[{"tags": ["vba", "excel", "delimiter"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447287638, "post_id": 33662089, "comment_id": 55098140, "body": "How many groupings are we talking on average?"}, {"owner": {"reputation": 9, "user_id": 5552650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40657f1a0483f436ee24a90267cfa539?s=128&d=identicon&r=PG&f=1", "display_name": "Pato", "link": "https://stackoverflow.com/users/5552650/pato"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447294347, "post_id": 33662089, "comment_id": 55100008, "body": "Probably no more than 10 groupings of names with date ranges.  To give some context, they&#39;re mutual fund managers and their start and end dates for their tenures."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447294910, "post_id": 33662089, "comment_id": 55100168, "body": "@jeeped answer should work, doing all in one action."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447289591, "post_id": 33662349, "comment_id": 55098733, "body": "This is great, but what about the OP&#39;s third want, splitting the dates.  I am just curious how you would go about doing it as your code is always more compact than I would think possible."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447290657, "post_id": 33662349, "comment_id": 55099037, "body": "@ScottCraner - yeah, I should have completed the final date trimming/split/conversion."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447291012, "post_id": 33662349, "comment_id": 55099115, "body": "It was not meant as a criticism,  Again I would have done it different but the method I was thinking would have been a few more lines to get the same result.  I like to learn as well as help.  I appreciate your responses."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447291341, "post_id": 33662349, "comment_id": 55099204, "body": "No worries. Don&#39;t mistake my terseness for deference. I write comments much as I do code; in as few words as possible. :)"}, {"owner": {"reputation": 9, "user_id": 5552650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40657f1a0483f436ee24a90267cfa539?s=128&d=identicon&r=PG&f=1", "display_name": "Pato", "link": "https://stackoverflow.com/users/5552650/pato"}, "edited": false, "score": 0, "creation_date": 1447294900, "post_id": 33662349, "comment_id": 55100165, "body": "I am going to spend some time reviewing this tomorrow to try and understand how it all works.  I really appreciate you posting this, and I wasn&#39;t expecting to get an answer this quickly.  I don&#39;t want to waste your time with my extremely limited knowledge, but I am curious.  Was my code that I was playing around with even on the right track or just completely wrong?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447296825, "post_id": 33662349, "comment_id": 55100712, "body": "A series of <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193593.aspx\" rel=\"nofollow noreferrer\">Range.TextToColumns method</a> would work well if a column was inserted and the last one used <code>xlFixedWidth</code> and discarded the first, third and last field. However, a subsequent operation to bring the second record values down to the second row was what madfe the decision to move to variant arrays for me."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1447290620, "last_edit_date": 1447290620, "creation_date": 1447287682, "answer_id": 33662349, "question_id": 33662089, "link": "https://stackoverflow.com/questions/33662089/how-do-i-set-up-code-to-dynamically-delimit-multiple-times/33662349#33662349", "title": "How do I set up code to dynamically delimit multiple times?", "body": "<p>Use variant arrays to first <a href=\"https://msdn.microsoft.com/en-us/library/aa263365(v=vs.60).aspx\" rel=\"nofollow\">Split</a> on the semi-colon, then split each piece on the comma. The dates are split/parse into actual dates and cell number formatting is applied to recreate the format of the original string dates.</p>\n\n<pre><code>Sub CommandButton1_Click()\n    Dim v As Long, vTMPs As Variant, vVALs As Variant, vDTs As Variant\n    With ActiveSheet\n        'split on semi-colon (e.g. Chr(59))\n        vTMPs = Split(.Cells(1, 1).Value2, Chr(59))\n        For v = LBound(vTMPs) To UBound(vTMPs)\n            Debug.Print vTMPs(v)\n            'split each piece on the comma\n            vVALs = Split(vTMPs(v), Chr(44))\n            'stuff it underneath and split the dates\n            With .Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\n                vDTs = Split(Mid(Trim(vVALs(LBound(vVALs))), 2, Len(Trim(vVALs(LBound(vVALs)))) - 2), \"--\")\n                .Cells(1, 1) = DateSerial(Left(vDTs(0), 4), Mid(vDTs(0), 6, 2), Right(vDTs(0), 2))\n                .Cells(1, 2) = DateSerial(Left(vDTs(1), 4), Mid(vDTs(1), 6, 2), Right(vDTs(1), 2))\n                .Resize(1, 2).NumberFormat = \"yyyy-mm-dd\"\n                .Offset(0, 2) = Trim(vVALs(UBound(vVALs)))\n            End With\n        Next v\n    End With\nEnd Sub\n</code></pre>\n\n<p>Each element of the final split is put into the next blank row in column A.</p>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1447287740, "creation_date": 1447287740, "answer_id": 33662357, "question_id": 33662089, "link": "https://stackoverflow.com/questions/33662089/how-do-i-set-up-code-to-dynamically-delimit-multiple-times/33662357#33662357", "title": "How do I set up code to dynamically delimit multiple times?", "body": "<pre><code>dim strSplit() as string\n\nstrSplit =split(range(\"a1\").value,\";\")\nrange(\"b1\").value=strsplit(0)\nrange(\"b2\").value=strSplit(1)\n</code></pre>\n\n<p>is the 1st bit :) then the same will apply to each of strSplit, using \",\" the 2nd time and will be date in 1 and name in the other</p>\n\n<p>split(\"test show\",\" \") gives an array (0)=\"test\" (1)=\"Show\"</p>\n\n<p>It can also be done using SUBSTITUTE and FIND/SEARCH in a formula, but can get tricky to track.</p>\n"}], "owner": {"reputation": 9, "user_id": 5552650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40657f1a0483f436ee24a90267cfa539?s=128&d=identicon&r=PG&f=1", "display_name": "Pato", "link": "https://stackoverflow.com/users/5552650/pato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1447290620, "creation_date": 1447286166, "last_edit_date": 1447286823, "question_id": 33662089, "link": "https://stackoverflow.com/questions/33662089/how-do-i-set-up-code-to-dynamically-delimit-multiple-times", "title": "How do I set up code to dynamically delimit multiple times?", "body": "<p>I'm analyzing some data pulled from a website and right now it's formatted like this within a single cell in Excel, for example:</p>\n\n<pre><code>[2015-08-01--2010-01-01], Jerry Smith; [2009-12-31--2000-01-01], John Brown\n</code></pre>\n\n<p>where all of that is located in, let's say, A1.</p>\n\n<p>I want to delimit it first by the semi-colon, then transpose the information, and then separate into columns the two date periods, so that way the final result for the example I listed above turns into a 2x3 cell grouping with the columns being 1. Start date 2. End date 3. Name </p>\n\n<p>I've played around with some VBA code and I'm getting frustrated because I can't even figure out how to code the first step of delimiting by the semi-colon.</p>\n\n<p>This is what I'm using so far:</p>\n\n<pre><code>    Sub CommandButton1_Click()\nSelection.TextToColumns _\n  Destination:=Range(\"A1\"), _\n  DataType:=xlDelimited, _\n  TextQualifier:=xlDoubleQuote, _\n  ConsecutiveDelimiter:=False, _\n  Tab:=False, _\n  Semicolon:=True, _\n  Comma:=False, _\n  Space:=False, _\n  Other:=False, _\n  OtherChar:=False, _\n\n  End Sub\n</code></pre>\n\n<p>I know that this is the incorrect first step for delimiting by semi-colon, so what do I need to do to fix it and how do I approach the next steps I described?  </p>\n\n<p>Also, how can I write the code correctly such that it can adapt to 3+ name and date range pairings instead of only two like I listed in my example cell?</p>\n"}, {"tags": ["vba", "excel", "csv"], "answers": [{"tags": [], "owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "is_accepted": true, "score": 0, "last_activity_date": 1447285675, "creation_date": 1447285675, "answer_id": 33662008, "question_id": 33661968, "link": "https://stackoverflow.com/questions/33661968/excel-2010-vba-to-copy-range-az-and-paste-a2z/33662008#33662008", "title": "Excel 2010 VBA to copy range A:Z and Paste A2:Z", "body": "<p>You can't copy the whole column in a column minus one row. If you do that, overflow occurs. Restrict your copy a little more, e.g. you can try</p>\n\n<pre><code>Workbooks.Open Filename:=\"C:\\Users\\Username\\Desktop\\file1.csv\"\nintersect(Sheets(\"sheet1\").Range(\"A:EW\"),sheets(\"sheet1).usedrange).Copy ThisWorkbook.Sheets(\"sheet2\").Range(\"A2\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 5552616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db708f458b44d1f20bc85635214946e4?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle L", "link": "https://stackoverflow.com/users/5552616/kyle-l"}, "edited": false, "score": 0, "creation_date": 1447349801, "post_id": 33662062, "comment_id": 55128523, "body": "Pasting the data from A:EW to A2 works now but it broke the date format script. A3 and down contains dates in timestamp format yyyymmdd hhmmss which Im trying to convert to mm/dd/yy hh:mm. I tried modifying my above code to change the date starting at A3 but had no luck so far. It has a debug error which highlights to &quot;y = Mid(z, 5, 2) &amp; &quot;/&quot; &amp; Mid(z, 7, 2) &amp; &quot;/&quot; &amp; Left(z, 4)&quot;"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1447286014, "creation_date": 1447286014, "answer_id": 33662062, "question_id": 33661968, "link": "https://stackoverflow.com/questions/33661968/excel-2010-vba-to-copy-range-az-and-paste-a2z/33662062#33662062", "title": "Excel 2010 VBA to copy range A:Z and Paste A2:Z", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196678.aspx\" rel=\"nofollow\">Range.CurrentRegion property</a> can quickly reference the 'island' of data originating in A1.</p>\n\n<pre><code>Dim wb As Workbook\nSet wb = Workbooks.Open(Filename:=\"C:\\Users\\Username\\Desktop\\file1.csv\")\n\nWith wb\n     'CSVs open with a single worksheet; usually named the same as the CSV, not Sheet1\n    With .Worksheets(1)\n        With .Range(\"A1\").CurrentRegion\n            'reference the destination workbook correctly (ThisWorkbook...?)\n            .Copy Destination:=ThisWorkbook.Worksheets(\"sheet2\").Range(\"A2\")\n        End With\n    End With\n.Close\nEnd With\n</code></pre>\n\n<p>You only need to reference the cell in the top-left corner for the destination of a paste.</p>\n"}], "owner": {"reputation": 35, "user_id": 5552616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db708f458b44d1f20bc85635214946e4?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle L", "link": "https://stackoverflow.com/users/5552616/kyle-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1216, "favorite_count": 0, "accepted_answer_id": 33662008, "answer_count": 2, "score": 0, "last_activity_date": 1447286014, "creation_date": 1447285447, "question_id": 33661968, "link": "https://stackoverflow.com/questions/33661968/excel-2010-vba-to-copy-range-az-and-paste-a2z", "title": "Excel 2010 VBA to copy range A:Z and Paste A2:Z", "body": "<p>I tried researching but have had no luck with what I'm trying to achieve. I have two different files I'm working with; file1.csv(sheet1)and workbook1(sheet2)</p>\n\n<p>file1.csv(sheet1) contains data from column A:EW, 1000+ rows, and is regularly updated with new rows</p>\n\n<p>The end goal here is to automatically copy the entire contents of file1.csv(sheet1) and paste the data from sheet 1 into workbook1(sheet2) starting at A2 on sheet2 because I need A1 to remain blank on sheet2</p>\n\n<p>I should also note, I cannot provide the actual files as they are confidential, I could make an example files if necessary.</p>\n\n<p>This is the code I have so far in workbook1 but it does not work when copying to/from a different ranges. It works great if I change it to copy from A:EW to A:EW <strong>BUT</strong> I need to copy from A:EW on Sheet1 to A2:EW on sheet2. Does anyone have any recommendations? </p>\n\n<pre><code>Sub auto_open()\n'\n' auto_open Macro\n'\nChDir \"C:\\\"\nWorkbooks.Open Filename:=\"C:\\Users\\Username\\Desktop\\file1.csv\"\nSheets(\"sheet1\").Range(\"A:EW\").Copy\nWindows(ThisWorkbook.Name).Activate\nWorksheets(\"sheet2\").Activate\nRange(\"A2:EW\").Select\nActiveSheet.Paste\nWindows(\"sheet1\").Activate\nApplication.CutCopyMode = False\nActiveWorkbook.Close\n\n' Change date/time format of column A from 20151111 090412 to 11/11/2015 9:04\nDim x As Integer\nDim y As Date\nDim z As String\nDim w As String\n\nNumRows = Range(\"A2\", Range(\"A2\").End(xlDown)).Rows.Count\n\nWindows(ThisWorkbook.Name).Activate\nFor x = 2 To NumRows\n     z = Cells(x, 1).Value\n     y = Mid(z, 5, 2) &amp; \"/\" &amp; Mid(z, 7, 2) &amp; \"/\" &amp; Left(z, 4)\n     w = Mid(z, 10, 2) &amp; \":\" &amp; Mid(z, 12, 2) &amp; \":\" &amp; Mid(z, 14, 2)\n     y = y + TimeValue(w)\n     Cells(x, 1).Value = y\nNext x\n\nRange(\"A2\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447285050, "post_id": 33661864, "comment_id": 55097380, "body": "You need to set the ws either through a <code>For Each ws in activeworkbook.sheets</code> or set each individual sheet <code>Set ws = Sheets(&quot;Sheet1&quot;)</code>"}, {"owner": {"reputation": 111, "user_id": 2912702, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/44246c8e08aadb1012fec964ea46193e?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Aslam", "link": "https://stackoverflow.com/users/2912702/sean-aslam"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447285288, "post_id": 33661864, "comment_id": 55097457, "body": "I did, but I get errors    Sub Macro1() Dim ws As Worksheet For Each ws In ActiveWorkbook.Sheets     Range(&quot;Sort&quot;).Select     Selection.Sort Key1:=Range(&quot;q66&quot;), Order1:=xlAscending, Key2:=Range(&quot;u66&quot;) _         , Order2:=xlDescending, Header:=xlGuess, OrderCustom:=1, MatchCase:= _         False, Orientation:=xlTopToBottom Next ws End Sub"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447285536, "post_id": 33661864, "comment_id": 55097540, "body": "The <code>Range(&quot;Sort&quot;)</code> likely has a workbook scope. You cannot use it on individual worksheets. Better to define each worksheet&#39;s sorting range &#39;manually&#39;. See <a href=\"http://stackoverflow.com/questions/33661309/streamline-a-recorded-macro-that-spans-over-multiple-tabs-and-sorts-on-different/33661909#33661909\">this recent question</a>."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 2912702, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/44246c8e08aadb1012fec964ea46193e?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Aslam", "link": "https://stackoverflow.com/users/2912702/sean-aslam"}, "edited": false, "score": 0, "creation_date": 1447338270, "post_id": 33661966, "comment_id": 55120041, "body": "Thanks for the macro. The second macro is working fine across the spreadsheet. The first one fails with run time error 1004 &quot;Method Range of object _Worksheet failed&quot;. ws.Range is whats causing the issue. Any suggestions?"}, {"owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "reply_to_user": {"reputation": 111, "user_id": 2912702, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/44246c8e08aadb1012fec964ea46193e?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Aslam", "link": "https://stackoverflow.com/users/2912702/sean-aslam"}, "edited": false, "score": 0, "creation_date": 1447341572, "post_id": 33661966, "comment_id": 55122613, "body": "do you have a range named &quot;Sort&quot; on each worksheet of the workbook?"}], "tags": [], "owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "is_accepted": false, "score": 0, "last_activity_date": 1447285836, "last_edit_date": 1447285836, "creation_date": 1447285442, "answer_id": 33661966, "question_id": 33661864, "link": "https://stackoverflow.com/questions/33661864/running-code-in-multiple-worksheets/33661966#33661966", "title": "Running code in multiple worksheets", "body": "<p>You still have a couple ranges that do not reference the relevant worksheet. Update as follows: </p>\n\n<pre><code>Sub Macro1()\nDim ws As WorkSheet\nFor Each ws in activeworkbook.sheets \n ws.Range(\"Sort\").Sort Key1:=ws.Range(\"q66\"), Order1:=xlAscending, Key2:=ws.Range(\"u66\") _\n    , Order2:=xlDescending, Header:=xlGuess, OrderCustom:=1, MatchCase:= _\n    False, Orientation:=xlTopToBottom\nNext WS\nEnd Sub\n\nSub Delete_Name_Date()\n   Dim cell As Range\nFor Each ws in activeworkbook.sheets \n    For Each cell In ws.Range(\"R66:R306\")\n      With cell\n        .EntireRow.Hidden = _\n            (.Value = \"Empty\")\n       End With\n    Next\nnext ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 2912702, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/44246c8e08aadb1012fec964ea46193e?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Aslam", "link": "https://stackoverflow.com/users/2912702/sean-aslam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447287638, "creation_date": 1447284837, "last_edit_date": 1447287638, "question_id": 33661864, "link": "https://stackoverflow.com/questions/33661864/running-code-in-multiple-worksheets", "title": "Running code in multiple worksheets", "body": "<p>Trying to run code on an Excel document that has compiled data. I am running two macros individually on each sheet. I am unable to run this macro on all the worksheets in this workbook. First macro is for sorting the columns:</p>\n\n<pre><code>Sub Macro1()\nDim ws As WorkSheet\nRange(\"Sort\").Select\nSelection.Sort Key1:=ws.Range(\"q66\"), Order1:=xlAscending, Key2:=ws.Range(\"u66\") _\n    , Order2:=xlDescending, Header:=xlGuess, OrderCustom:=1, MatchCase:= _\n    False, Orientation:=xlTopToBottom\nNext WS\nEnd Sub\n</code></pre>\n\n<p>Second macro is for hiding the rows based on value \"Null\": </p>\n\n<pre><code>Sub HideList()\nDim ws As Worksheet\nDim cell As Range\n\nFor Each cell In ws.Range(\"HideList\")\n    With cell\n        .EntireRow.Hidden = _\n            (Value = \"Empty\")\n    End With\n Next ws\n\n End Sub\n</code></pre>\n\n<p>It works if I remove the <code>ws</code>. from the range but again works only for single sheet.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1447284604, "post_id": 33661481, "comment_id": 55097228, "body": "not sure, but maybe =GetCoordinates(&quot; &amp; range(&quot;a&quot; &amp; I).value &amp; &quot;)&quot;"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447285744, "post_id": 33661481, "comment_id": 55097614, "body": "The key of the problem is to know if the error occurs at the first call to <code>GetCoordinates</code>or at the 11th call?"}, {"owner": {"reputation": 21, "user_id": 5552583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef2e77abd3f1e2d9144fe8a0e532d81?s=128&d=identicon&r=PG&f=1", "display_name": "pgarzav32", "link": "https://stackoverflow.com/users/5552583/pgarzav32"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447286397, "post_id": 33661481, "comment_id": 55097807, "body": "Thanks for the responses.. user5414798, unfortunately your suggestion did not fix the error. @A.S.H. The error occurs at the 1st call of <code>GetCoordinates</code>."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447286563, "post_id": 33661481, "comment_id": 55097855, "body": "Can you please post the prototype of <code>GetCoordinates</code> and the value in the cell <code>A1</code>?"}, {"owner": {"reputation": 21, "user_id": 5552583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef2e77abd3f1e2d9144fe8a0e532d81?s=128&d=identicon&r=PG&f=1", "display_name": "pgarzav32", "link": "https://stackoverflow.com/users/5552583/pgarzav32"}, "edited": false, "score": 0, "creation_date": 1447286594, "post_id": 33661481, "comment_id": 55097865, "body": "In case some were wondering, the GetCoordinates is a Function, this is the start of the code for it:      <code>Option Explicit       Function GetCoordinates(Address As String) As String</code>"}], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447286762, "post_id": 33662174, "comment_id": 55097911, "body": "Problem is, as I understood, the error occurs at the first time when <code>GetCoordinates</code> is used."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447286994, "post_id": 33662174, "comment_id": 55097977, "body": "We dont know much about that function and the content of <code>A1</code>. We need your <code>Crystal Ball</code> so badly now!!! :P :D"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447287836, "post_id": 33662174, "comment_id": 55098198, "body": "If the <code>GetCoordinates</code> is already a working function in 10 cells on the worksheet (albeit in a non-volatile mode), a recalculation can be forced on those individual cells. Without going into the API completely, I was offering a better recursive loop than resetting the increment counter in a For.. Next loop."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447288152, "post_id": 33662174, "comment_id": 55098294, "body": "I agree totally with your improvements, since I wasn&#39;t comfortable with the timing method in the OP. And yes, it might be that the API function was called elsewhere in the worksheet. (proves that we do need that Crystal Ball ;) )"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447289396, "post_id": 33662174, "comment_id": 55098674, "body": "No worries. Comments always welcomed and appreciated (although I can be admittedly terse in my responses). :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1447286637, "creation_date": 1447286637, "answer_id": 33662174, "question_id": 33661481, "link": "https://stackoverflow.com/questions/33661481/recalculate-ten-cells-every-ten-seconds/33662174#33662174", "title": "Recalculate ten cells every ten seconds", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196165.aspx\" rel=\"nofollow\">Application.OnTime method</a> can call the routine that it is in.</p>\n\n<pre><code>Sub Recalculatecells()\n    Application.StatusBar = \"Calculating ...\"\n    Worksheets(\"Sheet2\").Range(\"N1:N10\").Calculate\n    Application.StatusBar = vbNullString\n    'put something here to optionally exit the timed loop\n    Application.OnTime Now + TimeSerial(0, 0, 10), \"Recalculatecells\"\nEnd Sub\n</code></pre>\n\n<p>I find this allows more freedom for working on the workbook instead of staying within the same sub procedure and mucking with a <code>For ... Next</code> increment counter.</p>\n"}], "owner": {"reputation": 21, "user_id": 5552583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef2e77abd3f1e2d9144fe8a0e532d81?s=128&d=identicon&r=PG&f=1", "display_name": "pgarzav32", "link": "https://stackoverflow.com/users/5552583/pgarzav32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1447286637, "creation_date": 1447282932, "last_edit_date": 1447283813, "question_id": 33661481, "link": "https://stackoverflow.com/questions/33661481/recalculate-ten-cells-every-ten-seconds", "title": "Recalculate ten cells every ten seconds", "body": "<p>I am trying to use Google Maps API for around 2,000 locations. I was told the API only allows ten calculations every ten seconds hence we need the Excel sheet to do that. My code:  </p>\n\n<pre><code>'recalculate cells\nSub Recalculatecells()\nDim irow As Integer\nDim i As Integer\nDim j As Integer\n\n\n'    Worksheets(\"Sheet2\").Active\n        Range(\"A1\").Select\n        Selection.End(xlDown).Select\n        iRow = ActiveCell.Row\n\n        Range(\"N1\").Value = irow\n\n        For i = 1 To iRow\n            Range(\"N\" &amp; Str(i)).Formula = \"=GetCoordinates(A\" &amp; i &amp; \")\"\n        j = j + 1\n        If j = 10 Then\n\n            Application.Wait (Now + TimeValue(\"00:00:10\"))\n            j = 0\n        Else\n            j = j + 1\n        End If\n\n    Next i\n\nEnd Sub  \n</code></pre>\n\n<p>This is currently giving an error on the line:  </p>\n\n<pre><code>Range(\"N\" &amp; Str(i)).Formula= \"=GetCoordinates(A\" &amp; i &amp; \")\"  \n</code></pre>\n\n<p>(Note: <code>=getcoordinates</code> is the function to run the Maps API.)  </p>\n\n<p>I don't know why the error is there, once this error is removed would the code work?</p>\n"}, {"tags": ["excel", "vba", "bloomberg"], "answers": [{"comments": [{"owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 0, "creation_date": 1447318919, "post_id": 33662533, "comment_id": 55108287, "body": "<code>RefreshCurrentSelection</code> runs asynchronously so that would not work."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1447288773, "creation_date": 1447288773, "answer_id": 33662533, "question_id": 33661436, "link": "https://stackoverflow.com/questions/33661436/vba-to-refresh-bloomberg-data-not-running-in-proper-order/33662533#33662533", "title": "VBA to refresh Bloomberg data not running in proper order", "body": "<p>Even though your <strong>Call</strong>s seems odd, you should be able to make use of the value from <code>Application.CalculationState</code>.</p>\n\n<p>There are other ways to \"pause\" Excel, but you can do a simple While loop that do nothing except waiting for value of <code>Application.CalculationState</code> becomes <code>xlDone</code>.</p>\n\n<pre><code>Do Until Application.CalculationState=xlDone\nLoop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "is_accepted": false, "score": 3, "last_activity_date": 1447318876, "creation_date": 1447318876, "answer_id": 33667663, "question_id": 33661436, "link": "https://stackoverflow.com/questions/33661436/vba-to-refresh-bloomberg-data-not-running-in-proper-order/33667663#33667663", "title": "VBA to refresh Bloomberg data not running in proper order", "body": "<p>Bloomberg formulae update is asynchronous so your code won't wait until the update is over. You need to schedule the rest of your code to a later time, check if the data has been updated.</p>\n\n<p>It would look like this:</p>\n\n<pre><code>Application.Run \"RefreshCurrentSelection\"\nupdate\n\nSub update()\n  If (check if the links have been updated) Then\n    Worksheets(\"sheet1\").Range(\"d3\").Value = Worksheets(\"sheet1\").Range(\"sum\")\n  Else\n    Application.OnTime earliestTime:= Date + Time + timeserial(0, 0, 1), _\n                   procedure:=\"update\", Schedule:=True\n  End if\nEnd Sub\n</code></pre>\n\n<p>That would ask the Bloomberg API to refresh the data, then wait 1 second, check if the data is updated, wait another second if not etc. until the data is updated and then it would run the range assignment.</p>\n"}, {"tags": [], "owner": {"reputation": 715, "user_id": 4258124, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Cp2ML.jpg?s=128&g=1", "display_name": "NikT", "link": "https://stackoverflow.com/users/4258124/nikt"}, "is_accepted": false, "score": 2, "last_activity_date": 1455904380, "creation_date": 1455904380, "answer_id": 35511699, "question_id": 33661436, "link": "https://stackoverflow.com/questions/33661436/vba-to-refresh-bloomberg-data-not-running-in-proper-order/35511699#35511699", "title": "VBA to refresh Bloomberg data not running in proper order", "body": "<p>You have to split it up between a check and a refresh.</p>\n\n<pre><code>Sub RefreshData()\n\nApplication.Calculation = xlCalculationAutomatic\n\nWorksheets(\"Sheet1\").Range(\"A1:A4\").Select 'the cells \"data1\" contains the function =BDH(ticker, field, start date, end date) to get the information from Bloomberg'\n\nApplication.Run \"RefreshCurrentSelection\"\n\n'Check to see if it filled\nCall Check_API\n\nEnd Sub\n\nSub Check_API()\n\nIf Application.WorksheetFunction.CountIfs(Range(\"A1:A4\"), \"#N/A Requesting Data...\") &gt; 0 Then\n    'Check every 3 seconds\n     Application.OnTime Now + TimeValue(\"00:00:03\"), \"Check_API\"\nElse\n\n    'What to do after API filled\n     Worksheets(\"sheet1\").Range(\"D3\").Value = Application.WorksheetFunction.Sum(Worksheets(\"Sheet1\").Range(\"A1:A4\")) 'the cells \"sum\" takes the sum of all BB info'\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Also, instead of focusing on the selection, you can do:</p>\n\n<p>Refresh based on default option setting:</p>\n\n<pre><code>      Application.Run \"RefreshData\"\n</code></pre>\n\n<p>Refresh current selection:     </p>\n\n<pre><code>      Application.Run \"RefreshCurrentSelection\"\n</code></pre>\n\n<p>Refresh current worksheet:     </p>\n\n<pre><code>      Application.Run \"RefreshEntireWorksheet\"\n</code></pre>\n\n<p>Refresh current workbook:     </p>\n\n<pre><code>      Application.Run \"RefreshEntireWorkbook\"\n</code></pre>\n\n<p>Refresh all workbooks:     </p>\n\n<pre><code>      Application.Run \"RefreshAllWorkbooks\"\n</code></pre>\n\n<p>If you were interested. Still the better option is implementing the v3 COM API class that can be found in Bloomberg's SDK with VBA examples.</p>\n"}], "owner": {"reputation": 11, "user_id": 5039594, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MfiPIzmPMCI/AAAAAAAAAAI/AAAAAAAAABU/RjuwmrKHNLM/photo.jpg?sz=128", "display_name": "hokage VII", "link": "https://stackoverflow.com/users/5039594/hokage-vii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9733, "favorite_count": 5, "answer_count": 3, "score": 1, "last_activity_date": 1526964498, "creation_date": 1447282739, "last_edit_date": 1526964498, "question_id": 33661436, "link": "https://stackoverflow.com/questions/33661436/vba-to-refresh-bloomberg-data-not-running-in-proper-order", "title": "VBA to refresh Bloomberg data not running in proper order", "body": "<p>my purpose is to update Bloomberg data and do some calculatations with different tickers. But it seems that VBA will run all the calculations without waiting the data to be updated. \nHere is the code:</p>\n\n<pre><code>Application.Calculation = xlCalculationAutomatic\n\nFor i = 1 To 3\n\n    Call Worksheets(\"Sheet1\").Range(\"data1\").Select 'the cells \"data1\" contains the function =BDH(ticker, field, start date, end date) to get the information from Bloomberg'\n\n    Call Application.Run(\"RefreshCurrentSelection\")\n\n    Worksheets(\"sheet1\").Range(\"d3\").Value = Worksheets(\"sheet1\").Range(\"sum\") 'the cells \"sum\" takes the sum of all BB info'     \n</code></pre>\n\n<p>Anyone know how to fix it?</p>\n"}, {"tags": ["vba", "excel", "sorting"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1447282423, "post_id": 33661309, "comment_id": 55096407, "body": "you need to do a for each loop on the worksheet, and use one of the sorting and replace &quot;15-16 Vehicles&quot; with ws.name, so for each ws in thisworkbook.worksheets   ws.usedrange.sort.sortfields etc..... next ws  with an if statement to check its not sheet 9"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1447284477, "post_id": 33661309, "comment_id": 55097197, "body": "Were you aware that some of your worksheet names seem to have trailing spaces?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5552524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eQuIheDXdcI/AAAAAAAAAAI/AAAAAAAAAEU/O7t7V3Xgr8A/photo.jpg?sz=128", "display_name": "lilbuggs", "link": "https://stackoverflow.com/users/5552524/lilbuggs"}, "edited": false, "score": 0, "creation_date": 1447356169, "post_id": 33661909, "comment_id": 55132270, "body": "Thank you @Jeeped! I was unaware that there were spaces in two of the worksheet names and I have fixed them. Additionally with the data being selected there is no header, so I changed that to xlNo and changed the code from ascending to descending order."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1447285032, "last_edit_date": 1495540316, "creation_date": 1447285032, "answer_id": 33661909, "question_id": 33661309, "link": "https://stackoverflow.com/questions/33661309/streamline-a-recorded-macro-that-spans-over-multiple-tabs-and-sorts-on-different/33661909#33661909", "title": "Streamline a recorded macro that spans over multiple tabs and sorts on different columns", "body": "<p>The recorded code for sorting is usually more than just a little verbose. Chopping it down to what is actually needed can certainly remove a lot of useless code.</p>\n\n<pre><code>Sub Sort_All_Macro()\n    Dim v As Long, wsARR As Variant\n    Dim lr As Long\n\n    'make an array of the worksheet names\n    'some of the ws names seemed to have trailing spaces; the spaces should be removed\n    wsARR = Array(\"0809 Vehicles\", \"0910 Vehicles\", \"1011 Vehicles\", \"11-12 Vehicles\", _\n                  \"12-13 Vehicles\", \"13-14 Vehicles\", \"14-15 Vehicles\", \"15-16 Vehicles\")\n    'from the first in the array to the last\n    For v = LBound(wsARR) To UBound(wsARR)\n        'work on each in turn\n        With Worksheets(wsARR(v))\n            'get the last row in column Q\n            lr = .Cells(Rows.Count, \"Q\").End(xlUp).Row\n            'work on A5 to the last row in Q\n            With .Range(.Cells(5, 1), .Cells(lr, \"Q\"))\n                'sort on columns E first (can only sort on max 3 columns at a time this way\n                .Cells.Sort Key1:=.Columns(5), Order1:=xlAscending, _\n                            Orientation:=xlTopToBottom, Header:=xlYes   '&lt;~~ you should know if there is a header or not\n                'sort on columns B, C, D (finish off the sort)\n                .Cells.Sort Key1:=.Columns(2), Order1:=xlAscending, _\n                            Key2:=.Columns(3), Order2:=xlAscending, _\n                            Key3:=.Columns(4), Order3:=xlAscending, _\n                            Orientation:=xlTopToBottom, Header:=xlYes   '&lt;~~ you should know if there is a header or not\n            End With\n        End With\n    Next v\nEnd Sub\n</code></pre>\n\n<p>This method of sorting can only work on three key columns at one (i.e. there is no <strong>key4</strong> parameter). The trick is to sort the fourth one first, then sort the first three.</p>\n\n<p>Referencing the each worksheet in turn with a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a> reduces the amount of repetitious references. A <code>Range</code> becomes a <code>.Range</code> and <code>Cells</code> becomes <code>.Cells</code> to note it belongs to the worksheet referenced by the <code>With ... End With</code>.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</p>\n"}], "owner": {"reputation": 1, "user_id": 5552524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eQuIheDXdcI/AAAAAAAAAAI/AAAAAAAAAEU/O7t7V3Xgr8A/photo.jpg?sz=128", "display_name": "lilbuggs", "link": "https://stackoverflow.com/users/5552524/lilbuggs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447285032, "creation_date": 1447282037, "last_edit_date": 1447284751, "question_id": 33661309, "link": "https://stackoverflow.com/questions/33661309/streamline-a-recorded-macro-that-spans-over-multiple-tabs-and-sorts-on-different", "title": "Streamline a recorded macro that spans over multiple tabs and sorts on different columns", "body": "<p>I have recorded a macro that does a custom sort over eight worksheets and sorts on four columns. I have a workbook with nine total worksheets. The first eight of the worksheets need to be sorted upon opening the workbook. The ninth worksheet is a validation page for Conditional Formatting and error check formulas.  </p>\n\n<p>I want VBA that is simpler than a recorded macro produces for the eight worksheets. Each worksheet needs to be sorted by columns B, C, D, and E. All data starts at row 5 but never ends on the same row within the worksheets. I need to sort the entire sheet and not just a range.  </p>\n\n<p>Is there VBA that will do this more simply than creating the macro for all eight worksheets?  </p>\n\n<p>I'm sure a 'For' loop will probably take care of cycling through the worksheets and <code>xldown</code> will find all the data in each worksheet but I'm really struggling on how to streamline this with the sorts that need to be performed. The VBA from the recorded macro is:</p>\n\n<pre><code>Sub Auto_Open()\nSort_All Macro\nRange(\"A5\").Select\nRange(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\nActiveWorkbook.Worksheets(\"0809 Vehicles\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"0809 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"B5:B217\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"0809 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"C5:C217\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"0809 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"D5:D217\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"0809 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"E5:E217\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.Worksheets(\"0809 Vehicles\").Sort\n    .SetRange Range(\"A5:Q217\")\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nSheets(\"0910 Vehicles \").Select\nRange(\"A5\").Select\nRange(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\nActiveWorkbook.Worksheets(\"0910 Vehicles \").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"0910 Vehicles \").Sort.SortFields.Add Key:=Range( _\n    \"B5:B217\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"0910 Vehicles \").Sort.SortFields.Add Key:=Range( _\n    \"C5:C217\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"0910 Vehicles \").Sort.SortFields.Add Key:=Range( _\n    \"D5:D217\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"0910 Vehicles \").Sort.SortFields.Add Key:=Range( _\n    \"E5:E217\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.Worksheets(\"0910 Vehicles \").Sort\n    .SetRange Range(\"A5:Q217\")\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nSheets(\"1011 Vehicles \").Select\nRange(\"A5\").Select\nRange(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\nActiveWorkbook.Worksheets(\"1011 Vehicles \").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"1011 Vehicles \").Sort.SortFields.Add Key:=Range( _\n    \"B5:B215\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"1011 Vehicles \").Sort.SortFields.Add Key:=Range( _\n    \"C5:C215\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"1011 Vehicles \").Sort.SortFields.Add Key:=Range( _\n    \"D5:D215\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"1011 Vehicles \").Sort.SortFields.Add Key:=Range( _\n    \"E5:E215\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.Worksheets(\"1011 Vehicles \").Sort\n    .SetRange Range(\"A5:S215\")\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nSheets(\"11-12 Vehicles\").Select\nRange(\"A5\").Select\nRange(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\nActiveWindow.SmallScroll Down:=-234\nActiveWorkbook.Worksheets(\"11-12 Vehicles\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"11-12 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"B5:B237\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"11-12 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"C5:C237\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"11-12 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"D5:D237\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"11-12 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"E5:E237\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.Worksheets(\"11-12 Vehicles\").Sort\n    .SetRange Range(\"A5:R237\")\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nSheets(\"12-13 Vehicles\").Select\nRange(\"A5\").Select\nRange(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\nRange(\"A5:R259\").Select\nActiveWorkbook.Worksheets(\"12-13 Vehicles\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"12-13 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"B5:B259\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"12-13 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"C5:C259\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"12-13 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"D5:D259\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"12-13 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"E5:E259\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.Worksheets(\"12-13 Vehicles\").Sort\n    .SetRange Range(\"A5:R259\")\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nSheets(\"13-14 Vehicles\").Select\nRange(\"A5\").Select\nRange(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\nActiveWorkbook.Worksheets(\"13-14 Vehicles\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"13-14 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"B5:B245\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"13-14 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"C5:C245\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"13-14 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"D5:D245\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"13-14 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"E5:E245\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.Worksheets(\"13-14 Vehicles\").Sort\n    .SetRange Range(\"A5:T245\")\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nSheets(\"14-15 Vehicles\").Select\nRange(\"A5\").Select\nRange(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\nActiveWorkbook.Worksheets(\"14-15 Vehicles\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"14-15 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"B5:B249\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"14-15 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"C5:C249\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"14-15 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"D5:D249\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"14-15 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"E5:E249\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.Worksheets(\"14-15 Vehicles\").Sort\n    .SetRange Range(\"A5:R249\")\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nSheets(\"15-16 Vehicles\").Select\nRange(\"A5\").Select\nRange(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\nActiveWorkbook.Worksheets(\"15-16 Vehicles\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"15-16 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"B5:B234\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"15-16 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"C5:C234\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"15-16 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"D5:D234\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nActiveWorkbook.Worksheets(\"15-16 Vehicles\").Sort.SortFields.Add Key:=Range( _\n    \"E5:E234\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.Worksheets(\"15-16 Vehicles\").Sort\n    .SetRange Range(\"A5:R234\")\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "charts", "vba"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 4770524, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5a24f2d29f3518a6ccce08c72368ceb8?s=128&d=identicon&r=PG&f=1", "display_name": "Les Programmer", "link": "https://stackoverflow.com/users/4770524/les-programmer"}, "edited": false, "score": 0, "creation_date": 1447339296, "post_id": 33662821, "comment_id": 55120813, "body": "Sorry, that line had no effect at all - nothing changed."}, {"owner": {"reputation": 111, "user_id": 4770524, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5a24f2d29f3518a6ccce08c72368ceb8?s=128&d=identicon&r=PG&f=1", "display_name": "Les Programmer", "link": "https://stackoverflow.com/users/4770524/les-programmer"}, "edited": false, "score": 0, "creation_date": 1447362242, "post_id": 33662821, "comment_id": 55135651, "body": "I did a work-around for my problem.  If there was no value in &#39;B6&#39; i.e. the first day of the month, I placed a nominal value (0.00001).  This forced the chart to start from column B.  I also placed 31 tiny &#39;label boxes&#39; below the chart (i.e. image) right on the userform where each one lines up below the day number of the month.  I will place an appropriate letter (M for Monday, T for Tuesday, etc) in each box based on the day of the month.  Kind of sloppy but I think it will work out ok."}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "reply_to_user": {"reputation": 111, "user_id": 4770524, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5a24f2d29f3518a6ccce08c72368ceb8?s=128&d=identicon&r=PG&f=1", "display_name": "Les Programmer", "link": "https://stackoverflow.com/users/4770524/les-programmer"}, "edited": false, "score": 0, "creation_date": 1447374449, "post_id": 33662821, "comment_id": 55140797, "body": "I had a look on numerous websites and there doesn&#39;t seem to be (or I haven&#39;t found it jet) a satisfying answer (in my eyes)."}], "tags": [], "owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "is_accepted": false, "score": 0, "last_activity_date": 1447290758, "creation_date": 1447290758, "answer_id": 33662821, "question_id": 33661107, "link": "https://stackoverflow.com/questions/33661107/label-and-display-chart/33662821#33662821", "title": "Label and display chart", "body": "<p>Try using this in your <code>With</code>-Block:</p>\n\n<pre><code>With oChrt.Chart\n    .SetSourceData Source:=ThisWorkbook.sheets(\"Oct\").Range(\"B6:AF6\")\n    .FullSeriesCollection(1).XValues = Range(\"B2\",\"AF2\")\n    .ChartType = xl3DColumn\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 4770524, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5a24f2d29f3518a6ccce08c72368ceb8?s=128&d=identicon&r=PG&f=1", "display_name": "Les Programmer", "link": "https://stackoverflow.com/users/4770524/les-programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447290758, "creation_date": 1447281100, "last_edit_date": 1531161705, "question_id": 33661107, "link": "https://stackoverflow.com/questions/33661107/label-and-display-chart", "title": "Label and display chart", "body": "<p>I want to display a column chart with proper labels and the columns placed in the correct spot.</p>\n\n<p>I have a worksheet for each month of the year.  Row 2 is the days of the month i.e. numbered 1 to 31, (going from column 'B' to column 'AF').  Column 'A' has different products, from row 3 to row 12 (numbered 1 to 10). Throughout the month, production numbers are placed into a day and for a product.  For example, product #4 on the 5th of the month would have a production number placed in range(\"F6\"). Product #1 on the 31st would go into range(\"AF3\").</p>\n\n<p>I have the following code that produces a column chart on Userform1.  It works well.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim chartData As Range\nDim oChrt As ChartObject\n\nApplication.ScreenUpdating = False\n\nSet oChrt = ThisWorkbook.sheets(\"Oct\").ChartObjects.Add _\n            (Left:=24, Width:=768, Top:=66, Height:=402)\nWith oChrt.Chart\n    .SetSourceData Source:=ThisWorkbook.sheets(\"Oct\").Range(\"B6:AF6\")\n    .ChartType = xl3DColumn\nEnd With\n\nDim imageName As String\nimageName = Application.DefaultFilePath &amp; Application.PathSeparator &amp; \"tempChart.gif\"\n\noChrt.Chart.Export FileName:=imageName\n\nThisWorkbook.sheets(\"Oct\").ChartObjects.Delete\n\nApplication.ScreenUpdating = True\n\nUserForm1.Image1.Picture = LoadPicture(imageName)\n\nEnd Sub\n</code></pre>\n\n<p>The problem is the x-axis.  The x-axis is labelled 1 to whatever it needs i.e. if there is data in columns 'E'(6), 'J'(10) and 'T'(20) (for a particular row) the chart will only show about 15 columns and put 'E' in the 1st column, 'J' in the 5th column and 'T' in the 15th.</p>\n\n<p>What I want is for the chart to leave columns 1 to 5 blank and show 'E' in 6 as it is in the worksheet. If that's all I can accomplish that would be fine.  </p>\n\n<p>If, however, it is possible to create another row of labels along the x-axis, I would love to have the day of the month below the number of the month. The days (as text) are in row 1 of the worksheet and the numbers are in row 2.</p>\n"}, {"tags": ["excel", "vba", "strikethrough"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447280429, "post_id": 33660848, "comment_id": 55095440, "body": "What are your trying to put in its place?  Is it going to be the same across all cells or are you going to replace it with the same text just not striken through?"}, {"owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447281059, "post_id": 33660848, "comment_id": 55095757, "body": "With another text maybe from another cell. If it would be the same text but not strike through I could use something like this I think: <a href=\"http://stackoverflow.com/questions/11829914/creating-strikethrough-macro-in-excel#11830061\">example</a>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1447281714, "post_id": 33660848, "comment_id": 55096084, "body": "Range(&quot;c1&quot;).Characters(start,length ).font.strikethrough, may be a good place to start, but youll need to loop the start, with length of 1.  You can then use MID from 1 to this point and add your replacement on"}], "answers": [{"comments": [{"owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 0, "creation_date": 1447343672, "post_id": 33662312, "comment_id": 55124276, "body": "Clever workaround. So you search of any character with strikethrough, replace it with something that is more easy to handle and then replace it, right?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 0, "creation_date": 1447350619, "post_id": 33662312, "comment_id": 55129000, "body": "@Kronos Yes it puts A &quot;|&quot; at the beginning of the group and a &quot;|&quot; at the end of the group. And everything in between is skipped.  You end up with &quot;||&quot; in place of the whole group, then replace that with your wanted values."}, {"owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 0, "creation_date": 1447780499, "post_id": 33662312, "comment_id": 55293702, "body": "Do you know why does .Characters.Font.Strikethrough works but if I use Left().Font.Strikethrough doesn&#39;t? I understand Left returns a string but, would you know if there&#39;s another way to check if a substring has the strikethrough property?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 0, "creation_date": 1447780667, "post_id": 33662312, "comment_id": 55293799, "body": "All the research I have done states that to get or set the format properties of the characters one needs to use the characters."}, {"owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 0, "creation_date": 1447781615, "post_id": 33662312, "comment_id": 55294455, "body": "But could someone set the properties of those characters by getting a substring in some way?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 0, "creation_date": 1447781884, "post_id": 33662312, "comment_id": 55294613, "body": "Not in vba, as I understand it."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1447288180, "last_edit_date": 1447288180, "creation_date": 1447287462, "answer_id": 33662312, "question_id": 33660848, "link": "https://stackoverflow.com/questions/33660848/is-there-a-way-to-split-contents-of-a-cell-which-has-part-of-its-text-strikenthr/33662312#33662312", "title": "Is there a way to split contents of a cell which has part of its text strikenthrough?", "body": "<p>So I was thinking about how I would do this and I came up with the following function.</p>\n\n<pre><code>Function strkThr(t As Range) As String\nDim i As Long\nDim y As Boolean\nDim temp As String\n\ny = False\ntemp = \"\"\nFor i = 1 To Len(t.Value)\n    If Not t.Characters(i, 1).Font.Strikethrough = y Then\n        temp = temp &amp; \"|\"\n        If y Then\n            y = False\n        Else\n            y = True\n        End If\n    End If\n    If Not y Then\n        temp = temp &amp; Mid(t, i, 1)\n    End If\nNext\n\nstrkThr = temp\nEnd Function\n\n\nSub replace()\nDim cel As Range\nFor Each cel In Range(\"A1:A100\")\n    cel.Value = strkThr(cel)\n    cel.Value = replace(cel.Value, \"||\", YOURVALUE)\nNext cel\nEnd Sub\n</code></pre>\n\n<p>The function replaces each grouping of strike through text with \"||\".  Then in the sub you would replace the \"||\" with the value wanted.</p>\n"}], "owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 590, "favorite_count": 0, "accepted_answer_id": 33662312, "answer_count": 1, "score": 1, "last_activity_date": 1447288180, "creation_date": 1447280009, "last_edit_date": 1495540742, "question_id": 33660848, "link": "https://stackoverflow.com/questions/33660848/is-there-a-way-to-split-contents-of-a-cell-which-has-part-of-its-text-strikenthr", "title": "Is there a way to split contents of a cell which has part of its text strikenthrough?", "body": "<p>I know if I check the strikethrough property of Font like, for example <code>range(\"C1\").Font.Strikethrough</code> I'll have <code>True</code> if all the cell is strikethrough and a <code>False</code> if it's not but checking it in a cell like this:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/dUSII.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dUSII.png\" alt=\"Text part strikenthrough\"></a>\n<br>\n<br>\nThe result of the property is <code>Null</code>.  </p>\n\n<p>Now, knowing this, is there a way to recognize if just part of the content cell is \"strikethrough\" and then parse it so I could replace with other text?  </p>\n\n<p>I know I can check each character (checked out this <a href=\"https://stackoverflow.com/questions/28143643/excel-vba-delete-strikethrough-characters-in-a-cell\">example</a>) if it has the property active but, how could I know which part of the text is strikethrough and then replacing that text with another one?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 3, "creation_date": 1447279818, "post_id": 33660706, "comment_id": 55095120, "body": "It will never work the way you have planned. Look at your ONE CELL example. There is only one border between cells, but your idea assumes that there are two borders between adjacent cells. Since there is only one shared border, the code has to decide what to apply to the common borders, and it defaults to using the TOP and LEFT border settings."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 1, "creation_date": 1447279913, "post_id": 33660706, "comment_id": 55095160, "body": "You could make something like this work if you were open to hiding one column between visibly adjacent cells (and one row as well for the vertical)."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 2, "creation_date": 1447279973, "post_id": 33660706, "comment_id": 55095190, "body": "you are setting all the edges to white. Check your code: when you set to white the <code>top edge</code> of a cell, at the same time you are setting the <code>bottom edge</code> of the cell above it. same goes for left edge and right edge. edges are <b>common</b> between adjacent cells."}, {"owner": {"reputation": 171, "user_id": 5421582, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c83280fde3b4628c537a210ef323b42?s=128&d=identicon&r=PG&f=1", "display_name": "Yong", "link": "https://stackoverflow.com/users/5421582/yong"}, "edited": false, "score": 0, "creation_date": 1447280064, "post_id": 33660706, "comment_id": 55095240, "body": "That&#39;s what I was thinking. I am making a minesweeper. Since,I have known VBA only for a month, adding an extra lines in between would be too much more work for me. lol Thanks Excel Hero!"}, {"owner": {"reputation": 171, "user_id": 5421582, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c83280fde3b4628c537a210ef323b42?s=128&d=identicon&r=PG&f=1", "display_name": "Yong", "link": "https://stackoverflow.com/users/5421582/yong"}, "edited": false, "score": 0, "creation_date": 1447280274, "post_id": 33660706, "comment_id": 55095365, "body": "I agree ASH, but there seems like no other way to give it 3D like feel to a cell if I don&#39;t give it a shave and light. I couldn&#39;t figure out how to have an adjacent border to have two colors... lol Being new to VBA, that was the best I could think of:) Thanks ASH"}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1447337745, "post_id": 33660706, "comment_id": 55119666, "body": "And doing this with buttons is out of the question?"}, {"owner": {"reputation": 171, "user_id": 5421582, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c83280fde3b4628c537a210ef323b42?s=128&d=identicon&r=PG&f=1", "display_name": "Yong", "link": "https://stackoverflow.com/users/5421582/yong"}, "edited": false, "score": 0, "creation_date": 1447704115, "post_id": 33660706, "comment_id": 55255755, "body": "lol,my answer would has to be depend. I would use buttons if that wouldn&#39;t complicate the coding too much for making the minesweeper."}], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1447292132, "post_id": 33660947, "comment_id": 55099445, "body": "That is a nice effect and I&#39;ll upvote it as such, though unfortunately it isn&#39;t quite what OP is looking for."}, {"owner": {"reputation": 171, "user_id": 5421582, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c83280fde3b4628c537a210ef323b42?s=128&d=identicon&r=PG&f=1", "display_name": "Yong", "link": "https://stackoverflow.com/users/5421582/yong"}, "edited": false, "score": 0, "creation_date": 1447301778, "post_id": 33660947, "comment_id": 55102062, "body": "Thank you very much for taking your time to come up with this code. It isn&#39;t exactly what I was going for but the result looks very pretty. Thank you:)"}], "tags": [], "owner": {"reputation": 595, "user_id": 1237786, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f88fc95f445f0659730a2ad63c45f16a?s=128&d=identicon&r=PG", "display_name": "anefeletos", "link": "https://stackoverflow.com/users/1237786/anefeletos"}, "is_accepted": false, "score": 2, "last_activity_date": 1447337299, "last_edit_date": 1447337299, "creation_date": 1447280439, "answer_id": 33660947, "question_id": 33660706, "link": "https://stackoverflow.com/questions/33660706/make-cells-look-like-buttons/33660947#33660947", "title": "Make cells look like buttons", "body": "<pre><code>For Each mycell In Range(BoardSize)\nisblack = mycell.Row Mod 2 = 0 Xor mycell.Column Mod 2 = 0\n    With mycell\n        .Borders.LineStyle = xlContinuous\n        .Borders.Weight = xlThick\n        .Borders.Color = RGB(110, 110, 110)\n        .Interior.Color = RGB(180, 180, 180)\n    End With\nIf Not isblack Then\n        mycell.Borders(xlEdgeTop).Color = RGB(255, 255, 255)\n        mycell.Borders(xlEdgeLeft).Color = RGB(255, 255, 255)\nEnd If\nNext mycell\n</code></pre>\n\n<p>Another version with a minor artifact. It skipps odd rows and odd columns</p>\n\n<pre><code> Dim mycell As Range\nFor Each mycell In  Range(BoardSize)\nevenrow = mycell.Row Mod 2 = 0\nevencol = mycell.Column Mod 2 = 0\nisblack = evenrow Xor evencol\n    With mycell\n        .Borders.LineStyle = xlContinuous\n        .Borders.Weight = xlThick\n        .Borders.Color = RGB(110, 110, 110)\n        .Interior.Color = RGB(180, 180, 180)\n    End With\nIf Not isblack Then\n        mycell.Borders(xlEdgeTop).Color = RGB(255, 255, 255)\n        mycell.Borders(xlEdgeLeft).Color = RGB(255, 255, 255)\nEnd If\nIf evenrow Or evencol Then mycell.Borders.Color = RGB(180, 180, 180)\nIf evencol And mycell.ColumnWidth &lt;&gt; 0.1 Then mycell.ColumnWidth = 0.1 Else mycell.ColumnWidth = 5\nIf evenrow And mycell.RowHeight &lt;&gt; 1 Then mycell.RowHeight = 1 Else mycell.RowHeight = 30\nNext mycell\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 5421582, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c83280fde3b4628c537a210ef323b42?s=128&d=identicon&r=PG&f=1", "display_name": "Yong", "link": "https://stackoverflow.com/users/5421582/yong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1451, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1447337299, "creation_date": 1447279356, "last_edit_date": 1447287831, "question_id": 33660706, "link": "https://stackoverflow.com/questions/33660706/make-cells-look-like-buttons", "title": "Make cells look like buttons", "body": "<p>I am trying to make Excel cells look like buttons without actually inserting buttons.</p>\n\n<pre><code>For Each myCell In Range(BoardSize)\n    With myCell\n        .Borders.LineStyle = xlContinuous\n        .Borders.Weight = xlThick\n        .Borders.Color = RGB(110, 110, 110)\n        .Interior.Color = RGB(180, 180, 180)\n    End With\n\n        myCell.Borders(xlEdgeTop).Color = RGB(255, 255, 255)\n        myCell.Borders(xlEdgeLeft).Color = RGB(255, 255, 255)\nNext myCell\n</code></pre>\n\n<p>It works for one cell:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/wTgjs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wTgjs.png\" alt=\"enter image description here\"></a></p>\n\n<p>but in a large range it looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/u0Nxu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u0Nxu.png\" alt=\"enter image description here\"></a> </p>\n\n<p>What I want is something, without using actual command buttons, like:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/n8S1P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n8S1P.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1447279517, "post_id": 33660469, "comment_id": 55094997, "body": "You did not forget to <code>End If</code> I suppose. Is the field <code>Country</code> set to <code>required</code> in the table design?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447282661, "post_id": 33660469, "comment_id": 55096497, "body": "I don&#39;t think your code has anything to do with the error. From where is this code called?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1447282767, "post_id": 33660469, "comment_id": 55096531, "body": "<i>&quot;syntax error (missing operator) in table-level validation expression.&quot;</i> means: Open your table in design mode, open the property sheet, and check the table ValidationRule."}, {"owner": {"reputation": 109, "user_id": 1152974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abWkv.jpg?s=128&g=1", "display_name": "BryceH", "link": "https://stackoverflow.com/users/1152974/bryceh"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447283622, "post_id": 33660469, "comment_id": 55096881, "body": "@A.S.H no, I forgot to add that in the example - It is there in the actual VBA string, though; edited my original message to reflect this. Thanks... Also, I no longer have it in front of me will have to check in the AM. Will report back then."}, {"owner": {"reputation": 109, "user_id": 1152974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abWkv.jpg?s=128&g=1", "display_name": "BryceH", "link": "https://stackoverflow.com/users/1152974/bryceh"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447283790, "post_id": 33660469, "comment_id": 55096955, "body": "What do you mean &quot;From where is this code called&quot; @Andre451? The data is entered on the Form, the data is actually stored in the Table, they have a dependency link, and I am opening the VBA Prompt from the Table design view."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447284407, "post_id": 33660469, "comment_id": 55097177, "body": "Hmm. What VBA Prompt? (What exactly do you do to open this?) What Access version do you use?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1447284411, "post_id": 33660469, "comment_id": 55097179, "body": "Ok, but just in case, if you find that the field <code>Country</code> is <code>required</code> (check that in the Design View of the table), then probably changing <code>[County] = &quot;&quot;</code> into <code>[County] = &quot;unspecified&quot;</code> might fix it. Good luck :)"}, {"owner": {"reputation": 109, "user_id": 1152974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abWkv.jpg?s=128&g=1", "display_name": "BryceH", "link": "https://stackoverflow.com/users/1152974/bryceh"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447284666, "post_id": 33660469, "comment_id": 55097260, "body": "@Andre451 when in table view it is alt+F11 (maybe just F11?). And I use MS Access 2010 on a Windows 7 PC at work (where this is taking place)."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 3, "creation_date": 1447290117, "post_id": 33660469, "comment_id": 55098900, "body": "You would be much better off with a look-up table of zip and county."}, {"owner": {"reputation": 109, "user_id": 1152974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abWkv.jpg?s=128&g=1", "display_name": "BryceH", "link": "https://stackoverflow.com/users/1152974/bryceh"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1447300726, "post_id": 33660469, "comment_id": 55101790, "body": "@Fionnuala That looks like it might work as well. I will give that a shot if the other solutions for the If/Then/Else statements do not fix my issue. Thanks!"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1447301698, "post_id": 33660469, "comment_id": 55102042, "body": "The <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg278665.aspx\" rel=\"nofollow noreferrer\">Select Case statement</a> might be simpler to maintain than &quot;If/ElseIf/Else&quot;"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447325061, "post_id": 33660469, "comment_id": 55112100, "body": "I have to ask again: where does this code &quot;live&quot;? It must be inside a Sub or Function - please post the full sub/function. Or perhaps post a screenshot."}], "answers": [{"tags": [], "owner": {"reputation": 583, "user_id": 2286964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca11e109f5f3e0877a0ab858f33c3d4c?s=128&d=identicon&r=PG", "display_name": "Alan Waage", "link": "https://stackoverflow.com/users/2286964/alan-waage"}, "is_accepted": false, "score": 0, "last_activity_date": 1447876015, "creation_date": 1447876015, "answer_id": 33789016, "question_id": 33660469, "link": "https://stackoverflow.com/questions/33660469/how-do-i-insert-a-vba-if-else-if-else-statement-into-ms-access-table/33789016#33789016", "title": "How do I insert a VBA If/Else If/Else statement into MS Access Table?", "body": "<p>To use If/Then/Else logic in a query, use the IIF function.  Links:<a href=\"https://msdn.microsoft.com/en-us/library/office/gg241307%28v=office.14%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/gg241307%28v=office.14%29.aspx</a>\n<a href=\"http://www.techonthenet.com/access/functions/advanced/iif.php\" rel=\"nofollow\">http://www.techonthenet.com/access/functions/advanced/iif.php</a></p>\n\n<p>So something like:\nCountry: iif([ZipCode]=\"12345\",\"North\",\"\")</p>\n\n<p>And you can nest iif() statements.</p>\n\n<p>You could also create a VBA function and call it from the query.  So something close to what you have in your question, then in the query do:\nCountry: MyFunction([ZipCode])</p>\n"}], "owner": {"reputation": 109, "user_id": 1152974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abWkv.jpg?s=128&g=1", "display_name": "BryceH", "link": "https://stackoverflow.com/users/1152974/bryceh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1571, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1601711249, "creation_date": 1447278513, "last_edit_date": 1601711249, "question_id": 33660469, "link": "https://stackoverflow.com/questions/33660469/how-do-i-insert-a-vba-if-else-if-else-statement-into-ms-access-table", "title": "How do I insert a VBA If/Else If/Else statement into MS Access Table?", "body": "<p>I am the most &quot;computer savvy&quot; person at my job. I know very little about Access and will need an explanation of this in layman's terms. Appologies.</p>\n<p>SO... We have a form that data is entered on with the corresponding Table where the data is stored. We go to different places and do screenings with paper which require us to manually enter the data electronically. For the new year, they want us to enter the County for each of the persons we screen. The problem becomes, we don't know ALL of the area codes that make up the counties we visit regularly. My goal was to make an If/ElseIf/Else statements so when we type in the Zip Code - the county auto populates in the county field.</p>\n<p>I included &quot;Else&quot; because there are Zip Codes less commonly visited, I'm just trying to save as much time as possible. I chose not to do Nested If/Then statements so I didn't have to keep track of 100+ &quot;)&quot; for closing out my arguments.</p>\n<p>I've tried <a href=\"http://www.techonthenet.com/access/functions/advanced/if_then.php\" rel=\"nofollow noreferrer\" title=\"following this syntax\">the syntax here for If/ElseIf/Else</a>; but, I keep getting &quot;syntax error (missing operator) in table-level validation expression.&quot; I don't know how to trouble shoot what I am doing incorrectly.</p>\n<pre><code>If [Zip Code] =&quot;XXXXX&quot; Then\n   [County] = &quot;North&quot;\n\nElseIf [Zip Code] = &quot;YYYYY&quot; Then\n   [County] = &quot;South&quot;\n   \nElseIf [Zip Code] = &quot;ZZZZZ&quot; Then\n   [County] = &quot;East&quot;\n   \nElse\n   [County] = &quot;&quot;\n\nEnd If\n</code></pre>\n<p>From the &quot;Else&quot; part - I just don't want it to populate. I thought placing nothing here would just leave it blank. I am trying to do this from the Table, not the Form. The table title for the zip code field is &quot;Zip Code&quot; and the title of the county field is &quot;County.&quot;</p>\n<p>There are two drop down boxes at the top of the VBA script screen. One says &quot;General&quot; one says &quot;Description.&quot; When I select &quot;General,&quot; It populates a list of all the Title Fields in the table. I've tried selecting &quot;Zip Code&quot; which gives me options like &quot;BeforeUpdate&quot; or &quot;AfterUpdate&quot; where description was.</p>\n<p>This is all I can think of between telling you: what I want, what I'm trying to do, and what I think is relevant information. I will gladly give you more information if there is something I don't realize is important.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1447274280, "post_id": 33659301, "comment_id": 55092366, "body": "What is it doing and what should it be doing?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 7, "creation_date": 1447274639, "post_id": 33659301, "comment_id": 55092544, "body": "Range(&quot;A7:D7&quot; &amp; (last_row * 2))  I don&#39;t think you need D7, just D?"}, {"owner": {"reputation": 11, "user_id": 5552167, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TQgPgHATuN4/AAAAAAAAAAI/AAAAAAAAABE/zdH5-awiGD4/photo.jpg?sz=128", "display_name": "Raymond Khoo", "link": "https://stackoverflow.com/users/5552167/raymond-khoo"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1447435163, "post_id": 33659301, "comment_id": 55168371, "body": "@MatthewD: it should be doing is comparison within 4 columns and show difference in description in output and if there is no edit number on File2 Skip a line in output. What it is doing is if I remove one of the edit num on File 2 it did not skip and show weird result."}, {"owner": {"reputation": 11, "user_id": 5552167, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TQgPgHATuN4/AAAAAAAAAAI/AAAAAAAAABE/zdH5-awiGD4/photo.jpg?sz=128", "display_name": "Raymond Khoo", "link": "https://stackoverflow.com/users/5552167/raymond-khoo"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1447435231, "post_id": 33659301, "comment_id": 55168408, "body": "@Nathan_Sav: The program does not run if I change D7 to D"}, {"owner": {"reputation": 11, "user_id": 5552167, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TQgPgHATuN4/AAAAAAAAAAI/AAAAAAAAABE/zdH5-awiGD4/photo.jpg?sz=128", "display_name": "Raymond Khoo", "link": "https://stackoverflow.com/users/5552167/raymond-khoo"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1447435264, "post_id": 33659301, "comment_id": 55168431, "body": "@pnuts: Can you be more abbreviate?"}], "owner": {"reputation": 11, "user_id": 5552167, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TQgPgHATuN4/AAAAAAAAAAI/AAAAAAAAABE/zdH5-awiGD4/photo.jpg?sz=128", "display_name": "Raymond Khoo", "link": "https://stackoverflow.com/users/5552167/raymond-khoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1447274312, "creation_date": 1447273947, "last_edit_date": 1447274312, "question_id": 33659301, "link": "https://stackoverflow.com/questions/33659301/what-is-wrong-in-my-macro-code", "title": "What is wrong in my macro code?", "body": "<p>I tried to write comparison in Excel macro for my work. Somehow, it is working not in the way I wanted the output. What I want is to compare the two columns and show the differences between them. If empty field on one column, the program should skip a line. Here is my code: </p>\n\n<pre><code>Sub run_compare_main()\n\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n\n    Dim last_row As Integer\n    Dim input_array As Variant\n    Dim output_aray() As String\n    Dim a_counter As Integer\n    Dim b_counter As Integer\n\n    last_row = get_last_row(\"INPUT\", \"A\")\n\n    ReDim output_array(1 To (last_row * 2), 1 To 5) '(last_row * 2)\n\n    input_array = Range(\"A7:D7\" &amp; (last_row * 2)).Value2\n\n    a_counter = 1\n    b_counter = 1\n\n    For i = 1 To (last_row * 2)\n\n        If input_array(a_counter, 1) = input_array(b_counter, 3) Then\n\n            output_array(i, 1) = input_array(a_counter, 1)\n            output_array(i, 2) = input_array(a_counter, 2)\n            output_array(i, 3) = input_array(b_counter, 3)\n            output_array(i, 4) = input_array(b_counter, 4)\n\n            a_counter = a_counter + 1\n            b_counter = b_counter + 1\n\n\n        ElseIf input_array(a_counter, 1) = input_array(a_counter - 1, 1) Then\n\n            output_array(i, 1) = input_array(a_counter, 1)\n            output_array(i, 2) = input_array(a_counter, 2)\n\n            a_counter = a_counter + 1\n\n\n        ElseIf input_array(b_counter, 3) = input_array(b_counter - 1, 3) Then\n\n            output_array(i, 3) = input_array(b_counter, 3)\n            output_array(i, 4) = input_array(b_counter, 4)\n\n            b_counter = b_counter + 1\n\n        End If\n        'find smaller value\n        If input_array(a_counter, 1) &lt; input_array(b_counter, 3) Or input_array(b_counter, 1) = \"\" Then\n\n                output_array(i, 1) = input_array(a_counter, 1)\n                output_array(i, 2) = input_array(a_counter, 2)\n                a_counter = a_counter + 1\n\n            Else\n\n                output_array(i, 3) = input_array(b_counter, 3)\n                output_array(i, 4) = input_array(b_counter, 2)\n                b_counter = b_counter + 1\n\n\n        End If\n\n        If a_counter = last_row - 5 Or b_counter = last_row - 5 Then\n\n            Exit For\n\n        End If\n\n    Next\n\n    Call newtab(\"OUTPUT\")\n\n    Range(\"A7\").Resize(last_row, 4).Value = output_array\n\n    Sheets(\"INPUT\").Range(\"A5:D6\").Copy\n    Sheets(\"OUTPUT\").Range(\"A5\").Select\n    ActiveSheet.Paste\n    Columns(\"B:B\").ColumnWidth = 80\n    Columns(\"D:D\").ColumnWidth = 80\n\n\n    Dim LastCol As Long\n    Dim LastRow As Long\n\n  LastCol = ActiveSheet.UsedRange.Columns.Count\n  LastRow = ActiveSheet.UsedRange.Rows.Count\n\n  FilePath = \"D:\\Try\\support.txt\"\n  Open FilePath For Output As #2\n\n  CellData = \"\"\n  For i = 1 To LastRow\n      For j = 1 To LastCol\n      CellData = \"The Value at location (\" &amp; i &amp; \",\" &amp; j &amp; \") \" &amp; Trim(ActiveCell(i, j).Value)\n      Write #2, CellData\n      Next j\n  Next i\n\n  Close #2\n  MsgBox (\"Job Done\")\n\nEnd Sub\n\nSub newtab(sheetname As String)\n\n    Application.DisplayAlerts = False\n    On Error Resume Next\n    Sheets(sheetname).Delete\n    Application.DisplayAlerts = True\n\n    Sheets.Add After:=Sheets(Sheets.Count)\n    Sheets(Sheets.Count).Activate\n    Sheets(Sheets.Count).Name = sheetname\n\nEnd Sub\n\nFunction get_last_row(ByVal sheetname As String, column As String) As Integer\n\n    With Sheets(sheetname)\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            LastRow = .Cells.Find(What:=\"*\", _\n                  After:=.Range(column &amp; \"1\"), _\n                  Lookat:=xlPart, _\n                  LookIn:=xlFormulas, _\n                  SearchOrder:=xlByRows, _\n                  SearchDirection:=xlPrevious, _\n                  MatchCase:=False).Row\n        End If\n    End With\n\n    get_last_row = LastRow\n\nEnd Function\n</code></pre>\n\n<p>and here my  <a href=\"https://i.stack.imgur.com/WmLUj.png\" rel=\"nofollow noreferrer\">worksample</a>:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/WmLUj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WmLUj.png\" alt=\"worksample\"></a></p>\n"}, {"tags": ["vba", "excel", "filter"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447275263, "post_id": 33659144, "comment_id": 55092864, "body": "Is your data already sorted by the invoice number?"}, {"owner": {"reputation": 107, "user_id": 5239589, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1407a9551cbada1acfadb64fb1098fbe?s=128&d=identicon&r=PG&f=1", "display_name": "MCJNY1992", "link": "https://stackoverflow.com/users/5239589/mcjny1992"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447275435, "post_id": 33659144, "comment_id": 55092946, "body": "Yeah the corresponding invoices are all in a row."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1447275550, "post_id": 33659144, "comment_id": 55092999, "body": "And there is always one blank line before the change of the invoice nb, as in the figures, right?"}, {"owner": {"reputation": 107, "user_id": 5239589, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1407a9551cbada1acfadb64fb1098fbe?s=128&d=identicon&r=PG&f=1", "display_name": "MCJNY1992", "link": "https://stackoverflow.com/users/5239589/mcjny1992"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447276026, "post_id": 33659144, "comment_id": 55093243, "body": "No there&#39;s no blank lines, each row directly below is a invocie and detail combination.  I&#39;ll post above what I came up with."}, {"owner": {"reputation": 107, "user_id": 5239589, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1407a9551cbada1acfadb64fb1098fbe?s=128&d=identicon&r=PG&f=1", "display_name": "MCJNY1992", "link": "https://stackoverflow.com/users/5239589/mcjny1992"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447276303, "post_id": 33659144, "comment_id": 55093398, "body": "I don&#39;t know how to upload what my excel looks like via Jpeg the image upload isn&#39;t working well"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447277903, "post_id": 33659144, "comment_id": 55094209, "body": "Sorry I could not check your last code because I was testing my answer. Please tell me if it works for you."}, {"owner": {"reputation": 107, "user_id": 5239589, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1407a9551cbada1acfadb64fb1098fbe?s=128&d=identicon&r=PG&f=1", "display_name": "MCJNY1992", "link": "https://stackoverflow.com/users/5239589/mcjny1992"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447296625, "post_id": 33659144, "comment_id": 55100662, "body": "Ok I will. I&#39;ll be able to test it in the morning, thank you I appreciate the time and effort. I&#39;ll let you know how it works out."}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 5239589, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1407a9551cbada1acfadb64fb1098fbe?s=128&d=identicon&r=PG&f=1", "display_name": "MCJNY1992", "link": "https://stackoverflow.com/users/5239589/mcjny1992"}, "edited": false, "score": 0, "creation_date": 1447330455, "post_id": 33660207, "comment_id": 55115053, "body": "It seemed to have worked great man!  Thank you so much.  I&#39;m not overly versed in VBA could you explain what your Do Until and your Do Whiles are doing in your code?  So in the future I might be able to write something like this for myself."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 107, "user_id": 5239589, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1407a9551cbada1acfadb64fb1098fbe?s=128&d=identicon&r=PG&f=1", "display_name": "MCJNY1992", "link": "https://stackoverflow.com/users/5239589/mcjny1992"}, "edited": false, "score": 0, "creation_date": 1447334051, "post_id": 33660207, "comment_id": 55117218, "body": "@MCJNY1992 Glad it helped. Briefly, the <code>Do Until</code> loop (which is equivale to <code>Do While Not</code>) will span the range until last row. The inner loop will span a subrange elonging the the same invoice, as long as the invoice identifier is the same, move the details on the same row. This continues until a new invoice identifier is found."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1447278077, "last_edit_date": 1447278077, "creation_date": 1447277404, "answer_id": 33660207, "question_id": 33659144, "link": "https://stackoverflow.com/questions/33659144/copying-data-for-like-values/33660207#33660207", "title": "Copying data for like values", "body": "<p>Try this macro. It creates a new sheet which groups the invoices by row.\nIt supposes that the data is in sheets(\"Invoice\") columns A and B, starting at the second row. Please adjust these parameters to your won case.</p>\n\n<pre><code>Sub CreateGroupedInvoiceSheet()\n    Application.screenUpdating = False\n    Dim src As Range: Set src = Sheets(\"Invoice\").Range(\"A2\")\n    Dim dest As Range: Set dest = Sheets.Add.Range(\"A2\")\n    Dim lastR As Long: lastR = Sheets(\"Invoice\").Range(\"A\" &amp; Rows.count).End(xlUp).Row\n    Dim curInvoice As Variant\n\n    Do Until src.Row &gt; lastR\n        curInvoice = src.Value\n        src.Resize(1, 2).Copy dest\n        Set dest = dest.Offset(0, 2)\n        Set src = src.Offset(1, 0)\n        Do While src.Value = curInvoice\n            dest.Value = src.Offset(0, 1).Value\n            Set dest = dest.Offset(0, 1)\n            Set src = src.Offset(1, 0)\n         Loop\n         Set dest = dest.Offset(1, 0).End(xlToLeft)\n    Loop\n    Application.screenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 5239589, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1407a9551cbada1acfadb64fb1098fbe?s=128&d=identicon&r=PG&f=1", "display_name": "MCJNY1992", "link": "https://stackoverflow.com/users/5239589/mcjny1992"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 33660207, "answer_count": 1, "score": 1, "last_activity_date": 1447278723, "creation_date": 1447273387, "last_edit_date": 1447278723, "question_id": 33659144, "link": "https://stackoverflow.com/questions/33659144/copying-data-for-like-values", "title": "Copying data for like values", "body": "<p>I have a spreadsheet which contains invoice numbers and detail numbers. The detail numbers point to the line on the invoice where the information resides.  There can be multiple invoices on one spreadsheet, however and unfortunately, only one invoice and detail combination goes on a single line. So row 1 on my spreadsheet will contain a single invoice in column A and a detail in column B, then the next invoice starts on row 2. My problem is I want to create a program that will find any duplicate invoices and copy and paste the associated detail numbers to a single line so that I will end up with:</p>\n\n<pre><code>InvoiceA. Detail1. Detail2. Detail3. Etc\nInvoiceB. Detail1. Detail2. Etc\n</code></pre>\n\n<p>As opposed to:</p>\n\n<pre><code>InvoiceA. Detail\nInvoiceA. Detail\nInvoiceB. Detail\nInvoiceB. Detail\n</code></pre>\n\n<p>I have thought of going through each cell using a macro with advanced filters by invoice - count the visible rows and copy the details into the designated spots on the spreadsheet, then delete out the extra invoice numbers with only one detail number. However, this seems inefficient.</p>\n\n<p>Here's what I cam up with so far</p>\n\n<pre><code>Sub detail()\n   Dim wb As Workbook, ws As Worksheet\n   Dim dtl1 As Range, dtl2 As Range, dtl3 As Range, dtl4 As Range, dtl5 As Range, dtl6 As Range\n\n   Set wb = ThisWorkbook\n   Set ws = wb.Sheets(\"Sheet1\")\n   lastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n   Set inv = ws.Range(\"D2:D\" &amp; lastRow)\n   Set dtl1 = ws.Range(\"E2:E\" &amp; lastRow)\n  '\n  'ws.Range(\"E:I\").EntireColumn.Insert\n  'With ws\n     '.Range(\"E1\").Value = \"Detail 2\"\n     '.Range(\"F1\").Value = \"Detail 3\"\n     '.Range(\"G1\").Value = \"Detail 4\"\n     '.Range(\"H1\").Value = \"Detail 5\"\n     '.Range(\"I1\").Value = \"Detail 6\"\n  'End With\n\n   For i = 1 To ws.Rows.Count\n      If inv.Cells(i, 1).Value = \"\" Then\n         Exit Sub\n      End If\n      If inv.Cells(i, 1) = inv.Cells(i, 1).Offset(-1, 0) And dtl1.Cells(i, 1).Offset(-1, 1) = \"\" Then\n         dtl1.Cells(i, 1).Copy\n         dtl1.Cells(i, 1).Offset(-1, 1).PasteSpecial\n         If inv.Cells(i, 1) = inv.Cells(i, 1).Offset(-2, 0) And dtl1.Cells(i, 1).Offset(-2, 2) = \"\" Then\n           dtl1.Cells(i, 1).Copy\n           dtl1.Cells(i, 1).Offset(-2, 2).PasteSpecial\n           If inv.Cells(i, 1) = inv.Cells(i, 1).Offset(-3, 0) And dtl1.Cells(i, 1).Offset(-3, 3) = \"\" Then\n              dtl1.Cells(i, 1).Copy\n              dtl1.Cells(i, 1).Offset(-3, 3).PasteSpecial\n              If inv.Cells(i, 1) = inv.Cells(i, 1).Offset(-4, 0) And dtl1.Cells(i, 1).Offset(-4, 4) = \"\" Then\n                 dtl1.Cells(i, 1).Copy\n                 dtl1.Cells(i, 1).Offset(-4, 4).PasteSpecial\n                 If inv.Cells(i, 1) = inv.Cells(i, 1).Offset(-5, 0) And dtl1.Cells(i, 1).Offset(-5, 5) = \"\" Then\n                    dtl1.Cells(i, 1).Copy\n                    dtl1.Cells(i, 1).Offset(-5, 5).PasteSpecial\n                    If inv.Cells(i, 1) = inv.Cells(i, 1).Offset(-6, 0) And dtl1.Cells(i, 1).Offset(-6, 6) = \"\" Then\n                       dtl1.Cells(i, 1).Copy\n                       dtl1.Cells(i, 1).Offset(-6, 6).PasteSpecial\n                    End If\n                 End If\n              End If\n           End If\n        End If\n     End If\n  Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 605, "user_id": 4038135, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1a466feb6dbb26026d38b95c44d8a1b2?s=128&d=identicon&r=PG&f=1", "display_name": "KingOfTheNerds", "link": "https://stackoverflow.com/users/4038135/kingofthenerds"}, "edited": false, "score": 0, "creation_date": 1447276161, "post_id": 33659029, "comment_id": 55093321, "body": "Since you&#39;re using Excel 2010, you may also want to check out the PowerQuery add-in if you have to do these sorts of manipulations often. It enables you to do these sorts of transformations without code. <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=39379\" rel=\"nofollow noreferrer\">microsoft.com/en-us/download/details.aspx?id=39379</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "is_accepted": false, "score": 1, "last_activity_date": 1447278144, "last_edit_date": 1447278144, "creation_date": 1447275511, "answer_id": 33659704, "question_id": 33659029, "link": "https://stackoverflow.com/questions/33659029/move-rows-of-data-to-columns-then-delete-the-rows/33659704#33659704", "title": "Move rows of data to columns, then delete the rows", "body": "<p>Strange that this was not answered yet. :)</p>\n\n<p>All you need is to put your logic into a loop, I prefer using <code>Do..While...loop</code>, so here we go:</p>\n\n<pre><code>Sub Move_Rows()\n'\n' Move_Rows Macro\n' Moves cemetery row data for each grave into separate columns\n'\n' Keyboard Shortcut: Ctrl+q\n'\n    Application.ScreenUpdating = False\n\n    i = 111 'Initial row number\n    Do While Cells(i, \"A\") &lt;&gt; \"\"\n        Range(Cells(i, \"A\"), Cells(i+4, \"A\")).Select\n        Selection.Copy\n        Cells(i-1, \"B\").Select\n        Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n            False, Transpose:=True\n        Range(Cells(i, \"A\"), Cells(i+4, \"A\")).Select\n        Application.CutCopyMode = False\n        Selection.Delete Shift:=xlUp\n        i = i + 1\n    loop\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Have a good luck with that!</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 5551943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/758fc61e7dc6f7ce2bb78c8fe2147e9d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5551943/michael"}, "edited": false, "score": 0, "creation_date": 1447356231, "post_id": 33668179, "comment_id": 55132299, "body": "Thanks for the help. The Do..While...Loop worked with a bit of clean-up.  The &quot;longer&quot; macro that was not tested has a bug with &quot;rowRng.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:=False, Transpose:=True&quot;.  I will do som efurther investigation on it, but the &quot;shorter&quot; macro worked fine!"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 11, "user_id": 5551943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/758fc61e7dc6f7ce2bb78c8fe2147e9d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5551943/michael"}, "edited": false, "score": 0, "creation_date": 1447414734, "post_id": 33668179, "comment_id": 55155338, "body": "Oops! I renamed a variable and apparently missed one instance. Change <code>rowRng</code> to <code>rRng</code> and it will work."}], "tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": false, "score": 0, "last_activity_date": 1447414821, "last_edit_date": 1447414821, "creation_date": 1447320658, "answer_id": 33668179, "question_id": 33659029, "link": "https://stackoverflow.com/questions/33659029/move-rows-of-data-to-columns-then-delete-the-rows/33668179#33668179", "title": "Move rows of data to columns, then delete the rows", "body": "<p>Here's one that you should be able to run however many times you want, even if you add new data. I haven't tested it, so proceed with caution.</p>\n\n<pre><code>Sub Move_Rows()\n    Dim ws As Worksheet\n    Dim rRng As Range ' keep track of where we're gonna paste the results\n    Dim sRng As Range, eRng As Range ' start-range, end-range\n\n    Set ws = ThisWorkbook.Worksheets(1) ' &lt;~~ Change to whatever you need\n\n    For i = 1 To ws.UsedRange.Rows.Count\n        ' Is this row valid as start of a range? If the cell in col B is populated, this means the current row is already correctly \"formatted\" and we need to skip it.\n        If (ws.Range(\"B\" &amp; i).Value = \"\") And (sRng Is Nothing) Then\n            Set rRng = ws.Range(\"B\" &amp; i)\n            Set sRng = ws.Range(\"A\" &amp; i).Offset(1, 0) ' start-range set to the row below, we don't need to transpose the name.\n        End If\n\n        ' Is this row valid as end of a range? If the cell in col A is empty, the previous range will be the end of the area we want to copy.\n        If ws.Range(\"A\" &amp; i).Value = \"\" Then\n            Set eRng = ws.Range(\"A\" &amp; i).Offset(-1, 0) ' end-range set to the row above, we don't want to transpose the empty cell.\n\n            ' The row was empty and we've set the reference to the content above. Now we can delete the empty row.\n            ws.Range(\"A\" &amp; i).EntireRow.Delete\n        End If\n\n        If (Not sRng Is Nothing) And (Not eRng Is Nothing) Then ' You can also move this inside the previous If-loop. I prefer having it outside for readability.\n            ' We have both a start-range and an end-range, we should do the copy-paste now\n            Range(sRng, eRng).Copy\n            rRng.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:=False, Transpose:=True\n\n            ' Delete the now-superfluous rows\n            Range(sRng, eRng).EntireRow.Delete\n\n            ' Empty the range variables so we don't get wrong matches next iteration.\n            Set rRng = Nothing\n            Set sRng = Nothing\n            Set eRng = Nothing\n        Else\n            ' One of the ranges are empty, so we'll do nothing. You can remove this line and the Else.\n        End If\n    ' Go to the next row\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5551943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/758fc61e7dc6f7ce2bb78c8fe2147e9d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5551943/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1049, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1580141147, "creation_date": 1447272839, "last_edit_date": 1531161705, "question_id": 33659029, "link": "https://stackoverflow.com/questions/33659029/move-rows-of-data-to-columns-then-delete-the-rows", "title": "Move rows of data to columns, then delete the rows", "body": "<p>I have thousands of rows of data as shown in the Excel Sample #1 below. All data is currently in Column A. Each \"Group\" of data has six lines: name, dates, city, county, state and a blank line.  I need to move the data under each Name in Column A into Columns B through E as shown in Rows 1 and 2. I need to then delete the five rows below each name to bring the cells up so that the final output would look like the data currently in Rows 1 and 2. </p>\n\n<pre><code>EXCEL SAMPLE #1-\n     A        B      C      D      E\n 1 Name1    Dates1 City1 County1 State1\n 2 Name2    Dates2 City2 County2 State2 \n 3 Name3\n 4 Dates3\n 5 City3\n 6 County3\n 7 State3\n 8 &lt;blank row&gt;\n 9 Name4\n10 Dates4\n11 City4\n12 County4\n13 State4\n14 &lt;blank row&gt;\n</code></pre>\n\n<p>Here is the Excel 2010 macro I created to move the data. The problem is that I cannot figure out how to change the \u201cranges\u201d so that it picks up the next Group of data. My formula only works on the data in the ranges specified in the macro.</p>\n\n<pre><code>Sub Move_Rows()\n'\n' Move_Rows Macro\n' Moves cemetery row data for each grave into separate columns\n'\n' Keyboard Shortcut: Ctrl+q\n'\n    Range(\"A111:A115\").Select\n    Selection.Copy\n    Range(\"B110\").Select\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n    Range(\"A111:A115\").Select\n    Application.CutCopyMode = False\n    Selection.Delete Shift:=xlUp\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "record-count", "vba"], "comments": [{"owner": {"reputation": 803, "user_id": 4186108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/170ff81c1ed126d7c00aa6aea33fa3bb?s=128&d=identicon&r=PG&f=1", "display_name": "cboden", "link": "https://stackoverflow.com/users/4186108/cboden"}, "edited": false, "score": 0, "creation_date": 1447268430, "post_id": 33657867, "comment_id": 55089192, "body": "Try rs.MoveLast before you call rs.RecordCount"}, {"owner": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "reply_to_user": {"reputation": 803, "user_id": 4186108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/170ff81c1ed126d7c00aa6aea33fa3bb?s=128&d=identicon&r=PG&f=1", "display_name": "cboden", "link": "https://stackoverflow.com/users/4186108/cboden"}, "edited": false, "score": 0, "creation_date": 1447268672, "post_id": 33657867, "comment_id": 55089328, "body": "Hi @cboden, I get a &#39;rowset does not support fetching backwards&#39; error"}, {"owner": {"reputation": 803, "user_id": 4186108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/170ff81c1ed126d7c00aa6aea33fa3bb?s=128&d=identicon&r=PG&f=1", "display_name": "cboden", "link": "https://stackoverflow.com/users/4186108/cboden"}, "edited": false, "score": 0, "creation_date": 1447269016, "post_id": 33657867, "comment_id": 55089495, "body": "then use adOpenStatic (3) or adOpenKeyset (1) as third parameter when calling the rs.open method. If you have a reference to ADODB set in your project then you can use the named values ... if not simply use the numeric values in brackets or define a const for it."}], "answers": [{"comments": [{"owner": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "edited": false, "score": 0, "creation_date": 1447268834, "post_id": 33657963, "comment_id": 55089402, "body": "Hi , I get a &#39;rowset does not support fetching backwards&#39; error when i use rs.Movelast"}, {"owner": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "reply_to_user": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "edited": false, "score": 0, "creation_date": 1447269084, "post_id": 33657963, "comment_id": 55089530, "body": "Are you sure, that there is data? Check rs.EOF and rs.BOF. If both are TRUE than the recordset is empty..."}, {"owner": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "edited": false, "score": 0, "creation_date": 1447269336, "post_id": 33657963, "comment_id": 55089683, "body": "Hi, there definitely is data. I&#39;m familiar with rs.EOF and rs.BOF however I want to determine the total count rather than whether it&#39;s empty. So in future instances i can end the code when there is a count &gt;= 1048576"}, {"owner": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "reply_to_user": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "edited": false, "score": 0, "creation_date": 1447269747, "post_id": 33657963, "comment_id": 55089932, "body": "@Krishn You could - just to see what happens  - do a <code>while not .EOF</code> loop with a <code>.MoveNext</code> as the only statement. I did a lot with Recordsets and never had a problem to retrieve their row count - if there were rows... That&#39;s why I asked..."}], "tags": [], "owner": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "is_accepted": false, "score": 1, "last_activity_date": 1447268711, "creation_date": 1447268711, "answer_id": 33657963, "question_id": 33657867, "link": "https://stackoverflow.com/questions/33657867/recordcount-returns-value-of-1/33657963#33657963", "title": "Recordcount returns value of -1", "body": "<p>The ADO Recordsets will <strong>ever</strong> show this, until they've jumped to the end the first time. So just use rs.Movelast, then rs.MoveFirst.</p>\n\n<p>Now it should be OK...</p>\n\n<p>Hope this helps</p>\n"}, {"comments": [{"owner": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "edited": false, "score": 0, "creation_date": 1447321802, "post_id": 33659405, "comment_id": 55109958, "body": "Hi Krishn, you should mark your answer as accepted (check below the vote counter) to make clear, that this question has got an answer. If my answer wasn&#39;t the solution but helpful/useful in some way, it would be very nice to vote it up. The professionals giving answers on SO are hungry for reputation points. :-)"}], "tags": [], "owner": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "is_accepted": false, "score": 1, "last_activity_date": 1447274347, "creation_date": 1447274347, "answer_id": 33659405, "question_id": 33657867, "link": "https://stackoverflow.com/questions/33657867/recordcount-returns-value-of-1/33659405#33659405", "title": "Recordcount returns value of -1", "body": "<p>rs.CursorType = 3\nAppears to work</p>\n"}], "owner": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1447274347, "creation_date": 1447268345, "last_edit_date": 1531164843, "question_id": 33657867, "link": "https://stackoverflow.com/questions/33657867/recordcount-returns-value-of-1", "title": "Recordcount returns value of -1", "body": "<p>I have the below code which retrieves data correctly however always return a value of -1 for rs.RecordCount. Please assist.</p>\n\n<pre><code>    Sub TEST()\n\n        Dim rs As Object\n        Set rs = CreateObject(\"ADODB.Recordset\")\n\n        Dim SQLSTR As String, MYVAL As String\n        MYVAL = InputBox(\"Enter Query\")\n        SQLSTR = \" \" &amp; MYVAL &amp; \"\"\n        CONNECT_TO_DWHS\n        rs.Open SQLSTR, PERSONALDBCONT\n\n        ActiveSheet.Cells(2, 1).CopyFromRecordset rs\n        ActiveSheet.Cells(1, 1).Select\n\n            Debug.Print rs.RecordCount\n\n        CLOSE_CONNECTION_TO_SQL\n\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18656, "user_id": 355931, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16121b31590e34cfbd754a162bb88120?s=128&d=identicon&r=PG", "display_name": "Barranka", "link": "https://stackoverflow.com/users/355931/barranka"}, "edited": false, "score": 0, "creation_date": 1447267248, "post_id": 33657531, "comment_id": 55088478, "body": "AFAIK you can&#39;t use VBA to write VBA in another sheet&#39;s class module, you have to write it by hand"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1447267274, "post_id": 33657531, "comment_id": 55088500, "body": "Application.screenupdating is not worksheet specific.  It is application as in all of excel.  Also it automatically returns to true as soon as the sub that turned it false ends."}, {"owner": {"reputation": 1568, "user_id": 2725684, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/vbbwp.png?s=128&g=1", "display_name": "Waxi", "link": "https://stackoverflow.com/users/2725684/waxi"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447267380, "post_id": 33657531, "comment_id": 55088562, "body": "@ScottCraner I tried adding the <code>screenupdating</code> to the workbook object, but it didn&#39;t work until I put it on an actual sheet?"}, {"owner": {"reputation": 18656, "user_id": 355931, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16121b31590e34cfbd754a162bb88120?s=128&d=identicon&r=PG", "display_name": "Barranka", "link": "https://stackoverflow.com/users/355931/barranka"}, "edited": false, "score": 2, "creation_date": 1447267546, "post_id": 33657531, "comment_id": 55088662, "body": "@AmericanSlime Try to put it in the <code>Workbook_SheetChange</code> event"}, {"owner": {"reputation": 1568, "user_id": 2725684, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/vbbwp.png?s=128&g=1", "display_name": "Waxi", "link": "https://stackoverflow.com/users/2725684/waxi"}, "reply_to_user": {"reputation": 18656, "user_id": 355931, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16121b31590e34cfbd754a162bb88120?s=128&d=identicon&r=PG", "display_name": "Barranka", "link": "https://stackoverflow.com/users/355931/barranka"}, "edited": false, "score": 0, "creation_date": 1447267709, "post_id": 33657531, "comment_id": 55088749, "body": "@Barranka I&#39;m not sure what means. Within VBA there is a list of &#39;Microsoft Excel Objects&#39; which shows all the sheets, then the workbook at the bottom. If I put the code into a sheet, works, but if I put it into the workbook one, doesn&#39;t."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1447268100, "post_id": 33657531, "comment_id": 55089003, "body": "you need to select it from the drop downs at the top, so you get this                        Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)  End Sub"}, {"owner": {"reputation": 1568, "user_id": 2725684, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/vbbwp.png?s=128&g=1", "display_name": "Waxi", "link": "https://stackoverflow.com/users/2725684/waxi"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1447269342, "post_id": 33657531, "comment_id": 55089687, "body": "@user5414798 Thank you, between you and Barranka I was able to see what my options were and they had the exact one I was looking for."}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1447270624, "post_id": 33657531, "comment_id": 55090441, "body": "If their comments assisted you, you can always  up vote their comment(if not done so already)."}], "answers": [{"tags": [], "owner": {"reputation": 1568, "user_id": 2725684, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/vbbwp.png?s=128&g=1", "display_name": "Waxi", "link": "https://stackoverflow.com/users/2725684/waxi"}, "is_accepted": false, "score": 1, "last_activity_date": 1447356045, "last_edit_date": 1447356045, "creation_date": 1447269280, "answer_id": 33658138, "question_id": 33657531, "link": "https://stackoverflow.com/questions/33657531/getting-this-code-to-work-for-all-sheets-in-a-workbook/33658138#33658138", "title": "Getting this code to work for all sheets in a workbook?", "body": "<pre><code>Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>This worked for me. What I had to do was change my object to include the workbook itself. I clicked on the dropdown to see my available options which is where I found the one I needed.</p>\n\n<p>Bad: <code>Worksheet_SelectionChange</code></p>\n\n<p>Good: <code>Workbook_SheetSelectionChange</code></p>\n"}], "owner": {"reputation": 1568, "user_id": 2725684, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/vbbwp.png?s=128&g=1", "display_name": "Waxi", "link": "https://stackoverflow.com/users/2725684/waxi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1447356045, "creation_date": 1447267108, "last_edit_date": 1447268838, "question_id": 33657531, "link": "https://stackoverflow.com/questions/33657531/getting-this-code-to-work-for-all-sheets-in-a-workbook", "title": "Getting this code to work for all sheets in a workbook?", "body": "<p>I need this code to work for all sheets:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Right now I've been adding it to every sheet one by one, but how do I just add it to the workbook so every sheet has it?</p>\n"}, {"tags": ["excel", "vba", "if-statement", "sum"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1447265617, "post_id": 33657033, "comment_id": 55087406, "body": "<code>=C4+C5</code> is a formula and the <code>.hasformula</code> should return true. But reverse your if to find those without formulas, doe your things and you will not need the else."}, {"owner": {"reputation": 157, "user_id": 3078511, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/dbc4bf68e3426de00cbb768b9a7d0a02?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/3078511/jack"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447266174, "post_id": 33657033, "comment_id": 55087760, "body": "Thanks a lot. It helped. I thougt VBA only recognizes if it has pure EXCEL FORMULA (for instance, sum, count and etc.)."}], "owner": {"reputation": 157, "user_id": 3078511, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/dbc4bf68e3426de00cbb768b9a7d0a02?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/3078511/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1447265590, "creation_date": 1447265395, "last_edit_date": 1447265590, "question_id": 33657033, "link": "https://stackoverflow.com/questions/33657033/if-cells-contains-sum-of-two-cells", "title": "If cells contains sum of two cells", "body": "<p>I would like to write a macro which goes through all cells in column and if it finds any formula in cell then it simply ignores this cells and simply 'DO NOTHING'.</p>\n\n<p>I know about HasFormula property in VBA but not really sure it works for cells where I sum two cells simply (for instance, <code>=C4+C5</code>). Here is an example:</p>\n\n<pre><code>'loop (if the cell has formula then loop ignores that cell\n\n   i = 1\n   For i = 5 To 100\n   If InStr(1, Sheets(\"Corporate Detailed\").Cells(i, \"F\"), \"+\") &gt; 0 Then\n      could be also used---'If Sheets(\"Corporate Detailed\").Cells(i, \"G\").HasFormula = True Then\n    Else\n        'Do some operations\n    End If\n    Next i\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1447265759, "post_id": 33656953, "comment_id": 55087500, "body": "Best to describe specifically what you want to do and what you&#39;d like the result to be.  Right now your question is too vague."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1447265970, "post_id": 33656953, "comment_id": 55087628, "body": "looks like a for next loop on the chars, so r=range(&quot;B&quot; &amp; loopcount) then if r.offset(-1,0).value&lt;&gt;r.value then...   Agree, its realy vague a question tho."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447265973, "post_id": 33656953, "comment_id": 55087632, "body": "Is the dataset sorted? What the &quot;else&quot; and &quot;something else&quot; will be? Please include that info in your edit of the question, as it stand now it may get deleted..."}, {"owner": {"reputation": 9, "user_id": 5522043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bd058ba091d3ec7b38a0001c47fbba?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/5522043/danny"}, "edited": false, "score": 0, "creation_date": 1447272050, "post_id": 33656953, "comment_id": 55091193, "body": "I have tried the r=range(&quot;B&quot; &amp; loopcount) then if r.offset(-1,0).value&lt;&gt;r.value then, but it doesn&#39;t work."}], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1447272749, "last_edit_date": 1495542614, "creation_date": 1447266185, "answer_id": 33657271, "question_id": 33656953, "link": "https://stackoverflow.com/questions/33656953/check-value-above-to-identify-the-same-value-as-one-item/33657271#33657271", "title": "Check value above to identify the same value as one item", "body": "<p>If <code>ID</code> is in A1 then you might try in D2 copied down to suit:  </p>\n\n<pre><code>=IF(B1=B2,\"Do something\",\"Do something else\")  \n</code></pre>\n\n<p>The general principle is the same for VBA (say If ... Else) but VBA has much more scope for what to do or what else to do.  </p>\n\n<hr>\n\n<p><strong>Concerning your edit</strong> you'd need to adapt the above formula so it differentiates the last in each group, rather than the first, say in E2 copied down to suit:  </p>\n\n<pre><code>=B2&lt;&gt;B3  \n</code></pre>\n\n<p>Filter ColumnE to select TRUE and filter ColumnC to select (Blanks). Fill those with <code>100</code> and then fill ColumnC by selecting it, Go To Special..., Blanks (only), <code>=</code>,  Down, Ctrl+Enter (<a href=\"https://stackoverflow.com/a/27511788/1505120\">see</a>).</p>\n"}], "owner": {"reputation": 9, "user_id": 5522043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bd058ba091d3ec7b38a0001c47fbba?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/5522043/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1447360546, "creation_date": 1447265124, "last_edit_date": 1447360546, "question_id": 33656953, "link": "https://stackoverflow.com/questions/33656953/check-value-above-to-identify-the-same-value-as-one-item", "title": "Check value above to identify the same value as one item", "body": "<p>I have a dataset that looks like this:</p>\n\n<pre><code>ID  Item       No of items    No of items ordered\n1   Vauxhall   \n2   Vauxhall                         40\n3   Vauxhall       30                 \n4   Vauxhall                         60\n6   Vauxhall  \n7   Vauxhall       40\n8   Vauxhall                         25\n9   Vauxhall       \n10  BMW            30\n11  BMW  \n12  BMW            25\n13  BMW            \n14  BMW                              55\n15  BMW  \n16  BMW  \n17  BMW            20\n18  BMW  \n</code></pre>\n\n<p>Each item has nine rows. I would like VBA code or a formula to look at the 'Item' above active cell and if the 'Item' is the same and the 'No of Items' field is blank, I would like it to copy the next available value in 'No of Items' to the cells above which are empty. If there is no next available 'No of Items' for one item then put default value of <code>100</code>.</p>\n\n<p>I would like the result to look:</p>\n\n<pre><code>ID  Item       No of items    No of Items ordered\n1   Vauxhall                          40\n2   Vauxhall                          40\n3   Vauxhall       30                   \n4   Vauxhall                          60\n6   Vauxhall       40\n7   Vauxhall       40\n8   Vauxhall                          25\n9   Vauxhall      100 \n10  BMW            30\n11  BMW            25\n12  BMW            25\n13  BMW                               55\n14  BMW                               55 \n15  BMW            20\n16  BMW            20\n17  BMW            20\n18  BMW           100\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 3, "creation_date": 1447264986, "post_id": 33656858, "comment_id": 55087029, "body": "What does <code>column above it</code> mean?"}, {"owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 0, "creation_date": 1447265059, "post_id": 33656858, "comment_id": 55087071, "body": "oh i meant cell value above. fixed"}, {"owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 1, "creation_date": 1447266061, "post_id": 33656858, "comment_id": 55087686, "body": "you&#39;re right, my coworker just taught me this trick. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 0, "creation_date": 1447267599, "post_id": 33656961, "comment_id": 55088686, "body": "any advice on how i can implement this to many columns at once?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 1, "creation_date": 1447268005, "post_id": 33656961, "comment_id": 55088944, "body": "@ichoi, that my friend is a new question.  But, it would require another loop that goes from 1 to the extents of your columns and you would replace all the &quot;A&quot; in your cell reference with the variable from the loop.  Try that and if you get stuck post a new question."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1447265160, "creation_date": 1447265160, "answer_id": 33656961, "question_id": 33656858, "link": "https://stackoverflow.com/questions/33656858/scroll-through-column-from-top-to-bottom-and-replace-0s-with-value-from-cell-ab/33656961#33656961", "title": "Scroll through column from top to bottom and replace 0&#39;s with value from cell above", "body": "<p>So close:</p>\n\n<pre><code>Sub ReplaceZeros()\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nDim lr As Long\nDim i As Long\nDim ws As Worksheet\nSet ws = ActiveSheet\nWith ws\n    lr = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    For i = 2 To lr\n        If .Cells(i, \"A\").Value = 0 Then .Cells(i, \"A\").Value = .Cells(i - 1, \"A\").Value\n    Next i\nEnd With\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Note: The loop you had started at the bottom and went up, this would be fine but if you had two '0' in a row the second would remain zero, plus the <code>step 7000</code> made the loop skip 7000 rows at a time.</p>\n\n<p>Then if all you want is the value above using <code>Cells(i-1,\"A\").value</code> will return the value of the cells directly above.</p>\n"}], "owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 33656961, "answer_count": 1, "score": 0, "last_activity_date": 1452129753, "creation_date": 1447264780, "last_edit_date": 1531161705, "question_id": 33656858, "link": "https://stackoverflow.com/questions/33656858/scroll-through-column-from-top-to-bottom-and-replace-0s-with-value-from-cell-ab", "title": "Scroll through column from top to bottom and replace 0&#39;s with value from cell above", "body": "<p>I have to scroll through a column (actually two, but if I can get one going I can manage) from top to bottom and replace the <code>0</code>'s or blanks with cell value above it. This is what I have so far (it doesn't work):</p>\n\n<pre><code>Sub ReplaceZeros()\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nlr = Cells(Rows.Count, \"A\").End(xlUp).Row                                          \nFor i = lr To 2 Step 7000                                                             \n    If Cells(i, \"A\").Value = 0 Then Cells(i, \"A\").Replace_\n    What: 0, Replacement:= \"cell(i-1,\"A\").value,_\n    SearchOrder:=xlByColumns, MatchCase:=True\n\nNext i\n\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1447263047, "creation_date": 1447263047, "answer_id": 33656326, "question_id": 33656146, "link": "https://stackoverflow.com/questions/33656146/how-to-move-a-shape-without-selecting-it/33656326#33656326", "title": "How to move a shape without selecting it?", "body": "<pre><code>Application.ScreenUpdating = False\nSet s = Worksheets(\"sheet1\").Shapes(1)\ns.Left = 100\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5533719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad3bc92d97466dd079475bbd24e05a60?s=128&d=identicon&r=PG&f=1", "display_name": "NicoJ", "link": "https://stackoverflow.com/users/5533719/nicoj"}, "edited": false, "score": 0, "creation_date": 1447266339, "post_id": 33656351, "comment_id": 55087859, "body": "Yes, that&#39;s exactly what i wanted. Thanks."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1447263123, "creation_date": 1447263123, "answer_id": 33656351, "question_id": 33656146, "link": "https://stackoverflow.com/questions/33656146/how-to-move-a-shape-without-selecting-it/33656351#33656351", "title": "How to move a shape without selecting it?", "body": "<pre><code>ActiveSheet.Shapes(\"Picture 18\").IncrementLeft -76\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5533719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad3bc92d97466dd079475bbd24e05a60?s=128&d=identicon&r=PG&f=1", "display_name": "NicoJ", "link": "https://stackoverflow.com/users/5533719/nicoj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1447263123, "creation_date": 1447262471, "last_edit_date": 1447262671, "question_id": 33656146, "link": "https://stackoverflow.com/questions/33656146/how-to-move-a-shape-without-selecting-it", "title": "How to move a shape without selecting it?", "body": "<p>How can I move any shape in a sheet without selecting it?  </p>\n\n<p>If I use:</p>\n\n<pre><code>    ActiveSheet.Shapes.Range(Array(\"Picture 18\")).Select\n    Selection.ShapeRange.IncrementLeft -76\"\n</code></pre>\n\n<p>it appears an edition border around the shape.</p>\n"}, {"tags": ["vba", "user-defined-functions"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447261590, "post_id": 33655763, "comment_id": 55084981, "body": "Is your function defined in a regular module, or a worksheet module?  Should be in a regular module."}, {"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447263914, "post_id": 33655763, "comment_id": 55086389, "body": "@TimWilliams, Yes, it&#39;s defined in a regular module. I really only use sheet modules for change events. Thank you."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447264524, "post_id": 33655763, "comment_id": 55086766, "body": "Since <code>t</code> and <code>ID</code> are already ranges you do not call them with the <code>Range()</code> function, just use the <code>t</code> and <code>ID</code>. Like: <code>tr = t</code>.   Also remove the <code>()</code> after each reference to the arrays; note: you should declare these before assigning values.  Also you are not returning anything <code>LDCellsTwo = Something</code> at the end."}, {"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447265390, "post_id": 33655763, "comment_id": 55087271, "body": "@ScottCraner, Yikes yeah good catches there -- can I say it&#39;s been a long day? I&#39;m still getting the same errors, but I&#39;ve implemented your suggestions in the edited question"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1447265571, "post_id": 33655763, "comment_id": 55087376, "body": "have you set a break point @ your for trNum line and stepped through the code?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447265937, "post_id": 33655763, "comment_id": 55087611, "body": "now that you are iterating through a range and not an array, <code>tR(tRNum)</code> should be <code>tR.item(tRNum)</code>"}, {"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447266681, "post_id": 33655763, "comment_id": 55088092, "body": "@Scott yes I had, but it wasn&#39;t breaking at all. I ultimately broke it down into several small parts and tested each to find the bug."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447266750, "post_id": 33657385, "comment_id": 55088145, "body": "Sorry I missed that, it is because there you changed to iterating through a range and there is no value at tR(0) it starts at 1."}], "tags": [], "owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "is_accepted": true, "score": 0, "last_activity_date": 1447266593, "creation_date": 1447266593, "answer_id": 33657385, "question_id": 33655763, "link": "https://stackoverflow.com/questions/33655763/nested-min-selection-excel-vba-udf-parameters/33657385#33657385", "title": "Nested Min Selection | Excel-VBA UDF Parameters", "body": "<p>Not Sure why this made such a big deal, but</p>\n\n<pre><code>Function LDCellsTwo(sR As Range, tR As Range, IDRange As Range) As Integer\nDim tRNum As Integer: Dim CLVD As Integer: Dim MinLVD As Integer: Dim MinID As Integer\nFor tRNum = 1 To tR.Count\n    CLDV = LevenshteinDistance(sR.Text, tR(tRNum))\n    if IsEmpty(MinLDV) then MinLDV = CLDV + 1\n    If CLDV &lt; MinLDV Then\n        MinLDV = CLDV\n        MinID = IDRange(tRNum)\n    End If\nNext tRNum\n\nLDCellsTwo = MinID\nEnd Function\n</code></pre>\n\n<p>The change was:</p>\n\n<p>from <code>For tRNum =</code><strong>0</strong><code>To tR.Count</code></p>\n\n<p>to <code>For tRNum =</code><strong>1</strong><code>To tR.Count</code></p>\n"}], "owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 33657385, "answer_count": 1, "score": 0, "last_activity_date": 1447266593, "creation_date": 1447261271, "last_edit_date": 1447265306, "question_id": 33655763, "link": "https://stackoverflow.com/questions/33655763/nested-min-selection-excel-vba-udf-parameters", "title": "Nested Min Selection | Excel-VBA UDF Parameters", "body": "<p>Excel 2015/Access 2015</p>\n\n<p>Primary Function: LavenshteinDistance returns an integer</p>\n\n<pre><code>Function LDCellsTwo(sR As Range, tR As Range, IDRange As Range) As Integer\nDim tRNum As Integer: Dim CLVD As Integer: Dim MinLVD As Integer: Dim MinID As Integer\nFor tRNum = 0 To tR.Count\n    CLDV = LevenshteinDistance(sR.Text, tR(tRNum))\n    if IsEmpty(MinLDV) then MinLDV = CLDV + 1\n    If CLDV &lt; MinLDV Then\n        MinLDV = CLDV\n        MinID = IDRange(tRNum)\n    End If\nNext tRNum\n\nLDCellsTwo = MinID\nEnd Function\n</code></pre>\n\n<p><strong>Edited: Thanks Scott good catches - Still  Resulting In #NAME? error</strong></p>\n\n<p>Goal: Have the LDCellsTwo Function return the ID value associated with the first lowest LevenshteinDistance value returned by iterating various items in the <code>t</code> Range against the single value in the <code>sR</code> Range where the <code>ID</code> Range and the <code>t</code> Range are implicitly the same length</p>\n\n<p>Error: <code>#NAME?</code> returned in cell</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1447260908, "post_id": 33655535, "comment_id": 55084600, "body": "What does this mean: <i>&quot;Set Rng&quot; it doesn&#39;t go any further.</i>  Do you get an error?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1447261535, "post_id": 33655535, "comment_id": 55084942, "body": "A few things I&#39;d change - what happens if &#39;Product Line&#39; isn&#39;t found? Is &#39;201601&#39; formatted as text or a number - it won&#39;t find a number if it&#39;s formatted as text."}, {"owner": {"reputation": 21, "user_id": 5551456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46631eb06c88de0d3e3364a899121b4c?s=128&d=identicon&r=PG&f=1", "display_name": "user5551456", "link": "https://stackoverflow.com/users/5551456/user5551456"}, "edited": false, "score": 0, "creation_date": 1447261979, "post_id": 33655535, "comment_id": 55085225, "body": "&quot;Set Rng&quot; is set range by finding a specified cell and then setting a range of cells which will eventually be pasted to the new sheet called &quot;Budget&quot;."}, {"owner": {"reputation": 21, "user_id": 5551456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46631eb06c88de0d3e3364a899121b4c?s=128&d=identicon&r=PG&f=1", "display_name": "user5551456", "link": "https://stackoverflow.com/users/5551456/user5551456"}, "edited": false, "score": 0, "creation_date": 1447262109, "post_id": 33655535, "comment_id": 55085298, "body": "&quot;Product Line&quot; is always found.  The format is identical of all of the worksheets that I am trying to copy data from, only the values differ. &quot;201601&quot; is formatted as a number. Thanks both"}, {"owner": {"reputation": 21, "user_id": 5551456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46631eb06c88de0d3e3364a899121b4c?s=128&d=identicon&r=PG&f=1", "display_name": "user5551456", "link": "https://stackoverflow.com/users/5551456/user5551456"}, "edited": false, "score": 0, "creation_date": 1447262176, "post_id": 33655535, "comment_id": 55085349, "body": "&quot;object variable or with block variable not set&quot; is the error."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1447262443, "post_id": 33655535, "comment_id": 55085508, "body": "Try taking the speech marks from around 201601 - <code>Set Rng = .Find(What:=201601,</code>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5551456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46631eb06c88de0d3e3364a899121b4c?s=128&d=identicon&r=PG&f=1", "display_name": "user5551456", "link": "https://stackoverflow.com/users/5551456/user5551456"}, "edited": false, "score": 0, "creation_date": 1447328827, "post_id": 33656279, "comment_id": 55114268, "body": "Thanks for the suggestion.  I am looking into it, but I&#39;m not sure how to use the LastCell function.  Do I just add to my module? I&#39;m quite new to writing macros as you can see!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 21, "user_id": 5551456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46631eb06c88de0d3e3364a899121b4c?s=128&d=identicon&r=PG&f=1", "display_name": "user5551456", "link": "https://stackoverflow.com/users/5551456/user5551456"}, "edited": false, "score": 0, "creation_date": 1447329901, "post_id": 33656279, "comment_id": 55114821, "body": "Yes, just add it to a module.  The line in the code above <code>Set rUsedRange = ws.Range(ws.Cells(1, 1), LastCell(ws))</code> sets a reference in the <code>ws</code> worksheet range A1 to the last cell.  You could also use it as:  <code>Set MyRange = LastCell(Thisworkbook.worksheets(&quot;Sheet1&quot;))</code> which would return a reference to the last cell on the sheet.  Or in the Immediate window type <code>?LastCell(Thisworkbook.worksheets(&quot;Sheet1&quot;))</code>.Address`"}, {"owner": {"reputation": 21, "user_id": 5551456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46631eb06c88de0d3e3364a899121b4c?s=128&d=identicon&r=PG&f=1", "display_name": "user5551456", "link": "https://stackoverflow.com/users/5551456/user5551456"}, "edited": false, "score": 0, "creation_date": 1447332141, "post_id": 33656279, "comment_id": 55116025, "body": "Thanks! I managed to work it out in the end. The pasting of the data to the budget sheet includes the cell format, how can I change to to paste values only? Also I need to replicate the part where i look for the range below &quot;201601&quot; and do the same for &quot;201602&quot; and so on upto &quot;201612&quot;.  These columns are next to each other.  Do I need to do this individually or is there another way? I appreciate your time!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 21, "user_id": 5551456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46631eb06c88de0d3e3364a899121b4c?s=128&d=identicon&r=PG&f=1", "display_name": "user5551456", "link": "https://stackoverflow.com/users/5551456/user5551456"}, "edited": false, "score": 0, "creation_date": 1447335420, "post_id": 33656279, "comment_id": 55118083, "body": "To PasteSpecial just the values you&#39;ll need to split the copy line into two lines.  <code>Rng.Offset(1, 0).Resize(33).Copy Destination:=wsBudget.Range(&quot;F1&quot;).End(xlDown).Offset(, -3).End(xlUp).Offset(1).Resize(Rng.Rows.Count)</code> becomes <code>Rng.Offset(1, 0).Resize(33).Copy</code> and <code>wsBudget.Range(&quot;F1&quot;).End(xlDown).Offset(, -3).End(xlUp).Offset(1).Resize(Rng.Rows.Count).PasteSpecial Paste:=xlPasteValuesAndNumberFormats</code>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 21, "user_id": 5551456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46631eb06c88de0d3e3364a899121b4c?s=128&d=identicon&r=PG&f=1", "display_name": "user5551456", "link": "https://stackoverflow.com/users/5551456/user5551456"}, "edited": false, "score": 0, "creation_date": 1447335549, "post_id": 33656279, "comment_id": 55118162, "body": "For the number values I&#39;d add a loop - <code>For x = 201601 to 201612</code> and use <code>x</code> as your search criteria."}, {"owner": {"reputation": 21, "user_id": 5551456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46631eb06c88de0d3e3364a899121b4c?s=128&d=identicon&r=PG&f=1", "display_name": "user5551456", "link": "https://stackoverflow.com/users/5551456/user5551456"}, "edited": false, "score": 0, "creation_date": 1447852254, "post_id": 33656279, "comment_id": 55328190, "body": "This is what I have so far:"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1447262873, "creation_date": 1447262873, "answer_id": 33656279, "question_id": 33655535, "link": "https://stackoverflow.com/questions/33655535/copy-range-to-a-new-worksheet/33656279#33656279", "title": "Copy Range to a new worksheet", "body": "<p>I've added this as an answer as it's too long to fit in a comment.  It's not a perfect answer, but will hopefully highlight a couple of areas to look at.</p>\n\n<ul>\n<li>Each range reference also includes which sheet it's looking at (omitting the sheet reference tells Excel to use the currently active sheet).</li>\n<li>An array to populate the headings.</li>\n<li>SELECT CASE instead of IF</li>\n<li>Space to do something if the FIND's aren't found.  You say they're all the same, but that's in a perfect world and I haven't found that yet.</li>\n</ul>\n\n<p>Sub Test()</p>\n\n<pre><code>Dim wb As Workbook\nDim ws As Worksheet\nDim wsBudget As Worksheet\nDim Rng As Range\nDim rUsedRange As Range\n\nSet wb = ActiveWorkbook\n\n'create new worksheet, name it \"Budget\"\nSet wsBudget = wb.Sheets.Add\nWith wsBudget\n    .Name = \"Budget\"\n    .Range(\"A1:E1\") = Array(\"Period\", \"Country\", \"Product Line\", \"Currency\", \"Sales\")\nEnd With\n\n'search the entire UsedRange of sheet.\n'ActiveWorkbook or ThisWorkbook?\nFor Each ws In wb.Worksheets\n    Select Case ws.Name\n        Case \"Summary\", \"Template\", \"Data\"\n            'Do Nothing\n        Case Else\n            Set rUsedRange = ws.Range(ws.Cells(1, 1), LastCell(ws))\n            With rUsedRange\n                Set Rng = .Find(What:=\"Product Line\", _\n                    After:=.Cells(.Cells.Count), LookIn:=xlValues, LookAt:=xlWhole, SearchDirection:=xlNext)\n                If Not Rng Is Nothing Then\n                    Rng.Offset(1, 0).Resize(33).Copy _\n                        Destination:=wsBudget.Range(\"F1\").End(xlDown).Offset(, -3).End(xlUp).Offset(1).Resize(Rng.Rows.Count)\n                Else\n                    'Do something else if Rng not found.\n                End If\n\n                Set Rng = .Find(What:=201601, _\n                    After:=.Cells(.Cells.Count), LookIn:=xlValues, LookAt:=xlWhole, SearchDirection:=xlNext)\n                If Not Rng Is Nothing Then\n                    Rng.Offset(1).Resize(33).Copy _\n                        Destination:=wsBudget.Range(\"F1\").End(xlDown).Offset(, -1).End(xlUp).Offset(1).Resize(Rng.Rows.Count)\n                Else\n                    'Do something if Rng not found.\n                End If\n\n            End With\n    End Select\nNext ws\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Have included the find last cell function:</p>\n\n<pre><code>Public Function LastCell(wrkSht As Worksheet, Optional Col As Long = 0) As Range\n\n    Dim lLastCol As Long, lLastRow As Long\n\n    On Error Resume Next\n\n    With wrkSht\n        If Col = 0 Then\n            lLastCol = .Cells.Find(\"*\", , , , xlByColumns, xlPrevious).Column\n            lLastRow = .Cells.Find(\"*\", , , , xlByRows, xlPrevious).Row\n        Else\n            lLastCol = .Cells.Find(\"*\", , , , xlByColumns, xlPrevious).Column\n            lLastRow = .Columns(Col).Find(\"*\", , , , xlByColumns, xlPrevious).Row\n        End If\n\n        If lLastCol = 0 Then lLastCol = 1\n        If lLastRow = 0 Then lLastRow = 1\n\n        Set LastCell = wrkSht.Cells(lLastRow, lLastCol)\n    End With\n    On Error GoTo 0\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 5551456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46631eb06c88de0d3e3364a899121b4c?s=128&d=identicon&r=PG&f=1", "display_name": "user5551456", "link": "https://stackoverflow.com/users/5551456/user5551456"}, "is_accepted": false, "score": 0, "last_activity_date": 1447866930, "last_edit_date": 1447866930, "creation_date": 1447852512, "answer_id": 33781095, "question_id": 33655535, "link": "https://stackoverflow.com/questions/33655535/copy-range-to-a-new-worksheet/33781095#33781095", "title": "Copy Range to a new worksheet", "body": "<p>This is what I have so far...</p>\n\n<p>Sub Test()</p>\n\n<pre><code>' CreateBudgetFormat Macro\n\nDim wb As Workbook\nDim ws As Worksheet\nDim wsBudget As Worksheet\nDim Rng As Range\nDim rUsedRange As Range\n\nSet wb = ActiveWorkbook\n\n'create new worksheet, name it \"Budget\"\nSet wsBudget = wb.Sheets.Add\nWith wsBudget\n.Name = \"Budget\"\n.Range(\"A1:E1\") = Array(\"Period\", \"Country\", \"Product Line\", \"Currency\", \"Sales\")\nEnd With\n\n'search the entire UsedRange of sheet.\nFor Each ws In wb.Worksheets\nSelect Case ws.Name\n    Case \"Summary\", \"Template\", \"Data\"\n        'Do Nothing\n    Case Else\n\n    For x = 201601 To 201612\n\n        Set rUsedRange = ws.Range(ws.Cells(1, 1), LastCell(ws))\n        With rUsedRange\n            Set Rng = .Find(What:=\"Product Line\", _\n                After:=.Cells(.Cells.Count), LookIn:=xlValues, LookAt:=xlWhole, SearchDirection:=xlNext)\n            If Not Rng Is Nothing Then\n                Rng.Offset(1, 0).Resize(32).Copy\n                    wsBudget.Range(\"F1\").End(xlDown).Offset(, -3).End(xlUp).Offset(1).Resize(Rng.Rows.Count).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n            Else\n                'Do something else if Rng not found.\n            End If\n\n            Set Rng = .Find(What:=\"Product Line\", _\n                After:=.Cells(.Cells.Count), LookIn:=xlValues, LookAt:=xlWhole, SearchDirection:=xlNext)\n            If Not Rng Is Nothing Then\n                Rng.Offset(37, 0).Resize(2).Copy\n                    wsBudget.Range(\"F1\").End(xlDown).Offset(, -3).End(xlUp).Offset(1).Resize(Rng.Rows.Count).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n            Else\n                'Do something else if Rng not found.\n            End If\n\n            Set Rng = .Find(What:=x, _\n                After:=.Cells(.Cells.Count), LookIn:=xlValues, LookAt:=xlWhole, SearchDirection:=xlNext)\n            If Not Rng Is Nothing Then\n                Rng.Offset(1, 0).Resize(32).Copy\n                    wsBudget.Range(\"F1\").End(xlDown).Offset(, -1).End(xlUp).Offset(1).Resize(Rng.Rows.Count).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n            Else\n                'Do something if Rng not found.\n            End If\n\n            Set Rng = .Find(What:=x, _\n                After:=.Cells(.Cells.Count), LookIn:=xlValues, LookAt:=xlWhole, SearchDirection:=xlNext)\n            If Not Rng Is Nothing Then\n                Rng.Offset(37, 0).Resize(2).Copy\n                    wsBudget.Range(\"F1\").End(xlDown).Offset(, -1).End(xlUp).Offset(1).Resize(Rng.Rows.Count).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n            Else\n                'Do something if Rng not found.\n            End If\n\n            Set Rng = .Find(What:=\"Ship_To_Country\", _\n                After:=.Cells(.Cells.Count), LookIn:=xlValues, LookAt:=xlWhole, SearchDirection:=xlNext)\n            If Not Rng Is Nothing Then\n                Rng.Offset(, 1).Copy\n                    wsBudget.Range(\"F1\").End(xlDown).Offset(, -4).End(xlUp).Offset(1).Resize(34).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n            Else\n                'Do something if Rng not found.\n            End If\n\n            Set Rng = .Find(What:=x, _\n                After:=.Cells(.Cells.Count), LookIn:=xlValues, LookAt:=xlWhole, SearchDirection:=xlNext)\n            If Not Rng Is Nothing Then\n                Rng.Copy\n                    wsBudget.Range(\"F1\").End(xlDown).Offset(, -5).End(xlUp).Offset(1).Resize(34).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n            Else\n                'Do something if Rng not found.\n            End If\n\n        End With\n        Next\nEnd Select\nNext ws\n\n            With wsBudget\n            Range(\"D2\") = \"EUR\"\n            Range(\"C2\").Select\n            Selection.End(xlDown).Select\n            ActiveCell.Offset(0, 1).Select\n            Range(Selection, Selection.End(xlUp)).Select\n            Selection.FillDown\n            End With\n</code></pre>\n\n<p>End Sub</p>\n\n<p>It works although far from an ideal code.  I would appreciate any help on how I can change this [ wsBudget.Range(\"F1\").End(xlDown).Offset(, -5).End(xlUp).Offset(1).Resize(34).PasteSpecial Paste:=xlPasteValuesAndNumberFormats ] to resize filldown as opposed to having to specify a number of rows (34 in this case). Also any other suggestions of how I can improve the code will be welcome.  Thanks!</p>\n"}], "owner": {"reputation": 21, "user_id": 5551456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46631eb06c88de0d3e3364a899121b4c?s=128&d=identicon&r=PG&f=1", "display_name": "user5551456", "link": "https://stackoverflow.com/users/5551456/user5551456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 1, "accepted_answer_id": 33656279, "answer_count": 2, "score": 1, "last_activity_date": 1476892437, "creation_date": 1447260493, "last_edit_date": 1447260841, "question_id": 33655535, "link": "https://stackoverflow.com/questions/33655535/copy-range-to-a-new-worksheet", "title": "Copy Range to a new worksheet", "body": "<p>I am trying to write a macro to copy a range of data from different parts of a worksheet and paste it to a new worksheet.  It should do this for every worksheet in the workbook with a few specified exceptions.  This is the code I have written so far:</p>\n\n<pre><code>Dim wb As Workbook\nDim ws As Worksheet\nDim Rng As Range\n\n'create new worksheet, name it \"Budget\"\nSet ws = Sheets.Add\nws.Name = \"Budget\"\n'set column titles in the new sheet\nRange(\"A1\").Value = \"Period\"\nRange(\"B1\").Value = \"Country\"\nRange(\"C1\").Value = \"Product Line\"\nRange(\"D1\").Value = \"Currency\"\nRange(\"E1\").Value = \"Sales\"\n'search the entire UsedRange of sheet\nFor Each ws In ActiveWorkbook.Worksheets\nIf ws.Name &lt;&gt; \"Summary\" And ws.Name &lt;&gt; \"Template\" And ws.Name &lt;&gt; \"Data\" Then\nWith ws.UsedRange\n    Set Rng = .Find(What:=\"Product Line\", _\n                After:=.Cells(.Cells.Count), _\n                LookIn:=xlValues, _\n                LookAt:=xlWhole, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlNext, _\n                MatchCase:=False).Offset(1, 0).Resize(33)\n        Sheets(\"Budget\").[F1].End(xlDown).Offset(0, -3).End(xlUp).Offset(1, 0).Resize(Rng.Rows.Count).Value = Rng.Value 'put values from the Find into C column of new sheet\n     Set Rng = .Find(What:=\"201601\", _\n                After:=.Cells(.Cells.Count), _\n                LookIn:=xlValues, _\n                LookAt:=xlWhole, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlNext, _\n                MatchCase:=False).Offset(1, 0).Resize(33)\n        Sheets(\"Budget\").[F1].End(xlDown).Offset(0, -1).End(xlUp).Offset(1, 0).Resize(Rng.Rows.Count).Value = Rng.Value 'put values from the Find into D column of new sheet\n\nEnd With\nEnd If\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>The first part seems to work fine, but when it reaches the second \"Set Rng\" it doesn't go any further.  I am looking to set 5 different ranges to take data from.</p>\n"}, {"tags": ["vba", "excel", "search", "criteria"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5551341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ab8314401a5669c0ffc378e99211a85?s=128&d=identicon&r=PG&f=1", "display_name": "Penelly", "link": "https://stackoverflow.com/users/5551341/penelly"}, "edited": false, "score": 0, "creation_date": 1447326102, "post_id": 33655813, "comment_id": 55112711, "body": "I had to change <code>If v(b + 1, 1 = CI) Then</code> to <code>If v(b + 1, 1) = CI Then</code> but otherwise the code works and seems a lot quicker, thanks. I&#39;ll roll it out across the other subs and see if it speeds it up enough not to worry about figuring out auto filtering"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 3, "user_id": 5551341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ab8314401a5669c0ffc378e99211a85?s=128&d=identicon&r=PG&f=1", "display_name": "Penelly", "link": "https://stackoverflow.com/users/5551341/penelly"}, "edited": false, "score": 0, "creation_date": 1447334976, "post_id": 33655813, "comment_id": 55117816, "body": "@Penelly I&#39;ve updated the answer with typo correction. Please remember to accept the answer by clicking on the large check mark next to the answer."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 0, "last_activity_date": 1447334867, "last_edit_date": 1447334867, "creation_date": 1447261428, "answer_id": 33655813, "question_id": 33655096, "link": "https://stackoverflow.com/questions/33655096/efficiently-copy-and-paste-block-of-cells-based-on-multiple-criteria/33655813#33655813", "title": "Efficiently copy and paste block of cells based on multiple criteria", "body": "<p>It is likely that the AdvancedFilter method of the Range object will be the most efficient... and it definitely does not need to copy full rows. You can choose which columns you want.</p>\n\n<p>However, I refactored your code, without utilizing the AdvancedFilter. This should be significantly quicker:</p>\n\n<pre><code>Sub Join_(CI, FI, FSD)\n    Dim a&amp;, b&amp;, LastRow&amp;, v\n\n    LastRow = Fcst_Cust.[a1048576].End(xlUp).Row + 1\n\n    a = 3\n    b = 2\n\n    With Raw_IFcst\n        v = .Cells(1, 2).Resize(.[b1048576].End(xlUp).Row, 2).Value2\n\n        Do\n            If If v(b + 1, 1) = CI Then\n                If v(b + 1, 2) &gt;= FSD Then\n                    Exit Do\n                End If\n            End If\n            a = a + 1\n            b = b + 1\n        Loop\n\n        Do Until v(b + 1, 1) &lt;&gt; CI\n            b = b + 1\n        Loop\n\n        .Range(\"A\" &amp; a &amp; \":AZ\" &amp; b).Copy\n            Fcst_Cust.Range(\"C\" &amp; LastRow).PasteSpecial xlPasteValues\n\n        .Range(\"BB\" &amp; a &amp; \":CW\" &amp; b).Copy\n            Fcst_Cust.Range(\"BG\" &amp; LastRow).PasteSpecial xlPasteValues\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Note: I have not tested this, so please do.</p>\n\n<p>Note: I have changed the name of the Sub. It is not a good practice to use the name of an existing VBA function as the name of the procedure, unless you truly wish to override that function.</p>\n\n<p>Note: I changed the Dim line. You had <code>a</code> and <code>b</code> as variants, when they should be longs.</p>\n\n<p>Note: What was slowing down your procedure the most was the cell-by-cell read through columns 2 and 3. Reading and writing to cells one at a time is perhaps the most inefficient process available to an Excel developer. What my code does is transfer the used portion of columns 2 and 3 into an array, <code>v</code>. This is very fast and accessing the individual elements of the array as opposed to individual cells is extremely fast.</p>\n\n<p>Note: I changed the first <code>Do While</code> loop. VBA expression evaluation does not short-circuit multiple clauses. So, if <code>clause 1</code> And <code>clause 2</code> must be true (as in your case) then <code>clause 2</code> will get evaluated EVEN WHEN <code>clause 1</code> is false. That is a waste of processing with zero benefit. In your original setup that waste was amplified because of the slow read of individual cells. The optmization is to break up the clauses into separate lines. This way if the first fails, the second is never evaluated. This notion can be further otpimized by placing the clause that is most likely to fail on the first line. I do not know which is most likely to fail in your scenario, so I placed your first clause on the first line.</p>\n"}], "owner": {"reputation": 3, "user_id": 5551341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ab8314401a5669c0ffc378e99211a85?s=128&d=identicon&r=PG&f=1", "display_name": "Penelly", "link": "https://stackoverflow.com/users/5551341/penelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 33655813, "answer_count": 1, "score": 0, "last_activity_date": 1447334867, "creation_date": 1447259231, "last_edit_date": 1447259255, "question_id": 33655096, "link": "https://stackoverflow.com/questions/33655096/efficiently-copy-and-paste-block-of-cells-based-on-multiple-criteria", "title": "Efficiently copy and paste block of cells based on multiple criteria", "body": "<p>I have a large data set and want to query to columns based on a set of criteria to another sheet. I have a working method that uses a loop to find the start and a loop to find the end to get the rows required, but this is slow. </p>\n\n<p>I want to avoid a unique column that's required for the find function as this makes the end of the data tricky to find. I've considered trying to use some kind of FindAll function, but can't seem to figure out how to start it. </p>\n\n<p>I've seen a lot about filters, but these seem to work by copying the whole row, which I want to avoid.</p>\n\n<p>Like I said, this code works perfectly but it's way to slow as it will be run 1000's of times during a model run. I also have several similar subs that I'm hoping to able to roll the solution over</p>\n\n<pre><code>Sub Join(CI, FI, FSD)\nDim a, b, LastRow As Long\n\nLastRow = Fcst_Cust.Range(\"a1048576\").End(xlUp).Row + 1\n\n'find all values for that customer ID for dates greater than the forecast start date and copy onto forecast tab.\n\n    a = 3\n    b = 2\n\n    Do Until ((Raw_IFcst.Cells(b + 1, 2) = CI) And (Raw_IFcst.Cells(b + 1, 3) &gt;= FSD))\n        a = a + 1\n        b = b + 1\n    Loop\n    Do Until Raw_IFcst.Cells(b + 1, 2) &lt;&gt; CI\n        b = b + 1\n    Loop\n\n    Raw_IFcst.Range(\"A\" &amp; a &amp; \":AZ\" &amp; b).Copy\n        Fcst_Cust.Range(\"C\" &amp; LastRow).PasteSpecial xlPasteValues\n    Raw_IFcst.Range(\"BB\" &amp; a &amp; \":CW\" &amp; b).Copy\n        Fcst_Cust.Range(\"BG\" &amp; LastRow).PasteSpecial xlPasteValues\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 1, "creation_date": 1447260093, "post_id": 33655041, "comment_id": 55084066, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/2272361/can-i-iterate-through-all-outlook-emails-in-a-folder-including-sub-folders\">Can I iterate through all Outlook emails in a folder including sub-folders?</a>"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 1, "creation_date": 1447260166, "post_id": 33655041, "comment_id": 55084102, "body": "See as well <a href=\"http://stackoverflow.com/questions/33527816/outlook-vba-importing-emails-from-subfolders-into-excel/33553951#33553951\" title=\"outlook vba importing emails from subfolders into excel\">stackoverflow.com/questions/33527816/&hellip;</a>"}, {"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1447260909, "post_id": 33655041, "comment_id": 55084601, "body": "Thanks for that. I tried to implement the changes but I am confused with the lines <code>Private Sub processFolder(ByVal oParent As Outlook.MAPIFolder)</code> . If i include it VBA doesnt recognize it as a macro. If I take it out it refers to <code>processFolder (oFolder)</code> as sub or function not defined."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1447269880, "post_id": 33655041, "comment_id": 55090010, "body": "processFolder is not standalone code. When code starts with Sub name (data as whatever) then it is called from other code which passes data to it. As well there is a typo in the accepted answer, I described this in the second example, and just fixed in the accepted answer. processFolder oFolder without brackets. If you continue to have a problem edit you question to add your current code. Don&#39;t delete your first attempt."}, {"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1447700248, "post_id": 33655041, "comment_id": 55253533, "body": "@niton , i&#39;ve edited the code after impelementing your suggested fixes, it&#39;s in the OP. Right now, it&#39;s showing object not defined for the line <code>For Each olMail In oParent.Items</code>"}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 3, "last_activity_date": 1447709441, "creation_date": 1447709441, "answer_id": 33745021, "question_id": 33655041, "link": "https://stackoverflow.com/questions/33655041/vba-code-to-loop-through-every-folder-and-subfolder-in-outlook/33745021#33745021", "title": "VBA code to loop through every folder and subfolder in Outlook", "body": "<p>There is an extra loop and you are mixing up parent and folder. This is working Excel code, ignoring your workbook and worksheets.</p>\n\n<pre><code>Option Explicit\n\nSub repopulate3()\n\nDim olApp As Outlook.Application\nDim olNs As Outlook.Namespace\nDim olparentfolder As Outlook.Folder\nDim olMail As Object\n\nDim eFolder As Object\nDim i As Long\nDim wb As Workbook\nDim ws As Worksheet\n\nDim iCounter As Long\nDim lrow As Long\nDim lastrow As Long\n\n'Set wb = ActiveWorkbook\n'Set ws = wb.Worksheets(\"vlookup\")\n\nOn Error Resume Next\nSet olApp = GetObject(, \"Outlook.Application\")\nOn Error GoTo 0\nIf olApp Is Nothing Then\n    Set olApp = CreateObject(\"Outlook.Application\")\nEnd If\n\nSet olNs = olApp.GetNamespace(\"MAPI\")\nSet olparentfolder = olNs.GetDefaultFolder(olFolderInbox)\n\n'wb.Sheets(\"vlookup\").range(\"A2:C500\").ClearContents\n\n'i think you want column E here, not L?\n'lastrow = ThisWorkbook.Worksheets(\"vlookup\").Cells(Rows.count, \"E\").End(xlUp).Row\n\nProcessFolder olparentfolder\n\nExitRoutine:\n\nSet olparentfolder = Nothing\nSet olNs = Nothing\nSet olApp = Nothing\n\nEnd Sub\n\n\nPrivate Sub ProcessFolder(ByVal oParent As Outlook.Folder)\n\nDim olFolder As Outlook.Folder\nDim olMail As Object\n\nDim i As Long\nDim wb As Workbook\nDim ws As Worksheet\nDim iCounter As Long\nDim lrow As Long\nDim lastrow As Long\n\n'Set wb = ActiveWorkbook\n'Set ws = wb.Worksheets(\"vlookup\")\n\n'lastrow = ThisWorkbook.Worksheets(\"vlookup\").Cells(Rows.count, \"E\").End(xlUp).Row\n\nFor i = oParent.Items.Count To 1 Step -1\n\n    Debug.Print oParent\n    If TypeOf oParent.Items(i) Is MailItem Then\n        Set olMail = oParent.Items(i)\n\n        Debug.Print \" \" &amp; olMail.Subject\n        Debug.Print \" \" &amp; olMail.ReceivedTime\n        Debug.Print \" \" &amp; olMail.SenderEmailAddress\n        Debug.Print\n\n        'For iCounter = 2 To lastrow\n            'If InStr(olMail.SenderEmailAddress, ws.Cells(iCounter, 5).Value) &gt; 0 Then 'qualify the cell\n                'With ws\n                '   lrow = .range(\"A\" &amp; .Rows.count).End(xlUp).Row\n                '   .range(\"C\" &amp; lrow + 1).Value = olMail.body\n                '   .range(\"B\" &amp; lrow + 1).Value = olMail.ReceivedTime\n                '   .range(\"A\" &amp; lrow + 1).Value = olMail.SenderEmailAddress\n                'End With\n            'End If\n        'Next iCounter\n\n    End If\n\nNext i\n\nIf (oParent.Folders.Count &gt; 0) Then\n    For Each olFolder In oParent.Folders\n        ProcessFolder olFolder\n    Next\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11267, "favorite_count": 1, "accepted_answer_id": 33745021, "answer_count": 1, "score": 1, "last_activity_date": 1565282460, "creation_date": 1447259014, "last_edit_date": 1531164843, "question_id": 33655041, "link": "https://stackoverflow.com/questions/33655041/vba-code-to-loop-through-every-folder-and-subfolder-in-outlook", "title": "VBA code to loop through every folder and subfolder in Outlook", "body": "<p>I am trying to get the following code to look through all folders and subfolders in Outlook under Inbox and source data from the e-mails.</p>\n\n<p>The code runs but it ONLY looks through e-mails in the Inbox and the FIRST subfolder level of the Inbox. However, it doesn't look through all the subsequent subfolder levels within the first subfolder.</p>\n\n<p>So here's what it looks through</p>\n\n<p><strong>Inbox --> Subfolder 1</strong> --> stops looking</p>\n\n<p>I want it to look through </p>\n\n<p><strong>Inbox --> Subfolder 1 --> Subfolder 2 --> Subfolder \"n\"</strong></p>\n\n<p>So for example, I have the following folders in my Inbox:</p>\n\n<ol>\n<li>Inbox --> Canada --> Ontario --> Toronto</li>\n</ol>\n\n<p>OR</p>\n\n<ol start=\"2\">\n<li>Inbox --> Clothes --> Cheap clothes --> Walmart</li>\n</ol>\n\n<p>It only looks through Inbox and the first level, so Canada or clothes, but doesn't look into the folders under Canada/clothes, such as Ontario or Cheap Clothes. I want it to go further and look at Toronto and Walmart, which are folders under Ontario and Cheap clothes.</p>\n"}, {"tags": ["sql", "excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 1, "creation_date": 1447258437, "post_id": 33654811, "comment_id": 55082903, "body": "Which line in the code causes the error?"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1447258474, "post_id": 33654811, "comment_id": 55082925, "body": "Your SQL statement is a (badly formulated) INSERT. It should be a SELECT."}], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447266343, "post_id": 33656201, "comment_id": 55087862, "body": "1. <code>Dim sql AS STRING, strOutputFileName As String</code>. 2. Do you really want only <code>DoCmd.RunSQL sql</code> in the If clause? If yes, correct your indentation. If not, drop the _ after Then, and add an <code>End If</code> at the end of the block. 3. You are mixing xls and xlsx. Better: use <code>strOutputFileName</code>."}, {"owner": {"reputation": 11, "user_id": 5411356, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/3211112718062/picture?type=large", "display_name": "John Krull", "link": "https://stackoverflow.com/users/5411356/john-krull"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447268328, "post_id": 33656201, "comment_id": 55089137, "body": "Thanks. Just how it copied in and I thought I got all the .xlsx&#39;s changed. I do want it in the if clause, yeah. It&#39;s dependent on the if and only will run if the criteria are met."}], "tags": [], "owner": {"reputation": 11, "user_id": 5411356, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/3211112718062/picture?type=large", "display_name": "John Krull", "link": "https://stackoverflow.com/users/5411356/john-krull"}, "is_accepted": false, "score": 0, "last_activity_date": 1447272193, "last_edit_date": 1447272193, "creation_date": 1447262646, "answer_id": 33656201, "question_id": 33654811, "link": "https://stackoverflow.com/questions/33654811/trouble-copying-table-to-excel-based-on-criteria/33656201#33656201", "title": "Trouble copying table to Excel based on criteria", "body": "<p>Figured it out:</p>\n\n<pre><code>Sub CreateDailyReadOnlyCVG()\n\nDim sql, strOutputFileName As String\nDim intCounter As Integer\n\nstrOutputFileName = \"J:\\CUS Supply Chain\\All Division Reporting\\Field Retrievals\\Status Reports\\CVG\\Retrieval Status Report CVG\" &amp; _\nFormat(Date, \"yyyyMMdd\") &amp; \".xls\"\n\n\nsql = \"INSERT INTO tDaily_Report_CVG SELECT * FROM tRetrieval_Status_Report_CVG;\"\n\nintCounter = DCount(\"[Retrieval_ID]\", \"tRetrieval\", \"[BU] = 'CVG' AND [Retrieval_Status] = 'A'\")\n\n    If intCounter &gt; 0 Then\n        DoCmd.RunSQL sql\n        DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, \"tDaily_Report_CVG\", _\n        \" &amp; strOutputFileName &amp; \", True\n        SetAttr \" &amp; strOutputFileName &amp; \", vbReadOnly\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5411356, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/3211112718062/picture?type=large", "display_name": "John Krull", "link": "https://stackoverflow.com/users/5411356/john-krull"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594643244, "creation_date": 1447258292, "last_edit_date": 1594643244, "question_id": 33654811, "link": "https://stackoverflow.com/questions/33654811/trouble-copying-table-to-excel-based-on-criteria", "title": "Trouble copying table to Excel based on criteria", "body": "<p>I'm getting an error saying <em>Run-time error '424': Object required</em> when trying to run:  </p>\n\n<pre><code>Function CreateDailyReadOnlyCVG()\n\nDim sql, strStatusReport, strDailyCVG, strOutputFileName As String\n\nstrOutputFileName = \"mit-msp01\\cs\\CUS Supply Chain\\All Division Reporting\\Field Retrievals\\Status Reports\\CVG\" &amp; _\nFormat(Date, \"yyyyMMdd\") &amp; \".xlsx\"\n\n    If tRetrieval.[Retrieval_Status] = \"A\" And tRetrieval.[BU] = \"CVG\" Then _\n      sql = \"INSERT * FROM tRetrieval_Status_Report_CVG INSERT INTO tDaily_Report_CVG\"\n      DoCmd.RunSQL sql\n      DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12, \"Daily Report\", \" &amp; strOutputFileName &amp; \", True\n      SetAttr \" &amp; strOutputFileName &amp; \", vbReadOnly\n\nEnd Function\n</code></pre>\n\n<p>It compiles fine, but then I run it and get the error. Also, I feel like this won't run anyway.  </p>\n"}, {"tags": ["excel", "vba", "file", "iteration"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1447262283, "post_id": 33654705, "comment_id": 55085414, "body": "Take a look at <a href=\"http://stackoverflow.com/questions/14245712/cycle-through-sub-folders-and-files-in-a-user-specified-root-directory\">Cycle through sub-folders and files in a user-specified root directory</a> for a good way of getting each file.  Then you just need to open each file and check it for the string."}], "answers": [{"comments": [{"owner": {"reputation": 371, "user_id": 5551295, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3b3d7fc9a061d23de36c0321c4e98d?s=128&d=identicon&r=PG&f=1", "display_name": "dani jinji", "link": "https://stackoverflow.com/users/5551295/dani-jinji"}, "edited": false, "score": 0, "creation_date": 1447261887, "post_id": 33655799, "comment_id": 55085175, "body": "thank you though it still has a problam, becuase now if I have other file foramts in the folders, such as word docs, it doesn&#39;t skip them, it just says that cant open file."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 371, "user_id": 5551295, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3b3d7fc9a061d23de36c0321c4e98d?s=128&d=identicon&r=PG&f=1", "display_name": "dani jinji", "link": "https://stackoverflow.com/users/5551295/dani-jinji"}, "edited": false, "score": 0, "creation_date": 1447262026, "post_id": 33655799, "comment_id": 55085254, "body": "@danijinji I was editing the code, I think you took it before I edit it. Please see the edited version :)"}, {"owner": {"reputation": 371, "user_id": 5551295, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3b3d7fc9a061d23de36c0321c4e98d?s=128&d=identicon&r=PG&f=1", "display_name": "dani jinji", "link": "https://stackoverflow.com/users/5551295/dani-jinji"}, "edited": false, "score": 0, "creation_date": 1447262608, "post_id": 33655799, "comment_id": 55085584, "body": "thank you very much, works perfect! is there a difference in time run bitween the two? or do you have any suggestions for better run time?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 371, "user_id": 5551295, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3b3d7fc9a061d23de36c0321c4e98d?s=128&d=identicon&r=PG&f=1", "display_name": "dani jinji", "link": "https://stackoverflow.com/users/5551295/dani-jinji"}, "edited": false, "score": 0, "creation_date": 1447262701, "post_id": 33655799, "comment_id": 55085642, "body": "There shouldn&#39;t be any difference performance difference to care about. You are welcome."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1447261727, "last_edit_date": 1447261727, "creation_date": 1447261385, "answer_id": 33655799, "question_id": 33654705, "link": "https://stackoverflow.com/questions/33654705/iterate-through-files-and-subfolders-and-find-text/33655799#33655799", "title": "Iterate through files and subfolders, and find text", "body": "<blockquote>\n<pre><code>For Each oFile In oFolder.Files\n   strFile = Dir(oFolder &amp; \"\\*.xls*\")\n   Do While strFile &lt;&gt; \"\" '***THIS IS THE LOOP WHERE I THINK THE PROBLAM IS\n      ............\n      strFile = Dir\n   Loop\nNext oFile\n</code></pre>\n</blockquote>\n\n<p>Indeed, you have found where the error is. You dont need two nested loops here, that is what generates the duplicates. You should use either of the two techniques (using <code>Dir</code> or <code>oFolder.Files</code> collection), but not both.</p>\n\n<p>A quick fix of your code would be to use only the insider loop:</p>\n\n<pre><code>strFile = Dir(oFolder &amp; \"\\*.xls*\")\nDo While strFile &lt;&gt; \"\"\n    ......... ' &lt;~~ leave insider code as is\n    strFile = Dir\nLoop\n</code></pre>\n"}], "owner": {"reputation": 371, "user_id": 5551295, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3b3d7fc9a061d23de36c0321c4e98d?s=128&d=identicon&r=PG&f=1", "display_name": "dani jinji", "link": "https://stackoverflow.com/users/5551295/dani-jinji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 33655799, "answer_count": 1, "score": 0, "last_activity_date": 1447261727, "creation_date": 1447257976, "last_edit_date": 1447258394, "question_id": 33654705, "link": "https://stackoverflow.com/questions/33654705/iterate-through-files-and-subfolders-and-find-text", "title": "Iterate through files and subfolders, and find text", "body": "<p>I am working on something and I got stuck.\nI want to look for all xl files in my folder, and inside the subfolders of the folder, and look for a string, example \"bbb\" and prints all the files and cells where the string was found.</p>\n\n<p>for example, I have a folder named \"bla\", inside three xl files, and also another folder \"bla2\", with 4 more xl files. it looks for \"bbb\" in all the files, and prints a new worksheet with the path of the file and the cell that match.</p>\n\n<p>So, almost everything works, just it runs in one of my loops to many times, so it prints duplicate values.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub SearchFolders()\nDim fso As Object\nDim strSearch As String\nDim strFile As String\nDim wOut As Worksheet\nDim wbk As Workbook\nDim wks As Worksheet\nDim lRow As Long\nDim rFound As Range\nDim strFirstAddress As String\nDim oFolder, oSubfolder, oFile, queue As Collection\nDim HostFolder As String\n\nHostFolder = \"C:\\Users\\a\\Desktop\\xl files\"\n\nOn Error GoTo ErrHandler\nApplication.ScreenUpdating = False\n\nstrSearch = \"bbb\" 'the text to match\n\nSet wOut = Worksheets.Add\nlRow = 1\nWith wOut\n    .Cells(lRow, 1) = \"Workbook\"\n    .Cells(lRow, 2) = \"Worksheet\"\n    .Cells(lRow, 3) = \"Cell\"\n    .Cells(lRow, 4) = \"Text in Cell\"\n\n    'now some iterations through subfolders and folders\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set queue = New Collection\n    queue.Add fso.GetFolder(HostFolder)\n\n    Do While queue.Count &gt; 0\n        Set oFolder = queue(1)\n        queue.Remove 1 'dequeue\n\n        For Each oSubfolder In oFolder.SubFolders\n            queue.Add oSubfolder 'enqueue\n        Next oSubfolder\n        For Each oFile In oFolder.Files\n            strFile = Dir(oFolder &amp; \"\\*.xls*\")\n            '**********************************************************************\n            Do While strFile &lt;&gt; \"\" '***THIS IS THE LOOP WHERE I THINK THE PROBLAM IS\n                Set wbk = Workbooks.Open _\n                  (Filename:=oFolder &amp; \"\\\" &amp; strFile, _\n                  UpdateLinks:=0, _\n                  ReadOnly:=True, _\n                  AddToMRU:=False)\n\n                For Each wks In wbk.Worksheets\n                    Set rFound = wks.UsedRange.Find(strSearch, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)\n                    If Not rFound Is Nothing Then\n                        strFirstAddress = rFound.Address\n                    End If\n                    Do\n                        If rFound Is Nothing Then\n                            Exit Do\n                        Else\n                            lRow = lRow + 1\n                            .Cells(lRow, 1) = oFolder &amp; \"\\\" &amp; strFile\n                            .Cells(lRow, 2) = wks.Name\n                            .Cells(lRow, 3) = rFound.Address &amp; temp\n                            .Cells(lRow, 4) = rFound.Value\n                        End If\n                        Set rFound = wks.Cells.FindNext(After:=rFound)\n                    Loop While strFirstAddress &lt;&gt; rFound.Address\n                Next\n\n                wbk.Close (False)\n                strFile = Dir\n            Loop\n\n        Next oFile\n    Loop\n\n\n    .Columns(\"A:D\").EntireColumn.AutoFit\nEnd With\nMsgBox \"Done\"\nExitHandler:\nSet wOut = Nothing\nSet wks = Nothing\nSet wbk = Nothing\nSet oFolder = Nothing\nSet oSubfolder = Nothing\nSet oFile = Nothing\nSet queue = Nothing\nSet fso = Nothing\nApplication.ScreenUpdating = True\nExit Sub\n\nErrHandler:\n    MsgBox Err.Description, vbExclamation\n    Resume ExitHandler\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1447267978, "post_id": 33654591, "comment_id": 55088925, "body": "What happened when you used  <code>Selection.PasteAndFormat</code>. I see you have it there marked as a comment"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1447270208, "post_id": 33654591, "comment_id": 55090205, "body": "Also, I take it that you have opened <code>Word</code> with your <code>Excel - VBA</code> script. Try just using <code>Selection.PasteAndFormat</code> because this is a <code>Word</code> function. And have you added the <code>Microsoft Office - Word Library</code> to your <code>Excel-VBA</code> project?"}, {"owner": {"reputation": 13, "user_id": 5551181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932246f10dcca273ffb730bbbbceec73?s=128&d=identicon&r=PG&f=1", "display_name": "GSundberg", "link": "https://stackoverflow.com/users/5551181/gsundberg"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1447275042, "post_id": 33654591, "comment_id": 55092748, "body": "Hi Jean, when I used Selection.PasteAndFormat it came back as a Type Mismatch Error. And yes I have added the Word Library to the project as well."}, {"owner": {"reputation": 13, "user_id": 5551181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932246f10dcca273ffb730bbbbceec73?s=128&d=identicon&r=PG&f=1", "display_name": "GSundberg", "link": "https://stackoverflow.com/users/5551181/gsundberg"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1447275175, "post_id": 33654591, "comment_id": 55092821, "body": "Actually I was able to get the table to paste to the document finally using [oWord.Selection.PasteSpecial] but that only made it paste to the very top of the document since I have oDoc set as an Object  it references the beginning of the document and pastes it there. I need it to paste where the search runs into &#39;&lt;&lt;Checklist&gt;&gt;&#39; or at least at the bottom of the page instead."}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1447307659, "post_id": 33654591, "comment_id": 55103687, "body": "Have you tried just using <code>Selection.PasteSpecial</code> otherwise try <code>oDocRange.Selection.PasteSpecial</code> because your search range is <code>oDocRange</code>"}, {"owner": {"reputation": 13, "user_id": 5551181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932246f10dcca273ffb730bbbbceec73?s=128&d=identicon&r=PG&f=1", "display_name": "GSundberg", "link": "https://stackoverflow.com/users/5551181/gsundberg"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1447422098, "post_id": 33654591, "comment_id": 55159469, "body": "Using oDocRange gave me a Compile Error: &quot;Method or data member not found&quot; and then it highlighted Selection saying that&#39;s where the error was being made."}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1447422217, "post_id": 33654591, "comment_id": 55159545, "body": "Did you try <code>Selection.PasteSpecial</code> otherwise replace oDocRange with oDoc in the string  I posted previously"}, {"owner": {"reputation": 13, "user_id": 5551181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932246f10dcca273ffb730bbbbceec73?s=128&d=identicon&r=PG&f=1", "display_name": "GSundberg", "link": "https://stackoverflow.com/users/5551181/gsundberg"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1447428302, "post_id": 33654591, "comment_id": 55163686, "body": "Both Selection.PasteSpecial and oDoc.Selection.PasteSpecial came back as erros saying &quot;Select Method of Range class failed&quot;"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1447429813, "post_id": 33654591, "comment_id": 55164719, "body": "Ok so what about after the sSearch is found then use <code>Selection.delete</code> to delete the text then try <code>Selection.PasteSpecial</code> it might be that it&#39;s moaning about pasting a table over the text"}, {"owner": {"reputation": 13, "user_id": 5551181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932246f10dcca273ffb730bbbbceec73?s=128&d=identicon&r=PG&f=1", "display_name": "GSundberg", "link": "https://stackoverflow.com/users/5551181/gsundberg"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1447438123, "post_id": 33654591, "comment_id": 55170148, "body": "That would make sense, so would I just put sSearch.Selection.delete and then oDocRange.Selection.Paste?"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1447438224, "post_id": 33654591, "comment_id": 55170198, "body": "Just oDoc before both selection"}, {"owner": {"reputation": 13, "user_id": 5551181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932246f10dcca273ffb730bbbbceec73?s=128&d=identicon&r=PG&f=1", "display_name": "GSundberg", "link": "https://stackoverflow.com/users/5551181/gsundberg"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1447438581, "post_id": 33654591, "comment_id": 55170398, "body": "Using oDoc.Selection.Delete gave me the same error of &quot;Object doesn&#39;t support this property or method&quot; and it stopped the function before trying to PasteSpecial"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1447439385, "post_id": 33654591, "comment_id": 55170793, "body": "Ok I will have to do some testing next week then. So you have an excel data sheet and you are opening Word via Excel and then searching Word for a string which is contained in a certain cell which you then paste a define group of cells from excel into word"}, {"owner": {"reputation": 13, "user_id": 5551181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932246f10dcca273ffb730bbbbceec73?s=128&d=identicon&r=PG&f=1", "display_name": "GSundberg", "link": "https://stackoverflow.com/users/5551181/gsundberg"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1447439677, "post_id": 33654591, "comment_id": 55170922, "body": "The string I am searching for is not in a cell in word. It is just on a line at the top of the second page of my word template like so &lt;&lt;Checklist&gt;&gt;. and I just need it to replace that word with the table instead. Thanks!"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1447441694, "post_id": 33654591, "comment_id": 55171985, "body": "Good stuff. Will have a look when I&#39;m back at work"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5551181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932246f10dcca273ffb730bbbbceec73?s=128&d=identicon&r=PG&f=1", "display_name": "GSundberg", "link": "https://stackoverflow.com/users/5551181/gsundberg"}, "edited": false, "score": 0, "creation_date": 1447681470, "post_id": 33730683, "comment_id": 55241960, "body": "Well done! Thanks so much for the help this has been driving me crazy for a couple weeks now. Being specific with my references got it to work."}], "tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": true, "score": 0, "last_activity_date": 1447660650, "creation_date": 1447660650, "answer_id": 33730683, "question_id": 33654591, "link": "https://stackoverflow.com/questions/33654591/how-to-paste-a-dynamic-table-from-excel-to-word-using-the-find-function/33730683#33730683", "title": "How to paste a dynamic table from Excel to Word using the .Find function", "body": "<p>I believe the Error is because of the Excel.VBA script is getting used for Word.VBA script and visa versa.</p>\n\n<p>The script below is a simple Excel.VBA script which opens a specific Word Document and then  searches for <code>sSearch</code> and then copies a range of Cells from Excel. </p>\n\n<p>What I found was that I needed to reference each Application when I wanted to operate that Application. Example for Word I needed to use <code>Word.Selection</code> and for Excel <code>Excel.ActiveSheet.Range(\"A1:F13:)</code></p>\n\n<pre><code>Sub SomeSubRoutine()\n\nDim WordProgram As Object\nDim WordFile As Object\n\nWordFilePath = \"Some File Path\"\n\n'Starting Word\nSet WordProgram = CreateObject(\"Word.Application\")\n'Allowing it to be visible or not visible (For Developing its always good to have it visible\nWordProgram.Application.Visible = True\n\n'Opening the desired Word File\nSet WordFile = WordProgram.Documents.Open(Filename:=WordFilePath)\n\n'Here you can allocate your sSearch String\nsSearch = \"&lt;&lt;Checklist&gt;&gt;\"\n\nWith Word.Selection.Find\n\n    .ClearFormatting\n    .Text = \"&lt;&lt;Checklist&gt;&gt;\" 'sSearch\n   ' .Execute\n\n    Do While .Execute\n        If .Found = True Then\n\n            Set EventData = Excel.ActiveSheet.Range(\"A1:F13\")\n\n            'Copying Event Log from the opened Excel File\n            EventData.Copy\n\n            With Word.Selection\n\n                'Pasting Event Log into Word Doc\n                .PasteAndFormat Type:=wdFormatOriginalFormatting\n                'Selecting the Table\n                .Tables(1).Select\n                'Horizontal Centering Text in the Table Rows\n                .ParagraphFormat.Alignment = wdAlignParagraphCenter\n                'Center Table to Page Center\n                .Tables(1).Rows.Alignment = wdAlignRowCenter\n                'Vertical Centering of Text in the Table Row\n                .Cells.VerticalAlignment = wdCellAlignVerticalCenter\n                'Moving out of the Table to continue search\n                .MoveDown Unit:=wdLine, Count:=1, Extend:=wdMove\n\n            End With ' Ending \"Word.Selection\"\n\n        Else\n\n        'If nothing found then some other script can go here\n\n        End If 'Ending \"If .Found\"\n\n    Loop\n\nEnd With ' Ending \"Word.Selection.Find\"\n\n    'Quiting the Word Application\n    WordProgram.Quit\n\n    'clean up Objects for next use\n    Set WordProgram = Nothing\n    Set WordFile = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Just check your referencing to each application for all your search. </p>\n"}], "owner": {"reputation": 13, "user_id": 5551181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932246f10dcca273ffb730bbbbceec73?s=128&d=identicon&r=PG&f=1", "display_name": "GSundberg", "link": "https://stackoverflow.com/users/5551181/gsundberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 524, "favorite_count": 0, "accepted_answer_id": 33730683, "answer_count": 1, "score": 1, "last_activity_date": 1447660650, "creation_date": 1447257661, "last_edit_date": 1447272961, "question_id": 33654591, "link": "https://stackoverflow.com/questions/33654591/how-to-paste-a-dynamic-table-from-excel-to-word-using-the-find-function", "title": "How to paste a dynamic table from Excel to Word using the .Find function", "body": "<p>I am currently working on a project using VBA and it isn't a language I am  conformtable with.</p>\n\n<p>I am trying to take all of my data in the spreadsheets and paste them to a word template using a <code>.Find</code> function that finds the appropriate tags. </p>\n\n<p>It works until it gets to placing the final table at the end of the document after the Search finds the string its looking for. This is due to the table being dynamic and therefore will always have a different number of rows so it can't have a predefined table.</p>\n\n<pre><code> If Len(Trim(.Cells(1, lCol))) &lt;&gt; 0 Then\n    sSearch = .Cells(1, lCol)\n    sSearch = \"&lt;&lt;\" &amp; Trim(sSearch) &amp; \"&gt;&gt;\"\n    sTemp = .Cells(lRow, lCol)\n\n    With oDocRange.Find\n        .ClearFormatting\n        .Text = sSearch\n        .Replacement.ClearFormatting\n\n        ' check - how to figure if string type?\n        ' // If the cell text is &gt; 255 then we get an error.\n        ' // Calculate how many 'Chunks' of 250 are required to accomodate the long string.\n        ' // If more than 1 chunk of text then we replace the original template\n        ' // parameter with the first chunk and then insert additional parameters {2}, {3} etc\n         ' // into the template and replace those with the additional chunks\n        chunks = Round(Len(sTemp) / 250, 0)\n        sTemp = Replace(sTemp, vbNewLine, vbCr) \n        sTemp = Replace(sTemp, Chr(10), vbCr)                          \n\n        If sSearch = \"&lt;&lt;Checklist&gt;&gt;\" Then\n           rng2.Copy            \n           .Execute\n\n           Set wrdTable = oDoc.Tables.Add(Range:=oDocRange, NumRows:=1, numColumns:=4)\n           'With wrdTable\n               'Selection.PasteAndFormat\n               '.PasteSpecial Link:=False, DataType:=wdPasteMetafilePicture, Placement:=wdInLine, DisplayAsIcon:=False\n           'End With\n\n\n           '.Execute FindText:=\"&lt;&lt;Checklist&gt;&gt;\", ReplaceWith:=Selection, Format:=True, Replace:=wdReplaceAll\n\n        End If\n\n        If Len(sTemp) Mod 250 &gt; 0 Then chunks = chunks + 1\n        If chunks = 1 Then\n           .Replacement.Text = sTemp\n           .Execute Replace:=wdReplaceAll, Forward:=True, _\n                 Wrap:=wdFindContinue\n        Else\n            .Execute FindText:=sSearch, ReplaceWith:=\"{1}\", Replace:=wdReplaceAll\n            For i = 1 To chunks\n               chunk = Mid(sTemp, ((i - 1) * 250) + 1, 250)\n               If i &lt; chunks Then chunk = chunk &amp; \"{\" &amp; (i + 1) &amp; \"}\"\n               .Execute FindText:=\"{\" &amp; i &amp; \"}\", ReplaceWith:=chunk, Replace:=wdReplaceAll\n            Next i\n        End If 'If chunks is &gt; 0\n    End With ' the oDocRange.Find\nEnd If 'If the column value isn't blank\n</code></pre>\n\n<p><strong>sSearch</strong> is what words the program is looking through the word document for. And I want it to find Checklist, and replace it with the table I have set as <strong>rng2</strong>.\nIn the <code>If</code> statement I have a bunch of failed attempts but it always comes back to a <code>\"Type Mismatch\" Error</code>. </p>\n\n<p>Any help is greatly appreciated and I would be happy to give any more information. Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "edited": false, "score": 0, "creation_date": 1447256125, "post_id": 33653616, "comment_id": 55081302, "body": "transposeSplitLargeItemArray = some_return_value?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1447256464, "post_id": 33653616, "comment_id": 55081554, "body": "That&#39;s usually a compile error. Are you sure you&#39;ve copied your code correctly? Because this code compiles for me without raising any exception."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1447256506, "post_id": 33653616, "comment_id": 55081577, "body": "Usually this means you have an <code>End Sub</code> where you should have an <code>End Function</code>, or that you simply omitted the <code>End Function</code> (by mistake). Neither of those appear to be the case here."}, {"owner": {"reputation": 37, "user_id": 5494374, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2031dae3103125455d8d1c0f20e8e3f3?s=128&d=identicon&r=PG&f=1", "display_name": "OutOfMemory", "link": "https://stackoverflow.com/users/5494374/outofmemory"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1447256744, "post_id": 33653616, "comment_id": 55081733, "body": "@DavidZemens Yes, I copied the code correctly, and stil give me the error"}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "edited": false, "score": 0, "creation_date": 1447256820, "post_id": 33653616, "comment_id": 55081789, "body": "check the dhighs.count value?"}, {"owner": {"reputation": 37, "user_id": 5494374, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2031dae3103125455d8d1c0f20e8e3f3?s=128&d=identicon&r=PG&f=1", "display_name": "OutOfMemory", "link": "https://stackoverflow.com/users/5494374/outofmemory"}, "reply_to_user": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "edited": false, "score": 0, "creation_date": 1447256865, "post_id": 33653616, "comment_id": 55081822, "body": "@GSazheniuk But I use transposeSplitLargeItemArray in other codes in the same way they are here and it works well"}, {"owner": {"reputation": 37, "user_id": 5494374, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2031dae3103125455d8d1c0f20e8e3f3?s=128&d=identicon&r=PG&f=1", "display_name": "OutOfMemory", "link": "https://stackoverflow.com/users/5494374/outofmemory"}, "reply_to_user": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "edited": false, "score": 0, "creation_date": 1447257151, "post_id": 33653616, "comment_id": 55082030, "body": "@newjenn dhighs.count value is correct."}, {"owner": {"reputation": 37, "user_id": 5494374, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2031dae3103125455d8d1c0f20e8e3f3?s=128&d=identicon&r=PG&f=1", "display_name": "OutOfMemory", "link": "https://stackoverflow.com/users/5494374/outofmemory"}, "reply_to_user": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "edited": false, "score": 1, "creation_date": 1447257573, "post_id": 33653616, "comment_id": 55082321, "body": "Whell @GSazheniuk is right. Is the problem on copied codes from one side to another, accidently I didn&#39;t copied the last line. Sorry for the trouble, and thanks for the help. Still have problems with the code but this one is solve."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5494374, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2031dae3103125455d8d1c0f20e8e3f3?s=128&d=identicon&r=PG&f=1", "display_name": "OutOfMemory", "link": "https://stackoverflow.com/users/5494374/outofmemory"}, "edited": false, "score": 0, "creation_date": 1447259264, "post_id": 33654586, "comment_id": 55083505, "body": "False alarm, in the first&#39;s tests that error doesn&#39;t occurred but now sometimes give &quot;Expected end function&quot; other times this &quot;For control variable is already in use&quot;. The first error is in next w and second is in the first for of this error."}], "tags": [], "owner": {"reputation": 37, "user_id": 5494374, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2031dae3103125455d8d1c0f20e8e3f3?s=128&d=identicon&r=PG&f=1", "display_name": "OutOfMemory", "link": "https://stackoverflow.com/users/5494374/outofmemory"}, "is_accepted": true, "score": 0, "last_activity_date": 1447257649, "creation_date": 1447257649, "answer_id": 33654586, "question_id": 33653616, "link": "https://stackoverflow.com/questions/33653616/error-expected-end-function/33654586#33654586", "title": "Error - &quot;Expected End Function&quot;", "body": "<p>Here is the soluction for this problem</p>\n\n<pre><code>Function transposeSplitLargeItemArray(vITMs As Variant)\n    Dim v As Long, w As Long, vTMPs As Variant, vITM As Variant\n\n    ReDim vTMPs(LBound(vITMs) To UBound(vITMs), LBound(vITMs) To UBound(Split(vITMs(LBound(vITMs)), ChrW(8203))))\n    For v = LBound(vITMs) To UBound(vITMs)\n        vITM = Split(vITMs(v), ChrW(8203))\n        For w = LBound(vITM) To UBound(vITM)\n            vTMPs(v, w) = vITM(w)\n        Next w\n    Next v\n\n    transposeSplitLargeItemArray = vTMPs\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5494374, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2031dae3103125455d8d1c0f20e8e3f3?s=128&d=identicon&r=PG&f=1", "display_name": "OutOfMemory", "link": "https://stackoverflow.com/users/5494374/outofmemory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1087, "favorite_count": 0, "accepted_answer_id": 33654586, "answer_count": 1, "score": 0, "last_activity_date": 1447257649, "creation_date": 1447254958, "last_edit_date": 1447256315, "question_id": 33653616, "link": "https://stackoverflow.com/questions/33653616/error-expected-end-function", "title": "Error - &quot;Expected End Function&quot;", "body": "<p>I already have research and find some questions and answers similar, but I don't understand and still can't fix my problem. I have the next code:</p>\n\n<pre><code>Sub Keep_Highest_BC() \n\n    Debug.Print Time\n    Application.ScreenUpdating = False\n\n    Dim d As Long, dHIGHs As Object, dDUPEs As Object\n    Dim v As Long, vTMPs() As Variant, iCOLs As Long, Tam As Long\n\n    'On Error GoTo bm_Safe_Exit\n    Set dHIGHs = CreateObject(\"Scripting.Dictionary\")\n    Set dDUPEs = CreateObject(\"Scripting.Dictionary\")\n\n    With Worksheets(\"Sheet1\")\n        iCOLs = .Columns(15).Column\n        With .Cells(2, 1).Resize(.Cells(Rows.Count, 2).End(xlUp).Row - 1, iCOLs) \n            vTMPs = .Value2\n        End With\n    End With\n\n    For v = LBound(vTMPs, 1) To UBound(vTMPs, 1)\n        If vTMPs(v, 11) = \"In exploration\" Then\n            dHIGHs.Add Key:=vTMPs(v, 5), Item:=joinAtoAQ(vTMPs, v) \n        Else\n            dDUPEs.Add Key:=vTMPs(v, 5) &amp; v, Item:=joinAtoAQ(vTMPs, v)                                      \n        End If\n    Next v\n\n    With Worksheets(\"Sheet1\") \n        With .Cells(2, 1).Resize(.Cells(Rows.Count, 2).End(xlUp).Row - 1, iCOLs)\n            .ClearContents\n            With .Resize(dHIGHs.Count, iCOLs)\n                .Value = transposeSplitLargeItemArray(dHIGHs.items)\n            End With\n        End With\n    End With\n\nbm_Safe_Exit:\n    dHIGHs.RemoveAll: Set dHIGHs = Nothing\n    dDUPEs.RemoveAll: Set dDUPEs = Nothing\n\nApplication.ScreenUpdating = False\n\n    Debug.Print Time\nEnd Sub\n\nFunction joinAtoAQ(vTMP As Variant, ndx As Long)\n    Dim sTMP As String, v As Long\n\n    For v = LBound(vTMP, 2) To UBound(vTMP, 2)\n        sTMP = sTMP &amp; vTMP(ndx, v) &amp; ChrW(8203)\n    Next v\n    joinAtoAQ = Left$(sTMP, Len(sTMP) - 1)\nEnd Function\n\nFunction transposeSplitLargeItemArray(vITMs As Variant) 'Error is in this function\n\n    Dim v As Long, w As Long, vTMPs As Variant, vITM As Variant\n\n    ReDim vTMPs(LBound(vITMs) To UBound(vITMs), LBound(vITMs) To UBound(Split(vITMs(LBound(vITMs)), ChrW(8203))))\n    For v = LBound(vITMs) To UBound(vITMs)\n        vITM = Split(vITMs(v), ChrW(8203))\n        For w = LBound(vITM) To UBound(vITM)\n            vTMPs(v, w) = vITM(w)\n        Next w                                ' Error point in this line\n    Next v\n\nEnd Function\n</code></pre>\n\n<p>And when it came to the \"function transposeSplitLargeItemArray\" it said \"Expected end function\".  </p>\n\n<p>How could I resolve this and why the error?</p>\n"}, {"tags": ["sql", "vba", "excel"], "comments": [{"owner": {"reputation": 155, "user_id": 2953175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0500ba05552072c5d8813884535839?s=128&d=identicon&r=PG&f=1", "display_name": "ppw", "link": "https://stackoverflow.com/users/2953175/ppw"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1447256712, "post_id": 33653615, "comment_id": 55081711, "body": "@pnuts Just trying to be polite, will keep it in mind in the future."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 2953175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0500ba05552072c5d8813884535839?s=128&d=identicon&r=PG&f=1", "display_name": "ppw", "link": "https://stackoverflow.com/users/2953175/ppw"}, "edited": false, "score": 0, "creation_date": 1447255267, "post_id": 33653645, "comment_id": 55080691, "body": "I&#39;m getting an error &quot;Wrong number of arguments&quot; when I try your suggestion. (I&#39;ve changed nothing but added the syntax as recommended)"}, {"owner": {"reputation": 155, "user_id": 2953175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0500ba05552072c5d8813884535839?s=128&d=identicon&r=PG&f=1", "display_name": "ppw", "link": "https://stackoverflow.com/users/2953175/ppw"}, "edited": false, "score": 0, "creation_date": 1447255372, "post_id": 33653645, "comment_id": 55080770, "body": "I have replaced line 3 of the above strSQL with <code>Sum(ISNULL([tblRiskMain$].ScheduleImpact,0) - ISNULL([tblRiskMitigating$].ScheduleReduction,0)) as &#39;NewScheduleImpact&#39;</code>"}, {"owner": {"reputation": 119223, "user_id": 5070879, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7534153a9cc70ad4e20680d6ca1b09ff?s=128&d=identicon&r=PG&f=1", "display_name": "Lukasz Szozda", "link": "https://stackoverflow.com/users/5070879/lukasz-szozda"}, "reply_to_user": {"reputation": 155, "user_id": 2953175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0500ba05552072c5d8813884535839?s=128&d=identicon&r=PG&f=1", "display_name": "ppw", "link": "https://stackoverflow.com/users/2953175/ppw"}, "edited": false, "score": 1, "creation_date": 1447255468, "post_id": 33653645, "comment_id": 55080839, "body": "@ppw Try with IIF version <code>SUM(IIF(field1 IS NULL, 0, field1) - IIF(field2 IS NULL, 0 field2))</code> or <code>SUM(IIF(ISNULL(field), 0, field1) - IIF(ISNULL(field2), 0 field2))</code>"}, {"owner": {"reputation": 155, "user_id": 2953175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0500ba05552072c5d8813884535839?s=128&d=identicon&r=PG&f=1", "display_name": "ppw", "link": "https://stackoverflow.com/users/2953175/ppw"}, "edited": false, "score": 1, "creation_date": 1447255908, "post_id": 33653645, "comment_id": 55081150, "body": "The IIF version with IS NULL syntax worked like a charm, thank you very much for your help! Answer accepted."}], "tags": [], "owner": {"reputation": 119223, "user_id": 5070879, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7534153a9cc70ad4e20680d6ca1b09ff?s=128&d=identicon&r=PG&f=1", "display_name": "Lukasz Szozda", "link": "https://stackoverflow.com/users/5070879/lukasz-szozda"}, "is_accepted": true, "score": 3, "last_activity_date": 1447256163, "last_edit_date": 1447256163, "creation_date": 1447255032, "answer_id": 33653645, "question_id": 33653615, "link": "https://stackoverflow.com/questions/33653615/handling-null-values-in-an-sql-query-that-uses-sum/33653645#33653645", "title": "Handling NULL values in an SQL Query that uses SUM", "body": "<p>You can use <code>ISNULL/COALESCE</code>:</p>\n\n<pre><code>Select SUM(ISNULL(field1,0)) - SUM(ISNULL(field2,0)) as 'newField' \nfrom y;\n</code></pre>\n\n<p>or even combine to one <code>SUM</code>:</p>\n\n<pre><code>Select SUM(ISNULL(field1,0) - ISNULL(field2,0)) as 'newField' \nfrom y;\n</code></pre>\n\n<p>If <code>ISNULL/COALESCE</code> can be easily interchanged with <code>CASE WHEN</code> or <code>IIF</code>(<code>SQL Server 2012+</code>):</p>\n\n<pre><code>CASE WHEN field1 IS NULL THEN 0\n     ELSE field1\nEND;\n\nIIF(field1 IS NULL, 0, field1);\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Above code is <code>SQL Server</code> oriented, for <code>EXCEL</code> you should use:</p>\n\n<pre><code>SELECT SUM(IIF(field1 IS NULL, 0, field1) - IIF(field2 IS NULL, 0 field2)) \nFROM y\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 2953175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0500ba05552072c5d8813884535839?s=128&d=identicon&r=PG&f=1", "display_name": "ppw", "link": "https://stackoverflow.com/users/2953175/ppw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4461, "favorite_count": 0, "accepted_answer_id": 33653645, "answer_count": 1, "score": 2, "last_activity_date": 1447256532, "creation_date": 1447254954, "last_edit_date": 1447256532, "question_id": 33653615, "link": "https://stackoverflow.com/questions/33653615/handling-null-values-in-an-sql-query-that-uses-sum", "title": "Handling NULL values in an SQL Query that uses SUM", "body": "<p><strong>The Problem:</strong> </p>\n\n<p>I'm trying to execute a query in VBA (Excel) containing a calculation using SUM e.g. </p>\n\n<p><code>Select SUM(field1) - SUM(field2) as 'newField' from y</code>.</p>\n\n<p>If there are no null values or empty fields then the code works perfectly, however as soon as I have one null/empty value in either field1 or field2 then a blank is returned. </p>\n\n<p>So if <code>SUM(field1) = 17 and SUM(field2) = null</code> I want to see the query return <code>17</code> instead of a blank value.</p>\n\n<p><strong>The Code:</strong> </p>\n\n<pre><code>Public Function GetRiskRecords(ByVal strPrgNo As String) As Variant\n\nDim strSQL As String\n\nstrSQL = \"Select [tblRiskMitigating$].RiskID, [tblRiskMitigating$].Program_No, [tblRiskMain$].RiskID, [tblRiskMain$].Program_No, [tblRiskMain$].Department, [tblRiskMain$].DateAdded, [tblRiskMain$].OwnerID, [tblRiskMain$].Description, \" _\n        &amp; \" [tblRiskMain$].RiskTo, [tblRiskMain$].Probability, \" _\n        &amp; \" Sum([tblRiskMain$].ScheduleImpact) - Sum([tblRiskMitigating$].ScheduleReduction) as 'NewScheduleImpact', \" _\n        &amp; \" Sum([tblRiskMain$].CostImpact) - Sum([tblRiskMitigating$].CostReduction) as 'NewCostImpact'\" _\n        &amp; \" From [tblRiskMain$]\" _\n        &amp; \" Left Join [tblRiskMitigating$] on [tblRiskMain$].RiskID = [tblRiskMitigating$].RiskID AND [tblRiskMain$].Program_No = [tblRiskMitigating$].Program_No\" _\n        &amp; \" Where [tblRiskMain$].Program_No = '\" &amp; strPrgNo &amp; \"'\" _\n        &amp; \" Group By [tblRiskMitigating$].RiskID, [tblRiskMitigating$].Program_No, [tblRiskMain$].RiskID, [tblRiskMain$].Program_No, [tblRiskMain$].Department, [tblRiskMain$].DateAdded, [tblRiskMain$].OwnerID, [tblRiskMain$].Description, \" _\n        &amp; \" [tblRiskMain$].RiskTo, [tblRiskMain$].Probability\"\n\nCall Open_Conn(strDb)\nCall Open_RS(strSQL)\n\nIf rs.EOF Then\n    Debug.Print (\"Error: no records\")\nElse\n    GetRiskRecords = rs.GetRows\nEnd If\n\nCall Close_RS\nCall Close_Conn\n\nEnd Function\n</code></pre>\n\n<p><strong>The Background:</strong> </p>\n\n<p>I have done a bit of digging around and have experimented with adding isnull and iif at the start but I haven't been able to get these to work at all (so I've omitted them from the question to reduce confusion from my original (main) question).</p>\n"}, {"tags": ["vba", "charts", "datatable", "formatting"], "owner": {"reputation": 125, "user_id": 4944362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0449cca419faac931ee3495ca8721558?s=128&d=identicon&r=PG&f=1", "display_name": "WhoKnows19", "link": "https://stackoverflow.com/users/4944362/whoknows19"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 541, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1447254579, "creation_date": 1447254579, "question_id": 33653492, "link": "https://stackoverflow.com/questions/33653492/format-datatable-values-in-vba", "title": "Format datatable values in VBA", "body": "<p>Currently working on a vba script that makes charts automatically. I would like to add a datatable which is done using: .HasDataTable = True</p>\n\n<p>However I would like to show the values of series as percentages. Currently the value is defined as a Double containing all the values but not the right formatting. Using Format() or FormatPercent() will give the right values but returned in a String. This works for the datatable but not for the chart itself since it doesn't recognize the values anymore.</p>\n\n<p>My question comes down to whether it is possible to show the values as percentages in both the datatable and the chart? Without VBA it is easily done by formatting the data in the cells itself. The problem is that for formatting a String is returned but for the graph Integers or Doubles are needed.</p>\n\n<p>Below is part of the code. If I dim Ratio as String and use FormatPercent() I get the requested formatting but then the values in Ratio ar no longer doubles so it doesn't give the required chart.</p>\n\n<pre><code>Dim Ratio() As Double   \nDim labels() As String\n\nReDim Ratio(1 To Height)\nReDim labels(1 To Height)\n\n\nFor Each Column In sArray\n        labels(i) = Sheets(DataSheetName).Cells(LabelsRow, Column)\n        Ratio(i) = Math.Round(Sheets(DataSheetName).Cells(LabelsRow + 3, Column), 2)\n        i = i + 1\nNext Column\n\n\nSet myChtObj = Sheets(DrawSheetName).ChartObjects.Add(Left:=Left, Width:=Width, Top:=Top, Height:=HeightGraph)\n\nDim srsNew1 As Series\n\n ' Add the chart\nWith myChtObj.Chart\n    .ChartArea.Fill.Visible = False\n    .ChartArea.Border.LineStyle = xlNone\n    .PlotArea.Format.Fill.Solid\n    .PlotArea.Format.Fill.Transparency = 1\n    .HasTitle = True\n    .ChartTitle.text = Title\n    .HasLegend = False\n\n    .Axes(xlValue).TickLabels.NumberFormat = \"0%\"\n    .Axes(xlCategory, xlPrimary).HasTitle = False\n\n    'add data table\n    .HasDataTable = True\n\n     ' Make Line chart\n    .ChartType = xlLine\n\n\n     ' Add series\n    Set srsNew1 = .SeriesCollection.NewSeries\n    With srsNew1\n        .Values = Ratio\n        .XValues = labels\n        .Name = \"Ratio\"\n        .Interior.Color = clr3 'RGB(194, 84, 57)\n    End With\n\n\nEnd With\n</code></pre>\n"}, {"tags": ["python", "excel", "vba", "xlwings"], "answers": [{"tags": [], "owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "is_accepted": true, "score": 0, "last_activity_date": 1447264675, "creation_date": 1447264675, "answer_id": 33656821, "question_id": 33653211, "link": "https://stackoverflow.com/questions/33653211/how-to-interact-with-vba-objects-in-sheets-using-xlwings/33656821#33656821", "title": "How to interact with VBA objects in sheets using xlwings?", "body": "<p>This runs under the category \"Missing Features\" which is documented <a href=\"http://docs.xlwings.org/missing_features.html\" rel=\"nofollow\">here</a>.</p>\n\n<p>Since the workaround-syntax of the underlying appscript package (on Mac) is not really straight forward, here an example to get you started:</p>\n\n<pre><code>&gt;&gt;&gt; import xlwings as xw\n\n&gt;&gt;&gt; wb = xw.Workbook('WorkbookName')\n&gt;&gt;&gt; xw.Sheet('SheetName').xl_sheet.checkboxes['CheckBox_Name'].value.get()\nk.checkbox_off\n</code></pre>\n"}], "owner": {"reputation": 324, "user_id": 3187398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60fcbe1cab6d7ea53b06823d766f0f9?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/3187398/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 0, "accepted_answer_id": 33656821, "answer_count": 1, "score": 0, "last_activity_date": 1447264675, "creation_date": 1447253775, "question_id": 33653211, "link": "https://stackoverflow.com/questions/33653211/how-to-interact-with-vba-objects-in-sheets-using-xlwings", "title": "How to interact with VBA objects in sheets using xlwings?", "body": "<p>I'm trying to write a programmatic way to run through the CCIO 2016 Actuarial Value calculator (<a href=\"https://www.cms.gov/CCIIO/Resources/Regulations-and-Guidance/Downloads/Draft-2016-AV-Calculator.xlsm\" rel=\"nofollow\">download</a>) using <code>xlwings</code>. What I'd like to be able to do is interact with the checkboxes present in the different columns so I can vary the designs. My question is: how do I extract those as objects that can be interacted with?</p>\n\n<p>I am not married to <code>xlwings</code>, so I'd be happy with either an <code>xlwings</code> or non-<code>xlwings</code> solution.</p>\n\n<ul>\n<li>System: Mac</li>\n<li>Python: 2.7</li>\n<li>xlwings: 0.5.0</li>\n</ul>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "comments": [{"owner": {"reputation": 27294, "user_id": 535967, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/02c46fb58177c19c7a1b57f670bddbd1?s=128&d=identicon&r=PG", "display_name": "lisovaccaro", "link": "https://stackoverflow.com/users/535967/lisovaccaro"}, "reply_to_user": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "edited": false, "score": 0, "creation_date": 1447327847, "post_id": 33653167, "comment_id": 55113721, "body": "Microsoft Outlook crashes with the message &quot;Microsoft Outlook has stopped running&quot;. When I kill outlook I get &quot;The remote procedure failed&quot; on VBA"}], "answers": [{"tags": [], "owner": {"reputation": 398, "user_id": 4215263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OUqKk.png?s=128&g=1", "display_name": "andshrew", "link": "https://stackoverflow.com/users/4215263/andshrew"}, "is_accepted": false, "score": 0, "last_activity_date": 1447268744, "creation_date": 1447268744, "answer_id": 33657978, "question_id": 33653167, "link": "https://stackoverflow.com/questions/33653167/paste-cell-contents-in-outlook-email-maintaining-formatting/33657978#33657978", "title": "Paste cell contents in Outlook email maintaining formatting", "body": "<p>The issue is not that Outlook isn't running, it's that when you have programmatically opened Outlook it's in a different state to when a user has opened the application. Things such as the Word Editor are not going to work properly. You can verify this by stepping through your code, and you should see that after creating the <code>Outlook.Application</code> object that the Outlook icon is in the system tray and its tooltip will explain that another program is controlling Outlook.</p>\n\n<p>My suggestion would be to identify when Outlook is in this state, and then notify your user that they need to make sure Outlook is running prior to executing your code. One way to determine if it has been opened by the user is to look at the <code>Explorers</code> object. There will always be at least 1 when the user has opened Outlook, and if there isn't you could prompt the user to do something about it before trying again. </p>\n\n<pre><code>Dim oApp As Outlook.Application\n\n'   Open / Connect with Outlook\nSet oApp = CreateObject(\"Outlook.Application\")\n\n'   Check Outlook has been opened by a user\nWhile oApp.Explorers.Count = 0\n\n    If Not MsgBox(\"Please open Outlook and click Retry to try again.\", vbExclamation + vbRetryCancel, \"Outlook Not Open\") = vbRetry Then\n\n        Exit Sub\n    End If\n\nWend\n\n' Outlook has been opened by the user\n' Continue.....\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27294, "user_id": 535967, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/02c46fb58177c19c7a1b57f670bddbd1?s=128&d=identicon&r=PG", "display_name": "lisovaccaro", "link": "https://stackoverflow.com/users/535967/lisovaccaro"}, "is_accepted": false, "score": 0, "last_activity_date": 1447329660, "creation_date": 1447329660, "answer_id": 33670949, "question_id": 33653167, "link": "https://stackoverflow.com/questions/33653167/paste-cell-contents-in-outlook-email-maintaining-formatting/33670949#33670949", "title": "Paste cell contents in Outlook email maintaining formatting", "body": "<p>This is the only thing that worked. I defined OutApp and OutMail as Outlook objects and then got the inspector from the OutMail object. Using the .GetInspector method.</p>\n\n<pre><code>Public Sub CreateDraft(Destinatary As String, CC As String, Subject As String, Body As Range, Field1 As String, Field2 As String, Field3 As String, Optional AttachmentPath As String = \"\")\n    Dim OutApp As New Outlook.Application\n    Dim OutMail As Outlook.MailItem\n    Dim OutInspector As Outlook.Inspector\n    Dim WordDoc As Word.Document\n    Dim WordRange As Word.Range\n    Set OutMail = OutApp.CreateItem(olMailItem)\n    With OutMail\n        .To = Destinatary\n        .CC = CC\n        .Subject = Subject\n        If AttachmentPath &lt;&gt; \"\" Then .Attachments.Add (AttachmentPath)\n        .Display\n        Set OutInspector = OutMail.GetInspector\n        Set WordDoc = OutInspector.WordEditor\n        If Not (WordDoc Is Nothing) Then\n            Set WordRange = WordDoc.Range(0, 0)\n            Call Body.Copy\n            Call WordRange.PasteExcelTable(LinkedToExcel:=False, WordFormatting:=False, RTF:=False)\n            Application.CutCopyMode = False\n        End If\n        Call .Save\n        Call .Close(False)\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27294, "user_id": 535967, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/02c46fb58177c19c7a1b57f670bddbd1?s=128&d=identicon&r=PG", "display_name": "lisovaccaro", "link": "https://stackoverflow.com/users/535967/lisovaccaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1447329660, "creation_date": 1447253655, "last_edit_date": 1447328083, "question_id": 33653167, "link": "https://stackoverflow.com/questions/33653167/paste-cell-contents-in-outlook-email-maintaining-formatting", "title": "Paste cell contents in Outlook email maintaining formatting", "body": "<p>I created a procedure to create email drafts in Outlook. Users can modify the email body by writing it on a range, and it's added to the email maintaining all formatting options.</p>\n\n<p>My problem is that while my procedure worked at first, when I started using the word editor Microsoft Outlook starting crashing with the message \"Microsoft Outlook has stopped running\" and when I kill outlook I get message \"The remote procedure failed\" on VBA</p>\n\n<p>Why might this be happenning? is there a way to open Outlook before running the code to avoid the error?</p>\n\n<pre><code>Public Sub CreateDraft(Destinatary As String, CC As String, Subject As String, Body As Range, Optional AttachmentPath As String = \"\")\n    Dim OutApp  As Object\n    Dim OutMail As Object\n    Dim WordDoc As Word.Document\n    Dim WordRange As Word.Range\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n    With OutMail\n        .Display\n        .To = Destinatary\n        .CC = CC\n        .Subject = Subject\n        Set WordDoc = OutApp.ActiveInspector.WordEditor\n        Set WordRange = WordDoc.Goto(What:=wdGoToSection, Which:=wdGoToFirst) ' The code crashes here\n        Body.Copy\n        WordRange.PasteExcelTable LinkedToExcel:=False, WordFormatting:=False, RTF:=False\n        .HTMLBody = .HTMLBody\n        If (AttachmentPath &lt;&gt; \"\") Then\n            .Attachments.Add (AttachmentPath)\n        End If\n        .Save\n        .Close (False)\n    End With\n    Application.CutCopyMode = False\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "inputbox"], "comments": [{"owner": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 0, "creation_date": 1447253942, "post_id": 33653110, "comment_id": 55079775, "body": "Could not use Environ(&quot;username&quot;) to return the right username? (as a default value perhaps)"}], "answers": [{"comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 1, "creation_date": 1447256519, "post_id": 33653834, "comment_id": 55081583, "body": "Not the usual solution. <a href=\"http://stackoverflow.com/questions/16061562/trouble-with-inputboxes\" title=\"trouble with inputboxes\">stackoverflow.com/questions/16061562/trouble-with-inputboxes</a>  &amp; <a href=\"http://stackoverflow.com/questions/26264814/how-to-detect-if-user-select-cancel-inputbox-vba-excel\" title=\"how to detect if user select cancel inputbox vba excel\">stackoverflow.com/questions/26264814/&hellip;</a>"}], "tags": [], "owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "is_accepted": false, "score": 0, "last_activity_date": 1447255491, "creation_date": 1447255491, "answer_id": 33653834, "question_id": 33653110, "link": "https://stackoverflow.com/questions/33653110/input-box-type-mismatch-error/33653834#33653834", "title": "Input Box: Type Mismatch error", "body": "<p>I figured it out.</p>\n\n<p>Simply have to change</p>\n\n<pre><code>If filepath2 = False Then Exit Sub\n</code></pre>\n\n<p>to</p>\n\n<pre><code>If filepath2 = \"False\" Then Exit Sub\n</code></pre>\n\n<p>Just changing to a String.</p>\n"}], "owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 549, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447255491, "creation_date": 1447253471, "last_edit_date": 1447253513, "question_id": 33653110, "link": "https://stackoverflow.com/questions/33653110/input-box-type-mismatch-error", "title": "Input Box: Type Mismatch error", "body": "<p>I've got a Do-While loop in VBA asking the user for their company UserID. This is used to find a folder in their personal folder, doesn't really matter that much.</p>\n\n<p>I'm using an Input Box as I don't know how else I would do this:</p>\n\n<pre><code>Do\n    filepath2 = Application.InputBox(\"Enter your User FDIC\", \"UFDIC\")\n    If filepath2 = False Then Exit Sub\n    filepath3 = \"C:\\Users\\\" &amp; filepath2 &amp; \"\\Desktop\\NSC\\\"\n    Dir (filepath3)\nLoop While Not Dir(filepath3) &gt; \"\"\n</code></pre>\n\n<p>So basically, this will ask the user for UserID, if the user selects the button \"Cancel\", it will exit the sub.  If not, it will take the UserID and make sure it exists.\nI'm getting a Type Mismatch error when it comes to the line</p>\n\n<pre><code>If filepath2 = False Then Exit Sub\n</code></pre>\n\n<p>due to it expecting a Boolean value, I think.</p>\n\n<p>Should I be using something other than an Input Box?  </p>\n\n<p>If not, how do I type check?</p>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 2077, "user_id": 630535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dead23c2ab3ad4cd3b418fc6d33ec233?s=128&d=identicon&r=PG", "display_name": "nabuchodonossor", "link": "https://stackoverflow.com/users/630535/nabuchodonossor"}, "edited": false, "score": 3, "creation_date": 1447254761, "post_id": 33653101, "comment_id": 55080353, "body": "Complex single liners are <b><i>not</i></b> that &#39;elegant&#39;"}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1447257241, "post_id": 33653101, "comment_id": 55082082, "body": "Do you mean besides using something like a <code>Select Case</code>?  In some cases, that could provide a more elegant solution.  I also find the conditions can be a little bit more flexible than a normal If-Then conditional statement."}, {"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "reply_to_user": {"reputation": 2077, "user_id": 630535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dead23c2ab3ad4cd3b418fc6d33ec233?s=128&d=identicon&r=PG", "display_name": "nabuchodonossor", "link": "https://stackoverflow.com/users/630535/nabuchodonossor"}, "edited": false, "score": 0, "creation_date": 1447260574, "post_id": 33653101, "comment_id": 55084362, "body": "@nabuchodonossor I generally agree, but I find myself using them for stuff like <code>Dim v0(): ReDim v0(0 To Len(t))</code> where I cannot create an array with variable dims in one line but want to condense the functionality into functional group. I guess the coder has the final say on what is <b>Complex</b> and I&#39;d argue a two result conditional isn&#39;t..."}, {"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "reply_to_user": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1447260734, "post_id": 33653101, "comment_id": 55084473, "body": "@Demetri, I use the select function when I&#39;d otherwise be creating several if statements in series; how would a select case benefit when there&#39;s only one if statement with multiple reactionary statements"}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1447261606, "post_id": 33653101, "comment_id": 55084988, "body": "Well, the short answer is that there is no benefit in that case.  I might have misunderstood your question.  What I do sometimes is use an underscore to link related if then statements in a way that makes sense to me, but the &quot;falsifying&quot; problem, as well as problems with loops, limits it&#39;s application.  I&#39;ll provide an example of what I do as a &quot;solution&quot;, but I don&#39;t believe it is really what you&#39;re looking for, sorry."}], "answers": [{"comments": [{"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "edited": false, "score": 0, "creation_date": 1447264568, "post_id": 33655975, "comment_id": 55086789, "body": "I updated my original ask with a better example of the direction I&#39;m trying to head. Thanks for your input"}], "tags": [], "owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "is_accepted": false, "score": 1, "last_activity_date": 1447261943, "creation_date": 1447261943, "answer_id": 33655975, "question_id": 33653101, "link": "https://stackoverflow.com/questions/33653101/vba-if-statements-condensed/33655975#33655975", "title": "VBA If Statements Condensed", "body": "<p>I sometimes do something like the below:</p>\n\n<p>(I know most people would argue it is poor programming)</p>\n\n<pre><code>If s = t _\n      Then LD = 0:Exit Function _\n      Else If a=b _\n                Then LD = 1 _\n                Else If c=d then LD = 2 Else LD = 3:Exit Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "edited": false, "score": 0, "creation_date": 1447269425, "post_id": 33657038, "comment_id": 55089744, "body": "It&#39;s this what you were aiming at, if so please help to keep the site updated and acknowledge the answer. Thanks..."}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 1, "last_activity_date": 1447266440, "last_edit_date": 1447266440, "creation_date": 1447265411, "answer_id": 33657038, "question_id": 33653101, "link": "https://stackoverflow.com/questions/33653101/vba-if-statements-condensed/33657038#33657038", "title": "VBA If Statements Condensed", "body": "<p>Try this</p>\n\n<pre><code> cost = IIf(Mid$(s, I + 1, 1) = Mid$(t, J + 1, 1), 0, 1)\n</code></pre>\n"}], "owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 398, "favorite_count": 0, "accepted_answer_id": 33657038, "answer_count": 2, "score": 0, "last_activity_date": 1447266440, "creation_date": 1447253444, "last_edit_date": 1531164843, "question_id": 33653101, "link": "https://stackoverflow.com/questions/33653101/vba-if-statements-condensed", "title": "VBA If Statements Condensed", "body": "<p>Excel 2015, Access 2015</p>\n\n<p>General State:</p>\n\n<pre><code>if s=t then\n    LD = 0\n    Exit Function\nend if\n</code></pre>\n\n<p>Current State:</p>\n\n<pre><code>If s = t Then: LD = 0: Exit Function\n</code></pre>\n\n<p>Goal:\nIs there a way to condense multiple conditional statements into one line without essentially falsifying a return? I'm looking for a more elegant solution.</p>\n\n<hr>\n\n<p>Inspiration: C Code from <a href=\"https://en.wikipedia.org/wiki/Levenshtein_distance\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Levenshtein_distance</a></p>\n\n<pre><code>for (int j = 0; j &lt; t.Length; j++)\n{\n    var cost = (s[i] == t[j]) ? 0 : 1;\n    v1[j + 1] = Minimum(v1[j] + 1, v0[j + 1] + 1, v0[j] + cost);\n}\n</code></pre>\n\n<p>Changed into this in VBA:</p>\n\n<pre><code>For j = 0 To Len(t) - 1\n    If Mid$(s, i + 1, 1) = Mid$(t, j + 1, 1) Then cost = 0 Else cost = 1\n    v1(j + 1) = VBAMin(v1(j) + 1, v0(j + 1) + 1, v0(j) + cost)\nNext j\n</code></pre>\n"}, {"tags": ["arrays", "excel", "multidimensional-array", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1447255511, "post_id": 33653089, "comment_id": 55080873, "body": "It will be much simpler to paste area by area than anything else."}, {"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1447257661, "post_id": 33653089, "comment_id": 55082377, "body": "@Rory, sure and I know. I want one array with alla record from 2 or more range, after  i can loop each item of this array to do my code."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1447257848, "post_id": 33653089, "comment_id": 55082519, "body": "It will still be easier to process each area as an array. There is no simple method I&#39;m aware of to create one array from discontiguous ranges (for this <b>specific</b> example you could use a simple evaluate as the data is all in one column separated by blanks)"}, {"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1447258483, "post_id": 33653089, "comment_id": 55082935, "body": "thank but is not that I search. I need one array with all record. I tryed also to set arr = range (ra,rb) and when I paste the array, the code paste correct from C1 to  C10, blanck cell from C11 to C19 , C20 with correct value. to show all value I do change the output range to Range(&quot;C1:C30&quot;) to have 10 record, 10 blanck cell and the last 10 record. I was convinced we couldn&#39;t do, I asked you to have a confirm. Thank"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447259548, "post_id": 33653089, "comment_id": 55083705, "body": "you will need to iterate through each cell in the range rc and insert them individually into the array."}, {"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447259996, "post_id": 33653089, "comment_id": 55084011, "body": "@ScottCraner, ya, same I usually do, this is the unique way. tnk"}], "owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1447257281, "creation_date": 1447253402, "last_edit_date": 1531164843, "question_id": 33653089, "link": "https://stackoverflow.com/questions/33653089/array-from-cell-not-continuos", "title": "array from cell not continuos", "body": "<p>create one array form one range is basic</p>\n\n<pre><code>dim arr as range\narr = range(\"A1:A10)\n</code></pre>\n\n<p>I test to creare one array from 2 range of cell using <code>UNION</code> but this function run only to modific cell proprierties non to paste the array in another range.\nThis is my exaple, col A is the value col B is the result.\n<a href=\"https://i.stack.imgur.com/0KyxA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0KyxA.png\" alt=\"enter image description here\"></a></p>\n\n<p>My code:</p>\n\n<pre><code>Sub FuseRangeToArray()\n    Dim ra As Range\n    Dim rb As Range\n    Dim rc As Range\n    Dim a1 As Range\n    Set ra = Range(\"A1:A10\")     'the range is setting only for this exaple normally I pass it when I call my function\n    Set rb = Range(\"A20:A29\")    'idem\n    Set rc = Union(ra, rb)\n    rc.Select\n    With Selection\n        .Interior.Color = vbGreen\n    End With\n    Range(\"C1:C20\") = rc.Value '20 is the count of all record, usually I use C:lastRow)\n\nEnd Sub\n</code></pre>\n\n<p>I can to populate the array with loop of 2 range, but I looking for another way</p>\n"}, {"tags": ["arrays", "vba", "excel", "transpose"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1447252108, "post_id": 33652602, "comment_id": 55078588, "body": "How big is the array?  Transpose has a limit to the number of items it will accept."}, {"owner": {"reputation": 2318, "user_id": 4454635, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/68948c08bbd4e872c4ea3726bfeb97d8?s=128&d=identicon&r=PG&f=1", "display_name": "horace_vr", "link": "https://stackoverflow.com/users/4454635/horace-vr"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447252296, "post_id": 33652602, "comment_id": 55078693, "body": "@ScottCraner: The array has just over 3 x 250 elements, but this is a fair point, since I expect this to go well beyond 100.000 when deployed"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1447252390, "post_id": 33652602, "comment_id": 55078737, "body": "Then look <a href=\"http://stackoverflow.com/questions/33589463/get-entire-row-of-array/33589875#33589875\">here</a>.  @Jeeped gave a great answer with a custom function to flip it."}, {"owner": {"reputation": 2318, "user_id": 4454635, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/68948c08bbd4e872c4ea3726bfeb97d8?s=128&d=identicon&r=PG&f=1", "display_name": "horace_vr", "link": "https://stackoverflow.com/users/4454635/horace-vr"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447252657, "post_id": 33652602, "comment_id": 55078903, "body": "@ScottCraner: was no aware of those limitations, thanks a lot for pointing that out! However, the test I am using is definitely not that large. Could there be another cause...?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1447253162, "post_id": 33652602, "comment_id": 55079238, "body": "Do you have any long text values in the array? (longer than 255 characters)"}, {"owner": {"reputation": 2318, "user_id": 4454635, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/68948c08bbd4e872c4ea3726bfeb97d8?s=128&d=identicon&r=PG&f=1", "display_name": "horace_vr", "link": "https://stackoverflow.com/users/4454635/horace-vr"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1447254496, "post_id": 33652602, "comment_id": 55080163, "body": "@Rory: yes, I do; does that impact the Transpose, or is it a wider issue ?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1447254582, "post_id": 33652602, "comment_id": 55080229, "body": "Yes, it will cause <code>Transpose</code> a problem. You&#39;ll need to loop."}, {"owner": {"reputation": 2318, "user_id": 4454635, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/68948c08bbd4e872c4ea3726bfeb97d8?s=128&d=identicon&r=PG&f=1", "display_name": "horace_vr", "link": "https://stackoverflow.com/users/4454635/horace-vr"}, "edited": false, "score": 0, "creation_date": 1447254856, "post_id": 33652602, "comment_id": 55080417, "body": "Very good to know about both these limitations; who will post the answer now? :)"}], "owner": {"reputation": 2318, "user_id": 4454635, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/68948c08bbd4e872c4ea3726bfeb97d8?s=128&d=identicon&r=PG&f=1", "display_name": "horace_vr", "link": "https://stackoverflow.com/users/4454635/horace-vr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 356, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1447253261, "creation_date": 1447251938, "last_edit_date": 1447253261, "question_id": 33652602, "link": "https://stackoverflow.com/questions/33652602/array-into-worksheet-type-mismatch", "title": "Array into worksheet - Type Mismatch", "body": "<p>I am trying to unload an array into a worksheet. This code works with no errors, but it creates three rows and many columns (as I would expect):</p>\n\n<pre><code>Dim ToKeepArray() As Variant\nReDim ToKeepArray(1 To 3, 1 To LastRow) As Variant\n'Populate the Array (this part works fine)\n\nDim TargetRange As Range\nSet TargetRange = Sheets(\"TO_KEEP\").Range(Cells(1, 1), Cells(1, 1))\n\nTargetRange.Resize(UBound(ToKeepArray, 1), UBound(ToKeepArray, 2)).Value = ToKeepArray\n</code></pre>\n\n<p>However, if I try to transpose the whole thing by using:</p>\n\n<pre><code>TargetRange.Resize(UBound(ToKeepArray, 2), UBound(ToKeepArray, 1)).Value = Application.Transpose(ToKeepArray)\n</code></pre>\n\n<p>I get a <code>Type Mismatch</code> error; same if I drop the <code>.value</code>.  </p>\n\n<p>I know how to loop through the array (so I could find a workaround for what I am trying to do) but what am I missing, why am I getting that error? What is mismatched...?</p>\n"}, {"tags": ["excel", "vba", "excel-2010"], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 5589891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed8ff5139c6d8a59e0ac214f8c73cdf3?s=128&d=identicon&r=PG&f=1", "display_name": "Bunc", "link": "https://stackoverflow.com/users/5589891/bunc"}, "is_accepted": false, "score": 0, "last_activity_date": 1452775266, "creation_date": 1452775266, "answer_id": 34789902, "question_id": 33652565, "link": "https://stackoverflow.com/questions/33652565/display-userform-that-exists-in-add-in/34789902#34789902", "title": "Display Userform that exists in Add-in", "body": "<p>If i understand your problem correctly...\nu need to have sub that call's the form</p>\n\n<pre><code>sub showMyForm()\n   myForm.show\nend sub\n</code></pre>\n\n<p>add this code in add-in and call it from inside workbook that references the add-in (eg. via button).</p>\n"}], "owner": {"reputation": 2549, "user_id": 2107488, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/64b2e5153b56319b7560dec00634ee97?s=128&d=identicon&r=PG&f=1", "display_name": "Kaja", "link": "https://stackoverflow.com/users/2107488/kaja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452775266, "creation_date": 1447251789, "last_edit_date": 1447254222, "question_id": 33652565, "link": "https://stackoverflow.com/questions/33652565/display-userform-that-exists-in-add-in", "title": "Display Userform that exists in Add-in", "body": "<p>I have saved my project, which contains a form, as .xla.</p>\n\n<p>I would like to use this add in in another excel projects. If I add this add in in another projects. Is there a way to run directly my forms (and not forstly going to Visual basic and then run the form)</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 0, "creation_date": 1447254439, "post_id": 33651525, "comment_id": 55080123, "body": "Add a boolean variable to the module named, for instance, processing and set it to true before you change the value to an empty string. Then add an if statement to exit the sub at the beginning of the sub when the value is true. Reset the variable to false after setting the value to an empty string."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 3096324, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1372d201385e3c147b9abe679c6b70c5?s=128&d=identicon&r=PG&f=1", "display_name": "FredGooch", "link": "https://stackoverflow.com/users/3096324/fredgooch"}, "edited": false, "score": 0, "creation_date": 1447249529, "post_id": 33651655, "comment_id": 55076931, "body": "Thanks. Might just go with changing the If condition to not execute if the text is &quot;&quot;, which was my original idea. I was just wondering if there was some built in property or function I was missing that could do what I wanted, I don&#39;t wanna add all these extra lines of code. I&#39;ll keep it in mind for the future, though!"}], "tags": [], "owner": {"reputation": 613, "user_id": 2213887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U44UC.png?s=128&g=1", "display_name": "Hugues Paquet Blanchette", "link": "https://stackoverflow.com/users/2213887/hugues-paquet-blanchette"}, "is_accepted": false, "score": 1, "last_activity_date": 1447248820, "creation_date": 1447248820, "answer_id": 33651655, "question_id": 33651525, "link": "https://stackoverflow.com/questions/33651525/how-to-clear-userform-textbox-without-calling-the-change-function/33651655#33651655", "title": "How to clear userform textbox without calling the _Change function?", "body": "<p>prevent user from typing Alpha chars:</p>\n\n<pre><code>Private Sub TextBox1_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)\nSelect Case KeyAscii\n    Case Asc(\"0\") To Asc(\"9\")\n    Case Asc(\"-\")\n        If Instr(1,Me.TextBox1.Text,\"-\") &gt; 0 Or Me.TextBox1.SelStart &gt; 0 Then\n            KeyAscii = 0\n        End If\n    Case Asc(\".\")\n        If InStr(1, Me.TextBox1.Text, \".\") &gt; 0 Then\n            KeyAscii = 0\n        End If\n    Case Else\n        KeyAscii = 0\nEnd Select\nEnd Sub\n</code></pre>\n\n<p>Hope this helps!\n-Hugues</p>\n"}, {"comments": [{"owner": {"reputation": 181, "user_id": 3096324, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1372d201385e3c147b9abe679c6b70c5?s=128&d=identicon&r=PG&f=1", "display_name": "FredGooch", "link": "https://stackoverflow.com/users/3096324/fredgooch"}, "edited": false, "score": 0, "creation_date": 1447250187, "post_id": 33651803, "comment_id": 55077350, "body": "Ah, this is slightly better, but still going to go with just editing the If condition. Thanks though!"}], "tags": [], "owner": {"reputation": 472, "user_id": 3258942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cca53c78fc3f6fac7913a4abfd39c8?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3258942/christian"}, "is_accepted": true, "score": 3, "last_activity_date": 1447249439, "last_edit_date": 1447249439, "creation_date": 1447249271, "answer_id": 33651803, "question_id": 33651525, "link": "https://stackoverflow.com/questions/33651525/how-to-clear-userform-textbox-without-calling-the-change-function/33651803#33651803", "title": "How to clear userform textbox without calling the _Change function?", "body": "<p>A simple way to achieve this is to use the <code>_Exit()</code> Function:</p>\n\n<pre><code>Private Sub TextBox1_Exit(ByVal Cancel As MSForms.ReturnBoolean)\nIf Not IsNumeric(TextBox1.Value) Then\n        MsgBox \"Please only enter numeric values.\", vbCritical, \"Error\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>This triggers as soon as the text box looses Focus.</p>\n"}, {"tags": [], "owner": {"reputation": 181, "user_id": 3096324, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1372d201385e3c147b9abe679c6b70c5?s=128&d=identicon&r=PG&f=1", "display_name": "FredGooch", "link": "https://stackoverflow.com/users/3096324/fredgooch"}, "is_accepted": false, "score": 0, "last_activity_date": 1447249749, "creation_date": 1447249749, "answer_id": 33651961, "question_id": 33651525, "link": "https://stackoverflow.com/questions/33651525/how-to-clear-userform-textbox-without-calling-the-change-function/33651961#33651961", "title": "How to clear userform textbox without calling the _Change function?", "body": "<p>Seems since there is nothing built in that can do what I want, this would be the simplest way to handle the problem:</p>\n\n<pre><code>Private Sub txtbox1_Change()\ntxt = userform.txtbox1.Value\nIf (Not IsNumeric(txt)) And (txt &lt;&gt; \"\") Then\n    disp = MsgBox(\"Please only enter numeric values.\", vbOKCancel, \"Entry Error\")\n    txtbox1.Text = \"\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 429, "user_id": 4980571, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6dd665a9d36a1da523cc706f05a27e4a?s=128&d=identicon&r=PG&f=1", "display_name": "Estevam Garcia", "link": "https://stackoverflow.com/users/4980571/estevam-garcia"}, "is_accepted": false, "score": 1, "last_activity_date": 1447251109, "creation_date": 1447251109, "answer_id": 33652366, "question_id": 33651525, "link": "https://stackoverflow.com/questions/33651525/how-to-clear-userform-textbox-without-calling-the-change-function/33652366#33652366", "title": "How to clear userform textbox without calling the _Change function?", "body": "<p>You can do this way, as shown <a href=\"http://www.ozgrid.com/VBA/validate-numbers.htm\" rel=\"nofollow\">here</a></p>\n\n<pre><code>Private Sub TextBox1_Change()\n    OnlyNumbers\nEnd Sub\n\nPrivate Sub OnlyNumbers()\n\n    If TypeName(Me.ActiveControl) = \"TextBox\" Then\n\n        With Me.ActiveControl\n\n            If Not IsNumeric(.Value) And .Value &lt;&gt; vbNullString Then\n\n                MsgBox \"Sorry, only numbers allowed\"\n\n                .Value = vbNullString\n\n            End If\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1447256308, "last_edit_date": 1447256308, "creation_date": 1447253596, "answer_id": 33653150, "question_id": 33651525, "link": "https://stackoverflow.com/questions/33651525/how-to-clear-userform-textbox-without-calling-the-change-function/33653150#33653150", "title": "How to clear userform textbox without calling the _Change function?", "body": "<p>You can add this line at the very beginning </p>\n\n<pre><code>sub txtbox1_Change()\n    If txtbox1.Text = \"\" Or txtbox1.Text = \"-\" Then Exit Sub  '&lt;~~~\n</code></pre>\n\n<p>Alternatively, I found this even shorter and interesting:</p>\n\n<pre><code>Private Sub txtbox1_Change()\n    If Not IsNumeric(txtbox1.Text &amp; \"0\") Then\n       disp = MsgBox(\"Please only enter numeric values.\", vbOKCancel, \"Entry Error\")\n       txtbox1.Text = \"\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>The interesting part is that it accepts to enter things like \".2\", \"-3.2\", and also <strong>\"5e3\"</strong>, the last case being not allowed by the other methods!</p>\n\n<p>Turning it into a while loop can remove only the last bad typed character(s):</p>\n\n<pre><code>Private Sub txtbox1_Change()\n    t = txtbox1.Text\n    Do While t &lt;&gt; \"\" And Not IsNumeric(t) And Not IsNumeric(t &amp; \"0\")\n       t = Mid(t, 1, Len(t) - 1)\n    Loop\n    txtbox1.Text = t\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "is_accepted": false, "score": 0, "last_activity_date": 1447253809, "creation_date": 1447253809, "answer_id": 33653223, "question_id": 33651525, "link": "https://stackoverflow.com/questions/33651525/how-to-clear-userform-textbox-without-calling-the-change-function/33653223#33653223", "title": "How to clear userform textbox without calling the _Change function?", "body": "<p>Declare a global boolean and at the beginning of each sub, add an if statement which exits the sub if the boolean is true. When you get an error message, set the value to true, and nothing will happen. Then set it to false again.</p>\n\n<pre><code>Dim ufEventsDisabled As Boolean\n\nPrivate Sub txtbox1_Change()\n  'repeat the following line everywhere that you don't want to update\n  if ufeventsdisabled then exit sub\n  txt = userform.txtbox1.Value\n  If Not IsNumeric(txt) Then\n    disp = MsgBox(\"Please only enter numeric values.\", vbOKCancel, \"Entry Error\")\n    ufeventsdisabled = true\n    txtbox1.Text = \"\"\n    ufeventsdisabled = false\n  End If\nEnd Sub\n</code></pre>\n\n<p>*Credit goes to mikerickson from <a href=\"http://www.mrexcel.com/forum/excel-questions/393098-how-set-combobox-default-value.html\" rel=\"nofollow\" title=\"mrexcel.com\">mrexcel.com</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 1373851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce562bc1cdd5b6996955e4a985d6ac9?s=128&d=identicon&r=PG", "display_name": "DFPercush", "link": "https://stackoverflow.com/users/1373851/dfpercush"}, "is_accepted": false, "score": 0, "last_activity_date": 1447256270, "creation_date": 1447256270, "answer_id": 33654114, "question_id": 33651525, "link": "https://stackoverflow.com/questions/33651525/how-to-clear-userform-textbox-without-calling-the-change-function/33654114#33654114", "title": "How to clear userform textbox without calling the _Change function?", "body": "<p>You can't stop the _Changed event from firing. I would advise you to back up a couple of steps in your design and ask if you can get the job done without having to clear it in the first place. In FoxPro we would set the 'format' to 9999.99 and it would automatically prevent users from typing alpha characters, but I think that particular field was unique to FP. You can hook the _Changed event and perform your own validation there. I would suggest not filtering individual key strokes, but validating the whole value each time it's changed. </p>\n\n<pre><code>If Text1.Value &lt;&gt; str(val(Text1.Value)) Then\n    Text1.Value = previousValue\nEndIf\n</code></pre>\n\n<p>... which will require keeping a backup variable for the previous value, but I'm sure you can figure that out. There may be certain edge cases where VB's string-number conversion functions don't exactly match, like exponential notation as you mentioned, so you may need a more sophisticated check than that. Anyway, this will make it impossible to even enter a bad value. It also provides a better user experience because the feedback is more immediate and intuitive. You may notice that the value is being changed inside the _Changed event, which should raise a knee jerk red flag in your mind about infinite loops. If you do this, make sure that your previous value has already been validated, keeping in mind that the initial value will be an empty string. As such, the recursive call will skip over the If block thus terminating the loop. In any case, what you would consider \"better\" may differ depending on who you ask, but hopefully I've given you some food for thought.</p>\n"}], "owner": {"reputation": 181, "user_id": 3096324, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1372d201385e3c147b9abe679c6b70c5?s=128&d=identicon&r=PG&f=1", "display_name": "FredGooch", "link": "https://stackoverflow.com/users/3096324/fredgooch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5488, "favorite_count": 0, "accepted_answer_id": 33651803, "answer_count": 7, "score": 1, "last_activity_date": 1447256308, "creation_date": 1447248348, "last_edit_date": 1531164843, "question_id": 33651525, "link": "https://stackoverflow.com/questions/33651525/how-to-clear-userform-textbox-without-calling-the-change-function", "title": "How to clear userform textbox without calling the _Change function?", "body": "<p>I have a userform in Excel with textboxes meant for numeric data only. I want to clear the textbox when it detects bad entry and gives an error message, but I don't want to have the textbox's _Change function called again or else the message pops up twice because I change the text to \"\". I didn't see a built in clear function.. is there a better way to do this?</p>\n\n<pre><code>Private Sub txtbox1_Change()\n    txt = userform.txtbox1.Value\n    If Not IsNumeric(txt) Then\n        disp = MsgBox(\"Please only enter numeric values.\", vbOKCancel, \"Entry Error\")\n        txtbox1.Text = \"\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1447247271, "post_id": 33651167, "comment_id": 55075682, "body": "Have you considered a Scripting.Dictionary object with its own primary unique index on the <b>key</b>? Also, if all you want is to prove existance, why not <code>Application.Match</code> instead of VLOOKUP?"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1447247669, "post_id": 33651167, "comment_id": 55075897, "body": "A scripting disctionnary is indeed probably the best solution. For formulae, &#180;COUNTIF()&#180; is a zillion times faster than &#180;VLOOKUP()&#180;"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1447248807, "post_id": 33651167, "comment_id": 55076501, "body": "Use keys when you construct the collection: <a href=\"http://stackoverflow.com/a/21095201/4604845\">stackoverflow.com/a/21095201/4604845</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1447249911, "post_id": 33651167, "comment_id": 55077171, "body": "@iDevlop - The <a href=\"https://support.office.com/en-us/article/match-function-0600e189-9f3c-4e4f-98c1-943a0eb427ca\" rel=\"nofollow noreferrer\">MATCH function</a> is even faster (see <a href=\"http://stackoverflow.com/questions/29972016/is-there-a-faster-countif/29983885?s=1|7.5670#29983885\">Is there a faster CountIF</a>)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1447251809, "post_id": 33651167, "comment_id": 55078379, "body": "You could try to add the A to the B collection, if there is no error its A is not present in B, if there is an error A is present in B.  However, i use dictionaries rather than collections."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1447253864, "post_id": 33651167, "comment_id": 55079707, "body": "And what about querying your Excel sheets using SQL ? <a href=\"http://stackoverflow.com/a/8766541/78522\">stackoverflow.com/a/8766541/78522</a>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1447254261, "post_id": 33651167, "comment_id": 55080007, "body": "To expand on some of the above, use a <code>Key</code> when you create the collection; trying to add a non-unique item will return a <code>457</code> error which you can test for."}], "answers": [{"tags": [], "owner": {"reputation": 12472, "user_id": 4850, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GOfnj.jpg?s=128&g=1", "display_name": "Andr&#233; Chalella", "link": "https://stackoverflow.com/users/4850/andr%c3%a9-chalella"}, "is_accepted": false, "score": 0, "last_activity_date": 1447247945, "last_edit_date": 1525816189, "creation_date": 1447247619, "answer_id": 33651284, "question_id": 33651167, "link": "https://stackoverflow.com/questions/33651167/searching-collections/33651284#33651284", "title": "Searching collections", "body": "<p><code>VLookup</code> is a <a href=\"http://www.cpearson.com/excel/callingworksheetfunctionsinvba.aspx\" rel=\"nofollow noreferrer\"><em>worksheet function</em></a>, not a regular VBA function, thus <a href=\"https://support.office.com/en-us/article/VLOOKUP-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1\" rel=\"nofollow noreferrer\">it's for searching in <code>Range</code>s, not <code>Collection</code>s.</a></p>\n\n<blockquote>\n  <p><strong>Syntax:</strong> <code>VLOOKUP (lookup_value, table_array, col_index_num, [range_lookup])</code></p>\n  \n  <p>[...]</p>\n  \n  <p><strong><code>table_array</code> (required):</strong> the <strong>range of cells</strong> in which the VLOOKUP will search for the lookup_value and the return value.</p>\n</blockquote>\n\n<p>In order to search in other VBA data structures like arrays, collections etc you'll have to figure out some other way and maybe implement it manually.</p>\n"}, {"tags": [], "owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "is_accepted": false, "score": 0, "last_activity_date": 1447247912, "creation_date": 1447247912, "answer_id": 33651378, "question_id": 33651167, "link": "https://stackoverflow.com/questions/33651167/searching-collections/33651378#33651378", "title": "Searching collections", "body": "<p>I would do it like this:</p>\n\n<pre><code>Sub test()\n\nDim newRow As Long, oldRow As Long\nDim x As Long, Dim y As Long\nDim checker As Boolean\n\nWith ActiveSheet\n\nnewRow = .Cells(.Rows.Count,7).End(xlUp).Row\noldRow = .Cells(.Rows.Count,1).End(xlUp).Row\nchecker = True\n\nfor y = 1 To oldRow\n\n    for x = 1 To newRow\n\n    If .Cells(y,1).Value = .Cells(x,7).Value Then\n\n    checker = False\n\n    Exit For\n\n    End If\n\n    Next\n\nIf checker Then\n\nRange(\"E10000\").End(xlUp).Offset(1,0).Value = .Cells(y,1).Value\n\nEnd If\n\nchecker = True\n\nNext\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1447247984, "last_edit_date": 1495540768, "creation_date": 1447247984, "answer_id": 33651400, "question_id": 33651167, "link": "https://stackoverflow.com/questions/33651167/searching-collections/33651400#33651400", "title": "Searching collections", "body": "<p>While @Jeeped suggestion of a Scripting.Dictionary object might be the best one, you could also try using the <a href=\"https://stackoverflow.com/a/10451264/78522\"><code>Filter()</code> function</a> applied to your array.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1447249199, "creation_date": 1447249199, "answer_id": 33651780, "question_id": 33651167, "link": "https://stackoverflow.com/questions/33651167/searching-collections/33651780#33651780", "title": "Searching collections", "body": "<p>Here is a short sub demonstrating some of the scripting dictionary methods.</p>\n\n<pre><code>Sub list_New_Unique()\n    Dim dMASTER As Object, dNEW As Object, k As Variant\n    Dim v As Long, vVALs() As Variant, vNEWs() As Variant\n\n    Debug.Print \"Start: \" &amp; Timer\n\n    Set dMASTER = CreateObject(\"Scripting.Dictionary\")\n    Set dNEW = CreateObject(\"Scripting.Dictionary\")\n    dMASTER.comparemode = vbTextCompare\n    dNEW.comparemode = vbTextCompare\n\n    With Worksheets(\"Sheet7\")\n        vVALs = .Range(\"A2:A100000\").Value2\n        vNEWs = .Range(\"C2:C100000\").Value2\n    End With\n\n    'populate the dMASTER values\n    For v = LBound(vVALs, 1) To UBound(vVALs, 1)\n        dMASTER.Add Key:=vVALs(v, 1), Item:=vVALs(v, 1)\n    Next v\n\n    'only populate dNEW with items not found in dMASTER\n    For v = LBound(vNEWs, 1) To UBound(vNEWs, 1)\n        If Not dMASTER.exists(vNEWs(v, 1)) Then\n            If Not dNEW.exists(vNEWs(v, 1)) Then _\n                dNEW.Add Key:=vNEWs(v, 1), Item:=vNEWs(v, 1)\n        End If\n    Next v\n\n    Debug.Print dNEW.Count\n\n    For Each k In dNEW.keys\n        'Debug.Print k\n    Next k\n\n    Debug.Print \"End: \" &amp; Timer\n\n    dNEW.RemoveAll: Set dNEW = Nothing\n    dMASTER.RemoveAll: Set dMASTER = Nothing\nEnd Sub\n</code></pre>\n\n<p>With 99,999 unique entries in A2:A100000 and 89747 random entries in C2:C89747, this found 70,087 unique new entries not found in A2:A100000 in 9.87 seconds.</p>\n"}], "owner": {"reputation": 29, "user_id": 5550226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a2d295a78e550235868c1d40cea21e1?s=128&d=identicon&r=PG&f=1", "display_name": "lexkel", "link": "https://stackoverflow.com/users/5550226/lexkel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 1, "answer_count": 4, "score": 1, "last_activity_date": 1447249199, "creation_date": 1447247117, "last_edit_date": 1447247359, "question_id": 33651167, "link": "https://stackoverflow.com/questions/33651167/searching-collections", "title": "Searching collections", "body": "<p>I'm working with a rather large dataset (>100,000 rows) and trying to compare two lists to figure out which items in the new list are not already in the master list. In other words I want to find the new unique items.</p>\n\n<p>I have some VBA code that uses vlookup and arrays that works, but bombs out when the arrays get too big (~70,000). So I've turned to collections. However I'm having difficulty searching the collections using vlookup or match.  </p>\n\n<pre><code>Sub find_uniqueIDs()\n\nDim a As Long\nDim n As Long\nDim m As Variant\nDim oldnum As Long\nDim oldIDs As Variant\nDim oldcoll As New Collection\nDim newnum As Long\nDim newIDs As Variant\nDim newcoll As New Collection\n\noldnum = 75000\noldIDs = Range(\"A1\", Range(\"A\" &amp; oldnum))\nnewnum = 45000 + 3\nnewIDs = Range(\"G3\", Range(\"G\" &amp; newnum))\n\n'Using arrays to search, but bombs out when oldnum or newnum are ~70000\nFor n = 1 To newnum - 3\n    m = Application.VLookup(newIDs(n, 1), oldIDs, 1, False)\n    If IsError(m) Then Range(\"E100000\").End(xlUp).Offset(1, 0) = newIDs(n, 1)\nNext n\n\n'Using collections to search\nFor n = 1 To oldnum\nOn Error Resume Next\n    oldcoll.Add oldIDs(n, 1)\nOn Error GoTo 0\nNext n\n\nFor m = 1 To newnum\nOn Error Resume Next\n    newcoll.Add newIDs(m, 1)\nOn Error GoTo 0\nNext m\n\n'This bit of code doesn't work\nFor a = 1 To newcoll.Count\nIf Application.VLookup(newcoll(a), oldcoll, 1, False) = \"#N/A\" Then _\n    Range(\"E100000\").End(xlUp).Offset(1, 0) = newcoll(a)\nNext a\n\nEnd Sub\n</code></pre>\n\n<p>Any ideas how I can determine whether a particular item is in the master list using collections?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 5529457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2250529be82ae7ca1a15c5709b31eba8?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5529457/josh"}, "reply_to_user": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 0, "creation_date": 1447246227, "post_id": 33650792, "comment_id": 55075134, "body": "I don&#39;t have anything, this is my first VBA code. Haven&#39;t done vba  ever before."}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "edited": false, "score": 0, "creation_date": 1447247834, "post_id": 33651312, "comment_id": 55075982, "body": "to copy bigger areas instead of cells use range(cells(1,1),cells(3,1)) this one would copy contents from cells A1 to A3"}], "tags": [], "owner": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "is_accepted": false, "score": 0, "last_activity_date": 1447247713, "creation_date": 1447247713, "answer_id": 33651312, "question_id": 33650792, "link": "https://stackoverflow.com/questions/33650792/macro-for-data-extraction-from-one-ws-to-another-in-excel-2010/33651312#33651312", "title": "Macro for data extraction from one ws to another in Excel 2010", "body": "<pre><code>sub copy\nthisworkbook.sheets(put here number of sheet to copy TO).cells(rows,columns).value=thisworkbook.sheets(number of sheet to copy FROM).cells(rows,columns).value\nend sub\n</code></pre>\n\n<p>example</p>\n\n<pre><code>Sub Copy()\nThisWorkbook.Sheets(1).Cells(1,1).Value=ThisWorkbook.Sheets(2).Cells(1,1).Value\nEnd Sub\n</code></pre>\n\n<p>this one would copy contents from second sheet - cell \"A1\" to first sheet - cell \"A1\"</p>\n\n<p>anything else?</p>\n"}, {"tags": [], "owner": {"reputation": 276, "user_id": 5455709, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf21c9e93189c70b9248250794f59bc3?s=128&d=identicon&r=PG&f=1", "display_name": "Brett Reinhard", "link": "https://stackoverflow.com/users/5455709/brett-reinhard"}, "is_accepted": false, "score": 0, "last_activity_date": 1447254010, "creation_date": 1447254010, "answer_id": 33653298, "question_id": 33650792, "link": "https://stackoverflow.com/questions/33650792/macro-for-data-extraction-from-one-ws-to-another-in-excel-2010/33653298#33653298", "title": "Macro for data extraction from one ws to another in Excel 2010", "body": "<p>Since you have never coded before, you may want to add </p>\n\n<pre><code>Option Explicit \n</code></pre>\n\n<p>To the beginning of your code, above the</p>\n\n<pre><code>Sub Copy()\n</code></pre>\n\n<p>This is a more proper way of coding.</p>\n\n<p>I remember starting my coding in vba and going through copying cells from one sheet to another. I suggest you start looking at For-Next statements as it will help when you begin to copy lots of data for example:</p>\n\n<pre><code>Option Explicit\nSub Copy()\nDim intCounter as Integer     'intCounter is the variable when is denoted by a prefix 'int' and is a counter for the for statement\nFor intCounter=1 to Sheets(1).Cells(Rows.Count, 1).End(xlUp).Rows\n'The above line denotes For the Counter = to 1 all the way to the end of the sheet\nSheets(1).Cells(intCounter,1).Value=Sheets(2).Cells(intCounter,1).Value\n'The above will take the cell in Sheet 1 row intCounter Column 1 to Sheet 2 row intCounter Column 1\nNext\n'The Above line 'Next' will start the loop over, adding 1 to the Value of intCounter\nEnd Sub\n</code></pre>\n\n<p>I suggest you play around with the code and see what changing values will do to the sub routine.</p>\n\n<p>Also note, that the above sub routine is dependent on having data in Sheet1 and column 1 , and is only transferring data from 1 cell at a time, if you want to do more than one cell at a time, as mentioned above you can use     </p>\n\n<pre><code>Range(Cells(intCounter,1),Cells(intCounter,whateverColumnNumberYouWant)).Value\n</code></pre>\n\n<p>in Place of</p>\n\n<pre><code>Cells(intCounter,1).Value\n</code></pre>\n\n<p>Hopefully, this gives you something to play with that will help your endeavors</p>\n"}], "owner": {"reputation": 1, "user_id": 5529457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2250529be82ae7ca1a15c5709b31eba8?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5529457/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1447254010, "creation_date": 1447245771, "last_edit_date": 1531164843, "question_id": 33650792, "link": "https://stackoverflow.com/questions/33650792/macro-for-data-extraction-from-one-ws-to-another-in-excel-2010", "title": "Macro for data extraction from one ws to another in Excel 2010", "body": "<p>I am new to VBA and looking to write an easy macro to extract data from one worksheet and add it to another worksheet, within the same workbook. Could any of you help me with a macro for the same? thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "edited": false, "score": 0, "creation_date": 1447247329, "post_id": 33650783, "comment_id": 55075715, "body": "please specify your problem a bit more I would like to help but there are no clues. Did you mean by any chance to simply count the actual printing? Like on printer or did you have in mind putting them in cells. Or both? The increasing serial numbers are not a problem then"}, {"owner": {"reputation": 11, "user_id": 5550513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52149228303c269cc2c1cf2209f2f9f2?s=128&d=identicon&r=PG&f=1", "display_name": "gary2571", "link": "https://stackoverflow.com/users/5550513/gary2571"}, "reply_to_user": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "edited": false, "score": 0, "creation_date": 1447263624, "post_id": 33650783, "comment_id": 55086216, "body": "The number in the excel cell needs to increase by one for each copy printed. I can then save the excel report with the last number printed si i&#39;ll know at what number to start at for the next batch that need to be printed."}, {"owner": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "edited": false, "score": 0, "creation_date": 1447312521, "post_id": 33650783, "comment_id": 55105282, "body": "if it is about printing then I would suggest saving the serial number in worksheet. Store it in a cell. But you would have to give me more info to write you a code. I am still unsure whether you want to print it on paper or do the counting in excel. If you want to print it on paper just use UserForm which adds one to number stored in cell and then saves the new number to the same cell."}], "owner": {"reputation": 11, "user_id": 5550513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52149228303c269cc2c1cf2209f2f9f2?s=128&d=identicon&r=PG&f=1", "display_name": "gary2571", "link": "https://stackoverflow.com/users/5550513/gary2571"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1447245754, "creation_date": 1447245754, "last_edit_date": 1531164843, "question_id": 33650783, "link": "https://stackoverflow.com/questions/33650783/incrementing-a-form-number-in-excel", "title": "incrementing a form number in excel", "body": "<p>I have an Excel basec checklist with a serial number field that must correspond to a serialized product. \nI would like to be able to have the number increase by one for each copy printed.\nA couple of weeks ago I found a VBA on line that allowed me to do this but didn't save the form before closing it and cannot find it again.\nAny suggestions? </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5550542, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06ec92ab9e2b78baa798b028adfd6100?s=128&d=identicon&r=PG&f=1", "display_name": "NewbieExcelVBA", "link": "https://stackoverflow.com/users/5550542/newbieexcelvba"}, "edited": false, "score": 0, "creation_date": 1447245721, "post_id": 33650684, "comment_id": 55074888, "body": "Thank you very much. It worked. I will also read the link on avoiding Select in VBA."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1447245373, "last_edit_date": 1495535235, "creation_date": 1447245373, "answer_id": 33650684, "question_id": 33650539, "link": "https://stackoverflow.com/questions/33650539/run-time-error-1004-select-method-of-range-class-failed-vba-2010/33650684#33650684", "title": "Run Time Error &#39;1004&#39;: Select method of Range Class failed VBA 2010", "body": "<p>There is some ambiguity as to the parent worksheet of the B2:D2 and B2:D15000 ranges.</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n    Application.Calculation = xlManual\n    With Sheets(\"DB2 Totbel\")\n        .Range(\"B2:D2\").AutoFill Destination:=.Range(\"B2:D15000\"), Type:=xlFillDefault\n        'uncomment these is you need to activate the DB2 Totbel worksheet\n        'and select B2:D15000\n        '.Activate\n        '.Range(\"B2:D15000\").Select\n    End With\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>Alternate with the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838404.aspx\" rel=\"nofollow noreferrer\">Range.FillDown method</a>.</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n    Application.Calculation = xlManual\n    With Sheets(\"DB2 Totbel\")\n        .Range(\"B2:D15000\").FillDown\n    End With\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>Recorded macros are very verbose and make too much use of the <code>.Select</code> and <code>.Activate</code> commands. See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</p>\n"}, {"comments": [{"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "edited": false, "score": 0, "creation_date": 1447246335, "post_id": 33650855, "comment_id": 55075196, "body": "Thanks Jeeped.  yes corrected the error. But you already gave nice descriptive answer"}], "tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": false, "score": 0, "last_activity_date": 1447246259, "last_edit_date": 1447246259, "creation_date": 1447246041, "answer_id": 33650855, "question_id": 33650539, "link": "https://stackoverflow.com/questions/33650539/run-time-error-1004-select-method-of-range-class-failed-vba-2010/33650855#33650855", "title": "Run Time Error &#39;1004&#39;: Select method of Range Class failed VBA 2010", "body": "<pre><code>  Private Sub CommandButton2_Click()\n\n    Application.Calculation = xlCalculationManual\n\n        With Sheets(\"DB2 Totbel\")\n            .Range(\"B2:D2\").AutoFill Destination:=.Range(\"B2:D15000\"), Type:=xlFillDefault\n        End With\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5550542, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06ec92ab9e2b78baa798b028adfd6100?s=128&d=identicon&r=PG&f=1", "display_name": "NewbieExcelVBA", "link": "https://stackoverflow.com/users/5550542/newbieexcelvba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "accepted_answer_id": 33650684, "answer_count": 2, "score": 1, "last_activity_date": 1447246259, "creation_date": 1447244845, "last_edit_date": 1447245891, "question_id": 33650539, "link": "https://stackoverflow.com/questions/33650539/run-time-error-1004-select-method-of-range-class-failed-vba-2010", "title": "Run Time Error &#39;1004&#39;: Select method of Range Class failed VBA 2010", "body": "<p>I am trying to filldown formulas in a sheet. The code I am using is a recorded macro and it works fine until I connect it to a button. When I do so, it gives a </p>\n\n<blockquote>\n  <p>\"Run Time Error '1004': Select method of Range Class failed\"</p>\n</blockquote>\n\n<p>Here is the code and I can see nothing wrong with it. When I hit debug it highlights the second line</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nSheets(\"DB2 Totbel\").Select\n\nRange(\"B2:D2\").Select\n\nSelection.AutoFill Destination:=Range(\"B2:D15000\"), Type:=xlFillDefault\n\nRange(\"B2:D15000\").Select\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/JiGEL.png\" rel=\"nofollow noreferrer\">picture of code in VBA</a></p>\n\n<p>\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/JiGEL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JiGEL.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "is_accepted": true, "score": 0, "last_activity_date": 1447246661, "creation_date": 1447246661, "answer_id": 33651034, "question_id": 33650142, "link": "https://stackoverflow.com/questions/33650142/vba-loop-through-new-files-in-folder/33651034#33651034", "title": "vba loop through new files in folder", "body": "<p>Hope this helps. it is modified project of mine. Important is that you write to cell(5,1) the date you want the files to be filtered from. For example If you put 11.11.2015 only files younger than that will appear so no files will be written down. But if you put 1.1.1914 in cell 5,1 then all files will pop up. I dont know which file sare you opening. You didnt meantion types so I didnt put workbook.open into the code but I put an note in the code where some opening should happen. So Edit my code to your needs.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nThisWorkbook.Save\nDoEvents\nConst ROW_FIRST As Integer = 2\nDim intResult As Integer\nDim strPath As String\nDim objFSO As Object\nDim intCountRows As Integer\n\nApplication.FileDialog(msoFileDialogFolderPicker).Title = \"Vyberte pros\u00edm slo\u017eku\"\nApplication.FileDialog(msoFileDialogFolderPicker).ButtonName = \"Vybrat slo\u017eku\"\nApplication.FileDialog(msoFileDialogFolderPicker).AllowMultiSelect = True\n\nintResult = Application.FileDialog(msoFileDialogFolderPicker).Show\n\nFor Each Item In Application.FileDialog(msoFileDialogFolderPicker).SelectedItems\n    If intResult &lt;&gt; 0 Then\n        Application.ScreenUpdating = False\n        Range(\"A:A\").ClearContents\n        Range(\"B:B\").ClearContents\n        Range(\"C:C\").ClearContents\n        Cells(1, 1).Value = \"NAME\"\n        Cells(1, 2).Value = \"PATH\"\n        Cells(1, 3).Value = \"TAIL\"\n        Cells(1, 4).Value = \"Last check:\"\n\n        strPath = Application.FileDialog(msoFileDialogFolderPicker).SelectedItems(1)\n\n        Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n        intCountRows = GetAllFiles(strPath, ROW_FIRST, objFSO)\n        Call GetAllFolders(strPath, objFSO, intCountRows)\n        Application.ScreenUpdating = True\n    End If\nNext Item\nCells(1, 5).Value = Date\nEnd Sub\n\nPrivate Function GetAllFiles(ByVal strPath As String, ByVal intRow As Integer, ByRef objFSO As Object) As Integer\nDoEvents\nDim objFolder As Object\nDim objFile As Object\nDim i As Integer\ni = intRow - ROW_FIRST + 1\nSet objFolder = objFSO.GetFolder(strPath)\n\nFor Each objFile In objFolder.Files\n    inte = InStr(1, objFile.Name, \"pr\u00e1zdn\u00fd\")\n        If objFile.datecreated &gt; DateValue(Cells(1, 5).Value) Then\n'HERE SHOULD BE THE OPENING PROCEDURE!!!!!!!!!!!!!!                \n                Cells(i + ROW_FIRST - 1, 1) = objFile.Name\n                Cells(i + ROW_FIRST - 1, 2) = objFile.Path\n                Cells(i + ROW_FIRST - 1, 3) = Right(objFile.Name, Len(objFile.Name) - InStrRev(objFile.Name, \".\"))\n                i = i + 1\n        End If\nNext objFile\nGetAllFiles = i + ROW_FIRST - 1\n\nEnd Function\n\nPrivate Sub GetAllFolders(ByVal strFolder As String, ByRef objFSO As Object, ByRef intRow As Integer)\nDoEvents\nDim objFolder As Object\nDim objSubFolder As Object\nStatic veSpravneSlozce As Boolean\n\nSet objFolder = objFSO.GetFolder(strFolder)\nFor Each objSubFolder In objFolder.subfolders\n        intRow = GetAllFiles(objSubFolder.Path, intRow, objFSO)\n        Call GetAllFolders(objSubFolder.Path, objFSO, intRow)\nNext objSubFolder\nEnd Sub\n</code></pre>\n\n<p>the opening procedure should be in the middle sub</p>\n"}], "owner": {"reputation": 29, "user_id": 3888026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0c25a6329b0a31541ff134863361a7e8?s=128&d=identicon&r=PG&f=1", "display_name": "bramvs", "link": "https://stackoverflow.com/users/3888026/bramvs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 33651034, "answer_count": 1, "score": 0, "last_activity_date": 1447246661, "creation_date": 1447243339, "last_edit_date": 1531164843, "question_id": 33650142, "link": "https://stackoverflow.com/questions/33650142/vba-loop-through-new-files-in-folder", "title": "vba loop through new files in folder", "body": "<p>I have a folder in which CSV files from a FTP server are downloaded, I need to open the newest files and extract data from these. I do this vs the get data from text connection which works. The problem is that the folder has 15000+ files and I only need to open the ones from the last week, maybe a 100 files. \nIs there a way to open them in a certain order? then I could just say if timestamp file &lt; then some time --> stop loop.</p>\n\n<p>thx!</p>\n"}, {"tags": ["vba", "web", "excel-2010"], "answers": [{"tags": [], "owner": {"reputation": 781, "user_id": 5175125, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10206341392667431/picture?type=large", "display_name": "Richard Lusch", "link": "https://stackoverflow.com/users/5175125/richard-lusch"}, "is_accepted": false, "score": 0, "last_activity_date": 1447250054, "creation_date": 1447250054, "answer_id": 33652043, "question_id": 33650110, "link": "https://stackoverflow.com/questions/33650110/importing-data-from-an-excel-sheet-to-a-web-form/33652043#33652043", "title": "Importing data from an excel sheet to a web form", "body": "<p>Yes, this sort of thing is possible.  Before we start giving you code, we will need to see what you have done, know what you are trying to accomplish, and what the errors are.</p>\n\n<p>Because it appears that you are just getting started down the road of IE Automation here are a few websites I used initially to get started.</p>\n\n<p><a href=\"http://www.excely.com/excel-vba/ie-automation.shtml\" rel=\"nofollow\">http://www.excely.com/excel-vba/ie-automation.shtml</a>\n<a href=\"http://www.makeuseof.com/tag/using-vba-to-automate-internet-explorer-sessions-from-an-excel-spreadsheet/\" rel=\"nofollow\">http://www.makeuseof.com/tag/using-vba-to-automate-internet-explorer-sessions-from-an-excel-spreadsheet/</a>\n<a href=\"https://msdn.microsoft.com/en-us/library/aa752084(v=vs.85).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/aa752084(v=vs.85).aspx</a></p>\n\n<p>I hope this helps you get started too.</p>\n"}], "owner": {"reputation": 3, "user_id": 5299937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47e6b249bb5e203e6ae48daa1b08b2c?s=128&d=identicon&r=PG&f=1", "display_name": "rcb", "link": "https://stackoverflow.com/users/5299937/rcb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 281, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447250054, "creation_date": 1447243214, "question_id": 33650110, "link": "https://stackoverflow.com/questions/33650110/importing-data-from-an-excel-sheet-to-a-web-form", "title": "Importing data from an excel sheet to a web form", "body": "<p>I have an excel template on which I would like to validate data entered by users, and on click of a button on the spreadsheet, I'd like to get the entered information on to a 3rd party web form, which is used to keep track of the user input. \nIs this possible using macros/vba for MS Excel 2010? If yes, I would like some help with the code as well...</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1447239672, "post_id": 33649016, "comment_id": 55071669, "body": "You have too options, either you write your second Sub in such a way, that it can receive 2 values as input or you write your first sub as a function, which returns an array of two values."}, {"owner": {"reputation": 251, "user_id": 4233291, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/dca7b89667f1cb99a16263879305ac9b?s=128&d=identicon&r=PG&f=1", "display_name": "pexpex223", "link": "https://stackoverflow.com/users/4233291/pexpex223"}, "reply_to_user": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1447240191, "post_id": 33649016, "comment_id": 55071944, "body": "I have changed the first sub to public function and call the function in second sub but it doesn&#39;t work."}], "answers": [{"tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1447240426, "creation_date": 1447240426, "answer_id": 33649365, "question_id": 33649016, "link": "https://stackoverflow.com/questions/33649016/pass-two-results-in-a-sub-to-another-sub/33649365#33649365", "title": "Pass two results in a sub to another sub", "body": "<p>Your calling syntax is incorrect, you pass the result of an evaluation (a equals x) and get a nasty automatic cast from bool instead of a type error.</p>\n\n<p>Instead of:</p>\n\n<pre><code>returnIntegerAndBoolean a = x, b = y\n</code></pre>\n\n<p>Use:</p>\n\n<pre><code>returnIntegerAndBoolean a, b\n</code></pre>\n\n<p>Or if you want to note the parameters:</p>\n\n<pre><code>returnIntegerAndBoolean x:=a, y:=b\n</code></pre>\n"}], "owner": {"reputation": 251, "user_id": 4233291, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/dca7b89667f1cb99a16263879305ac9b?s=128&d=identicon&r=PG&f=1", "display_name": "pexpex223", "link": "https://stackoverflow.com/users/4233291/pexpex223"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 33649365, "answer_count": 1, "score": 2, "last_activity_date": 1447240426, "creation_date": 1447239120, "last_edit_date": 1447239513, "question_id": 33649016, "link": "https://stackoverflow.com/questions/33649016/pass-two-results-in-a-sub-to-another-sub", "title": "Pass two results in a sub to another sub", "body": "<p>I am trying to pass the result of <code>x</code> and <code>y</code> from sub <code>returnIntegerAndBoolean</code> to sub <code>testing1</code>.</p>\n\n<p>In this case, user can run sub <code>testing1</code> and return the result \"4true\" but this doesn't work:  </p>\n\n<pre><code>Public Sub returnIntegerAndBoolean(ByRef x As Integer, Byref y As Boolean)\n\nx = 2\nx = x + 2\n\nIf x &gt; 5 Then\n  y = False\nElse\n  y = True\nEnd If\n\nEnd Sub\n\nSub testing1()\n\nDim a As Integer\nDim b As Boolean\n\nreturnIntegerAndBoolean a = x, b = y\nMsgBox a &amp; b\n\nEnd Sub  \n</code></pre>\n\n<p>Could someone have a look please?</p>\n"}, {"tags": ["vba", "excel", "oledb", "adodb"], "owner": {"reputation": 201, "user_id": 5498266, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/b9e47cb8439ec713f2c67a3e6dd7b9d1?s=128&d=identicon&r=PG&f=1", "display_name": "A Torre", "link": "https://stackoverflow.com/users/5498266/a-torre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1446, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1447239858, "creation_date": 1447238339, "last_edit_date": 1447239858, "question_id": 33648802, "link": "https://stackoverflow.com/questions/33648802/run-time-error-2147467259-80004005-unspecified-error-when-attempting-to-re", "title": "&quot;Run-Time error &#39;-2147467259 (80004005) Unspecified error&quot; when attempting to reconnect", "body": "<p>I am building an Excel spreadsheet to acquire some data (table format) from a server using a customized Excel Add-in. After that I need to modify that table and I thought the best way to do it is using a ADODB connection to the same Excel spreadsheet and SQL queries. </p>\n\n<p>When I try to establish the ADODB connection using Microsoft ACE OLEDB 12.0 driver having used before a connection with that Excel Add-in, I always get the same error:</p>\n\n<blockquote>\n  <p>Run-Time error '-2147467259 (80004005)<br>\n  Unspecified error</p>\n</blockquote>\n\n<p>This is the code I am using to establish ADODB connection:</p>\n\n<pre><code>Dim Conn As New ADODB.Connection\nDim mrs As New ADODB.Recordset\nDim sconnect As String\n\nSet Conn = New ADODB.Connection\nDBPath = ThisWorkbook.FullName\nsconnect = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" _\n     &amp; DBPath &amp; \";\" &amp; \"Extended Properties=\"\"Excel 12.0 Xml; HDR=YES\"\";\"\nConn.Open sconnect\nConn.Close\n</code></pre>\n\n<p>If I swap the connection order, connect first to my Excel using ADODB and then connect to the external server using the Add-in, I do not get this error.</p>\n\n<p>The problem is, sometimes I have already established the Add-in connection using a different spreadsheet and when I open this spreadsheet with the ADODB connection, the error is triggered, because Excel retains that plug-in connection if I do not restart the Excel session.</p>\n\n<p>I have tried looping through Excel connections but it does not pick up the plug-in connection:</p>\n\n<pre><code>    For i = 1 To ActiveWorkbook.Connections.Count\n\n    Next\n</code></pre>\n\n<p>Is there any way to know/debug why I get this error.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1447235042, "post_id": 33647743, "comment_id": 55069054, "body": "The function won&#39;t recalculate unless you re-enter it. (Just select the cell and press f2 then Enter)"}, {"owner": {"reputation": 3, "user_id": 5549950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93596881afa201529ba773625901ea30?s=128&d=identicon&r=PG&f=1", "display_name": "NIcolaHearn", "link": "https://stackoverflow.com/users/5549950/nicolahearn"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1447235410, "post_id": 33647743, "comment_id": 55069268, "body": "Hi Rory, thanks I have tried the F2 thing and retyped. In fact I closed and reopened the whole project. Also, nothing is working now. I just get #NAME? in the cell :("}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1447235594, "post_id": 33647743, "comment_id": 55069380, "body": "If you get a <code>#NAME?</code> error, you have macros disabled, or you changed the name of the function, or you moved it into a class module, or the module has the same name as the function."}], "answers": [{"tags": [], "owner": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "is_accepted": false, "score": 0, "last_activity_date": 1447236254, "creation_date": 1447236254, "answer_id": 33648220, "question_id": 33647743, "link": "https://stackoverflow.com/questions/33647743/vba-string-function-does-not-update-when-i-change-the-text/33648220#33648220", "title": "VBA String Function does not update when I change the text", "body": "<p>declare your function right</p>\n\n<pre><code>Function Hello(str As String) As String\n</code></pre>\n\n<p>then use something like</p>\n\n<p>cells(1,1).value=str</p>\n\n<p>function does the job for you but first you must call the function by parameter like this</p>\n\n<p>cells(1,1).value=Hello(\"How are you\")</p>\n\n<p>the result will be that in cell 1,1 will \"How are you\" be written.\nbut from this on I am not sure what are you trying to accomplish. If you need funct. to write in specific cell all the time you should use something like</p>\n\n<pre><code> Funtion Hello(row as integer, column as integer) as string\n    cells(row,column).value=inputbox(\"give me the input\")\n    end function\n</code></pre>\n\n<p>then to use this you write into code</p>\n\n<pre><code>result=Hello(1,2)\n</code></pre>\n\n<p>this example works</p>\n\n<pre><code>Function Area(row As Integer, column As Integer) As String\nCells(row, column).Value = InputBox(\"give something here\")\nEnd Function\n\nSub my()\n    result = Area(2, 2)\n    End Sub\n</code></pre>\n\n<p>run my()</p>\n"}, {"tags": [], "owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "is_accepted": true, "score": 4, "last_activity_date": 1447236324, "last_edit_date": 1495539874, "creation_date": 1447236324, "answer_id": 33648237, "question_id": 33647743, "link": "https://stackoverflow.com/questions/33647743/vba-string-function-does-not-update-when-i-change-the-text/33648237#33648237", "title": "VBA String Function does not update when I change the text", "body": "<p>You seem to have this function in the code-file for <code>thisWorkbook</code>, but it should be in a module. Add a module to your project, place your code there and make the function <code>Public</code>. See also: <a href=\"https://stackoverflow.com/questions/19601630/how-to-call-vba-function-from-excel-cells\">How to Call VBA Function from Excel Cells?</a></p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 5549950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93596881afa201529ba773625901ea30?s=128&d=identicon&r=PG&f=1", "display_name": "NIcolaHearn", "link": "https://stackoverflow.com/users/5549950/nicolahearn"}, "is_accepted": false, "score": 0, "last_activity_date": 1447236884, "creation_date": 1447236884, "answer_id": 33648400, "question_id": 33647743, "link": "https://stackoverflow.com/questions/33647743/vba-string-function-does-not-update-when-i-change-the-text/33648400#33648400", "title": "VBA String Function does not update when I change the text", "body": "<p>Ok I worked it out, I had written the function into the file \"This Workbook\" instead of into the Module I created... </p>\n\n<p>I knew it would be something simple! All working now.</p>\n"}, {"tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 2, "last_activity_date": 1447237215, "creation_date": 1447237215, "answer_id": 33648477, "question_id": 33647743, "link": "https://stackoverflow.com/questions/33647743/vba-string-function-does-not-update-when-i-change-the-text/33648477#33648477", "title": "VBA String Function does not update when I change the text", "body": "<p>Normally a <strong>Function</strong> should be in a <strong>Module</strong>, not in <strong>ThisWorkbook</strong>. You store Event handlers in the ThisWorkbook or a Sheet module.</p>\n\n<p>It doesn't recalculate because it doesn't have a Range input, since the function doesn\u2019t have any arguments, it is treated constant output and hence updating the function doesn\u2019t update the cell value.</p>\n\n<p>But if you modify it to accept a Range input, and if there are any changes to the input range, it will recalculate.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5405549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6318d097de33ee8160557ab1212e26a?s=128&d=identicon&r=PG", "display_name": "Maux", "link": "https://stackoverflow.com/users/5405549/maux"}, "is_accepted": false, "score": 0, "last_activity_date": 1447335682, "creation_date": 1447335682, "answer_id": 33672797, "question_id": 33647743, "link": "https://stackoverflow.com/questions/33647743/vba-string-function-does-not-update-when-i-change-the-text/33672797#33672797", "title": "VBA String Function does not update when I change the text", "body": "<pre><code>Function Hello() As String\nApplication.Volatile\nHello = \"Greetings\"\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5549950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93596881afa201529ba773625901ea30?s=128&d=identicon&r=PG&f=1", "display_name": "NIcolaHearn", "link": "https://stackoverflow.com/users/5549950/nicolahearn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1018, "favorite_count": 0, "accepted_answer_id": 33648237, "answer_count": 5, "score": 0, "last_activity_date": 1447335682, "creation_date": 1447234577, "last_edit_date": 1531164843, "question_id": 33647743, "link": "https://stackoverflow.com/questions/33647743/vba-string-function-does-not-update-when-i-change-the-text", "title": "VBA String Function does not update when I change the text", "body": "<p>I'm starting with VBA and I'm very upset to discover I have fallen at the first hurdle in this book I am following. </p>\n\n<p>I should type the following</p>\n\n<pre><code>Function Hello() As String\n    Hello = \"Greetings\"\nEnd Function\n</code></pre>\n\n<p>This all works fine but next I am supposed to change the text and see the function change on the Excel spreadsheet. Unfortunately I can't get this to work. Does anyone know why?</p>\n\n<p><img src=\"https://i.stack.imgur.com/LWAfu.png\" alt=\"Screenshot\"></p>\n\n<p>I've saved the document as an Excel Macro-enabled workbook and tried opening and closing. </p>\n"}, {"tags": ["excel", "vba", "while-loop"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1447233637, "post_id": 33647391, "comment_id": 55068326, "body": "More often than not you can discard the extra string vars and just use simple string concatenation within the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow noreferrer\">Range object</a> definition; e.g. <code>Range(&quot;B&quot; &amp; i)</code>"}], "tags": [], "owner": {"reputation": 383, "user_id": 5316139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e29782883e3ae7abd9953f88b4687851?s=128&d=identicon&r=PG&f=1", "display_name": "Cornelis", "link": "https://stackoverflow.com/users/5316139/cornelis"}, "is_accepted": false, "score": 0, "last_activity_date": 1447233358, "creation_date": 1447233358, "answer_id": 33647391, "question_id": 33647289, "link": "https://stackoverflow.com/questions/33647289/loop-without-selecting-cells/33647391#33647391", "title": "Loop without selecting cells", "body": "<p><strong>Anwser</strong></p>\n\n<p>I've tryed it an this seems to work</p>\n\n<pre><code>Dim i as integer\nDim a as String\nDim b as String\nDim c as integer\ni = 1\n\nDo While i &lt; 200\n    a = \"A\"&amp; i\n    b = \"B\"&amp; i\n    c = i * 10\n    If Range(b) &lt;&gt;\"\" Then\n        Range(a) = c\n    End if\n    i = i + 1\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "is_accepted": false, "score": 1, "last_activity_date": 1562164054, "last_edit_date": 1562164054, "creation_date": 1447233679, "answer_id": 33647480, "question_id": 33647289, "link": "https://stackoverflow.com/questions/33647289/loop-without-selecting-cells/33647480#33647480", "title": "Loop without selecting cells", "body": "<p>You're almost there with your first snippet. This works:</p>\n\n<pre><code>Sub SetNumbers()\n    Dim i As Integer\n    i = 1\n    Do While i &lt; 200\n        If Range(\"B\" &amp; i) &lt;&gt; \"\" Then\n            Range(\"A\" &amp; i) = i * 10\n        End If\n        i = i + 1\n    Loop\nEnd Sub\n</code></pre>\n\n<p>The key is to make the Range selection like this: <code>Range(\"A\" &amp; i)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 383, "user_id": 5316139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e29782883e3ae7abd9953f88b4687851?s=128&d=identicon&r=PG&f=1", "display_name": "Cornelis", "link": "https://stackoverflow.com/users/5316139/cornelis"}, "edited": false, "score": 0, "creation_date": 1447234643, "post_id": 33647536, "comment_id": 55068830, "body": "Thanks for this cleaver sollution! It does the same as my own code but is much slimmer&amp;cleaner.( in my case, i only need to add the if function, because I&#39;d like it to stop counting when at the end of the list, or better (Do While &lt;&gt; &quot;&quot;)"}], "tags": [], "owner": {"reputation": 2456, "user_id": 1754307, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/7170dd9a6ce7317ab73835c15ef1d9f7?s=128&d=identicon&r=PG", "display_name": "smackenzie", "link": "https://stackoverflow.com/users/1754307/smackenzie"}, "is_accepted": true, "score": 3, "last_activity_date": 1447233847, "creation_date": 1447233847, "answer_id": 33647536, "question_id": 33647289, "link": "https://stackoverflow.com/questions/33647289/loop-without-selecting-cells/33647536#33647536", "title": "Loop without selecting cells", "body": "<p>You can use Cells to use numeric indexes to rows and columns, if you don't want to create strings of range addresses.</p>\n\n<pre><code>Dim i As Integer\nDim c As Long\n\ni = 1\nc = 10\n\nDo While i &lt; 200\n    Cells(i, 2).Value = c\n    i = i + 1\n    c = c + 10\nLoop\n</code></pre>\n"}], "owner": {"reputation": 383, "user_id": 5316139, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e29782883e3ae7abd9953f88b4687851?s=128&d=identicon&r=PG&f=1", "display_name": "Cornelis", "link": "https://stackoverflow.com/users/5316139/cornelis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 1, "accepted_answer_id": 33647536, "answer_count": 3, "score": 0, "last_activity_date": 1562164054, "creation_date": 1447232960, "last_edit_date": 1447237168, "question_id": 33647289, "link": "https://stackoverflow.com/questions/33647289/loop-without-selecting-cells", "title": "Loop without selecting cells", "body": "<p>I'd like to loop without selecting cells. Range B:B will contain a list of values which I'd like numbered: <code>10</code>, <code>20</code>, <code>30</code> etc. I have an idea of how this could be accomplished but it doesn't work yet:</p>\n\n<pre><code>Dim i as integer\ni = 1\nDo While i &lt; 200\n    If Range(\"Bi\") &lt;&gt; \"\" Then\n        Range(\"Ai\")= i*10\n    end if\n    i = i + 1\nLoop\nEnd sub\n</code></pre>\n\n<p>Does anyone know a way to accomplish something like this?</p>\n\n<p>And would this work or wouldn't it make any sense at all?:</p>\n\n<pre><code>Dim i as integer\nDim a as String\nDim b as String\nDim c as integer\ni = 1\n\nDo While i &lt; 200\n    a = \"A\"&amp; i\n    b = \"B\"&amp; i\n    c = i * 10\n    If Range(b) &lt;&gt;\"\" Then\n        Range(a) = c\n    End if\n    i = i + 1\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "embed", "powerpoint", "webpage"], "comments": [{"owner": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "edited": false, "score": 0, "creation_date": 1447232478, "post_id": 33647125, "comment_id": 55067756, "body": "Try with &quot;http://&quot; in front of the web address."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5549783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0233ea89a1c7386a29edd9bb44f4d468?s=128&d=identicon&r=PG&f=1", "display_name": "MET", "link": "https://stackoverflow.com/users/5549783/met"}, "is_accepted": false, "score": 2, "last_activity_date": 1447238309, "creation_date": 1447238309, "answer_id": 33648792, "question_id": 33647125, "link": "https://stackoverflow.com/questions/33647125/i-want-embed-a-webpage-in-powerpoint/33648792#33648792", "title": "I want embed a webpage in powerpoint", "body": "<p>Finally I found it</p>\n\n<pre><code>Sub OnSlideShowPageChange()\nDim i As Integer\ni = ActivePresentation.SlideShowWindow.View.CurrentShowPosition\nIf i &lt;&gt; 1 Then Exit Sub\nWebBrowser1.Navigate (\"www.google.com\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5549783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0233ea89a1c7386a29edd9bb44f4d468?s=128&d=identicon&r=PG&f=1", "display_name": "MET", "link": "https://stackoverflow.com/users/5549783/met"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2088, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1566365114, "creation_date": 1447232301, "last_edit_date": 1447235146, "question_id": 33647125, "link": "https://stackoverflow.com/questions/33647125/i-want-embed-a-webpage-in-powerpoint", "title": "I want embed a webpage in powerpoint", "body": "<p>I want embed a just simple webpage in Powerpoint. The page must automatically load from the given URL when the slideshow starts. No text-box no click-button.</p>\n\n<p>I've insert a Web Browser element from the developer tab.\nThe code that i used is:</p>\n\n<pre><code>Sub Main()\nWebBrowser1.Navigate (\"www.google.com\")\nEnd Sub\n</code></pre>\n\n<p>Powerpoint shows a file explorer in the slideshow.</p>\n\n<p>What did i wrong?</p>\n\n<p>Cheers.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 143, "user_id": 5023141, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/73e4102f195847ce8cdd617c722fba4c?s=128&d=identicon&r=PG&f=1", "display_name": "Calum", "link": "https://stackoverflow.com/users/5023141/calum"}, "edited": false, "score": 0, "creation_date": 1447231296, "post_id": 33646749, "comment_id": 55067150, "body": "See <a href=\"https://support.microsoft.com/en-gb/kb/110462\" rel=\"nofollow noreferrer\">here</a>, can it find the data?"}, {"owner": {"reputation": 904, "user_id": 4519709, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c6b1f82af788e90e52773d9007bae416?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/4519709/gonzalo"}, "reply_to_user": {"reputation": 143, "user_id": 5023141, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/73e4102f195847ce8cdd617c722fba4c?s=128&d=identicon&r=PG&f=1", "display_name": "Calum", "link": "https://stackoverflow.com/users/5023141/calum"}, "edited": false, "score": 0, "creation_date": 1447232748, "post_id": 33646749, "comment_id": 55067876, "body": "I didnt manage following that procedures. I gave a name to the table, but the instructions are pointing to different direction: &quot;o define your data with the defined name &quot;database&quot; . In INSERT tab i dont have such options as descrived in the workaround. I am a bit lost here.."}, {"owner": {"reputation": 143, "user_id": 5023141, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/73e4102f195847ce8cdd617c722fba4c?s=128&d=identicon&r=PG&f=1", "display_name": "Calum", "link": "https://stackoverflow.com/users/5023141/calum"}, "edited": false, "score": 1, "creation_date": 1447236492, "post_id": 33646749, "comment_id": 55069901, "body": "what error do you get when you debug it?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1447238678, "post_id": 33646749, "comment_id": 55071148, "body": "Where does your table start?"}, {"owner": {"reputation": 904, "user_id": 4519709, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c6b1f82af788e90e52773d9007bae416?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/4519709/gonzalo"}, "edited": false, "score": 0, "creation_date": 1447241286, "post_id": 33646749, "comment_id": 55072568, "body": "my table starts in cell b2 of sheet 2 (name Tasks). Actually from b2 to j2 are the headers, content is below that. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 3686134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f28054fff1cd57116c53613804627e40?s=128&d=identicon&r=PG", "display_name": "Mohamed Allam", "link": "https://stackoverflow.com/users/3686134/mohamed-allam"}, "is_accepted": true, "score": 0, "last_activity_date": 1447244775, "creation_date": 1447244775, "answer_id": 33650520, "question_id": 33646749, "link": "https://stackoverflow.com/questions/33646749/open-an-excel-form-to-read-a-table/33650520#33650520", "title": "Open an Excel Form to read a table", "body": "<p>Select your table range and give it the name \"Database\", before showing the form, as follows:</p>\n\n<pre><code>Worksheets(\"Tasks\").Activate\nRange(\"B2:J30\").Select\nActiveWorkbook.Names.Add Name:=ActiveSheet.Name &amp; \"!Database\",RefersToR1C1:=Selection\nActiveSheet.ShowDataForm\n</code></pre>\n"}], "owner": {"reputation": 904, "user_id": 4519709, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c6b1f82af788e90e52773d9007bae416?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/4519709/gonzalo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 33650520, "answer_count": 1, "score": 0, "last_activity_date": 1447244775, "creation_date": 1447230706, "last_edit_date": 1531161705, "question_id": 33646749, "link": "https://stackoverflow.com/questions/33646749/open-an-excel-form-to-read-a-table", "title": "Open an Excel Form to read a table", "body": "<p>I am not being able to open a the Form to read a table (and edit it) on a specific sheet called \"Tasks\" with:</p>\n\n<pre><code>Sub Button6_Click()\n\n   ' Activate the sheet that contains your database.\n         Worksheets(\"Tasks\").Activate\n\n         ' Show the data form for the selected range.\n         ActiveSheet.ShowDataForm\nEnd Sub\n</code></pre>\n\n<p>That occurs because Excel doesn't know what to read? There is just one table on sheet \"Tasks\".           </p>\n"}, {"tags": ["vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447226601, "post_id": 33645650, "comment_id": 55065209, "body": "It&#39;s possible it&#39;s not really a new page but new content loaded into the same page?"}], "answers": [{"tags": [], "owner": {"reputation": 428, "user_id": 2319414, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e338eeb42f4a45404306131fc661d9eb?s=128&d=identicon&r=PG", "display_name": "S.aad", "link": "https://stackoverflow.com/users/2319414/s-aad"}, "is_accepted": false, "score": 1, "last_activity_date": 1447314014, "last_edit_date": 1447314014, "creation_date": 1447229330, "answer_id": 33646458, "question_id": 33645650, "link": "https://stackoverflow.com/questions/33645650/how-to-get-html-document-after-ie-navigates-to-a-new-page/33646458#33646458", "title": "How to get html document after IE navigates to a new page?", "body": "<p>Here is the simple workaround that i found.</p>\n\n<pre><code>IE.navigate \"javascript:document.getElementById('clickelement').click();\"\n</code></pre>\n\n<p>Regards</p>\n"}], "owner": {"reputation": 428, "user_id": 2319414, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e338eeb42f4a45404306131fc661d9eb?s=128&d=identicon&r=PG", "display_name": "S.aad", "link": "https://stackoverflow.com/users/2319414/s-aad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 576, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1447314014, "creation_date": 1447225257, "last_edit_date": 1531164843, "question_id": 33645650, "link": "https://stackoverflow.com/questions/33645650/how-to-get-html-document-after-ie-navigates-to-a-new-page", "title": "How to get html document after IE navigates to a new page?", "body": "<p>I am using the code below</p>\n\n<pre><code>eSignIn.Click\nDo While IE.READYSTATE &lt;&gt; READYSTATE_COMPLETE\n\n    DoEvents     \nLoop\nSet html = IE.document\n</code></pre>\n\n<p>The html that i get is of the previous page not the new one which <code>IE</code> navigates to after the click event.</p>\n\n<p>The state check loop is also being skipped even though <code>IE</code> is still loading, it works fine if put after <code>IE.navigate</code> command.</p>\n\n<p>Even if i put a break before the <code>Set html = IE.document</code> statement and step into it after the page loads it still loads the document of previous page. Kindly let me know if some one has a solution.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "outlook", "outlook-2013"], "answers": [{"tags": [], "owner": {"reputation": 161, "user_id": 1542755, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2752f1c55ca668532bdf65a49930b1ac?s=128&d=identicon&r=PG", "display_name": "Alex C", "link": "https://stackoverflow.com/users/1542755/alex-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1447242029, "last_edit_date": 1490005101, "creation_date": 1447242029, "answer_id": 33649779, "question_id": 33645636, "link": "https://stackoverflow.com/questions/33645636/convert-text-from-incoming-message-to-hyperlink/33649779#33649779", "title": "Convert text from incoming message to hyperlink", "body": "<p>Suddenly found it's possible to realize option1\nSolution is explained here - <a href=\"https://superuser.com/questions/464000/how-to-replace-text-in-the-body-of-an-incoming-message-with-a-hyperlink-in-outlo\">https://superuser.com/questions/464000/how-to-replace-text-in-the-body-of-an-incoming-message-with-a-hyperlink-in-outlo</a></p>\n"}], "owner": {"reputation": 161, "user_id": 1542755, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2752f1c55ca668532bdf65a49930b1ac?s=128&d=identicon&r=PG", "display_name": "Alex C", "link": "https://stackoverflow.com/users/1542755/alex-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593306611, "creation_date": 1447225158, "last_edit_date": 1593306611, "question_id": 33645636, "link": "https://stackoverflow.com/questions/33645636/convert-text-from-incoming-message-to-hyperlink", "title": "Convert text from incoming message to hyperlink", "body": "<p>Outlook 2013<br>\nOur bugtracking system sends notifications where bug's ID is displayed as a plain text.</p>\n\n<pre><code>From:bugtracker\nTo:me\nSubject: Bug 123456567 arrived\nMessage body:\n\nBug: 1234567\nDescription: Something went wrong blahblahblah\n</code></pre>\n\n<p>So I have to copy ID from the message, open browser, open bugtracker, input ID in the search box, press Enter.<br>\nThis bugtracker is a 3rd party solution so it will take a long time to improve it on server's side (and I'm already pushing them for a long time).<br>\nThat's pretty annoying so I would like to improve it a little bit on client's side.<br>\nI need to convert bug ID to hyperlink (like <a href=\"http://bugtracker/ID\" rel=\"nofollow\">http://bugtracker/ID</a>) somehow, so I can go directly to its location in bugtracker just in one click<br>\nAfter some research I think I will need to use Outlook rules.<br>\nPossible solutions I see:<br>\n1) Modify incoming message in-place/on-the-fly and convert bug's ID in subject (as outlook converts 'http' links or in message's body) to hyperlink - not sure whether it's possible at all and how to do it<br>\n2) Display pop-up notification with hyperlink - not sure whether it's possible at all and how to do it<br>\n3) Display MsgBox with \"hyperlink\" (as I understand it's not possible to use real hyperlinks in MsgBox, so it will be workaround with Shell command) - I'm working on this option right now.  </p>\n\n<p>Any suggestions on option1 and option2?</p>\n"}, {"tags": ["excel", "vba", "csv", "python-3.x", "xlwings"], "comments": [{"owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "edited": false, "score": 0, "creation_date": 1447286238, "post_id": 33644419, "comment_id": 55097753, "body": "Why don&#39;t you paste the code with your <code>Sort_File</code> function?"}, {"owner": {"reputation": 109, "user_id": 4297499, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c949ca43c033099636373ae506e51b33?s=128&d=identicon&r=PG&f=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/4297499/geoff"}, "reply_to_user": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "edited": false, "score": 0, "creation_date": 1447303852, "post_id": 33644419, "comment_id": 55102645, "body": "@ Felix Zumstein I took it out of the code above but I had it right above keyfunc = lambda row:row[1:] and everything was indented after that. Im not sure how to make the above a function and call it from excel. In short the above is what i would like to be my Sort_File function. Thanks for any help."}, {"owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "edited": false, "score": 0, "creation_date": 1447318615, "post_id": 33644419, "comment_id": 55108125, "body": "Well in case that <code>group_by_trailing_py2.py</code> is what your file is called, then you need to <code>import group_by_trailing_py2</code> and not <code>SortProduct</code>."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 4297499, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c949ca43c033099636373ae506e51b33?s=128&d=identicon&r=PG&f=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/4297499/geoff"}, "edited": false, "score": 0, "creation_date": 1447251180, "post_id": 33650200, "comment_id": 55077959, "body": "Thanks, I put this code in with my button and it runs python. The only problem is it does not create the My Product.grouped.csv file. When i run the file in idle it creates the file so i know that part works. What am i missing."}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "reply_to_user": {"reputation": 109, "user_id": 4297499, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c949ca43c033099636373ae506e51b33?s=128&d=identicon&r=PG&f=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/4297499/geoff"}, "edited": false, "score": 0, "creation_date": 1447253350, "post_id": 33650200, "comment_id": 55079358, "body": "I could nt find the full paths of the Csv files. What it &quot;import SortProduct&quot; mean ? is it possible to give within the python code. But I am not sure of the solution."}, {"owner": {"reputation": 109, "user_id": 4297499, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c949ca43c033099636373ae506e51b33?s=128&d=identicon&r=PG&f=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/4297499/geoff"}, "edited": false, "score": 0, "creation_date": 1447272337, "post_id": 33650200, "comment_id": 55091352, "body": "import SortProduct calls the .py file and the second part runs the function within SortProduct.  I tried defining the function before but was unable to get it to work. With your method of calling python i wouldnt need to define a function."}], "tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": false, "score": 0, "last_activity_date": 1447244329, "last_edit_date": 1447244329, "creation_date": 1447243594, "answer_id": 33650200, "question_id": 33644419, "link": "https://stackoverflow.com/questions/33644419/call-py-file-from-excel/33650200#33650200", "title": "Call .py file from Excel", "body": "<pre><code>  Private Sub PRODRLIST_Click()\n    Dim pyPrgm As String, pyScript As String\n    pyPrgm = \"C:\\Python33\\python.exe \" \n'---- Space should be there after python 'exe path\n    pyScript = \"C:\\Python33\\MyScripts\\sort.py\" ' File path\n    Call Shell(pyPrgm &amp; pyScript, vbMaximizedFocus)\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 4297499, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c949ca43c033099636373ae506e51b33?s=128&d=identicon&r=PG&f=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/4297499/geoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 270, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447250764, "creation_date": 1447217131, "last_edit_date": 1447250764, "question_id": 33644419, "link": "https://stackoverflow.com/questions/33644419/call-py-file-from-excel", "title": "Call .py file from Excel", "body": "<p>I have a UserForm with a button called PRODRLIST and when you click it is supposed to sort My Product.csv and save its output as My Product.grouped.csv. I can run the Python code in IDLE and it works, but when I define a function (Sort_File()) I cannot get it to work. I'm still new to Python so I'm assuming it is something simple.  </p>\n\n<p>Excel VBA code to launch Python program:</p>\n\n<pre><code>Private Sub PRODRLIST_Click()\nRunPython (\"import SortProduct; SortProduct.Sort_File()\")\nEnd Sub\n</code></pre>\n\n<p>Python code to sort .csv file:</p>\n\n<pre><code>from xlwings import Workbook, Range\n# file group_by_trailing_py2.py\nimport os\nimport csv\nfrom itertools import groupby\n\nDELIM=';'\nIN_FILENAME = 'My Product.csv'\nOUT_FILENAME = 'My Product.grouped.csv'\n\n\nkeyfunc = lambda row: row[1:]\n\nwith open(IN_FILENAME) as csv_file:\n    rows = sorted(csv.reader(csv_file, delimiter=DELIM), key=keyfunc)\n\nit = map(lambda t: [\", \".join(v[0].strip() for v in t[1]) + \" \"] + t[0],\n        groupby(rows, key=keyfunc))\n\nwith open(OUT_FILENAME, 'w') as csv_file:\n    writer = csv.writer(csv_file, delimiter=DELIM)  \nfor row in it:\n    writer.writerow(row)  \n</code></pre>\n\n<p>Maybe I have to define a few more things or it's my indentation?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1284, "user_id": 2155068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/728613d777dfb5393e42162a638f5e48?s=128&d=identicon&r=PG", "display_name": "MjrKusanagi", "link": "https://stackoverflow.com/users/2155068/mjrkusanagi"}, "edited": false, "score": 0, "creation_date": 1447212994, "post_id": 33643803, "comment_id": 55061575, "body": "Why not just write the text to a file and then open the file in its default application?"}, {"owner": {"reputation": 59, "user_id": 3256102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5653ab553cdcd02a42a16655c7c591f?s=128&d=identicon&r=PG&f=1", "display_name": "user3256102", "link": "https://stackoverflow.com/users/3256102/user3256102"}, "reply_to_user": {"reputation": 1284, "user_id": 2155068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/728613d777dfb5393e42162a638f5e48?s=128&d=identicon&r=PG", "display_name": "MjrKusanagi", "link": "https://stackoverflow.com/users/2155068/mjrkusanagi"}, "edited": false, "score": 0, "creation_date": 1447213379, "post_id": 33643803, "comment_id": 55061651, "body": "Here text will be changed every time. So would like to display the text in new notepad."}, {"owner": {"reputation": 1284, "user_id": 2155068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/728613d777dfb5393e42162a638f5e48?s=128&d=identicon&r=PG", "display_name": "MjrKusanagi", "link": "https://stackoverflow.com/users/2155068/mjrkusanagi"}, "edited": false, "score": 0, "creation_date": 1447213587, "post_id": 33643803, "comment_id": 55061703, "body": "Hmm. So, do you want Notepad to show the contents of a cell in Excel? And you want Notepad to always show only the latest value in the cell?"}, {"owner": {"reputation": 59, "user_id": 3256102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5653ab553cdcd02a42a16655c7c591f?s=128&d=identicon&r=PG&f=1", "display_name": "user3256102", "link": "https://stackoverflow.com/users/3256102/user3256102"}, "reply_to_user": {"reputation": 1284, "user_id": 2155068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/728613d777dfb5393e42162a638f5e48?s=128&d=identicon&r=PG", "display_name": "MjrKusanagi", "link": "https://stackoverflow.com/users/2155068/mjrkusanagi"}, "edited": false, "score": 0, "creation_date": 1447213870, "post_id": 33643803, "comment_id": 55061773, "body": "I have prepared a calendar to display the data. If week &lt;= 1 Then     MsgBox Sheet11.Cells(4, &quot;a&quot;). But, MsgBox displays limited data. I think Notepad can help me to display the huge data."}, {"owner": {"reputation": 1284, "user_id": 2155068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/728613d777dfb5393e42162a638f5e48?s=128&d=identicon&r=PG", "display_name": "MjrKusanagi", "link": "https://stackoverflow.com/users/2155068/mjrkusanagi"}, "edited": false, "score": 1, "creation_date": 1447214257, "post_id": 33643803, "comment_id": 55061867, "body": "Hmm. Without knowing more about your design, my thought would be to display the data directly in an excel spreadsheet, but a sheet that is formatted properly for your data."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1447235238, "post_id": 33643803, "comment_id": 55069161, "body": "I still don&#39;t get why you don&#39;t write to a text file and open that in Notepad. It&#39;s a lot simpler and does exactly what you seem to want."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 3256102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5653ab553cdcd02a42a16655c7c591f?s=128&d=identicon&r=PG&f=1", "display_name": "user3256102", "link": "https://stackoverflow.com/users/3256102/user3256102"}, "edited": false, "score": 0, "creation_date": 1447214764, "post_id": 33643968, "comment_id": 55062007, "body": "Perfect. Thank you so much Siddharth."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 59, "user_id": 3256102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5653ab553cdcd02a42a16655c7c591f?s=128&d=identicon&r=PG&f=1", "display_name": "user3256102", "link": "https://stackoverflow.com/users/3256102/user3256102"}, "edited": false, "score": 0, "creation_date": 1447215161, "post_id": 33643968, "comment_id": 55062088, "body": "Glad to be of help :)"}, {"owner": {"reputation": 59, "user_id": 3256102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5653ab553cdcd02a42a16655c7c591f?s=128&d=identicon&r=PG&f=1", "display_name": "user3256102", "link": "https://stackoverflow.com/users/3256102/user3256102"}, "edited": false, "score": 0, "creation_date": 1447217431, "post_id": 33643968, "comment_id": 55062667, "body": "one more question, I have arranged Excel cell as one : Suman(Alt+enter) Two : Surya. Message box displays the data how I arranged in Cell. But Note pad continued the text as one : sumanTwo:Surya. can&#39;t we see the data how I arranged the data in Excel?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 59, "user_id": 3256102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5653ab553cdcd02a42a16655c7c591f?s=128&d=identicon&r=PG&f=1", "display_name": "user3256102", "link": "https://stackoverflow.com/users/3256102/user3256102"}, "edited": false, "score": 0, "creation_date": 1447217663, "post_id": 33643968, "comment_id": 55062716, "body": "No for that you will have to copy and paste the data using <code>WM_PASTE</code> instead of <code>WM_SETTEXT</code> I would recommend googling on how to paste data using sendmessage. I may not be able to reply anymore today as I have a flight to catch in the next 2 hours."}, {"owner": {"reputation": 59, "user_id": 3256102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5653ab553cdcd02a42a16655c7c591f?s=128&d=identicon&r=PG&f=1", "display_name": "user3256102", "link": "https://stackoverflow.com/users/3256102/user3256102"}, "edited": false, "score": 1, "creation_date": 1447221216, "post_id": 33643968, "comment_id": 55063521, "body": "Thank you. I used    Sheets(&quot;Sheet1&quot;).Activate ActiveSheet.Cells(4, 1).Select Selection.Copy Shell &quot;notepad.exe&quot;, 3 SendKeys &quot;^v&quot; VBA.AppActivate .Caption .CutCopyMode = False but data appears as I mentioned above :( Please help to me once you are back"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 5, "last_activity_date": 1447213800, "creation_date": 1447213800, "answer_id": 33643968, "question_id": 33643803, "link": "https://stackoverflow.com/questions/33643803/write-text-in-new-notepad/33643968#33643968", "title": "Write text in new Notepad", "body": "<p>I had answered a similar question many years ago in vbforums.com but couldn't find it so I quickly re-wrote it for you. I have commented the code so you shall not have a problem understanding it.</p>\n\n<p>Like you and me, we both have names, similarly windows have \u201chandles\u201d (hWnd), Class etc. Once you know what that hWnd is, it is easier to interact with that window. Findwindow API finds the hWnd of a particular window by using the class name. Read up on the rest of the APIs <a href=\"http://allapi.mentalis.org/apilist/apilist.php\" rel=\"noreferrer\">Here</a></p>\n\n<pre><code>Private Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" _\n(ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n\nPrivate Declare Function FindWindowEx Lib \"user32\" Alias \"FindWindowExA\" _\n(ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, _\nByVal lpsz2 As String) As Long\n\nPrivate Declare Function SendMessage Lib \"user32\" Alias \"SendMessageA\" _\n(ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long\n\nPrivate Const WM_SETTEXT = &amp;HC\n\nPrivate Sub Command1_Click()\n    Dim Ret As Long, ChildRet As Long\n    Dim sString As String\n\n    '~~&gt; This is the value from the cell which\n    '~~&gt; you want to send to notepad\n    sString = Range(\"A1\").Value\n\n    '~~&gt; Start Notepad\n    Ret = Shell(\"notepad.exe\", vbNormalFocus)\n\n    '~~&gt; Wait for it to load\n    DoEvents\n\n    '~~&gt; Find notepad\n    Ret = FindWindow(vbNullString, \"Untitled - Notepad\")\n\n    '~~&gt; Check if found\n    If Ret = 0 Then\n        MsgBox \"Cannot find Notepad Window\"\n        Exit Sub\n    End If\n\n    '~~&gt; Find the \"Edit Window\" which is a child window of Notepad window\n    ChildRet = FindWindowEx(Ret, ByVal 0&amp;, \"Edit\", vbNullString)\n\n    '~~&gt; Send the message\n    SendMessage ChildRet, WM_SETTEXT, 0, ByVal sString\nEnd Sub\n</code></pre>\n\n<p>To get the classnames of windows, I usually use Spy ++ or uuSpy. See this is how I got the classname \"Edit\" of notepad using Spy ++</p>\n\n<p><a href=\"https://i.stack.imgur.com/Sm3JG.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/Sm3JG.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 59, "user_id": 3256102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5653ab553cdcd02a42a16655c7c591f?s=128&d=identicon&r=PG&f=1", "display_name": "user3256102", "link": "https://stackoverflow.com/users/3256102/user3256102"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 735, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1488824242, "creation_date": 1447212544, "last_edit_date": 1447216084, "question_id": 33643803, "link": "https://stackoverflow.com/questions/33643803/write-text-in-new-notepad", "title": "Write text in new Notepad", "body": "<p>Could any one help me to write cell value to new instance of Notepad?</p>\n\n<p>Here is the code I tried:</p>\n\n<pre><code>Sub a()\n    Dim nt As String\n    nt = Shell(\"notepad.exe\", vbNormalFocus)\n    Print #1, ActiveSheet.Cells(1, 1).Value\n    Close #1\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1447213426, "post_id": 33643754, "comment_id": 55061663, "body": "What&#39;s working? What information? All we can see is you read in a text file omitting new lines. With this 1 lone line, you looped twice (due to aStrings) and extracting some string to cells that doesn&#39;t change row on next item. Then some maths (v and j) to extract text to rows that got overwritten later on... totally confused me what you are trying to do."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447213977, "post_id": 33643754, "comment_id": 55061793, "body": "Without seeing what your text file looks like it&#39;s difficult to make any guesses here."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1447292462, "creation_date": 1447292462, "answer_id": 33663064, "question_id": 33643754, "link": "https://stackoverflow.com/questions/33643754/looping-in-text-file/33663064#33663064", "title": "Looping in text file", "body": "<p>Untested:</p>\n\n<pre><code>Sub test()\n\n    Const S_HDR As String = \"INFORMATION DE BASE ET DONN\u00c9ES DE CALCUL\"\n    Const S_DT As String = \"Date d'emploi\"\n\n    Dim myFile As String, textline As String\n    Dim c As Range\n\n    myFile = \"C:\\Users\\mark\\Desktop\\C0010DET.txt\"\n\n    Set c = ActiveSheet.Range(\"A1\")\n\n    Open myFile For Input As #1\n    Do Until EOF(1)\n\n        Line Input #1, textline\n        textline = Trim(textline)\n\n        If textline Like S_DT &amp; \"*\" Then\n            c.Value = S_HDR\n            c.Offset(1, 0).Value = S_DT\n            c.Offset(1, 1).Value = Right(textline, 10)\n            Set c = c.Offset(2, 0)\n        End If\n\n    Loop\n    Close #1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5549111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e3e51ee1c4e22ccb5ec91dd1ffd0cbc?s=128&d=identicon&r=PG&f=1", "display_name": "mckaymental", "link": "https://stackoverflow.com/users/5549111/mckaymental"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1450172738, "creation_date": 1447212205, "last_edit_date": 1447292108, "question_id": 33643754, "link": "https://stackoverflow.com/questions/33643754/looping-in-text-file", "title": "Looping in text file", "body": "<p>I've came up with a bit of code that extracts certain values in a text file using VBA. I need it to loop as many times as the expression 'INFORMATION DE BASE ET DONN\u00c9ES DE CALCUL' appear in the text file. Here's my code so far:</p>\n\n<p>exemple of text file: </p>\n\n<pre><code>INFORMATION DE BASE ET DONN\u00c9ES DE CALCUL  \n\nNom de l'individu ................. Louis Boutel  \nSexe .............................. Homme  \nNum\u00e9ro d'assurance sociale  ....... 323-423-123  \nNo employ\u00e9 ........................ 14023  \nDate de naissance ................. 1969-03-22  \nDate d'emploi ..................... 1998-09-28  \n\nINFORMATION DE BASE ET DONN\u00c9ES DE CALCUL  \n\nNom de l'individu ................. Morin laprise  \nSexe .............................. Homme  \nNum\u00e9ro d'assurance sociale  ....... 123-012-012  \nNo employ\u00e9 ........................ 14023  \nDate de naissance ................. 1959-06-14 \nDate d'emploi ..................... 1996-10-22  \n</code></pre>\n\n<p>I Expected to have in Excel: </p>\n\n<pre><code>INFORMATION DE BASE ET DONN\u00c9ES DE CALCUL  \nDate d'emploi 1998-09-28  \nINFORMATION DE BASE ET DONN\u00c9ES DE CALCUL  \nDate d'emploi 1996-10-22  \n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>Sub test()\nDim myFile As String, text As String, textline As String, DDC As Integer, i As Integer, sArray(4) As String\n\nmyFile = \"C:\\Users\\mark\\Desktop\\C0010DET.txt\"\nOpen myFile For Input As #1\nDo Until EOF(1)\n    Line Input #1, textline\n     text = text &amp; textline\nLoop\nClose #1\n\n\n    i = 1\n\n    Dim vItm As Variant\n    Dim aStrings(1 To 2) As String\n\n    aStrings(1) = \"INFORMATION DE BASE ET DONN\u00c9ES DE CALCUL\": aStrings(2) = \"INFORMATION DE BASE ET DONN\u00c9ES DE CALCUL\"\n\n    For Each vItm In aStrings\n        DDC = InStr(text, \"Date d'emploi\")\n        Cells(i + 1, 1).Value = Mid(text, DDC, 14)\n        Cells(i + 1, 2).Value = Mid(text, DDC + 36, 10)\n        Next vItm\n\nEnd Sub\n</code></pre>\n\n<p>Do you know how I could run this sequence using a loop so I can retrieve all information needed?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1447213051, "post_id": 33643749, "comment_id": 55061583, "body": "Merged cells are the Devil&#39;s work..."}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1447213447, "post_id": 33643749, "comment_id": 55061669, "body": "if you want to copy and paste merged cells, you will need to specify which ranges are merged, i.e. if you want to copy a merged cell, which originally consisted of range C9 and D9, then you will have to use <code>Range(&quot;C9&quot;,&quot;D9&quot;).Copy (Worksheets(&quot;FRONT&quot;).Range(&quot;G7&quot;))</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 1, "creation_date": 1447213902, "post_id": 33643749, "comment_id": 55061780, "body": "@MarcoGetrost not exactly. Copying <i>from</i> merged cells is a little easier than copying <i>to</i> merged cells using the <code>MergeArea</code> property of a range object."}], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447215193, "post_id": 33643980, "comment_id": 55062099, "body": "Dear David, I&#39;ve tested successfully <code>src.copy dest.MergeArea</code>, where dest is any cell from the merged area. Is there a problem with some versions of Excel or something?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447215827, "post_id": 33643980, "comment_id": 55062260, "body": "I&#39;m not sure I understand what you&#39;re asking @A.S.H -- what is your question/problem?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447215895, "post_id": 33643980, "comment_id": 55062273, "body": "I am saying that the copy operation worked for me as indicated, without the need to unmerge then merge the destination area. So I wonder if I misunderstood the reason for this complexity."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447216379, "post_id": 33643980, "comment_id": 55062401, "body": "I wrote a simple macro with <code>Range(&quot;A1&quot;).Copy Destination:= Sheets(&quot;Sheet8&quot;).Range(&quot;H9&quot;).MergeArea</code> where <code>H9</code> is inside a large merged area... and it worked without problem. That made me wonder if I misunderstood the requirements question or if that would not work with some versions of Excel."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447216589, "post_id": 33643980, "comment_id": 55062451, "body": "@A.S.H  I&#39;m looking at Excel 2010 right now and when I do <code>src.Copy dest.MergeArea</code>, then the formatting doesn&#39;t carry through, only the <code>.Value</code>..  If i do simple <code>src.Copy dest</code> then 1004 &quot;Can&#39;t change part of a merged cell&quot;"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 2, "creation_date": 1447216764, "post_id": 33643980, "comment_id": 55062489, "body": "I confirm. That is it then, bad me. Didnt see it in the question of the OP that they wanted to <b>keep the format</b>... But it is said in the title!! :D. My apologies."}, {"owner": {"reputation": 1, "user_id": 5491345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c256f6299f41bad26b9eca42d60226ff?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Shepherd", "link": "https://stackoverflow.com/users/5491345/tom-shepherd"}, "edited": false, "score": 0, "creation_date": 1447217127, "post_id": 33643980, "comment_id": 55062579, "body": "I was just about to ask this.  The updated code you sent works perfectly but loses the formatting, anyway around this?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 1, "user_id": 5491345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c256f6299f41bad26b9eca42d60226ff?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Shepherd", "link": "https://stackoverflow.com/users/5491345/tom-shepherd"}, "edited": false, "score": 0, "creation_date": 1447252476, "post_id": 33643980, "comment_id": 55078795, "body": "@TomShepherd the code I put for <code>Worksheet_Change</code> seems to work when I test it. If you&#39;re having trouble still, can you revise your Q and include the code you&#39;re currently attempting to use? I can take a look and see what the problem is."}, {"owner": {"reputation": 1, "user_id": 5491345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c256f6299f41bad26b9eca42d60226ff?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Shepherd", "link": "https://stackoverflow.com/users/5491345/tom-shepherd"}, "edited": false, "score": 0, "creation_date": 1447280456, "post_id": 33643980, "comment_id": 55095454, "body": "Hey David,   I am using the exact code above you posted altered for myself.   It doesn&#39;t seem to carry over any of the formatting, I am using excel 2010 if that makes a difference. I have tried it on a brand new spreadsheet with identical amounts of merged cells moving to the same amount of merged cells."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1447280644, "post_id": 33643980, "comment_id": 55095538, "body": "<b>If you&#39;re having trouble still, can you revise your Q and include the code you&#39;re currently attempting to use? I can take a look and see what the problem is.</b>  Was that not clear the first time?"}, {"owner": {"reputation": 1, "user_id": 5491345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c256f6299f41bad26b9eca42d60226ff?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Shepherd", "link": "https://stackoverflow.com/users/5491345/tom-shepherd"}, "edited": false, "score": 0, "creation_date": 1447281101, "post_id": 33643980, "comment_id": 55095779, "body": "Ok I will do my best explaining it again.  I am attempting to move the contents of a cell from one worksheet to another and not lose the formatting (colour, font, bolding etc). The cell in which they are being transposed into is 100 or so merged cells forming a big reading pane on the form.   I am using the update code you provided. I cannot paste it as it takes me over the word limit so I will post below. The code works to copy, but does not take the formatting with it."}, {"owner": {"reputation": 1, "user_id": 5491345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c256f6299f41bad26b9eca42d60226ff?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Shepherd", "link": "https://stackoverflow.com/users/5491345/tom-shepherd"}, "edited": false, "score": 0, "creation_date": 1447281110, "post_id": 33643980, "comment_id": 55095787, "body": "Private Sub Worksheet_Change(ByVal Target As Excel.Range)      Dim src as Range, dest as Range      Dim mergeAddress as String     Set src = Range(&quot;C9&quot;)      Set dest = Worksheets(&quot;FRONT&quot;).Range(&quot;G7&quot;) mergeAddress = dest.MergeArea.Address If Not Intersect(Target,src) Is Nothing Then     dest.MergeArea.Cells(1).Value = src.Value     src.Copy     dest.PasteSpecial xlPasteFormats     dest.Parent.Range(mergeAddress).Merge End If End Sub"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1447281203, "post_id": 33643980, "comment_id": 55095833, "body": "What part of <b>REVISE YOUR ORIGINAL QUESTION</b> don&#39;t you understand?  Code doesn&#39;t belong in comments, as you can plainly see from the lack of formatting, indentation, etc.  Elaborate explanations also do not belong in the comments."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1447281261, "post_id": 33643980, "comment_id": 55095863, "body": "By revising your original Q, you&#39;re also allowing others to potentially help you. By putting all this in the comments only, you&#39;re basically limiting the audience to <i>only me</i>, which is not a good way to help yourself."}, {"owner": {"reputation": 1, "user_id": 5491345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c256f6299f41bad26b9eca42d60226ff?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Shepherd", "link": "https://stackoverflow.com/users/5491345/tom-shepherd"}, "edited": false, "score": 0, "creation_date": 1447281429, "post_id": 33643980, "comment_id": 55095949, "body": "Right - as you can see I am basically brand new to not only using this forum but VBA. My apologies David."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1447281568, "post_id": 33643980, "comment_id": 55096021, "body": "This is also not a place for chit-chat. if you revise your question, I&#39;ll take a look at it tomorrow."}, {"owner": {"reputation": 1, "user_id": 5491345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c256f6299f41bad26b9eca42d60226ff?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Shepherd", "link": "https://stackoverflow.com/users/5491345/tom-shepherd"}, "edited": false, "score": 0, "creation_date": 1447634837, "post_id": 33643980, "comment_id": 55223106, "body": "I think my original question and revised question was poorly worded, I stumbled across <b>xlPasteAllUsingSourceTheme</b> and this was able to copy the rest of the formatting outside of the font positioning. Thanks for your help David with the answer it was very helpful, much appreciated."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 3, "last_activity_date": 1447215867, "last_edit_date": 1447215867, "creation_date": 1447213846, "answer_id": 33643980, "question_id": 33643749, "link": "https://stackoverflow.com/questions/33643749/macro-to-copy-merged-cell-to-another-merged-cell-whilst-keeping-the-formatting/33643980#33643980", "title": "Macro to copy merged cell to another merged cell whilst keeping the formatting", "body": "<p>This is a little tricky, perhaps this will help.  Merged Cells are a pain to work with. In this case, I think you can solve your problem by:</p>\n\n<ol>\n<li>Get the address of the merged area</li>\n<li>Copy/Paste formatting (this will unmerge the cells)</li>\n<li>Re-merge the cells based on the address obtained in (1) above</li>\n</ol>\n\n<p><strong>Copy FROM one cell to a Merged Area</strong></p>\n\n<p>Here is the example I tested where [A1] has a MergeArea consisting of [A1:C3].  This example assumes you're copying ONE cell into a Merged Cell (e.g., \"H1\" gets copied in to \"A1:C3\"</p>\n\n<pre><code>Sub foo()\nDim src As Range, dest As Range\nDim mergeAddress As String\n\nSet src = [H3]\nSet dest = [A1]\n\n'First, put the value in the merged cells:\ndest.MergeArea.Cells(1).Value = src.Value = src.Value\n\n'Then, the formatting:\n'1. Get the mergeArea.Address\nmergeAddress = dest.MergeArea.Address\n'2. Copy &amp; paste formatting (this unmerges the cells)\nsrc.Copy\ndest.PasteSpecial (xlPasteFormats)\n'3. Re-merge the cells:\nRange(mergeAddress).Merge\n\nEnd Sub\n</code></pre>\n\n<p>Updating your code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\nDim src as Range, dest as Range\nDim mergeAddress as String\nSet src = Range(\"C9\")\nSet dest = Worksheets(\"FRONT\").Range(\"G7\")\nmergeAddress = dest.MergeArea.Address\nIf Not Intersect(Target,src) Is Nothing Then\n    dest.MergeArea.Cells(1).Value = src.Value\n    src.Copy\n    dest.PasteSpecial xlPasteFormats\n    dest.Parent.Range(mergeAddress).Merge\nEnd If\nEnd Sub\n</code></pre>\n\n<p><strong>Copy from Merged Area (full copy)</strong></p>\n\n<p>Copying <em>from</em> merged cell is a little easier, where you can do the following, to copy the entire merged area, and paste to the destination:</p>\n\n<pre><code>src.MergeArea.Copy dest\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 15132306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e297be52b1960f4fb8cb8b4a935dfd5?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/15132306/hello-world"}, "is_accepted": false, "score": 0, "last_activity_date": 1511881589, "creation_date": 1511881589, "answer_id": 47534746, "question_id": 33643749, "link": "https://stackoverflow.com/questions/33643749/macro-to-copy-merged-cell-to-another-merged-cell-whilst-keeping-the-formatting/47534746#47534746", "title": "Macro to copy merged cell to another merged cell whilst keeping the formatting", "body": "<p>I found a solution:</p>\n\n<p>first: write a code to select a cell in the merged cell (It should select the whole merged cell)</p>\n\n<p>second: write a code to copy the selected cells.</p>\n\n<p>Example: I have spreadsheet with each day of the week in a row, but each day of the week is merged with columns \"A\" and \"B\". The code below will select and copy all the data including the rest of the merged cells.</p>\n\n<pre><code>Range(Cells.Find(\"Monday\").Address, Cells.Find(\"Sunday\").Address).Select\nSelection.copy\n</code></pre>\n\n<p>to paste the data, use something along the lines of this:</p>\n\n<pre><code>Range(\"A30\").PasteSpecial xlPasteAll\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5491345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c256f6299f41bad26b9eca42d60226ff?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Shepherd", "link": "https://stackoverflow.com/users/5491345/tom-shepherd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16604, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1511881589, "creation_date": 1447212135, "last_edit_date": 1447282048, "question_id": 33643749, "link": "https://stackoverflow.com/questions/33643749/macro-to-copy-merged-cell-to-another-merged-cell-whilst-keeping-the-formatting", "title": "Macro to copy merged cell to another merged cell whilst keeping the formatting", "body": "<p>As assisted below, I am currently using </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\nDim src as Range, dest as Range\nDim mergeAddress as String\nSet src = Range(\"C9\")\nSet dest = Worksheets(\"FRONT\").Range(\"G7\")\nmergeAddress = dest.MergeArea.Address\nIf Not Intersect(Target,src) Is Nothing Then\ndest.MergeArea.Cells(1).Value = src.Value\nsrc.Copy\ndest.PasteSpecial xlPasteFormats\ndest.Parent.Range(mergeAddress).Merge\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I am still losing the formatting with this code, e.g. bold, colour etc. </p>\n\n<p>Any help would be appreciated. Thank you. </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2418, "user_id": 4205652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-JU-6fQpM_Xs/AAAAAAAAAAI/AAAAAAAAAFA/BmnAnM8FkMM/photo.jpg?sz=128", "display_name": "Richard Erickson", "link": "https://stackoverflow.com/users/4205652/richard-erickson"}, "edited": false, "score": 0, "creation_date": 1447213085, "post_id": 33643627, "comment_id": 55061593, "body": "What code have you tried? Please post it as well as an <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a> if possible."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447213109, "post_id": 33643627, "comment_id": 55061597, "body": "If you are planning to receive output such as <code>A -1, B -1, C -1, D -2, F -1, H -1 </code> in a cell then a User Defined Function would likely be the best bet. Have you got anything to show so far?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5538885"}, "reply_to_user": {"reputation": 2418, "user_id": 4205652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-JU-6fQpM_Xs/AAAAAAAAAAI/AAAAAAAAAFA/BmnAnM8FkMM/photo.jpg?sz=128", "display_name": "Richard Erickson", "link": "https://stackoverflow.com/users/4205652/richard-erickson"}, "edited": false, "score": 1, "creation_date": 1447213915, "post_id": 33643627, "comment_id": 55061782, "body": "@RichardErickson: I added the code. But there I&#39;m giving the cell range as C2:C8. If I give the range as C2:C17, I get the wrong count (it counts the tags that have been used in both Type1 and Type2)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5538885"}, "edited": false, "score": 0, "creation_date": 1447214014, "post_id": 33643627, "comment_id": 55061806, "body": "@Jeeped: No, I do not want to get the output as that. I want to get it in another sheet with Tags in one column and corresponding counts in the next column"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447214295, "post_id": 33643627, "comment_id": 55061876, "body": "Did my edit to your sample results get a little closer to the truth?"}, {"owner": {"reputation": 2418, "user_id": 4205652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-JU-6fQpM_Xs/AAAAAAAAAAI/AAAAAAAAAFA/BmnAnM8FkMM/photo.jpg?sz=128", "display_name": "Richard Erickson", "link": "https://stackoverflow.com/users/4205652/richard-erickson"}, "edited": false, "score": 0, "creation_date": 1447214350, "post_id": 33643627, "comment_id": 55061895, "body": "Thank you for editing your example to include code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5538885"}, "reply_to_user": {"reputation": 2418, "user_id": 4205652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-JU-6fQpM_Xs/AAAAAAAAAAI/AAAAAAAAAFA/BmnAnM8FkMM/photo.jpg?sz=128", "display_name": "Richard Erickson", "link": "https://stackoverflow.com/users/4205652/richard-erickson"}, "edited": false, "score": 0, "creation_date": 1447229680, "post_id": 33643627, "comment_id": 55066429, "body": "@RichardErickson: :)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5538885"}, "edited": false, "score": 0, "creation_date": 1447226278, "post_id": 33644647, "comment_id": 55065089, "body": "When I run this on module sheet, a Macro window pops up. All I did was, Alt+ F11, added a module to the sheet, copy-pasted this, select all and F5. Am I doing it right? I am a newbie to VBA, so sorry for bothering. And one more thing, you said it would be easy to do if column A is filled with types. If so, how can this be achieved? Thanks in advance"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447226402, "post_id": 33644647, "comment_id": 55065146, "body": "It&#39;s actually intended to be used on a worksheet just like any other function. See the sample image and the yellow <b>Syntax</b> blockquote for usage."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5538885"}, "edited": false, "score": 0, "creation_date": 1447229460, "post_id": 33644647, "comment_id": 55066339, "body": "Got it! Thank you very much! :). I would like to learn how this code works. Are there any references I should refer?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1447218811, "last_edit_date": 1592644375, "creation_date": 1447218811, "answer_id": 33644647, "question_id": 33643627, "link": "https://stackoverflow.com/questions/33643627/countif-inside-if-vba/33644647#33644647", "title": "Countif inside if VBA", "body": "<p>Your main problem are the blanks in column A where the <em>Type</em> is only implied by the last entry and not defined for each row. If the <em>Type</em> column was fully populated, this would be a simple <a href=\"https://support.office.com/en-us/article/COUNTIFS-function-53C4DC8E-0E5B-4E32-93DF-9CA5E7DA89ED\" rel=\"nofollow noreferrer\">COUNTIFS function</a>.</p>\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/Qo16S.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Qo16S.png\" alt=\"COUNTIFS using last known\" /></a></p>\n<p>Put the following into a module sheet.</p>\n<pre><code>Function udf_Count_Tag_by_Type(ByVal rTAGs As Range, sTAG As String, _\n                               ByVal rTYPs As Range, sTYP As String)\n    Set rTYPs = Intersect(rTYPs, rTYPs.Parent.UsedRange)\n    Set rTYPs = Application.Range(Application.Index(rTYPs, Application.Match(sTYP, rTYPs, 0)), _\n                                  rTYPs(rTYPs.Cells.Count))\n    If Not IsError(Application.Match(Chr(42), rTYPs.Offset(1, 0), 0)) Then\n        Set rTYPs = rTYPs.Resize(Application.Match(Chr(42), rTYPs.Offset(1, 0), 0), 1)\n    End If\n    Set rTAGs = rTYPs.Offset(0, rTAGs.Column - rTYPs.Column)\n    \n    udf_Count_Tag_by_Type = Application.CountIf(rTAGs, sTAG)\n    \nEnd Function\n</code></pre>\n<blockquote>\n<p>syntax:<br/>\u00a0\u00a0\u00a0\u00a0\u00a0=udf_Count_Tag_by_Type(<em>&lt;type_range&gt;, &lt;type&gt;, &lt;tag_range&gt;, &lt;tag&gt;</em>)</p>\n</blockquote>\n<p>In the sample image in F5 as,</p>\n<pre><code>=udf_Count_Tag_by_Type(Sheet5!$C:$C, F$4, Sheet5!$A:$A, $E5)\n</code></pre>\n<p>Fill both right and down.</p>\n<p>Here are two array\u00b9 formulas that can populate G4:O4 and E5:E6.</p>\n<pre><code>'in G4 then  CSE and fill right\n=IFERROR(INDEX(Sheet5!$C$2:INDEX(Sheet5!$C:$C, MATCH(&quot;zzz&quot;, Sheet5!$C:$C )), MATCH(0, COUNTIF($E4:E4, Sheet5!$C$2:INDEX(Sheet5!$C:$C, MATCH(&quot;zzz&quot;, Sheet5!$C:$C ))), 0)), &quot;&quot;)\n'in E5 then  CSE and fill down\n=IFERROR(INDEX(Sheet5!$A$2:INDEX(Sheet5!$A:$A, MATCH(&quot;zzz&quot;, Sheet5!$A:$A )), MATCH(0, IF(LEN(Sheet5!$A$2:INDEX(Sheet5!$A:$A, MATCH(&quot;zzz&quot;, Sheet5!$A:$A))), COUNTIF(E$4:E4, Sheet5!$A$2:INDEX(Sheet5!$A:$A, MATCH(&quot;zzz&quot;, Sheet5!$A:$A))), 1), 0)), &quot;&quot;)\n</code></pre>\n<p>After they have been entered correctly, fill right and down for a few rows/column more than is immediately necessary in order to automatically catch new entries as they appear in Sheet5!C:C.</p>\n<p>This UDF is likely a little more complicated tha it needs to be. A <a href=\"https://msdn.microsoft.com/en-us/library/5ebk1751.aspx\" rel=\"nofollow noreferrer\">For Each...Next Statement</a> probably would have been more than adequate. However, I've been trying to write all UDFs in such a way that they can receive full column references for more universality without suffering calculation lag.</p>\n<hr />\n<p>\u00b9 <sub>Array formulas need to be finalized with <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter\u21b5</kbd>. Once entered into the first cell correctly, they can be filled or copied down or right just like any other formula. Try and reduce your full-column references to ranges more closely representing the extents of your actual data. Array formulas chew up calculation cycles logarithmically so it is good practise to narrow the referenced ranges to a minimum. See <a href=\"https://support.office.com/en-ca/article/guidelines-and-examples-of-array-formulas-7d94a64e-3ff3-4686-9372-ecfd5caa57c7\" rel=\"nofollow noreferrer\">Guidelines and examples of array formulas</a> for more information.</sub></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5538885"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1447218811, "creation_date": 1447211227, "last_edit_date": 1447214260, "question_id": 33643627, "link": "https://stackoverflow.com/questions/33643627/countif-inside-if-vba", "title": "Countif inside if VBA", "body": "<p>What I want to do is count how many times the tags have been used in each type and write them into a different sheet. My data are as follow.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/j0BqP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j0BqP.png\" alt=\"Sample data\"></a></p>\n\n<p>For this example, it would be like this:</p>\n\n<pre><code>         A  B   C   D   F   H   K   L   M   N\nType1    1  1   1   2   1   1\nType2    1  1   1           1   1   2   1   1 \n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>Sub Countif_trial()\n\nDim myString As String\nDim xRange As Range\n\nSet xRange = Range(\"C2:C8\")\n\nmyString = Range(\"A2\").Value\n\nIf InStr(myString, Type1) Then\n\nRange(\"h1\").Value = Application.CountIf(xRange, \"A\")\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "report", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 816, "user_id": 1861701, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gUg7L.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/1861701/alan"}, "edited": false, "score": 0, "creation_date": 1447251228, "post_id": 33646134, "comment_id": 55077991, "body": "I&#39;m thinking that [Expr1] is not a String but some other data type?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 816, "user_id": 1861701, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gUg7L.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/1861701/alan"}, "edited": false, "score": 0, "creation_date": 1447252018, "post_id": 33646134, "comment_id": 55078533, "body": "@Alan: Then try <code>Public Function GetString(varValues As Variant) As String</code>"}, {"owner": {"reputation": 816, "user_id": 1861701, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gUg7L.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/1861701/alan"}, "edited": false, "score": 0, "creation_date": 1447253569, "post_id": 33646134, "comment_id": 55079523, "body": "Tried it.  I get run time error: You entered an expression that has no value."}, {"owner": {"reputation": 816, "user_id": 1861701, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gUg7L.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/1861701/alan"}, "edited": false, "score": 0, "creation_date": 1447253935, "post_id": 33646134, "comment_id": 55079765, "body": "I found the problem.  The name of the textbox had a circurlar reference to itself.  Its name was the same as the field name.  I renamed the textbox to txtAllValues and that fix it."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 1, "last_activity_date": 1447227817, "creation_date": 1447227817, "answer_id": 33646134, "question_id": 33643568, "link": "https://stackoverflow.com/questions/33643568/setting-controlsource-on-textbox-in-report/33646134#33646134", "title": "Setting ControlSource on textbox in report", "body": "<p>You need a <code>=</code> to evaluate a function.</p>\n\n<p><code>=GetString([Expr1])</code> as controlsource works for me.</p>\n"}], "owner": {"reputation": 816, "user_id": 1861701, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gUg7L.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/1861701/alan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447227817, "creation_date": 1447210860, "question_id": 33643568, "link": "https://stackoverflow.com/questions/33643568/setting-controlsource-on-textbox-in-report", "title": "Setting ControlSource on textbox in report", "body": "<p>In my report why is it that when I set the ControlSource on a textbox in a report to a field name like this: txtSomeTextBox.ControlSource = [Expr1] it populates as expected but when I define a user defined function like this:</p>\n\n<pre><code>Public Function GetString(strValues As String) As String\nGetString = \"Values: \" &amp; strValues\nEnd Function\n</code></pre>\n\n<p>Then set the ControlSource property to txtSomeTextBox.ControlSource = GetString([Expr1]) it doesn't know what to do! In fact the textbox displays: \"#Type!\"  Why can't I pass the value of [Expr1] to the function?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5548989, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207858076118718/picture?type=large", "display_name": "Zach Buechler", "link": "https://stackoverflow.com/users/5548989/zach-buechler"}, "edited": false, "score": 0, "creation_date": 1447281329, "post_id": 33643810, "comment_id": 55095891, "body": "I can&#39;t get your solution to work. It keeps failing at this line:  Ws.Rows(Rowaddress).AutoFilter Field:=Columnaddress, Criteria1:=&quot;Y&quot;  I&#39;ve stepped through it numerous times and it does everything up to that point correctly. I&#39;ve even removed all the filters in the sheet prior to running it."}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "reply_to_user": {"reputation": 31, "user_id": 5548989, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207858076118718/picture?type=large", "display_name": "Zach Buechler", "link": "https://stackoverflow.com/users/5548989/zach-buechler"}, "edited": false, "score": 0, "creation_date": 1447289575, "post_id": 33643810, "comment_id": 55098729, "body": "@ZachBuechler it will check for the word &quot;Advertising&quot;, Since it is the header for the filter  column . It will dynamically get the column number and row number instead of hard coded column number 8. Check if you have changed the column header name from &quot;Advertising&quot;?"}, {"owner": {"reputation": 31, "user_id": 5548989, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207858076118718/picture?type=large", "display_name": "Zach Buechler", "link": "https://stackoverflow.com/users/5548989/zach-buechler"}, "edited": false, "score": 0, "creation_date": 1447730961, "post_id": 33643810, "comment_id": 55265379, "body": "it is finding the right column dynamically but I keep getting the &quot;Runtime error 1004 autofilter method of range class failed&quot; error. I added watch to watch the rowaddress 1 and columnaddress 9 and they are both correct. It also finds the right number of Y&#39;s but it doesn&#39;t go past that line. I really like the idea of being dynamic like that but I can&#39;t seem to figure it out."}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "reply_to_user": {"reputation": 31, "user_id": 5548989, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207858076118718/picture?type=large", "display_name": "Zach Buechler", "link": "https://stackoverflow.com/users/5548989/zach-buechler"}, "edited": false, "score": 0, "creation_date": 1447752787, "post_id": 33643810, "comment_id": 55274361, "body": "I have make few changes. I have added used range in the code. please check the code now and let me know if it works or not"}], "tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": false, "score": 0, "last_activity_date": 1447752720, "last_edit_date": 1447752720, "creation_date": 1447212594, "answer_id": 33643810, "question_id": 33643275, "link": "https://stackoverflow.com/questions/33643275/create-new-dynamic-sheet-based-on-column/33643810#33643810", "title": "Create New Dynamic Sheet based on Column", "body": "<p>Below code will check for sheet Name \"Adversting\"  if not it will create a new one. It will copy the autofilter values ( \"Y\" on Advertising column) and paste it in the advertising sheet</p>\n\n<pre><code>    Option Explicit\n\n    Sub Worksheetfilter()\n\n    Dim c As Variant\n    Dim Wb As Workbook\n    Dim Ws As Worksheet\n    Dim WsPaste As Worksheet\n    Dim Columnaddress As Long\n    Dim Rowaddress As Long\n    Dim Rng As Range\n    Dim Rngcopy As Range\n    Dim Countws As Long\n\n    'On Error Resume Next\n    Set Wb = ThisWorkbook\n\n    Set Ws = Wb.Worksheets(\"sheet1\")\n\n    With Ws.UsedRange\n        Set c = .Find(\"Advertising\", LookIn:=xlValues)\n        If Not c Is Nothing Then\n            Columnaddress = c.Column\n            Rowaddress = c.Row\n       End If\n    End With\n\n\n    Set Rng = Ws.Columns(Columnaddress)\n\n    Countws = WorksheetFunction.CountIf(Rng, \"Y\")\n\n\n    If Countws &gt;= 1 Then\n\n    If e(\"Adversting\") = False Then\n        With Wb.Sheets\n           .Add().Name = \"Adversting\"\n        End With\n    End If\n\n    Set WsPaste = Wb.Worksheets(\"Adversting\")\n\n    WsPaste.Cells.Clear\n\n    Ws.AutoFilterMode = False \n\n    'Ws.Rows(Rowaddress).AutoFilter Field:=Columnaddress, Criteria1:=\"Y\"\n\nWs.UsedRange.Rows(Rowaddress).AutoFilter Field:=Columnaddress, Criteria1:=\"Y\"\n\n\n    Set Rngcopy = Ws.UsedRange.SpecialCells(xlCellTypeVisible)\n\n\n    Rngcopy.Copy\n\n    WsPaste.Cells(1, 1).PasteSpecial xlValues\n\n    Application.CutCopyMode = False\n    Application.CutCopyMode = True\n\n    Ws.AutoFilterMode = False\n    End If\n\n    End Sub\n    Function e(n As String) As Boolean\n\n     Dim Wss As Worksheet\n\n      e = False\n      For Each Wss In Worksheets\n        If n = Wss.Name Then\n          e = True\n          Exit Function\n        End If\n      Next Wss\n    End Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 5548989, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207858076118718/picture?type=large", "display_name": "Zach Buechler", "link": "https://stackoverflow.com/users/5548989/zach-buechler"}, "edited": false, "score": 0, "creation_date": 1447280142, "post_id": 33643819, "comment_id": 55095286, "body": "This method worked as well..I had to make some changes but your code was the base of it. I was having problems with the worksheets(2) line so I changed that."}], "tags": [], "owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "is_accepted": false, "score": 0, "last_activity_date": 1447212656, "creation_date": 1447212656, "answer_id": 33643819, "question_id": 33643275, "link": "https://stackoverflow.com/questions/33643275/create-new-dynamic-sheet-based-on-column/33643819#33643819", "title": "Create New Dynamic Sheet based on Column", "body": "<p>I hope you know how to open VBA and insert a new module. \nPaste this in the module:</p>\n\n<pre><code>Sub test()\n\nDim ws As Worksheet\nDim rN As Long, c As Long, counter As Long\n\nSet ws = Worksheets(2) 'Change the 2 to the index where the sheet is located, i.e. if it is located in 4th position,\n                       'then change the 2 to 4\ncounter = 2 'Assuming you have a Header in your second sheet\n\nWith ActiveSheet\n\nrN = .Cells(.Rows.Count, 1).End(xlUp).Row 'find last row\n\nFor c = 2 To rN\n\n    If .Cells(c, 8).Value = \"Y\" Then 'Copy only if the value in column H is \"Y\"\n\n        .Rows(c).EntireRow.Copy\n\n        ws.Rows(counter).EntireRow.PasteSpecial xlPasteValues\n        counter = counter + 1\n    End If\nNext\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 5548989, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207858076118718/picture?type=large", "display_name": "Zach Buechler", "link": "https://stackoverflow.com/users/5548989/zach-buechler"}, "edited": false, "score": 1, "creation_date": 1447280050, "post_id": 33643983, "comment_id": 55095231, "body": "This one worked for me! I even made a clicky button to do it."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 31, "user_id": 5548989, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207858076118718/picture?type=large", "display_name": "Zach Buechler", "link": "https://stackoverflow.com/users/5548989/zach-buechler"}, "edited": false, "score": 0, "creation_date": 1447280309, "post_id": 33643983, "comment_id": 55095380, "body": "@ZachBuechler Glad it helped. But hey, you owe me a few points! :P just joking of course."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1447213870, "creation_date": 1447213870, "answer_id": 33643983, "question_id": 33643275, "link": "https://stackoverflow.com/questions/33643275/create-new-dynamic-sheet-based-on-column/33643983#33643983", "title": "Create New Dynamic Sheet based on Column", "body": "<p>Add and run this macro:</p>\n\n<pre><code>Sub CreateAdSheet()\n    With Sheets(\"Main Contact\").UsedRange\n       .AutoFilter 8, \"Y\" ' &lt;~~ Assumed advertising is column 8 (H)\n       .Copy Sheets.Add().Cells(2, 1)\n       .AutoFilter\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5548989, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207858076118718/picture?type=large", "display_name": "Zach Buechler", "link": "https://stackoverflow.com/users/5548989/zach-buechler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 33643983, "answer_count": 3, "score": 1, "last_activity_date": 1447752720, "creation_date": 1447208787, "last_edit_date": 1447283069, "question_id": 33643275, "link": "https://stackoverflow.com/questions/33643275/create-new-dynamic-sheet-based-on-column", "title": "Create New Dynamic Sheet based on Column", "body": "<p>I'm trying to make a new sheet that has just the advertisers that want to advertise based on main contact sheet.</p>\n\n<p>My sheet is setup like this:</p>\n\n<pre><code>Customer   Add1   Add2   City/State/Zip   Mailed   Phone   Called   Advertising\n</code></pre>\n\n<p>Where the advertising column is either Y or N. What I want to do is have a new sheet that contains every advertiser that has a y in their advertising column. </p>\n\n<p>I have gotten it to display the customer in the new sheet if sheet 1 contains a Y in the advertising column but I'd have to drag the formula down and then have a ton of blank spaces for the rows that have Ns instead of Ys. I'm a novice at VBA and don't even know where to start if that's how I will have to do it. </p>\n\n<p>I'm trying to keep track of what kind of ads they want on a separate sheet so I don't have any more columns on my main sheet and cluttering it up. If it comes down to it I guess I can write a C++ program to do it but I'd like to keep it in excel.</p>\n\n<p>I've looked at some of the code on here but I have no clue how to manipulate it to what I need.</p>\n\n<p>EDIT This is what I have working for me right now, I combined two of the solutions into one: </p>\n\n<pre><code>Sub AdvertisingFilter()\nDim Wb As Workbook\nDim Ws As Worksheet\nDim Wst\nDim rN As Long, c As Long, counter As Long\n\nSet Wb = ThisWorkbook\n\nIf e(\"Advertising\") = False Then\n    With Wb.Sheets\n       .Add().Name = \"Advertising\"\n    End With\nEnd If\n\nSet Ws = Wb.Worksheets(\"Advertising\")\nSet Wst = Wb.Worksheets(\"Customers\")\n\nWs.Cells.Clear\n\ncounter = 2 'Assuming you have a Header in your second sheet\n\nWith Wst\n\nrN = .Cells(.Rows.Count, 1).End(xlUp).Row 'find last row\n\nFor c = 2 To rN\n\n    If .Cells(c, 9).Value = \"Y\" Then 'Copy only if the value in column I is \"Y\"\n\n        .Rows(c).Columns(1).Copy\n        Ws.Rows(counter).Columns(1).PasteSpecial xlPasteValues\n        counter = counter + 1\n    End If\nNext\n\nEnd With\n\nEnd Sub\n\nFunction e(n As String) As Boolean\n\n Dim Wss As Worksheet\n\n  e = False\n  For Each Wss In Worksheets\n    If n = Wss.Name Then\n      e = True\n      Exit Function\n    End If\n  Next Wss\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1447203399, "post_id": 33642482, "comment_id": 55059103, "body": "you need to put quotes around the string <code>&quot;Call Fail Rate&quot;</code>"}, {"owner": {"reputation": 199, "user_id": 2606653, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e08d03a0f7e0a3e13c7c962fad4cad86?s=128&d=identicon&r=PG", "display_name": "Randy Adhitama", "link": "https://stackoverflow.com/users/2606653/randy-adhitama"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447203697, "post_id": 33642482, "comment_id": 55059203, "body": "ah my bad, forgot to put the quotes. Thanks for the help Scoot"}], "owner": {"reputation": 199, "user_id": 2606653, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e08d03a0f7e0a3e13c7c962fad4cad86?s=128&d=identicon&r=PG", "display_name": "Randy Adhitama", "link": "https://stackoverflow.com/users/2606653/randy-adhitama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1447213223, "creation_date": 1447203254, "last_edit_date": 1531161705, "question_id": 33642482, "link": "https://stackoverflow.com/questions/33642482/autofilter-using-our-own-variable", "title": "Autofilter using our own variable", "body": "<p>I have a  problem with autofilter using macro. The idea is how to use autofilter with macro using spesific criteria from myself. This is the original code for my autofilter:</p>\n\n<pre><code>ActiveSheet.Range(\"$A$4:$P$100\").AutoFilter Field:=4, Criteria1:= _\n    \"Call Success Rate\"\n</code></pre>\n\n<p>I tried to make a variable called \"temp\" to manipulate the criteria:</p>\n\n<pre><code>Dim temp As String\n</code></pre>\n\n<p>then declare the temp</p>\n\n<pre><code>temp = Call Fail Rate\n</code></pre>\n\n<p>but when I run the macro, the autofilter didn't recognize \"temp\" variable.</p>\n\n<p>So how to make this autofilter recognize my own variable?</p>\n"}, {"tags": ["excel", "syntax-error", "vba"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1447199150, "post_id": 33641719, "comment_id": 55057722, "body": "Does the error occur when trying to compile? Are you sure it&#39;s because of this actual prcedure?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1447200248, "post_id": 33641719, "comment_id": 55058103, "body": "Is there more code to this sub that you are not showing?"}, {"owner": {"reputation": 11, "user_id": 5548688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc5030c9d9580abc198ba9ff05cd991?s=128&d=identicon&r=PG&f=1", "display_name": "Spencer Oswald", "link": "https://stackoverflow.com/users/5548688/spencer-oswald"}, "edited": false, "score": 0, "creation_date": 1447289441, "post_id": 33641719, "comment_id": 55098688, "body": "Macro Man, thanks for the response.  I have not tried to compile that i know of. I am fairly new to Macros and have been updating a previous users complicated macro. There is a sub before this one that moves the data from one sheet to the chart fields. Maybe i am wrong but wouldn&#39;t the various subs run in conjuncture but not effect the next sub? Again I am new to this. Thanks again!"}], "owner": {"reputation": 11, "user_id": 5548688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc5030c9d9580abc198ba9ff05cd991?s=128&d=identicon&r=PG&f=1", "display_name": "Spencer Oswald", "link": "https://stackoverflow.com/users/5548688/spencer-oswald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1447297516, "creation_date": 1447198627, "last_edit_date": 1531164843, "question_id": 33641719, "link": "https://stackoverflow.com/questions/33641719/block-if-without-end-if-error-when-creating-a-chart", "title": "Block if without end if Error when creating a chart", "body": "<p>I am trying to automate the creation of 4 charts in excel.  I know others have had the same \"Block If without End if\" issue but I couldn't seem to get this to work.</p>\n\n<p>This is the updated Code for the whole Sub.  There are 3 other subs that work before this sub but there didn't seem to be issues with them.</p>\n\n<pre><code>Sub BuildCharts(rngIn As Range, rngOut As Range, strChartType As String)\n\n' Variable Declarations\nDim rngAIRThisYear As Range 'Data Source of AIRthisyear\nDim rngAIRLastYear As Range 'Data Source of AIRLastYear\nDim rngSEICompare As Range 'Data Source of SEICompare\nDim rngSEIThisYear As Range 'Data Source of SEIChart\n\nDim strAIRThisYearName As String 'Name of the first chart object\nDim strAIRLastYearName As String 'Name of the second chart object\nDim strSEICompareName As String 'Name of the first chart object\nDim strSEIThisYearName As String 'Name of the second chart object\n\nDim strAIRThisYearAddr As String 'Template of AIRThisYear\nDim strAIRLastYearAddr As String 'Template of AIRLastYear\nDim strSEICompareAddr As String 'Template of SEIcompare\nDim strSEIThisYearAddr As String 'Template of SEIChart\n\nDim strTitleAIRThisYear As String 'Title of AIRThisYear\nDim strTitleAIRLastYear As String 'Title of AIRLastYear\nDim strTitleSEICompare As String 'Title of AIRThisYear\nDim strTitleSEIThisYear As String 'Title of AIRLastYear\n\nDim intLnTitle As Integer 'Length of the chart's Title\nDim intLnPeriod As Integer 'Length of the chart's time period (which is part of the title)\n\nDim strPercentage As String 'Percentage of Total TODO REMOVE AS UNUSED?\n\nDim strChartExportFile As String 'Filepath where charts will be saved: needs to end in .png\n\n    ' Variable Initialization\n\n     If (strChartType = \"AIRThisYear\") Then ' These are AIRThisYear\n        Set rngAIRThisYear = Sheets(\"ChartData\").Range(\"A12:D17\")\n        strAIRThisYearAddr = ThisWorkbook.Path &amp; \"\\ - AIRThisYear.crtx\"\n        strTitleAIRThisYear = rngIn.Offset(0, 1) &amp; \" - AIRThisYear\"\n        strAIRThisYearName = rngIn.Offset(0, 1) &amp; \" - AIRThisYear\"\n\n    ElseIf (strChartType = \"AIRLastYear\") Then ' These are AIRLastYear\n        Set rngAIRLastYear = Sheets(\"ChartData\").Range(\"A3:D7\")\n        strAIRLastYearAddr = ThisWorkbook.Path &amp; \"\\ - AIRLastYear.crtx\"\n        strTitleAIRLastYear = rngIn.Offset(0, 1) &amp; \" - AIRLastYear\"\n        strAIRLastYearName = rngIn.Offset(0, 1) &amp; \" - AIRLastYear\"\n\n    ElseIf (strChartType = \"SEICompare\") Then ' These are These are SEICompare\n        Set rngSEICompare = Sheets(\"ChartData\").Range(\"A12:D17\")\n        strSEICompareAddr = ThisWorkbook.Path &amp; \"\\ - SEICompare.crtx\"\n        strTitleSEICompare = rngIn.Offset(0, 1) &amp; \" - SEICompare\"\n        strSEICompareName = rngIn.Offset(0, 1) &amp; \" - SEICompare\"\n\n    ElseIf (strChartType = \"SEIThisYear\") Then 'These are SEI This Year Charts\n        Set rngSEIThisYear = Sheets(\"ChartData\").Range(\"A12:D17\")\n        strSEIThisYearAddr = ThisWorkbook.Path &amp; \"\\ - SEIThisYear.crtx\"\n        strTitleSEIThisYear = rngIn.Offset(0, 1) &amp; \" - SEIThisYear\"\n        strSEIThisYearName = rngIn.Offset(0, 1) &amp; \" - SEIThisYear\"\n\n    End If\n\n  rngIn.Offset(0, 1) = rngIn.Offset(0, 2)\n\n   'Create AIRThisYear -----------\nSheets(\"ChartData\").Activate\nrngAIRThisYear.Select\nSheets(\"ChartData\").Shapes.AddChart.Select\nActiveChart.ApplyChartTemplate (strAIRThisYearAddr)\nActiveChart.SetSourceData Source:=rngAIRThisYear\nActiveChart.Parent.Name = strAIRThisYearName\n\n'Change Title\nActiveChart.ChartTitle.Text = strTitleAIRThisYear\nCall ChangeChartTitle(ActiveChart, intLnTitle, intLnPeriod)\n\n'Export the chart image\nstrChartExportFile = strAIRThisYearName &amp; \".png\"\nCall SaveChartAsImage(ActiveChart, strChartExportFile)\n\n'Update the merge sheet with the path of the image we just exported\nIf (strChartType = \"AIRThisYear\") Then\n    rngOut.Offset(0, 9) = strChartExportFile\nElse\n    rngOut.Offset(0, 11) = strChartExportFile\nEnd If\n\n'Done with the chart, so delete it...\nSheets(\"ChartData\").ChartObjects(strAIRThisYearName).Delete\n\n    'Create AIRLastYear \nSheets(\"ChartData\").Activate\nrngAIRLastYear.Select\nSheets(\"ChartData\").Shapes.AddChart.Select\nActiveChart.ApplyChartTemplate (strAIRLastYearAddr)\nActiveChart.SetSourceData Source:=rngAIRLastYear\nActiveChart.Parent.Name = strAIRLastYearName\n\n'Change Title\nActiveChart.ChartTitle.Text = strTitleAIRLastYear\nCall ChangeChartTitle(ActiveChart, intLnTitle, intLnPeriod)\n\n'Export the chart image\nstrChartExportFile = strAIRLastYearName &amp; \".png\"\nCall SaveChartAsImage(ActiveChart, strChartExportFile)\n\n'Update the merge sheet with the path of the image we just exported\nIf (strChartType = \"AIRLastYear\") Then\n    rngOut.Offset(0, 10) = strChartExportFile\nElse\n    rngOut.Offset(0, 12) = strChartExportFile\nEnd If\n\n'Done with the chart, so delete it...\nSheets(\"ChartData\").ChartObjects(strAIRLastYearName).Delete\n\n'Create SEICompare \nrngSEICompare.Select\nActiveSheet.Shapes.AddChart.Select\nActiveChart.ApplyChartTemplate (strSEICompareAddr)\nActiveChart.SetSourceData Source:=rngSEICompare\nActiveChart.Parent.Name = strSEICompareName\nActiveChart.PlotBy = xlColumns\n\n'Change Title\nActiveChart.ChartTitle.Text = strTitleSEICompare\nCall ChangeChartTitle(ActiveChart, intLnTitle, intLnPeriod)\n\n'Export the chart image\nstrChartExportFile = strSEICompareName &amp; \".png\"\nCall SaveChartAsImage(ActiveChart, strChartExportFile)\n\n'Update the merge sheet with the path of the image we just exported\nIf (strChartType = \"SEICompare\") Then\n    rngOut.Offset(0, 13) = strChartExportFile\nElse\n    rngOut.Offset(0, 15) = strChartExportFile\nEnd If\n\n'Done with the chart, so delete it...\nSheets(\"ChartData\").ChartObjects(strSEICompareName).Delete\n\n'Create SEIChart ------\nrngSEIThisYear.Select\nActiveSheet.Shapes.AddChart.Select\nActiveChart.ApplyChartTemplate (strSEIThisYearAddr)\nActiveChart.SetSourceData Source:=rngSEIThisYear\nActiveChart.Parent.Name = strSEIThisYearName\nActiveChart.PlotBy = xlColumns\n\n'Change Title\nActiveChart.ChartTitle.Text = strTitleSEIThisYear\nCall ChangeChartTitle(ActiveChart, intLnTitle, intLnPeriod)\n\n'Export the chart image\nstrChartExportFile = strSEIThisYearName &amp; \".png\"\nCall SaveChartAsImage(ActiveChart, strChartExportFile)\n\n'Update the merge sheet with the path of the image we just exported\nIf (strChartType = \"SEIThisYear\") Then\n    rngOut.Offset(0, 14) = strChartExportFile\nElse\n    rngOut.Offset(0, 16) = strChartExportFile\nEnd If\n\nSheets(\"ChartData\").ChartObjects(strSEIThisYearName).Delete\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1447196450, "post_id": 33641245, "comment_id": 55056627, "body": "This sounds more like a corrupted workbook than an issue with the underlying VBA code."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447206011, "post_id": 33641245, "comment_id": 55059835, "body": "<a href=\"http://www.contextures.com/xlDataVal08.html\" rel=\"nofollow noreferrer\">contextures.com/xlDataVal08.html</a> mentions a 256-character limit on lists used for validation drop-downs.  Can you not instead directly reference the named range ?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447206435, "post_id": 33641245, "comment_id": 55059959, "body": "@TimWilliams just tried it with a string llist with more than 5200 values, on a single cell. No problems whatsoever :D. I lean to think that it is a problem of resources if there are too many cells with such validation rule."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1447207306, "post_id": 33641245, "comment_id": 55060166, "body": "@A.S.H - did you try saving and then re-opening the file? When I tested with just under 256 chars - no problem: just over 256 chars and I got the same error as the OP.  (Tested by saving as .xlsm format)  See also same issue at <a href=\"http://www.pcreview.co.uk/threads/data-validation-list-limit.3627051/\" rel=\"nofollow noreferrer\">pcreview.co.uk/threads/data-validation-list-limit.3627051</a>"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447207787, "post_id": 33641245, "comment_id": 55060284, "body": "@TimWilliams Ah yes. I did not save. When saving, I had the pattern. Sorry for confusing you guys."}], "owner": {"reputation": 35, "user_id": 5534721, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2710a7cf4de3d32d45d70f4e634eb6ee?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Brophy", "link": "https://stackoverflow.com/users/5534721/matthew-brophy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "closed_date": 1447207591, "answer_count": 0, "score": 0, "last_activity_date": 1447319405, "creation_date": 1447196173, "last_edit_date": 1447319405, "question_id": 33641245, "link": "https://stackoverflow.com/questions/33641245/error-message-relating-to-xlvalidatelist", "closed_reason": "Duplicate", "title": "Error message relating to xlValidateList", "body": "<p>Many thanks for your help on this. My issue was resolved by referencing the named range \"lstlocations\" rather than doing a loop through the named range creating a string (subject to the 255 character limit). I'm sure this is obvious to most, I'm quite new to VBA. </p>\n\n<p>This is a great website by the way. </p>\n\n<pre><code>    For Each Value In Range(\"lstLocations\")\n        ALoc = ALoc &amp; \",\" &amp; Value\n    Next Value\n\n  I'm getting an error when I open my workbook, the error reads:\n</code></pre>\n\n<p>\"We found a problem with some content in \" file \". Do you want us to try to recover as much as we can ...\"</p>\n\n<p>When I select \"yes\" a message pops up saying \"Removed feature: Data Validation...\"</p>\n\n<p>Basically, I use a userform to populate cells with drop-down boxes. I can pinpoint where the error arises. It seems to occur where the dropdown has loads of items i.e. in the case of location, the error starts when I hve 26+ locations - it works fine with 25 or less. </p>\n\n<p>Here is the part of my code where the error is orinating</p>\n\n<p>lstLocations us a range with 90 levels. When I reduce this to 25 I don't get the error. Is there a limit to the number of characters that can be used? Is there a way to overcome this without reducing the number of levels?</p>\n\n<pre><code>    With Sheets(\"Begin Quote\").Range(\"MainLocation\").Validation\n    .Delete\n    .Add _\n    Type:=xlValidateList, _\n    AlertStyle:=xlValidAlertStop, _\n    Formula1:=ALoc\n    End With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1447196208, "post_id": 33641010, "comment_id": 55056510, "body": "<b>You canNOT name a variable by any used name like Types, Built-In functions, ...</b> So change <code>Dim DataObject As DataObject</code> to <code>Dim AnyThingElseYouWant As DataObject</code>"}], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1447195781, "post_id": 33641087, "comment_id": 55056321, "body": "you may need to add the msforms reference also, adding a userform should do it, if not there already."}, {"owner": {"reputation": 133, "user_id": 3212600, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a1d75151579fc9cf0be7ecc4d02d58a4?s=128&d=identicon&r=PG&f=1", "display_name": "Chaoxys", "link": "https://stackoverflow.com/users/3212600/chaoxys"}, "edited": false, "score": 0, "creation_date": 1447195861, "post_id": 33641087, "comment_id": 55056356, "body": "Thanks, I tried but I still have the same error (the line highlighted in yellow for debug is : Sub TextBox1_Click())."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1447196073, "post_id": 33641087, "comment_id": 55056446, "body": "Is it a Userform? if so i think Its textbox enter or mousedown"}], "tags": [], "owner": {"reputation": 2931, "user_id": 3242103, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zmsJQ.jpg?s=128&g=1", "display_name": "snow_FFFFFF", "link": "https://stackoverflow.com/users/3242103/snow-ffffff"}, "is_accepted": false, "score": 2, "last_activity_date": 1447195518, "creation_date": 1447195518, "answer_id": 33641087, "question_id": 33641010, "link": "https://stackoverflow.com/questions/33641010/copy-textbox-to-clipboard/33641087#33641087", "title": "Copy TextBox to clipboard", "body": "<p>You need to specify it as a MSForms.DataObject:</p>\n\n<pre><code>Dim clipboard As MSForms.DataObject\nSet clipboard = New MSForms.DataObject\nclipboard.SetText Me.TextBox1.Text\nclipboard.PutInClipboard\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1447195881, "creation_date": 1447195881, "answer_id": 33641180, "question_id": 33641010, "link": "https://stackoverflow.com/questions/33641010/copy-textbox-to-clipboard/33641180#33641180", "title": "Copy TextBox to clipboard", "body": "<p><strong>First : you canNOT name a variable by any used name like Types, Built-In functions, ...</strong> <br>\nSo change <code>Dim DataObject As DataObject</code> to <code>Dim AnyThingElseYouWant As DataObject</code></p>\n\n<p>After that, <strong>2 options if you still have an error</strong> :</p>\n\n<ol>\n<li><p>You may need to explicitly reference the DataObject as being from the Forms library like <br> <code>Dim Clipboard as MSForms.DataObject</code></p></li>\n<li><p>You are missing a reference :</p></li>\n</ol>\n\n<p>If <code>MSForms</code> is not listed in the References list, go to add a reference and then hit the \"Browse...\" button to look for the file yourself. </p>\n\n<p><code>MSForms</code> is in a file called <code>FM20.dll</code> (at least for version 2.0; other versions would be numbered accordingly) which is probably in your Windows\\System32 folder.</p>\n\n<p>If you can't find the file, it may have somehow gotten erased and you may need to reinstall it.</p>\n"}], "owner": {"reputation": 133, "user_id": 3212600, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a1d75151579fc9cf0be7ecc4d02d58a4?s=128&d=identicon&r=PG&f=1", "display_name": "Chaoxys", "link": "https://stackoverflow.com/users/3212600/chaoxys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3247, "favorite_count": 0, "accepted_answer_id": 33641180, "answer_count": 2, "score": 1, "last_activity_date": 1487250833, "creation_date": 1447195147, "last_edit_date": 1487250833, "question_id": 33641010, "link": "https://stackoverflow.com/questions/33641010/copy-textbox-to-clipboard", "title": "Copy TextBox to clipboard", "body": "<p>I try to copy all the textbox in the clipboard (when I do a left click on the textbox). I get an error: <em>User-defined type not defined</em>. The code:</p>\n\n<pre><code>Sub TextBox1_Click()\nDim DataObject As DataObject\n          Set DataObject = New DataObject\n          DataObject.SetText Me.TextBox1.Text\n          DataObject.PutInClipboard\nEnd Sub\n</code></pre>\n\n<p>Any idea?</p>\n"}, {"tags": ["vba", "report", "ms-access-2010"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1447194857, "post_id": 33640460, "comment_id": 55055929, "body": "Hi, what you have there would set the value of that field to the return of the function PopulateTextboxes, if this returns nothing then nothing will be there.  You need to call it when the report opens, but I am not sure it will work like that, I think you&#39;ll need to have separate fields for each text box, then just bind them to that, so name,op1,op2,op3,op4 etc.etc."}, {"owner": {"reputation": 816, "user_id": 1861701, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gUg7L.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/1861701/alan"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1447196029, "post_id": 33640460, "comment_id": 55056428, "body": "FYI, the function doesn&#39;t return anything, but even so, when I altered the function so that it did return something, the function still wasn&#39;t being fired. Interestingly enough, even when I don&#39;t call the function and simply set the ControlSource of the first textbox to just Expr1, then run the report, that textbox doesn&#39;t populate with the data.  I&#39;m stumped."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1447196253, "post_id": 33640460, "comment_id": 55056538, "body": "Can you show the function code?"}, {"owner": {"reputation": 816, "user_id": 1861701, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gUg7L.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/1861701/alan"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1447197071, "post_id": 33640460, "comment_id": 55056896, "body": "Sure.  I&#39;ve edited the original post with the added function."}, {"owner": {"reputation": 816, "user_id": 1861701, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gUg7L.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/1861701/alan"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1447197400, "post_id": 33640460, "comment_id": 55057037, "body": "I&#39;ve set a breakpoint within the function but since the function isn&#39;t being fired neither is the breakpoint being triggered."}, {"owner": {"reputation": 816, "user_id": 1861701, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gUg7L.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/1861701/alan"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1447198767, "post_id": 33640460, "comment_id": 55057553, "body": "Since I was having problems with the textbox named txtDesig_1, I created a new textbox and gave its ControlSource = Expr1.  That worked.  Then I changed it to = PopulateTextboxes([Expr1]).  Then I got a runtime error message saying &quot;Invalid use of property&quot;.  This maybe a clue.  Any ideas?"}], "answers": [{"comments": [{"owner": {"reputation": 816, "user_id": 1861701, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gUg7L.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/1861701/alan"}, "edited": false, "score": 0, "creation_date": 1447200739, "post_id": 33641877, "comment_id": 55058277, "body": "I edited the function as advised.  I called the function from the Detail_Format as suggested, however, that isn&#39;t even being fired.  I put a breakpoint on the function call but it&#39;s not breaking there."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 816, "user_id": 1861701, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gUg7L.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/1861701/alan"}, "edited": false, "score": 0, "creation_date": 1447201311, "post_id": 33641877, "comment_id": 55058444, "body": "You must open the report in <b>Page Preview</b>, not in Report view, for the Format event to fire. Not sure if there is a suitable event for Report view."}, {"owner": {"reputation": 816, "user_id": 1861701, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gUg7L.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/1861701/alan"}, "edited": false, "score": 0, "creation_date": 1447257373, "post_id": 33641877, "comment_id": 55082175, "body": "Calling the function from Detail_Format is not acceptable.  The report must display in Report View.  I discovered another problem as to why the function wasn&#39;t being called in the first place. Now that that is fixed and I&#39;m able to step through the code, I&#39;ll post a separate question on this forum about another new issue at hand."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1447199525, "creation_date": 1447199525, "answer_id": 33641877, "question_id": 33640460, "link": "https://stackoverflow.com/questions/33640460/reports-textbox-function-call-from-controlsource-not-firing/33641877#33641877", "title": "Report&#39;s textbox function call from ControlSource not firing", "body": "<p>The best way is to call your function from the <code>Format</code> event of the Detail section, so it will be called for each record.</p>\n\n<pre><code>Private Sub Detail_Format(Cancel As Integer, FormatCount As Integer)\n    Call PopulateTextboxes(Me.Expr1)\nEnd Sub\n</code></pre>\n\n<p>If <code>PopulateTextboxes</code> is in a separate module, I suggest to pass <code>Me</code> as additional parameter for the report, so you don't have to hardcode the report name.</p>\n\n<p>Also note that you need the <code>Set</code> keyword when assigning object variables, e.g.</p>\n\n<pre><code>Set txt = rpt.Controls.item(\"txtDesig_\" &amp; CStr(i))\n</code></pre>\n"}], "owner": {"reputation": 816, "user_id": 1861701, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gUg7L.jpg?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/1861701/alan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1447257092, "creation_date": 1447192815, "last_edit_date": 1447257092, "question_id": 33640460, "link": "https://stackoverflow.com/questions/33640460/reports-textbox-function-call-from-controlsource-not-firing", "title": "Report&#39;s textbox function call from ControlSource not firing", "body": "<p>Firstly, here's a pic on my report in design mode:</p>\n\n<p><a href=\"https://i.stack.imgur.com/aSilB.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aSilB.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The underlying query for the report returns values like so:</p>\n\n<pre><code>Allen    Nelli    3:A,5:B,7:A,8:A, etc.\nBreton   Micheline    1:A,3:A,5:B,7:A, etc\nCaporale    Jody    1:A,3:A,5:B,7:A, etc\n</code></pre>\n\n<p>I had to use a subquery to get the third field which concatenates the <strong>number : letter</strong> combinations.  These values actually represent day of month and designation to a particular shift in a schedule.  So basically, for a given month, each individual works the designated shift indicated by the day value.</p>\n\n<p>The intention is to call a user defined public function named PopulateTextboxes(Value as String) to be called from the first textbox in the report from the textbox's ControlSource property.  The third field in the query is actually named Expr1 and that is being passed as a parameter to the function. The function is designed to populate all the textboxes with the appropriate letter designation: A or B or C or D, etc. The function itself is not being fired when I run the report. </p>\n\n<p>The function is as follows:</p>\n\n<pre><code>    Public Function PopulateTextboxes(Expr As String) As String\n'Each element of Expr should be a number followed by a colon followed by a letter: 10:A,12:B,15:C, etc.\nDim shiftData() As String\nDim Data As Variant\nDim i As Integer\nDim j As Integer\nDim temp() As String\nDim txt As TextBox\nDim rpt As Report\nDim strCtrl As String\n\nIf Expr = \"\" Then Exit Function\n\nIf IsNull(Expr) Then Exit Function\n\nshiftData = Split(Expr, \",\")\n\nIf UBound(shiftData) &gt; 0 Then\n  'Make a 2D array\n  ReDim Data(UBound(shiftData), 2)\n  'Load up 2D array\n  For i = 0 To UBound(shiftData) - 1\n    If shiftData(i) &lt;&gt; \"\" Then\n        temp = SplitElement(shiftData(i), \":\")\n        Data(i, 0) = temp(0)\n        Data(i, 1) = temp(1)\n    End If\n  Next i\n\n  Set rpt = Reports.item(\"Multi_Locations_Part_1\")\n\n  If UBound(days) = 0 Then\n    MsgBox \"days array not populated\"\n    Exit Function\n  End If\n\n  'Populate each Textbox in the Multi_Locations_Part_1 Report\n  For i = 1 To UBound(days)\n    strCtrl = \"txtDesig_\" &amp; CStr(i)\n    Set txt = rpt.Controls.item(strCtrl)\n    For j = 0 To UBound(Data) - 1\n      If Data(j, 0) = days(i) Then\n        txt.Value = Data(j, 1) 'A,B,C,etc.\n        Exit For\n      End If\n    Next j\n  Next i\nEnd If\nPopulateTextboxes = Expr\nEnd Function\n\nPrivate Function SplitElement(Value As String, Delim As String) As String()\nDim result() As String\n\nresult = Split(Value, Delim)\n\nSplitElement = result\nEnd Function\n</code></pre>\n\n<p>Please advise.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 2, "creation_date": 1447192499, "post_id": 33640285, "comment_id": 55054734, "body": "You should change that one part that points to the red thing. Honestly, though, how can we help you when you post no code, or even a blurry screengrab? <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5548375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13452a5b544443dcb1fd260a8cb081eb?s=128&d=identicon&r=PG&f=1", "display_name": "Comando_sur", "link": "https://stackoverflow.com/users/5548375/comando-sur"}, "edited": false, "score": 0, "creation_date": 1447277836, "post_id": 33651938, "comment_id": 55094173, "body": "Fantastic!!! I have modified the query and it work brilliantly! and the time execution improve a lot. Thank you so much!!"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 0, "last_activity_date": 1447249672, "creation_date": 1447249672, "answer_id": 33651938, "question_id": 33640285, "link": "https://stackoverflow.com/questions/33640285/macro-does-not-update-selected-row-column/33651938#33651938", "title": "Macro does not update selected row/column", "body": "<p>The reason that the macro is dropping in results starting in A4 has nothing to do with the cell that is selected before running the macro. This bit here determines where in the sheet that the data will be dropped:</p>\n\n<pre><code>row = 3\nDo Until rs.EOF\n    row = row + 1\n    For col = 0 To rs.Fields.Count - 1\n        Cells(row, col + 1) = rs.Fields(col)\n    Next\n    rs.MoveNext\nLoop\n</code></pre>\n\n<p>It says \"Set variable <code>row</code> to <code>3</code>. Now loop through the recordset. Add <code>1</code> to <code>row</code> and loop through the fields in the recordset. Now paste the data for each field, starting in column <code>0+1</code> (or 1), in the row (which is now set to 4).\" As this iterates through the fields it writes the data out, then moves to the next row.</p>\n\n<p>To start writing the data in <code>F4</code> you can change that bit that actually writes the data out inside that loop:</p>\n\n<pre><code>row = 3\nDo Until rs.EOF\n    row = row + 1\n    For col = 0 To rs.Fields.Count - 1\n        Cells(row, col + 6) = rs.Fields(col)\n    Next\n    rs.MoveNext\nLoop\n</code></pre>\n\n<p>Now the first cell written to will be the 4th row and 6th column (Cell F4).</p>\n\n<p>All in all, this is a pretty slow way to grab the results from a recordset. You could probably change this whole module over to:</p>\n\n<pre><code>Sheets(\"Month\").Select\nRange(\"F4\").Select\ncon.Open \"Database\"\nsql = Sheets(\"SQL\").Range(\"A1\").Value\ncon.CommandTimeout = 600\nrs.Open sql, con\nSheets(\"Month\").Range(\"F4\").CopyFromRecordset rs    \nrs.Close\ncon.Close\n</code></pre>\n\n<p>And this would do the same thing without the messy iteration and confusing row/column math. It will also be much quicker if the recordset is large.</p>\n"}], "owner": {"reputation": 31, "user_id": 5548375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13452a5b544443dcb1fd260a8cb081eb?s=128&d=identicon&r=PG&f=1", "display_name": "Comando_sur", "link": "https://stackoverflow.com/users/5548375/comando-sur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 0, "accepted_answer_id": 33651938, "answer_count": 1, "score": 0, "last_activity_date": 1447320112, "creation_date": 1447192182, "last_edit_date": 1447320112, "question_id": 33640285, "link": "https://stackoverflow.com/questions/33640285/macro-does-not-update-selected-row-column", "title": "Macro does not update selected row/column", "body": "<p>Hope someone can help me as I am new on macros. </p>\n\n<p>I have an issue when macros run in excel, the results should update the worksheet starting on 'F4' ( Range(\"F4\").Select) however for some reason every time the macro run the results are updated/added in the first column (A4) even when the selection row and column is different</p>\n\n<p>I reckon is a setup on excel as this was working correctly but I do not how/what was changed, this has a knock on effect on all my macros workbooks, help please!!!</p>\n\n<pre><code>Sheets(\"Month\").Select\n    Range(\"F4\").Select\n    con.Open \"Database\"\n    sql = Sheets(\"SQL\").Range(\"A1\").Value\n    con.CommandTimeout = 600\n    rs.Open sql, con\n    row = 3\n    Do Until rs.EOF\n        row = row + 1\n        For col = 0 To rs.Fields.Count - 1\n            Cells(row, col + 1) = rs.Fields(col)\n        Next\n        rs.MoveNext\n    Loop\n    rs.Close\n    con.Close\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 5477107, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a7fc865e35e3cda2c1a13d86737b42fd?s=128&d=identicon&r=PG&f=1", "display_name": "torin", "link": "https://stackoverflow.com/users/5477107/torin"}, "edited": false, "score": 0, "creation_date": 1447238199, "post_id": 33642461, "comment_id": 55070868, "body": "Thx a lot for an idea."}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "reply_to_user": {"reputation": 49, "user_id": 5477107, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a7fc865e35e3cda2c1a13d86737b42fd?s=128&d=identicon&r=PG&f=1", "display_name": "torin", "link": "https://stackoverflow.com/users/5477107/torin"}, "edited": false, "score": 0, "creation_date": 1447238488, "post_id": 33642461, "comment_id": 55071035, "body": "I just had another look at the code from the answer from your previous question, and there he defines a function <code>InitialiseQuestion</code> which has a number of input arguments. Most of these arguments are Ranges. Calling Cells(1) on these ranges will then retrieve the first range stored in these ranges, Cells(2)  the second and so on. Since in my example the Ranges used is the whole worksheet, the first range retrieved is A1, the second B1 and so on, since excel reads from left to right and from top to bottom."}, {"owner": {"reputation": 49, "user_id": 5477107, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a7fc865e35e3cda2c1a13d86737b42fd?s=128&d=identicon&r=PG&f=1", "display_name": "torin", "link": "https://stackoverflow.com/users/5477107/torin"}, "edited": false, "score": 0, "creation_date": 1447272080, "post_id": 33642461, "comment_id": 55091213, "body": "Ok, it will help me with understanding the code, so thx a lot."}], "tags": [], "owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "is_accepted": true, "score": 2, "last_activity_date": 1447203151, "creation_date": 1447203151, "answer_id": 33642461, "question_id": 33640205, "link": "https://stackoverflow.com/questions/33640205/cells1-what-does-it-mean/33642461#33642461", "title": "Cells(1) - what does it mean", "body": "<p>You could just write a simple Macro to see what it does. Something like this:</p>\n\n<pre><code>Sub test()\nDim c As Integer\nFor c = 1 To 5\nDebug.Print Cells(c).Address\nNext\nEnd Sub\n</code></pre>\n\n<p>You would then see, that Cells(1) refers to A1, Cells(2) to B1 and so on.</p>\n"}], "owner": {"reputation": 49, "user_id": 5477107, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a7fc865e35e3cda2c1a13d86737b42fd?s=128&d=identicon&r=PG&f=1", "display_name": "torin", "link": "https://stackoverflow.com/users/5477107/torin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2340, "favorite_count": 0, "accepted_answer_id": 33642461, "answer_count": 1, "score": 0, "last_activity_date": 1447203151, "creation_date": 1447191913, "last_edit_date": 1531164843, "question_id": 33640205, "link": "https://stackoverflow.com/questions/33640205/cells1-what-does-it-mean", "title": "Cells(1) - what does it mean", "body": "<p>I recieved an answer in the code below from a very helpful stackoverflow user:\n<a href=\"https://stackoverflow.com/questions/33334447/solving-variable-variables-names-issue-in-excel\">Solving variable variable&#39;s names issue in excel</a></p>\n\n<p>But I am not sure why he uses Cells(1) in the code. Does this correspond to: \nCells(1) = whole worksheet? </p>\n\n<p>Thx for help</p>\n"}, {"tags": ["database", "vba", "ms-access-2010"], "owner": {"reputation": 1963, "user_id": 2813238, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f620841b40c34f34be0876f7007e4e92?s=128&d=identicon&r=PG", "display_name": "Mohammad AlBanna", "link": "https://stackoverflow.com/users/2813238/mohammad-albanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1447194063, "creation_date": 1447191895, "last_edit_date": 1447194063, "question_id": 33640199, "link": "https://stackoverflow.com/questions/33640199/change-the-start-number-of-primary-key-in-existing-access-database", "title": "Change the start number of Primary Key in existing access database", "body": "<p>I've an access 2010 database with a relationships and constraints between tables.</p>\n\n<p>I would like to change the start position of existing primary key to start from specific number and then change the order of other rows like normal auto-increment.</p>\n\n<p>Changing the primary key should change also the related tables references as there's cascade on update.</p>\n\n<p>Can I do that using Macro or VBA? How can I change the primary key number without deleting the column or the relationship, and the changing must be applied on other related tables?</p>\n"}, {"tags": ["excel", "vba", "collections", "output"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1447193187, "post_id": 33640168, "comment_id": 55055089, "body": "It depends the type of item in the collection. So to begin with, add <code>Debug.Print &quot;Item type: &quot; &amp; TypeName(item)</code> within the For loop, then from the immediate window, research on the object properties. If you do record a macro and go type some text in some cell, stop record and you should have an idea of how to put value in a cell."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1447194624, "post_id": 33640168, "comment_id": 55055823, "body": "Please have a look at my answer."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5100100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7fdeecafdb271b068d7bd5a28843ffbc?s=128&d=identicon&r=PG&f=1", "display_name": "zaanwar", "link": "https://stackoverflow.com/users/5100100/zaanwar"}, "edited": false, "score": 0, "creation_date": 1447194293, "post_id": 33640658, "comment_id": 55055657, "body": "Worked like a charm. Thank you!"}, {"owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "reply_to_user": {"reputation": 45, "user_id": 5100100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7fdeecafdb271b068d7bd5a28843ffbc?s=128&d=identicon&r=PG&f=1", "display_name": "zaanwar", "link": "https://stackoverflow.com/users/5100100/zaanwar"}, "edited": false, "score": 0, "creation_date": 1447194691, "post_id": 33640658, "comment_id": 55055860, "body": "For the record the other answer below is more than likely way more efficient. However I wouldn&#39;t worry about it unless you are having more than 100 items or so in your collection."}], "tags": [], "owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "is_accepted": true, "score": 3, "last_activity_date": 1447193602, "creation_date": 1447193602, "answer_id": 33640658, "question_id": 33640168, "link": "https://stackoverflow.com/questions/33640168/printing-entries-in-a-collection/33640658#33640658", "title": "Printing entries in a Collection", "body": "<p>You can change the starting row or column from 1, to whatever you want. Also you can insert into cells by incrementing columns by replacing 'r = r + 1' with 'c = c + 1'. </p>\n\n<p>Note: Change \"Sheet1\" to whatever your worksheet name is, this is just the default name I used since I don't know the name of your actual worksheet.</p>\n\n<pre><code>Dim r As Integer\nDim c As Integer\nr = 1 'Row 1\nc = 1 'Column A\nFor Each item In myCollection\n    ThisWorkbook.Worksheets(\"Sheet1\").Cells(r, c).Value = item\n    'Increment Row by 1\n    r = r + 1\nNext item\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 788, "user_id": 997088, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/354c6358174c3e539ca9fe427d25391c?s=128&d=identicon&r=PG", "display_name": "GisMofx", "link": "https://stackoverflow.com/users/997088/gismofx"}, "edited": false, "score": 0, "creation_date": 1447196179, "post_id": 33640861, "comment_id": 55056493, "body": "Cool Tip! I will use that Transpose Method Next time! Note: If the user wants <i>intellisense</i> for the Dictionary Object, they need to add the <code>Microsoft Scripting Runtime</code> Reference to their project."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 1, "last_activity_date": 1447361692, "last_edit_date": 1447361692, "creation_date": 1447194457, "answer_id": 33640861, "question_id": 33640168, "link": "https://stackoverflow.com/questions/33640168/printing-entries-in-a-collection/33640861#33640861", "title": "Printing entries in a Collection", "body": "<p>This is one of the reasons why a Dictionary object is superior to the Collection object.</p>\n\n<p>With Collections you must loop through the entire collection object to retrieve all of the values.</p>\n\n<p>With Dictionaries you can retrieve all of the values in one go, which is a tremendous speed boon when writing to a worksheet. Writing one cell at a time is one of the most inefficient things you can do in Excel.</p>\n\n<p>So here is how to convert to using Dictionaries. Note the last line. The entire dictionary is written to the range in one go:</p>\n\n<pre><code>Sub zaanwar()\n\n    Dim myDictionary As Object\n\n    Set myDictionary = CreateObject(\"scripting.dictionary\")\n\n    With myDictionary\n        .Item(\"key1\") = \"val1\"\n        .Item(\"key2\") = \"val2\"\n        .Item(\"key3\") = \"val3\"\n        .Item(\"key4\") = \"val4\"\n    End With\n\n    [a1:d4] = Application.Transpose(myDictionary.Items)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5100100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7fdeecafdb271b068d7bd5a28843ffbc?s=128&d=identicon&r=PG&f=1", "display_name": "zaanwar", "link": "https://stackoverflow.com/users/5100100/zaanwar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1633, "favorite_count": 0, "accepted_answer_id": 33640658, "answer_count": 2, "score": 0, "last_activity_date": 1447361692, "creation_date": 1447191812, "last_edit_date": 1447196284, "question_id": 33640168, "link": "https://stackoverflow.com/questions/33640168/printing-entries-in-a-collection", "title": "Printing entries in a Collection", "body": "<p>I have a Collection containing x amount of items. I simply need the contents of that Collection to be output into an Excel column.</p>\n\n<pre><code>For Each item In myCollection\n'Insert code here\n\nNext item  \n</code></pre>\n\n<p>Any idea how I can do this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1447192995, "post_id": 33640065, "comment_id": 55054999, "body": "I&#39;m not 100% sure, but adding DoEvents to each cycle might enable user input to be interpreted. Then ctrl+break will work, but remember to add error handling. Or you can try listening to keypresses after the DoEvents command. I sadly can&#39;t test it now, but might worth looking into."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1447193441, "post_id": 33640065, "comment_id": 55055236, "body": "Why not use <code>Application.StatusBar = &quot;Loading &quot; &amp; m</code> instead of changing a cell value? Remember to <code>Application.StatusBar = False</code> at end of sub to reset it."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1447200661, "post_id": 33640065, "comment_id": 55058256, "body": "Another idea is to read to whole file (<code>txtstrm.ReadAll</code>), have another Variant to store the Split with <code>vbCrLf</code> instead of line by line. But with that much lines, I am not sure if that is ok with Excel."}], "answers": [{"comments": [{"owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 0, "creation_date": 1447192603, "post_id": 33640256, "comment_id": 55054796, "body": "The animation isn&#39;t required but it&#39;s nice to know <i>something</i> is happening.  I will test without it though... after it runs this time :)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 0, "creation_date": 1447192725, "post_id": 33640256, "comment_id": 55054852, "body": "@ScottBeeson - I haven&#39;t used it a lot, but it might be quicker for Excel if you instead update the status via the <code>StatusBar</code>, i.e. <code>Application.StatusBar = &quot;Running part 1&quot;</code>  then later you can change the text to &quot;part 2&quot; or whatever, so you know it&#39;s working."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1447192091, "creation_date": 1447192091, "answer_id": 33640256, "question_id": 33640065, "link": "https://stackoverflow.com/questions/33640065/stop-intensive-file-process/33640256#33640256", "title": "Stop intensive file process?", "body": "<p>First, turn off screen refreshing and calculation.</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.Calculation = xlManual\n</code></pre>\n\n<p>then at the very end, turn back on</p>\n\n<pre><code>Application.ScreenUpdating = True\nApplication.Calculation = XlCalculationAutomatic\n</code></pre>\n\n<p>Additonally, if you add some type of counter that, after X iterations, prompts the user to continue or not, something like</p>\n\n<pre><code>Dim myCount as Long\n...your loop starts here\nmyCount = myCount + 1\nIf myCount mod 1000 = 0 then\n     toContinue = msgBox(\"Continue with macro?\",vbYesNo)\n     If toContinue = vbNo then exit sub\nEnd if\n...continue loop\n</code></pre>\n\n<p>Edit: Bah, I'll have to tweak that <code>If myCount mod 1000 = 0</code> to something better...basically an even divisor of 1000 or something.</p>\n\n<p>Also, is the loading \"animation\" required? I bet that contributes to it taking long when running over that many cells. And, just thought of it, when you turn off screenupdating, you <em>won't</em> see that animation, so maybe comment it out and see how it runs.</p>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447194598, "post_id": 33640799, "comment_id": 55055808, "body": "I don&#39;t know that he needs <code>DoEvents</code>, but otherwise, I like your tips. :P"}, {"owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447194838, "post_id": 33640799, "comment_id": 55055917, "body": "He is asking if there is a way to gracefully stop it with a Macro button. If Excel locks up, you cannot use the macro button to force the stop. Using a forced dialog every 1k rows isn&#39;t very optimal. Maybe call &#39;DoEvents&#39; every 500 rows or so would be optimal, instead of calling it every iteration."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1447194985, "post_id": 33640799, "comment_id": 55055985, "body": "@BruceWayne <code>DoEvents</code> returns control from the executing program to the processor in order to process any pending commands (such as worksheet <i>events</i> * wink wink * ) - To halt execution in looped code something like this is essential."}, {"owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "edited": false, "score": 0, "creation_date": 1447195175, "post_id": 33640799, "comment_id": 55056060, "body": "Interesting, so I should probably not disable events then, since it will disable direct events as well... interesting. For some reason I was thinking click events weren&#39;t affected, but that was a misnomer on my case."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1447195274, "post_id": 33640799, "comment_id": 55056104, "body": "@KrisB Don&#39;t want to get off-topic here - but basically you can disable events, and then use <code>DoEvents</code> to manually &quot;fire&quot; any events that may be pending. This is particularly useful for preventing infinite loops when using a change event for example."}], "tags": [], "owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1447195224, "last_edit_date": 1447195224, "creation_date": 1447194146, "answer_id": 33640799, "question_id": 33640065, "link": "https://stackoverflow.com/questions/33640065/stop-intensive-file-process/33640799#33640799", "title": "Stop intensive file process?", "body": "<p>In order for excel not to 'lock up' you have to call 'DoEvents'. Using the following will also speed up your process, however it appears as though you'll need screen updating to update the status bar, and EnableEvents to operate your button press event.</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.Calculation = xlManual\nApplication.EnableEvents = False\n</code></pre>\n\n<p>You can use the application's status bar at the very bottom if you want by doing the following:</p>\n\n<pre><code>Application.StatusBar = \"Your Value Here\"\n</code></pre>\n\n<p>Just make sure to clear it before you leave your function. If you wanted to be really 'safe' you can store its old previous value before writing to it then restore it here.</p>\n\n<pre><code>Application.StatusBar = \"\"\n</code></pre>\n\n<p>Your modified code is below:</p>\n\n<pre><code>Function LoadFile(m)\n    Dim WrdArray() As String\n    Dim txtstrm As TextStream\n    Dim line As String\n    Dim clm As Long\n    Dim Rw As Long\n    Dim Dash As Worksheet\n\n    Application.Calculation = xlManual   \n\n    Set Dash = Sheets(\"Dashboard\")\n    Set cellStatus = Dash.Range(\"E3\")\n\n    Set txtstrm = FSO.OpenTextFile(\"s:\\views_\" &amp; m &amp; \".txt\")\n\n    Rw = 1\n    Do Until txtstrm.AtEndOfStream\n      If Rw Mod 4 = 0 Then Application.StatusBar = \"Loading \" &amp; m &amp; \"... /\"\n      If Rw Mod 4 = 1 Then Application.StatusBar = \"Loading \" &amp; m &amp; \"... |\"\n      If Rw Mod 4 = 2 Then Application.StatusBar = \"Loading \" &amp; m &amp; \"... \\\"\n      If Rw Mod 4 = 3 Then Application.StatusBar = \"Loading \" &amp; m &amp; \"... -\"\n      line = txtstrm.ReadLine\n      clm = 1\n      WrdArray() = Split(line, \"|!|\")\n      For Each wrd In WrdArray()\n        Sheets(m).Cells(Rw, clm) = wrd\n        clm = clm + 1\n      Next wrd\n      Rw = Rw + 1\n      'This will insure that excel doesn't lock up or freeze\n      DoEvents\n    Loop\n    txtstrm.Close\n    LoadFile = Rw\n\n    Application.Calculation = XlCalculationAutomatic\n    Application.StatusBar = \"\"\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 0, "creation_date": 1447198744, "post_id": 33641132, "comment_id": 55057545, "body": "I&#39;m only doing it in a function so I can return the total number of rows added.  I guess I could do this another way but is there a reason I shouldn&#39;t use a function?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 0, "creation_date": 1447200256, "post_id": 33641132, "comment_id": 55058111, "body": "Function without Private can be called within a Cell. If you only use this within Subs in same Module, then should use <code>Private Function</code>."}, {"owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 0, "creation_date": 1447337842, "post_id": 33641132, "comment_id": 55119734, "body": "Is there a disadvantage to not privatizing it?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 0, "creation_date": 1447364371, "post_id": 33641132, "comment_id": 55136759, "body": "If a Function is not Private, it&#39;s available as an Excel Function, which needs more error handling codes to prevent misuse. Imagine a user filled tens of cells with <code>=LoadFile(&quot;Test&quot;)</code>, it would consume Excel dramatically. Making it Private will prevent that."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 1, "last_activity_date": 1447195686, "creation_date": 1447195686, "answer_id": 33641132, "question_id": 33640065, "link": "https://stackoverflow.com/questions/33640065/stop-intensive-file-process/33641132#33641132", "title": "Stop intensive file process?", "body": "<p>Not sure why you do this in a Function, but if you have Sub that calls this, it may be better to pause calculation there.</p>\n\n<p>Anyway, try this (dumping array values in one go):</p>\n\n<pre><code>Function LoadFile(m)\n    Dim WrdArray() As String\n    Dim txtstrm As Object\n    Dim line As String\n    Dim clm As Long ' Now used as number of items in the Split\n    Dim CalcMode As Long\n    Dim Rw As Long\n    Dim Dash As Worksheet\n\n    Set Dash = Sheets(\"Dashboard\")\n    'Set cellStatus = Dash.Range(\"E3\")\n    Set txtstrm = FSO.OpenTextFile(\"s:\\views_\" &amp; m &amp; \".txt\")\n\n    Rw = 1\n    CalcMode = Application.Calculation ' Save calculation mode\n    Application.Calculation = xlCalculationManual ' Change to Manual Calculation\n    Do Until txtstrm.AtEndOfStream\n        Application.StatusBar = Now &amp; \": Loading \" &amp; m &amp; \" (Rw: \" &amp; Rw &amp; \")\"\n        'If Rw Mod 4 = 0 Then cellStatus.Value = \"Loading \" &amp; m &amp; \"... /\"\n        'If Rw Mod 4 = 1 Then cellStatus.Value = \"Loading \" &amp; m &amp; \"... |\"\n        'If Rw Mod 4 = 2 Then cellStatus.Value = \"Loading \" &amp; m &amp; \"... \\\"\n        'If Rw Mod 4 = 3 Then cellStatus.Value = \"Loading \" &amp; m &amp; \"... -\"\n        line = txtstrm.ReadLine\n        'clm = 1\n        WrdArray = Split(line, \"|!|\")\n        clm = UBound(WrdArray) + 1 ' Number of items in the split\n        ' Dump the array to cells value to resized range from Col A\n        Sheets(m).Cells(Rw, \"A\").Resize(, clm).Value = WrdArray\n        'For Each wrd In WrdArray()\n        '    Sheets(m).Cells(Rw, clm) = wrd\n        '    clm = clm + 1\n        'Next wrd\n        Rw = Rw + 1\n    Loop\n    txtstrm.Close\n    Application.StatusBar = False ' Reset status bar\n    Application.Calculation = CalcMode ' restore calculation mode\n    LoadFile = Rw\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1447195686, "creation_date": 1447191367, "last_edit_date": 1495535236, "question_id": 33640065, "link": "https://stackoverflow.com/questions/33640065/stop-intensive-file-process", "title": "Stop intensive file process?", "body": "<p>I'm using the following function to read files into a spreadsheet.  I was thinking of adding a stop button (<a href=\"https://stackoverflow.com/questions/3979893/how-to-stop-vba-code-running\">something like this</a>) but the problem is that while this is running it completely locks up Excel and I cannot interact with it in any way.  Is there a way to gracefully stop something like this?  Note that these are huge files (500,000+ lines)</p>\n\n<pre><code>Function LoadFile(m)\n        Dim WrdArray() As String\n        Dim txtstrm As TextStream\n        Dim line As String\n        Dim clm As Long\n        Dim Rw As Long\n        Dim Dash As Worksheet\n        Set Dash = Sheets(\"Dashboard\")\n        Set cellStatus = Dash.Range(\"E3\")\n        Set txtstrm = FSO.OpenTextFile(\"s:\\views_\" &amp; m &amp; \".txt\")\n        Rw = 1\n        Do Until txtstrm.AtEndOfStream\n          If Rw Mod 4 = 0 Then cellStatus.Value = \"Loading \" &amp; m &amp; \"... /\"\n          If Rw Mod 4 = 1 Then cellStatus.Value = \"Loading \" &amp; m &amp; \"... |\"\n          If Rw Mod 4 = 2 Then cellStatus.Value = \"Loading \" &amp; m &amp; \"... \\\"\n          If Rw Mod 4 = 3 Then cellStatus.Value = \"Loading \" &amp; m &amp; \"... -\"\n          line = txtstrm.ReadLine\n          clm = 1\n          WrdArray() = Split(line, \"|!|\")\n          For Each wrd In WrdArray()\n            Sheets(m).Cells(Rw, clm) = wrd\n            clm = clm + 1\n          Next wrd\n          Rw = Rw + 1\n        Loop\n        txtstrm.Close\n        LoadFile = Rw\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "shell", "excel", "search", "explorer"], "answers": [{"comments": [{"owner": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "edited": false, "score": 0, "creation_date": 1447201898, "post_id": 33639934, "comment_id": 55058642, "body": "I would like to avoid using shell, but I can&#39;t find a way to achieve the same result with any other method"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 0, "last_activity_date": 1447190826, "creation_date": 1447190826, "answer_id": 33639934, "question_id": 33639849, "link": "https://stackoverflow.com/questions/33639849/calling-shell-explorer-search-in-vba-workaround/33639934#33639934", "title": "Calling Shell - explorer search in VBA - Workaround", "body": "<p>Why not avoid using shell all together and use something like this,</p>\n\n<pre><code>        Dim myFolder As String\n        Dim myFile As String\n        Dim wb as Workbook\n        Dim i As Long, tempLimit As Long\n        Application.FileDialog(msoFileDialogFolderPicker).Title = \"Select Folder Containing Excel Files\"\n        myFolder = Application.FileDialog(msoFileDialogFolderPicker)\n        With Application.FileDialog(msoFileDialogFolderPicker)\n            .AllowMultiSelect = False\n            .Show\n            If .SelectedItems.Count &gt; 0 Then\n                myFolder = .SelectedItems(1)\n            End If\n        End With\n        myFile = Dir(myFolder &amp; \"\\*.xls*\")\n        Do While myFile &lt;&gt; \"\"\n            Set wb = Application.Workbooks.Open(myFolder &amp; \"\\\" &amp; myFile)\n            ...\n        Loop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "edited": false, "score": 0, "creation_date": 1447691986, "post_id": 33737994, "comment_id": 55248917, "body": "I am starting to understand the method used here, but what I need is to list these files in an explorer window. How do I do that?"}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "reply_to_user": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "edited": false, "score": 0, "creation_date": 1447692997, "post_id": 33737994, "comment_id": 55249526, "body": "To my knowledge there is no way of opening Explorer without using Shell. (Well, there might be, but it would be very involved and very complex). If these <i>must</i> be displayed in explorer, you&#39;re kinda stuck with Shell. What are users doing in/with the files displayed in the Explorer window? If they are simply opening them, it would be easy enough to add a userform that displays the returned files and they can open them from there. Or, if they are copying them, you can script that too."}, {"owner": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "edited": false, "score": 0, "creation_date": 1447693386, "post_id": 33737994, "comment_id": 55249758, "body": "The users need to see the file(s) displayed with file names, file size and date modified, choose the one that suits them best and access it as easy as possible. If there are no other ways than I am stuck with explorers overcomplicated method. It took me a while to make it even work so my hands are tied if I want to modify something."}, {"owner": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "edited": false, "score": 0, "creation_date": 1447693521, "post_id": 33737994, "comment_id": 55249835, "body": "Anyway thank you for the information, at least now I understand my limits, I accept this answer as the best solution."}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "reply_to_user": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "edited": false, "score": 0, "creation_date": 1447693573, "post_id": 33737994, "comment_id": 55249865, "body": "Ah! You can certainly look into using a FileSystemObject since it will return all that information."}, {"owner": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "edited": false, "score": 0, "creation_date": 1447694231, "post_id": 33737994, "comment_id": 55250217, "body": "Yeah, I know it does, I use it in other parts of my scrip, but it would be overcomplicated to implement. To create the userform, display all the information needed, etc. If I will have more time to play with it, at least I will have the search engine that you gave me. So this is a good start, I just taught that there would be an easier workaround."}], "tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 1, "last_activity_date": 1447684926, "creation_date": 1447684926, "answer_id": 33737994, "question_id": 33639849, "link": "https://stackoverflow.com/questions/33639849/calling-shell-explorer-search-in-vba-workaround/33737994#33737994", "title": "Calling Shell - explorer search in VBA - Workaround", "body": "<p>@Jeanno nailed one method of getting all the files that matched \"banana\". This just tweaks his/her code to get all Word documents (but you can see that it will find.txt, .html, or <em>.</em> too). Another method would be to use a FileSystemObject (FSO) to do exactly this same thing. You could also use wscript (Windows Script Host) to get the information even though it would over complicate things. There are many ways to skin this cat. :)</p>\n\n<pre><code>    Dim myFolder As String\n    Dim myFile As String\n    Dim wb As Workbook\n    Dim i As Long, tempLimit As Long\n    Dim r As Integer\n\n    r = 1\n    Application.FileDialog(msoFileDialogFolderPicker).Title = \"Select Folder Containing .doc Files\"\n    myFolder = Application.FileDialog(msoFileDialogFolderPicker)\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .AllowMultiSelect = False\n        .Show\n        If .SelectedItems.Count &gt; 0 Then\n            myFolder = .SelectedItems(1)\n        End If\n    End With\n    myFile = Dir(myFolder &amp; \"\\*.doc*\")\n    Do While myFile &lt;&gt; \"\"\n        'Do what you need to do with the found files\n        Sheet1.Cells(r, 1).Value = myFile\n\n        'Call Dir again without arguments to loop through all files that matched our criteria\n        myFile = Dir\n        r = r + 1\n    Loop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "edited": false, "score": 0, "creation_date": 1447697529, "post_id": 33741193, "comment_id": 55252042, "body": "Nice! The only problem is that you should change the last <code>Else</code> to <code>Next oFile</code> and it works like a dream"}], "tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": true, "score": 1, "last_activity_date": 1447700023, "last_edit_date": 1447700023, "creation_date": 1447694884, "answer_id": 33741193, "question_id": 33639849, "link": "https://stackoverflow.com/questions/33639849/calling-shell-explorer-search-in-vba-workaround/33741193#33741193", "title": "Calling Shell - explorer search in VBA - Workaround", "body": "<p>2nd Answer demonstrating FSO</p>\n\n<pre><code>Sub GetFiles()\n\nDim FSO as Object 'Late binding &lt;- Prefered method\n'or As New FileSystemObject  for Early Binding \n'but don't forget to add a reference to Scripting Runtime!\nDim oFile as Object\nDim oFolder as Object\nDim sFileSpec as String\nDim r As Integer\n\nr = 1\nsFileSpec = \"banana\"\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nSet oFolder = FSO.GetFolder(\"C:\\path\\to\\Predefined\\Folder\\\") \n'Or use the folder picker method already used\n\nFor Each oFile In oFolder.Files\n    If Instr(1, oFile.Name, sFileSpec, vbTextCompare) Then\n        With Worksheets(\"Sheet1\")\n            .Cells(r, 1) = \"File Name:\"\n            .Cells(r, 3) = \"File Size:\"\n            .Cells(r, 5) = \"Date:\"\n            .Cells(r, 2) = oFile.Name\n            .Cells(r, 4) = oFile.Size\n            .Cells(r, 5) = oFile.DateLastModified\n        End With\n        r = r + 1\n    End If\nNext oFile\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3577, "favorite_count": 0, "accepted_answer_id": 33741193, "answer_count": 3, "score": 2, "last_activity_date": 1447700023, "creation_date": 1447190453, "last_edit_date": 1447692110, "question_id": 33639849, "link": "https://stackoverflow.com/questions/33639849/calling-shell-explorer-search-in-vba-workaround", "title": "Calling Shell - explorer search in VBA - Workaround", "body": "<p>I have a code in VBA that will call explorer with a given search parameter and will find and list files with a given name in explorer on a specific location.</p>\n\n<p>code:</p>\n\n<pre><code>RetVal = Shell( _\n\"c:\\Windows\\explorer.exe \"\"search-ms:displayname=Search%20Results&amp;crumb=System.Generic.String%3A~%3D\" _\n&amp; filename &amp; \"%20kind%3A%3Dfolder&amp;crumb=location:\" _\n&amp; location, vbNormalFocus)\n</code></pre>\n\n<p>It works nicely while I was using it on English windows.</p>\n\n<p>Is there any way to improve this code so it would work on other language platforms or at least a workaround for it to make it work on German Windows?</p>\n\n<p>Edit:</p>\n\n<p>To clarify what I need to happen:</p>\n\n<p>There are hyperlinks in a workbook with different names (ex. \"banana\"), when a user opens a hyperlink named \"banana\", the script calls the shell, opens an explorer window and lists all the files (these files are not excel files like <code>.xls</code>) containing the word \"banana\" in an already defined folder. </p>\n\n<p>Since other language Windows explorers use different search commands, it only works on English Windows.</p>\n\n<p>A search on German Windows would look like something this:</p>\n\n<pre><code>search-ms:displayname=Suchergebnisse%20in%20\"SYS%20(C%3A)\"&amp;crumb=System.Generic.String%3A &amp; filename &amp; &amp;crumb=location: &amp; location\n</code></pre>\n\n<p>If you want to try it yourselves note that the location should also look something like this: <code>C%3A%5C</code> for <code>C:\\</code> in order to make it work.</p>\n\n<p>Edit2:</p>\n\n<p>So I have figured out what the problem was. The part <code>%20kind%3A%3Dfolder</code> is different in German Windows, so as I got rid of that, it started working on both platforms.</p>\n\n<p>Here is the working version:</p>\n\n<pre><code>RetVal = Shell(\"c:\\Windows\\explorer.exe \"\"search-ms:displayname=backup%20for:%20\" &amp; _\nbackup &amp; \"&amp;crumb=System.Generic.String%3A~%3D\" &amp; backup &amp; _\n\"%20&amp;crumb=location:\" &amp; location, vbNormalFocus)\n</code></pre>\n\n<p>I am still looking for a way to get the same results without using Shell.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "edited": false, "score": 0, "creation_date": 1447201802, "post_id": 33641952, "comment_id": 55058613, "body": "selecting declared arrays from a textbox&quot; - sorry probably me not typing correctly. The arrays that I have declared in the code e.g Dim COST As String"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "edited": false, "score": 0, "creation_date": 1447202106, "post_id": 33641952, "comment_id": 55058715, "body": "@Elixir: that&#39;s a string, not an array. You can&#39;t &quot;select&quot; from a textbox. Do you want the users to enter data into a textbox? Then see my answer. Or do you want them to select from a predefined list? Then you need e.g. a listbox."}, {"owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "edited": false, "score": 0, "creation_date": 1447202629, "post_id": 33641952, "comment_id": 55058867, "body": "I see, is there any way of the users entering in the textbox similar to what i had on my first code - (COST, GAT, OND)"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "edited": false, "score": 0, "creation_date": 1447227357, "post_id": 33641952, "comment_id": 55065511, "body": "@Elixir: Yes... three textboxes, labeled COST, GAT, OND. I have the feeling that you aren&#39;t quite sure yet what you actually want from the users. Or if you are, you haven&#39;t told us."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1447199962, "creation_date": 1447199962, "answer_id": 33641952, "question_id": 33639629, "link": "https://stackoverflow.com/questions/33639629/vba-access-array-via-textbox/33641952#33641952", "title": "VBA Access - Array via textbox", "body": "<p>I would use a multi-line textbox, where the user e.g. enters</p>\n\n<pre><code>C:\\Users\\update\\COST.xlsb\nC:\\Users\\BACKUP\\GAT.xlsb\n</code></pre>\n\n<p>and then use the <code>Split()</code> function on the line breaks:</p>\n\n<pre><code>MyArray = Split(Me!myTextbox, vbCrLf)\n</code></pre>\n\n<p>But I my have misunderstood your question - not sure what you mean by \"selecting declared arrays from a textbox\".</p>\n"}], "owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594643249, "creation_date": 1447189592, "last_edit_date": 1594643249, "question_id": 33639629, "link": "https://stackoverflow.com/questions/33639629/vba-access-array-via-textbox", "title": "VBA Access - Array via textbox", "body": "<p>At the moment all my arrays are implemented in the vba code. This works fine</p>\n\n<pre><code>Dim COST As String\nDim GAT As String\nDim OND As String\n\nCOST = \"C:\\Users\\update\\COST.xlsb\"\nGAT = \"C:\\Users\\BACKUP\\GAT.xlsb\"\nOND = \"C:\\Users\\BACKUP\\OND.xlsb\"\n\nMyArray = Array(COST, GAT, OND)\n</code></pre>\n\n<p>However I would like to select the above arrays from a textbox via a form</p>\n\n<p>Below code works but I have to implement the file path</p>\n\n<pre><code>MyArray = Array(Forms![LAYOUT_F]![Update_F])\n</code></pre>\n\n<p>with file path </p>\n\n<pre><code>MyArray = Array(\"C:\\Users\\BACKUP\\\" &amp; Forms![LAYOUT_F]![Update_F])\n</code></pre>\n\n<p>Using the above will require me to be file name specific and doesn't take into account arrays plus the file paths are different</p>\n\n<p>Is there a way of selecting declared arrays from a textbox</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1447191265, "post_id": 33639618, "comment_id": 55054071, "body": "Is the text <code>**Coupon : 20 Yards $25(303)**</code> in row 2?"}, {"owner": {"reputation": 21, "user_id": 5504052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b276adf6081d0ad0e8e2e9a53c44e33?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/5504052/lisa"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1447195791, "post_id": 33639618, "comment_id": 55056325, "body": "The Coupon Type differs and is always in column(3) above the &quot;Closed Date/Time&quot; cell, this is why i used a offset to get the location of the cell.  The Profit Center Name is above the coupon type. the problem i have is that, it depends on how many transactions there were for the coupon. We have multiple Profit Centers which have different coupons. so there X amount of coupons and X amount different coupons in each Profit Center. If that makes sense."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5504052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b276adf6081d0ad0e8e2e9a53c44e33?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/5504052/lisa"}, "edited": false, "score": 0, "creation_date": 1447197730, "post_id": 33640232, "comment_id": 55057165, "body": "I seem to be getting the same error &quot;Run-time error &#39;5&#39;: invalid procedure call or argument with this line:ProfitCenterName = Trim(Right(ProfitCenterName, Len(ProfitCenterName) - 16))"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 21, "user_id": 5504052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b276adf6081d0ad0e8e2e9a53c44e33?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/5504052/lisa"}, "edited": false, "score": 0, "creation_date": 1447197870, "post_id": 33640232, "comment_id": 55057225, "body": "What is the value of <code>Len(ProfitCenterName)</code>? And <code>ProfitCenterName</code>?"}, {"owner": {"reputation": 21, "user_id": 5504052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b276adf6081d0ad0e8e2e9a53c44e33?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/5504052/lisa"}, "edited": false, "score": 0, "creation_date": 1447198963, "post_id": 33640232, "comment_id": 55057635, "body": "Im not sure what you are talking about? i am very new to vba, and have been recording macros and using samples from other codes similar to what i am trying to accomplish."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 21, "user_id": 5504052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b276adf6081d0ad0e8e2e9a53c44e33?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/5504052/lisa"}, "edited": false, "score": 0, "creation_date": 1447199787, "post_id": 33640232, "comment_id": 55057951, "body": "When the line is yellow, put the mouse on <code>Len(..</code> for a few instants and the value should appear! Do the same for <code>ProfitCenterName</code>. Take a look at these : <a href=\"http://www.excel-easy.com/vba/examples/debugging.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/examples/debugging.html</a> and <a href=\"http://www.excelcampus.com/vba/vba-immediate-window-excel/\" rel=\"nofollow noreferrer\">excelcampus.com/vba/vba-immediate-window-excel</a> , it&#39;ll save you hours of coderage ;) And once you have activated the Immediate Window change the code to new edit! ;)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 21, "user_id": 5504052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b276adf6081d0ad0e8e2e9a53c44e33?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/5504052/lisa"}, "edited": false, "score": 0, "creation_date": 1447511318, "post_id": 33640232, "comment_id": 55190336, "body": "@Lisa : Where are you at on this?"}, {"owner": {"reputation": 21, "user_id": 5504052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b276adf6081d0ad0e8e2e9a53c44e33?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/5504052/lisa"}, "edited": false, "score": 0, "creation_date": 1449005581, "post_id": 33640232, "comment_id": 55816546, "body": "I keep getting error. I commented out the ProfitCenterName = Trim(Right (profitCenterName... And the code is doing almost what i want. The problem is ProfitCntrName is  2cells above the ClosedDate after all coupons have been totaled for the named ProfitCenter. I did not take in account the CouponTotal.  See the order is like this  ProfitCenter: CopperOak (1)  Coupon: 2 for 1  Closed Date/Time 11-02-2015 11-02-2015 11-02-2015 Coupon Total  Coupon: Buy 1 get 1  Closed Date/Time 11-02-2015 11-02-2015 Coupon Total ProfitCenter: Sunrise (2) Coupon: Free Drink Closed Date/Time 11-09-2015"}, {"owner": {"reputation": 21, "user_id": 5504052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b276adf6081d0ad0e8e2e9a53c44e33?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/5504052/lisa"}, "edited": false, "score": 0, "creation_date": 1449012878, "post_id": 33640232, "comment_id": 55819840, "body": "would it be better to write an if statement"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 21, "user_id": 5504052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b276adf6081d0ad0e8e2e9a53c44e33?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/5504052/lisa"}, "edited": false, "score": 0, "creation_date": 1449013126, "post_id": 33640232, "comment_id": 55819939, "body": "Nope I think I got it, just google this : how to use immediate window in VBA. And tell me what the 2 <code>Debug.Print</code> display in the immediate window, I&#39;d be able to finish the code knowing that"}, {"owner": {"reputation": 21, "user_id": 5504052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b276adf6081d0ad0e8e2e9a53c44e33?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/5504052/lisa"}, "edited": false, "score": 0, "creation_date": 1449853271, "post_id": 33640232, "comment_id": 56201343, "body": "R3uK  Profit Center : Copper Oak(6)  29  Coupon Total  12"}, {"owner": {"reputation": 21, "user_id": 5504052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b276adf6081d0ad0e8e2e9a53c44e33?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/5504052/lisa"}, "edited": false, "score": 0, "creation_date": 1449860770, "post_id": 33640232, "comment_id": 56205211, "body": "R3uK Stepping through using F8, the code works 1st time around. As the loop starts again from next Closed Date/Time,-1 CouponName, -2 CouponTotal. The reports will continue this order until there is No more coupons for this particular Profit Center. Then the order is: ClosedDate/Time, -1 CouponName, -2 ProfitCenterName,-3 ProfitCenterTotal, -4 CouponTotal. Then the order begins again, -1 CouponName, -2 CouponTotal etc."}, {"owner": {"reputation": 21, "user_id": 5504052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b276adf6081d0ad0e8e2e9a53c44e33?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/5504052/lisa"}, "edited": false, "score": 0, "creation_date": 1449862024, "post_id": 33640232, "comment_id": 56205815, "body": "The next time it runs through the value for ProfitCenterName= &quot;Coupon Total&quot;"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1447199961, "last_edit_date": 1447199961, "creation_date": 1447192009, "answer_id": 33640232, "question_id": 33639618, "link": "https://stackoverflow.com/questions/33639618/run-time-error-5-invalid-procedure-call-or-argument-locate-specific-text-usin/33640232#33640232", "title": "Run-time error \u20185\u2019 invalid procedure call or argument: locate Specific text using Find/ extract characters after first 16 characters using", "body": "<ol>\n<li><p><code>ProfitCenterName = Right(ProfitCenterName, Len(ProfitCenterName) - 16)</code> throw an error because <strong><code>ProfitCenterName</code> was empty</strong> when you start working with it, you should have use something like <code>ProfitCenterName = ProfitCenter.Offset(-2, 0)</code></p></li>\n<li><p>You could do both string extractions in the same loop, take a look at the result.</p></li>\n<li><p>I changed <code>ProfitCenter.Offset(-2, 0).Copy ProfitCenter.Offset(1, -2)</code> to <code>ProfitCenter.Offset(1, -2) = ProfitCenter.Offset(-2, 0)</code> which is far more efficient!  <br>\nWhen working with multiple cells Range, you just have to add the <code>.Value</code> <em>(which is implicit for one cell Range)</em> at the of both sides to accomplish the same</p></li>\n</ol>\n\n<hr>\n\n<p>Here is your code revised (I just changed <code>ProfitCenterName</code> to <code>fCell</code> for readabilty):</p>\n\n<pre><code>Sub CopyDataFrCellAndPlaceInCellNext()\n\nDim fCell As Range, _\n    FirstAddress As String, _\n    ProfitCenterName As String, _\n    CouponName As String\n\nWith ActiveSheet.Columns(3)\n    Set fCell = .Cells.Find(What:=\"Closed Date/Time\", _\n                                    After:=ActiveCell, _\n                                    LookIn:=xlFormulas, _\n                                    LookAt:=xlPart)\n    If Not fCell Is Nothing Then\n        FirstAddress = fCell.Address\n        Do\n            ProfitCenterName = fCell.Offset(-2, 0).Value2\n            Debug.Print ProfitCenterName \n            Debug.Print Len(ProfitCenterName)\n            ProfitCenterName = Trim(Right(ProfitCenterName, Len(ProfitCenterName) - 16))\n            CouponName = fCell.Offset(-1, 0).Value2\n            CouponName = Trim(Right(CouponName, Len(CouponName) - 9))\n            fCell.Offset(1, -2) = ProfitCenterName\n            fCell.Offset(1, -1) = CouponName\n            fCell.Offset(-2, 0).Clear\n            fCell.Offset(-1, 0).Clear\n\n            Set fCell = .FindNext(fCell)\n        Loop While (Not fCell Is Nothing) And fCell.Address &lt;&gt; FirstAddress\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5504052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b276adf6081d0ad0e8e2e9a53c44e33?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/5504052/lisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 450, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1447199961, "creation_date": 1447189557, "last_edit_date": 1447190159, "question_id": 33639618, "link": "https://stackoverflow.com/questions/33639618/run-time-error-5-invalid-procedure-call-or-argument-locate-specific-text-usin", "title": "Run-time error \u20185\u2019 invalid procedure call or argument: locate Specific text using Find/ extract characters after first 16 characters using", "body": "<p>I am new to VBA Coding. I have used 3 different types of codes that are near to what I am trying to accomplish, but keep getting errors. Could someone suggest what is wrong? </p>\n\n<p>In column (3) the following cells change ProfitCenterName &amp; CouponTypes, I have Dim the variables as Strings. I named ranges for the variables to find location.</p>\n\n<p>I used ProfitCenter that would located the \u201cClosed Date/Time\u201d since this variable name never changes, but the names of the coupons and Profit Centers do. </p>\n\n<p>I search for \u201cClosed Date/Time\u201d using offset to locate and extract names from strings of text using \u201cRight and lens\u201d and then offset to place the extracted names and to delete original strings using a loop. </p>\n\n<p>I also would like to place the extracted names alongside the actual transactions, but do not know how to do. </p>\n\n<pre><code>ProfitCenter     Coupontype \n                                    **Profit Center : Copper Oak(6)**\n                                    **Coupon : 20 Yards $25(303)**\n                                    Closed Date/Time\nCopper Oak(6)   20 Yards $25(303)   09/27/2015 18:15\nCopper Oak(6)   21 Yards $25(303)   09/27/2015 20:04\n                                    Coupon Total\n                                    Coupon : Dells Deals 10%(247)\n                                    Dells Deals 10%(247)    \n                                    09/27/2015 18:15\n                                    Coupon Total\n                                    Profit Center Total\n                                    **Profit Center :  High Stakes Bar(2)**\n                                    **Coupon : SILVER $5(298)**\n                                    Closed Date/Time\n High Stakes Bar(2) SILVER $5(298)  10/24/2015 16:44\n High Stakes Bar(2) SILVER $5(298)  10/24/2015 16:44\n High Stakes Bar(2) SILVER $5(298)  10/24/2015 16:44\n</code></pre>\n\n<p>And the code:</p>\n\n<pre><code>Sub CopyDataFrCellAndPlaceInCellNext()\n\nDim ProfitCenterName As String\nDim ProfitCenter As Range\nDim Coupontype As Range\nDim firstaddress As String\nDim CouponName As String\n\n'In column (3)I want to select ProfitCenterName cell \"Profit Center : Copper Oak(6)\"\n'extract only the name of the ProfitCenterName \"Copper Oak(6)\"\n'Then place the ProfitCenterName \"Copper Oak(6)\" into Column(1)\n'delete the original cell in column(3)\"Profit Center : Copper Oak(6)\"\n\nWith ActiveSheet.Columns(3)\n\n      Set ProfitCenter = Cells.find(What:=\"Closed Date/Time\", After:=ActiveCell, LookIn:= _\n                            xlFormulas, LookAt:=xlPart)\n        ProfitCenterName = Right(ProfitCenterName, Len(ProfitCenterName) - 16)\n\n            If Not ProfitCenter Is Nothing Then\n            firstaddress = ProfitCenter.Address\n\n                Do\n                    ProfitCenter.Offset(-2, 0).Copy ProfitCenter.Offset(1, -2)\n                    ProfitCenter.Offset(-2, 0).Clear\n\n        Set ProfitCenter = .FindNext(ProfitCenter)\n\nLoop While (Not ProfitCenter Is Nothing) And ProfitCenter.Address &lt;&gt; firstaddress\n\n        End If\n\nEnd With\n\n'In column (3) I want to select ProfitCenterName cell \"Coupon : 20 Yards $25(303)\"\n'extract only the name of the ProfitCenterName \"20 Yards $25(303)\"\n'Then place the ProfitCenterName \"20 Yards $25(303)\" into Column(2)\n'delete the original cell in column(3)\"Coupon : 20 Yards $25(303)\"\n\nWith ActiveSheet.Columns(3)\n\n    Set Coupontype = .find(What:=\"Closed Date/Time\", After:=ActiveCell, LookIn:= _\n                            xlFormulas, LookAt:=xlPart)\n\n        CouponName = Right(ProfitCenterName, Len(ProfitCenterName) - 9)\n\n            If Not Coupontype Is Nothing Then\n                firstaddress = Coupontype.Address\n\n                    Do\n                        Coupontype.Offset(-1, 0).Copy Coupontype.Offset(1, -1)\n                        Coupontype.Offset(-1, 0).Clear\n\n    Set Coupontype = .FindNext(Coupontype)\n\nLoop While (Not Coupontype Is Nothing) And Coupontype.Address &lt;&gt; firstaddress\n\n            End If\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "image", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447187584, "post_id": 33638922, "comment_id": 55052112, "body": "So what&#39;s the question?"}, {"owner": {"reputation": 11, "user_id": 5548180, "user_type": "registered", "profile_image": "https://graph.facebook.com/1029161793813620/picture?type=large", "display_name": "Alan Morrison Fell", "link": "https://stackoverflow.com/users/5548180/alan-morrison-fell"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447188049, "post_id": 33638922, "comment_id": 55052355, "body": "I was afraid I wasn&#39;t being specific enough. The question is, why does the method work for 100% of the photos on Excel 2013, but fail for some photos on Excel 2010?"}], "owner": {"reputation": 11, "user_id": 5548180, "user_type": "registered", "profile_image": "https://graph.facebook.com/1029161793813620/picture?type=large", "display_name": "Alan Morrison Fell", "link": "https://stackoverflow.com/users/5548180/alan-morrison-fell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 531, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1447195013, "creation_date": 1447187119, "last_edit_date": 1447195013, "question_id": 33638922, "link": "https://stackoverflow.com/questions/33638922/activesheet-shapes-addpicture-vba-excel-2010-vs-vba-excel-2013", "title": "ActiveSheet.Shapes.AddPicture VBA Excel 2010 vs VBA Excel 2013", "body": "<p>So I have a bunch of code I wrote for Excel 2013 that extracts images from a server via the: </p>\n\n<pre><code>Set Pic = ActiveSheet.Shapes.AddPicture (URL)\n</code></pre>\n\n<p>method that works OK (I've processed up to 5.000 images in a row without issues). Sometimes images download instantly and sometimes they might take up to 10 seconds.</p>\n\n<p>I then distributed the macro to the sales force (they use Excel 2010) so they could build their own spreadsheets with images, but in some cases they're getting an error where the Pic variable returns as Nothing. This can happen at random points of the batch process (sometimes on image #4 or sometimes on image #500) for the same SKU list. In the meantime I fixed it by using Ifs, but I have to say its quite disappointing having it run flawlessly on 2013 and not being able to replicate that to 2010.</p>\n\n<p>EDIT #1:</p>\n\n<p>Ok, so I found the specific culprit. The way I replicate it is, I set the macro to begin, then change windows to my Web Browser and press ESC. Nothing happens. I then keep ESC pressed for 5 seconds. Nothing happens. I then keep it pressed for 10 seconds and then I get a fail during Set Pic = ... which comes back as Nothing. I cannot loop around this with error handling or EnableCancelKey or OnKey.</p>\n\n<p>This is seriously frustrating me A LOT, because I know users are just randomly pressing ESC during the macro run while they are on others tasks and if they randomly sincronize the ESC press with the set pic line IT will cancel the macro outright :S</p>\n"}, {"tags": ["excel", "formula", "vba"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1447188162, "post_id": 33638404, "comment_id": 55052403, "body": "What bit are you exactly having issues with? Try using the macro recorder to get an idea of what you should do for the autofilter"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 5490468, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/17b7fd62bb6ac02414fc301da31a1927?s=128&d=identicon&r=PG&f=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/5490468/todd"}, "edited": false, "score": 0, "creation_date": 1447242964, "post_id": 33639318, "comment_id": 55073487, "body": "I am rather new to the VBA world and was wondering if you could give a breakdown of what the sections within your code actually do, if possible."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1447250602, "last_edit_date": 1447250602, "creation_date": 1447188456, "answer_id": 33639318, "question_id": 33638404, "link": "https://stackoverflow.com/questions/33638404/filtering-for-the-value-in-a1/33639318#33639318", "title": "Filtering for the value in A1", "body": "<p>Set range(\"A1\") as a variable</p>\n\n<pre><code>Sub Button2_Click()\n    Dim F As Range'declare F as a range\n    Set F = Range(\"A1\")'set F as range(\"A1\")\n    With ActiveSheet.Range(\"A5\").CurrentRegion\n        .AutoFilter Field:=3, Criteria1:=F'Filter for F\n        If .Columns(1).SpecialCells(xlCellTypeVisible).Count &gt; 1 Then\n            With .Columns(2)\n                .Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).FormulaR1C1 = \"=RC[1]&amp;\"\"-R21\"\"\"\n            End With\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>Here's another version, so you won't have to use Formulas.</p>\n\n<pre><code>Sub LoopThroughFilterd()\n    Dim rws As Long, rng As Range, Fltr As Range, c As Range\n\n    rws = Cells(Rows.Count, \"A\").End(xlUp).Row\n    Set rng = Range(\"C6:C\" &amp; rws)\n    Set Fltr = Range(\"A1\")\n\n    Application.ScreenUpdating = 0\n\n    With ActiveSheet.Range(\"A5\").CurrentRegion\n\n        .AutoFilter Field:=3, Criteria1:=Fltr\n\n        For Each c In rng.Cells\n\n            If c.EntireRow.Hidden = 0 Then\n                c.Offset(, -1) = c &amp; \"-R21\"\n            End If\n\n        Next c\n        .AutoFilter\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>You can also Loop through the cells instead of filtering.</p>\n\n<pre><code>Sub LooPFor()\n    Dim rws As Long, rng As Range, Fltr As Range, c As Range\n\n    rws = Cells(Rows.Count, \"A\").End(xlUp).Row\n    Set rng = Range(\"C6:C\" &amp; rws)\n    Set Fltr = Range(\"A1\")\n\n    For Each c In rng.Cells\n        If c = Fltr Then c.Offset(, -1) = c &amp; \"-R21\"\n    Next c\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 121, "user_id": 5490468, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/17b7fd62bb6ac02414fc301da31a1927?s=128&d=identicon&r=PG&f=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/5490468/todd"}, "edited": false, "score": 0, "creation_date": 1447242958, "post_id": 33643003, "comment_id": 55073483, "body": "I am rather new to the VBA world and was wondering if you could give a breakdown of what the sections within your code actually do, if possible."}], "tags": [], "owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "is_accepted": false, "score": 0, "last_activity_date": 1447206855, "creation_date": 1447206855, "answer_id": 33643003, "question_id": 33638404, "link": "https://stackoverflow.com/questions/33638404/filtering-for-the-value-in-a1/33643003#33643003", "title": "Filtering for the value in A1", "body": "<p>I think the problem is that your formula is only being added to the first cell in your filtered range. That is because a discontiguous SpecialCells range such as yours, i.e., C7, C10,C12:C15, etc., will consist of multiple <a href=\"https://msdn.microsoft.com/en-us/library/office/aa213698%28v=office.11%29.aspx\" rel=\"nofollow\">Areas</a>. If that's the case, you need to loop through the Areas with a For/Next:</p>\n\n<pre><code>Dim FilteredArea as Range\n\nWith ActiveSheet.Range(\"A5\").CurrentRegion\n    .AutoFilter Field:=3, Criteria1:=\"=RC[1]\"\n    If .Columns(1).SpecialCells(xlCellTypeVisible).Count &gt; 1 Then\n        For Each FilteredArea in .Columns(2).Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).Areas\n            FilteredArea.FormulaR1C1 = \"=RC[1]&amp;\"\"-R21\"\"\"\n        Next FilteredArea\n    End If\nEnd With\n</code></pre>\n\n<p>This is untested, but hopefully will give you an idea of how to work with Areas.</p>\n"}], "owner": {"reputation": 121, "user_id": 5490468, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/17b7fd62bb6ac02414fc301da31a1927?s=128&d=identicon&r=PG&f=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/5490468/todd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1447250602, "creation_date": 1447185256, "last_edit_date": 1531161705, "question_id": 33638404, "link": "https://stackoverflow.com/questions/33638404/filtering-for-the-value-in-a1", "title": "Filtering for the value in A1", "body": "<p>I am trying to figure out a way to filter Column C for the value in A1, then put the formula in the first cell and copy down.  I have the below code but I can't seem to get it to work. I have an example of the spreadsheet below the code.</p>\n\n<pre><code>    With ActiveSheet.Range(\"A5\").CurrentRegion\n        .AutoFilter Field:=3, Criteria1:=\"=RC[1]\"\n            If .Columns(1).SpecialCells(xlCellTypeVisible).Count &gt; 1 Then\n                With .Columns(2)\n                .Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).FormulaR1C1 = \"=RC[1]&amp;\"\"-R21\"\"\"\n                End With\n            End If\n    End With\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/be9nz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/be9nz.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "split", "delimiter"], "comments": [{"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1447184316, "post_id": 33638143, "comment_id": 55050248, "body": "Where&#39;s the part that&#39;s not working?"}, {"owner": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "edited": false, "score": 1, "creation_date": 1447184400, "post_id": 33638143, "comment_id": 55050304, "body": "Have a look at Split function: <a href=\"http://www.techonthenet.com/excel/formulas/split.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/split.php</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "edited": false, "score": 0, "creation_date": 1447184944, "post_id": 33638143, "comment_id": 55050627, "body": "Can you also post a sample table of the expected output? But it looks like @GSazheniuk is on the scent, look at <code>Split</code>."}, {"owner": {"reputation": 55, "user_id": 5548034, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6c463da49f145c3c25b20d27fc0b898f?s=128&d=identicon&r=PG&f=1", "display_name": "J Moore", "link": "https://stackoverflow.com/users/5548034/j-moore"}, "edited": false, "score": 0, "creation_date": 1447187760, "post_id": 33638143, "comment_id": 55052202, "body": "Thanks, I did look at the Split function. I can use that to separate the output data into columns; I just can&#39;t figure out how to put it into rows."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447188896, "post_id": 33638143, "comment_id": 55052818, "body": "If you have the code to put it in columns, can you post it? It should require just a little tweaking to put in rows instead."}, {"owner": {"reputation": 55, "user_id": 5548034, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6c463da49f145c3c25b20d27fc0b898f?s=128&d=identicon&r=PG&f=1", "display_name": "J Moore", "link": "https://stackoverflow.com/users/5548034/j-moore"}, "edited": false, "score": 0, "creation_date": 1447191520, "post_id": 33638143, "comment_id": 55054221, "body": "Thanks for the help so far. Let me know if I&#39;m not making sense."}], "answers": [{"tags": [], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "is_accepted": false, "score": 0, "last_activity_date": 1447191651, "creation_date": 1447191651, "answer_id": 33640123, "question_id": 33638143, "link": "https://stackoverflow.com/questions/33638143/splitting-text-by-rows-and-columns/33640123#33640123", "title": "Splitting Text By Rows and Columns", "body": "<p>I'm not sure of what you need but you can try to extract the string you need with this function</p>\n\n<pre><code>Function ExtractText(ByVal Txt As String) As String\n    Txt = Right(Txt, Len(Txt) - InStr(1, Txt, \",\"\"\", vbTextCompare) - 1)\n    Txt = Left(Txt, InStr(1, Txt, \"\"\",\", vbTextCompare) - 1)\nEnd Function\n</code></pre>\n\n<p>This extract the company name from the original string you get in the table.</p>\n\n<p>Hope it helps</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 5548034, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6c463da49f145c3c25b20d27fc0b898f?s=128&d=identicon&r=PG&f=1", "display_name": "J Moore", "link": "https://stackoverflow.com/users/5548034/j-moore"}, "edited": false, "score": 0, "creation_date": 1447340962, "post_id": 33640145, "comment_id": 55122172, "body": "Thank you very much. I appreciate the help - and the disparaging alert."}, {"owner": {"reputation": 609, "user_id": 1742962, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/aRDMd.gif?s=128&g=1", "display_name": "frostbite", "link": "https://stackoverflow.com/users/1742962/frostbite"}, "reply_to_user": {"reputation": 55, "user_id": 5548034, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6c463da49f145c3c25b20d27fc0b898f?s=128&d=identicon&r=PG&f=1", "display_name": "J Moore", "link": "https://stackoverflow.com/users/5548034/j-moore"}, "edited": false, "score": 0, "creation_date": 1447343741, "post_id": 33640145, "comment_id": 55124327, "body": "@JMoore to be sure that alert was a reference to me!"}, {"owner": {"reputation": 55, "user_id": 5548034, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6c463da49f145c3c25b20d27fc0b898f?s=128&d=identicon&r=PG&f=1", "display_name": "J Moore", "link": "https://stackoverflow.com/users/5548034/j-moore"}, "edited": false, "score": 0, "creation_date": 1447345728, "post_id": 33640145, "comment_id": 55125771, "body": "Haha oh! Well you could have fooled me. I am definitely the zealous newbie"}], "tags": [], "owner": {"reputation": 609, "user_id": 1742962, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/aRDMd.gif?s=128&g=1", "display_name": "frostbite", "link": "https://stackoverflow.com/users/1742962/frostbite"}, "is_accepted": false, "score": 0, "last_activity_date": 1447191725, "creation_date": 1447191725, "answer_id": 33640145, "question_id": 33638143, "link": "https://stackoverflow.com/questions/33638143/splitting-text-by-rows-and-columns/33640145#33640145", "title": "Splitting Text By Rows and Columns", "body": "<p>Zealous VB newbie alert.</p>\n\n<pre><code>Private Sub so_stub_1()\n 'wsSo is the name of my test worksheet\n  Dim hdr() As String: hdr = Split(\"Last Close Price, Market Cap, Company Name, Annual Revenue\", \",\")\n  Dim data() As Variant: data = wsSO.Range(\"G1:G4\")\n  Dim i As Integer\n  Dim r As Integer\n  For i = 1 To UBound(data) \n    r = i + 1 'offset in my test sheet\n    wsSO.Range(\"A\" &amp; r &amp; \":D\" &amp; r) = Split(data(i, 1), \",\")\n Next 'i \nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 5548034, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6c463da49f145c3c25b20d27fc0b898f?s=128&d=identicon&r=PG&f=1", "display_name": "J Moore", "link": "https://stackoverflow.com/users/5548034/j-moore"}, "edited": false, "score": 0, "creation_date": 1447340379, "post_id": 33640372, "comment_id": 55121712, "body": "Thanks so much! This is a huge help for me. I tinkered with the code to clarify the output range (I realize the code I copied in contradicts the output I specified in my original question) but I&#39;m having one small problem. All of the rows and columns are reformatting except for the last two. Even when I add to the range of tickers, it excludes the last two rows."}, {"owner": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "reply_to_user": {"reputation": 55, "user_id": 5548034, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6c463da49f145c3c25b20d27fc0b898f?s=128&d=identicon&r=PG&f=1", "display_name": "J Moore", "link": "https://stackoverflow.com/users/5548034/j-moore"}, "edited": false, "score": 0, "creation_date": 1447341263, "post_id": 33640372, "comment_id": 55122399, "body": "Could you please provide more details about your problem? I do not get this part &quot;All of the rows and columns are reformatting except for the last two.&quot;"}, {"owner": {"reputation": 55, "user_id": 5548034, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6c463da49f145c3c25b20d27fc0b898f?s=128&d=identicon&r=PG&f=1", "display_name": "J Moore", "link": "https://stackoverflow.com/users/5548034/j-moore"}, "edited": false, "score": 0, "creation_date": 1447344168, "post_id": 33640372, "comment_id": 55124638, "body": "I wish I could explain it more. This code separates the data by columns and rows, which is exactly what I needed it to do. The problem is it stops at the last two rows. All of the data called from the URL is contained in each cell of the last two rows of the table."}, {"owner": {"reputation": 55, "user_id": 5548034, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6c463da49f145c3c25b20d27fc0b898f?s=128&d=identicon&r=PG&f=1", "display_name": "J Moore", "link": "https://stackoverflow.com/users/5548034/j-moore"}, "edited": false, "score": 0, "creation_date": 1447349668, "post_id": 33640372, "comment_id": 55128433, "body": "Sorry to keep bugging you. Can you edit the split lines and delimiter code such that the output range starts at C5? The ticker inputs are in A5:LastRow, and the data output should go from C5:FLastRow. Thanks again"}], "tags": [], "owner": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "is_accepted": true, "score": 1, "last_activity_date": 1447192498, "creation_date": 1447192498, "answer_id": 33640372, "question_id": 33638143, "link": "https://stackoverflow.com/questions/33638143/splitting-text-by-rows-and-columns/33640372#33640372", "title": "Splitting Text By Rows and Columns", "body": "<p>I understand this is not the best way to handle this type of problem, but it should work.</p>\n\n<p>First of all we need to change your <code>Delimiter</code> sub (which is good!) so it can work with rows extracted from response:</p>\n\n<pre><code>Sub Delimiter(ByVal LastRow)\n''Separate the data into four columns\n    Range(\"B1:B\" &amp; LastRow).TextToColumns Destination:=Range(\"C1:C\" &amp; LastRow), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n        Semicolon:=False, Comma:=True, Space:=False, Other:=False, FieldInfo _\n        :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1)), TrailingMinusNumbers:=True\n\n''Unwrap the text\n    Range(\"B1:F\" &amp; LastRow).Select\n    With Selection\n        .WrapText = False\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>And here is how to split your response in proper way:</p>\n\n<pre><code>Sub SplitToLines()\n    s = Cells(1, \"A\")\n    If Left(s, 1) = \"\"\"\" Then\n        s = Mid(s, 2)\n    End If\n\n    If Right(s, 1) = \"\"\"\" Then\n        s = Mid(s, 1, Len(s) - 1)\n    End If\n\n    resLines = Split(s, vbLf)\n\n    For i = LBound(resLines) To UBound(resLines)\n        Cells(i + 1, \"B\") = resLines(i)\n    Next i\n    Delimiter (i + 1)\n\nEnd Sub\n</code></pre>\n\n<p>I just checked on your example and it works. All you need is to put your response in \"A1\" cell (or change the macro). </p>\n\n<p>Let me know if you are having trouble with it.</p>\n"}], "owner": {"reputation": 55, "user_id": 5548034, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6c463da49f145c3c25b20d27fc0b898f?s=128&d=identicon&r=PG&f=1", "display_name": "J Moore", "link": "https://stackoverflow.com/users/5548034/j-moore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 906, "favorite_count": 1, "accepted_answer_id": 33640372, "answer_count": 3, "score": 3, "last_activity_date": 1447192498, "creation_date": 1447184223, "last_edit_date": 1447192280, "question_id": 33638143, "link": "https://stackoverflow.com/questions/33638143/splitting-text-by-rows-and-columns", "title": "Splitting Text By Rows and Columns", "body": "<p>I am using an Excel macro to retrieve a CSV file from Yahoo Finance. In column A, I have the stock tickers listed as input. I used to run a macro that would insert each ticker into a URL then output the results into column B. Then I would call a function to split the text in column B into columns B through column E.</p>\n\n<p>The function became much faster when I create a concatenated string of URLs and call the URL just once. The main problem is I am receiving the data in the following format:</p>\n\n<pre><code>\"81.950,342.05B,\"Exxon Mobil Corporation Common \",263.71B\n81.38,201.29B,\"Alibaba Group Holding Limited A\",13.56B\n754.77,519.78B,\"Alphabet Inc.\",71.76B\n120.57,649.30B,\"Apple Inc.\",233.72B\"\n</code></pre>\n\n<p><strong>Current Output</strong>\n<a href=\"https://i.stack.imgur.com/OjN72.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OjN72.jpg\" alt=\"Current Output\"></a></p>\n\n<p><strong>Expected/Ideal Output</strong>\n<a href=\"https://i.stack.imgur.com/dIHe0.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dIHe0.jpg\" alt=\"Expected/Ideal Output\"></a></p>\n\n<p>When I called the URL one ticker at a time, I could separate the necessary data out with the Text to Columns function. Now I need it separated by columns and rows.</p>\n\n<pre><code>Sub StockDataPull() \nDim url As String\nDim http As Object\nDim LastRow As Long\nDim Symbol_rng As Range\nDim Output_rng As Range\n\n'Define Last Row in Ticker Range\n    With ActiveSheet\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\n\n    Application.ScreenUpdating = False\n\nSet Symbol_rng = Range(\"A5:A\" &amp; LastRow).Cells\nSet Output_rng = Range(\"C5:F\" &amp; LastRow).Cells\n\n    'Open Yahoo Finance URL\n        url = \"http://download.finance.yahoo.com/d/quotes.csv?s=\" &amp; concatRange(Symbol_rng) &amp; \"&amp;f=pj1ns6\"\n                Set http = CreateObject(\"MSXML2.XMLHTTP\")\n        http.Open \"GET\", url, False\n        http.Send\n                    Output_rng = http.responseText\n           Set http = Nothing\n    Application.DisplayAlerts = False\n    Application.ScreenUpdating = True\nEnd Sub\n\n\n'The code below is what I used before Sub StockDataPull(). This code calls a URL for each ticker, instead of one URL for all tickers in a concatenated string. It's considerably slower, but it works because it outputs the data two cells away from the ticker, then I call Sub Delimiter() to separate it across the next few consecutive columns.\n\n\nSub StockData()\nDim url As String\nDim http As Object\nDim LastRow As Long\nDim Symbol_rng As Range\n\n''Define Last Row in Ticker Range\n    With ActiveSheet\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\n\n    Application.ScreenUpdating = False\n\nSet Symbol_rng = Range(\"A5:A\" &amp; LastRow).Cells\n\n    For Each cell In Symbol_rng\n\n    ''Open Yahoo Finance URL\n        url = \"http://download.finance.yahoo.com/d/quotes.csv?s=\" &amp; cell.Value &amp; \"&amp;f=pj1ns6\"\n\n        Set http = CreateObject(\"MSXML2.XMLHTTP\")\n        http.Open \"GET\", url, False\n        http.Send\n\n        cell.Offset(rowOffset:=0, columnOffset:=2) = http.responseText\n\n        Set http = Nothing\n\n    Next cell\n\n        Application.DisplayAlerts = False    \n        Application.ScreenUpdating = True    \n        Call Delimiter            \n    End Sub\n\nSub Delimiter()    \n''Define Last Row in Ticker Range\n    With ActiveSheet\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\n\n''Separate the data into four columns\n    Range(\"C5:C\" &amp; LastRow).TextToColumns Destination:=Range(\"C5\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n        Semicolon:=False, Comma:=True, Space:=False, Other:=False, FieldInfo _\n        :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1)), TrailingMinusNumbers:=True\n\n''Unwrap the text\n    Range(\"C5:F\" &amp; LastRow).Select\n    With Selection\n        .WrapText = False\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 3, "creation_date": 1447183545, "post_id": 33637920, "comment_id": 55049836, "body": "Please don&#39;t just tell us <code>What You would Like</code>. Please show us <code>What Have You Tried</code> and <code>Where Are you stuck</code> and <code>What Error(s) are you getting</code>"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1447192124, "post_id": 33637920, "comment_id": 55054532, "body": "<code>If target.column=16 then</code> will kick in when you change Column P"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5548009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfae6805e797c28df0ece82e15a32f5?s=128&d=identicon&r=PG&f=1", "display_name": "VBAgocode", "link": "https://stackoverflow.com/users/5548009/vbagocode"}, "edited": false, "score": 0, "creation_date": 1447357949, "post_id": 33640659, "comment_id": 55133278, "body": "The code above worked so well!! Thanks so much :) You are a life saver."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 11, "user_id": 5548009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfae6805e797c28df0ece82e15a32f5?s=128&d=identicon&r=PG&f=1", "display_name": "VBAgocode", "link": "https://stackoverflow.com/users/5548009/vbagocode"}, "edited": false, "score": 0, "creation_date": 1447358204, "post_id": 33640659, "comment_id": 55133415, "body": "Maybe mark it as the answer, so it doesn&#39;t keep popping up as unanswered."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1447194009, "last_edit_date": 1447194009, "creation_date": 1447193603, "answer_id": 33640659, "question_id": 33637920, "link": "https://stackoverflow.com/questions/33637920/loop-if-statements-as-well-run-macros-after-multiple-data-list-selections/33640659#33640659", "title": "Loop If statements as well run macros after multiple data list selections", "body": "<p>Are you changing Column P to \"Keep - no action\", then would you really need to loop instead of just working with the target.row?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim r As Integer\n    If Target.Column = 16 Then\n        If Target = \"Keep - no action\" Then\n            r = Target.Row\n\n            Cells(r, \"S\").Value = Cells(r, \"N\").Value\n            Cells(r, \"S\").AutoFill Destination:=Range(\"S\" &amp; r &amp; \":AB\" &amp; r), Type:=xlFillSeries 'Type:=xlFillDefault\n        End If\n\n        If Target = \"Something else\" Then\n            MsgBox \"Do something else\"\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Here is a loop you can work with:</p>\n\n<pre><code>Sub DoIt()\n    Dim LstRw As Long, Rng As Range, c As Range\n\n    LstRw = Cells(Rows.Count, \"P\").End(xlUp).Row\n    Set Rng = Range(\"P1:P\" &amp; LstRw)\n\n    For Each c In Rng.Cells\n\n        If c = \"Keep - no action\" Then\n            r = c.Row\n            Cells(r, \"S\").Value = Cells(r, \"N\").Value\n            Cells(r, \"S\").AutoFill Destination:=Range(\"S\" &amp; r &amp; \":AB\" &amp; r), Type:=xlFillSeries    'Type:=xlFillDefault\n        End If\n\n    Next c\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5548009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfae6805e797c28df0ece82e15a32f5?s=128&d=identicon&r=PG&f=1", "display_name": "VBAgocode", "link": "https://stackoverflow.com/users/5548009/vbagocode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1447194009, "creation_date": 1447183414, "last_edit_date": 1447190957, "question_id": 33637920, "link": "https://stackoverflow.com/questions/33637920/loop-if-statements-as-well-run-macros-after-multiple-data-list-selections", "title": "Loop If statements as well run macros after multiple data list selections", "body": "<ol>\n<li><p>I would like the Work Change macro to apply for the entire column.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Address(True, True) = \"$P$1\" Then\n    Select Case Target\n    Case \"Keep - no action\"\n        Call KeepNoAction\n    Case Else\n        Selection.ClearContents\n    End Select\nEnd If\nEnd Sub\n</code></pre></li>\n<li><p>the macro called, \"KeepNoAction\" I would like it to loop for multiple columns/ rows:</p>\n\n<pre><code>Sub KeepNoAction()\nIf Range(\"P1\").Value = \"Keep - no action\" Then\n    Range(\"N1\").Select\n    Selection.Copy\n    Range(\"S1\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n    Application.CutCopyMode = False\n    Selection.AutoFill Destination:=Range(\"S1:AB1\"), Type:=xlFillDefault\n    Range(\"S1:AB1\").Select\nElse\nEnd If\nIf Range(\"P2\").Value = \"Keep - no action\" Then\n    Range(\"N2\").Select\n    Selection.Copy\n    Range(\"S2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n    Application.CutCopyMode = False\n    Selection.AutoFill Destination:=Range(\"S2:AB2\"), Type:=xlFillDefault\n    Range(\"S2:AB2\").Select\nEnd If\nIf Range(\"P3\").Value = \"Keep - no action\" Then\n    Range(\"N3\").Select\n    Selection.Copy\n    Range(\"S3\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n    Application.CutCopyMode = False\n    Selection.AutoFill Destination:=Range(\"S3:AB3\"), Type:=xlFillDefault\n    Range(\"S3:AB3\").Select\nEnd If\n</code></pre></li>\n</ol>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1447183710, "post_id": 33637862, "comment_id": 55049909, "body": "I will take a look, but a quick fix you could exit the IsValidWord once its been set to false, as youre checking space to 9 each time."}, {"owner": {"reputation": 113, "user_id": 4962634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b962135c2081eb478fad99df967226b4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4962634/alex"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1447184283, "post_id": 33637862, "comment_id": 55050228, "body": "Thanks, I should have implemented that.."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1447184644, "post_id": 33637862, "comment_id": 55050453, "body": "Loop over all of the words in the document, adding them to a Scripting Dictionary: each time you find a new word, increment the value for that &quot;key&quot;.   You can then check your list against the Dictionary to find the count for each word."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4962634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b962135c2081eb478fad99df967226b4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4962634/alex"}, "edited": false, "score": 0, "creation_date": 1447264383, "post_id": 33638663, "comment_id": 55086674, "body": "Thank you! It does the job very fast!"}, {"owner": {"reputation": 113, "user_id": 4962634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b962135c2081eb478fad99df967226b4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4962634/alex"}, "edited": false, "score": 0, "creation_date": 1447264797, "post_id": 33638663, "comment_id": 55086909, "body": "However I&#39;ve added the IsValidWord() function to avoid wrong words to beadded and counted (do not know how to predict all possible versions of wrong words to add into a special dictionary to filter them out, e.g. &quot;Introduction.....................................3&quot;, or some Unicode strings that looks like just a whitespace)"}, {"owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "edited": false, "score": 0, "creation_date": 1450423186, "post_id": 33638663, "comment_id": 56442275, "body": "You might want to have a look at <a href=\"http://stackoverflow.com/a/22542835/4600127\">Regular Expressions in VBA</a> to specify valid words?"}], "tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": true, "score": 4, "last_activity_date": 1450425655, "last_edit_date": 1495540850, "creation_date": 1447186276, "answer_id": 33638663, "question_id": 33637862, "link": "https://stackoverflow.com/questions/33637862/word-occurences-in-vba-how-to-speed-up/33638663#33638663", "title": "Word occurences in VBA: how to speed up", "body": "<p>Add a reference to the <strong>Microsoft Scripting Runtime</strong> (<strong>Tools</strong> -> <strong>References...</strong>). Then use the following:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Const SpanishLCID = 3082\n    Dim dict As New Scripting.Dictionary, word As Variant, fixedWord As String\n    Dim key As Variant\n\n    dict.CompareMode = SpanishLCID\n    For Each word In ActiveDocument.Words\n        fixedWord = Trim(StrConv(Trim(word), vbLowerCase, SpanishLCID))\n        If Not dict.Exists(fixedWord) Then\n            dict(fixedWord) = 1\n        Else\n            dict(fixedWord) = dict(fixedWord) + 1\n        End If\n    Next\n\n    ListBox1.Clear\n    For Each key In dict.Keys\n        ListBox1.AddItem key &amp; \"=\" &amp; dict(key)\n    Next\nEnd Sub\n</code></pre>\n\n<p>NB. Word treats each punctuation symbol or paragraph as a new word. It may be advisable to specify another Dictionary or Collection with the strings that shouldn't be added to the dictionary, and test for those strings using <code>.Exists</code> before adding to the dictionary.</p>\n\n<hr>\n\n<p>A more concise version of <code>IsValidWord</code> without regular expressions:</p>\n\n<pre><code>Function IsValidWord(s As String) As Boolean\n    Const validChars As String = \"abcdefghijklmnopqrstuvwxyz\"\n    Dim i As Integer, char As String * 1\n    For i = 1 To Len(s)\n        char = Mid(s, i, 1)\n        If InStr(1, validChars, char, vbTextCompare) = 0 Then Exit Function\n    Next\n    IsValidWord = True\nEnd Function\n</code></pre>\n\n<p>and using <a href=\"https://stackoverflow.com/a/22542835/111794\">regular expressions</a> (add a reference to <strong>Microsoft VBScript Regular Expressions 5.5</strong>):</p>\n\n<pre><code>Dim regex As RegExp\nFunction IsValidWord2(s As String) As Boolean\n    If regex Is Nothing Then\n        Set regex = New RegExp\n        regex.Pattern = \"[^a-z]\"\n        regex.IgnoreCase = True\n    End If\n    IsValidWord2 = Not regex.Test(s)\nEnd Function\n</code></pre>\n\n<p>and using regular expressions with replacement:</p>\n\n<pre><code>Function GetValidWord(s As String) As String\n    'GetValidWord(\"Introduction.......3\") will return \"Introduction\"\n    If regex2 Is Nothing Then\n        Set regex2 = New RegExp\n        regex2.Pattern = \"[^a-z]\"\n        regex2.Global = True\n        regex2.IgnoreCase = True\n    End If\n    GetValidWord = regex2.Replace(s, \"\")\nEnd Function\n</code></pre>\n\n<p>and you would use it as follows:</p>\n\n<pre><code>    For Each word In ActiveDocument.Words\n        fixedWord = Trim(StrConv(Trim(word), vbLowerCase, SpanishLCID))\n        fixedWord = GetValidWord(fixedWord)\n        If Not dict.Exists(fixedWord) Then\n</code></pre>\n\n<p>NB: You might combine the language conversion and <code>Trim</code> into <code>GetValidWord</code>.</p>\n"}], "owner": {"reputation": 113, "user_id": 4962634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b962135c2081eb478fad99df967226b4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4962634/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 664, "favorite_count": 1, "accepted_answer_id": 33638663, "answer_count": 1, "score": 0, "last_activity_date": 1450425655, "creation_date": 1447183193, "last_edit_date": 1495540850, "question_id": 33637862, "link": "https://stackoverflow.com/questions/33637862/word-occurences-in-vba-how-to-speed-up", "title": "Word occurences in VBA: how to speed up", "body": "<p>I need to write a MS Word macro to count occurence of every word within a given document and print out the list like .\nI did the macro and it works, but it is so sloooow, it takes several hours to get results for a document of 60000 words. \nCould you please give me some advices/suggestions on how to make the macro run faster?</p>\n\n<p>(I checked a similar question here <a href=\"https://stackoverflow.com/questions/5645762/word-vba-count-word-occurrences\">WORD VBA Count Word Occurrences</a> but still don't get it how to speed up and need my macro to be reviewed). Thank you.</p>\n\n<pre><code>Private Type WordStatData\n    WordText As String\n    WordCount As Integer\nEnd Type\n\nOption Base 1\n'Check if the word is valid\n\nPrivate Function IsValidWord(SomeString As String) As Boolean\n    Dim Retval As Boolean\n    Retval = True\n    If Not (InStr(SomeString, \" \") = 0) Then Retval = False\n    If Not (InStr(SomeString, \".\") = 0) Then Retval = False\n    If Not (InStr(SomeString, \",\") = 0) Then Retval = False\n    If Not InStr(SomeString, \"0\") = 0 Then Retval = False\n    If Not InStr(SomeString, \"1\") = 0 Then Retval = False\n    If Not InStr(SomeString, \"2\") = 0 Then Retval = False\n    If Not InStr(SomeString, \"3\") = 0 Then Retval = False\n    If Not InStr(SomeString, \"4\") = 0 Then Retval = False\n    If Not InStr(SomeString, \"5\") = 0 Then Retval = False\n    If Not InStr(SomeString, \"6\") = 0 Then Retval = False\n    If Not InStr(SomeString, \"7\") = 0 Then Retval = False\n    If Not InStr(SomeString, \"8\") = 0 Then Retval = False\n    If Not InStr(SomeString, \"9\") = 0 Then Retval = False\n    IsValidWord = Retval\nEnd Function\n\nPrivate Sub CommandButton1_Click()\n    SpanishLCID = 3082 'The source text is in Spanish\n    ListBox1.Clear\n    Dim WordsTotal As Long\n    WordsTotal = ActiveDocument.Words.Count\n    TextBox1.Text = Str(WordsTotal)\n    Dim Wordfound As Boolean\n    Dim NewWord As String\n    Dim MyData() As WordStatData\n    ReDim Preserve MyData(1)\n    NewWord = \"\"\n    For i = 1 To WordsTotal\n        NewWord = Trim(StrConv(Trim(ActiveDocument.Words(i)), vbLowerCase, SpanishLCID))\n        'Check if the word is in the list\n        If IsValidWord(NewWord) Then\n            Wordfound = False\n            For j = 1 To UBound(MyData)\n                If StrComp(MyData(j).WordText, NewWord) = 0 Then\n                    Wordfound = True: Exit For\n                End If\n            Next j\n            If Wordfound Then\n                MyData(j).WordCount = MyData(j).WordCount + 1\n            Else\n                ReDim Preserve MyData(UBound(MyData) + 1)\n                MyData(UBound(MyData)).WordText = NewWord\n                MyData(UBound(MyData)).WordCount = 1\n            End If\n        End If\n    Next i\n    'Printing out the word list\n    For i = 1 To UBound(MyData)\n        ListBox1.AddItem (MyData(i).WordText &amp; \"=\" &amp; Str(MyData(i).WordCount))\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1447183243, "post_id": 33637622, "comment_id": 55049671, "body": "I need to see the actual url"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1447184192, "post_id": 33637622, "comment_id": 55050180, "body": "check the browser is not busy also, but that looks ok.Set ele2 = doc.getElementById(&quot;search_terms&quot;) ele2.Value = &quot;TEST VAL&quot; is what I&#39;ve used in the past"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447184977, "post_id": 33637622, "comment_id": 55050649, "body": "without seeing the URL - replace <code>.getElementById(&quot;username&quot;).Value = &quot;user&quot;</code> with <code>.getElementByName(&quot;username&quot;).Item(0).Value = &quot;user&quot;</code> (and same for password). Also use IE developer tools to find the name of the button to click and place <code>If Instr(1, oHTML_Element.Name, &quot;ButtoName&quot;) Then</code> in front of  <code>oHTML_Element.Click</code>. Otherwise, you may click another button unintentionally."}, {"owner": {"user_type": "does_not_exist", "display_name": "user882670"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447185419, "post_id": 33637622, "comment_id": 55050941, "body": "@ScottHoltzman Thanks, but I still can&#39;t enter user/pass in the form. BTW you may see the HTML following the link on my comment above"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user882670"}, "edited": false, "score": 0, "creation_date": 1447186112, "post_id": 33638558, "comment_id": 55051301, "body": "Whoa, it&#39;s also working here! Would you please change the sURL in your code so that I won&#39;t have the world trying to login to the website? :-) Thanks a lot for your help!"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447186464, "post_id": 33638558, "comment_id": 55051489, "body": "Edited it out. I also changed &#39;input&#39; to &#39;button&#39;. Forgot to add that first time. Please mark as answered if it is indeed so."}, {"owner": {"user_type": "does_not_exist", "display_name": "user882670"}, "edited": false, "score": 0, "creation_date": 1447186580, "post_id": 33638558, "comment_id": 55051555, "body": "Thanks, I noticed the &#39;input&#39; had to be changed to &#39;button&#39;, but it happens the page has more than one button, so it isn&#39;t clicking on the right one yet."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447186787, "post_id": 33638558, "comment_id": 55051677, "body": "See my edit. Added an <code>If</code> statement to test button name. However, I only saw one button on the page when I tested it."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1447186736, "last_edit_date": 1447186736, "creation_date": 1447185875, "answer_id": 33638558, "question_id": 33637622, "link": "https://stackoverflow.com/questions/33637622/enter-username-and-password-in-login-form-on-a-webpage/33638558#33638558", "title": "Enter username and password in login form on a webpage", "body": "<p>I just tested this code and it worked. </p>\n\n<p>The only difference is that I used <code>Late Binding</code> (too lazy to set all references) and I added <code>While .Busy</code> to the Loop to wait for the URL to load. I also changed <code>input</code> to <code>button</code> in the button click loop.</p>\n\n<pre><code>Dim HTMLDoc As Object 'HTMLDocument\nDim oBrowser As Object 'InternetExplorer\n\nSub Website_Login()\n\nDim oHTML_Element As Object 'IHTMLElement\nDim sURL As String\n\nsURL = \"https://www.mypage.com/login.html\"\nSet oBrowser = CreateObject(\"InternetExplorer.Application\") 'New InternetExplorer\n'oBrowser.Silent = True\n'oBrowser.timeout = 60\noBrowser.navigate sURL\noBrowser.Visible = True\n\nWith oBrowser\n    Do While .Busy Or .ReadyState &lt;&gt; 4: Loop\nEnd With\n\n\nSet HTMLDoc = oBrowser.Document\n\nWith HTMLDoc\n  HTMLDoc.getElementById(\"username\").Value = \"user\"\n  HTMLDoc.getElementById(\"password\").Value = \"password\"\nEnd With\n\nFor Each oHTML_Element In HTMLDoc.getElementsByTagName(\"button\")\n  If oHTML_Element.Name = \"Submit\" Then oHTML_Element.Click\n  Exit For\nNext\n\noBrowser.Quit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user882670"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1008, "favorite_count": 1, "accepted_answer_id": 33638558, "answer_count": 1, "score": 1, "last_activity_date": 1447186736, "creation_date": 1447182462, "question_id": 33637622, "link": "https://stackoverflow.com/questions/33637622/enter-username-and-password-in-login-form-on-a-webpage", "title": "Enter username and password in login form on a webpage", "body": "<p>Using Excel VBA, I'm trying to login to a website.</p>\n\n<p>This is my code:</p>\n\n<pre><code>Dim HTMLDoc As HTMLDocument\nDim oBrowser As InternetExplorer\nSub Website_Login()\n\nDim oHTML_Element As IHTMLElement\nDim sURL As String\n\nsURL = \"https://www.domain.com/login.html\"\n\nSet oBrowser = New InternetExplorer\n'oBrowser.Silent = True\n'oBrowser.timeout = 60\noBrowser.navigate sURL\noBrowser.Visible = True\n\nDo\nLoop Until oBrowser.ReadyState = READYSTATE_COMPLETE\n\nSet HTMLDoc = oBrowser.Document\n\nWith HTMLDoc\n  HTMLDoc.getElementById(\"username\").Value = \"user\"\n  HTMLDoc.getElementById(\"password\").Value = \"password\"\nEnd With\n\nFor Each oHTML_Element In HTMLDoc.getElementsByTagName(\"input\")\n  oHTML_Element.Click\n  Exit For\nNext\n\noBrowser.Quit\n\nEnd Sub\n</code></pre>\n\n<p>The Javascript instructions in this code are working. If I go to the page and enter them, they work. But when I run the code, IE opens but it doesn't enter the user/pass and click the button.</p>\n\n<p>Any help, please?</p>\n"}, {"tags": ["vba", "ms-word", "infinite-loop"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5531895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114c3de88425e69b420bc41e6222ba0a?s=128&d=identicon&r=PG&f=1", "display_name": "Bobcloclimar", "link": "https://stackoverflow.com/users/5531895/bobcloclimar"}, "edited": false, "score": 0, "creation_date": 1447190659, "post_id": 33637746, "comment_id": 55053759, "body": "Thanks - switching to a counting loop seems to solve the problem.   I&#39;m still curious (academically) as to the root issue in my original code (maybe something to do with how <code>Rows.Add</code> works), but at least I can move forward."}, {"owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "reply_to_user": {"reputation": 13, "user_id": 5531895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114c3de88425e69b420bc41e6222ba0a?s=128&d=identicon&r=PG&f=1", "display_name": "Bobcloclimar", "link": "https://stackoverflow.com/users/5531895/bobcloclimar"}, "edited": false, "score": 0, "creation_date": 1447192595, "post_id": 33637746, "comment_id": 55054793, "body": "Maybe each time you call &#39;Add&#39; internally it creates a new table. Academically you can just set a breakpoint inside your old code, then keep looking at ActiveDocument.Tables.Count, to see if it increases with each iteration"}, {"owner": {"reputation": 13, "user_id": 5531895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114c3de88425e69b420bc41e6222ba0a?s=128&d=identicon&r=PG&f=1", "display_name": "Bobcloclimar", "link": "https://stackoverflow.com/users/5531895/bobcloclimar"}, "edited": false, "score": 0, "creation_date": 1447195437, "post_id": 33637746, "comment_id": 55056175, "body": "I was thinking the same thing - however, <code>ActiveDocument.Tables.Count</code> doesn&#39;t actually increment."}], "tags": [], "owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "is_accepted": true, "score": 1, "last_activity_date": 1447183106, "last_edit_date": 1447183106, "creation_date": 1447182794, "answer_id": 33637746, "question_id": 33637352, "link": "https://stackoverflow.com/questions/33637352/vba-word-macro-inserting-table-rows-at-end-of-table-creates-infinite-loop/33637746#33637746", "title": "VBA Word macro - inserting table rows at end of table creates infinite loop", "body": "<p>I am not sure why your for each is going on forever, but you can easily just convert it to a normal for loop if you're having issues like so:</p>\n\n<pre><code>Sub insertTopRow()\n    Dim theTable As Table\n    Dim theNewRow As Row\n    Dim i As Integer\n\n    For i = 1 to ActiveDocument.Tables.Count\n        Set theTable = ActiveDocument.Tables(i)\n        Set theNewRow = theTable.Rows.Add(theTable.Rows.First)\n        'Other row formatting\n    Next i\nEnd Sub\n\n Sub insertBottomRow()\n    Dim theTable As Table\n    Dim theNewRow As Row\n    Dim i As Integer\n\n    For i = 1 to ActiveDocument.Tables.Count\n        Set theTable = ActiveDocument.Tables(i)\n        Set theNewRow = theTable.Rows.Add\n        'Other row formatting\n    Next i\nEnd Sub\n</code></pre>\n\n<p>You may also want to confirm it is an infinite loop, you can always break your executing code by pressing Ctrl + Pause/Break.</p>\n\n<p>Another tip would be to combine these functions if the 'Other row formatting is the same for the top and bottom rows. You can just create a boolean parameter and have an if/else statement around the 'Set theNewRow =' line.</p>\n"}], "owner": {"reputation": 13, "user_id": 5531895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114c3de88425e69b420bc41e6222ba0a?s=128&d=identicon&r=PG&f=1", "display_name": "Bobcloclimar", "link": "https://stackoverflow.com/users/5531895/bobcloclimar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8209, "favorite_count": 1, "accepted_answer_id": 33637746, "answer_count": 1, "score": 1, "last_activity_date": 1447183106, "creation_date": 1447181489, "question_id": 33637352, "link": "https://stackoverflow.com/questions/33637352/vba-word-macro-inserting-table-rows-at-end-of-table-creates-infinite-loop", "title": "VBA Word macro - inserting table rows at end of table creates infinite loop", "body": "<p>I'm writing a set of macros to format a series of tables in a document. Part of this requires inserting a new row at the end of each table - however, when I try to do it using <code>For Each &lt;table&gt; in ActiveDocument.Tables</code>, it ends up inserting an infinite number of rows at the bottom of the first table. \nBoth of these subs will enter an infinite loop:</p>\n\n<pre><code>Sub insertBottomRow1()\n    Dim theTable As Table\n    Dim theNewRow As Row\n    For Each theTable In ActiveDocument.Tables\n        Set theNewRow = theTable.Rows.Add\n        'Other row formatting\n    Next theTable\nEnd Sub\n\nSub insertBottomRow2()\n    Dim theTable As Table\n    Dim theNewRow As Row\n    For Each theTable In ActiveDocument.Tables\n        theTable.Rows.Last.Select\n        Selection.InsertRowsBelow\n        Set theNewRow = theTable.Rows.Last\n        'Other row formatting\n    Next theTable\nEnd Sub\n</code></pre>\n\n<p>I have a similar sub which uses the same structure to insert a row at the top of the tables, and this does not enter an infinite loop.</p>\n\n<pre><code>Sub insertTopRow()\n    Dim theTable As Table\n    Dim theNewRow As Row\n    For Each theTable In ActiveDocument.Tables\n        Set theNewRow = theTable.Rows.Add(theTable.Rows.First)\n        'Other row formatting\n    Next theTable\nEnd Sub\n</code></pre>\n\n<p>I've done some experimentation (adding counters to the added rows, and stepping through the debugger), and the two subs that crash seem to be re-selecting the first table instead of moving onto the next table. </p>\n\n<p>Any help would be appreciated. Thank you.</p>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1447179983, "post_id": 33636888, "comment_id": 55047872, "body": "if you have Acrobat you can create javascript inside the PDF that will fill an Excel file, say at the press of a button. Alternatively, you can program VBA in Excel to grab the data from the form via a button push from the Excel file with the Acrobat Type Library Reference."}, {"owner": {"reputation": 69, "user_id": 5490317, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/580d2780b0ecd1767968d3b1be0a5932?s=128&d=identicon&r=PG&f=1", "display_name": "Silent Observer", "link": "https://stackoverflow.com/users/5490317/silent-observer"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447180409, "post_id": 33636888, "comment_id": 55048121, "body": "@ Scott Holtzman That was a good head start. I would search something on this. By chance, do you have any sample codes or links regarding this?"}], "answers": [{"tags": [], "owner": {"reputation": 3227, "user_id": 2241145, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ff4bb43d7776533dbd96d13258c99f4d?s=128&d=identicon&r=PG", "display_name": "Max Wyss", "link": "https://stackoverflow.com/users/2241145/max-wyss"}, "is_accepted": false, "score": 0, "last_activity_date": 1447203785, "creation_date": 1447203785, "answer_id": 33642563, "question_id": 33636888, "link": "https://stackoverflow.com/questions/33636888/is-there-a-way-to-connect-pdf-document-and-excel-sheet/33642563#33642563", "title": "Is there a way to connect PDF document and Excel sheet?", "body": "<p>In the olden days, it was possible to set up a direct connection, using ODBC (and the ADBC object in the PDF). This has, however, been abandoned a few Acrobat versions ago.</p>\n\n<p>The most direct connection would be based on SOAP, but it requires Acrobat; it does not work with Reader.</p>\n\n<p>All other ways of communicating with a database/spreadsheet are asynchronous, meaning that you have to initiate the process from your form. </p>\n\n<p>You can use the form to create a tab-delimited file which you then can import into your back end, or you can submit data to a server which then communicates with the back end. Or, as it has already been stated, you can control Acrobat using VB (or Applescript), and get data out by this way.</p>\n"}], "owner": {"reputation": 69, "user_id": 5490317, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/580d2780b0ecd1767968d3b1be0a5932?s=128&d=identicon&r=PG&f=1", "display_name": "Silent Observer", "link": "https://stackoverflow.com/users/5490317/silent-observer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447203785, "creation_date": 1447179689, "question_id": 33636888, "link": "https://stackoverflow.com/questions/33636888/is-there-a-way-to-connect-pdf-document-and-excel-sheet", "title": "Is there a way to connect PDF document and Excel sheet?", "body": "<p>I want to know whether there is a way to connect a Fillable PDF document and excel sheet. I know this question may be little open ended. But I have been searching a lot to find out if there is a way to do it, without much success. My requirement is I want to connect a Fillable PDF with an excel sheet, so that whenever we fill the PDF document, the excel sheet automatically populates.</p>\n\n<p>I am not sure whether this is possible or not. If it is possible, can anybody tell me a way to do that? So that I can search on it and figure it out?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "edited": false, "score": 0, "creation_date": 1447181633, "post_id": 33636793, "comment_id": 55048780, "body": "What is giving you the error? The commented out line towards the top?"}, {"owner": {"reputation": 81, "user_id": 5419479, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1e492141951a95d01e928a5e63fb157b?s=128&d=identicon&r=PG&f=1", "display_name": "SAS_N00b", "link": "https://stackoverflow.com/users/5419479/sas-n00b"}, "reply_to_user": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "edited": false, "score": 0, "creation_date": 1447183654, "post_id": 33636793, "comment_id": 55049881, "body": "The line that gives the error is the consolidate step at the very end. It reads and starts the IF statement, but the ws2.Range(&quot;A2&quot;) etc does not work. It gives me the object-defined or application-defined error"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1447204265, "post_id": 33636793, "comment_id": 55059356, "body": "Have you tried adding <code>External:=True</code> to the call to <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837625(v=office.15).aspx\" rel=\"nofollow noreferrer\">Range.Address</a>?"}, {"owner": {"reputation": 81, "user_id": 5419479, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1e492141951a95d01e928a5e63fb157b?s=128&d=identicon&r=PG&f=1", "display_name": "SAS_N00b", "link": "https://stackoverflow.com/users/5419479/sas-n00b"}, "edited": false, "score": 0, "creation_date": 1447264659, "post_id": 33636793, "comment_id": 55086836, "body": "Thank you, barrowc! That solved the issue. Could you help me understand what the external:=true is doing? I have never seen that before."}], "owner": {"reputation": 81, "user_id": 5419479, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1e492141951a95d01e928a5e63fb157b?s=128&d=identicon&r=PG&f=1", "display_name": "SAS_N00b", "link": "https://stackoverflow.com/users/5419479/sas-n00b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1447179678, "creation_date": 1447179377, "last_edit_date": 1531161705, "question_id": 33636793, "link": "https://stackoverflow.com/questions/33636793/application-defined-error-when-trying-to-consolidate-table-data", "title": "Application-defined error when trying to consolidate table data", "body": "<p>I have tried to use several workarounds and other posts, but cannot seem to find a way to answer the error I am having. </p>\n\n<p>I am using Excel 2013 and am trying to grab information from a table to consolidate it. I also tried to copy the table data onto another worksheet, hoping that this would make it easier to consolidate. However, I am still having the same error above.</p>\n\n<p>Ideally, I would like to grab the filtered table information and consolidate it. The reason it needs to be consolidated is that it will have multiple values for state in the table and I need to see the sum of a few categories based off of state (and other variables).</p>\n\n<p>Please help me figure out why the code keeps on breaking at the consolidate piece of the code.</p>\n\n<pre><code>Private Sub ComboBox2_Change()\n\nDim Issuer As String\nDim FirstRow As Long\nDim LastRow As Long\nDim LastCol As Long\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim MyArray As Variant\n\nSet ws1 = Worksheets(\"Data\")\nSet ws2 = Worksheets(\"ChartData\")\nIssuer = ws2.Range(\"IssuerNum\").Value\n\n'Worksheets(\"Data\").ListObjects(\"Table1\").Range.AutoFilter.ShowAllData\n\nIf Issuer = \"All\" Then\n    Worksheets(\"Data\").ListObjects(\"Table1\").Range.AutoFilter _\n        Field:=1, Criteria1:=\"&lt;&gt;\", Operator:=xlFilterValues\n\n    LastRow = ws1.Cells(ws1.Rows.Count, \"A\").End(xlUp).Row\n    FirstRow = ws1.Cells(2, 1).Row\n\nElse\n    ws1.ListObjects(\"Table1\").Range.AutoFilter _\n        Field:=1, Criteria1:=Issuer, Operator:=xlFilterValues\n\n    With ws1.ListObjects(\"Table1\").AutoFilter.Range.SpecialCells(xlCellTypeVisible)\n         LastRow = .Areas(.Areas.Count).Row + .Areas(.Areas.Count).Rows.Count - 1\n    End With\n    FirstRow = ws1.ListObjects(\"Table1\").AutoFilter.Range.Offset(1).SpecialCells(xlCellTypeVisible).Cells(1, 2).Row\n\nEnd If\n\nws1.Range(ws1.Cells(FirstRow, 3), ws1.Cells(LastRow, 9)).Select\n\nSet MyArray = Selection\n\n'Add in consolidate here to set up chart data\nIf ws2.Range(\"RadioSel\").Value = 1 Then\nws2.Range(\"A2\").Consolidate _\nSources:=MyArray.Address(ReferenceStyle:=xlR1C1), _\nFunction:=xlSum, LeftColumn:=True\n\nEnd Sub()\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5547670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/315b33d38bc4cf0bf1596f910848b909?s=128&d=identicon&r=PG&f=1", "display_name": "fergustr", "link": "https://stackoverflow.com/users/5547670/fergustr"}, "is_accepted": false, "score": 1, "last_activity_date": 1448310703, "creation_date": 1448310703, "answer_id": 33880140, "question_id": 33636790, "link": "https://stackoverflow.com/questions/33636790/interacting-with-web-dropdown-dispatchevent/33880140#33880140", "title": "Interacting with web dropdown, .dispatchEvent", "body": "<p>After many Google searches I found my answer. I had the True &amp; False properties backwards in the .initEvent line. I had:</p>\n\n<pre><code>objEvent.initEvent \"change\", False, True\n</code></pre>\n\n<p>It needed to be:</p>\n\n<pre><code>objEvent.initEvent \"change\", True, False\n</code></pre>\n\n<p>Hope this helps someone in the future.</p>\n"}], "owner": {"reputation": 31, "user_id": 5547670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/315b33d38bc4cf0bf1596f910848b909?s=128&d=identicon&r=PG&f=1", "display_name": "fergustr", "link": "https://stackoverflow.com/users/5547670/fergustr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 629, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1448310703, "creation_date": 1447179364, "last_edit_date": 1447179959, "question_id": 33636790, "link": "https://stackoverflow.com/questions/33636790/interacting-with-web-dropdown-dispatchevent", "title": "Interacting with web dropdown, .dispatchEvent", "body": "<p>I am working on a web crawler of sorts that pulls back prices of items from various websites. The issue I am having is that on amazon.com, on items which have multiple options (i.e. sizes), I am able to interact, and change the dropdown selection option, but I can't get the site to post-back and display the specific price for that option. I realize that this isn't an uncommon question, but most people seem to have their issue resolved by using .dispatchEvent method rather than .fireEvent. That doesn't seem to be working for me.</p>\n\n<p>Dropdown options (only showing first 5):<br>\n        </p>\n\n<pre><code>            &lt;option value=\"-1\" id=\"native_size_name_-1\" data-a-id=\"size_name_-1\" selected=\"\"&gt; Select&lt;/option&gt;    \n\n            &lt;option value=\"0,B001249LAS\" class=\"dropdownAvailable\" data-a-css-class=\"dropdownAvailable\" id=\"native_size_name_0\" data-a-id=\"size_name_0\" data-a-html-content=\"44W x 29L\"&gt;\n                44W x 29L\n            &lt;/option&gt;\n\n            &lt;option value=\"1,B001249KAE\" class=\"dropdownAvailable\" data-a-css-class=\"dropdownAvailable\" id=\"native_size_name_1\" data-a-id=\"size_name_1\" data-a-html-content=\"44W x 30L\"&gt;\n                44W x 30L\n            &lt;/option&gt;\n\n            &lt;option value=\"2,B001243XPM\" class=\"dropdownAvailable\" data-a-css-class=\"dropdownAvailable\" id=\"native_size_name_2\" data-a-id=\"size_name_2\" data-a-html-content=\"44W x 32L\"&gt;\n                44W x 32L\n            &lt;/option&gt;\n\n            &lt;option value=\"3,B001243XRK\" class=\"dropdownAvailable\" data-a-css-class=\"dropdownAvailable\" id=\"native_size_name_3\" data-a-id=\"size_name_3\" data-a-html-content=\"44W x 34L\"&gt;\n                44W x 34L\n            &lt;/option&gt;\n\n            &lt;option value=\"4,B001243Z00\" class=\"dropdownAvailable\" data-a-css-class=\"dropdownAvailable\" id=\"native_size_name_4\" data-a-id=\"size_name_4\" data-a-html-content=\"46W x 29L\"&gt;\n                46W x 29L\n            &lt;/option&gt;\n\n\n            &lt;option value=\"5,B001245XG4\" class=\"dropdownAvailable\" data-a-css-class=\"dropdownAvailable\" id=\"native_size_name_5\" data-a-id=\"size_name_5\" data-a-html-content=\"46W x 30L\"&gt;\n                46W x 30L\n            &lt;/option&gt;\n\n    &lt;/select&gt;&lt;span style=\"min-width: 0%;\" tabindex=\"-1\" id=\"dropdown_selected_size_name\" data-a-class=\"aui-variation  a-fastclick-disable\" class=\"a-button a-button-dropdown aui-variation  a-fastclick-disable\"&gt;&lt;span class=\"a-button-inner\"&gt;&lt;span class=\"a-button-text a-declarative\" data-action=\"a-dropdown-button\" aria-haspopup=\"true\" role=\"button\" tabindex=\"0\"&gt;&lt;span class=\"a-dropdown-prompt\"&gt; Select&lt;/span&gt;&lt;/span&gt;&lt;i class=\"a-icon a-icon-dropdown\"&gt;&lt;/i&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;\n</code></pre>\n\n<p>Firefox shows me that there is an event associated with with the dropdown:</p>\n\n<pre><code>\"native_dropdown_selected_size_name\").onchange = function() {\nTwisterNonJs.handleDropDown[0]();\n</code></pre>\n\n<p>Here is my code, Excel seems to compile the .dispatchEvent method just fine, but IE does not fire when it is initiated.</p>\n\n<p>URLPath = <a href=\"https://rads.stackoverflow.com/amzn/click/com/B001243Z00\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">http://www.amazon.com/Lee-Big-Tall-Dungarees-Carpenter-Original/dp/B001243Z00/</a>\nelementid = \"priceblock_ourprice\" (With Quotes)</p>\n\n<pre><code>Sub getPrice(URLPath As String, elementid As String)\n\nSet IE = CreateObject(\"internetexplorer.application\")\n\nIE.Visible = True\nnavigate:\nIE.navigate URLPath\n\n\nDo While IE.readystate &lt;&gt; 4: DoEvents: Loop\n    Set doc = CreateObject(\"htmlfile\")\n    Set doc = IE.document\n\n    If doc Is Nothing Then GoTo navigate\n    doc.getElementById(\"native_dropdown_selected_size_name\").Focus\n            doc.getElementById(\"native_dropdown_selected_size_name\").SelectedIndex = 2\n\n    Dim objEvent\n    Set objEvent = doc.createEvent(\"HTMLEvents\")\n    objEvent.initEvent \"change\", False, True\n    doc.getElementById(\"native_dropdown_selected_size_name\").dispatchEvent objEvent\n\n    Do While IE.readystate &lt;&gt; 4: DoEvents: Loop\n\n    pricestr = doc.getElementById(elementid).innertext\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 5547753, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/579de7b649442b2a4192bc8ba4a993be?s=128&d=identicon&r=PG&f=1", "display_name": "Ben A", "link": "https://stackoverflow.com/users/5547753/ben-a"}, "edited": false, "score": 0, "creation_date": 1447248571, "post_id": 33636895, "comment_id": 55076357, "body": "Estevam, that works great as long as the sorting results in data being displayed. I periodically have empty data as the final result, in this case I&#39;m no longer able to pull blank data and the sheet goes to cells in the 200+ row count range. Any way to make it ok with this?"}, {"owner": {"reputation": 429, "user_id": 4980571, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6dd665a9d36a1da523cc706f05a27e4a?s=128&d=identicon&r=PG&f=1", "display_name": "Estevam Garcia", "link": "https://stackoverflow.com/users/4980571/estevam-garcia"}, "reply_to_user": {"reputation": 159, "user_id": 5547753, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/579de7b649442b2a4192bc8ba4a993be?s=128&d=identicon&r=PG&f=1", "display_name": "Ben A", "link": "https://stackoverflow.com/users/5547753/ben-a"}, "edited": false, "score": 0, "creation_date": 1447248898, "post_id": 33636895, "comment_id": 55076553, "body": "Not sure if I understood what you want, but you can check whether a filtered table returns any results using this line of code <code>YourTable.Range.SpecialCells(xlCellTypeVisible).Rows.Count &gt; 1</code>"}], "tags": [], "owner": {"reputation": 429, "user_id": 4980571, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6dd665a9d36a1da523cc706f05a27e4a?s=128&d=identicon&r=PG&f=1", "display_name": "Estevam Garcia", "link": "https://stackoverflow.com/users/4980571/estevam-garcia"}, "is_accepted": false, "score": 0, "last_activity_date": 1447179714, "creation_date": 1447179714, "answer_id": 33636895, "question_id": 33636753, "link": "https://stackoverflow.com/questions/33636753/store-cell-contents-from-first-row-of-filtered-data/33636895#33636895", "title": "Store cell contents from first row of filtered data", "body": "<p>You can use the method <code>SpecialCells(xlCellTypeVisible)</code> to select and copy the data once it is filtered</p>\n\n<p>example:</p>\n\n<pre><code>Sheet1.Range(\"A1:D10\")SpecialCells(xlCellTypeVisible).Select\nSelection.Copy\nSheet2.Paste\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 582, "user_id": 6896061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf0230605ac24f5be23ea08c02dbbe5?s=128&d=identicon&r=PG", "display_name": "DavidP", "link": "https://stackoverflow.com/users/6896061/davidp"}, "is_accepted": false, "score": 0, "last_activity_date": 1532636668, "creation_date": 1532636668, "answer_id": 51547001, "question_id": 33636753, "link": "https://stackoverflow.com/questions/33636753/store-cell-contents-from-first-row-of-filtered-data/51547001#51547001", "title": "Store cell contents from first row of filtered data", "body": "<p>Instead of filtering and copying the top row that is shown, you might want to consider just looping through all the rows in the sorted table, copying a row to the other sheet when the unit and shift are not equal to the previous row.</p>\n"}], "owner": {"reputation": 159, "user_id": 5547753, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/579de7b649442b2a4192bc8ba4a993be?s=128&d=identicon&r=PG&f=1", "display_name": "Ben A", "link": "https://stackoverflow.com/users/5547753/ben-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1532636668, "creation_date": 1447179190, "last_edit_date": 1447179820, "question_id": 33636753, "link": "https://stackoverflow.com/questions/33636753/store-cell-contents-from-first-row-of-filtered-data", "title": "Store cell contents from first row of filtered data", "body": "<p>I'm writing a macro that will automate the generation of a report using data from one tab.\nThe data is stored in the columns: Date, Shift (Day or night), UnitID, Operator Initials, Unit Uptime, and Comments. For the report I need to sort the data first by date and then iteratively by each unit for each shift. The data for each sort will be only a single line separated into cells such as:</p>\n\n<pre><code>Unit | Shift | Operator Initials | Up Time | Comments.\n</code></pre>\n\n<p>Then I need to resort the data for the next shift/unit set and continue through all of the units.  Using two For loops I have automated the iteration through the units and shifts. However I cannot figure out how to copy the data once it is filtered. Using hardcoded cell references I get the same data each iteration (as would be expected). </p>\n\n<p>How do I tell Excel to copy (or better yet save as a variable) the value in each cell that is displayed directly below the header line?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447179143, "post_id": 33636699, "comment_id": 55047390, "body": "change <code>With Columns(2)</code> to <code>With DR.Columns(2)</code>."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1447179188, "post_id": 33636699, "comment_id": 55047422, "body": "Find is SLOW. Use Match instead:  <a href=\"https://fastexcel.wordpress.com/2011/10/26/match-vs-find-vs-variant-array-vba-performance-shootout/\" rel=\"nofollow noreferrer\">fastexcel.wordpress.com/2011/10/26/&hellip;</a>"}, {"owner": {"reputation": 125, "user_id": 5196659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPFG4.jpg?s=128&g=1", "display_name": "zickens", "link": "https://stackoverflow.com/users/5196659/zickens"}, "edited": false, "score": 0, "creation_date": 1447179193, "post_id": 33636699, "comment_id": 55047428, "body": "Sorry for not clarifying; the first .Find works just fine. its the one that involves the other worksheet that failed out of nowhere."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447179493, "post_id": 33636699, "comment_id": 55047597, "body": "is it the <code>MatchCase:=True</code> setting that may be throwing it off on the 2nd <code>.Find</code> groupings?"}, {"owner": {"reputation": 125, "user_id": 5196659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPFG4.jpg?s=128&g=1", "display_name": "zickens", "link": "https://stackoverflow.com/users/5196659/zickens"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447180213, "post_id": 33636699, "comment_id": 55048015, "body": "Tried it with and without the MatchCase, and in both <code>True</code> and <code>False</code>. It shouldn&#39;t even matter, because the string i&#39;m searching is a number (Spin Button Value). @ScottHoltzman"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447180634, "post_id": 33636699, "comment_id": 55048252, "body": "well, it could&#39;ve have matter since you don&#39;t use <code>LookAt:=xlWhole</code> when you initially <code>Set = Finder ...</code>. What line of your code do you receive the error you mentioned?"}, {"owner": {"reputation": 125, "user_id": 5196659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPFG4.jpg?s=128&g=1", "display_name": "zickens", "link": "https://stackoverflow.com/users/5196659/zickens"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447180925, "post_id": 33636699, "comment_id": 55048403, "body": "Let me explain the code further: the &quot;Finder&quot; object is just a cell that contains the value that you put in the Form. That cell is in a table in a certain worksheet. What I do in the rest of the code, is to do a series of operations in <b>another</b> worksheet to a certain range that has a guide number equal to the value of Finder. Precisely what I&#39;m doing in this fragment, is retrieving the value of Finder and then looking for it in another Worksheet. I work just fine 5 hours ago; i open it again, try to run the command, and boom; nothing. Get the error above. @ScottHoltzman"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1447181215, "post_id": 33636699, "comment_id": 55048566, "body": "I get what the code is doing. What exact <b>line of code</b> do you receive the error on? And when you <code>Set Finder = </code> do you get the result you expect in terms of value (or say, range.address)?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447181315, "post_id": 33636699, "comment_id": 55048621, "body": "Part of the issue could be the <code>ActiveSheet</code>.  Is your <code>DR</code> worksheet the active one? I would specify which worksheet you need to refer to at this line: <code>With Columns(2)</code> (just before you set <code>Finder</code> the first time) and change that to <code>With [worksheet].Columns(2)</code>...  Also, when you use that Find, try specifying what part of the object you need, i.e. <code>Set Finder = .Find(spinCapituloVal.Value, LookIn:=xlValues, MatchCase:=False).Address</code> or <code>.Row</code>, etc."}, {"owner": {"reputation": 125, "user_id": 5196659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPFG4.jpg?s=128&g=1", "display_name": "zickens", "link": "https://stackoverflow.com/users/5196659/zickens"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447181452, "post_id": 33636699, "comment_id": 55048685, "body": "in the one that says <code>Set capActualGuia = capActual.End(xlDown)</code>. And it throws this error because capActual is <code>Nothing</code>; ergo the .Find method returned <code>Nothing</code> @ScottHoltzman"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447181749, "post_id": 33636699, "comment_id": 55048848, "body": "when you <code>Set capActual = </code> is the value for <code>indiceCapActual</code> what you would expect it to be? And what happens if you open the <code>Find</code> dialogue manually at this line break. That may give you a clue as to why it can&#39;t find the data you say is there. (I.e. - extra spaces or something?)"}, {"owner": {"reputation": 125, "user_id": 5196659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPFG4.jpg?s=128&g=1", "display_name": "zickens", "link": "https://stackoverflow.com/users/5196659/zickens"}, "edited": false, "score": 0, "creation_date": 1447181885, "post_id": 33636699, "comment_id": 55048923, "body": "Yes, its supposed to be a number, but <code>.Find</code> shouldn&#39;t care about that."}, {"owner": {"reputation": 125, "user_id": 5196659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPFG4.jpg?s=128&g=1", "display_name": "zickens", "link": "https://stackoverflow.com/users/5196659/zickens"}, "edited": false, "score": 0, "creation_date": 1447182193, "post_id": 33636699, "comment_id": 55049077, "body": "There is no room for extra spaces, it&#39;s the direct value of the cell."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447182257, "post_id": 33636699, "comment_id": 55049112, "body": "you still did not answer my question: is the value for <code>indiceCapActual</code> what you expect it to be? If you debug the code and check that value is it what you think it should be based on the SpinButton option?"}, {"owner": {"reputation": 125, "user_id": 5196659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPFG4.jpg?s=128&g=1", "display_name": "zickens", "link": "https://stackoverflow.com/users/5196659/zickens"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447182711, "post_id": 33636699, "comment_id": 55049361, "body": "I found what happened, and it seems such ridiculous NONSENSE that I urge Microsoft to fix this. Apparently, I saved the worksheet with a different column width that didn&#39;t allow for the cell to display it&#39;s content properly (column is <code>Fill</code> formatted). After giving the column the proper width again the code ran flawlessly. I am in complete and total confusion with this. This is just... Why in the world would this even happen? Thanks for your help, @ScottHoltzman"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1447190219, "post_id": 33636699, "comment_id": 55053523, "body": "@zickens Please follow my advice. Do not use <code>Find</code>. It&#39;s finicky and slow. Always use Match, which is blazingly fast and does not suffer the quirks that <code>Find</code> does."}], "answers": [{"tags": [], "owner": {"reputation": 125, "user_id": 5196659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPFG4.jpg?s=128&g=1", "display_name": "zickens", "link": "https://stackoverflow.com/users/5196659/zickens"}, "is_accepted": false, "score": 0, "last_activity_date": 1447183284, "creation_date": 1447183284, "answer_id": 33637890, "question_id": 33636699, "link": "https://stackoverflow.com/questions/33636699/find-method-simply-wont-return-anything/33637890#33637890", "title": "&#39;.Find&#39; method simply won&#39;t return anything", "body": "<p>The solution to my problem was a highly unexpected one. The column where I was using the <code>.Find</code> method with <code>capActual</code> didn't have enough width so as to display its contents properly, and this somehow stopped <code>.Find</code>from finding the cell that contained the value. Yes. The column width.</p>\n\n<p>Giving the column enough room to display the contents solved the problem. </p>\n"}], "owner": {"reputation": 125, "user_id": 5196659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPFG4.jpg?s=128&g=1", "display_name": "zickens", "link": "https://stackoverflow.com/users/5196659/zickens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447183284, "creation_date": 1447178982, "last_edit_date": 1447179541, "question_id": 33636699, "link": "https://stackoverflow.com/questions/33636699/find-method-simply-wont-return-anything", "title": "&#39;.Find&#39; method simply won&#39;t return anything", "body": "<p>Essentially my code just finds a certain cell containing an index coordinate provided by a Spin Button from a form. It is just a segment of the whole code, and the whole code worked absolutely perfectly and was fast, before I reopened the code this morning to continue coding. I changed absolutely nothing after I saved the last time, and through some debugging, I've found that the .Find method, for some reason, returns nothing, although the data is there and even if I fill the entire column with the same data it's supposed to find, it won't return anything. Thus the code yields:  </p>\n\n<blockquote>\n  <p>\"object variable or With block variable not set\"  </p>\n</blockquote>\n\n<p>every time it tries to use the object.</p>\n\n<pre><code>Set DR = Worksheets(\"Detalle - Reporte\")\n\nIf spinCapituloVal.Value = 0 Then\n    MsgBox (\"Por favor, introduce un cap\u00edtulo v\u00e1lido\")\n    Exit Sub\nEnd If\n\nWith Columns(2)\nSet Finder = .Find(spinCapituloVal.Value, LookIn:=xlValues, MatchCase:=False)\nEnd With\n\nIf Finder Is Nothing Then\nMsgBox (\"No se encontr\u00f3 el cap\u00edtulo especificado\")\nExit Sub\nEnd If\n\nindiceCapActual = Finder.Value\nindiceCapSiguiente = Finder.Offset(1, 0).Value\n\nIf indiceCapSiguiente = \"\" Then\n\n    With DR.Columns(1)\n        Set capActual = .Find(indiceCapActual, LookIn:=xlValues, MatchCase:=True)\n        Set capActualGuia = capActual.End(xlDown)\n    End With\n\nElse\n\n    With DR.Columns(1)\n        Set capActual = .Find(indiceCapActual, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=True)\n        Set capSiguiente = .Find(indiceCapSiguiente, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=True)\n    End With\n\nEnd If\n</code></pre>\n\n<p>All I want to know is why in the world the .Find method just stopped working, and how can I avoid it in the future?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1447177966, "post_id": 33636222, "comment_id": 55046679, "body": "&quot;I have a scale that is weighing items and entering them into excel&quot; - what exactly does this look like in practice?  What triggers a new entry, and where does each new entry get placed?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1447178418, "post_id": 33636222, "comment_id": 55046940, "body": "Probably by using the <code>Worksheet_Change</code> event, and adding some logic to ignore when the entry == 0 (or whatever an &quot;empty&quot; scale would register in the worksheet)"}, {"owner": {"reputation": 323, "user_id": 2795569, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0bb3af9b5e714d7230bb04ea2b9967f8?s=128&d=identicon&r=PG&f=1", "display_name": "user2795569", "link": "https://stackoverflow.com/users/2795569/user2795569"}, "edited": false, "score": 0, "creation_date": 1447180833, "post_id": 33636222, "comment_id": 55048343, "body": "Tim.  I am running rs232 key software.  Its a &quot;keyboard wedge&quot; software.  It reads the incoming data from the serial port and puts it into the keyboard buffer.  The scale sends data when it senses a new weight and then stabilizes (hence it records loaded and unloaded).  The value gets entered into excel from the keyboard buffer with an &quot;Enter&quot; afterwards.  So in Excel the data is inputted by the rs232 software then it hits enter for me.  I want to delete the &quot;unloaded&quot; rows."}], "answers": [{"comments": [{"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447180489, "post_id": 33636589, "comment_id": 55048166, "body": "If you are talking about my answer, the user just uses the subroutine that he has already found to work.  As for David&#39;s comment, you could have something like:  <code>TempRange=Intersect(Target.Parent.Range(&quot;D:D&quot;), Target)</code> then <code>For Each Cell in TempRange</code> <code>If ABS(Cell.Value)&lt;=0.005 then Cell.EntireRow.Delete</code> etc."}, {"owner": {"reputation": 323, "user_id": 2795569, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0bb3af9b5e714d7230bb04ea2b9967f8?s=128&d=identicon&r=PG&f=1", "display_name": "user2795569", "link": "https://stackoverflow.com/users/2795569/user2795569"}, "edited": false, "score": 0, "creation_date": 1447180637, "post_id": 33636589, "comment_id": 55048253, "body": "This seems to create some sort of endless loop with debug pointing at  &quot;.AutoFilter field:=1, Criteria1:=&quot;&lt;=0.005&quot;, Operator:=xlAnd&quot;  .  The &quot;clean_input_data&quot; code executes fine without the worksheet_change call.  However, thats what I need to automate this."}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1447180824, "post_id": 33636589, "comment_id": 55048339, "body": "Yes,  you&#39;re right.  Sorry about that, I forgot to add something to disable the events.  Please see the revised answer."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447181078, "post_id": 33636589, "comment_id": 55048491, "body": "Ah. I see @Demetri. Sorry, I was thinking &quot;wipe-out&quot; the bad entry on the <code>Worksheet_Change</code> event. +1 for a nice-easy integration :)"}], "tags": [], "owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "is_accepted": true, "score": 2, "last_activity_date": 1447180793, "last_edit_date": 1447180793, "creation_date": 1447178618, "answer_id": 33636589, "question_id": 33636222, "link": "https://stackoverflow.com/questions/33636222/excel-vba-run-on-entry/33636589#33636589", "title": "Excel VBA run on entry", "body": "<p>Try placing the following subroutine in the worksheet tab that contains the measurements:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target.Parent.Range(\"D:D\"), Target) Is Nothing Then\n        Application.EnableEvents = False\n        Run \"clean_input_data\"\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>I just saw David's response now, I think he has a better idea.</p>\n"}], "owner": {"reputation": 323, "user_id": 2795569, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0bb3af9b5e714d7230bb04ea2b9967f8?s=128&d=identicon&r=PG&f=1", "display_name": "user2795569", "link": "https://stackoverflow.com/users/2795569/user2795569"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 505, "favorite_count": 0, "accepted_answer_id": 33636589, "answer_count": 1, "score": 1, "last_activity_date": 1447180793, "creation_date": 1447177375, "last_edit_date": 1447178802, "question_id": 33636222, "link": "https://stackoverflow.com/questions/33636222/excel-vba-run-on-entry", "title": "Excel VBA run on entry", "body": "<p>Ive never written anything in VBA.  I have a scale that is weighing items and entering them into excel.  However, it takes a reading when I weigh something and then it also records a reading when the scale is empty between weighings.  Im trying to get rid of the empty reading in column D.  It really needs to happen on every entry into the spreadsheet.</p>\n\n<p>This code works if I run it manually.  How do I wrap it so that it executes automatically?  Also, please be deliberate in explaining how to activate the code.  For whatever reason its not clear from my internet searches.</p>\n\n<pre><code>Sub clean_input_data()\nDim i As Long\n\nWith Application\n    .ScreenUpdating = False\n    .DisplayAlerts = False\nEnd With\n\nWith ActiveSheet\n    If .AutoFilterMode Then .AutoFilterMode = False\n    i = .Range(\"D\" &amp; Rows.Count).End(xlUp).row\n    If i &lt; 2 Then\n        MsgBox \"No data found, macro exiting\"\n        Exit Sub\n    Else\n        With .Range(\"D1:D\" &amp; i)\n            .AutoFilter\n            .AutoFilter field:=1, Criteria1:=\"&lt;=0.005\", Operator:=xlAnd\n        End With\n    End If\n    .UsedRange.Offset(1, 0).SpecialCells(xlCellTypeVisible).Rows.Delete\n    .AutoFilterMode = False\nEnd With\n\n\nWith Application\n    .ScreenUpdating = True\n    .DisplayAlerts = True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Thanks so much</p>\n"}, {"tags": ["excel", "activex", "userform", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1015, "user_id": 3390169, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/70879b968ccc50066cc074bc87add7f0?s=128&d=identicon&r=PG&f=1", "display_name": "user3390169", "link": "https://stackoverflow.com/users/3390169/user3390169"}, "edited": false, "score": 0, "creation_date": 1447182241, "post_id": 33636262, "comment_id": 55049100, "body": "Weird.  When I open the file on my old machine, the box for Microsoft Forms 2.0 Object Library is checked as well as the one for Microsoft Office Web Components 11.0.  When I open it on the new computer, those boxes are not checked.  Even after I check them, I still have the same problem."}, {"owner": {"reputation": 2014, "user_id": 5521857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2wZP7.jpg?s=128&g=1", "display_name": "PGilm", "link": "https://stackoverflow.com/users/5521857/pgilm"}, "reply_to_user": {"reputation": 1015, "user_id": 3390169, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/70879b968ccc50066cc074bc87add7f0?s=128&d=identicon&r=PG&f=1", "display_name": "user3390169", "link": "https://stackoverflow.com/users/3390169/user3390169"}, "edited": false, "score": 0, "creation_date": 1447186545, "post_id": 33636262, "comment_id": 55051538, "body": "After checking them, you may have to exit and restart the application(s).  Also, try deleting those pesky MSForms.exd files from wherever you can find them while the app(s) are all closed, and then restart."}, {"owner": {"reputation": 1015, "user_id": 3390169, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/70879b968ccc50066cc074bc87add7f0?s=128&d=identicon&r=PG&f=1", "display_name": "user3390169", "link": "https://stackoverflow.com/users/3390169/user3390169"}, "edited": false, "score": 0, "creation_date": 1447195718, "post_id": 33636262, "comment_id": 55056291, "body": "Thanks for the suggestion, I tried both of those things and it still won&#39;t work."}], "tags": [], "owner": {"reputation": 2014, "user_id": 5521857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2wZP7.jpg?s=128&g=1", "display_name": "PGilm", "link": "https://stackoverflow.com/users/5521857/pgilm"}, "is_accepted": false, "score": 0, "last_activity_date": 1447177479, "creation_date": 1447177479, "answer_id": 33636262, "question_id": 33636000, "link": "https://stackoverflow.com/questions/33636000/userform-activex-controls-not-working-on-new-machine/33636262#33636262", "title": "UserForm ActiveX controls not working on new machine", "body": "<p>Add a reference to <code>Microsoft Forms 2.0 Object Library</code> (found as <code>FM20.dll</code>)</p>\n\n<p>Hth</p>\n"}], "owner": {"reputation": 1015, "user_id": 3390169, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/70879b968ccc50066cc074bc87add7f0?s=128&d=identicon&r=PG&f=1", "display_name": "user3390169", "link": "https://stackoverflow.com/users/3390169/user3390169"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 785, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447177479, "creation_date": 1447176536, "last_edit_date": 1531161705, "question_id": 33636000, "link": "https://stackoverflow.com/questions/33636000/userform-activex-controls-not-working-on-new-machine", "title": "UserForm ActiveX controls not working on new machine", "body": "<p>I built a workbook in Excel on my old machine that has a bunch of UserForms in it.  One of the UserForms has an ActiveX spreadsheet control in it.  This allows me to enter spreadsheet data into the UserForm.  My old computer recently crashed so my IT department gave me a new machine that is running the same system (Microsoft Office 2010).  Now, when I open the spreadsheet, I get:  </p>\n\n<blockquote>\n  <p>Could not load some objects because they are not available on this machine.</p>\n</blockquote>\n\n<p>I Googled this error and read through a number of pages.  The first thing to try was installing Microsoft Office Web Components 11.0.  Weirdly, this allows me to add a spreadsheet control to any UserForm I want to but I still cannot open the original sheet with all of its controls still in it.</p>\n\n<p>Next, I tried <a href=\"https://stackoverflow.com/questions/27411399/microsoft-excel-activex-controls-disabled\">these instructions</a> but got no results.</p>\n\n<p>Does anybody have any ideas?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1447177298, "post_id": 33635935, "comment_id": 55046293, "body": "will it always be a sum formula?"}, {"owner": {"reputation": 638, "user_id": 3493459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/75314fffaef2605559ee466fa02b6bb6?s=128&d=identicon&r=PG&f=1", "display_name": "Blankdud", "link": "https://stackoverflow.com/users/3493459/blankdud"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1447177455, "post_id": 33635935, "comment_id": 55046375, "body": "@SiddharthRout As things stand right now, yes, it will always be a SUM."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1447180279, "post_id": 33635935, "comment_id": 55048051, "body": "++ Good Question! Had me thinking for quite some time"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447181078, "post_id": 33635935, "comment_id": 55048490, "body": "This was a good question; well stated, thought out, and you showed what you&#39;re expecting.  Nicely done!"}], "answers": [{"comments": [{"owner": {"reputation": 638, "user_id": 3493459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/75314fffaef2605559ee466fa02b6bb6?s=128&d=identicon&r=PG&f=1", "display_name": "Blankdud", "link": "https://stackoverflow.com/users/3493459/blankdud"}, "edited": false, "score": 0, "creation_date": 1447178405, "post_id": 33636476, "comment_id": 55046931, "body": "This is extremely close to what I was looking for. I was/am actually in the process of super-googling the indirect method you mentioned to use them more directly. That would be the most ideal situation for me, though this could also work."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 638, "user_id": 3493459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/75314fffaef2605559ee466fa02b6bb6?s=128&d=identicon&r=PG&f=1", "display_name": "Blankdud", "link": "https://stackoverflow.com/users/3493459/blankdud"}, "edited": false, "score": 0, "creation_date": 1447178529, "post_id": 33636476, "comment_id": 55047023, "body": "@Blankdud - I just edited my post with a more robust formula.  It&#39;s not <code>Indirect()</code> but, as far as I can tell, it should work for you.  Note: If your variable names are more than two digits, you&#39;ll need to tweak the <code>Mid()</code> formulas to return <code>3</code> places, not <code>2</code>."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1447179784, "last_edit_date": 1592644375, "creation_date": 1447178183, "answer_id": 33636476, "question_id": 33635935, "link": "https://stackoverflow.com/questions/33635935/string-formula-with-variables-in-same-sheet/33636476#33636476", "title": "String formula with variables in same sheet", "body": "<p>I have tried to use a more dynamic solution, using a <code>Vlookup</code> to find the values to add together.</p>\n<p>Here's how I have the data (Note the formula shown is old, see edit):</p>\n<p><a href=\"https://i.stack.imgur.com/MdYIP.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MdYIP.jpg\" alt=\"enter image description here\" /></a></p>\n<p>The first two answer blocks are (respectively):</p>\n<p><code>=SUM(VLOOKUP(&quot;Az&quot;,$A$2:$D$6,column(),FALSE)+(VLOOKUP(&quot;Cx&quot;,$A$2:$D$6,column(),FALSE)/2))</code>\n<code>=SUM(VLOOKUP(&quot;By&quot;,$A$2:$D$6,column(),FALSE)+(VLOOKUP(&quot;Ev&quot;,$A$2:$D$6,column(),FALSE)/VLOOKUP(&quot;Dw&quot;,$A$2:$D$6,column(),FALSE)))</code></p>\n<p>...and drag over.</p>\n<p>But I realize you're looking, in the end, to be able to perhaps more quickly edit the formula variables, so my second two answers (rows 11 and 12) use the column F, G, and H to look for the variable:</p>\n<p><code>=SUM(VLOOKUP($F$11,$A$2:$D$6,COLUMN(),FALSE)+(VLOOKUP($G$11,$A$2:$D$6,COLUMN(),FALSE)/2))</code><br />\nand\n<code>=SUM(VLOOKUP($F$12,$A$2:$D$6,COLUMN(),FALSE)+(VLOOKUP($G$12,$A$2:$D$6,COLUMN(),FALSE)/VLOOKUP($H$12,$A$2:$D$6,COLUMN(),FALSE)))</code></p>\n<p>Does that kind of get you where you wanted? I'm trying to think of a way using perhaps <code>indirect()</code> ro use <code>E8</code> and <code>E9</code> more directly, so if you edit that formulas, the others change too...</p>\n<p><strong>Edit</strong> - Here's the &quot;best&quot;  solution, insofar as all you need to do is edit the variable names in <code>E8</code> and <code>E9</code> and the formula will update itself.  (If you follow my layout above), in <code>B8</code> use\n<code>=SUM(VLOOKUP(MID($E$8,SEARCH(&quot;(&quot;,$E$8)+1,2),$A$2:$D$6,COLUMN(),FALSE)+(VLOOKUP(MID($E$8,SEARCH(&quot;+(&quot;,$E$8)+2,2),$A$2:$D$6,COLUMN(),FALSE)/2))</code></p>\n<p>and in <code>B9</code>,\n<code>=SUM(VLOOKUP(MID($E$9,SEARCH(&quot;(&quot;,$E$9)+1,2),$A$2:$D$6,COLUMN(),FALSE)+(VLOOKUP(MID($E$9,SEARCH(&quot;+(&quot;,$E$9)+2,2),$A$2:$D$6,COLUMN(),FALSE)/VLOOKUP(MID($E$9,SEARCH(&quot;/&quot;,$E$9)+1,2),$A$2:$D$6,COLUMN(),FALSE)))</code></p>\n<p>That way, if you want to sum, say <code>Sum(Cx+(Ev/2))</code> all you have to do is edit <code>E8</code> to that formula, and the answer1 in <code>B8</code> will update itself.</p>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447179918, "post_id": 33636842, "comment_id": 55047838, "body": "Ahhh, clever thinking...gets rid of having to use a convoluted formula.  Also, +1 for me as I&#39;ve never seen the &quot;Create Names&quot; popup, nice to know!"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447180398, "post_id": 33636842, "comment_id": 55048116, "body": "@BruceWayne, Thanks, the only possible issue I see is that the names are create at the workbook level, and it may be an issue if there are other similar worksheets..."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447180421, "post_id": 33636842, "comment_id": 55048127, "body": "@SiddhartRout Thanks.. Nevertheless, it can be workout by creating the names at worksheet level. Will add this to the answer now..."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447180470, "post_id": 33636842, "comment_id": 55048157, "body": "I was just about to post a vba resolution, but this is nice, and much easier."}, {"owner": {"reputation": 638, "user_id": 3493459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/75314fffaef2605559ee466fa02b6bb6?s=128&d=identicon&r=PG&f=1", "display_name": "Blankdud", "link": "https://stackoverflow.com/users/3493459/blankdud"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1447180591, "post_id": 33636842, "comment_id": 55048226, "body": "@SiddharthRout This is awesome. Clean, simple, and newbie friendly. Thanks so much EEM, and everyone else who took the time to help out."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 638, "user_id": 3493459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/75314fffaef2605559ee466fa02b6bb6?s=128&d=identicon&r=PG&f=1", "display_name": "Blankdud", "link": "https://stackoverflow.com/users/3493459/blankdud"}, "edited": false, "score": 0, "creation_date": 1447180754, "post_id": 33636842, "comment_id": 55048304, "body": "@Blankdud most welcome, you initiate all with a very creative question."}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 4, "last_activity_date": 1447180522, "last_edit_date": 1447180522, "creation_date": 1447179538, "answer_id": 33636842, "question_id": 33635935, "link": "https://stackoverflow.com/questions/33635935/string-formula-with-variables-in-same-sheet/33636842#33636842", "title": "String formula with variables in same sheet", "body": "<p>Used Defined Names and your formulas as they are actually written.</p>\n\n<p>Select all rows with data starting from Column <code>A</code>\nThen click on main tab Formulas\\in the group Defined names click on Create from Selection</p>\n\n<p><a href=\"https://i.stack.imgur.com/tX3K1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tX3K1.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then copy your formulas to the corresponding columns in row 8 and 9</p>\n\n<p><a href=\"https://i.stack.imgur.com/YJBiQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YJBiQ.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/9g8hk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9g8hk.png\" alt=\"enter image description here\"></a></p>\n\n<p>Note that the defined names Created from selection are added at workbook level, and it may be an issue if there are other similar worksheets... This can be workout by creating the names at worksheet level, using the Define name option instead.</p>\n\n<p>using the </p>\n"}], "owner": {"reputation": 638, "user_id": 3493459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/75314fffaef2605559ee466fa02b6bb6?s=128&d=identicon&r=PG&f=1", "display_name": "Blankdud", "link": "https://stackoverflow.com/users/3493459/blankdud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 2, "accepted_answer_id": 33636842, "answer_count": 2, "score": 4, "last_activity_date": 1447184662, "creation_date": 1447176295, "last_edit_date": 1531161705, "question_id": 33635935, "link": "https://stackoverflow.com/questions/33635935/string-formula-with-variables-in-same-sheet", "title": "String formula with variables in same sheet", "body": "<p>I'm relatively new to excel formulas so I don't know the best way to approach this, or word it to find a good answer through the search.</p>\n\n<p>I have the following data:</p>\n\n<h2><a href=\"https://i.stack.imgur.com/p6gFk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p6gFk.png\" alt=\"enter image description here\"></a></h2>\n\n<p>I want to take the formula string that is contained in the E column for each row, replace variables with data that are in the same row and evaluate the expression. I have no idea if this is even possible, but I'm willing to try VB Macros or whatever is needed.</p>\n\n<p>Using the above thinking:<br>\n     B8 = SUM(4 + (8 / 2))<br>\n     B9 = SUM(5 + (6 / 2))<br>\n     C8 = SUM(5 + (6 / 2))<br>\n     etc...</p>\n\n<p>If this ISN'T possible, my real overarching goal here is to just have a single location for the formula. I will have much more than 3 columns of data so being able to update it in one location would be perfect for me. Any help is appreciated.</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1447176614, "post_id": 33635903, "comment_id": 55045891, "body": "Did you verify the existence of <code>hiddensheet1</code>? Anyway, you must step into the debugger and identify the line where the <code>out of range</code> error occurs."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1447176819, "post_id": 33635903, "comment_id": 55046011, "body": "Yep, step through this line by line using F8 in debugging mode, and you&#39;ll probably see that it&#39;s not the UserForm itself which is &quot;out of range&quot;, but rather some other named parameter, like <code>Sheets(&quot;hiddensheet1&quot;)</code>. You may also try qualifying to <code>ThisWorkbook.Sheets(&quot;hiddensheet1&quot;)</code>."}, {"owner": {"reputation": 11, "user_id": 5420731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d67a6e71a979a409c408189a28f709?s=128&d=identicon&r=PG&f=1", "display_name": "oBritton", "link": "https://stackoverflow.com/users/5420731/obritton"}, "edited": false, "score": 0, "creation_date": 1447190674, "post_id": 33635903, "comment_id": 55053769, "body": "I&#39;ll be derned; yall are right. Somehow the hidden sheet got deleted, and it gets referred to before I check its existence and create it if missing. Thanks guys; I was barking up totally the wrong tree. Fixed and working."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5420731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d67a6e71a979a409c408189a28f709?s=128&d=identicon&r=PG&f=1", "display_name": "oBritton", "link": "https://stackoverflow.com/users/5420731/obritton"}, "is_accepted": false, "score": 0, "last_activity_date": 1447190912, "creation_date": 1447190912, "answer_id": 33639954, "question_id": 33635903, "link": "https://stackoverflow.com/questions/33635903/vba-wont-call-userform-from-inside-its-own-workbook/33639954#33639954", "title": "VBA won&#39;t call UserForm from inside its own workbook", "body": "<p>Somehow the hidden sheet got deleted, and it gets referred to before I check its existence and create it if missing. Thanks guys; I was barking up totally the wrong tree. Fixed and working. </p>\n\n<p>Nothing was wrong with the calling of the userform at all. </p>\n"}], "owner": {"reputation": 11, "user_id": 5420731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d67a6e71a979a409c408189a28f709?s=128&d=identicon&r=PG&f=1", "display_name": "oBritton", "link": "https://stackoverflow.com/users/5420731/obritton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 264, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1447190912, "creation_date": 1447176174, "last_edit_date": 1447176452, "question_id": 33635903, "link": "https://stackoverflow.com/questions/33635903/vba-wont-call-userform-from-inside-its-own-workbook", "title": "VBA won&#39;t call UserForm from inside its own workbook", "body": "<p>I have a CMD button on my sheet with the following code:</p>\n\n<pre><code>Private Sub cmdBlastoff_Click()\n  UserForm2.Show vbModeless           'launch gateway userform\nEnd Sub\n</code></pre>\n\n<p>This code worked for a long time, but is now generating \"Error 9: Subscript out of range.\"</p>\n\n<p>The userform I am trying to call (UserForm2) is located in the same workbook.</p>\n\n<p>I will put the full code of the userform below in case it's relevant, but the code in its Userform_initialize sub is:</p>\n\n<pre><code>Private Sub userform_initialize()\n    Sheets(\"hiddensheet1\").Range(\"B5\").Value = \"v7.04\"      'sets version # in hidden sheet\n    FileNameChecker_local                                   'runs a sub (located below in the userform module) to determine the filename and path\n    ValueInjector                                           'runs a sub (located below in the userform module) to put some values into text fields on the userform\n    cmdBigGo.Font.Size = 15                                 'sets font size of a button\nEnd Sub\n</code></pre>\n\n<p>As I said earlier, this was working until recently and I am out of ideas. \nSo far I have tried:</p>\n\n<ul>\n<li>1) Finding some way to explicitly point to the exact location of\nuserform2 by specifying the workbook in front of it:\n<code>ActiveWorkbook.UserForm2.show</code> (doesn't work for reasons that are\nnow obvious) I regard a more explicit call as the most likely fix,\nbut don't know how to do it</li>\n<li>2) Removing <code>vbModeless</code> from the call button call</li>\n<li>3) Explicitly setting the <code>ActiveWorkbook</code> to the one all my stuff is\nstored on, which is where the call button sits (this shouldn't be\nnecessary, I know)</li>\n</ul>\n\n<p>Any other ideas?</p>\n\n<p>Full code of the UserForm2 (probably not relevant, all working prior to this problem arising):</p>\n\n<pre><code>Private Declare Function URLDownloadToFile Lib \"urlmon\" Alias \"URLDownloadToFileA\" _\n    (ByVal pCaller As Long, _\n    ByVal szURL As String, _\n    ByVal szFileName As String, _\n    ByVal dwReserved As Long, _\n    ByVal lpfnCB As Long) As Long\n\n'should check to see if there is an output folder in the directory where COGENT sits and if not create it\n'should pull default filepath to the outputs folder from the hiddensheet\n'should call data baster on terminate\n'DONE   should allow the user to change the default save location\n'DONE   should allow them to change the save location THIS time.\n'DONE   should pull filepath from hiddensheet, check against original (?) and\n'DONE   Should create a default filename\n\n\n    Public strFileFullName As String\n    Public strFileJustPath As String\n    Public strUserFolderName As String\n    Public strFileName As String\n    Public strRawDate As String\n\n    Public strDLlink As String\n    Public strDLdest As String\n    Public strDLlocalName As String\n    Public strDLNameOnWeb As String\n\n    Public strOpenURLPointer As String\n    Dim strSaveAsErrHandler As String\n    Dim strQueryID As String\n\n\nPrivate Sub userform_initialize()\n    Sheets(\"hiddensheet1\").Range(\"B5\").Value = \"v7.04\"      'sets version # in hidden sheet\n    FileNameChecker_local                                   'runs a sub (located below in the userform module) to determine the filename and path\n    ValueInjector                                           'runs a sub (located below in the userform module) to put some values into text fields on the userform\n    cmdBigGo.Font.Size = 15                                 'sets font size of a button\nEnd Sub\n\n\nPrivate Sub chkCyberDiv_Click()\n    If chkCyberDiv.Value = True Then\n        '==Cyber OUs visible==\n        chkNDIO.Visible = True\n        txtQueryID.Value = \"169436\"\n\n        '==Other Div OUs invisible==\n        chkCivilDiv.Value = False\n    Else\n        chkNDIO.Visible = False\n    End If\nEnd Sub\nPrivate Sub chkCivilDiv_Click()\n    If chkCivilDiv.Value = True Then\n        '==Civil OUs visible==\n        chkCivilInfoSys.Visible = True\n\n        '==Other Div OUs invisible==\n        chkCyberDiv.Value = False\n    Else\n        chkCivilInfoSys.Visible = False\n    End If\nEnd Sub\n\nSub cmdBigGo_Click()\n    '==========Check if SaveAsNewName worked and if not kill sub==========\n        SaveAsNewName\n            If strSaveAsErrHandler = \"Filename/path not viable.\" Then\n                MsgBox strSaveAsErrHandler\n                Exit Sub\n            Else\n    '==========Startup==========\n    Application.ScreenUpdating = False\n    Sheets(\"LoadingData\").Visible = True\n    Sheets(\"Launchpad\").Visible = False\n\n        '==========Check for/create Temp Directory==========\n            If FileFolderExists(strFileJustPath &amp; \"\\temp\") = True Then\n                'MsgBox \"temp Folder already exists.\"\n            Else\n                MkDir strFileJustPath &amp; \"\\temp\"\n                'MsgBox \"temp Folder didn't exist, but it do now.\"\n            End If\n\n        '==========Download Section==========\n            '=====Set up=====                                        'big gap for now =          169436\n                strQueryID = txtQueryID.Value\n                strDLlink = \"https://workbench.northgrum.com/xauth/login.aspx?&amp;ActionPageID=37&amp;ActionParameters=QueryID%3d\" &amp; strQueryID &amp; \"%26View%3d0%26OutputToExcel%3d1\"\n                strDLdest = strFileJustPath &amp; \"\\temp\\dump.xlsx\"\n\n            '=====Run=====\n                'MsgBox \"cmdBigGo thinks strDLdest = \" &amp; strDLdest\n                Dim done\n                done = URLDownloadToFile(0, strDLlink, strDLdest, 0, 0)\n\n    '==========Copy Targets from temp file==========\n         Sheets(\"LoadingData\").Select\n         copyPathName = strFileJustPath &amp; \"\\temp\\\"\n         copyFileName = \"dump.xlsx\"\n         copyTabName = \"Targets\"\n         ControlFile = ActiveWorkbook.Name\n         Workbooks.Open FileName:=copyPathName &amp; \"\\\" &amp; copyFileName\n         ActiveSheet.Name = copyTabName\n         Sheets(copyTabName).Copy After:=Workbooks(ControlFile).Sheets(1)\n         Windows(copyFileName).Activate\n         ActiveWorkbook.Close SaveChanges:=False\n         Windows(ControlFile).Activate\n         ActiveWorkbook.Sheets(\"Targets\").Name = \"COGENT Targets\"\n         '^source: https://msdn.microsoft.com/en-us/library/office/ff194819.aspx\n\n    '==========Delete Temp Directory==========\n         On Error Resume Next\n         Kill copyPathName &amp; \"\\*.*\"    ' delete all files in the folder\n         RmDir copyPathName  ' delete folder\n         On Error GoTo 0\n\n    '==========Create Userform1 Button on \"Targets\"==========\n        Rows(\"1:1\").RowHeight = 26\n        Dim btnCOGENT As Button\n        Set btnCOGENT = Sheets(\"COGENT Targets\").Buttons.Add(10.5, 4.5, 84.75, 19.5)\n        With btnCOGENT\n            .OnAction = \"CallUserform1\"\n            .Characters.Text = \"COGENT\"\n        End With\n        With btnCOGENT.Characters(Start:=1, Length:=6).Font\n            .Name = \"Calibri\"\n            .FontStyle = \"Regular\"\n            .Size = 11\n            .Strikethrough = False\n            .Superscript = False\n            .Subscript = False\n            .OutlineFont = False\n            .Shadow = False\n            .Underline = xlUnderlineStyleNone\n            .ColorIndex = 1\n        End With\n        Sheets(\"COGENT Targets\").Shapes(\"Button 1\").ScaleWidth 0.7433628319, msoFalse, _\n            msoScaleFromTopLeft\n\n    '==========Finish up==========\n         Worksheets(\"COGENT Targets\").Activate\n         Sheets(\"LoadingData\").Visible = False\n         Application.ScreenUpdating = True\n    End If\n        UserForm1.Show vbModeless\n    End Sub\n\nPrivate Sub SaveAsNewName()\n\n    strSaveAsErrHandler = \"\"\n    On Error GoTo ErrorHandler\n\n    '==========Save the file with a new name==========\n        Dim strExpectedFileFullName As String\n        strExpectedFileFullName = txtFilePath.Value &amp; \"\\\" &amp; txtFileName &amp; \".xlsm\"\n        ActiveWorkbook.SaveAs strExpectedFileFullName\n        FileNameChecker_local                                   'get the new filename\n\n    Exit Sub\nErrorHandler:\n    '==========Error Handler==========\n    If Err.Number = 1004 Then\n        lblSaveAsText.Caption = \"That name and location didn't work... Try using 'Browse' or 'Create Outbox.\"\n        lblSaveAsText.BackColor = &amp;H8080FF\n        strSaveAsErrHandler = \"Filename/path not viable.\"\n    Else\n        MsgBox \"unknown error...email Owen.Britton@NGC.com; it's probably his fault.\"\n        strSaveAsErrHandler = \"\"\n    End If\n\nEnd Sub\n\n\n\n\n\nSub FileNameChecker_local()\n\n\n    '==========Check Filename and SaveAs if needed==========\n\n    strFileJustPath = ActiveWorkbook.Path\n    strFileFullName = ActiveWorkbook.FullName\n\n        '==========Get Filename==========\n            Dim i As Integer\n            Dim intBackSlash As Integer, intPoint As Integer\n            For i = Len(strFileFullName) To 1 Step -1\n              If Mid$(strFileFullName, i, 1) = \".\" Then\n                intPoint = i\n                Exit For\n              End If\n            Next i\n            If intPoint = 0 Then intPoint = Len(strFileFullName) + 1\n            For i = intPoint - 1 To 1 Step -1\n              If Mid$(strFileFullName, i, 1) = \"\\\" Then\n                intBackSlash = i\n                Exit For\n              End If\n            Next i\n            strFileName = Mid$(strFileFullName, intBackSlash + 1, intPoint - intBackSlash - 1)\n           'MsgBox \"strFileName = \" &amp; strFileName &amp; vbNewLine &amp; _\n                    \"strFileJustPath = \" &amp; strFileJustPath &amp; vbNewLine &amp; _\n                    \"strFileFullName = \" &amp; strFileFullName &amp; vbNewLine &amp; _\n                    \"ran from userform2\"\nEnd Sub\nPrivate Sub ValueInjector()\n\n    strRawDate = Format(Date, \"mm-d-yy\")\n\n    '==========Inject File Name==========\n        If strFileName = \"COGENT Launchpad\" Then\n            txtFileName.Value = \"COGENT_Pull_\" &amp; strRawDate            'might be better to include query number\\\n            lblSaveAsText.Caption = \"Give your output a descriptive name. Here's a suggestion:\"\n           Else\n            'txtFileName.Value = strFileName\n            lblSaveAsText.Caption = \"This file should be named 'COGENT Launchpad.' Some features break if you rename it.\"\n            lblSaveAsText.BackColor = &amp;H8080FF\n            'MsgBox \"Please rename this file 'COGENT Launchpad'\"\n        End If\n\n    '==========Inject File Path==========\n    Application.ScreenUpdating = False\n     If IsEmpty(Worksheets(\"Hiddensheet1\").Range(\"B6\")) Then\n            cmdCreateOutbox_click\n            Worksheets(\"Hiddensheet1\").Range(\"B6\") = strFileJustPath &amp; \"\\Outbox\"\n            txtFilePath.Value = Worksheets(\"Hiddensheet1\").Range(\"B6\")\n        Else\n            txtFilePath.Value = Worksheets(\"Hiddensheet1\").Range(\"B6\")\n        End If\n    Application.ScreenUpdating = True\n    Worksheets(\"Launchpad\").Activate\n\nEnd Sub\n\n\nPrivate Sub cmdBrowse_Click()\n    FileNameChecker_local\n    GetFolder (strFileJustPath)\n\nEnd Sub\nPrivate Sub cmdMakeDefault_Click()\n    Worksheets(\"Hiddensheet1\").Range(\"B6\") = txtFilePath.Value\n    imgCheckMark.Visible = True\nEnd Sub\nPrivate Sub cmdCreateOutbox_click()\n    'MsgBox \"looking for\" &amp; strFileJustPath &amp; \"\\Outbox\"\n\n     If FileFolderExists(strFileJustPath &amp; \"\\Outbox\") Then\n        MsgBox \"Outbox Folder already exists.\"\n    Else\n        MsgBox \"Outbox Folder did not exist, but it does now.\"\n        MkDir strFileJustPath &amp; \"\\Outbox\"\n        txtFilePath.Value = strFileJustPath &amp; \"\\Outbox\"\n    End If\n\nEnd Sub\n\n\nFunction GetFolder(strFilePath As String) As String\n\n    Dim fldr As FileDialog\n    Dim strGetFolderOutput As String\n\n    Set fldr = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With fldr\n        .Title = \"Select a Folder\"\n        .AllowMultiSelect = False\n        .InitialFileName = strFilePath\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        strGetFolderOutput = .SelectedItems(1)\n    End With\nNextCode:\n    GetFolder = strGetFolderOutput\n    txtFilePath.Value = strGetFolderOutput\n    Set fldr = Nothing\nEnd Function\n\n\nPrivate Sub userform_terminate()\n    Unload Me\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447175462, "post_id": 33635632, "comment_id": 55045152, "body": "why a vba function? A formula will work just as easily as well. <code>=Right(A5,1)+1</code> to increment last digit by 1 then you can concatenate that to a string. Otherwise, if you really need &#39;vba&#39; please post your coding efforts and where you are stuck <a href=\"http://stackoverflow.com/help/how-to-ask\">see How to Ask</a>"}, {"owner": {"reputation": 2182, "user_id": 3230146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e16f58dd24d4f673ddda1e32ce21b79?s=128&d=identicon&r=PG&f=1", "display_name": "Joel", "link": "https://stackoverflow.com/users/3230146/joel"}, "edited": false, "score": 0, "creation_date": 1447175752, "post_id": 33635632, "comment_id": 55045362, "body": "Please show us what you have tried so far so that we can help you. The purpose of StackOverflow is to help if you&#39;re struggling, but no one will do the work for you."}, {"owner": {"reputation": 47, "user_id": 4686429, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8912e3a335138f9636e1af30e30f94c8?s=128&d=identicon&r=PG&f=1", "display_name": "Techie2015", "link": "https://stackoverflow.com/users/4686429/techie2015"}, "edited": false, "score": 0, "creation_date": 1447175982, "post_id": 33635632, "comment_id": 55045493, "body": "I have a userform attached to a worikbook. New asset information is added to the worksheet via a macro written in vb. Over time, the worksheet will have hundreds of rows of data. Column &quot;A&quot; contains the asset IDs. Using VB, I need to determine the last value at the bottom of column A, increment it by one, and return that value."}, {"owner": {"reputation": 47, "user_id": 4686429, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8912e3a335138f9636e1af30e30f94c8?s=128&d=identicon&r=PG&f=1", "display_name": "Techie2015", "link": "https://stackoverflow.com/users/4686429/techie2015"}, "edited": false, "score": 0, "creation_date": 1447176495, "post_id": 33635632, "comment_id": 55045819, "body": "Function GenerateAssetID() As String return .Cells(.Rows.Count, &quot;A&quot;).End(xlDown).Row End Function"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447178274, "post_id": 33635632, "comment_id": 55046844, "body": "If you mean these ID&#39;s to be relevant long-term then generating each new one based off the &quot;last&quot; one in the list is not a good approach.  Use (eg) a named range to store the sequence number, and increment that each time you create a new ID.  As soon as you need to move items, delete items, or resort your data you&#39;ll find that approach has lots of advantages."}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1447176692, "creation_date": 1447176692, "answer_id": 33636050, "question_id": 33635632, "link": "https://stackoverflow.com/questions/33635632/generate-alphanumeric-id-from-column-a/33636050#33636050", "title": "Generate alphanumeric ID from column A", "body": "<pre><code>Sub New_ID()\n\n    Dim rLastValue As Range\n    Dim alpha As String\n    Dim numeric As Long\n\n    Set rLastValue = Sheet1.Range(\"A1\").End(xlDown)\n    alpha = Left(rLastValue, 1)\n    numeric = Val(Replace(rLastValue, alpha, \"\")) + 1\n\n    rLastValue.Offset(1) = alpha &amp; Format(numeric, \"0000\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 4686429, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8912e3a335138f9636e1af30e30f94c8?s=128&d=identicon&r=PG&f=1", "display_name": "Techie2015", "link": "https://stackoverflow.com/users/4686429/techie2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1320, "favorite_count": 0, "accepted_answer_id": 33636050, "answer_count": 1, "score": -3, "last_activity_date": 1447176692, "creation_date": 1447175358, "question_id": 33635632, "link": "https://stackoverflow.com/questions/33635632/generate-alphanumeric-id-from-column-a", "title": "Generate alphanumeric ID from column A", "body": "<p>I have an Excel workbook containing a macro. The workbook contains a single worksheet where each row contains information on a particular asset; each row begins with an asset id. The asset id is composed of the letter \"A\" followed by followed by five numbers. Whenever a new asset is added to the worksheet, a unique asset ID should be included in the new row of data. For example, the last row has an asset ID of \"A0006 \". I need a function written in vb that when called will read the last value in the asset id column (Column \"A\"), increment that value by one, and return the alphanumeric string. If the function were called now, it should return a value of \"A0007\".</p>\n"}, {"tags": ["vba", "function"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1447174483, "post_id": 33635236, "comment_id": 55044471, "body": "It works fine for me, what value of Title is causing the issue?  Also you could use split(title,&quot;_&quot;) and then return ubound of the array produced."}, {"owner": {"reputation": 143, "user_id": 4288062, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/88928ecaf192be3c161243187a4af318?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Koefoed", "link": "https://stackoverflow.com/users/4288062/sebastian-koefoed"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1447241790, "post_id": 33635236, "comment_id": 55072840, "body": "Thanks, I tried this, but I got the value 1 instead of the value. See the code I tried in original question, Findsite_Function2"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1447251240, "post_id": 33635236, "comment_id": 55077999, "body": "You need to ref the array at the point of ubound, so SplitTitle(UBound(SplitTitle))"}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 4288062, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/88928ecaf192be3c161243187a4af318?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Koefoed", "link": "https://stackoverflow.com/users/4288062/sebastian-koefoed"}, "edited": false, "score": 0, "creation_date": 1447241139, "post_id": 33635337, "comment_id": 55072482, "body": "I tried the work arounds, but I could not get it to work. What should I be looking for in the references list?"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1447242996, "last_edit_date": 1447242996, "creation_date": 1447174502, "answer_id": 33635337, "question_id": 33635236, "link": "https://stackoverflow.com/questions/33635236/vba-function-with-right-function/33635337#33635337", "title": "VBA function with right function", "body": "<p>This could be the bizarre manifestation of a missing reference in your project. Have a look at your project references list (Tools -> References).</p>\n\n<p>You can work around this using <code>VBA.Right</code>, or the older <code>Right$</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1447175310, "creation_date": 1447175310, "answer_id": 33635608, "question_id": 33635236, "link": "https://stackoverflow.com/questions/33635236/vba-function-with-right-function/33635608#33635608", "title": "VBA function with right function", "body": "<p>Wild guess, but it is <strong>probable that you have something else called <code>FindSite</code> in your scope</strong></p>\n\n<p>So change the name to <code>FindSite_Function</code> and try again! ;)</p>\n"}], "owner": {"reputation": 143, "user_id": 4288062, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/88928ecaf192be3c161243187a4af318?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Koefoed", "link": "https://stackoverflow.com/users/4288062/sebastian-koefoed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 33635608, "answer_count": 2, "score": 1, "last_activity_date": 1447242996, "creation_date": 1447174200, "last_edit_date": 1447241893, "question_id": 33635236, "link": "https://stackoverflow.com/questions/33635236/vba-function-with-right-function", "title": "VBA function with right function", "body": "<p>just wondering why the below code returns #NAME? instead of the actual value:</p>\n\n<ul>\n<li>The issue was due to function name</li>\n</ul>\n\n<p>Corrected VBA function:</p>\n\n<pre><code>Function LocateSite_Function(Title As String) As String\n\nDim StartNumber As Long\n\nStartNumber = Len(Title) - InStr(1, Title, \"_\")\n\nLocateSite_Function = Right(Title, StartNumber)\n\nEnd Function\n</code></pre>\n\n<p>Extra:</p>\n\n<pre><code>Function FindSite_Function2(Title As String) As String\n\nDim SplitTitle As Variant\n\nSplitTitle = Split(Title, \"_\")\n\nFindSite_Function2 = UBound(SplitTitle)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "resources"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 4, "creation_date": 1447174128, "post_id": 33635128, "comment_id": 55044198, "body": "I suspect that is because you are using <code>wsFac.Cells.Copy</code> over and over again which is hogging your resources. After the autofilter copy only the visible cells. And when I say visible cells then see <a href=\"http://stackoverflow.com/questions/11631363/how-to-copy-a-line-in-excel-using-a-specific-word-and-pasting-to-another-excel-s\">THIS</a>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 3, "creation_date": 1447174210, "post_id": 33635128, "comment_id": 55044255, "body": "You might want to add <code>Application.CutCopyMode = False</code> after each &quot;paste&quot; and a few <code>DoEvents</code> if it&#39;s not enough. If it&#39;s still not enough, you&#39;ll need to change your <code>.Copy</code>, to something like <code>Range.Resize.Value=Range.SpecialsCells.Value</code> (I don&#39;t have a link for all of this but at least you&#39;ll have the keywords! ;) ) And as suggested by @SiddharthRout : if you use the same table, create a named range and use <code>wsFac.Range(&quot;Name_of_NamedRange&quot;).Copy</code>"}, {"owner": {"reputation": 107, "user_id": 5239589, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1407a9551cbada1acfadb64fb1098fbe?s=128&d=identicon&r=PG&f=1", "display_name": "MCJNY1992", "link": "https://stackoverflow.com/users/5239589/mcjny1992"}, "edited": false, "score": 0, "creation_date": 1447174691, "post_id": 33635128, "comment_id": 55044616, "body": "Wow thanks!! Visible Cells worked like a charm! And it&#39;s much faster now.  I guess me being lazy really cost me on this one"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447175128, "post_id": 33635128, "comment_id": 55044939, "body": "you could also refactor your code to places all the names into an array and loop through the array to add the sheet name, name it, filter the main sheet and copy the visible cells onto the new sheet. would make it easier to update going forward (and to read to :))"}], "owner": {"reputation": 107, "user_id": 5239589, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1407a9551cbada1acfadb64fb1098fbe?s=128&d=identicon&r=PG&f=1", "display_name": "MCJNY1992", "link": "https://stackoverflow.com/users/5239589/mcjny1992"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 350, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1482887472, "creation_date": 1447173862, "last_edit_date": 1447174164, "question_id": 33635128, "link": "https://stackoverflow.com/questions/33635128/excel-cannot-complete-task-with-available-resources", "title": "&quot;Excel Cannot complete task with available resources&quot;", "body": "<p>I have no clue what is causing this issue. I have a simple macro that creates new tabs and names them, then filters data from one tab and pastes it to their corresponding tab. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub Tabs()\n\nDim wbRecovery As Workbook\nDim wsFac As Worksheet\n\nSet wbRecovery = ThisWorkbook\nSet wsFac = wbRecovery.Sheets(\"Facility Rec Bucket &amp; Year\")\n\nWith wbRecovery\nSheets.Add After:=Sheets(Sheets.Count), Count:=17\nSheets(5).Name = \"DANES\"\nSheets(6).Name = \"DCEND\"\nSheets(7).Name = \"DCHED\"\nSheets(8).Name = \"DCNUR\"\nSheets(9).Name = \"DCRIC\"\nSheets(10).Name = \"DEMER\"\nSheets(11).Name = \"DHEMA\"\nSheets(12).Name = \"DMED\"\nSheets(13).Name = \"DNEUR\"\nSheets(14).Name = \"DNSUR\"\nSheets(15).Name = \"DOBGY\"\nSheets(16).Name = \"DOPHT\"\nSheets(17).Name = \"DPEDS\"\nSheets(18).Name = \"DPMR\"\nSheets(19).Name = \"DPSYC\"\nSheets(20).Name = \"DRADS\"\nSheets(21).Name = \"DSURG\"\nEnd With\n\nwsFac.Range(\"A1\").AutoFilter Field:=1, Criteria1:=(\"DANES\"), _\n        Operator:=xlFilterValues\nwsFac.Cells.Copy Destination:=wbRecovery.Sheets(\"DANES\").Range(\"A1\")\nwsFac.Range(\"A1\").AutoFilter Field:=1, Criteria1:=(\"DCEND\"), _\n        Operator:=xlFilterValues\nwsFac.Cells.Copy Destination:=wbRecovery.Sheets(\"DCEND\").Range(\"A1\")\nwsFac.Range(\"A1\").AutoFilter Field:=1, Criteria1:=(\"DCHED\"), _\n        Operator:=xlFilterValues\nwsFac.Cells.Copy Destination:=wbRecovery.Sheets(\"DCHED\").Range(\"A1\")\nwsFac.Range(\"A1\").AutoFilter Field:=1, Criteria1:=(\"DCNUR\"), _\n        Operator:=xlFilterValues\nwsFac.Cells.Copy Destination:=wbRecovery.Sheets(\"DCNUR\").Range(\"A1\")\nwsFac.Range(\"A1\").AutoFilter Field:=1, Criteria1:=(\"DCRIC\"), _\n        Operator:=xlFilterValues\nwsFac.Cells.Copy Destination:=wbRecovery.Sheets(\"DCRIC\").Range(\"A1\")\nwsFac.Range(\"A1\").AutoFilter Field:=1, Criteria1:=(\"DEMER\"), _\n        Operator:=xlFilterValues\nwsFac.Cells.Copy Destination:=wbRecovery.Sheets(\"DEMER\").Range(\"A1\")\nwsFac.Range(\"A1\").AutoFilter Field:=1, Criteria1:=(\"DHEMA\"), _\n        Operator:=xlFilterValues\nwsFac.Cells.Copy Destination:=wbRecovery.Sheets(\"DHEMA\").Range(\"A1\")\nwsFac.Range(\"A1\").AutoFilter Field:=1, Criteria1:=(\"DMED\"), _\n        Operator:=xlFilterValues\nwsFac.Cells.Copy Destination:=wbRecovery.Sheets(\"DMED\").Range(\"A1\")\nwsFac.Range(\"A1\").AutoFilter Field:=1, Criteria1:=(\"DNEUR\"), _\n        Operator:=xlFilterValues\nwsFac.Cells.Copy Destination:=wbRecovery.Sheets(\"DNEUR\").Range(\"A1\")\nwsFac.Range(\"A1\").AutoFilter Field:=1, Criteria1:=(\"DNSUR\"), _\n        Operator:=xlFilterValues\nwsFac.Cells.Copy Destination:=wbRecovery.Sheets(\"DNSUR\").Range(\"A1\")\nwsFac.Range(\"A1\").AutoFilter Field:=1, Criteria1:=(\"DOBGY\"), _\n        Operator:=xlFilterValues\nwsFac.Cells.Copy Destination:=wbRecovery.Sheets(\"DOBGY\").Range(\"A1\")\nwsFac.Range(\"A1\").AutoFilter Field:=1, Criteria1:=(\"DOPHT\"), _\n        Operator:=xlFilterValues\nwsFac.Cells.Copy Destination:=wbRecovery.Sheets(\"DOPHT\").Range(\"A1\")\nwsFac.Range(\"A1\").AutoFilter Field:=1, Criteria1:=(\"DPEDS\"), _\n        Operator:=xlFilterValues\nwsFac.Cells.Copy Destination:=wbRecovery.Sheets(\"DPEDS\").Range(\"A1\")\nwsFac.Range(\"A1\").AutoFilter Field:=1, Criteria1:=(\"DPMR\"), _\n        Operator:=xlFilterValues\nwsFac.Cells.Copy Destination:=wbRecovery.Sheets(\"DPMR\").Range(\"A1\")\nwsFac.Range(\"A1\").AutoFilter Field:=1, Criteria1:=(\"DPSYC\"), _\n        Operator:=xlFilterValues\nwsFac.Cells.Copy Destination:=wbRecovery.Sheets(\"DPSYC\").Range(\"A1\")\nwsFac.Range(\"A1\").AutoFilter Field:=1, Criteria1:=(\"DRADS\"), _\n        Operator:=xlFilterValues\nwsFac.Cells.Copy Destination:=wbRecovery.Sheets(\"DRADS\").Range(\"A1\")\nwsFac.Range(\"A1\").AutoFilter Field:=1, Criteria1:=(\"DSURG\"), _\n        Operator:=xlFilterValues\nwsFac.Cells.Copy Destination:=wbRecovery.Sheets(\"DSURG\").Range(\"A1\")\n\n\n\n\nEnd Sub\n</code></pre>\n\n<p>When I run this code as is, after the <strong>OBGY</strong> tab is pasted I get the error <strong>\"Excel Cannot complete task with available resources \"</strong>.  The tab where the data is being copied from is not abnormally large, it's only 566 rows and 14 columns wide (I wouldn't consider that large at all for Excel).  If I run the lines of code individually or in chunks of 5-8 it works perfect.  All the data is copied and pasted correctly but when I run it as a whole I get the same issue.  </p>\n\n<p>Is there something wrong with my computer or Excel itself?  </p>\n\n<p>I deleted a lot of stuff off my desktop so I didn't think it was a storage issue.  Also when I do the process manually I have no issues.  I have also tried <code>Application.CutCopyMode = False</code> and that hasn't worked either</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1447172998, "post_id": 33634779, "comment_id": 55043384, "body": "It is just that you <b>overwrite</b> <code>nextrow</code> at every calculation that you made on the start, so you&#39;ll only have this in facts <code>nextrow = Sheet17.Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row + 1</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447173007, "post_id": 33634779, "comment_id": 55043391, "body": "Why are you setting <code>nextrow</code> so many times?  Effectively, the only value <code>nextrow</code> will ever have is <code>Sheet17.Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row + 1</code> since that&#39;s the last call.  Therefore, when you are pasting to the next available range in Sheet 1, it&#39;s going to be based on that sheet17.  (You could literally remove the first 14 or so <code>nextrow = ...</code> and the same outcome would occur)."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447173426, "post_id": 33634929, "comment_id": 55043692, "body": "If that&#39;s basically going to be one big loop (just changing the sheet each time), perhaps he could use an Array to store the Sheet names/indices and loop through that?  Would like <code>mySheets() = Array(&quot;Sheet1&quot;,&quot;Sheet2&quot;,&quot;Sheet3&quot;,...,&quot;Sheet19&quot;)</code>  then <code>for i = lbound(mysheets) to ubound(mySheets)...mySheets(i).Cells(rows.count,&quot;A&quot;).End(xlU&zwnj;&#8203;p).Row+1</code>. ...etc, etc?  Or is it tricky working with sheet names as an array?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447173906, "post_id": 33634929, "comment_id": 55044045, "body": "It might be possible with the actual names of the sheets (here <code>Sheet1</code> is not the name, it is the object), but not with the index (as it can change if you change the order of the sheets). Let&#39;s see what the OP says but I admit (personally) I&#39;d prefer to use objects here because the names of the sheets may change but this Object reference won&#39;t."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447174358, "post_id": 33634929, "comment_id": 55044369, "body": "That&#39;s what I was thinking (that you could use an array with the &quot;Sheet1&quot; name, but not the index)."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447175147, "post_id": 33634929, "comment_id": 55044954, "body": "Though, It might be possible with an array of Worksheets&#39; Objects! See the edit!"}, {"owner": {"reputation": 33, "user_id": 5547080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f03de90365dd54fbed68959c4247537d?s=128&d=identicon&r=PG&f=1", "display_name": "MJD", "link": "https://stackoverflow.com/users/5547080/mjd"}, "edited": false, "score": 0, "creation_date": 1447183663, "post_id": 33634929, "comment_id": 55049888, "body": "So saying im not too familiar with arrays is probably obvious by my inadvertent redundancy and inability to notice the nextrow getting overwritten. But I wont be adding projects at a rate that it will be difficult to edit the code once I get a handle on it, but the sheet numbers will change, as well as the cell range such as C5:C, which is the target cell that I want activated for that project number. The next project will be D5:D, and so on... so the sheet number and cell number are paired."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1447230085, "post_id": 33634929, "comment_id": 55066620, "body": "Ok, I added a column to the array to include range basis (<code>C5:C</code>), take a look at the edit. FYI, <b><code>:</code></b> is used to place 2 code lines in the same row, I used it for a better readability of the definition of the array!"}, {"owner": {"reputation": 33, "user_id": 5547080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f03de90365dd54fbed68959c4247537d?s=128&d=identicon&r=PG&f=1", "display_name": "MJD", "link": "https://stackoverflow.com/users/5547080/mjd"}, "edited": false, "score": 0, "creation_date": 1447253362, "post_id": 33634929, "comment_id": 55079369, "body": "Perfect! : is what I was needing to understand to pair the sheet with the cell!"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 33, "user_id": 5547080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f03de90365dd54fbed68959c4247537d?s=128&d=identicon&r=PG&f=1", "display_name": "MJD", "link": "https://stackoverflow.com/users/5547080/mjd"}, "edited": false, "score": 0, "creation_date": 1447260913, "post_id": 33634929, "comment_id": 55084605, "body": "@MJD : Glad I could help! ;) As you are new to SO, just a few pointers : When your problem is solved, you can validate the answer by clicking in the tick right under the up/down vote arrows. Use up/down votes on each posts(Q or A) that you find useful/useless(or bad quality). And take a look : stackoverflow.com/help/how-to-ask and stackoverflow.com/help/mcve (even if this question was fine, it is always useful to know about those)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 5, "last_activity_date": 1447229944, "last_edit_date": 1447229944, "creation_date": 1447173213, "answer_id": 33634929, "question_id": 33634779, "link": "https://stackoverflow.com/questions/33634779/copying-row-info-from-one-sheet-to-another-based-on-cell-input/33634929#33634929", "title": "Copying row info from one sheet to another, based on cell input", "body": "<p>It is just that you <strong>overwrite</strong> <code>nextrow</code> at every calculation that you made on the start, so you'll only have this in facts <code>nextrow = Sheet17.Cells(Rows.Count, \"A\").End(xlUp).Row + 1</code>.</p>\n\n<p>You need to change the structure like this :</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Cells.Count &gt; 1 Then Exit Sub\nApplication.ScreenUpdating = False\n\nDim nextrow As Long, lastrow As Long, i As Long\nlastrow = Sheet3.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n\nnextrow = Sheet1.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nIf Not Intersect(Target, Range(\"C5:C\" &amp; lastrow)) Is Nothing Then\n    If Target &lt;&gt; vbNullString Then\n        i = Target.Row\n        Range(\"A\" &amp; i &amp; \":B\" &amp; i).Copy Destination:=Sheet1.Range(\"A\" &amp; nextrow)\n    End If\nEnd If\n\n\nnextrow = Sheet5.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nIf Not Intersect(Target, Range(\"C5:C\" &amp; lastrow)) Is Nothing Then\n    If Target &lt;&gt; vbNullString Then\n        i = Target.Row\n        Range(\"A\" &amp; i &amp; \":B\" &amp; i).Copy Destination:=Sheet5.Range(\"A\" &amp; nextrow)\n    End If\nEnd If\n\nnextrow = Sheet4.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n'And so ON....\n</code></pre>\n\n<hr>\n\n<p>Or with an Array of Worksheets' Objects :</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Cells.Count &gt; 1 Then Exit Sub\nApplication.ScreenUpdating = False\n\nDim NextRow As Long, LastRow As Long, i As Long, Sh() As Variant, Ws As Worksheet\nLastRow = Sheet3.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n\nReDim Sh(1 To 15, 1 To 2)\nSet Sh(1, 1) = Sheet1:      Sh(1, 2) = \"C5:C\"\nSet Sh(2, 1) = Sheet5:      Sh(2, 2) = \"D5:D\"\nSet Sh(3, 1) = Sheet4:      Sh(3, 2) = \"E5:E\"\nSet Sh(4, 1) = Sheet6:      Sh(4, 2) = \"F5:F\"\nSet Sh(5, 1) = Sheet7:      Sh(5, 2) = \"G5:G\"\nSet Sh(6, 1) = Sheet8:      Sh(6, 2) = \"H5:H\"\nSet Sh(7, 1) = sheet9:      Sh(7, 2) = \"I5:I\"\nSet Sh(8, 1) = sheet10:     Sh(8, 2) = \"J5:J\"\nSet Sh(9, 1) = sheet11:     Sh(9, 2) = \"K5:K\"\nSet Sh(10, 1) = sheet12:    Sh(10, 2) = \"L5:L\"\nSet Sh(11, 1) = sheet13:    Sh(11, 2) = \"M5:M\"\nSet Sh(12, 1) = Sheet14:    Sh(12, 2) = \"N5:N\"\nSet Sh(13, 1) = Sheet15:    Sh(13, 2) = \"O5:O\"\nSet Sh(14, 1) = sheet16:    Sh(14, 2) = \"P5:P\"\nSet Sh(15, 1) = Sheet17:    Sh(15, 2) = \"Q5:Q\"\n\nFor k = LBound(Sh, 1) To UBound(Sh, 1)\n    Set Ws = Sh(k, 1)\n    NextRow = Ws.Cells(Ws.Rows.Count, \"A\").End(xlUp).Row + 1\n    If Not Intersect(Target, Range(Sh(k, 2) &amp; LastRow)) Is Nothing Then\n        If Target &lt;&gt; vbNullString Then\n            i = Target.Row\n            Range(\"A\" &amp; i &amp; \":B\" &amp; i).Copy Destination:=Ws.Range(\"A\" &amp; NextRow)\n        End If\n    End If\nNext k\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5547080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f03de90365dd54fbed68959c4247537d?s=128&d=identicon&r=PG&f=1", "display_name": "MJD", "link": "https://stackoverflow.com/users/5547080/mjd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "accepted_answer_id": 33634929, "answer_count": 1, "score": 3, "last_activity_date": 1447229944, "creation_date": 1447172765, "last_edit_date": 1447173195, "question_id": 33634779, "link": "https://stackoverflow.com/questions/33634779/copying-row-info-from-one-sheet-to-another-based-on-cell-input", "title": "Copying row info from one sheet to another, based on cell input", "body": "<p>I havent coded in many years so ill do my best at communicating my objective.</p>\n\n<p>I have a Master sheet that contains a list of many projects (listed in the Master with their own cell) that likewise have their own numbered sheets. This Master has info that pertains to all other projects in the rows, that when selected under the appropriate cell, will copy that rows info to the next available row in the applicable project sheet.   </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim nextrow As Long, lastrow As Long, i As Long\n\nnextrow = Sheet1.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nnextrow = Sheet5.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nnextrow = Sheet4.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nnextrow = Sheet6.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nnextrow = Sheet7.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nnextrow = Sheet8.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nnextrow = Sheet9.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nnextrow = Sheet10.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nnextrow = Sheet11.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nnextrow = Sheet12.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nnextrow = Sheet13.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nnextrow = Sheet14.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nnextrow = Sheet15.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nnextrow = Sheet16.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nnextrow = Sheet17.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nlastrow = Sheet3.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n\nIf Target.Cells.Count &gt; 1 Then Exit Sub\n\nApplication.ScreenUpdating = False\n\nIf Not Intersect(Target, Range(\"C5:C\" &amp; lastrow)) Is Nothing Then\n    If Target &lt;&gt; vbNullString Then\n        i = Target.Row\n        Range(\"A\" &amp; i &amp; \":B\" &amp; i).Copy Destination:=Sheet1.Range(\"A\" &amp; nextrow)\n    End If\nEnd If\n</code></pre>\n\n<p>This the previous 6 lines of code are repeated for every sheet number until it gets to the last sheet (Sheet 17 and cell Q), and then theres the:</p>\n\n<pre><code> Application.ScreenUpdating = True\nend Sub\n</code></pre>\n\n<p>This works, however when it copies the info over, it replaces the existing info rather than place it in the next available row. This is the case EXCEPT for whatever the last project sheet is. The last sheet works as intended. </p>\n"}, {"tags": ["ms-access", "combobox", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447177610, "post_id": 33634645, "comment_id": 55046470, "body": "<i>How</i> do you add new values to the list(s)? What bound fields (the result list?) ? -- You can always do <code>Me.myCombobox.Requery</code>, but your post isn&#39;t very clear about what you are actually doing."}, {"owner": {"reputation": 21, "user_id": 5394516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ac068b8a658aabef53fe6c65fb4e4b6?s=128&d=identicon&r=PG&f=1", "display_name": "Mouse", "link": "https://stackoverflow.com/users/5394516/mouse"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447178475, "post_id": 33634645, "comment_id": 55046978, "body": "The combo boxes value lists allow edits. So as a new product comes in I (Admin) am able to edit the list to add the new product. This updates all the bound fields (There are several forms that have combo boxes that are bound to the table field). I have a search form with unbound combo boxes. I would like to have the unbound combo boxes be updated with the new product that was added to the value list when it is added."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447196380, "post_id": 33634645, "comment_id": 55056595, "body": "Still not clear, but we&#39;ll get there. What is the <code>RowSource</code> of the bound comboboxes, and what is it for the unbound comboboxes? Please edit your question with the info, comments are not really suited for these explanations."}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1447261453, "post_id": 33634645, "comment_id": 55084905, "body": "Perhaps store the options for these combo boxes in a table of their own and then use that as the row source for your combo boxes. If there are new options to add to the list you can either just add it to options table manually or try one of these fancy methods: <a href=\"http://allenbrowne.com/ser-27.html\" rel=\"nofollow noreferrer\">allenbrowne.com/ser-27.html</a>"}, {"owner": {"reputation": 21, "user_id": 5394516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ac068b8a658aabef53fe6c65fb4e4b6?s=128&d=identicon&r=PG&f=1", "display_name": "Mouse", "link": "https://stackoverflow.com/users/5394516/mouse"}, "edited": false, "score": 0, "creation_date": 1447268409, "post_id": 33634645, "comment_id": 55089178, "body": "That&#39;s actually not a bad idea. Thanks I will give that a try."}], "owner": {"reputation": 21, "user_id": 5394516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ac068b8a658aabef53fe6c65fb4e4b6?s=128&d=identicon&r=PG&f=1", "display_name": "Mouse", "link": "https://stackoverflow.com/users/5394516/mouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 797, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1447241085, "creation_date": 1447172376, "last_edit_date": 1447241085, "question_id": 33634645, "link": "https://stackoverflow.com/questions/33634645/updating-unbound-combo-box-value-lists", "title": "Updating Unbound combo box value lists", "body": "<p>I have a database that allows an end user to search all available records in a table based on the criteria they have entered. I have a form with three command buttons (search, clear, and close), six unbound text or combo boxes, and a query. When the user enters data into the text or combo boxes they will click the search button and the query will use the users data to search the table for the results. All of this works great. My problem is\u2026. The combo boxes are value lists. When I add new values to the list, all bound fields update automatically, but the unbound do not. Is there a way for me to automatically update those unbound fields when I update the bound ones too? My code for the search button is below if anyone has any pointers or thinks something needs changed.</p>\n\n<p>The record source for the bound comboboxes is empty but has a control source from the table (manufacturer combo's control source is the manufacturer field of the table and the main form is bound to the table). The Unbound combo box has a value list record source and the form is unbound. If I bind the form to the table and the control source of the combo to the correct field of the table When I select a manufacturer as my search criteria it changes the records to that manufacturer instead of just finding all the records that match the criteria.</p>\n\n<pre><code>If DCount(\"*\", \"User Customer Owned Parts Query\") = 0 Then\n    MsgBox \"No Records Found\"\n    Else\n        Me.User_Customer_Owned_Parts_Query_Subform.Requery\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1447171869, "post_id": 33634332, "comment_id": 55042508, "body": "What version of Excel?"}, {"owner": {"reputation": 3, "user_id": 5520234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037693f27e096090b9800ffdb4d7b0e1?s=128&d=identicon&r=PG&f=1", "display_name": "DaaB", "link": "https://stackoverflow.com/users/5520234/daab"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1447172063, "post_id": 33634332, "comment_id": 55042644, "body": "the version is excel 2010"}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1447172065, "creation_date": 1447172065, "answer_id": 33634538, "question_id": 33634332, "link": "https://stackoverflow.com/questions/33634332/validation-list-cant-refrence-a-range-in-another-sheet-in-formula1-as-a-var/33634538#33634538", "title": "validation list - can&#39;t refrence a range in another sheet in &quot;formula1&quot; as a variable", "body": "<blockquote>\n  <p>, is there some refrencing problem with the formula1 part in the validation list code??</p>\n</blockquote>\n\n<p>Yes: <code>ChoiceRng</code> is an object. Use the <code>.Address</code> property explicitly:</p>\n\n<pre><code>.Add Type:=xlValidateList, _\n     AlertStyle:=xlValidAlertStop,  _\n     Operator:=xlBetween, _\n     Formula1:=ChoiceRng.Address\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5520234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037693f27e096090b9800ffdb4d7b0e1?s=128&d=identicon&r=PG&f=1", "display_name": "DaaB", "link": "https://stackoverflow.com/users/5520234/daab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 562, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447172065, "creation_date": 1447171451, "last_edit_date": 1531164843, "question_id": 33634332, "link": "https://stackoverflow.com/questions/33634332/validation-list-cant-refrence-a-range-in-another-sheet-in-formula1-as-a-var", "title": "validation list - can&#39;t refrence a range in another sheet in &quot;formula1&quot; as a variable", "body": "<pre><code>   Set AcctRng = Sheets(\"New Accounts\").Range(Cells(2, 1),Cells(countnonblank1 + 1, 1))\n   CntNBlnk = Application.WorksheetFunction.CountA(AcctRng)\n\n   Set MasterSht = ThisWorkbook.Worksheets(\"Master Data\")\n   LstRo = MasterSht.Cells(MasterSht.Rows.Count, \"A\").End(xlUp).Row\n\n '  Sheets(\"New Accounts\").Range(\"a5\") = LstRo\n\n   Set ChoiceRng = Sheets(\"Master Data\").Range(Cells(4, 1), Cells(LstRo, 1))\n   'Sheets(\"Master Data\").Range(Cells(4, 1), Cells(LstRo, 1))\n\n\n '  Choice = \"ChoiceRange\"\n\n\n     Sheets(\"New Accounts\").Range(Cells(2, 2), Cells(CntNBlnk + 1, 2)).Select\n     With Selection.Validation\n    .Delete\n   .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n     xlBetween, Formula1:=ChoiceRng\n    .IgnoreBlank = True\n    .InCellDropdown = True\n    .InputTitle = \"\"\n    .ErrorTitle = \"\"\n    .InputMessage = \"\"\n    .ErrorMessage = \"\"\n    .ShowInput = True\n    .ShowError = True\nEnd With\n</code></pre>\n\n<p>all the variables are declared accordingly, is there some referencing problem with the formula1 part in the validation list code??</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 1, "creation_date": 1447171195, "post_id": 33634187, "comment_id": 55042018, "body": "What are you trying to ask ?"}, {"owner": {"reputation": 904, "user_id": 4519709, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c6b1f82af788e90e52773d9007bae416?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/4519709/gonzalo"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1447171368, "post_id": 33634187, "comment_id": 55042141, "body": "if i find one keyword in a specific column, to move the entire row to a other sheet ( first empty row found) :)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1447171588, "post_id": 33634187, "comment_id": 55042305, "body": "This has been asked and answered many many times, did you try google?  If you have code that is not working edit you post with the code."}, {"owner": {"reputation": 904, "user_id": 4519709, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c6b1f82af788e90e52773d9007bae416?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/4519709/gonzalo"}, "edited": false, "score": 0, "creation_date": 1447171854, "post_id": 33634187, "comment_id": 55042498, "body": "actually i couldnt find.. because i want to look to a specific column to match a &quot;keyword&quot;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447172006, "post_id": 33634187, "comment_id": 55042602, "body": "<a href=\"http://stackoverflow.com/questions/24131874/cutting-row-with-data-and-moving-to-different-sheet-vba\">This</a> will do it you just need to change the criteria and columns to meet your needs.  Took two minutes on google."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447173955, "post_id": 33634187, "comment_id": 55044077, "body": "@ScottCraner Understood. I&#39;ll delete my comments..."}], "answers": [{"comments": [{"owner": {"reputation": 904, "user_id": 4519709, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c6b1f82af788e90e52773d9007bae416?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/4519709/gonzalo"}, "edited": false, "score": 0, "creation_date": 1447175097, "post_id": 33634906, "comment_id": 55044924, "body": "thanks for your input. It works partially.. its just moving 1 row (the first found) and deletes all others with solved (without moving them). Any chance it could place the rows starting in B3 of sheet 2?"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 904, "user_id": 4519709, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c6b1f82af788e90e52773d9007bae416?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/4519709/gonzalo"}, "edited": false, "score": 0, "creation_date": 1447175283, "post_id": 33634906, "comment_id": 55045034, "body": "I tested it before posting. It moves all the rows here that contain &quot;solved&quot; in column C. Yes it can be modified to start in B3 of destination. But there must be something unexplained in your source data. Any chance you can send me a sample? I&#39;ll sort it out quickly. My email address is:  daniel.ferry@gmail.com"}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 1, "last_activity_date": 1447173513, "last_edit_date": 1447173513, "creation_date": 1447173147, "answer_id": 33634906, "question_id": 33634187, "link": "https://stackoverflow.com/questions/33634187/move-specific-row-to-other-sheet/33634906#33634906", "title": "Move specific row to other sheet", "body": "<p>This will do exactly as you want:</p>\n\n<pre><code>Sub Gonzalo()\n\n    Const SEARCH_COLUMN = 3\n    Const KEYWORD = \"solved\"\n\n    Dim n&amp;\n    Application.ScreenUpdating = 0\n    Application.Calculation = xlCalculationManual\n    On Error Resume Next\n    Do While Err = 0\n        n = Application.Match(KEYWORD, Sheet1.Columns(SEARCH_COLUMN), 0)\n        If Err = 0 Then\n            Sheet2.Rows(Sheet2.[index(a:a,1+max(iferror(match({\"*\";9E+99},a:a,{-1;1}),1)))].Row) = Sheet1.Rows(n).Value\n            Sheet1.Rows(n).Delete xlUp\n        End If\n    Loop\n    Application.ScreenUpdating = 1\n    Application.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n\n<p>Note: use the first two lines to edit the search column and the keyword to search for.</p>\n"}], "owner": {"reputation": 904, "user_id": 4519709, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c6b1f82af788e90e52773d9007bae416?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/4519709/gonzalo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 33634906, "answer_count": 1, "score": -2, "last_activity_date": 1447173931, "creation_date": 1447171047, "last_edit_date": 1447173931, "question_id": 33634187, "link": "https://stackoverflow.com/questions/33634187/move-specific-row-to-other-sheet", "title": "Move specific row to other sheet", "body": "<p>How could I move a complete row (or rows) of sheet1, if on that row the column C  have the word \"solved\", to the first empty row of sheet2?  </p>\n\n<p>The other rows which do not match the condition would need to continue in sheet 1 but occupying the empty rows, if is the case (to not have spaces between all rows).</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5310684, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/R2TWc.jpg?s=128&g=1", "display_name": "epgrape", "link": "https://stackoverflow.com/users/5310684/epgrape"}, "edited": false, "score": 0, "creation_date": 1447171529, "post_id": 33634255, "comment_id": 55042254, "body": "Thank you :) Will flag your answer in 6 minutes"}], "tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 0, "last_activity_date": 1447171268, "creation_date": 1447171268, "answer_id": 33634255, "question_id": 33634160, "link": "https://stackoverflow.com/questions/33634160/cell-format-changing/33634255#33634255", "title": "Cell format changing", "body": "<p>Just add quotation marks when defining range:</p>\n\n<pre><code>Dim num As Integer\nnum = ActiveWorkbook.Sheets.Count\nFor i = 2 To num - 1\n    ActiveWorkbook.Sheets(i).Range(\"B4\").NumberFormat = \"00\"\nNext i\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5310684, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/R2TWc.jpg?s=128&g=1", "display_name": "epgrape", "link": "https://stackoverflow.com/users/5310684/epgrape"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 33634255, "answer_count": 1, "score": -1, "last_activity_date": 1447172394, "creation_date": 1447170962, "last_edit_date": 1447172394, "question_id": 33634160, "link": "https://stackoverflow.com/questions/33634160/cell-format-changing", "title": "Cell format changing", "body": "<p>I wanted to change the format in Cell <code>B4</code> on every Worksheet except the first and last and did this:</p>\n\n<pre><code>Dim num As Integer\nnum = ActiveWorkbook.Sheets.Count\nFor i = 2 To num - 1\n    ActiveWorkbook.Sheets(i).Range(B4).NumberFormat = \"00\"\nNext i\n</code></pre>\n\n<p>First I am checking number of worksheets I have and then going from Sheet to till one before last sheet, but i get an error :/</p>\n"}, {"tags": ["xml", "ms-access", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1447173476, "post_id": 33633961, "comment_id": 55043722, "body": "That error would happen if there is no table named <i>INSTRUMENT</i>.  Does it exist?"}, {"owner": {"reputation": 1, "user_id": 5346952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7e3fa919641e71df0d9ba05a0c9ec0e?s=128&d=identicon&r=PG&f=1", "display_name": "smh", "link": "https://stackoverflow.com/users/5346952/smh"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1447190947, "post_id": 33633961, "comment_id": 55053920, "body": "You are right.  Previously the file had always imported into a new table named &quot;INSTRUMENT&quot; but now for some reason the table is being named the same as the xml file name.  There are a lot of tables and so I didn&#39;t see this.  Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1447177208, "creation_date": 1447177208, "answer_id": 33636171, "question_id": 33633961, "link": "https://stackoverflow.com/questions/33633961/error-on-access-import-run-time-error-3265-item-not-found-in-this-collectio/33636171#33636171", "title": "Error on Access Import - Run-time error &#39;3265&#39;: Item not found in this collection", "body": "<p>Whenever editing/deleting/re-creating objects across a collection like Access' Tabledefs, Forms, Querydefs, or Reports during an automation process, it is helpful to to loop through entire set to find needed object and conditionally edit or delete it. </p>\n\n<p>This is similar to renaming or deleting a worksheet in an Excel workbook (loop through all worksheets and rename if such worksheet exists):</p>\n\n<pre><code>Dim db As Database\nDim tbldef As TableDef\n\nSet db = CurrentDb\n\nFor each tbldef in db.TableDefs\n  If tbldef.Name = \"INSTRUMENT\" Then\n       tbldef.Name = \"ANALYTICS\"\n  End if    \nNext tbldef\n\n' UNINITIALIZE OBJECTS\nSet tbldef = Nothing\nSet db = Nothing\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5346952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7e3fa919641e71df0d9ba05a0c9ec0e?s=128&d=identicon&r=PG&f=1", "display_name": "smh", "link": "https://stackoverflow.com/users/5346952/smh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 749, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594643257, "creation_date": 1447170399, "last_edit_date": 1594643257, "question_id": 33633961, "link": "https://stackoverflow.com/questions/33633961/error-on-access-import-run-time-error-3265-item-not-found-in-this-collectio", "title": "Error on Access Import - Run-time error &#39;3265&#39;: Item not found in this collection", "body": "<p>I have taken over an Access database created by someone else and I have little to no Access experience.  I am getting a <code>Run-time error '3265': Item not found in this collection.</code> error when I try to run the code which imports an xml file.  When I debug, line 4 of the below code is highlighted in yellow. Can you please provide any hints at what generally causes this?  This process is run everyday with a new holdings file, so we delete the previous day's Analytics table and create a new one.  Thanks in advance.</p>\n\n<pre><code>'import holdings file\nDoCmd.DeleteObject acTable, \"ANALYTICS\"\nApplication.ImportXML XmlHoldingsFile, acAppendData\nCurrentDb.TableDefs(\"INSTRUMENT\").Name = \"ANALYTICS\"\n</code></pre>\n"}, {"tags": ["vba", "csv", "visio"], "answers": [{"comments": [{"owner": {"reputation": 217, "user_id": 3314570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/6ykgd.jpg?s=128&g=1", "display_name": "user3314570", "link": "https://stackoverflow.com/users/3314570/user3314570"}, "edited": false, "score": 0, "creation_date": 1447270532, "post_id": 33635964, "comment_id": 55090394, "body": "Thanks for your answer! I have to put my text in a &quot;Puce 120&quot; Master because it&#39;s an instruction I have. My problem is to retrieve it from this Master in fact. The second function I write is independent from the first so I have to find my Master Puce 120 first in the page and then retrieve the text. But I don&#39;t find it when I search in the properties of the Master. I find a Property &quot;Shapes&quot; but I don&#39;t find the text thaht I wrote inside de Master, juste &quot;Text = Puce 120&quot;"}, {"owner": {"reputation": 7447, "user_id": 929187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/F5QPL.png?s=128&g=1", "display_name": "Nikolay", "link": "https://stackoverflow.com/users/929187/nikolay"}, "reply_to_user": {"reputation": 217, "user_id": 3314570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/6ykgd.jpg?s=128&g=1", "display_name": "user3314570", "link": "https://stackoverflow.com/users/3314570/user3314570"}, "edited": false, "score": 0, "creation_date": 1447271424, "post_id": 33635964, "comment_id": 55090866, "body": "You don&#39;t find it because it does not exist in the master; you put your text in the shape (not in the master) with your first code snippet. What do you actually want to do (i.e. basic idea?) &quot;Shape&quot; in Visio relates to a &quot;Master&quot; as &quot;Object&quot; (Instance) relates to a &quot;Class&quot; (Type) in a programming language."}, {"owner": {"reputation": 217, "user_id": 3314570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/6ykgd.jpg?s=128&g=1", "display_name": "user3314570", "link": "https://stackoverflow.com/users/3314570/user3314570"}, "edited": false, "score": 0, "creation_date": 1447271810, "post_id": 33635964, "comment_id": 55091074, "body": "The idea is that the first function will import a csv file in a Puce 120 shape and the second function will do the reverse thing. From the Puce 120 shape retrieve the text and write it in a csv file. But the 2 functions are not done successively, so I can&#39;t pass the shape in parameter. I&#39;ve done it in word but I have trouble with visio"}, {"owner": {"reputation": 7447, "user_id": 929187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/F5QPL.png?s=128&g=1", "display_name": "Nikolay", "link": "https://stackoverflow.com/users/929187/nikolay"}, "reply_to_user": {"reputation": 217, "user_id": 3314570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/6ykgd.jpg?s=128&g=1", "display_name": "user3314570", "link": "https://stackoverflow.com/users/3314570/user3314570"}, "edited": false, "score": 0, "creation_date": 1447271884, "post_id": 33635964, "comment_id": 55091114, "body": "Then it seems you don&#39;t need any masters. Just use the code like above with &quot;shape.Text&quot;... why masters?! Maybe you mean, you want to find the shape which you dropped at step 1?"}, {"owner": {"reputation": 7447, "user_id": 929187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/F5QPL.png?s=128&g=1", "display_name": "Nikolay", "link": "https://stackoverflow.com/users/929187/nikolay"}, "reply_to_user": {"reputation": 217, "user_id": 3314570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/6ykgd.jpg?s=128&g=1", "display_name": "user3314570", "link": "https://stackoverflow.com/users/3314570/user3314570"}, "edited": false, "score": 0, "creation_date": 1447272191, "post_id": 33635964, "comment_id": 55091262, "body": "In case you need to find a shape, you can just mark it at step 1 (add a data field to it to mark it). Or remember it&#39;s ID. Or it&#39;s name (or give it a specific name so that you can find it later by that name). Or iterate over all shapes, and check which shapes were created out of master named &quot;Puce 120&quot; by examining shape&#39;s Master property."}, {"owner": {"reputation": 217, "user_id": 3314570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/6ykgd.jpg?s=128&g=1", "display_name": "user3314570", "link": "https://stackoverflow.com/users/3314570/user3314570"}, "edited": false, "score": 0, "creation_date": 1447272446, "post_id": 33635964, "comment_id": 55091412, "body": "Actually I didn&#39;t write that code with the Master. A collegue wrote it so I rely on this to write the reverse function . And yes, I want to find the shape I dropped that&#39;s why I am searching throught the masters to find my Puce 120."}, {"owner": {"reputation": 217, "user_id": 3314570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/6ykgd.jpg?s=128&g=1", "display_name": "user3314570", "link": "https://stackoverflow.com/users/3314570/user3314570"}, "reply_to_user": {"reputation": 7447, "user_id": 929187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/F5QPL.png?s=128&g=1", "display_name": "Nikolay", "link": "https://stackoverflow.com/users/929187/nikolay"}, "edited": false, "score": 0, "creation_date": 1447272481, "post_id": 33635964, "comment_id": 55091432, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/94852/discussion-between-user3314570-and-nikolay\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 7447, "user_id": 929187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/F5QPL.png?s=128&g=1", "display_name": "Nikolay", "link": "https://stackoverflow.com/users/929187/nikolay"}, "is_accepted": false, "score": 0, "last_activity_date": 1447176407, "creation_date": 1447176407, "answer_id": 33635964, "question_id": 33633946, "link": "https://stackoverflow.com/questions/33633946/retrieve-texte-from-a-masters/33635964#33635964", "title": "Retrieve texte from a Masters", "body": "<p>You can put and get text of a shape using <code>shape.Text</code> property.\nIs there any reason for all other fancy stuff? That is, you can set shape text like this:</p>\n\n<pre><code>shape.Text = \"Hello\"\n</code></pre>\n\n<p>And get it back like this:</p>\n\n<pre><code>myText = shape.Text\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 3314570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/6ykgd.jpg?s=128&g=1", "display_name": "user3314570", "link": "https://stackoverflow.com/users/3314570/user3314570"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1447205626, "creation_date": 1447170371, "last_edit_date": 1447205626, "question_id": 33633946, "link": "https://stackoverflow.com/questions/33633946/retrieve-texte-from-a-masters", "title": "Retrieve texte from a Masters", "body": "<p>I'm working on Visio 2013 for a project and I'm new to VBA and Visio.</p>\n\n<p>First, I wrote a function which imports a CSV file in the current visio document by creating first a string table <code>texte</code> of the CSV and then adding it in a shape:</p>\n\n<pre><code>Dim sp As Visio.Shape\nSet sp = ActiveDocument.Pages(1).Drop(Visio.ActiveDocument.Masters(\"Puce 120\"), 4, 10)\nsp.Characters.Text = texte\n</code></pre>\n\n<p>Now I want to write the reverse function, from the shape to a CSV file but I can't find a way to access the text in my shape \"Puce 120\".</p>\n\n<p>I wrote this:</p>\n\n<pre><code>Dim vsoMasters As Visio.Masters\nDim intMasterCount As Integer\nDim intCounter As Integer\nDim vsoMaster As Visio.Master\n\nSet vsoMasters = ActiveDocument.Masters    \nintMasterCount = vsoMasters.Count\n\nIf intMasterCount &gt; 0 Then\n    For intCounter = 1 To intMasterCount\n        If vsoMasters.Item(intCounter).Name = \"Puce 120\" Then\n            Set vsoMaster = vsoMasters.Item(intCounter)\n        End If\n    Next intCounter\nElse\n    Debug.Print \" No masters in document\"\nEnd If\n\nDim shap As Visio.Shapes\nSet shap = vsoMaster.Shapes\n\nDim ch As Visio.Characters\nch = shap.Characters\n</code></pre>\n\n<p>But I don't find my text in <code>ch</code>. Can someone explain me how to retrieve it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 803, "user_id": 4186108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/170ff81c1ed126d7c00aa6aea33fa3bb?s=128&d=identicon&r=PG&f=1", "display_name": "cboden", "link": "https://stackoverflow.com/users/4186108/cboden"}, "edited": false, "score": 0, "creation_date": 1447170552, "post_id": 33633762, "comment_id": 55041546, "body": "you only one to move values within between ----------------- lines right?"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1447170933, "creation_date": 1447170933, "answer_id": 33634151, "question_id": 33633762, "link": "https://stackoverflow.com/questions/33633762/remove-empty-lines-from-selected-cells/33634151#33634151", "title": "Remove empty lines from selected cells", "body": "<p>This will do it:</p>\n\n<p>Instead of replacing the carriage returns, split on it then loop through and replace the value with only those items that have a value.</p>\n\n<pre><code>Sub RemoveCarriageReturns()\n    Dim MyRange As Range\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    For Each MyRange In ActiveSheet.UsedRange\n        Dim textArr() As String\n        textArr = Split(MyRange.Value, Chr(10))\n        MyRange.Value = \"\"\n        For i = LBound(textArr) To UBound(textArr)\n            If textArr(i) &lt;&gt; \"\" Then\n                If MyRange.Value = \"\" Then\n                    MyRange.Value = textArr(i)\n                Else\n                    MyRange.Value = MyRange.Value &amp; Chr(10) &amp; textArr(i)\n                End If\n            End If\n        Next i\n    Next\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1447174321, "last_edit_date": 1592644375, "creation_date": 1447172094, "answer_id": 33634549, "question_id": 33633762, "link": "https://stackoverflow.com/questions/33633762/remove-empty-lines-from-selected-cells/33634549#33634549", "title": "Remove empty lines from selected cells", "body": "<p>You need to locate and remove errant line feed characters (e.g. vbLF, <code>Chr(10)</code> or ASCII 010 dec). If the data was copied from an external source, it is possible that rogue carriage return characters (e.g. vbCR or <code>Chr(13)</code>) may have piggy-backed along and these should be scrubbed as well.</p>\n<pre><code>Sub clean_blank_lines()\n    Dim rw As Long\n    \n    With Worksheets(&quot;Sheet3&quot;)   '&lt;~~SET THIS WORKSHEET REFERENCE PROPERLY!\n        For rw = 2 To .Cells(Rows.Count, 1).End(xlUp).Row\n            With .Cells(rw, 1)\n                .Value = Replace(.Value2, Chr(13), Chr(10))\n                Do While Left(.Value2, 1) = Chr(10): .Value = Mid(.Value2, 2): Loop\n                Do While CBool(InStr(1, .Value, Chr(10) &amp; Chr(10)))\n                    .Value = Replace(.Value2, Chr(10) &amp; Chr(10), Chr(10))\n                Loop\n                Do While Right(.Value2, 1) = Chr(10): .Value = Left(.Value2, Len(.Value2) - 1): Loop\n            End With\n            .Rows(rw).EntireRow.AutoFit\n        Next rw\n    End With\nEnd Sub\n</code></pre>\n<p>A <a href=\"https://msdn.microsoft.com/en-us/library/office/ff820840.aspx\" rel=\"nofollow noreferrer\">Range.AutoFit</a> is performed on the finished cell to remove dead 'white space'.</p>\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/Uivet.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Uivet.png\" alt=\"Trim Line Feeds\" /></a>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/vJqj4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vJqj4.png\" alt=\"Trim line feed results\" /></a>\n<br/>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sub>Before</sub>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sub>After</sub></p>\n<p>To convert this to a macro that processes one or more selected cells, see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros/28700020#28700020\">Examples of Selection-based sub framework</a> in <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros/28700020\">How to avoid using Select in Excel VBA macros</a>.</p>\n"}], "owner": {"reputation": 148, "user_id": 2396600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c281bab0d11c876db9525037cdcda32b?s=128&d=identicon&r=PG", "display_name": "phidrho", "link": "https://stackoverflow.com/users/2396600/phidrho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 33634549, "answer_count": 2, "score": 0, "last_activity_date": 1447174321, "creation_date": 1447169876, "last_edit_date": 1447170978, "question_id": 33633762, "link": "https://stackoverflow.com/questions/33633762/remove-empty-lines-from-selected-cells", "title": "Remove empty lines from selected cells", "body": "<p>I am trying to remove only empty lines from cells in excel. Here is what I'm trying to accoplish:</p>\n\n<pre><code>+-----------------+    +---------------------+    +---------------------+\n|  EXAMPLE DATA   |    |    EXPLANATION      |    |   EXPECTED RESULT   |\n+-----------------+    +---------------------+    +---------------------+\n| cell1_text1     |    | cell1_text1         |    | cell1_text1         |\n| cell1_text2     |    | cell1_text2         |    | cell1_text2         |\n+-----------------+    +---------------------+    +---------------------+\n|                 |    | cell2_empty_line    |    | cell2_text1         | \n| cell2_text1     |    | cell2_text1         |    +---------------------+ \n+-----------------+    +---------------------+    | cell3_text1         | \n| cell3_text1     |    | cell3_text1         |    | cell3_text2         | \n|                 |    | cell3_emptyline     |    +---------------------+ \n| cell3_text2     |    | cell3_text2         |    | cell4_text1         | \n+-----------------+    +---------------------+    +---------------------+ \n|                 |    | cell4_emptyline     |    | cell5_text1         | \n|                 |    | cell4_emptyline     |    +---------------------+ \n| cell4_text1     |    | cell4_text1         |    | cell6_text1         | \n+-----------------+    +---------------------+    | cell6_text2         | \n| cell5_text1     |    | cell5_text1         |    | cell6_text3         | \n+-----------------+    +---------------------+    | cell6_text4         | \n| cell6_text1     |    | cell6_text1         |    +---------------------+ \n| cell6_text2     |    | cell6_text2         |\n| cell6_text3     |    | cell6_text3         |\n|                 |    | cell6_emptyline     |\n| cell6_text4     |    | cell6_text4         |\n+-----------------+    +---------------------+\n</code></pre>\n\n<p>I have <a href=\"https://www.ablebits.com/office-addins-blog/2013/12/03/remove-carriage-returns-excel/\" rel=\"nofollow\">found this script</a>:</p>\n\n<pre><code>Sub RemoveCarriageReturns()\n    Dim MyRange As Range\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    For Each MyRange In ActiveSheet.UsedRange\n        If 0 &lt; InStr(MyRange, Chr(10)) Then\n            MyRange = Replace(MyRange, Chr(10), \"\")\n        End If\n    Next\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>but it doesn't give me desired result, it removes all breaklines in all cells.</p>\n\n<pre><code>+---------------------------------------------+\n|          CURRENT SCRIPT RESULT              |\n+---------------------------------------------+\n| cell1_text1cell1_text2                      |\n+---------------------------------------------+\n| cell2_text1                                 |\n+---------------------------------------------+\n| cell3_text1cell3_text2                      |\n+---------------------------------------------+\n| cell4_text1                                 |\n+---------------------------------------------+\n| cell5_text1                                 |\n+---------------------------------------------+\n| cell6_text1cell6_text2cell6_text3cell6_text4|\n+---------------------------------------------+\n</code></pre>\n\n<p>How can I test if row doesn't contain any other letter and delete only that row within cell?\nHow can I apply that macro only to currenty selected cells?</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1447170542, "post_id": 33633759, "comment_id": 55041539, "body": "Will the repeating lines always be consecutive? If so, create branching logic. Say &quot;If [Cell in C in current row] = [Cell in C in row above] , Then [Cell in G in current row] = [Cell in G in row above] Else [Cell in C in current row] = [Current formula] End If&quot;"}, {"owner": {"reputation": 111, "user_id": 4996987, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7764ea06ad5f8c3b8089becd303a6d15?s=128&d=identicon&r=PG", "display_name": "wongnog", "link": "https://stackoverflow.com/users/4996987/wongnog"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1447171057, "post_id": 33633759, "comment_id": 55041912, "body": "Yes the repeating lines in <code>Column C</code> will be consecutive, but not named so neatly with numbers at the end.  In other words, if <code>Parameter 5</code> repeats 4 times, you will never see <code>Parameter 1</code> afterwards"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 4996987, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7764ea06ad5f8c3b8089becd303a6d15?s=128&d=identicon&r=PG", "display_name": "wongnog", "link": "https://stackoverflow.com/users/4996987/wongnog"}, "edited": false, "score": 0, "creation_date": 1447171488, "post_id": 33634062, "comment_id": 55042229, "body": "I&#39;m not sure if this code will work as it does not have <code>k = k + 10</code> at the end of the <code>For</code> loop.  I need this so the values increment by 10.  For example, if the user enters <code>100</code> as the starting <code>TagNum</code>, then the values in your example above should be <code>Apple_100</code> <code>Apple_110</code> <code>Apple_110</code> etc"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 111, "user_id": 4996987, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7764ea06ad5f8c3b8089becd303a6d15?s=128&d=identicon&r=PG", "display_name": "wongnog", "link": "https://stackoverflow.com/users/4996987/wongnog"}, "edited": false, "score": 0, "creation_date": 1447171569, "post_id": 33634062, "comment_id": 55042286, "body": "Do you always want to increment by 10?"}, {"owner": {"reputation": 111, "user_id": 4996987, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7764ea06ad5f8c3b8089becd303a6d15?s=128&d=identicon&r=PG", "display_name": "wongnog", "link": "https://stackoverflow.com/users/4996987/wongnog"}, "edited": false, "score": 0, "creation_date": 1447171662, "post_id": 33634062, "comment_id": 55042354, "body": "Yes always by 10.  Also which line defines the first cell in <code>Column G</code> to populate?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 111, "user_id": 4996987, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7764ea06ad5f8c3b8089becd303a6d15?s=128&d=identicon&r=PG", "display_name": "wongnog", "link": "https://stackoverflow.com/users/4996987/wongnog"}, "edited": false, "score": 0, "creation_date": 1447171830, "post_id": 33634062, "comment_id": 55042478, "body": "Then see the updated code :) You may have to refresh the page. The first code was using <code>TagNum</code> to increment. In the second code the increment is happening at fixed interval of 10"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1447172027, "last_edit_date": 1447172027, "creation_date": 1447170696, "answer_id": 33634062, "question_id": 33633759, "link": "https://stackoverflow.com/questions/33633759/repeat-or-change-cell-value-based-on-other-cell/33634062#33634062", "title": "Repeat or change cell value based on other cell", "body": "<p>I think there are couple of errors. Is this what you are trying?</p>\n\n<pre><code>Sub Sample()\n    Dim TagName As String, sTag As String\n    Dim TagNum As Long, k As Long\n\n    ' Prompts user for tag names/numbers\n    TagName = InputBox(\"What is the product tag name? Ex. APPLE\")\n    TagNum = InputBox(\"What is the starting tag #? Ex. 10\")\n\n    With ActiveSheet\n        LastRow = .Cells(.Rows.Count, \"J\").End(xlUp).Row\n        k = TagNum\n        .Range(\"G2\").Value = TagName &amp; \"_\" &amp; k\n        For i = 3 To LastRow\n            '~~&gt; Increment k only if the values do not match\n            If .Range(\"C\" &amp; i).Value &lt;&gt; .Range(\"C\" &amp; i - 1).Value _\n            Then k = k + 10\n\n            .Range(\"G\" &amp; i).Value = TagName &amp; \"_\" &amp; k\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>I selected \"Apple\" and \"10\" in the Input Boxes</p>\n\n<p><a href=\"https://i.stack.imgur.com/MIzP9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MIzP9.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 111, "user_id": 4996987, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7764ea06ad5f8c3b8089becd303a6d15?s=128&d=identicon&r=PG", "display_name": "wongnog", "link": "https://stackoverflow.com/users/4996987/wongnog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 33634062, "answer_count": 1, "score": 1, "last_activity_date": 1447172037, "creation_date": 1447169867, "last_edit_date": 1447172037, "question_id": 33633759, "link": "https://stackoverflow.com/questions/33633759/repeat-or-change-cell-value-based-on-other-cell", "title": "Repeat or change cell value based on other cell", "body": "<p>I have a macro which fills values in Column G (starting at cell <code>G2</code>) based on user prompts for the start value, then repeats to the end of the column by adding 10 to the value each time.  </p>\n\n<pre><code>Sub Macro1()\n\nDim TagName As String\nDim TagNum As Long, k As Long\n\n' Prompts user for tag names/numbers\nTagName = InputBox(\"What is the product tag name? Ex. APPLE\")\nTagNum = InputBox(\"What is the starting tag #? Ex. 10\")\n\n\n' Set values in column G, up to last row in column J\nk = 0\nWith ActiveSheet\n    LastRow = .Cells(.Rows.Count, \"J\").End(xlUp).Row\nEnd With\n\nWith ActiveSheet.Range(\"G2\")\n    For i = 1 To LastRow Step 1\n        .Item(i + 0) = TagName &amp; \"_\" &amp; TagNum2 + k\n        k = k + 10\n    Next\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>This works perfectly if Column C has unique values in each line, like so:\n<a href=\"https://i.stack.imgur.com/nzO4m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nzO4m.png\" alt=\"Before\"></a></p>\n\n<p>But if the value in Column C repeats, I want the same in Column G, like this:\n<a href=\"https://i.stack.imgur.com/P3nap.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P3nap.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "time-complexity", "complexity-theory"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 1, "creation_date": 1447169252, "post_id": 33633417, "comment_id": 55040573, "body": "Well if it <i>must</i> compare every value,  it <i>must</i> compare every value.  There is nothing built in to do this."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1447169614, "post_id": 33633417, "comment_id": 55040853, "body": "There are some ways you could speed this up - for example, performing a sort first. There are pre-made custom macros which do this; I thought ozgrid.com had a full suite of &#39;array comparison&#39; macros, but it doesn&#39;t seem to. Perhaps they&#39;ve moved that package to the pay-site."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1447169745, "post_id": 33633417, "comment_id": 55040960, "body": "Are they collections of custom objects, strings, ints, doubles?"}, {"owner": {"reputation": 6511, "user_id": 4765200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb1ac82079e2f813975cfa1aad1e234?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Pressler", "link": "https://stackoverflow.com/users/4765200/brian-pressler"}, "edited": false, "score": 1, "creation_date": 1447169864, "post_id": 33633417, "comment_id": 55041043, "body": "It depends on what you mean by &quot;compare&quot;... if your simply looking for equality for example, a simper inner join will find items in A that are also in B.  If you mean you need to perform an operation or evaluate a function... then the optimization will depend entirely on the function.  So you&#39;re question is too vague as it stands."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1447173124, "post_id": 33633417, "comment_id": 55043473, "body": "You can use the Exists function of the Scripting.Dictionary, or try to put the value in to collection B and trap the error, so if B accepts the value of A, then its NOT in B, if it doesnt then it is already in col B."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447173639, "post_id": 33633417, "comment_id": 55043859, "body": "How long does it take with your current code?  Is that too slow?"}, {"owner": {"reputation": 212, "user_id": 5463410, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7a7cec411c86ab8d42f4a831c0241b6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny Nguyen", "link": "https://stackoverflow.com/users/5463410/kenny-nguyen"}, "edited": false, "score": 0, "creation_date": 1447334839, "post_id": 33633417, "comment_id": 55117719, "body": "This is a lot of questions to answer so i&#39;ll try my best:  -This is a collection of custom objects (each object is a class containing strings and long variable)  -The long variables in each object is a range (long x for min and long y for max, together they form a range). Both Collection (A and B) have the same object. So I&#39;m comparing the range overlap, i.e if range(x,y) of collection A overlaps with range(x,y) of collection B then add that object from collection A to a new collection."}, {"owner": {"reputation": 212, "user_id": 5463410, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7a7cec411c86ab8d42f4a831c0241b6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny Nguyen", "link": "https://stackoverflow.com/users/5463410/kenny-nguyen"}, "edited": false, "score": 0, "creation_date": 1447335109, "post_id": 33633417, "comment_id": 55117906, "body": "-This whole process takes about 1 hour to complete. However while testing it, after iterating through 500 indexes from Collection A, it just freezes. In this case Collection A has 28000 indexes, collection B has 5800. So for every Collection A index, it<code>ll need to iterate through 5800 objects. I</code>m aware these are large numbers but I don&#39;t think it should&#39;ve froze."}], "owner": {"reputation": 212, "user_id": 5463410, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7a7cec411c86ab8d42f4a831c0241b6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny Nguyen", "link": "https://stackoverflow.com/users/5463410/kenny-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1447169068, "creation_date": 1447168939, "last_edit_date": 1447169068, "question_id": 33633417, "link": "https://stackoverflow.com/questions/33633417/vba-reducing-time-complexity-of-nested-for-loop", "title": "VBA Reducing time complexity of nested for-loop", "body": "<p>I have 2 Collections (Collection A, Collection B) and every object in A has to compare itself with EVERY object in B (cannot exit early). Unfortunately this causes an O(n^2) complexity. Keep in mind, both A and B are very large (1000+).</p>\n\n<p>My question is: are there any alternative ways to go about this? Also does VBA have a simple built in function which deals with this?</p>\n"}]