[{"tags": ["vba", "events", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 182, "user_id": 1972664, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8b338577d7494f9a5d3f1c862d006ac?s=128&d=identicon&r=PG", "display_name": "Martin Lundberg", "link": "https://stackoverflow.com/users/1972664/martin-lundberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1571527100, "creation_date": 1571527100, "answer_id": 58468809, "question_id": 58422909, "link": "https://stackoverflow.com/questions/58422909/last-element-of-an-outlook-email-conversation-doesnt-trigger-the-application-it/58468809#58468809", "title": "Last element of an Outlook email conversation doesn&#39;t trigger the Application_ItemLoad event in VBA", "body": "<p>I might have found it.\nIn my helper module I had this:<br>\n<code>Public EventsDisable, unReadWhenSelected As Boolean</code>.  </p>\n\n<p>From a great <a href=\"https://stackoverflow.com/questions/13763955/object-required-error-in-outlook-vba\">Stack Overflow post</a> and Rick Rothstein's contribution on <a href=\"http://dailydoseofexcel.com/archives/2012/05/01/quick-vba-tip-parentheses/\" rel=\"nofollow noreferrer\">DailyDoseOfExcel.com</a> I learned that declaring variables with comma separation leads to the first variable being declared as <strong><em>Variant</em></strong> instead of the intended <em>Boolean</em>. </p>\n\n<p>I just changed to the following and <strong>the error is gone</strong>.</p>\n\n<pre><code>Public EventsDisable As Boolean\nPublic unReadWhenSelected As Boolean\n</code></pre>\n\n<p>I still cannot explain why this weird error happens when EventsDisable is declared as <em>Variant</em>. So, if anybody knows, feel free.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\n' When doubleclick opening unread mails, they are automatically marked 'read'. This code will mark them 'unread'.\n' Despite that, emails that have been read already and then doubleclick opened will stay 'read'.\n' In other words: Doubleclicking a mail won't change its unread property\nPublic WithEvents myItem As Outlook.mailItem\n\nPrivate Sub Application_ItemLoad(ByVal Item As Object)\n    MsgBox \"Item loaded\"\n    'If EventsDisable = True Then Exit Sub\n    If Item.Class = olMail Then\n            Set myItem = Item\n     End If\nEnd Sub\n\nPrivate Sub myItem_Read()\n    unReadWhenSelected = myItem.UnRead\nEnd Sub\n\n\nPrivate Sub myItem_PropertyChange(ByVal Name As String)\n    If EventsDisable = True Then Exit Sub\n    If Name = \"UnRead\" Then\n        If unReadWhenSelected = True And myItem.UnRead = False Then\n            myItem.UnRead = True\n            myItem.Save\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 182, "user_id": 1972664, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8b338577d7494f9a5d3f1c862d006ac?s=128&d=identicon&r=PG", "display_name": "Martin Lundberg", "link": "https://stackoverflow.com/users/1972664/martin-lundberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1584431563, "creation_date": 1571268504, "last_edit_date": 1584431563, "question_id": 58422909, "link": "https://stackoverflow.com/questions/58422909/last-element-of-an-outlook-email-conversation-doesnt-trigger-the-application-it", "title": "Last element of an Outlook email conversation doesn&#39;t trigger the Application_ItemLoad event in VBA", "body": "<p>I wrote a Visual Basic macro to mark an opened email as 'unread' again.\nFor this, I used the event 'Application_ItemLoad' as you see below. However, when testing this for email conversations of Outlook's <em>group by conversation</em> function I noticed something weird: </p>\n\n<p>The event won't fire at all when opening the last element of such a conversation group by double clicking it.</p>\n\n<p>Please enlighten me why for every other email this event fires without any problems but only for the last element of a conversation group it does not.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571266509, "post_id": 58422359, "comment_id": 103187550, "body": "At one point you say you&#39;re working with a text box, and then you say a range. Can you clarify which one it is?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1571267213, "post_id": 58422359, "comment_id": 103187704, "body": "The variable <code>Path</code> is not declared, just as the error message says..."}], "answers": [{"tags": [], "owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "is_accepted": false, "score": 1, "last_activity_date": 1571267369, "creation_date": 1571267369, "answer_id": 58422792, "question_id": 58422359, "link": "https://stackoverflow.com/questions/58422359/select-file-and-display-path/58422792#58422792", "title": "Select file and display path", "body": "<p>I suggest you rename <code>Data</code> to something more meaningful. I've changed it to just <code>FileDialog</code>. The reason for your error is that the code has no idea what <code>Path</code> is. Note that I omitted the clearing of the filter, it is not needed.</p>\n\n<pre><code>Option Explicit 'always have this\n\nDim strPath As String 'explicitly declare your variable\n\n Sub SelectMonthlyFile()\n\n   Dim FileDialog As Office.FileDialog\n\n   Set FileDialog = Application.FileDialog(msoFileDialogFilePicker)\n\n   With FileDialog\n     .AllowMultiSelect = False\n     .Title = \"Please select the file.\"\n     .Filters.Add \"Excel 2003\", \"*.xls\"\n     .Filters.Add \"All Files\", \"*.*\"\n\n    'was anything selected?\n     If .Show &lt;&gt; 0 Then\n        strPath = .SelectedItems(1)\n        Debug.Print strPath\n     End If\n\n    End With\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11574727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49adca5d97c5b994f2856beb6bb87089?s=128&d=identicon&r=PG&f=1", "display_name": "SamiiiWarr", "link": "https://stackoverflow.com/users/11574727/samiiiwarr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576172924, "creation_date": 1571264165, "last_edit_date": 1576172924, "question_id": 58422359, "link": "https://stackoverflow.com/questions/58422359/select-file-and-display-path", "title": "Select file and display path", "body": "<p>I am trying to show the path of a file I select from a dialog box, in a text box. </p>\n\n<pre><code>Sub SelectMonthlyFile()\n\n    Dim Data As Office.FileDialog\n\n    Set Data = Application.FileDialog(msoFileDialogFilePicker)\n\n    With Data\n        .AllowMultiSelect = False\n        .Title = \"Please select the file.\"\n        .Filters.Clear\n        .Filters.Add \"Excel 2003\", \"*.xls\"\n        .Filters.Add \"All Files\", \"*.*\"\n\n        If .Show = True Then\n            Path = .SelectedItems(1)\n        End If\n\n    End With\n\n End Sub\n</code></pre>\n\n<p>I show an error at <code>Path = .SelectedItems(1)</code>.</p>\n\n<blockquote>\n  <p>variable is not defined</p>\n</blockquote>\n\n<p>I named my cell Path and assumed that this would get the file path copied and pasted here.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1571261737, "creation_date": 1571261737, "answer_id": 58421992, "question_id": 58421808, "link": "https://stackoverflow.com/questions/58421808/pasting-values-only-using-vba-error-unable-to-get-the-pastespecial-property-of/58421992#58421992", "title": "Pasting Values Only using VBA: Error &quot;Unable to get the PasteSpecial property of the Range class", "body": "<p>I don't think you can paste values with 1 line in VBA, so you'll need to split that into two lines:</p>\n\n<pre><code>SrcRng.Copy\n.Cells(LRDest + 1, 2).PasteSpecial (xlPasteValues)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 2, "last_activity_date": 1571294643, "creation_date": 1571294643, "answer_id": 58426401, "question_id": 58421808, "link": "https://stackoverflow.com/questions/58421808/pasting-values-only-using-vba-error-unable-to-get-the-pastespecial-property-of/58426401#58426401", "title": "Pasting Values Only using VBA: Error &quot;Unable to get the PasteSpecial property of the Range class", "body": "<p>since you're interested in pasting values only, a one liner would be:</p>\n\n<pre><code>.Cells(LRDest + 1, 2).Resize(SrcRng.Rows.Count, SrcRng.Columns.Count).Value = SrcRng.Value            \n</code></pre>\n\n<p>and to shorten the whole thing down a little bit more:</p>\n\n<pre><code>With Sheets(\"General inventory\")\n    .Cells(.Rows.Count, 2).End(xlUp).Offset(1).Resize(SrcRng.Rows.Count, SrcRng.Columns.Count).Value = SrcRng.Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 12090057, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA-r2c3rGAh-8tgLu4ecDRwAbgR-eCBebL9TPe-=k-s128", "display_name": "Baldomero", "link": "https://stackoverflow.com/users/12090057/baldomero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 58426401, "answer_count": 2, "score": 1, "last_activity_date": 1571294643, "creation_date": 1571260476, "last_edit_date": 1571290641, "question_id": 58421808, "link": "https://stackoverflow.com/questions/58421808/pasting-values-only-using-vba-error-unable-to-get-the-pastespecial-property-of", "title": "Pasting Values Only using VBA: Error &quot;Unable to get the PasteSpecial property of the Range class", "body": "<p>I'm trying to get a small macro to work. Basically, all I want to change is making it paste only values. </p>\n\n<p>I did not write most of this code, only a few snippets. And it goes like this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim LRSrc As Long, LRDest As Long, SrcRng As Range\n\nWith Sheets(\"Input sheet\")\n    LRSrc = .Cells(.Rows.Count, 1).End(xlUp).Row 'assumes column 1 is contiguous\n    Set SrcRng = .Range(\"A2:G\" &amp; LRSrc)\nEnd With\nIf WorksheetFunction.CountA(Range(\"A2:G2\")) = 0 Then\nDim emptyErr As Integer\nemptyErr = MsgBox(\"Data missing or incomplete! Please type in all the fields, starting from row 2\", vbOKOnly, \"No data\")\n\nElse\n\nWith Sheets(\"General inventory\")\n    LRDest = .Cells(.Rows.Count, 2).End(xlUp).Row\n    SrcRng.Copy .Cells(LRDest + 1, 2)\nEnd With\nDim answer As Integer\nanswer = MsgBox(\"Data sent to inventory! Do you wish to clear the sheet?\", vbYesNo + vbQuestion, \"Empty Sheet\")\nIf answer = vbYes Then\n    SrcRng.ClearContents\n\nEnd If\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I tried to solve it making these changes:</p>\n\n<pre><code>With Sheets(\"General inventory\")\n    LRDest = .Cells(.Rows.Count, 2).End(xlUp).Row\n    SrcRng.Copy .Cells(LRDest + 1, 2).PasteSpecial(xlPasteValues)\nEnd With\nDim answer As Integer\nanswer = MsgBox(\"Data sent to inventory! Do you wish to clear the sheet?\", vbYesNo + vbQuestion, \"Empty Sheet\")\nIf answer = vbYes Then\n    SrcRng.ClearContents\n</code></pre>\n\n<p>But it gives me the error </p>\n\n<blockquote>\n  <p>Runtime error '1004':</p>\n  \n  <p>Unable to get the paste special property of the Range class</p>\n</blockquote>\n\n<p>I have no idea of how to fix it, or whether I should be using <code>PasteSpecial</code> at all.</p>\n\n<p>I appreciate the time you may have taken to read this, and thank you for any advice you may give.</p>\n\n<p>Cheers, </p>\n\n<p>David.-</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1571259824, "post_id": 58421515, "comment_id": 103185544, "body": "Turn on the macro recorder while you perform the action(s) you want to automate, then use the generated code as a starting point"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7396713, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TWREsf1oWjE/AAAAAAAAAAI/AAAAAAAAAH8/ZYfxcnMRKWg/photo.jpg?sz=128", "display_name": "emiwark", "link": "https://stackoverflow.com/users/7396713/emiwark"}, "reply_to_user": {"reputation": 1, "user_id": 12228990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d82ae75aedbf2cba27ffb1e911e99885?s=128&d=identicon&r=PG&f=1", "display_name": "K_Daley", "link": "https://stackoverflow.com/users/12228990/k-daley"}, "edited": false, "score": 0, "creation_date": 1571264661, "post_id": 58421614, "comment_id": 103187093, "body": "I will edit my original comment (formatting is hard)."}], "tags": [], "owner": {"reputation": 25, "user_id": 7396713, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TWREsf1oWjE/AAAAAAAAAAI/AAAAAAAAAH8/ZYfxcnMRKWg/photo.jpg?sz=128", "display_name": "emiwark", "link": "https://stackoverflow.com/users/7396713/emiwark"}, "is_accepted": false, "score": 0, "last_activity_date": 1571264989, "last_edit_date": 1571264989, "creation_date": 1571259468, "answer_id": 58421614, "question_id": 58421515, "link": "https://stackoverflow.com/questions/58421515/how-to-activate-a-tables-sort-feature-with-vba/58421614#58421614", "title": "How To Activate A Table&#39;s Sort Feature With VBA?", "body": "<p>When you say 'activate' do you mean 'select' or are you trying to filter the table?</p>\n\n<hr>\n\n<p><strong>Answer:</strong>\nYou can filter the table like this...</p>\n\n<pre><code>Sub name()\nActiveSheet.Range(\"$A$1:$C$50\").AutoFilter Field:=5, Criteria1:=\"&lt;your criteria&gt;\", _\nOperator:=xlAnd, Criteria2:=\"&lt;more criteria&gt;\"\nEnd Sub\n</code></pre>\n\n<p>Where <code>Range(\"$A$1:$C$50\")</code> is your table range, <code>Field:=5</code> is the column number you want to filter on (e.g. 2 for column B, 5 for column E, etc), and <code>Criteria1</code> is what you want to filter on. You can use <code>xlAnd</code> or <code>xlOr</code> for the <code>Operator</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 12228990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d82ae75aedbf2cba27ffb1e911e99885?s=128&d=identicon&r=PG&f=1", "display_name": "K_Daley", "link": "https://stackoverflow.com/users/12228990/k-daley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571264989, "creation_date": 1571258966, "last_edit_date": 1571259903, "question_id": 58421515, "link": "https://stackoverflow.com/questions/58421515/how-to-activate-a-tables-sort-feature-with-vba", "title": "How To Activate A Table&#39;s Sort Feature With VBA?", "body": "<p>I'm writing in VBA and plan to set some values in a table, and then for convenience have the VBA choose a specific column and sort like you could with a mouse. Is there any way to activate the cell that contains that specific header and sort the table?</p>\n"}, {"tags": ["excel", "vba", "variables"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7746636, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102266007614483/picture?type=large", "display_name": "Sean Lee", "link": "https://stackoverflow.com/users/7746636/sean-lee"}, "edited": false, "score": 0, "creation_date": 1571342167, "post_id": 58421785, "comment_id": 103219419, "body": "FndVal Still returned a value of nothing."}, {"owner": {"reputation": 185, "user_id": 10788327, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-W3IVKOR1B1Q/AAAAAAAAAAI/AAAAAAAAABI/iiyc6eWbnrw/photo.jpg?sz=128", "display_name": "mdelapena", "link": "https://stackoverflow.com/users/10788327/mdelapena"}, "reply_to_user": {"reputation": 11, "user_id": 7746636, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102266007614483/picture?type=large", "display_name": "Sean Lee", "link": "https://stackoverflow.com/users/7746636/sean-lee"}, "edited": false, "score": 0, "creation_date": 1571342485, "post_id": 58421785, "comment_id": 103219550, "body": "can you give at least sample data to recreate the issue? because this code is working for me, it returns nothing only when the value is not found"}, {"owner": {"reputation": 11, "user_id": 7746636, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102266007614483/picture?type=large", "display_name": "Sean Lee", "link": "https://stackoverflow.com/users/7746636/sean-lee"}, "edited": false, "score": 0, "creation_date": 1571689688, "post_id": 58421785, "comment_id": 103317229, "body": "It worked!  I spelled the sheet name wrong.  Thanks for the help"}], "tags": [], "owner": {"reputation": 185, "user_id": 10788327, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-W3IVKOR1B1Q/AAAAAAAAAAI/AAAAAAAAABI/iiyc6eWbnrw/photo.jpg?sz=128", "display_name": "mdelapena", "link": "https://stackoverflow.com/users/10788327/mdelapena"}, "is_accepted": true, "score": 0, "last_activity_date": 1571260377, "creation_date": 1571260377, "answer_id": 58421785, "question_id": 58421421, "link": "https://stackoverflow.com/questions/58421421/how-to-get-a-cell-range-to-select-and-copy-based-off-of-cell-value/58421785#58421785", "title": "How to get a cell range to select and copy based off of cell value", "body": "<p>If this code is in a <code>UserForm</code> try specifing the <code>Sheet</code> you are refering to.</p>\n\n<p>Example:</p>\n\n<pre><code>Set FndVal = Sheets(\"Data\").Columns(\"J:J\").Find(What:=FndStr, LookAt:=xlPart)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7746636, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102266007614483/picture?type=large", "display_name": "Sean Lee", "link": "https://stackoverflow.com/users/7746636/sean-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 58421785, "answer_count": 1, "score": 1, "last_activity_date": 1571315352, "creation_date": 1571258567, "last_edit_date": 1571315352, "question_id": 58421421, "link": "https://stackoverflow.com/questions/58421421/how-to-get-a-cell-range-to-select-and-copy-based-off-of-cell-value", "title": "How to get a cell range to select and copy based off of cell value", "body": "<p>I want to select and copy a cell range.  I have the user choosing what data they want from a combo box.  Once the data is chosen, they hit a button that runs the code below:</p>\n\n<pre><code>Private Sub btnEnter_Click()\n'''''WHAT HAPPENS WHEN BUTTON IS CLICKED'''''\n\n'TARGET CELL REFERENCE\nDim TargetRow As Integer\nTargetRow = Application.WorksheetFunction.Match(ComboBox1, Sheets(\"Inprocess\").Range(\"Sku_Range1\"), 0)\nSheets(\"Data\").Range(\"G3\").Value = TargetRow\n\n'COPY &amp; SELECT CELL RANGE FROM TARGET CELL\nDim FndStr As String\nFndStr = TargetRow\nDim FndVal As Range\nSet FndVal = Columns(\"J:J\").Find(What:=FndStr, LookAt:=xlPart)\n    If FndVal Is Nothing Then\n        MsgBox \"LP not found!!\"\n    Else\n        FndVal.Select\n        Range(Selection.Offset(0, -1), Selection.Offset(0, 2)).Copy\n    End If\n\n\nEnd Sub\n</code></pre>\n\n<p>My issue is that FndVal is returning nothing and I cant seem to figure out why.  Could someone please help?</p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1571257469, "post_id": 58421155, "comment_id": 103184541, "body": "See: <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\" title=\"how to use regular expressions regex in microsoft excel both in cell and loops\">stackoverflow.com/questions/22542834/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1571259732, "post_id": 58421439, "comment_id": 103185506, "body": "Can you explain how this works? I don&#39;t like copy/pasting code without understanding it better.   It looks like you try to change ) into )( and then split the string by ( so it ends up as:  &quot;apple, orange, &quot;, &quot;pear, banana, grape)&quot; and &quot;, mango&quot;  Then you check if ) exists in the result and if so replace commas with |  Then you later replace | with comas again...?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1571260409, "post_id": 58421439, "comment_id": 103185737, "body": "Yes, that is exactly how it works. After replacing the <code>,</code> with <code>|</code> I split on the <code>,</code> and since not <code>,</code> exist at that time it does not split the words inside the <code>()</code>.  Then as a last step I remove any extraneous spaces from the output."}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1571262456, "post_id": 58421439, "comment_id": 103186429, "body": "Without being able to share my spreadsheet, I was able to incorporate your logic in my code and got it to work for the most part.  I am looping over each row in a given range. And for each row, I try to access finalSplt(0), finalSplt(1), and finalSplt(2) unique to that row to access first, second, and third elements in the array."}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1571262631, "post_id": 58421439, "comment_id": 103186475, "body": "finalSplt(0) seems to work consistently, but when I try to access finalSplt(1) or finalSplt(2) and add it to the value of a new cell, only some of the elements get written.  e.g. if finalSplt(0) = apple, finalSplt(1) = (pear, banana, orange, grape), and finalSplt(2) = mango, I sometimes only get the first two results.  Eventually I get a subscript out of range error. Are there any limitations to using an approach that would cause this, or is it likely something else with my code?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1571262770, "post_id": 58421439, "comment_id": 103186520, "body": "It means you have fewer &quot;words&quot; in the split array.  If the string is only <code>Apple, (Pear, Orange, Banana)</code> there are only <code>finalSplt(0)</code> and <code>finalSplt(1)</code>.  <code>finalSplt(2)</code> would error as there is no such item for that line."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1571262910, "post_id": 58421439, "comment_id": 103186577, "body": "@Kamui see edit.  I have changed the last line to output the result in a column.  You only need to change the <code>&quot;A1&quot;</code> to the first cell in each row where you wan the output.  Then it is not reliant on the number of items but is dynamic."}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1571263029, "post_id": 58421439, "comment_id": 103186610, "body": "Yes that makes sense. Not all rows will have three elements. Is there a check I can add to ensure the code doesn&#39;t get interrupted if I can&#39;t fill all elements in my array?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1571263113, "post_id": 58421439, "comment_id": 103186637, "body": "At this point you need to ask a new question showing the part of the code that is in error with desired outcome and inputs."}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1571263161, "post_id": 58421439, "comment_id": 103186648, "body": "Ok if I can&#39;t figure this separate part out I&#39;ll add a new thread. Thank you for your help!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1571262842, "last_edit_date": 1571262842, "creation_date": 1571258640, "answer_id": 58421439, "question_id": 58421155, "link": "https://stackoverflow.com/questions/58421155/how-can-i-split-an-array-in-vba-with-a-delimiter-based-on-a-regex-condition/58421439#58421439", "title": "How can I split an array in VBA with a delimiter based on a regex condition?", "body": "<p>Alternative to RegEx:</p>\n\n<pre><code>Sub mytry()\n    Dim str As String\n    str = \"apple, orange, (pear, banana, grape), mango \"\n\n    Dim perenSplt() As String\n    perenSplt = Split(Replace(str, \")\", \")(\"), \"(\")\n\n    str = \"\"\n\n    Dim i As Long\n    For i = LBound(perenSplt) To UBound(perenSplt)\n        If InStr(perenSplt(i), \")\") Then\n            perenSplt(i) = \"(\" &amp; Replace(perenSplt(i), \",\", \"|\")\n        End If\n        str = str &amp; perenSplt(i)\n    Next i\n\n    Dim finalSplt() As String\n    finalSplt = Split(str, \",\")\n\n    For i = LBound(finalSplt) To UBound(finalSplt)\n        If InStr(str, \"(\") &gt; 0 Then\n            finalSplt(i) = Trim(Replace(finalSplt(i), \"|\", \",\"))\n        Else\n            finalSplt(i) = Trim(finalSplt(i))\n        End If\n    Next i\n\n    ActiveSheet.Range(\"A1\").Resize(,UBound(finalSplt) + 1) = finalSplt\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/9fuBA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9fuBA.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1571294065, "creation_date": 1571294065, "answer_id": 58426279, "question_id": 58421155, "link": "https://stackoverflow.com/questions/58421155/how-can-i-split-an-array-in-vba-with-a-delimiter-based-on-a-regex-condition/58426279#58426279", "title": "How can I split an array in VBA with a delimiter based on a regex condition?", "body": "<p>another possibility out of RegEx:</p>\n\n<pre><code>Function GetArray(ByVal str As String) As Variant       \n    Dim s As String, v As Variant\n    For Each v In Split(Replace(str &amp; \" \", \")\", \"(\"), \"(\")\n        s = s &amp; IIf(Right(v, 1) &lt;&gt; \" \", \"(\" &amp; v &amp; \")\", Replace(v, \",\", \"|\"))\n    Next\n\n    GetArray = Split(Replace(WorksheetFunction.Trim(s), \"| \", \"|\"), \"|\")\nEnd Function\n</code></pre>\n\n<p>which you can use in your main code like:</p>\n\n<pre><code>    Dim myArray As Variant        \n    myArray = GetArray(\"apple, orange, (pear, banana, grape), mango\")\n    Range(\"A1\").Resize(ubound(myArray) + 1).Value = Application.Transpose(myArray)\n</code></pre>\n"}], "owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 58421439, "answer_count": 2, "score": 1, "last_activity_date": 1571294065, "creation_date": 1571257331, "last_edit_date": 1571257638, "question_id": 58421155, "link": "https://stackoverflow.com/questions/58421155/how-can-i-split-an-array-in-vba-with-a-delimiter-based-on-a-regex-condition", "title": "How can I split an array in VBA with a delimiter based on a regex condition?", "body": "<p>I have an input like:</p>\n\n<pre><code>apple, orange, (pear, banana, grape), mango \n</code></pre>\n\n<p>that I want to split as:</p>\n\n<pre><code>apple\norange\n(pear, banana, grape)\nmango\n</code></pre>\n\n<p>I don't understand the regex fully, but I think I would use ,(?![^()]*)) which I found here - <a href=\"https://stackoverflow.com/questions/31993153/java-split-string-on-comma-except-when-between-parenthesis\">Java split string on comma(,) except when between parenthesis ()</a></p>\n\n<p>I am using VBA, so if I have the input stored in an array, I would typically do:</p>\n\n<pre><code>array = Split(string, \",\")\n</code></pre>\n\n<p>But this would yield the result as:</p>\n\n<pre><code>apple\norange\n(pear\nbanana\ngrape)\nmango\n</code></pre>\n\n<p>which I don't want.</p>\n\n<p>I'm pretty sure I can find a way to replace ( and ) with nothing so they disappear from the output, but I don't know how to feed my regex string logic to my VBA formula.</p>\n\n<p>I thought something like this would work:</p>\n\n<pre><code>array = Split(string, \",(?![^()]*\\))\")\n</code></pre>\n\n<p>But it doesn't. I did enable the \"Microsoft VBScript Regular Expressions 5.5\" reference but it didn't seem to help.</p>\n\n<p>Any advice is appreciated.</p>\n\n<p>Thank you,</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 5684, "user_id": 1657610, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/kcTi0.png?s=128&g=1", "display_name": "Reg Edit", "link": "https://stackoverflow.com/users/1657610/reg-edit"}, "edited": false, "score": 0, "creation_date": 1571256813, "post_id": 58420991, "comment_id": 103184235, "body": "Taken literally, the error message would suggest it&#39;s the other (active) sheet that&#39;s protected. Have you tried unprotecting that too?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571256834, "post_id": 58420991, "comment_id": 103184246, "body": "I can&#39;t repro based on what you&#39;ve provided (assuming the active sheet is unprotected)."}, {"owner": {"reputation": 153, "user_id": 4250405, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b5a14253a206c98e212e046e555a5493?s=128&d=identicon&r=PG&f=1", "display_name": "Jamie Sutton", "link": "https://stackoverflow.com/users/4250405/jamie-sutton"}, "edited": false, "score": 0, "creation_date": 1571257067, "post_id": 58420991, "comment_id": 103184354, "body": "The active sheet is not protected. What&#39;s weird is if I change the data source (by adding 1 row or removing 1 row) all of a sudden it works. It&#39;s only when I save, and reopen the file I get the error again."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571257241, "post_id": 58420991, "comment_id": 103184440, "body": "Still no repro. I don&#39;t even need to unprotect/protect. Can you explain more about your setup?"}, {"owner": {"reputation": 153, "user_id": 4250405, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b5a14253a206c98e212e046e555a5493?s=128&d=identicon&r=PG&f=1", "display_name": "Jamie Sutton", "link": "https://stackoverflow.com/users/4250405/jamie-sutton"}, "edited": false, "score": 0, "creation_date": 1571257723, "post_id": 58420991, "comment_id": 103184664, "body": "2 sheets - 1 sheet where staff put data dumps from our bespoke system into. There are defined headers and a macro to run to ensure the data is valid. Once validated, they move to the second sheet which is the pivot table off of that data (it&#39;s a named range with offset as the data could grow/shrink depending on the week). If i alter the offset to minus one row the pivot refreshes. Once I save and reopen the file I get this error."}, {"owner": {"reputation": 153, "user_id": 4250405, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b5a14253a206c98e212e046e555a5493?s=128&d=identicon&r=PG&f=1", "display_name": "Jamie Sutton", "link": "https://stackoverflow.com/users/4250405/jamie-sutton"}, "edited": false, "score": 0, "creation_date": 1571262736, "post_id": 58420991, "comment_id": 103186512, "body": "Okay, I actually have 4 pivot tables across 3 sheets - I didn&#39;t think that would be part of the problem but now I believe this is what is causing the issue..apparently when the same data source is used for Pivot tables they now share the save pivot cache, which I believe is my issue. Extremely frustrating and still no closer to figuring it out."}], "answers": [{"tags": [], "owner": {"reputation": 14, "user_id": 10379082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/291f9439d0c06b2549ac372c487230cf?s=128&d=identicon&r=PG&f=1", "display_name": "Neelavathy", "link": "https://stackoverflow.com/users/10379082/neelavathy"}, "is_accepted": false, "score": 0, "last_activity_date": 1572435481, "creation_date": 1572435481, "answer_id": 58624542, "question_id": 58420991, "link": "https://stackoverflow.com/questions/58420991/refresh-pivot-on-protected-sheet-error-even-though-unprotect-in-vba/58624542#58624542", "title": "Refresh Pivot on Protected Sheet - error even though unprotect in VBA", "body": "<p>Since pivot tables are in protected sheets, you get this error,so you need to unprotect them before refreshing </p>\n\n<p>so have a refresh button in each sheet and assign this  macro below,</p>\n\n<p>g_sPassword-> is the password to unprotect the sheet, I have declared that as a variable ,so I use it directly</p>\n\n<p>Sub RefreshPtInFirstsheet()</p>\n\n<pre><code>Call RefreshPivotTables(sheetname1)\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Sub RefreshPtInSecondsheet()</p>\n\n<pre><code>Call RefreshPivotTables(sheetname2)\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Sub RefreshPivotTables(sht As Worksheet)</p>\n\n<pre><code>Dim pt As pivotTable\n\nsheetname1.Unprotect g_sPassword\nsheetname2.Unprotect g_sPassword\nFor Each pt In sht.PivotTables\n    pt.PivotCache.Refresh\n    Exit For\nNext pt\nsheetname1.Protect g_sPassword\nsheetname2.Protect g_sPassword\nMsgBox \"Pivot Table Updated\"\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 153, "user_id": 4250405, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b5a14253a206c98e212e046e555a5493?s=128&d=identicon&r=PG&f=1", "display_name": "Jamie Sutton", "link": "https://stackoverflow.com/users/4250405/jamie-sutton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 285, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572435481, "creation_date": 1571256571, "question_id": 58420991, "link": "https://stackoverflow.com/questions/58420991/refresh-pivot-on-protected-sheet-error-even-though-unprotect-in-vba", "title": "Refresh Pivot on Protected Sheet - error even though unprotect in VBA", "body": "<p>I have a pivot table that automatically refreshes on sheet activation, with data from another tab which is protected. Even though I unprotect the tab prior to refreshing, I still get:</p>\n\n<pre><code>Run-time error '1004':\nCannot edit PivotTable on protected sheet.\n</code></pre>\n\n<p>My VBA:</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n   Sheets(\"Extract\").Unprotect \"password\"\n   ActiveSheet.PivotTables(\"pvt_Activity\").PivotCache.Refresh\n   Sheets(\"Extract\").Protect Password:=\"password\", Contents:=True, Scenarios:=True\nEnd Sub\n</code></pre>\n\n<p>Banging my head against a wall - why is this not working?</p>\n\n<p>Cheers</p>\n"}, {"tags": ["excel", "vba", "for-loop"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1571255915, "post_id": 58420807, "comment_id": 103183835, "body": "Why do you want to do this? Can you explain what your use case is / what you&#39;re actually trying to do?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1571256058, "post_id": 58420807, "comment_id": 103183902, "body": "Once it is set the for loop end cannot be changed."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1571256095, "post_id": 58420807, "comment_id": 103183925, "body": "You need to change to a Do While or Do Until loop"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571256422, "post_id": 58420807, "comment_id": 103184082, "body": "Note - if <code>LR</code> were actually changed in the for loop, then your loop would be an infinite one, it wouldn&#39;t stop at row 20. But as already pointed out, this sounds like an X-Y problem, we need more detail on what you actually are trying to do."}, {"owner": {"reputation": 363, "user_id": 6178088, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10101152076236969/picture?type=large", "display_name": "Chris Kiniry", "link": "https://stackoverflow.com/users/6178088/chris-kiniry"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571322094, "post_id": 58420807, "comment_id": 103210022, "body": "@BigBen you are correct that I had accidentally created an infinite loop. I edited the code to only increment LR up if some condition is true which I had intended to do before."}, {"owner": {"reputation": 363, "user_id": 6178088, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10101152076236969/picture?type=large", "display_name": "Chris Kiniry", "link": "https://stackoverflow.com/users/6178088/chris-kiniry"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1571322154, "post_id": 58420807, "comment_id": 103210057, "body": "@ScottCraner Thank you for clarifying that I need to use a Do While or Unitl Loop. It made sense to that I could modify LR inside of the loop, but obviously that was not working. I was able to accomplish the task using your advice. Thank you for suggesting it."}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 2275525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/94715f087eceeaf7dd0361926b0e43f6?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/2275525/tim"}, "is_accepted": false, "score": 0, "last_activity_date": 1571260435, "creation_date": 1571260435, "answer_id": 58421798, "question_id": 58420807, "link": "https://stackoverflow.com/questions/58420807/vba-for-loop-go-longer-than-initially-planned/58421798#58421798", "title": "VBA For Loop - go longer than initially planned", "body": "<p>I believe Scott is correct.</p>\n\n<p>UNTESTED</p>\n\n<pre><code>Sub Test()\nLR = 10\n\nDo Until LR = 20\n    'Inside the loop you can use Exit Sub if a condition is meet before LR = 20\n    If LR &gt; 20 Then\n        Exit Sub\n    End If\n    LR = LR + 1\nLoop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 363, "user_id": 6178088, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10101152076236969/picture?type=large", "display_name": "Chris Kiniry", "link": "https://stackoverflow.com/users/6178088/chris-kiniry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571322031, "creation_date": 1571255682, "last_edit_date": 1571322031, "question_id": 58420807, "link": "https://stackoverflow.com/questions/58420807/vba-for-loop-go-longer-than-initially-planned", "title": "VBA For Loop - go longer than initially planned", "body": "<p>I would like to have an excel VBA For Loop that can go longer than I initially planned. For example:</p>\n\n<pre><code>Sub Test()\n LR = 10\n\n For i = 1 To LR\n    Cells(i, 1).Value = 1\n    If Cells(i, 2).Value &lt;&gt; \"\" Then\n       LR = LR + 1\n    End If\n Next i\nEnd Sub\n</code></pre>\n\n<p>Assuming there were contents in column 2/B, I am expecting to add 1 to LR at each iteration. I would expect this loop to continue to row 20. It is stopping on row 10 which is initially what is declared. How do I get around this issue, and have the loop go longer if I need to extend it based on a condition?</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12228563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56fa6f748353e49fb34c314bdefac1c9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/12228563/peter"}, "edited": false, "score": 0, "creation_date": 1571351863, "post_id": 58421044, "comment_id": 103222673, "body": "Thanks I will try it this weekend"}, {"owner": {"reputation": 1, "user_id": 12228563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56fa6f748353e49fb34c314bdefac1c9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/12228563/peter"}, "edited": false, "score": 0, "creation_date": 1571376186, "post_id": 58421044, "comment_id": 103227495, "body": "I\u2019ve tried it., but i get an error: unable to get the axes property of Chart class. The code i wrote: me.Graph1.object.axes(xlValue).maximumscale=3"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 1, "user_id": 12228563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56fa6f748353e49fb34c314bdefac1c9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/12228563/peter"}, "edited": false, "score": 0, "creation_date": 1571380137, "post_id": 58421044, "comment_id": 103228800, "body": "I edited answer to show complete procedures. Note <code>.Object</code> is not used."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1571379856, "last_edit_date": 1571379856, "creation_date": 1571256812, "answer_id": 58421044, "question_id": 58420658, "link": "https://stackoverflow.com/questions/58420658/change-number-of-categories-between-tick-mark-labels-on-chart-x-axis/58421044#58421044", "title": "Change Number of Categories between Tick-Mark Labels on Chart X-axis", "body": "<p>Example code from my db for XYScatter chart. xlCategory is for X-axis and xlValue is Y-axis.</p>\n\n<ol>\n<li>this procedure is in a standard module and called by a form and a report</li>\n</ol>\n\n<pre><code>Sub FormatProcGraph(strObject As String, strLabNum As String, booMetric As Boolean, dblOMC, dblMDD)\n'format Proctor graph on form and report\nDim obj As Object\nDim gc As Object\nDim intMaxD As Integer\nDim intMinD As Integer\nDim intM As Integer\nIf strObject Like \"Lab*\" Then\n    Set obj = Reports(strObject)\nElse\n    Set obj = Forms(strObject).Controls(\"ctrProctor\").Form\nEnd If\nSet gc = obj(\"gphDensity\")\nintMaxD = Nz(Int(dblMDD), 0)\nintMinD = Nz(Int(DMin(\"D\", \"GraphProctor\", \"Source='Lab' AND LabNum='\" &amp; strLabNum &amp; \"'\")), 0)\nWith gc\n'format y axis scale\nIf booMetric = True Then\n    intMaxD = intMaxD + IIf(intMaxD - intMinD &lt; 125, 50, IIf(intMaxD - intMinD &lt; 250, 25, 0))\n    .Axes(xlValue).MaximumScale = intMaxD\n    .Axes(xlValue).MinimumScale = intMaxD - 250\n    .Axes(xlValue).MajorUnit = 50\n    .Axes(xlValue).MinorUnit = 10\nElse\n    intMaxD = intMaxD + IIf(intMaxD - intMinD &lt; 6, 2, IIf(intMaxD - intMinD &lt; 10, 1, 0))\n    .Axes(xlValue).MaximumScale = intMaxD\n    .Axes(xlValue).MinimumScale = intMaxD - 10\n    .Axes(xlValue).MajorUnit = 2\n    .Axes(xlValue).MinorUnit = 0.4\nEnd If\n'format x axis scale\nIf Int(dblOMC) &gt; 6 Then\n    intM = Int(dblOMC) + IIf(dblOMC - Int(dblOMC) &gt;= 0.5, 1, 0)\n    .Axes(xlCategory).MaximumScale = intM + 7\n    .Axes(xlCategory).MinimumScale = intM - 5\nEnd If\n'y axis label\n.Axes(xlValue, xlPrimary).HasTitle = True\nIf booMetric = True Then\n    .Axes(xlValue, xlPrimary).AxisTitle.Text = \"Dry Density, kg/cu.m\"\nEnd If\nEnd With\nEnd Sub\n</code></pre>\n\n<ol start=\"2\">\n<li>this procedure is behind report</li>\n</ol>\n\n<pre><code>Private Sub Detail_Format(Cancel As Integer, FormatCount As Integer)\n'format graphs\nDim MinUWT As Double, MaxUWT As Double\nDim MinDry As Double, MaxDry As Double\nDim MinSoak As Double, MaxSoak As Double\nDim MinRat As Double, MaxRat As Double\nWith Me\nIf Not IsNull(!MinOfA) Then\n    MinUWT = Int(!MinOfU) - IIf(!MaxOfU - !MinOfU &lt;= 2, 3, 1)\n    MaxUWT = MinUWT + 8\n    MinDry = Int(!MinOfD / 5) * 5 - (40 - Int((Int(!MaxOfD / 5) * 5 + 5 - Int(!MinOfD / 5) * 5) / 10) * 10) / 2\n    MaxDry = MinDry + 40\n    MinSoak = Int(!MinOfS / 5) * 5 - (40 - Int((Int(!MaxOfS / 5) * 5 + 5 - Int(!MinOfS / 5) * 5) / 10) * 10) / 2\n    MaxSoak = MinSoak + 40\n    MinRat = Int(!MinOfR / 5) * 5 - (40 - Int((Int(!MaxOfR / 5) * 5 + 5 - Int(!MinOfR / 5) * 5) / 10) * 10) / 2\n    MaxRat = MinRat + 40\n    .gphWeight.Axes(xlValue).MinimumScale = MinUWT\n    .gphWeight.Axes(xlValue).MaximumScale = MaxUWT\n    .gphITSdry.Axes(xlValue).MinimumScale = MinDry\n    .gphITSdry.Axes(xlValue).MaximumScale = MaxDry\n    .gphITSsoak.Axes(xlValue).MinimumScale = MinSoak\n    .gphITSsoak.Axes(xlValue).MaximumScale = MaxSoak\n    .gphITSret.Axes(xlValue).MinimumScale = MinRat\n    .gphITSret.Axes(xlValue).MaximumScale = MaxRat\n    If Me!Metric = True Then\n        .gphWeight.Axes(xlValue, xlPrimary).AxisTitle.Text = \"Unit Weight, kg/cu.cm\"\n        .gphGradation.Axes(xlCategory, xlPrimary).AxisTitle.Text = \"Sieve Size (mm)\"\n        .gphITSdry.Axes(xlValue, xlPrimary).AxisTitle.Text = \"ITS Dry, kg/cu.cm\"\n        .gphITSsoak.Axes(xlValue, xlPrimary).AxisTitle.Text = \"ITS Soaked, kg/cu.cm\"\n    End If\nEnd If\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12228563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56fa6f748353e49fb34c314bdefac1c9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/12228563/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594421266, "creation_date": 1571255048, "last_edit_date": 1594421266, "question_id": 58420658, "link": "https://stackoverflow.com/questions/58420658/change-number-of-categories-between-tick-mark-labels-on-chart-x-axis", "title": "Change Number of Categories between Tick-Mark Labels on Chart X-axis", "body": "<p>If I have more (or less) data in my Access 2010 graph, I want to decrease (or increase) the number of tick marks on the X-axis. I looked for the right syntax but I couldn't find it. </p>\n\n<p>I did the same for the Y-axis Title and that works fine:</p>\n\n<pre><code>me.Graph1.Object.Axes(2,1).AxisTitles.Caption=\"g/ml\"\n</code></pre>\n\n<p>For number of tick-marks of the X-axis; I've tried a number of words can not find the right one. It stopped at:</p>\n\n<pre><code>me.Graph.Object.Axes(1,1).Scale.???????? (I want a number of categories = 3 )\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1571254839, "post_id": 58420547, "comment_id": 103183421, "body": "Is the idea to loop through rows? I am somehow missing the point. Can you make a screenshot, explaining why <code>Set Capture = Worksheets(&quot;Sheet1&quot;).Range(&quot;A1:C5&quot;)</code> is a problem?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571254866, "post_id": 58420547, "comment_id": 103183434, "body": "Also - <code>cel.Offset(0, 1 + (i - 1) * Capture.Rows.Count).Resize(1, Capture.Rows.Count).Value =  Application.Transpose(Capture.Columns(i).Value)</code> can probably be simplified, but adding a screenshot will help."}, {"owner": {"reputation": 15, "user_id": 11898285, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yILbeumWayI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re2Wm7vl_c_Ce0u2RhSD_DTCVedmQ/photo.jpg?sz=128", "display_name": "Digit Pres", "link": "https://stackoverflow.com/users/11898285/digit-pres"}, "edited": false, "score": 0, "creation_date": 1571291778, "post_id": 58420547, "comment_id": 103193082, "body": "ok I will add the screenshot"}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 11898285, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yILbeumWayI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re2Wm7vl_c_Ce0u2RhSD_DTCVedmQ/photo.jpg?sz=128", "display_name": "Digit Pres", "link": "https://stackoverflow.com/users/11898285/digit-pres"}, "is_accepted": true, "score": 0, "last_activity_date": 1571395945, "creation_date": 1571395945, "answer_id": 58449363, "question_id": 58420547, "link": "https://stackoverflow.com/questions/58420547/how-to-record-data-of-one-excel-sheet-and-store-another-sheet-after-an-interval/58449363#58449363", "title": "How to record data of one excel sheet and store another sheet after an interval", "body": "<p>The correct code could be rewritten as:</p>\n\n<pre><code>Dim NextTime As Double \nSub RecordData()\nDim Interval As Double\nDim cel As Range, Capture As Range\nInterval = 5    'Number of seconds between each recording of data\nSet Capture = Worksheets(\"Sheet1\").Range(\"A2:N2\") 'Capture this column of data\nWith Worksheets(\"Sheet2\")   'Record the data on this worksheet\nSet cel = .Range(\"A5\")  'First timestamp goes here\nSet cel = .Cells(.Rows.Count, cel.Column).End(xlUp).Offset(1, 0)\ncel.Value = Now\ncel.Offset(0, 1).Resize(1, Capture.Cells.Count).Value = Capture.Value\n\n\nEnd With\n\nNextTime = Now + Interval / 86400\nApplication.OnTime NextTime, \"RecordData\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11898285, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yILbeumWayI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re2Wm7vl_c_Ce0u2RhSD_DTCVedmQ/photo.jpg?sz=128", "display_name": "Digit Pres", "link": "https://stackoverflow.com/users/11898285/digit-pres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58449363, "answer_count": 1, "score": -1, "last_activity_date": 1571395945, "creation_date": 1571254497, "last_edit_date": 1571291746, "question_id": 58420547, "link": "https://stackoverflow.com/questions/58420547/how-to-record-data-of-one-excel-sheet-and-store-another-sheet-after-an-interval", "title": "How to record data of one excel sheet and store another sheet after an interval", "body": "<p>I get a VBA code for this but I am not able to capture the data in row wise. It stores column wise data only.</p>\n\n<blockquote>\n<pre><code>Set Capture = Worksheets(\"Sheet1\").Range(\"A1:C5\")\n</code></pre>\n</blockquote>\n\n<p>This code capture the data First A1 to A5 column then B1 to B5 column in the same row and so on. But I am trying to capture like First A1 to C1 in one row then A2 to C2 in next row and so on. Is there any way I can dot it?\n<a href=\"https://i.stack.imgur.com/5hOYc.jpg\" rel=\"nofollow noreferrer\">Screenshot of the problem</a></p>\n\n<pre><code>Dim NextTime As Double\n\n\n\nSub RecordData()\nDim Interval As Double\nDim cel As Range, Capture As Range\nInterval = 5    'Number of seconds between each recording of data\nSet Capture = Worksheets(\"Sheet1\").Range(\"A1:C5\") '****Problem in this code.Only****\nWith Worksheets(\"Sheet2\")   'Record the data on this worksheet\nSet cel = .Range(\"A5\")  'First timestamp goes here\nSet cel = .Cells(.Rows.Count, cel.Column).End(xlUp).Offset(1, 0)\ncel.Value = Now\nFor i = 1 To 5\ncel.Offset(0, 1 + (i - 1) * Capture.Rows.Count).Resize(1, Capture.Rows.Count).Value = \nApplication.Transpose(Capture.Columns(i).Value)\nNext i\n\nEnd With\n\nNextTime = Now + Interval / 86400\nApplication.OnTime NextTime, \"RecordData\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word", "output"], "comments": [{"owner": {"reputation": 13, "user_id": 12227474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/887c95929cfa1796e863e61d1a55a1db?s=128&d=identicon&r=PG&f=1", "display_name": "kamikazzy", "link": "https://stackoverflow.com/users/12227474/kamikazzy"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1571262328, "post_id": 58420194, "comment_id": 103186388, "body": "@CindyMeister Thank you! I thought it was similar to excel where if you selected a cell and then wrote into a different cell the activecell would change.  I will give it a try and let you know how it goes. I have been trying various versions of that line to see if I can move the range along, but have been having some problems with that portion."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12227474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/887c95929cfa1796e863e61d1a55a1db?s=128&d=identicon&r=PG&f=1", "display_name": "kamikazzy", "link": "https://stackoverflow.com/users/12227474/kamikazzy"}, "edited": false, "score": 0, "creation_date": 1571320600, "post_id": 58431834, "comment_id": 103209102, "body": "Thank you! That made so much sense. I envision it now as kind of an invisible block that moves along as you tell it to. It has a start and an end and by moving the start to the end  you move the range along."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 13, "user_id": 12227474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/887c95929cfa1796e863e61d1a55a1db?s=128&d=identicon&r=PG&f=1", "display_name": "kamikazzy", "link": "https://stackoverflow.com/users/12227474/kamikazzy"}, "edited": false, "score": 0, "creation_date": 1571332428, "post_id": 58431834, "comment_id": 103215323, "body": "@kamikazzy Yes, you can think of it like that :-) Note that you can also &quot;collapse&quot; in the other direction, and there are a number of <code>Move...</code> methods for adjusting where a range is, as well."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 13, "user_id": 12227474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/887c95929cfa1796e863e61d1a55a1db?s=128&d=identicon&r=PG&f=1", "display_name": "kamikazzy", "link": "https://stackoverflow.com/users/12227474/kamikazzy"}, "edited": false, "score": 0, "creation_date": 1571332545, "post_id": 58431834, "comment_id": 103215374, "body": "@kamikazzy Since you&#39;re new to the site: The &quot;accepted&quot; way to thank and mark a contribution as &quot;the answer&quot; is to click the checkmark at the left of that contribution. Once you&#39;ve accumulated some site &quot;reputation&quot; points, you&#39;ll also be able to upvote any contribution (question or answer) you consider helpful. These help maintain site quality - they let others know what information has been found useful by their peers :-) Enjoy!"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1571312552, "creation_date": 1571312552, "answer_id": 58431834, "question_id": 58420194, "link": "https://stackoverflow.com/questions/58420194/vba-excel-taking-multiple-tabs-and-outputting-as-a-single-word-document/58431834#58431834", "title": "VBA Excel: Taking multiple tabs and outputting as a single word document", "body": "<p>The trick to adding things to existing content in Word is to use <code>Range</code> objects. Think of ranges like invisible <em>selections</em> with the major difference that there can be only one selection, but code can use as many ranges as needed to manipulate content.</p>\n\n<p>To your comment: <code>Selection</code> in Word is very much like <code>ActiveCell</code> in Excel; Excel coding pros will always say: avoid using \"Active\"-anything, work with specific objects, for example Ranges instead of <code>ActiveCell</code>. The same is true with Word :-) You can never be sure which is the active cell, or where the selection is; <code>Range(\"A3\")</code> tells you exactly what is meant, <code>Document.Paragraphs(2)</code> the same.</p>\n\n<p>In that spirit, I've altered an extract of the code in the question, declaring (<code>Dim</code>) and instantiating (<code>Set</code>) a <code>Range</code> object to the entire main body of the document. The range is then \"collapsed\" (think of it like pressing the right-arrow of a selection) to its end-point so that adding new content won't replace previous content (the same problem as typing over a selection).</p>\n\n<pre><code>Dim rngTarget as Object     'Word.Range for early-binding or within Word\nSet rngTarget = mydoc1.Paragraphs(1).Range\n\n'Paste Table into MS Word\nrngTarget.PasteExcelTable False, False, False\n\n'Autofit Table so it fits inside Word Document\nSet WordTable = mydoc1.Tables(1)\nWordTable.AutoFitBehavior (wdAutoFitWindow)\n\nrngTarget.InsertAfter Chr(13) &amp; \"Hello\"    \nrngTarget.Collapse Direction:=wdCollapseEnd\n\nrngTarget.InsertBreak 7  'Word.WdBreakType.wdPageBreak (default type)\nrngTarget.Collapse Direction:=wdCollapseEnd\n\nSet tbl = ThisWorkbook.Worksheets(Sheet3.Name).UsedRange\ntbl.Copy\n\nrngTarget.PasteExcelTable False, False, False\n</code></pre>\n\n<p>I've also made some adjustments to the clean-up. When working with an outside application it's important to correctly release its declared and instantiated objects. This should be done in the <em>reverse order</em> they were created. If these are not correctly released, it could hold them in memory, causing errors the next time the code is run.</p>\n\n<pre><code>EndRoutine:\n\n  'Clear The Clipboard\n  Application.CutCopyMode = False\n\n  mydoc1.SaveAs Filename:=Application.ActiveWorkbook.Path &amp; \"\\Application_Temp\\\" &amp; \"Sheet1\"\n  mydoc1.Close\n  Set rngTarget = Nothing\n  Set WordTable = NOthing\n  Set tbl = Nothing\n  Set mdyDoc1 = Nothing\n\n  'Possibly you also want\n  'WordApp.Quit\n  'This you definitely need\n  Set WordApp = Nothing\n\n  Application.ScreenUpdating = True\n  Application.EnableEvents = True\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12227474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/887c95929cfa1796e863e61d1a55a1db?s=128&d=identicon&r=PG&f=1", "display_name": "kamikazzy", "link": "https://stackoverflow.com/users/12227474/kamikazzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 58431834, "answer_count": 1, "score": 1, "last_activity_date": 1571312552, "creation_date": 1571253034, "last_edit_date": 1571259774, "question_id": 58420194, "link": "https://stackoverflow.com/questions/58420194/vba-excel-taking-multiple-tabs-and-outputting-as-a-single-word-document", "title": "VBA Excel: Taking multiple tabs and outputting as a single word document", "body": "<p>I have multiple Excel tabs that I would like to output into a word document. I was able to take some code (with help from the community of course!) and output the first tab of my excel to the word document. When I  try to take the second tab on sheet 3 it just replaces the first page that I have created. </p>\n\n<p>I have also tried another route of exporting each sheet as a separate word document and then merging them but that also ran into the same problem where the word just replaced the first page over and over.</p>\n\n<p>Basically my code does the following: </p>\n\n<ol>\n<li>Creates a word file with specific margin outlines. </li>\n<li>Sets the table as a usedrange in the excel sheet. copies this</li>\n<li>Pastes into word. </li>\n</ol>\n\n<p>Tries again for the next sheet. Runs into issues. </p>\n\n<p>(Set tbl = ThisWorkbook.Worksheets(Sheet3.Name).UsedRange) </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Dim tbl As Excel.Range\r\nDim WordApp As Word.Application\r\n\r\nDim WordTable As Word.Table\r\n\r\nDim MainDoc As Word.Document\r\nDim mydoct1 As Word.Document\r\n\r\nDim sFolderPath As String\r\n\r\nSub Export_to_Word()\r\n\r\n    Application.ScreenUpdating = False\r\n    Application.EnableEvents = False\r\n    'Create an Instance of MS Word\r\n    On Error Resume Next\r\n        'Is MS Word already opened?\r\n        Set WordApp = GetObject(class:=\"Word.Application\")\r\n        'Clear the error between errors\r\n        Err.Clear\r\n        'If MS Word is not already open then open MS Word\r\n        If WordApp Is Nothing Then Set WordApp = CreateObject(class:=\"Word.Application\")\r\n        'Handle if the Word Application is not found\r\n        If Err.Number = 429 Then\r\n            MsgBox \"Microsoft Word could not be found, aborting.\"\r\n            GoTo EndRoutine\r\n        End If\r\n    On Error GoTo 0\r\n      \r\n    'Make MS Word Visible and Active\r\n    WordApp.Visible = True\r\n    WordApp.Activate\r\n        \r\n    'Create a New Document\r\n    Set mydoc1 = WordApp.Documents.Add\r\n    With mydoc1.PageSetup\r\n        .TopMargin = Application.CentimetersToPoints(1)\r\n        .BottomMargin = Application.CentimetersToPoints(1)\r\n        .LeftMargin = Application.CentimetersToPoints(1)\r\n        .RightMargin = Application.CentimetersToPoints(1)\r\n    End With\r\n    \r\n    Set tbl = ThisWorkbook.Worksheets(Sheet2.Name).UsedRange\r\n    tbl.Copy\r\n        \r\n    'Paste Table into MS Word\r\n    mydoc1.Paragraphs(1).Range.PasteExcelTable False, False, False\r\n    \r\n    'Autofit Table so it fits inside Word Document\r\n    Set WordTable = mydoc1.Tables(1)\r\n    WordTable.AutoFitBehavior (wdAutoFitWindow)\r\n    \r\n    \r\n    mydoc1.Range.InsertAfter Chr(13) &amp; \"Hello\"\r\n    \r\n    my.Collapse Direction:=wdCollapseEnd\r\n    mydoc1.Range.InsertBreak\r\n    \r\n    Set tbl = ThisWorkbook.Worksheets(Sheet3.Name).UsedRange\r\n    tbl.Copy\r\n    \r\n    mydoc1.Range.PasteExcelTable False, False, False\r\n    \r\nEndRoutine:\r\n    \r\n    'Clear The Clipboard\r\n    Application.CutCopyMode = False\r\n    \r\n    mydoc1.SaveAs Filename:=Application.ActiveWorkbook.Path &amp; \"\\Application_Temp\\\" &amp; \"Sheet1\"\r\n    mydoc1.Close\r\n    \r\n    Application.ScreenUpdating = True\r\n    Application.EnableEvents = True\r\n    \r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571253065, "post_id": 58420188, "comment_id": 103182619, "body": "What&#39;s the error message? Note - better to pass the function a worksheet object than a string representing the name. And also better to use <code>Long</code> instead of <code>Integer</code>. And be explicit - add <code>As Long</code> to the end of the function declaration."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1571253233, "post_id": 58420188, "comment_id": 103182707, "body": "You do not need the <code>WS</code> on the <code>Match</code>  The <code>Search_rng</code> has the worksheet as part of the variable.  You should not need the <code>WS.Select</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1571253285, "post_id": 58420188, "comment_id": 103182728, "body": "If you are getting an error it is because when the value is not found in the search range an error is produced that stops the code."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571253325, "post_id": 58420188, "comment_id": 103182752, "body": "^^ You need error handling to account for the possibility of no match."}, {"owner": {"reputation": 347, "user_id": 3623603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67bbefebff4c2699b06da0d490c995b?s=128&d=identicon&r=PG&f=1", "display_name": "Vaslo", "link": "https://stackoverflow.com/users/3623603/vaslo"}, "edited": false, "score": 0, "creation_date": 1571253778, "post_id": 58420188, "comment_id": 103182923, "body": "This value will always be there.  I&#39;m pretty amateur at coding this, but I will get a specific account (say 0001) and then it will be on a different line depending on how many other lines we are getting.  This returns the row that I need.  So the object to find is there - the issue is that I THINK it is on a different worksheet when it tries to search."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1571253902, "post_id": 58420188, "comment_id": 103182980, "body": "If you are looking for <code>0001</code> it may be as simple as the lookup is a number that is formatted to show the lead <code>0</code>s and not a text string.  If you try to match a text string <code>0001</code> to <code>1</code> that is formatted <code>0000</code> it will not find a match."}, {"owner": {"reputation": 347, "user_id": 3623603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67bbefebff4c2699b06da0d490c995b?s=128&d=identicon&r=PG&f=1", "display_name": "Vaslo", "link": "https://stackoverflow.com/users/3623603/vaslo"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571254019, "post_id": 58420188, "comment_id": 103183028, "body": "@ScottCraner I did a bunch of testing using lengths, setting the two equal on the spreadsheet, Immediate window variable testing, testing for types, etc - they are identical strings as far as I can tell."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1571254175, "post_id": 58420188, "comment_id": 103183107, "body": "@Vaslo the issue is then not with the code but the data, or the way you are calling the function."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571254320, "post_id": 58420188, "comment_id": 103183171, "body": "The <code>Set WS = Sheets(allocation_cc)</code> is suspect - because there&#39;s an implicit <code>ActiveWorkbook</code> - you need to qualify the workbook. This is why I proposed passing a <code>Worksheet</code> object instead of the worksheet name as a string."}, {"owner": {"reputation": 347, "user_id": 3623603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67bbefebff4c2699b06da0d490c995b?s=128&d=identicon&r=PG&f=1", "display_name": "Vaslo", "link": "https://stackoverflow.com/users/3623603/vaslo"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571254609, "post_id": 58420188, "comment_id": 103183318, "body": "@BigBen So this is part of a larger program.  Basically I use this to get the row number.  There is another function that gets the allocation tab by using a cell value.  I think what you are saying is just to go into a higher scope, get the worksheet name and save it in that scope and then pass it to the functions that need it?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571254694, "post_id": 58420188, "comment_id": 103183366, "body": "Sorry if my comment wasn&#39;t clear. I meant that you should have <code>Function Find...(ByVal allocationWs as Worksheet, ByVal allocation_cc as String</code>. Pass the function a fully qualified worksheet object, not a string of the worksheet name. In other words, that other function should return a worksheet object that you can pass to this one."}, {"owner": {"reputation": 347, "user_id": 3623603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67bbefebff4c2699b06da0d490c995b?s=128&d=identicon&r=PG&f=1", "display_name": "Vaslo", "link": "https://stackoverflow.com/users/3623603/vaslo"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571259724, "post_id": 58420188, "comment_id": 103185504, "body": "@BigBen I believe you are right that it is not great handling of Worksheet Object handling.  I ran into another problem while doing this which I&#39;ll post as a separate question but in short I had to add my WS object to the two &quot;Cells&quot; which were called.  Seems to be working now but I cannot with certainty understand why that was happening because I clearly don&#39;t know the passing of objects as well as I&#39;d like."}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 3623603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67bbefebff4c2699b06da0d490c995b?s=128&d=identicon&r=PG&f=1", "display_name": "Vaslo", "link": "https://stackoverflow.com/users/3623603/vaslo"}, "edited": false, "score": 0, "creation_date": 1571253848, "post_id": 58420353, "comment_id": 103182964, "body": "Sorry I added above the Error should not occur because this value will ALWAYS be in there.  The line will simply differ."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 347, "user_id": 3623603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67bbefebff4c2699b06da0d490c995b?s=128&d=identicon&r=PG&f=1", "display_name": "Vaslo", "link": "https://stackoverflow.com/users/3623603/vaslo"}, "edited": false, "score": 1, "creation_date": 1571253877, "post_id": 58420353, "comment_id": 103182970, "body": "@Vaslo <i>never</i> assume the error will not occur. Because - it will, Murphy&#39;s law."}, {"owner": {"reputation": 347, "user_id": 3623603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67bbefebff4c2699b06da0d490c995b?s=128&d=identicon&r=PG&f=1", "display_name": "Vaslo", "link": "https://stackoverflow.com/users/3623603/vaslo"}, "edited": false, "score": 0, "creation_date": 1571253956, "post_id": 58420353, "comment_id": 103183006, "body": "Well, I believe in the abundance of caution and can add the recommendation, but if it errors out when I know my value is there, it isn&#39;t solving my problem unfortunately."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1571253808, "last_edit_date": 1571253808, "creation_date": 1571253664, "answer_id": 58420353, "question_id": 58420188, "link": "https://stackoverflow.com/questions/58420188/does-excel-vba-worksheetfunction-need-to-use-a-select-to-be-on-the-proper-worksh/58420353#58420353", "title": "Does Excel VBA WorksheetFunction need to use a select to be on the proper worksheet", "body": "<p>If the match is not found it will kick out an error and stop the code.  If we late bind the match and send the result to a variant we can test for the error:</p>\n\n<pre><code>Function Find_Allocation_Acct_Row_Number(allocation_acct As String, allocation_cc As String) As Long\n    Dim WS As Worksheet\n    Set WS = Worksheets(allocation_cc)\n\n    Dim search_rng As Range\n    Set search_rng = WS.Range(\"E1:E2000\")\n\n    Dim CC_row As Variant\n    CC_row = Application.Match(allocation_acct, search_rng, 0)\n\n    If Not IsError(CC_row) Then\n        Find_Allocation_Acct_Row_Number = CC_row + 4\n    Else\n        Find_Allocation_Acct_Row_Number = -1\n    End If\nEnd Function\n</code></pre>\n\n<p>Now if a match cannot be found it will return <code>-1</code></p>\n"}], "owner": {"reputation": 347, "user_id": 3623603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67bbefebff4c2699b06da0d490c995b?s=128&d=identicon&r=PG&f=1", "display_name": "Vaslo", "link": "https://stackoverflow.com/users/3623603/vaslo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571253908, "creation_date": 1571252999, "last_edit_date": 1571253908, "question_id": 58420188, "link": "https://stackoverflow.com/questions/58420188/does-excel-vba-worksheetfunction-need-to-use-a-select-to-be-on-the-proper-worksh", "title": "Does Excel VBA WorksheetFunction need to use a select to be on the proper worksheet", "body": "<p>I have the following code, but I have to select the worksheet otherwise the WorksheetFunction will return an error:</p>\n\n<pre><code>Function Find_Allocation_Acct_Row_Number(allocation_acct As String, allocation_cc As String)\nDim WS As Worksheet\nDim CC_row As Integer\nDim search_rng As Range\n\nSet WS = Sheets(allocation_cc)\nWS.Select\n\nSet search_rng = WS.Range(\"E1:E2000\")\n\nCC_row = WS.Application.WorksheetFunction.Match(allocation_acct,search_rng, 0)\n\nFind_Allocation_Acct_Row_Number = CC_row + 4\nEnd Function\n</code></pre>\n\n<p>How can I select the right range on the right worksheet without using the Select command?</p>\n\n<p>To be clear, I will ALWAYS find the value.  I just need to return the row so I can create a range from it.</p>\n\n<p>I have tried a number of different ways to change the \"search_rng\" to different variables or expressions of Range but no luck.</p>\n\n<p>The error I am getting is:</p>\n\n<pre><code>Run-time error '1004':\nUnable to get the Match property of the WorksheetFunction class\n</code></pre>\n"}, {"tags": ["excel", "vba", "rest"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1571260996, "post_id": 58419857, "comment_id": 103185953, "body": "can you please show the url you are putting in the browser if possible?"}, {"owner": {"reputation": 21, "user_id": 9286606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9771ce33b25279cfbf9561188b768b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Maggie", "link": "https://stackoverflow.com/users/9286606/maggie"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1571664700, "post_id": 58419857, "comment_id": 103305487, "body": "Sorry, I can&#39;t share the exact URL. Are there any things I could try?"}], "owner": {"reputation": 21, "user_id": 9286606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9771ce33b25279cfbf9561188b768b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Maggie", "link": "https://stackoverflow.com/users/9286606/maggie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571260912, "creation_date": 1571251583, "question_id": 58419857, "link": "https://stackoverflow.com/questions/58419857/rest-api-excel-vba-get-call-with-variable-input", "title": "REST API Excel VBA GET call with variable input", "body": "<p>I am trying to perform a GET call with a where clause on an id. The back end is set up and the call works when you put the URL into a browser however it does take some time to load. However, when I try the GET call from Excel I get an HTTP Error: 500. \"Reason: Illegal Character in query at position: 54\"\n My variable portion of the URL is  <code>/?q={\"user_id\":\"abc12345\"}</code>\nThe VBA input is <code>/?q={\"\"user_id\"\":\"\"\" &amp; vUser &amp; \"\"\"}\"</code>\n  The 54th position is the first bracket. Does vba require some other syntax? </p>\n\n<p>I also tried putting in a wait function to see if it wasn't waiting for the execution. Didn't Help.</p>\n\n<p>Any idea why it works in the browser but not in the VBA? \nBelow is the Object I am using: </p>\n\n<pre><code>Set http = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\nhttp.SetAutoLogonPolicy 0\nhttp.Open \"GET\", URL, False\nhttp.send\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1571251023, "post_id": 58419674, "comment_id": 103181746, "body": "Like the preload"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1571252750, "last_edit_date": 1571252750, "creation_date": 1571250829, "answer_id": 58419674, "question_id": 58419565, "link": "https://stackoverflow.com/questions/58419565/run-time-error-13-showing-while-looking-through-n-a-string/58419674#58419674", "title": "Run Time Error: 13 showing while looking through #N/A string", "body": "<p>You will need to check for the error before the existing if:</p>\n\n<pre><code>Sub m()    \n    With ActiveSheet        'Better to use actual sheet: WorkSheets(\"Sheet1\")\n        'load with all `0`\n        .range(\"B2:B10\").Value = 0\n        For i = 2 To 10\n            If Not IsError(.Cells(i, 1)) Then\n                If .Cells(i, 1).Value = \"SUP ID\" Then\n                    .Cells(i, 2).Value = 1\n                End If\n            End If\n        Next i\n    End with        \nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>With only 9 cells to check the above will run quickly, but as the range increases the number of times that vba references the worksheet will slow it down.</p>\n\n<p>You can use Arrays to speed it up.</p>\n\n<pre><code>Sub m()\n    With ActiveSheet        'Better to use actual sheet: WorkSheets(\"Sheet1\")\n        Dim inputArr() As Variant\n        inputArr = .Range(\"A2:A10\").Value\n\n        'Default of Integer is `0`\n        Dim outputArr() As Integer\n        ReDim outputArr(1 To UBound(inputArr, 1), 1 To 1) As Integer\n\n\n        For i = LBound(inputArr, 1) To UBound(inputArr, 1)\n            If Not IsError(inputArr(i, 1)) Then\n                If inputArr(i, 1) = \"SUP ID\" Then\n                    outputArr(i, 1) = 1\n                End If\n            End If\n        Next i\n\n        .Range(\"B2\").Resize(UBound(inputArr, 1)).Value = outputArr\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8509714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfca5f898149f17e5e38e5f9447f5892?s=128&d=identicon&r=PG&f=1", "display_name": "anishmbait", "link": "https://stackoverflow.com/users/8509714/anishmbait"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 1, "accepted_answer_id": 58419674, "answer_count": 1, "score": 1, "last_activity_date": 1571315424, "creation_date": 1571250360, "last_edit_date": 1571315424, "question_id": 58419565, "link": "https://stackoverflow.com/questions/58419565/run-time-error-13-showing-while-looking-through-n-a-string", "title": "Run Time Error: 13 showing while looking through #N/A string", "body": "<p>I'm trying to run the below code to find whether the A column has keyword \"SUP ID\" or not. Any instance of SUP ID would be updated with number <strong>1</strong> on adjacent column and rest all would go as <strong>0</strong>. However while finding the #N/A word, getting error Run-Time <strong>Error '13': Type Mismatch</strong></p>\n\n<pre><code>Sub m()\n\nFor i = 2 To 10\n    If Cells(i, 1).Value = \"SUP ID\" Then\n        Cells(i, 2).Value = 1\n    Else\n        Cells(i, 2).Value = 0\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/5orwF.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5orwF.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "powerpoint", "bullet"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1571252033, "post_id": 58419461, "comment_id": 103182195, "body": "Please edit the question to explain <b>*how</b> the code &quot;isn&#39;t working&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 11988887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3ZLtMLxQM4CVhys_AW1ZiWxHw7vuO-wewCl4cVw=k-s128", "display_name": "Naxos", "link": "https://stackoverflow.com/users/11988887/naxos"}, "edited": false, "score": 0, "creation_date": 1571298828, "post_id": 58424650, "comment_id": 103196277, "body": "I know. The reason why I post this question is because I need it on another case especially with another font."}], "tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": false, "score": 0, "last_activity_date": 1571284300, "creation_date": 1571284300, "answer_id": 58424650, "question_id": 58419461, "link": "https://stackoverflow.com/questions/58419461/powerpoint-vba-only-insert-custom-bullets-list/58424650#58424650", "title": "Powerpoint - VBA Only - Insert custom bullets list", "body": "<p>Your code is not necessary. This numbering style is already built into PowerPoint. Here is the code to apply it:</p>\n\n<pre><code>Sub NumberStyle()\n  With ActiveWindow.Selection.ShapeRange(1).TextFrame2. _\n    TextRange.ParagraphFormat.Bullet\n    .Type = msoBulletNumbered\n    .Style = msoBulletCircleNumWdBlackPlain\n  End With\nEnd Sub\n</code></pre>\n\n<p>Here's my article explaining PowerPoint numbering styles: <a href=\"http://www.brandwares.com/bestpractices/2017/06/xml-hacking-powerpoint-numbering-styles/\" rel=\"nofollow noreferrer\">OOXML Hacking: PowerPoint Numbering Styles</a></p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 11988887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3ZLtMLxQM4CVhys_AW1ZiWxHw7vuO-wewCl4cVw=k-s128", "display_name": "Naxos", "link": "https://stackoverflow.com/users/11988887/naxos"}, "is_accepted": true, "score": 0, "last_activity_date": 1571305448, "creation_date": 1571305448, "answer_id": 58429610, "question_id": 58419461, "link": "https://stackoverflow.com/questions/58419461/powerpoint-vba-only-insert-custom-bullets-list/58429610#58429610", "title": "Powerpoint - VBA Only - Insert custom bullets list", "body": "<p>After few tries I found the code if someone needs it please find it below.</p>\n\n<pre><code>Sub InsertCustomBulletList()\n If ActiveWindow.Selection.Type = ppSelectionText Then\n     With ActiveWindow.Selection.TextRange\n                With ActiveWindow.Selection.TextRange.Lines(1).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n                With ActiveWindow.Selection.TextRange.Lines(2).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n                With ActiveWindow.Selection.TextRange.Lines(3).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n                With ActiveWindow.Selection.TextRange.Lines(4).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n                With ActiveWindow.Selection.TextRange.Lines(5).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n                With ActiveWindow.Selection.TextRange.Lines(6).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n                With ActiveWindow.Selection.TextRange.Lines(7).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n                With ActiveWindow.Selection.TextRange.Lines(8).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n                With ActiveWindow.Selection.TextRange.Lines(9).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n                With ActiveWindow.Selection.TextRange.Lines(10).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n                With ActiveWindow.Selection.TextRange.Lines(11).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n                With ActiveWindow.Selection.TextRange.Lines(12).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n               End With\n                 With ActiveWindow.Selection.TextRange.Lines(13).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n                With ActiveWindow.Selection.TextRange.Lines(14).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n                With ActiveWindow.Selection.TextRange.Lines(15).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n                With ActiveWindow.Selection.TextRange.Lines(16).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n                With ActiveWindow.Selection.TextRange.Lines(17).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n                With ActiveWindow.Selection.TextRange.Lines(18).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n                With ActiveWindow.Selection.TextRange.Lines(19).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n                With ActiveWindow.Selection.TextRange.Lines(20).ParagraphFormat.bullet\n                    .Visible = msoTrue\n                    .UseTextColor = msoTrue\n                    .Font.name = \"Your font\"\n                    .Character = 0  'Character in ASCII Dec\n                    .Font.Color.RGB = RGB(0, 0, 0)\n                End With\n    End With\n End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 11988887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3ZLtMLxQM4CVhys_AW1ZiWxHw7vuO-wewCl4cVw=k-s128", "display_name": "Naxos", "link": "https://stackoverflow.com/users/11988887/naxos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 1, "accepted_answer_id": 58429610, "answer_count": 2, "score": -1, "last_activity_date": 1571305448, "creation_date": 1571249948, "question_id": 58419461, "link": "https://stackoverflow.com/questions/58419461/powerpoint-vba-only-insert-custom-bullets-list", "title": "Powerpoint - VBA Only - Insert custom bullets list", "body": "<p>Hope you are doing well. \nI am on a VBA code (only, not XML) to insert a custom bullet list in the selected object (textbox, shape etc.) such as \n<a href=\"https://i.stack.imgur.com/urRxw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/urRxw.png\" alt=\"Expected\"></a>\nI tried the following code:</p>\n\n<pre><code>Sub CustomBulletsVBAOnly()\n\nWith ActiveWindow.Selection.ShapeRange.textFrame\n    With .TextFrame2.TextRange.Paragraphs(1)\n        .ParagraphFormat.bullet.Font.name = \"Webdings\"\n        .ParagraphFormat.bullet.Character = 140\n    End With\n    With .TextFrame2.TextRange.Paragraphs(2)\n        .ParagraphFormat.bullet.Font.name = \"Webdings\"\n        .ParagraphFormat.bullet.Character = 141\n    End With\n    With .TextFrame2.TextRange.Paragraphs(3)\n        .ParagraphFormat.bullet.Font.name = \"Webdings\"\n        .ParagraphFormat.bullet.Character = 142\n    End With\n    With .TextFrame2.TextRange.Paragraphs(4)\n        .ParagraphFormat.bullet.Font.name = \"Webdings\"\n        .ParagraphFormat.bullet.Character = 143\n    End With\n    With .TextFrame2.TextRange.Paragraphs(5)\n        .ParagraphFormat.bullet.Font.name = \"Webdings\"\n        .ParagraphFormat.bullet.Character = 144\n    End With\n    With .TextFrame2.TextRange.Paragraphs(6)\n        .ParagraphFormat.bullet.Font.name = \"Webdings\"\n        .ParagraphFormat.bullet.Character = 145\n    End With\n    With .TextFrame2.TextRange.Paragraphs(7)\n        .ParagraphFormat.bullet.Font.name = \"Webdings\"\n        .ParagraphFormat.bullet.Character = 146\n    End With\n    With .TextFrame2.TextRange.Paragraphs(8)\n        .ParagraphFormat.bullet.Font.name = \"Webdings\"\n        .ParagraphFormat.bullet.Character = 147\n    End With\n    With .TextFrame2.TextRange.Paragraphs(9)\n        .ParagraphFormat.bullet.Font.name = \"Webdings\"\n        .ParagraphFormat.bullet.Character = 148\n    End With\n\nEnd With\nEnd Sub\n\n</code></pre>\n\n<p>The code is currently not working.\nDo you have any ideas?\nThanks. Naxos</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 4, "creation_date": 1571249724, "post_id": 58419330, "comment_id": 103181149, "body": "There should also be a reference for <code>Microsoft ActiveX Data Objects 2.8 Library</code>.  You don&#39;t see it?"}, {"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 2, "creation_date": 1571249769, "post_id": 58419330, "comment_id": 103181167, "body": "You need <code>Microsoft ActiveX Data Objects x.x Library</code>. See <a href=\"https://docs.microsoft.com/en-us/sql/ado/guide/appendixes/using-ado-with-microsoft-visual-basic?view=sql-server-ver15\" rel=\"nofollow noreferrer\">this article</a> at doc.Microsoft.com."}, {"owner": {"reputation": 1042, "user_id": 2023624, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YegJC.jpg?s=128&g=1", "display_name": "DaveU", "link": "https://stackoverflow.com/users/2023624/daveu"}, "reply_to_user": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 1, "creation_date": 1571267304, "post_id": 58419330, "comment_id": 103187723, "body": "@BrianMStafford Yes, that did it.  I misread an example I was following, and referenced the wrong library.  My excuse - this is a new area for me.  Thank you."}, {"owner": {"reputation": 1042, "user_id": 2023624, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YegJC.jpg?s=128&g=1", "display_name": "DaveU", "link": "https://stackoverflow.com/users/2023624/daveu"}, "reply_to_user": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 1, "creation_date": 1571267340, "post_id": 58419330, "comment_id": 103187729, "body": "@AhmedAbdelhameed Thanks for your input, appreciated."}], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 10772767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ec6501aad428b9b9f0f4b07fdb4af0?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Strasser", "link": "https://stackoverflow.com/users/10772767/robert-strasser"}, "is_accepted": false, "score": 1, "last_activity_date": 1571249804, "last_edit_date": 1571249804, "creation_date": 1571249781, "answer_id": 58419411, "question_id": 58419330, "link": "https://stackoverflow.com/questions/58419330/create-an-adodb-object/58419411#58419411", "title": "Create an ADODB object", "body": "<p>Are you able to create an object via late binding? This may prevent the need for the library reference.</p>\n\n<p>Example:</p>\n\n<pre><code>Dim rst As Object: Set rst = CreateObject(\"ADODB.Recordset\")\n</code></pre>\n"}], "owner": {"reputation": 1042, "user_id": 2023624, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YegJC.jpg?s=128&g=1", "display_name": "DaveU", "link": "https://stackoverflow.com/users/2023624/daveu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1571250166, "creation_date": 1571249432, "last_edit_date": 1571250166, "question_id": 58419330, "link": "https://stackoverflow.com/questions/58419330/create-an-adodb-object", "title": "Create an ADODB object", "body": "<p>Running MS Office 2010 on Windows 7 Professional.</p>\n\n<p>I'm trying to create a new ADODB object in my VBA project.  I've set a reference to the MS ActiveX Data Objects Recordset 2.8 Library, but that only seems to give me the ADOR object. I also tried Recordset 6.0, with the same results.  The reference is pointing to msador28.tlb, which probably explains the ADOR object.  So my question is, how do I update the reference so I can access the ADODB object?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1571245812, "post_id": 58417946, "comment_id": 103179458, "body": "You need to build your own searching mechanism, vlookup will only work for the leftmost column in a range. <a href=\"https://support.office.com/en-us/article/vlookup-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571255819, "post_id": 58418529, "comment_id": 103183794, "body": "Edited to check if result is found"}], "tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": true, "score": 3, "last_activity_date": 1571255727, "last_edit_date": 1571255727, "creation_date": 1571246007, "answer_id": 58418529, "question_id": 58417946, "link": "https://stackoverflow.com/questions/58417946/lookup-with-different-variants/58418529#58418529", "title": "Lookup with different variants", "body": "<p>VLookup is not capable of searching multiple columns, what you want to do is use <code>Range.Find</code> to locate the row, then pull the data in column 4.  There are more arguments for <code>Range.Find</code> that you can reference here <a href=\"https://excelmacromastery.com/excel-vba-find/\" rel=\"nofollow noreferrer\">https://excelmacromastery.com/excel-vba-find/</a></p>\n\n<pre><code>Sub NewPasteFormulatoRange()\n\n    Dim refRng As Range, ref As Range, dataRng As Range\n    Dim foundrow as Long\n    Set refRng = ThisWorkbook.Worksheets(\"Main\").Range(\"K2:K969\") 'horizontal range of look up values\n    Set dataRng = ThisWorkbook.Worksheets(\"Countries\").Range(\"A2:C198\") 'data block you want to look up value in\n\n    For Each ref In refRng\n        Set findref = dataRng.Find(ref)\n        If Not findref Is Nothing Then\n            foundrow = findref.Row\n            ref.Offset(0, 2) = ThisWorkbook.Worksheets(\"Countries\").Cells(foundrow, 4)\n        End If\n    Next ref\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 58418529, "answer_count": 1, "score": 0, "last_activity_date": 1571255727, "creation_date": 1571243698, "question_id": 58417946, "link": "https://stackoverflow.com/questions/58417946/lookup-with-different-variants", "title": "Lookup with different variants", "body": "<p>I have code for VLookup. Problem is that I want to have several variants for country name so it should use them all before it will give an error. So it should look in Column A, then Column B, then Column C.</p>\n\n<p>My data (Sheet \"Countries\"):</p>\n\n<p><a href=\"https://i.stack.imgur.com/XGsNs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XGsNs.png\" alt=\"enter image description here\"></a></p>\n\n<p>My code:</p>\n\n<pre><code>Sub PasteFormulaToRange()\n\n    Dim refRng As Range, ref As Range, dataRng As Range\n\n    Set refRng = ThisWorkbook.Worksheets(\"Main\").Range(\"K2:K969\") 'horizontal range of look up values\n    Set dataRng = ThisWorkbook.Worksheets(\"Countries\").Range(\"A2:D198\") 'data block you want to look up value in\n\n    For Each ref In refRng\n        ref.Offset(0, 2) = Application.WorksheetFunction.VLookup(ref, dataRng, 4, False)\n    Next ref\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "visio", "createobject"], "answers": [{"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 1, "last_activity_date": 1571245500, "creation_date": 1571245500, "answer_id": 58418394, "question_id": 58417848, "link": "https://stackoverflow.com/questions/58417848/creating-an-instance-of-visio-in-vba-when-2-versions-are-installed/58418394#58418394", "title": "Creating an instance of Visio in vba when 2 versions are installed", "body": "<p>If you early-bind it by adding a reference (<code>Tools | References</code>) to the desired version then <code>Dim</code>ing your object as that type, you'll be guaranteed which version you're using.</p>\n\n<pre><code>Dim visioApplication as Visio.Application\nSet visioApplication = new Visio.Application\n</code></pre>\n\n<p>However, that may not be the full solution if your company is mid-upgrade and some folks have the new version and some the older version. You'd get run-time issues on the machines that don't have your chosen version. </p>\n\n<p>To solve that issue, you could create <code>MyApp2010</code> and <code>MyApp2016</code>, each linking to the appropriate version of Visio, but that becomes a bit of a maintenance nightmare for you...</p>\n\n<p>Early-binding <em>does</em> add loads of benefits like IntelliSense and turning <em>most</em> run-time errors into compile-time errors, so it's probably still worth it.</p>\n"}, {"tags": [], "owner": {"reputation": 7447, "user_id": 929187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/F5QPL.png?s=128&g=1", "display_name": "Nikolay", "link": "https://stackoverflow.com/users/929187/nikolay"}, "is_accepted": true, "score": 1, "last_activity_date": 1571251402, "creation_date": 1571251402, "answer_id": 58419807, "question_id": 58417848, "link": "https://stackoverflow.com/questions/58417848/creating-an-instance-of-visio-in-vba-when-2-versions-are-installed/58419807#58419807", "title": "Creating an instance of Visio in vba when 2 versions are installed", "body": "<p>There are some options I believe.</p>\n\n<p>Solution 1 (I would recommend this one). Install only Visio 2010 on your development machine (and uninstall 2016). It's safest to have the lowest version you want your app to run with on your dev machine anyways. Add a reference to Visio 2010's type library in Excel. Remove the reference to Visio 21016 type library. Visio versions are upward-compatible, so the code should run properly even on the machine with Visio 2016.</p>\n\n<p>Solution 2. Use late binding. Remove the reference to the Visio from your excel project altogether and use only script-like access. In this case, you will lose auto-completion though. If your app is not a big one, that should not be an issue.</p>\n\n<p>Solution 3. (if you want to run a specific version). You can start the Visio application from the program files (like any other executable), and then connect to it using \"GetObject(...)\" instead of \"CreateObject(...)\"</p>\n\n<p>BTW, there is a better way to run Visio as invisible app (without flashing):</p>\n\n<p><code>Set appVisio = CreateObject(\"Visio.InvisibleApp\")</code></p>\n"}], "owner": {"reputation": 65, "user_id": 10171153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23189c243c7ed1ae41cc64d56f0210a9?s=128&d=identicon&r=PG&f=1", "display_name": "Rwood", "link": "https://stackoverflow.com/users/10171153/rwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 1, "accepted_answer_id": 58419807, "answer_count": 2, "score": 2, "last_activity_date": 1571301307, "creation_date": 1571243229, "last_edit_date": 1571301307, "question_id": 58417848, "link": "https://stackoverflow.com/questions/58417848/creating-an-instance-of-visio-in-vba-when-2-versions-are-installed", "title": "Creating an instance of Visio in vba when 2 versions are installed", "body": "<p>I have the below code to create an instance of Visio from Excel.  It works on machines where I have a single version of Visio installed, but on some machines I have 2 versions (2010 and 2016) installed.  On these machines it fails to run with the error \"Method 'Visible' of object 'IVApplication' failed\".  When I check AppVisio its empty, and I am guessing it is because both applications are visio.exe.  Is there a way to create the object from a specific path, or any way to createobject when 2 versions are installed?</p>\n\n<pre><code>Set AppVisio = CreateObject(\"visio.application\")\nAppVisio.Visible = False\nSet docsObj = AppVisio.Documents\n</code></pre>\n"}, {"tags": ["excel", "vba", "match", "cell"], "comments": [{"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571243421, "post_id": 58417779, "comment_id": 103178343, "body": "hi.  Application.Match returns a double and your TargetRw is a long.  replace Dim TargetRw As Long for Dim TargetRw As double and try. good luck"}, {"owner": {"reputation": 451, "user_id": 1390170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ad058771b4e13cc20484c2de4efd0f?s=128&d=identicon&r=PG", "display_name": "Jeremy Hodge", "link": "https://stackoverflow.com/users/1390170/jeremy-hodge"}, "edited": false, "score": 1, "creation_date": 1571243939, "post_id": 58417779, "comment_id": 103178597, "body": "Something to point out, your line &#39;Dim MACMtable, RCtable, TargetTable As ListObject&#39;, dimensions TargetTable as a list object and the others as variants, you need to specify each one like Dim MACMtable As ListObject, RCtable As ListObject, TargetTable As ListObject"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571244624, "post_id": 58417779, "comment_id": 103178909, "body": "Have you checked that <code>Acell</code> is actually found?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1571245056, "post_id": 58417779, "comment_id": 103179092, "body": "If there\u2019s no match then Match returns an error value, so the receiving variable should be a variant, and you need to test for an error before proceeding"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7327640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a68c1acbb99e228bdb40d94e67cd42a?s=128&d=identicon&r=PG&f=1", "display_name": "joe1250", "link": "https://stackoverflow.com/users/7327640/joe1250"}, "edited": false, "score": 0, "creation_date": 1571247952, "post_id": 58418538, "comment_id": 103180385, "body": "Thanks everyone for all your help. The TargetRw variable is now working as expected however Tim&#39;s suggested line of &#39;TargetTable.DataBodyRange.Cells(TargetRw, 6) = Rate.Value&#39; is generating Run-Time Error &#39;424&#39;: Object required...?"}, {"owner": {"reputation": 3, "user_id": 7327640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a68c1acbb99e228bdb40d94e67cd42a?s=128&d=identicon&r=PG&f=1", "display_name": "joe1250", "link": "https://stackoverflow.com/users/7327640/joe1250"}, "edited": false, "score": 0, "creation_date": 1571251701, "post_id": 58418538, "comment_id": 103182049, "body": "hey @Tim, would you happen to know if this error is in reference to the TargetRw variable or the Table? or neither?  thanks"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 7327640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a68c1acbb99e228bdb40d94e67cd42a?s=128&d=identicon&r=PG&f=1", "display_name": "joe1250", "link": "https://stackoverflow.com/users/7327640/joe1250"}, "edited": false, "score": 0, "creation_date": 1571258751, "post_id": 58418538, "comment_id": 103185095, "body": "Sorry my bad - missed removing the <code>.Value</code> from <code>Rate</code> (this just a plain variable and has no <code>Value</code> property)"}, {"owner": {"reputation": 3, "user_id": 7327640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a68c1acbb99e228bdb40d94e67cd42a?s=128&d=identicon&r=PG&f=1", "display_name": "joe1250", "link": "https://stackoverflow.com/users/7327640/joe1250"}, "edited": false, "score": 0, "creation_date": 1571260243, "post_id": 58418538, "comment_id": 103185673, "body": "the weird thing is that i&#39;d tried that already and when it executed that line, it initiated a UDF that i have in another module, which is named UserName, but takes Reference as Range... not sure how or why it called that from Rate... I thought might have something to do with the Rate variable&#39;s name and/or type so i tried renaming to myRate and changing the Dim type (Rate will either be type integer or decimal depending), but no luck with all the various combinations i tried. It either throws the error or calls the UDF"}, {"owner": {"reputation": 3, "user_id": 7327640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a68c1acbb99e228bdb40d94e67cd42a?s=128&d=identicon&r=PG&f=1", "display_name": "joe1250", "link": "https://stackoverflow.com/users/7327640/joe1250"}, "edited": false, "score": 0, "creation_date": 1571260566, "post_id": 58418538, "comment_id": 103185781, "body": "I also tried replacing = Rate with something else like = Now() and it still calls the UDF"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 7327640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a68c1acbb99e228bdb40d94e67cd42a?s=128&d=identicon&r=PG&f=1", "display_name": "joe1250", "link": "https://stackoverflow.com/users/7327640/joe1250"}, "edited": false, "score": 0, "creation_date": 1571260584, "post_id": 58418538, "comment_id": 103185788, "body": "Does it trigger the UDF because there are cells referencing that UDF on the sheet you&#39;re updating?"}, {"owner": {"reputation": 3, "user_id": 7327640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a68c1acbb99e228bdb40d94e67cd42a?s=128&d=identicon&r=PG&f=1", "display_name": "joe1250", "link": "https://stackoverflow.com/users/7327640/joe1250"}, "edited": false, "score": 0, "creation_date": 1571261256, "post_id": 58418538, "comment_id": 103186053, "body": "nothing on the active sheet... other sheets, but nothing linking them to the active sheet. The active sheet just contains a pivot table. when i hover over all the variables, their values are correct, however when i hover over the TargetTable portion of &#39;TargetTable.DataBodyRange.Cells(TargetRw, 6) = Rate&#39; i don&#39;t get the table name, but i do when i hover over the variable higher up at the &quot;Set&quot; lines... do i need to further define TargetTable or something? like preface with LUTables?"}, {"owner": {"reputation": 3, "user_id": 7327640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a68c1acbb99e228bdb40d94e67cd42a?s=128&d=identicon&r=PG&f=1", "display_name": "joe1250", "link": "https://stackoverflow.com/users/7327640/joe1250"}, "edited": false, "score": 0, "creation_date": 1571261308, "post_id": 58418538, "comment_id": 103186078, "body": "nothing referencing the UDF on the destination sheet either"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 7327640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a68c1acbb99e228bdb40d94e67cd42a?s=128&d=identicon&r=PG&f=1", "display_name": "joe1250", "link": "https://stackoverflow.com/users/7327640/joe1250"}, "edited": false, "score": 0, "creation_date": 1571261401, "post_id": 58418538, "comment_id": 103186111, "body": "Is the UDF volatile?  Not much I can offer without access to your workbook..."}, {"owner": {"reputation": 3, "user_id": 7327640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a68c1acbb99e228bdb40d94e67cd42a?s=128&d=identicon&r=PG&f=1", "display_name": "joe1250", "link": "https://stackoverflow.com/users/7327640/joe1250"}, "edited": false, "score": 0, "creation_date": 1571261841, "post_id": 58418538, "comment_id": 103186217, "body": "I didn&#39;t think it was, but this isn&#39;t my wheelhouse... the function it&#39;s calling is this... Function UserName(Reference As Range) If Reference.Value &lt;&gt; &quot;&quot; Then UserName = Environ$(&quot;Username&quot;) Else UserName = &quot;&quot; End If End Function"}, {"owner": {"reputation": 3, "user_id": 7327640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a68c1acbb99e228bdb40d94e67cd42a?s=128&d=identicon&r=PG&f=1", "display_name": "joe1250", "link": "https://stackoverflow.com/users/7327640/joe1250"}, "edited": false, "score": 0, "creation_date": 1571262152, "post_id": 58418538, "comment_id": 103186326, "body": "If i delete the function from the workbook, it works perfectly... but i&#39;m kind of relying on that function in some other sheets..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 7327640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a68c1acbb99e228bdb40d94e67cd42a?s=128&d=identicon&r=PG&f=1", "display_name": "joe1250", "link": "https://stackoverflow.com/users/7327640/joe1250"}, "edited": false, "score": 0, "creation_date": 1571265966, "post_id": 58418538, "comment_id": 103187409, "body": "Do you have an event handler which is triggering the function?"}, {"owner": {"reputation": 3, "user_id": 7327640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a68c1acbb99e228bdb40d94e67cd42a?s=128&d=identicon&r=PG&f=1", "display_name": "joe1250", "link": "https://stackoverflow.com/users/7327640/joe1250"}, "edited": false, "score": 0, "creation_date": 1571276655, "post_id": 58418538, "comment_id": 103189600, "body": "Not that I know of, that function is in a table column on another sheet so that every time the user adds a new record it auto stamps their user ID. There is a similar UDF that performs a date stamp. But those are the only two functions/modules in the Wb aside from this one...?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 7327640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a68c1acbb99e228bdb40d94e67cd42a?s=128&d=identicon&r=PG&f=1", "display_name": "joe1250", "link": "https://stackoverflow.com/users/7327640/joe1250"}, "edited": false, "score": 0, "creation_date": 1571278226, "post_id": 58418538, "comment_id": 103189932, "body": "What&#39;s the problem with that function running?"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1571258728, "last_edit_date": 1571258728, "creation_date": 1571246033, "answer_id": 58418538, "question_id": 58417779, "link": "https://stackoverflow.com/questions/58417779/how-to-update-cell-value-in-excel-table-using-vba-and-match-function/58418538#58418538", "title": "How to update cell value in Excel table using VBA and Match function?", "body": "<pre><code>TargetTable.ListColumns(1)\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>TargetTable.ListColumns(1).DataBodyRange\n</code></pre>\n\n<p>A ListColumn is not the same thing as a Range</p>\n\n<p>Untested:</p>\n\n<pre><code>Sub ReviewTracker()\n\n    Dim Acell As Variant, Asht As String\n    Dim TargetRw As Variant '***\n    Dim Rate As Variant\n    Dim TargetTable As ListObject\n    Dim LUTables As Worksheet\n\n    Set LUTables = ThisWorkbook.Sheets(\"LookupTables\")\n\n    Asht = ActiveSheet.Name\n    Acell = ActiveCell.Value\n    Rate = ActiveCell.Offset(0, -3).Value\n\n    If Asht = \"Rate Codes\" Then\n        Set TargetTable = LUTables.ListObjects(\"RC_Lookup\")\n    ElseIf Asht = \"MACMs\" Then\n        Set TargetTable = LUTables.ListObjects(\"MACM_Lookup\")\n    End If\n\n    TargetRw = Application.Match(Acell, TargetTable.ListColumns(1).DataBodyRange, 0)\n\n    If Not IsError(TargetRw) Then\n        TargetTable.DataBodyRange.Cells(TargetRw, 6) = Rate '### no .Value\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7327640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a68c1acbb99e228bdb40d94e67cd42a?s=128&d=identicon&r=PG&f=1", "display_name": "joe1250", "link": "https://stackoverflow.com/users/7327640/joe1250"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3028, "favorite_count": 0, "accepted_answer_id": 58418538, "answer_count": 1, "score": 0, "last_activity_date": 1571258728, "creation_date": 1571242918, "question_id": 58417779, "link": "https://stackoverflow.com/questions/58417779/how-to-update-cell-value-in-excel-table-using-vba-and-match-function", "title": "How to update cell value in Excel table using VBA and Match function?", "body": "<p>not a VBA pro here, but doing my best...</p>\n\n<p>The goal is to create a Macro that updates a cell value in a table based on the table row variable from Application.Match function, which I am also struggling with. Here's what I have so far and where I'm lost (also commented into the code).</p>\n\n<ol>\n<li><p>I can't seem to get the match function to set my TargetRw variable to the matched row in the table. As it is currently i'm getting 'Type Mismatch', but I've attempted several different configurations and received a variety of different errors.</p></li>\n<li><p>If i can get the match to work, I'd like to be able to set the cell value of the TargetRw and table Column \"Reviewed Rate\" = to the value held in the 'Rate' variable. I haven't been able to find much online regarding how to reference a table range like this in order update a cell value.</p>\n\n<pre><code>Sub ReviewTracker()\n\nDim Acell As Variant\nDim TargetRw As Long\nDim Rate As Variant\nDim MACMtable, RCtable, TargetTable As ListObject\nDim LUTables As Worksheet\n\n\n    Set LUTables = ThisWorkbook.Sheets(\"LookupTables\")\n\n    Set MACMtable = LUTables.ListObjects(\"MACM_Lookup\")\n    Set RCtable = LUTables.ListObjects(\"RC_Lookup\")\n\n    Asht = ActiveSheet.Name\n    Acell = ActiveCell.Value\n    Rate = ActiveCell.Offset(0, -3).Value\n\n    If Asht = \"Rate Codes\" Then\n    Set TargetTable = RCtable\n    Else\n    If Asht = \"MACMs\" Then\n    Set TargetTable = MACMtable\n    End If\n        End If\n\n    ***''' Can't get the TargetRw variable below to work... Type Missmatch'''***\n    TargetRw = Application.Match(Acell, TargetTable.ListColumns(1), 0)\n\n    With TargetTable\n        ******'''I am trying to figure out how to set the cell corresponding to the row: TargetRw &amp; Column 6 (name: \"Reviewed Rate\") to the value of the variable 'Rate'******\n\n    .DataBodyRange.Cells(TargetRw, 6) = Rate.Value '''This doesn't seem to work, but hopefully illustrates the goal'''\n\n    End With\n</code></pre>\n\n<p>End Sub</p></li>\n</ol>\n\n<p>There are 2 tables on a single worksheet (variable: 'LUTables'). One or the other would be updated depending on the activesheet at the time the Macro was initiated. Both have a column named \"Reviewed Rate\", which is also the 6th column in each table.</p>\n\n<p>Any assistance would be very much appreciated!</p>\n"}, {"tags": ["excel", "vba", "recordset", "createoleobject"], "comments": [{"owner": {"reputation": 451, "user_id": 1390170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ad058771b4e13cc20484c2de4efd0f?s=128&d=identicon&r=PG", "display_name": "Jeremy Hodge", "link": "https://stackoverflow.com/users/1390170/jeremy-hodge"}, "edited": false, "score": 0, "creation_date": 1571243155, "post_id": 58417476, "comment_id": 103178210, "body": "For #1, What is the error you receive?  For #2 try setting the Placement of the control to 2, e.g. CommandButton1.Placemnet = 2"}, {"owner": {"reputation": 1, "user_id": 12227604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28d0253377e8ea74543cd5ace84abdf?s=128&d=identicon&r=PG&f=1", "display_name": "Yosh", "link": "https://stackoverflow.com/users/12227604/yosh"}, "reply_to_user": {"reputation": 451, "user_id": 1390170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ad058771b4e13cc20484c2de4efd0f?s=128&d=identicon&r=PG", "display_name": "Jeremy Hodge", "link": "https://stackoverflow.com/users/1390170/jeremy-hodge"}, "edited": false, "score": 0, "creation_date": 1571243449, "post_id": 58417476, "comment_id": 103178361, "body": "Is placement=2 equivalent to xlfreefloating ? If yes it&#39;s already set that way"}, {"owner": {"reputation": 1, "user_id": 12227604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28d0253377e8ea74543cd5ace84abdf?s=128&d=identicon&r=PG&f=1", "display_name": "Yosh", "link": "https://stackoverflow.com/users/12227604/yosh"}, "reply_to_user": {"reputation": 451, "user_id": 1390170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ad058771b4e13cc20484c2de4efd0f?s=128&d=identicon&r=PG", "display_name": "Jeremy Hodge", "link": "https://stackoverflow.com/users/1390170/jeremy-hodge"}, "edited": false, "score": 0, "creation_date": 1571243635, "post_id": 58417476, "comment_id": 103178439, "body": "For the copyfromrecorset it World partially, i&#39;ve the rows i&#39;ve asked on the limit statement follower by empty lines and then an unable to copy from recorset error."}, {"owner": {"reputation": 451, "user_id": 1390170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ad058771b4e13cc20484c2de4efd0f?s=128&d=identicon&r=PG", "display_name": "Jeremy Hodge", "link": "https://stackoverflow.com/users/1390170/jeremy-hodge"}, "edited": false, "score": 0, "creation_date": 1571243637, "post_id": 58417476, "comment_id": 103178441, "body": "xlFreeFloating is 3, my error.  You can try 2 (xlMove) and see how it behaves."}, {"owner": {"reputation": 1, "user_id": 12227604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28d0253377e8ea74543cd5ace84abdf?s=128&d=identicon&r=PG&f=1", "display_name": "Yosh", "link": "https://stackoverflow.com/users/12227604/yosh"}, "reply_to_user": {"reputation": 451, "user_id": 1390170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ad058771b4e13cc20484c2de4efd0f?s=128&d=identicon&r=PG", "display_name": "Jeremy Hodge", "link": "https://stackoverflow.com/users/1390170/jeremy-hodge"}, "edited": false, "score": 2, "creation_date": 1571243702, "post_id": 58417476, "comment_id": 103178474, "body": "Sorry for poor english i fight with l&#39;y french autocorrect"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1571250691, "post_id": 58417476, "comment_id": 103181562, "body": "Yosh, strictly speaking, this quesiton is &quot;too broad&quot; because you ask more than one thing. You can use the <a href=\"https://stackoverflow.com/posts/58417476/edit\">edit</a> link to remove the first question so that this conforms to the site&#39;s rules and ask it in a second question..."}, {"owner": {"reputation": 1, "user_id": 12227604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28d0253377e8ea74543cd5ace84abdf?s=128&d=identicon&r=PG&f=1", "display_name": "Yosh", "link": "https://stackoverflow.com/users/12227604/yosh"}, "edited": false, "score": 0, "creation_date": 1571293926, "post_id": 58417476, "comment_id": 103193917, "body": "Oh ok, sorry, edit done !"}, {"owner": {"reputation": 1, "user_id": 12227604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28d0253377e8ea74543cd5ace84abdf?s=128&d=identicon&r=PG&f=1", "display_name": "Yosh", "link": "https://stackoverflow.com/users/12227604/yosh"}, "edited": false, "score": 0, "creation_date": 1571294010, "post_id": 58417476, "comment_id": 103193950, "body": "After the query, I do some stuff on the result, with a step by step execution I saw that the problem happen when this line of code is executed : ActiveSheet.ListObjects.Add(xlSrcRange, Range(Cells(6, 1), Cells(LastRow, LastCol)), , xlYes).Name = &quot;Tableau1&quot;"}, {"owner": {"reputation": 1, "user_id": 12227604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28d0253377e8ea74543cd5ace84abdf?s=128&d=identicon&r=PG&f=1", "display_name": "Yosh", "link": "https://stackoverflow.com/users/12227604/yosh"}, "edited": false, "score": 0, "creation_date": 1571668868, "post_id": 58417476, "comment_id": 103307748, "body": "Ok, so my problem come from the association of the xlFreefloating placement value for my controls and the presence of a Table on the sheet. If I take one away all is ok... any idea ?"}], "owner": {"reputation": 1, "user_id": 12227604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28d0253377e8ea74543cd5ace84abdf?s=128&d=identicon&r=PG&f=1", "display_name": "Yosh", "link": "https://stackoverflow.com/users/12227604/yosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571293232, "creation_date": 1571241866, "last_edit_date": 1571293232, "question_id": 58417476, "link": "https://stackoverflow.com/questions/58417476/how-to-properly-use-oleobjects-and-recordsets", "title": "How to properly use oleobjects and recordsets?", "body": "<p>I've some issues with OLEObjects and recordsets... </p>\n\n<p>I create some controls on the fly in my code.\nI prepare them, I fill them, and then I use the data collected from them to run a query on an AS400 (adodb).</p>\n\n<p>When I get the data back I've this issue :</p>\n\n<p>my <code>oleobjects</code> on top of the worksheet start acting weird: they seem normal, but when I click on one of them, the <code>Left</code> property seems to change. While holding the mouse button down I see the control twice, once where it should be, and at another position offset to the right (let's call it the buggy version). If my pointer leaves the control it returns to its normal position. </p>\n\n<p>The globality of the control reacts to my mouse click for offsetting the control to the right and showing its \"Buggy version\", but the normal behaviour (<code>Click</code> is the only event I manage) only happens if I click on the Buggy Version... Each time I run the query the buggy  controls are more and more offset to the right. </p>\n\n<p>Here are some pictures :</p>\n\n<p><strong>Start</strong>: all is ok</p>\n\n<p><a href=\"https://i.stack.imgur.com/QkhPf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QkhPf.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>First query</strong>: behaviour after the first run when I click on the left part of the button:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rW5dl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rW5dl.png\" alt=\"first query\"></a></p>\n\n<p><strong>Second query</strong>: same, but the offset is greater:</p>\n\n<p><a href=\"https://i.stack.imgur.com/aReON.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aReON.png\" alt=\"second query\"></a></p>\n\n<p>When I don't click on the controls they are like in the first picture.</p>\n\n<p>This affects all my controls except the first 3 which are at left = 0</p>\n\n<p>I hope I was clear and that someone has an idea about what is happening.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11808184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fd7d3ff6ada51a5571aad213f32e8f?s=128&d=identicon&r=PG&f=1", "display_name": "frankbean", "link": "https://stackoverflow.com/users/11808184/frankbean"}, "edited": false, "score": 0, "creation_date": 1571260803, "post_id": 58419499, "comment_id": 103185872, "body": "I get a function or sub not defined when I try any variant of this and no matter where I place the .PageSetup portion.  My main sub name is highlighted in yellow and the first InchesToPoints (I&#39;m in the US so not using metric) line is highlighted.  I&#39;m not worrying about .PaperSize at this point so I left that line out."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 35, "user_id": 11808184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fd7d3ff6ada51a5571aad213f32e8f?s=128&d=identicon&r=PG&f=1", "display_name": "frankbean", "link": "https://stackoverflow.com/users/11808184/frankbean"}, "edited": false, "score": 0, "creation_date": 1571260963, "post_id": 58419499, "comment_id": 103185943, "body": "Ah, sorry, I forgot the code in the question uses late-binding, which means InchesToPoints (or CentimetersToPoints) won&#39;t be available. In that case, you need to pass the information <i>in points</i> @frankbean"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 35, "user_id": 11808184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fd7d3ff6ada51a5571aad213f32e8f?s=128&d=identicon&r=PG&f=1", "display_name": "frankbean", "link": "https://stackoverflow.com/users/11808184/frankbean"}, "edited": false, "score": 0, "creation_date": 1571261226, "post_id": 58419499, "comment_id": 103186036, "body": "@frankbean I&#39;ve edited the answer and also added information about the paper size"}, {"owner": {"reputation": 35, "user_id": 11808184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fd7d3ff6ada51a5571aad213f32e8f?s=128&d=identicon&r=PG&f=1", "display_name": "frankbean", "link": "https://stackoverflow.com/users/11808184/frankbean"}, "edited": false, "score": 0, "creation_date": 1571262830, "post_id": 58419499, "comment_id": 103186546, "body": "ok that worked except I moved the With wordDoc.PageSetup part up below Set wordDoc = .  Where you have is inside a for loop that processes every row in a very large spreadsheet.  I didn&#39;t even try it there because it didn&#39;t make sense to have the setup process after every row is output.  Thanks!"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1571261193, "last_edit_date": 1571261193, "creation_date": 1571250123, "answer_id": 58419499, "question_id": 58417420, "link": "https://stackoverflow.com/questions/58417420/can-page-size-and-margins-be-set-when-sending-data-from-excel-to-word/58419499#58419499", "title": "Can page size and margins be set when sending data from Excel to Word?", "body": "<p>Page size and margins are properties of the <code>PageSetup</code> object. Note that this kind of information can often be discovered by recording a macro...</p>\n\n<p>Since the code in the question uses late-binding, the numerical values for paper sizes will need to be used instead of the enumeration (<code>wdPaperLetter</code> for example) and the margin values will need to be passed in <strong><em>points</em></strong>.</p>\n\n<p>I've adapted the code in the question to demonstrate. Also, I've made additional optimizations:</p>\n\n<ul>\n<li>Work with the objects (espcially <code>Range</code> objects), rather than <code>Selection</code> (similar logic as avoiding <code>ActiveCell</code> and <code>Activate</code> in Excel - it's more accurate)</li>\n<li>Use the <code>Document</code> object that's declared and </li>\n</ul>\n\n<pre><code>    Dim blnNewApp As Boolean\n    Dim wordApp As Object   'Word.Application\n    Dim wordDoc As Object   'Word.Document\n    Dim wordRange as Object 'Word.Range\n    Dim j As Long\n\n    Set wordApp = GetObject(, \"Word.Application\")\n\n    If wordApp Is Nothing Then\n        Set wordApp = CreateObject(\"Word.Application\")\n        blnNewApp = True\n    End If\n\n    Set wordDoc = wordApp.Documents.Add()\n    Set wordRange = wordDoc.Content\n\n    With ThisWorkbook.Sheets(strSHEET_NAME)\n        For j = 2 To .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n            strLineOfText = .Cells(j, \"A\").Text\n            wordRange.Text = strLineOfText &amp; vbCr  'vbCr = a new paragraph\n            With wordDoc.PageSetup\n              .PaperSize = 2 'wdPaperLetter\n              .BottomMargin = 452 'CentimetersToPoints(1.5)\n              .TopMargin = 700 'CentimetersToPoints(2)\n              .LeftMargin = 680 'CentimetersToPoints(2)\n              .RightMargin = 680 'CentimetersToPoints(2)\n            End With\n        Next j\n    End With\n\n    wordApp.Visible = True\n    AppActivate wordApp.Caption\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11808184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fd7d3ff6ada51a5571aad213f32e8f?s=128&d=identicon&r=PG&f=1", "display_name": "frankbean", "link": "https://stackoverflow.com/users/11808184/frankbean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 58419499, "answer_count": 1, "score": 1, "last_activity_date": 1571261193, "creation_date": 1571241656, "last_edit_date": 1571247590, "question_id": 58417420, "link": "https://stackoverflow.com/questions/58417420/can-page-size-and-margins-be-set-when-sending-data-from-excel-to-word", "title": "Can page size and margins be set when sending data from Excel to Word?", "body": "<p>I have code like the following:</p>\n\n<pre><code>Dim blnNewApp As Boolean\nDim wordApp As Object\nDim wordDoc As Object\nDim j As Long\n\nSet wordApp = GetObject(, \"Word.Application\")\n\nIf wordApp Is Nothing Then\n    Set wordApp = CreateObject(\"Word.Application\")\n    blnNewApp = True\nEnd If\n\nSet wordDoc = wordApp.Documents.Add()\n\nWith ThisWorkbook.Sheets(strSHEET_NAME)\n    For j = 2 To .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        strLineOfText = .Cells(j, \"A\").Text\n    wordApp.Selection.TypeText strLineOfText\n        wordApp.Selection.TypeParagraph\n\n    Next j\nEnd With\n\nwordApp.Visible = True\nAppActivate wordApp.Caption\n</code></pre>\n\n<p>If I want to set the page size and margins in the Word doc that gets created how would I do that?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1571241636, "post_id": 58417397, "comment_id": 103177522, "body": "<code>Set rng = ws.Range(&quot;A1&quot;, ws.Range(&quot;A1&quot;).End(xlDown).End(xlToRight))</code> or neater is <code>Set rng = ws.Range(&quot;A1&quot;).currentregion</code>."}, {"owner": {"reputation": 183, "user_id": 10588212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d546cbf894cd0769ee981fba6af5ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Raymond_90", "link": "https://stackoverflow.com/users/10588212/raymond-90"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1571241848, "post_id": 58417397, "comment_id": 103177619, "body": "oh wow, why is the solution always so easy :( i was adding prefix in front of first Range not the second. So i always need to put worksheet reference in front of every range in statement. Another note taken, thank you :)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571241869, "post_id": 58417397, "comment_id": 103177626, "body": "@Raymond_90 - this is a great use case for a <code>With ws...End With</code> block."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1571241934, "post_id": 58417397, "comment_id": 103177657, "body": "You do, not doing so is a common reason for questions here so you are ahead of the curve."}, {"owner": {"reputation": 183, "user_id": 10588212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d546cbf894cd0769ee981fba6af5ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Raymond_90", "link": "https://stackoverflow.com/users/10588212/raymond-90"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571243227, "post_id": 58417397, "comment_id": 103178247, "body": "@BigBen thank you, i will look into it, SJR thank you again, can i somehow flag your comment as solution?"}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1571246498, "last_edit_date": 1571246498, "creation_date": 1571243685, "answer_id": 58417945, "question_id": 58417397, "link": "https://stackoverflow.com/questions/58417397/delete-used-range-from-every-worksheet-in-workbook/58417945#58417945", "title": "Delete used range from every worksheet in workbook", "body": "<p>This error is very common.</p>\n\n<p>You must add a sheet reference to every instance of <code>Range</code> (and <code>Cells</code>) as otherwise your range can be straddling two sheets (the specified one and the active sheet, which is implied in the absence of anything else), which causes an error.</p>\n\n<pre><code>Set rng = ws.Range(\"A1\", ws.Range(\"A1\").End(xlDown).End(xlToRight))\n</code></pre>\n\n<p>In this particular case, you could also consider this variation:</p>\n\n<pre><code>Set rng = ws.Range(\"A1\").currentregion\n</code></pre>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.currentregion\" rel=\"nofollow noreferrer\">CurrentRegion</a>.</p>\n"}], "owner": {"reputation": 183, "user_id": 10588212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d546cbf894cd0769ee981fba6af5ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Raymond_90", "link": "https://stackoverflow.com/users/10588212/raymond-90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 58417945, "answer_count": 1, "score": 0, "last_activity_date": 1571246498, "creation_date": 1571241567, "last_edit_date": 1571246484, "question_id": 58417397, "link": "https://stackoverflow.com/questions/58417397/delete-used-range-from-every-worksheet-in-workbook", "title": "Delete used range from every worksheet in workbook", "body": "<p>i have this test dataset:</p>\n\n<p><a href=\"https://i.stack.imgur.com/iGFM1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iGFM1.png\" alt=\"dataset\"></a></p>\n\n<p>i have it on multiple sheets, but its always different range - more columns, more rows etc. Beneath this \"header\" are always some blank rows.</p>\n\n<p>I would like to loop throug all sheets and select this header using End(xlDown) and End(xlToRight).</p>\n\n<p>I am trying to do this with the following code:</p>\n\n<pre><code>    Sub WorksheetLoop()\n\n    Dim ws As Worksheet\n    Dim rng As Range\n\n    For Each ws In ActiveWorkbook.Worksheets\n        Set rng = Range(\"A1\", Range(\"A1\").End(xlDown).End(xlToRight))\n            rng.Delete\n    Next ws\n\nEnd Sub\n</code></pre>\n\n<p>This macro deletes everything on first worksheet and nothing happens on any other sheet.</p>\n\n<p>I tried using ws.rng but then i get an object error.</p>\n\n<p>Can you please tell me what am i doing wrong?</p>\n\n<p>I am studying some VBA material and trying to make changes, but i always end up with an error.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "powerpoint", "commandbar"], "answers": [{"tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": false, "score": -1, "last_activity_date": 1571241390, "creation_date": 1571241390, "answer_id": 58417359, "question_id": 58417126, "link": "https://stackoverflow.com/questions/58417126/powerpoint-vba-run-application-commandbars/58417359#58417359", "title": "Powerpoint - VBA - Run Application CommandBars", "body": "<p>I have no idea why a commandbar would ever show in any modern version of Office. They were deprecated with the introduction of Office 2007, more than 12 years ago. Sometimes it's necessary to run CommandBarButton.Execute to run a command that isn't in the object model. Other than that, you should be looking into ribbon modification to display custom commands.</p>\n"}, {"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1571251788, "creation_date": 1571251788, "answer_id": 58419900, "question_id": 58417126, "link": "https://stackoverflow.com/questions/58417126/powerpoint-vba-run-application-commandbars/58419900#58419900", "title": "Powerpoint - VBA - Run Application CommandBars", "body": "<p>Quite possibly, the reason the code is not working as expected is because PowerPoint 2016 (as all versions for the last 12 years or so) no longer uses <code>CommandBars</code> for the user interface. It can work, but it's better to use the Ribbon whenever possible.</p>\n\n<p>In order to trigger a built-in command, it's possible to use the <code>idMSO</code> \"name\" of the command. A complete list of these commands can be downloaded <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=50745\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Searching the list for <strong>Format</strong> turns up the idMSO <code>ObjectFormatDialog</code>. Testing on my system using the following line displays the <code>Format Shape</code> task pane:</p>\n\n<pre><code>Application.CommandBars.ExecuteMso(\"ObjectFormatDialog\")\n</code></pre>\n\n<p>The \"Mso\" methods are the only things <code>CommandBars</code> are used for, these days...</p>\n"}], "owner": {"reputation": 41, "user_id": 11988887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3ZLtMLxQM4CVhys_AW1ZiWxHw7vuO-wewCl4cVw=k-s128", "display_name": "Naxos", "link": "https://stackoverflow.com/users/11988887/naxos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 58419900, "answer_count": 2, "score": 1, "last_activity_date": 1571251788, "creation_date": 1571240594, "last_edit_date": 1571250776, "question_id": 58417126, "link": "https://stackoverflow.com/questions/58417126/powerpoint-vba-run-application-commandbars", "title": "Powerpoint - VBA - Run Application CommandBars", "body": "<p>I want to create a macro which allows, once an object is selected, to open the associated CommandBar.</p>\n\n<p>I wrote the following which works sometimes, but not everytime - it does not work the first time. and I do not understand why. I have to manually do a right click and select the \"Height and position\" option to run it for the first time and then everything works - the formatting pane is displayed. </p>\n\n<p>Do you have any clues to avoid the right click part?</p>\n\n<pre><code>Sub Bars ()\n  Application.CommandBars(\"Format Object\").Visible = True\nEnd Sub\n</code></pre>\n\n<p>This is Office 2016.</p>\n\n<p><a href=\"https://i.stack.imgur.com/RdCWt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RdCWt.png\" alt=\"Outpout\"></a>\nOther code tested:</p>\n\n<pre><code>Sub Bars ()\n  On Error GoTo Out\n  Dim cmd As CommandBar\n  For Each cmd In Application.CommandBars\n    cmd.Enabled = True\n  Next\n  If Application.CommandBars(\"Format Object\").Visible = True Then\n    Application.CommandBars(\"Format Object\").Visible = False\n  Else\n    Application.CommandBars(\"Format Object\").Visible = True\n  End If\nOut:\n  Exit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "filter", "find"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1571241478, "post_id": 58417068, "comment_id": 103177461, "body": "<code>Filter</code> returns elements that include (or exclude) the Match String so should consider partial matches. What code did you use?"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571241764, "post_id": 58417068, "comment_id": 103177581, "body": "@SJR, i have listed the filter code above. It returns partial matches, but results in Mismatch error if no matches found."}], "answers": [{"comments": [{"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1571242169, "post_id": 58417531, "comment_id": 103177773, "body": "as you can see i am using the Filter function, and it returns partial matches. But donot know why it returns in <code>Type Mismatch</code> error sometimes. Is it because it may not find any partial matches?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1571242235, "post_id": 58417531, "comment_id": 103177804, "body": "You would probably need to check first the size of your output array as if you are not returning anything you cannot process the array. Probably boils down to adding an If statement."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1571242488, "post_id": 58417531, "comment_id": 103177925, "body": "Can you share an example? I tried with an IIF statement to return 0 on error, but still gave an error."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 1, "creation_date": 1571242678, "post_id": 58417531, "comment_id": 103178005, "body": "Yes I have added above. You might want to consider breaking down your operations into separate stages rather than doing it all in one line."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571242919, "post_id": 58417531, "comment_id": 103178101, "body": "^^^^ Can&#39;t second this recommendation enough."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571243356, "post_id": 58417531, "comment_id": 103178311, "body": "@BigBen - am partly motivated by the fact that my creaky old brain can&#39;t get my head round lines like that above."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571243400, "post_id": 58417531, "comment_id": 103178335, "body": "It&#39;s not a question of creakiness but readability and &quot;debugability&quot; :)"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 1, "creation_date": 1571243829, "post_id": 58417531, "comment_id": 103178538, "body": "@SJR, should the IF condition line in above code be <code>If UBound(v) &gt; 0 Then</code> or <code>If UBound(v) +1  &gt; 0 Then</code> ?"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1571244005, "post_id": 58417531, "comment_id": 103178632, "body": "thanks. But what do i use to get a count of the returned textual values?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571244207, "post_id": 58417531, "comment_id": 103178726, "body": "As above, it would be <code>UBound(v) + 1</code> where <code>v</code> is the output array."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1571244338, "post_id": 58417531, "comment_id": 103178784, "body": "Ah! understood your approach now. Thanks. Let me try that."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 1, "creation_date": 1571245030, "post_id": 58417531, "comment_id": 103179080, "body": "@SJR, finally got it working thanks to your alternative solution of <code>checking UBound of returned array</code> to get the <code>Count</code>. I still prefer short hand due to certain limitations i have in my code. Here is what i used:  <code>bCount = IIf(UBound(VBA.Filter(.Index(oVarDict(Key), i), sTerm, True, vbTextCompare)) &gt; -1, UBound(VBA.Filter(.Index(oVarDict(Key), i), sTerm)) + 1, 0)</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571245968, "post_id": 58417531, "comment_id": 103179524, "body": "Glad it works. Each to his own, but the problem with that approach is, as BigBen says, that if it errors you won&#39;t know where it breaks"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1571244067, "last_edit_date": 1571244067, "creation_date": 1571242055, "answer_id": 58417531, "question_id": 58417068, "link": "https://stackoverflow.com/questions/58417068/count-partial-matches-in-array-using-application-find-or-vba-filter/58417531#58417531", "title": "Count partial matches in Array using Application.Find or VBA.Filter", "body": "<p>Here is an example using <code>Filter</code> which I knocked up, without any errors. So it may come down to how you are declaring variables or similar.</p>\n\n<pre><code>Sub y()\n\nDim s(1 To 5) As String, v As Variant\n\ns(1) = \"Fred\"      'includes \"Fred\"\ns(2) = \"Fred\"      'includes \"Fred\"\ns(3) = \"Freddie\"   'includes \"Fred\"\ns(4) = \"Harry\"\ns(5) = \"Frederick\" 'includes \"Fred\"\n\n'v = Filter(s, \"Fred\", True) 'returns an array with 4 elements\n'MsgBox UBound(v) + 1        'returns 4\n'MsgBox Application.Index(Range(\"A1:A10\"), UBound(v) + 1)\n\nv = Filter(s, \"Bill\", True) 'returns an array with 0 elements (actually treated as -1)\nMsgBox UBound(v) + 1        'returns 0\n\n'to avoid error below\nIf UBound(v) &gt; -1 Then\n    MsgBox Application.Index(Range(\"A1:A10\"), UBound(v) + 1)\nElse\n    MsgBox \"Output array is empty\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 1, "accepted_answer_id": 58417531, "answer_count": 1, "score": 0, "last_activity_date": 1571244067, "creation_date": 1571240404, "last_edit_date": 1571240831, "question_id": 58417068, "link": "https://stackoverflow.com/questions/58417068/count-partial-matches-in-array-using-application-find-or-vba-filter", "title": "Count partial matches in Array using Application.Find or VBA.Filter", "body": "<p>I am trying to <code>Count</code> the number of <code>partial matches</code> in an 1D-Array without resorting to looping the array. <code>STerm</code> contains the string Key to search. I tried using the following functions:</p>\n\n<p><code>Sterm</code> is a <code>Dictionary</code> that i am looping and so changes everytime. The Dictionary items corresponding to that key is a 2D array of different string values. I am looping through the 1st dimension and it is a 1D array of values in which <code>Sterm</code> may be present.</p>\n\n<p>e.g. if <code>Sterm</code> is <code>TC</code> then array may contain <code>TC</code>, <code>TC 1</code>, <code>TC A</code>... etc., and function should find and count these partial matches.</p>\n\n<pre><code>With Application\nbCount = .Count(.Find(.Index(oVarDict(Key), i), sTerm, 1))\nbCount = .Count(.Find(.Index(oVarDict(Key), i), sTerm &amp; \"*\", 1))\n...\n</code></pre>\n\n<p>Now the combination of <code>Application.Count</code> &amp; <code>Application.Find</code> works well (as Count excludes any error values), but <code>Application.Find</code> results in an <code>EXACT</code> match. I want <code>PARTIAL</code> matches. <code>This looked very promising until it started returning 0 counts for partial matches i.e. it was not able to detect partial matches.</code></p>\n\n<blockquote>\n  <p>Also, there is no documentation available on MSDN or web for <code>Application.Find</code> Syntax.</p>\n</blockquote>\n\n<p>Then i tried using <code>VBA.Filter</code> as it is known to return <code>Partial matches</code>. But <code>Application.Count</code>is not able to count <code>textual values</code>. So i used <code>Application.CountA</code>, but it results in a Type mismatch error for some unknown reason.</p>\n\n<blockquote>\n  <p>Also i do not know what <code>VBA.Filter</code> returns if it is not to find any matches.</p>\n</blockquote>\n\n<p>So i thought of doing a <code>VBA.Replace</code> of all partial matches to 1 and then feed it to <code>Count</code>. It is also resulting in error - <code>Expression not in expected context</code>.</p>\n\n<pre><code>Application.Count(CLng(VBA.Replace(Join(VBA.Filter(Application.Index(oVarDict(Key), i), sterm, True, vbTextCompare), \",\"), sterm, 1)))\n</code></pre>\n\n<p>I tried using <code>Application.Countif</code> but not sure how to write it in VBA.</p>\n\n<pre><code>Application.CountIf(Application.Index(oVarDict(Key), i), sterm &amp; \"*\")\n</code></pre>\n\n<p>But it throws <code>Error 2015</code>.</p>\n\n<p>Am i missing some syntax OR is there a better function to find and count partial matches without looping?</p>\n"}, {"tags": ["excel", "vba", "webautomation"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1571243936, "post_id": 58416977, "comment_id": 103178595, "body": "And is this code not working? Please use snippet tool via <a href=\"https://stackoverflow.com/posts/58416977/edit\">edit</a> to insert the html and indicate the link you are trying to click."}, {"owner": {"reputation": 25, "user_id": 8512722, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QDUVk3CvJeM/AAAAAAAAAAI/AAAAAAAAAGI/I6Cwjjl1Iww/photo.jpg?sz=128", "display_name": "Thomas Bever", "link": "https://stackoverflow.com/users/8512722/thomas-bever"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1571253230, "post_id": 58416977, "comment_id": 103182705, "body": "It seems to be looping back to the &quot;username&quot; line. That is the highlighted line when I debug. There are no changes/navigation on the IE page. I added an image of the HTML with the link highlighted. Thanks!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1571257780, "post_id": 58416977, "comment_id": 103184689, "body": "Are you getting any error messages? Please use the snippet tool via <a href=\"https://stackoverflow.com/posts/58416977/edit\">edit</a> to insert html. You will see it in the edit toolbar with &lt;&gt; on it."}, {"owner": {"reputation": 25, "user_id": 8512722, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QDUVk3CvJeM/AAAAAAAAAAI/AAAAAAAAAGI/I6Cwjjl1Iww/photo.jpg?sz=128", "display_name": "Thomas Bever", "link": "https://stackoverflow.com/users/8512722/thomas-bever"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1571327629, "post_id": 58416977, "comment_id": 103213139, "body": "Ah I see. I have added the HTML with the snippet tool. I was unable to highlight the line in question but it is towards the bottom and denoted as &quot;```***This line is the target destination***&quot;. The error I receive is &quot;Run-time error &#39;70&#39;: Permission Denied. It occurs at the line: If ul.class = &quot;nav ui-sortable&quot; Then in the VBA code"}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1571328805, "creation_date": 1571328805, "answer_id": 58436847, "question_id": 58416977, "link": "https://stackoverflow.com/questions/58416977/how-do-i-use-vba-to-automate-navigation-through-a-webpage/58436847#58436847", "title": "How do I use VBA to automate navigation through a webpage?", "body": "<p>A few things I observe:</p>\n\n<ol>\n<li>The submit button is wrapped in a form element, and I think you may need to <code>.Submit()</code> the form rather than <code>Click</code> the button. Both seem to work when I test it, though. See the HTML:</li>\n</ol>\n\n<pre><code>   &lt;form name=\"loginform\" method=\"post\" autocomplete=\"off\" class=\"login-form\"&gt;\n            &lt;div class=\"login-form-inner\"&gt;\n                &lt;div class=\"field-wrapper\"&gt;\n                    &lt;label for=\"username\"&gt;Username&lt;/label&gt;\n                    &lt;input type=\"text\" name=\"username\" id=\"username\" autocomplete=\"off\" value=\"asdfadf\" maxlength=\"255\" class=\"input-block-level\" autofocus=\"\"&gt;\n                    &lt;p class=\"text-error\"&gt;&lt;/p&gt;\n                &lt;/div&gt;\n                &lt;p&gt;\n                    &lt;input class=\"btn btn-login btn-large\" id=\"submitBtn\" name=\"submitBtn\" value=\"Next\" type=\"submit\"&gt;\n                &lt;/p&gt;\n            &lt;/div&gt;\n        &lt;/form&gt;\n</code></pre>\n\n<ol start=\"2\">\n<li>You probably want to assign object variable to the username &amp; password elements</li>\n<li>You may need to use the ready/waiting loop after each click/submit.</li>\n<li><p>The <code>li</code> items use a relative path, so rather than comparing the full URL, your logic should probably also use the relative path:</p>\n\n<pre><code>If li.className = \"top-level-menu-link\" And li.href = \"/smrs/AdhocReportControlServlet?hdn_function=SPECIMEN_SEARCH&amp;amp;hdn_function_type=REPORT_SEARCH\"\n</code></pre></li>\n</ol>\n\n<p>Since I can't get past the Username (I don't have a valid username of course), this is the best I can do:</p>\n\n<pre><code>Sub Test()\n\nDim IE As Object\nDim doc As Object\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\nIE.Visible = True\nIE.Navigate \"https://iuctsi-oncore-prod.forteresearchapps.com/smrs/AdhocReportControlServlet\"\n\nCall ReadyWaitingLoop(IE)\n\nSet doc = IE.Document\n\nDim userEle As Object, pwEle As Object, submitBtn As Object, frm As Object\nSet frm = doc.getElementsByClassName(\"login-form\")(0)\nSet userEle = doc.GetElementById(\"username\")\nuserEle.Value = \"Username\" ' ## MODIFY to use a real username\nSet submitBtn = doc.GetElementById(\"submitBtn\")\nfrm.Submit  ' or submitBtn.Click -- not sure which is needed, both seem to work as tested\n\nCall ReadyWaitingLoop(IE)\n\nSet pwEle = doc.GetElementById(\"password\")\nSet submitBtn = doc.GetElementById(\"submitBtn\")  '## maybe case-sensitive\npwEle.Value = \"Password\" ' ## MODIFY to use a real password\nfrm.Submit  ' or submitBtn.Click -- not sure which is needed, both seem to work as tested\n\nCall ReadyWaitingLoop(IE)\n\n' Rest of your code...\n\nEnd Sub\n\n\nSub ReadyWaitingLoop(IE As Object)\nDo While IE.Busy Or IE.ReadyState &lt;&gt; 4\n   DoEvents\nLoop\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 8512722, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QDUVk3CvJeM/AAAAAAAAAAI/AAAAAAAAAGI/I6Cwjjl1Iww/photo.jpg?sz=128", "display_name": "Thomas Bever", "link": "https://stackoverflow.com/users/8512722/thomas-bever"}, "edited": false, "score": 0, "creation_date": 1571670754, "post_id": 58438567, "comment_id": 103308766, "body": "Your recommendation worked. Thank you! I am unable to further navigate through the page though. The following are the elements I am working with:"}, {"owner": {"reputation": 25, "user_id": 8512722, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QDUVk3CvJeM/AAAAAAAAAAI/AAAAAAAAAGI/I6Cwjjl1Iww/photo.jpg?sz=128", "display_name": "Thomas Bever", "link": "https://stackoverflow.com/users/8512722/thomas-bever"}, "edited": false, "score": 0, "creation_date": 1571672020, "post_id": 58438567, "comment_id": 103309481, "body": "I did not mean to submit my comment above. I updated the code I&#39;m working with though and am running into more road blocks while trying to use querySelector. I commented on the line where I am having that issue with the element that I am trying to work with."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1571336225, "creation_date": 1571336225, "answer_id": 58438567, "question_id": 58416977, "link": "https://stackoverflow.com/questions/58416977/how-do-i-use-vba-to-automate-navigation-through-a-webpage/58438567#58438567", "title": "How do I use VBA to automate navigation through a webpage?", "body": "<p>Try working off IE.document after ensuring proper page load wait after prior click then avoid loop and use css attribute = value selector</p>\n\n<pre><code>doc.getElementById(\"submitBtn\").Click\nWhile ie.Busy Or ie.ReadyState&lt;&gt;4:DoEvents:Wend\nie.document.querySelector(\"[href$=REPORT_SEARCH]\").click\nWhile ie.Busy Or ie.ReadyState&lt;&gt;4:DoEvents:Wend\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8512722, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QDUVk3CvJeM/AAAAAAAAAAI/AAAAAAAAAGI/I6Cwjjl1Iww/photo.jpg?sz=128", "display_name": "Thomas Bever", "link": "https://stackoverflow.com/users/8512722/thomas-bever"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 58438567, "answer_count": 2, "score": 1, "last_activity_date": 1571671886, "creation_date": 1571240108, "last_edit_date": 1571671886, "question_id": 58416977, "link": "https://stackoverflow.com/questions/58416977/how-do-i-use-vba-to-automate-navigation-through-a-webpage", "title": "How do I use VBA to automate navigation through a webpage?", "body": "<p>I have successfully been able to navigate to a webpage and get logged in but I am getting hung up on identifying the proper elements to follow clickable links. I ultimately would like to navigate to a specific location on a website and use excel to automate data entry from an excel file into an input box on the webpage. </p>\n\n<p>I initially just tried opening the page needed directly but am prompted with user login which ultimately opens to the default home page. I have tried to identify the HTML page elements to follow the clickable path but I'm not sure how specific I need to be or how far up the hierarchy I need to define. I have tried the following: </p>\n\n<p>This is the code that I have so far: </p>\n\n<pre><code>Sub Test()\n\nDim IE As Object\nDim doc As HTMLDocument\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\nIE.Visible = True\nIE.Navigate \"https://iuctsi-oncore-prod.forteresearchapps.com/smrs/AdhocReportControlServlet\"\n\nDo While IE.Busy Or IE.ReadyState &lt;&gt; 4\n   DoEvents\nLoop\n\nSet doc = IE.Document\n\ndoc.getElementById(\"username\").Value = \"Username\"\ndoc.getElementById(\"submitbtn\").Click\ndoc.getElementById(\"password\").Value = \"Password\"\ndoc.getElementById(\"submitbtn\").Click\n\n\nSet ul = IE.Document.getElementsByTagName(\"ul\")\n   If li.class = \"ui-sortable-handle\" And role = \"presentation\" Then\n        Set link = IE.Document.getElementsByTagName(\"a\")\n          For Each li In link\n             If li.className = \"top-level-menu-link\" And li.href = \"https://iuctsi-oncore-prod.forteresearchapps.com/smrs/AdhocReportControlServlet?hdn_function=SPECIMEN_SEARCH&amp;amp;hdn_function_type=REPORT_SEARCH\" Then\n            link.Click\n            Exit For\n            End If\n   Next\n      End If\n\nEnd Sub\n</code></pre>\n\n<p>I thought it would suffice to just define the classname \"top-level-menu-link\" and the href but there are also ul id=\"nav\", li class =\"nav iu-sortable\" and role =\"Presentation\" elements above. I'm obviously inexperienced with this stuff but am trying to learn to save my sanity from nonstop monotonous data entry.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;a class=\"brand\" href=\"/smrs/SMRSHomePageServlet?hdn_function=WELCOME\"&gt;\r\n  &lt;img src=\"/smrs/images/menu/menu_logo.png?v=20190523144203\"&gt;\r\n&lt;/a&gt;\r\n&lt;script type=\"application/json\" id=\"app-menu-items\"&gt;\r\n  { &amp; #34;data&amp;# 34;: { &amp; #34;key&amp;# 34;: &amp; #34;ROOT&amp;# 34;,\r\n      &amp;\r\n      #34;label&amp;# 34;: &amp; #34;Menu&amp;# 34;,\r\n      &amp;\r\n      #34;url&amp;# 34;: null,\r\n      &amp;\r\n      #34;active&amp;# 34;: false,\r\n      &amp;\r\n      #34;external&amp;# 34;: false\r\n    }, &amp; #34;children&amp;# 34;: [{ &amp; #34;data&amp;# 34;: { &amp; #34;key&amp;# 34;: &amp; #34;MY_CONSOLE_ITEM&amp;# 34;,\r\n          &amp;\r\n          #34;label&amp;# 34;: &amp; #34;My Console&amp;# 34;,\r\n          &amp;\r\n          #34;url&amp;# 34;: &amp; #34;/smrs/MyConsoleControlServlet&amp;# 34;,\r\n          &amp;\r\n          #34;active&amp;# 34;: false,\r\n          &amp;\r\n          #34;external&amp;# 34;: false\r\n        },\r\n        &amp;\r\n        #34;children&amp;# 34;: []\r\n      }, { &amp; #34;data&amp;# 34;: { &amp; #34;key&amp;# 34;: &amp; #34;PROTOCOLS_GROUP&amp;# 34;,\r\n          &amp;\r\n          #34;label&amp;# 34;: &amp; #34;Protocols&amp;# 34;,\r\n          &amp;\r\n          #34;url&amp;# 34;: null,\r\n          &amp;\r\n          #34;active&amp;# 34;: false,\r\n          &amp;\r\n          #34;external&amp;# 34;: false\r\n        },\r\n        &amp;\r\n        #34;children&amp;# 34;: [{ &amp; #34;data&amp;# 34;: { &amp; #34;key&amp;# 34;: &amp; #34;DOCUMENT_SEARCH_ITEM&amp;# 34;,\r\n                &amp;\r\n                #34;label&amp;# 34;: &amp; #34;Document Search&amp;# 34;,\r\n                &amp;\r\n                #34;url&amp;# 34;: &amp; #34;/smrs/SMRSControlServlet?hdn_function= DOCUMENT_SEARCH &amp; #34;,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[]},{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;PC_CONSOLE_ITEM &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;PC Console &amp; #34;,&amp;# 34;url &amp; #34;:&amp;# 34;\r\n                /smrs/SMRSControlServlet ? hdn_function = PROTOCOL_INQUIRY &amp; #34;,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[]},{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;PROTOCOL_SEARCH_ITEM &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;Protocol Search &amp; #34;,&amp;# 34;url &amp; #34;:&amp;# 34;\r\n                /smrs/SMRSControlServlet ? hdn_function = PROTOCOL_SEARCH &amp; #34;,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[]},{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;PROTOCOL_SEARCH_LAST_RESULTS &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;Protocol Search - Last Results &amp; #34;,&amp;# 34;url &amp; #34;:&amp;# 34;\r\n                /smrs/PRBrowseServlet ? hdn_function = PROTOCOL_SEARCH_LAST_RESULTS &amp; #34;,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[]}]},{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;REPORTS_GROUP &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;Reports &amp; #34;,&amp;# 34;url &amp; #34;:null,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;REPORTS_ITEM &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;Reports &amp; #34;,&amp;# 34;url &amp; #34;:&amp;# 34;\r\n                /smrs/SMRSControlServlet ? hdn_function = PL_REPORTS_MAINTAIN &amp; amp;hdn_PRIVILEGE_ID,\r\n                FUNCTION_GROUP_type = REPORTS &amp; amp;on_success = /plinks/jsp / pl_report_browse.jsp &amp; #34;,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[]}]},{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;SPECIMENS_GROUP &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;Specimens &amp; #34;,&amp;# 34;url &amp; #34;:null,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;BSM_DASHBOARD_ITEM &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;BSM Dashboard &amp; #34;,&amp;# 34;url &amp; #34;:&amp;# 34;\r\n                /smrs/BSMSReportsControlServlet ? hdn_function = BSM_DASHBOARD &amp; #34;,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[]},{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;SPECIMEN_BULK_MOVE_ITEM &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;Specimen Bulk Move &amp; #34;,&amp;# 34;url &amp; #34;:&amp;# 34;\r\n                /smrs/BSMSSpecimenCollectionControlServlet ? hdn_function = BULK_MOVE &amp; #34;,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[]},{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;SPECIMEN_COLLECTION_CONSOLE_ITEM &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;Specimen Collection Console &amp; #34;,&amp;# 34;url &amp; #34;:&amp;# 34;\r\n                /smrs/BSMSSpecimenCollectionControlServlet ? hdn_function = SPECIMEN_COLLECTION &amp; amp;hdn_function_type = INQUIRY &amp; #34;,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[]},{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;SPECIMEN_CUSTOM_REPORT_ITEM &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;Specimen Custom Report &amp; #34;,&amp;# 34;url &amp; #34;:&amp;# 34;\r\n                /smrs/AdhocReportControlServlet ? hdn_function = SPECIMEN_SEARCH &amp; amp;hdn_function_type = REPORT_SEARCH &amp; #34;,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[]},{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;SPECIMEN_DATA_ENTRY_ITEM &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;Specimen Data Entry &amp; #34;,&amp;# 34;url &amp; #34;:&amp;# 34;\r\n                /smrs/BSMSpecimenEntryControlServlet ? hdn_function = SPECIMEN_COLLECTION &amp; #34;,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[]},{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;SPECIMEN_IMPORT_ITEM &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;Specimen Import &amp; #34;,&amp;# 34;url &amp; #34;:&amp;# 34;\r\n                /smrs/BSMSpecimenUploadServlet ? hdn_function = SPECIMEN_IMPORT &amp; #34;,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[]},{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;SPECIMEN_REQUEST_CONSOLE_ITEM &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;Specimen Request Console &amp; #34;,&amp;# 34;url &amp; #34;:&amp;# 34;\r\n                /smrs/BSMSpecimenRequestControlServlet ? hdn_function = REQUEST_LIST &amp; amp;default_list = Y &amp; #34;,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[]},{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;STORAGE_BROWSE_ITEM &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;Storage Browse &amp; #34;,&amp;# 34;url &amp; #34;:&amp;# 34;\r\n                /smrs/bsmStorage / browse /\r\n                default.do &amp; #34;,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[]},{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;WORKING_LISTS_ITEM &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;Working Lists &amp; #34;,&amp;# 34;url &amp; #34;:&amp;# 34;\r\n                /smrs/BSMSSpecimenCollectionControlServlet ? hdn_function = WORKING_LISTS &amp; #34;,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[]}]},{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;SUBJECTS_GROUP &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;Subjects &amp; #34;,&amp;# 34;url &amp; #34;:null,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;CRA_CONSOLE_ITEM &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;CRA Console &amp; #34;,&amp;# 34;url &amp; #34;:&amp;# 34;\r\n                /smrs/SMRSControlServlet ? hdn_function = CRA_CONSOLE &amp; #34;,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[]},{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;SUBJECT_CONSOLE_ITEM &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;Subject Console &amp; #34;,&amp;# 34;url &amp; #34;:&amp;# 34;\r\n                /smrs/SMRSControlServlet ? hdn_function = SUBJECT_CONSOLE &amp; #34;,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[]},{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;SUBJECT_SEARCH_ITEM &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;Subject Search &amp; #34;,&amp;# 34;url &amp; #34;:&amp;# 34;\r\n                /smrs/SMRSControlServlet ? hdn_function = SUBJECT_INQUIRY &amp; #34;,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[]},{&amp;# 34;data &amp; #34;:{&amp;# 34;key &amp; #34;:&amp;# 34;SUBJECT_SEARCH_LAST_RESULTS &amp; #34;,&amp;# 34;label &amp; #34;:&amp;# 34;Subject Search - Last Results &amp; #34;,&amp;# 34;url &amp; #34;:&amp;# 34;\r\n                /smrs/SubjectBrowseServlet ? hdn_function = SUBJECT_SEARCH_LAST_RESULTS &amp; #34;,&amp;# 34;active &amp; #34;:false,&amp;# 34;external &amp; #34;:false},&amp;# 34;children &amp; #34;:[]}]}]}\r\n&lt;/script&gt;\r\n&lt;script type=\"application/json\" id=\"user-favorite-keys\"&gt;\r\n  [ &amp; #34;BSM_DASHBOARD_ITEM&amp;# 34;, &amp; #34;WORKING_LISTS_ITEM&amp;# 34;, &amp; #34;STORAGE_BROWSE_ITEM&amp;# 34;, &amp; #34;SPECIMEN_CUSTOM_REPORT_ITEM&amp;# 34;, &amp; #34;SPECIMEN_COLLECTION_CONSOLE_ITEM&amp;# 34;, &amp; #34;SPECIMEN_IMPORT_ITEM&amp;# 34;]\r\n&lt;/script&gt;\r\n&lt;ul class=\"nav\" id=\"nav\"&gt;\r\n  &lt;li class=\"dropdown star-menu\"&gt;&lt;a href=\"#\" class=\"main-menu-link dropdown-toggle\" data-toggle=\"main-menu\"&gt;Menu&amp;nbsp;&lt;i class=\"icon-menu-hamburger\"&gt;&lt;/i&gt;&lt;/a&gt;\r\n    &lt;ul class=\"dropdown-menu\" role=\"main-menu\"&gt;\r\n      &lt;li role=\"presentation\" class=\"\"&gt;\r\n        &lt;a href=\"/smrs/MyConsoleControlServlet\"&gt;\r\n          &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star-empty\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;My Console&lt;/span&gt;&lt;/a&gt;\r\n      &lt;/li&gt;\r\n      &lt;li class=\"dropdown-submenu\"&gt;\r\n        &lt;a href=\"#\"&gt;\r\n          &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star-empty\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Protocols&lt;/span&gt;&lt;/a&gt;\r\n        &lt;ul class=\"dropdown-menu\" role=\"main-menu\" style=\"top: -6px; left: 99px;\"&gt;\r\n          &lt;li role=\"presentation\" class=\"\"&gt;\r\n            &lt;a href=\"/smrs/SMRSControlServlet?hdn_function=DOCUMENT_SEARCH\"&gt;\r\n              &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star-empty\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Document Search&lt;/span&gt;&lt;/a&gt;\r\n          &lt;/li&gt;\r\n          &lt;li role=\"presentation\" class=\"\"&gt;\r\n            &lt;a href=\"/smrs/SMRSControlServlet?hdn_function=PROTOCOL_INQUIRY\"&gt;\r\n              &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star-empty\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;PC Console&lt;/span&gt;&lt;/a&gt;\r\n          &lt;/li&gt;\r\n          &lt;li role=\"presentation\" class=\"\"&gt;\r\n            &lt;a href=\"/smrs/SMRSControlServlet?hdn_function=PROTOCOL_SEARCH\"&gt;\r\n              &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star-empty\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Protocol Search&lt;/span&gt;&lt;/a&gt;\r\n          &lt;/li&gt;\r\n          &lt;li role=\"presentation\" class=\"\"&gt;\r\n            &lt;a href=\"/smrs/PRBrowseServlet?hdn_function=PROTOCOL_SEARCH_LAST_RESULTS\"&gt;\r\n              &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star-empty\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Protocol Search - Last Results&lt;/span&gt;&lt;/a&gt;\r\n          &lt;/li&gt;\r\n        &lt;/ul&gt;\r\n      &lt;/li&gt;\r\n      &lt;li class=\"dropdown-submenu\"&gt;\r\n        &lt;a href=\"#\"&gt;\r\n          &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star-empty\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Reports&lt;/span&gt;&lt;/a&gt;\r\n        &lt;ul class=\"dropdown-menu\" role=\"main-menu\" style=\"top: -6px; left: 99px;\"&gt;\r\n          &lt;li role=\"presentation\" class=\"\"&gt;\r\n            &lt;a href=\"/smrs/SMRSControlServlet?hdn_function=PL_REPORTS_MAINTAIN&amp;amp;hdn_PRIVILEGE_ID,\r\n\r\nFUNCTION_GROUP_type=REPORTS&amp;amp;on_success=/plinks/jsp/pl_report_browse.jsp\"&gt;\r\n              &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star-empty\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Reports&lt;/span&gt;&lt;/a&gt;\r\n          &lt;/li&gt;\r\n        &lt;/ul&gt;\r\n      &lt;/li&gt;\r\n      &lt;li class=\"dropdown-submenu\"&gt;\r\n        &lt;a href=\"#\"&gt;\r\n          &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star-empty\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Specimens&lt;/span&gt;&lt;/a&gt;\r\n        &lt;ul class=\"dropdown-menu\" role=\"main-menu\" style=\"top: -6px; left: 99px;\"&gt;\r\n          &lt;li role=\"presentation\" class=\"\"&gt;\r\n            &lt;a href=\"/smrs/BSMSReportsControlServlet?hdn_function=BSM_DASHBOARD\"&gt;\r\n              &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;BSM Dashboard&lt;/span&gt;&lt;/a&gt;\r\n          &lt;/li&gt;\r\n          &lt;li role=\"presentation\" class=\"\"&gt;\r\n            &lt;a href=\"/smrs/BSMSSpecimenCollectionControlServlet?hdn_function=BULK_MOVE\"&gt;\r\n              &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star-empty\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Specimen Bulk Move&lt;/span&gt;&lt;/a&gt;\r\n          &lt;/li&gt;\r\n          &lt;li role=\"presentation\" class=\"\"&gt;\r\n            &lt;a href=\"/smrs/BSMSSpecimenCollectionControlServlet?hdn_function=SPECIMEN_COLLECTION&amp;amp;hdn_function_type=INQUIRY\"&gt;\r\n              &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Specimen Collection Console&lt;/span&gt;&lt;/a&gt;\r\n          &lt;/li&gt;\r\n          &lt;li role=\"presentation\" class=\"\"&gt;\r\n            &lt;a href=\"/smrs/AdhocReportControlServlet?hdn_function=SPECIMEN_SEARCH&amp;amp;hdn_function_type=REPORT_SEARCH\"&gt;\r\n              &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Specimen Custom Report&lt;/span&gt;&lt;/a&gt;\r\n          &lt;/li&gt;\r\n          &lt;li role=\"presentation\" class=\"\"&gt;\r\n            &lt;a href=\"/smrs/BSMSpecimenEntryControlServlet?hdn_function=SPECIMEN_COLLECTION\"&gt;\r\n              &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star-empty\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Specimen Data Entry&lt;/span&gt;&lt;/a&gt;\r\n          &lt;/li&gt;\r\n          &lt;li role=\"presentation\" class=\"\"&gt;\r\n            &lt;a href=\"/smrs/BSMSpecimenUploadServlet?hdn_function=SPECIMEN_IMPORT\"&gt;\r\n              &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Specimen Import&lt;/span&gt;&lt;/a&gt;\r\n          &lt;/li&gt;\r\n          &lt;li role=\"presentation\" class=\"\"&gt;\r\n            &lt;a href=\"/smrs/BSMSpecimenRequestControlServlet?hdn_function=REQUEST_LIST&amp;amp;default_list=Y\"&gt;\r\n              &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star-empty\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Specimen Request Console&lt;/span&gt;&lt;/a&gt;\r\n          &lt;/li&gt;\r\n          &lt;li role=\"presentation\" class=\"\"&gt;\r\n            &lt;a href=\"/smrs/bsmStorage/browse/default.do\"&gt;\r\n              &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Storage Browse&lt;/span&gt;&lt;/a&gt;\r\n          &lt;/li&gt;\r\n          &lt;li role=\"presentation\" class=\"\"&gt;\r\n            &lt;a href=\"/smrs/BSMSSpecimenCollectionControlServlet?hdn_function=WORKING_LISTS\"&gt;\r\n              &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Working Lists&lt;/span&gt;&lt;/a&gt;\r\n          &lt;/li&gt;\r\n        &lt;/ul&gt;\r\n      &lt;/li&gt;\r\n      &lt;li class=\"dropdown-submenu\"&gt;\r\n        &lt;a href=\"#\"&gt;\r\n          &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star-empty\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Subjects&lt;/span&gt;&lt;/a&gt;\r\n        &lt;ul class=\"dropdown-menu\" role=\"main-menu\" style=\"top: -6px; left: 99px;\"&gt;\r\n          &lt;li role=\"presentation\" class=\"\"&gt;\r\n            &lt;a href=\"/smrs/SMRSControlServlet?hdn_function=CRA_CONSOLE\"&gt;\r\n              &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star-empty\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;CRA Console&lt;/span&gt;&lt;/a&gt;\r\n          &lt;/li&gt;\r\n          &lt;li role=\"presentation\" class=\"\"&gt;\r\n            &lt;a href=\"/smrs/SMRSControlServlet?hdn_function=SUBJECT_CONSOLE\"&gt;\r\n              &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star-empty\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Subject Console&lt;/span&gt;&lt;/a&gt;\r\n          &lt;/li&gt;\r\n          &lt;li role=\"presentation\" class=\"\"&gt;\r\n            &lt;a href=\"/smrs/SMRSControlServlet?hdn_function=SUBJECT_INQUIRY\"&gt;\r\n              &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star-empty\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Subject Search&lt;/span&gt;&lt;/a&gt;\r\n          &lt;/li&gt;\r\n          &lt;li role=\"presentation\" class=\"\"&gt;\r\n            &lt;a href=\"/smrs/SubjectBrowseServlet?hdn_function=SUBJECT_SEARCH_LAST_RESULTS\"&gt;\r\n              &lt;div class=\"menu-icon-wrapper\"&gt;&lt;i class=\"icon-star-empty\"&gt;&lt;/i&gt;&lt;/div&gt;&lt;span class=\"link-text\"&gt;Subject Search - Last Results&lt;/span&gt;&lt;/a&gt;\r\n          &lt;/li&gt;\r\n        &lt;/ul&gt;\r\n      &lt;/li&gt;\r\n    &lt;/ul&gt;\r\n  &lt;/li&gt;\r\n  &lt;ul class=\"nav ui-sortable\"&gt;\r\n    &lt;li role=\"presentation\" class=\"ui-sortable-handle\"&gt;&lt;a class=\"top-level-menu-link\" href=\"/smrs/BSMSReportsControlServlet?hdn_function=BSM_DASHBOARD\"&gt;BSM Dashboard&lt;/a&gt;&lt;/li&gt;\r\n    &lt;li role=\"presentation\" class=\"ui-sortable-handle\"&gt;&lt;a class=\"top-level-menu-link\" href=\"/smrs/BSMSSpecimenCollectionControlServlet?hdn_function=WORKING_LISTS\"&gt;Working Lists&lt;/a&gt;&lt;/li&gt;\r\n    &lt;li role=\"presentation\" class=\"ui-sortable-handle\"&gt;&lt;a class=\"top-level-menu-link\" href=\"/smrs/bsmStorage/browse/default.do\"&gt;Storage Browse&lt;/a&gt;&lt;/li&gt;\r\n\r\n``` ***Target destination is this line****        \r\n&lt;li role=\"presentation\" class=\"ui-sortable-handle\"&gt;&lt;a class=\"top-level-menu-link\" href=\"/smrs/AdhocReportControlServlet?hdn_function=SPECIMEN_SEARCH&amp;amp;hdn_function_type=REPORT_SEARCH\"&gt;Specimen Custom Report&lt;/a&gt;&lt;/li&gt;\r\n\r\n```\r\n    &lt;li role=\"presentation\" class=\"ui-sortable-handle\"&gt;&lt;a class=\"top-level-menu-link\" href=\"/smrs/BSMSSpecimenCollectionControlServlet?hdn_function=SPECIMEN_COLLECTION&amp;amp;hdn_function_type=INQUIRY\"&gt;Specimen Collection Console&lt;/a&gt;&lt;/li&gt;\r\n    &lt;li role=\"presentation\" class=\"ui-sortable-handle\"&gt;&lt;a class=\"top-level-menu-link\" href=\"/smrs/BSMSpecimenUploadServlet?hdn_function=SPECIMEN_IMPORT\"&gt;Specimen Import&lt;/a&gt;&lt;/li&gt;\r\n  &lt;/ul&gt;\r\n&lt;/ul&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><a href=\"https://i.stack.imgur.com/tx2Of.png\" rel=\"nofollow noreferrer\">HTML</a></p>\n\n<p>I have modified my code with the following changes recommended by the commentors below: </p>\n\n<pre><code>Sub Test()\n\nDim IE As Object\nDim doc As Object\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\nIE.Visible = True\nIE.navigate \"https://iuctsi-oncore-prod.forteresearchapps.com/smrs/AdhocReportControlServlet\"\n\nCall ReadyWaitingLoop(IE)\n\nSet doc = IE.document\n\nDim userEle As Object, pwEle As Object, submitBtn As Object, frm As Object\nSet frm = doc.getElementsByClassName(\"login-form\")(0)\nSet userEle = doc.getElementById(\"username\")\nuserEle.Value = \"username\" ' ## MODIFY to use a real username\nSet submitBtn = doc.getElementById(\"submitBtn\")\nfrm.submit  ' or submitBtn.Click -- not sure which is needed, both seem to work as tested\nCall ReadyWaitingLoop(IE)\n\nSet pwEle = doc.getElementById(\"password\")\nSet submitBtn = doc.getElementById(\"submitBtn\")  '## maybe case-sensitive\npwEle.Value = \"password\" ' ## MODIFY to use a real password\nsubmitBtn.Click '-- not sure which is needed, both seem to work as tested frm.submit  ' or\n\n    Call ReadyWaitingLoop(IE)\n\nWhile IE.Busy Or IE.readyState &lt;&gt; 4: DoEvents: Wend\nIE.document.querySelector(\"[href$=REPORT_SEARCH]\").Click\nWhile IE.Busy Or IE.readyState &lt;&gt; 4: DoEvents: Wend\n\nWhile IE.Busy Or IE.readyState &lt;&gt; 4: DoEvents: Wend\nIE.document.querySelector(\"[href$=CustomReportGroup_Mine_IUGBQCChecks\").Click '----This reference does not seem to work. The original element is:&lt;a id=\"groupHead_3\" href=\"javascript:showhide(3,'CustomReportGroup_Mine_IUGBQCChecks' );\"&gt;[-]&lt;/a&gt; \nWhile IE.Busy Or IE.readyState &lt;&gt; 4: DoEvents: Wend\n\nWhile IE.Busy Or IE.readyState &lt;&gt; 4: DoEvents: Wend\nIE.document.querySelector(\"[href$=Copy of Hemoglobin QC_CO\").Click\nWhile IE.Busy Or IE.readyState &lt;&gt; 4: DoEvents: Wend\n\n\n' Rest of your code...\n\n\n\nEnd Sub\n\n\nSub ReadyWaitingLoop(IE As Object)\nDo While IE.Busy Or IE.readyState &lt;&gt; 4\n   DoEvents\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "dynamic-sql", "subform", "record-count"], "answers": [{"comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 1, "creation_date": 1571320056, "post_id": 58419935, "comment_id": 103208765, "body": "It&#39;s very good practice in general with a SQL back end and larger recordsets to always try and load a form with no underlying records, then only load a filtered set based on user choice. Glad you sorted it out!"}, {"owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1571333367, "post_id": 58419935, "comment_id": 103215742, "body": "Yeah, I also had to remind myself to create SQL views whenever I can, instead of building all of it in the VBA.  It loads so much slower, constructing it in VBA."}], "tags": [], "owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "is_accepted": false, "score": 0, "last_activity_date": 1571251956, "creation_date": 1571251956, "answer_id": 58419935, "question_id": 58416971, "link": "https://stackoverflow.com/questions/58416971/access-vba-subform-dynamic-sql-parent-form-count-slow/58419935#58419935", "title": "Access VBA Subform Dynamic SQL Parent Form Count Slow", "body": "<p>I found the answer, so I wanted to post the solution for anyone it may help.</p>\n\n<p>To make the form load faster, I converted the initial fSQL select, into a SQL view, and then made that initial fSQL be this:</p>\n\n<pre><code>fSQL = \"SELECT * FROM vw_MyNewView WHERE 1 = 1 \"\n</code></pre>\n\n<p>Then, after I set the subform's recordsource and requery it, I have the following:</p>\n\n<pre><code>With Me.frmSubform.Form.RecordsetClone\n    If .RecordCount &gt; 0 Then .MoveLast\n    ccount = .RecordCount\nEnd With\nMe.txtCountRecords = ccount &amp; \" Records\"\n</code></pre>\n\n<p>The form loads way quicker, and this count tabulates quickly too.</p>\n\n<p>Hope this helps others!</p>\n"}], "owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594421324, "creation_date": 1571240098, "last_edit_date": 1594421324, "question_id": 58416971, "link": "https://stackoverflow.com/questions/58416971/access-vba-subform-dynamic-sql-parent-form-count-slow", "title": "Access VBA Subform Dynamic SQL Parent Form Count Slow", "body": "<p>I have a filters private function on a form, to dynamically generate the SQL for the record source on a subform, for searching records. I run this onload of the main form, and afterupdate of a series of text box (dates), comobo box, and check box controls. Below is the Filters code. When the form loads, there are 15,247 records. When I load the form, it is frozen for a while, getting the count. </p>\n\n<p>The subform is datasheet, and I wanted the counts bigger than the navigation buttons record count, so I put a textbox on the form footer of the main form. \nTo display the count of the subform records on the main form, I put a textbox in the form footer of the subform, and it's control source =count(*)</p>\n\n<p>On the main form footer textbox, the controlsource is<br>\n=[frmsubform].[Form]![txtCountrecs] &amp; \" Records\"</p>\n\n<p>It works, but it is so slow.  I'm wondering if there is anyway to make this less slow and laggy.</p>\n\n<pre><code>Private Sub Filters()\n    Dim fSQL As String\n\n    fSQL = \"SELECT [fields] \" &amp; _\n            \"FROM tbltable1 LEFT JOIN tbltable2 ON tbltable1.ID = tbltable2.FKtbl1ID \" &amp; _\n            \"WHERE ((tbltable3.ID) Is Not Null) AND ((tbltable4.ID) Is Not Null)) \"\n\n    If Nz(Me.cboFilterTo.Value, 0) &lt;&gt; 0 Then\n        fSQL = fSQL &amp; \" AND tbltable5.ID = \" &amp; Me.cboFilterTo.Column(0)\n    End If\n\n    If Nz(Me.cboFilterFrom.Value, 0) &lt;&gt; 0 Then\n        fSQL = fSQL &amp; \" AND tbltable6.ID = \" &amp; Me.cboFilterFrom.Column(0)\n    End If\n\n    If Nz(Me.txtDateOnOrAfter, 0) &lt;&gt; 0 Then\n        fSQL = fSQL &amp; \" AND tbltable4.dtdate &gt;= \" &amp; Me.txtDateOnOrAfter\n    End If\n\n    If Nz(Me.txtDateOnOrBefore, 0) &lt;&gt; 0 Then\n        fSQL = fSQL &amp; \" AND tbltable4.dtdate &lt;= \" &amp; Me.txtDateOnOrBefore\n    End If\n\n    If Nz(Me.chkUncompleted, 0) &lt;&gt; 0 Then\n        fSQL = fSQL &amp; \" AND nz(tbltable3.dtdatedone,0) = 0\"\n    End If\n\n'Debug.Print fSQL\n    Me.frmSubform.Form.RecordSource = fSQL\n    Me.frmSubform.Form.Requery\nEnd Sub\n</code></pre>\n\n<p>If there is any way to make this faster, I'd love some suggestions.</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1571239985, "post_id": 58416861, "comment_id": 103176668, "body": "You could have a loop through A which splits &quot;apple, orange&quot; and then an inner loop which splits B &quot;red, green&quot; ? <code>Split</code> produces an array."}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571240750, "post_id": 58416861, "comment_id": 103177089, "body": "So I have two different loops to split the cells in the columns that have comma separated entries.  The problem is that each column will have multiple cells I need to split, and I need to split cells from multiple columns."}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571240757, "post_id": 58416861, "comment_id": 103177092, "body": "So I think I need two arrays - one for storing each cell value in a given column range, and one for storing the results from the cells I split.   My problem is once I split the cells, I don&#39;t know how to best store the elements in this new second array and later access them."}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571240762, "post_id": 58416861, "comment_id": 103177097, "body": "e.g. If I initially get one array that contains &quot;apple, orange&quot;, &quot;banana, pear, grape&quot; as two elements, I want to create a new array &quot;apple&quot;, &quot;orange&quot; that has two elements and another array &quot;banana&quot;, &quot;pear&quot; that contains three elements.   But I&#39;ll need more than just two new arrays - I&#39;ll need to keep creating a new array every time I split a cell and be able to access its elements at a later point. Is there a way to do this?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571240804, "post_id": 58416861, "comment_id": 103177116, "body": "I&#39;ve posted an answer below so give it a try and let me know how you get on."}], "answers": [{"comments": [{"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 1, "creation_date": 1571243246, "post_id": 58417113, "comment_id": 103178256, "body": "Sorry for the delay... was tweaking it to my real program and I got it to work. Thanks so much for your help! :)"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 3, "last_activity_date": 1571240555, "creation_date": 1571240555, "answer_id": 58417113, "question_id": 58416861, "link": "https://stackoverflow.com/questions/58416861/how-to-split-a-cell-value-into-multiple-rows-while-keeping-other-cell-data/58417113#58417113", "title": "How to split a cell value into multiple rows while keeping other cell data?", "body": "<p>This works, based on your example.</p>\n\n<p>If you have a lot of data, you might want to consider writing your data into an array and only reading back once you've done the concatentation as this will speed things up considerably.</p>\n\n<pre><code>Sub x()\n\nDim vA As Variant, vB As Variant, i As Long, j As Long, r As Range\n\nFor Each r In Range(\"A1:A10\")\n    vA = Split(r, \",\")\n    vB = Split(r.Offset(, 1), \",\")\n    For i = LBound(vA) To UBound(vA)\n        For j = LBound(vB) To UBound(vB)\n            Range(\"F\" &amp; Rows.Count).End(xlUp)(2) = Trim(vA(i)) &amp; \"-\" &amp; Trim(vB(j)) &amp; \"-\" &amp; r.Offset(, 2).Value &amp; \"-\" &amp; r.Offset(, 3).Value\n        Next j\n    Next i\nNext r\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/gx0JN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gx0JN.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 58417113, "answer_count": 1, "score": 1, "last_activity_date": 1571292160, "creation_date": 1571239697, "last_edit_date": 1571292160, "question_id": 58416861, "link": "https://stackoverflow.com/questions/58416861/how-to-split-a-cell-value-into-multiple-rows-while-keeping-other-cell-data", "title": "How to split a cell value into multiple rows while keeping other cell data?", "body": "<p>I have a range of cells like the below:</p>\n\n<pre><code>Col A         | Col B      | Col C | Col D\napple, orange | red, green | 5     | 10\npear, banana  | blue       | 20    | 40\n</code></pre>\n\n<p>I want to get a result that looks like:</p>\n\n<pre><code>Col A \napple-red-5-10\napple-green-5-10\norange-red-5-10\norange-green-5-10\npear-blue-20-40\nbanana-blue-20-40\n</code></pre>\n\n<p>I am concatenating values in each row across multiple columns, but if a cell contains a comma separated list of an item, I need to treat each entry as if they belong in a new row with other column data included. </p>\n\n<p>I first reference the range belonging to the four columns I am interested in concatenating. </p>\n\n<pre><code>Dim cellRef1 As Range\nSet cellRef1 = ThisWorkbook.Worksheets(1).Range(\"I2:I60\")\nDim cellRef2 As Range\nSet cellRef2 = ThisWorkbook.Worksheets(1).Range(\"E2:E60\")\nDim cellRef3 As Range\nSet cellRef3 = ThisWorkbook.Worksheets(1).Range(\"D2:D60\")\nDim cellRef4 As Range\nSet cellRef4 = ThisWorkbook.Worksheets(1).Range(\"H2:H60\")\n</code></pre>\n\n<p>Then for the columns which would have comma separated entries (second and fourth), I create an array to store each value e.g.:</p>\n\n<pre><code>Dim Array_Two As Variant\nArray_Two = cellRef2.Value\n</code></pre>\n\n<p>So I would have an array along the lines of</p>\n\n<pre><code> (\"apple, orange\", \"pear,banana\")\n</code></pre>\n\n<p>I wanted to loop through each array to create a sub-array where I want to split the entries by a comma and store them in a new array.</p>\n\n<p>e.g. I want:</p>\n\n<pre><code>Array_Two_A = (\"apple\", \"orange\")\nArray_Two_B = (\"pear\", \"banana)\n</code></pre>\n\n<p>So I can later access each entry and concatenate them.</p>\n\n<p>I wanted to do this using:</p>\n\n<pre><code>Dim Array_Two_New() As String\n\nFor x = LBound(Array_Two) To UBound(Array_Two)\n    Array_Two_New = Split(Array_Two(x, 1), \",\")\nNext x\n</code></pre>\n\n<p>Which kind of works, but the problem is I can't figure out how to dynamically create an array that I can later access. </p>\n\n<p>e.g. as is my code will keep overwriting the Array_Two_New array with the first value the string in Array_Two(x,1) is split into. </p>\n\n<p>I thought I could add Array_Two_New(x) in my code so that I get a result like:</p>\n\n<pre><code>Array_Two_New(1) = (\"apple\", \"orange\")\nArray_Two_New(2) = (\"pear\", \"banana\")\n</code></pre>\n\n<p>And I could later access the value I want e.g.</p>\n\n<pre><code>Array_Two_New(1)(1) = \"apple\"\nArray_Two_New(1)(2) = \"orange\"\nArray_Two_New(2)(1) = \"pear\" // etc.\n</code></pre>\n\n<p>I think I'm confusing the syntax here. </p>\n\n<p>I think I need to use an object but I am not too familiar with them.</p>\n\n<p>I found these articles but I couldn't follow the explanations.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/42425208/vba-split-cell-values-into-multiple-rows-and-keep-other-data\">VBA: Split cell values into multiple rows and keep other data</a><br>\n<a href=\"https://stackoverflow.com/questions/44656750/splitting-an-array-into-multiple-rows\">Splitting an array into multiple rows</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9, "user_id": 11801795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d59ce1ad5ac3afb7730ebbc922f698?s=128&d=identicon&r=PG&f=1", "display_name": "NewUser342", "link": "https://stackoverflow.com/users/11801795/newuser342"}, "edited": false, "score": 0, "creation_date": 1571240015, "post_id": 58416838, "comment_id": 103176686, "body": "Still doesnt populate the other cells in the columns, i have 10 rows in the dataset."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11801795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d59ce1ad5ac3afb7730ebbc922f698?s=128&d=identicon&r=PG&f=1", "display_name": "NewUser342", "link": "https://stackoverflow.com/users/11801795/newuser342"}, "edited": false, "score": 0, "creation_date": 1571240399, "post_id": 58416930, "comment_id": 103176905, "body": "Hi thanks for this, thats makes more sense but my column isnt being populated. I have &#39;lucord&#39; in b1 and need it coped it and pasted to the last row."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 9, "user_id": 11801795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d59ce1ad5ac3afb7730ebbc922f698?s=128&d=identicon&r=PG&f=1", "display_name": "NewUser342", "link": "https://stackoverflow.com/users/11801795/newuser342"}, "edited": false, "score": 0, "creation_date": 1571240495, "post_id": 58416930, "comment_id": 103176957, "body": "No repro. What is the last row number? Should you be getting the last row based on another column and not column B? If only B1 is populated, then <code>LastRow</code> = <code>1</code>. If it&#39;s column A, change to <code>LastRow = .Range(&quot;A&quot; &amp; .Rows.Count).End(xlUp).Row</code>"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1571240891, "last_edit_date": 1571240891, "creation_date": 1571239951, "answer_id": 58416930, "question_id": 58416838, "link": "https://stackoverflow.com/questions/58416838/how-to-copy-b1-down-to-the-last-columns-in-the-data-set/58416930#58416930", "title": "How to copy B1 down to the last columns in the data set", "body": "<p><code>\"B1\"</code> is the text \"B1\" and not the reference to the range <code>B1</code>. </p>\n\n<p>Also this is a great use case for a <code>With...End With</code> block to qualify the <code>Range</code> calls - otherwise <code>Lastrow</code> is determined from the active sheet, which may not necessarily be <code>src</code>.</p>\n\n<p>Change </p>\n\n<pre><code>Lastrow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\nsrc.Range(\"B1:B\" &amp; Lastrow).Value = \"B1\"\n</code></pre>\n\n<p>to</p>\n\n<pre><code>With src\n    Lastrow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n    .Range(\"B1:B\" &amp; Lastrow).Value = .Range(\"B1\").Value\nEnd With\n</code></pre>\n\n<p><strong>EDIT:</strong> If only <code>B1</code> is populated, then <code>Lastrow</code> = <code>1</code>. Determine <code>Lastrow</code> based on a populated column, e.g. Column A:</p>\n\n<pre><code>Lastrow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11801795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d59ce1ad5ac3afb7730ebbc922f698?s=128&d=identicon&r=PG&f=1", "display_name": "NewUser342", "link": "https://stackoverflow.com/users/11801795/newuser342"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 58416930, "answer_count": 1, "score": 0, "last_activity_date": 1571245017, "creation_date": 1571239597, "last_edit_date": 1571245017, "question_id": 58416838, "link": "https://stackoverflow.com/questions/58416838/how-to-copy-b1-down-to-the-last-columns-in-the-data-set", "title": "How to copy B1 down to the last columns in the data set", "body": "<p>I'm trying to drag the columns down from <code>B1</code> to the last row in the dataset. <code>B1</code> will always be populated with value and I need this to be copied and pasted 'x' amount of times down column <code>B</code> depending on how many rows there are on the sheet.</p>\n\n<pre><code>Sub Button1test_Click()\n\nSet src = Sheets(\"Sheet1\")\nDim Lastrow As Long\n\nLastrow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\nsrc.Range(\"B1:B\" &amp; Lastrow).Value = \"B1\"\n\nEnd Sub\n</code></pre>\n\n<p>columns <code>B</code> should be populated with 'lucord' x amount of times.</p>\n"}, {"tags": ["excel", "vba", "windows", "popup", "registry"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1571239240, "post_id": 58416535, "comment_id": 103176278, "body": "Could be just me, but it seems anything but <i>fixing the file so that it stops causing serious errors</i> would be a band-aid."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1571239733, "post_id": 58416535, "comment_id": 103176552, "body": "That said, this community can help you figure out what&#39;s wrong with a script that&#39;s blowing up or otherwise not behaving as it should, but we&#39;re not here to <i>provide</i> any code to anyone, let alone a solution in any one of X wildly different languages/technologies. Consider researching &quot;vbs edit registry&quot; or &quot;batch edit registry&quot; or &quot;powershell edit registry&quot;, depending on what type of scripted solution you&#39;re looking for... and I&#39;m sure you&#39;ll find <a href=\"https://stackoverflow.com/q/28416995/1188513\">an existing post</a> that has everything you need."}, {"owner": {"reputation": 35, "user_id": 7462273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8720eb94fc7171c2ce7d67caa58cd9c5?s=128&d=identicon&r=PG&f=1", "display_name": "kabarto", "link": "https://stackoverflow.com/users/7462273/kabarto"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1571240963, "post_id": 58416535, "comment_id": 103177204, "body": "It is not about &quot;how do I perform the change&quot; but &quot;what do I have to change in registry&quot;..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1571241076, "post_id": 58416535, "comment_id": 103177257, "body": "Ok, but you&#39;re still asking for someone to write the code for you. Also, seriously consider addressing the real problem instead of patching it up with registry hacks"}, {"owner": {"reputation": 35, "user_id": 7462273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8720eb94fc7171c2ce7d67caa58cd9c5?s=128&d=identicon&r=PG&f=1", "display_name": "kabarto", "link": "https://stackoverflow.com/users/7462273/kabarto"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1571241314, "post_id": 58416535, "comment_id": 103177372, "body": "this web is about coding, the majority of the answers are in snippets....I do not understand where are you aiming..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1571242012, "post_id": 58416535, "comment_id": 103177697, "body": "I&#39;m just saying, Reddit, Facebook, and other platforms/forums might be perfectly fine with questions asking for code that does XYZ in whatever language answerers want to supply code for, but here it is expected (see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and, perhaps more importantly, <b><a href=\"https://stackoverflow.com/help/on-topic\">help center</a></b>) that you ask about a <i>specific</i> programming problem; as it stands your question will likely end up closed as &quot;too broad&quot;."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1571248946, "post_id": 58416535, "comment_id": 103180830, "body": "In addition to what Mathieu has said: It&#39;s not really a good idea to be changing this setting on a user&#39;s machine... The last answer in the link provided does mention this. It&#39;s for this kind of reason that unattended automation of Office applications is <i>not supported</i>. You might look into working with the Office Open XML of the file, rather than opening it in Excel if there&#39;s no user interaction... Also, in that link a tool to find the Registry entry is mentioned. If you&#39;re looking for code to change the registry I&#39;m sure some searching will turn up code examples."}], "owner": {"reputation": 35, "user_id": 7462273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8720eb94fc7171c2ce7d67caa58cd9c5?s=128&d=identicon&r=PG&f=1", "display_name": "kabarto", "link": "https://stackoverflow.com/users/7462273/kabarto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 350, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571240883, "creation_date": 1571238656, "last_edit_date": 1571240883, "question_id": 58416535, "link": "https://stackoverflow.com/questions/58416535/prevent-pop-up-message-by-opening-excel", "title": "Prevent Pop Up message by opening Excel", "body": "<p>Task scheduler opens an Excel application. Sometimes appears at starting the excel instance a window in saying <strong><em>\"The last time you opened \" ...name of the file...\", it caused a serious error. Do you still want to open it?\"</em></strong>  I need to click on YES manually. After that excel runs normally. I found this has to deal with the  registry in this link: <a href=\"https://www.utteraccess.com/forum/index.php?showtopic=2045211\" rel=\"nofollow noreferrer\">https://www.utteraccess.com/forum/index.php?showtopic=2045211</a>. </p>\n\n<p>How to \"clear\" or change the registry before launching Excel to prevent an appearing the pop-up window? (vbs, cmd)Thanks \n<a href=\"https://i.stack.imgur.com/Y8ZGr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y8ZGr.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": true, "score": 1, "last_activity_date": 1571240251, "creation_date": 1571240251, "answer_id": 58417028, "question_id": 58416522, "link": "https://stackoverflow.com/questions/58416522/conditionally-remove-rows-from-ms-access-query-sql/58417028#58417028", "title": "Conditionally remove rows from ms access query (SQL)", "body": "<p>Since this is a report, you are better off creating a query that excludes what you don't want to see. </p>\n\n<p>Pull in whatever fields you need then create two more fields that have <code>iif([column1] = [column3], True, False)</code> and <code>iif([column2] = [column4], True, False</code> Add into criteria <code>False</code> and then point your report's recordsource at that query. (Change the column1-4 into their actual names)</p>\n"}], "owner": {"reputation": 177, "user_id": 10024371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d67d61ffd87563a9488b288f5c337a3c?s=128&d=identicon&r=PG&f=1", "display_name": "FrosyFeet456", "link": "https://stackoverflow.com/users/10024371/frosyfeet456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 58417028, "answer_count": 1, "score": 0, "last_activity_date": 1571240251, "creation_date": 1571238602, "question_id": 58416522, "link": "https://stackoverflow.com/questions/58416522/conditionally-remove-rows-from-ms-access-query-sql", "title": "Conditionally remove rows from ms access query (SQL)", "body": "<p>I would like to remove rows (about 10000) from a report in ms access. I am comparing two sets of two column in a table. When I run the query I would like it to remove the rows where column 1 and 3 match and column 2 and 4 match. I have tried running a left join query and trying with vba code but can't get it to work.</p>\n\n<p>Here is the data</p>\n\n<p><a href=\"https://i.stack.imgur.com/Dq78e.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Dq78e.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have tried using VBA</p>\n\n<pre><code>Private Sub Report_Open()\n   Dim prism_box As String\n   Dim prism_recs As String\n   Dim keepdrop_box As String\n   Dim keepdrop_recs As String\n\n   prism_box = CStr(Me.[tbl_KeepDrop_remainingpackets_RecId])\n   prism_recs = CStr(Me.[tbl_KeepDrop_remainingpackets_RecId])\n   keepdrop_box = CStr(Me.[Duplicate Recids_Box#])\n   keepdrop_recs = CStr(Me.[Duplicate Recids_RecId])\n\n   If prism_box = keepdrop_box &amp; prism_recs = keepdrop_recs Then\n\n   End If\nEnd Sub\n</code></pre>\n\n<p>I have tried using query too but won't delete them.</p>\n\n<p>I would like the final result to report a table like this...\n<a href=\"https://i.stack.imgur.com/k1cmM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k1cmM.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1571248969, "post_id": 58416500, "comment_id": 103180838, "body": "We don&#39;t know what the input data is like, and thus cannot reproduce the situation.  Please set some breakpoints in your code, and look at intermediate status of the sheet to see where in your code the problem occurs.  Then set more breakpoints in the failing area, finally single step the code until the problem is found."}, {"owner": {"reputation": 33, "user_id": 6664244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89aef3825e2ba5138460b7f062aaacee?s=128&d=identicon&r=PG&f=1", "display_name": "dashton", "link": "https://stackoverflow.com/users/6664244/dashton"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1571265111, "post_id": 58416500, "comment_id": 103187185, "body": "Here is the source .xlsm with a sample input .txt file (TALENT-LOUISJ-9-19.txt).  <a href=\"https://github.com/blasphemousjohn/swmm-converter\" rel=\"nofollow noreferrer\">Source</a>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6664244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89aef3825e2ba5138460b7f062aaacee?s=128&d=identicon&r=PG&f=1", "display_name": "dashton", "link": "https://stackoverflow.com/users/6664244/dashton"}, "edited": false, "score": 0, "creation_date": 1571680637, "post_id": 58438012, "comment_id": 103313522, "body": "Thank you, I&#39;m not sure what my thinking with the nested Ifs was at the time, but I changed it to:  <code>If IsEmpty(ActiveSheet.Cells(row, 1).Value) = True And IsEmpty(ActiveSheet.Cells(row, 44).Value) = True Then             Exit For</code>  From:  <code>If IsEmpty(ActiveSheet.Cells(row, 1).Value) = True Then             If IsEmpty(ActiveSheet.Cells(row, 44).Value) = True Then                 Exit For             End If</code>  And it works now.  Also have made the additions you recommended, thanks."}], "tags": [], "owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1571333830, "creation_date": 1571333830, "answer_id": 58438012, "question_id": 58416500, "link": "https://stackoverflow.com/questions/58416500/vba-code-works-for-every-row-except-the-last-one/58438012#58438012", "title": "VBA Code works for every row except the last one", "body": "<p>Thanks for the input data.  Please add</p>\n\n<pre><code>'at very top\nOption Explicit\n\n'after Dim answer As Integer\nApplication.Visible = True\nStop\n\n'in data conversion\nDim StringLength As Long, Str_Length As Long, kLen As Long\n\n'please note\n'rows 14 &amp; 15 are not SD, WQ, SDCS, but fall thru to OUTFALL, \n'but neither are TOP/PIPE because column tested s/b 19 (not 18)\n\n'real problem is in Reorg\n        If IsEmpty(ActiveSheet.Cells(row, 1).Value) = True Then\n            If IsEmpty(ActiveSheet.Cells(row, 44).Value) = True Then\n                Exit For\n            End If\n col-A  col-AM etc...\n\n1                           \n2       1641.11 SD  1644.01 4302311.81  216897.65   1\n3       1641.63 SD  1644.53 4302261.52  216898  2\n4       1648.61 SD  1651.26 4302009.62  216670.98   3\n5       1648.99 SD  1652.39 4301918.39  216673.01   4\n6       1649.51 SD  1654.41 4301857.91  216626.07   5\n7       1651.74 SD  1654.64 4301628.69  216756.85   6\n8       1662.07 SD  1665.12 4301234.27  216561.5    7\n9       1661.76 SD  1665.02 4301232.65  216482.29   8\n10      1661.14 SD  1664.94 4301271.11  216498.17   9\n11      1669.14 SD  1669.29 4301040.07  216960.04   10\n12      1656.85 SD  1661.1  4302020.09  216349.68   11\n13      1658.6  SD  1660.64 4302036.86  216345.72   12\n14      Unable..WQ  1656.83 4302020.95  216368.26   13\n15      1647    OUTFALL 1647    4302151.24  216561.44   14\n        1648.76 OUTFALL 1648.76 4302059.74  216518.98   15\n</code></pre>\n\n<p>Col=1 on row 16 is blank, and ExitFor is done one row too soon.</p>\n"}], "owner": {"reputation": 33, "user_id": 6664244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89aef3825e2ba5138460b7f062aaacee?s=128&d=identicon&r=PG&f=1", "display_name": "dashton", "link": "https://stackoverflow.com/users/6664244/dashton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58438012, "answer_count": 1, "score": 0, "last_activity_date": 1571333830, "creation_date": 1571238514, "last_edit_date": 1571265189, "question_id": 58416500, "link": "https://stackoverflow.com/questions/58416500/vba-code-works-for-every-row-except-the-last-one", "title": "VBA Code works for every row except the last one", "body": "<p>I have created a VBA code that runs through a .txt (Comma separated) file, does some calculations (<strong>Works fine</strong>), and then re-organizes the data (Adds some headers and moves all the data down one row, gets rid of irrelevant data, <strong>Doesn't work on last row</strong>) and spits out a new .csv file.  I think it has to do with the fact that I am bumping everything down by one row.  </p>\n\n<p>Here is the aforementioned code:</p>\n\n<pre><code>Private Sub Workbook_Open()\nSheets(\"Sheet1\").Cells.ClearContents\nApplication.Visible = False\n'---------------------------------------------------------------------------------------\n'Choose and open the .TXT file for conversion\nDim answer As Integer\nanswer = MsgBox(\"Do you want to process a .TXT file for use in InfoSWMM?\", vbYesNo + vbQuestion, \"Select .TXT File\")\nIf answer = vbNo Then\n    Application.Visible = True\n    Exit Sub\nEnd If\nDim Ret\nRet = Application.GetOpenFilename(\"Text Files (*.txt),*.txt\")\nIf Ret &lt;&gt; False Then\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;\" &amp; Ret, Destination:=Range(\"$A$1\") _\n        )\n        .Name = \"Sample\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = True\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\nEnd If\n'---------------------------------------------------------------------------------------\n'Do data conversion\nDim CountThem As Integer\nDim CountIt2 As Integer\nDim CountIt As Integer\nDim row As Integer\nDim col As Integer\nDim i As Integer\nDim j As Integer\nDim k As Integer\nDim ant As Double\nDim tester(3) As Double\nDim col_test As Integer\nDim size_test As Integer\nDim rim As Double\nDim Diff2Ele As Double\nDim ResultTxt As String\nDim DiamResultTxt As String\nDim DiamResult As Double\nDim CorrectedDiamResult As Double\nDim Result As Double\nDim MeasDiff As Double\nDim GetElev As Double\nDim GetDiam As String\nDim GetDiam_Val As Double\nDim SVal As Double\nDim Diam2Ft As Double\nCountIt = 1\nCountIt2 = 1\nFor row = 1 To ActiveSheet.UsedRange.Rows.Count\n    If IsEmpty(ActiveSheet.Cells(row, 1).Value) = True Then\n        Exit For\n    End If\n    'Change these values in case feature code library is changed in Carlson, also need to add extra fields\n    If ActiveSheet.Cells(row, 5).Value = \"SD\" Or ActiveSheet.Cells(row, 5).Value = \"WQ\" Or ActiveSheet.Cells(row, 5).Value = \"SDCS\" Then\n        col_test = 20\n        size_test = 19\n        rim = Val(ActiveSheet.Cells(row, 4).Value) 'Needs val to convert as double\n        For i = 0 To 3\n            Result = 0\n            ResultTxt = Empty\n            StringLength = Len(Cells(row, col_test))\n            Str_Length = Len(Cells(row, size_test))\n            'Gets numbers from string, but ignores 3rd char\n            DiamResultTxt = Empty\n            For j = 1 To StringLength\n                If j = 3 Then GoTo NextIteration 'Skips to next loop on 3rd character, which is an irrelevant number (not one we want)\n                If IsNumeric(Mid(Cells(row, col_test), j, 1)) = True Or Mid(Cells(row, col_test), j, 1) = \".\" Then\n                    ResultTxt = ResultTxt &amp; Mid(Cells(row, col_test), j, 1)\n                End If\nNextIteration:\n                Next j\n                For j = 1 To Str_Length\n                    If j = 3 Then GoTo nNextIteration 'Skips to next loop on 3rd character, which is an irrelevant number (not one we want)\n                    If IsNumeric(Mid(Cells(row, size_test), j, 1)) = True Then\n                        DiamResultTxt = DiamResultTxt &amp; Mid(Cells(row, size_test), j, 1)\n                    End If\nnNextIteration:\n                Next j\n                'MsgBox ResultTxt\n                DiamResult = Val(DiamResultTxt)\n                CorrectedDiamResult = DiamResult / 12\n                'MsgBox DiamResult\n                Result = Val(ResultTxt) 'Needs val to convert as Double\n                If (InStr(1, ActiveSheet.Cells(row, 34).Value, \"TOP\") &gt; 0 And InStr(1, ActiveSheet.Cells(row, 34).Value, \"PIPE\") &gt; 0) Or (InStr(1, ActiveSheet.Cells(row, 36).Value, \"TOP\") &gt; 0 And InStr(1, ActiveSheet.Cells(row, 36).Value, \"PIPE\")) Or (InStr(1, ActiveSheet.Cells(row, 38).Value, \"TOP\") &gt; 0 And InStr(1, ActiveSheet.Cells(row, 38).Value, \"PIPE\")) Then\n                    tester(i) = Result + CorrectedDiamResult\n                Else\n                    tester(i) = Result\n                End If\n                col_test = col_test + 4\n                size_test = size_test + 4\n            Next i\n            Diff2Ele = WorksheetFunction.Max(tester)\n            If Diff2Ele = 0 Then\n                ActiveSheet.Cells(row + 1, 39).Value = \"Unable to obtain\"\n            Else\n                ActiveSheet.Cells(row + 1, 39).Value = rim - Diff2Ele '39 is out of WQ SD and SDCS def. range\n            End If\n        End If\n        'Corrects for top of pipe instances\n        GetDiam = Empty\n        If ActiveSheet.Cells(row, 5).Value = \"OUTFALL\" Then\n            If InStr(1, ActiveSheet.Cells(row, 18).Value, \"TOP\") &gt; 0 And InStr(1, ActiveSheet.Cells(row, 18).Value, \"PIPE\") &gt; 0 Then\n                GetElev = Val(ActiveSheet.Cells(row, 5).Value)\n                kLen = Len(Cells(row, 16))\n                For k = 1 To kLen\n                    If IsNumeric(Mid(Cells(row, 16), k, 1)) = True Or Mid(Cells(row, 16), k, 1) = \".\" Then\n                        GetDiam = GetDiam &amp; Mid(Cells(row, 16), k, 1)\n                    End If\n\n\n           Next k\n                GetDiam_Val = Val(GetDiam)\n                Diam2Ft = GetDiam_Val / 12\n                ActiveSheet.Cells(row + 1, 39).Value = GetElev - Diam2Ft\n            Else\n                ActiveSheet.Cells(row + 1, 39).Value = ActiveSheet.Cells(row, 4).Value\n            End If\n        End If\n    Next row\n    '---------------------------------------------------------------------------------------\n    'Prepare sheet re-organization, has to be next step to get altered data from prior process\n    For row = 1 To ActiveSheet.UsedRange.Rows.Count\n        If IsEmpty(ActiveSheet.Cells(row, 1).Value) = True Then\n            Exit For\n        End If\n        'ID\n        ActiveSheet.Cells(row + 1, 44).Value = ActiveSheet.Cells(row, 1).Value\n        'Description\n        ActiveSheet.Cells(row + 1, 40).Value = ActiveSheet.Cells(row, 5).Value\n        'Rim Elevation\n        If ActiveSheet.Cells(row, 5).Value &lt;&gt; \"OUTFALL\" Or ActiveSheet.Cells(row, 5).Value &lt;&gt; \"DITCH\" Then\n            ActiveSheet.Cells(row + 1, 41).Value = ActiveSheet.Cells(row, 4).Value\n        End If\n        'X pos\n        ActiveSheet.Cells(row + 1, 42).Value = ActiveSheet.Cells(row, 3).Value\n        'Y pos\n        ActiveSheet.Cells(row + 1, 43).Value = ActiveSheet.Cells(row, 2).Value\n    Next row\n    '---------------------------------------------------------------------------------------\n    'Re-organize sheet\n    For row = 1 To ActiveSheet.UsedRange.Rows.Count + 1\n        If IsEmpty(ActiveSheet.Cells(row, 1).Value) = True Then\n            If IsEmpty(ActiveSheet.Cells(row, 44).Value) = True Then\n                Exit For\n            End If\n        ElseIf CountIt = 1 Then\n            ActiveSheet.Cells(row, 1).Value = \"ID\"\n            ActiveSheet.Cells(row, 2).Value = \"DESC.\"\n            ActiveSheet.Cells(row, 3).Value = \"RIM ELEV.\"\n            ActiveSheet.Cells(row, 4).Value = \"YR_INST\"\n            ActiveSheet.Cells(row, 5).Value = \"YR_RETIRE\"\n            ActiveSheet.Cells(row, 6).Value = \"ZONE\"\n            ActiveSheet.Cells(row, 7).Value = \"PHASE\"\n            ActiveSheet.Cells(row, 8).Value = \"INV. ELEV.\"\n            ActiveSheet.Cells(row, 9).Value = \"DEPTH_RIM\"\n            ActiveSheet.Cells(row, 10).Value = \"INIT_DPTH\"\n            ActiveSheet.Cells(row, 11).Value = \"SURG_DPTH\"\n            ActiveSheet.Cells(row, 12).Value = \"POND_AREA\"\n            ActiveSheet.Cells(row, 13).Value = \"FLOOD_TYP\"\n            ActiveSheet.Cells(row, 14).Value = \"SD_COEFF\"\n            ActiveSheet.Cells(row, 15).Value = \"SELECTED\"\n            ActiveSheet.Cells(row, 16).Value = \"SYMBOL\"\n            ActiveSheet.Cells(row, 17).Value = \"SYMSIZE\"\n            ActiveSheet.Cells(row, 18).Value = \"X\"\n            ActiveSheet.Cells(row, 19).Value = \"Y\"\n            ActiveSheet.Cells(row, 20).Value = \"Z\"\n            ActiveSheet.Cells(row, 21).Value = \"SD_MESH\"\n            CountIt = CountIt + 1\n        Else\n            ActiveSheet.Cells(row, 1).Value = ActiveSheet.Cells(row, 44).Value\n            ActiveSheet.Cells(row, 2).Value = ActiveSheet.Cells(row, 40).Value\n            ActiveSheet.Cells(row, 3).Value = ActiveSheet.Cells(row, 41).Value\n            ActiveSheet.Cells(row, 4).Value = \"\"\n            ActiveSheet.Cells(row, 5).Value = \"\"\n            ActiveSheet.Cells(row, 6).Value = \"\"\n            ActiveSheet.Cells(row, 7).Value = \"\"\n            ActiveSheet.Cells(row, 8).Value = ActiveSheet.Cells(row, 39).Value\n            ActiveSheet.Cells(row, 9).Value = \"\"\n            ActiveSheet.Cells(row, 10).Value = \"\"\n            ActiveSheet.Cells(row, 11).Value = \"\"\n            ActiveSheet.Cells(row, 12).Value = \"\"\n            ActiveSheet.Cells(row, 13).Value = \"\"\n            ActiveSheet.Cells(row, 14).Value = \"\"\n            ActiveSheet.Cells(row, 15).Value = \"\"\n            ActiveSheet.Cells(row, 16).Value = \"\"\n            ActiveSheet.Cells(row, 17).Value = \"\"\n            ActiveSheet.Cells(row, 18).Value = ActiveSheet.Cells(row, 42).Value\n            ActiveSheet.Cells(row, 19).Value = ActiveSheet.Cells(row, 43).Value\n            ActiveSheet.Cells(row, 20).Value = ActiveSheet.Cells(row, 41).Value\n            ActiveSheet.Cells(row, 21).Value = \"\"\n            For CountThem = 22 To 44\n                ActiveSheet.Cells(row, CountThem).Value = \"\"\n            Next CountThem\n        End If\n    Next row\n    '---------------------------------------------------------------------------------------\n    'Save converted file as .CSV\n    MsgBox \"Choose the desired save location for the .CSV file.\"\n    Dim InitialName As String\n    Dim PathName As Variant\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    InitialName = \"sfm_output\"\n    PathName = Application.GetSaveAsFilename(InitialFileName:=InitialName, fileFilter:=\"CSV (Comma delimited) (*.csv), *.csv\")\n    ws.Copy\n    ActiveWorkbook.SaveAs Filename:=PathName, _\n        FileFormat:=xlCSV, CreateBackup:=False\n    MsgBox \"Process completed successfully.\" &amp; vbNewLine &amp; \"File saved to:\" &amp; vbNewLine &amp; PathName\n    '---------------------------------------------------------------------------------------\n    'Close all Workbooks\n    Application.DisplayAlerts = False\n    Application.Quit\nEnd Sub\n</code></pre>\n\n<p>The section(s) in question are either the \"Prepare sheet re-organization\" section or the \"Re-organize sheet section\" (or both).  Sorry that the code is sloppy currently, I am just trying to get it to work in the first place before I go through and clean it up.  </p>\n\n<p>Any help is greatly appreciated!</p>\n\n<p>Edit: Not sure what happened with the indentation in the code snippet..</p>\n\n<p>Edit2: Here is the <a href=\"https://github.com/blasphemousjohn/swmm-converter\" rel=\"nofollow noreferrer\">GitHub</a> with the .xlsm file and a sample input .txt file.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1571238005, "post_id": 58416068, "comment_id": 103175500, "body": "Are you sure it&#39;s running?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1571238020, "post_id": 58416068, "comment_id": 103175515, "body": "What exactly do you mean by &quot;no effect&quot;?"}, {"owner": {"reputation": 11, "user_id": 11434189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8069379432e5892c2cd515e5d8c4d84d?s=128&d=identicon&r=PG&f=1", "display_name": "90&#39;sProSkater", "link": "https://stackoverflow.com/users/11434189/90sproskater"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1571238153, "post_id": 58416068, "comment_id": 103175593, "body": "@Rory the worksheet is not protected once I run the code. Cells formatted to &quot;lock&quot; are still editable."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1571238289, "post_id": 58416068, "comment_id": 103175667, "body": "Then per @TimWilliams comment, did you check the code is actually running (I assume it is in the <code>ThisWorkbook</code> module of <i>that</i> workbook)?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1571238300, "post_id": 58416068, "comment_id": 103175677, "body": "The code runs only once, when <code>ThisWorkbook</code> is opened, and protects the worksheet in <code>ThisWorkbook</code> that has <code>Sheet1</code> for a code name. Is that the sheet you mean to protect?"}, {"owner": {"reputation": 11, "user_id": 11434189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8069379432e5892c2cd515e5d8c4d84d?s=128&d=identicon&r=PG&f=1", "display_name": "90&#39;sProSkater", "link": "https://stackoverflow.com/users/11434189/90sproskater"}, "edited": false, "score": 0, "creation_date": 1571238803, "post_id": 58416068, "comment_id": 103175999, "body": "Yes, it is tied to the correct workbook. sheet 1 is the code name, but do i have to include the full name ie. Sheet1(Example Name) ??"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1571239142, "post_id": 58416068, "comment_id": 103176200, "body": "No. <code>Sheet1</code> can only refer to the sheet with that codename in the same workbook as the code. If the code is running, then the sheet will be protected, unless there is other code that unprotects it subsequently."}], "owner": {"reputation": 11, "user_id": 11434189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8069379432e5892c2cd515e5d8c4d84d?s=128&d=identicon&r=PG&f=1", "display_name": "90&#39;sProSkater", "link": "https://stackoverflow.com/users/11434189/90sproskater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571237221, "creation_date": 1571237163, "last_edit_date": 1571237221, "question_id": 58416068, "link": "https://stackoverflow.com/questions/58416068/protect-worksheet-vba", "title": "Protect Worksheet VBA", "body": "<p>I am attempting to protect a single worksheet out of my workbook with a password using the following VBA code, since I have macros running on the worksheet I want to protect.</p>\n\n<p>However there is no effect when ran - any suggestions?</p>\n\n<pre><code>Private Sub Workbook_Open()\n'enter below statement for each worksheet\n\n\nSheet1.Protect Password:=\"Example\" , UserInterFaceOnly:=True\n\n\nEnd Sub\n</code></pre>\n\n<p>Also, I want to be able to protect and unprotect the sheet when needed, while also having the ability to run my macro buttons.</p>\n"}, {"tags": ["sql", "excel", "vba", "sql-server-2017"], "comments": [{"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 1, "creation_date": 1571236593, "post_id": 58415812, "comment_id": 103174551, "body": "Do you need to use integrated security or a username/password? I believe the problem is that you are doing both."}, {"owner": {"reputation": 11, "user_id": 10728212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093298a7a26a7f4348ec618f94d07f26?s=128&d=identicon&r=PG&f=1", "display_name": "Broady", "link": "https://stackoverflow.com/users/10728212/broady"}, "reply_to_user": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1571236992, "post_id": 58415812, "comment_id": 103174822, "body": "Thanks  that was and oversight by myself. I removed it and ran it and still ran into the same error."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10728212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093298a7a26a7f4348ec618f94d07f26?s=128&d=identicon&r=PG&f=1", "display_name": "Broady", "link": "https://stackoverflow.com/users/10728212/broady"}, "edited": false, "score": 0, "creation_date": 1571239078, "post_id": 58416176, "comment_id": 103176163, "body": "Thanks I did miss this do."}, {"owner": {"reputation": 11, "user_id": 10728212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093298a7a26a7f4348ec618f94d07f26?s=128&d=identicon&r=PG&f=1", "display_name": "Broady", "link": "https://stackoverflow.com/users/10728212/broady"}, "edited": false, "score": 0, "creation_date": 1571242056, "post_id": 58416176, "comment_id": 103177720, "body": "I am still running into the same error thought once I try to connect."}], "tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": false, "score": 0, "last_activity_date": 1571237477, "creation_date": 1571237477, "answer_id": 58416176, "question_id": 58415812, "link": "https://stackoverflow.com/questions/58415812/complications-with-moving-data-from-sql-server-to-excel-using-vba/58416176#58416176", "title": "Complications with moving data from SQL Server to Excel using VBA", "body": "<p>Your <code>strConn = strConn</code> strings are not concatenated properly.</p>\n\n<p>Your variables aren't evaluating, their names are just being put straight into the string.</p>\n\n<p>Change, e.g.</p>\n\n<pre><code> strConn = strConn &amp; \"Initial Catalog= &amp; pCatalog; &amp; Data Source= &amp; pServer;\"\n strConn = strConn &amp; \"Integrated Security=sspi;&amp; UserID= &amp; pUser; &amp; Password= &amp; pPsw;\"\n</code></pre>\n\n<p>to</p>\n\n<pre><code> strConn = strConn &amp; \"Initial Catalog=\" &amp; pCatalog &amp; \";Data Source=\" &amp; pServer &amp; \";\"\n strConn = strConn &amp; \"Integrated Security=sspi;User ID= \"&amp; pUser; &amp; \"Password= \" &amp; pPsw &amp; \";\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10728212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093298a7a26a7f4348ec618f94d07f26?s=128&d=identicon&r=PG&f=1", "display_name": "Broady", "link": "https://stackoverflow.com/users/10728212/broady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571237477, "creation_date": 1571236387, "last_edit_date": 1571237474, "question_id": 58415812, "link": "https://stackoverflow.com/questions/58415812/complications-with-moving-data-from-sql-server-to-excel-using-vba", "title": "Complications with moving data from SQL Server to Excel using VBA", "body": "<p>I am trying to extract data from SQL Server into Excel to populate a pre-existing worksheet so I wrote a test code to this this out. While it is imperfect what I was mainly testing was establishing the connection to the server but I run into an Automation error Error 440 when I open the connection. What am I doing wrong within that portion of code. </p>\n\n<p>I haven't made any modifications as of yet and have check to make sure it compiled just fine. </p>\n\n<pre><code>Sub GetPhysicalCount()\n    Dim squery As String\n    Dim cnLogs As New ADODB.Connection\n    Dim rsData As New ADODB.Recordset\n    Dim rsHeaders As New ADODB.Recordset\n    Dim x As Long\n    Dim y As Long\n    Dim dbpath As String\n    Dim dbname As String\n    Dim AppExcel As Excel.Application\n    Dim Workbook As Object\n    Dim Worksheet As Object\n    Dim strConn As String\n    Dim Count As Long\n\n\n    pUser = \"AllenBroady\"\n    pPsw = \"Cthulu90\"\n    pServer = \"IMCPU_TEST\"\n    pCatalog = \"MasterMFG\"\n\n\n\n\n    strConn = \"Provider = SQLOLEDB;\"\n    strConn = strConn &amp; \"Initial Catalog= &amp; pCatalog; &amp; Data Source= &amp; pServer;\"\n    strConn = strConn &amp; \"Integrated Security=sspi;&amp; User ID= &amp; pUser; &amp; Password= &amp; pPsw;\"\n\n    cnLogs.Open strConn\n\n        With rsHeaders\n\n            .ActiveConnection = cnLogs\n\n                    .Open \"SELECT * FROM MasterMFG WHERE Dept_Code = 001\"\n\n                 Do While Not rsHeaders.EOF\n\n                    Cells(1, l_counter + 1) = rsHeaders(0)\n\n                    l_counter = l_counter + 1\n\n                    rsHeaders.MoveNext\n\n                  Loop\n\n            .Close\n\n            End With\n\n            With rsCount\n                  .ActiveConnection = cnLogs\n                    .Open \"SELECT COUNT(Dept_Code)FROM MasterMFG WHERE Total &lt;&gt; 0\"\n                      Count = rsCount\n                  .Close\n            End With\n\n\n\n            With rsData\n\n            .ActiveConnection = cnLogs\n                .Open \"SELECT  Dept_Code, Total FROM MasterMFG WHERE Total &lt;&gt; 0\"\n\n\n               For i = 1 To Count\n\n                    Sheet1.Range(\"A\" &amp; i + 1) = rsData.Fields(i)\n                    rsData.MoveNext\n                    Sheet1.Range(\"B\" &amp; i + 1) = rsData.Fields(i)\n               Next i\n\n            .Close\n\n            End With\n\n        cnLogs.Close\n\n        Set cnLogs = Nothing\n\n        Set rsHeaders = Nothing\n\n        Set rsData = Nothing\n\n    Sheets(1).UsedRange.EntireColumn.AutoFit\n\nEnd Sub\n</code></pre>\n\n<p>I keep getting an \"Automation\" error (Error 440)</p>\n"}, {"tags": ["excel", "vba", "find", "copy"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1571235576, "post_id": 58415516, "comment_id": 103173870, "body": "Just an (important) note: See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select</a> to clean up the code, and also note that any time you use <code>Range</code> or <code>Cells</code> you should qualify the workbook/worksheet."}], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 6544310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/696db412320de192c8130f5058dbf9c4?s=128&d=identicon&r=PG&f=1", "display_name": "l3ob", "link": "https://stackoverflow.com/users/6544310/l3ob"}, "is_accepted": false, "score": 0, "last_activity_date": 1571241290, "creation_date": 1571241290, "answer_id": 58417331, "question_id": 58415516, "link": "https://stackoverflow.com/questions/58415516/finding-and-copying-a-range-of-data-between-workbooks/58417331#58417331", "title": "Finding and copying a range of data between workbooks", "body": "<p>My reputation is to low to comment but I am able to give an answer, I do have an idea. You are looping through all the sheets, but with the first range declarations no sheet is given, so for example changing Columns(\"H:H\") to Sheet(\"Sheet1\").Column(\"H:H\") might prevent referring to column H on the wrong sheet. </p>\n"}], "owner": {"reputation": 1, "user_id": 12227099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25dbc9865229ac290f49cb30b6e706d6?s=128&d=identicon&r=PG&f=1", "display_name": "Brennan", "link": "https://stackoverflow.com/users/12227099/brennan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571242267, "creation_date": 1571235473, "last_edit_date": 1571242267, "question_id": 58415516, "link": "https://stackoverflow.com/questions/58415516/finding-and-copying-a-range-of-data-between-workbooks", "title": "Finding and copying a range of data between workbooks", "body": "<p>I've been working on this code for a while and any help is appreciated!</p>\n\n<p>I want to be able to put a known string on the open excel sheet <code>\"B7\"</code> and file location in <code>\"B6\"</code>. Using these inputs I want to open the other file, look for <code>\"B7\"</code> value (header for data table), and copy all of the data in that column and then return to workbook 1 to paste it.</p>\n\n<p>I think my find function is working but the macro returns whatever column below whatever cell was already selected upon opening workbook 2.</p>\n\n<pre><code>Sub FindB7()\n\n    Dim Look As Range\n    Dim Sh As Worksheet\n\n    Columns(\"H:H\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n\n    Range(\"H1\") = Range(\"B6\")\n    Goal = Range(\"B7\").Value\n\n    Range(\"B6\").Select\n    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True\n\n    For Each Sh In ThisWorkbook.Worksheets\n        With Sh.UsedRange\n            Set Look = .Cells.Find(What:=Goal)\n            If Not Look Is Nothing Then\n                adrs = Range(Look.Address).Select\n                Data = Range(adrs, Selection.End(xlDown))\n                ActiveWindow.Close\n            Else\n                Data = \"Not Found\"\n            End If\n        End With\n    Next\n\n    'paste data in original WkBk\n\n    Range(\"H2\").Value = Look\n    Range(\"H3:H1000\").Value = Data\n\n'now remove all \"extra\" data\n\nCells.Replace What:=\"#N/A\", Replacement:=\" \", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571234512, "post_id": 58415029, "comment_id": 103173144, "body": "Presumably you should add an <code>Exit For</code> within the <code>If...End If</code> in both loops to stop iterating through the array once the row has been deleted. As far as your main question, is there anything different about the format of column P (what is the format prior to formatting as text)?"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571234998, "post_id": 58415029, "comment_id": 103173478, "body": "@BigBen - It&#39;s not even going into the <code>If...End If</code>.  I&#39;ll add it in for best practice nonetheless.  Prior to formatting it is simply General.  I changed to <code>Text</code> because the other <code>If</code> works great and that one is also a <code>Text</code> format."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571235240, "post_id": 58415029, "comment_id": 103173629, "body": "I don&#39;t see anything wrong with the code. What does <code>Debug.Print visa.Cells(x, 16).Value2</code> return? Note - you could avoid looping by filtering and then deleting visible cells."}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571235815, "post_id": 58415029, "comment_id": 103174012, "body": "@BigBen - It returns the value that I&#39;m concerned with and I also added in this <code>Debug.Print visa.Cells(x, 16).Value2 &amp; &quot; - &quot; &amp; Deceased(visa_Inx)</code> to compare it.  I&#39;m looking at the debug screen right now and they are the same number, but the if statement is treating it as if it were false.  I also tried adding <code>Trim</code> and that didn&#39;t work"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571236080, "post_id": 58415029, "comment_id": 103174183, "body": "A bit of a stab in the dark, but what about <code>Left(visa.Cells(x, 16).Value2, 9)</code>?"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571236191, "post_id": 58415029, "comment_id": 103174271, "body": "@BigBen - <code>Trim</code> didn&#39;t work and <code>Len</code> returned 9, which is correct.  <code>Left</code> didn&#39;t work either."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1571236236, "post_id": 58415029, "comment_id": 103174306, "body": "Then perhaps <code>CLng</code> the value?"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571236404, "post_id": 58415029, "comment_id": 103174409, "body": "@BigBen - THAT&#39;S IT!  That worked!  Please put your solution into an answer so I can give you some more reputation!"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1571236833, "creation_date": 1571236833, "answer_id": 58415960, "question_id": 58415029, "link": "https://stackoverflow.com/questions/58415029/delete-matching-ssn-based-on-array/58415960#58415960", "title": "Delete matching SSN based on array", "body": "<p>Seems like a question of the underlying data, perhaps try using <code>CLng</code> on the cell value.</p>\n\n<pre><code> If CLng(visa.Cells(x, 16).Value2) = Deceased(visa_Inx) Then\n</code></pre>\n"}], "owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 58415960, "answer_count": 1, "score": 0, "last_activity_date": 1571315338, "creation_date": 1571234008, "last_edit_date": 1571315338, "question_id": 58415029, "link": "https://stackoverflow.com/questions/58415029/delete-matching-ssn-based-on-array", "title": "Delete matching SSN based on array", "body": "<p>I have a private sub that I call at the end of my code.  It's purpose is to delete any individuals whose SSN match a running array.  I have two sheets that it searches through and the second one works great, however the first doesn't seem to be working.</p>\n\n<p>I attempted to debug it and it is finding the right numbers the one individual that I am concerned with matches the array, however the <code>If statement</code> doesn't seem to effect it.  Here is what I have, any and all help would be appreciated.  Again the issue is that the first <code>If statement</code> isn't working properly.  I have obviously changed the SSN's for security reasons.  Thanks again!</p>\n\n<pre><code>Private Sub Delete_Deceased()\n\n    Dim tw As Workbook: Set tw = ThisWorkbook\n    Dim visa As Worksheet: Set visa = tw.Worksheets(\"Visa\")\n    Dim nav As Worksheet: Set nav = tw.Worksheets(\"Navigator\")\n    Dim rwCnt_visa As Long: rwCnt_visa = visa.Cells(Rows.Count, 1).End(xlUp).Row\n    Dim rwCnt_nav As Long: rwCnt_nav = nav.Cells(Rows.Count, 1).End(xlUp).Row\n    Dim x As Long\n    Dim y As Long\n    Dim Deceased() As Variant\n    Deceased = Array(123456789, 234567890, 345678901, 456789012, 567890123, 678901234, _\n        789012345, 890123456, 901234567)\n    Dim visa_Inx As Long\n    Dim nav_Inx As Long\n\n    visa.Columns(\"P:P\").NumberFormat = \"@\"  'Format the VISA SSN column as text\n\n    For x = rwCnt_visa To 4 Step -1\n        For visa_Inx = LBound(Deceased) To UBound(Deceased)\n            If visa.Cells(x, 16).Value2 = Deceased(visa_Inx) Then\n                Debug.Print \"Row: \" &amp; x\n                'visa.Rows(x).Delete shift:=xlShiftUp\n            End If\n        Next visa_Inx\n    Next x\n\n    For y = rwCnt_nav To 2 Step -1\n        For nav_Inx = LBound(Deceased) To UBound(Deceased)\n            If nav.Cells(y, 5).Value2 = Deceased(nav_Inx) Then\n                nav.Rows(y).Delete shift:=xlShiftUp\n            End If\n        Next nav_Inx\n    Next y\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 12202440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ac6e0f895fc6c49adb912b05ec642b?s=128&d=identicon&r=PG&f=1", "display_name": "edgarc1981", "link": "https://stackoverflow.com/users/12202440/edgarc1981"}, "edited": false, "score": 0, "creation_date": 1571238536, "post_id": 58415396, "comment_id": 103175833, "body": "Wow this is above and beyond! I am sitting trying to understand your work and implement and I&#39;ll let you know but thank you so much for such a detailed reply. I very much appreciate it!"}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 1, "last_activity_date": 1571235071, "creation_date": 1571235071, "answer_id": 58415396, "question_id": 58414974, "link": "https://stackoverflow.com/questions/58414974/error-handling-with-a-combo-box-vlookup-in-vba/58415396#58415396", "title": "Error handling with a combo box VLOOKUP in VBA", "body": "<p>You can do this one of two ways. The first is to implement an error handler in your <code>jobRefCbo_Change</code> code that will catch the failure of the <code>VLOOKUP</code> function.</p>\n\n<pre><code>Private Sub jobRefCbo_Change()\n    Application.ScreenUpdating = False\n    Call Lists_sort\n    Sheets(\"Tracker\").Activate\n\n    'Formatting Issue\n    jobCloseFrm.date2Txt.Value = Format(Range(\"W1\").Value, \"dd/mm/yyyy\")\n\n    On Error GoTo VLookup_Error\n    Me.nameTxt.Value = Application.VLookup(Me.jobRefCbo.Value &amp; \"\", Worksheets(\"Lists \").Range(\"I3:P21\"), 2, False)\n    'Me.acNoTxt.Value = Application.WorksheetFunction.VLookup(Me.jobRefCbo.Value, Worksheets(\"Lists \").Range(\"I3:P21\"), 2, False)\n    Me.jobDesc2Txt.Value = Application.WorksheetFunction.VLookup(Me.jobRefCbo.Value, Worksheets(\"Lists \").Range(\"I3:P21\"), 3, False)\n    Me.date2Txt.Value = Application.WorksheetFunction.VLookup(Me.jobRefCbo.Value, Worksheets(\"Lists \").Range(\"I3:P21\"), 4, False)\n    Me.month2Txt.Value = Application.WorksheetFunction.VLookup(Me.jobRefCbo.Value, Worksheets(\"Lists \").Range(\"I3:P21\"), 5, False)\n    Me.timeOnJobTxt.Value = Application.WorksheetFunction.VLookup(Me.jobRefCbo.Value, Worksheets(\"Lists \").Range(\"I3:P21\"), 6, False)\n    Me.StatusTxt.Value = Application.WorksheetFunction.VLookup(Me.jobRefCbo.Value, Worksheets(\"Lists \").Range(\"I3:P21\"), 7, False)\n    Me.startTime2Txt.Value = Format(CDate(Application.WorksheetFunction.VLookup(Me.jobRefCbo.Value, Worksheets(\"Lists \").Range(\"I3:P21\"), 8, False)), \"hh:mm:ss AM/PM\")\n    jobCloseFrm.date2Txt.Value = Format(Range(\"W1\").Value, \"dd/mm/yyyy\")\n    Application.ScreenUpdating = True\n\nVLookup_Error:\n    '--- nothing to do, just exit\n\nEnd Sub\n</code></pre>\n\n<p>The other method is to grab the list of values from the worksheet into an array and perform a quick check before you try to use the value.</p>\n\n<pre><code>Option Explicit\n\nPrivate Type InternalData\n    jobRefs As Variant\nEnd Type\nPrivate this As InternalData\n\nPrivate Sub jobRefCbo_Change()\n    Dim cbValue As Variant\n    cbValue = Me.jobRefCbo.Value\n    If ValueInList(cbValue) Then\n        Debug.Print \"the value is valid! (\" &amp; cbValue &amp; \")\"\n    Else\n        Debug.Print \"the value is invalid! (\" &amp; cbValue &amp; \")\"\n    End If\nEnd Sub\n\nPrivate Sub QuitButton_Click()\n    Me.Hide\nEnd Sub\n\nPrivate Function ValueInList(ByVal thisValue As Variant) As Boolean\n    Dim i As Long\n    ValueInList = False\n    For i = LBound(this.jobRefs) To UBound(this.jobRefs)\n        If this.jobRefs(i, 1) = thisValue Then\n            ValueInList = True\n            Exit For\n        End If\n    Next i\nEnd Function\n\nPrivate Sub UserForm_Initialize()\n    this.jobRefs = Worksheets(\"Lists \").Range(\"I2:P21\").Columns(1).Value\n    Me.jobRefCbo.List = this.jobRefs\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 12202440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ac6e0f895fc6c49adb912b05ec642b?s=128&d=identicon&r=PG&f=1", "display_name": "edgarc1981", "link": "https://stackoverflow.com/users/12202440/edgarc1981"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 58415396, "answer_count": 1, "score": 1, "last_activity_date": 1571315329, "creation_date": 1571233883, "last_edit_date": 1571315329, "question_id": 58414974, "link": "https://stackoverflow.com/questions/58414974/error-handling-with-a-combo-box-vlookup-in-vba", "title": "Error handling with a combo box VLOOKUP in VBA", "body": "<p>I have created a userform that takes a list of job refs(jobRefCbo) and populates text boxs based on the selection. I have not yet understood errors and if you select a blank or press escape in the combo box it jumps back to the VBA error screen. </p>\n\n<p>How can I implement a way to just 'do nothing' if the job ref selection is not valid? </p>\n\n<p>I guess a smart way would to be to have a locked list but I am trying to pull the cbo list from a list of active jobs in a column. </p>\n\n<pre><code>Private Sub UserForm_Initialize()\nSheets(\"Lists \").Activate\nDim xRg As Range\n\nApplication.ScreenUpdating = False\n\nCall Lists_sort\n\n\n    Set xRg = Worksheets(\"Lists \").Range(\"I2:P21\")\n    Me.jobRefCbo.List = xRg.Columns(1).Value\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Here is the combo box code: </p>\n\n<pre><code>Private Sub jobRefCbo_Change()\nApplication.ScreenUpdating = False\n\n\nCall Lists_sort\n\n\nSheets(\"Tracker\").Activate\n\n\n    'Formatting Issue\n    jobCloseFrm.date2Txt.Value = Format(Range(\"W1\").Value, \"dd/mm/yyyy\")\n\n\n    Me.nameTxt.Value = Application.VLookup(Me.jobRefCbo.Value &amp; \"\", Worksheets(\"Lists \").Range(\"I3:P21\"), 2, False)\n     'Me.acNoTxt.Value = Application.WorksheetFunction.VLookup(Me.jobRefCbo.Value, Worksheets(\"Lists \").Range(\"I3:P21\"), 2, False)\n    Me.jobDesc2Txt.Value = Application.WorksheetFunction.VLookup(Me.jobRefCbo.Value, Worksheets(\"Lists \").Range(\"I3:P21\"), 3, False)\n    Me.date2Txt.Value = Application.WorksheetFunction.VLookup(Me.jobRefCbo.Value, Worksheets(\"Lists \").Range(\"I3:P21\"), 4, False)\n    Me.month2Txt.Value = Application.WorksheetFunction.VLookup(Me.jobRefCbo.Value, Worksheets(\"Lists \").Range(\"I3:P21\"), 5, False)\n    Me.timeOnJobTxt.Value = Application.WorksheetFunction.VLookup(Me.jobRefCbo.Value, Worksheets(\"Lists \").Range(\"I3:P21\"), 6, False)\n    Me.StatusTxt.Value = Application.WorksheetFunction.VLookup(Me.jobRefCbo.Value, Worksheets(\"Lists \").Range(\"I3:P21\"), 7, False)\n    Me.startTime2Txt.Value = Format(CDate(Application.WorksheetFunction.VLookup(Me.jobRefCbo.Value, Worksheets(\"Lists \").Range(\"I3:P21\"), 8, False)), \"hh:mm:ss AM/PM\")\n    jobCloseFrm.date2Txt.Value = Format(Range(\"W1\").Value, \"dd/mm/yyyy\")\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Any help you can give is much appreciated! </p>\n\n<p>Craig</p>\n"}, {"tags": ["excel", "vba", "cell"], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 12163319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9e2445b33378644a355a3d489864820?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Sanch&#233;z", "link": "https://stackoverflow.com/users/12163319/miguel-sanch%c3%a9z"}, "is_accepted": false, "score": 0, "last_activity_date": 1571237157, "creation_date": 1571237157, "answer_id": 58416064, "question_id": 58414807, "link": "https://stackoverflow.com/questions/58414807/how-to-lock-make-read-only-a-specific-range-based-on-a-cell-value/58416064#58416064", "title": "How to lock (make read-only) a specific range based on a cell value?", "body": "<p>i tested your code and it works for me (Excel2016). the ranges (M:P) are locked if 17th column (col Q) of current row isn't empty. don't no what could be your problem here...</p>\n"}, {"tags": [], "owner": {"reputation": 185, "user_id": 10788327, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-W3IVKOR1B1Q/AAAAAAAAAAI/AAAAAAAAABI/iiyc6eWbnrw/photo.jpg?sz=128", "display_name": "mdelapena", "link": "https://stackoverflow.com/users/10788327/mdelapena"}, "is_accepted": false, "score": 0, "last_activity_date": 1571249592, "creation_date": 1571249592, "answer_id": 58419371, "question_id": 58414807, "link": "https://stackoverflow.com/questions/58414807/how-to-lock-make-read-only-a-specific-range-based-on-a-cell-value/58419371#58419371", "title": "How to lock (make read-only) a specific range based on a cell value?", "body": "<p>Well, if you need to watch the <em>status</em> column for changes, I would suggest to use the <code>Sub Worksheet_Change</code>. this will trigger your code every time something changes in your sheet.</p>\n\n<p>I made some changes to adapt your code and here is the result:</p>\n\n<pre><code>Sub Worksheet_Change(ByVal target As Range)\n    Dim intesection As Range\n    Dim rowIndex As Integer\n    Set intesection = Intersect(target, Range(\"Q:Q\"))\n\n    'watch changes in intersection (column Q)\n    If Not intesection Is Nothing Then\n        'get row index of changed status\n        rowIndex = Range(intesection.Address(0, 0)).Row\n\n        If Cells(rowIndex, 17).Value = \"\" Then\n            'unlock if status is blank\n            ActiveSheet.Range(\"M\" &amp; rowIndex &amp; \":\" &amp; \"P\" &amp; rowIndex).Locked = False\n            Call ActiveSheet.Protect(UserInterfaceOnly:=True, Password:=\"User\")\n\n        Else\n            'lock if not blank\n            ActiveSheet.Range(\"M\" &amp; rowIndex &amp; \":\" &amp; \"P\" &amp; rowIndex).Locked = True\n            Call ActiveSheet.Protect(UserInterfaceOnly:=True, Password:=\"User\")\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>And you need to add this to the <code>sheet</code> where you have the table you want to lock/unlock.</p>\n\n<p>Something like this:<a href=\"https://i.stack.imgur.com/xa4fW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xa4fW.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Sources:</strong></p>\n\n<p><a href=\"https://stackoverflow.com/questions/3037400/how-to-lock-the-data-in-a-cell-in-excel-using-vba\">How to Lock the data in a cell</a></p>\n\n<p><a href=\"https://www.spreadsheetsmadeeasy.com/how-to-tell-if-a-cell-changed-with-vba/\" rel=\"nofollow noreferrer\">How to Tell if a Cell Changed</a></p>\n"}], "owner": {"reputation": 11, "user_id": 12024329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc3284f9a192a06302f10f3ad112bf6b?s=128&d=identicon&r=PG&f=1", "display_name": "Davide B.", "link": "https://stackoverflow.com/users/12024329/davide-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1605708011, "creation_date": 1571233350, "last_edit_date": 1605708011, "question_id": 58414807, "link": "https://stackoverflow.com/questions/58414807/how-to-lock-make-read-only-a-specific-range-based-on-a-cell-value", "title": "How to lock (make read-only) a specific range based on a cell value?", "body": "<p>I'm working on a planning monitoring tool. I need to lock a range of cells based on a cell value.</p>\n<p>I would like when the value in column &quot;Q&quot; is &quot;Confirmed&quot;, then cells on the same row from Column M to Q are locked.<br />\n<a href=\"https://i.stack.imgur.com/7Z8tg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7Z8tg.png\" alt=\"enter image description here\" /></a></p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub planning_blocker()\n\n    Dim last_row As Integer\n\n    ' Compute the last row\n    last_row = Worksheets(&quot;Planning&quot;).Cells(Rows.Count, 1).End(xlUp).Row\n    Debug.Print last_row\n\n    For i = 3 To last_row\n\n        If Worksheets(&quot;Planning&quot;).Cells(i, 17).Value = &quot;&quot; Then\n            Sheets(&quot;Planning&quot;).Range(&quot;M&quot; &amp; i &amp; &quot;:&quot; &amp; &quot;P&quot; &amp; i).Locked = False\n        \n        Else\n            Sheets(&quot;Planning&quot;).Range(&quot;M&quot; &amp; i &amp; &quot;:&quot; &amp; &quot;P&quot; &amp; i).Locked = True\n    \n        End If\n    \n    Next i\n\n    Sheets(&quot;Planning&quot;).Protect Password:=&quot;User&quot;\n\nEnd Sub\n</code></pre>\n<p>This works partially because:</p>\n<ul>\n<li>it locks the entire row where &quot;confirmed&quot; is detected and not only the range</li>\n<li>it consider only the first row where &quot;confirmed&quot; is detected and not the remaining ones (if more than one row is marked with &quot;confirmed&quot;, only the first row is blocked).</li>\n</ul>\n"}, {"tags": ["excel", "vba", "module", "listbox", "activex"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571232887, "post_id": 58414607, "comment_id": 103172062, "body": "What are <code>With dataValKeep()</code> and <code>With dataValScrap()</code>?"}, {"owner": {"reputation": 1, "user_id": 12226842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d703f72ccb4356450d76d2e1f0bebd?s=128&d=identicon&r=PG&f=1", "display_name": "duncfair", "link": "https://stackoverflow.com/users/12226842/duncfair"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571236130, "post_id": 58414607, "comment_id": 103174227, "body": "one listbox for each column (column names are &#39;Keep&#39; and &#39;Scrap&#39;)."}, {"owner": {"reputation": 1, "user_id": 12226842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d703f72ccb4356450d76d2e1f0bebd?s=128&d=identicon&r=PG&f=1", "display_name": "duncfair", "link": "https://stackoverflow.com/users/12226842/duncfair"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571239621, "post_id": 58414607, "comment_id": 103176491, "body": "Copying and pasting this code into a new module in another spreadsheet results in  no listbox on any row or column, i.e., 100% nothing."}], "owner": {"reputation": 1, "user_id": 12226842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d703f72ccb4356450d76d2e1f0bebd?s=128&d=identicon&r=PG&f=1", "display_name": "duncfair", "link": "https://stackoverflow.com/users/12226842/duncfair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571241158, "creation_date": 1571232716, "last_edit_date": 1571241158, "question_id": 58414607, "link": "https://stackoverflow.com/questions/58414607/need-a-vba-module-to-apply-drop-down-list-box-validation-for-two-columns-in-a-se", "title": "Need a vba module to apply drop-down list box validation for two columns in a set of excel spreadsheets", "body": "<p>I have written something but it only works (sort of) on one spreadsheet, but I have 18 each month and my aim is to write one module and import it into all of them each month. The one that sort of works starts at row 4 for some reason instead of row 2.</p>\n\n<p>What am I doing wrong?</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_Open()\n\n\nWith dataValKeep()\n\n    Dim lrow As Long\n    Dim i As Long\n\n    Set sht = Sheets(\"Inventory_Risk_beta1\")\n    lrow = Sheets(\"Inventory_Risk_beta1\").Cells(Sheets(\"Inventory_Risk_beta1\").Rows.Count, \"A\").End(xlUp).Row\n\n      With sht.Range(\"AN2:AN\" &amp; lrow).Validation\n           .Delete\n           .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n        Formula1:=\"Rework,Shelf Life Extension,Change in Demand,Quality Issue,End of Life,NPI,Transfer and Charge,Older Lot / Batch,Other\"\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .ErrorTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = True\n        .ShowError = True\n        End With\n\nEnd With\n\nWith dataValScrap()\n\n    Dim lrow As Long\n    Dim i As Long\n\n    Set sht = Sheets(\"Inventory_Risk_beta1\")\n    lrow = Sheets(\"Inventory_Risk_beta1\").Cells(Sheets(\"Inventory_Risk_beta1\").Rows.Count, \"A\").End(xlUp).Row\n\n      With sht.Range(\"AO2:AO\" &amp; lrow).Validation\n           .Delete\n           .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n        Formula1:=\"Rework,Shelf Life Extension,Change in Demand,Quality Issue,End of Life,NPI,Transfer and Charge,Older Lot / Batch,Other\"\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .ErrorTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = True\n        .ShowError = True\n        End With\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "autofilter"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1571231875, "post_id": 58414293, "comment_id": 103171420, "body": "<code>&quot;&lt;&gt;&quot; &amp; Test_Criteria</code>."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 12226705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f64d32282a97ae6c38420b26746372e?s=128&d=identicon&r=PG&f=1", "display_name": "walterpayton34", "link": "https://stackoverflow.com/users/12226705/walterpayton34"}, "edited": false, "score": 0, "creation_date": 1571233591, "post_id": 58414367, "comment_id": 103172500, "body": "I used your changes:     ActiveSheet.ListObjects(&quot;Rpt_AM_04_Sales_ShipTo&quot;).Range.Auto&zwnj;&#8203;Filter Field:=4, _         Criteria1:&quot;&lt;&gt;&quot; &amp; Test_Criteria, Operator:=xlFilterValues  But I now get a compile error: Syntax error    Any other suggestions?"}, {"owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "reply_to_user": {"reputation": 15, "user_id": 12226705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f64d32282a97ae6c38420b26746372e?s=128&d=identicon&r=PG&f=1", "display_name": "walterpayton34", "link": "https://stackoverflow.com/users/12226705/walterpayton34"}, "edited": false, "score": 0, "creation_date": 1571234589, "post_id": 58414367, "comment_id": 103173194, "body": "@walterpayton34 After testing the code, it seems there was some special character that was causing the error. Try to re-copy this code and see if it fixes the error."}, {"owner": {"reputation": 15, "user_id": 12226705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f64d32282a97ae6c38420b26746372e?s=128&d=identicon&r=PG&f=1", "display_name": "walterpayton34", "link": "https://stackoverflow.com/users/12226705/walterpayton34"}, "edited": false, "score": 0, "creation_date": 1571243705, "post_id": 58414367, "comment_id": 103178480, "body": "Per your recommendation, I changed this: Criteria1:&quot;&lt;&gt;&quot; &amp; Test_Criteria to this: Criteria1:=&quot;&lt;&gt;&quot; &amp; Test_Criteria.  This fixed the problem and works perfectly.  Thanks so much for the help!"}], "tags": [], "owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "is_accepted": true, "score": 0, "last_activity_date": 1571234437, "last_edit_date": 1571234437, "creation_date": 1571231996, "answer_id": 58414367, "question_id": 58414293, "link": "https://stackoverflow.com/questions/58414293/trying-to-use-a-variable-for-the-criteria-in-autofilter-with-not-equal-and/58414367#58414367", "title": "Trying to use a variable for the criteria in autofilter with &quot;not equal&quot; &lt;&gt; and can not get it to work", "body": "<h3> Incorrect syntax </h3>\n\n<p>The code does not work because of <code>incorrect syntax</code> where you specify the criteria. Try this:</p>\n\n<p>Change this:</p>\n\n<pre><code>Criteria1:&lt;&gt;Test_Criteria\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>Criteria1:\"&lt;&gt;\" &amp; Test_Criteria\n</code></pre>\n\n<p>Complete code:</p>\n\n<pre><code>Dim Test_Criteria As String\nTest_Criteria = \"Bob\"\nActiveSheet.ListObjects(\"Rpt_AM_04_Sales_ShipTo\").Range.AutoFilter Field:=4, _\n     Criteria1:=\"&lt;&gt;\" &amp; Test_Criteria, Operator:=xlFilterValues\n</code></pre>\n\n<p>I hope this helps.</p>\n"}], "owner": {"reputation": 15, "user_id": 12226705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f64d32282a97ae6c38420b26746372e?s=128&d=identicon&r=PG&f=1", "display_name": "walterpayton34", "link": "https://stackoverflow.com/users/12226705/walterpayton34"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 58414367, "answer_count": 1, "score": 1, "last_activity_date": 1571234437, "creation_date": 1571231803, "last_edit_date": 1571231916, "question_id": 58414293, "link": "https://stackoverflow.com/questions/58414293/trying-to-use-a-variable-for-the-criteria-in-autofilter-with-not-equal-and", "title": "Trying to use a variable for the criteria in autofilter with &quot;not equal&quot; &lt;&gt; and can not get it to work", "body": "<p>I'm using Excel VBA to filter a list using the \"not equals\" expression. If I use <code>Criteria1:=\"&lt;&gt;Bob\"</code>, the code runs perfectly, but if I change \"Bob\" to a variable, the code does not run.</p>\n\n<p>This works:</p>\n\n<pre><code>ActiveSheet.ListObjects(\"Rpt_AM_04_Sales_ShipTo\").Range.AutoFilter Field:=4, _\n    Criteria1:=\"&lt;&gt;Bob\", Operator:=xlFilterValues\n</code></pre>\n\n<p>This does not work:</p>\n\n<pre><code>Dim Test_Criteria As String\nTest_Criteria = \"Bob\"\nActiveSheet.ListObjects(\"Rpt_AM_04_Sales_ShipTo\").Range.AutoFilter Field:=4, _\n    Criteria1:&lt;&gt;Test_Criteria, Operator:=xlFilterValues\n</code></pre>\n\n<p>I expect the code to return a list that has everyone in it except Bob.\nInstead, I get an error message just typing in the code:</p>\n\n<pre><code>Compile error\nExpected: named parameter\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1571243573, "post_id": 58414176, "comment_id": 103178416, "body": "can you post your current code?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12226628, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3vlTRcWqXqI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcx8j7QrnjevxkdIsrJMahqF0Zqhg/photo.jpg?sz=128", "display_name": "Candy_Cain22", "link": "https://stackoverflow.com/users/12226628/candy-cain22"}, "edited": false, "score": 0, "creation_date": 1571239354, "post_id": 58414499, "comment_id": 103176346, "body": "The form is opened via a macro button on the ribbon if that helps"}, {"owner": {"reputation": 1, "user_id": 12182998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/895eb7af98259b907d8f18724a86c010?s=128&d=identicon&r=PG&f=1", "display_name": "UnTechnical", "link": "https://stackoverflow.com/users/12182998/untechnical"}, "reply_to_user": {"reputation": 1, "user_id": 12226628, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3vlTRcWqXqI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcx8j7QrnjevxkdIsrJMahqF0Zqhg/photo.jpg?sz=128", "display_name": "Candy_Cain22", "link": "https://stackoverflow.com/users/12226628/candy-cain22"}, "edited": false, "score": 0, "creation_date": 1571242572, "post_id": 58414499, "comment_id": 103177964, "body": "I see, I assumed you were working with VSTO. I made a similar thing last week, making a new task item from a Macro button. I only modified the open task with C#. Did you try adding the macro to the Mail inspector and then in VBA get the current mail item instead of creating a new one...?"}], "tags": [], "owner": {"reputation": 1, "user_id": 12182998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/895eb7af98259b907d8f18724a86c010?s=128&d=identicon&r=PG&f=1", "display_name": "UnTechnical", "link": "https://stackoverflow.com/users/12182998/untechnical"}, "is_accepted": false, "score": 0, "last_activity_date": 1571232379, "creation_date": 1571232379, "answer_id": 58414499, "question_id": 58414176, "link": "https://stackoverflow.com/questions/58414176/how-can-i-populate-fields-in-the-active-email/58414499#58414499", "title": "How can I populate fields in the active email?", "body": "<p>I'm no expert but, if the form is available inside the mail item inspector you could make a call to the active mail item and reference the CC and Subject from there.</p>\n\n<p>something along the lines of:</p>\n\n<pre><code>C#\n\nOutlook.Inspector ins = this.Application.ActiveInspector();\nOutlook.MailItem olMail = ins.CurrentItem as Outlook.MailItem;\nolMail.Subject = subjectCriterea;\nolMail.CC = CCCriterea;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12226628, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3vlTRcWqXqI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcx8j7QrnjevxkdIsrJMahqF0Zqhg/photo.jpg?sz=128", "display_name": "Candy_Cain22", "link": "https://stackoverflow.com/users/12226628/candy-cain22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1574446124, "creation_date": 1571231497, "last_edit_date": 1574446124, "question_id": 58414176, "link": "https://stackoverflow.com/questions/58414176/how-can-i-populate-fields-in-the-active-email", "title": "How can I populate fields in the active email?", "body": "<p>I have a userform where the user checks off certain criteria. Depending on these criteria the To and CC are populated.</p>\n\n<p>I want to populate the email currently active on Outlook.</p>\n\n<p>I can get VBA to open a new email and populate the To and CC based on the checkboxes but I want to populate the open/selected email.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571232354, "post_id": 58413999, "comment_id": 103171711, "body": "hi. in the line If strSenderDomain = &quot;vs@gmail.com&quot; Then u expect to get vs@gmail.com, but the var strSenderDomain is iqual to the domain gmail.com... change the  &quot;vs@gmail.com&quot; to  &quot;gmail.com&quot; and should work"}, {"owner": {"reputation": 21, "user_id": 5794786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efe6a0b9fc805590dc0f027daf71027?s=128&d=identicon&r=PG&f=1", "display_name": "vmjan02", "link": "https://stackoverflow.com/users/5794786/vmjan02"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571234089, "post_id": 58413999, "comment_id": 103172850, "body": "Hi Luis, I need it for a specific sender only, there are may emails that come in form diff user&#39;s if doing so it will download all the mails from gmail senders. &#39;&#39;&#39; If strSenderDomain = &quot;gmail.com&quot;&#39;, still not downloading"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571234876, "post_id": 58413999, "comment_id": 103173395, "body": "in that case change --&gt; If strSenderDomain = &quot;vs@gmail.com&quot; Then &lt;-- to --&gt; If strSenderAddress = &quot;vs@gmail.com&quot; Then &lt;--. U cant compare an email address with the domain.."}, {"owner": {"reputation": 21, "user_id": 5794786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efe6a0b9fc805590dc0f027daf71027?s=128&d=identicon&r=PG&f=1", "display_name": "vmjan02", "link": "https://stackoverflow.com/users/5794786/vmjan02"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571235201, "post_id": 58413999, "comment_id": 103173605, "body": "Have changed it, but still no luck, &#39;&#39;&#39; If strSenderAddress = &quot;vs@gmail.com&quot; Then &#39;&#39;&#39;"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571235293, "post_id": 58413999, "comment_id": 103173676, "body": "does it enter in that if ? and in the for each ?"}, {"owner": {"reputation": 21, "user_id": 5794786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efe6a0b9fc805590dc0f027daf71027?s=128&d=identicon&r=PG&f=1", "display_name": "vmjan02", "link": "https://stackoverflow.com/users/5794786/vmjan02"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571235430, "post_id": 58413999, "comment_id": 103173766, "body": "This is my code below now  If strSenderDomain = &quot;gmail.com&quot; Then        If strSenderAddress = &quot;vs@gmail.com&quot; Then"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571235681, "post_id": 58413999, "comment_id": 103173941, "body": "u have write gmai.com. i dont know if is a typo. can u do a F8 to see if the code enters in the for each cycle ?"}, {"owner": {"reputation": 21, "user_id": 5794786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efe6a0b9fc805590dc0f027daf71027?s=128&d=identicon&r=PG&f=1", "display_name": "vmjan02", "link": "https://stackoverflow.com/users/5794786/vmjan02"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571235846, "post_id": 58413999, "comment_id": 103174040, "body": "sorry, done the changes, for gmail.com"}, {"owner": {"reputation": 21, "user_id": 5794786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efe6a0b9fc805590dc0f027daf71027?s=128&d=identicon&r=PG&f=1", "display_name": "vmjan02", "link": "https://stackoverflow.com/users/5794786/vmjan02"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571236287, "post_id": 58413999, "comment_id": 103174338, "body": "Luis, you can check my code , I have updated the modifications."}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571236429, "post_id": 58413999, "comment_id": 103174429, "body": "it seems ok. ill ask you again. when you run the code does it enters in that IF&#39;s and in the FOR EACH ?"}, {"owner": {"reputation": 21, "user_id": 5794786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efe6a0b9fc805590dc0f027daf71027?s=128&d=identicon&r=PG&f=1", "display_name": "vmjan02", "link": "https://stackoverflow.com/users/5794786/vmjan02"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571298279, "post_id": 58413999, "comment_id": 103195994, "body": "Luis, it runs in IF&#39;s"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5794786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efe6a0b9fc805590dc0f027daf71027?s=128&d=identicon&r=PG&f=1", "display_name": "vmjan02", "link": "https://stackoverflow.com/users/5794786/vmjan02"}, "edited": false, "score": 0, "creation_date": 1571298234, "post_id": 58426950, "comment_id": 103195967, "body": "error on &#39;&#39;&#39;  Set Items = Inbox.Items &#39;&#39;&#39; object not defined"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 21, "user_id": 5794786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efe6a0b9fc805590dc0f027daf71027?s=128&d=identicon&r=PG&f=1", "display_name": "vmjan02", "link": "https://stackoverflow.com/users/5794786/vmjan02"}, "edited": false, "score": 0, "creation_date": 1571298404, "post_id": 58426950, "comment_id": 103196060, "body": "object is defined, look at 2nd line on answer code @vmjan02"}, {"owner": {"reputation": 21, "user_id": 5794786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efe6a0b9fc805590dc0f027daf71027?s=128&d=identicon&r=PG&f=1", "display_name": "vmjan02", "link": "https://stackoverflow.com/users/5794786/vmjan02"}, "edited": false, "score": 0, "creation_date": 1571317861, "post_id": 58426950, "comment_id": 103207399, "body": "I am still getting the same error for  Set Items = Inbox.Items error as Variable not defined."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1571296680, "creation_date": 1571296680, "answer_id": 58426950, "question_id": 58413999, "link": "https://stackoverflow.com/questions/58413999/download-attachment-from-outlook-vba/58426950#58426950", "title": "Download Attachment from Outlook VBA", "body": "<p><em>Set up your <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.application.startup\" rel=\"nofollow noreferrer\">Application_Startup()</a> the following</em></p>\n\n<pre><code>Option Explicit\nPrivate WithEvents Items As Outlook.Items\nPrivate Sub Application_Startup()\n    Dim olNs As Outlook.NameSpace\n    Set olNs = Application.GetNamespace(\"MAPI\")\n\n    Dim Inbox  As Outlook.MAPIFolder\n    Set Inbox = olNs.GetDefaultFolder(olFolderInbox)\n\n    Set Items = Inbox.Items\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5794786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efe6a0b9fc805590dc0f027daf71027?s=128&d=identicon&r=PG&f=1", "display_name": "vmjan02", "link": "https://stackoverflow.com/users/5794786/vmjan02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1584431574, "creation_date": 1571230954, "last_edit_date": 1584431574, "question_id": 58413999, "link": "https://stackoverflow.com/questions/58413999/download-attachment-from-outlook-vba", "title": "Download Attachment from Outlook VBA", "body": "<p>I have this code in Outlook VBA ThisOutlookSession, it is not giving any error, but is not downloading the attachments. Any idea</p>\n\n<pre><code>Public WithEvents objInboxItems As Outlook.Items\nPrivate Sub Application_Startup()\n   Set objInboxItems = Session.GetDefaultFolder(olFolderInbox).Items\nEnd Sub\nPrivate Sub objInboxItems_ItemAdd(ByVal Item As Object)\n   Dim objMail As Outlook.MailItem\n   Dim strSenderAddress As String\n   Dim strSenderDomain As String\n   Dim objAttachment As Attachment\n   Dim strFolderPath As String\n   Dim strFileName As String\n\n   If Item.Class = olMail Then\n      Set objMail = Item\n\n      'Get sender domain\n      strSenderAddress = objMail.SenderEmailAddress\n      strSenderDomain = Right(strSenderAddress, Len(strSenderAddress) - InStr(strSenderAddress, \"@\"))\n\n      'Change to the specific domain as per your needs\n      If strSenderDomain = \"gmail.com\" Then\n       If strSenderAddress = \"vs@gmail.com\" Then\n         If objMail.Attachments.Count &gt; 0 Then\n            For Each objAttachment In objMail.Attachments\n                strFolderPath = \"E:\\Cisco - Qutar\\Performance Report Automation\\\"\n                strFileName = objMail.Subject &amp; \" \" &amp; Chr(45) &amp; \" \" &amp; objAttachment.FileName\n                objAttachment.SaveAsFile strFolderPath &amp; strFileName\n            Next\n         End If\n      End If\n   End If\n End If\nEnd Sub\n\n</code></pre>\n\n<p>Updated now</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1571230262, "post_id": 58412960, "comment_id": 103170423, "body": "Which line of code gives an exception? Did you try to debug the code?"}, {"owner": {"reputation": 23, "user_id": 10208760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00c9c51037c8fa7a3c3588c7901169b2?s=128&d=identicon&r=PG", "display_name": "Wojciech Wi\u015bniewski", "link": "https://stackoverflow.com/users/10208760/wojciech-wi%c5%9bniewski"}, "reply_to_user": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1571230532, "post_id": 58412960, "comment_id": 103170589, "body": "No line. The error occurs in Outlook, not in Excel code. I&#39;ve told that in post - it displays properly, it sends properly, but doesn&#39;t add an attachment properly."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1571231056, "post_id": 58412960, "comment_id": 103170899, "body": "What is the actual value passed to the <code>Attachments.Add</code> method?"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1571241642, "post_id": 58412960, "comment_id": 103177527, "body": "You are using <code>On Error Resume Next</code> incorrectly. Remove that line and you will likely see an error, possibly related to the attachment. Even if you do not see an error, do not use it again before reading this. <a href=\"http://www.cpearson.com/excel/errorhandling.htm\" rel=\"nofollow noreferrer\">cpearson.com/excel/errorhandling.htm</a>"}, {"owner": {"reputation": 23, "user_id": 10208760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00c9c51037c8fa7a3c3588c7901169b2?s=128&d=identicon&r=PG", "display_name": "Wojciech Wi\u015bniewski", "link": "https://stackoverflow.com/users/10208760/wojciech-wi%c5%9bniewski"}, "edited": false, "score": 0, "creation_date": 1571303644, "post_id": 58412960, "comment_id": 103198908, "body": "Seems like passing an empty string (&quot;&quot;) to Attachment.Add was causing error in Outlook 2016, but not in 2010."}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1571230460, "creation_date": 1571230460, "answer_id": 58413823, "question_id": 58412960, "link": "https://stackoverflow.com/questions/58412960/outlook-mail-array-index-is-out-of-bounds/58413823#58413823", "title": "Outlook mail &quot;Array index is out of bounds&quot;", "body": "<p>You need to find which line of code gives an error by running the code under the debugger. See <a href=\"https://www.excel-easy.com/vba/examples/debugging.html\" rel=\"nofollow noreferrer\">Debugging</a> for more information. But I think the problem lies in the <code>Tre\u015b\u0107HTMLDoMaila</code> function.</p>\n\n<p>The <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.attachments.add\" rel=\"nofollow noreferrer\">Attachments.Add</a> method creates a new attachment in the <code>Attachments</code> collection. The source of the attachment can be a file (represented by the full file system path with a file name) or an Outlook item that constitutes the attachment. So, you just need to make sure the file path is correct. </p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 10208760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00c9c51037c8fa7a3c3588c7901169b2?s=128&d=identicon&r=PG", "display_name": "Wojciech Wi\u015bniewski", "link": "https://stackoverflow.com/users/10208760/wojciech-wi%c5%9bniewski"}, "is_accepted": false, "score": 0, "last_activity_date": 1571231895, "creation_date": 1571231895, "answer_id": 58414334, "question_id": 58412960, "link": "https://stackoverflow.com/questions/58412960/outlook-mail-array-index-is-out-of-bounds/58414334#58414334", "title": "Outlook mail &quot;Array index is out of bounds&quot;", "body": "<p>Ok, it wasn't the case (as I mentioned earlier, there was no problem when code running), but deleting the line with .Attachment.Add solved the problem on my computer. I've asked my coworkers, waiting for response.</p>\n"}], "owner": {"reputation": 23, "user_id": 10208760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00c9c51037c8fa7a3c3588c7901169b2?s=128&d=identicon&r=PG", "display_name": "Wojciech Wi\u015bniewski", "link": "https://stackoverflow.com/users/10208760/wojciech-wi%c5%9bniewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1457, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1571315317, "creation_date": 1571227698, "last_edit_date": 1571315317, "question_id": 58412960, "link": "https://stackoverflow.com/questions/58412960/outlook-mail-array-index-is-out-of-bounds", "title": "Outlook mail &quot;Array index is out of bounds&quot;", "body": "<p>I have the problem with Outlook mail. I'm creating the HTML mail via Excel VBA and it's displaying properly. When a user click \"Send\", it's sending properly. But if user (on Outlook 2016) try to add an attachment, gets the prompt \"Array index is out of bounds\" (even, if Excel is closed after creating mail), so I think it's Outlook's problem rather than Excel's. It's not happening on Outlook 2010.</p>\n\n<p>I've noticed, that when user change message type to RTF, then it's possible to add an attachment (but HTML formatting is quite important for me, because I want to send a table in body).</p>\n\n<p>I've searched Stack and other sites, but everything I've found on that prompt was occuring in Excel while code was running. Thanks in advance :)</p>\n\n<hr>\n\n<p>I was asked for the code (it's not important in my opinion, but maybe i'm wrong ;) ).</p>\n\n<pre><code>Sub Wysy\u0142anieMaila(Tre\u015b\u0107 As String, Temat As String, Adresat As String, DW As String, Za\u0142\u0105cznik As String)\n\nDim Wy\u015bwietlanie As Boolean\nDim Wy\u015blij As Boolean\nDim OutApp As Object\nDim OutMail As Object\n\nWy\u015bwietlanie = True\nWy\u015blij = False\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(olMailItem)\n\nOn Error Resume Next\nWith OutMail\n    .BodyFormat = 3\n    If Wy\u015bwietlanie Then .Display\n    .To = Adresat \n    .CC = DW\n    .Subject = Temat\n    .Body = Tre\u015b\u0107\n    .Attachments.Add Za\u0142\u0105cznik\n    If Wy\u015blij Then\n        .Send\n    Else\n        .Display\n    End If\nEnd With\nOn Error GoTo 0\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nEnd Sub\n\nFunction Tre\u015b\u0107HTMLDoMaila(WierszMin As Long, WierszMax As Long) As String\n\nDim i As Long\nDim j As Integer\nDim KolumnaPocz\u0105tek As Integer\nDim KolumnaKoniec As Integer\n\nKolumnaPocz\u0105tek = 1\nKolumnaKoniec = 18\n\nTre\u015b\u0107HTMLDoMaila = \"&lt;table border=1 cellpadding=5 style=\"\"border-collapse:collapse\"\"&gt;&lt;tr&gt;\"\n\nFor j = KolumnaPocz\u0105tek To KolumnaKoniec\n    If Not j = 4 And Not j = 14 And Not j = 15 And Not j = 17 Then Tre\u015b\u0107HTMLDoMaila = Tre\u015b\u0107HTMLDoMaila &amp; \"&lt;td&gt;&lt;b&gt;&lt;font face=\"\"Calibri\"\" size=\"\"2\"\"&gt;\" &amp; Arkusz1.Cells(1, j).Value &amp; \"&lt;/font&gt;&lt;/b&gt;&lt;/td&gt;\"\nNext j\nTre\u015b\u0107HTMLDoMaila = Tre\u015b\u0107HTMLDoMaila &amp; \"&lt;/tr&gt;\"\n\nFor i = WierszMin To WierszMax\n    If Arkusz1.Cells(i, 25).Value = \"Nierozliczone\" Then\n        Tre\u015b\u0107HTMLDoMaila = Tre\u015b\u0107HTMLDoMaila &amp; \"&lt;tr&gt;\"\n        For j = KolumnaPocz\u0105tek To KolumnaKoniec\n            If Not j = 4 And Not j = 14 And Not j = 15 And Not j = 17 Then Tre\u015b\u0107HTMLDoMaila = Tre\u015b\u0107HTMLDoMaila &amp; \"&lt;td&gt;&lt;font face=\"\"Calibri\"\" size=\"\"2\"\"&gt;\" &amp; Arkusz1.Cells(i, j).Value &amp; \"&lt;/font&gt;&lt;/td&gt;\"\n        Next j\n        Tre\u015b\u0107HTMLDoMaila = Tre\u015b\u0107HTMLDoMaila &amp; \"&lt;/tr&gt;\"\n    End If\nNext i\n\nTre\u015b\u0107HTMLDoMaila = Tre\u015b\u0107HTMLDoMaila &amp; \"&lt;/table&gt;\"\n\nEnd Function\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 163, "user_id": 12213296, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4kCa9Fd48wY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reQFQIp8Gts_ND1mP4FoT2Xe4SvfQ/photo.jpg?sz=128", "display_name": "Sfagnum", "link": "https://stackoverflow.com/users/12213296/sfagnum"}, "is_accepted": true, "score": 2, "last_activity_date": 1571231313, "creation_date": 1571231313, "answer_id": 58414111, "question_id": 58412815, "link": "https://stackoverflow.com/questions/58412815/my-code-does-not-place-the-values-every-row-instead-skips-rows-based-on-source/58414111#58414111", "title": "My code does not place the values every row, instead skips rows based on source sheet layout", "body": "<p>move <code>n = n + 1</code> to another place.</p>\n\n<pre><code>    n = 2\n    With Worksheets(\"Sheet1\")\n    For Each cell In Sheets(\"Sheet1\").Range(\"A2:A\" &amp; Lastrow3)\n        If IsNumeric(cell.Value) Then\n            If cell.Value = Int(cell.Value) Then\n               Worksheets(\"Sheet3\").Cells(n, \"C\").Value = cell.Value\n               Worksheets(\"Sheet3\").Cells(n, \"D\").Value = cell.Offset(0, 1).Value\n               Worksheets(\"Sheet3\").Cells(n, \"B\").Value = cell.Offset(0, 8).Value\n               Worksheets(\"Sheet3\").Cells(n, \"A\").Value = cell.Offset(0, 7).Value\n               Worksheets(\"Sheet3\").Cells(n, \"H\").Value = cell.Offset(0, 23).Value\n               Worksheets(\"Sheet3\").Cells(n, \"E\").Value = cell.Offset(0, 3).Value\n               n = n + 1\n            Else\n            End If\n        Else\n        End If\n    Next cell\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11186188, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156535419728218/picture?type=large", "display_name": "Lawrence Forster", "link": "https://stackoverflow.com/users/11186188/lawrence-forster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 58414111, "answer_count": 1, "score": 0, "last_activity_date": 1571231313, "creation_date": 1571227269, "last_edit_date": 1571231019, "question_id": 58412815, "link": "https://stackoverflow.com/questions/58412815/my-code-does-not-place-the-values-every-row-instead-skips-rows-based-on-source", "title": "My code does not place the values every row, instead skips rows based on source sheet layout", "body": "<p>I have a piece of code that searches through Sheet(\"Sub Tasks\") and if the number in column A is a decimal, it then makes cells in Sheet(\"PBS\") Column D = to the offset of the decimal cell found in column A. However, I would like the code to work by making row 2,3,4,5,6, and so on (+1) in sheet PBS display the info from Sub tasks. </p>\n\n<p>But at the moment, the info is displayed in the same layout as it is in Sheet(\"Sub Tasks\"). What am i missing from the code. </p>\n\n<pre><code>\nDim Lastrow3 As Long, r As Long, n As Long, cell As Range, ws As Worksheet, Lastrow1 As Long\nLastrow3 = Sheets(\"Sub Tasks\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nLastrow1 = Sheets(\"PBS \").Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n\nn = 2\nWith Worksheets(\"Sub Tasks\")\n        For Each cell In Sheets(\"Sub Tasks\").Range(\"A2:A\" &amp; Lastrow3)\n            If IsNumeric(cell.value) Then\n                If cell.value = Int(cell.value) Then\n                   Worksheets(\"PBS \").Cells(n, \"C\").value = cell.value\n                   Worksheets(\"PBS \").Cells(n, \"D\").value = cell.Offset(0, 1).value\n                   Worksheets(\"PBS \").Cells(n, \"B\").value = cell.Offset(0, 8).value\n                   Worksheets(\"PBS \").Cells(n, \"A\").value = cell.Offset(0, 7).value\n                   Worksheets(\"PBS \").Cells(n, \"H\").value = cell.Offset(0, 23).value\n                   Worksheets(\"PBS \").Cells(n, \"E\").value = cell.Offset(0, 3).value\n                Else\n                End If\n            Else\n            End If\n        n = n + 1\n    Next cell\nEnd With\n``````````````````````````\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "insert", "parameterization"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 3, "creation_date": 1571226733, "post_id": 58412396, "comment_id": 103168303, "body": "Please try to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. With the current information, it&#39;s very hard to figure out what you&#39;re doing."}, {"owner": {"reputation": 69, "user_id": 9540872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30851ee7aba1658d91a41b2727905a72?s=128&d=identicon&r=PG&f=1", "display_name": "dcary", "link": "https://stackoverflow.com/users/9540872/dcary"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1571230374, "post_id": 58412396, "comment_id": 103170481, "body": "@ErikA thank you. So when I went to upload my code. I found my issue, I declared the parm but didn&#39;t include it in the INSERT. There were 22 parms so I guess I just overlooked it."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 9540872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30851ee7aba1658d91a41b2727905a72?s=128&d=identicon&r=PG&f=1", "display_name": "dcary", "link": "https://stackoverflow.com/users/9540872/dcary"}, "edited": false, "score": 0, "creation_date": 1571230398, "post_id": 58412685, "comment_id": 103170502, "body": "I found my mistake. This is an interesting solution."}], "tags": [], "owner": {"reputation": 96, "user_id": 11920730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ee300e95b2aa75e774e8becb73b6606?s=128&d=identicon&r=PG&f=1", "display_name": "andarvi", "link": "https://stackoverflow.com/users/11920730/andarvi"}, "is_accepted": false, "score": 0, "last_activity_date": 1571226867, "creation_date": 1571226867, "answer_id": 58412685, "question_id": 58412396, "link": "https://stackoverflow.com/questions/58412396/parameterization-of-a-yesno-field-using-an-insert-into-in-access-vba/58412685#58412685", "title": "Parameterization of a YesNo field using an INSERT INTO in Access VBA", "body": "<p>This works for me:</p>\n\n<pre><code>Sub TestYesNo\n  DIM rs as Recordset\n  currentdb.Execute  \"CREATE TABLE Tbl1 (YesNoCol BIT)\"\n  currentdb.Execute \"INSERT INTO Tbl1 VALUES(-1)\"\n  set rs=Currentdb.Openrecordset(\"Tbl1\")\n  Debug.print rs!YesNoCol\n  rs.close\n  currentdb.Execute  \"DROP TABLE Tbl1\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 9540872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30851ee7aba1658d91a41b2727905a72?s=128&d=identicon&r=PG&f=1", "display_name": "dcary", "link": "https://stackoverflow.com/users/9540872/dcary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593762448, "creation_date": 1571225930, "last_edit_date": 1593762448, "question_id": 58412396, "link": "https://stackoverflow.com/questions/58412396/parameterization-of-a-yesno-field-using-an-insert-into-in-access-vba", "title": "Parameterization of a YesNo field using an INSERT INTO in Access VBA", "body": "<p>I have an Access Database, I have to do coding in the backend while users will use forms to update records. I have a field that is designated as a YesNo field. Well when I try to parameterize my code I set the parm to YesNo. When I receive the value, it comes in as -1 or (TRUE) like it should. I even tried to hardcode the parm to (TRUE). However when the insert statement executes. My record does not change and when I evaluate it after the run, the value is 0 (False). Help? I can show some of the code later. But I just don't understand, I'm passing the correct information but the insert just isn't changing the field correctly.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 1, "creation_date": 1571224981, "post_id": 58412101, "comment_id": 103167298, "body": "You have an unnecessary <code>Current</code> inside the assignment of <code>LastColumn</code> =)"}], "tags": [], "owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "is_accepted": true, "score": 2, "last_activity_date": 1571225096, "last_edit_date": 1571225096, "creation_date": 1571224873, "answer_id": 58412101, "question_id": 58412005, "link": "https://stackoverflow.com/questions/58412005/vba-looping-through-worksheets-to-delete-blank-columns/58412101#58412101", "title": "VBA Looping through worksheets to delete blank columns", "body": "<p>Try this:</p>\n\n<pre><code>Option Explicit\n\nSub DeleteBlankColumns()\n\nDim LastColumn As Long\nDim r As Long\nDim Counter As Long\nDim Current As Worksheet\n\n    Application.ScreenUpdating = False\n    For Each Current In Worksheets\n        With Current\n            LastColumn = .UsedRange.Columns.Count + .UsedRange.Columns(1).Column - 1\n            For r = LastColumn To 1 Step -1\n                If Application.WorksheetFunction.CountA(.Columns(r)) = 0 Then\n                    .Columns(r).Delete\n                    Counter = Counter + 1\n                End If\n            Next r\n        End With\n    Next\n    Application.ScreenUpdating = True\n    MsgBox \"Deleted \" &amp; Counter &amp; \" empty columns.\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12226096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2956f099cef73e3c9a065dff5365e409?s=128&d=identicon&r=PG&f=1", "display_name": "MacMaxBus", "link": "https://stackoverflow.com/users/12226096/macmaxbus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 58412101, "answer_count": 1, "score": 1, "last_activity_date": 1571225096, "creation_date": 1571224480, "last_edit_date": 1571224988, "question_id": 58412005, "link": "https://stackoverflow.com/questions/58412005/vba-looping-through-worksheets-to-delete-blank-columns", "title": "VBA Looping through worksheets to delete blank columns", "body": "<p>I created this macro to delete every empty column in active workbook. However it does not work on each sheet and only on an active one.</p>\n\n<p>Please let me know your ideas what can be done to make macro work properly and loop through all the worksheets, not only the active one.</p>\n\n<pre><code>Sub DeleteBlankColumns()\n\nDim LastColumn As Long\nDim r As Long\nDim Counter As Long\nDim Current As Worksheet\n\n    Application.ScreenUpdating = False\n    For Each Current In Worksheets\n    LastColumn = Current.UsedRange.Columns.Count + Current.UsedRange.Columns(1).Column - 1\n        For r = LastColumn To 1 Step -1\n            If Application.WorksheetFunction.CountA(Columns(r)) = 0 Then\n                Current.Columns(r).Delete\n                Counter = Counter + 1\n            End If\n        Next r\n    Next\n    Application.ScreenUpdating = True\n    MsgBox \"Deleted \" &amp; Counter &amp; \" empty columns.\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12224879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f7b0a2b8c32d2ac2ae77f8cbb9547cb?s=128&d=identicon&r=PG&f=1", "display_name": "HarCo", "link": "https://stackoverflow.com/users/12224879/harco"}, "edited": false, "score": 0, "creation_date": 1571239605, "post_id": 58412273, "comment_id": 103176484, "body": "This works for me but Is it possible to do the same with header names rather than column numbers?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1, "user_id": 12224879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f7b0a2b8c32d2ac2ae77f8cbb9547cb?s=128&d=identicon&r=PG&f=1", "display_name": "HarCo", "link": "https://stackoverflow.com/users/12224879/harco"}, "edited": false, "score": 0, "creation_date": 1571239755, "post_id": 58412273, "comment_id": 103176559, "body": "Yes just use the names instead of the indexes."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1571225500, "creation_date": 1571225500, "answer_id": 58412273, "question_id": 58411453, "link": "https://stackoverflow.com/questions/58411453/how-to-select-multiple-non-adjacent-columns-in-excel-filtered-table-using-colu/58412273#58412273", "title": "How to select multiple, non-adjacent, columns in Excel filtered table using column names", "body": "<p>This works for me.</p>\n\n<pre><code>Sub x()\n\nWith ActiveSheet.ListObjects(1)\n    Union(.ListColumns(1).Range, .ListColumns(3).Range).SpecialCells(xlCellTypeVisible).Copy Range(\"A18\")\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/mEOFp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mEOFp.png\" alt=\"enter image description here\"></a></p>\n\n<p>There is a good guide to tables <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 12224879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f7b0a2b8c32d2ac2ae77f8cbb9547cb?s=128&d=identicon&r=PG&f=1", "display_name": "HarCo", "link": "https://stackoverflow.com/users/12224879/harco"}, "edited": false, "score": 0, "creation_date": 1571239935, "post_id": 58413417, "comment_id": 103176641, "body": "Done that but still getting <b>&quot;Method &#39;Range&#39; of object &#39;_Worksheet&#39; failed&quot;</b> run-time error. If I use column numbers (e.g. <code>.ListColumns(1).Range</code> then it works. If you can solve this then this would be my preferred answer. Thank you"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 1, "user_id": 12224879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f7b0a2b8c32d2ac2ae77f8cbb9547cb?s=128&d=identicon&r=PG&f=1", "display_name": "HarCo", "link": "https://stackoverflow.com/users/12224879/harco"}, "edited": false, "score": 0, "creation_date": 1571248225, "post_id": 58413417, "comment_id": 103180501, "body": "@HarCo It works here with a table set up with that name and those headers. Without more information as to the real data and exactly what you are doing, I could only guess as to your problem with implementing this solution.  My guess is that the header names (or table name) are not what you think they are.  Maybe some non-printing characters, spaces, etc.  If that is not the case, I&#39;d need to examine the workbook."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1571229129, "creation_date": 1571229129, "answer_id": 58413417, "question_id": 58411453, "link": "https://stackoverflow.com/questions/58411453/how-to-select-multiple-non-adjacent-columns-in-excel-filtered-table-using-colu/58413417#58413417", "title": "How to select multiple, non-adjacent, columns in Excel filtered table using column names", "body": "<p>Using structured references as you show, I think you want something like:</p>\n\n<pre><code>Set R = Union(Range(\"Table1[[#All],[Email]]\"), Range(\"Table1[[#All],[Language]]\")).SpecialCells(xlCellTypeVisible)\n\nR.Copy 'your_destination\n</code></pre>\n\n<p>Some of your errors are related to:</p>\n\n<ul>\n<li>you are not providing range objects for the arguments to the <code>Union</code> method</li>\n<li>you are only providing the Header row to the argument</li>\n<li>Use of <code>Select</code> just confuses things and is rarely, if ever, necessary.</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 12224879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f7b0a2b8c32d2ac2ae77f8cbb9547cb?s=128&d=identicon&r=PG&f=1", "display_name": "HarCo", "link": "https://stackoverflow.com/users/12224879/harco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 673, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1571229129, "creation_date": 1571222667, "question_id": 58411453, "link": "https://stackoverflow.com/questions/58411453/how-to-select-multiple-non-adjacent-columns-in-excel-filtered-table-using-colu", "title": "How to select multiple, non-adjacent, columns in Excel filtered table using column names", "body": "<p>I'm trying to copy multiple, non-adjacent, columns from filtered table to another sheet. I'm stuck with the multiple selection part:<br>\n* The data is from external source -> I can't control original stracture<br>\n* The filtering creterias are from columns which I don't need to copy -> I can't skip importing columns that I don't need to copy.<br>\n* The table is filtered -> I can't simply select column (e.g. C:C), I need the filtered rows only.<br>\n<br>\nIs it possible doing so by using header names?</p>\n\n<p>I've tried few lines of code (see below) but none of those produced the desired results. If I record a macro I simply get range selections:<br>\n<strong><em>Range(\"C155:C30230,E155:E30230\").Select</em></strong></p>\n\n<p>This is what i tried so far, grouped by results:<br>\nNote that these is test code so it is not necessarily refer to the same columns\n-> Working, but not exactly what I want:<br>\n<code>' this is only one column\nRange(\"myTable[[#Headers],[Email]]\").Select</code></p>\n\n<p><code>' this is full (unfiltered) column selection\nUnion(ws.Range(\"C:C\"), ws.Range(\"E:E\")).Select<br></code></p>\n\n<p><code>'  this is not using header name\nUnion(ActiveSheet.ListObjects(\"myTable\").ListColumns(3).Range, ActiveSheet.ListObjects(\"myTable\").ListColumns(5).Range).Select</code><br></p>\n\n<p>->These snippets generatad run-time error \"Method 'Range' of object<br>\n'_Worksheet' failed\":<br>\n<code>Union(Range(\"myTable[[#Headers],[Email]]\").Select, Range(\"myTable[[#Headers],[Language]]\").Select)</code></p>\n\n<p><code>Dim rng As Range\nSet rng = Union(Range(\"myTable[[#Headers],[Email]]\"), Range(\"myTable[[#Headers],[Language]]\"))</code><br></p>\n\n<p><code>Union(Range(\"myTable[[#Headers],[Email]]\"), Range(\"myTable[[#Headers],[Language]]\")).Select</code><br></p>\n\n<p><code>Union(Range(\"myTable[[#Headers],[Email]]\"), Range(\"A:A\")).Select</code><br></p>\n\n<p>->This snippet generatad error \"Compile error: Type mismatch\":<br>\n<code>Dim rng As Range\nSet rng = Union(Range(\"myTable[[#Headers],[Email]]\").Address, Range(\"myTable[[#Headers],[Language]]\").Address)</code><br></p>\n\n<p>My aim at this stage is to see all the required filtrered table columns selected.<br>\nThank you for looking at this</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1571223271, "post_id": 58411392, "comment_id": 103166369, "body": "I think OP means this: <a href=\"https://support.office.com/en-us/article/write-conflict-dialog-box-2d139ce4-4ec5-4bea-adb2-b2a3d73ee775\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1571224052, "post_id": 58411392, "comment_id": 103166815, "body": "@Andre: Right. I misread the question. I&#39;ve edited the answer."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1571223984, "last_edit_date": 1571223984, "creation_date": 1571222443, "answer_id": 58411392, "question_id": 58410916, "link": "https://stackoverflow.com/questions/58410916/write-conflict-i-want-to-always-drop-changes/58411392#58411392", "title": "Write conflict: I want to always Drop Changes", "body": "<p>Not quite sure what you mean by \"drop changes\" - the frontend should never be redesigned during normal use.</p>\n\n<p>You must distribute a new copy of the frontend to the users.</p>\n\n<p>A smooth and proven method using a <em>shortcut</em> and a <em>script</em> is described in my article:</p>\n\n<p><a href=\"https://www.experts-exchange.com/articles/33417/Deploy-and-update-a-Microsoft-Access-application-with-one-click.html\" rel=\"nofollow noreferrer\">Deploy and update a Microsoft Access application with one click</a></p>\n\n<p><em>(If you don't have an account, browse for the link: Read the full article)</em></p>\n\n<p><strong>Edit</strong>:</p>\n\n<p>If it is the data that is updated by several users, and you update via VBA, you may study another of my articles:</p>\n\n<p><a href=\"https://www.experts-exchange.com/articles/25780/Handle-concurrent-update-conflicts-in-Access-silently.html\" rel=\"nofollow noreferrer\">Handle concurrent update conflicts in Access silently</a></p>\n\n<p>Though simple to use, the code is a bit too much to post here. It is also on <strong>GitHub</strong>: </p>\n\n<p><a href=\"https://github.com/GustavBrock/VBA.ConcurrencyUpdates\" rel=\"nofollow noreferrer\">VBA.ConcurrencyUpdates</a></p>\n"}], "owner": {"reputation": 33, "user_id": 12019909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c37a734d9b2dad8555342b3dfa4d5ea1?s=128&d=identicon&r=PG&f=1", "display_name": "lgTakunda", "link": "https://stackoverflow.com/users/12019909/lgtakunda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593762460, "creation_date": 1571220895, "last_edit_date": 1593762460, "question_id": 58410916, "link": "https://stackoverflow.com/questions/58410916/write-conflict-i-want-to-always-drop-changes", "title": "Write conflict: I want to always Drop Changes", "body": "<p>I have a split database and I have duplicated front-end file to make multiple copies for different users. Every-time a change is made on one front-end form, I want the other forms in other front-ends to always drop changes. How can I trap this write conflict to always drop changes maybe through VBA if possible?</p>\n"}, {"tags": ["excel", "vba", "yahoo-finance"], "comments": [{"owner": {"reputation": 5315, "user_id": 3689364, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/1wGCo.jpg?s=128&g=1", "display_name": "EliteRaceElephant", "link": "https://stackoverflow.com/users/3689364/eliteraceelephant"}, "edited": false, "score": 1, "creation_date": 1571222525, "post_id": 58410896, "comment_id": 103165969, "body": "What have you tried? See <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1571223295, "post_id": 58410896, "comment_id": 103166387, "body": "I do not extract information from Yahoo but I have and do extract information from other websites and electronic files.  The authors of such data regularly change the format (an extra column here or a rearrangement there).  Perhaps they think they are improving it or perhaps they wish to discourage its use in this way.  Either way, there is no point starting this type of extraction unless you are able to update your routines quickly after each format change.  If someone here helped you update your routine, it would only delay the need for you to be able do it yourself."}, {"owner": {"reputation": 23, "user_id": 10876425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d016997b5b89e689c3ddb5ea186785e7?s=128&d=identicon&r=PG&f=1", "display_name": "bibsn", "link": "https://stackoverflow.com/users/10876425/bibsn"}, "edited": false, "score": 0, "creation_date": 1571227280, "post_id": 58410896, "comment_id": 103168628, "body": "dear EliteRaceElephant"}, {"owner": {"reputation": 23, "user_id": 10876425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d016997b5b89e689c3ddb5ea186785e7?s=128&d=identicon&r=PG&f=1", "display_name": "bibsn", "link": "https://stackoverflow.com/users/10876425/bibsn"}, "edited": false, "score": 0, "creation_date": 1571227791, "post_id": 58410896, "comment_id": 103168953, "body": "Dear EliteRaceElephant, I tried to build up a new script, but the problem is that I don&#39;t know HTML well, so I cannot found the correct way to extract them"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1571230471, "post_id": 58410896, "comment_id": 103170553, "body": "if you have Excel 2010+, you may be able to obtain the information by using <code>Power Query</code> aka <code>Get &amp; Transform</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1571231591, "post_id": 58410896, "comment_id": 103171230, "body": "We can help you but please include your current attempt with the page shown and explain where code is failing and indicate the required output data and its format."}, {"owner": {"reputation": 23, "user_id": 10876425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d016997b5b89e689c3ddb5ea186785e7?s=128&d=identicon&r=PG&f=1", "display_name": "bibsn", "link": "https://stackoverflow.com/users/10876425/bibsn"}, "edited": false, "score": 0, "creation_date": 1571302450, "post_id": 58410896, "comment_id": 103198210, "body": "Dear QHarr I update my request with the part that I need. Thanks in advance."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1571351176, "post_id": 58410896, "comment_id": 103222497, "body": "Most modern webpages are designed to display attractively on both a PC and a smartphone despite their very different dimensions. Those I have examined, build the components of the display using fairly standard HTML then use device dependent, complex CCS to position those components. You cannot work down the displayed page and the HTML and expect to find some simple match between them. Each component will be blocked with divs, named with a class, so the CCS can position the components as appropriate for the device. You need to find the components which may not be what you expect. ..."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1571351222, "post_id": 58410896, "comment_id": 103222508, "body": "... My guess is you will have to extract the contents of each component separately and then merge them as the CCS does for a PC."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10876425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d016997b5b89e689c3ddb5ea186785e7?s=128&d=identicon&r=PG&f=1", "display_name": "bibsn", "link": "https://stackoverflow.com/users/10876425/bibsn"}, "edited": false, "score": 0, "creation_date": 1571661919, "post_id": 58477258, "comment_id": 103303868, "body": "I tried your Macro but I received an error:  run-time error &#39;5&#39; &quot;Invalid procedure call or argument&quot;  the problem is in the line 4 &quot;.CommandType = 0&quot;."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 23, "user_id": 10876425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d016997b5b89e689c3ddb5ea186785e7?s=128&d=identicon&r=PG&f=1", "display_name": "bibsn", "link": "https://stackoverflow.com/users/10876425/bibsn"}, "edited": false, "score": 0, "creation_date": 1571769976, "post_id": 58477258, "comment_id": 103348672, "body": "You can comment out that line and run it once more.  You have to figure it our yourself, or wait until I get back to the US.  Again, I&#39;m in Spain, and everything here is translated into Spanish automatically.  Weird, but true.  When I get back to the US, on Saturday, I can see what&#39;s really going on.  Or, try to resolve the issue yourself.  Learning is fun.  It can be frustrating too.  Nevertheless, the benefits outweigh the costs."}, {"owner": {"reputation": 23, "user_id": 10876425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d016997b5b89e689c3ddb5ea186785e7?s=128&d=identicon&r=PG&f=1", "display_name": "bibsn", "link": "https://stackoverflow.com/users/10876425/bibsn"}, "edited": false, "score": 0, "creation_date": 1571843043, "post_id": 58477258, "comment_id": 103376331, "body": "Ciao asher, thx for your reply. Don&#39;t worry, I will try and I want to have your feedback when you are in US next week. Many thanks for your help."}, {"owner": {"reputation": 23, "user_id": 10876425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d016997b5b89e689c3ddb5ea186785e7?s=128&d=identicon&r=PG&f=1", "display_name": "bibsn", "link": "https://stackoverflow.com/users/10876425/bibsn"}, "edited": false, "score": 0, "creation_date": 1572251779, "post_id": 58477258, "comment_id": 103488911, "body": "Ciao Asher. This weekend I tried to solve the problem. I commented the line .commantype = 0 but the macro did not extract nothing. So I tried to learn the function QueryTables.Add but it has been not very clear for me. So can you give me an update, please?"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 23, "user_id": 10876425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d016997b5b89e689c3ddb5ea186785e7?s=128&d=identicon&r=PG&f=1", "display_name": "bibsn", "link": "https://stackoverflow.com/users/10876425/bibsn"}, "edited": false, "score": 0, "creation_date": 1572304842, "post_id": 58477258, "comment_id": 103511628, "body": "Ciao.  I am back home now and I can actually see what is going on at this point.  I just updated my original answer.  Use that script.  You should have what you need now.  This works for me; it should work for you.  Feel free to customize the code, of course, to do exactly what you need to do."}, {"owner": {"reputation": 23, "user_id": 10876425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d016997b5b89e689c3ddb5ea186785e7?s=128&d=identicon&r=PG&f=1", "display_name": "bibsn", "link": "https://stackoverflow.com/users/10876425/bibsn"}, "edited": false, "score": 0, "creation_date": 1572435386, "post_id": 58477258, "comment_id": 103556646, "body": "Ciao Asher. I thank you for helping. I copied and pasted your update, but when I run it, I received nothing. The sheet is without data. I think that I&#39;m wrong about something, but I don&#39;t have ideas where. I&#39;m sorry about it."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 23, "user_id": 10876425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d016997b5b89e689c3ddb5ea186785e7?s=128&d=identicon&r=PG&f=1", "display_name": "bibsn", "link": "https://stackoverflow.com/users/10876425/bibsn"}, "edited": false, "score": 0, "creation_date": 1572456445, "post_id": 58477258, "comment_id": 103568700, "body": "That was very weird.  I could swear the code from my last post initially worked, but when I just re-tried it, it did not work.  I changed the code and re-posted.  Try it again please."}, {"owner": {"reputation": 23, "user_id": 10876425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d016997b5b89e689c3ddb5ea186785e7?s=128&d=identicon&r=PG&f=1", "display_name": "bibsn", "link": "https://stackoverflow.com/users/10876425/bibsn"}, "edited": false, "score": 0, "creation_date": 1572859163, "post_id": 58477258, "comment_id": 103678367, "body": "Ciao Asher. thanks a lot for your help. I have already a script the same as you posted, that download the &quot;tables&quot; in the web site. But I need (see my post) a portion that appears as a  &quot;table&quot; but it is not downloaded as a table."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1572456387, "last_edit_date": 1572456387, "creation_date": 1571605104, "answer_id": 58477258, "question_id": 58410896, "link": "https://stackoverflow.com/questions/58410896/extract-financial-fundamental-from-yahoo-finance-with-excel/58477258#58477258", "title": "Extract financial fundamental from Yahoo finance with excel", "body": "<p>Try this.</p>\n\n<pre><code>Sub Yahoo_BS()\n\nDim xmlHttp As Object\nDim TR_col As Object, Tr As Object\nDim TD_col As Object, Td As Object\nDim row As Long, col As Long\n\n    Set xmlHttp = CreateObject(\"MSXML2.XMLHTTP.6.0\")\n    myURL = \"https://finance.yahoo.com/quote/SBUX/balance-sheet?p=SBUX\"\n    xmlHttp.Open \"GET\", myURL, False\n    xmlHttp.setRequestHeader \"Content-Type\", \"text/xml\"\n    xmlHttp.send\n\n    Dim html As Object\n    Set html = CreateObject(\"htmlfile\")\n    html.body.innerHTML = xmlHttp.responseText\n\n    Dim tbl As Object\n    Set tbl = html.getElementById(\"Pos(r)\")\n\n\n    row = 1\n    col = 1\n\n    Set TR_col = html.getElementsByTagName(\"TR\")\n    For Each Tr In TR_col\n        Set TD_col = Tr.getElementsByTagName(\"TD\")\n        For Each Td In TD_col\n            Cells(row, col) = Td.innerText\n            col = col + 1\n        Next\n        col = 1\n        row = row + 1\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Keep in mind that this is just one way to do it.  I'm sure there are several means to the same end.  Also, think about looping through an array of ticker symbols.  You can add new sheets for each ticker and import the relevant data for each symbol that you query for.</p>\n\n<p>Please click the check to say the answer is useful if this solution helps you.</p>\n"}], "owner": {"reputation": 23, "user_id": 10876425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d016997b5b89e689c3ddb5ea186785e7?s=128&d=identicon&r=PG&f=1", "display_name": "bibsn", "link": "https://stackoverflow.com/users/10876425/bibsn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2512, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1572520081, "creation_date": 1571220836, "last_edit_date": 1572520081, "question_id": 58410896, "link": "https://stackoverflow.com/questions/58410896/extract-financial-fundamental-from-yahoo-finance-with-excel", "title": "Extract financial fundamental from Yahoo finance with excel", "body": "<p>Yahoo changed his structure for the financials (fundamental) report.\nIn the past (last month) at the page <a href=\"https://finance.yahoo.com/quote/AAPL/financials?p=AAPL&amp;guccounter=1\" rel=\"nofollow noreferrer\">https://finance.yahoo.com/quote/AAPL/financials?p=AAPL&amp;guccounter=1</a> I could download the information regarding the financial Income Statement or Balance Sheet or Cash Flow in VBA Excel as a table.\nNow they have updated the \"new\" version that appears as a table but I cannot extract it con VBA Excel.\nThere someone that can help me?\nIf you need I can post the code in VBA regarding the old version, that can download all the tables in the HTML page.</p>\n\n<p>To better explain I need the information in the yellow box.\n<a href=\"https://i.stack.imgur.com/7GvMy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7GvMy.png\" alt=\"enter image description here\"></a>\nYou can see that it appears as a table, but if you look inside in the HTML code there is not the normal tag regarding tables.\nI identify that the starting \"table\" has this tag <code>&lt;div class=\"D(tbrg)\"</code> but I don't know how to proceed to extract data.\nThe same \"table\" is in the Balance Sheet and Cash Flow selection. </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba", "sax", "saxparser"], "owner": {"reputation": 11, "user_id": 12225645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca65e3cb8e623e3d710138baa1ca1fd?s=128&d=identicon&r=PG&f=1", "display_name": "David Barraclough", "link": "https://stackoverflow.com/users/12225645/david-barraclough"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1571220730, "creation_date": 1571220730, "question_id": 58410863, "link": "https://stackoverflow.com/questions/58410863/in-excel-vba-using-saxxmlreader60-to-parse-multiple-very-large-files-how-to-sto", "title": "In Excel VBA using SAXXMLReader60 to parse multiple very large files. How to stop parsing document and go to next file?", "body": "<p>I'm trying to parse large XML files relatively quickly in Excel VBA. In each file I only need to get information from the first few elements, then need to exit parsing and go to the next file. I implemented the ContentHandlerError but can't see how to raise it in order to gracefully drop back into the loop and parse the next file. Here is the code, I'd really appreciate any help!</p>\n\n<pre><code>Sub main()\n\n    Dim saxReader As SAXXMLReader60\n    Dim saxhandler As ContentHandlerImpl\n    Dim saxerror As ContentHandlerError\n    Dim sFolder As String\n    Dim sFile As String\n    Dim sFilePath As String\n\n    sFilePath = \"c:\\testfiles\\\"\n    sFolder = sFilePath &amp; \"*.xml\"\n\n    sFile = Dir(sFolder)\n\n    Do While Len(sFile) &gt; 0\n        Debug.Print sFile\n\n        Set saxReader = New SAXXMLReader60\n        Set saxhandler = New ContentHandlerImpl\n        Set saxerror = New ContentHandlerError\n\n        Set saxReader.contentHandler = saxhandler\n        Set saxReader.errorHandler = saxerror\n\n        saxReader.parseURL \"file://\" &amp; sFilePath &amp; sFile\n\n        Set saxReader = Nothing\n\n        sFile = Dir\n    Loop\n\nEnd Sub\n\nPrivate Sub IVBSAXContentHandler_endElement(strNamespaceURI As String, strLocalName As String, strQName As String)\n\n    If strLocalName = \"Series\" Then\n\n        'TODO:How to stop processing and go to next file?\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11186188, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156535419728218/picture?type=large", "display_name": "Lawrence Forster", "link": "https://stackoverflow.com/users/11186188/lawrence-forster"}, "edited": false, "score": 0, "creation_date": 1571222241, "post_id": 58410958, "comment_id": 103165829, "body": "Just tried changing to worksheet_change and still no luck!"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 31, "user_id": 11186188, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156535419728218/picture?type=large", "display_name": "Lawrence Forster", "link": "https://stackoverflow.com/users/11186188/lawrence-forster"}, "edited": false, "score": 0, "creation_date": 1571222792, "post_id": 58410958, "comment_id": 103166109, "body": "Strange, I&#39;m running this identical sub in a test file. It will fire when you press <code>Enter</code> in a cell in which you just typed &quot;Delivered&quot;, or you select it from a dropdown. Did you check you have the right workbook, range and spelling?"}, {"owner": {"reputation": 31, "user_id": 11186188, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156535419728218/picture?type=large", "display_name": "Lawrence Forster", "link": "https://stackoverflow.com/users/11186188/lawrence-forster"}, "edited": false, "score": 0, "creation_date": 1571223280, "post_id": 58410958, "comment_id": 103166379, "body": "I believe its all correct, I have checked all spellings, sheets etc"}], "tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": false, "score": 0, "last_activity_date": 1571222637, "last_edit_date": 1571222637, "creation_date": 1571221053, "answer_id": 58410958, "question_id": 58410808, "link": "https://stackoverflow.com/questions/58410808/looping-through-cells-to-identify-if-data-validation-list-selected/58410958#58410958", "title": "Looping through cells to identify if Data validation list selected", "body": "<p>This can be done entirely without a loop like so:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nlastrow = Sheets(\"Sub Tasks\").Range(\"W\" &amp; Rows.Count).End(xlUp).Row\nIf Target.Value = \"Delivered\" Then\n    If Application.Intersect(Target, Range(\"W4:W\" &amp; lastrow)) Is Nothing Then     Exit Sub\n    Call ConditionalFormatSharepointDeliveryLink\nEnd If\nEnd Sub\n</code></pre>\n\n<p>As per your comments on the other answer, you might want to change this sub to Worksheet_Change instead. That will run when a cell is changed to \"Delivered\", but the above only runs when a new cell is selected with \"Delivered\" in the name.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 11186188, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156535419728218/picture?type=large", "display_name": "Lawrence Forster", "link": "https://stackoverflow.com/users/11186188/lawrence-forster"}, "edited": false, "score": 0, "creation_date": 1571221828, "post_id": 58411064, "comment_id": 103165627, "body": "I really don&#39;t know what is going wrong, again for some reason it will nto work when any cell in column W is changed to delivered"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 31, "user_id": 11186188, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156535419728218/picture?type=large", "display_name": "Lawrence Forster", "link": "https://stackoverflow.com/users/11186188/lawrence-forster"}, "edited": false, "score": 0, "creation_date": 1571222139, "post_id": 58411064, "comment_id": 103165778, "body": "Works for me. Is the code definitely in the correct sheet module? Screenshot added."}, {"owner": {"reputation": 31, "user_id": 11186188, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156535419728218/picture?type=large", "display_name": "Lawrence Forster", "link": "https://stackoverflow.com/users/11186188/lawrence-forster"}, "edited": false, "score": 0, "creation_date": 1571223102, "post_id": 58411064, "comment_id": 103166284, "body": "Yes ive checked everything its in SUb tasks"}, {"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1571223144, "post_id": 58411064, "comment_id": 103166305, "body": "+1 for the comment that VBA is not even needed for doing this. Maybe it&#39;s a good idea to add a screenshot of the conditional formatting formula(s)."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571223242, "post_id": 58411064, "comment_id": 103166350, "body": "Go to the immediate window, Ctrl+G, and type <code>application.enableevents=true</code> and then see if it works. Make sure X is definitely blank and check the value of &#39;lastrow&#39;."}, {"owner": {"reputation": 31, "user_id": 11186188, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156535419728218/picture?type=large", "display_name": "Lawrence Forster", "link": "https://stackoverflow.com/users/11186188/lawrence-forster"}, "edited": false, "score": 0, "creation_date": 1571223379, "post_id": 58411064, "comment_id": 103166443, "body": "That worked, how did they become turned off? I didnt even know that existed"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571225240, "post_id": 58411064, "comment_id": 103167445, "body": "Sometimes it gets turned off in code and if you exit the procedure without proper error handling it doesn&#39;t get turned back on."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1571222187, "last_edit_date": 1571222187, "creation_date": 1571221408, "answer_id": 58411064, "question_id": 58410808, "link": "https://stackoverflow.com/questions/58410808/looping-through-cells-to-identify-if-data-validation-list-selected/58411064#58411064", "title": "Looping through cells to identify if Data validation list selected", "body": "<p>I don't see a need for the second sub (but have left in in case you want to retain for other purposes, though you should add a range argument).</p>\n\n<p>Check the intersection between <code>Target</code> and column W and then only run the code if there is something (plenty on this online).</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim Lastrow As Long, cell As Range\nLastrow = Sheets(\"Sub Tasks\").Range(\"W\" &amp; Rows.Count).End(xlUp).Row\n\nIf Not Intersect(Target, Range(\"W4:W\" &amp; Lastrow)) Is Nothing Then\n    For Each cell In Intersect(Target, Range(\"W4:W\" &amp; Lastrow))\n        If cell.Value = \"Delivered\" And cell.Offset(0, 1).Value = vbNullString Then\n            cell.Offset(0, 1).Interior.Color = vbRed\n            'ConditionalFormatSharepointDeliveryLink\n        End If\n    Next cell\nEnd If\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Note that you could do all this using conditional formatting.</p>\n\n<p><a href=\"https://i.stack.imgur.com/RCgYx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RCgYx.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 31, "user_id": 11186188, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156535419728218/picture?type=large", "display_name": "Lawrence Forster", "link": "https://stackoverflow.com/users/11186188/lawrence-forster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 58411064, "answer_count": 2, "score": 0, "last_activity_date": 1571222979, "creation_date": 1571220550, "last_edit_date": 1571222979, "question_id": 58410808, "link": "https://stackoverflow.com/questions/58410808/looping-through-cells-to-identify-if-data-validation-list-selected", "title": "Looping through cells to identify if Data validation list selected", "body": "<p>I have a macro that changes the colour of the cell (Offset(0,1)) if the cell to the left says delivered and the offset cell is blank. The macro is triggered by a change in the data validation list. See below. However, the code doesn't do as i want. It doesn't run every time the data validation list is selceted. I want this to run every time a data validation option is changed within Column W. (Validation list applies to all cells in column W).</p>\n\n<p>The code works but its the way I am running the macro within a worksheet change. </p>\n\n<p>The macro itself </p>\n\n<pre><code>Sub ConditionalFormatSharepointDeliveryLink()\n\nDim Lastrow As Long, n As Long, cell As Range, ws As Worksheet\nLastrow = Sheets(\"Sub Tasks\").Range(\"W\" &amp; Rows.Count).End(xlUp).Row\n\nn = 4\n\n    For Each cell In Worksheets(\"Sub Tasks\").Range(\"W4:W\" &amp; Lastrow)\n        If cell.value = \"Delivered\" And cell.Offset(0, 1).value = \"\" Then\n            cell.Offset(0, 1).Interior.Color = vbRed\n        End If\n    n = n + 1\n    Next cell\n\nEnd Sub\n</code></pre>\n\n<p><strong>How i am calling the macro</strong></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n\nDim Lastrow As Long, n As Long, cell As Range, ws As Worksheet\nLastrow = Sheets(\"Sub Tasks\").Range(\"W\" &amp; Rows.Count).End(xlUp).Row\n\nFor Each cell In Worksheets(\"Sub Tasks\").Range(\"W4:4\" &amp; Lastrow)\n    If Target.Address(True, True) = cell Then\n        Select Case Target\n            Case \"Delivered\"\n                Call ConditionalFormatSharepointDeliveryLink\n        End Select\n    End If\n\nEnd Sub\n``````````````````````````` \n\n\n\n\n[![enter image description here][1]][1]\n\n\n  [1]: https://i.stack.imgur.com/BJzZB.png\n</code></pre>\n"}, {"tags": ["excel", "vba", "range", "max", "array-formulas"], "answers": [{"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1571219335, "post_id": 58410255, "comment_id": 103164352, "body": "@sifar, the code I have put up works for me. About your edit, you just needed to omit the last parameter within the <code>AGGREGATE</code>"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 4, "last_activity_date": 1571219694, "last_edit_date": 1571219694, "creation_date": 1571218719, "answer_id": 58410255, "question_id": 58410083, "link": "https://stackoverflow.com/questions/58410083/find-max-in-column-range-ignoring-error-values-using-evaluate-syntax/58410255#58410255", "title": "Find MAX in Column Range ignoring Error values using Evaluate Syntax", "body": "<p>Try this:</p>\n\n<pre><code>Sub GetMax()\n\nDim rng As Range, lr As Long\nWith Sheet1 'Change accordingly\n    lr = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    Set rng = .Range(\"A1:B\" &amp; lr)\n    If Application.Aggregate(4, 6, rng.columns(2)) &gt; 0 Then\n        Debug.Print \"Max is higher than 0\"\n    Else\n        Debug.Print \"Max is not higher than 0\"\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>If you want to use <code>.Evaluate</code> you can change this line: <code>If Application.Aggregate(4, 6, rng.columns(2)) &gt; 0 Then</code>, for this: <code>If .Evaluate(\"AGGREGATE(4,6,\" &amp; rng.Columns(2).Address &amp; \")\") &gt; 0 Then</code></p>\n\n<p>The reason this works is that we can utilize <code>MAX</code> within the <a href=\"https://support.office.com/en-us/article/aggregate-function-43b9278e-6aa7-4f17-92b6-e19993fa26df\" rel=\"nofollow noreferrer\"><code>AGGREGATE</code></a> function and tell it to ignore error values.</p>\n\n<hr>\n\n<p><strong><em>Why did your attempts not succeed:</em></strong></p>\n\n<p>The reason your attempt with <code>[]</code> failed is because you cannot use these brackets to evaluate a formula with variables. You'll need to actually use <code>Application.Evaluate</code>. Secondly, you'll need to feed the formula the actual address. I've implemented the <code>.Evaluate</code> version in my answer above.</p>\n\n<p>The reason your attempt with <code>AGGREGATE</code> raised an error is because you needed to omit the last parameter within the <code>MAX</code> function of <code>AGGREGATE</code>. If you would try it on a worksheet, it would also raise a <code>#VALUE</code> error. You simply don't need to input a index number since <code>MAX</code>, as the name suggests, returns just one value.</p>\n"}, {"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 2, "creation_date": 1571223405, "post_id": 58411121, "comment_id": 103166463, "body": "You just need a dot <code>.</code> in front of <code>Evaluate</code> in case another sheet has been selected when you run your code :)"}], "tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 2, "last_activity_date": 1571225217, "last_edit_date": 1571225217, "creation_date": 1571221559, "answer_id": 58411121, "question_id": 58410083, "link": "https://stackoverflow.com/questions/58410083/find-max-in-column-range-ignoring-error-values-using-evaluate-syntax/58411121#58411121", "title": "Find MAX in Column Range ignoring Error values using Evaluate Syntax", "body": "<p>for those who have old ms excel version (&lt;2010) that not supports <code>AGGREGATE</code> worksheetfunction:</p>\n\n<pre><code>Sub GetMax_oldstyle()\n    Dim rng$, lr As Long\n    With Sheet1 'Change accordingly\n        lr = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        rng = .Range(\"A1:B\" &amp; lr).Columns(2).Address(0, 0)\n        If .Evaluate(\"MAX(IF(NOT(ISNA(\" &amp; rng &amp; \")),\" &amp; rng &amp; \"))\") &gt; 0 Then\n            Debug.Print \"Max is higher than 0\"\n        Else\n            Debug.Print \"Max is not higher than 0\"\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>test:</p>\n\n<p><a href=\"https://i.stack.imgur.com/V4kuA.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/V4kuA.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 1, "accepted_answer_id": 58410255, "answer_count": 2, "score": 2, "last_activity_date": 1571225217, "creation_date": 1571218161, "last_edit_date": 1571219027, "question_id": 58410083, "link": "https://stackoverflow.com/questions/58410083/find-max-in-column-range-ignoring-error-values-using-evaluate-syntax", "title": "Find MAX in Column Range ignoring Error values using Evaluate Syntax", "body": "<p>I have defined a range called <strong><code>Rng</code></strong>. The <code>Columns(2)</code> of <code>Rng</code> contains numbers and #N/A error values. I want to find the MAX value in this column and then compare if it is <code>&gt;0</code>.</p>\n\n<pre><code>Col A    Col B\n--------------\nansdlsd  1\nsdlsds   1\nlgdfkf   2\nfdlksd   2\nsdlsdks  3\nsds sds  5\nsdlkjq   #N/A\neowmf    #N/A\npwpwo    #N/A\nqwdds    #N/A\nospw     #N/A\ndlsls    #N/A\nqpdmf    #N/A\n</code></pre>\n\n<p>I tried using the shorthand syntax for <code>Application.Evaluate</code> i.e. <code>[]</code>, but the code returns a Type Mismatch Error 13 - (Error 2029 in Watch Window).</p>\n\n<pre><code>If [MAX(IF(NOT(ISNA(Rng.Columns(2))),Rng.Columns(2)))] &gt; 0 Then\n    do something...\nEnd If\n</code></pre>\n\n<p>I also tried :</p>\n\n<pre><code>If Application.Aggregate(4, 6, Rng.Columns(2), 1) &gt; 0 Then...\n</code></pre>\n\n<p>got error <code>: Error 2015 : Variant/Error</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/x17LU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x17LU.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am able to get the MAX using the Excel <code>Array Formula (Ctrl+Shft+Entr)</code> in a worksheet:</p>\n\n<pre><code>{=MAX(IF(NOT(ISNA(B2:B14)),B2:B14))}\n</code></pre>\n\n<p>I suppose it has to do with the <code>Rng.Columns(2)</code> not being evaluated correctly by the <code>[]</code> brackets.</p>\n\n<p>Or is something else the cause of this error?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1571218000, "post_id": 58409993, "comment_id": 103163580, "body": "Please don&#39;t shout."}, {"owner": {"reputation": 39, "user_id": 11992864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e7c4419440df1f1643ac3e7c9e3499d?s=128&d=identicon&r=PG&f=1", "display_name": "firmphem", "link": "https://stackoverflow.com/users/11992864/firmphem"}, "reply_to_user": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1571218135, "post_id": 58409993, "comment_id": 103163684, "body": "I dont understand what you meant by this"}, {"owner": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1571218215, "post_id": 58409993, "comment_id": 103163733, "body": "Your initial heading was all in caps - I&#39;ve switched the case."}, {"owner": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 1, "creation_date": 1571218260, "post_id": 58409993, "comment_id": 103163757, "body": "Have you tried looking at the field&#39;s properties in the table design?"}, {"owner": {"reputation": 39, "user_id": 11992864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e7c4419440df1f1643ac3e7c9e3499d?s=128&d=identicon&r=PG&f=1", "display_name": "firmphem", "link": "https://stackoverflow.com/users/11992864/firmphem"}, "reply_to_user": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1571220772, "post_id": 58409993, "comment_id": 103165124, "body": "Yes, I changed the fields&#39; properties to required. but while testing, i intentionally left one of the fields blank and i got a prompt that asked if I wanted to close the atabase object anyway, then  i selected no but it brought another propmt with a header &#39;Macro single step&#39; , i could close it and add the required field but i dont want this propmt as it could confuse the the user who doesnt know anything about access"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 11992864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e7c4419440df1f1643ac3e7c9e3499d?s=128&d=identicon&r=PG&f=1", "display_name": "firmphem", "link": "https://stackoverflow.com/users/11992864/firmphem"}, "edited": false, "score": 0, "creation_date": 1571221620, "post_id": 58410606, "comment_id": 103165529, "body": "it showed the message but if i then click ok, it still brought the propmt you &quot;you cant save at this time&quot;. for me its not a problem and I can do it. I am only worried for the inexperienced users"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 39, "user_id": 11992864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e7c4419440df1f1643ac3e7c9e3499d?s=128&d=identicon&r=PG&f=1", "display_name": "firmphem", "link": "https://stackoverflow.com/users/11992864/firmphem"}, "edited": false, "score": 0, "creation_date": 1571232470, "post_id": 58410606, "comment_id": 103171795, "body": "It depends on the context. You may have to use the <code>BeforeUpdate</code> event of each field instead. <code>Me.Undo</code> and/or <code>Me.CancelEvent</code> may be used, but if a field is required, that kicks in first."}, {"owner": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "reply_to_user": {"reputation": 39, "user_id": 11992864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e7c4419440df1f1643ac3e7c9e3499d?s=128&d=identicon&r=PG&f=1", "display_name": "firmphem", "link": "https://stackoverflow.com/users/11992864/firmphem"}, "edited": false, "score": 0, "creation_date": 1571297008, "post_id": 58410606, "comment_id": 103195342, "body": "@firmphem - Have you <a href=\"https://support.office.com/en-gb/article/turn-delete-object-and-action-query-confirmation-messages-on-or-off-e58e4bba-9d54-4b9d-b962-9eca048e5335\" rel=\"nofollow noreferrer\">turned off the prompts for action queries</a> in the settings?"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1571219894, "creation_date": 1571219894, "answer_id": 58410606, "question_id": 58409993, "link": "https://stackoverflow.com/questions/58409993/how-to-make-a-field-compulsory-to-fill-before-a-record-can-be-saved-in-a-bound-f/58410606#58410606", "title": "How to make a field compulsory to fill before a record can be saved in a bound form", "body": "<p>Use the <em>BeforeUpdate</em> event of the form:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Cancel = IsNull(Me!SomeField.Value) Or IsNull(Me!SomeOtherField.Value)\n\nIf Cancel = True Then\n    MsgBox \"Please fill in all required values.\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 11992864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e7c4419440df1f1643ac3e7c9e3499d?s=128&d=identicon&r=PG&f=1", "display_name": "firmphem", "link": "https://stackoverflow.com/users/11992864/firmphem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1594421312, "creation_date": 1571217866, "last_edit_date": 1594421312, "question_id": 58409993, "link": "https://stackoverflow.com/questions/58409993/how-to-make-a-field-compulsory-to-fill-before-a-record-can-be-saved-in-a-bound-f", "title": "How to make a field compulsory to fill before a record can be saved in a bound form", "body": "<p>I have a bound form that adds to an exisitng record when the fields are filled but there are two fields that are very important to be filled.  I want the form to prompt the user to fill those fields before they can be saved if left blank. I can definitely do this in unbound form but I dont know how to implement it in a bound form .</p>\n\n<p>Any input would be greately appreciated</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 12225476, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA5coBycbO1e7gM3KIQpZLWiPhdAyj6IOldqJgG=k-s128", "display_name": "Ethan Taylor", "link": "https://stackoverflow.com/users/12225476/ethan-taylor"}, "edited": false, "score": 0, "creation_date": 1571220900, "post_id": 58410013, "comment_id": 103165185, "body": "thanks for the help. I get what you mean it definitely helped out there."}], "tags": [], "owner": {"reputation": 11, "user_id": 12222547, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2mJkffeyYe0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rde568NRdvFCNNWohdNGutB2Cc8hA/photo.jpg?sz=128", "display_name": "Tom Lee", "link": "https://stackoverflow.com/users/12222547/tom-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1571229028, "last_edit_date": 1571229028, "creation_date": 1571217940, "answer_id": 58410013, "question_id": 58409935, "link": "https://stackoverflow.com/questions/58409935/if-elseif-for-three-option-buttons/58410013#58410013", "title": "If ElseIf for three Option Buttons", "body": "<p>Why can't you just write three separate <code>IF</code> statements. Hardly the most elegant solution, but it'd work</p>\n\n<p>OR</p>\n\n<pre><code>   If button1= true then,\n   Do this,\n   Else,\n   If button2 = true then,\n   Do this,\n   Else,\n   If button2 = true then,\n   Do this,\n   End if,\n   End if,\n   End if,\n</code></pre>\n\n<p>Sorry for the poor format, on mobile can't make it look like code. New line everywhere theres a comma</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 12225476, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA5coBycbO1e7gM3KIQpZLWiPhdAyj6IOldqJgG=k-s128", "display_name": "Ethan Taylor", "link": "https://stackoverflow.com/users/12225476/ethan-taylor"}, "edited": false, "score": 0, "creation_date": 1571220840, "post_id": 58410082, "comment_id": 103165158, "body": "Perfect this one worked a treat. managed to just get the data into a spreadsheet so we can see the results based on the options picked from the buttons. and for the Else I added a line to log out N/A if nothing was selected."}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 0, "last_activity_date": 1571218160, "creation_date": 1571218160, "answer_id": 58410082, "question_id": 58409935, "link": "https://stackoverflow.com/questions/58409935/if-elseif-for-three-option-buttons/58410082#58410082", "title": "If ElseIf for three Option Buttons", "body": "<p>When using <code>Elseif</code> that counts like a new <code>IF...Then</code> and you were missing the <code>Then</code> part.</p>\n\n<pre><code>If OPButton1.Value = True Then\n    ws.Range(\"G\" &amp; emptyRow).Value = OPButton1.Caption\nElseIf OPButton2.Value = True Then\n    ws.Range(\"G\" &amp; emptyRow).Value = OPButton2.Caption\nElseIf OPButton3.Value = True Then\n    ws.Range(\"G\" &amp; emptyRow).Value = OPButton3.Caption\nElse\n    'what do you want to do in this case?\nEnd If\n</code></pre>\n\n<p>Try it</p>\n"}], "owner": {"reputation": 5, "user_id": 12225476, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA5coBycbO1e7gM3KIQpZLWiPhdAyj6IOldqJgG=k-s128", "display_name": "Ethan Taylor", "link": "https://stackoverflow.com/users/12225476/ethan-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 58410082, "answer_count": 2, "score": 0, "last_activity_date": 1571273270, "creation_date": 1571217635, "last_edit_date": 1571273270, "question_id": 58409935, "link": "https://stackoverflow.com/questions/58409935/if-elseif-for-three-option-buttons", "title": "If ElseIf for three Option Buttons", "body": "<p>I can write the \"If\" \"Else\" statement when using 2 radio buttons, but when trying to convert this to an \"ElseIf\" statement with a 3rd button being added in the code doesn't work. </p>\n\n<p>I have tried google and YouTube and solution topics here and I can't find the answer I am after.</p>\n\n<pre><code>If OPButton1.Value = True Then\n    ws.Range(\"G\" &amp; emptyRow).Value = OPButton1.Caption\nElseIf \n    OPButton2.Value = True\n    ws.Range(\"G\" &amp; emptyRow).Value = OPButton2.Caption\nElse\n    OPButton3.Value = True\n    ws.Range(\"G\" &amp; emptyRow).Value = OPButton3.Caption\n\nEnd If\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "vba", "ms-access", "ado"], "answers": [{"comments": [{"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571218881, "post_id": 58409933, "comment_id": 103164118, "body": "Thank you @Gustav - this code is working however. If I change the code to <code>adDate</code> it still makes the recordset not updateable, I assume because it&#39;s just retrieving it one way rather than it being &#39;linked&#39;. Ultimately I&#39;m trying to populate it with data but retain the ability to manipulate the data in the table directly. Hope that&#39;s a little clearer!"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571219610, "post_id": 58409933, "comment_id": 103164480, "body": "As far as I know, a recordset retrieved from a stored procedure is always read-only. To update, use a pass-through query."}, {"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571219998, "post_id": 58409933, "comment_id": 103164686, "body": "Yes that&#39;s exactly what I&#39;m trying to achieve - do you mind showing me how my code could be turned into a pass-through query?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571220181, "post_id": 58409933, "comment_id": 103164795, "body": "Sorry, I don&#39;t use ADO. But lots of code out there; it should be snap to bing/google on the keywords."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1571217629, "creation_date": 1571217629, "answer_id": 58409933, "question_id": 58409734, "link": "https://stackoverflow.com/questions/58409734/how-can-i-create-an-updateable-recordsource-for-an-msaccess-subform-datasheet-wi/58409933#58409933", "title": "How can I create an updateable recordsource for an MSACCESS subform datasheet with a parameterised query or stored procedure in ADO?", "body": "<p>It seems like your field <em>ps_dateClaim</em> is not a timestamp but a <em>DateTime</em> field, so try with:</p>\n\n<pre><code>sp.Parameters.Append sp.CreateParameter(\"@wkEnd\", adDate, adParamInput, , wkEnd)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571836412, "post_id": 58412949, "comment_id": 103372363, "body": "Thanks for this response @ErikA - just to give context on the security side, this was put together purely for the example above and I chose the word [redacted] rather than [server_name] or something similar, but thank you.   Correct me if I&#39;m wrong, but the ADO side works in a similar fashion to above, but instead of the command type being a SP, it uses the query text provided in the VBA code. With that in mind, will it not retrieve the recordset in the sameway and make it non-updateable when I set the recordsource to the table as a &#39;one-way&#39; transaction?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571836767, "post_id": 58412949, "comment_id": 103372626, "body": "@RazorKillBen That highly depends on the query. ADO recordsets allow you to poll if the dataset is updatable (<code>recordset.Supports(adUpdate)</code>). As a rule of thumb, recordsets selecting data from multiple tables are not updateable when you use SQL server, but there are exceptions"}, {"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571838233, "post_id": 58412949, "comment_id": 103373499, "body": "the reason I ask is I have a static table no joins, that I&#39;m pulling in the way you mention in the ADO answer <a href=\"https://stackoverflow.com/questions/49509615/how-do-i-use-parameters-in-vba-in-the-different-contexts-in-microsoft-access/49509616#49509616\">here</a> although I can&#39;t seem to fully replicate it by naming the parameter in the query you have. The recordset remains updateable as it sees the fields that are bound to be &quot;based on expressions&quot; rather than field data."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571839171, "post_id": 58412949, "comment_id": 103374048, "body": "@RazorKillBen Can you either post a new question, or edit what you&#39;re currently trying into this question? Sounds odd to me."}, {"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571993653, "post_id": 58412949, "comment_id": 103429952, "body": "Thanks @ErikA - i&#39;ve posted a new question as I think I may have come from this at the wrong angle. For future readers the thread is <a href=\"https://stackoverflow.com/questions/58555243/how-can-i-parameterise-a-recordsource-query-to-ensure-the-data-remains-updateabl\">here</a>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571993987, "post_id": 58412949, "comment_id": 103430129, "body": "I&#39;m inclined to close that as a duplicate of the question I linked here. The <i>Using DAO</i> section outlines how to create a parameterized query. That should just work for you. Then, you can set the form recordset equal to your obtained recordset. If you have a specific attempt that somehow doesn&#39;t work, that&#39;d make a good new question. But now it looks like you didn&#39;t actually try."}, {"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571994153, "post_id": 58412949, "comment_id": 103430194, "body": "I think my question was misunderstood. Your linked answer is very helpful for retrieving data as read-only, but by using a <code>RecordSet</code> like all the answers specify, it instantly makes the query not updateable, which is what I am specifically trying to do. I believe I need to use the <code>RecordSource</code> property instead but this doesn&#39;t allow a recordset to be used with it."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571994231, "post_id": 58412949, "comment_id": 103430229, "body": "@RazorKillBen That&#39;s plain untrue. Recordsets are generally updateable when properly created. As said, please share an attempt that didn&#39;t work."}, {"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571996034, "post_id": 58412949, "comment_id": 103431153, "body": "I used the ADO example you&#39;ve given in your answer and by naming the parameter in the second example, it says &#39;Must declare the scalar variable @&lt;varname&gt;&#39; which I can&#39;t do as you rightly pointed out, ADO will not pass the named parameter. The code executes when using the <code>?</code> parameter name, but doesn&#39;t return any data when executing using the array command. I have updated my question with the failed example and commented out the failing parameter code also."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571996404, "post_id": 58412949, "comment_id": 103431324, "body": "If you want to join tables and keep the set updateable, you need to use the DAO example, though. SQL server doesn&#39;t do updateable joins, but if you process everything in Access it should be fine."}, {"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571996897, "post_id": 58412949, "comment_id": 103431556, "body": "there are no joins in the query. When the data is returned using the ADO method above that you provided in your answer, the dataset is not updateable as it says &quot;this field is based on an expression&quot; for every single field. I will try the DAO one now."}, {"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571997430, "post_id": 58412949, "comment_id": 103431832, "body": "same issue with the DAO I&#39;m afraid. The data pulls correctly, and ends up in the table correctly but can&#39;t be updated as it&#39;s based on an expression. I think as I mentioned in the second question, this may be to do with the <code>Recordset</code> property instead of using the <code>RecordSource</code> property."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571998015, "post_id": 58412949, "comment_id": 103432099, "body": "That sounds like you&#39;ve bound your fields in the wrong way (e.g. using <code>=Fieldname</code> instead of <code>FieldName</code> to bind it). Anyway, I&#39;ve edited in an updateable RS example, you need to define a few more details than you have now."}, {"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571998893, "post_id": 58412949, "comment_id": 103432533, "body": "thanks, so to give some more context, the <code>RecordSource</code> of the form is set to return a default query and the fields are bound correctly (not as &#39;=fieldname&#39;). The recordset returns the same fields and therefore when set as the RecordSource, pick up just fine. The issue seems to be using a Recordset instead as that seems to make the data almost &#39;read-only&#39; by nature. I&#39;m keen to resolve this, so if you can let me know what I need to do/try or provide, I&#39;ll happily do so."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571999207, "post_id": 58412949, "comment_id": 103432702, "body": "Well, I&#39;d need to be able to reproduce the issue. I know for a fact I&#39;ve got similar code in one of my databases that has produced editable forms for years, filtering on a primary key and using an ADO query, so that can&#39;t be it. You can try the setup I outlined <a href=\"https://stackoverflow.com/a/52763115/7296893\">here</a> to easily display recordsets on a standardized form, to make sure it&#39;s an issue with the recordset, not the form. You&#39;re setting your cursor location on the connection to <code>adUseClient</code>, right, btw?"}, {"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571999753, "post_id": 58412949, "comment_id": 103432937, "body": "Progress! The good news is, I&#39;ve managed to do this successfully using the DAO.QueryDef answer you posted in your first response &quot;Using DAO&quot;. Thank you for this. However as this project is ADO mainly, it&#39;d be useful to have this working for ADO, and I cannot seem to do this using ADO in anyway - once the Recordset is applied it simply constantly recognises every field as an expression. I have edited my original question to show the two examples I used that do not work - are you able to see this? Yes the cursor location is set to <code>db.CursorLocation = adUseClient</code>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1571999880, "post_id": 58412949, "comment_id": 103432996, "body": "@RazorKillBen I did see your examples, and have revised one of them in my answer (some comments ago). You should try that one."}, {"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "edited": false, "score": 0, "creation_date": 1572000663, "post_id": 58412949, "comment_id": 103433373, "body": "Thanks @ErikA - so when using the <code>WHERE t.TeamName = @tmName</code> SQL code, it fails as it says I must declare the scalar variable @tmName. However! Amended the <code>.CommandText</code> to <code>WHERE t.TeamName = ?</code> and then doing this, does indeed work, and has returned an updateable recordset! I think another key spot you made here, was that the Recordset does need to be opened rather than executed, which seemingly has resolved the updateable issue also. Thank you so much, and I do genuinely appreciate you giving your time to get this over the line. If you want to edit the code to the <code>?</code> instead I&#39;ll accept"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 3, "last_activity_date": 1572001696, "last_edit_date": 1572001696, "creation_date": 1571227661, "answer_id": 58412949, "question_id": 58409734, "link": "https://stackoverflow.com/questions/58409734/how-can-i-create-an-updateable-recordsource-for-an-msaccess-subform-datasheet-wi/58412949#58412949", "title": "How can I create an updateable recordsource for an MSACCESS subform datasheet with a parameterised query or stored procedure in ADO?", "body": "<p>You can't. Recordsets returned from stored procedures are not updateable.</p>\n\n<p>Of course, you can use a parameterized query using DAO if you want it to be updateable.</p>\n\n<p>For how to create parameterized queries, see <a href=\"https://stackoverflow.com/a/49509616/7296893\">this answer</a>, the <em>Using DAO</em> section. Note that I strongly warn against it, the last time I used that Access had some bugs in handling filters/sorts on parameterized queries.</p>\n\n<p>You can also check the <em>Using ADO</em> section for how to do this via a passthrough query.</p>\n\n<p>Note that obfuscating your SQL server address is futile (can trivially be discovered using internet traffic analysis tools), and since you appear to not use encrypted connections, your current obfuscation of other parameters is trivially worked around too. This might be enough to ward off curious users not experienced in SQL server security, but is by no means true security.</p>\n\n<p>For an updateable ADO recordset:</p>\n\n<pre><code>With sp\n    Set .ActiveConnection = db\n    .CommandText = \" SELECT t.Date, t.TeamName, t.Reference, t.Status, t.Reason, t.Checked \" &amp; _\n                    \" FROM testTbl as t\" &amp; _\n                    \" WHERE t.TeamName = ?\"\n        .Parameters.Append .CreateParameter(, adVarChar, adParamInput, 4, tm)\n    Dim rs AS ADODB.Recordset\n    Set rs = New ADODB.Recordset\n    rs.CursorLocation = adUseClient\n    rs.Open sp, , adOpenDynamic, adLockOptimistic\nEnd Wit\n</code></pre>\n"}], "owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 58412949, "answer_count": 2, "score": 0, "last_activity_date": 1572001696, "creation_date": 1571217012, "last_edit_date": 1572000108, "question_id": 58409734, "link": "https://stackoverflow.com/questions/58409734/how-can-i-create-an-updateable-recordsource-for-an-msaccess-subform-datasheet-wi", "title": "How can I create an updateable recordsource for an MSACCESS subform datasheet with a parameterised query or stored procedure in ADO?", "body": "<p>I have a subform set to the datasheet view, that I am trying to update with data from SQL Server, based on parameters specified by the users selection.</p>\n\n<p>I usually achieve this with stored procedures and have the VBA call them through ADO, but this data is different in that the RecordSource needs to be able to be amended/edited directly within the data table.</p>\n\n<p>I have a data table that I currently use to display data and this uses the below code:</p>\n\n<pre><code>Dim db As ADODB.Connection\nDim rs As ADODB.Recordset\nDim sp As ADODB.Command\n\nSet db = New ADODB.Connection\nSet rs = New ADODB.Recordset\nSet sp = New ADODB.Command\nSet ps = frmName\n    db.Open dbString\n    db.CursorLocation = adUseClient\n\n    With sp\n        .ActiveConnection = db\n        .CommandText = \"x04_ch_sl_ptsTable\"\n        .CommandType = adCmdStoredProc\n        .Parameters.Append sp.CreateParameter(\"@tmName\", adVarChar, adParamInput, 4, tmName)\n    End With\n\n    sp.Parameters.Append sp.CreateParameter(\"@wkEnd\", adDBTimeStamp, adParamInput, , wkEnd)\n        Set rs = sp.Execute\n        Set ps.subFormDataViewer.Form.Recordset = rs\n        Exit Sub\n    End If\ndb.Close\n</code></pre>\n\n<p>Can this be amended to make the dataset updateable?</p>\n\n<p>This is so far the only way I have been able to achieve what I want to do, but due to the majorly obvious security and injection issues, I do not want to go down this route:</p>\n\n<pre><code>ps.subFormDataViewer.Form.RecordSource = \" SELECT p.ps_dateClaim as [Date], p.ps_id as [ID], p.ps_empid as [Employee ID], e.hc_fullName as [Employee], p.ps_pts as [Claimed] \" &amp; _\n                                            \" FROM (([ODBC;DRIVER=SQL Server;SERVER=&lt;REDACTED&gt;;Integrated_Security=SSPI;DATABASE=&lt;REDACTED&gt;].prod_pts as p \" &amp; _\n                                            \" INNER JOIN [ODBC;DRIVER=SQL Server;SERVER=&lt;REDACTED&gt;;Integrated_Security=SSPI;DATABASE=&lt;REDACTED&gt;].hc_employee as e \" &amp; _\n                                                \" ON p.ps_empid = e.hc_empid) \" &amp; _\n                                            \" WHERE (p.ps_dateClaim = #\" &amp; wkEnd &amp; \"#\" &amp; _\n                                                \" AND (e.hc_teamName = '\" &amp; tmName &amp; \"'); \"\n</code></pre>\n\n<p>I have tried the following ADO methods with no success:</p>\n\n<pre><code>    With sp\n        Set .ActiveConnection = db\n        .CommandText = \" SELECT t.Date, t.TeamName, t.Reference, t.Status, t.Reason, t.Checked \" &amp; _\n                        \" FROM testTbl as t\" &amp; _\n                        \" WHERE t.TeamName = @tmName \"\n            .Parameters.Append .CreateParameter(, adVarChar, adParamInput, 4, tm)\n        Set rs = .Execute\n    End With\n</code></pre>\n\n<pre><code>    With sp\n        Set .ActiveConnection = db\n        .CommandText = \" SELECT t.Date, t.TeamName, t.Reference, t.Status, t.Reason, t.Checked \" &amp; _\n                        \" FROM testTbl as t\" &amp; _\n                        \" WHERE t.TeamName = ? \"\n        Set rs = .Execute(, Array(tm))\n    End With\n</code></pre>\n\n<p>(the 2nd example does produce data, but the recordset is not updateable as it recognises each field as an \"expression\")</p>\n\n<p>I have been able to achieve this with DAO:</p>\n\n<pre><code>Dim db as DAO.Database\nDim rs as DAO.Recordset\nDim qd as DAO.QueryDef\nDim dbSQL as string\n\ndbSQL = \" SELECT t.Date, t.TeamName, t.Reference, t.Status, t.Reason, t.Checked \" &amp; _\n                        \" FROM testTbl as t\" &amp; _\n                        \" WHERE t.TeamName = tmName1 \"\nSet qd = db.CreateQueryDef(\"\", dbSQL)\n\nWith qd\n    .Parameters!tmName1 = tm\nEnd With\n\nSet rs = qd.OpenRecordset\nSet ps.subFormDataViewer.Form.Recordset = rs\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 11803960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cnA-kxndNIU/AAAAAAAAAAI/AAAAAAAAACY/kSkSCzxTxmk/photo.jpg?sz=128", "display_name": "Fabian Breuer", "link": "https://stackoverflow.com/users/11803960/fabian-breuer"}, "edited": false, "score": 0, "creation_date": 1571216559, "post_id": 58409529, "comment_id": 103162821, "body": "Hey Martin, there comes the error message argument type ByRef incompatible"}, {"owner": {"reputation": 39, "user_id": 11803960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cnA-kxndNIU/AAAAAAAAAAI/AAAAAAAAACY/kSkSCzxTxmk/photo.jpg?sz=128", "display_name": "Fabian Breuer", "link": "https://stackoverflow.com/users/11803960/fabian-breuer"}, "edited": false, "score": 0, "creation_date": 1571216690, "post_id": 58409529, "comment_id": 103162890, "body": "I found the solution, my delay was declared as a Long and my randomdelay as an Integer"}], "tags": [], "owner": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "is_accepted": true, "score": 1, "last_activity_date": 1571216349, "creation_date": 1571216349, "answer_id": 58409529, "question_id": 58409422, "link": "https://stackoverflow.com/questions/58409422/why-does-passing-a-parameter-generate-error-argumenttype-byref/58409529#58409529", "title": "Why does passing a parameter generate error argumenttype ByRef?", "body": "<p>Assuming that you are looking to replace the 15 in the following with a value in the range 300 - 480:</p>\n\n<pre><code>Call Pause(15)\n</code></pre>\n\n<p>This should become:</p>\n\n<pre><code>Dim PauseDelay As Integer\nPauseDelay = Int((480 - 300 + 1) * Rnd + 300) ' Stores the random interval between 300-480\nCall Pause(PauseDelay) ' Calls Pause with the random interval\n</code></pre>\n\n<p>Is there something I am overlooking?  This code looks straight-forward and you already seem to have the answer</p>\n"}], "owner": {"reputation": 39, "user_id": 11803960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cnA-kxndNIU/AAAAAAAAAAI/AAAAAAAAACY/kSkSCzxTxmk/photo.jpg?sz=128", "display_name": "Fabian Breuer", "link": "https://stackoverflow.com/users/11803960/fabian-breuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 58409529, "answer_count": 1, "score": 0, "last_activity_date": 1571245196, "creation_date": 1571216054, "last_edit_date": 1571245196, "question_id": 58409422, "link": "https://stackoverflow.com/questions/58409422/why-does-passing-a-parameter-generate-error-argumenttype-byref", "title": "Why does passing a parameter generate error argumenttype ByRef?", "body": "<p>I code a delay for mail merge in VBA.<br>\nI have never worked with VBA before.</p>\n\n<p>Mail merge works fine. Now I would like to enter a random number instead of a fixed delay in <code>Call Pause(15)</code>.</p>\n\n<pre><code>Sub Letter_EN()\n' Merges one record at a time to email with a pre-defined delay between messages.\n' Sourced from: https://www.msofficeforums.com/mail-merge/38282-email-merge-delay.html\n\nIf MsgBox(\"Wirklich an Company_EN senden?\", vbYesNo, \"Senden\") &lt;&gt; vbYes Then Exit Sub\nApplication.ScreenUpdating = False\nDim i As Long\nWith ActiveDocument\n  For i = 1 To .MailMerge.DataSource.RecordCount\n    With .MailMerge\n      .Destination = wdSendToEmail\n      .MailSubject = \"Company wishes you a merry Christmas!\"\n      .MailFormat = wdMailFormatHTML\n      .MailAddressFieldName = \"EMAIL\"\n      .SuppressBlankLines = True\n\n      With .DataSource\n        .FirstRecord = i\n        .LastRecord = i\n        .ActiveRecord = i\n      End With\n      .Execute Pause:=False\n    End With\n    Call Pause(15)\n  Next i\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n\nPublic Function Pause(Delay As Long)\nDim Start As Long\nStart = Timer\nIf Start + Delay &gt; 86399 Then\n  Start = 0: Delay = (Start + Delay) Mod 86400\n  Do While Timer &gt; 1\n    DoEvents ' Yield to other processes.\n  Loop\nEnd If\nDo While Timer &lt; Start + Delay\n  DoEvents ' Yield to other processes.\nLoop\nEnd Function\n</code></pre>\n\n<p>I know that the formula for a random number between 300 - 480 seconds is:</p>\n\n<pre><code>Dim MyValue As Integer\nzahl= Int((480 - 300 + 1) * Rnd + 300)\n</code></pre>\n\n<p>However, if I insert instead of the 15 - MyValue the error argumenttype ByRef comes</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1571218160, "post_id": 58409393, "comment_id": 103163699, "body": "Try to imagine that you reach your last cell on column B. Your code is adding <code>&quot;TODAY()&quot;</code> before it checks, so when you check if both are empty, column AJ will have today value. Use a For.. Next loop better."}], "answers": [{"tags": [], "owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "is_accepted": false, "score": 0, "last_activity_date": 1571218543, "creation_date": 1571218543, "answer_id": 58410201, "question_id": 58409393, "link": "https://stackoverflow.com/questions/58409393/how-to-loop-until-both-columns-have-an-empty-cell/58410201#58410201", "title": "How to loop until both columns have an empty cell?", "body": "<p>Try this one:</p>\n\n<pre><code>Sub DateStomper()\nDim i as Long\n\nApplication.ScreenUpdating = False\n\nFor i=2 to Range(\"B2\").End(xlDown).Offset(1, 0).Row\n    Range(\"AJ\" &amp; i).Formula = \"=TODAY()\"\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Just check if the formula is applied in the correct position. It is not clear for me if you need to apply in AJ2 -> AJ<code>Last Item + 1</code>.</p>\n\n<p>Hope it helps</p>\n"}, {"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1571222025, "creation_date": 1571222025, "answer_id": 58411253, "question_id": 58409393, "link": "https://stackoverflow.com/questions/58409393/how-to-loop-until-both-columns-have-an-empty-cell/58411253#58411253", "title": "How to loop until both columns have an empty cell?", "body": "<p>Another approach. You can enter the formula without a loop, and using <code>xldown</code> is dubious in case you have nothing else in B.</p>\n\n<pre><code>Sub x()\n\nDim r As Long\n\nOn Error Resume Next 'in case there are no blanks\nr = Range(\"B2\", Range(\"B\" &amp; Rows.Count).End(xlUp)).SpecialCells(xlCellTypeBlanks)(1).Row\nOn Error GoTo 0\n\nIf r &gt; 0 Then\n    Range(\"AJ2:AJ\" &amp; r - 1).Formula = \"=TODAY()\"\nElse\n    MsgBox \"No blanks in B\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 58411253, "answer_count": 2, "score": 0, "last_activity_date": 1571286437, "creation_date": 1571215971, "last_edit_date": 1571286437, "question_id": 58409393, "link": "https://stackoverflow.com/questions/58409393/how-to-loop-until-both-columns-have-an-empty-cell", "title": "How to loop until both columns have an empty cell?", "body": "<p>Below code should fill column AJ with the =TODAY() formula, until it hits a empty cell in column B.</p>\n\n<p>Works when there are empty cells in AJ (in comparison to B), but when AJ is filled it keeps looping, and stamps in dates in unneccesary rows in AJ (after B is empty).</p>\n\n<p>My thought was to build an exemption that checks beforehand if the last Row of AJ and B are both empty, if this is true, then skip the loop, but haven't been able to get something off the ground.</p>\n\n<pre><code>Sub DateStomper()\n\nDo\n    Application.ScreenUpdating = False\n    Worksheets(\"xxx\").Select\n    Range(\"AJ2\").End(xlDown).Offset(1, 0).Select\n    ActiveCell.FormulaR1C1 = \"=TODAY()\"\nLoop Until Range(\"AJ2\").End(xlDown).Offset(1, 0).Row = Range(\"B2\").End(xlDown).Offset(1, 0).Row\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "xcode"], "comments": [{"owner": {"reputation": 41, "user_id": 4633011, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152789357188576/picture?type=large", "display_name": "Tomas Joe Gemine", "link": "https://stackoverflow.com/users/4633011/tomas-joe-gemine"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1571234183, "post_id": 58409327, "comment_id": 103172912, "body": "thats cool, i have no formal training/background with VBA have been doing a bunch of research on it, but everything was signposting me to a formula as opposed to VBA so i was just seeing if it was going to be a possibility before plugging some hours in."}, {"owner": {"reputation": 41, "user_id": 4633011, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152789357188576/picture?type=large", "display_name": "Tomas Joe Gemine", "link": "https://stackoverflow.com/users/4633011/tomas-joe-gemine"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1571234254, "post_id": 58409327, "comment_id": 103172970, "body": "i was also going to do 2 seperate codes (eventually) one for the prepopulation of cell and then another for the email. i just wanted to one before the other sort of thing..."}], "owner": {"reputation": 41, "user_id": 4633011, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152789357188576/picture?type=large", "display_name": "Tomas Joe Gemine", "link": "https://stackoverflow.com/users/4633011/tomas-joe-gemine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573681065, "creation_date": 1571215801, "last_edit_date": 1573681065, "question_id": 58409327, "link": "https://stackoverflow.com/questions/58409327/is-it-possible-for-excel-to-automatically-put-a-value-in-a-cell-a2-when-a-cell", "title": "Is it possible for Excel to automatically put a value in a cell (A2) when a cell (A1) is selected/typed in?", "body": "<p>I have a sheet that user complete once they have arranged for a document to be rescanned. </p>\n\n<p>I intend on writing some code to send some automatic email reminders. </p>\n\n<p>However what I want to happen at this stage is once someone types their name in Column A(#) i want the corresponding cell in column M (actioned) to prepopulate as a \"NO\". </p>\n\n<p>I have searched online and there are a lot of suggestions for the IF Formula however this wont work for my sheet as when the Agent has completed their work I want column M (actioned?) to be changed to \"Yes\". Therefore the macro that I'll look towards writing will no longer send an email reminder to them.</p>\n"}, {"tags": ["sql", "excel", "vba", "connection"], "comments": [{"owner": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 0, "creation_date": 1571214720, "post_id": 58408918, "comment_id": 103161770, "body": "Why are you using a named user with <code>Integrated Security</code>?  Use one or the other"}, {"owner": {"reputation": 11, "user_id": 11945114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7199edc171602ff511e519153917d576?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/11945114/nick"}, "reply_to_user": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 0, "creation_date": 1571215102, "post_id": 58408918, "comment_id": 103162002, "body": "Honestly i dont know... removing integrated Security made it work. Thanks :)"}], "answers": [{"tags": [], "owner": {"reputation": 305, "user_id": 10785732, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RIiEj6LHpXQ/AAAAAAAAAAI/AAAAAAAAABU/tYGkN03PEsA/photo.jpg?sz=128", "display_name": "Peter Ksenak", "link": "https://stackoverflow.com/users/10785732/peter-ksenak"}, "is_accepted": false, "score": 0, "last_activity_date": 1571214999, "creation_date": 1571214999, "answer_id": 58409087, "question_id": 58408918, "link": "https://stackoverflow.com/questions/58408918/vba-runtime-error-when-connection-to-sql-database/58409087#58409087", "title": "VBA Runtime Error when connection to SQL Database", "body": "<p>this is my snippet, try it :</p>\n\n<pre><code>Set cnConn = New ADODB.Connection\n\nWith cnConn\n.Provider = \"SQLOLEDB.1\"\n.CursorLocation = adUseClient\n.ConnectionTimeout = 0\n.Properties(\"Data Source\").Value = ' serverName\n.Properties(\"Password\").Value = ' pswd\n.Properties(\"User ID\").Value = ' userName\n.Properties(\"Initial Catalog\").Value = ' init DB\n.Open\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "is_accepted": true, "score": 2, "last_activity_date": 1571215227, "creation_date": 1571215227, "answer_id": 58409150, "question_id": 58408918, "link": "https://stackoverflow.com/questions/58408918/vba-runtime-error-when-connection-to-sql-database/58409150#58409150", "title": "VBA Runtime Error when connection to SQL Database", "body": "<p>The issue is because you are using a named user with <code>Integrated Security</code>.  These two modes are incompatible.</p>\n\n<p>Try removing <code>Integrated Security=SSPI</code>:</p>\n\n<pre><code>conn.ConnectionString = \"PERSIST SECURITY INFO=True;Provider=SQLOLEDB.1;Server=WWDDB;Database=01Projekt;User ID=XXX;Password=XXX;Trusted_Connection=True;\" conn.Open\n</code></pre>\n\n<p>Or the named user:</p>\n\n<pre><code>conn.ConnectionString = \"PERSIST SECURITY INFO=True;Provider=SQLOLEDB.1;Server=WWDDB;Database=01Projekt;Trusted_Connection=True;Integrated Security=SSPI;\" conn.Open\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11945114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7199edc171602ff511e519153917d576?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/11945114/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 58409150, "answer_count": 2, "score": 1, "last_activity_date": 1571834487, "creation_date": 1571214454, "last_edit_date": 1571834487, "question_id": 58408918, "link": "https://stackoverflow.com/questions/58408918/vba-runtime-error-when-connection-to-sql-database", "title": "VBA Runtime Error when connection to SQL Database", "body": "<p>I'm trying to connect to a <code>SQL Server</code> from multiple PCs in the same domain.</p>\n\n<p>When using the following code:</p>\n\n<pre><code>Dim conn As ADODB.Connection\n\nSet conn = New ADODB.Connection 'Neue Verbindung initialisieren\n\n'Verbindung einrichten'\nconn.ConnectionString = \"PERSIST SECURITY INFO=True;Provider=SQLOLEDB.1;Server=WWDDB;Database=01Projekt;User ID=XXX;Password=XXX;Trusted_Connection=True;Integrated Security=SSPI;\"\nconn.Open\n</code></pre>\n\n<p><code>conn.Open</code> returns the error: </p>\n\n<blockquote>\n  <p>Error on login for the user 'XXXX'</p>\n</blockquote>\n"}, {"tags": ["vba", "function", "cell", "key-value", "helper"], "comments": [{"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 4, "creation_date": 1571214077, "post_id": 58408803, "comment_id": 103161412, "body": "Are You sure this is VBA language?"}], "answers": [{"tags": [], "owner": {"reputation": 163, "user_id": 12213296, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4kCa9Fd48wY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reQFQIp8Gts_ND1mP4FoT2Xe4SvfQ/photo.jpg?sz=128", "display_name": "Sfagnum", "link": "https://stackoverflow.com/users/12213296/sfagnum"}, "is_accepted": false, "score": 0, "last_activity_date": 1571222591, "creation_date": 1571222591, "answer_id": 58411428, "question_id": 58408803, "link": "https://stackoverflow.com/questions/58408803/how-select-the-last-active-cell/58411428#58411428", "title": "How select the last active cell?", "body": "<p>in VBA it can be so:</p>\n\n<pre><code>Sub OrderMacro()\nDim o As Object\n    Set o = Selection\n    Range(\"B3:AF41\").Activate\n    'do something\n    o.Select\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Property Selection As Object\n      read-only\n      Member of Excel.Application</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 12225123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FWuwonSNBzI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfw2RkiD0FJANz3bRGzhZEomQ_-JA/photo.jpg?sz=128", "display_name": "Juanma", "link": "https://stackoverflow.com/users/12225123/juanma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1571222591, "creation_date": 1571214021, "question_id": 58408803, "link": "https://stackoverflow.com/questions/58408803/how-select-the-last-active-cell", "title": "How select the last active cell?", "body": "<p>Instead of selecting cell A1 at the end I want to select the last active cell. That is, where I clicked with the cursor. What would be the sentence?</p>\n\n<pre><code>function OrderMacro() {\n  var spreadsheet = SpreadsheetApp.getActive();\n  spreadsheet.getRange('B3:AF41').activate()\n  .sort({column: 32, ascending: false});\n  spreadsheet.getRange('A1').activate();\n};\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 1, "creation_date": 1571213412, "post_id": 58408107, "comment_id": 103161055, "body": "Hi. If the VLOOKUP() fails (can&#39;t find a match), you will get this error."}], "answers": [{"tags": [], "owner": {"reputation": 377, "user_id": 11515463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a12a06f75df2e6ad12c29e215427e11e?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Abreu", "link": "https://stackoverflow.com/users/11515463/johnny-abreu"}, "is_accepted": false, "score": 1, "last_activity_date": 1571214706, "last_edit_date": 1571214706, "creation_date": 1571213544, "answer_id": 58408647, "question_id": 58408107, "link": "https://stackoverflow.com/questions/58408107/how-to-fix-vlookup-worksheet-property-error-in-vba/58408647#58408647", "title": "how to fix vlookup worksheet property error in VBA", "body": "<p>Why do you have two <code>**</code> at the end of this code line <code>strResult = Application.WorksheetFunction.VLookup(Range(\"B3\"), Sheets(\"Pipeline Master\").Range(\"B6:T3000\"), 6, False)</code> ?\nI tried it out and it worked fine.</p>\n\n<p>edit: If it still doesn't work for you maybe try to use the <code>.formula</code> property instead.</p>\n\n<pre><code>With ThisWorkbook.Worksheets(\"Pipeline Master\").Range(\"B3\")\n    .Formula = \"=VLOOKUP(\"\"Qualified\"\",B6:T3000,6,FALSE)\"\n    .Value = .Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12163221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73931191263d64377e891635fdfabbe9?s=128&d=identicon&r=PG&f=1", "display_name": "suupmaster", "link": "https://stackoverflow.com/users/12163221/suupmaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571214706, "creation_date": 1571211288, "question_id": 58408107, "link": "https://stackoverflow.com/questions/58408107/how-to-fix-vlookup-worksheet-property-error-in-vba", "title": "how to fix vlookup worksheet property error in VBA", "body": "<p>I have the following code which when run, returns error 1004 \"Unable to get Vlookup Property of the WorksheetFunction Class\" on the line <strong><em>\"If strF = Qualified</em></strong>\". Please guide how to fix. Thanks in advance.</p>\n\n<pre><code>Sub Geo()\n\nDim i As Long\nDim strB As String, strF As String, strResult As String\n\nFor i = 1 To 100\n\nWith ActiveSheet\nstrB = .Cells(i, 2).Value2\nstrF = .Cells(i, 6).Value2\nEnd With\n\nIf strB = vbNullString Then\nstrResult = vbNullString\n\nElse\nIf strF = \"Qualified\" Then\nstrResult = Application.WorksheetFunction.VLookup(Range(\"B3\"), Sheets(\"Pipeline Master\").Range(\"B6:T3000\"), 6, False)**\n\nOn Error Resume Next\nstrResult = Application.WorksheetFunction.VLookup(Range(\"B3\"), Sheets(\"2019-Wins&amp;Losses\").Range(\"A7:M5000\"), 2, False)\n\nOn Error Resume Next\nstrResult = Application.WorksheetFunction.VLookup(Range(\"B3\"), Sheets(\"PipelineHistory\").Range(\"C3:G15934\"), 5, False)\n\nOn Error Resume Next\n\nstrResult = \" \"\nOn Error GoTo 0\n\nEnd If\nEnd If\n\nActiveSheet.Cells(i, 11).Value2 = strResult\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "forms", "ms-access", "sum"], "comments": [{"owner": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1571210383, "post_id": 58407759, "comment_id": 103159577, "body": "Hi Lois, could you include your SQL, example data and perhaps a screen shot, please?"}, {"owner": {"reputation": 21, "user_id": 10716812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbeulL0yW5Q/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jX-R-np-PKvbEFmCzc6n7oY1pE2g/mo/photo.jpg?sz=128", "display_name": "Lois", "link": "https://stackoverflow.com/users/10716812/lois"}, "reply_to_user": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1571210871, "post_id": 58407759, "comment_id": 103159792, "body": "Hi Paul, I didn&#39;t try SQL since I am not really good at it. what I tried is vba: TEAM1 = Sum(&quot;[Percentage Passed]&quot;, &quot;KPI&quot;, &quot;[SelMonth]=&#39;&quot; &amp; Me.Month &amp; &quot;&#39;&quot;, &quot;[Team]&quot; = &quot;Team1&quot;) (SelMonth is my searchbox for Month &amp; &quot;KPI&quot; is my Query)"}, {"owner": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1571210979, "post_id": 58407759, "comment_id": 103159838, "body": "Could you <a href=\"https://stackoverflow.com/posts/58407759/edit\">edit</a> your question and put your code in there - anything that handles the process."}, {"owner": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1571211689, "post_id": 58407759, "comment_id": 103160189, "body": "Hi Lois, if you edit your query, and where you&#39;d normally click the <b>View</b> button on the very left of the ribbon, click the little arrow beside it and select <b>SQL</b>, then copy the SQL and paste into your question."}, {"owner": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1571213403, "post_id": 58407759, "comment_id": 103161049, "body": "It&#39;s not too long - just copy it and paste it into the editor and I&#39;ll tidy it up for you."}, {"owner": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1571213577, "post_id": 58407759, "comment_id": 103161139, "body": "Lois, please click the edit button just under your question (where it says <b>share edit close flag</b>) and paste your SQL into the question, not the comments."}, {"owner": {"reputation": 21, "user_id": 10716812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbeulL0yW5Q/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jX-R-np-PKvbEFmCzc6n7oY1pE2g/mo/photo.jpg?sz=128", "display_name": "Lois", "link": "https://stackoverflow.com/users/10716812/lois"}, "reply_to_user": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1571213620, "post_id": 58407759, "comment_id": 103161156, "body": "so stupid of me. I just thought of that"}, {"owner": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1571213660, "post_id": 58407759, "comment_id": 103161173, "body": "Don&#39;t worry :o)"}, {"owner": {"reputation": 21, "user_id": 10716812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbeulL0yW5Q/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jX-R-np-PKvbEFmCzc6n7oY1pE2g/mo/photo.jpg?sz=128", "display_name": "Lois", "link": "https://stackoverflow.com/users/10716812/lois"}, "reply_to_user": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1571213713, "post_id": 58407759, "comment_id": 103161203, "body": "Hi Paul, the [M15 Percentage] is the field i want to sum based on selected Month in my Form"}], "answers": [{"tags": [], "owner": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "is_accepted": false, "score": 0, "last_activity_date": 1571215683, "creation_date": 1571215683, "answer_id": 58409295, "question_id": 58407759, "link": "https://stackoverflow.com/questions/58407759/sum-field-in-ms-access-form-based-in-two-criteria-selected/58409295#58409295", "title": "Sum Field in MS Access Form Based in two criteria selected", "body": "<p>I've checked your code, and (now having the two pieces of code listed) I can safely say that your VBA is looking for <code>SelMonth</code> in your query.  Try the following...</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>TEAM1 = DSum(\"[Percentage Passed]\", \"KPI\", \"[Month]=\"\"\" &amp; Me.SelMonth &amp; \"\"\" AND [Team] = \"\"\" &amp; Team1 &amp; \"\"\"\")\n</code></pre>\n\n<p>You had the following issues...</p>\n\n<ol>\n<li>You used <a href=\"https://support.office.com/en-gb/article/sum-data-by-using-a-query-430a669b-e7fd-4c4b-b154-8c8dbbe41c8a\" rel=\"nofollow noreferrer\"><code>Sum</code></a> instead of <a href=\"https://support.office.com/en-gb/article/dsum-function-08f8450e-3bf6-45e2-936f-386056e61a32\" rel=\"nofollow noreferrer\"><code>DSum</code></a>. <code>Sum</code> is the function that totals columns in the query itself, whereas <code>DSum</code> is an aggregate function for VBA.</li>\n<li>You were testing <code>[SelMonth]</code> as a field in the query, rather than a value on your form.</li>\n<li>You'd done something strange with the <code>Team</code> field, and it was referencing a fixed value of 'Team1'.</li>\n</ol>\n\n<p>Personally, I believe that you've chosen the wrong way to do this.  You'd be far better off basing your form on a new query that only pulls the required data.  That query could be as simple as...</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT \n    SUM([M15 Passed]/[Line Items]*100) AS [M15 Percentage]\nFROM \n    [OE Finance Tracker] \nWHERE \n    ((([OE Finance Tracker].[Request Type])=\"Request\") AND \n    (([OE Finance Tracker].[Mantainer Status])=\"Completed\")) AND \n    ((Format$([OE Finance Tracker].[MNT Completion Date], \"yyyymm\")) = Forms![MyForm]![txtMonth]) AND \n    (([OE Finance Tracker].[Team]) = Forms![MyForm]![txtTeam]);\n</code></pre>\n\n<p>But I'll leave that up to you.</p>\n\n<p>There are still some confusing issues - using <code>TEAM1</code> to store your value is also a touch shaky.  Try researching <a href=\"https://support.office.com/en-gb/article/make-summary-data-easier-to-read-by-using-a-crosstab-query-8465b89c-2ff2-4cc8-ba60-2cd8484667e8\" rel=\"nofollow noreferrer\">crosstab queries</a> to get your answers for <strong>all</strong> teams in one go.</p>\n"}], "owner": {"reputation": 21, "user_id": 10716812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbeulL0yW5Q/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jX-R-np-PKvbEFmCzc6n7oY1pE2g/mo/photo.jpg?sz=128", "display_name": "Lois", "link": "https://stackoverflow.com/users/10716812/lois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571215683, "creation_date": 1571210190, "last_edit_date": 1571213772, "question_id": 58407759, "link": "https://stackoverflow.com/questions/58407759/sum-field-in-ms-access-form-based-in-two-criteria-selected", "title": "Sum Field in MS Access Form Based in two criteria selected", "body": "<p>I created a query for my KPI with \"Team\", \"Month\", \"Percentage Passed\" as my key data.\nWhat I am trying to execute now, is to have the sum of \"Percentage Passed\" per Team (i have 4 Teams) in a text box based on a selected month</p>\n\n<p>I created a Split form that includes my key data &amp; added text boxes per team where I want my sum up percentage appear &amp; a Text Box to be used as search field for the month.</p>\n\n<p>I am trying to create a VBA to this that is similar to Dlookup function but it was not successful.\nCan someone please help me how can i execute this?</p>\n\n<p>SQL in my Query </p>\n\n<pre><code>SELECT \n    [OE Finance Tracker].Team, \n    [OE Finance Tracker].ERP, \n    [OE Finance Tracker].[Data Object], \n    [OE Finance Tracker].[Business Code], \n    [OE Finance Tracker].[Company Code], \n    [OE Finance Tracker].[Select], \n    Format([MNT Completion Date],\"yyyymm\") AS [Month], \n    [OE Finance Tracker].[Transaction Type], \n    IIf([Line Item Passed After Validation]&lt;[Total Line Items Raised],[Total Line Items Raised],[Line Item Passed After Validation]) AS [Line Items], \n    IIf([Line Item Passed After Validation]&lt;&gt;[APP - Line Items Passed after Validation],[APP - Line Items Passed after Validation],IIf([MNT - Line Items Passed after validation]&lt;&gt;[Line Item Passed After Validation],[MNT - Line Items Passed after validation],[Line Item Passed After Validation])) AS [M15 Passed], \n    ([M15 Passed]/[Line Items]*100) AS [M15 Percentage], \n    IIf([M2Req]=\"0\",\"0\",IIf([M2App]=\"0\",\"0\",IIf([M2MNT]=\"0\",\"0\",[Line Items]))) AS [M2 Passed], \n    ([M2 Passed]/[Line Items]*100) AS [M2 Percentage], \n    IIf(IsNull([M16 Failure Reason]),[Line Items],\"0\") AS [M16 Passed], \n    ([M16 Passed]/[Line Items]*100) AS [M16 Percentage], \n    IIf([M15 Failure Reason - APP]&lt;&gt;\"\",[M15 Failure Reason - APP],[M15 Failure Reason - MNT]) AS [M15 Failure Reason], \n    IIf([M15 Comments - APP]&lt;&gt;\"\",[M15 Comments - APP],[M15 Comments - MNT]) AS [M15 Specific], \n    IIf([M2Req]=\"0\",[M2 Failure Reason - REQMRD Lead],IIf([M2App]=\"0\",[M2 Failure Reason - APP],IIf([M2MNT]=\"0\",[M2 Failure Reason - MNT],\"\"))) AS [M2 Failure Reason], \n    IIf([M2Req]=\"0\",[M2 Comments - REQ/MRD Lead],IIf([M2App]=\"0\",[M2 Comments - APP],IIf([M2MNT]=\"0\",[M2 Comments - MNT],\"\"))) AS [M2 Failure Specific], \n    IIf([M16 Failure Reason]&lt;&gt;\"\",[M16 Failure Reason]) AS [M16 Failure Reasons], \n    IIf([M16 Comments]&lt;&gt;\"\",[M16 Comments]) AS [M16 Failure Specifics], \n    IIf([Line Item Passed After Validation]&lt;[Total Line Items Raised],[Total Line Items Raised],[Line Item Passed After Validation]) AS [Line ItemsM16], \n    [OE Finance Tracker].[Request Number], \n    [OE Finance Tracker].[Maintainer Assigned], \n    [OE Finance Tracker].[MRD RequestorLead Assigned], \n    [OE Finance Tracker].[Approver Assigned], \n    [OE Finance Tracker].[Total line items Processed], \n    [OE Finance Tracker].[APP - Line Items Passed after Validation], \n    [OE Finance Tracker].[MNT - Line Items Passed after validation], \n    [OE Finance Tracker].[Total Line Items Raised], \n    [OE Finance Tracker].[Request Type], \n    [OE Finance Tracker].[Mantainer Status], \n    [OE Finance Tracker].[Line Item Passed After Validation], \n    [OE Finance Tracker].[M2 Failure Reason - REQMRD Lead], \n    [OE Finance Tracker].[M2 Comments - REQ/MRD Lead], \n    IIf(IsNull([M2 Failure Reason - REQMRD Lead]),[Line Items],\"0\") AS M2Req, \n    [OE Finance Tracker].[M15 Failure Reason - APP], \n    [OE Finance Tracker].[M15 Comments - APP], \n    [OE Finance Tracker].[M2 Failure Reason - APP], \n    [OE Finance Tracker].[M2 Comments - APP], \n    IIf(IsNull([M2 Failure Reason - APP]),[Line Items],\"0\") AS M2APP, \n    [OE Finance Tracker].[M15 Failure Reason - MNT], \n    [OE Finance Tracker].[M15 Comments - MNT], \n    [OE Finance Tracker].[M2 Failure Reason - MNT], \n    [OE Finance Tracker].[M2 Comments - MNT], \n    IIf(IsNull([M2 Failure Reason - MNT]),[Line Items],\"0\") AS M2MNT, \n    [OE Finance Tracker].[M16 Failure Reason], \n    [OE Finance Tracker].[M16 Comments] \nFROM \n    [OE Finance Tracker] \nWHERE \n    ((([OE Finance Tracker].[Request Type])=\"Request\") AND \n    (([OE Finance Tracker].[Mantainer Status])=\"Completed\"));\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1571211331, "post_id": 58407701, "comment_id": 103160029, "body": "Why the array list? Why don&#39;t you just filer by criteria column H = 0?"}, {"owner": {"reputation": 19, "user_id": 12224730, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB7aBzEbcL825MFVRQ-k_JZEtJigRKtbSo0AgjAHQ=k-s128", "display_name": "Alan Wong", "link": "https://stackoverflow.com/users/12224730/alan-wong"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1571211472, "post_id": 58407701, "comment_id": 103160095, "body": "Oh i forgot to iterate, i did an offset there after finding the H= 0 to grab a value. Im using that value to do an autofilter."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1571212845, "post_id": 58407701, "comment_id": 103160754, "body": "The issue you have is that your <code>exrcif</code> is a <code>String</code>  and <code>exrcif = oneCell.Offset(,-7).Value</code> overwrites that string in each iteration. Instead you must add the value to an array (there are tutorials for how to add a value to an array, give it a try)."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 12224730, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB7aBzEbcL825MFVRQ-k_JZEtJigRKtbSo0AgjAHQ=k-s128", "display_name": "Alan Wong", "link": "https://stackoverflow.com/users/12224730/alan-wong"}, "edited": false, "score": 0, "creation_date": 1571217990, "post_id": 58408710, "comment_id": 103163572, "body": "Peh, your code works wonder!! Have been figuring this around the forum for a day. Thanks alot for your help and have a great week ahead!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 19, "user_id": 12224730, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB7aBzEbcL825MFVRQ-k_JZEtJigRKtbSo0AgjAHQ=k-s128", "display_name": "Alan Wong", "link": "https://stackoverflow.com/users/12224730/alan-wong"}, "edited": false, "score": 0, "creation_date": 1571223970, "post_id": 58408710, "comment_id": 103166777, "body": "@AlanWong If this answered your question please upvote/mark it as solved: <a href=\"https://meta.stackexchange.com/a/5235\">Accepting Answers: How does it work?</a>"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 2, "last_activity_date": 1571214859, "last_edit_date": 1571214859, "creation_date": 1571213784, "answer_id": 58408710, "question_id": 58407701, "link": "https://stackoverflow.com/questions/58407701/looping-through-each-cell-and-if-match-grab-value-and-add-to-list-array-which/58408710#58408710", "title": "Looping through each cell, and if match, grab value and add to list/array which will like to use it for autofilter", "body": "<p>The issue you have is that your <code>exrcif</code> is a <code>String</code> and no array and </p>\n\n<pre><code>exrcif = oneCell.Offset(,-7).Value \n</code></pre>\n\n<p>overwrites that string in each iteration. Instead you must append the value to an array:</p>\n\n<p>For example write a procedure to append a value to an array</p>\n\n<pre><code>Option Explicit\n\nPublic Sub AppendToArray(ByRef Arr() As Variant, ByVal AppendValue As Variant)\n    Dim ArrSize As Long\n    ArrSize = -1\n\n    On Error Resume Next\n    ArrSize = UBound(Arr)\n    On Error GoTo 0\n\n    ReDim Preserve Arr(ArrSize + 1)\n    Arr(ArrSize + 1) = AppendValue\nEnd Sub\n</code></pre>\n\n<p>And use it like below</p>\n\n<pre><code>Public Sub test()\n    Dim exrcif() As Variant\n\n    Dim oneCell As Range\n    For Each oneCell In Range(\"H2:H1000\")\n        If oneCell.Value = 0 Then\n            AppendToArray Arr:=exrcif, AppendValue:=oneCell.Offset(, -7).Value\n            'note no Exit For here! Otherwise it will stop after the first found 0\n        End If\n    Next oneCell\n\n    Range(\"A:H\").AutoFilter Field:=4, Criteria1:=exrcif, Operator:=xlFilterValues\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 1, "last_activity_date": 1571214105, "creation_date": 1571214105, "answer_id": 58408823, "question_id": 58407701, "link": "https://stackoverflow.com/questions/58407701/looping-through-each-cell-and-if-match-grab-value-and-add-to-list-array-which/58408823#58408823", "title": "Looping through each cell, and if match, grab value and add to list/array which will like to use it for autofilter", "body": "<p>variant using <code>Scripting.Dictionary</code></p>\n\n<pre><code>Sub test()\n    Dim oneCell As Range\n    Dim exrcif As Object: Set exrcif = CreateObject(\"Scripting.Dictionary\")\n    For Each oneCell In Range(\"H2:H1000\")\n        With oneCell\n            If oneCell.Value = 0 And _\n                oneCell.Value &lt;&gt; \"\" And _\n                Not exrcif.exists(oneCell.Offset(, -7).Value) Then\n                exrcif.Add oneCell.Offset(, -7).Value, Nothing\n            End If\n        End With\n    Next oneCell\n    Range(\"A:H\").AutoFilter Field:=4, Criteria1:=exrcif.Keys, Operator:=xlFilterValues\nEnd Sub\n</code></pre>\n\n<p>test:\n<a href=\"https://i.stack.imgur.com/YwwLx.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YwwLx.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 19, "user_id": 12224730, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB7aBzEbcL825MFVRQ-k_JZEtJigRKtbSo0AgjAHQ=k-s128", "display_name": "Alan Wong", "link": "https://stackoverflow.com/users/12224730/alan-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1571214859, "creation_date": 1571209976, "last_edit_date": 1571211131, "question_id": 58407701, "link": "https://stackoverflow.com/questions/58407701/looping-through-each-cell-and-if-match-grab-value-and-add-to-list-array-which", "title": "Looping through each cell, and if match, grab value and add to list/array which will like to use it for autofilter", "body": "<p>Self explanatory subject. The problem I face now is that my <code>exrcif</code> is not increasing as I would like to include a list of criteria in the autofilter. </p>\n\n<p>Currently I have this code:</p>\n\n<pre><code>    Dim oneCell as Range\n    Dim exrcif as String\n\n    For each oneCell in Range(\u201cH2:H1000\u201d)    \n        With oneCell    \n            If oneCell.value = 0 Then    \n                exrcif = oneCell.Offset(,-7).Value    \n                Exit For\n            End If\n        End With\n    Next oneCell\n\n    Range(\u201cA:H\u201d).AutoFilter Field:=4, , Criteria1:=exrcif\nEnd sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1571214449, "post_id": 58407652, "comment_id": 103161627, "body": "It will be easier if you can provide an input sample. We don&#180;t know how big is your range."}, {"owner": {"reputation": 11, "user_id": 11873213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20335c1d60b1e010577b0d62844102df?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/11873213/john"}, "reply_to_user": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1571223077, "post_id": 58407652, "comment_id": 103166268, "body": "There are currently 15568 rows of data , with 1386 rows to be copied and pasted . There columns A:BA"}, {"owner": {"reputation": 11, "user_id": 11873213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20335c1d60b1e010577b0d62844102df?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/11873213/john"}, "reply_to_user": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1571307269, "post_id": 58407652, "comment_id": 103201048, "body": "it appears to be this line of code causing issues Application.ActiveWorkbook.Worksheets(&quot;Financial Data&quot;).Range(&quot;J2&quot;, &quot;K200000&quot;) = Format(Date, &quot;dd/mm/yyyy&quot;)"}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1571310455, "post_id": 58407652, "comment_id": 103202917, "body": "Should be <code>Application.ActiveWorkbook.Worksheets(&quot;Financial Data&quot;).Range(&quot;J2&quot;, &quot;K200000&quot;).NumberFormat = &quot;dd&#47;mm&#47;yyyy&quot;</code>"}], "owner": {"reputation": 11, "user_id": 11873213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20335c1d60b1e010577b0d62844102df?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/11873213/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571211118, "creation_date": 1571209833, "last_edit_date": 1571211118, "question_id": 58407652, "link": "https://stackoverflow.com/questions/58407652/importing-next-years-date-to-table-based-on-max-number-in-year-column-my-code", "title": "Importing next years date to table based on max number in year column , my code freezes", "body": "<p>I have a table with duplicate company names , as they each have a row of data based on yearly values. I have been trying to create an import code to add a row for each company with the next year details added. My code filters column E which has the year , from smallest to largest number. I use the max code to get the first instance of the highest number. and then I get the last row number and last row number plus 1 values. I can then copy and paste the range to the next empty row. I then need clear the range in column H and columns N to AD. I need to ensure that the columns J:K are in the dd/mm/yyyy format for my code to change the years only for dates in columns J and K. my code below works , but it can take 20 to 30 mins to run. and can freeze up. My computer spec is quite good , so not sure why this small bit of code is taking so long. Any help would be much appreciated , as I have spent hours looking for a solution.</p>\n\n<pre><code>Sub AddNewYear()\nothwb = Application.Workbooks.Count\nIf othwb &gt; 1 Then MsgBox \"Please save and close any other workbooks before running this code\", , \"Panda\": Exit Sub\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\nDim d As Date\nDim da As Date\nDim lrow As Long\nDim copy_range As Range\nlrow = Sheet1.Cells(Rows.Count, 1).End(xlUp).Row\nApplication.ActiveWorkbook.Worksheets(\"Financial Data\").Range(\"J2\", \"K200000\") = Format(Date, \"dd/mm/yyyy\")\nlrow1 = Sheet1.Cells(Rows.Count, 1).End(xlUp).Row + 1\nDim tabl As ListObject\nSet tabl = Sheet1.ListObjects(1)\nSheet1.ListObjects.item(1).ShowTotals = False\nDim orgid As String\nDim yearchoice As Variant\ntabl.AutoFilter.ShowAllData\nyearchoice = Application.WorksheetFunction.Max(Range(\"E:E\"))\nSet copy_range = Sheet1.Range(\"A2:AZ\" &amp; lrow)\ntabl.Range.AutoFilter Field:=5, Criteria1:=yearchoice\ncopy_range.SpecialCells(xlCellTypeVisible).Copy Sheet1.Range(\"A\" &amp; lrow1)\ntabl.AutoFilter.ShowAllData\nDim lrow2\nlrow2 = Sheet1.Cells(Rows.Count, 1).End(xlUp).Row\nSheet1.Range(\"H\" &amp; lrow1 &amp; \":H\" &amp; lrow2).ClearContents\nSheet1.Range(\"N\" &amp; lrow1 &amp; \":AD\" &amp; lrow2).ClearContents\nDim x\nyearchoice = yearchoice + 1\nFor x = lrow1 To lrow2\nSheet1.Range(\"E\" &amp; x).Value = yearchoice\nSheet1.Range(\"F\" &amp; x).Value = \"A\"\nSheet1.Range(\"G\" &amp; x).Value = yearchoice &amp; Sheet1.Range(\"F\" &amp; x).Value\nSheet1.Range(\"H\" &amp; x).Value = 0\nd = Sheet1.Range(\"J\" &amp; x).Value\nSheet1.Range(\"J\" &amp; x).Value = DateSerial(year(d) + 1, Month(d), Day(d))\nda = Sheet1.Range(\"K\" &amp; x).Value\nSheet1.Range(\"K\" &amp; x).Value = DateSerial(year(da) + 1, Month(da), Day(da))\nNext x\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1571208967, "post_id": 58405875, "comment_id": 103158843, "body": "This <code>On Error Resume Next</code> just hides the error message but the error still occurs. It doesn&#39;t solve any problems it just tells VBA &quot;If there is an error please don&#39;t show anyone&quot;. Never use that line without a complete error handling afterwards! You might benefit from reading <a href=\"https://excelmacromastery.com/vba-error-handling\" rel=\"nofollow noreferrer\">VBA Error Handling \u2013 A Complete Guide</a>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1571202674, "creation_date": 1571202674, "answer_id": 58406119, "question_id": 58405875, "link": "https://stackoverflow.com/questions/58405875/vba-lookup-function-giving-incorrect-number-on-error/58406119#58406119", "title": "VBA Lookup function giving incorrect number on Error", "body": "<p>If you drop the <code>Worksheetfunction</code> then a non-match will not throw a run-time error and you can instead test the return value using <code>IsError()</code> </p>\n\n<pre><code>Sub x()\n    Dim src As Range, cell As Range, Rng As Range\n    Dim d as Variant  'not String, because it might need to\n                      '  hold an error value if no match\n\n    Set src = Range(\"A1:A5\") 'list of names needs to be searched\n    Set Rng = Range(\"D1:E5\") 'table array\n\n    For Each cell In src.Cells\n\n        d = Application.VLookup(cell.Value, Rng, 2, 0)\n        cell.Offset(0, 1).Value = IIf(IsError(d), \"No Match\", d)\n\n    Next cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 94, "user_id": 11378204, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Xs4Oi9rUW_c/AAAAAAAAAAI/AAAAAAAAADo/1qszOfKxLw4/photo.jpg?sz=128", "display_name": "Mrblackey", "link": "https://stackoverflow.com/users/11378204/mrblackey"}, "is_accepted": false, "score": 0, "last_activity_date": 1571203214, "creation_date": 1571203214, "answer_id": 58406216, "question_id": 58405875, "link": "https://stackoverflow.com/questions/58405875/vba-lookup-function-giving-incorrect-number-on-error/58406216#58406216", "title": "VBA Lookup function giving incorrect number on Error", "body": "<p>What happens is that when you skip an assignment which is causing an error in <code>d = Application.WorksheetFunction.VLookup(cell.Value, Rng, 2, 0)</code>, the previous value hasn't been cleaned from the <code>d</code> variable.</p>\n\n<p>You can try two approaches here:<br>\n1. Initialize the string in every iteration:</p>\n\n<pre><code>On Error Resume Next\nFor Each cell In src\n    d = vbNullString\n    d = Application.WorksheetFunction.VLookup(cell.Value, Rng, 2, 0)\n    cell.Offset(0, 1).Value = d\nNext cell\n</code></pre>\n\n<p>2. Skip assignment of string to cell, by defining a label, rather then <code>Resume Next</code>:</p>\n\n<pre><code>On Error Resume NextCell\nFor Each cell In src\n    d = Application.WorksheetFunction.VLookup(cell.Value, Rng, 2, 0)\n    cell.Offset(0, 1).Value = d\nNextCell:\nNext cell\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8509714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfca5f898149f17e5e38e5f9447f5892?s=128&d=identicon&r=PG&f=1", "display_name": "anishmbait", "link": "https://stackoverflow.com/users/8509714/anishmbait"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 58406119, "answer_count": 2, "score": 0, "last_activity_date": 1571208847, "creation_date": 1571200912, "last_edit_date": 1571208847, "question_id": 58405875, "link": "https://stackoverflow.com/questions/58405875/vba-lookup-function-giving-incorrect-number-on-error", "title": "VBA Lookup function giving incorrect number on Error", "body": "<p>I appreciate if you can help me on below code. I'm trying to do a lookup with the VBA Lookup function, and it gives an error 1004 when the looked up value isn't available in the table array. I have tried to use \"On resume Resume Next\" command to skip when result an error, but instead of skipping and giving a blank result, it throws the previous value on it.</p>\n\n<pre><code>Sub x()\n\nDim d As String\n\nSet src = Range(\"A1:A5\") 'list of names needs to be searched\nSet Rng = Range(\"D1:E5\") 'table array\n\nOn Error Resume Next\n\nFor Each cell In src\n\nd = Application.WorksheetFunction.VLookup(cell.Value, Rng, 2, 0)\ncell.Offset(0, 1).Value = d\n\nNext cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 1044, "user_id": 10068520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f18bb002969dd5d8e5cd6ed739e5f917?s=128&d=identicon&r=PG&f=1", "display_name": "OverflowStacker", "link": "https://stackoverflow.com/users/10068520/overflowstacker"}, "edited": false, "score": 1, "creation_date": 1571200592, "post_id": 58405747, "comment_id": 103156043, "body": "Are the colors changed manually or by some logic with conditional formatting"}, {"owner": {"reputation": 3064, "user_id": 11768364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kK8lw.png?s=128&g=1", "display_name": "Terry W", "link": "https://stackoverflow.com/users/11768364/terry-w"}, "edited": false, "score": 1, "creation_date": 1571202732, "post_id": 58405747, "comment_id": 103156507, "body": "Post the formula you mentioned."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "edited": false, "score": 0, "creation_date": 1571207741, "post_id": 58406271, "comment_id": 103158272, "body": "=SUMPRODUCT(($A$2:$A$26=$A30)*(GET.CELL(63,IF(1,+OFFSET($B$2&zwnj;&#8203;:$B$26,ROW($B$2:$B$2&zwnj;&#8203;6)-ROW($B$2),)))=GET&zwnj;&#8203;.CELL(63,$B$29)))  Upon using this I get an error &#39;The function is not valid.&#39; I&#39;m probably doing something incorrectly?"}, {"owner": {"reputation": 2814, "user_id": 12125181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d1dd8c08836a0f30f03a66adddc2c3?s=128&d=identicon&r=PG", "display_name": "bosco_yip", "link": "https://stackoverflow.com/users/12125181/bosco-yip"}, "reply_to_user": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "edited": false, "score": 0, "creation_date": 1571210631, "post_id": 58406271, "comment_id": 103159693, "body": "Few points : 1] criteria country put in range A30:A34 (Argentina, China, Australia....)  2] Criteria cell B29 of wording &quot;RED&quot; must filled with red color. 3] Select B30 then click &quot;Define name&quot; and enter the formula as above description. Finally save file as xlsm type."}], "tags": [], "owner": {"reputation": 2814, "user_id": 12125181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d1dd8c08836a0f30f03a66adddc2c3?s=128&d=identicon&r=PG", "display_name": "bosco_yip", "link": "https://stackoverflow.com/users/12125181/bosco-yip"}, "is_accepted": true, "score": 1, "last_activity_date": 1571214355, "last_edit_date": 1571214355, "creation_date": 1571203626, "answer_id": 58406271, "question_id": 58405747, "link": "https://stackoverflow.com/questions/58405747/count-number-of-cells-with-specifc-text-and-specific-colour-in-excel-range-where/58406271#58406271", "title": "Count number of cells with specifc text and specific colour in excel range where the text is derived from another column", "body": "<p>Here is a formula solution without helper column, please see</p>\n\n<p>1] Assume \"Source table\" put in <code>A1:B26</code> include \"Status\" column filled with <code>red</code> and <code>green</code> background color</p>\n\n<p>2] \"Output table\" put in <code>A29:B34</code> include criteria country put in range <code>A30:A34</code> (Argentina, China, Australia....) </p>\n\n<p>3] In \"Output\" header criteria <code>B29</code>, of wording \"<code>RED</code>\" must filled with <code>red</code> background color  </p>\n\n<p>4] \"Output\" select <code>B30</code> >> Define Name >></p>\n\n<p>'>> Name : <code>CountColor</code></p>\n\n<p>'>> Refer to :</p>\n\n<pre><code>=SUMPRODUCT(($A$2:$A$26=$A30)*(GET.CELL(63,IF(1,+OFFSET($B$2:$B$26,ROW($B$2:$B$26)-ROW($B$2),)))=GET.CELL(63,$B$29)))\n</code></pre>\n\n<p>Then,</p>\n\n<p>5] In \"Output\" <code>B30</code>, enter formula and copied down :</p>\n\n<pre><code>=CountColor\n</code></pre>\n\n<p>6] Finally save file in <code>xlsm</code> type</p>\n\n<p>Edit : Get.Cell is a Excel 4 Macro function, you need to save the file as Macro-Enable Workbook xlsm type.</p>\n"}], "owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 58406271, "answer_count": 1, "score": 0, "last_activity_date": 1571214355, "creation_date": 1571199899, "last_edit_date": 1571208983, "question_id": 58405747, "link": "https://stackoverflow.com/questions/58405747/count-number-of-cells-with-specifc-text-and-specific-colour-in-excel-range-where", "title": "Count number of cells with specifc text and specific colour in excel range where the text is derived from another column", "body": "<p>Perhaps easier looking at the data,</p>\n\n<p><a href=\"https://i.stack.imgur.com/fVniT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fVniT.png\" alt=\"ExcelTable\"></a></p>\n\n<p>I basically need to know how many cells in red are under each country using a formula or VBA. I was able to get a function off the internet which counts the total number of red  background cells but this does not do the job. I need the number of red cells by country. My output should look like this,</p>\n\n<p><a href=\"https://i.stack.imgur.com/hnrgU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hnrgU.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any help would be highly appreciated!</p>\n"}, {"tags": ["vba", "internet-explorer", "automation", "datepicker"], "comments": [{"owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "edited": false, "score": 0, "creation_date": 1571215522, "post_id": 58405728, "comment_id": 103162245, "body": "Which kind of Datepicker plugin are you using? Can you share the related code about that to reproduce the problem? I have created a sample using your code (without adding the datepicker reference), the code works well on my side, I could fill date into the TextBox control. So, perhaps the issue is related to the Datepicker plugin."}, {"owner": {"reputation": 25, "user_id": 12167866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca6731abe7a10aa94715fcbefb2ac62?s=128&d=identicon&r=PG&f=1", "display_name": "FeiLong001", "link": "https://stackoverflow.com/users/12167866/feilong001"}, "reply_to_user": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "edited": false, "score": 0, "creation_date": 1571259349, "post_id": 58405728, "comment_id": 103185352, "body": "Thanks for your help! I have added the javascript code for the datepicker plugin!"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 12167866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca6731abe7a10aa94715fcbefb2ac62?s=128&d=identicon&r=PG&f=1", "display_name": "FeiLong001", "link": "https://stackoverflow.com/users/12167866/feilong001"}, "edited": false, "score": 0, "creation_date": 1571493436, "post_id": 58433037, "comment_id": 103263950, "body": "Thanks for your help! It has worked! I was able to send the correct date (using the datepicker) on the intranet site! Much appreciated!!"}], "tags": [], "owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "is_accepted": true, "score": 0, "last_activity_date": 1571316436, "creation_date": 1571316436, "answer_id": 58433037, "question_id": 58405728, "link": "https://stackoverflow.com/questions/58405728/vba-automation-how-to-access-date-picker-elements/58433037#58433037", "title": "VBA Automation - How To Access Date Picker Elements", "body": "<p>You could try to use the SendKeys method to enter the date, please refer to the following code:</p>\n\n<pre><code>Sub Test()\n    Dim IE As Object\n\n    Dim startDateText As Object, endDateText As Object\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    With IE\n        .Visible = True\n        .Navigate \"&lt;the website url&gt;\"\n\n        While IE.ReadyState &lt;&gt; 4\n            DoEvents\n        Wend\n\n        'find the startdate textbox and focus\n        Set startDateText = IE.document.all(\"startdate\")\n        startDateText.Focus\n        'using sendkeys method to enter the date.\n        SendKeys Format$(ThisWorkbook.Sheets(\"Legends\").Range(\"b7\").Value, \"yyyy-mm-dd\")\n        'Waiting the date value enters (1 second)\n        Application.Wait (Now + TimeValue(\"0:00:1\"))\n\n        Set endDateText = IE.document.all(\"enddate\")\n        endDateText.Focus\n        SendKeys Format$(ThisWorkbook.Sheets(\"Legends\").Range(\"b8\").Value, \"yyyy-mm-dd\")\n\n        Application.Wait (Now + TimeValue(\"0:00:1\"))\n        IE.document.all(\"startdate\").Click\n\n    End With\n    Set IE = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 12167866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca6731abe7a10aa94715fcbefb2ac62?s=128&d=identicon&r=PG&f=1", "display_name": "FeiLong001", "link": "https://stackoverflow.com/users/12167866/feilong001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "accepted_answer_id": 58433037, "answer_count": 1, "score": 2, "last_activity_date": 1571316436, "creation_date": 1571199707, "last_edit_date": 1571259318, "question_id": 58405728, "link": "https://stackoverflow.com/questions/58405728/vba-automation-how-to-access-date-picker-elements", "title": "VBA Automation - How To Access Date Picker Elements", "body": "<p>I am working on some VBA Automation where it is taking data from an Excel Spreadsheet, and inputting that data into an Intranet Site.</p>\n\n<p>On the Intranet Site there is a little datepicker tool (with a start date and end date) that allows you to pick the date (please see html excerpt of the datepicker html code):</p>\n\n<pre><code>&lt;input type=\"text\" id=\"startdate\" name=\"startdate\" value=\"\" class=\"form-control\" size=\"30\"&gt;    \n&lt;button class=\"pika-button pika-day\" type=\"button\" data-pika-year=\"2019\" data-pika-month=\"8\" data-pika-day=\"2\"&gt;2&lt;/button&gt;\n&lt;button class=\"pika-prev\" type=\"button\"&gt;Previous Month&lt;/button&gt;\n\n&lt;input type=\"text\" id=\"enddate\" name=\"enddate\" value=\"\" class=\"form-control\" size=\"30\"&gt;\n&lt;button class=\"pika-button pika-day\" type=\"button\" data-pika-year=\"2019\" data-pika-month=\"8\" data-pika-day=\"2\"&gt;2&lt;/button&gt;\n&lt;button class=\"pika-prev\" type=\"button\"&gt;Previous Month&lt;/button&gt;\n</code></pre>\n\n<p>Please also see the JavaScript code below for the datepicker function:</p>\n\n<pre><code>&lt;script&gt;\n    var startDate,\n    endDate,\n    updateStartDate = function() {\n        startPicker.setStartRange(startDate);\n        endPicker.setStartRange(startDate);\n        endPicker.setMinDate(startDate);\n    },\n    updateEndDate = function() {\n        startPicker.setEndRange(endDate);\n        startPicker.setMaxDate(endDate);\n        endPicker.setEndRange(endDate);\n    },\n    startPicker = new Pikaday({\n        field: document.getElementById('startdate'),\n        minDate: new Date(2016, 1, 1),\n        maxDate: new Date(2050, 12, 31),\n        onSelect: function() {\n            startDate = this.getDate();\n            updateStartDate();\n        }\n    }),\n    endPicker = new Pikaday({\n        field: document.getElementById('enddate'),\n        minDate: new Date(2016, 1, 1),\n        maxDate: new Date(2050, 12, 31),\n        onSelect: function() {\n            endDate = this.getDate();\n            updateEndDate();\n        }\n    });\n    _startDate = startPicker.getDate();\n    _endDate = endPicker.getDate();\n    if (_startDate) {\n        startDate = _startDate;\n        updateStartDate();\n    };\n    if (_endDate) {\n        endDate = _endDate;\n        updateEndDate();\n    };\n&lt;/script&gt;\n</code></pre>\n\n<p>I originally had this code which pushes the correct date string to the form, but the datepicker elements inside the datepicker don't get selected (they default to today's date) after running the automation (see code below:).</p>\n\n<pre><code>IE.document.all(\"startdate\").Value = Format$(ThisWorkbook.Sheets(\"Legends\").Range(\"b7\").Value, \"yyyy-mm-dd\")\nIE.document.all(\"enddate\").Value = Format$(ThisWorkbook.Sheets(\"Legends\").Range(\"b8\").Value, \"yyyy-mm-dd\")\n</code></pre>\n\n<p>This is what happens after I run the automation, please see image with the date pushed: <a href=\"https://i.stack.imgur.com/IZAgS.png\" rel=\"nofollow noreferrer\">Intranet site with date</a></p>\n\n<p>This is how it looks when I click on the datepicker element: <a href=\"https://i.stack.imgur.com/16vZ0.png\" rel=\"nofollow noreferrer\">Datepicker defaulting to today's date</a></p>\n\n<p>After reading some some stuff online, it seems like you have to click on the \"startdate\" element, and then click on the other elements inside the datepicker (which I have successfully done below:).</p>\n\n<pre><code>IE.document.querySelector(\"startdate\").Click\n</code></pre>\n\n<p>However I am unable to figure out how to click on the other elements (previous month, and the day) to complete this part of the automation.</p>\n\n<p>Any help would be much appreciated!</p>\n"}, {"tags": ["excel", "vba", "list", "loops", "paste"], "comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1571197076, "post_id": 58405332, "comment_id": 103155332, "body": "Could you upload one input sample and your expected output?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1571206565, "post_id": 58405332, "comment_id": 103157822, "body": "Can de parameters vfrom column a be contacts occur twice on contacts?"}, {"owner": {"reputation": 5, "user_id": 12223771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d2c5bab7e93848ef7a442d4f6512cb?s=128&d=identicon&r=PG&f=1", "display_name": "class5cat", "link": "https://stackoverflow.com/users/12223771/class5cat"}, "reply_to_user": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1571224650, "post_id": 58405332, "comment_id": 103167132, "body": "@DavidGarc&#237;aBodego Edited to include as requested."}, {"owner": {"reputation": 5, "user_id": 12223771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d2c5bab7e93848ef7a442d4f6512cb?s=128&d=identicon&r=PG&f=1", "display_name": "class5cat", "link": "https://stackoverflow.com/users/12223771/class5cat"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1571224705, "post_id": 58405332, "comment_id": 103167156, "body": "@JvdV Yes. I forgot to account for the fact that a branch can have multiple managers. Reffer to my last edit on the original post as I clarified that matter."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1571228137, "post_id": 58405332, "comment_id": 103169140, "body": "So how would your results look then. It&#39;s a bit confusing to me. Because the second parameter to consider are the managers. With your explaination I would loop through <code>contacts</code> to see if the combination of branch and manager exists on <code>public</code>. And if that exists your results show columns A,B,C and D from <code>contacts</code> which is considerably different to your whole question above."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1571228247, "post_id": 58405332, "comment_id": 103169213, "body": "The only results I would expect considering your data is those of branch 7155 (so the result would only consist of 4 lines)"}, {"owner": {"reputation": 5, "user_id": 12223771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d2c5bab7e93848ef7a442d4f6512cb?s=128&d=identicon&r=PG&f=1", "display_name": "class5cat", "link": "https://stackoverflow.com/users/12223771/class5cat"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1571232657, "post_id": 58405332, "comment_id": 103171908, "body": "@JvdV I apologize. To clarify things, I hastily fabricated a small public, contacts and result this morning before leaving to work, but i realize now that it contradicts my previous explanation of the problem.  I should have input on the example more managers, to match with the clients I have in the public sheet, but with haste comes the mistakes.  Nevertheless, aparently you were able to extrapolate the correct information and your solution seems to be what I need.  I will try to implement this afternoon and bring back a feedback. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 12223771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d2c5bab7e93848ef7a442d4f6512cb?s=128&d=identicon&r=PG&f=1", "display_name": "class5cat", "link": "https://stackoverflow.com/users/12223771/class5cat"}, "edited": false, "score": 0, "creation_date": 1571224750, "post_id": 58406307, "comment_id": 103167170, "body": "Hi @xyz! I haven&#39;t been able to try your solution yet, but I will give it a try during the day. Thanks!"}], "tags": [], "owner": {"reputation": 258, "user_id": 3099345, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/662be73d766ce241f690ff4b1644422b?s=128&d=identicon&r=PG&f=1", "display_name": "xyz", "link": "https://stackoverflow.com/users/3099345/xyz"}, "is_accepted": false, "score": 0, "last_activity_date": 1571203874, "creation_date": 1571203874, "answer_id": 58406307, "question_id": 58405332, "link": "https://stackoverflow.com/questions/58405332/how-can-i-compare-two-sheets-and-generate-a-new-list-using-vba/58406307#58406307", "title": "How can I compare two sheets and generate a new list using VBA?", "body": "<p>As David suggested, it would be better to have an input and output sample. Maybe you can try this: </p>\n\n<pre><code>Option Explicit\n\nPublic Sub match()\n\n    Dim wsPub As Worksheet\n    Dim wsCon As Worksheet\n    Dim wsRes As Worksheet\n    Dim pubRow As Long\n    Dim conRow As Long\n    Dim resRow As Long\n    Dim i As Long\n    Dim rng As Range\n    Dim cel As Range\n    Dim found As Long\n    Dim order(1 To 5) As Integer\n\n    Set wsPub = ThisWorkbook.Worksheets(\"public\")\n    Set wsCon = ThisWorkbook.Worksheets(\"contacts\")\n    Set wsRes = ThisWorkbook.Worksheets(\"result\")\n    pubRow = wsPub.Cells(wsPub.Rows.Count, 1).End(xlUp).Row\n    conRow = wsCon.Cells(wsPub.Rows.Count, 1).End(xlUp).Row\n    resRow = wsRes.Cells(wsRes.Rows.Count, 1).End(xlUp).Row\n    Set rng = wsPub.Range(\"A2:A\" &amp; pubRow)\n    order(1) = 1\n    order(2) = 3\n    order(3) = 7\n    order(4) = 6\n    order(5) = 7\n\n    For Each cel In rng\n        If Not IsError(Application.match(cel.Value, wsCon.Range(\"A2:A\" &amp; conRow), 0)) Then\n            found = Application.match(cel.Value, wsCon.Range(\"A2:A\" &amp; conRow), 0) + 1\n            resRow = wsRes.Cells(wsRes.Rows.Count, 1).End(xlUp).Row\n\n            For i = 1 To 5\n                If i &lt; 4 Then\n                    wsRes.Cells(resRow, i).Offset(1, 0).Value _\n                    = cel.Offset(0, order(i) - 1).Value\n                Else\n                    wsRes.Cells(resRow, i).Offset(1, 0).Value _\n                    = wsCon.Cells(found, order(i)).Value\n                End If\n            Next\n        End If\n    Next\n\n    wsRes.Range(\"A1\").AutoFilter\n    wsRes.AutoFilter.Sort.SortFields.Clear\n    wsRes.AutoFilter.Sort.SortFields.Add2 Key:= _\n        Range(\"A1:A\" &amp; resRow), SortOn:=xlSortOnValues, order:=xlAscending, DataOption:= _\n        xlSortNormal\n    wsRes.AutoFilter.Sort.Apply\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 12223771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d2c5bab7e93848ef7a442d4f6512cb?s=128&d=identicon&r=PG&f=1", "display_name": "class5cat", "link": "https://stackoverflow.com/users/12223771/class5cat"}, "edited": false, "score": 0, "creation_date": 1571270733, "post_id": 58413265, "comment_id": 103188463, "body": "it works like a charm!  One last request? If I want to list on the results cl_cod, product, motn and year, how to proceed?"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1571228624, "creation_date": 1571228624, "answer_id": 58413265, "question_id": 58405332, "link": "https://stackoverflow.com/questions/58405332/how-can-i-compare-two-sheets-and-generate-a-new-list-using-vba/58413265#58413265", "title": "How can I compare two sheets and generate a new list using VBA?", "body": "<p>As per my comments, and your updated question with sample, I do believe that your current results do not match that what you say is required; which is looking for both parameters \"Branch\" and \"Manager\". Neither does your expected result look like the columns you wanted to extract according to your question. However, going by your sample data and expected output I tried the following:</p>\n\n<pre><code>Sub BuildList()\n\n'Define your variables\nDim x As Long, y As Long\nDim arr1 As Variant, arr2 As Variant\nDim dict As Object: Set dict = CreateObject(\"Scripting.Dictionary\")\n\n'Fill 1st array variable from sheet Contacts\nWith Sheet1 'Change accordingly\n    x = .Cells(.Rows.Count, 1).End(xlUp).Row\n    arr1 = .Range(\"A2:D\" &amp; x).Value\nEnd With\n\n'Fill dictionary with first array\nFor x = LBound(arr1) To UBound(arr1)\n    dict.Add arr1(x, 1) &amp; \"|\" &amp; arr1(x, 2), arr1(x, 3) &amp; \"|\" &amp; arr1(x, 4)\nNext x\n\n'Fill 2nd array variable from sheet Public\nWith Sheet2 'Change accordingly\n    x = .Cells(.Rows.Count, 1).End(xlUp).Row\n    arr2 = .Range(\"A2:B\" &amp; x).Value\nEnd With\n\n'Compare array against dictionary and fill sheet Results\nWith Sheet3 'Change accordingly\n    y = 2\n    For x = LBound(arr2) To UBound(arr2)\n        If dict.Exists(arr2(x, 1) &amp; \"|\" &amp; arr2(x, 2)) Then\n            .Cells(y, 1).Value = arr2(x, 1)\n            .Cells(y, 2).Value = arr2(x, 2)\n            .Cells(y, 3).Value = Split(dict(arr2(x, 1) &amp; \"|\" &amp; arr2(x, 2)), \"|\")(0)\n            .Cells(y, 4).Value = Split(dict(arr2(x, 1) &amp; \"|\" &amp; arr2(x, 2)), \"|\")(1)\n            y = y + 1\n        End If\n    Next x\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>This solution makes use of arrays and dictionary which should be fast. It has given me the following result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ve8D3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ve8D3.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 5, "user_id": 12223771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8d2c5bab7e93848ef7a442d4f6512cb?s=128&d=identicon&r=PG&f=1", "display_name": "class5cat", "link": "https://stackoverflow.com/users/12223771/class5cat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 58413265, "answer_count": 2, "score": 0, "last_activity_date": 1571228624, "creation_date": 1571196501, "last_edit_date": 1571224626, "question_id": 58405332, "link": "https://stackoverflow.com/questions/58405332/how-can-i-compare-two-sheets-and-generate-a-new-list-using-vba", "title": "How can I compare two sheets and generate a new list using VBA?", "body": "<p>Beforehand, be aware that I just began using VBA, and I have few coding experience prior to it.</p>\n\n<p>I have two sheets:</p>\n\n<ul>\n<li>public</li>\n<li>contacts</li>\n</ul>\n\n<p>There is one parameter on column A that is definitely on \"contacts\" sheet, but may be or not be on column A on \"public\" sheet.</p>\n\n<p>What I'm doing is:</p>\n\n<p>Checking if the parameter contacts.A2 is on public.A2.</p>\n\n<p>If it is, I need to copy columns, on the exact order:</p>\n\n<p>public: A, C, G.\ncontacts: E, F.</p>\n\n<p>I've found the following code online, and I'm running some adaptations to it, but I'm stuck.</p>\n\n<pre><code>Sub match()\n\nDim I, total, frow As Integer\nDim found As Range\n\ntotal = Sheets(\"public\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n'MsgBox (total) '(verifica se a contagem est\u00e1 ok)\n\nFor I = 2 To total\n   pesquisa = Worksheets(\"public\").Range(\"A\" &amp; I).Value\nSet found = Sheets(\"contacts\").Columns(\"A:A\").Find(what:=pesquisa) 'finds a match\n\nIf found Is Nothing Then\n    Worksheets(\"result\").Range(\"W\" &amp; I).Value = \"NO MATCH\"\nElse\n    frow = Sheets(\"contacts\").Columns(\"A:A\").Find(what:=pesquisa).Row\n    Worksheets(\"result\").Range(\"A\" &amp; I).Value = Worksheets(\"public\").Range(\"A\" &amp; frow).Value\n    Worksheets(\"result\").Range(\"B\" &amp; I).Value = Worksheets(\"public\").Range(\"C\" &amp; frow).Value\n    Worksheets(\"result\").Range(\"C\" &amp; I).Value = Worksheets(\"public\").Range(\"G\" &amp; frow).Value\n    Worksheets(\"result\").Range(\"D\" &amp; I).Value = Worksheets(\"contacts\").Range(\"F\" &amp; frow).Value\n    Worksheets(\"result\").Range(\"E\" &amp; I).Value = Worksheets(\"contacts\").Range(\"G\" &amp; frow).Value\nEnd If\nNext I\nEnd Sub\n</code></pre>\n\n<p>What I expect:</p>\n\n<ul>\n<li>to the code do ignore the line 1, as those are headers;</li>\n<li>to eliminate de IF above, since I don't need the \"NO MATCH\"</li>\n<li>to the resulting list to be ordered on ascending order, based on the A column.</li>\n</ul>\n\n<p>Can you help me?</p>\n\n<hr>\n\n<p><strong>edited to include samples of the data and expected results:</strong></p>\n\n<p>I believe I can simplify my needs with the images above. I want to check a client on the public sheet, grab the manager contacts (emails) from the contacts sheet, and create a list that contains branch, manager, and both e-mails on the results sheet.</p>\n\n<p>Creating those images, I realized I have forgotten to account for the second parameter (manager), as there can be multiple managers on a branch. So this is another parameter to account for.</p>\n\n<p>`<a href=\"https://i.stack.imgur.com/uDwDs.png\" rel=\"nofollow noreferrer\">Public sheet (image)</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/5Ywg0.png\" rel=\"nofollow noreferrer\">Contacts sheet(image)</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/BdAhQ.png\" rel=\"nofollow noreferrer\">Result sheet(image)</a></p>\n\n<p><a href=\"https://drive.google.com/file/d/1lm3flJfQMyulFT6dGI7Q8uznCcuJtiWR/view?usp=sharing\" rel=\"nofollow noreferrer\">spreadsheet</a></p>\n\n<p>`</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1571197311, "post_id": 58405084, "comment_id": 103155385, "body": "Please, show the code you tried, show some screenshots with your error and your desired output."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1571205703, "post_id": 58405084, "comment_id": 103157507, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/39217593/trouble-referencing-windows-portable-device-files-in-vba\">trouble referencing Windows Portable Device files in VBA?</a>"}], "owner": {"reputation": 11, "user_id": 12223782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d1a4940ccf374ac5e38adfa95838e1d?s=128&d=identicon&r=PG&f=1", "display_name": "MBMSOFT", "link": "https://stackoverflow.com/users/12223782/mbmsoft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1593762473, "creation_date": 1571194520, "last_edit_date": 1593762473, "question_id": 58405084, "link": "https://stackoverflow.com/questions/58405084/get-path-to-file-e-g-picture-in-android-device-e-g-cell-phone-tablet-f", "title": "Get path to file (e.g. picture) in android device (e.g. cell phone, tablet...) from vba access form", "body": "<p>I need to get path string to android device or its SD card as be able to copy or get some files(e.g. pictures) to process further...</p>\n\n<p>As I didn't find not so menu samples about...</p>\n\n<ol>\n<li>I tried go get the file with file dialog <code>f = Application.FileDialog...</code> but the directory has not been showed in the dialog.</li>\n<li>I follow some samples to get <code>getExternalFilesDir(...</code> but I get <code>Sub or function not defined</code> error message.\nSimply I need to get file from let say this address:\n<code>Computer\\HUAWEI M2-801L\\Internal storage\\DCIM\\Camera\\12.jpg</code></li>\n<li>I tried to use <code>Environ()</code> go get external directory but I didn't success to open folder.</li>\n</ol>\n\n<p>As well I need to count items there or choose the latest record etc in that directory etc.</p>\n\n<p>I tried to work with WIA COMMON DIALOG but I stuck over there as well</p>\n\n<p>please anyone to help</p>\n"}, {"tags": ["vba", "internet-explorer", "automation"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1571195461, "post_id": 58405060, "comment_id": 103155030, "body": "I don&#39;t think there&#39;s much you can do, besides trying to swallow whatever error <code>IE.Quit</code> might throw - you can do that with <code>On Error Resume Next</code>, and then you can do <code>On Error GoTo 0</code> after <code>Set IE = Nothing</code> (<code>doc</code> looks like it should already be out of scope by then though)."}], "answers": [{"tags": [], "owner": {"reputation": 6456, "user_id": 11490347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lFlKK.jpg?s=128&g=1", "display_name": "Yu Zhou", "link": "https://stackoverflow.com/users/11490347/yu-zhou"}, "is_accepted": false, "score": 0, "last_activity_date": 1571214390, "creation_date": 1571214390, "answer_id": 58408904, "question_id": 58405060, "link": "https://stackoverflow.com/questions/58405060/vba-auotmation-closing-ie-before-ie-quit-runs-freezes-excel/58408904#58408904", "title": "VBA Auotmation - Closing IE Before IE.Quit Runs Freezes Excel", "body": "<p>I'm agree with what Mathieu says. The freeze is due to the waiting is still being executed. Everything you put after <code>Application.Wait</code> will be executed after the waiting--which is to say after \"the freeze\". </p>\n\n<p>You can only add <code>On Error Resume Next</code> after <code>Application.Wait (Now + TimeValue(\"00:00:55\"))</code> to avoid the error display, but you can't stop the waiting. </p>\n"}], "owner": {"reputation": 25, "user_id": 12167866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca6731abe7a10aa94715fcbefb2ac62?s=128&d=identicon&r=PG&f=1", "display_name": "FeiLong001", "link": "https://stackoverflow.com/users/12167866/feilong001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571214390, "creation_date": 1571194300, "question_id": 58405060, "link": "https://stackoverflow.com/questions/58405060/vba-auotmation-closing-ie-before-ie-quit-runs-freezes-excel", "title": "VBA Auotmation - Closing IE Before IE.Quit Runs Freezes Excel", "body": "<p>I have some code which closes IE after some VBA Website Automation (after waiting for a period of time).</p>\n\n<pre><code>Application.Wait (Now + TimeValue(\"00:00:55\"))\nIE.Quit\nSet IE = Nothing\nSet doc = Nothing\n</code></pre>\n\n<p>The problem is that if someone inadvertently closes IE before the IE.Quit code executes, Excel freezes because the IE property no longer exists.</p>\n\n<p>I've tried something like this (please see below code excerpt) but Excel still freezes if it's closed before the timer executes the code (Run-Time error '462', The remote server machine does not exist or is unavailable):</p>\n\n<pre><code>Application.Wait (Now + TimeValue(\"00:00:55\"))\nIf IE Is Nothing Then\n    'do nothing\nElse\n    IE.Quit\n    Set IE = Nothing\n    Set doc = Nothing\nEnd If\n</code></pre>\n\n<p>Any ideas or guidance would be much appreciated.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": true, "score": 2, "last_activity_date": 1571290284, "last_edit_date": 1571290284, "creation_date": 1571191437, "answer_id": 58404777, "question_id": 58404357, "link": "https://stackoverflow.com/questions/58404357/excel-vba-change-current-color-in-color-picker/58404777#58404777", "title": "Excel VBA - Change current color in color picker", "body": "<p><a href=\"https://www.thespreadsheetguru.com/the-code-vault/vba-add-recent-colors-to-palette\" rel=\"nofollow noreferrer\">This article</a> by The Spreadsheet Guru can help you to achieve this. The article is written in case you want to add multiple colors to the recent colors section of the palette, but you can easily use that method for a single color (by editing the array in the code below to include just one RGB color code) and that will result in that color being the one selected for the user.</p>\n\n<p>The suggested code in the article is the following:</p>\n\n<blockquote>\n<pre><code>'Declare Sleep() API\n  #If VBA7 Then ' Excel 2010 or later\n    Public Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal Milliseconds As LongPtr)\n  #Else ' Excel 2007 or earlier\n    Public Declare Sub Sleep Lib \"kernel32\" (ByVal Milliseconds As Long)\n  #End If\n\nSub LoadRecentColors()\n'PURPOSE: Use A List Of RGB Codes To Load Colors Into Recent Colors Section of Color Palette\n'SOURCE: www.TheSpreadsheetGuru.com/the-code-vault\n\nDim ColorList As Variant\nDim CurrentFill As Variant\n\n'Array List of RGB Color Codes to Add To Recent Colors Section (Max 10)\n  ColorList = Array(\"066,174,093\", \"184,055,038\", \"046,062,081\", \"056,160,133\")\n\n'Store ActiveCell's Fill Color (if applicable)\n  If ActiveCell.Interior.ColorIndex &lt;&gt; xlNone Then CurrentFill = ActiveCell.Interior.Color\n\n'Optimize Code\n  Application.ScreenUpdating = False\n\n'Loop Through List Of RGB Codes And Add To Recent Colors\n  For x = LBound(ColorList) To UBound(ColorList)\n    ActiveCell.Interior.Color = RGB(Left(ColorList(x), 3), Mid(ColorList(x), 5, 3), Right(ColorList(x), 3))\n    DoEvents\n    SendKeys \"%h\"\n    Sleep 500 'Pause half-second (units in milliseconds)\n    SendKeys \"h\"\n    Sleep 500 'Pause half-second (units in milliseconds)\n    SendKeys \"m\"\n    Sleep 500 'Pause half-second (units in milliseconds)\n    SendKeys \"~\"\n    Sleep 500 'Pause half-second (units in milliseconds)\n    DoEvents\n  Next x\n\n'Return ActiveCell Original Fill Color\n  If CurrentFill = Empty Then\n    ActiveCell.Interior.ColorIndex = xlNone\n  Else\n    ActiveCell.Interior.Color = currentColor\n  End If\n\nEnd Sub\n</code></pre>\n</blockquote>\n\n<p>However, I would suggest to always set the <code>wait</code> argument of the SendKeys method to <code>true</code> in order to let VBA know it has to wait for the key press to be processed before continuing (e.g. <code>SendKeys \"%h\", True</code>). It will increase the probability that your key press will be registered and executed properly.</p>\n\n<p>I'm not sure, but since this whole procedure is running within Excel and there is no other application involved, it might not even be necessary to use the <code>Sleep</code> function after each key press, but it's never a bad idea to be overly cautious with the SendKeys method.</p>\n\n<p>So, that will work for the filling tool. Now, for the font color, the shortcut should be Alt+H,FC,M</p>\n"}], "owner": {"reputation": 434, "user_id": 8783311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe3948e7f0f1a9e258e7eaa9c94a665?s=128&d=identicon&r=PG&f=1", "display_name": "jblack", "link": "https://stackoverflow.com/users/8783311/jblack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 58404777, "answer_count": 1, "score": 2, "last_activity_date": 1571290284, "creation_date": 1571187487, "question_id": 58404357, "link": "https://stackoverflow.com/questions/58404357/excel-vba-change-current-color-in-color-picker", "title": "Excel VBA - Change current color in color picker", "body": "<p>How do i change the current color in Excel's color picker? I've googled and have absolutely no idea how to do this. I have seen this <code>Application.Dialogs(xlDialogEditColor)</code> but it's not what I want.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4aG68.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4aG68.png\" alt=\"enter image description here\"></a></p>\n\n<p>Basically, when i run my macro it will set the colors in the color picker (font &amp; fill color pickers) to a specified color. For example, if the specified color is red then this is what will happen</p>\n\n<p><a href=\"https://i.stack.imgur.com/Mh1Lf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Mh1Lf.png\" alt=\"enter image description here\"></a></p>\n\n<p>any assistance will be appreciated, thanks</p>\n"}, {"tags": ["html", "vba", "unicode", "ms-word", "diacritics"], "comments": [{"owner": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "edited": false, "score": 1, "creation_date": 1571207728, "post_id": 58404356, "comment_id": 103158268, "body": "Just curious; which characters in which languages have that diacritic?"}, {"owner": {"reputation": 33, "user_id": 11829140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3qgW.png?s=128&g=1", "display_name": "schefflaa", "link": "https://stackoverflow.com/users/11829140/schefflaa"}, "reply_to_user": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "edited": false, "score": 0, "creation_date": 1571241924, "post_id": 58404356, "comment_id": 103177650, "body": "@MrLister some latin- and greek-based languages make use of these diacritics, in order to specify the exact pronounciation. But I have no linguistic backround tbh, so don&#39;t take this at face value; I&#39;m just here to programm this"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11818836"}, "edited": false, "score": 0, "creation_date": 1573905925, "post_id": 58404356, "comment_id": 104046802, "body": "For the specific case where the combo looks like U+1FCD or U+1FCE, <i>in Word</i> you can use an EQ field, e.g. { EQ \\o(a,\u1fce)} or using a Math Equation. e.g. copy the following MathML and paste it into a Word document, then make it Inline: &lt;math xmlns=&quot;<a href=\"http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mover\" rel=\"nofollow noreferrer\">w3.org/1998/Math/MathML&quot;&gt;&lt;mover</a> accent=&quot;true&quot;&gt;&lt;mtext&gt;a&lt;/mtext&gt;&lt;mo&gt;&amp;#x1FCE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mat&zwnj;&#8203;h&gt;. The first of those won&#39;t help you on the Web, but the MathML representation might, depending on the browser (my test put the accent too high). Perhaps CSS can help. Experiments using MathML multiple accent characters not so successful."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11818836"}, "edited": false, "score": 0, "creation_date": 1573906103, "post_id": 58404356, "comment_id": 104046843, "body": "BTW I suspect a lot of people here would not regard this as a &quot;programming question&quot; as far as SO is concerned - possibly why it has been downmarket."}, {"owner": {"reputation": 33, "user_id": 11829140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3qgW.png?s=128&g=1", "display_name": "schefflaa", "link": "https://stackoverflow.com/users/11829140/schefflaa"}, "edited": false, "score": 0, "creation_date": 1574188373, "post_id": 58404356, "comment_id": 104139874, "body": "okay I am going to try this stuff out and update this thread based on my findings; thanks everyone!"}, {"owner": {"reputation": 33, "user_id": 11829140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3qgW.png?s=128&g=1", "display_name": "schefflaa", "link": "https://stackoverflow.com/users/11829140/schefflaa"}, "reply_to_user": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "edited": false, "score": 0, "creation_date": 1611250513, "post_id": 58404356, "comment_id": 116397047, "body": "@MrLister the italian language uses it (or at least has used it the past)"}], "answers": [{"comments": [{"owner": {"reputation": 4539, "user_id": 1698431, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lpYwg.png?s=128&g=1", "display_name": "lenz", "link": "https://stackoverflow.com/users/1698431/lenz"}, "edited": false, "score": 0, "creation_date": 1571225192, "post_id": 58407099, "comment_id": 103167412, "body": "Why do you say &quot;In Word&quot;? These are the offical codepoint names according to Unicode, nothing nothing to do with MS Word..."}, {"owner": {"reputation": 33, "user_id": 11829140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3qgW.png?s=128&g=1", "display_name": "schefflaa", "link": "https://stackoverflow.com/users/11829140/schefflaa"}, "edited": false, "score": 0, "creation_date": 1571240895, "post_id": 58407099, "comment_id": 103177171, "body": "@macropod Well yes, that is true. But the &#39;combining reversed comma above&#39; (0314) is still not the same as the required &#39;combining comma above left&#39; (non-existent) as it is just the mirrored version of the &#39;combining comma above right&#39; (0314), isn&#39;t it?"}, {"owner": {"reputation": 33, "user_id": 11829140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3qgW.png?s=128&g=1", "display_name": "schefflaa", "link": "https://stackoverflow.com/users/11829140/schefflaa"}, "edited": false, "score": 0, "creation_date": 1571243105, "post_id": 58407099, "comment_id": 103178183, "body": "@macropod Also when combining the mirrord comma with e.g. an acute tone mark the <a href=\"https://imgur.com/a/jDOuvsu\" rel=\"nofollow noreferrer\">diarcital marks interfere with each other</a>"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1571265072, "post_id": 58407099, "comment_id": 103187176, "body": "I said &quot;In Word&#39; because that&#39;s what you see in the Insert|Symbol dialogue box for these Unicode characters."}, {"owner": {"reputation": 33, "user_id": 11829140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3qgW.png?s=128&g=1", "display_name": "schefflaa", "link": "https://stackoverflow.com/users/11829140/schefflaa"}, "edited": false, "score": 0, "creation_date": 1571274708, "post_id": 58407099, "comment_id": 103189226, "body": "@macropod Yeah I got that; still does not solve the problem unfortunately. Or was this a reply to user-lenz"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1571278672, "post_id": 58407099, "comment_id": 103190011, "body": "My previous comment was in reply to lenz - as I&#39;d have thought was quite obvious. Regarding the conflicting diacritics, the behaviour is to some extent dependent on the order in which they&#39;re inserted. For example, you can insert Unicode 0315 followed by Unicode 0301 - the latter appears above the former - but not the other way around."}, {"owner": {"reputation": 33, "user_id": 11829140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3qgW.png?s=128&g=1", "display_name": "schefflaa", "link": "https://stackoverflow.com/users/11829140/schefflaa"}, "edited": false, "score": 0, "creation_date": 1571346641, "post_id": 58407099, "comment_id": 103221195, "body": "@macropod Sure thing! I still need to display the comma and the acute above the base character, but <b>on the same height</b>. For example <a href=\"https://imgur.com/a/COnPTT9\" rel=\"nofollow noreferrer\">like this</a> (acute tone mark &amp; comma above right), but with the diacritcal marks swapped (so <i>comma above left</i> &amp; acute tone mark)."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1571713067, "post_id": 58407099, "comment_id": 103322449, "body": "For something like that you might use Unicode 0107 (small C with acute) preceded by Unicode 0315 (combining comma above right)."}, {"owner": {"reputation": 33, "user_id": 11829140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3qgW.png?s=128&g=1", "display_name": "schefflaa", "link": "https://stackoverflow.com/users/11829140/schefflaa"}, "edited": false, "score": 0, "creation_date": 1571785538, "post_id": 58407099, "comment_id": 103353973, "body": "@macropod Sadly no, as the 0107 (small C with acute) character behaves the same as combining the seperate characters (small c + combining acute accent). The important part here is the difference between the combining acute accent and the combining acute tone mark. The tone mark allows another combining character on the same height, what raises the earlier described interference problem when using the regular (-not left-) comma above. Using the acute accent (pre-combined as in 0107 or manually combined [0063 + 0301]) does not allow another combining diacritical mark on the same height, see <code>\u0107\u0313</code>"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1571809593, "post_id": 58407099, "comment_id": 103358702, "body": "The sequence I suggested places the diacritic comma on the same level as the acute. Do make sure both employ the same font &amp; point size."}, {"owner": {"reputation": 33, "user_id": 11829140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3qgW.png?s=128&g=1", "display_name": "schefflaa", "link": "https://stackoverflow.com/users/11829140/schefflaa"}, "edited": false, "score": 0, "creation_date": 1571844339, "post_id": 58407099, "comment_id": 103377025, "body": "@macropod can you paste in the result as I did in my previous message? Because I tried it again, using the exact sequence you suggested an keep getting this <code>\u0107\u0313</code> as the result. Idenpendently of the way I combine this character (with my macro or manually via Insert &gt; Symbol) the result is the same."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1571865063, "post_id": 58407099, "comment_id": 103385883, "body": "Insert the Unicode 0107 first, then move the insertion point back one position before inserting the Unicode 0315. That way you&#39;ll get \u0315\u0107 (but with the result displayed better than it does here - both the \u0315 and the \u0301 will be displayed at the same height)."}, {"owner": {"reputation": 33, "user_id": 11829140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3qgW.png?s=128&g=1", "display_name": "schefflaa", "link": "https://stackoverflow.com/users/11829140/schefflaa"}, "edited": false, "score": 0, "creation_date": 1571872288, "post_id": 58407099, "comment_id": 103387819, "body": "@macropod Oh I am so sorry, I was using 0314 the entire time; now I see what you&#39;re describing. This does raise another problem though, inserting the 0315 character before 0107 will bind it to the previous character (if it exists). So if a word starts with \u0315\u0107 thats no problem but as soon as the &#39;c&#39;-character is within a word like for example &#39;ma\u0315\u0107ro&#39; you can see how it will be bound to the &#39;a&#39;-character in this case"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1571892615, "post_id": 58407099, "comment_id": 103391617, "body": "Try Ma\u02bc\u0107ro, with the &#39;a&#39; horizontal spacing condensed by 1/6th the point size and the &#39;\u02bc&#39; horizontal spacing condensed by 1/4th the point size. FWIW, I know of no latin-based or greek-based language that makes use of such a diacritic combination. Greek has its own extensive character set that includes all diacritic combinations known to me."}, {"owner": {"reputation": 33, "user_id": 11829140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3qgW.png?s=128&g=1", "display_name": "schefflaa", "link": "https://stackoverflow.com/users/11829140/schefflaa"}, "edited": false, "score": 0, "creation_date": 1573008910, "post_id": 58407099, "comment_id": 103737228, "body": "@macropod I&#39;ve noticed, that many greek characters have this combination already, for example \u1f64 (U+1F64). Using Latin base characters and combining diacritical marks (as well as the combining acute and not the tone mark) causes the combination to not be displayed as desired: a\u0313\u0301 (0061+0313+0301).  However, with Greek base characters the desired result is achievable: \u03b1\u0313\u0301 (03B1+0313+0301) or \u03b5\u0313\u0301 (03B5+0313+0301)  In addition to that a precomposed version of this exists as a regular character: \u1fce (1FCE) that is sadly not combinable."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1573103633, "post_id": 58407099, "comment_id": 103773900, "body": "So why are you trying to combine characters when all valid combinations are already available as single characters?"}, {"owner": {"reputation": 33, "user_id": 11829140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3qgW.png?s=128&g=1", "display_name": "schefflaa", "link": "https://stackoverflow.com/users/11829140/schefflaa"}, "edited": false, "score": 0, "creation_date": 1573151964, "post_id": 58407099, "comment_id": 103797860, "body": "@macropod Well it is <b>not</b> possible for latin base characters. So a regular &#39;c&#39; or a &#39;g&#39; is neither combinable with \u1fce (U+1FCE) (<i>obviously, as it is a standalone character and not a combining one</i>) nor with the &#39;combining comma above&#39; (U+0313) + &#39;combining acute accent&#39; (U+0301) in order to get the desired result (which is \u1fce on top of them)."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1573189371, "post_id": 58407099, "comment_id": 103808371, "body": "And who uses these obscure characters?"}, {"owner": {"reputation": 33, "user_id": 11829140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3qgW.png?s=128&g=1", "display_name": "schefflaa", "link": "https://stackoverflow.com/users/11829140/schefflaa"}, "edited": false, "score": 0, "creation_date": 1573232794, "post_id": 58407099, "comment_id": 103827892, "body": "@macropod The comma above is quite usual in the elder versions of phonological and phonetical transkriptions. The whole traditional romance philology (dialectology) used it, naturally mainly in combination with the velars K and G that become palatal. In combination with the accent it means &quot;palatalization and affricativation&quot;. So yes, it is used in many texts (s. above). It is quite frequent."}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 1, "last_activity_date": 1571207729, "creation_date": 1571207729, "answer_id": 58407099, "question_id": 58404356, "link": "https://stackoverflow.com/questions/58404356/combining-diacritical-marks-like-the-comma-above-and-acute-accent-with-latin-bas/58407099#58407099", "title": "Combining diacritical marks like the comma above and acute accent with Latin base characters", "body": "<p>In Word, Unicode 0315 is known as a 'combining comma above right'. The reverse form of this is Unicode 0314, which is known as a 'combining reversed comma above'. There are also Unicode 0312, known as a 'combining turned comma above' and Unicode 0313, known as a 'combining comma above'.</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 11829140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3qgW.png?s=128&g=1", "display_name": "schefflaa", "link": "https://stackoverflow.com/users/11829140/schefflaa"}, "is_accepted": true, "score": 1, "last_activity_date": 1611577970, "last_edit_date": 1611577970, "creation_date": 1611223162, "answer_id": 65825005, "question_id": 58404356, "link": "https://stackoverflow.com/questions/58404356/combining-diacritical-marks-like-the-comma-above-and-acute-accent-with-latin-bas/65825005#65825005", "title": "Combining diacritical marks like the comma above and acute accent with Latin base characters", "body": "<p>After reaching out to <a href=\"https://home.unicode.org/\" rel=\"nofollow noreferrer\">the Unicode Consortium</a> this was the answer of one of their representatives:</p>\n<blockquote>\n<p>I checked the Unicode code chart and consulted with other Unicode experts. The code point that should be used, in the view of the experts, is: U+0313 COMBINING COMMA ABOVE.\nIn the Phonetic Symbol Guide, the entry for \u201capostrophe\u201d mentions its use for palatalization (by Slavicists), besides its use for ejectives or glottalized consonants, and states it can appear following the symbol or over the symbol.\nHowever, I tried out U+0313 on various fonts, and see fonts don't work as you wish: the acute and COMBINING COMMA ABOVE stack (or collide), instead of appearing beside one another. To rectify the situation, you should contact the font providers and ask them to adjust the font - or do it yourself if you have the tools.\nI hope this is helpful. (Using an already encoded  Unicode code point will save 2+ years of waiting for a new character.)</p>\n</blockquote>\n<p>Our solution to this problem was to create a custom font that moves the U+1FCE character on top of the base character, effectively making it a <em>combining</em> one. This font will also be used for our web applications, so not just MS-Word.</p>\n"}], "owner": {"reputation": 33, "user_id": 11829140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3qgW.png?s=128&g=1", "display_name": "schefflaa", "link": "https://stackoverflow.com/users/11829140/schefflaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 65825005, "answer_count": 2, "score": 0, "last_activity_date": 1611577970, "creation_date": 1571187480, "last_edit_date": 1573152385, "question_id": 58404356, "link": "https://stackoverflow.com/questions/58404356/combining-diacritical-marks-like-the-comma-above-and-acute-accent-with-latin-bas", "title": "Combining diacritical marks like the comma above and acute accent with Latin base characters", "body": "<p>I am developing a solution for MS Word (using VBA) and websites (using HTML/CSS/JS) enabling an efficient typing of character combinations that consist of multiple diacritical marks, such as <code>\u0153\u0323\u0304\u0303\u0301</code>, for example. </p>\n\n<p>A prototype solution has already been implemented, though I've stumbled across one single difficulty that I may not be able to solve without any support.</p>\n\n<p>I need to display <a href=\"https://i.stack.imgur.com/sLCzf.png\" rel=\"nofollow noreferrer\">these characters</a> which consist of the 'combining comma above' (U+0313) and 'combining acute accent' (U+0301). The current result I am getting is a stacked version <code>c\u0313\u0301</code>, though I need the diacritics to be side by side. This is possible with Greek base characters like <code>\u03b1\u0313\u0301</code>(03B1+0313+0301) for example, but not with Latin ones.</p>\n\n<p>Even a standalone version exists: \u1fce(U+1FCE) that is sadly not combinable.</p>\n\n<p>How can I solve this problem?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1571185945, "post_id": 58403965, "comment_id": 103153320, "body": "If you show your current code I&#39;m sure you&#39;ll get useful suggestions.  Find() or Match() seem like good ways to go here."}, {"owner": {"reputation": 258, "user_id": 3099345, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/662be73d766ce241f690ff4b1644422b?s=128&d=identicon&r=PG&f=1", "display_name": "xyz", "link": "https://stackoverflow.com/users/3099345/xyz"}, "edited": false, "score": 0, "creation_date": 1571193436, "post_id": 58403965, "comment_id": 103154695, "body": "Would you like the a large range, like the row or column where it was found, or the exact cell?"}], "owner": {"reputation": 141, "user_id": 10673029, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gXWScLerMo8/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gK2vouoAQwpm8qHmzHCnJNyOcPTg/mo/photo.jpg?sz=128", "display_name": "Charlieeeeeeeeee", "link": "https://stackoverflow.com/users/10673029/charlieeeeeeeeee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571208996, "creation_date": 1571183465, "last_edit_date": 1571208996, "question_id": 58403965, "link": "https://stackoverflow.com/questions/58403965/how-to-find-a-specific-value-in-an-entire-worksheet-then-return-the-specific-ran", "title": "How to find a specific value in an entire worksheet then return the specific range where the value was found", "body": "<p>I'm creating a new vba code for finding a specific value in a worksheet and returning the range where I find the value. </p>\n\n<p>I've already tried the <code>COUNTIF</code> function and it only returns the number that it found on the worksheet. What I want is to return where specific range where the specific value was found.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1571182047, "post_id": 58403758, "comment_id": 103152564, "body": "What have you tried, and what problems did you run into?  This could be done using a pretty simple loop."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 12030555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe35b2d5226bc991659d598cd4d5fe5a?s=128&d=identicon&r=PG&f=1", "display_name": "Donald", "link": "https://stackoverflow.com/users/12030555/donald"}, "edited": false, "score": 0, "creation_date": 1571214600, "post_id": 58405108, "comment_id": 103161707, "body": "Worked! Thank you"}], "tags": [], "owner": {"reputation": 258, "user_id": 3099345, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/662be73d766ce241f690ff4b1644422b?s=128&d=identicon&r=PG&f=1", "display_name": "xyz", "link": "https://stackoverflow.com/users/3099345/xyz"}, "is_accepted": true, "score": 0, "last_activity_date": 1571194648, "creation_date": 1571194648, "answer_id": 58405108, "question_id": 58403758, "link": "https://stackoverflow.com/questions/58403758/how-to-copy-a-list-of-data-from-one-worksheet-to-another-and-spaced-out/58405108#58405108", "title": "How to copy a list of data from one worksheet to another and spaced out", "body": "<p>You can try this: </p>\n\n<pre><code>Option Explicit\n\nPublic Sub test()\n\n    Dim ws As Worksheet\n    Dim ws2 As Worksheet\n    Dim lrow As Long\n    Dim i As Long\n    Dim j As Long\n\n    Set ws = ThisWorkbook.Worksheets(\"Services\")\n    Set ws2 = ThisWorkbook.Worksheets(\"Data\")\n    lrow = ws.Cells(ws.Rows.Count, 2).End(xlUp).Row\n    j = 12\n\n    For i = 1 To lrow\n        ws2.Cells(j, 2).Value = ws.Cells(i, 2).Value\n        j = j + 8\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 12030555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe35b2d5226bc991659d598cd4d5fe5a?s=128&d=identicon&r=PG&f=1", "display_name": "Donald", "link": "https://stackoverflow.com/users/12030555/donald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 58405108, "answer_count": 1, "score": 0, "last_activity_date": 1571194648, "creation_date": 1571181742, "question_id": 58403758, "link": "https://stackoverflow.com/questions/58403758/how-to-copy-a-list-of-data-from-one-worksheet-to-another-and-spaced-out", "title": "How to copy a list of data from one worksheet to another and spaced out", "body": "<p>I am unsure how I would go about doing this, so I have a \u201cservices\u201d worksheet that holds a list on services starting from B1 and down - this can be a infinite amount so assume the code would go to rowend. </p>\n\n<p>I have another worksheet called \u201cData\u201d and what I want is for the first field in B1 from \u201cServices\u201d to be copied into the \u201cData\u201d worksheet field B12 and then for each of all the other services to be copied 7 spaces down - so a 7 space gap between each of the services in the \u201cServices\u201d worksheet (starting from B12 in the data worksheet)</p>\n\n<p>How would I go about doing this?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1571181652, "post_id": 58403544, "comment_id": 103152487, "body": "What does stepping through the code in the debugger tell you?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1571181846, "post_id": 58403544, "comment_id": 103152522, "body": "I&#39;m not certain what you are trying to do but it&#39;s entirely likely that you can replace most of this code with the correct SQL query"}, {"owner": {"reputation": 95, "user_id": 1262602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4869b67f0ed65f9deacfe1c7102f65c5?s=128&d=identicon&r=PG", "display_name": "the1gofer", "link": "https://stackoverflow.com/users/1262602/the1gofer"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1571182809, "post_id": 58403544, "comment_id": 103152725, "body": "@Nick.McDermaid. My table has information associated with addresses.  When the query starts I don&#39;t know what or how many there will be.  There may be multiple rows with the same address so I want to group them by address.    my idea was to get a list of addresses, then as I loop through those addresses using it to  filter another query with the information I want to display. Using nested loops to get the grouping If I do that, I don&#39;t get an error, but it hangs the program.  What sql would you suggest?"}, {"owner": {"reputation": 95, "user_id": 1262602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4869b67f0ed65f9deacfe1c7102f65c5?s=128&d=identicon&r=PG", "display_name": "the1gofer", "link": "https://stackoverflow.com/users/1262602/the1gofer"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1571182946, "post_id": 58403544, "comment_id": 103152749, "body": "@KenWhite I don&#39;t know how to do that.  I&#39;ll have to look it up.  Thanks"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1571183093, "post_id": 58403544, "comment_id": 103152783, "body": "There&#39;s not enough info provided to suggest a SQL query but it sounds like you are just doing a standard SQL join between two tables"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1571183274, "post_id": 58403544, "comment_id": 103152829, "body": "See the <code>Debug</code> menu. Use F9 to set a breakpoint on the first line of your outer loop, and then run to there. Use F8 to step through the code line by line to see what it&#39;s doing. If you loop without hitting a <code>MoveNext</code>, you&#39;ll know where you missed it."}, {"owner": {"reputation": 95, "user_id": 1262602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4869b67f0ed65f9deacfe1c7102f65c5?s=128&d=identicon&r=PG", "display_name": "the1gofer", "link": "https://stackoverflow.com/users/1262602/the1gofer"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1571183972, "post_id": 58403544, "comment_id": 103152945, "body": "@Nick.McDermaid Does my edit help."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1571195849, "post_id": 58403544, "comment_id": 103155107, "body": "Well in theory you could return all of the data in one joined dataset and rather than do an inner query for each address, just recognise when the address value changes, and if so start another new grouping. But what you have is probably fine. Now you just have to follow existing advice and use debugging to confirm what&#39;s going on. &quot;hanging&quot; could be an endless loop or it could be something else. You need to understand more details about &quot;hanging&quot;"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1571277649, "post_id": 58403544, "comment_id": 103189794, "body": "Why using HTML tags? Where are you using address string? I don&#39;t use QueryDefs just to open a recordset object."}, {"owner": {"reputation": 95, "user_id": 1262602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4869b67f0ed65f9deacfe1c7102f65c5?s=128&d=identicon&r=PG", "display_name": "the1gofer", "link": "https://stackoverflow.com/users/1262602/the1gofer"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1571326305, "post_id": 58403544, "comment_id": 103212412, "body": "@June7  I am going to be using outlook to send it, and I want the default signiture to attach.  It doesn&#39;t work that way unless I go HTML.  it&#39;s a lot simpler to use reports, sure, but unfortunately, the people I am emailing don&#39;t like the attachments."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 1262602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4869b67f0ed65f9deacfe1c7102f65c5?s=128&d=identicon&r=PG", "display_name": "the1gofer", "link": "https://stackoverflow.com/users/1262602/the1gofer"}, "edited": false, "score": 0, "creation_date": 1571326392, "post_id": 58412246, "comment_id": 103212468, "body": "It was a combination of this, and a few other errors with how I had the loops working.  after a few tweaks I have it more or less working."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 1, "last_activity_date": 1571225393, "creation_date": 1571225393, "answer_id": 58412246, "question_id": 58403544, "link": "https://stackoverflow.com/questions/58403544/how-to-fix-this-code-from-crashing-access-i-assume-through-some-error-with-the/58412246#58412246", "title": "How to fix this code from crashing access. I assume through some error with the loop", "body": "<p>Filter criteria has syntax errors. Need a space in front of AND. Quote mark delimiters are wrong. Use apostrophe instead of trying to double up quote mark.</p>\n\n<p><code>rst.filter = \"submission_number=\" &amp; strID &amp; \" AND Address='\" &amp; rstAddressFiltered!Address &amp; \"'\"</code></p>\n"}], "owner": {"reputation": 95, "user_id": 1262602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4869b67f0ed65f9deacfe1c7102f65c5?s=128&d=identicon&r=PG", "display_name": "the1gofer", "link": "https://stackoverflow.com/users/1262602/the1gofer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 58412246, "answer_count": 1, "score": 0, "last_activity_date": 1577954392, "creation_date": 1571179794, "last_edit_date": 1577954392, "question_id": 58403544, "link": "https://stackoverflow.com/questions/58403544/how-to-fix-this-code-from-crashing-access-i-assume-through-some-error-with-the", "title": "How to fix this code from crashing access. I assume through some error with the loop", "body": "<p>I got it to just make a list of everything, but I need to do some grouping. my idea was to get a list of addresses, then as I loop through those addresses, filter another query with the information I want to display. If I do that, I don't get an error, but it hangs the program. I'm assuming it's a problem with the loop, but I'm not sure how. Any suggestions?</p>\n\n<pre><code>Public Function getActionItems(strID As String, strType As String) As String\n\n    Dim dbs As DAO.Database\n    Dim qdf As DAO.QueryDef\n    Dim qdfAddress As DAO.QueryDef\n    Dim rst As DAO.Recordset\n    Dim rstAddress As DAO.Recordset\n    Dim s As String\n\n    Set dbs = CurrentDb\n\n    'Get the parameter query\n    Set qdf = dbs.QueryDefs(\"qryActionItems\")\n    Set qdfAddress = dbs.QueryDefs(\"qryActionItemsAddresses\")\n\n    'get all records\n    Set rst = qdf.OpenRecordset()\n    Set rstAddress = qdfAddress.OpenRecordset()\n\n    'get all records with the submisison number\n    rstAddress.filter = \"submission_number=\" &amp; strID\n    Set rstAddressFiltered = rstAddress.OpenRecordset\n\n    'cycle through the addresses\n    If Not rstAddressFiltered.EOF Then\n        rstAddressFiltered.MoveFirst\n\n        s = s + \"&lt;strong&gt;\" &amp; rstAddressFiltered!Address &amp; \"&lt;/strong&gt;\" &amp; vbLf &amp; \"&lt;ol&gt;\"\n\n        Do\n            'filter for the address\n            rst.filter = \"submission_number=\" &amp; strID &amp; \"AND Address=\" &amp; \"\"\" &amp; rstAddressFiltered!Address &amp; \"\"\"\n            Set rstFiltered = rst.OpenRecordset\n\n            'cycle through the records with the address\n            If Not rstFiltered.EOF Then\n                rstFiltered.MoveFirst\n                Do\n                    s = s + vbTab &amp; \"&lt;li&gt;\" &amp; rstFiltered!Address &amp; \" - \" &amp; rstFiltered!Notes &amp; \" - \" &amp; rstFiltered!Due_date &amp; \"&lt;/li&gt;\" &amp; vbLf\n                    rstFiltered.MoveNext\n                Loop Until rstFiltered.EOF\n            End If\n\n        Loop Until rstAddressFiltered.EOF\n\n        s = s + \"&lt;/ol&gt;\"\n\n    End If\n\nEnd Function\n</code></pre>\n\n<p>Edit:  I think it may be that I missed the .movenext, but I haven\u2019t had a chance to try it.</p>\n\n<p>The main query has\nsubmission_number, type, address, notes</p>\n\n<p>I'm trying to get something like\n123 main st</p>\n\n<ul>\n<li>Foo bar</li>\n<li>Bar foo</li>\n</ul>\n\n<p>126 main st</p>\n\n<ul>\n<li>Notes </li>\n</ul>\n\n<p>When I run the query I won't know what or how many addresses I have.  So I thought I would use query1 to grab the addresses, then use the addresses in <code>query1</code> to filter <code>query2</code>, printing those results.  </p>\n\n<p>If you see a better approach, I'm open! </p>\n"}, {"tags": ["python", "excel", "vba", "pdf-generation", "win32com"], "answers": [{"tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": false, "score": 1, "last_activity_date": 1571207030, "last_edit_date": 1571207030, "creation_date": 1571205778, "answer_id": 58406679, "question_id": 58403161, "link": "https://stackoverflow.com/questions/58403161/export-excel-file-to-pdf-format-without-loosing-hyperlink-functionality/58406679#58406679", "title": "Export Excel file to PDF format without loosing hyperlink functionality", "body": "<p>This isn't exactly something simple and formatting might be an issue, but if what you have in your Excel file are simple tables with text and numbers (without images or fancy formatting), there might be a way using LaTeX:</p>\n\n<ol>\n<li>Export the Excel content in LaTeX format. You can find already existing packages for VBA (<a href=\"https://github.com/krlmlr/Excel2LaTeX\" rel=\"nofollow noreferrer\">like this one</a>) or for Python (<a href=\"https://github.com/michaelkirker/excel2latexviapython\" rel=\"nofollow noreferrer\">like this one</a>)that can do that or at least be a good starting point.</li>\n<li>In the LaTeX file, do a find and replace to change your links to the right format for LaTeX and add the section info. (See <a href=\"https://tex.stackexchange.com/questions/180571/making-clickable-links-to-sections-with-hyperref\">this question</a> for more details).</li>\n<li>Compile the LaTeX file to a PDF via VBA (using a shell command) or Python.</li>\n</ol>\n"}], "owner": {"reputation": 809, "user_id": 11903343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f82e39111c9664313c9569da0d458618?s=128&d=identicon&r=PG&f=1", "display_name": "Clade", "link": "https://stackoverflow.com/users/11903343/clade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1571207030, "creation_date": 1571176687, "question_id": 58403161, "link": "https://stackoverflow.com/questions/58403161/export-excel-file-to-pdf-format-without-loosing-hyperlink-functionality", "title": "Export Excel file to PDF format without loosing hyperlink functionality", "body": "<p>I use the following code to read in an Excel file and export select sheets to a PDF:</p>\n\n<pre><code>import win32com.client\n\nxlsx_path = \"\" #insert path to excel file\npdf_path = \"\" #insert path to pdf output\n\nexcel = win32com.client.gencache.EnsureDispatch(\"Excel.Application\")\nwb = excel.Workbooks.Open(xlsx_path)\nsheet_list = [\"Sheet1\", \"Sheet2\"]\nwb.Worksheets(sheet_list).Select()\nwb.ActiveSheet.ExportAsFixedFormat(0, pdf_path)\nwb.Close()\n</code></pre>\n\n<p>Within the Excel file I have hyperlinks that toggle between the sheets, but the links loose their functionality in PDF format. An example of the macro I use is:</p>\n\n<pre><code>=HYPERLINK(\"[file.xlsx]Sheet1!A1\",\"back\")\n</code></pre>\n\n<p>My question is if there is any way to preserve the links functionality in PDF form?</p>\n"}, {"tags": ["excel", "vba", "excel-r1c1-notation"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1571170448, "post_id": 58402031, "comment_id": 103149012, "body": "<code>&quot;=SUM(R[4]C:R[&quot; &amp; Final &amp; &quot;]C)&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 12222398, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mALsrMN2xt900RwlYZPH_kaIq7r-HjQW-quMEcI=k-s128", "display_name": "Daniel Jaramillo", "link": "https://stackoverflow.com/users/12222398/daniel-jaramillo"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571170843, "post_id": 58402031, "comment_id": 103149180, "body": "That everything I needed! thanks so much for your help."}, {"owner": {"reputation": 4675, "user_id": 5086631, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IKrb6.png?s=128&g=1", "display_name": "Keith Stein", "link": "https://stackoverflow.com/users/5086631/keith-stein"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571193828, "post_id": 58402031, "comment_id": 103154756, "body": "@ScottCraner Please add this as an answer so it can be accepted and this question doesn&#39;t come up as unanswered."}], "owner": {"reputation": 1, "user_id": 12222398, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mALsrMN2xt900RwlYZPH_kaIq7r-HjQW-quMEcI=k-s128", "display_name": "Daniel Jaramillo", "link": "https://stackoverflow.com/users/12222398/daniel-jaramillo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571184350, "creation_date": 1571170385, "last_edit_date": 1571184350, "question_id": 58402031, "link": "https://stackoverflow.com/questions/58402031/set-a-variable-on-a-formular1c1", "title": "Set a variable on a FormulaR1C1", "body": "<p>I'm trying to code a variable R1C1 formula but I don't know what I'm doing wrong. I searched a lot but couldn't find any answer applicable to my case.</p>\n\n<pre><code>Sub Step17()\nDim Final As Integer\n\nActiveCell.FormulaR1C1 = \"=SUM(R[4]C:R[&amp;Final&amp;]C)\"\n\nEnd Sub\n</code></pre>\n\n<p>I created the variable \"Final\" because what I need to do is a sum of a range where the last row is going to be different every time so it goes from row 4 to row 50 in the first batch but in the following batch it might end up in row 200.</p>\n\n<p>Thanks so much for your help.</p>\n"}, {"tags": ["javascript", "vba", "ms-access", "treeview"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1571171096, "post_id": 58401725, "comment_id": 103149286, "body": "<code>sURL = C:&#47; &amp; &quot;tree_template.html&quot;</code> ??"}, {"owner": {"reputation": 1, "user_id": 8165842, "user_type": "registered", "profile_image": "https://graph.facebook.com/1488518647858805/picture?type=large", "display_name": "David Loraj", "link": "https://stackoverflow.com/users/8165842/david-loraj"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1571171417, "post_id": 58401725, "comment_id": 103149409, "body": "@Tim I just changed that for showing"}], "owner": {"reputation": 1, "user_id": 8165842, "user_type": "registered", "profile_image": "https://graph.facebook.com/1488518647858805/picture?type=large", "display_name": "David Loraj", "link": "https://stackoverflow.com/users/8165842/david-loraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571168924, "creation_date": 1571168924, "question_id": 58401725, "link": "https://stackoverflow.com/questions/58401725/how-to-fix-beforenavigate2-in-access-vba", "title": "How to fix &#39;beforeNavigate2&#39; in Access VBA", "body": "<p>I have implemented coolJStree to a webbrowser-element inside my access database. The tree works fine, till I installed the access-database on a local PC of a customer. Now tree is visible and when I click on a Node, it just expand but it dosen\u00b4t go into the vba sub (oTree_beforeNavigate2). </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Compare Database\nOption Explicit\nPrivate WithEvents oTree As SHDocVw.WebBrowser\nPrivate Sub Form_Load()\n    Set oTree = Me!ctlTreeview.Object\n    Dim x As Variant\n    x = 0\n    If x = 0 Then\n        GetLoad\n        x = x + 1\n    End If\nEnd Sub\n\nPrivate Sub WaitForReady()\n    Do\n        DoEvents\n    Loop Until oTree.ReadyState &gt;= READYSTATE_INTERACTIVE\nEnd Sub\n\nPrivate Function GetLoad()\n    Dim sURL As String\n    Dim sIconPath As String\n    Dim sDoc As String\n    Dim sMenu As String\n    Dim sStyle As String\n    Dim f As Integer\n    Dim var As Variant\n    On Error Resume Next\n    oTree.Navigate2 \"about:blank\"\n    WaitForReady\n    f = FreeFile\n    sURL = C:/ &amp; \"tree_template.html\"\n    Open sURL For Binary As f\n    sDoc = String(LOF(f), 0)\n    Get f, , sDoc\n    Close f\n    sMenu = tree_mieter\n    sIconPath = var &amp; \"icons\\\"\n    sIconPath = Replace(sIconPath, \"\\\", \"/\")\n    sIconPath = \"file://\" &amp; sIconPath\n    sStyle = GetStyleString\n    sDoc = Replace(sDoc, \"@@@\", sMenu)\n    sDoc = Replace(sDoc, \"???\", sIconPath)\n    sDoc = Replace(sDoc, \"\u00a7\u00a7\u00a7\", sStyle)\n    oTree.document.write sDoc\n    MsgBox sDoc\nEnd Function\n\nPrivate Sub oTree_BeforeNavigate2(ByVal pDisp As Object, URL As Variant, Flags As Variant, TargetFrameName As Variant, PostData As Variant, Headers As Variant, Cancel As Boolean)\n    If Right(URL, 1) = \"w\" Or Right(URL, 1) = \"x\" Or Right(URL, 1) = \"y\" Or Right(URL, 1) = \"z\" Or Right(URL, 1) = \"v\" Then\n        Dim sRet As String\n        Dim N As Long\n        N = InStrRev(URL, \"\\\")\n        sRet = Mid(URL, N + 1)\n        sRet = Replace(sRet, \"about:\", \"\")\n        Cancel = True\n    End If\n    If Right(URL, 1) = \"v\" Then 'Ansprechpartner\n        URL = Left(URL, Len(URL) - 1)\n        URL = Right(URL, Len(URL) - 6)\n        DoCmd.BrowseTo acBrowseToForm, \"frm_1\", \"frm_main.frm_main_sub_main\", \"asp_id = \" &amp; URL\n    Else\n        If Right(URL, 1) = \"z\" Then 'Unternehmen\n            URL = Left(URL, Len(URL) - 1)\n            URL = Right(URL, Len(URL) - 6)\n            DoCmd.BrowseTo acBrowseToForm, \"frm_2\", \"frm_main.frm_main_sub_main\", \"adr_id = \" &amp; URL\n        Else\n            If Right(URL, 1) = \"y\" Then 'Geb\u00e4ude\n                URL = Left(URL, Len(URL) - 1)\n                URL = Right(URL, Len(URL) - 6)\n                DoCmd.BrowseTo acBrowseToForm, \"frm_3\", \"frm_main.frm_main_sub_main\", \"geb_id = \" &amp; URL\n            Else\n                If Right(URL, 1) = \"x\" Then 'Liegenschaft\n                    URL = Left(URL, Len(URL) - 1)\n                    URL = Right(URL, Len(URL) - 6)\n                    DoCmd.BrowseTo acBrowseToForm, \"frm_4\", \"frm_main.frm_main_sub_main\", \"ls_id = \" &amp; URL\n                Else\n                    Exit Sub\n                End If\n            End If\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>I expect, that after click on a node, it goes to oTree_beforeNavigate2, but he don\u00b4t but only on the pc of the customer. Usually it works.</p>\n"}, {"tags": ["excel", "vba", "label", "series", "excel-charts"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 8197109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFFNy.jpg?s=128&g=1", "display_name": "fpuglap", "link": "https://stackoverflow.com/users/8197109/fpuglap"}, "edited": false, "score": 0, "creation_date": 1571173480, "post_id": 58402257, "comment_id": 103150201, "body": "I tried this before @TimWilliams! But without succes."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 51, "user_id": 8197109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFFNy.jpg?s=128&g=1", "display_name": "fpuglap", "link": "https://stackoverflow.com/users/8197109/fpuglap"}, "edited": false, "score": 0, "creation_date": 1571173663, "post_id": 58402257, "comment_id": 103150256, "body": "In that case it would help to update your question with the code you tried, and describe what happened when you ran that code."}, {"owner": {"reputation": 51, "user_id": 8197109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFFNy.jpg?s=128&g=1", "display_name": "fpuglap", "link": "https://stackoverflow.com/users/8197109/fpuglap"}, "edited": false, "score": 0, "creation_date": 1571233270, "post_id": 58402257, "comment_id": 103172299, "body": "I updated my question in order to clarify what I&#39;m trying to do."}, {"owner": {"reputation": 51, "user_id": 8197109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFFNy.jpg?s=128&g=1", "display_name": "fpuglap", "link": "https://stackoverflow.com/users/8197109/fpuglap"}, "edited": false, "score": 0, "creation_date": 1571315876, "post_id": 58402257, "comment_id": 103206118, "body": "I tried your code. I&#39;m getting &quot;Run-Time Error &#39;-2147024809 (80070057)&#39; Invalid parameter&quot; in that line."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 51, "user_id": 8197109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFFNy.jpg?s=128&g=1", "display_name": "fpuglap", "link": "https://stackoverflow.com/users/8197109/fpuglap"}, "edited": false, "score": 0, "creation_date": 1571324283, "post_id": 58402257, "comment_id": 103211271, "body": "I used your data and code and it worked for me with that one change."}, {"owner": {"reputation": 51, "user_id": 8197109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFFNy.jpg?s=128&g=1", "display_name": "fpuglap", "link": "https://stackoverflow.com/users/8197109/fpuglap"}, "edited": false, "score": 0, "creation_date": 1571331914, "post_id": 58402257, "comment_id": 103215080, "body": "I&#39;m using Office 2016. Still getting the error. What else can I be doing wrong?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 51, "user_id": 8197109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFFNy.jpg?s=128&g=1", "display_name": "fpuglap", "link": "https://stackoverflow.com/users/8197109/fpuglap"}, "edited": false, "score": 0, "creation_date": 1571332970, "post_id": 58402257, "comment_id": 103215576, "body": "Here&#39;s my working copy - <a href=\"https://drive.google.com/file/d/1ng-0RDY405K55KoAMp5oOpUe-dvMwa-s/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/1ng-0RDY405K55KoAMp5oOpUe-dvMwa-s/&hellip;</a>"}, {"owner": {"reputation": 51, "user_id": 8197109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFFNy.jpg?s=128&g=1", "display_name": "fpuglap", "link": "https://stackoverflow.com/users/8197109/fpuglap"}, "edited": false, "score": 0, "creation_date": 1571408525, "post_id": 58402257, "comment_id": 103243208, "body": "Thanks @TimWilliams! Works perfectly. However I can&#39;t figure it out why doesn&#39;t work in my Workbook. <a href=\"https://drive.google.com/open?id=153xkZhSo1HOSoXveEpAc0LiSnAZ0MBmV\" rel=\"nofollow noreferrer\">Here</a> is the file."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1571287695, "last_edit_date": 1571287695, "creation_date": 1571171515, "answer_id": 58402257, "question_id": 58401645, "link": "https://stackoverflow.com/questions/58401645/add-custom-column-chart-datalabels-in-vba/58402257#58402257", "title": "Add custom Column Chart Datalabels in VBA", "body": "<p>You can use the macro recorder while making an update to your chart, then use the generated code as a starting point.</p>\n\n<p>Eg: you will get something like this -</p>\n\n<pre><code>ActiveChart.SeriesCollection(1).DataLabels(3).Format.TextFrame2.TextRange. _\n    InsertAfter \"  blah blah\" &amp; Chr(13) &amp; \"\"\n</code></pre>\n\n<p><strong>edit:</strong> this line from your posted code - </p>\n\n<pre><code>.DataLabels.Format.TextFrame2.TextRange.InsertAfter labelStr &amp; Chr(13) &amp; \"\"\n</code></pre>\n\n<p>should be     </p>\n\n<pre><code>.DataLabels(1).Format.TextFrame2.TextRange.InsertAfter labelStr &amp; Chr(13) &amp; \"\"\n</code></pre>\n\n<p>Works for me with that change.</p>\n"}], "owner": {"reputation": 51, "user_id": 8197109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFFNy.jpg?s=128&g=1", "display_name": "fpuglap", "link": "https://stackoverflow.com/users/8197109/fpuglap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 513, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571316374, "creation_date": 1571168555, "last_edit_date": 1571316374, "question_id": 58401645, "link": "https://stackoverflow.com/questions/58401645/add-custom-column-chart-datalabels-in-vba", "title": "Add custom Column Chart Datalabels in VBA", "body": "<p>I have a <a href=\"https://i.stack.imgur.com/C3jn1.png\" rel=\"nofollow noreferrer\">Chart</a> object where I want to edit DataLabels of Columns from VBA code. How can I do to achive this goal?</p>\n\n<p>For example: add any string or percentages next to values.</p>\n\n<p>EDIT 1</p>\n\n<p>This is the <a href=\"https://i.stack.imgur.com/svNCr.png\" rel=\"nofollow noreferrer\">Data Range</a> where I have the info.</p>\n\n<p>The following Sub creates a chart and try to edit the DataLabels of columns.</p>\n\n<pre><code>Sub createChart()\n'PURPOSE: Create a chart (chart dimensions are required)\n\nDim rng As Range\nDim pChart As Object\nDim nRng, vRng, labelStr As String\nDim i As Integer\n\nSet report_sht = ThisWorkbook.Worksheets(\"REPORT\")\nWith report_sht\n    'data range for the chart\n    Set rng = .Range(\"E16:F20\")\nEnd With\n\nSet pChart = report_sht.Shapes.AddChart2(Style:=-1, XlChartType:=xlColumnClustered, Left:=Range(\"D22\").Left, Top:=Range(\"D22\").Top, Width:=645, Height:=340, NewLayout:=True)\npChart.Chart.ChartWizard Source:=rng, PlotBy:=xlColumns, SeriesLabels:=0, HasLegend:=1, Title:=\"Chart Title\"\n\npChart.Name = \"chartName\"\n\nWith report_sht.ChartObjects(\"chartName\").Chart\n    .ClearToMatchStyle\n    .ChartStyle = 209\n    .Axes(xlCategory).Delete\n    .Legend.Position = xlRight\n    With .Axes(xlValue)\n        .HasTitle = True\n        .AxisTitle.Text = \"Data Values\"\n    End With\n    For Each s In .SeriesCollection\n      s.Delete\n    Next s\n    For i = 1 To 5\n        .SeriesCollection.NewSeries\n        nRng = \"E\" &amp; (15 + i)\n        vRng = \"F\" &amp; (15 + i)\n        With .SeriesCollection(i)\n            .Name = report_sht.Range(nRng)\n            .Values = report_sht.Range(vRng)\n            labelStr = \" blah blah\"\n            .HasDataLabels = True\n            .DataLabels.Format.TextFrame2.TextRange. _\n              InsertAfter labelStr &amp; Chr(13) &amp; \"\"\n            With .Format.Fill\n                .Visible = msoTrue\n                Select Case i\n                    Case 1\n                        'BLUE\n                        .ForeColor.RGB = RGB(51, 102, 204)\n                    Case 2\n                        'RED\n                        .ForeColor.RGB = RGB(255, 80, 80)\n                    Case 3\n                        'ORANGE\n                        .ForeColor.ObjectThemeColor = msoThemeColorAccent2\n                        .ForeColor.TintAndShade = 0\n                        .ForeColor.Brightness = 0.400000006\n                        'What is this color in RGB?\n                    Case 4\n                        'GREEN\n                        .ForeColor.RGB = RGB(146, 208, 80)\n                    Case 5\n                        'YELLOW\n                        .ForeColor.RGB = RGB(255, 255, 153)\n                End Select\n                .Transparency = 0\n                .Solid\n            End With\n        End With\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>This is the <a href=\"https://i.stack.imgur.com/mX9Ah.png\" rel=\"nofollow noreferrer\">resulting Chart</a> after executing the code. No DataLabels was edited.</p>\n\n<p>EDIT 2</p>\n\n<p>The <a href=\"https://i.stack.imgur.com/cI9of.png\" rel=\"nofollow noreferrer\">line error</a> after try the code. Run-Time Error '-2147024809 (80070057)'.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 2, "creation_date": 1571168830, "post_id": 58401628, "comment_id": 103148453, "body": "Can you show (with a picture) how your data looks now, and how it should look after you done? Right now I&#39;m confused wheather you want all values of each row in one cell (concatenated with commas) or you just want all cells with a comma behind the value."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1571169271, "post_id": 58401628, "comment_id": 103148597, "body": "Agreed. Some sample data (even a picture) and desired results would go a LONG way in helping us understand."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1571169364, "post_id": 58401628, "comment_id": 103148629, "body": "I think you&#39;ll want to do a <code>split</code> on the cell using a space delimiter and then join the array using <code>join</code> and a comma (<code>,</code>). But maybe I&#39;m misunderstanding the aim, as are others."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 1, "creation_date": 1571169465, "post_id": 58401628, "comment_id": 103148672, "body": "Or you might be better of just using <code>replace</code> and replace your spaces with commas."}, {"owner": {"reputation": 13, "user_id": 12222551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/612a3db7b45a2fc5f79c4897d643976e?s=128&d=identicon&r=PG&f=1", "display_name": "mad27", "link": "https://stackoverflow.com/users/12222551/mad27"}, "edited": false, "score": 0, "creation_date": 1571170156, "post_id": 58401628, "comment_id": 103148913, "body": "Picture attached,"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1571170585, "post_id": 58401628, "comment_id": 103149064, "body": "So you want the data transposed, with a comma added after every value?  Looks like each of those are individual cell values in both the before and after conversion."}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1571170768, "creation_date": 1571170768, "answer_id": 58402104, "question_id": 58401628, "link": "https://stackoverflow.com/questions/58401628/vba-how-to-insert-text-into-a-cell-that-already-contains-text/58402104#58402104", "title": "VBA how to insert text into a cell that already contains text", "body": "<p>Will add a quick mock-up of some code to capture an array then iterate through the array and print to cell.</p>\n\n<pre><code>dim arr as variant, i as long\narr = range(cells(4,1),cells(4,7)).value\nfor i = 1 to 7\n    cells(3+i,10).value = arr(1,i) &amp; \",\"\nnext i\n</code></pre>\n\n<p>Note this is untested, but should give an idea about what is being displayed in your updated post (aligns with the comment i made).</p>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1571171208, "creation_date": 1571171208, "answer_id": 58402196, "question_id": 58401628, "link": "https://stackoverflow.com/questions/58401628/vba-how-to-insert-text-into-a-cell-that-already-contains-text/58402196#58402196", "title": "VBA how to insert text into a cell that already contains text", "body": "<p>Something very basic (needs work to catch errors):</p>\n\n<pre><code>Sub TransposeWithComma()\n\nDim range1 As Range: Set range1 = Application.InputBox(\"Source Ranges:\", xTitleId, Type:=8)\nDim range2 As Range: Set range2 = Application.InputBox(\"Convert to (single cell):\", xTitleId, Type:=8)\nrange2.Resize(range1.Columns.Count).Value = Application.Evaluate(\"TRANSPOSE(\" &amp; range1.Address &amp; \")&amp;\"\",\"\"\")\n\nEnd Sub\n</code></pre>\n\n<ul>\n<li>Let the user select a bunch of cells in a row, say <code>A1:G1</code></li>\n<li>Let the user pick a single cell where you want the values transposed to</li>\n<li>Resize the single cell to match the source and concatenate the values from the source with a comma using <code>Evaluate</code></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/IMMLo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IMMLo.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 12222551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/612a3db7b45a2fc5f79c4897d643976e?s=128&d=identicon&r=PG&f=1", "display_name": "mad27", "link": "https://stackoverflow.com/users/12222551/mad27"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 58402196, "answer_count": 2, "score": 0, "last_activity_date": 1571171208, "creation_date": 1571168477, "last_edit_date": 1571170238, "question_id": 58401628, "link": "https://stackoverflow.com/questions/58401628/vba-how-to-insert-text-into-a-cell-that-already-contains-text", "title": "VBA how to insert text into a cell that already contains text", "body": "<p>I have a worksheet that contain some numbers in rows, I would like to convert to columns with \",\" in the end of the number, for example:</p>\n\n<pre><code>5001 5002 5003\n</code></pre>\n\n<p>After convert</p>\n\n<pre><code>5001,\n5002,\n5003,\n</code></pre>\n\n<p>I have this code already</p>\n\n<pre><code>\nDim range1 As Range, Range2 As Range, Rng As Range\nDim rowIndex As Integer\nSet range1 = Application.Selection\nSet range1 = Application.InputBox(\"Source Ranges:\", xTitleId, range1.Address, Type:=8)\nSet Range2 = Application.InputBox(\"Convert to (single cell):\", xTitleId, Type:=8)\nrange1.Select\n    Selection.NumberFormat = \"@\"\nrowIndex = 0\nApplication.ScreenUpdating = False\nFor Each Rng In range1.Columns\n    Rng.Copy\n    Range2.Offset(rowIndex, 0).PasteSpecial Paste:=xlPasteAll, Transpose:=False\n    rowIndex = rowIndex + Rng.Rows.Count\nNext\n\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/zGnKW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zGnKW.png\" alt=\"Image example\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1571168485, "post_id": 58401534, "comment_id": 103148310, "body": "If you place <code>Debug.Print fileName</code> before the <code>Workbooks.Open</code>, you&#39;ll be able to see the values in the immediate window."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1571168590, "post_id": 58401534, "comment_id": 103148340, "body": "Also, wouldn&#39;t you need to add the subfolder in there like <code>Workbooks.Open (pathName &amp;  subfolders.Name &amp; fileName)</code> (or the equivalent)?"}, {"owner": {"reputation": 21, "user_id": 9497997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6a866210ae3c4d6ca3e90fb82104fef?s=128&d=identicon&r=PG&f=1", "display_name": "A.C.", "link": "https://stackoverflow.com/users/9497997/a-c"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1571170933, "post_id": 58401534, "comment_id": 103149215, "body": "@Mistella where would I be able to see the values in the immediate windwo when I use &#39;Debug.Print fileName&#39;? (sorry, i&#39;m really new at VBA. when I typed this into the line above, I just continued getting the same error with no new info popping up)"}, {"owner": {"reputation": 21, "user_id": 9497997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6a866210ae3c4d6ca3e90fb82104fef?s=128&d=identicon&r=PG&f=1", "display_name": "A.C.", "link": "https://stackoverflow.com/users/9497997/a-c"}, "edited": false, "score": 0, "creation_date": 1571171052, "post_id": 58401534, "comment_id": 103149269, "body": "updating my code to Workbooks.Open (pathName &amp; subfolders.Name &amp; &quot;\\&quot; &amp; fileName) worked! Thank you"}, {"owner": {"reputation": 4675, "user_id": 5086631, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IKrb6.png?s=128&g=1", "display_name": "Keith Stein", "link": "https://stackoverflow.com/users/5086631/keith-stein"}, "edited": false, "score": 0, "creation_date": 1571193967, "post_id": 58401534, "comment_id": 103154780, "body": "@A.C. You would get <code>Debug.Print</code> messages in the Immediate Window, which is normally at the bottom of the VBA window. Alternatively, you can use <code>MsgBox()</code> and get a popup message."}], "owner": {"reputation": 21, "user_id": 9497997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6a866210ae3c4d6ca3e90fb82104fef?s=128&d=identicon&r=PG&f=1", "display_name": "A.C.", "link": "https://stackoverflow.com/users/9497997/a-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "closed_date": 1576683548, "answer_count": 0, "score": 2, "last_activity_date": 1576566270, "creation_date": 1571168057, "last_edit_date": 1576566270, "question_id": 58401534, "link": "https://stackoverflow.com/questions/58401534/looping-through-subfolders-in-a-folder", "closed_reason": "Not suitable for this site", "title": "Looping through subfolders in a folder", "body": "<p>I got this code from another question and am trying to customize it.</p>\n\n<p>I get error message</p>\n\n<blockquote>\n  <p>Run-time error '1004': Method 'Open' of object 'Workbooks' failed.</p>\n</blockquote>\n\n<p>I want to use the path to the main folder to iterate through all of the (sub)folders within that folder. Those subfolders do not contain further subfolders.</p>\n\n<p>I want to open every Excel file that has the substring \"-WB_\" in the file name, and make edits (the edits seen in this code are just a placeholder to see if it works). I use InStr to try and determine if CurrFile.Name has \"-WB_\" in it.</p>\n\n<p>One thought I have is that CurrFile.Name is not giving a string, so when I try to use Workbooks.Open it is not working.</p>\n\n<p>I took out my real pathName and replaced it with \"Path to Main Folder\" to protect my real name.</p>\n\n<pre><code>Sub LoopSubfoldersAndFiles()\n    Dim fso As Object\n    Dim folder As Object\n    Dim subfolders As Object\n    Dim MyFile As String\n    Dim wb As Workbook\n    Dim CurrFile As Object\n    Dim fileName As String\n    Dim pathName As String\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n        .Calculation = xlCalculationManual\n    End With\n\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set folder = fso.GetFolder(\"PATH TO MAIN FOLDER\")\n    Set subfolders = folder.subfolders\n    pathName = \"PATH TO MAIN FOLDER\"\n\n    For Each subfolders In subfolders\n\n        Set CurrFile = subfolders.Files\n\n        For Each CurrFile In CurrFile\n            fileName = CurrFile.Name\n            If InStr(CurrFile.Name, \"-WB_\") Then\n                Workbooks.Open (pathName &amp; fileName)\n                Workbooks(CurrFile.Name).Sheets(1).Range(\"a1:a20\") = \"Excel\"\n                wb.Close SaveChanges:=True\n            End If\n        Next\n\n    Next\n\n    Set fso = Nothing\n    Set folder = Nothing\n    Set subfolders = Nothing\n\n    With Application\n        .EnableEvents = True\n        .Calculation = xlCalculationAutomatic\n        .ScreenUpdating = True\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1571167434, "post_id": 58401374, "comment_id": 103147906, "body": "What have you tried thusfar?  As this is tagged for VBA, please include your attempt at coding, the issue/error you are having, and location of the issue, by <a href=\"https://stackoverflow.com/posts/58401374/edit\">editing your post</a>."}], "answers": [{"tags": [], "owner": {"reputation": 4675, "user_id": 5086631, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IKrb6.png?s=128&g=1", "display_name": "Keith Stein", "link": "https://stackoverflow.com/users/5086631/keith-stein"}, "is_accepted": false, "score": 0, "last_activity_date": 1571194954, "creation_date": 1571194954, "answer_id": 58405146, "question_id": 58401374, "link": "https://stackoverflow.com/questions/58401374/how-can-i-take-away-editing-privileges-after-a-specific-number-of-cells-in-a-row/58405146#58405146", "title": "How can I take away editing privileges after a specific number of cells in a row have content?", "body": "<p>Here are a couple options you could use once you detect the class has reached its limit:</p>\n\n<ul>\n<li><p>Use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.saveas\" rel=\"nofollow noreferrer\"><code>Workbook.SaveAs</code></a> to save as a read-only file.<br>\nThis, of course, can be defeated by a student browsing to the file in the file explorer and removing the read-only restriction.</p></li>\n<li><p>Use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.protect\" rel=\"nofollow noreferrer\"><code>Worksheet.Protect</code></a> to restrict editing on the worksheet in question.<br>\nYou can even program it to use a password to protect the worksheet if you're worried about a student trying to un-protect it. Of course, the student could also open the code and find the password you used. But you can also password protect the VBA code itself if you're worried about that.</p></li>\n</ul>\n"}], "owner": {"reputation": 51, "user_id": 11522265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d84a2e41cee6d9d391852ed5377a09?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/11522265/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1571194954, "creation_date": 1571167305, "last_edit_date": 1571167444, "question_id": 58401374, "link": "https://stackoverflow.com/questions/58401374/how-can-i-take-away-editing-privileges-after-a-specific-number-of-cells-in-a-row", "title": "How can I take away editing privileges after a specific number of cells in a row have content?", "body": "<p>I have an Excel sign up sheet for a class where there is a table with the names of the participants for the columns and the date of the classes are the rows. There is a class around once a week but only ten people can sign up. To signup, they just have to simply put an x in the table where the date and their name lineup. How can I restrict everyone from putting an x after the ten spots are filled in the row?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1571166624, "post_id": 58401182, "comment_id": 103147583, "body": "remove the outer loop and use <code>If cel.value Like activityNumber and cel.offset(0,-1).value = deliveryWs.Range(&quot;N9&quot;) Then</code> for the if."}, {"owner": {"reputation": 31, "user_id": 11186188, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156535419728218/picture?type=large", "display_name": "Lawrence Forster", "link": "https://stackoverflow.com/users/11186188/lawrence-forster"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571166857, "post_id": 58401182, "comment_id": 103147666, "body": "Problem solved, thanks!"}, {"owner": {"reputation": 31, "user_id": 11186188, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156535419728218/picture?type=large", "display_name": "Lawrence Forster", "link": "https://stackoverflow.com/users/11186188/lawrence-forster"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571166946, "post_id": 58401182, "comment_id": 103147693, "body": "Out of interest, why didnt two loops work"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1571167455, "post_id": 58401182, "comment_id": 103147917, "body": "You would run through all the cell in column J every time column I returned true.  You only needed to loop once through the rows and check the values of column J and column I once for each row."}], "owner": {"reputation": 31, "user_id": 11186188, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156535419728218/picture?type=large", "display_name": "Lawrence Forster", "link": "https://stackoverflow.com/users/11186188/lawrence-forster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571209023, "creation_date": 1571166412, "last_edit_date": 1571209023, "question_id": 58401182, "link": "https://stackoverflow.com/questions/58401182/for-each-loop-wont-stop", "title": "For each loop wont stop", "body": "<p>I have two loops working so that if any cells within column I = celll.Value, Proceed to second loop, If any cell in column J are like Activity Number then print cell offset cell value. However, the loop keeps on going and doesnt stop, keep repeating same values. </p>\n\n<pre><code>For Each celll In SubTaskWs.Range(\"I1:I\" &amp; Lastrow)\n        If celll.value = deliveryWs.Range(\"N9\") Then\n            For Each cel In SubTaskWs.Range(\"J1:J\" &amp; Lastrow)\n                If cel.value Like activityNumber Then\n\n                    'Insert row at the last position of Activity table\n                    deliveryWs.Range(\"A\" + CStr(delivActivEnd + (i))).EntireRow.Insert\n\n                    ' Copy formatting from line above\n                    Call copyFormattingAbove(deliveryWs, \"A\" &amp; CStr(delivActivEnd + i))\n\n                    'copy cell offset hit to newly inserted row\n                    deliveryWs.Range(\"C\" &amp; CStr(delivActivEnd) + (i - 1)).value = cel.Offset(, -7)\n                    deliveryWs.Range(\"H\" &amp; CStr(delivActivEnd) + (i - 1)).value = cel.Offset(, -6)\n                    deliveryWs.Range(\"I\" &amp; CStr(delivActivEnd) + (i - 1)).value = cel.Offset(, -5)\n                    deliveryWs.Range(\"P\" &amp; CStr(delivActivEnd) + (i - 1)).value = cel.Offset(, 1)\n\n                    ' Number Deliverable\n                    deliveryNum = deliveryWs.Range(\"B\" &amp; CStr(delivActivEnd - 1)) + (0.1 + (i / 10))\n                    deliveryWs.Range(\"B\" &amp; CStr(delivActivEnd) + i) = deliveryNum\n\n                    ' Update sum of workload for activity\n                    Call updateActivityWorkload(deliveryWs, activityNumber, delivActivStart, (delivActivEnd + i))\n\n                    ' Create new line for deliverable on Delivery and Validation for Invoicing table\n                    Call updateInvoicingTable(deliveryWs, (delivActivEnd + i), (delivActivEnd + i) - deliverablesStart)\n                    i = i + 1\n                End If\n            Next cel\n        End If\n    Next celll\n\n</code></pre>\n\n<p>I want it to just loop through the columns just once and not repeat values.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 7, "creation_date": 1571166180, "post_id": 58401098, "comment_id": 103147411, "body": "This can be done with a formula: <code>=D2&#47;COUNTIF(D:D,D2)</code>"}, {"owner": {"reputation": 4675, "user_id": 5086631, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IKrb6.png?s=128&g=1", "display_name": "Keith Stein", "link": "https://stackoverflow.com/users/5086631/keith-stein"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 3, "creation_date": 1571194183, "post_id": 58401098, "comment_id": 103154818, "body": "@cybernetic.nomad Please post this as an answer"}], "answers": [{"comments": [{"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "edited": false, "score": 0, "creation_date": 1571332070, "post_id": 58415673, "comment_id": 103215149, "body": "As an added note, if you used named ranges, such as table references the calculations will go way quicker, since it would be checking the entire column first. Also I prefer using <code>COUNTIFS</code> over <code>COUNTIF</code> even if I only use 1 criteria, just because if you need to add more the order doesn&#39;t change so it&#39;s easier to adjust."}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": true, "score": 0, "last_activity_date": 1571235969, "creation_date": 1571235969, "answer_id": 58415673, "question_id": 58401098, "link": "https://stackoverflow.com/questions/58401098/divide-column-by-value/58415673#58415673", "title": "Divide Column By Value", "body": "<p>This can be done with a formula: </p>\n\n<pre><code>=D2/COUNTIF(D:D,D2) \n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12203661"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 58415673, "answer_count": 1, "score": 0, "last_activity_date": 1571235969, "creation_date": 1571166005, "last_edit_date": 1571166180, "question_id": 58401098, "link": "https://stackoverflow.com/questions/58401098/divide-column-by-value", "title": "Divide Column By Value", "body": "<p>I need to divide a column by a value that will be based on duplicates (1-4) for a macro.</p>\n\n<p>I have tried to work out a formula with no luck </p>\n\n<p>I need it to know that when there is a duplicate to divide column D by the duplicated number</p>\n\n<p>example:</p>\n\n<pre><code>column D = 800/ 3 duplicates = 266.66\n</code></pre>\n\n<p>example:</p>\n\n<pre><code>column D = 600/ 2 duplicates = 200\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Uk0lW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Uk0lW.png\" alt=\"\"></a></p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1571166106, "post_id": 58401037, "comment_id": 103147388, "body": "<code>Next j</code> not <code>Next k</code>"}, {"owner": {"reputation": 53, "user_id": 8542035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d45ca6b15c9b5e9b54e73de4b59f8ed?s=128&d=identicon&r=PG&f=1", "display_name": "tboo132", "link": "https://stackoverflow.com/users/8542035/tboo132"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1571168442, "post_id": 58401037, "comment_id": 103148288, "body": "Have fixed that but doesn&#39;t seem to solve the error, still getting &quot;invalid next control variable reference&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1571208330, "creation_date": 1571208330, "answer_id": 58407242, "question_id": 58401037, "link": "https://stackoverflow.com/questions/58401037/error-message-invalid-next-control-variable-reference/58407242#58407242", "title": "Error message: Invalid next control variable reference", "body": "<p>First of all, your loop variables are <code>i</code> and <code>j</code>, in <code>Next</code> statement you have <code>k</code> and <code>i</code>., Swith <code>k</code> to <code>j</code>.</p>\n\n<p>Also, order of <code>Next</code>s is wrong, becuase <code>Next i</code> corresponds to <code>For j</code>, so order of <code>Next</code>s should be:</p>\n\n<pre><code>Next j\nNext i\n</code></pre>\n\n<p>Also, you can omit variables in <code>Next</code>, which would be les error prone.</p>\n\n<p>One more note: use proper indentation :)</p>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1571208738, "last_edit_date": 1571208738, "creation_date": 1571208333, "answer_id": 58407245, "question_id": 58401037, "link": "https://stackoverflow.com/questions/58401037/error-message-invalid-next-control-variable-reference/58407245#58407245", "title": "Error message: Invalid next control variable reference", "body": "<p>If you open the <code>i</code> loop structure <em>first</em> you need to close it <em>last</em>. Always format your code correctly (use indentation as below) so you see that the loop structure you open last (here <code>j</code>) needs to be closed first.</p>\n\n<p>You tried it the other way round so you got an error.</p>\n\n<pre><code>Dim i As Long, j As Long\nFor i = 1 To 2\n    For j = 0 To 1\n        ' your code\n    Next j\nNext i\n</code></pre>\n\n<p>Also note that if you declare <code>Dim i, j As Integer</code> that means <code>j</code> is <code>Integer</code> but <code>i</code> is <code>Variant</code>. You must specify a type for <strong>every</strong> variable <code>Dim i As Long, j As Long</code> otherwise VBA assumes <code>Variant</code> by default. </p>\n\n<p>And you should declare your variables as <code>Long</code> because Excel has more rows than <code>Integer</code> can handle. Actually you can always use <code>Long</code> instead of <code>Integer</code> as there is no benefit in using <code>Integer</code>: Also see <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long/26409520#26409520\">Why Use Integer Instead of Long?</a></p>\n\n<hr>\n\n<p>Additional recommendation:</p>\n\n<p>Don't declare <code>Dim ws As String</code> instead </p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"Settings\")\n</code></pre>\n\n<p>and use it like:</p>\n\n<pre><code>ws.Range(\u2026)\n</code></pre>\n\n<p>you can use this technique for your other worksheets too so your code gets a lot shorter and easier to maintain. Eg. if a name of a worksheet changes you have to change it only once in the <code>Set</code> statement.</p>\n"}], "owner": {"reputation": 53, "user_id": 8542035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d45ca6b15c9b5e9b54e73de4b59f8ed?s=128&d=identicon&r=PG&f=1", "display_name": "tboo132", "link": "https://stackoverflow.com/users/8542035/tboo132"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1571209051, "creation_date": 1571165759, "last_edit_date": 1571209051, "question_id": 58401037, "link": "https://stackoverflow.com/questions/58401037/error-message-invalid-next-control-variable-reference", "title": "Error message: Invalid next control variable reference", "body": "<p>Trying to run the following loop but keep getting an invalid next control variable reference error. Cannot seem to work out the solution and I am sure it is a simple one.</p>\n\n<p>The code works fine without the loop but when I have added the loop it has now failed.</p>\n\n<pre><code>Sub QC()\n\nDim i, j As Integer\nDim ws As String\n\nFor i = 1 To 2\nFor j = 0 To 1\nws = \"Settings\"\n\n    Worksheets(ws).Range(Worksheets(\"QC\").Cells(i * 5 - j, 2)) = Worksheets(\"QC\").Cells(i * 5 - j, 3)\n    Worksheets(\"QC\").Cells(8, 5) = Worksheets(\"CE Results\").Cells(9, 9)\n    Worksheets(ws).Range(Worksheets(\"QC\").Cells(i * 5 - j, 2)) = Worksheets(\"QC\").Cells(i * 5, 2)\n\n    Worksheets(ws).Range(Worksheets(\"QC\").Cells(i * 5 - j, 2)) = Worksheets(\"QC\").Cells(i * 5 + j, 3)\n    Worksheets(\"QC\").Cells(10, 5) = Worksheets(\"CE Results\").Cells(9, 9)\n    Worksheets(ws).Range(Worksheets(\"QC\").Cells(i * 5 - j, 2)) = Worksheets(\"QC\").Cells(i * 5, 2)\n\nNext i\nNext k\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 4, "creation_date": 1571165809, "post_id": 58400913, "comment_id": 103147271, "body": "I&#39;m voting to close this question as off-topic because better suited for <a href=\"https://codereview.stackexchange.com/\">Code Review</a>. While this question is better suited for Code Review, I can say that this is a normal practice in general. In fact, I just wrote a similar bit of code about 15 minutes ago! :). That said, you can remove the <code>Call</code> statement, because it&#39;s not necessary. Also, if your procedures are not returning any values, they are not really functions, but subs. The best procedures are those that are short sweet and do one thing <i>very</i> well."}, {"owner": {"reputation": 33, "user_id": 8425958, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CqsG2.jpg?s=128&g=1", "display_name": "RunningEXE", "link": "https://stackoverflow.com/users/8425958/runningexe"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1571166270, "post_id": 58400913, "comment_id": 103147452, "body": "@ScottHoltzman Fair enough. Thanks, Scott! These functions are basically scanning through a log that&#39;s been imported, finding specific statements and then performing some substrings. Data is being written to cells in a number of worksheets, these should be functions? Haven&#39;t done any programming in a while and have just started learning VBA."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1571167225, "post_id": 58400913, "comment_id": 103147797, "body": "These are not <code>Function</code>s (but <code>Sub</code>s) as @ScottHoltzman mentioned. Also, what you have written is not a UDF - which is a function that is written intended to return a value and place it in a cell <b>when called from that cell</b>.  You might get some efficiencies by converting the <code>Sub</code>s to <code>Function</code>s. To post in CodeReview you must show all of the real working code with an explanation of the real intent of the code."}, {"owner": {"reputation": 33, "user_id": 8425958, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CqsG2.jpg?s=128&g=1", "display_name": "RunningEXE", "link": "https://stackoverflow.com/users/8425958/runningexe"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1571167980, "post_id": 58400913, "comment_id": 103148122, "body": "@AJD It seems i&#39;ve been misunderstanding what a UDF is, but you summed that up and it makes a bit more sense now. How would one actually call the <code>Function</code> from a cell? I guess that what i&#39;ve done was not technically return a value, but just move values around? Which would technically not &quot;return&quot; a value. Think that&#39;s why i&#39;ve been a bit confused on that."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1571172094, "post_id": 58400913, "comment_id": 103149696, "body": "@RunningEXE - Typically functions return a value. Think like <code>=SUM(1,2)</code>. You can write a custom function - often called a <code>UDF</code> - that returns a value from given input (or even with no input). You can also write a custom function that is not called by cells and is used solely in code. All this is kind of semantics in a way, but learning how to &quot;speak the language&quot; will help you communicate your issues to others more clearly :)"}, {"owner": {"reputation": 33, "user_id": 8425958, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CqsG2.jpg?s=128&g=1", "display_name": "RunningEXE", "link": "https://stackoverflow.com/users/8425958/runningexe"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1571174308, "post_id": 58400913, "comment_id": 103150498, "body": "@ScottHoltzman Gotcha, thanks again!!"}], "owner": {"reputation": 33, "user_id": 8425958, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CqsG2.jpg?s=128&g=1", "display_name": "RunningEXE", "link": "https://stackoverflow.com/users/8425958/runningexe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571244771, "creation_date": 1571165156, "last_edit_date": 1571244771, "question_id": 58400913, "link": "https://stackoverflow.com/questions/58400913/main-sub-calling-multiple-of-the-same-u-d-function", "title": "Main Sub Calling Multiple of the Same U-D Function", "body": "<p>I have four functions and one main Sub that is called upon clicking a button. Within that Sub I have several lines, calling the same functions to take in different parameters for each one. </p>\n\n<p>My question is, is this bad practice? I can't think of any other way to call these functions because I <em>need</em> them all taking in their own user-defined parameters. It just looks odd is all. </p>\n\n<p>Take this as an example:</p>\n\n<pre><code>Sub Generate_Timeline_Click()\n\nDim timelineWb As Workbook\nDim RegExp As Object\nDim regexObj As Object\nDim logSheetRange As Range, logCell As Range\nDim lastRow As Long, lastRowItTook As Long, lastRowStartedProcessing As Long, lastRowProcessingTheFollowing As Long, x As Long\nDim processStartSearch As String, firstAddress As String\nDim counter As Integer, j As Integer, i As Integer\n</code></pre>\n\n<p>...etc... </p>\n\n<pre><code>   Call Call_Line_Search(\"Started Processing\", startedProcessingLinesWs, lastRow)\n   lastRowStartedProcessing = startedProcessingLinesWs.Cells(startedProcessingLinesWs.Rows.Count, \"A\").End(xlUp).Row\n   Call Call_Line_Search(\"Processing the following\", processTheFollowingLinesWs, lastRow)\n   lastRowProcessingTheFollowing = processTheFollowingLinesWs.Cells(processTheFollowingLinesWs.Rows.Count, \"A\").End(xlUp).Row\n   Call Call_Line_Search(\"Signal Data Call Received\", signalDataCallLinesWs, lastRow)\n   Call Call_Line_Search(\"It took: \", itTookLinesWs, lastRow)\n   lastRowItTook = itTookLinesWs.Cells(itTookLinesWs.Rows.Count, \"A\").End(xlUp).Row\n\n   Call Parse_Data(regexObj, \"[regex pattern]\", startedProcessingLinesWs, lastRowStartedProcessing, \"B\")\n   Call Parse_Data(regexObj, \"[regex pattern]\", startedProcessingLinesWs, lastRowStartedProcessing, \"C\")\n   Call Parse_Data(regexObj, \"[regex pattern]\", processTheFollowingLinesWs, lastRowProcessingTheFollowing, \"C\")\n   Call Parse_Data(regexObj, \"[regex pattern]\", processTheFollowingLinesWs, lastRowProcessingTheFollowing, \"D\")\n   Call Parse_Data(regexObj, \"[regex pattern]\", processTheFollowingLinesWs, lastRowProcessingTheFollowing, \"E\")\n   Call Parse_Data(regexObj, \"[regex pattern]\", processTheFollowingLinesWs, lastRowProcessingTheFollowing, \"B\")\n   Call Parse_Data(regexObj, \"[regex pattern]\", itTookLinesWs, lastRowItTook, \"B\")\n   Call Parse_Data(regexObj, \"[regex pattern]\", itTookLinesWs, lastRowItTook, \"C\")\n\nEnd Sub\n</code></pre>\n\n<p>And below I have all of my functions and such. </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1571163012, "post_id": 58400260, "comment_id": 103146063, "body": "These two guides will be a great help to you... <a href=\"https://excelmacromastery.com/vba-class-modules/\" rel=\"nofollow noreferrer\">Excel Mastery</a> and <a href=\"http://www.cpearson.com/excel/classes.aspx\" rel=\"nofollow noreferrer\">Chip Pearson</a>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1571164258, "post_id": 58400260, "comment_id": 103146584, "body": "Classes don&#39;t have parameterized constructors in VBA. You can have <i>factory methods</i> instead though, and IMO a very clean way to do this is to have a stateless default instance, as shown <a href=\"https://stackoverflow.com/a/46414650/1188513\">here</a>"}], "owner": {"reputation": 455, "user_id": 11437189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Cvfhc7JXJKk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h1mFuFK8x2_B_15roYP6g3Ey3gsQ/mo/photo.jpg?sz=128", "display_name": "Igor Cheglakov", "link": "https://stackoverflow.com/users/11437189/igor-cheglakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571162327, "creation_date": 1571162327, "question_id": 58400260, "link": "https://stackoverflow.com/questions/58400260/need-help-implementing-object-constructor", "title": "Need help implementing object constructor", "body": "<p>I need an object constructor, but I\"m cofused with how classes, types, collecitons etc work in VBA \nThe object supposed like this:</p>\n\n<pre><code>obj\n    name\n        value = \"\"\n        tag = \"name\"\n    id\n        value = \"\"\n        tag = \"id\"\n    address\n        value = \"\"\n        tag = \"address\"\n\n    ...\n\n    nthProp\n        value = \"\"\n        tag = \"nthProp\"\n</code></pre>\n\n<p>Where <code>value</code> is an empty string to populate later and <code>tag</code> is a string that is the same as the property name.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1571162406, "post_id": 58400211, "comment_id": 103145788, "body": "Please review this reference <a href=\"http://www.cpearson.com/excel/ErrorHandling.htm\" rel=\"nofollow noreferrer\">cpearson.com/excel/ErrorHandling.htm</a> - in particular around what you can do (and can&#39;t do) once you&#39;re in an error handler block"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1571163276, "post_id": 58400211, "comment_id": 103146186, "body": "You can shorten up all the date formatting into one statement: <code>fname = Name &amp; Format(Now, &quot;_yyyy mm dd - hh\\hmm&quot;)</code>"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 2, "creation_date": 1571163627, "post_id": 58400211, "comment_id": 103146330, "body": "Also, you&#39;re mixing the use of <code>ActiveWorkbook</code> and <code>ThisWorkbook</code>. Don&#39;t do that. Pick one and stick with it. The recommended use is almost always <code>ThisWorkbook</code>."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 11988887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3ZLtMLxQM4CVhys_AW1ZiWxHw7vuO-wewCl4cVw=k-s128", "display_name": "Naxos", "link": "https://stackoverflow.com/users/11988887/naxos"}, "is_accepted": true, "score": 0, "last_activity_date": 1571219782, "creation_date": 1571219782, "answer_id": 58410579, "question_id": 58400211, "link": "https://stackoverflow.com/questions/58400211/vba-excel-resetting-var-macro/58410579#58410579", "title": "VBA - Excel - Resetting var macro", "body": "<p>Finally based on your advice I made the code simpler and everything work now.\nI post it for the next users</p>\n\n<pre><code>Private Sub SaveFile()\nDim fname As String\nDim fdate As String\nDim fhour As String\nDim name As String\nDim name2 As String\nDim path As String\nDim f_name As String\nDim ppfdate As String\nDim ppfhour As String\nDim ppfname As String\nDim ppfname2 As String\nDim pppath As String\n\ndateactuelle = Now()\n\nOn Error GoTo First\nfdate = Format(dateactuelle, \"yyyymmdd - h\\hmm\")\nname = Left(ActiveWorkbook.name, (InStrRev(ActiveWorkbook.name, \"_\", -1, vbTextCompare) - 1))\npath = Application.ActiveWorkbook.path\nfname = name &amp; \"_v\" &amp; fdate\n\nApplication.ActiveWorkbook.SaveAs filename:=path &amp; \"\\\" &amp; fname, _\nFileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\nExit Sub\n\nFirst:\nppfdate = Format(dateactuelle, \"yyyymmdd - h\\hmm\")\nppfname = Left(ActiveWorkbook.name, (InStrRev(ActiveWorkbook.name, \".\", -1, vbTextCompare) - 1))\npath = Application.ActiveWorkbook.path\nf_name = ppfname &amp; \"_v\" &amp; ppfdate\n\nApplication.ActiveWorkbook.SaveAs filename:=path &amp; \"\\\" &amp; f_name, _\nFileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 11988887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3ZLtMLxQM4CVhys_AW1ZiWxHw7vuO-wewCl4cVw=k-s128", "display_name": "Naxos", "link": "https://stackoverflow.com/users/11988887/naxos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 58410579, "answer_count": 1, "score": 0, "last_activity_date": 1571219782, "creation_date": 1571162157, "last_edit_date": 1571207921, "question_id": 58400211, "link": "https://stackoverflow.com/questions/58400211/vba-excel-resetting-var-macro", "title": "VBA - Excel - Resetting var macro", "body": "<p>I hope you are doing well. \nI wrote a macro for saving the active workbook with the date and hour. Everything work fine except the hour, date are not resetting after I re run the code. </p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub SaveFile()\n\nDim fname As String\nDim fdate As String\nDim fhour As String\nDim name As String\nDim name2 As String\nDim path As String\nDim f_name As String\nDim f_date As String\nDim f_hour As String\nDim n_ame As String\nDim n_ame2 As String\nDim p_ath As String\n\nOn Error GoTo First\nfdate = Format(Date, \"yyyy\") &amp; \" \" &amp; Format(Date, \"mm\") &amp; \" \" &amp; Format(Date, \"dd\")\nfhour = Format(Time, \"hh\") &amp; \"h\" &amp; Format(Time, \"mm\")\nname = Left(ThisWorkbook.name, (InStrRev(ThisWorkbook.name, \"_\", -1, vbTextCompare) - 1))\npath = Application.ActiveWorkbook.path\nfname = name &amp; \"_\" &amp; fdate &amp; \" - \" &amp; fhour\nApplication.ActiveWorkbook.SaveAs Filename:=path &amp; \"\\\" &amp; fname, _\nFileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\n\nExit Sub\n\nFirst:\n\nOn Error GoTo -1\nOn Error GoTo Second\nfdate = Format(Date, \"yyyy\") &amp; \" \" &amp; Format(Date, \"mm\") &amp; \" \" &amp; Format(Date, \"dd\")\nfhour = Format(Time, \"hh\") &amp; \"h\" &amp; Format(Time, \"mm\")\nname = Left(ThisWorkbook.name, (InStrRev(ThisWorkbook.name, \"_\", -1, vbTextCompare) - 1))\npath = Application.ActiveWorkbook.path\nfname = name &amp; \"_\" &amp; fdate &amp; \" - \" &amp; fhour\nApplication.ActiveWorkbook.SaveAs Filename:=path &amp; \"\\\" &amp; fname, _\nFileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\n\nExit Sub\n\nSecond:\nf_date = Format(Date, \"yyyy\") &amp; \" \" &amp; Format(Date, \"mm\") &amp; \" \" &amp; Format(Date, \"dd\")\nf_hour = Format(Time, \"hh\") &amp; \"h\" &amp; Format(Time, \"mm\")\nn_ame = Left(ThisWorkbook.name, (InStrRev(ThisWorkbook.name, \".\", -1, vbTextCompare) - 1))\npath = Application.ActiveWorkbook.path\nf_name = n_ame &amp; \"_\" &amp; f_date &amp; \" - \" &amp; f_hour\nApplication.ActiveWorkbook.SaveAs Filename:=path &amp; \"\\\" &amp; f_name, _\nFileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\n\nEnd Sub\n</code></pre>\n\n<p>The macro currently save for the first time in the wanted format and for the next time will understand and left the correct number of characters to save in the proper wanted format.\nI also set a \"second chance\" in case of too early enter pressed. </p>\n\n<p>Currently if my workbook is name \"Workook\"\nThe macro will save it as \"Workbook_2019 10 14 - 19h12\" and not the current time and date values.</p>\n\n<p>Thanks for your help\nNaxos</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 3, "creation_date": 1571160745, "post_id": 58399835, "comment_id": 103145104, "body": "Is there a variable named <code>Target</code> that is accessible inside the <code>Test()</code> method? Please note that while debugging, it&#39;s very important to remove/comment any <code>On Error</code> statements (specially <code>On Error Resume Next</code>), otherwise, things could be going wrong and you wouldn&#39;t know."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1571161407, "post_id": 58399835, "comment_id": 103145363, "body": "<code>SelectionChange</code> gets triggered when the user make a selection, not when values are changed..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1571161725, "post_id": 58399835, "comment_id": 103145490, "body": "You can use the <code>Worksheet_Calculate</code> event."}], "owner": {"reputation": 43, "user_id": 12170767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lGiwwdnsCiI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd9em_ueK8qcUaKzUeqTsCu-7UtEg/photo.jpg?sz=128", "display_name": "Rina Tse", "link": "https://stackoverflow.com/users/12170767/rina-tse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571160484, "creation_date": 1571160484, "question_id": 58399835, "link": "https://stackoverflow.com/questions/58399835/use-worksheet-calculate-to-automaitcally-sort-values-derived-from-formula", "title": "Use Worksheet Calculate to automaitcally sort values derived from formula", "body": "<p>I want to sort rows automatically based on values in Column C, which are derived from a formula and will change. So far, I have:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Not Application.Intersect(Range(\"C140:C143\"), Range (Target.Address)) Is Nothing Then\n        Call Test\n\n    End If\n\nEnd Sub\n\nSub Test()\n    On Error Resume Next\n    If Not Intersect(Target, Range(\"C140:C143\")) Is Nothing Then\n        Range(\"A140:I143\").Sort Key1:=Range(\"C140:C143\"), _\n        Order1:=xlAscending, Header:=xlNo, _\n        OrderCustom:=1, MatchCase:=False, _\n        Orientation:=xlTopToBottom\n    End If\nEnd Sub\n</code></pre>\n\n<p>This works well to automatically sort values when those values are inputted manually. How can I convert this to Worksheet Calculate to account for values derived from formulas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1571161025, "post_id": 58399816, "comment_id": 103145208, "body": "First: the more times a macro touches a worksheet, the longer the code takes to run. Second: VLookup sometimes fails when trying to match a number to the string-representation of that same number or vice versa.  I would recommend pulling the data from the sheet into an array in excel, cycling through the column with the &quot;match&quot; to identify the row, then pulling the information from the identified row in the array."}, {"owner": {"reputation": 27, "user_id": 12202440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ac6e0f895fc6c49adb912b05ec642b?s=128&d=identicon&r=PG&f=1", "display_name": "edgarc1981", "link": "https://stackoverflow.com/users/12202440/edgarc1981"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1571161150, "post_id": 58399816, "comment_id": 103145260, "body": "It seems it only mismatches when a letter is used in the job reference lookup. I am testing this now."}, {"owner": {"reputation": 27, "user_id": 12202440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ac6e0f895fc6c49adb912b05ec642b?s=128&d=identicon&r=PG&f=1", "display_name": "edgarc1981", "link": "https://stackoverflow.com/users/12202440/edgarc1981"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1571161237, "post_id": 58399816, "comment_id": 103145299, "body": "You were head on the nail Mistella, IT must be the String interpretation that is causing the error. IF I may ask, how do I convert the data to an array?"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1571161337, "post_id": 58399816, "comment_id": 103145336, "body": "If that&#39;s the case, it would be caused by the <code>CDbl</code> function that&#39;s wrapping <code>Me.jobRefCbo.Value</code>. <code>CDbl</code> converts to double, which is a number type. If the <code>Me.jobRefCbo.Value</code> ever contains non-digits, the <code>CDbl</code> function will error"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1571161454, "post_id": 58399816, "comment_id": 103145382, "body": "Simplest fix would probably be to remove <code>CDbl</code>, but if you want to work on speeding up the code, I can add more info on pulling data into an array."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1571161857, "post_id": 58399816, "comment_id": 103145551, "body": "Since I&#39;m not sure how using WorksheetFunctions affects the speed of the code, it may help to assign a long with <code>WorksheetFunction.Match(Me.jobRefCbo.Value,Worksheets(&quot;Lists &quot;).Range(&quot;I3:I21&quot;),0)</code> as this will identify the correct row. Then you could assign values like <code>Me.nameTxt.Value = Worksheets(&quot;Lists &quot;).Range(&quot;J&quot; &amp; rowVariable)</code>"}, {"owner": {"reputation": 27, "user_id": 12202440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ac6e0f895fc6c49adb912b05ec642b?s=128&d=identicon&r=PG&f=1", "display_name": "edgarc1981", "link": "https://stackoverflow.com/users/12202440/edgarc1981"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1571162106, "post_id": 58399816, "comment_id": 103145663, "body": "Mistella I&#39;d like to really thank you for taking the time out to provide all this learning. I didn&#39;t know that&#39;s what CBdl did. I am excited to try the code you have displayed here, it will make the tool/code a lot cleaner! Thanks again, I really appreciate the help. I would really appreciate any assistance with pulling data into an array."}, {"owner": {"reputation": 27, "user_id": 12202440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ac6e0f895fc6c49adb912b05ec642b?s=128&d=identicon&r=PG&f=1", "display_name": "edgarc1981", "link": "https://stackoverflow.com/users/12202440/edgarc1981"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1571162416, "post_id": 58399816, "comment_id": 103145792, "body": "Mistrella,  when I enter the code:  Private Sub jobRefCbo_Change() Application.ScreenUpdating = False     WorksheetFunction.Match(Me.jobRefCbo.Value, Worksheets(&quot;Lists &quot;).Range(&quot;I3:I21&quot;), 0)  It gives me an &#39;Expected =&#39; error."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 12202440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ac6e0f895fc6c49adb912b05ec642b?s=128&d=identicon&r=PG&f=1", "display_name": "edgarc1981", "link": "https://stackoverflow.com/users/12202440/edgarc1981"}, "edited": false, "score": 0, "creation_date": 1571163252, "post_id": 58400234, "comment_id": 103146176, "body": "Wow I can&#39;t thank you enough, I appreciate you taking the time out to post this. It has been a massive help."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 27, "user_id": 12202440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ac6e0f895fc6c49adb912b05ec642b?s=128&d=identicon&r=PG&f=1", "display_name": "edgarc1981", "link": "https://stackoverflow.com/users/12202440/edgarc1981"}, "edited": false, "score": 0, "creation_date": 1571164382, "post_id": 58400234, "comment_id": 103146635, "body": "@edgarc1981 Just in case you aren&#39;t aware, if Tim&#39;s answer solved your issue, you can accept it as your preferred answer by clicking the check mark located directly under the vote buttons."}, {"owner": {"reputation": 27, "user_id": 12202440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ac6e0f895fc6c49adb912b05ec642b?s=128&d=identicon&r=PG&f=1", "display_name": "edgarc1981", "link": "https://stackoverflow.com/users/12202440/edgarc1981"}, "edited": false, "score": 0, "creation_date": 1571165671, "post_id": 58400234, "comment_id": 103147205, "body": "Thank you, I have done so. Thanks for the guidance and your patience with me as I learn the platform. The tool works perfectly now thanks to your expertise!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1571166971, "last_edit_date": 1571166971, "creation_date": 1571162252, "answer_id": 58400234, "question_id": 58399816, "link": "https://stackoverflow.com/questions/58399816/vba-lookup-mismatch/58400234#58400234", "title": "VBA Lookup Mismatch", "body": "<p>Suggestions for fixes:</p>\n\n<pre><code>Private Sub jobRefCbo_Change()\n\n    Dim m, v, rngSearch As Range\n\n    Application.ScreenUpdating = False\n\n    Lists_sort 'use of Call is deprecated\n\n    v = Trim(Me.jobRefCbo.Value)\n\n    If IsNumeric(v) Then\n        Set rngSearch = Worksheets(\"Lists \").Range(\"I3:P21\")\n        'use Match to find a hit in the first column...\n        m = Application.Match(CDbl(v), rngSearch.Columns(1), 0)\n        If Not IsError(m) Then\n            'got a hit so return the values\n            With rngSearch.Rows(m)\n                Me.nameTxt.Value = .Cells(2).Value\n                Me.jobDesc2Txt.Value = .Cells(3).Value\n                'etc etc\n            End With\n        End If\n    Else\n        MsgBox \"Lookup value must be numeric\", vbExclamation\n    End If\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 12202440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ac6e0f895fc6c49adb912b05ec642b?s=128&d=identicon&r=PG&f=1", "display_name": "edgarc1981", "link": "https://stackoverflow.com/users/12202440/edgarc1981"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 58400234, "answer_count": 1, "score": 0, "last_activity_date": 1571166971, "creation_date": 1571160343, "last_edit_date": 1571161843, "question_id": 58399816, "link": "https://stackoverflow.com/questions/58399816/vba-lookup-mismatch", "title": "VBA Lookup Mismatch", "body": "<p>I reviewed previous questions on this and can't locate an answer. I am using a VLOOKUP within VBA to populate a userform with the data based on the selection. I continue to get mismatch on certain entries and others worked, now none work. Here is the code: </p>\n\n<pre><code>Private Sub jobRefCbo_Change()\nApplication.ScreenUpdating = False\n\nCall Lists_sort ' This just sorts a list of the 'Active' data so the user only sees the active jobs in the combo box. \n\n\n\n    Me.nameTxt.Value = Application.WorksheetFunction.VLookup(CDbl(Me.jobRefCbo.Value), Worksheets(\"Lists \").Range(\"I3:P21\"), 2, False)\n    'Me.acNoTxt.Value = Application.WorksheetFunction.VLookup(CDbl(Me.jobRefCbo.Value), Worksheets(\"Lists \").Range(\"I3:P21\"), 2, False)\n    Me.jobDesc2Txt.Value = Application.WorksheetFunction.VLookup(CDbl(Me.jobRefCbo.Value), Worksheets(\"Lists \").Range(\"I3:P21\"), 3, False)\n    'Me.date2Txt.Value = Application.WorksheetFunction.VLookup(CDbl(Me.jobRefCbo.Value), Worksheets(\"Lists \").Range(\"I3:P21\"), 4, False)\n    Me.month2Txt.Value = Application.WorksheetFunction.VLookup(CDbl(Me.jobRefCbo.Value), Worksheets(\"Lists \").Range(\"I3:P21\"), 5, False)\n    Me.timeOnJobTxt.Value = Application.WorksheetFunction.VLookup(CDbl(Me.jobRefCbo.Value), Worksheets(\"Lists \").Range(\"I3:P21\"), 6, False)\n    Me.StatusTxt.Value = Application.WorksheetFunction.VLookup(CDbl(Me.jobRefCbo.Value), Worksheets(\"Lists \").Range(\"I3:P21\"), 7, False)\n    Me.startTime2Txt.Value = Format(CDate(Application.WorksheetFunction.VLookup(CDbl(Me.jobRefCbo.Value), Worksheets(\"Lists \").Range(\"I3:P21\"), 8, False)), \"hh:mm:ss AM/PM\")\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Any advice in doing this in general is much appreciated. </p>\n"}, {"tags": ["excel", "vba", "replace"], "comments": [{"owner": {"reputation": 1, "user_id": 11330390, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bjvHU4KKvik/AAAAAAAAAAI/AAAAAAAAAd4/OuUboRbuoWc/photo.jpg?sz=128", "display_name": "Morgan Thomas", "link": "https://stackoverflow.com/users/11330390/morgan-thomas"}, "reply_to_user": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1571161747, "post_id": 58399475, "comment_id": 103145502, "body": "Edit: I do not think my question is a duplicate to &quot;declaring a unicode string in vba in excel&quot; because ideally the macro would function based on reading cell values outside of the code  ex:  &#39; if Sheet0!A2 matches Sheet1!A2, replace Sheet0!A2 with Sheet1!B2"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11330390, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bjvHU4KKvik/AAAAAAAAAAI/AAAAAAAAAd4/OuUboRbuoWc/photo.jpg?sz=128", "display_name": "Morgan Thomas", "link": "https://stackoverflow.com/users/11330390/morgan-thomas"}, "edited": false, "score": 0, "creation_date": 1571176543, "post_id": 58400391, "comment_id": 103151202, "body": "Thank you for the extremely detailed and beautiful response - unfortunately, I couldn&#39;t get it to work. Ideally, it&#39;d be nicer if the macro checked a list that I didn&#39;t have to open or move into the sheet - I&#39;ll probably need to simply find a different work around for what I&#39;m trying to accomplish, I guess."}, {"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "reply_to_user": {"reputation": 1, "user_id": 11330390, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bjvHU4KKvik/AAAAAAAAAAI/AAAAAAAAAd4/OuUboRbuoWc/photo.jpg?sz=128", "display_name": "Morgan Thomas", "link": "https://stackoverflow.com/users/11330390/morgan-thomas"}, "edited": false, "score": 0, "creation_date": 1571176831, "post_id": 58400391, "comment_id": 103151288, "body": "@MorganThomas <i>&quot;I couldn&#39;t get it to work&quot;</i> As you can see in the gif, it works as expected. I can&#39;t tell you what&#39;s wrong unless I see your code."}, {"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "reply_to_user": {"reputation": 1, "user_id": 11330390, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bjvHU4KKvik/AAAAAAAAAAI/AAAAAAAAAd4/OuUboRbuoWc/photo.jpg?sz=128", "display_name": "Morgan Thomas", "link": "https://stackoverflow.com/users/11330390/morgan-thomas"}, "edited": false, "score": 0, "creation_date": 1571176834, "post_id": 58400391, "comment_id": 103151291, "body": "<i>&quot;Ideally, it&#39;d be nicer if the macro checked a list that I didn&#39;t have to open or move into the sheet&quot;</i> Do you mean you want to hardcode the list of words in your code? Because that&#39;s what I thought you wanted to do at the beginning and that you couldn&#39;t do it because the editor doesn&#39;t support Unicode characters so I suggested a duplicate post but then you said you want to put the list of words in a sheet, right?"}], "tags": [], "owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "is_accepted": false, "score": 1, "last_activity_date": 1571163577, "last_edit_date": 1571163577, "creation_date": 1571162869, "answer_id": 58400391, "question_id": 58399475, "link": "https://stackoverflow.com/questions/58399475/how-to-replace-cells-in-a-column-with-chinese-characters-based-on-list-of-transl/58400391#58400391", "title": "How to replace cells in a column with Chinese characters based on list of translations?", "body": "<p>Let's assume the two sheets are <code>Sheet1</code> and <code>Sheet2</code>. You may use a for loop to iterate the cells of the first column on Sheet1 and then use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\"><code>Range.Find</code></a> method to look for a match in <code>Sheet2</code>.</p>\n\n<p>Try something like this:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n    Dim lastRow As Long, i As Long\n    lastRow = Sheet1.Range(\"A\" &amp; Sheet1.Rows.Count).End(xlUp).Row\n    For i = 2 To lastRow\n        Dim currentCell As Range, foundChineseCell As Range, foundEnglishCell As Range\n        Set currentCell = Sheet1.Range(\"A\" &amp; i)\n        Set foundChineseCell = Sheet2.Range(\"A:A\").Find(currentCell.Value)\n        If Not foundChineseCell Is Nothing Then\n            Set foundEnglishCell = foundChineseCell.Offset(0, 1)\n            currentCell.Value = foundEnglishCell.Value\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p><strong>Result:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/SoDdi.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SoDdi.gif\" alt=\"Demo\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 11330390, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bjvHU4KKvik/AAAAAAAAAAI/AAAAAAAAAd4/OuUboRbuoWc/photo.jpg?sz=128", "display_name": "Morgan Thomas", "link": "https://stackoverflow.com/users/11330390/morgan-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571163577, "creation_date": 1571158740, "last_edit_date": 1571163003, "question_id": 58399475, "link": "https://stackoverflow.com/questions/58399475/how-to-replace-cells-in-a-column-with-chinese-characters-based-on-list-of-transl", "title": "How to replace cells in a column with Chinese characters based on list of translations?", "body": "<p>I am a VBA newbie here. Ideally, I would like to put together a macro that will scan a specific column for certain Chinese phrases and translate them per a list of translations. </p>\n\n<p>I've started with kind of a primitive find and replace via an Activecell.value loop per my friend's suggestion, but it won't work because VBA doesn't allow for Chinese characters.</p>\n\n<pre><code>sub Translate()\n\nActiveCell.Select (\"A2\")\n\nDim r As Integer      ' Number of rows\n\n'   ****************************** Input ******************************\n\n'  Count rows \"r\" &amp; Indent\n\n'   Use Loop\n\nDo\n\n    r = r + 1\n    If ActiveCell.Value = \"??\" Then\n    ActiveCell.Value = \"Apple\"\n    Else\n        If ActiveCell.Value = \"??\" Then\n           ActiveCell.Value = \"Banana\"\n    End If\n\n'   Move Cursor\n    ActiveCell.Offset(0, 1).Select\n'   End Loop\nLoop Until ActiveCell.Value = \"\"\n\nEnd Sub\n</code></pre>\n\n<p>Here's the logic I would want the macro to follow:</p>\n\n<ol>\n<li>select a specific column as range</li>\n<li>check value of cell</li>\n<li>if value of cell = specific Chinese phrase (likely from another sheet or index)</li>\n<li>replace value with specified translation phrase</li>\n<li>continue down the column until blank cell is reached, then end macro</li>\n</ol>\n\n<p>For example,</p>\n\n<pre><code>   A\n1 **Fruit**\n2 \u8d5b\u4f0d\n3 \u9999\u8549\n</code></pre>\n\n<p>gets checked against reference sheet or index:</p>\n\n<pre><code>   A    B\n1 \u8d5b\u4f0d apple\n2 \u9999\u8549 banana\n</code></pre>\n\n<p>so that the end result is:</p>\n\n<pre><code>    A\n1 **Fruit**\n2 apple\n3 banana\n</code></pre>\n\n<p>Any help you could provide would be greatly appreciated. Thank you!</p>\n\n<p>Edit: I do not think my question is a duplicate to \"declaring a unicode string in vba in excel\" because ideally the macro would function based on reading cell values outside of the code </p>\n\n<p>ex:</p>\n\n<pre><code>' if Sheet0!A2 matches Sheet1!A2, replace Sheet0!A2 with Sheet1!B2\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1571158178, "post_id": 58399295, "comment_id": 103144071, "body": "Did you ensure you weren&#39;t in break mode when trying to add references?  My assumption is <i>References</i> was greyed out."}, {"owner": {"reputation": 11, "user_id": 12197148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58d08e727b2eb1e77a3c56a53b6f261b?s=128&d=identicon&r=PG&f=1", "display_name": "Loder", "link": "https://stackoverflow.com/users/12197148/loder"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1571414735, "post_id": 58399295, "comment_id": 103246356, "body": "Yep, that was part of the issue too, Tnx!"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12197148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58d08e727b2eb1e77a3c56a53b6f261b?s=128&d=identicon&r=PG&f=1", "display_name": "Loder", "link": "https://stackoverflow.com/users/12197148/loder"}, "is_accepted": true, "score": 0, "last_activity_date": 1571159846, "creation_date": 1571159846, "answer_id": 58399708, "question_id": 58399295, "link": "https://stackoverflow.com/questions/58399295/user-defined-type-not-defined-error-for-a-simple-code-in-excel-vba/58399708#58399708", "title": "&quot;User-defined type not defined&quot; error for a simple code in excel-VBA", "body": "<p>Whenever you couldn't see References option available try to run your Excel as  an administer.</p>\n"}], "owner": {"reputation": 11, "user_id": 12197148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58d08e727b2eb1e77a3c56a53b6f261b?s=128&d=identicon&r=PG&f=1", "display_name": "Loder", "link": "https://stackoverflow.com/users/12197148/loder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 58399708, "answer_count": 1, "score": 0, "last_activity_date": 1571159846, "creation_date": 1571157991, "last_edit_date": 1571158295, "question_id": 58399295, "link": "https://stackoverflow.com/questions/58399295/user-defined-type-not-defined-error-for-a-simple-code-in-excel-vba", "title": "&quot;User-defined type not defined&quot; error for a simple code in excel-VBA", "body": "<p>I wrote a simple code to open my browser from Excel-VBA with help of <a href=\"https://codingislove.com/browser-automation-in-excel-selenium/\" rel=\"nofollow noreferrer\">Selenium</a> below; However, I got an error that says: \"Compile Error: User-defined type not defined\".</p>\n\n<p>I tried to go to the references and add WebDriver to my Excel, but \"References\" option is not available under Tools category in my Excel. </p>\n\n<pre><code>Public Sub seleniumtutorial()\nDim bot As New WebDriver\nbot.Start \"internet explorer\", \"http://google.com\"\nbot.Get \"/\"\nbot.TakeScreenshot.SaveAs (ActiveWorkbook.Path + \"/screenshot.jpg\")\nbot.Quit\n'quit method for closing browser instance.\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 2, "creation_date": 1571161391, "post_id": 58399142, "comment_id": 103145356, "body": "At a very high level - the immediate solution would be for each of your sub queries to use the <code>LIMIT</code> clause  <a href=\"https://www.w3schools.com/sql/sql_top.asp\" rel=\"nofollow noreferrer\">w3schools.com/sql/sql_top.asp</a> . Dlookup returns the first occurence of matched criteria, so you&#39;d just mimic this same behavior by taking the first value returned in the subquery."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1571161561, "post_id": 58399142, "comment_id": 103145426, "body": "Are there more than one price for each unique <code>so_id</code> and <code>product_id</code> in <i>tbl_so_mainfest</i>? Also MySQL subquery does not retrieve <i>price</i> like MS Access&#39; <code>DLookUp</code> and why <code>INNER JOIN</code>?"}, {"owner": {"reputation": 568, "user_id": 8147680, "user_type": "registered", "profile_image": "https://graph.facebook.com/1495266583868736/picture?type=large", "display_name": "Nitin Nanda", "link": "https://stackoverflow.com/users/8147680/nitin-nanda"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1571163154, "post_id": 58399142, "comment_id": 103146138, "body": "@Parfait. No ach unique so_id and product_id in tbl_so_mainfest has only one price. I used inner join because I wasn&#39;t sure of what else. Any suggestions please."}, {"owner": {"reputation": 568, "user_id": 8147680, "user_type": "registered", "profile_image": "https://graph.facebook.com/1495266583868736/picture?type=large", "display_name": "Nitin Nanda", "link": "https://stackoverflow.com/users/8147680/nitin-nanda"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1571163279, "post_id": 58399142, "comment_id": 103146188, "body": "@Mike. good observation that Dlookup returns only one row. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 568, "user_id": 8147680, "user_type": "registered", "profile_image": "https://graph.facebook.com/1495266583868736/picture?type=large", "display_name": "Nitin Nanda", "link": "https://stackoverflow.com/users/8147680/nitin-nanda"}, "edited": false, "score": 0, "creation_date": 1571165859, "post_id": 58400179, "comment_id": 103147286, "body": "I understood your point that I need to select the first row but you suggested that I need not use the join if I use &quot;Select price FROM tbl_so_manifest as sm  WHERE sm.so_id = tbl_trade.so_id AND sm.product_id = tbl_po_manifest.product_id ORDER BY PRICE, ID LIMIT 1;&quot;  then it says unknown column tbl_trade.so_id in &#39;where clause&#39;. This error was the reason I used the INNER JOIN"}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "reply_to_user": {"reputation": 568, "user_id": 8147680, "user_type": "registered", "profile_image": "https://graph.facebook.com/1495266583868736/picture?type=large", "display_name": "Nitin Nanda", "link": "https://stackoverflow.com/users/8147680/nitin-nanda"}, "edited": false, "score": 1, "creation_date": 1571186954, "post_id": 58400179, "comment_id": 103153550, "body": "Do you need the joined table or JUST in that lookup? The dlookup() is a one to one conversion to a sub query. The other columns  in your  original post occur later on via the joins. If the joined values are ONLY required inside of the dlookup() and now the sub-query, then fine. Your original query as written joins in the additional columns WAY farther down. If you place the join inside of the subquery, then what  about the join that occurs later on? (you would be doing it two times). And dumping the later on join quite much means you are VERY much changing the meaning of the query."}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "reply_to_user": {"reputation": 568, "user_id": 8147680, "user_type": "registered", "profile_image": "https://graph.facebook.com/1495266583868736/picture?type=large", "display_name": "Nitin Nanda", "link": "https://stackoverflow.com/users/8147680/nitin-nanda"}, "edited": false, "score": 1, "creation_date": 1571187520, "post_id": 58400179, "comment_id": 103153648, "body": "All I am suggesting is that  you want to adopt a logical one to one conversion. That way you modify the query without really having to total change or know the  original logic. Its possible that the sub query can&#39;t use or pick up the columns from the join you have later on, but I would at least try and adopt a one to one logical flip from dlookup() to a subquery. If you have several dlookups() then you have to repeat the join over and over as opposed to the one join in the main query at the end. I not familiar with MySQL so I don&#39;t know if the later on join columns can be used."}], "tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": false, "score": 0, "last_activity_date": 1571162010, "creation_date": 1571162010, "answer_id": 58400179, "question_id": 58399142, "link": "https://stackoverflow.com/questions/58399142/subquery-returns-more-than-1-row-in-select-partdlookup-to-mysql/58400179#58400179", "title": "Subquery returns more than 1 row in SELECT part(Dlookup to MySql)", "body": "<p>You can force the sub query to only return one reocrd with a top 1</p>\n\n<p>So this:</p>\n\n<pre><code>DLookUp(\"[price]\",\"tbl_so_manifest\",\"[so_id] = \" \n&amp; tbl_trade.so_id &amp; \" AND [product_id] = \" &amp; tbl_po_manifest.product_id)\n</code></pre>\n\n<p>Becomes:</p>\n\n<pre><code>(SELECT TOP 1 Price FROM tbl_so_manifest \n         WHERE so_ID = tbl_trade.so_id AND product_id = sm.product_id\n         ORDER BY PRICE, ID DESC) AS MyPrice\n</code></pre>\n\n<p>So you actually don't need a join but simply \"pluck\" out the value. To restrict the sub query  to ONE record, the TOP 1 and the order by \"PK\" will ensure that only one row is returned. If you leave out the  \"id\", then if two top prices are the same, then you get two rows. By adding the \"ID\" to  the order by, then you will only ever get one row, even if 5 prices are the same.</p>\n\n<p>If other tables in context  have same column name, then of course add the table qualifier to the above (but, it wrote it  as is due for short hand).</p>\n\n<p>So, as a general rule, you can replace dlookup() with an above type  of query.\nI not all that familiar with MySQL, so you might not be able to use the table alias as above, but all in all, use a top 1 and order by with \"ID (or PK) tossed in after price or whatever in those cases where more then one row could exist. In most cases, a dlookup() should not have multiple values (but dlookup() always only returns one value). So in most \"translates\" from dlookup() to a sub-query, the  top 1 should not be required.</p>\n\n<p>And I can't think that a dlookup() needs a \"join\". Dlookup() always hits one table, and so should a conversion from dlookup() to a sub query. You want column to pluck, the table, and then the criteria).</p>\n\n<p>If the dlookup() is a FK value, then a left join to the lookup table is easier, will not cause extra rows in the query, but either approach is fine. I find that a sub-query has less chance of \"messing\" with the main query number of rows returned.</p>\n\n<p>So, a dlookup() to sub-query is a one to one conversion. No join should be required, and as noted in most cases a TOP one + the \"id/pk\" appended should not  be required in most cases.</p>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1571166904, "creation_date": 1571166904, "answer_id": 58401284, "question_id": 58399142, "link": "https://stackoverflow.com/questions/58399142/subquery-returns-more-than-1-row-in-select-partdlookup-to-mysql/58401284#58401284", "title": "Subquery returns more than 1 row in SELECT part(Dlookup to MySql)", "body": "<p>Consider removing the <code>INNER JOIN</code>s of subquery as you do not do it in MS Access' <code>DLookUp</code> (which interestingly you do not use the specified aliases in its criteria logic). Remember <code>SELECT</code> (ironically being first listed clause) is usually the last in SQL's order of operations, so it can read external columns, <code>t.so_id</code> and <code>pm.product_id</code> within the subquery. </p>\n\n\n\n<pre class=\"lang-sql prettyprint-override\"><code>...\n  (SELECT sm.`price`\n   FROM tbl_so_manifest as sm \n   WHERE sm.so_id = t.so_id \n     AND sm.product_id = pm.product_id) AS sub_name \n...\n</code></pre>\n\n<p>More efficiently use subquery as a derived table (or CTE in MySQL 8) to be joined with all other tables. This avoids the row by row calculation and runs look up once to be joined to full resultset. </p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT \n   sm.`price`,\n   ...\nFROM tbl_so_manifest as sm\n/// 15 nested INNER JOINS ....\nINNER JOIN tbl_trade AS t ON sm.so_id = t.so_id \nINNER JOIN tbl_po_manifest AS pm ON sm.product_id = pm.product_id\nINNER JOIN (\n    SELECT `so_id`, `product_id`, `price`\n    FROM tbl_so_manifest\n   ) sm\n ON sm.so_id = t.so_id \n AND sm.product_id = pm.product_id;\n</code></pre>\n\n<p>Note: MySQL does not require parentheses around multiple <code>JOIN</code>s (which hopefully my <a href=\"https://access.uservoice.com/forums/319956-access-desktop-application/suggestions/37193662-upgrade-access-sql-dialect-to-current-ansi-standar\" rel=\"nofollow noreferrer\">MS suggestion</a> will one day fix in MS Access SQL).</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 4626167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9df75b8984d9ac411a121070ffb4dd9?s=128&d=identicon&r=PG&f=1", "display_name": "Wijayanga Wijekoon", "link": "https://stackoverflow.com/users/4626167/wijayanga-wijekoon"}, "is_accepted": false, "score": 0, "last_activity_date": 1571744692, "creation_date": 1571744692, "answer_id": 58503568, "question_id": 58399142, "link": "https://stackoverflow.com/questions/58399142/subquery-returns-more-than-1-row-in-select-partdlookup-to-mysql/58503568#58503568", "title": "Subquery returns more than 1 row in SELECT part(Dlookup to MySql)", "body": "<p>You can limit the sub query to only return one reocrd using LIMIT 1 key word. \n(SELECT Price FROM tbl_so_manifest \n         WHERE so_ID = tbl_trade.so_id AND product_id = sm.product_id\n         ORDER BY PRICE, ID DESC LIMIT 1) AS MyPrice</p>\n"}], "owner": {"reputation": 568, "user_id": 8147680, "user_type": "registered", "profile_image": "https://graph.facebook.com/1495266583868736/picture?type=large", "display_name": "Nitin Nanda", "link": "https://stackoverflow.com/users/8147680/nitin-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1571744692, "creation_date": 1571157324, "last_edit_date": 1571160695, "question_id": 58399142, "link": "https://stackoverflow.com/questions/58399142/subquery-returns-more-than-1-row-in-select-partdlookup-to-mysql", "title": "Subquery returns more than 1 row in SELECT part(Dlookup to MySql)", "body": "<p>I am migrating a desktop application from MS Access VBA to Java Springboot application and I need to make a VBA query work in MySQL. The VBA query is insanely big so I present to you a smaller example to demonstrate my situation.\nVBA query:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT SELECT tbl_trade.id, \n   DLookUp(\"[price]\",\"tbl_so_manifest\",\"[so_id] = \" \n   &amp; tbl_trade.so_id &amp; \" AND [product_id] = \" &amp; tbl_po_manifest.product_id),\n   // .... many more attributes....\nFROM tbl_so_manifest as sm (((\n   /// 15 nested INNER JOINS ....\n   INNER JOIN tbl_trade AS t ON sm.so_id = t.so_id \n   INNER JOIN tbl_po_manifest AS pm ON sm.product_id = pm.product_id\n   )));\n</code></pre>\n\n<p>MySQL conversion:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT SELECT tbl_trade.id, \n   (SELECT sm.product_id \n   FROM tbl_so_manifest as sm \n      INNER JOIN tbl_trade AS t ON sm.so_id = t.so_id \n      INNER JOIN tbl_po_manifest AS pm ON sm.product_id = pm.product_id), \n   // ......\nFROM tbl_so_manifest as sm (((\n   /// 15 nested INNER JOINS ....\n   INNER JOIN tbl_trade AS t ON sm.so_id = t.so_id \n   INNER JOIN tbl_po_manifest AS pm ON sm.product_id = pm.product_id\n   )));\n</code></pre>\n\n<p>but it gives error</p>\n\n<blockquote>\n  <p>Error Code: 1242. Subquery returns more than 1 row    0.844 sec</p>\n</blockquote>\n\n<p>Suggestions needed on how to handle this. </p>\n"}, {"tags": ["excel", "vba", "autofilter"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1571157497, "post_id": 58399086, "comment_id": 103143771, "body": "Why not turn off the filters, add the formula and then turn them back on. You can always record your place before doing so."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571157755, "post_id": 58399086, "comment_id": 103143877, "body": "Side note: Use <code>Long</code> instead of <code>Integer</code>, and it looks like that should be <code>.FormulR1C1</code> instead of <code>.Formula</code>."}, {"owner": {"reputation": 41, "user_id": 12221685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c2821f4509d2e0adefe78e9d83ff10f?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/12221685/tyler"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571159465, "post_id": 58399086, "comment_id": 103144582, "body": "@SJR - I thought about that but just wasn&#39;t sure it was possible to record your place, remove the filters, and then reapply and go back to where you were. I&#39;ll look into it a bit more! Thank you!"}, {"owner": {"reputation": 41, "user_id": 12221685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c2821f4509d2e0adefe78e9d83ff10f?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/12221685/tyler"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571159509, "post_id": 58399086, "comment_id": 103144602, "body": "@BigBen - I switched out Integer with Long but same result. However, given that I&#39;m still a novice I&#39;ll leave it as long and assume there&#39;s a good reason behind it lol. Thanks!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571159578, "post_id": 58399086, "comment_id": 103144641, "body": "Yes, you are right, it will not change the result, it was just a side note. <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long\">Here&#39;s</a> the reasoning behind it, if you are curious and have time!"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1571159590, "post_id": 58399086, "comment_id": 103144646, "body": "@TylerWebb there&#39;re several posts out there which state that, in its current format, VBA will inherently convert <code>Integer</code> to <code>Long</code>, which takes more effort than just defining as <code>Long</code> in the first part."}, {"owner": {"reputation": 41, "user_id": 12221685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c2821f4509d2e0adefe78e9d83ff10f?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/12221685/tyler"}, "edited": false, "score": 0, "creation_date": 1571159886, "post_id": 58399086, "comment_id": 103144765, "body": "Oh wow I had no idea. Thank you both for the input!"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571160611, "post_id": 58399086, "comment_id": 103145056, "body": "Assign the activecell to a variable and then afterwards goto that cell. Or better still, save a custom view and I think that might preserve your filter settings."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571164104, "post_id": 58399086, "comment_id": 103146517, "body": "Nice one - you can post your code as an answer to your own question."}, {"owner": {"reputation": 41, "user_id": 12221685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c2821f4509d2e0adefe78e9d83ff10f?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/12221685/tyler"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1571165040, "post_id": 58399086, "comment_id": 103146927, "body": "@SJR Thanks for the tip. Didn&#39;t see that button down there."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1576096198, "post_id": 58399086, "comment_id": 104791863, "body": "Please place answers in Answer blocks. Please don&#39;t add answers to questions. Later, you can accept your own Answer. Also see <a href=\"https://meta.stackexchange.com/q/5234/173448\">How does accepting an answer work?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 12221685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c2821f4509d2e0adefe78e9d83ff10f?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/12221685/tyler"}, "is_accepted": true, "score": 0, "last_activity_date": 1579108124, "creation_date": 1579108124, "answer_id": 59756397, "question_id": 58399086, "link": "https://stackoverflow.com/questions/58399086/run-a-macro-on-filtered-hidden-rows/59756397#59756397", "title": "Run a macro on filtered/hidden rows?", "body": "<p>Thanks all! I was able to find a way to save the filter settings and then run my code and reapply the settings. I've added the code below (not my code but works well) in case anyone is interested in seeing what I was able to find.</p>\n\n<pre><code>Sub FormulaRefresh()\n'Macro to add formulas to all rows within the range. As users add/remove rows, the formulas will dynamically populate.\n\nDim ws As Worksheet\nSet ws = ActiveSheet\n\nDim used As Range\nSet used = ws.UsedRange\n\nDim LastRow As Long\nLastRow = used.Row + used.Rows.Count - 1\n\nDim FilterArray()\nDim CurrentFiltRange As String\nDim Col As Long\n\n    ' Capture AutoFilter settings\n    With ws.AutoFilter\n        CurrentFiltRange = .Range.Address\n        With .Filters\n            ReDim FilterArray(1 To .Count, 1 To 3)\n            For f = 1 To .Count\n                With .Item(f)\n                    If .On Then\n                        FilterArray(f, 1) = .Criteria1\n                        If .Operator Then\n                            FilterArray(f, 2) = .Operator\n                            FilterArray(f, 3) = .Criteria2\n                        End If\n                    End If\n                End With\n            Next f\n        End With\n    End With\n    'Remove AutoFilter\n    ws.AutoFilterMode = False\n\n 'Formula to be entered    \n ws.Range(\"A5:A\" &amp; LastRow).FormulaR1C1 = \"=IF(ISBLANK(RC6),\"\"\"\",'Report Setup'!R9C2)\"\n\n    ' Restore Filter settings\n\n    For Col = 1 To UBound(FilterArray(), 1)\n        If Not IsEmpty(FilterArray(Col, 1)) Then\n            If FilterArray(Col, 2) Then\n                ws.Range(CurrentFiltRange).AutoFilter field:=Col, _\n                Criteria1:=FilterArray(Col, 1), _\n                Operator:=FilterArray(Col, 2), _\n                Criteria2:=FilterArray(Col, 3)\n            Else\n                ws.Range(CurrentFiltRange).AutoFilter field:=Col, _\n                Criteria1:=FilterArray(Col, 1)\n            End If\n        End If\n    Next Col\n\nIf ws.AutoFilterMode = False Then ws.Range(\"4:4\").AutoFilter \n'If a filter isn't applied when I run they will disappear so I added a quick check at the end to add them back to row 4 if they are gone.\n\nEnd Sub\n</code></pre>\n\n<p>I'm running this with different formulas in 12 columns on around 5,000 rows doing a few other things and it runs in under 3 seconds so seems to be pretty quick!</p>\n"}], "owner": {"reputation": 41, "user_id": 12221685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c2821f4509d2e0adefe78e9d83ff10f?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/12221685/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 59756397, "answer_count": 1, "score": 1, "last_activity_date": 1579108173, "creation_date": 1571157072, "last_edit_date": 1579108173, "question_id": 58399086, "link": "https://stackoverflow.com/questions/58399086/run-a-macro-on-filtered-hidden-rows", "title": "Run a macro on filtered/hidden rows?", "body": "<p>I'm new to the group/VBA so please forgive me if I'm not as concise as I should be.</p>\n\n<p>I've got a macro that adds a formula to a range of cells. However, the range has filters and when I apply one and run the code, the formula is only added to visible cells and not the rows that are filtered out.</p>\n\n<p>Is there a way to get the code to ignore applied filters? I'd prefer not to use ShowAllData to remove the filters so as users are working with the file they are able to keep their place if/when they run the code.</p>\n\n<pre><code>Function RefreshFormulas()\n\nDim ws As Worksheet\nSet ws = ActiveSheet\n\nDim used As Range\nSet used = ws.UsedRange\n\nDim LastRow As Integer\nLastRow = used.Row + used.Rows.Count - 1\n\nws.Range(\"A5:A\" &amp; LastRow).Formula = \"=IF(ISBLANK(RC6),\"\"\"\",'Report Setup'!R9C2)\"\n\nEnd Function\n</code></pre>\n\n<p>Say my range has 3,000 rows. When not filtered, the code above will fill the used range in column A with the formula in all 3,000 rows. However, if I was to filter a column and now only 500 rows are visible, the formula would only be added to those 500 rows. I'd like the code to be run on all 3,000 rows regardless of filters.</p>\n"}, {"tags": ["sql-server", "vba", "ms-access", "odbc"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1571159051, "post_id": 58398670, "comment_id": 103144414, "body": "What exactly is the problem with <code>SELECT ... INTO ...</code> and auto-increment fields? It generally works great for me."}, {"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 0, "creation_date": 1571159668, "post_id": 58398670, "comment_id": 103144678, "body": "Maybe lack of primary key, indexes, defaults, refs in resulting table is a problem?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1571160069, "post_id": 58398670, "comment_id": 103144844, "body": "Well, if you want to copy those you need more advanced code than a simple copy. You&#39;d need to manually copy those."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1571177515, "post_id": 58398670, "comment_id": 103151478, "body": "You don&#39;t want to export from Access, but to import from SQL Server. So something like <code>DoCmd.TransferDatabase acImport, &quot;ODBC&quot;, &quot;your ODBC_String&quot;, ...</code> could work."}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 11920730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ee300e95b2aa75e774e8becb73b6606?s=128&d=identicon&r=PG&f=1", "display_name": "andarvi", "link": "https://stackoverflow.com/users/11920730/andarvi"}, "is_accepted": false, "score": 0, "last_activity_date": 1571173791, "last_edit_date": 1571173791, "creation_date": 1571172729, "answer_id": 58402478, "question_id": 58398670, "link": "https://stackoverflow.com/questions/58398670/copy-a-odbc-linked-sql-table-to-an-access-table-with-vba/58402478#58402478", "title": "Copy a ODBC-linked SQL-Table to an Access table with VBA", "body": "<p>I've done something similiar. Change the ConnectionString to your environment. Maybe you have to extend the TranslateDatatype function.</p>\n\n<pre><code>Function TranslateDatatype(value As Long) As String\n  Select Case value\n    Case 2: TranslateDatatype = \"INT\" ' adSmallInt\n    Case 3: TranslateDatatype = \"LONG\" ' adInteger\n    Case 200: TranslateDatatype = \"STRING\" ' adVarChar\n    Case 202: TranslateDatatype = \"STRING\" ' adVarWChar\n    Case 17: TranslateDatatype = \"BYTE\" ' adUnsignedTinyInt\n    Case 11: TranslateDatatype = \"BIT\" ' adBoolean\n    Case 129: TranslateDatatype = \"STRING\" ' adChar\n    Case 135: TranslateDatatype = \"DATE\" ' adDBTimeStamp\n    Case Else: Err.Raise \"You have to extend TranslateDatatype with value \" &amp; value\n  End Select\nEnd Function\n\nSub CopyFromSQLServer()\n  Dim SQLDB As Object, rs As Object, sql As String, i As Integer, tdf As TableDef\n  Dim ConnectionString As String\n  Set SQLDB = CreateObject(\"ADODB.Connection\")\n  ConnectionString = \"Driver={SQL Server Native Client 11.0};Server=YourSQLServer;Database=YourDatabase;trustedConnection=yes\"\n  SQLDB.Open ConnectionString\n  Set rs = CreateObject(\"ADODB.Recordset\")\n  Set rs.ActiveConnection = SQLDB\n  For Each tdf In CurrentDb.TableDefs\n    rs.Source = \"[\" &amp; tdf.Name &amp; \"]\"\n    rs.Open\n    sql = \"(\"\n    i = 0\n    Do\n      sql = sql &amp; \"[\" &amp; rs(i).Name &amp; \"] \" &amp; TranslateDatatype(rs(i).Type) &amp; \", \"\n      i = i + 1\n    Loop Until i = rs.Fields.Count\n    rs.Close\n    sql = \"CREATE TABLE [Dev_\" &amp; tdf.Name &amp; \"] \" &amp; Left(sql, Len(sql) - 2) &amp; \")\"\n    CurrentDb.Execute sql, dbFailOnError\n    sql = \"INSERT INTO [Dev_\" &amp; tdf.Name &amp; \"] SELECT * FROM [\" &amp; tdf.Name &amp; \"]\"\n    CurrentDb.Execute sql, dbFailOnError\n  Next\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 159, "user_id": 8048399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab78e93b5c199d020e469808857b58aa?s=128&d=identicon&r=PG", "display_name": "Aranxo", "link": "https://stackoverflow.com/users/8048399/aranxo"}, "edited": false, "score": 0, "creation_date": 1572005875, "post_id": 58403540, "comment_id": 103435823, "body": "Hello Guys, thank you for your help. now I&#39;ve chosen this solution with an additional <code>CREATE UNIQUE INDEX ID ON &lt;Tablename&gt; (&lt;FirstField&gt;) WITH PRIMARY</code>."}], "tags": [], "owner": {"reputation": 202, "user_id": 5569008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ae435683b0de0fb75cefd9211afdd2?s=128&d=identicon&r=PG&f=1", "display_name": "xShen", "link": "https://stackoverflow.com/users/5569008/xshen"}, "is_accepted": true, "score": 0, "last_activity_date": 1571180344, "last_edit_date": 1571180344, "creation_date": 1571179770, "answer_id": 58403540, "question_id": 58398670, "link": "https://stackoverflow.com/questions/58398670/copy-a-odbc-linked-sql-table-to-an-access-table-with-vba/58403540#58403540", "title": "Copy a ODBC-linked SQL-Table to an Access table with VBA", "body": "<p>What you are asking can be done like</p>\n\n<p>CurrentDb.Execute \"select *  into localTable from  dbo_serverTable\" , dbFailOnError</p>\n\n<p>And to do this to all the tables use this sub </p>\n\n<pre><code>   Sub importSrverTables()\n\n    Dim db As DAO.Database\n    Dim tdf As DAO.TableDef\n    Set db = CurrentDb\n    For Each tdf In db.TableDefs       \n            If Left(LCase(tdf.Name), 4) = \"dbo_\" Then\n                'CurrentDb.Execute \"select * into localTable from  dbo_serverTable\", dbFailOnError\n                db.Execute \"select * into \" &amp; Mid(tdf.Name, 5) &amp; \" from  \" &amp; tdf.Name, dbFailOnError\n       ' the next if is to make the loop wait until the transfer finish.\n        If db.RecordsAffected &gt; 0 Then\n        ' do nothing\n        End If\n            End If         \n    Next\n    Set tdf = Nothing\n    Set db = Nothing\n   End Sub\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 8048399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab78e93b5c199d020e469808857b58aa?s=128&d=identicon&r=PG", "display_name": "Aranxo", "link": "https://stackoverflow.com/users/8048399/aranxo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 914, "favorite_count": 0, "accepted_answer_id": 58403540, "answer_count": 2, "score": 1, "last_activity_date": 1594421338, "creation_date": 1571155350, "last_edit_date": 1594421338, "question_id": 58398670, "link": "https://stackoverflow.com/questions/58398670/copy-a-odbc-linked-sql-table-to-an-access-table-with-vba", "title": "Copy a ODBC-linked SQL-Table to an Access table with VBA", "body": "<p>I have some ODBC-linked SQL-Server tables in my Access DB, which are the production environment. For testing I want to copy all the data from the SQL-Server into structure-identical Access tables so that I have an identical set of tables in a dev or test-environment. To make it difficult: All of these tables have autoincrement IDs and I want the copies to have the same values and of course the copied ID field also as autoincrement long.</p>\n\n<p>So, a set of these tables:<br>\n- dbo_tbl_Abcd<br>\n- dbo_tbl_Efgh etc.  </p>\n\n<p>should be copied to:<br>\n- Dev_Abcd<br>\n- Dev_Efgh etc.  </p>\n\n<p>or to:<br>\n- Test_Abcd<br>\n- Test_Efgh etc.  </p>\n\n<p>When I do a manual copy and paste for each single table this will work without problems. A dialog \"Paste Table As\" appears where you have the options:  </p>\n\n<p>Linked Table<br>\nStructure Only<br>\nStructure and Data<br>\nAppend Data to Existing Table  </p>\n\n<p>When you set the name correctly and choose Structure and Data, you will have a proper copy as Access table with the same values in the Auto-ID field. I just want to do this by code and for all ODBC-Tables at once (in a loop). When Access provides this manual copying, there must be a way to do this by code.</p>\n\n<p>I have already tried this:</p>\n\n<pre><code>DoCmd.CopyObject , \"Dev_Abcd\", acTable, \"dbo_tbl_Abcd\"\n</code></pre>\n\n<p>but this only will create more ODBC-links to the same SQL-Server tables.\nI also tried this:</p>\n\n<pre><code>DoCmd.TransferDatabase acExport, \"Microsoft Access\", CurrentDb.Name, acTable, \"dbo_tbl_Abcd\", \"Dev_Abcd\"\n</code></pre>\n\n<p>This led to the following error:<br>\n<em>The Microsoft Access database engine could not find the object . Make sure the object exists and that you spell its name and the path name correctly. (Error 3011)</em></p>\n\n<p>I experimented a lot with DoCmd.TransferDatabase, but cound't find a working setting.</p>\n\n<p>I did not test any \"SELECT INTO\"-Statements because of the autoincrement field.</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1574429230, "post_id": 58398567, "comment_id": 104240798, "body": "Please change your question title. This has nothing to do with <code>Maths</code> :)"}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1571162145, "last_edit_date": 1571162145, "creation_date": 1571161827, "answer_id": 58400141, "question_id": 58398567, "link": "https://stackoverflow.com/questions/58398567/calculate-a-mathematical-operation-between-two-records-with-a-custom-function/58400141#58400141", "title": "Calculate a mathematical operation between two records with a custom function", "body": "<p>Getting value from previous record requires subquery.</p>\n\n<pre><code>SELECT Sessions.*, (SELECT TOP 1 Dupe.SessionLoad\n    FROM Sessions AS Dupe WHERE Dupe.ID&lt;Sessions.ID ORDER BY ID Desc) AS PrevLoad\nFROM Sessions;\n</code></pre>\n\n<p>However, calculation dependent on calculation in previous record is not practical in Access query. </p>\n\n<p>I tested your formula in Excel and it does not produce the results you show.</p>\n"}], "owner": {"reputation": 1, "user_id": 12221513, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93XEH1EralY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5_1ng8gkc70h3j0yLU1UcoCZ8ug/photo.jpg?sz=128", "display_name": "Daniel Garc&#237;a", "link": "https://stackoverflow.com/users/12221513/daniel-garc%c3%ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594349116, "creation_date": 1571154944, "last_edit_date": 1594349116, "question_id": 58398567, "link": "https://stackoverflow.com/questions/58398567/calculate-a-mathematical-operation-between-two-records-with-a-custom-function", "title": "Calculate a mathematical operation between two records with a custom function", "body": "<p>I am stuck on an Access Function.</p>\n\n<p>I have the following query:<br>\n<a href=\"https://i.stack.imgur.com/fKUTE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fKUTE.png\" alt=\"\"></a></p>\n\n<pre><code>EWMA=(SessionLoad Actual record *(2/(28+1))+((1-(2/(28+1)))*EWMA from the previous record)\n</code></pre>\n\n<p>I would have to get the data this way:</p>\n\n<p>Query I want to do:<br>\n<a href=\"https://i.stack.imgur.com/7ELi7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7ELi7.png\" alt=\"\"></a></p>\n"}, {"tags": ["python", "excel", "vba", "pandas", "listobject"], "comments": [{"owner": {"reputation": 17765, "user_id": 9375102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8yBw3.jpg?s=128&g=1", "display_name": "Umar.H", "link": "https://stackoverflow.com/users/9375102/umar-h"}, "edited": false, "score": 1, "creation_date": 1571155269, "post_id": 58398464, "comment_id": 103142689, "body": "If the behavior is the same per every table you can use skip rows in your <code>pd.read_excel(file, skiprows=n)</code> now to access all the sheets in a single statement <code>df = pd.concat(pd.read_excel(file, sheet_name=None, skiprows=n), ignore_index=True)</code> or use <code>pd.ExcelWriter(file)</code>"}, {"owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "reply_to_user": {"reputation": 17765, "user_id": 9375102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8yBw3.jpg?s=128&g=1", "display_name": "Umar.H", "link": "https://stackoverflow.com/users/9375102/umar-h"}, "edited": false, "score": 0, "creation_date": 1571155458, "post_id": 58398464, "comment_id": 103142784, "body": "As I answered to @Florian the idea is that the excel file is not mine, I can ot open it and change python code for every sheet. there should be a way. A Listobject is a very well and powerfull object in excel. in the same way I access the sheets colection by id the idea is to access the list collection of Tables in every sheet by id."}, {"owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "reply_to_user": {"reputation": 17765, "user_id": 9375102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8yBw3.jpg?s=128&g=1", "display_name": "Umar.H", "link": "https://stackoverflow.com/users/9375102/umar-h"}, "edited": false, "score": 0, "creation_date": 1571155694, "post_id": 58398464, "comment_id": 103142907, "body": "Also really weird that there is skillrows and not skipcols in  read_excel(file, skiprows=n)"}, {"owner": {"reputation": 17765, "user_id": 9375102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8yBw3.jpg?s=128&g=1", "display_name": "Umar.H", "link": "https://stackoverflow.com/users/9375102/umar-h"}, "edited": false, "score": 1, "creation_date": 1571156224, "post_id": 58398464, "comment_id": 103143208, "body": "Youll have to write a custom function to iterate each sheet or each file to find where the headers start then pass those params into pandas"}, {"owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "reply_to_user": {"reputation": 17765, "user_id": 9375102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8yBw3.jpg?s=128&g=1", "display_name": "Umar.H", "link": "https://stackoverflow.com/users/9375102/umar-h"}, "edited": false, "score": 0, "creation_date": 1571157400, "post_id": 58398464, "comment_id": 103143725, "body": "Any workaround to skip columns?"}], "answers": [{"comments": [{"owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "edited": false, "score": 0, "creation_date": 1571155324, "post_id": 58398635, "comment_id": 103142712, "body": "Ahhh Florian, so nice, we met in the other question. Thanks. Assume you dont know where is the Listobject possitioned. (Actually I dont want to open the excel file to check it). I would like to look over the tables (listobjects)."}, {"owner": {"reputation": 17765, "user_id": 9375102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8yBw3.jpg?s=128&g=1", "display_name": "Umar.H", "link": "https://stackoverflow.com/users/9375102/umar-h"}, "edited": false, "score": 1, "creation_date": 1571209330, "post_id": 58398635, "comment_id": 103159035, "body": "Nice one, if the excel files are small I guess it won&#39;t matter but I would only read the first 50 rows into function for performance"}], "tags": [], "owner": {"reputation": 2389, "user_id": 7348030, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7PmbNFJwfPc/AAAAAAAAAAI/AAAAAAAAAJE/5lDuTFQtNpQ/photo.jpg?sz=128", "display_name": "Florian Bernard", "link": "https://stackoverflow.com/users/7348030/florian-bernard"}, "is_accepted": true, "score": 3, "last_activity_date": 1571157963, "last_edit_date": 1571157963, "creation_date": 1571155211, "answer_id": 58398635, "question_id": 58398464, "link": "https://stackoverflow.com/questions/58398464/read-excel-sheet-table-listobject-into-python-with-pandas/58398635#58398635", "title": "Read Excel sheet table (Listobject) into python with pandas", "body": "<p>Here is a way to parse one table, howver it's need you to know some informations on the seet parsed. </p>\n\n<pre class=\"lang-py prettyprint-override\"><code>df = pd.read_excel(\"file.xlsx\", usecols=\"B:I\", index_col=3)\nprint(df)\n</code></pre>\n\n<p>Not elegant and work only if one table is present inside the sheet, but that a first step: </p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import pandas as pd\nimport string\n\nletter = list(string.ascii_uppercase)\n\ndf1 = pd.read_excel(\"file.xlsx\")\n\ndef get_start_column(df):\n    for i, column in enumerate(df.columns):\n        if df[column].first_valid_index():\n            return letter[i]\n\ndef get_last_column(df):\n    columns = df.columns\n    len_column = len(columns)\n    for i, column in enumerate(columns):\n        if df[column].first_valid_index():\n            return letter[len_column - i]\n\ndef get_first_row(df):\n    for index, row in df.iterrows():\n        if not row.isnull().values.all():\n            return index + 1\n\ndef usecols(df):\n    start = get_start_column(df)\n    end = get_last_column(df)\n    return f\"{start}:{end}\"\n\ndf = pd.read_excel(\"file.xlsx\",  usecols=usecols(df1), header=get_first_row(df1)) \nprint(df)\n</code></pre>\n"}], "owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4026, "favorite_count": 0, "accepted_answer_id": 58398635, "answer_count": 1, "score": 2, "last_activity_date": 1571208007, "creation_date": 1571154542, "last_edit_date": 1571208007, "question_id": 58398464, "link": "https://stackoverflow.com/questions/58398464/read-excel-sheet-table-listobject-into-python-with-pandas", "title": "Read Excel sheet table (Listobject) into python with pandas", "body": "<p>There are multiple ways to read excel data into python.\nPandas provides aslo an API for writing and reading</p>\n\n<pre><code>import pandas as pd\nfrom pandas import ExcelWriter\nfrom pandas import ExcelFile\n\ndf = pd.read_excel('File.xlsx', sheetname='Sheet1')\n</code></pre>\n\n<p>That works fine.</p>\n\n<p>BUT: What is the way to access the tables of every sheet directly into a pandas dataframe??</p>\n\n<p><a href=\"https://i.stack.imgur.com/Sz3eY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Sz3eY.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The above picture shows a sheet including a table SEPARATED THAN CELL (1,1).</p>\n\n<p>Moreover the sheet might include several tables (listobjects in VBA).</p>\n\n<p>I can not find anywhere the way to read them into pandas.</p>\n\n<p>Note1: It is not possible to modify the workbook to bring all the tables towards cell(1,1).\nNote2: I would like to use just pandas (if it is possible) and minimize the need to import other libraries. But it there is no other way I am ready to use other lybray. In any case I could not manage with xlwings for instance.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/17063458/reading-an-excel-file-in-python-using-pandas\">here</a> it looks like its possible to parse the excel file, but no soilution is provided for tables, just for complete sheets.</p>\n\n<p>The <a href=\"https://pandas.pydata.org/pandas-docs/version/0.11.0/generated/pandas.io.parsers.ExcelFile.parse.html\" rel=\"nofollow noreferrer\">documentation of pandas</a> does not seem to offer that possibility.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["arrays", "excel", "vba", "sorting", "range"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 7, "creation_date": 1571154189, "post_id": 58398237, "comment_id": 103142124, "body": "Hi Poppenhoffer, off topic but you still got quite some loose ends on your other questions (8 questions, zero accepted answers). Please address this too."}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1571214243, "post_id": 58398237, "comment_id": 103161496, "body": "Try  applying <code>.Sort</code> on one <code>Range</code> instead of an array of ranges, like <code>everything(1).Sort</code>"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1571214681, "post_id": 58398237, "comment_id": 103161752, "body": "And do not try sorting noncontiguous ranges."}, {"owner": {"reputation": 39, "user_id": 10642369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41bd0eb65ce084302a568011a05d30e?s=128&d=identicon&r=PG&f=1", "display_name": "Poppenhoffer", "link": "https://stackoverflow.com/users/10642369/poppenhoffer"}, "edited": false, "score": 0, "creation_date": 1571412701, "post_id": 58398237, "comment_id": 103245367, "body": "Sorry, I wasn&#39;t clear. I have this range array where the name of each range is contained in the 0, 1 position of each respective range, but the number of columns that contains accompanying data in each range is dynamic. I want to be able to sort each range relative to each other range by the cell in each that contains the respective range&#39;s name using the .Sort function. I wrote a bubble sort, but it&#39;s pretty slow. As far as I can tell, I can&#39;t use that .Sort function to do this."}], "owner": {"reputation": 39, "user_id": 10642369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41bd0eb65ce084302a568011a05d30e?s=128&d=identicon&r=PG&f=1", "display_name": "Poppenhoffer", "link": "https://stackoverflow.com/users/10642369/poppenhoffer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571153690, "creation_date": 1571153690, "question_id": 58398237, "link": "https://stackoverflow.com/questions/58398237/using-sort-function-on-array-of-dynamic-ranges-in-vba", "title": "Using sort function on array of dynamic ranges in VBA?", "body": "<p>Have an array of dynamic ranges that need to be sorted by the B1 position in each. I wrote some very long an inefficient code for a bubble sort that breaks occasionally and was wondering if the .Sort function might work. Here's the code that loops in each dynamic range. If there are syntax errors it's because I chopped it out of larger code. I can assure you that everything works up until the .Sort line:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim everything() As Range\nDim check As Range\nDim count As Range\n\nDim lr As Long\nDim x As Long\nDim y As Long\nDim z As Long\nDim q As Long\nWith ThisWorkbook.Sheets(\"Names and Vendors\")\n\n'Counts how many rows contain data\nIf .Cells(.Rows.count, \"D\").End(xlUp).Row &gt; .Cells(.Rows.count, \"B\").End(xlUp).Row Then\n    lr = .Cells(.Rows.count, \"D\").End(xlUp).Row\n    Else\n    lr = .Cells(.Rows.count, \"B\").End(xlUp).Row\n    End If\n\n'Step 1: Counts number of RMs to size the \"everything\" array\n\nFor z = 2 To lr\n    Set count = .Range(\"B\" &amp; z)\n        If IsEmpty(count) = False Then\n            count.Select\n            q = q + 1\n            End If\n    Next z\n    ReDim everything(q - 1) As Range 'Resizes array\n\n'Step 2: Loops all RM info into array by each distinct range\n\nFor x = 2 To lr\n    Set check = .Range(\"A\" &amp; x &amp; \":Q\" &amp; x)\n\n        'ensures subcomponents are added to range\n        If IsEmpty(.Range(\"B\" &amp; 1 + x)) = True Then\n            Do While IsEmpty(.Range(\"B\" &amp; 1 + x)) = True And x &lt; lr\n                Set check = Union(check, .Range(\"A\" &amp; 1 + x &amp; \":Q\" &amp; 1 + x))\n                check.Select\n                x = x + 1\n            Loop\n        End If\n    Set everything(y) = check\n    y = y + 1\n    check.Select\nNext x\n\n'This doesn't work. Is there a way to make it work?\neverything.Sort Key1:=Range(\"B1\"), Order1:=xlAscending, MatchCase:=False\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "http", "parsing", "post"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1571153594, "post_id": 58398156, "comment_id": 103141802, "body": "Have you checked that there is actual data inside <code>XMLPage.responseText</code>?"}, {"owner": {"reputation": 109, "user_id": 11549939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460ca9449cbe67f4244aa29eef466b61?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo ", "link": "https://stackoverflow.com/users/11549939/eduardo"}, "reply_to_user": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1571155064, "post_id": 58398156, "comment_id": 103142596, "body": "Yes, it returns an HTML document and my table is inside it. @FedericoklezCulloca"}, {"owner": {"reputation": 94, "user_id": 11378204, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Xs4Oi9rUW_c/AAAAAAAAAAI/AAAAAAAAADo/1qszOfKxLw4/photo.jpg?sz=128", "display_name": "Mrblackey", "link": "https://stackoverflow.com/users/11378204/mrblackey"}, "edited": false, "score": 0, "creation_date": 1571155721, "post_id": 58398156, "comment_id": 103142923, "body": "Could it be that the table is in a nested HTMLDoc?"}, {"owner": {"reputation": 109, "user_id": 11549939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460ca9449cbe67f4244aa29eef466b61?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo ", "link": "https://stackoverflow.com/users/11549939/eduardo"}, "reply_to_user": {"reputation": 94, "user_id": 11378204, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Xs4Oi9rUW_c/AAAAAAAAAAI/AAAAAAAAADo/1qszOfKxLw4/photo.jpg?sz=128", "display_name": "Mrblackey", "link": "https://stackoverflow.com/users/11378204/mrblackey"}, "edited": false, "score": 0, "creation_date": 1571155936, "post_id": 58398156, "comment_id": 103143055, "body": "That is very well possible. It shows as follows:  &lt;div id=&quot;content&quot; style=&quot; background:#eeeeee;&quot;&gt; &lt;form method=&quot;post&quot; action=&quot;/Advanced/TrouverAdv&quot; id=&#39;myform&#39;&gt; &lt;table class=&quot;data-table&quot; id=&quot;anyTable&quot; &gt;. Any sugestions to get around that? @Mrblackey"}], "owner": {"reputation": 109, "user_id": 11549939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460ca9449cbe67f4244aa29eef466b61?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo ", "link": "https://stackoverflow.com/users/11549939/eduardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571153397, "creation_date": 1571153397, "question_id": 58398156, "link": "https://stackoverflow.com/questions/58398156/table-in-html-response-not-found-for-parsing", "title": "Table in HTML Response not found for parsing", "body": "<p>I am sending a POST request and I confirmed that the expected data is there.</p>\n\n<p>When trying to parse a table from that response text (HTML) VBA can't find any table.</p>\n\n<pre><code>Option Explicit\nSub GetExchangeRates()\n\n    Dim XMLPage As New MSXML2.XMLHTTP60\n    Dim htmlDoc As New MSHTML.HTMLDocument\n\n    Dim URL As String\n\n    URL = \"http://www.medmouic.org/Advanced/TrouverAdv\"\n\n    XMLPage.Open \"POST\", URL, False\n    XMLPage.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n    XMLPage.setRequestHeader \"Accept\", \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3\"\n    XMLPage.send \"imonumber=&amp;val=0&amp;Name=&amp;selectFlag=333&amp;selectType=&amp;grossfrom=&amp;grossTo=&amp;yearFrom=&amp;yearTo=&amp;selectClass=&amp;Countries=Selects+items&amp;InspectResult=All&amp;TypesDeficiencies=0&amp;SortBy=Imo&amp;fro=01.08.2019&amp;to=31.08.2019\"\n\n    SaveHTMFile XMLPage.responseText\n    htmlDoc.body.innerHTML = XMLPage.responseText\n\n    ProcessHTMLPage htmlDoc\n\nEnd Sub\n\nSub ProcessHTMLPage(HTMLPage As MSHTML.HTMLDocument)\n\n    Dim HTMLTable As MSHTML.IHTMLElement\n    Dim HTMLTables As MSHTML.IHTMLElementCollection\n    Dim HTMLRow As MSHTML.IHTMLElement\n    Dim HTMLCell As MSHTML.IHTMLElement\n    Dim RowNum As Long, ColNum As Integer\n\n    Set HTMLTables = HTMLPage.getElementsByTagName(\"table\")\n\n    For Each HTMLTable In HTMLTables\n        Debug.Print HTMLTable.className\n    Next HTMLTable\n\nEnd Sub\n</code></pre>\n\n<p>The \"SaveHTMFile XMLPage.responseText\" creates a TXT file where I find the table. I was expecting the \"Debug.Print HTMLTable.className\" to show \"data-table\" which is the class of the table, but instead I have nothing as a result.</p>\n\n<pre><code>&lt;form method=\"post\" action=\"/Advanced/TrouverAdv\" id='myform'&gt;\n\n&lt;table class=\"data-table\" id=\"anyTable\" &gt;\n    &lt;!--- Sortby IMONUMBER----&gt;\n        &lt;thead&gt;\n            &lt;tr bgcolor=\"#428bca\"&gt;\n                &lt;th&gt;IMO Number&lt;/th&gt;\n                &lt;th&gt;Ship Name&lt;/th&gt;\n                &lt;th&gt;Flag state&lt;/th&gt;\n                &lt;th&gt;Date of  inspection&lt;/th&gt;\n                &lt;th&gt;Place of inspection&lt;/th&gt;\n            &lt;/tr&gt;\n        &lt;/thead&gt;\n        &lt;tbody&gt;\n            &lt;tr&gt;\n                &lt;td&gt;\n                    9301433\n                &lt;/td&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1571153224, "post_id": 58398045, "comment_id": 103141589, "body": "Have you attempted to use the serial date?  Try finding if serial date is +/- a fraction of a day from a central timestamp, e.g., <code>Date_val &lt;= 48136.1231624 + 0.03</code> and <code>Date_val &gt;= 48136.1231624 - 0.03</code>"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1571153243, "post_id": 58398045, "comment_id": 103141601, "body": "I think that there is a property for the <code>MailItems</code> which is <code>CreationTime</code>"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1571153619, "creation_date": 1571153619, "answer_id": 58398213, "question_id": 58398045, "link": "https://stackoverflow.com/questions/58398045/how-to-count-emails-within-an-hourly-range/58398213#58398213", "title": "How to count emails within an hourly range?", "body": "<p>There is no <code>Received</code> property, you must use the <code>ReceivedTime</code> instead.</p>\n\n<p>And if you need to get hourly range only, you must specify boundaries for the search criteria:</p>\n\n<pre><code>Dim searchCriteria As String = \"[ReceivedTime]&lt;=\"\"\" + dateTimeEnd + \"\"\" AND [ReceivedTime]&gt;=\"\"\" + dateTimeStart + \"\"\"\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 11278270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7b80e13f312a241547e42d27b0b8ed?s=128&d=identicon&r=PG&f=1", "display_name": "CreeXLR", "link": "https://stackoverflow.com/users/11278270/creexlr"}, "is_accepted": true, "score": 0, "last_activity_date": 1571407286, "last_edit_date": 1571407286, "creation_date": 1571158798, "answer_id": 58399489, "question_id": 58398045, "link": "https://stackoverflow.com/questions/58398045/how-to-count-emails-within-an-hourly-range/58399489#58399489", "title": "How to count emails within an hourly range?", "body": "<p>Okay after playing around with it some more (and a generous amount of debug messageboxes) I've managed to get it to work using the following trick:</p>\n\n<ol>\n<li><p>Created an output cell 'A11' on the first sheet running a =NOW() function formatted to \"ddd dd/mm/yyyy hh:mm\"</p></li>\n<li><p>Created a cell 'A1' on the processing sheet that was running 'Sheet1!A11 - 2' formula. The reason why is that for some reason when doing 'Now - 2' through VBA, even with formatting it was always giving midnight. Doing it through autocalc in cells gives correct deduction down to a second.</p></li>\n</ol>\n\n<p>The reason for formatting \"dd dd/mm/yyyy hh:mm\" is that this is the format that the \"Received\" column in outlook stores the receive times. Not providing that 'ddd' in front of the datetime string results in an automation error.</p>\n\n<p>Final code looks like this:</p>\n\n<pre><code>Dim OOSLAitms As Outlook.Items\nDim DateDiff As Long\nDim Filter As String\nDim Today As String\n\nToday = Format(ThisWorkbook.Sheets(\"Sheet2\").Range(\"A1\"), \"ddd dd/mm/yyyy hh:mm\")\n        Filter = \"[Received]\" &amp; \"&lt;\" &amp; Today\n\nSet OOSLAitms = itms.Restrict(\"[FlagStatus] = 0\")\nSet OOSLAitms = OOSLAitms.Restrict(Filter)\nWorksheets(\"Sheet1\").Range(\"F4\").Value = OOSLAitms.Count\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11278270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7b80e13f312a241547e42d27b0b8ed?s=128&d=identicon&r=PG&f=1", "display_name": "CreeXLR", "link": "https://stackoverflow.com/users/11278270/creexlr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 58399489, "answer_count": 2, "score": 0, "last_activity_date": 1584431615, "creation_date": 1571152970, "last_edit_date": 1584431615, "question_id": 58398045, "link": "https://stackoverflow.com/questions/58398045/how-to-count-emails-within-an-hourly-range", "title": "How to count emails within an hourly range?", "body": "<p>My team uses outlook to track completed work. All work needs to be completed within 48 hours of receipt and we need to keep strict track of it. I've managed to put together a function that counts the emails that have fallen outside of the 2 day range, but the track needs to be kept down to an hour.</p>\n\n<p>No matter how many configurations I try I was unable to get my code to count within hourly range. This is what my current code looks like:</p>\n\n<pre><code>Dim OOSLAitms As Outlook.Items\nDim DateDiff As Long\nDim Filter As String\nDim i As Long\nDateDiff = Now - 2\n    Filter = \"[Received]  &lt; '\" &amp; Day(DateDiff) &amp; _\n                         \"/\" &amp; Month(DateDiff) &amp; _\n                         \"/\" &amp; Year(DateDiff) &amp; \"'\"\n\nSet OOSLAitms = itms.Restrict(\"[FlagStatus] = 0\")\nSet OOSLAitms = OOSLAitms.Restrict(Filter)\n\nFor i = OOSLAitms.Count To 1 Step -1\n    Worksheets(\"Sheet1\").Range(\"F4\").Value = OOSLAitms.Count\nNext\n</code></pre>\n\n<p>This manages to count all the emails received within the calendar day, but does not take hours of the day into account. So for example if we received 300 cases on Sunday, it will count all of them up to midnight, instead of only counting ones up to current time (4pm for example).</p>\n\n<p>I need help incorporating hour/minutes criteria into my code on top of day/month/year if it's possible.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1571152943, "post_id": 58397965, "comment_id": 103141434, "body": "So your gross question is &quot;help me rewrite this code?&quot;  Have you looked into <code>.find()</code> in VBA to support finding the cell/range that contains your desired value?  There are many posts on these aspects of your desired final output, where you would need to put those together."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1571153045, "post_id": 58397965, "comment_id": 103141482, "body": "References... <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">Avoid select</a> and <a href=\"https://stackoverflow.com/questions/30161124/vba-find-and-adding-a-value/30162390\">Using <code>.find()</code></a>"}, {"owner": {"reputation": 49, "user_id": 11995192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59c675d745545856b0b8be8f958702b?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/11995192/nick"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1571153097, "post_id": 58397965, "comment_id": 103141511, "body": "Well, not really. I basically only need: Find value A in the array and then select the cell where the match was.  I do not know the syntax for this. that is what I need."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 2, "creation_date": 1571153376, "post_id": 58397965, "comment_id": 103141675, "body": "Take a look at those links and attempt to apply those bits of code to your desired outcome.  Once you have tried that, and if you still have questions with your newly-developed script, please <a href=\"https://stackoverflow.com/posts/58397965/edit\">edit your post</a> to include the code, the error/issue, and the line of the error/issue."}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 11995192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59c675d745545856b0b8be8f958702b?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/11995192/nick"}, "is_accepted": false, "score": 0, "last_activity_date": 1571208901, "creation_date": 1571208901, "answer_id": 58407400, "question_id": 58397965, "link": "https://stackoverflow.com/questions/58397965/find-column-and-then-paste-vba-excel/58407400#58407400", "title": "Find column and then paste vba excel", "body": "<p>I solved it. I ended up with more selections that I would like but I tried to minimize it but I got a lot of error codes that way. \nsee code below:</p>\n\n<pre><code>Sub savedata()\n\n    G = Range(\"A1\").Value\n\n    Range(\"P2:P47\").Copy\n\n    Worksheets(\"All Data\").Select\n    Range(\"C2:AL2\").Find(What:=G).Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n\n    Worksheets(\"Add Data\").Select\n    Application.CutCopyMode = False\n    Range(\"C4:K34\").ClearContents\n\nEnd Sub\n</code></pre>\n\n<p>I would like to do like this bu this does not work:\n    Sub savedata()</p>\n\n<pre><code>    G = Range(\"A1\").Value\n\n    Range(\"P2:P47\").Copy\n\n    Worksheets(\"All Data\").Range(\"C2:AL2\").Find(What:=G).PasteSpecial \nPaste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n\n    Worksheets(\"Add Data\").Select\n    Application.CutCopyMode = False\n    Range(\"C4:K34\").ClearContents\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11995192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59c675d745545856b0b8be8f958702b?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/11995192/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571208901, "creation_date": 1571152674, "last_edit_date": 1571153900, "question_id": 58397965, "link": "https://stackoverflow.com/questions/58397965/find-column-and-then-paste-vba-excel", "title": "Find column and then paste vba excel", "body": "<p>I need to save some data by just clicking a button. </p>\n\n<p>It should be easy but I dont know the syntax for vba. </p>\n\n<pre><code>Range(\"P2:P47\").Copy\n\nSheets(\"All Data\").Select\nRange(\"J2\").Select\n\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n</code></pre>\n\n<p>I have 2 problem with this code,</p>\n\n<p>1 there is \"a lot of\" selections that I do not know how to get rid of(I know you should try not to use selections).</p>\n\n<p>2 My real problem is this: \ncell J2 in the code should not be a determined cell. I would like to have a \"lookup value\" and search for that in an array, and then using the mathing cell to paste my values.</p>\n\n<p>So in my workbook cell A1 = \"Aug 19\" and in row 2 all the months are listed. So cell A2 = \"Jan 19\", B2 = \"Feb 19\" etc. </p>\n\n<p>I would like to select cell H2 and then pasting by matching my lookup value \"Aug 19\" to H2 contains \"Aug 19\"</p>\n\n<p>So in excel formulas I would basically just write:</p>\n\n<pre><code>=HLOOKUP(A1;'All Data'!$B$2:$AL$2;1;FALSE)\n</code></pre>\n\n<p>Solved problem 1</p>\n\n<pre><code>Sub savedata()\n\n    Range(\"P2:P47\").Copy\n\n    Worksheets(\"All Data\").Range(\"J2\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nEnd Sub\n</code></pre>\n\n<p>EDIT on problem 2:</p>\n\n<pre><code>Sub savedata()\n\n    Range(\"P2:P47\").Copy\n\n    ActiveSheet.Range(\"C3:K3\").Find(What:=\"Aug 19\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nEnd Sub\n</code></pre>\n\n<p>This work as I need it to! Still som questions tho, I couldn't figure out how to reference cell A1 instead of \"Aug 19\".</p>\n"}]