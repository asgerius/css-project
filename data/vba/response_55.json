[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1453939500, "post_id": 35050463, "comment_id": 57825403, "body": "AFAIK - the <code>Personal.xlsb</code> is saved to the individual computer.  To find the location, in the Immediate Window of the VBA editor, type <code>?Application.StartupPath</code>.  That&#39;s where the <code>Personal.xlsb</code> resides.  To have this macro work on other computers, the macro should be stored in a module created in that workbook.  Or, share the <code>Personal.xlsb</code> file I suppose."}, {"owner": {"reputation": 664, "user_id": 2977281, "user_type": "registered", "profile_image": "https://graph.facebook.com/561723379/picture?type=large", "display_name": "CustodianOfCode", "link": "https://stackoverflow.com/users/2977281/custodianofcode"}, "edited": false, "score": 2, "creation_date": 1453940552, "post_id": 35050463, "comment_id": 57825707, "body": "Data ribbon -&gt; Edit Links will let you see all links you have to other workbooks, and break them if so desired."}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 1, "creation_date": 1453980792, "post_id": 35050463, "comment_id": 57843402, "body": "On the other computer in the options of excel, are macros enabled? Have you tried debugging step by step? Where does the error happen? can you show us the code?"}, {"owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "edited": false, "score": 0, "creation_date": 1454018409, "post_id": 35050463, "comment_id": 57868838, "body": "Thank you for all your help everybody! I have updated my question with some of my code, I guess the main issue that I am seen is that since I am creating a new sheet is there a way for the new sheet to save the functions too so it does not need to depend on a macro? Thank you again!"}, {"owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "edited": false, "score": 0, "creation_date": 1454281052, "post_id": 35050463, "comment_id": 57961769, "body": "any idea? :) thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "is_accepted": true, "score": 1, "last_activity_date": 1455044079, "last_edit_date": 1525816150, "creation_date": 1455044079, "answer_id": 35299980, "question_id": 35050463, "link": "https://stackoverflow.com/questions/35050463/create-workbook-from-workbook-with-macros-and-send-to-a-different-computer/35299980#35299980", "title": "Create Workbook from workbook with macros and send to a different computer", "body": "<p>Hello I was able to figure out this information. After more research this was the answered I was able to come up with hope it helps if you run into this issue:</p>\n\n<p>I used the following link for help <a href=\"http://www.cpearson.com/Excel/VBE.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/Excel/VBE.aspx</a></p>\n\n<pre><code>Dim ToVBProject As VBIDE.VBProject\nDim FromVBProject As VBIDE.VBProject\nDim Fname As String\n\nFname = \"Path of bas + bas name.bas\"\nFromVBProject.VBComponents(\"module\").Export Fname\nToVBProject.VBComponents.Import (Fname)\n</code></pre>\n\n<p>Thank you again for all the help!</p>\n"}], "owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 35299980, "answer_count": 1, "score": 1, "last_activity_date": 1455044079, "creation_date": 1453938742, "last_edit_date": 1454018309, "question_id": 35050463, "link": "https://stackoverflow.com/questions/35050463/create-workbook-from-workbook-with-macros-and-send-to-a-different-computer", "title": "Create Workbook from workbook with macros and send to a different computer", "body": "<p>I have a macro that creates a workbook with some buttons and pulls information from an Excel sheet into it.</p>\n\n<p>The macro works when run on the computer where it was created. If I send the newly created file to a different computer it asks me to update the data sources and if I select don't update the buttons do not work. If I choose to update it it says it can't file the personal.xlsb file. </p>\n\n<p>Why won't the macro work? I guess my main question is if I am creating a new sheet with dropdowns and button, is there a way to have this saved onto the new file with the function they will be using??</p>\n\n<p>Here is some of my code:</p>\n\n<pre><code>'Create New Workbook\nFunction AddNew() As Workbook\nSet AddNew = Workbooks.Add()\nWname = ActiveWorkbook.name\nWname = Left(Wname, Len(Wname) - 5)\nWith AddNew\n.SaveAs Filename:=Wname &amp; \".xlsx\"\nEnd With\nnwrkbksaved = True\nEnd Function\n\n'Run the create new Workbook function and pull information to new sheet\nPublic Sub TemplateCreate()\nSet thisWB = ActiveWorkbook\n'Set up template for new workbook\nSet NewBook.Workbook = AddNew\n\n'Check to see if New Workbook exists\nIf nwrkbksaved = False Then GoTo term\n\n'Pull information code\n\nSet btn = NewBook.Workbook.Sheets(\"sheet1\").Buttons.Add(Range(\"F15\").Left, Range(\"F15\").Top, 165, 15)\nWith btn\n    .OnAction = \"getData\"\n    .Caption = \"Submit\"\n    .name = \"submitData\"\nEnd With\n\nEnd Sub\n\nFunction getData()\n'Get data code\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1453939300, "creation_date": 1453939300, "answer_id": 35050569, "question_id": 35050147, "link": "https://stackoverflow.com/questions/35050147/excel-vba-for-each-loop-with-if-statement-and-structured-references/35050569#35050569", "title": "Excel vba for each loop with if statement and structured references", "body": "<p>While it is possible to use structured references in VBA, addressing the current row is different. The @ sign refers to the current row, but that syntax only works inside a worksheet cell, not within a VBA. </p>\n\n<p>If you are concerned about readability, I'm not sure the long syntax is helpful at all. My suggestion is to create variables that represent the offset of the table column name from the current column. Something like this:</p>\n\n<pre><code>Sub test()\nDim Height As Integer, Width As Integer, Result As Integer\nResult = 3\nHeight = 1\nWidth = 2\n\nFor Each cel In Worksheets(\"Sheet1\").Range(\"SizingTable[Colour]\")\n    If cel.Value = \"red\" Then\n        cel.Offset(0, Result) = cel.Offset(0, Height) * cel.Offset(0, Width)\n    End If\nNext cel\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/uXqHo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uXqHo.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 4481901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617ffc18518e0d2c7b4235f790416fee?s=128&d=identicon&r=PG&f=1", "display_name": "Mediterrano", "link": "https://stackoverflow.com/users/4481901/mediterrano"}, "is_accepted": false, "score": 2, "last_activity_date": 1460638996, "last_edit_date": 1460638996, "creation_date": 1460637680, "answer_id": 36623455, "question_id": 35050147, "link": "https://stackoverflow.com/questions/35050147/excel-vba-for-each-loop-with-if-statement-and-structured-references/36623455#36623455", "title": "Excel vba for each loop with if statement and structured references", "body": "<p>The above statement </p>\n\n<blockquote>\n  <p>The @ sign refers to the current row, but that syntax only works inside a worksheet cell, not within a VBA.</p>\n</blockquote>\n\n<p>is <strong>false</strong>.</p>\n\n<p>This <strong>works</strong>:</p>\n\n<pre><code>[tblActualsWithFacts[@1c]].Select \n</code></pre>\n\n<p>these <strong>work</strong> too:</p>\n\n<pre><code>Range(\"tblActualsWithFacts[@1c]\").Select \n\nFor i = 1 to 12\n    Range(\"tblActualsWithFacts[\" &amp; i &amp; \" c]\").Select\nNext i \n</code></pre>\n\n<p>however, the combination of the above techniques i.e. concatenating a structured reference which makes use of \"@\" does not work, therefore this does <strong>NOT</strong> work</p>\n\n<pre><code>For i = 1 to 12\n   Range(\"tblActualsWithFacts[@\" &amp; i &amp; \" c]\").Select\nNext i \n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5849383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aab26343d0096253136547942a55d06?s=128&d=identicon&r=PG&f=1", "display_name": "A Lamb", "link": "https://stackoverflow.com/users/5849383/a-lamb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4232, "favorite_count": 0, "accepted_answer_id": 35050569, "answer_count": 2, "score": 0, "last_activity_date": 1460638996, "creation_date": 1453937263, "last_edit_date": 1453937633, "question_id": 35050147, "link": "https://stackoverflow.com/questions/35050147/excel-vba-for-each-loop-with-if-statement-and-structured-references", "title": "Excel vba for each loop with if statement and structured references", "body": "<p>I want to change the value in a column of a table based on the value of another column in the same table using structured references. So far I have something like:</p>\n\n<pre><code>Sub Test\nFor Each cell In Worksheets(\"FNM_DB\").Range(\"DB_SS[Resource_Loc_Type]\")\n If cell.Value = \"TH\" Then\n   Worksheets(\"FNM_DB\").Range(\"DB_SS[Resource]\") = Worksheets(\"FNM_DB\").Range(\"DB_SS[SOURCE_AND_SINK_NAMES]\")\n  End If\n  Next cell\nEnd Sub\n</code></pre>\n\n<p>I know I could do this without the structured reference, but I want the code to be more readable. Is there a way to loop through all the values? I know the @ refers to a specific row, but I don't know how to use it in this instance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1453937432, "post_id": 35050076, "comment_id": 57824661, "body": "Your code should be in Sheet A, since that&#39;s the sheet you expect the changes to happen on. Then, the reason it&#39;s not likely doing anything, is you didn&#39;t tell it what sheet to actually sort on.  Without doing that, it&#39;s going to use SheetA&#39;s <code>Range(&quot;A2&quot;)</code>, etc.  Add <code>Sheets(&quot;SheetB&quot;)</code> before the <code>.Range(...</code> parts."}], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1453937769, "creation_date": 1453937769, "answer_id": 35050265, "question_id": 35050076, "link": "https://stackoverflow.com/questions/35050076/sort-data-in-sheet-b-when-sheet-a-changes-excel-vba/35050265#35050265", "title": "Sort Data in Sheet B when Sheet A Changes Excel VBA", "body": "<p>Use a Worksheet_Change event in SheetA instead of the global Worksheet_Calculate.</p>\n\n<p>Monitor a cell or a range of cells that will be affected when you paste data, for example to monitor column A for changes and run the rest of the code only when a cell in column A is changed:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Not Intersect(Target, Range(\"A:A\")) Is Nothing Then\n\n' run code to copy the data from SheetA to SheetB\n' run code to sort SheetB\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5849380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b07aaed20cc650283bee998b084d2f?s=128&d=identicon&r=PG&f=1", "display_name": "AlexT", "link": "https://stackoverflow.com/users/5849380/alext"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 35050265, "answer_count": 1, "score": 0, "last_activity_date": 1453937769, "creation_date": 1453936928, "last_edit_date": 1531161705, "question_id": 35050076, "link": "https://stackoverflow.com/questions/35050076/sort-data-in-sheet-b-when-sheet-a-changes-excel-vba", "title": "Sort Data in Sheet B when Sheet A Changes Excel VBA", "body": "<p>I have three sheets in one workbook in excel. I have Sheet A where I paste raw data from another program, Sheet B that takes the data from Sheet A and sorts the first three columns, and Sheet C that uses the sorted data to do calculations.</p>\n\n<p>What I would like to do is trigger the sort in Sheet B when I paste data in Sheet A, that way if everything was working you would never have to look at Sheet B.</p>\n\n<p>I'm not very experienced with Excel VBA but here is what I've gotten from doing some research:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n\nApplication.EnableEvents = False\n      Range(\"A1:C314\").Sort _\n   Key1:=Range(\"A2\"), Order1:=xlDescending, _\n     Key2:=Range(\"B2\"), Order2:=xlDescending, _\n        Key3:=Range(\"C2\"), Order3:=xlDescending, _\n     Header:=xlGuess, OrderCustom:=1, MatchCase:=False, _\n     Orientation:=xlTopToBottom\n     Application.EnableEvents = True\n\n End Sub\n</code></pre>\n\n<p>I have this in \"Microsoft Excel Objects\" in \"Sheet B\" in the VBA window. The issues I'm having is the macro triggers when I make a change on any sheet, not just Sheet A. What I was trying to accomplish was when I pasted data in Sheet A, the changes in Sheet B would trigger the macro.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1453935414, "post_id": 35049703, "comment_id": 57823826, "body": "This was recently asked, <a href=\"http://stackoverflow.com/questions/34548106/excel-2010-hyperlinking-cells/34548461#34548461\" title=\"excel 2010 hyperlinking cells\">stackoverflow.com/questions/34548106/&hellip;</a>"}, {"owner": {"reputation": 664, "user_id": 2977281, "user_type": "registered", "profile_image": "https://graph.facebook.com/561723379/picture?type=large", "display_name": "CustodianOfCode", "link": "https://stackoverflow.com/users/2977281/custodianofcode"}, "edited": false, "score": 0, "creation_date": 1453940882, "post_id": 35049703, "comment_id": 57825803, "body": "The linked question does not address the problem, because the requirement here is for the hyperlink to perform more complex logic than simply navigating to a fixed destination. Instead it needs to perform a lookup, hence using worksheet_followhyperlink method is the only solution."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5849302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f5c6fdbfcb85db2c44e4324afb876a?s=128&d=identicon&r=PG&f=1", "display_name": "Prasad", "link": "https://stackoverflow.com/users/5849302/prasad"}, "edited": false, "score": 0, "creation_date": 1454004750, "post_id": 35050793, "comment_id": 57860740, "body": "Yes I don&#39;t want cells to be linked to a fixed destination.... I want the text containing in cell only... means particular name or text in worksheet... Is it possible to put formula without Visual Basic.. please tell me.."}, {"owner": {"reputation": 664, "user_id": 2977281, "user_type": "registered", "profile_image": "https://graph.facebook.com/561723379/picture?type=large", "display_name": "CustodianOfCode", "link": "https://stackoverflow.com/users/2977281/custodianofcode"}, "reply_to_user": {"reputation": 1, "user_id": 5849302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f5c6fdbfcb85db2c44e4324afb876a?s=128&d=identicon&r=PG&f=1", "display_name": "Prasad", "link": "https://stackoverflow.com/users/5849302/prasad"}, "edited": false, "score": 0, "creation_date": 1454040582, "post_id": 35050793, "comment_id": 57875905, "body": "You need to use vb, no way around it. Do some research on the follow hyperlink method."}], "tags": [], "owner": {"reputation": 664, "user_id": 2977281, "user_type": "registered", "profile_image": "https://graph.facebook.com/561723379/picture?type=large", "display_name": "CustodianOfCode", "link": "https://stackoverflow.com/users/2977281/custodianofcode"}, "is_accepted": false, "score": 0, "last_activity_date": 1453940750, "creation_date": 1453940750, "answer_id": 35050793, "question_id": 35049703, "link": "https://stackoverflow.com/questions/35049703/how-to-give-hyperlink-for-particular-name-in-excel-cell/35050793#35050793", "title": "How to give hyperlink for particular name in excel cell", "body": "<p>I know what you mean. You don't want cells to be linked to a fixed destination, but rather have the destination determined at runtime, when the user clicks the link, based on the contents of the cell. </p>\n\n<p>The only way to implement this is to have the target of the hyperlink pointing to the cell itself. Then in the workbook_followhyperlink method of the sheet, it should interpret the cell value, and direct the user to the right destination (or do any other action - I often use this to make a network path 'clickable' and open it in explorer).</p>\n"}], "owner": {"reputation": 1, "user_id": 5849302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f5c6fdbfcb85db2c44e4324afb876a?s=128&d=identicon&r=PG&f=1", "display_name": "Prasad", "link": "https://stackoverflow.com/users/5849302/prasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453940750, "creation_date": 1453935242, "last_edit_date": 1453938128, "question_id": 35049703, "link": "https://stackoverflow.com/questions/35049703/how-to-give-hyperlink-for-particular-name-in-excel-cell", "title": "How to give hyperlink for particular name in excel cell", "body": "<p>If I give hyperlink for cell A1 in Sheet1, that link automatically should go to A4 in Sheet2. I mean if I click on \u201cApple\u201d it should go to where the \u201cApple\u201d Cell in Sheet2 even (Where ever it is in Sheet2) if it is shuffled in Sheet2. Here in Sheet2 the cell is not important the \u201cApple\u201d is important, like Vlookup function.<a href=\"http://i.stack.imgur.com/mpmXe.jpg\" rel=\"nofollow\">enter image description here</a></p>\n"}, {"tags": ["vba", "excel", "range"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1453934957, "post_id": 35049558, "comment_id": 57823618, "body": "Change <code>ColumnAverageToTop (rg)</code> to <code>ColumnAverageToTop rg</code> OR <code>Call CoumnAverageToTop (rg)</code>"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1453935143, "post_id": 35049558, "comment_id": 57823701, "body": "VBA doesn&#39;t use parentheses around parameters to subroutines unless you use <code>CALL</code> first."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1453935681, "post_id": 35049558, "comment_id": 57823958, "body": "Also your <code>Application.WorksheetFunction.Average(rg.Columns(rg.Column))</code> will always return the column number as the average. You want something like this <code>Application.WorksheetFunction.Average(Range(Left(rg.Address(&zwnj;&#8203;0, 0), 1) &amp; &quot;:&quot; &amp; Left(rg.Address(0, 0), 1)))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 1, "last_activity_date": 1453946175, "last_edit_date": 1453946175, "creation_date": 1453944962, "answer_id": 35051392, "question_id": 35049558, "link": "https://stackoverflow.com/questions/35049558/passing-a-range-object-to-a-sub-in-vba/35051392#35051392", "title": "passing a range object to a sub in VBA", "body": "<p>Good that there's a comment that is telling what this sub should do: I read it as: If I run \"<code>Test()</code>\", the following happens: in the passed range's column in row one, the average of that column's values should appear.</p>\n\n<p>There are three problems in your code. \nThe first is mentioned in previous comments: Use either <code>call ColumnAverageToTop(rg)</code> or <code>ColumnAverageToTop rg</code> in your test-routine. Solution:</p>\n\n<pre><code>Sub test()\n    Dim rg As Range\n    Set rg = ThisWorkbook.Worksheets(1).Range(\"B1\")\n    ColumnAverageToTop rg\nEnd Sub\n</code></pre>\n\n<p>Now that we will succesfully enter the ColumnAverageToTop routine, there's an issue with passing the parameter to the <code>WorkSheetFunction.Average</code>\nIt takes arguments as documented here: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836809.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff836809.aspx</a> so to keep it simple just make sure to pass a Range-object to it on which the calculation is performed.</p>\n\n<p>Lastly, when using End and Offset, make sure you use them in the right order. Each of these functions will provide a new range object. I see you attempt to get the cell below the passed argument and then go down and get all the other values to calculate the average of that range.</p>\n\n<p>If you truely always need the average of the entire column, I would advise:</p>\n\n<pre><code>Sub ColumnAverageToTop(rg As Range)\n    'calculates the average of the data in column and puts it in row 1 of column\n    'We declare where we put the value: Cells(1,1) of the column of the Range passed\n    'E.g. \"B1\" passed means that the average will be in \"B1\".\n    'Same fore passing \"B323\"\n    rg.EntireColumn.Cells(1, 1).Value = WorksheetFunction.Average(rg.EntireColumn)\nEnd Sub\n</code></pre>\n\n<p>This will include any numerical value in row 1 of the same column of the passed range, even though it will be overwritten with the result. Running the same test multiple times will therefore change the result. </p>\n\n<p>If you really need the average of everything below the 1st row until the first blank row, it should be:</p>\n\n<p><code>.rg.EntireColumn.Cells(1,1).value = WorksheetFunction.Average(rg.EntireColumn.Range(Cells(2, 1), Cells(2,1).End(xlDown)))</code></p>\n\n<p>If your need the average of the filled cells below the referenced cell:</p>\n\n<p><code>.rg.EntireColumn.Cells(1, 1).Value = WorksheetFunction.Average(rg.Offset(1, 0).Resize(rg.Offset(1, 0).End(xlDown).Row - rg.Offset(1, 0), 1))</code></p>\n\n<p>Hope this helps you out.</p>\n"}], "owner": {"reputation": 1, "user_id": 5415037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732ac91e8b37c4f677c4eebdc4fdb71a?s=128&d=identicon&r=PG", "display_name": "Colm", "link": "https://stackoverflow.com/users/5415037/colm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 711, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459772360, "creation_date": 1453934537, "last_edit_date": 1459772360, "question_id": 35049558, "link": "https://stackoverflow.com/questions/35049558/passing-a-range-object-to-a-sub-in-vba", "title": "passing a range object to a sub in VBA", "body": "<p>Trying to create a subroutine that takes a range cell and calculates the average of the cells in that column. But I get the error: Object Required</p>\n\n<p>How can I correct this?</p>\n\n<pre><code>    Sub test()\n\n    Dim rg As Range\n\n    Set rg = ThisWorkbook.Worksheets(1).Range(\"B1\")\n    ColumnAverageToTop (rg)\n\n    End Sub\n\n    Sub ColumnAverageToTop(rg As Range)\n    'calculates the average of the data in column and puts it above the data\n    Cells(1, rg.Column).End(xlDown).Offset(1, 0).Value =  Application.WorksheetFunction.Average(rg.Columns(rg.Column))\n    End Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1453934466, "post_id": 35049443, "comment_id": 57823391, "body": "is this as small as your dataset and a one time thing? because if so, you can do without VBA. See <code>REPT</code> function (with added &quot;,&quot; to cell value), <code>Text-To-Columns</code> and <code>Copy &gt; Past &gt; Transpose</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "is_accepted": false, "score": 0, "last_activity_date": 1453935245, "creation_date": 1453935245, "answer_id": 35049705, "question_id": 35049443, "link": "https://stackoverflow.com/questions/35049443/simple-excel-code-array-issue/35049705#35049705", "title": "simple excel code array issue", "body": "<p>You can do this with this simple code:</p>\n\n<pre><code>Sub trasposeNumbers()\n    Dim i\n    For Each i In Range(\"B1:B100\")\n        If i.Value = 0 Then\n            'do nothing\n        Else\n            Range(Cells(i.Row, 1), Cells(i.Row, i.Value)).Value = i.Offset(0, -1).Value\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>This way you override the value in column B, just note that. </p>\n"}, {"tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 0, "last_activity_date": 1453938111, "creation_date": 1453938111, "answer_id": 35050336, "question_id": 35049443, "link": "https://stackoverflow.com/questions/35049443/simple-excel-code-array-issue/35050336#35050336", "title": "simple excel code array issue", "body": "<p>As a fast solution without any later transposing you could use this:</p>\n\n<pre><code>Sub test()\n  Dim values As Variant, counter As Variant\n  values = [A1:A100].Value 'change the ranges to fit your needs\n  counter = [B1:B100].Value\n\n  Dim output() As Variant\n  ReDim output(0 To Application.WorksheetFunction.Sum(counter) - 1, 0)\n\n  Dim i As Long, j As Long\n\n  While i &lt;= UBound(output)\n    j = j + 1\n    For i = i To counter(j, 1) + i - 1\n      output(i, 0) = values(j, 1)\n    Next\n  Wend\n\n  [C1].Resize(UBound(output) + 1).Value = output\n  'change C1 to the cell to start your output\n\nEnd Sub\n</code></pre>\n\n<p>It generates an array (<code>output</code>) which will simply be pasted starting with <code>C1</code> (can be changed)</p>\n"}], "owner": {"reputation": 13, "user_id": 5849245, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zlY0N2p6i08/AAAAAAAAAAI/AAAAAAAAAWU/CmforMd2CJ0/photo.jpg?sz=128", "display_name": "neal pfeiffenberger", "link": "https://stackoverflow.com/users/5849245/neal-pfeiffenberger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 35050336, "answer_count": 2, "score": 1, "last_activity_date": 1453938111, "creation_date": 1453934052, "last_edit_date": 1531161705, "question_id": 35049443, "link": "https://stackoverflow.com/questions/35049443/simple-excel-code-array-issue", "title": "simple excel code array issue", "body": "<p>so i have 2 columns A and B with numbers in them, something like this.</p>\n\n<pre><code>A                   B\n96.66666667         0\n193.3333333         0\n290                 0\n386.6666667         0 \n483.3333333         1\n725                 22\n966.6666667         19\n1208.333333         10\n</code></pre>\n\n<p>What I want code for is to look at column B and if its value is 0, put nothing in say column C1.  If column B is >0, then take its corresponding value in A, and list the A value, B number of times.  So my final goal column in C would look like:</p>\n\n<pre><code>483.3333333333333\n725\n725\n725\n725\netc til 725 happens 22 times then\n966\n966\netc until 966 happens 19 times etc.\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1453933948, "post_id": 35049310, "comment_id": 57823109, "body": "while <a href=\"https://support.office.com/en-US/article/COUNT-function-A59CD7FC-B623-4D93-87A4-D23BF411294C\" rel=\"nofollow noreferrer\">COUNT</a> should help, your <code>Jan</code> may be a number with a <code>MMM</code> formatting... it is not completely clear what you have and need.... can you specify you question a bit?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453934093, "post_id": 35049310, "comment_id": 57823187, "body": "or post a sample screenshot of your data ..."}], "answers": [{"comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1453936045, "post_id": 35049600, "comment_id": 57824102, "body": "This would count the numerical characters inside the cell... at least 1 to 8, cus 0 and 9 would not be count by your code. A simple <code>IsNumeric(Mid(c.Value,i,1)</code> would be easier... while this could also be done easiely without VBA by an array-formula like this: <code>=SUM(IF(ROW(INDIRECT(&quot;1:&quot;&amp;LEN(A1))),ISNUMBER(MID(A1,ROW(INDI&zwnj;&#8203;RECT(&quot;1:&quot;&amp;LEN(A1))),&zwnj;&#8203;1)*1)*1))</code>"}], "tags": [], "owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "is_accepted": false, "score": -1, "last_activity_date": 1453934816, "creation_date": 1453934816, "answer_id": 35049600, "question_id": 35049310, "link": "https://stackoverflow.com/questions/35049310/how-to-count-the-numeric-values-from-cell/35049600#35049600", "title": "How to count the numeric values from cell", "body": "<p>Here is my answer:</p>\n\n<pre><code>Sub countingNumbers()\n    Dim c As Range\n    Dim L As Long\n    Dim s As String\n    Dim tmp\n    Dim i\n    Dim y\n    Set c = Range(\"A1\") 'Imagine in A1 is this: \"RDFY2372784GDTD2GV3G3G3V3\"\n    L = Len(c.Value) 'to store the len of the string\n    s = c.Value 'to store the string\n    y = 0 'the index of the numbers\n    For i = 1 To L\n        tmp = Left(Right(s, i), 1) 'to take just one letter at the time\n        If Asc(tmp) &lt; 57 And Asc(tmp) &gt; 48 Then\n        'if is a number ASC() returns the ASCII code of that number\n        'and increase y one by one || that is number by number\n            y = y + 1\n        End If\n    Next i\n    Range(\"B2\").Value = y 'store the counting in B2\nEnd Sub\n\n\nPart of the ASCII Table:\n+------------+-----------+\n| ASCII Code | Character |\n+------------+-----------+\n|         48 | 0         |\n|         49 | 1         |\n|         50 | 2         |\n|         51 | 3         |\n|         52 | 4         |\n|         53 | 5         |\n|         54 | 6         |\n|         55 | 7         |\n|         56 | 8         |\n|         57 | 9         |\n|         64 | @         |\n|         65 | A         |\n|         66 | B         |\n|         67 | C         |\n|         68 | D         |\n|         69 | E         |\n|         70 | F         |\n|         71 | G         |\n|         72 | H         |\n|         73 | I         |\n|         74 | J         |\n+------------+-----------+\n</code></pre>\n\n<p>Here you can check the <a href=\"http://www.ascii-code.com/\" rel=\"nofollow\">ASCII</a> table</p>\n"}, {"tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": false, "score": 0, "last_activity_date": 1453944199, "creation_date": 1453944199, "answer_id": 35051293, "question_id": 35049310, "link": "https://stackoverflow.com/questions/35049310/how-to-count-the-numeric-values-from-cell/35051293#35051293", "title": "How to count the numeric values from cell", "body": "<p>You could also use the <code>split</code> function in a UDF:</p>\n\n<pre><code>Function CountNumbers(R As Range) As Integer\n  Dim values, value As Variant\n  Dim result As Integer\n\n  values = Split(R.Text, \",\")\n  result = 0\n\n  For Each value In values\n    If IsNumeric(value) Then\n      result = result + 1\n    End If\n  Next value\n\n  CountNumbers = result\n\nEnd Function\n</code></pre>\n\n<p>From here, you could call it within another Excel cell as:</p>\n\n<pre><code>=CountNumbers(A1)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5692997, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/AagZU.jpg?s=128&g=1", "display_name": "Rohit Singh", "link": "https://stackoverflow.com/users/5692997/rohit-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1453944199, "creation_date": 1453933598, "last_edit_date": 1531161705, "question_id": 35049310, "link": "https://stackoverflow.com/questions/35049310/how-to-count-the-numeric-values-from-cell", "title": "How to count the numeric values from cell", "body": "<p>I have values in cell like.</p>\n\n<pre><code>1,2,4,45,64,Jan. Ans: 5\n</code></pre>\n\n<p>I want to count only number from the cell.\nIs it possible?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 5152595, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0fe63ac592fdc0b2f3888adb1c596b42?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Chandler", "link": "https://stackoverflow.com/users/5152595/graham-chandler"}, "edited": false, "score": 0, "creation_date": 1453933320, "post_id": 35049204, "comment_id": 57822753, "body": "is it because I&#39;m using spreadsheet formulas in vba?  I don&#39;t normally use them"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 2, "creation_date": 1453933592, "post_id": 35049204, "comment_id": 57822893, "body": "You are <i>inside</i> a string and except for <code>&quot;</code> it will ignore any syntax. This way you need to end the string to make the <code>_</code> useable."}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "reply_to_user": {"reputation": 155, "user_id": 5152595, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0fe63ac592fdc0b2f3888adb1c596b42?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Chandler", "link": "https://stackoverflow.com/users/5152595/graham-chandler"}, "edited": false, "score": 1, "creation_date": 1453933974, "post_id": 35049204, "comment_id": 57823126, "body": "@GrahamChandler Remember to check the answer as correct when you get the right answer"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 7, "last_activity_date": 1453933200, "creation_date": 1453933200, "answer_id": 35049204, "question_id": 35049174, "link": "https://stackoverflow.com/questions/35049174/excel-vba-line-break-in-code/35049204#35049204", "title": "excel vba: line break in code", "body": "<p>Line breaks don't work like that.  </p>\n\n<p>You need something like:</p>\n\n<pre><code>   fset(0, 16).Formula = \"THISIS() + \" &amp; _\n                         \"REALLYLONG()\" \n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 5152595, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0fe63ac592fdc0b2f3888adb1c596b42?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Chandler", "link": "https://stackoverflow.com/users/5152595/graham-chandler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1670, "favorite_count": 0, "accepted_answer_id": 35049204, "answer_count": 1, "score": 1, "last_activity_date": 1453933200, "creation_date": 1453933079, "question_id": 35049174, "link": "https://stackoverflow.com/questions/35049174/excel-vba-line-break-in-code", "title": "excel vba: line break in code", "body": "<p>I have a rather lengthy formula in excel vba that I'm being forced to break into multiple lines.  I've tried inserting a \" _\" but I'm getting the following error:</p>\n\n<p>\"Compile error:  Expected: end of statement\"            </p>\n\n<p>I've looked over this code several times and cant seem to find what is driving this error.  If someone could look over the code below and help me figure this out I'd greatly appreciate it.  Thanks in advance.</p>\n\n<pre><code>        If InStr(1, lineitem.Value, \"Excess MO\") &gt; 0 And InStr(1, lineitem.Value, \"AOS\") &gt; 0 Then\n        lineitem.Offset(0, 16).Formula = \"=SUMPRODUCT(COUNTIFS(INDIRECT(\"\"'\"\"&amp;R2C3&amp;\"\" Claims'!B:B\"\"),R[0]C[-19],INDIRECT(\"\"'\"\"&amp;R2C3&amp;\"\" Claims'!C:C\"\"),R[0]C[-17],INDIRECT(\"\"'\"\"&amp;R2C3&amp;\"\" Claims'!E:E\"\"),CHOOSE({1;2},R[0]C[-15],R[0]C[-14]),INDIRECT(\"\"'\"\"&amp;R2C3&amp;\"\" Claims'!P:P\"\"),\"\"&gt;\"\"&amp;R5C3,INDIRECT(\"\"'\"\"&amp;R2C3&amp;\"\" Claims'!H:H\"\"),\"\"&lt;&gt;\"\"&amp;\"\"NS\"\"))- _\n        SUMPRODUCT(COUNTIFS(INDIRECT(\"\"'\"\"&amp;R2C3&amp;\"\" Claims'!B:B\"\"),R[0]C[-19],INDIRECT(\"\"'\"\"&amp;R2C3&amp;\"\" Claims'!C:C\"\"),R[0]C[-17],INDIRECT(\"\"'\"\"&amp;R2C3&amp;\"\" Claims'!E:E\"\"),CHOOSE({1;2},R[0]C[-15],R[0]C[-14]),INDIRECT(\"\"'\"\"&amp;R2C3&amp;\"\" Claims'!P:P\"\"),\"\"&gt;\"\"&amp;R5C3,INDIRECT(\"\"'\"\"&amp;R2C3&amp;\"\" Claims'!H:H\"\"),\"\"&lt;&gt;\"\"&amp;\"\"NS\"\",INDIRECT(\"\"'\"\"&amp;R2C3&amp;\"\" Claims'!G:G\"\"),R2C5:R2C27))- _\n        SUMPRODUCT(COUNTIFS(INDIRECT(\"\"'\"\"&amp;R2C3&amp;\"\" Claims'!B:B\"\"),R[0]C[-19],INDIRECT(\"\"'\"\"&amp;R2C3&amp;\"\" Claims'!C:C\"\"),R[0]C[-17],INDIRECT(\"\"'\"\"&amp;R2C3&amp;\"\" Claims'!E:E\"\"),CHOOSE({1;2},R[0]C[-15],R[0]C[-14]),INDIRECT(\"\"'\"\"&amp;R2C3&amp;\"\" Claims'!P:P\"\"),\"\"&gt;\"\"&amp;R5C3,INDIRECT(\"\"'\"\"&amp;R2C3&amp;\"\" Claims'!H:H\"\"),\"\"&lt;&gt;\"\"&amp;\"\"NS\"\",INDIRECT(\"\"'\"\"&amp;R2C3&amp;\"\" Claims'!G:G\"\"),R5C5:R5C54))\"\n        lineitem.Offset(0, 16).Value = lineitem.Offset(0, 16).Value\n        lineitem.Offset(0, 17).Formula = \"=SUMPRODUCT(COUNTIFS(INDIRECT(\"\"'\"\"&amp;R3C3&amp;\"\" Claims'!B:B\"\"),R[0]C[-20],INDIRECT(\"\"'\"\"&amp;R3C3&amp;\"\" Claims'!C:C\"\"),R[0]C[-18],INDIRECT(\"\"'\"\"&amp;R3C3&amp;\"\" Claims'!E:E\"\"),CHOOSE({1;2},R[0]C[-16],R[0]C[-15]),INDIRECT(\"\"'\"\"&amp;R3C3&amp;\"\" Claims'!P:P\"\"),\"\"&gt;\"\"&amp;R5C3,INDIRECT(\"\"'\"\"&amp;R3C3&amp;\"\" Claims'!H:H\"\"),\"\"&lt;&gt;\"\"&amp;\"\"NS\"\"))- _\n        SUMPRODUCT(COUNTIFS(INDIRECT(\"\"'\"\"&amp;R3C3&amp;\"\" Claims'!B:B\"\"),R[0]C[-20],INDIRECT(\"\"'\"\"&amp;R3C3&amp;\"\" Claims'!C:C\"\"),R[0]C[-18],INDIRECT(\"\"'\"\"&amp;R3C3&amp;\"\" Claims'!E:E\"\"),CHOOSE({1;2},R[0]C[-16],R[0]C[-15]),INDIRECT(\"\"'\"\"&amp;R3C3&amp;\"\" Claims'!P:P\"\"),\"\"&gt;\"\"&amp;R5C3,INDIRECT(\"\"'\"\"&amp;R3C3&amp;\"\" Claims'!H:H\"\"),\"\"&lt;&gt;\"\"&amp;\"\"NS\"\",INDIRECT(\"\"'\"\"&amp;R3C3&amp;\"\" Claims'!G:G\"\"),R2C5:R2C27))- _\n        SUMPRODUCT(COUNTIFS(INDIRECT(\"\"'\"\"&amp;R3C3&amp;\"\" Claims'!B:B\"\"),R[0]C[-20],INDIRECT(\"\"'\"\"&amp;R3C3&amp;\"\" Claims'!C:C\"\"),R[0]C[-18],INDIRECT(\"\"'\"\"&amp;R3C3&amp;\"\" Claims'!E:E\"\"),CHOOSE({1;2},R[0]C[-16],R[0]C[-15]),INDIRECT(\"\"'\"\"&amp;R3C3&amp;\"\" Claims'!P:P\"\"),\"\"&gt;\"\"&amp;R5C3,INDIRECT(\"\"'\"\"&amp;R2C3&amp;\"\" Claims'!H:H\"\"),\"\"&lt;&gt;\"\"&amp;\"\"NS\"\",INDIRECT(\"\"'\"\"&amp;R3C3&amp;\"\" Claims'!G:G\"\"),R5C5:R5C54))\"\n        lineitem.Offset(0, 17).Value = lineitem.Offset(0, 17).Value\n        End If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 235, "user_id": 1011866, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/74ca11dd03d332bbb3ebe833870e3532?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1011866/john"}, "edited": false, "score": 0, "creation_date": 1453945946, "post_id": 35049255, "comment_id": 57827215, "body": "Love your work Gary, works like a charm. Have not come across Application.CommandBars before will look into it much appreciated."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 235, "user_id": 1011866, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/74ca11dd03d332bbb3ebe833870e3532?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1011866/john"}, "edited": false, "score": 0, "creation_date": 1453946310, "post_id": 35049255, "comment_id": 57827316, "body": "@John  <b>Please note the code adapted from Jeeped&#39;s</b>"}, {"owner": {"reputation": 235, "user_id": 1011866, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/74ca11dd03d332bbb3ebe833870e3532?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1011866/john"}, "edited": false, "score": 0, "creation_date": 1454744789, "post_id": 35049255, "comment_id": 58191490, "body": "Thanks Gary appreciate you pointing me in the direction of Jeeped&#39;s post."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1453933367, "last_edit_date": 1495540241, "creation_date": 1453933367, "answer_id": 35049255, "question_id": 35049027, "link": "https://stackoverflow.com/questions/35049027/excel-vbscript-return-the-number-of-fonts-available-in-excel/35049255#35049255", "title": "Excel vbscript return the number of fonts available in excel", "body": "<p>This should give the count and list the names:</p>\n\n<pre><code>Sub dural()\n   Dim FontList\n   Dim i As Long\n   Set FontList = Application.CommandBars(\"Formatting\").FindControl(ID:=1728)\n\n   MsgBox FontList.ListCount\n\n   For i = 1 To FontList.ListCount\n       Cells(Rows.Count, 1).End(xlUp)(2) = FontList.List(i)\n   Next i\nEnd Sub\n</code></pre>\n\n<p><em>From a Jeeped Post</em></p>\n\n<p><a href=\"https://stackoverflow.com/questions/32080762/get-a-list-of-all-fonts-in-vba-excel-2010\">Jeeped Post</a></p>\n"}], "owner": {"reputation": 235, "user_id": 1011866, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/74ca11dd03d332bbb3ebe833870e3532?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1011866/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 35049255, "answer_count": 1, "score": 0, "last_activity_date": 1459769754, "creation_date": 1453932503, "last_edit_date": 1459769754, "question_id": 35049027, "link": "https://stackoverflow.com/questions/35049027/excel-vbscript-return-the-number-of-fonts-available-in-excel", "title": "Excel vbscript return the number of fonts available in excel", "body": "<p>Is it possible to access the fonts available in excel?</p>\n\n<p>I realise you can set the font by using:</p>\n\n<pre><code> Range(\"A1:C1\").Select\n     With Selection.Font\n         .Name = \"Arial\"\n     End With\n</code></pre>\n\n<p>What I'd like to do is return the number of fonts in excel and then loop through them to get the name of each font.</p>\n\n<p>Something like:</p>\n\n<pre><code>For Counter = 1 To excel.fonts\n   ActiveCell = excel.font.Name\nNext Counter\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "is_accepted": false, "score": 0, "last_activity_date": 1453931696, "creation_date": 1453931696, "answer_id": 35048816, "question_id": 35048547, "link": "https://stackoverflow.com/questions/35048547/how-to-add-a-row-before-last-row-of-the-table-using-vba/35048816#35048816", "title": "how to add a row before last row of the table using VBA?", "body": "<p>Found by using the record macro tool</p>\n\n<pre><code>Thisworkbook.worksheets(\"name of your sheet\").Row(lrow2).Insert shift:=xldown, CopyOrigin:=xlFormatFromLeftOrAbove.\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5645114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/25b1545132baa878e42493be79bed595?s=128&d=identicon&r=PG&f=1", "display_name": "T. Patel", "link": "https://stackoverflow.com/users/5645114/t-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 795, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453931696, "creation_date": 1453930670, "last_edit_date": 1531164843, "question_id": 35048547, "link": "https://stackoverflow.com/questions/35048547/how-to-add-a-row-before-last-row-of-the-table-using-vba", "title": "how to add a row before last row of the table using VBA?", "body": "<p>Im trying to add a row before last row of the table and hidding the last row. The code is working fine including hidding last row of table. but not sure how to add row.  </p>\n\n<pre><code>Sub StayOverRoom2()\n\nDim lRow1 As Long\nDim lRow2 As Long\nDim eRow As Long\nDim Name1 As String\nDim Name2 As String\nDim Check As Boolean\nDim Table As ListObject\nDim nRow As ListRow\nDim lLastRow As Long\nDim strTableName As String\n\nlRow1 = Sheets(\"DR01\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nlRow2 = Sheets(\"DR02\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nstrTableName = \"DailyReport2\"\n\nSet Table = Range(strTableName).ListObject\n\nSheets(\"DR02\").Rows(\"1:150\").EntireRow.Hidden = False\n\nFor i = 11 To lRow1\n    Name1 = Sheets(\"DR01\").Cells(i, \"C\").Value\n    Check = False\n\n    For j = 11 To lRow2\n        Name2 = Sheets(\"DR02\").Cells(j, \"C\").Value\n\n        If Sheets(\"DR01\").Cells(i, 5) &lt;= Date Or Name1 = Name2 Then\n            Check = True\n        End If\n    Next j\n\n    If Not Check Then\n        Set nRow = Table.ListRows.Add(AlwaysInsert:=True)\n            Sheets(\"DR01\").Range(Sheets(\"DR01\").Cells(i, \"B\"), Sheets(\"DR01\").Cells(i, \"E\")).Copy\n            eRow = Sheets(\"DR02\").Cells(Sheets(\"DR02\").Rows.Count, 2).End(xlUp).Offset(1, 0).Row\n            nRow.Range(1, 1).PasteSpecial\n            nRow.Range(1, \"E\").Value = \"S/O\"\n            nRow.Range(1, \"F\").Value = \"-\"\n            nRow.Range(1, \"G\").Value = \"-\"\n            nRow.Range(1, \"H\").Value = \"-\"\n            nRow.Range(1, \"I\").Value = \"-\"\n            nRow.Range(1, \"J\").Value = \"-\"\n            nRow.Range(1, \"K\").Value = \"-\"\n            Sheets(\"DR01\").Cells(i, \"M\").Copy\n            nRow.Range(1, \"L\").PasteSpecial\n\n            If Sheets(\"DR01\").Cells(i, \"M\") = \"R.D. - D\" Or _\n                Sheets(\"DR01\").Cells(i, \"M\") = \"P.P.D. - D\" Or _\n                Sheets(\"DR01\").Cells(i, \"M\") = \"C.R. - D\" Then\n                nRow.Range(1, \"L\") = \"Daily\"\n            End If\n\n            If Sheets(\"DR01\").Cells(i, \"M\") = \"R.D. - W\" Or _\n                Sheets(\"DR01\").Cells(i, \"M\") = \"P.P.D. - W\" Or _\n                Sheets(\"DR01\").Cells(i, \"M\") = \"C.R. - W\" Then\n                nRow.Range(1, \"L\") = \"Weekly\"\n            End If\n        Application.CutCopyMode = False\n    End If\nNext i\n\nlRow2 = Sheets(\"DR02\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nSheets(\"DR02\").Rows(lRow2 &amp; \":\" &amp; lRow2).EntireRow.Hidden = True\n\nEnd Sub\n</code></pre>\n\n<p>Im trying to add a row before last row of the table and hidding the last row. The code is working fine including hidding last row of table. but not sure how to add row.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1453930926, "post_id": 35048469, "comment_id": 57821410, "body": "Quick suggestion: Instead of copying the entire <code>Sheet</code>, what if instead you just copies all the <code>Cells</code>? That way, you would just keep the data, no named ranges. ie: <code>Sheets(&quot;mainSheet&quot;).Cells.Copy Sheets(&quot;newSheet&quot;).Cells</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1453930945, "post_id": 35048469, "comment_id": 57821423, "body": "You can delete the names after creating the sheet.  I don&#39;t think there&#39;s a setting which controls whether they get created with the copy."}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453931493, "post_id": 35048707, "comment_id": 57821741, "body": "this is a moot point with so little names, but if there lots of names, you could specify which worksheet to loop through and only delete the names in the worksheet. As well as pass a worksheet argument into the Sub so it works with specific sheets."}, {"owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 0, "creation_date": 1453931635, "post_id": 35048707, "comment_id": 57821820, "body": "I would very much like to see a version that passes the &quot;NewCopy&quot; sheet to the <code>deleteNames</code> sub so that it only deletes named ranges which fall into the scope of the newly created worksheet."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 0, "creation_date": 1453931686, "post_id": 35048707, "comment_id": 57821852, "body": "@DevilsAdvocate - how do we know the scope and if the ranges fit in the new sheet? So you <i>do</i> want to keep <i>some</i> named ranges?"}, {"owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1453931768, "post_id": 35048707, "comment_id": 57821903, "body": "@BruceWayne: I don&#39;t, but it&#39;s possible I might have a sheet that does have named ranges scoped only to that sheet.  If the copy procedure passed the newly created sheet to the delete procedure then it deleted only the names in that scope, it still accomplishes the goal but reduces the risk of deleting something unintentionally, right?"}, {"owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 0, "creation_date": 1453931953, "post_id": 35048707, "comment_id": 57822011, "body": "I just finished modifying it on my own.  It worked but yours is slightly different (probably more robust).  Thanks!"}], "tags": [], "owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "is_accepted": true, "score": 9, "last_activity_date": 1463067207, "last_edit_date": 1463067207, "creation_date": 1453931278, "answer_id": 35048707, "question_id": 35048469, "link": "https://stackoverflow.com/questions/35048469/copy-sheet-without-creating-new-instances-of-named-ranges/35048707#35048707", "title": "Copy sheet without creating new instances of named ranges?", "body": "<p>Here is my answer:</p>\n\n<pre><code>Sub btnCopyTemplate()\n    Dim template As Worksheet\n    Dim newSheet As Worksheet\n    Set template = ActiveWorkbook.Sheets(\"Template\")\n    template.Copy After:=Sheets(Sheets.Count)\n    Set newSheet = ActiveSheet\n    newSheet.Name = \"NewCopy\"\n    deleteNames 'Check the sub\nEnd Sub\n\nSub deleteNames()\n    Dim theName As Name\n    For Each theName In Names\n        If TypeOf theName.Parent Is Worksheet Then\n            theName.Delete\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>This way you will delete all the names with the scope \"worksheet\" and keep the \"workbook\" names</p>\n\n<p><strong>Edit#2</strong></p>\n\n<p>After read the comments here is the update passing the sheet to loop only the \"newSheet\"</p>\n\n<pre><code>Sub btnCopyTemplate()\n    Dim template As Worksheet\n    Dim newSheet As Worksheet\n    Set template = ActiveWorkbook.Sheets(\"Template\")\n    template.Copy After:=Sheets(Sheets.Count)\n    Set newSheet = ActiveSheet\n    newSheet.Name = \"NewCopy\"\n    deleteNames newSheet\nEnd Sub\n\nSub deleteNames(sht As Worksheet)\n    Dim theName As Name\n    For Each theName In Names\n        If (TypeOf theName.Parent Is Worksheet) And (sht.Name = theName.Parent.Name) Then\n            theName.Delete\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16478, "favorite_count": 3, "accepted_answer_id": 35048707, "answer_count": 1, "score": 6, "last_activity_date": 1463067207, "creation_date": 1453930371, "question_id": 35048469, "link": "https://stackoverflow.com/questions/35048469/copy-sheet-without-creating-new-instances-of-named-ranges", "title": "Copy sheet without creating new instances of named ranges?", "body": "<p>I'm using the following code to copy a sheet.  I also have a few named ranges that are scoped to the Workbook.  The problem is, when I do the copy, it creates duplicates of all the named ranges with a scope of the new sheet.  Everything works of course but I could potentially have 20+ sheets.  I don't need 80 named ranges that are mostly duplicates.  How can I avoid this?</p>\n\n<pre><code>Sub btnCopyTemplate()\n    Dim template As Worksheet\n    Dim newSheet As Worksheet\n    Set template = ActiveWorkbook.Sheets(\"Template\")\n    template.Copy After:=Sheets(Sheets.Count)\n    Set newSheet = ActiveSheet\n    newSheet.Name = \"NewCopy\"\nEnd Sub\n</code></pre>\n\n<p>And the Name Manager after a copy:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xe3bY.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/xe3bY.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1453930492, "post_id": 35048425, "comment_id": 57821143, "body": "<a href=\"https://www.google.com/search?q=create+access+table+from+excel+vba\" rel=\"nofollow noreferrer\">google.com/search?q=create+access+table+from+excel+vba</a>"}, {"owner": {"reputation": 1683, "user_id": 3299157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fd2850c64bf866ed6e6b448eca08f0ea?s=128&d=identicon&r=PG&f=1", "display_name": "Ageonix", "link": "https://stackoverflow.com/users/3299157/ageonix"}, "edited": false, "score": 1, "creation_date": 1453930507, "post_id": 35048425, "comment_id": 57821154, "body": "Have a look here. <a href=\"http://stackoverflow.com/questions/16312375/opening-access-from-excel-vba\" title=\"opening access from excel vba\">stackoverflow.com/questions/16312375/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5849052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1af8555e3f05da2f887a4383283fb74?s=128&d=identicon&r=PG&f=1", "display_name": "cam503", "link": "https://stackoverflow.com/users/5849052/cam503"}, "edited": false, "score": 0, "creation_date": 1453931186, "post_id": 35048533, "comment_id": 57821561, "body": "Thanks Ageonix, but once the connection has been opened, how would I command Access to import the text file that I desire?"}, {"owner": {"reputation": 1683, "user_id": 3299157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fd2850c64bf866ed6e6b448eca08f0ea?s=128&d=identicon&r=PG&f=1", "display_name": "Ageonix", "link": "https://stackoverflow.com/users/3299157/ageonix"}, "reply_to_user": {"reputation": 11, "user_id": 5849052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1af8555e3f05da2f887a4383283fb74?s=128&d=identicon&r=PG&f=1", "display_name": "cam503", "link": "https://stackoverflow.com/users/5849052/cam503"}, "edited": false, "score": 0, "creation_date": 1453931885, "post_id": 35048533, "comment_id": 57821962, "body": "Just so I&#39;m clear, you want to open/import a text file within Excel, then use that to create a new table in Access?  How are you going to determine the table structure?  Or do you mean the table already exists in Access and you just want to dump the text file data into the table?  I think you&#39;re going to need more info than what I text file would give you."}, {"owner": {"reputation": 11, "user_id": 5849052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1af8555e3f05da2f887a4383283fb74?s=128&d=identicon&r=PG&f=1", "display_name": "cam503", "link": "https://stackoverflow.com/users/5849052/cam503"}, "edited": false, "score": 0, "creation_date": 1453933706, "post_id": 35048533, "comment_id": 57822959, "body": "I would like to be able to execute VBA code in Excel, that will tell Access to open a database, create a new table, and populate that table with the data from a txt file.  The txt file contains data delimited by a character (comma, pipe, semicolon, doesn&#39;t matter)"}], "tags": [], "owner": {"reputation": 1683, "user_id": 3299157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fd2850c64bf866ed6e6b448eca08f0ea?s=128&d=identicon&r=PG&f=1", "display_name": "Ageonix", "link": "https://stackoverflow.com/users/3299157/ageonix"}, "is_accepted": false, "score": 0, "last_activity_date": 1453930612, "creation_date": 1453930612, "answer_id": 35048533, "question_id": 35048425, "link": "https://stackoverflow.com/questions/35048425/connecting-to-access-from-excel-then-create-table-from-txt-file/35048533#35048533", "title": "Connecting to Access from Excel, then create table from txt file", "body": "<p>Google \"Open access database from excel VBA\" and you'll find lots of resources.  Here's the general idea though: </p>\n\n<pre><code>Dim db As Access.Application\nPublic Sub OpenDB()\n\nSet db = New Access.Application\ndb.OpenCurrentDatabase \"C:\\My Documents\\db2.mdb\"\ndb.Application.Visible = True\n\nEnd Sub\n</code></pre>\n\n<p>You can also use a data access technology like ODBC or ADODB.  I'd look into those if you're planning more extensive functionality.  Good luck!</p>\n"}, {"tags": [], "owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "is_accepted": false, "score": 0, "last_activity_date": 1473772328, "creation_date": 1473772328, "answer_id": 39471011, "question_id": 35048425, "link": "https://stackoverflow.com/questions/35048425/connecting-to-access-from-excel-then-create-table-from-txt-file/39471011#39471011", "title": "Connecting to Access from Excel, then create table from txt file", "body": "<p>I had to do this exact same problem. You have a large problem presented in a small question here, but here is my solution to the hardest hurdle. You first parse each line of the text file into an array:</p>\n\n<pre><code>Function ParseLineEntry(LineEntry As String) As Variant\n'Take a text file string and parse it into individual elements in an array.\n    Dim NumFields As Integer, LastFieldStart As Integer\n    Dim LineFieldArray() As Variant\n    Dim i As Long, j As Long\n\n    'Determine how many delimitations there are. My data always had the format\n    'data1|data2|data3|...|dataN|, so there was always at least one field.\n    NumFields = 0\n    For I = 1 To Len(LineEntry)\n        If Mid(LineEntry, i, 1) = \"|\" Then NumFields = NumFields + 1\n    Next i\n    ReDim LineFieldArray(1 To NumFields)\n\n    'Parse out each element from the string and assign it into the appropriate array value\n    LastFieldStart = 1\n    For i = 1 to NumFields\n        For j = LastFieldStart To Len(LineEntry)\n            If Mid(LineEntry, j , 1) = \"|\" Then\n                LineFieldArray(i) = Mid(LineEntry, LastFieldStart, j - LastFieldStart)\n                LastFieldStart = j + 1\n                Exit For\n            End If\n        Next j\n    Next i\n\n    ParseLineEntry = LineFieldArray\nEnd Function\n</code></pre>\n\n<p>You then use another routine to add the connection in (I am using ADODB). My format for entries was <code>TableName|Field1Value|Field2Value|...|FieldNValue|</code>:</p>\n\n<pre><code>Dim InsertDataCommand as String\n\n'LineArray = array populated by ParseLineEntry\nInsertDataCommand = \"INSERT INTO \" &amp; LineArray(1) &amp; \" VALUES (\"\nFor i = 2 To UBound(LineArray)\n    If i = UBound(LineArray) Then\n        InsertDataCommand = InsertDataCommand &amp; \"'\" &amp; LineArray(i) &amp; \"'\" &amp; \")\"\n    Else\n        InsertDataCommand = InsertDataCommand &amp; LineArray(i) &amp; \", \"\n    End If\nNext i\n</code></pre>\n\n<p>Just keep in mind that you will have to build some case handling into this. For example, if you have an empty value (e.g. <code>Val1|Val2||Val4</code>) and it is a string, you can enter \"\" which will already be in the ParseLineEntry array. However, if you are entering this into a number column it will fail on you, you have to insert <code>\"Null\"</code> instead inside the string. Also, if you are adding any strings with an apostrophe, you will have to change it to a <code>''</code>. In sum, I had to go through my lines character by character to find these issues, but the concept is demonstrated.</p>\n\n<p>I built the table programmatically too using the same parsing function, but of this .csv format: <code>TableName|Field1Name|Field1Type|Field1Size|...|</code>.</p>\n\n<p>Again, this is a big problem you are tackling, but I hope this answer helps you with the less straight forward parts.</p>\n"}], "owner": {"reputation": 11, "user_id": 5849052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1af8555e3f05da2f887a4383283fb74?s=128&d=identicon&r=PG&f=1", "display_name": "cam503", "link": "https://stackoverflow.com/users/5849052/cam503"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 574, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473772328, "creation_date": 1453930198, "question_id": 35048425, "link": "https://stackoverflow.com/questions/35048425/connecting-to-access-from-excel-then-create-table-from-txt-file", "title": "Connecting to Access from Excel, then create table from txt file", "body": "<p>I am writing VBA code for an Excel workbook.  I would like to be able to open a connection with an Access database, and then import a txt file (pipe delimited) and create a new table in the database from this txt file.  I have searched everywhere but to no avail.  I have only been able to find VBA code that will accomplish this from within Access itself, rather than from Excel.  Please help!  Thank you</p>\n"}, {"tags": ["excel", "excel-2007", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453930010, "post_id": 35048277, "comment_id": 57820894, "body": "Is <code>UnFilter</code> in a module? Or is it in a <code>Worksheet_Module</code>? If it&#39;s in a module, what happens if you use <code>she.AutoFilterMode = False</code> vs. <code>she.ShowAllData</code>?"}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453930670, "post_id": 35048277, "comment_id": 57821255, "body": "@ScottHoltzman I just tested that and had the same result. It is worth noting that I have the same Unfilter code in the Workbook_Open and Workbook_BeforeClose  and it works as intended. I used that code and put it in it&#39;s own sub to use with the Application.Run, but I get nothing."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453931051, "post_id": 35048277, "comment_id": 57821489, "body": "Did you step through the code line-by-line? If so, when it moves to the <code>Run</code> does it take to that code so that it&#39;s actually running?"}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453931070, "post_id": 35048277, "comment_id": 57821498, "body": "@ScottHoltzman I think that is my dilemma. I do not know how to call the macro from within code that is running on the extract file to perform the unfilter on the Master workbook before the extract code performs the copy/paste into the Master workbook. Does this order of events make sense?"}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453931112, "post_id": 35048277, "comment_id": 57821518, "body": "@ScottHoltzman No, I did not step through the code."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453931171, "post_id": 35048277, "comment_id": 57821553, "body": "Step through the code <code>Extract_Sort_1601_January</code> line-by-line and see what happens when it hits the <code>Run</code> command. If it is working correctly, you will see the debugger move to that code and process it line-by-line. If something else happens, you have information on what needs fixing :)"}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453931495, "post_id": 35048277, "comment_id": 57821742, "body": "Ran through it step by step and found a misspelled word. Corrected that and ran it again. The use of she.AutoFilterMode = False removed the arrows on all the headers. Not a desired result."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453931689, "post_id": 35048277, "comment_id": 57821855, "body": "does <code>ShowAllData</code> work now? (with the misspelled word fix)"}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453931762, "post_id": 35048277, "comment_id": 57821901, "body": "@ScottHoltzman Ha ha. I actually misspelled AutoFilterMode (I had AutiFilterMode). So, a direct answer is no."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453937435, "post_id": 35048277, "comment_id": 57824666, "body": "@ScottHoltzman I apologize, I did not answer one of your questions from above, the Unfilter sub is in a regular module."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1454005738, "post_id": 35048277, "comment_id": 57861344, "body": "@ScottHoltzman Please review my edited question. I think that I may not have been specific enough of my intended goal. I am doing more research and have come to believe that Application.Run is basically doing a Call of a macro that resides in an external workbook and run the code on the &quot;calling&quot; workbook."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1454006103, "post_id": 35048277, "comment_id": 57861565, "body": "good find. surprised I didn&#39;t this before. In the <code>Unfitler</code> sub change <code>For Each she In Worksheets</code> to <code>For Each she In ThisWorkbook.Worksheets</code> to have it run on the workbook containing the code."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1454008877, "post_id": 35048277, "comment_id": 57863350, "body": "@ScottHoltzman I was just able to test it and it works perfectly. Thanks for all the help again Scott! Put this as an answer and I will definitely accept it."}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1454008985, "creation_date": 1454008985, "answer_id": 35070197, "question_id": 35048277, "link": "https://stackoverflow.com/questions/35048277/proper-use-of-application-run/35070197#35070197", "title": "Proper use of Application.Run", "body": "<p>Change the <code>Unfilter</code> sub to work directly with the Workbook where the code resides. </p>\n\n<p>See below:</p>\n\n<pre><code>Sub Unfilter()\n\n    Dim she As Variant\n    For Each she In ThisWorkbook.Worksheets\n         If she.FilterMode Then she.ShowAllData\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "accepted_answer_id": 35070197, "answer_count": 1, "score": 0, "last_activity_date": 1454008985, "creation_date": 1453929744, "last_edit_date": 1531164843, "question_id": 35048277, "link": "https://stackoverflow.com/questions/35048277/proper-use-of-application-run", "title": "Proper use of Application.Run", "body": "<p>I am not sure I fully understand the use of Application.Run. I have tried using this in one of my macros, but I did not see the expected change. Here is the setup. I have an Excel Add-In that runs several macros from a menu system. One of the macros will copy data from an extract workbook to a master workbook. The other day, one of the users had applied a filter to one of the columns and did not clear it before running the copy code. This caused the data to not copy correctly. So I have researched how to run a code on the master workbook from the extract workbook to clear the filter before copy/paste occurs.</p>\n\n<p>To better clarify how I need this to work:</p>\n\n<ol>\n<li><strong>Workbook A</strong> contains data that needs to move to <strong>Workbook B</strong></li>\n<li><strong>Workbook A</strong> will sort the data and remove data that is not needed in\n<strong>workbook B</strong>.</li>\n<li>In <strong>Workbook B</strong> I have code that will show all data if a filter is\napplied upon open and close of the workbook.</li>\n<li>Before copying and pasting the data from <strong>workbook A</strong> to <strong>workbook B</strong>, I\nneed to have <strong>workbook A</strong> trigger the unfilter code in <strong>workbook B</strong> to perform the sub in <strong>workbook B</strong>.</li>\n</ol>\n\n<p>This is the code from the extract workbook (<strong>workbook A</strong>) (that uses the Add-In):</p>\n\n<pre><code>Sub Extract_Sort_1601_January()\n\nDim ANS As Long\n\nANS = MsgBox(\"Is the January 2016 Swivel Master File checked out of SharePoint and currently open on this desktop?\", vbYesNo + vbQuestion + vbDefaultButton1, \"Master File Open\")\nIf ANS = vbNo Or IsWBOpen(\"Swivel - Master - January 2016\") = False Then\n    MsgBox \"The required workbook is not currently open. This procedure will now terminate.\", vbOKOnly + vbExclamation, \"Terminate Procedure\"\n    Exit Sub\nEnd If\n\nApplication.ScreenUpdating = False\n\n    ' This line autofits the columns C, D, O, and P\n    Range(\"C:C,D:D,O:O,P:P\").Columns.AutoFit\n\n    ' This unhides any hidden rows\n    Cells.EntireRow.Hidden = False\n\nDim LR As Long\n\n    For LR = Range(\"B\" &amp; Rows.Count).End(xlUp).Row To 2 Step -1\n        If Range(\"B\" &amp; LR).Value &lt;&gt; \"1\" Then\n            Rows(LR).EntireRow.Delete\n        End If\n    Next LR\n\nApplication.Run \"'Swivel - Master - January 2016.xlsm'!Unfilter\"\n\nWith ActiveWorkbook.Worksheets(\"Extract\").Sort\n    With .SortFields\n        .Clear\n        .Add Key:=Range(\"B2:B2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"D2:D2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"O2:O2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"J2:J2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"K2:K2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"L2:L2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    End With\n    .SetRange Range(\"A2:AE2000\")\n    .Apply\nEnd With\nCells.WrapText = False\nSheets(\"Extract\").Range(\"A2\").Select\n\n    Dim LastRow As Integer, i As Integer, erow As Integer\n\n    'With Workbooks(\"Swivel - Master - January 2016.xlsm\").Sheets(\"Swivel\")\n        'erow = .Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n        '.Range(\"A2:AE\" &amp; erow).AutoFilter 'leaving arguments blank clears all filters, but leaves the drop-down arrows (filter mode still on)\n    'End With\n\n    LastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    For i = 2 To LastRow\n        If Cells(i, 2) = \"1\" Then\n\n            ' As opposed to selecting the cells, this will copy them directly\n            Range(Cells(i, 1), Cells(i, 31)).Copy\n\n            ' As opposed to \"Activating\" the workbook, and selecting the sheet, this will paste the cells directly\n            With Workbooks(\"Swivel - Master - January 2016.xlsm\").Sheets(\"Swivel\")\n                erow = .Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n                .Cells(erow, 1).PasteSpecial xlPasteAll\n            End With\n            Application.CutCopyMode = False\n        End If\n    Next i\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Here is the Unfilter code that I need to run on the Master workbook (<strong>Workbook B</strong>)(this is located in a module in the Master workbook):</p>\n\n<pre><code>Sub Unfilter()\n\n    Dim she As Variant\n    For Each she In Worksheets\n         If she.FilterMode Then she.ShowAllData\n    Next\nEnd Sub\n</code></pre>\n\n<p>Am I using the Application.Run correctly? Or is there another issue with my code? I do not get any errors. When I tested this, the data in <strong>workbook B</strong> remained filtered.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 659469, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/7954576636c731b4b863e2d662ce7fe7?s=128&d=identicon&r=PG", "display_name": "user659469", "link": "https://stackoverflow.com/users/659469/user659469"}, "edited": false, "score": 0, "creation_date": 1454941910, "post_id": 35048490, "comment_id": 58255659, "body": "Hi Scott, can you help me out in this issue ..  <a href=\"http://stackoverflow.com/questions/35249927/access-link-child-fields-value-automatically-hidden-how-to-unhide-it\" title=\"access link child fields value automatically hidden how to unhide it\">stackoverflow.com/questions/35249927/&hellip;</a>"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1453930454, "creation_date": 1453930454, "answer_id": 35048490, "question_id": 35048120, "link": "https://stackoverflow.com/questions/35048120/access-vba-condition-formatting-with-2-different-xlformatcondictiontypes/35048490#35048490", "title": "Access VBA - condition formatting with 2 different xlFormatCondictionTypes", "body": "<p>The code in your post is a bit all over the place in certain areas, so my assumptions on the fixes may be a bit off. However, those things you can probably adjust very easily.</p>\n\n<p>As far as combining the conditions, just place another formula inside the <code>AND</code> wrapper of current expression.</p>\n\n<pre><code>With xlSheet\n    Set range = .Range(\"A1:L1\")\n\n    range.FormatConditions.Add Type:=xlExpression, Formula1:=\"=AND($I1&gt;=TODAY(),($I1&lt;(TODAY()+30),NOT(ISERROR(FIND(\"\"Focus\"\",$I1))))\"\n\n   With range.FormatConditions(1).Interior\n       .Color = Any color            \n   End With\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 325, "user_id": 659469, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/7954576636c731b4b863e2d662ce7fe7?s=128&d=identicon&r=PG", "display_name": "user659469", "link": "https://stackoverflow.com/users/659469/user659469"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 35048490, "answer_count": 1, "score": 1, "last_activity_date": 1453930454, "creation_date": 1453929195, "last_edit_date": 1453930225, "question_id": 35048120, "link": "https://stackoverflow.com/questions/35048120/access-vba-condition-formatting-with-2-different-xlformatcondictiontypes", "title": "Access VBA - condition formatting with 2 different xlFormatCondictionTypes", "body": "<p>I would like to do condition formatting while exporting from access to excel. I have to check condition 1(Type:=xlExpression) and condition 2(Type:=xlTextString). If both are true, then highlight the row with any color in excel. Here is my code:</p>\n\n<pre><code>With xlSheet\n    Set range = .Range(\"A1:L1\")\n    Sheets(\"xyz\").Select\n\n     range.FormatConditions.Add Type:=xlExpression, Formula1:=\"=AND($I1&gt;=TODAY(),($I1&lt;(TODAY()+30)))\"\n    rng.FormatConditions.Add Type:=xlTextString, String:=\"Focus\", TextOperator:=xlContains\n\n\n        With rng.FormatConditions(1).Interior\n            .Color = Any color            \n        End With\n\n\nEnd With\n</code></pre>\n\n<p>How do I combine above 2 conditions as one condition.</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 4036403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d863809d420b1184e441335595b7c26e?s=128&d=identicon&r=PG&f=1", "display_name": "Bhupinder Singh", "link": "https://stackoverflow.com/users/4036403/bhupinder-singh"}, "is_accepted": true, "score": 0, "last_activity_date": 1454097242, "creation_date": 1454097242, "answer_id": 35092916, "question_id": 35047742, "link": "https://stackoverflow.com/questions/35047742/copying-existing-password-protected-sheet-to-new-workbook-as-an-unprotected-shee/35092916#35092916", "title": "Copying existing password protected sheet to new workbook as an unprotected sheet does not make the new worksheet unprotected", "body": "<p>The following lines of code activate the original workbook and this somehow clears the protection of the copied sheet with excel 2013 only. On Excel 2007 this causes the original workbook to be activated and confuses users, hence the check for 2013.</p>\n\n<pre><code>If Application.Version = \"15.0\" Then\n    Workbooks(CurrentWorkBook).Activate\n    'jBook.Activate\nEnd If\n</code></pre>\n\n<p>This is a hack that happens to work. If some one finds a better solution please do post it here as well.</p>\n\n<p>The full code listing is as follows:</p>\n\n<pre><code>Private Sub cmd_Click()\nDim jBook As Workbook\nDim jsheet As Worksheet\n\nCurrentWorkBook = ActiveWorkbook.Name\nWorkbooks(CurrentWorkBook).Unprotect jWorksheetPassword\n'catch all for errors\nOn Error GoTo ErrEnd\nDim orginalScreenUpdating As Boolean\norginalScreenUpdating = Application.ScreenUpdating\nApplication.ScreenUpdating = False\n\nIf Range(\"Language\").Value = \"2\" Then\n    'French\n    Set jsheet = TemplateFR\nElse\n    'english\n    Set jsheet = TemplateEN\nEnd If\n\njsheet.Visible = xlSheetHidden\n\nSet jBook = Workbooks.Add(xlWBATWorksheet)\njsheet.Copy After:=jBook.Sheets(1)\njBook.Sheets(2).Visible = xlSheetVisible\n\nApplication.DisplayAlerts = False\njBook.Sheets(1).Delete\nApplication.DisplayAlerts = True\n\nIf Application.Version = \"15.0\" Then\n    Workbooks(CurrentWorkBook).Activate\n    'jBook.Activate\nEnd If\n\njsheet.Visible = xlSheetVeryHidden\n\nNoErrEnd:\nWorkbooks(CurrentWorkBook).Protect Password:=jWorksheetPassword, Structure:=True, Windows:=False\nApplication.ScreenUpdating = orginalScreenUpdating\nUnload Me\nExit Sub\n\nErrEnd:\nWorkbooks(CurrentWorkBook).Protect Password:=jWorksheetPassword,     Structure:=True, Windows:=False\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\nMsgBox DataTable.Range(\"MSG4\").Value, vbCritical,     DataTable.Range(\"MSG4TITLE\").Value\nUnload Me\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4036403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d863809d420b1184e441335595b7c26e?s=128&d=identicon&r=PG&f=1", "display_name": "Bhupinder Singh", "link": "https://stackoverflow.com/users/4036403/bhupinder-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1221, "favorite_count": 0, "accepted_answer_id": 35092916, "answer_count": 1, "score": 0, "last_activity_date": 1454097242, "creation_date": 1453927877, "last_edit_date": 1454004285, "question_id": 35047742, "link": "https://stackoverflow.com/questions/35047742/copying-existing-password-protected-sheet-to-new-workbook-as-an-unprotected-shee", "title": "Copying existing password protected sheet to new workbook as an unprotected sheet does not make the new worksheet unprotected", "body": "<p>Copying an existing password protected sheet to a new workbook as an unprotected sheet gives the following error when user tries to type in data in the new worksheet.</p>\n\n<blockquote>\n  <p>Error: \"the cell or chart you're trying to change is on a protected sheet\"</p>\n</blockquote>\n\n<p>Click OK on the error message.</p>\n\n<p>Please note that this error happens only once. click OK on the pop up error message and type again, then excel allows you to type data in the cells and save the sheet.</p>\n\n<p>We have an excel (format .xls) file currently being used to create another excel spreadsheet when a button on a form in the same spreadsheet is clicked. It basically copies one password protected blank sheet (a template) to a new workbook as an unprotected sheet. The code below used to work with excel 2007(using .xls format). We recently upgraded from excel 2007 to excel 2013 and the problem appeared.</p>\n\n<pre><code>Private Sub cmd_Click()\nDim jBook As Workbook\nDim jsheet As Worksheet\n\nCurrentWorkBook = ActiveWorkbook.Name\nWorkbooks(CurrentWorkBook).Unprotect jWorksheetPassword\n'catch all for errors\nOn Error GoTo ErrEnd  \n\nDim orginalScreenUpdating As Boolean\norginalScreenUpdating = Application.ScreenUpdating\nApplication.ScreenUpdating = False\n\nIf Range(\"Language\").Value = \"2\" Then\n   'French\n  Set jsheet = TemplateFR\nElse\n   'english\n   Set jsheet = TemplateEN\nEnd If\n\njsheet.Visible = xlSheetHidden\n'jSheet.Visible = xlSheetVisible\n\n'Delete this line\njsheet.Unprotect jWorksheetPassword\n\nSet jBook = Workbooks.Add(xlWBATWorksheet)\njsheet.Copy After:=jBook.Sheets(1)\njBook.Sheets(2).Visible = xlSheetVisible\n\nApplication.DisplayAlerts = False\njBook.Sheets(1).Delete\nApplication.DisplayAlerts = True\n\njsheet.Visible = xlSheetVeryHidden\n\n'Delete this line\njBook.Sheets(1).Unprotect jWorksheetPassword\n'Delete this line\n'jsheet.Protect Password:=jWorksheetPassword\n\nNoErrEnd:\nWorkbooks(CurrentWorkBook).Protect Password:=jWorksheetPassword, Structure:=True, Windows:=False\nApplication.ScreenUpdating = orginalScreenUpdating\nUnload Me\nExit Sub\n\nErrEnd:\nWorkbooks(CurrentWorkBook).Protect Password:=jWorksheetPassword, Structure:=True, Windows:=False\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\nMsgBox DataTable.Range(\"MSG4\").Value, vbCritical,    DataTable.Range(\"MSG4TITLE\").Value\nUnload Me\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "formatting"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 3, "creation_date": 1453926178, "post_id": 35047188, "comment_id": 57818757, "body": "this is pretty good as is. You could load the ranges into an array, manipulate the array and rewrite the array to the range, but its probably not necessary with what you have."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453926875, "post_id": 35047188, "comment_id": 57819141, "body": "As @ScottHoltzman any other answer will require loops and depending on the data it will be slower than your method."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5842997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c80e6be540d91b04ed3df4d8a499a5c?s=128&d=identicon&r=PG&f=1", "display_name": "D_Vandagriff", "link": "https://stackoverflow.com/users/5842997/d-vandagriff"}, "edited": false, "score": 0, "creation_date": 1454001337, "post_id": 35047740, "comment_id": 57858702, "body": "Awesome, thanks for your response. I&#39;ll check it out!"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 3, "last_activity_date": 1453927864, "creation_date": 1453927864, "answer_id": 35047740, "question_id": 35047188, "link": "https://stackoverflow.com/questions/35047188/any-suggestions-for-a-more-direct-proper-text-format-excel-vba/35047740#35047740", "title": "Any suggestions for a more direct PROPER text format - Excel VBA", "body": "<p>Just in case you do want to loop through each cell, use this, it's pretty quick...</p>\n\n<pre><code>Sub Button1_Click()\n    Dim MyLr As Long, rng As Range, c As Range\n\n    MyLr = Cells(Rows.Count, \"Q\").End(xlUp).Row\n    Set rng = Range(\"Q2:Y\" &amp; MyLr)\n\n    For Each c In rng.Cells\n        c = StrConv(c, vbProperCase)\n    Next c\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5842997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c80e6be540d91b04ed3df4d8a499a5c?s=128&d=identicon&r=PG&f=1", "display_name": "D_Vandagriff", "link": "https://stackoverflow.com/users/5842997/d-vandagriff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453927864, "creation_date": 1453925812, "question_id": 35047188, "link": "https://stackoverflow.com/questions/35047188/any-suggestions-for-a-more-direct-proper-text-format-excel-vba", "title": "Any suggestions for a more direct PROPER text format - Excel VBA", "body": "<p>I'm creating a workbook that will automate the formatting process for customer service department at the non-profit I work for. They will copy/paste data into the workbook, run the procedures, then copy/paste out and import into their database. </p>\n\n<p>One of the processes is taking fields such as first and last name, etc, and putting them into the \"proper\" or \"title\" case format. The code below is currently how I'm executing this process but I can't help but think that there has to be a more direct way. I've searched but to no avail.</p>\n\n<p>Please lend me your wisdom!</p>\n\n<pre><code>'Proper Format\nRange(\"AS1:BA\" &amp; myLR).FormulaR1C1 = \"=PROPER(RC[-28])\"\nRange(\"BB1:BB\" &amp; myLR).FormulaR1C1 = \"=PROPER(RC[-26])\"\n\nRange(\"Q2:Y\" &amp; myLR) = Range(\"AS2:BA\" &amp; myLR).Value\nRange(\"AB2:AB\" &amp; myLR) = Range(\"BB2:BB\" &amp; myLR).Value\n\nColumns(\"AS:BB\").Delete Shift:= xlToRight\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1453927536, "post_id": 35047024, "comment_id": 57819512, "body": "For other ways to do this see <a href=\"http://stackoverflow.com/questions/33744149/code-in-vba-loops-and-never-ends-how-to-fix-this\">HERE</a>"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1453925716, "last_edit_date": 1453925716, "creation_date": 1453925333, "answer_id": 35047059, "question_id": 35047024, "link": "https://stackoverflow.com/questions/35047024/reset-a-for-loop-when-a-condition-is-met-vba/35047059#35047059", "title": "Reset a for loop when a condition is met vba", "body": "<p>Two changes:</p>\n\n<pre><code>Set report = Workbooks(\"Rapports\").Worksheets(\"Relev\u00e9_\" &amp; Client &amp; \"_\" &amp; Datereport2)\nFor i = 11 To 1 Step -1 'pas auto\n    VM1 = report.Range(\"G\" &amp; i + 11).Value\n    VM2 = report.Range(\"H\" &amp; i + 11).Value\n     If VM1 = \"0\" And VM2 = \"0\" Then\n     report.Rows(i + 11 &amp; \":\" &amp; i + 11).Delete\n     End If\n\n     Next\nEnd Sub\n</code></pre>\n\n<ol>\n<li><p>Loop backwards. This will take care of any duplicates and will not need to run more than once.</p></li>\n<li><p>change <code>0</code> to <code>\"0\"</code>  This will force it to find <code>0</code> and not empty cells.</p></li>\n</ol>\n"}], "owner": {"reputation": 47, "user_id": 5827705, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1efb42be6f51e2ef47edda115438ba5c?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/5827705/florian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2454, "favorite_count": 0, "accepted_answer_id": 35047059, "answer_count": 1, "score": 0, "last_activity_date": 1453926560, "creation_date": 1453925202, "last_edit_date": 1453925360, "question_id": 35047024, "link": "https://stackoverflow.com/questions/35047024/reset-a-for-loop-when-a-condition-is-met-vba", "title": "Reset a for loop when a condition is met vba", "body": "<p>I want to reset a counter in a loop every time a condition is met.</p>\n\n<p>Here my code : </p>\n\n<pre><code>Set report = Workbooks(\"Rapports\").Worksheets(\"Relev\u00e9_\" &amp; Client &amp;  \"_\" &amp; Datereport2)\nFor i = 1 To 11 'pas auto\n    VM1 = report.Range(\"G\" &amp; i + 11).Value\n    VM2 = report.Range(\"H\" &amp; i + 11).Value\n     If VM1 = 0 And VM2 = 0 Then\n     report.Rows(i + 11 &amp; \":\" &amp; i + 11).Delete\n     End If\n\n     Next\nend sub\n</code></pre>\n\n<p>When the row is deleted i want to restart i at 1, until no more cell = 0.\nAlso, i dont want to delete rows where there is an empty cell.</p>\n\n<p>Thank you !!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1453924156, "post_id": 35046619, "comment_id": 57817607, "body": "Just do <code>After:=Sheets(Sheets(2))</code>, no?  Or actually, if you&#39;re running this on multiple sheets (and have no variables), <code>After:=Sheets(Activesheet.index)</code> should work."}, {"owner": {"reputation": 472, "user_id": 4105679, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b378f63f5898183a8cdbb1f8e17a1b95?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4105679/luke"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1453924548, "post_id": 35046619, "comment_id": 57817822, "body": "the After:=Sheets(Activesheet.index) worked."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1453926751, "creation_date": 1453926751, "answer_id": 35047444, "question_id": 35046619, "link": "https://stackoverflow.com/questions/35046619/excel-copy-sheet-following-active-sheet/35047444#35047444", "title": "Excel copy sheet following active sheet", "body": "<p>You could use the activesheet's index:  <code>After:=Sheets(Activesheet.Index)</code>.</p>\n\n<p>Not sure if you know much VBA, but as the name implies, whatever your currently active sheet is, that index will be used.  Without knowing more of your code, it will work for the specific instance you asked about here. BUT if you have multiple worksheets (which you do), you'll probably instead want to set a variable for the worksheet you're working in, then use that in the <code>Sheets()</code> part...i.e. </p>\n\n<pre><code>Sub t()\nDim x As Integer\nDim myWorksheet As Worksheet\n\nmyWorksheet = Sheets(\"Data Sheet\")\nx = InputBox(\"Enter number of times to copy sheet, puts copies at end of sheet list\")\nFor numtimes = 1 To x\n  'Loop by using x as the index number to make x number copies.\n  myWorksheet.Copy _\n      After:=Sheets(myWorksheet.Index)\nNext\nEnd Sub\n</code></pre>\n\n<p>Now, this just uses a single worksheet. You'd need to add a little logic to loop through all, but that shouldn't be too hard for you to find out how to do. If you would like any more help, just let me know.</p>\n"}, {"tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": false, "score": 2, "last_activity_date": 1453927348, "creation_date": 1453927348, "answer_id": 35047597, "question_id": 35046619, "link": "https://stackoverflow.com/questions/35046619/excel-copy-sheet-following-active-sheet/35047597#35047597", "title": "Excel copy sheet following active sheet", "body": "<blockquote>\n  <p>Also if i cancel the popup box that asks for the number of sheet copies it gets in error is there a way to keep that from happening?</p>\n</blockquote>\n\n<p>Change type of <code>x</code> to Variant. If you click Cancel on input box, empty string is returned which is inappropriate for <code>Integer</code>.</p>\n"}], "owner": {"reputation": 472, "user_id": 4105679, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b378f63f5898183a8cdbb1f8e17a1b95?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4105679/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 942, "favorite_count": 0, "accepted_answer_id": 35047444, "answer_count": 2, "score": 1, "last_activity_date": 1453927348, "creation_date": 1453923778, "last_edit_date": 1453924225, "question_id": 35046619, "link": "https://stackoverflow.com/questions/35046619/excel-copy-sheet-following-active-sheet", "title": "Excel copy sheet following active sheet", "body": "<p>I'm wanting to copy a sheet using VBA as a new sheet following the sheet being copied </p>\n\n<p>I'm using this code now and it works but puts the copied sheet at the end of the list of sheets</p>\n\n<pre><code>Dim x As Integer\n\nx = InputBox(\"Enter number of times to copy sheet, puts copies at end of sheet list\")\nFor numtimes = 1 To x\n  'Loop by using x as the index number to make x number copies.\n  ActiveWorkbook.ActiveSheet.Copy _\n      After:=Sheets(Sheets.Count)\n\nNext\n</code></pre>\n\n<p>Lets say the list of sheets is - sheet (1), Sheet (2), Sheet (3), Sheet (4)\nif i run the code on Sheet (2) i want the new copy to be in between Sheet (2) and Sheet (3), Is this passable?</p>\n\n<p>Also if i cancel the popup box that asks for the number of sheet copies it gets in error is there a way to keep that from happening? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1453924710, "post_id": 35046548, "comment_id": 57817914, "body": "Assuming the date in line 3 is a typo, and really should be 1/1/2016, I would define a Class with the Comment property being a collection.  A collection of those objects could then be used to generate your final report."}, {"owner": {"reputation": 113, "user_id": 5011931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13685879e66b2ce2b97f25a056255150?s=128&d=identicon&r=PG&f=1", "display_name": "mattinwpg", "link": "https://stackoverflow.com/users/5011931/mattinwpg"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1453925300, "post_id": 35046548, "comment_id": 57818234, "body": "I&#39;m sorry, I wish I knew what those words meant or how to do that. I&#39;m not sure what you mean by &quot;define a Class&quot;... I&#39;m not a newbie to excel, but that isn&#39;t in my grasp as of yet."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1453925668, "post_id": 35046548, "comment_id": 57818448, "body": "Well, there are other ways to do this; if you are going to do this repeatedly, VBA is the way to go.  As this is not a free code-writing service, I would suggest you devise an approach and try to code it, then post your code here with specific questions where you run into problems.  With regard to classes, Chip Pearson has some excellent material on his <a href=\"http://www.cpearson.com/Excel/Classes.aspx\" rel=\"nofollow noreferrer\">Introduction to Classes</a> page."}], "answers": [{"tags": [], "owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "is_accepted": true, "score": 1, "last_activity_date": 1453926053, "creation_date": 1453926053, "answer_id": 35047250, "question_id": 35046548, "link": "https://stackoverflow.com/questions/35046548/copy-specific-columns-from-rows-with-duplicate-data/35047250#35047250", "title": "copy specific columns from rows with duplicate data", "body": "<p>This should do the trick:</p>\n\n<pre><code>Sub Main()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim i As Long, j As Long\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Sheets(\"Sheet1\") ' Change the name of your Sheet\n\n    Lastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row\n\n\nWith ws\n\n    j = 2 ' Start the loop at row 2\n\n    Do While Not IsEmpty(.Cells(j, 1))\n            For i = Lastrow To 2 Step -1\n\n                        If j &lt;&gt; i And .Cells(j, 1) = .Cells(i, 1) Then\n                            .Cells(j, 4) = .Cells(j, 4) &amp; \",\" &amp; .Cells(i, 4)\n                            .Rows(i).EntireRow.Delete\n                        End If\n\n            Next i\n    j = j + 1\n    Loop\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 5011931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13685879e66b2ce2b97f25a056255150?s=128&d=identicon&r=PG&f=1", "display_name": "mattinwpg", "link": "https://stackoverflow.com/users/5011931/mattinwpg"}, "edited": false, "score": 0, "creation_date": 1453926924, "post_id": 35047272, "comment_id": 57819165, "body": "Thanks so much Dan! This is beefy and a bit over my head still, but this, and the info on Classes shared by @RonRosenfeld give me great way to tinker and learn more about how they work."}], "tags": [], "owner": {"reputation": 2633, "user_id": 3075291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bcf603991da65f2886510a8416614d?s=128&d=identicon&r=PG", "display_name": "Dan Wagner", "link": "https://stackoverflow.com/users/3075291/dan-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1453926106, "creation_date": 1453926106, "answer_id": 35047272, "question_id": 35046548, "link": "https://stackoverflow.com/questions/35046548/copy-specific-columns-from-rows-with-duplicate-data/35047272#35047272", "title": "copy specific columns from rows with duplicate data", "body": "<p>Great question! This is particularly interesting because you need to adjust your source data in the <strong>opposite</strong> direction of the usual move -- you're getting data into an \"un-pivotable\" state.</p>\n\n<p><a href=\"http://danwagner.co/combining-data-and-transposing-the-results-to-rows-not-columns-with-vba/\" rel=\"nofollow\">I wrote about a tutorial for a very similar situation here</a> -- instead of putting campers in cabins, though, you need to put comments in tickets. (You also need to combine comments into a single, comma-delimited cell.)</p>\n\n<p>Suppose you were to follow that guide and assemble two <code>Scripting.Dictionary</code> objects, <code>dicTickets</code> and <code>dicComments</code>, where <code>dicTickets</code> contains Keys and Items that both represent the \"Ticket\" values and <code>dicComments</code> contains \"Comment\"s as Keys and \"Ticket\"s as Items.</p>\n\n<p>With those structures in place, you could loop through them like I do in the <strong>heavily-commented-but-not-tested code below</strong>:</p>\n\n<pre><code>'We'll need these, so you'll probably want to declare them up at the top\nDim dicTickets As Scripting.Dictionary, dicComments As Scripting.Dictionary\nSet dicTickets = New Scripting.Dictionary\nSet dicComments = New Scripting.Dictionary\nDim colCombinedComments As Collection\nDim varTicket As Variant, varComment As Variant\nDim strComments As String\nDim lngIdx As Long\n\n'...\n'Fill up the Scripting.Dictionary objects as described in the guide\n'...\n\n'\"Outer\" loop iterates through all the tickets\nFor Each varTicket in dicTickets.Keys\n\n    '\"Inner\" loop iterates through all the comments\n    For Each varComment in dicComments.Keys\n\n        'Initialize a collection to store all the comments\n        Set colCombinedComments = New Collection\n\n        'If this comment matches the current ticket, add it to a string\n        If dicComment(varComment) = dicTickets(varTicket) Then\n            colCombinedComments.Add dicComment(varComment)\n        End If\n\n        'colCombinedComments now contains the comments, yay!\n\n        'Initialize a string to join all the comments together\n        'with commas\n        strComments = \"\"\n\n        'Loop through the colCombinedComments, appending each time\n        For lngIdx = 1 To colCombinedComments.Count\n\n            'The first time, just make strComments the first comment\n            If strComments = \"\" Then\n                strComments = colCombinedComments(lngIdx)\n\n            'Each time after the first time, append with a comma and space\n            Else\n                strComments = strComments &amp; \", \" &amp; colCombinedComments\n            End If\n        Next lngIdx\n\n        '...\n        'Now you can do what you need to with strComments\n        '...\n\n    Next varComment\n\nNext varTicket\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 5011931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13685879e66b2ce2b97f25a056255150?s=128&d=identicon&r=PG&f=1", "display_name": "mattinwpg", "link": "https://stackoverflow.com/users/5011931/mattinwpg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 35047250, "answer_count": 2, "score": 1, "last_activity_date": 1453926106, "creation_date": 1453923541, "question_id": 35046548, "link": "https://stackoverflow.com/questions/35046548/copy-specific-columns-from-rows-with-duplicate-data", "title": "copy specific columns from rows with duplicate data", "body": "<p>Trying to do this all in Excel, as the end-user will not have MS Access (which would make this a billion times easier...).</p>\n\n<p>I have a sheet with rows of data like:</p>\n\n<pre><code>ticket  date      name           comments\n52      1/1/2016  Edgar          did thing A\n52      1/1/2016  Edgar          did thing B\n52      1/2/2016  Edgar          did thing C\n60      1/5/2016  Steph          looked at X\n60      1/5/2016  Steph          looked at Y\n</code></pre>\n\n<p>I need to write a formula (or VBA macro) that will loop through all rows and concatenate comments based on ticket #. i.e. in the above example the end result would be:</p>\n\n<pre><code>Ticket   date      name         comments\n52       1/1/2016  Edgar        did thing A, did thing B, did thing C\n60       1/5/2016  Steph        looked at X, looked at Y\n</code></pre>\n\n<p>I've tried looking through some similar questions, but haven't found anything that i've been able to manipulate to suit my needs.</p>\n\n<p>Would love to hear what you experts think. The sheet will be reconciled monthly, and will be of varying length.</p>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1453934101, "post_id": 35046400, "comment_id": 57823191, "body": "I am having difficulties understanding the question(s). Do you have difficulties pressing the &quot;Next&quot; button on some website? Is that the question? For learning loops you might want to have a look at the following: <a href=\"http://www.homeandlearn.org/excel_vba_for_loops.html\" rel=\"nofollow noreferrer\">homeandlearn.org/excel_vba_for_loops.html</a>"}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1453938695, "post_id": 35046400, "comment_id": 57825131, "body": "You could push the &quot;NextResults&quot; button by doing a getElementsByTagName for whatever kind of container it&#39;s in and then a loop to get it by searching for innerText = InStr(myElement.innerText, &quot;NextResults&quot;), and then myElement.click"}], "answers": [{"tags": [], "owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "is_accepted": false, "score": 0, "last_activity_date": 1453939278, "creation_date": 1453939278, "answer_id": 35050562, "question_id": 35046400, "link": "https://stackoverflow.com/questions/35046400/how-to-loop-vba-code-to-perform-same-actions-through-list-of-data/35050562#35050562", "title": "How to loop VBA code to perform same actions through list of data", "body": "<p>Sample code to push button: \nTry to use the innermost tag type, such as if it's inside an \"a\" tag inside of a div, use \"a\"</p>\n\n<pre><code>Dim aTag, someTags\nSet someTags = IE.Document.getElementsByTagName(\"a\")\nFor Each aTag In someTags\n    If InStr(aTag.innerText, \"NextResults\") Then\n       aTag.Click\n       Exit For\n    End If\nNext aTag\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5848495, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/e8a5fb8434af3e25132aa0f17a0be4f0?s=128&d=identicon&r=PG&f=1", "display_name": "Dick Plixen", "link": "https://stackoverflow.com/users/5848495/dick-plixen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453999449, "creation_date": 1453923094, "last_edit_date": 1453999449, "question_id": 35046400, "link": "https://stackoverflow.com/questions/35046400/how-to-loop-vba-code-to-perform-same-actions-through-list-of-data", "title": "How to loop VBA code to perform same actions through list of data", "body": "<p>Ok, sorry guys... I managed to figure out the issue with regards to clicking the \"Next Results\" button and looping it back around to pull the same data, then click the \"Next Results\" button and pull the same data... so on and so on until... and here's where I'm running into the problem. I keep getting an \"Object required\" error on my \"Loop Until\" statement... I've tried a number of different workarounds, switching to variables, etc. but still running into errors. Basically I would just like the loop to stop once the \"Next Results\" button is no longer available (which will obviously happen when there is no more data to pull). </p>\n\n<p>Here's the section of VBA causing the problem... </p>\n\n<pre><code>Dim TDelements As IHTMLElementCollection\nDim TDelement As HTMLTableCell\nDim r As Long\n\nSet TDelements = IE.document.getElementsByTagName(\"tr\")\n\nr = 0\n\nDo\n    Application.Wait Now + TimeValue(\"00:00:03\")\n\n    For Each TDelement In TDelements\n\n        If TDelement.className = \"searchActivityResultsContent\" Then\n            Sheet1.Range(\"E1\").Offset(r, 0).Value = TDelement.ChildNodes(8).innerText\n            r = r + 1\n        ElseIf TDelement.className = \"searchActivityResultsContent\" Then\n            Sheet1.Range(\"E1\").Offset(r, 0).Value = TDelement.ChildNodes(8).innerText\n            r = r + 1\n        End If\n    Next\n\n    Application.Wait Now + TimeValue(\"00:00:02\")\n\n    Set elems = IE.document.getElementsByTagName(\"input\")\n    For Each e In elems\n\n    If e.Value = \"Next Results\" Then\n        e.Click\n        Exit For\n    End If\n\nNext e\n\nLoop Until e.Value &lt;&gt; \"Next Results\"\n\nDo Until Not IE.Busy And IE.readyState = 4\n   DoEvents\nLoop\n\nIE.Quit\n</code></pre>\n\n<p>Here's the HTML code for the buttons I'm referring to... </p>\n\n<pre><code>&lt;table class=\"contentTable\" align=\"center\"&gt;\n    &lt;tr class=\"contentTableTR\"&gt;\n&lt;form name=\"scrollResultListForm\" method=\"post\"   action=\"/scrollTransactionsList.do\" onsubmit=\"return isBusy();\"&gt;\n\n\n\n\n&lt;input type=\"submit\" name=\"action\" value=\"Next Results\" onmouseover=\"showComment(event,'Display next results')\" onmouseout=\"hideComment()\" class=\"formButton\"&gt;\n\n\n&lt;input type=\"submit\" name=\"action\" value=\"Last Page\" onmouseover=\"showComment(event,'Goto last result page')\" onmouseout=\"hideComment()\" class=\"formButton\"&gt;\n\n&lt;/form&gt;\n&lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453922548, "post_id": 35045944, "comment_id": 57816624, "body": "The <code>.Shapes()</code> argument is expecting a <code>String</code> with the shape name in it. The way the code is written it tries to pass an <code>Object</code> into that argument that happens to be a worksheet object as set by <code>GraphTab = ActiveSheet</code>. Does the chart name you want share the same name as the worksheet?"}, {"owner": {"reputation": 173, "user_id": 3602466, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b4656fe2c2a635d76b184b8af24e4a03?s=128&d=identicon&r=PG&f=1", "display_name": "X. Shi", "link": "https://stackoverflow.com/users/3602466/x-shi"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453923380, "post_id": 35045944, "comment_id": 57817147, "body": "@ScottHoltzman Yes, I want my chart name the same name as the worksheet. How should I do that?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453923588, "post_id": 35045944, "comment_id": 57817258, "body": "First, are you trying to make a new chart? Move an existing chart to a new worksheet? Or just rename a chart on the current sheet? And how many charts on the sheet?"}, {"owner": {"reputation": 173, "user_id": 3602466, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b4656fe2c2a635d76b184b8af24e4a03?s=128&d=identicon&r=PG&f=1", "display_name": "X. Shi", "link": "https://stackoverflow.com/users/3602466/x-shi"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453923939, "post_id": 35045944, "comment_id": 57817477, "body": "@ScottHoltzman For this exercise, let&#39;s assume the chart is already in new worksheet, and the new worksheet has only the chart object."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453925227, "post_id": 35045944, "comment_id": 57818185, "body": "Shawn. See my answer below. I will elaborate on how it will automatically change the title of the chart if the sheet name is changed."}], "answers": [{"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1453923351, "creation_date": 1453923351, "answer_id": 35046490, "question_id": 35045944, "link": "https://stackoverflow.com/questions/35045944/how-to-refer-to-chart-title-in-shapes/35046490#35046490", "title": "How to refer to chart title in Shapes()?", "body": "<p>Maybe this is the solution you've been looking for:</p>\n\n<pre><code>With Sheet1.ChartObjects(\"Chart 1\").Chart.ChartTitle\n    .Text = \"test\"\n    .Font.FontStyle = \"Times New Roman\"\n    .Font.Size = 10\nEnd With\n</code></pre>\n\n<p>If you are using the sheet's code name instead of the sheet name then the code will still work when you are changing the name of the graph sheet. If you meant to change the chart name then I would integrate a loop like so</p>\n\n<pre><code>For Each cht In Sheet1.ChartObjects\n    With cht.Chart.ChartTitle\n        .Text = \"test\"\n        .Font.FontStyle = \"Times New Roman\"\n        .Font.Size = 10\n    End With\nNext cht\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1453925510, "last_edit_date": 1453925510, "creation_date": 1453924614, "answer_id": 35046846, "question_id": 35045944, "link": "https://stackoverflow.com/questions/35045944/how-to-refer-to-chart-title-in-shapes/35046846#35046846", "title": "How to refer to chart title in Shapes()?", "body": "<p>Based on your last comment, this code has been tested to produce the desired results.</p>\n\n<pre><code>Sub Macro1()\n\n    Dim ws As Worksheet\n    Set ws = Sheets(\"NewChartSheet\") ' change name as needed\n\n    ws.Range(\"A1\").Formula = \"=RIGHT(CELL(\"\"filename\"\",A1),LEN(CELL(\"\"filename\"\",A1))-FIND(\"\"]\"\",CELL(\"\"filename\"\",A1)))        \n\n    Dim cht As ChartObject\n    Set cht = ws.ChartObjects(1) 'since just one chart on page, it's the first one in the collection\n\n    With cht.Chart.ChartTitle\n        With .Format.TextFrame2.TextRange.Font\n            .NameComplexScript = \"Times New Roman\"\n            .NameFarEast = \"Times New Roman\"\n            .Name = \"Times New Roman\"\n            .Size = 10\n        End With\n        .Caption = \"=NewChartSheet!R1C1\"\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>To understand how the chart title is set up to automatically change if the sheet name is changed see below:</p>\n\n<ol>\n<li>The <code>.Caption = \"=NewChartSheet!R1C1\"</code> sets the chart title to equal the value in cell A1</li>\n<li>The <code>ws.Range(\"A1\").Formula</code> sets the formula to show the sheet name. </li>\n<li>The formula in <code>A1</code> uses the <code>filename</code> argument of the <a href=\"https://support.office.com/en-us/article/CELL-function-51BD39A5-F338-4DBE-A33F-955D67C2B2CF\" rel=\"nofollow\">CELL</a> function, which returns the full file path, file name and sheet name, of the referenced cell.</li>\n<li>The formula manipulates the format of the filename further to return just the sheet name.</li>\n</ol>\n"}], "owner": {"reputation": 173, "user_id": 3602466, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b4656fe2c2a635d76b184b8af24e4a03?s=128&d=identicon&r=PG&f=1", "display_name": "X. Shi", "link": "https://stackoverflow.com/users/3602466/x-shi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "accepted_answer_id": 35046846, "answer_count": 2, "score": 1, "last_activity_date": 1453941543, "creation_date": 1453921728, "last_edit_date": 1453941543, "question_id": 35045944, "link": "https://stackoverflow.com/questions/35045944/how-to-refer-to-chart-title-in-shapes", "title": "How to refer to chart title in Shapes()?", "body": "<p>I want to format a chart in a new tab based on some existing data from a worksheet. I can record the pattern using \"Save As Template\", but I want to create a macro that creates the same format every time. However, I have some problem with referring to the chart. Here's my code.</p>\n\n<pre><code>Sub Macro1()\n    Dim GraphTab As Object\n    Set GraphTab = ActiveSheet\n\n   'Change everything to Times New Roman\n    With ActiveSheet.Shapes(GraphTab).TextFrame2.TextRange.Font\n        .NameComplexScript = \"Times New Roman\"\n        .NameFarEast = \"Times New Roman\"\n        .Name = \"Times New Roman\"\n        .Size = 10\n    End With\nEnd Sub\n</code></pre>\n\n<p>I receive an error message starting from this line <code>With ActiveSheet.Shapes(GraphTab).TextFrame2.TextRange.Font</code>.</p>\n\n<p>Ideally, I also want the <code>GraphTab</code> to be updated every time I manually change the tab name. Is that possible?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4595, "user_id": 314507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35fa938f2b64b7620be0181281f2ae1?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/314507/jeremy"}, "edited": false, "score": 0, "creation_date": 1453923357, "post_id": 35045580, "comment_id": 57817129, "body": "I&#39;d say no. The reason being that VBa/VB6 does not have real support for classes in terms of inheritance, and for what you are doing, having generic functions to do this is fine. Also, maybe look at optional parameters so everything doesn&#39;t have to be passed in."}, {"owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "reply_to_user": {"reputation": 4595, "user_id": 314507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35fa938f2b64b7620be0181281f2ae1?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/314507/jeremy"}, "edited": false, "score": 0, "creation_date": 1453924204, "post_id": 35045580, "comment_id": 57817643, "body": "@Jeremy thanks for the insight. what do you mean about class inheritance, I&#39;m not familiar with that."}, {"owner": {"reputation": 4595, "user_id": 314507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35fa938f2b64b7620be0181281f2ae1?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/314507/jeremy"}, "edited": false, "score": 0, "creation_date": 1453925039, "post_id": 35045580, "comment_id": 57818084, "body": "you can check this article out. <a href=\"https://en.wikipedia.org/wiki/Inheritance_(object-oriented_programming)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Inheritance_(object-oriented_programmi&zwnj;&#8203;ng)</a>"}, {"owner": {"reputation": 544, "user_id": 4868761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b86485dea136b4aa5498ff3d8f2a413?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4868761/kyle"}, "edited": false, "score": 0, "creation_date": 1453930075, "post_id": 35045580, "comment_id": 57820925, "body": "Consider using an interface with the <code>Implements</code> keyword. <a href=\"http://stackoverflow.com/questions/19373081/how-to-use-the-implements-in-excel-vba\" title=\"how to use the implements in excel vba\">stackoverflow.com/questions/19373081/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4573, "user_id": 5718868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lMKOf.png?s=128&g=1", "display_name": "jonathana", "link": "https://stackoverflow.com/users/5718868/jonathana"}, "is_accepted": false, "score": 0, "last_activity_date": 1453926253, "creation_date": 1453926253, "answer_id": 35047312, "question_id": 35045580, "link": "https://stackoverflow.com/questions/35045580/using-a-class-object-to-make-different-shapes/35047312#35047312", "title": "Using a class object to make different shapes", "body": "<p>you are right. you need to use object oriented concepts of the language. VBA is not a complete object oriented language but it has some nice features. i cant write you an example because there is more then one way to do this. also <strong>i wanted to comment and not to write an answer but my low rating preventing me</strong>.\nread about object oriented concepts and working with classes, crating instances to classes overloading function with different stamps and enums. if you want to do it with more modern language (like visual basic.net for example) read about inheritance and polimorphizem - also very important concepts to implement tasks like you mentioned.</p>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 11653404, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jmueMVhOXMU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdxfqW7xE3erFKPU2bgQVyNwx643Q/mo/photo.jpg?sz=128", "display_name": "Mark E.", "link": "https://stackoverflow.com/users/11653404/mark-e"}, "is_accepted": false, "score": 0, "last_activity_date": 1604931562, "creation_date": 1604931562, "answer_id": 64753370, "question_id": 35045580, "link": "https://stackoverflow.com/questions/35045580/using-a-class-object-to-make-different-shapes/64753370#64753370", "title": "Using a class object to make different shapes", "body": "<p>I have been exploring this question of how to create class modules to use with shapes. I have a MakeShape() sub with many arguments defining the shape's properties.  As you said, it becomes challenging to keep them orderly as I add new arguments.</p>\n<p>I asked myself: what is the relationship between the class and the shape on the screen?  My working theory is that the class should hold the properties of the shape on the screen (e.g. compressor.top, compressor.left, compressor.width, etc.).  Then you could create methods (e.g., compressor.draw to create the shape on screen).  I am less clear how you would manipulate a shape once it is drawn as a method of the shape class (in effect, how to keep a leash on that same shape object now that it is out in the wild).  I suppose the object could have an object property, so compressor.shape would refer to a shape object on the screen.  At that point I'm not sure if you would make adjustments with compressor.top, compressor.shape.top, or either.  I will try to update as I learn.</p>\n"}], "owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 489, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1604931562, "creation_date": 1453920464, "last_edit_date": 1453920807, "question_id": 35045580, "link": "https://stackoverflow.com/questions/35045580/using-a-class-object-to-make-different-shapes", "title": "Using a class object to make different shapes", "body": "<p>My excel sheet creates a map with various layers, showing a network made up of lines, squares, dots, and triangles. I have functions for each creation which take arguments such as</p>\n\n<pre><code>cellLocation As Range  '(takes a given cell location)\nshapeType As String    '(oval, triangle, rectangle)\nColor                  '(red, black, whatever)\nsizeFactor As Double   '(factors the shape size as a function of cell's width)\n</code></pre>\n\n<p>I am just learning about classes now, but wondering if classes would be useful in this case, and how I could use them to simplify my code, rather than having functions with 6 different arguments and such.</p>\n\n<p>Originally I had functions like this:</p>\n\n<pre><code>Function CreateWell(cellRng As Range, wellName As String)\n'creates a square of particular color, size, etc in the cellRng and names it wellName\n\nFunction CreateCompressor(cellRng As Range, compName As String)\n'creates an oval of particular color, size , etc. similar to other func.\n</code></pre>\n\n<p>Then, because I had about 5 of these where the only variations were color, size, shape, etc. I tried making an overall function:</p>\n\n<pre><code> Function CreateShape(cellRng As Range, shpName As String, _\n            shpColor As String, shpSize as double, shpType As string)\n</code></pre>\n\n<p>But this seems to be messy (too many arguments). How can employing classes clean up this type of code? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 384, "user_id": 5601585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cc66cd843f23cd582c84493691ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "Maertin", "link": "https://stackoverflow.com/users/5601585/maertin"}, "edited": false, "score": 0, "creation_date": 1453917192, "post_id": 35044571, "comment_id": 57813369, "body": "What error do you get?"}, {"owner": {"reputation": 384, "user_id": 5601585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cc66cd843f23cd582c84493691ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "Maertin", "link": "https://stackoverflow.com/users/5601585/maertin"}, "edited": false, "score": 1, "creation_date": 1453917482, "post_id": 35044571, "comment_id": 57813555, "body": "Comment this line &#39;Workbooks.Open(&quot;C:\\Users\\j\\Trial.xltx&quot;).Activate&#39;. Change code to copy to Sheet2 - Sheets(&quot;Sheet2&quot;).Range(&quot;A6&quot;).PasteSpecial xlPasteValues See if that copy works."}], "answers": [{"comments": [{"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1453918483, "post_id": 35044744, "comment_id": 57814159, "body": "Is your code copying from Sheet1 and pasting to Sheet1? I think that is causing the crash the OP is experiencing as he is doing the same thing."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 1, "creation_date": 1453919473, "post_id": 35044744, "comment_id": 57814839, "body": "my code is copying from <code>Sheet1</code> of <code>ThisWorkbook</code> to <code>Sheet1</code> of <code>wbPaste</code>. It <b>explicitly</b> declares which <i>specific</i> Sheet1s to move between."}, {"owner": {"reputation": 157, "user_id": 4980688, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/460974fc289ede386c98a270c7b6cad2?s=128&d=identicon&r=PG&f=1", "display_name": "jg2703", "link": "https://stackoverflow.com/users/4980688/jg2703"}, "edited": false, "score": 0, "creation_date": 1453928861, "post_id": 35044744, "comment_id": 57820195, "body": "Thanks Scott, all works fine now but I need to find a way to Insert the copied data and shift anything below it down."}, {"owner": {"reputation": 157, "user_id": 4980688, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/460974fc289ede386c98a270c7b6cad2?s=128&d=identicon&r=PG&f=1", "display_name": "jg2703", "link": "https://stackoverflow.com/users/4980688/jg2703"}, "edited": false, "score": 0, "creation_date": 1453928904, "post_id": 35044744, "comment_id": 57820214, "body": "As you say, the ` rngDest.Insert xlShiftDown ` is bizarre (in fact it doesn&#39;t work like that) but I would be grateful if someone can help me how to do this."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 157, "user_id": 4980688, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/460974fc289ede386c98a270c7b6cad2?s=128&d=identicon&r=PG&f=1", "display_name": "jg2703", "link": "https://stackoverflow.com/users/4980688/jg2703"}, "edited": false, "score": 0, "creation_date": 1453930064, "post_id": 35044744, "comment_id": 57820921, "body": "@JG2703 - please post a separate question if you cannot get it to work, and we can help you <i>specifically</i> with that issue."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1453917594, "creation_date": 1453917594, "answer_id": 35044744, "question_id": 35044571, "link": "https://stackoverflow.com/questions/35044571/excel-vba-copy-and-insert-paste-special-values-from-workbooks/35044744#35044744", "title": "Excel VBA Copy and Insert/Paste Special Values from workbooks", "body": "<p>Try setting parentage to all your objects and working directly with them, stayingaway from <code>.Activate</code> statements. Try this and make sure the <code>Trail.xltx</code> workbook actually has a worksheet called <code>Sheet1</code>.</p>\n\n<pre><code>Sub Copy()\nDim wbThis as Workbook\nSet wbThis = ThisWorkbook\nwbThis.Sheets(\"Sheet1\").Range(\"A2:D26\").Copy\n\nDim wbPaste as Workbook\nSet wbPaste = Workbooks.Open(\"C:\\Users\\j\\Trial.xltx\")\n\nwbPaste.Sheets(\"Sheet1\").Range(\"A6\").PasteSpecial xlPasteValues\n\nrngDest.Insert xlShiftDown ' this is bizarre, because you never set this variable\n  Err_Execute:\nIf Err.Number = 0 Then MsgBox \"Copying Successful :)\" Else _\nMsgBox Err.Description\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 4980688, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/460974fc289ede386c98a270c7b6cad2?s=128&d=identicon&r=PG&f=1", "display_name": "jg2703", "link": "https://stackoverflow.com/users/4980688/jg2703"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1354, "favorite_count": 1, "accepted_answer_id": 35044744, "answer_count": 1, "score": 2, "last_activity_date": 1453917594, "creation_date": 1453917022, "question_id": 35044571, "link": "https://stackoverflow.com/questions/35044571/excel-vba-copy-and-insert-paste-special-values-from-workbooks", "title": "Excel VBA Copy and Insert/Paste Special Values from workbooks", "body": "<p>Can anyone help with this Excel macro? I'm trying to copy from one sheet to another, but it crashes at </p>\n\n<pre><code>Sheets(\"Sheet1\").Range(\"A6\").PasteSpecial xlPasteValues\n</code></pre>\n\n<p>Don't know what I'm doing wrong...</p>\n\n<pre><code>Sub Copy()\nSheets(\"Sheet1\").Range(\"A2:D26\").Copy\nWorkbooks.Open(\"C:\\Users\\j\\Trial.xltx\").Activate\nSheets(\"Sheet1\").Range(\"A6\").PasteSpecial xlPasteValues\nApplication.CutCopyMode = False\nrngDest.Insert xlShiftDown\n  Err_Execute:\nIf Err.Number = 0 Then MsgBox \"Copying Successful :)\" Else _\nMsgBox Err.Description\nEnd Sub\n</code></pre>\n\n<p>Also is this the best way around pasting values and inserting the data?\nThanks</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1501, "user_id": 5427063, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8dAoViSoxvk/AAAAAAAAAAI/AAAAAAAAA60/8VcZHPeu1vw/photo.jpg?sz=128", "display_name": "Tah", "link": "https://stackoverflow.com/users/5427063/tah"}, "edited": false, "score": 0, "creation_date": 1453918119, "post_id": 35044407, "comment_id": 57813934, "body": "Use an else if. <code>IIf [FieldName] = &quot;ocean&quot; then [FieldName2] = &quot;John&quot; else if [FieldName] = &quot;mountain&quot; then [FieldName2] = &quot;Jack&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 5848156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac52946ae506fee072144131eefc89ad?s=128&d=identicon&r=PG&f=1", "display_name": "MicRock", "link": "https://stackoverflow.com/users/5848156/microck"}, "reply_to_user": {"reputation": 1501, "user_id": 5427063, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8dAoViSoxvk/AAAAAAAAAAI/AAAAAAAAA60/8VcZHPeu1vw/photo.jpg?sz=128", "display_name": "Tah", "link": "https://stackoverflow.com/users/5427063/tah"}, "edited": false, "score": 0, "creation_date": 1453923153, "post_id": 35044407, "comment_id": 57817001, "body": "@TahTatsumoto I am entering the following and I&#39;m getting an invalid syntax.  Any idea where I&#39;m going wrong?  If ([Product Category]=&quot;Children&quot;) Then  [Category Manager] =&quot;John&quot;  Elseif ([Product Category] = &quot;Hybrid&quot;) Then  [Category Manager] = &quot;Jack&quot;  Elseif ([Product Category]=&quot;Leisure&quot;) Then  [Category Manager] = &quot;Sally&quot;  Elseif ([Product Category] = &quot;Mtn.&quot;) then  [Category Manager] = &quot;Kelly&quot; Else ([Category Manager]=&quot;Carl&quot;) End If"}, {"owner": {"reputation": 1501, "user_id": 5427063, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8dAoViSoxvk/AAAAAAAAAAI/AAAAAAAAA60/8VcZHPeu1vw/photo.jpg?sz=128", "display_name": "Tah", "link": "https://stackoverflow.com/users/5427063/tah"}, "edited": false, "score": 0, "creation_date": 1453923363, "post_id": 35044407, "comment_id": 57817132, "body": "That&#39;s a lot of <code>if</code> statements. I&#39;d recommend changing it to a <code>case</code> statement. Here&#39;s how you&#39;d use them <a href=\"http://www.techonthenet.com/access/functions/advanced/case.php\" rel=\"nofollow noreferrer\">techonthenet.com/access/functions/advanced/case.php</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1501, "user_id": 5427063, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8dAoViSoxvk/AAAAAAAAAAI/AAAAAAAAA60/8VcZHPeu1vw/photo.jpg?sz=128", "display_name": "Tah", "link": "https://stackoverflow.com/users/5427063/tah"}, "reply_to_user": {"reputation": 1, "user_id": 5848156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac52946ae506fee072144131eefc89ad?s=128&d=identicon&r=PG&f=1", "display_name": "MicRock", "link": "https://stackoverflow.com/users/5848156/microck"}, "edited": false, "score": 0, "creation_date": 1453924370, "post_id": 35046559, "comment_id": 57817733, "body": "Welcome to StackOverflow. #SOReadyToHelp. Would appreciate if you mark my answer as accepted."}], "tags": [], "owner": {"reputation": 1501, "user_id": 5427063, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8dAoViSoxvk/AAAAAAAAAAI/AAAAAAAAA60/8VcZHPeu1vw/photo.jpg?sz=128", "display_name": "Tah", "link": "https://stackoverflow.com/users/5427063/tah"}, "is_accepted": false, "score": 1, "last_activity_date": 1453923582, "creation_date": 1453923582, "answer_id": 35046559, "question_id": 35044407, "link": "https://stackoverflow.com/questions/35044407/access-2007-validation-rules/35046559#35046559", "title": "Access 2007 Validation rules", "body": "<p>It's better to change multiple <code>if-then</code> statements to case/switch statements.</p>\n\n<pre><code>Select Case [Product Category]\n    Case \"Children\"\n        [Category Manager] = \"John\"\n    Case \"Hybrid\"\n        [Category Manager] = \"Jack\"\n    Case \"Leisure\"\n        [Category Manager] = \"Sally\"\n    Case \"Mtn.\"\n        [Category Manager] = \"Kelly\"\n    Case Else\n        [Category Manager] = \"Carl\"\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5848156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac52946ae506fee072144131eefc89ad?s=128&d=identicon&r=PG&f=1", "display_name": "MicRock", "link": "https://stackoverflow.com/users/5848156/microck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453960430, "creation_date": 1453916531, "last_edit_date": 1453960430, "question_id": 35044407, "link": "https://stackoverflow.com/questions/35044407/access-2007-validation-rules", "title": "Access 2007 Validation rules", "body": "<p>I'm trying to make a field put a certain name in when a different field has a certain text in Access 2007.  Eg.</p>\n\n<pre><code>If [FieldName] = \"mountain\" then [FieldName2] =\"Jack\" but if [FieldName] = \"ocean\" then [FieldName2] =\"John\"\n</code></pre>\n\n<p>I can't find an expression that will give me this result. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5827028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a48bd94a830ba5bec47433a59873c0?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Hlade", "link": "https://stackoverflow.com/users/5827028/jan-hlade"}, "edited": false, "score": 2, "creation_date": 1453919245, "post_id": 35044634, "comment_id": 57814709, "body": "Thank your for yout help. Now it works perfect and I understand how to make that for next time. Your answer was really helpful for my project. Thanks again ;)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1453917229, "creation_date": 1453917229, "answer_id": 35044634, "question_id": 35044302, "link": "https://stackoverflow.com/questions/35044302/count-rows-starting-in-the-middle-of-worksheet/35044634#35044634", "title": "Count rows starting in the middle of worksheet", "body": "<p>Try with these modifications:</p>\n\n<pre><code>Private Sub btnvzdrzevalna_Click()\n\nDim nvdsheet As Worksheet\nSet nvdsheet = ThisWorkbook.Sheets(\"iNVD\")\n\nDim nr As Long\nnr = 26\n\nWith nvdsheet\n\n    'finds first empty row starting at 26, but not moving past 33\n    Do Until IsEmpty(.Cells(nr, 2)) Or nr = 33\n\n        nr = nr + 1\n\n    Loop\n\n    If nr &lt; 33 Then\n\n        .Cells(nr, 2) = Me.cmbvzdrzevanje\n        .Cells(nr, 3) = \"Stanovanjski zakon (SZ-1)\"\n        .Cells(nr, 4) = Me.cmbizvajalec2\n        .Cells(nr, 5) = Me.cmbperioda\n        .Cells(nr, 6) = Me.cmbpregled\n        .Cells(nr, 8) = Me.tbcena1\n\n    Else\n\n        MsgBox \"Not Enough Space\"\n\n    End If\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 5827028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a48bd94a830ba5bec47433a59873c0?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Hlade", "link": "https://stackoverflow.com/users/5827028/jan-hlade"}, "edited": false, "score": 0, "creation_date": 1453919814, "post_id": 35044769, "comment_id": 57815032, "body": "Thank you for your advice and reminder for the property but it is already set in database."}], "tags": [], "owner": {"reputation": 4573, "user_id": 5718868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lMKOf.png?s=128&g=1", "display_name": "jonathana", "link": "https://stackoverflow.com/users/5718868/jonathana"}, "is_accepted": false, "score": 0, "last_activity_date": 1453917708, "creation_date": 1453917708, "answer_id": 35044769, "question_id": 35044302, "link": "https://stackoverflow.com/questions/35044302/count-rows-starting-in-the-middle-of-worksheet/35044769#35044769", "title": "Count rows starting in the middle of worksheet", "body": "<p>the question is unclear but, cmbvzdrzevanje, cmbizvajalec2 etc.. are form controls? (comboboxes etc..). if they are, you need to use the text property.</p>\n\n<pre><code>    .Cells(nr, 2) = Me.cmbvzdrzevanje.text\n    .Cells(nr, 3) = \"Stanovanjski zakon (SZ-1)\"\n    .Cells(nr, 4) = Me.cmbizvajalec2.text\n    .Cells(nr, 5) = Me.cmbperioda.text\n    .Cells(nr, 6) = Me.cmbpregled.text\n    .Cells(nr, 8) = Me.tbcena1.text\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5827028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a48bd94a830ba5bec47433a59873c0?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Hlade", "link": "https://stackoverflow.com/users/5827028/jan-hlade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 603, "favorite_count": 0, "accepted_answer_id": 35044634, "answer_count": 2, "score": 1, "last_activity_date": 1453917708, "creation_date": 1453916233, "last_edit_date": 1531164843, "question_id": 35044302, "link": "https://stackoverflow.com/questions/35044302/count-rows-starting-in-the-middle-of-worksheet", "title": "Count rows starting in the middle of worksheet", "body": "<p>I have a question about the cell count in vba for excell workbook. I am trying to write down text selected in combobox to a proper row (row 26 in the picture) in excel with changing it if it is full (move to next row) till row 32. If it reaches row 33, write text in error window (not enough space). For better wiev and understanding I make a picture where it is all expained. Currently i use following code but it is hot working well:</p>\n\n<pre><code>Private Sub btnvzdrzevalna_Click()\n\nDim nvdsheet As Worksheet\n\nSet nvdsheet = ThisWorkbook.Sheets(\"iNVD\")\n\nnr = nvdsheet.Cells(Rows.Count, 1).End(xlUp).Row - 15 \n'- 15 leads to the right cell from bottom of last cell but it allways returns the same cell because the last cell in rows.count is the same so it overwrites it. \n\nnvdsheet.Cells(nr, 2) = Me.cmbvzdrzevanje\nnvdsheet.Cells(nr, 3) = \"Stanovanjski zakon (SZ-1)\"\nnvdsheet.Cells(nr, 4) = Me.cmbizvajalec2\nnvdsheet.Cells(nr, 5) = Me.cmbperioda\nnvdsheet.Cells(nr, 6) = Me.cmbpregled\nnvdsheet.Cells(nr, 8) = Me.tbcena1\n\nEnd Sub\n</code></pre>\n\n<p>The picture for better understanding of question</p>\n\n<p><a href=\"https://i.stack.imgur.com/K4MpQ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K4MpQ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Thank you for your help. Have a nice day,</p>\n"}, {"tags": ["vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453919398, "post_id": 35044247, "comment_id": 57814798, "body": "What connection string are you using?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453920238, "post_id": 35044247, "comment_id": 57815299, "body": "Try this <code>[&#39;Step#2-PreSource&#39;!$F3:F15]</code>. The single quotes may help solve the issue. And I am pretty sure you will need the <code>!</code> between the sheet name and range reference."}], "owner": {"reputation": 65, "user_id": 2069483, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/eaae84d2c5423441faa713dcf0e5ca9d?s=128&d=identicon&r=PG", "display_name": "Eric Hondzinski", "link": "https://stackoverflow.com/users/2069483/eric-hondzinski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1453916081, "creation_date": 1453916081, "last_edit_date": 1531164843, "question_id": 35044247, "link": "https://stackoverflow.com/questions/35044247/error-involving-ado-recordset-and-excel-worksheet-name", "title": "Error involving ADO recordset and excel worksheet name", "body": "<p>I am attempting to execute the following code:</p>\n\n<pre><code>rs.Open \"SELECT * FROM [Step#2-PreSource$F3:F15]\", cnn, _\n            adOpenStatic, adLockOptimistic, adCmdText\n</code></pre>\n\n<p>I receive this error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/aoHd6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aoHd6.png\" alt=\"Run-time error\"></a></p>\n\n<p>Notice in the error notification it converts the # sign to a period. There is in fact no existing object with such a name. Obviously this is not intended. Is there any way to work around an issue of this sort? </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1453915966, "creation_date": 1453915966, "answer_id": 35044205, "question_id": 35044073, "link": "https://stackoverflow.com/questions/35044073/sub-function-to-show-userform/35044205#35044205", "title": "Sub function to show UserForm", "body": "<p>It depends on what launches these subs. If they are attached to a button or shape (which is what I tend to do for launching userforms) then it makes sense to put them in the module for the sheet that contains the shape. If buttons/shapes on several sheets refer to it -- put them in a general code module. I don't know if there really is a \"best practice\" here. The most important thing is to have consistency so that you don't have to go searching for things.</p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 14, "last_activity_date": 1453930325, "last_edit_date": 1495541784, "creation_date": 1453921706, "answer_id": 35045940, "question_id": 35044073, "link": "https://stackoverflow.com/questions/35044073/sub-function-to-show-userform/35045940#35045940", "title": "Sub function to show UserForm", "body": "<p>Assuming <code>Adjuster</code> is the name of the form, you're using the <em>default instance</em> here, which isn't ideal.</p>\n\n<p>This would already be better:</p>\n\n<pre><code>Dim view As Adjuster\nSet view = New Adjuster\nview.Show\n</code></pre>\n\n<p>Yes, it's more code. But you're using a dedicated <em>object</em> (i.e. <code>view</code>) and, if that object's state gets modified, these changes aren't going to affect the default instance. Think of that default instance as a global object: it's <em>global</em>, which isn't very OOP.</p>\n\n<p>Now, you may argue, <em>why not \"new up\" the object on the same line as the declaration then?</em></p>\n\n<p>Consider this:</p>\n\n<pre><code>Sub DoSomething()\n    Dim c As New Collection\n    Set c = Nothing\n    c.Add \"test\"\nEnd Sub\n</code></pre>\n\n<p>Is this code accessing a null reference and blowing up with a run-time error 91? No! Confusing? Yes! Hence, avoid the <code>As New</code> shortcut, unless you like having VBA automagically doing implicit stuff behind your back.</p>\n\n<hr>\n\n<p>So, you're asking about <em>best practice</em>... I tend to consider VBA UserForms as an early pre-.NET version of <a href=\"/questions/tagged/winforms\" class=\"post-tag\" title=\"show questions tagged &#39;winforms&#39;\" rel=\"tag\">winforms</a>, and best practice design pattern for WinForms is the <em>Model-View-Presenter</em> pattern (aka \"MVP\").</p>\n\n<p>Following this pattern, you'll have UserForms strictly responsible for <em>presentation</em>, and you'll have your business logic either implemented in a <em>presenter</em> object, or in a dedicated object that the presenter uses. Something like this:</p>\n\n<p><strong>Class Module: MyPresenter</strong></p>\n\n<p>The <em>presenter</em> class receives events from the <em>model</em>, and executes application logic depending on the state of the model. It knows about a <em>concept</em> of a <em>view</em>, but it doesn't have to be <em>tightly coupled</em> with a concrete implementation (e.g. <code>MyUserForm</code>) - with proper tooling you could <a href=\"https://github.com/rubberduck-vba/Rubberduck/wiki/Unit-Testing\" rel=\"nofollow noreferrer\">write unit tests</a> to validate your logic programmatically, without having to actually run the code and display the form and click everywhere.</p>\n\n<pre><code>Option Explicit\n\nPrivate Type TPresenter\n    View As IView\nEnd type\n\nPublic Enum PresenterError\n    ERR_ModelNotSet = vbObjectError + 42\nEnd Enum\n\nPrivate WithEvents viewModel As MyModel\nPrivate this As TPresenter\n\nPublic Sub Show()\n    If viewModel Is Nothing Then\n        Err.Raise ERR_ModelNotSet, \"MyPresenter.Show\", \"Model is not set to an object reference.\"\n    End If\n    'todo: set up model properties\n    view.Show\n    If Not view.IsCancelled Then DoSomething\nEnd Sub\n\nPublic Property Get View() As IView\n    Set View = this.View\nEnd Property\n\nPublic Property Set View(ByVal value As IView)\n    Set this.View = value\n    If Not this.View Is Nothing Then Set this.View.Model = viewModel\nEnd Property\n\nPublic Property Get Model() As MyModel\n    Set Model = viewModel\nEnd Property\n\nPublic Property Set Model(ByVal value As MyModel)\n    Set viewModel = value\n    If Not this.View Is Nothing Then Set this.View.Model = viewModel        \nEnd Property\n\nPrivate Sub Class_Terminate()\n    Set this.View.Model = Nothing\n    Set this.View = Nothing\n    Set viewModel = Nothing\nEnd Sub\n\nPrivate Sub viewModel_PropertyChanged(ByVal changedProperty As ModelProperties)\n    'todo: execute logic that needs to run when something changes in the form\nEnd Sub\n\nPrivate Sub DoSomething()\n    'todo: whatever needs to happen after the form closes\nEnd Sub\n</code></pre>\n\n<p><strong>Class Module: IView</strong></p>\n\n<p>That's the <em>abstraction</em> that represents the <em>concept</em> of a <em>View</em> that exposes everything the <em>Presenter</em> needs to know about any UserForm - note that <em>everything it needs to know</em>, isn't much:</p>\n\n<pre><code>Option Explicit\n\nPublic Property Get Model() As Object\nEnd Property\n\nPublic Property Set Model(ByVal value As Object)\nEnd Property\n\nPublic Property Get IsCancelled() As Boolean\nEnd Property\n\nPublic Sub Show()\nEnd Sub\n</code></pre>\n\n<p><strong>Class Module: MyModel</strong></p>\n\n<p>The model class encapsulates the data that the form needs and manipulates. It doesn't know about the <em>view</em>, and it doesn't know about the <em>presenter</em> either: it's just a container for encapsulated data, with simple logic that enables both the view and the presenter to execute code when any of the properties are modified.</p>\n\n<pre><code>Option Explicit\n\nPrivate Type TModel\n    MyProperty As String\n    SomeOtherProperty As String\n    'todo: wrap members here\nEnd Type\n\nPublic Enum ModelProperties\n    MyProperty\n    SomeOtherProperty\n    'todo: add enum values here for each monitored property\nEnd Enum\n\nPublic Event PropertyChanged(ByVal changedProperty As ModelProperties)\nPrivate this As TModel\n\nPublic Property Get MyProperty() As String\n    MyProperty = this.MyProperty\nEnd Property\n\nPublic Property Let MyProperty(ByVal value As String)\n    If this.MyProperty &lt;&gt; value Then\n        this.MyProperty = value\n        RaiseEvent PropertyChanged(MyProperty)\n    End If\nEnd Property\n\nPublic Property Get SomeOtherProperty() As String\n    SomeProperty = this.SomeOtherProperty\nEnd Property\n\nPublic Property Let SomeOtherProperty(ByVal value As String)\n    If this.SomeOtherProperty &lt;&gt; value Then\n        this.SomeOtherProperty = value\n        RaiseEvent PropertyChanged(SomeOtherProperty)\n    End If\nEnd Property\n\n'todo: expose other model properties\n</code></pre>\n\n<p><strong>UserForm: MyUserForm</strong></p>\n\n<p>The UserForm is strictly responsible for visual presentation; all its event handlers to, is change the value of a property in the model - the model then tells the presenter \"hey I've been modified!\", and the presenter acts accordingly. The form also listens for modified properties on the model, so when the presenter changes the model, the view can execute code and update itself accordingly. Here's an example of a simple form \"binding\" the <code>MyProperty</code> model property to the text of some <code>TextBox1</code>; I added a listener for <code>SomeOtherProperty</code> just to illustrate that the view can also be updated indirectly when the model changes.</p>\n\n<p>Obviously the view wouldn't be reacting to the same properties changing as the presenter, otherwise you would enter an endless ping-pong of callbacks that would eventually blow up the stack... but you get the idea.</p>\n\n<p>Note that the form implements the <code>IView</code> interface, so that the presenter can talk to it without actually knowing about its inner workings. The interface implementation simply refers to concrete members, but the concrete members don't even need to actually exist, since they won't even be used!</p>\n\n<pre><code>Option Explicit\nImplements IView\n\nPrivate Type TView\n    IsCancelled As Boolean\nEnd Type\n\nPrivate WithEvents viewModel As MyModel\nPrivate this As TView\n\nPrivate Property Get IView_Model() As Object\n    Set IView_Model = Model\nEnd Property\n\nPrivate Property Set IView_Model(ByVal value As Object)\n    Set Model = value\nEnd Property\n\nPrivate Property Get IView_IsCancelled() As Boolean\n    IView_IsCancelled = IsCancelled\nEnd Property\n\nPrivate Sub IView_Show()\n    Show vbModal\nEnd Sub\n\nPublic Property Get Model() As MyModel\n    Set Model = viewModel\nEnd Property\n\nPublic Property Set Model(ByVal value As MyModel)\n    Set viewModel = value\nEnd Property\n\nPublic Property Get IsCancelled() As Boolean\n    IsCancelled = this.IsCancelled\nEnd Property\n\nPrivate Sub CancelButton_Click()\n    this.IsCancelled = True\n    Me.Hide\nEnd Sub\n\nPrivate Sub OkButton_Click()\n    Me.Hide\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    '\"x-ing out\" of the form is like clicking the Cancel button\n    If CloseMode = VbQueryClose.vbFormControlMenu Then\n        this.IsCancelled = True\n    End If\nEnd Sub\n\nPrivate Sub UserForm_Activate()\n    If viewModel Is Nothing Then\n        MsgBox \"Model property must be assigned before the view can be displayed.\", vbCritical, \"Error\"\n        Unload Me\n    Else\n        Me.TextBox1.Text = viewModel.MyProperty\n        Me.TextBox1.SetFocus\n    End If\nEnd Sub\n\nPrivate Sub TextBox1_Change()\n    'UI elements update the model properties\n    viewModel.MyProperty = Me.TextBox1.Text\nEnd Sub\n\nPrivate Sub viewModel_PropertyChanged(ByVal changedProperty As ModelProperties)\n    If changedProperty = SomeOtherProperty Then\n        Frame1.Caption = SomeOtherProperty\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Module: Macros</strong></p>\n\n<p>Say your spreadsheet had a shape and you wanted to run that logic when it's clicked. You need to attach a macro to that shape - I like to regroup all macros in a standard module (.bas) called \"Macros\", that contains nothing but public procedures that all look like this:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub DoSomething()\n\n    Dim presenter As MyPresenter \n    Set presenter = New MyPresenter\n\n    Dim theModel As MyModel\n    Set theModel = New MyModel\n\n    Dim theView As IView\n    Set theView = New MyUserForm\n\n    Set presenter.Model = theModel\n    Set presenter.View = theView\n    presenter.Show\n\nEnd Sub\n</code></pre>\n\n<p>Now, if you want to test your presenter logic programmatically without showing a form, all you need to do is implement a \"fake\" view, and write a test method that will do what you need:</p>\n\n<p><strong>Class: MyFakeView</strong></p>\n\n<pre><code>Option Explicit\nImplements IView\n\nPrivate Type TFakeView\n    IsCancelled As Boolean\nEnd Type\n\nPrivate this As TFakeView\n\nPrivate Property Get IView_Model() As Object\n    Set IView_Model = Model\nEnd Property\n\nPrivate Property Set IView_Model(ByVal value As Object)\n    Set Model = value\nEnd Property\n\nPrivate Property Get IView_IsCancelled() As Boolean\n    IView_IsCancelled = IsCancelled\nEnd Property\n\nPrivate Sub IView_Show()\n    IsCancelled = False\nEnd Sub\n\nPublic Property Get IsCancelled() As Boolean\n    IsCancelled = this.IsCancelled\nEnd Property\n\nPublic Property Let IsCancelled(ByVal value As Boolean)\n    this.IsCancelled = value\nEnd Property\n</code></pre>\n\n<p><strong>Module: TestModule1</strong></p>\n\n<p>There are probably other tools out there, but since I actually wrote this one and I like how it works without a crap ton of boilerplate setup code or comments that contain executable instructions I'm going to warmly recommend using Rubberduck unit tests. Here's what a [very simple] test module might look like:</p>\n\n<pre><code>'@TestModule\nOption Explicit\nOption Private Module\nPrivate Assert As New Rubberduck.AssertClass\n\n'@TestMethod\nPublic Sub Model_SomePropertyInitializesEmpty()\n    On Error GoTo TestFail\n\n    'Arrange\n    Dim presenter As MyPresenter \n    Set presenter = New MyPresenter\n\n    Dim theModel As MyModel\n    Set theModel = New MyModel\n\n    Set presenter.Model = theModel\n    Set presenter.View = New MyFakeView\n\n    'Act\n    presenter.Show\n\n    'Assert\n    Assert.IsTrue theModel.SomeProperty = vbNullString\n\nTestExit:\n    Exit Sub\nTestFail:\n    Assert.Fail \"Test raised an error: #\" &amp; Err.Number &amp; \" - \" &amp; Err.Description\nEnd Sub\n</code></pre>\n\n<p><a href=\"http://www.rubberduck-vba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> unit tests allow you to use this decoupled code to test everything you want to test about your application logic - as long as you keep that application logic <em>decoupled</em> and that you write <em>testable</em> code, you'll have unit tests that document how your VBA application is supposed to behave, tests that document what the specs are - just like you would have them in C# or Java, or any other OOP language one can write unit tests with.</p>\n\n<p>Point is, VBA can do it, too.</p>\n\n<hr>\n\n<p>Overkill? Depends. Specs changes all the time, code changes accordingly. Implementing all the application logic in spreadsheets' code-behind gets utterly annoying, because <a href=\"https://github.com/rubberduck-vba/Rubberduck/wiki/Code-Explorer\" rel=\"nofollow noreferrer\">the Project Explorer doesn't drill down to module members</a>, so finding what's implemented where can easily get annoying.</p>\n\n<p>And it's even worse when the logic is implemented in the forms' code-behind and then you have <code>Button_Click</code> handlers making database calls or spreadsheet manipulations.</p>\n\n<p>Code that's implemented in objects that have as few responsibilities as possible, makes code that's reusable, and that's easier to maintain.</p>\n\n<p>Your question isn't exactly precise about exactly what you mean with \"an Excel file with multiple userforms\", but if you need to, you could have a \"main\" presenter class that receives 4-5 \"child\" presenters, each being responsible for the specific logic tied to each \"child\" form.</p>\n\n<p>That said, if you have working code (that works exactly as intended) that you would like to refactor and make more efficient, or easier to read/maintain, you can post it on <a href=\"http://www.codereview.stackexchange.com\" rel=\"nofollow noreferrer\">Code Review Stack Exchange</a>, that's what that site is for.</p>\n\n<hr>\n\n<blockquote>\n  <p><strong>Disclaimer</strong>: <a href=\"https://stackoverflow.com/teams/189/rubberduck\">I maintain the Rubberduck project.</a></p>\n</blockquote>\n"}], "owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1364, "favorite_count": 5, "accepted_answer_id": 35045940, "answer_count": 2, "score": 5, "last_activity_date": 1453930325, "creation_date": 1453915588, "question_id": 35044073, "link": "https://stackoverflow.com/questions/35044073/sub-function-to-show-userform", "title": "Sub function to show UserForm", "body": "<p>I have an excel file with multiple UserForms. To open a UserForm I have code such as</p>\n\n<pre><code>Sub runAdjuster()\n   Adjuster.Show\nEnd Sub\n</code></pre>\n\n<p>There are about 5 of these. What is considered best practice in terms of where this code should be kept? I originally had it in a module, but have decided to move it to the ThisWorkbook object. Looking for tips on what is normally done to keep code clean.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 3, "creation_date": 1453915505, "post_id": 35043974, "comment_id": 57812193, "body": "<a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to Avoid Using Select and ActiveCell in VBA</a> - a <b>MUST</b> read for all VBA programmers."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1453915846, "post_id": 35043974, "comment_id": 57812435, "body": "In addition to @Scott&#39;s comment, you need to <a href=\"http://stackoverflow.com/a/34934998/4650297\">assign parentage</a> to the ranges when using <code>With</code>. So, in a <code>With</code> block, add <code>.</code> before any range type reference, such as <code>Range()</code>, <code>Cells()</code>, <code>Rows()</code>, <code>Columns()</code>, etc.  Otherwise, it&#39;s just going to use whatever the <code>ActiveSheet</code> is for those references."}], "answers": [{"tags": [], "owner": {"reputation": 104, "user_id": 2132992, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/70286dcb42281043dd345a7b064bcf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Tango_Mike", "link": "https://stackoverflow.com/users/2132992/tango-mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1453916395, "last_edit_date": 1453916395, "creation_date": 1453915940, "answer_id": 35044195, "question_id": 35043974, "link": "https://stackoverflow.com/questions/35043974/why-wont-my-range-paste/35044195#35044195", "title": "Why won&#39;t my range paste?", "body": "<p>Since you are using \"With\" statement, you need to add a \".\" in front of \"cells\" and \"range\" and any other references you make. For example:</p>\n\n<pre><code>With myWorksheet\n    .range(\"A1\").copy\nEnd with\n</code></pre>\n\n<p>So, the problem in this case is that you still remain on the same worksheet and clear the contents of the cells you had pasted.</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 5040968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d560c150d2a862397ec7e7e80dac9b43?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Oropeza", "link": "https://stackoverflow.com/users/5040968/sergio-oropeza"}, "edited": false, "score": 2, "creation_date": 1453916189, "post_id": 35044204, "comment_id": 57812653, "body": "THAT LINK IS THE BEST THING TO HAPPEN TO ME! Thank you so much"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 3, "last_activity_date": 1453915963, "creation_date": 1453915963, "answer_id": 35044204, "question_id": 35043974, "link": "https://stackoverflow.com/questions/35043974/why-wont-my-range-paste/35044204#35044204", "title": "Why won&#39;t my range paste?", "body": "<p>I fixed the code here, but <strong>please read the link I provided in my comment</strong>, and you will not have these errors in the future.</p>\n\n<p>I also commented the refactors I did to the code. Also, notice that I assigned the Cells and Ranges to the parent worksheet with <code>.</code>. <em>(See @BruceWayne's link in his comment to your original question)</em></p>\n\n<pre><code>Sub Macro1()\n\nDim Form1033 As Worksheet\nDim CleaningSchedule As Worksheet\n\nSet Form1033 = Worksheets(\"Form1033andForm1034\")\nSet CleaningSchedule = Worksheets(\"CleaningSchedule\")\n\nDim Day As Range\nSet Day = Form1033.Range(\"$J$3\")\n\n'copy the range directly\nForm1033.Range(\"$G$5:$G$18\").Copy\n\nWith CleaningSchedule\n\n    Dim i As Integer\n\n    For i = 6 To 37\n\n        If .Cells(4, i).Value = Day.Value Then\n\n            'paste directly to range and i also combined 13 rows plus row 5, since you are always using the same row\n            Range(.Cells(5,i), Cells(18,i)).PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n                SkipBlanks:=False, Transpose:=False\n\n        End If\n\n    Next i\n\nEnd With\n\n'clear contenst directly\nForm1033.Range(\"$G$5:$G$18\").ClearContents\n\nMsgBox \"Scoresheet Updated\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5040968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d560c150d2a862397ec7e7e80dac9b43?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Oropeza", "link": "https://stackoverflow.com/users/5040968/sergio-oropeza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 35044204, "answer_count": 2, "score": 1, "last_activity_date": 1453916395, "creation_date": 1453915283, "question_id": 35043974, "link": "https://stackoverflow.com/questions/35043974/why-wont-my-range-paste", "title": "Why won&#39;t my range paste?", "body": "<p>The following is my VBA code, for some reason the code will run but not actually paste in the range I need it to paste. Anybody have any ideas why it won't paste my values? </p>\n\n<p>The programs goes to my selected cell that I'm looking for, but now the activecell becomes my range and I'm trying to paste the it there. Any information will help, it just doesn't want to paste the values in the range I selected. </p>\n\n<pre><code>Sub Macro1()\n\nDim Form1033 As Worksheet\nDim CleaningSchedule As Worksheet\n\nSet Form1033 = Worksheets(\"Form1033andForm1034\")\nSet CleaningSchedule = Worksheets(\"CleaningSchedule\")\n\nDim Day As Range\nSet Day = Form1033.Range(\"$J$3\")\n\nWith Form1033\n\nRange(\"$G$5:$G$18\").Select\nSelection.Copy\n\nEnd With\n\nWith CleaningSchedule\n\nDim i As Integer\n\nFor i = 6 To 37\n\nIf Cells(4, i).Value = Day.Value Then\n\nCells(5, i).Select\n\nRange(ActiveCell, Cells(ActiveCell.Rows + 13, ActiveCell.Column)).Select\nSelection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n\n                End If\n          Next i\n    End With\n\n\nForm1033.Select\nApplication.CutCopyMode = False\nRange(\"$G$5:$G$18\").ClearContents\n\nMsgBox \"Scoresheet Updated\"\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1453915393, "post_id": 35043956, "comment_id": 57812115, "body": "<a href=\"http://peltiertech.com/get-open-or-save-as-filename/\" rel=\"nofollow noreferrer\">GetOpenFilename</a>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1453921042, "post_id": 35043956, "comment_id": 57815794, "body": "you can also use <code>ENVIRON(&quot;username&quot;)</code> to get the <code>USER*n*</code>. So <code>sFile = &quot;C;\\Users\\&quot; &amp; ENVIRON(&quot;username&quot;) &amp; &quot;\\Box Sync\\filnename.xlsx&quot;</code>"}], "owner": {"reputation": 11, "user_id": 2092811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b5a75330bf6ab6df287225dc2714b1b?s=128&d=identicon&r=PG", "display_name": "malaise", "link": "https://stackoverflow.com/users/2092811/malaise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1453919764, "creation_date": 1453915221, "last_edit_date": 1495535277, "question_id": 35043956, "link": "https://stackoverflow.com/questions/35043956/user-option-in-access-to-select-unique-filepath-for-excel-source-data", "title": "User option in Access to select unique filepath for Excel source data", "body": "<p>I am working off of a <a href=\"https://stackoverflow.com/questions/15930832/import-dynamic-and-static-ranges-from-excel-in-to-ms-access-that-do-not-start-at/15947191#15947191\">great solution</a> created by @MattHall from 2011 to a question that I also shared about importing a dynamic range from Excel into Access.</p>\n\n<p>Specific to that--though in general for future VBA's--my question is whether there is an additional way to be able to point to the Excel source file if it is moved without having to go into the VBA editor every time? </p>\n\n<p>For my specific needs, I am trying to work on these Access and Excel files with others through a shared BOX that has a different file path for whoever is working on it.</p>\n\n<p>USER 1 may be: C:\\Users\\USER1\\Box Sync\\filename.xlsx</p>\n\n<p>USER 2 may be: C:\\Users\\USER2\\Box Sync\\filename.xlsx</p>\n\n<p>...and so forth for any other users. I am curious how we can all work off this when the file path used in the VBA created and used by USER1 is not accessible by USER2? Could there be some code that allows for the every user to locate the file each time through their own filepath?</p>\n\n<p>It would be a pain to do that but I also do not know a better option as we are not working off a shared server and this is unfortunately limited to Box share at the moment.</p>\n\n<p>EDIT: If anyone could also suggest how to integrate their recommendation into the 'Dynamic Range' code in solution from @MattHall in the <a href=\"https://stackoverflow.com/questions/15930832/import-dynamic-and-static-ranges-from-excel-in-to-ms-access-that-do-not-start-at/15947191#15947191\">linked Stackoverflow</a>, that would particularly helpful to my request.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1453918281, "post_id": 35043784, "comment_id": 57814037, "body": "what are the settings in the trust center for the active x controls?"}, {"owner": {"reputation": 3101, "user_id": 167478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f77f8328db85911cfbfba4662bb73?s=128&d=identicon&r=PG", "display_name": "Fink", "link": "https://stackoverflow.com/users/167478/fink"}, "edited": false, "score": 2, "creation_date": 1453927259, "post_id": 35043784, "comment_id": 57819337, "body": "With the .accdb file try to manually run a &#39;Compile&#39; command (VBA Editor --&gt; Debug --&gt; Compile) to ensure there is no warnings/issues as any compiler error can cause issues with a compiled .accde files not firing events"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1453928262, "post_id": 35043784, "comment_id": 57819879, "body": "Is this both (.accdb working and .accde not working) on the same computer?"}], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1454084511, "post_id": 35088103, "comment_id": 57900309, "body": "You should <b>always</b> make sure your code compiles. It helps to add Debug -&gt; Compile to the VBA Editor toolbar."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1454088197, "post_id": 35088103, "comment_id": 57902649, "body": "How do you create an ACCDE from an ACCDB if the ACCDB won&#39;t compile without error?  I thought compile is part of the conversion process and have seen the conversion fail due to compile errors."}, {"owner": {"reputation": 580, "user_id": 4092675, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1463524265/picture?type=large", "display_name": "Chris Chevalier", "link": "https://stackoverflow.com/users/4092675/chris-chevalier"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1454090228, "post_id": 35088103, "comment_id": 57903762, "body": "@hansup That is why I am confused as well.. creating the accde I never had error. And compiling it from there had no errors either but solved it."}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1534891257, "post_id": 35088103, "comment_id": 90865698, "body": "I added some comments and hit compile again. Then it started working. My code didn&#39;t change. I&#39;m convinced Access is a wreck and doesn&#39;t know what the hell is going on."}], "tags": [], "owner": {"reputation": 580, "user_id": 4092675, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1463524265/picture?type=large", "display_name": "Chris Chevalier", "link": "https://stackoverflow.com/users/4092675/chris-chevalier"}, "is_accepted": false, "score": 3, "last_activity_date": 1454084278, "last_edit_date": 1454084278, "creation_date": 1454081275, "answer_id": 35088103, "question_id": 35043784, "link": "https://stackoverflow.com/questions/35043784/after-making-my-accdb-an-accde-form-events-wont-fire/35088103#35088103", "title": "After making my .accdb an .accde, form events wont fire", "body": "<blockquote>\n  <p>With the .accdb file try to manually run a 'Compile' command (VBA Editor --> Debug --> Compile) to ensure there is no warnings/issues as any compiler error can cause issues with a compiled .accde files not firing events</p>\n</blockquote>\n\n<p>this solved my problem</p>\n"}, {"tags": [], "owner": {"reputation": 151, "user_id": 1227580, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/JcNlg.jpg?s=128&g=1", "display_name": "Mark Sowards", "link": "https://stackoverflow.com/users/1227580/mark-sowards"}, "is_accepted": false, "score": 0, "last_activity_date": 1562390101, "last_edit_date": 1562390101, "creation_date": 1562389755, "answer_id": 56911390, "question_id": 35043784, "link": "https://stackoverflow.com/questions/35043784/after-making-my-accdb-an-accde-form-events-wont-fire/56911390#56911390", "title": "After making my .accdb an .accde, form events wont fire", "body": "<p>OK with a quick little DB App on Access 2013 I ran into this problem.  I found several different explanation across multiple support sites like this one, but every one had been left open without a solution or at least a solution that worked for me.  The Trusted location solution had no effect, recompiling the code, deleting the VB in the form -saving the form (sans code) and then replacing the code in the form and compiling did not work.  </p>\n\n<p>So let's get this straight: the accdb has gone through multiple testing and debug compile completes with out note and has been used operationally for half a year.  However, when I decided to harden the Db making both the front end and back end accde files, the back end compiled (there is locking code in the backend)  and the accde worked fine, the front end compiled with out error, but the accde file none of it VBA worked.  The default startup form opened, but none of the vb subs seemed to be executed - the form_load sub didn't do anything and when the buttons were pressed nothing happened (all except the button that executed an embedded macro - that button worked).</p>\n\n<p>After trying all the different solutions and banging my head on the wall for a while  I decided it had to be something in the original accbd file.  So I created a new blank accdb and imported all the Table links, forms, Queries, and modules into the new db.  Tested the accdb and everything was working; compiled and made the accde - it didn't work. Same problem. hummmm?  It's not the Access installation because the back end compiles and it's accde works fine.  I thought I reestablished the link between the form(s) and the VB by deleting the code and saving the form without the code, then adding(pasting from notepad) the code back in and saving the form again, but that didn't work.  So I tried an experiment. I created a new form with a button that ran code to pop up a message, compiled the DB and made the accde and the new form worked (all the others still didn't).  Would I have to remake every form?  Well let's try a short cut  I copied and pasted each form to it's original name with a 2 appended, then deleted every original form and renamed all the copies.  Some quick tests and all the DB functions are fine, the compile is fine and the Accde --- it works!   No code change; no error to find - just recopying the form(s) some how reconnected the VB to the forms once the DB was made into a ACCDE. </p>\n"}, {"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1576105944, "post_id": 59292526, "comment_id": 104795346, "body": "A full <a href=\"https://stackoverflow.com/a/3268188/3820271\">Decompile</a> might have helped, too."}], "tags": [], "owner": {"reputation": 11, "user_id": 11915266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3594c69e57d8b428056dd94efaece8e7?s=128&d=identicon&r=PG", "display_name": "David in Mississippi", "link": "https://stackoverflow.com/users/11915266/david-in-mississippi"}, "is_accepted": false, "score": 1, "last_activity_date": 1576095221, "last_edit_date": 1576095221, "creation_date": 1576091493, "answer_id": 59292526, "question_id": 35043784, "link": "https://stackoverflow.com/questions/35043784/after-making-my-accdb-an-accde-form-events-wont-fire/59292526#59292526", "title": "After making my .accdb an .accde, form events wont fire", "body": "<p>I had the same problem as Chris Chevalier above, and I would have been pulling out my hair, if I had any left.</p>\n\n<p>[<em>Extensive description deleted - it merely showed what I tried that DID NOT work</em>]</p>\n\n<p><strong>Here's what I did that WORKED:</strong></p>\n\n<p>[<strong>THE STEPS I WENT THROUGH</strong>]</p>\n\n<ol>\n<li>Created a new database; imported all native tables (2), re-linked all linked tables (9), imported modules (1) and queries (numerous). Imported all forms that had minimal VBA code in their modules (about 8).</li>\n<li>Tested Operation so far. Made sure I knew what should work and what not to try yet.</li>\n<li>Created .accde file and tested it. It worked, therefore, so far, so good.</li>\n<li>Began importing the more complex-VBA-code-module forms, one at a time. After each import, I would test the functionality of that form and its code, then created the .accde file (numbered sequentially so I could track what I was doing) and tested that. For the first few forms, it worked fine, then on one form import, it crashed.</li>\n<li>Went back to the original .accdb file and looked at the code for the form that made the .accde file crash (not run VBA code). Fortunately, there were only 3 procedures in that form's code module, two were simple code, and one was (critical point) an <strong><em>EMPTY ONCLOSE EVENT PROCEDURE</em></strong>.</li>\n<li>I deleted the empty event procedure, re-created the .accde file, and it WORKED!!</li>\n</ol>\n\n<p>[<strong>THE SOLUTION</strong>]</p>\n\n<p>I went back to the original .accdb file - the full program that worked fine as an .accdb file but would not run VBA code as an .accde file - and I deleted the empty OnClose event procedure from the offending form's code module, re-created the .accde file for the full program, and IT NOW WORKS!</p>\n\n<p>By deleting that single offending empty event procedure, the .accde file will now run all my VBA code.</p>\n\n<p>This is what I found that works for me. It will take more experimentation (for which I don't have time right now) to determine if this is the cause of most similar instances of VBA code not running from an .accde file. </p>\n"}, {"comments": [{"owner": {"reputation": 1540, "user_id": 4705583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBboA.jpg?s=128&g=1", "display_name": "Rich Michaels", "link": "https://stackoverflow.com/users/4705583/rich-michaels"}, "edited": false, "score": 0, "creation_date": 1606680737, "post_id": 65041842, "comment_id": 115027836, "body": "This does not seem to provide and answer to the OP&#39;s question. If you can explain how it does, I&#39;ll remove my comment, otherwise you should consider removing this as an answer."}], "tags": [], "owner": {"reputation": 1, "user_id": 14067082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0pdF9.jpg?s=128&g=1", "display_name": "PJD", "link": "https://stackoverflow.com/users/14067082/pjd"}, "is_accepted": false, "score": -1, "last_activity_date": 1606500000, "creation_date": 1606500000, "answer_id": 65041842, "question_id": 35043784, "link": "https://stackoverflow.com/questions/35043784/after-making-my-accdb-an-accde-form-events-wont-fire/65041842#65041842", "title": "After making my .accdb an .accde, form events wont fire", "body": "<p>This is a dangerous flaw in Access since there is no warning that the code has failed. While compiling the code before creating the .accde file does correct the problem, if you forget this step catastrophic results could ensue.</p>\n<p>In my case, I had code to link to the backend in the same folder as the front end. As a result of this flaw the front end was linked and records were written to the wrong backend.</p>\n<p>It happened that on my opening form I had a text box referencing a subroutine to calculate the data path of the backend which gave a &quot;#Name?&quot; error when loaded. I have now made use of this by hiding that text box and naming it txtTestCode and using an On Open macro event &quot;If IsError([txtTestCode])&quot; to generate a messagebox to warn that the &quot;Code is not running, run Debug&gt;Compile on .accdb to check for errors and remove empty Sub or Function declarations.&quot; Note that using code rather than a macro would fail in this case.</p>\n<p>I now use DLookUp(&quot;[Database]&quot;,&quot;[MSysObjects]&quot;,&quot;Name = &quot;&quot;AnyLinkedTable&quot;&quot;&quot;) to provide the backend data path so it will show even when the code fails.</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 9837350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I4H21.jpg?s=128&g=1", "display_name": "Saad Khawaja", "link": "https://stackoverflow.com/users/9837350/saad-khawaja"}, "is_accepted": false, "score": 0, "last_activity_date": 1619205812, "last_edit_date": 1619205812, "creation_date": 1617478260, "answer_id": 66935136, "question_id": 35043784, "link": "https://stackoverflow.com/questions/35043784/after-making-my-accdb-an-accde-form-events-wont-fire/66935136#66935136", "title": "After making my .accdb an .accde, form events wont fire", "body": "<p>I was facing similar issue.I just opened .accdb file which was working perfectly, then went to vba code &amp; deleted all my empty functions. After that .accde file works perfectly</p>\n"}], "owner": {"reputation": 580, "user_id": 4092675, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1463524265/picture?type=large", "display_name": "Chris Chevalier", "link": "https://stackoverflow.com/users/4092675/chris-chevalier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2736, "favorite_count": 1, "answer_count": 5, "score": 3, "last_activity_date": 1619205812, "creation_date": 1453914797, "last_edit_date": 1594247383, "question_id": 35043784, "link": "https://stackoverflow.com/questions/35043784/after-making-my-accdb-an-accde-form-events-wont-fire", "title": "After making my .accdb an .accde, form events wont fire", "body": "<p>I have a working MS-Access project. All of the events and vba code functions as intended when existing as an .accdb</p>\n\n<p>When I compile to a .accde all of the vba events tied to updating a textbox, combo box or clicking a button no longer run. I have tried different locations for the file and it still runs the same.</p>\n\n<p>EDIT: Just double checked my trusted locations and the file is located in a trusted location. I even ticked the option to allow vba code to run no matter the security.</p>\n\n<p>Also can confirm that the onLoad() events do work..</p>\n"}, {"tags": ["c#", "visual-studio", "excel", "excel-addins", "vba"], "comments": [{"owner": {"reputation": 3307, "user_id": 1295010, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9f397d33316aee7a3b0de54298476d37?s=128&d=identicon&r=PG", "display_name": "Alex Butenko", "link": "https://stackoverflow.com/users/1295010/alex-butenko"}, "edited": false, "score": 0, "creation_date": 1453933174, "post_id": 35043572, "comment_id": 57822675, "body": "Do I understand it right that you want to set the dropdown list in B1 when A1 changed and change D1 list when B1 changed?"}, {"owner": {"reputation": 249, "user_id": 4918949, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/919598998083266/picture?type=large", "display_name": "Sonu Gupta", "link": "https://stackoverflow.com/users/4918949/sonu-gupta"}, "reply_to_user": {"reputation": 3307, "user_id": 1295010, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9f397d33316aee7a3b0de54298476d37?s=128&d=identicon&r=PG", "display_name": "Alex Butenko", "link": "https://stackoverflow.com/users/1295010/alex-butenko"}, "edited": false, "score": 0, "creation_date": 1453963319, "post_id": 35043572, "comment_id": 57832680, "body": "yes exactly. @Alex Butenko"}], "owner": {"reputation": 249, "user_id": 4918949, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/919598998083266/picture?type=large", "display_name": "Sonu Gupta", "link": "https://stackoverflow.com/users/4918949/sonu-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 480, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1453963606, "creation_date": 1453914089, "last_edit_date": 1531161705, "question_id": 35043572, "link": "https://stackoverflow.com/questions/35043572/how-to-apply-data-validation-for-drop-down-in-excel-sheet-by-c-code", "title": "How to apply data validation for drop down in excel sheet by C# code", "body": "<p>I am working on Excel plugin and trying to create the dropdowns for a column which can have another column cells data. </p>\n\n<p>For Example:</p>\n\n<p>Column H's name is <code>Type</code> and has data like \"Animal, Human\".<br>\nColumn I's name is <code>Animal</code> and has data like \"Dog, Cat, Rat\"<br>\nColumn J's name is <code>Dog</code> and has data like \"Dog1, Dog2, Dog3\"<Br>\nColumn K's name is <code>Cat</code> and has data like \"Cat1 , Cat2 , Cat3\"<br>\nColumn L's name is <code>Rat</code> and has data like \"Rat1 , Rat2 , Rat3\" </p>\n\n<pre><code>1    H        I        J        K        L\n2   Type     Name     Dog      Cat      Rat\n3   Animal   Dog      Dog1     Cat1     Rat1\n4   Human    Cat      Dog2     Cat2     Rat2\n5            Rat      Dog3     Cat3     Rat3\n</code></pre>\n\n<p>I linked column A with column H with this formula:</p>\n\n<pre><code>firstRow.Validation.Add(Excel.XlDVType.xlValidateList, Excel.XlDVAlertStyle.xlValidAlertStop, Excel.XlFormatConditionOperator.xlBetween,\n                \"=\" + activeWorkSheet.Name + \"!\" + activeWorkSheet.get_Range(\"Type\").AddressLocal);\n</code></pre>\n\n<p>same formula I applied for <code>B2</code> with changing the range name.</p>\n\n<p>Now cell <code>A1</code> has a dropdown list of \"Animal, Human\".</p>\n\n<p>cell <code>B1</code>'s dropdown list is dependent on cell <code>A1</code>.</p>\n\n<p>So if user is selecting <code>A1</code> data as \"Animal\", the dropdown list of <code>B1</code> should be according to <code>A1</code>'s dropdown data like \"Dog, Cat, Rat, Lion\"</p>\n\n<p>Again if user is selecting <code>D1</code>, It should be according to selected data as <code>B1</code>.</p>\n\n<p>In excel I just selected the cells and go to data validation tab, then select type as list and applied formula like:</p>\n\n<pre><code>=indirect($A1)\n</code></pre>\n\n<p>And it is working fine for column <code>B1</code>.</p>\n\n<p>How can I apply it by C# code.?</p>\n\n<p>Please let me know If any sentence is not clear.</p>\n"}, {"tags": ["excel", "conditional-formatting", "vba"], "answers": [{"tags": [], "owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "is_accepted": false, "score": 0, "last_activity_date": 1453914137, "creation_date": 1453914137, "answer_id": 35043586, "question_id": 35043370, "link": "https://stackoverflow.com/questions/35043370/check-cell-formatting-in-excel/35043586#35043586", "title": "Check Cell Formatting in Excel", "body": "<p>You could use a = Right(Left(range(\"D3\").numberformat, 3), 1) to see what format it is in. Based on the string that it pulls, you will be able to find the currency symbol that is showing in the cell.</p>\n\n<p>You could also change the range to a dynamic variable to check any cell that you want.</p>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 2185540, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/eb73939e5ba2754b00d421a1208887d6?s=128&d=identicon&r=PG", "display_name": "Paul Hesketh", "link": "https://stackoverflow.com/users/2185540/paul-hesketh"}, "edited": false, "score": 0, "creation_date": 1453915806, "post_id": 35043715, "comment_id": 57812404, "body": "Hi Ralph, The test sheet is called &#39;Assessment&#39; does this need to be specified in the VBE code anywhere please"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 85, "user_id": 2185540, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/eb73939e5ba2754b00d421a1208887d6?s=128&d=identicon&r=PG", "display_name": "Paul Hesketh", "link": "https://stackoverflow.com/users/2185540/paul-hesketh"}, "edited": false, "score": 0, "creation_date": 1453915914, "post_id": 35043715, "comment_id": 57812477, "body": "No, just use the formula. Example: <code>=IsFormatted(Assesment!B1)</code>."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 1, "last_activity_date": 1453915423, "last_edit_date": 1453915423, "creation_date": 1453914568, "answer_id": 35043715, "question_id": 35043370, "link": "https://stackoverflow.com/questions/35043370/check-cell-formatting-in-excel/35043715#35043715", "title": "Check Cell Formatting in Excel", "body": "<p>Go into the VBE and add an empty module. Copy into that module the following code:</p>\n\n<pre><code>Option Explicit\n\nPublic Function IsFormatted(FormattedCell As Range) As Byte\n\nIsFormatted = 0\nIf InStr(1, FormattedCell.Cells(1, 1).NumberFormat, \"$\", vbTextCompare) &gt;= 1 Then IsFormatted = 1\n\nEnd Function\n</code></pre>\n\n<p>Then you have the function which you can use like this: <code>=IsFormatted(D2)</code>.</p>\n\n<p>Note: the generic number format for currencies is made with a $ sign and not a \u00a3. This translates automatically into UK currency based on your windows settings. If you want to make sure that people have set the format of the cell to UK \u00a3 then you need to change the following line in the above code:</p>\n\n<pre><code>If InStr(1, FormattedCell.Cells(1, 1).NumberFormat, \"[$\u00a3-809]\", vbTextCompare) &gt;= 1 Then IsFormatted = 1\n</code></pre>\n\n<p>Please keep in mind that the above function is not <code>volatile</code>. That means the value of the function will not change if the referenced cell is changed. In other words: if you check a cell like so <code>=IsFormatted(D2)</code> and we assume that this formula is in cell F2 then F2 will be 0 when D2 is not correctly formatted. Now, if you format D2 correctly then F2 will still display 0. So, you'll have to force-update the sheet with the functions with <code>F9</code> or you add <code>Application.Volatile</code> to the above function. Yet, this may significantly slow down your Excel. Look at the following article for more details: <a href=\"http://www.excel-easy.com/vba/examples/volatile-functions.html\" rel=\"nofollow\">http://www.excel-easy.com/vba/examples/volatile-functions.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1453915744, "post_id": 35043905, "comment_id": 57812358, "body": "Your solution does not seem to work on my computer. I get for <code>=CELL(&quot;format&quot;, SomeCell)</code> the return value <code>C2-</code>. Could it be that your solution requires a particular language code?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1453916149, "post_id": 35043905, "comment_id": 57812616, "body": "@Ralph <code>C2-</code> is accounting format. Are you testing that the &quot;candidate&quot; clicks the accounting format icon? If so, just change the format return type in the <code>If</code> statement. See <a href=\"https://support.office.com/en-us/article/CELL-function-51BD39A5-F338-4DBE-A33F-955D67C2B2CF\" rel=\"nofollow noreferrer\">CELL</a> for more information on the function."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1453916434, "post_id": 35043905, "comment_id": 57812821, "body": "Strange, I have <code>currency</code> selected and not <code>accounting</code>. Are they both the same? Also, the referenced cell is correctly formatted showing a <code>&#163;</code> but your solution returns <code>0</code>. Maybe I should note that UK is not my native language and therefore I had to select the <code>&#163;</code> sign explicitly in the number format drop-down (within currencies)."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1453916522, "post_id": 35043905, "comment_id": 57812887, "body": "@Ralph I just did a test. It shows <code>C2</code> when I format to <code>$</code> (native English), but <code>,2</code> when I choose any non-native currency. Maybe that helps you modify it a bit to get it to work for you? Also note that with <code>CELL</code> you need to recalc everytime to get it show the new format when a change occurs."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1453915083, "creation_date": 1453915083, "answer_id": 35043905, "question_id": 35043370, "link": "https://stackoverflow.com/questions/35043370/check-cell-formatting-in-excel/35043905#35043905", "title": "Check Cell Formatting in Excel", "body": "<p>You can do this without VBA and with just an Excel formula, however, there is a caveat that may, or may not, be important to you.</p>\n\n<p>Enter this formula in your scoring sheet.</p>\n\n<pre><code>=IF(LEFT(CELL(\"format\",testSheet!D2),1)=\",\",1,0)\n</code></pre>\n\n<ol>\n<li>testSheet is the candidate sheet</li>\n<li>the <code>CELL(\"format\",</code> argument returns <code>,[decimal places]</code> for currency formatted cells</li>\n<li>the <code>LEFT(...,1)</code> returns the first letter in the string for number 2</li>\n<li>the <code>IF</code> wrapper says if the first character of the format is <code>,</code> then 1, else 0.</li>\n<li>And here's the <strong>caveat</strong>, the format could be in <code>\u00a3</code> or <code>$</code> or any other symbol, so I don't know if that is necessary to test for or not.</li>\n</ol>\n\n<p>Lastly, you could modify this formula to test for 2 decimal places like so</p>\n\n<pre><code>=IF(LEFT(CELL(\"format\",testSheet!D2),2)=\",2\",1,0)\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 2185540, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/eb73939e5ba2754b00d421a1208887d6?s=128&d=identicon&r=PG", "display_name": "Paul Hesketh", "link": "https://stackoverflow.com/users/2185540/paul-hesketh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4388, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1453915423, "creation_date": 1453913576, "last_edit_date": 1531161705, "question_id": 35043370, "link": "https://stackoverflow.com/questions/35043370/check-cell-formatting-in-excel", "title": "Check Cell Formatting in Excel", "body": "<p>I'm trying to produce a simple Excel assessment and have come across a stumbling block.</p>\n\n<p>The 'Candidate' needs to correctly format a cell to 'Currency' so that it shows the \u00a3 sign in the cell.</p>\n\n<p>Is there a function that can check the presence of the '\u00a3' after the cell has been formatted </p>\n\n<p>The function bar only shows the value as a number without the \u00a3 sign</p>\n\n<p><a href=\"https://i.stack.imgur.com/Z51K4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z51K4.jpg\" alt=\"Function Bar Value\"></a></p>\n\n<p>On my scoring sheet, I give a value of '1' for correct answer and '0' for incorrect.</p>\n\n<p>I therefore could really use some advice to help me establish if the 'Candidate' correctly formats the cell</p>\n\n<p><a href=\"https://i.stack.imgur.com/zdf5t.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zdf5t.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Many thanks</p>\n\n<p>Paul</p>\n"}, {"tags": ["excel", "vba", "dropdown"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1453961652, "last_edit_date": 1453961652, "creation_date": 1453915646, "answer_id": 35044090, "question_id": 35043161, "link": "https://stackoverflow.com/questions/35043161/excel-multiple-selection-drop-down-list-no-duplication-of-selection/35044090#35044090", "title": "Excel - Multiple selection drop down list - no duplication of selection", "body": "<p>Try this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Const SEP As String = \", \"\n    Dim rngDV As Range\n    Dim oldVal As String\n    Dim newVal As String\n    Dim arr, m, v\n    If Target.Count &gt; 1 Then GoTo exitHandler\n\n    On Error Resume Next\n    Set rngDV = Target.SpecialCells(xlCellTypeSameValidation)\n    On Error GoTo exitHandler\n    If rngDV Is Nothing Then Exit Sub\n\n    newVal = Target.Value\n    If Len(newVal) = 0 Then Exit Sub 'user has cleared the cell...\n\n    Application.EnableEvents = False\n\n    Application.Undo\n    oldVal = Target.Value\n\n    If oldVal &lt;&gt; \"\" Then\n        arr = Split(oldVal, SEP)\n        m = Application.Match(newVal, arr, 0)\n        If IsError(m) Then\n            newVal = oldVal &amp; SEP &amp; newVal\n        Else\n            arr(m - 1) = \"\"\n            newVal = \"\"\n            For Each v In arr\n                If Len(v) &gt; 0 Then newVal = newVal &amp; IIf(Len(newVal) &gt; 0, SEP, \"\") &amp; v\n            Next v\n        End If\n        Target.Value = newVal\n    End If\n\nexitHandler:\n      Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 279, "user_id": 4202664, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f570061fdf58c1bc5e678bb4641b43b6?s=128&d=identicon&r=PG&f=1", "display_name": "user289040", "link": "https://stackoverflow.com/users/4202664/user289040"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1558, "favorite_count": 0, "accepted_answer_id": 35044090, "answer_count": 1, "score": 0, "last_activity_date": 1453961652, "creation_date": 1453913024, "last_edit_date": 1453913240, "question_id": 35043161, "link": "https://stackoverflow.com/questions/35043161/excel-multiple-selection-drop-down-list-no-duplication-of-selection", "title": "Excel - Multiple selection drop down list - no duplication of selection", "body": "<p>I have developed on my excel spreadsheet that multiple items can be selected in a drop down list using the following code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim rngDV As Range\nDim oldVal As String\nDim newVal As String\nIf Target.Count &gt; 1 Then GoTo exitHandler\n\nOn Error Resume Next\nSet rngDV = Cells.SpecialCells(xlCellTypeAllValidation)\nOn Error GoTo exitHandler\n\nIf rngDV Is Nothing Then GoTo exitHandler\n\nIf Intersect(Target, rngDV) Is Nothing Then\n\nElse\n  Application.EnableEvents = False\n  newVal = Target.Value\n  Application.Undo\n  oldVal = Target.Value\n  Target.Value = newVal\n    If oldVal = \"\" Then\n\n      Else\n      If newVal = \"\" Then\n\n      Else\n      Target.Value = oldVal _\n        &amp; \", \" &amp; newVal\n\n      End If\n    End If\nEnd If\n\n\nexitHandler:\n  Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>But, I want to now validate the answers that the drop down list items can only be selected once. And preferably, if the user selects that item again, that is it then removed.</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1453913411, "post_id": 35043137, "comment_id": 57810776, "body": "is this code inside of Excel itself or is it run inside of another office application?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1453913436, "post_id": 35043137, "comment_id": 57810787, "body": "Has <code>ActWS</code> been <b>Set</b> somewhere ??"}, {"owner": {"reputation": 123, "user_id": 5582853, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/481c633cd79437872c546e9df0bd8ee0?s=128&d=identicon&r=PG&f=1", "display_name": "Meursault", "link": "https://stackoverflow.com/users/5582853/meursault"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453913540, "post_id": 35043137, "comment_id": 57810866, "body": "@ScottHoltzman it is a part of excel file itself, as a sheet&#39;s private sub <code>Private Sub Worksheet_Activate()</code> (sheet is called ActWS, so the action suppose to happen inside this sheet when I activate it)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1453913734, "post_id": 35043137, "comment_id": 57811020, "body": "Is sheet <b>object</b> (inside the VBE) called <code>ActWs</code> or is the sheet <b>name</b> <code>ActWs</code>. If it&#39;s the name, or really regardless, using <code>Me.Shapes</code> will work either way. Me works because it is inside a worksheet level module."}, {"owner": {"reputation": 123, "user_id": 5582853, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/481c633cd79437872c546e9df0bd8ee0?s=128&d=identicon&r=PG&f=1", "display_name": "Meursault", "link": "https://stackoverflow.com/users/5582853/meursault"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453914596, "post_id": 35043137, "comment_id": 57811602, "body": "@ScottHoltzman unfortunately it gives the same error. Seems like I will have to get back to the older version of the file, that worked well"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1453915180, "post_id": 35043137, "comment_id": 57811983, "body": "this code should work, so take heed to what changes you made between files and resolve what is different that is causing the error."}, {"owner": {"reputation": 123, "user_id": 5582853, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/481c633cd79437872c546e9df0bd8ee0?s=128&d=identicon&r=PG&f=1", "display_name": "Meursault", "link": "https://stackoverflow.com/users/5582853/meursault"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453915482, "post_id": 35043137, "comment_id": 57812178, "body": "@ScottHoltzman Yes, that&#39;s what I&#39;ve started doing. But in general, my understanding of VBA tells me that specifically this error should not appear in the first place. Maybe some other one, but this... The code worked before. And even if it did not, the Shape type of variant do support this property... I am lost in the logic of VBA =)"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 5582853, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/481c633cd79437872c546e9df0bd8ee0?s=128&d=identicon&r=PG&f=1", "display_name": "Meursault", "link": "https://stackoverflow.com/users/5582853/meursault"}, "edited": false, "score": 0, "creation_date": 1453913864, "post_id": 35043338, "comment_id": 57811105, "body": "The code works. And my code worked before. However after my last update it does not"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 123, "user_id": 5582853, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/481c633cd79437872c546e9df0bd8ee0?s=128&d=identicon&r=PG&f=1", "display_name": "Meursault", "link": "https://stackoverflow.com/users/5582853/meursault"}, "edited": false, "score": 0, "creation_date": 1453914001, "post_id": 35043338, "comment_id": 57811197, "body": "I do not get it. If you exchange my code with yours, does it work? If yes -&gt; then probably the error was that you have not set correctly ActWS. If no -&gt; can you run it with my code and tell me what is the name of the last shape?"}, {"owner": {"reputation": 123, "user_id": 5582853, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/481c633cd79437872c546e9df0bd8ee0?s=128&d=identicon&r=PG&f=1", "display_name": "Meursault", "link": "https://stackoverflow.com/users/5582853/meursault"}, "edited": false, "score": 0, "creation_date": 1453914196, "post_id": 35043338, "comment_id": 57811326, "body": "Sheets are named correcty. Ok, I just noticed that my code crashes only in one case - when i switch from one specific sheet to ActWS. That sheet has private sub on deactivation, and ActWS has this piece of code that gives error in private sub on activation. By the way, your code gives <code>Shape.Name = &lt;object required&gt;</code>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1453913482, "creation_date": 1453913482, "answer_id": 35043338, "question_id": 35043137, "link": "https://stackoverflow.com/questions/35043137/error-when-deleting-shapes/35043338#35043338", "title": "Error when deleting SHAPES", "body": "<p>Your code works by me. Probably there is something with the shapes, that you are using. Can you run this:</p>\n\n<pre><code>Public Sub ale()\n\nDim Shp As Shape\n\nFor Each Shp In ActiveSheet.Shapes\n    If Shp.Type = msoAutoShape Then\n        Debug.Print Shp.Name\n        Shp.Delete\n    End If\nNext Shp\n\nEnd Sub\n</code></pre>\n\n<p>And share what is the last result from the Immediate window before the error comes? Also, can you confirm on which line of the new code the error comes?</p>\n"}], "owner": {"reputation": 123, "user_id": 5582853, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/481c633cd79437872c546e9df0bd8ee0?s=128&d=identicon&r=PG&f=1", "display_name": "Meursault", "link": "https://stackoverflow.com/users/5582853/meursault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453913482, "creation_date": 1453912961, "last_edit_date": 1453913412, "question_id": 35043137, "link": "https://stackoverflow.com/questions/35043137/error-when-deleting-shapes", "title": "Error when deleting SHAPES", "body": "<p>A piece of my code (to delete all shapes in the sheet) suddenly started to throw an error </p>\n\n<blockquote>\n  <p>\"Object does not support this property or method\"</p>\n</blockquote>\n\n<p>and highlights the row <code>If Shp.Type = msoAutoShape Then</code> This is a part of a big code I continuously update, but the code below is not a part of any cycle, IF, etc. What could be a reason?</p>\n\n<pre><code>Dim Shp As Shape\nFor Each Shp In ActWS.Shapes                                                        \n    If Shp.Type = msoAutoShape Then Shp.Delete\nNext Shp\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1453913966, "post_id": 35043106, "comment_id": 57811172, "body": "If you step through the code with the debugger, are the single quotes already present when setting fase1 and prod1?  And is there any intermediate code between the two fragments that alters fase1 and prod1 in any way?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453914350, "post_id": 35043106, "comment_id": 57811423, "body": "what variable type are <code>fase1</code> and <code>prod1</code>? They should be declared as <code>String</code>."}, {"owner": {"reputation": 83, "user_id": 5812498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431f0d12f1c68d3604b2964dbc4a498d?s=128&d=identicon&r=PG&f=1", "display_name": "mschlindwein", "link": "https://stackoverflow.com/users/5812498/mschlindwein"}, "edited": false, "score": 0, "creation_date": 1453914472, "post_id": 35043106, "comment_id": 57811498, "body": "The quotes are already present. Double quotes actually, I think my excel version (Portuguese) turns them into single quotes. There&#39;s no code between those lines. And both variables are declared as String. Can&#39;t figure out why that is happening."}, {"owner": {"reputation": 83, "user_id": 5812498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431f0d12f1c68d3604b2964dbc4a498d?s=128&d=identicon&r=PG&f=1", "display_name": "mschlindwein", "link": "https://stackoverflow.com/users/5812498/mschlindwein"}, "edited": false, "score": 0, "creation_date": 1453914544, "post_id": 35043106, "comment_id": 57811561, "body": "The whole line Range <code>(&quot;B3&quot;).Formula = &quot;=SUM((SUMIFS(ben_quant,ben_dia,R[-1]C,ben_fase, &quot; &amp; fase1 &amp; &quot;,ben_linha,&quot; &amp; prod1 &amp; &quot;)),(SUMIFS(ben_quant,ben_dia,R[-1]C,ben_fase,&quot; &amp; fase1 &amp; &quot;,ben_linha,&quot; &amp; prod2 &amp; &quot;)),(SUMIFS(ben_quant,ben_dia,R[-1]C,ben_fase,&quot; &amp; fase2 &amp; &quot;,ben_linha,&quot; &amp; prod1 &amp; &quot;)),(SUMIFS(ben_quant,ben_dia,R[-1]C,ben_fase,&quot; &amp; fase2 &amp; &quot;,ben_linha,&quot; &amp; prod2 &amp; &quot;)))&quot;</code>"}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1453914605, "post_id": 35043106, "comment_id": 57811608, "body": "@mschlindwein: To be paranoid, please Dim an extra String, and assign the formula you&#39;re building up to that string.  Then step through the code with the debugger and tell us if the formula-in-a-string also has those quotes."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1453915002, "post_id": 35043106, "comment_id": 57811863, "body": "It probably wont make a difference, but you could try just taking the address (without setting row and column absolute to false) and the use <code>Replace</code> to remove the dollar sign. You could also assign it all to a string and remove the single quotes with <code>Replace</code>."}, {"owner": {"reputation": 83, "user_id": 5812498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431f0d12f1c68d3604b2964dbc4a498d?s=128&d=identicon&r=PG&f=1", "display_name": "mschlindwein", "link": "https://stackoverflow.com/users/5812498/mschlindwein"}, "edited": false, "score": 0, "creation_date": 1453915271, "post_id": 35043106, "comment_id": 57812036, "body": "I created a msgBox with the string  and no quotes appeared this time. I don&#39;t know what to do with that though"}, {"owner": {"reputation": 83, "user_id": 5812498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431f0d12f1c68d3604b2964dbc4a498d?s=128&d=identicon&r=PG&f=1", "display_name": "mschlindwein", "link": "https://stackoverflow.com/users/5812498/mschlindwein"}, "edited": false, "score": 0, "creation_date": 1453915638, "post_id": 35043106, "comment_id": 57812292, "body": "I checked the debugger and the &quot;string formula&quot; has those quotes too."}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1453916293, "post_id": 35043106, "comment_id": 57812726, "body": "@mschlindwein: I&#39;ve added an &#39;answer&#39; with a code sample; could you test that and see what happens?  I&#39;m stumped actually by what&#39;s going on; the code in that sample works for me."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1453918973, "post_id": 35043106, "comment_id": 57814495, "body": "You are mixing R1C1 and A1 formula format in the offending line.  AFAIK, that is never valid."}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "reply_to_user": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1453919675, "post_id": 35043106, "comment_id": 57814950, "body": "@RBarryYoung: that was it; I added an R1C1 component to the code in my sample and all A1 style references got quoted - learned something new today!  I&#39;d say make it an answer."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1453920127, "post_id": 35043106, "comment_id": 57815234, "body": "OK, I have added it as an answer."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5812498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431f0d12f1c68d3604b2964dbc4a498d?s=128&d=identicon&r=PG&f=1", "display_name": "mschlindwein", "link": "https://stackoverflow.com/users/5812498/mschlindwein"}, "edited": false, "score": 0, "creation_date": 1453916709, "post_id": 35044306, "comment_id": 57813021, "body": "No, no! That is working fine, that&#39;d be my solution. I have added the complete part of the code on the OP."}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "reply_to_user": {"reputation": 83, "user_id": 5812498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431f0d12f1c68d3604b2964dbc4a498d?s=128&d=identicon&r=PG&f=1", "display_name": "mschlindwein", "link": "https://stackoverflow.com/users/5812498/mschlindwein"}, "edited": false, "score": 0, "creation_date": 1453916916, "post_id": 35044306, "comment_id": 57813180, "body": "If the code above works for you, but your own code you posted does not, then I&#39;m out of options since they use the exact same syntax?  Are you really sure there&#39;s no difference in my and your code set-up and/or did you thoroughly debug both code sets to check how they behave?"}, {"owner": {"reputation": 83, "user_id": 5812498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431f0d12f1c68d3604b2964dbc4a498d?s=128&d=identicon&r=PG&f=1", "display_name": "mschlindwein", "link": "https://stackoverflow.com/users/5812498/mschlindwein"}, "edited": false, "score": 0, "creation_date": 1453917418, "post_id": 35044306, "comment_id": 57813518, "body": "That&#39;s really weird because both our codes work the same way when I debug them. When I put them in the same module in my current worksheet, your code returns the correct value without quotes, while mine not. I&#39;ll keep trying to find a solution, asap I&#39;ll share it."}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "reply_to_user": {"reputation": 83, "user_id": 5812498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431f0d12f1c68d3604b2964dbc4a498d?s=128&d=identicon&r=PG&f=1", "display_name": "mschlindwein", "link": "https://stackoverflow.com/users/5812498/mschlindwein"}, "edited": false, "score": 0, "creation_date": 1453926760, "post_id": 35044306, "comment_id": 57819069, "body": "As RBarryYoung suggested, it&#39;s caused by mixing R1C1 style referencing with A1 type referencing; see his newer answer for the details."}], "tags": [], "owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "is_accepted": false, "score": 1, "last_activity_date": 1453916241, "creation_date": 1453916241, "answer_id": 35044306, "question_id": 35043106, "link": "https://stackoverflow.com/questions/35043106/variables-inside-formulas-appearing-with-quotes/35044306#35044306", "title": "Variables inside formulas appearing with quotes", "body": "<p>Your code looks OK to me...  Could you start a fresh Excel workbook, go to the VBA editor, and paste the following code in a new module?</p>\n\n<pre><code>Sub x()\n  Dim cellAddress As String\n  cellAddress = Cells(1, 1).Address(RowAbsolute:=False, ColumnAbsolute:=False)\n  Dim formula As String\n  formula = \"=SUMIFS(B1:B4,C1:C4,\" &amp; cellAddress &amp; \")\"\n  Call MsgBox(formula)\n  Range(\"A2\").formula = formula\nEnd Sub\n</code></pre>\n\n<p>After this, run it and tell us if the prompt shows any quotes in the formula, and tell us what's in cell A2 afterwards.</p>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 5812498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431f0d12f1c68d3604b2964dbc4a498d?s=128&d=identicon&r=PG&f=1", "display_name": "mschlindwein", "link": "https://stackoverflow.com/users/5812498/mschlindwein"}, "edited": false, "score": 0, "creation_date": 1453918962, "post_id": 35044863, "comment_id": 57814488, "body": "That is working! I think the problem was with the SUM((SUMIFS formula. I tried using just SUMIF or just SUM and it was working. Thanks"}], "tags": [], "owner": {"reputation": 36, "user_id": 5802862, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o2cFBaJGA9Q/AAAAAAAAAAI/AAAAAAAAAcQ/vU_1SfphI4s/photo.jpg?sz=128", "display_name": "Xavier Navarro", "link": "https://stackoverflow.com/users/5802862/xavier-navarro"}, "is_accepted": false, "score": 1, "last_activity_date": 1453918058, "creation_date": 1453918058, "answer_id": 35044863, "question_id": 35043106, "link": "https://stackoverflow.com/questions/35043106/variables-inside-formulas-appearing-with-quotes/35044863#35044863", "title": "Variables inside formulas appearing with quotes", "body": "<p>I'd simply replace the quotes with nothing:</p>\n\n<pre><code>Range(\"B3\").Formula = \"=SUM((SUMIFS(ben_quant,ben_dia,R[-1]C,ben_fase,\" &amp; fase1 &amp; \",ben_linha,\" &amp; prod1 &amp; \")),(SUMIFS(ben_quant,ben_dia,R[-1]C,ben_fase,\" &amp; fase1 &amp; \",ben_linha,\" &amp; prod2 &amp; \")),(SUMIFS(ben_quant,ben_dia,R[-1]C,ben_fase,\" &amp; fase2 &amp; \",ben_linha,\" &amp; prod1 &amp; \")),(SUMIFS(ben_quant,ben_dia,R[-1]C,ben_fase,\" &amp; fase2 &amp; \",ben_linha,\" &amp; prod2 &amp; \")))\"\nRange(\"B3\").Formula = Replace(Range(\"B3\").Formula, \"'\", \"\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "is_accepted": true, "score": 5, "last_activity_date": 1453920095, "creation_date": 1453920095, "answer_id": 35045483, "question_id": 35043106, "link": "https://stackoverflow.com/questions/35043106/variables-inside-formulas-appearing-with-quotes/35045483#35045483", "title": "Variables inside formulas appearing with quotes", "body": "<p>If I read you correctly, this VBA line:</p>\n\n<pre><code>Range(\"B3\").Formula = \"=SUM((SUMIFS(ben_quant,ben_dia,R[-1]C,ben_fase, \" &amp; fase1 &amp; \",ben_linha,\" &amp; prod1 &amp; \"))\"\n</code></pre>\n\n<p>Is trying to set this formula expression:</p>\n\n<pre><code>=SUM((SUMIFS(ben_quant,ben_dia,R[-1]C,ben_fase, AG2,ben_linha,AG4))\n</code></pre>\n\n<p>However, this is mixing R1C1 and A1 cell addressing in the same formula.  As far as I know, that is always invalid syntax.</p>\n"}], "owner": {"reputation": 83, "user_id": 5812498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431f0d12f1c68d3604b2964dbc4a498d?s=128&d=identicon&r=PG&f=1", "display_name": "mschlindwein", "link": "https://stackoverflow.com/users/5812498/mschlindwein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "accepted_answer_id": 35045483, "answer_count": 3, "score": 2, "last_activity_date": 1453920095, "creation_date": 1453912884, "last_edit_date": 1453916666, "question_id": 35043106, "link": "https://stackoverflow.com/questions/35043106/variables-inside-formulas-appearing-with-quotes", "title": "Variables inside formulas appearing with quotes", "body": "<p>I am trying to insert 2 variables into a formula. Altough they are appearing inside quotes.</p>\n\n<pre><code>fase1 = Cells(2, diffdate_ac + 4).Address(RowAbsolute:=False, ColumnAbsolute:=False)\nprod1 = Cells(4, diffdate_ac + 4).Address(RowAbsolute:=False, ColumnAbsolute:=False)\n</code></pre>\n\n<p>Fase1 refers to AG2 and Prod1 to AG4.</p>\n\n<pre><code>Range(\"B3\").Formula = \"=SUM((SUMIFS(ben_quant,ben_dia,R[-1]C,ben_fase, \" &amp; fase1 &amp; \",ben_linha,\" &amp; prod1 &amp; \"))\n</code></pre>\n\n<p>It is part of the formula. \" &amp; fase 1 &amp; \" is giving me 'AG2', and \" &amp; prod 1 &amp; \" is returning 'AG4'. Yes, they are both inside quotes inside the formula as the image shows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gB2PY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gB2PY.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I want to remove those single quotes, because that way the formula is not referring to those cells.</p>\n\n<p>The complete part of the code of this command</p>\n\n<pre><code>'Prints an array of dates\nDim startac2 As Long, finishac2 As Long\nDim datearray3 As Variant, y As Long\n\nfinishac2 = CLng(DateValue(lastac))\nstartac2 = CLng(DateValue(firstac))\n    ReDim datearray3(finishac2 - startac2 + 1)\n\n    For y = 0 To finishac2 - startac2\n        datearray3(y) = startac2 + y\n    Next\n\ndiffdate_ac = DateDiff(\"d\", startac2, finishac2) + 1\n\nwsPBen.Activate\nRange(Cells(2, 2), Cells(2, diffdate_ac + 1)).Value = datearray3\nRange(Cells(2, 2), Cells(2, diffdate_ac + 1)).NumberFormat = \"d/m;@\"\n'\n\nRange(\"A1\").Value = \"BENEFICIAMENTO: TINTURARIA LISO\"\nRange(\"A2\").Value = \"Data\"\nRange(\"A3\").Value = \"Produ\u00e7\u00e3o\"\nCells(2, diffdate_ac + 2).Value = \"TOTAL\"\nCells(2, diffdate_ac + 3).Value = \"FASE\"\nCells(4, diffdate_ac + 3).Value = \"PRODUTO\"\nCells(2, diffdate_ac + 4).Value = \"TINGIR ALTA TEMP.\"\nCells(3, diffdate_ac + 4).Value = \"TINGIR BAIXA TEMP.\"\nCells(4, diffdate_ac + 4).Value = \"TINTO RAMADO\"\nCells(5, diffdate_ac + 4).Value = \"TINTO TUBULAR\"\n\n\nDim fase1 As String\nDim fase2 As String\nDim prod1 As String\nDim prod2 As String\n\nfase1 = Cells(2, diffdate_ac + 4).Address(RowAbsolute:=False, ColumnAbsolute:=False)\nfase2 = Cells(3, diffdate_ac + 4).Address(RowAbsolute:=False, ColumnAbsolute:=False)\nprod1 = Cells(4, diffdate_ac + 4).Address(RowAbsolute:=False, ColumnAbsolute:=False)\nprod2 = Cells(5, diffdate_ac + 4).Address(RowAbsolute:=False, ColumnAbsolute:=False)\n\n\nRange(\"B3\").formula = \"=SUM((SUMIFS(ben_quant,ben_dia,R[-1]C,ben_fase,\" &amp; fase1 &amp; \",ben_linha,\" &amp; prod1 &amp; \")),(SUMIFS(ben_quant,ben_dia,R[-1]C,ben_fase,\" &amp; fase1 &amp; \",ben_linha,\" &amp; prod2 &amp; \")),(SUMIFS(ben_quant,ben_dia,R[-1]C,ben_fase,\" &amp; fase2 &amp; \",ben_linha,\" &amp; prod1 &amp; \")),(SUMIFS(ben_quant,ben_dia,R[-1]C,ben_fase,\" &amp; fase2 &amp; \",ben_linha,\" &amp; prod2 &amp; \")))\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1453913038, "post_id": 35042892, "comment_id": 57810471, "body": "Can you clarify a little on what you want to compare? Do you want to compare each cell in a column, to the same row in another column? Or do you want to see if the ENTIRE column is the same as the other?"}, {"owner": {"reputation": 43, "user_id": 5836742, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e0663fa0d3d4b7ca71ca3e00155561de?s=128&d=identicon&r=PG&f=1", "display_name": "user5836742", "link": "https://stackoverflow.com/users/5836742/user5836742"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1453913503, "post_id": 35042892, "comment_id": 57810840, "body": "Well, ideally both. At the moment with the code above I am able to highlight a few cells and compare them to another few cells. Or I am also able to compare two whole columns. I am using this tool to clarify an upload has been successful, so the user would input all the data they want to upload into one column, then after the upload the page refreshes, and then in the other column the updated values can be seen."}, {"owner": {"reputation": 43, "user_id": 5836742, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e0663fa0d3d4b7ca71ca3e00155561de?s=128&d=identicon&r=PG&f=1", "display_name": "user5836742", "link": "https://stackoverflow.com/users/5836742/user5836742"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1453913670, "post_id": 35042892, "comment_id": 57810971, "body": "-- don&#39;t know if I&#39;m explaining it well. but essentially, as I am using 10000s of cells, I want to be able to use a tool to highlight all the same values in two columns, that way the user can quickly see if all the data is correct and the two columns match."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5836742, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e0663fa0d3d4b7ca71ca3e00155561de?s=128&d=identicon&r=PG&f=1", "display_name": "user5836742", "link": "https://stackoverflow.com/users/5836742/user5836742"}, "edited": false, "score": 0, "creation_date": 1453976173, "post_id": 35043513, "comment_id": 57840252, "body": "Thanks, The first one was helpful...not sure what you mean by your second point (pretty new to it all)"}, {"owner": {"reputation": 56, "user_id": 5847806, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1WCUe.jpg?s=128&g=1", "display_name": "zfdn.cat", "link": "https://stackoverflow.com/users/5847806/zfdn-cat"}, "reply_to_user": {"reputation": 43, "user_id": 5836742, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e0663fa0d3d4b7ca71ca3e00155561de?s=128&d=identicon&r=PG&f=1", "display_name": "user5836742", "link": "https://stackoverflow.com/users/5836742/user5836742"}, "edited": false, "score": 0, "creation_date": 1453976920, "post_id": 35043513, "comment_id": 57840749, "body": "What i meant is to define variables to store information that you use often, the same way you defined the ranges or the <code>intCellcounter</code>. Something in these lines. <code>Dim rowsCol1 as Long</code> <code>rowsCol1 = Column1.Rows.Count </code> It won&#39;t make a change in this snippet, but it&#39;s good practice :)"}], "tags": [], "owner": {"reputation": 56, "user_id": 5847806, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1WCUe.jpg?s=128&g=1", "display_name": "zfdn.cat", "link": "https://stackoverflow.com/users/5847806/zfdn-cat"}, "is_accepted": false, "score": 2, "last_activity_date": 1453913917, "creation_date": 1453913917, "answer_id": 35043513, "question_id": 35042892, "link": "https://stackoverflow.com/questions/35042892/comparing-two-columns-on-excel-vba/35043513#35043513", "title": "Comparing two columns on Excel VBA", "body": "<p>I may suggest a couple of tweaks that could help. </p>\n\n<ol>\n<li><p>Disable the screen update while the comparison loop is running. You can do this with: </p>\n\n<pre>Application.ScreenUpdating = False \n'Your loop here'\nApplication.ScreenUpdating = True</pre></li>\n<li><p>Use variables for the expressions that repeat through the code, like <pre>Column1.Rows.Count</pre></p></li>\n</ol>\n\n<p>I haven't test it, but it should be pretty fast to check it out ;)</p>\n"}, {"tags": [], "owner": {"reputation": 727, "user_id": 4921888, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a408de400a095098d88d92c6af5d6fa5?s=128&d=identicon&r=PG&f=1", "display_name": "dslosky", "link": "https://stackoverflow.com/users/4921888/dslosky"}, "is_accepted": false, "score": 0, "last_activity_date": 1453918093, "creation_date": 1453918093, "answer_id": 35044874, "question_id": 35042892, "link": "https://stackoverflow.com/questions/35042892/comparing-two-columns-on-excel-vba/35044874#35044874", "title": "Comparing two columns on Excel VBA", "body": "<p>Screen updating is a huge CPU suck, especially when you're changing the colors of cells. So @zfdn.cat's answer will definitely help you out. </p>\n\n<p>Another thought, though: If many of your 10000s of rows are having their color changed, you'll also see a performance increase by keeping track of which cells need to change color, and setting the color of these cells once your loop is finished.</p>\n\n<p>Something like...</p>\n\n<pre><code>Dim range_string as String\nrange_string = \"\"\n\nDim intCell As Long\nFor intCell = 1 To Column1.Rows.Count\n    If Column1.Cells(intCell) = Column2.Cells(intCell) Then\n\n        ' check if the range_string is empty\n        ' if not, we'll add a comma to separate the next and previous points\n        if range_string &lt;&gt; \"\" Then\n            range_string = range_string &amp; \",\"\n        end if\n\n        range_string = range_string &amp; _\n           Column1.Cells(intCell).Address &amp; \":\" &amp;_\n           Column1.Cells(intCell).Address &amp; \",\" &amp; _\n           Column2.Cells(intCell).Address &amp; \":\" &amp;_\n           Column2.Cells(intCell).Address\n\n    End If\nNext\n\n' Change the color of all the cells at once\nRange(range_string).Interior.Color = vbYellow\n</code></pre>\n\n<p>I haven't tested the code, but the algorithm is solid... I think</p>\n"}, {"tags": [], "owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "is_accepted": false, "score": 0, "last_activity_date": 1453924309, "creation_date": 1453924309, "answer_id": 35046776, "question_id": 35042892, "link": "https://stackoverflow.com/questions/35042892/comparing-two-columns-on-excel-vba/35046776#35046776", "title": "Comparing two columns on Excel VBA", "body": "<p>You can try this (100'000 rows in 13,46 seconds):</p>\n\n<pre><code> Sub Main()\n\n    Dim Col1 As Range\n    Dim Col2 As Range\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim i As Long\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Sheets(\"Sheet1\") ' Change the name of your Sheet\n\n\n    Set Col1 = Application.InputBox(\"Select First Column to Compare\", Type:=8)\n    Set Col2 = Application.InputBox(\"Select First Column to Compare\", Type:=8)\n\nApplication.ScreenUpdating = False\n\nWith ws\ni = 1\nDo While Not IsEmpty(.Cells(i, Col1.Column))\n\n                If .Cells(i, Col1.Column) = .Cells(i, Col2.Column) Then\n                    .Cells(i, Col1.Column).Interior.Color = vbYellow\n                    .Cells(i, Col2.Column).Interior.Color = vbYellow\n                End If\n        i = i + 1\nLoop\n\nEnd With\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5836742, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e0663fa0d3d4b7ca71ca3e00155561de?s=128&d=identicon&r=PG&f=1", "display_name": "user5836742", "link": "https://stackoverflow.com/users/5836742/user5836742"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 847, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1453924309, "creation_date": 1453912322, "last_edit_date": 1453912996, "question_id": 35042892, "link": "https://stackoverflow.com/questions/35042892/comparing-two-columns-on-excel-vba", "title": "Comparing two columns on Excel VBA", "body": "<p>I'm looking to compare two columns in excel using VBA. I'm using the below code, but its taking ages because there are thousands of cells. I'm looking to put a maximum limit but don't know how/where to apply that. I also don't know if anyone knows of a more efficient way of doing this code?</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim Column1 As Range\nDim Column2 As Range\n\n'Prompt user for the first column range to compare...\nSet Column1 = Application.InputBox(\"Select First Column to Compare\", Type:=8)\n\n'Check that the range they have provided consists of only 1 column...\nIf Column1.Columns.Count &gt; 1 Then\n    Do Until Column1.Columns.Count = 1\n        MsgBox \"You can only select 1 column\"\n        Set Column1 = Application.InputBox(\"Select First Column to Compare\", Type:=8)\n    Loop\nEnd If\n\n'Prompt user for the second column range to compare...\nSet Column2 = Application.InputBox(\"Select Second Column to Compare\", Type:=8)\n\n'Check that the range they have provided consists of only 1 column...\nIf Column2.Columns.Count &gt; 1 Then\n    Do Until Column2.Columns.Count = 1\n        MsgBox \"You can only select 1 column\"\n        Set Column2 = Application.InputBox(\"Select Second Column to Compare\", Type:=8)\n    Loop\nEnd If\n\n'Check both column ranges are the same size...\nIf Column2.Rows.Count &lt;&gt; Column1.Rows.Count Then\n    Do Until Column2.Rows.Count = Column1.Rows.Count\n        MsgBox \"The second column must be the same size as the first\"\n        Set Column2 = Application.InputBox(\"Select Second Column to Compare\", Type:=8)\n    Loop\nEnd If\n\n'If entire columns have been selected, limit the range sizes\nIf Column1.Rows.Count = 11600 Then\n    Set Column1 = Range(Column1.Cells(1), Column1.Cells(ActiveSheet.UsedRange.Rows.Count))\n    Set Column2 = Range(Column2.Cells(1), Column2.Cells(ActiveSheet.UsedRange.Rows.Count))\nEnd If\n\n'Perform the comparison and set cells that are the same to yellow\nDim intCell As Long\nFor intCell = 1 To Column1.Rows.Count\n    If Column1.Cells(intCell) = Column2.Cells(intCell) Then\n        Column1.Cells(intCell).Interior.Color = vbYellow\n        Column2.Cells(intCell).Interior.Color = vbYellow\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "edited": false, "score": 1, "creation_date": 1453914264, "post_id": 35042854, "comment_id": 57811370, "body": "It&#39;s always good practice to avoid using certain unreliable functions such as <code>.select</code> and <code>.copy</code>/<code>.paste</code>. I&#39;d advise looking up alternative methods and rewriting your code. Also have a look at the tour and read up on how to ask a good question. <a href=\"http://stackoverflow.com/tour\">stackoverflow.com/tour</a>"}, {"owner": {"reputation": 3, "user_id": 5847803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/232cd205f70f7fa36d98357f3a9a9e6b?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari Jagannath", "link": "https://stackoverflow.com/users/5847803/srihari-jagannath"}, "reply_to_user": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "edited": false, "score": 0, "creation_date": 1453919120, "post_id": 35042854, "comment_id": 57814604, "body": "Hi Josh,Thanks for the tip. I shall practice what you have suggested in the future"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5847803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/232cd205f70f7fa36d98357f3a9a9e6b?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari Jagannath", "link": "https://stackoverflow.com/users/5847803/srihari-jagannath"}, "edited": false, "score": 0, "creation_date": 1453985059, "post_id": 35057322, "comment_id": 57846338, "body": "Hi Josh,I understand my knowledge of VBA is at its very basic now that I see your code. Your&#39;s looks more structured and easier to understand and edit. Thank you for taking your time out and helping me out in this en-devour."}, {"owner": {"reputation": 3, "user_id": 5847803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/232cd205f70f7fa36d98357f3a9a9e6b?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari Jagannath", "link": "https://stackoverflow.com/users/5847803/srihari-jagannath"}, "edited": false, "score": 0, "creation_date": 1453985732, "post_id": 35057322, "comment_id": 57846846, "body": "I would like to know why you have given D13, N13 etc in Range? I am getting a #Ref error in the D4 range in the new sheet.  Reswt of the code works flawlessly"}, {"owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "reply_to_user": {"reputation": 3, "user_id": 5847803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/232cd205f70f7fa36d98357f3a9a9e6b?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari Jagannath", "link": "https://stackoverflow.com/users/5847803/srihari-jagannath"}, "edited": false, "score": 0, "creation_date": 1453988537, "post_id": 35057322, "comment_id": 57848832, "body": "I just picked out the ranges you had selected in your code, is the code putting a formula in D4? If so, it might be the way the formula was made to work originally. For example, if the formula says &quot;Sum of A1 and B1&quot; and you then moved it to a new sheet where there wasn&#39;t a value in B1, you would get an error."}, {"owner": {"reputation": 3, "user_id": 5847803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/232cd205f70f7fa36d98357f3a9a9e6b?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari Jagannath", "link": "https://stackoverflow.com/users/5847803/srihari-jagannath"}, "edited": false, "score": 0, "creation_date": 1453989537, "post_id": 35057322, "comment_id": 57849625, "body": "Thanks Josh. Figured it out. Minor changes were required. Its reduced my work to a good extent. Also, do you know of any VBA tutorials or courses that I can go through to improve my VBA skills?"}, {"owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "reply_to_user": {"reputation": 3, "user_id": 5847803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/232cd205f70f7fa36d98357f3a9a9e6b?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari Jagannath", "link": "https://stackoverflow.com/users/5847803/srihari-jagannath"}, "edited": false, "score": 0, "creation_date": 1453990047, "post_id": 35057322, "comment_id": 57850008, "body": "Unfortunately, since VBA has a sort of built in UI (Excel), it&#39;s quite tricky. The best way to learn any language is with practice, things like this :) Maybe find a good book to teach you the fundamentals, but nothing beats doing things you don&#39;t know how to do."}], "tags": [], "owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "is_accepted": true, "score": 0, "last_activity_date": 1453972666, "creation_date": 1453972666, "answer_id": 35057322, "question_id": 35042854, "link": "https://stackoverflow.com/questions/35042854/error-copying-data-to-new-excel-sheet-using-a-macro/35057322#35057322", "title": "Error copying data to new Excel sheet using a Macro", "body": "<p>Just incase you haven't solved this already, take a look at the code I've adapted for you. When making new VBA projects, play around with some of these methods, you'll find they're a lot faster and more reliable than your previous version. Compare them side by side.</p>\n\n<p>This took a lot of assumption on my part so make a backup before running this to test it and make sure everything is going to the right place.</p>\n\n<pre><code>Sub Macro7()\n\n    Sheets.Add After:=Sheets(Sheets.Count)\n    NewSheet = ActiveSheet.Name\n    Sheets(\"Template\").Rows(\"1:3\").Copy Destination:=ActiveSheet.Range(\"A1\")\n\n    Sheets(\"Sheet1\").Activate\n    Range(\"N13\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy Destination:=Sheets(NewSheet).Range(\"D4\")\n\n    With Sheets(NewSheet)\n        Columns(\"D:D\").EntireColumn.AutoFit\n    End With\n\n    Range(\"A13\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy Destination:=Sheets(NewSheet).Range(\"C4\")\n\n    Range(\"D13\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy Destination:=Sheets(NewSheet).Range(\"E4\")\n\n    Range(\"B13\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy Destination:=Sheets(NewSheet).Range(\"F4\")\n\n    Range(\"H13\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy Destination:=Sheets(NewSheet).Range(\"G4\")\n\n    Range(\"F13\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy Destination:=Sheets(NewSheet).Range(\"I4\")\n\n    Sheets(NewSheet).Activate\n    Range(\"A4\").Value = \"Fives Cinetic Corp\"\n    Columns(\"A:A\").AutoFit\n    Range(\"A4\").AutoFill Destination:=Range(\"A4:A5\")\n    Range(\"D10\").Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5847803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/232cd205f70f7fa36d98357f3a9a9e6b?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari Jagannath", "link": "https://stackoverflow.com/users/5847803/srihari-jagannath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 35057322, "answer_count": 1, "score": 0, "last_activity_date": 1453972666, "creation_date": 1453912227, "last_edit_date": 1531161705, "question_id": 35042854, "link": "https://stackoverflow.com/questions/35042854/error-copying-data-to-new-excel-sheet-using-a-macro", "title": "Error copying data to new Excel sheet using a Macro", "body": "<p>This is my first post here.</p>\n\n<p>I am trying to copy data from one sheet to a new sheet in the same workbook after filtering in the main sheet.</p>\n\n<p>I also have to copy the sheet template from a template sheet onto this new sheet where I am copying the data to before I copy the data.</p>\n\n<p>This is the VBA code shown in my macro:</p>\n\n<pre><code>Sub Macro7()\n'\n' Macro7 Macro\n'\n\n'\n    Sheets(\"Template\").Select\n    Rows(\"1:3\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Dim sSheetName As String\n    Sheets.Add After:=Sheets(Sheets.Count)\n    sSheetName = ActiveSheet.Name\n\n    ActiveSheet.Paste\n    Sheets(\"Sheet1\").Select\n    Range(\"N13\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"sSheetName\").Select\n    Range(\"D4\").Select\n    ActiveSheet.Paste\n    Columns(\"D:D\").EntireColumn.AutoFit\n    Sheets(\"Sheet1\").Select\n    Range(\"A13\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"sSheetName\").Select\n    Range(\"C4\").Select\n    ActiveSheet.Paste\n    Sheets(\"Sheet1\").Select\n    Range(\"D13\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"sSheetName\").Select\n    Range(\"E4\").Select\n    ActiveSheet.Paste\n    Sheets(\"Sheet1\").Select\n    Range(\"B13\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"sSheetName\").Select\n    Range(\"F4\").Select\n    ActiveSheet.Paste\n    Sheets(\"Sheet1\").Select\n    Range(\"H13\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"sSheetName\").Select\n    Range(\"G4\").Select\n    ActiveSheet.Paste\n    Sheets(\"Sheet1\").Select\n    Range(\"F13\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"sSheetName\").Select\n    Range(\"I4\").Select\n    ActiveSheet.Paste\n    Range(\"A4\").Select\n    Application.CutCopyMode = False\n    ActiveCell.FormulaR1C1 = \"Fives Cinetic Corp\"\n    Columns(\"B:B\").Select\n    Columns(\"A:A\").ColumnWidth = 17.57\n    Range(\"A4\").Select\n    Selection.AutoFill Destination:=Range(\"A4:A5\")\n    Range(\"A4:A5\").Select\n    Range(\"D10\").Select\nEnd Sub\n</code></pre>\n\n<p>I get an error: Run-time Error 9:  Subscript out of range </p>\n\n<p>Guess its something to do with sheet numbers but not able to figure it out exactly what it is.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 5847773, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/882c4b60b5539b38bd6313f59a86622c?s=128&d=identicon&r=PG&f=1", "display_name": "broncos15", "link": "https://stackoverflow.com/users/5847773/broncos15"}, "edited": false, "score": 0, "creation_date": 1453913270, "post_id": 35042937, "comment_id": 57810660, "body": "JNevill, that worked perfectly. Thank you, I knew it just had something to do with my logic in the code. Thank you so much for the help!"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 2, "last_activity_date": 1453924413, "last_edit_date": 1453924413, "creation_date": 1453912452, "answer_id": 35042937, "question_id": 35042717, "link": "https://stackoverflow.com/questions/35042717/excel-vba-delete-rows/35042937#35042937", "title": "Excel VBA Delete Rows", "body": "<p>This is a common problem when deleting rows. Imagine you are moving through your for loop one row at a time and deleting:</p>\n\n<pre><code>For cnt = 7 To dlt\n    Rows(cnt).EntireRow.Delete\n    cnt = cnt + 1\nNext \n</code></pre>\n\n<p>You are on row 7 and you delete it. This shifts all of your rows up. Row 8 is now Row 7. You then increase your <code>cnt</code> variable by 1 (to 8) and delete row 8. But you missed row 7, which was row 8... it's crazy bananas.</p>\n\n<p>Instead, change your for loop to work backwards:</p>\n\n<pre><code>For cnt = dlt to 7 step -1\n    Rows(cnt).EntireRow.Delete\n    cnt = cnt - 1\nNext    \n</code></pre>\n\n<p>This way the row shifting doesn't affect your <code>cnt</code>. </p>\n"}], "owner": {"reputation": 59, "user_id": 5847773, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/882c4b60b5539b38bd6313f59a86622c?s=128&d=identicon&r=PG&f=1", "display_name": "broncos15", "link": "https://stackoverflow.com/users/5847773/broncos15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 1, "accepted_answer_id": 35042937, "answer_count": 1, "score": 1, "last_activity_date": 1463014721, "creation_date": 1453911865, "last_edit_date": 1459772161, "question_id": 35042717, "link": "https://stackoverflow.com/questions/35042717/excel-vba-delete-rows", "title": "Excel VBA Delete Rows", "body": "<p>I am trying to create a program that will delete or create rows based on what a user puts in a certain row. For example, if the user puts in 3, but there are only 2 rows, then it will insert 1 row. If there were 5 rows, it would delete rows 4 and 5. It seems like it should be an easy code, but I am having the hardest time having it actually delete/create the rows that I want it to. My code is as follows:</p>\n\n<pre><code>Sheets(\"Summary\").Select\n\nx = Cells(29, 3).Value\ni = 7\n\nSheets(\"Weighted I\").Select\n\nDo Until Cells(i, 1).Value = \"TOTAL\"\n    i = i + 1\nLoop\n\ni = i - 7\nIf i &gt; x Then   \n    dlt = i - x + 7\n\n    For cnt = 7 To dlt\n        Rows(cnt).EntireRow.Delete\n        cnt = cnt + 1\n    Next    \nElseIf i &lt; x Then\n    crt = x - i + 7\n\n    For cnt = 7 To dlt\n        Rows(cnt).EntireRow.Insert\n        cnt = cnt + 1\n    Next\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "pdf", "ms-word"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1453911219, "post_id": 35042260, "comment_id": 57809197, "body": "You&#39;ll need to identify the table.  You can then get the text from the table and store it in a variable.  Then make your SaveAs command using the variable as your file name."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 3, "creation_date": 1453913691, "post_id": 35042260, "comment_id": 57810982, "body": "Your question as written is too broad. Break it into separate tasks, and start figuring out the tasks individually. First figure out how to select the table and retrieve the text from the cells. Then add string handling (retrieving the filename without extension, concatenating the text from the table, and then concatenating the .pdf extension). Then add saving a file from VBA code. Recording a macro in Word itself will do the majority of the work for you."}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1453981785, "post_id": 35042260, "comment_id": 57844011, "body": "You know you could work with formfields or bookmarks which you could set into your table to retrieve data faster."}], "owner": {"reputation": 19, "user_id": 5847455, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Tvn9l2saruo/AAAAAAAAAAI/AAAAAAAAEKQ/yTFb5hoilzA/photo.jpg?sz=128", "display_name": "Ed C", "link": "https://stackoverflow.com/users/5847455/ed-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 289, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1453913447, "creation_date": 1453910719, "last_edit_date": 1453913447, "question_id": 35042260, "link": "https://stackoverflow.com/questions/35042260/looking-to-save-word-document-as-pdf-with-text-from-document-as-the-file-name", "title": "Looking to save word document as PDF with text from document as the file name", "body": "<p>There are hundreds of contracts in .doc format that I need to save as pdf.</p>\n\n<p>I am hoping to use a macro to quickly save the document as pdf using the first and last name of the person who the document was addressed to [always 2nd line of 'table' that is 1x1 -so the entire length of document]</p>\n\n<p>So I think the logic would go:</p>\n\n<ol>\n<li>Move Cursor to correct location</li>\n<li>Select 2 words to right [i.e. first &amp; last name]</li>\n<li>Copy those words</li>\n<li>Some how concatenate those words at the end of the desired filepath of a Save As statement, but before the .pdf file extension.</li>\n</ol>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453910893, "post_id": 35042189, "comment_id": 57808973, "body": "You can export the code modules and import them, this relies on access to the VBA project though, something that may not be possible.  Is a shared WB solution not a possibility?"}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453911662, "post_id": 35042189, "comment_id": 57809512, "body": "Most of our macros are user forms, but there are a few that are workbooks, but they are all separate due to the information we are working with."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1453912030, "post_id": 35042189, "comment_id": 57809761, "body": "Do you have your own personal macros? Or rather you all use common macros that everyone in network has?"}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1453912082, "post_id": 35042189, "comment_id": 57809794, "body": "Common macros for the most part, there are a few that have personal macros due to their situation. But the majority are all the same."}, {"owner": {"reputation": 178, "user_id": 5744945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aDOkW.jpg?s=128&g=1", "display_name": "Snachmo", "link": "https://stackoverflow.com/users/5744945/snachmo"}, "edited": false, "score": 2, "creation_date": 1453912596, "post_id": 35042189, "comment_id": 57810167, "body": "We use an Excel add-in for this.  Set the .xlam read-only and do <i>not</i> &quot;copy to folder&quot; when adding to Excel.  This way everyone loads the same read-only copy of the addin from the network when they open Excel.  Updates involve either replacing the .xlam on the network or using a &#39;deploy&#39; macro (set read/write&gt;set isaddon=false&gt;save new copy&gt;set isaddon=true&gt;set read-only).  Let me know if you&#39;d like more detail."}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "reply_to_user": {"reputation": 178, "user_id": 5744945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aDOkW.jpg?s=128&g=1", "display_name": "Snachmo", "link": "https://stackoverflow.com/users/5744945/snachmo"}, "edited": false, "score": 0, "creation_date": 1453913750, "post_id": 35042189, "comment_id": 57811034, "body": "We have them set up as add-ins in a central folder. But currently we have a makeshift installer that copies them over to the user&#39;s computer into their macro folder for use. I think we would definitely like more info @Snachmo."}, {"owner": {"reputation": 178, "user_id": 5744945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aDOkW.jpg?s=128&g=1", "display_name": "Snachmo", "link": "https://stackoverflow.com/users/5744945/snachmo"}, "edited": false, "score": 2, "creation_date": 1453915187, "post_id": 35042189, "comment_id": 57811987, "body": "Sounds like you&#39;re halfway there, only trick is to add the .xlam to Excel from a network location rather than copying it to the macro folder.  If Excel sees the .xlam is on a network it will prompt you to &quot;Copy myaddin.xlam to the Addins folder for User?&quot;  Select no, and it will re-load this .xlam from the network every time the user starts Excel (the add-in will not be available outside the network, which may be a deal breaker).  I think <a href=\"http://www.excelguru.ca/content.php?152-Deploying-Add-ins-in-a-Network-Environment\" rel=\"nofollow noreferrer\">this writeup</a> covers everything."}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1453917001, "post_id": 35042189, "comment_id": 57813240, "body": "That is perfect! Unless our network is down, it&#39;ll work great. But when our network is down, we can&#39;t really do anything anyway! Thanks!!"}], "owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 553, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1456410809, "creation_date": 1453910490, "last_edit_date": 1456410809, "question_id": 35042189, "link": "https://stackoverflow.com/questions/35042189/use-same-macro-file-for-network", "title": "Use same macro file for network", "body": "<p>We are trying to create a single file that everyone on our network can pull from for their macros.</p>\n\n<p>We want a way to have the code update without everyone updating it separately.</p>\n\n<p>Is there a way to have everyone update their macros to a new style that will pull from this single location and allow us to be able to update the code at will? </p>\n\n<p>The potential issue is, with so many people using the macros, if anyone leaves it open, it could stop us from updating the code because it is open elsewhere.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 2, "creation_date": 1453910809, "post_id": 35042112, "comment_id": 57808901, "body": "See if it exists first: <a href=\"http://stackoverflow.com/questions/3350645/how-to-check-if-table-is-exists-or-not-in-ms-access-for-vb-macros\">how to check if table is exists or not in ms access for vb macros?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 4, "last_activity_date": 1453910662, "creation_date": 1453910662, "answer_id": 35042240, "question_id": 35042112, "link": "https://stackoverflow.com/questions/35042112/ms-access-vba-add-if-condition-to-vba-code/35042240#35042240", "title": "MS Access/ VBA : add if condition to vba code", "body": "<p>You mean error trapping? Here's an example of how you can \"trap\" an error - If an error occured trying to delete Table1 it will ask you if you want to continue:</p>\n\n<pre><code>Private Sub Command66_Click()\nDoCmd.SetWarnings False\n\nOn Error Resume Next\nDoCmd.DeleteObject acTable, \"Table1\"\n\nIf Err.Number &gt; 0 Then\n    Err.Clear\n    On Error GoTo 0\n    If MsgBox(\"There was an error trying to delete Table1, do you want to continue?\", vbYesNo) = vbYes Then\n        DoCmd.DeleteObject acTable, \"Table2\"\n        DoCmd.DeleteObject acTable, \"Table3\"\n    End If\nEnd If\nDoCmd.SetWarnings True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": false, "score": 2, "last_activity_date": 1453912092, "last_edit_date": 1495541724, "creation_date": 1453912092, "answer_id": 35042790, "question_id": 35042112, "link": "https://stackoverflow.com/questions/35042112/ms-access-vba-add-if-condition-to-vba-code/35042790#35042790", "title": "MS Access/ VBA : add if condition to vba code", "body": "<p>If you decide to trap and ignore the error, start by ignoring <em>only</em> error 7874 (<em>Microsoft Access can't find the object ''.</em>)  You may prefer not to ignore other errors, such as when the table is in use.  </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Command66_Click()\n\n    Dim strMsg As String\n\nOn Error GoTo ErrorHandler\n\n    DoCmd.DeleteObject acTable, \"Table1\"\n    DoCmd.DeleteObject acTable, \"Table2\"\n    DoCmd.DeleteObject acTable, \"Table3\"\n\nExitHere:\n    Exit Sub\n\nErrorHandler:\n    Select Case Err.Number\n    Case 7874 'Microsoft Access can't find the object\n        Resume Next\n    Case Else\n        strMsg = \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description _\n            &amp; \") in procedure Command66_Click\"\n        MsgBox strMsg\n        GoTo ExitHere\n    End Select\nEnd Sub\n</code></pre>\n\n<p>Notes:</p>\n\n<ul>\n<li>If you discover other errors you wish to ignore, you can add those error numbers to the first <code>Case</code> statement: <code>Case 7874, &lt;another number here&gt;</code></li>\n<li>I don't see any reason to turn <code>SetWarnings</code> off in this procedure.</li>\n<li>Consider Alex's <a href=\"https://stackoverflow.com/questions/35042112/ms-access-vba-add-if-condition-to-vba-code#comment57808901_35042112\">suggestion</a> to check whether the table exists before attempting to delete it.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5849064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44c4974a2a440be301e17a54de7426a2?s=128&d=identicon&r=PG&f=1", "display_name": "Arctics", "link": "https://stackoverflow.com/users/5849064/arctics"}, "edited": false, "score": 0, "creation_date": 1454356924, "post_id": 35048531, "comment_id": 57998651, "body": "did you put On Error Resume Next before if statement?"}], "tags": [], "owner": {"reputation": 1, "user_id": 5849064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44c4974a2a440be301e17a54de7426a2?s=128&d=identicon&r=PG&f=1", "display_name": "Arctics", "link": "https://stackoverflow.com/users/5849064/arctics"}, "is_accepted": false, "score": -1, "last_activity_date": 1454356858, "last_edit_date": 1454356858, "creation_date": 1453930607, "answer_id": 35048531, "question_id": 35042112, "link": "https://stackoverflow.com/questions/35042112/ms-access-vba-add-if-condition-to-vba-code/35048531#35048531", "title": "MS Access/ VBA : add if condition to vba code", "body": "<p>Well, if you want to delete table that only exists in Access then you can simply check for the object, here is how you normally do it:</p>\n\n<pre><code>On Error Resume Next\nIf IsObject(CurrentDb.TableDefs(\"Table1\")) Then\n    DoCmd.DeleteObject acTable, \"Table1\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 2857740, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5870407206e91db4674d4cd3b9c795a1?s=128&d=identicon&r=PG&f=1", "display_name": "adp", "link": "https://stackoverflow.com/users/2857740/adp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 722, "favorite_count": 0, "accepted_answer_id": 35042240, "answer_count": 3, "score": 2, "last_activity_date": 1454356858, "creation_date": 1453910311, "last_edit_date": 1453912122, "question_id": 35042112, "link": "https://stackoverflow.com/questions/35042112/ms-access-vba-add-if-condition-to-vba-code", "title": "MS Access/ VBA : add if condition to vba code", "body": "<p>I have the following code : </p>\n\n<pre><code>Private Sub Command66_Click()\nDoCmd.SetWarnings False\nDoCmd.DeleteObject acTable, \"Table1\"\nDoCmd.DeleteObject acTable, \"Table2\"\nDoCmd.DeleteObject acTable, \"Table3\"\nDoCmd.SetWarnings True\nEnd Sub\n</code></pre>\n\n<p>The problem is that if \"Table1\" is not present,I receive an VBA/debug Error. Can I add some condition that if the script doesn't find \"Table1\" it should go further and delete the other 2 tables without returning any error message?</p>\n"}, {"tags": ["excel", "vba", "sumifs"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453910822, "post_id": 35042090, "comment_id": 57808912, "body": "Do you need to do this by code, formula&#39;s are possible for this."}, {"owner": {"reputation": 161, "user_id": 5847288, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dda2fadf981ca09c990415c821421e0e?s=128&d=identicon&r=PG&f=1", "display_name": "robin", "link": "https://stackoverflow.com/users/5847288/robin"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453938199, "post_id": 35042090, "comment_id": 57824969, "body": "Hi, i have dynamic daily data to process, so, i was thinking it&#39;s good to use VB to do the automation process with a click of a button."}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 5847288, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dda2fadf981ca09c990415c821421e0e?s=128&d=identicon&r=PG&f=1", "display_name": "robin", "link": "https://stackoverflow.com/users/5847288/robin"}, "edited": false, "score": 0, "creation_date": 1453938447, "post_id": 35043061, "comment_id": 57825047, "body": "Hi, i found it too texting to use pivot table as i have dynamic data to process daily, i like the idea of VB coding and automation process with a button. i want to copy the raw data and paste them in sheet2, there are more diifferent raw data, i plan to paste them in sheet3, sheet4 later on.....sheet1 is the summary sheet, with a click of button it sum up all the data by criteria, eg. sales person, so the VB coding cut short all the manual process. Thanks"}, {"owner": {"reputation": 161, "user_id": 5847288, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dda2fadf981ca09c990415c821421e0e?s=128&d=identicon&r=PG&f=1", "display_name": "robin", "link": "https://stackoverflow.com/users/5847288/robin"}, "edited": false, "score": 0, "creation_date": 1453939166, "post_id": 35043061, "comment_id": 57825272, "body": "Hi, anyone know how to tweak the code below?   Sub sumif()  Sheet1.Range(&quot;A2&quot;) = &quot;Robin&quot; Sheet1.Range(&quot;C2&quot;) = Application.WorksheetFunction.sumif(Sheet2.Range(&quot;b2:F6&quot;), &quot;Robin&quot;, Sheet2.Range(&quot;D2:D6&quot;)) Range(&quot;A3&quot;) = &quot;Ray&quot; Sheet1.Range(&quot;C3&quot;) = Application.WorksheetFunction.sumif(Sheet2.Range(&quot;b2:F6&quot;), &quot;Ray&quot;, Sheet2.Range(&quot;D2:d6&quot;))  End Sub"}, {"owner": {"reputation": 56, "user_id": 5847806, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1WCUe.jpg?s=128&g=1", "display_name": "zfdn.cat", "link": "https://stackoverflow.com/users/5847806/zfdn-cat"}, "reply_to_user": {"reputation": 161, "user_id": 5847288, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dda2fadf981ca09c990415c821421e0e?s=128&d=identicon&r=PG&f=1", "display_name": "robin", "link": "https://stackoverflow.com/users/5847288/robin"}, "edited": false, "score": 0, "creation_date": 1453977341, "post_id": 35043061, "comment_id": 57841042, "body": "Automation using VBA is of course a possibility, but the code you suggest will need to be changed as well every time... You&#39;d need to use expressions that rely on relative references rather than absolutes."}], "tags": [], "owner": {"reputation": 56, "user_id": 5847806, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1WCUe.jpg?s=128&g=1", "display_name": "zfdn.cat", "link": "https://stackoverflow.com/users/5847806/zfdn-cat"}, "is_accepted": false, "score": 1, "last_activity_date": 1453912786, "creation_date": 1453912786, "answer_id": 35043061, "question_id": 35042090, "link": "https://stackoverflow.com/questions/35042090/excel-vb-sum-copy-range-with-criteria/35043061#35043061", "title": "excel vb sum &amp; copy range with criteria", "body": "<p>In my opinion, you should avoid using VBA code to accomplish this objective, and use a Pivot Table instead. The way that you present the data is a little messy, but:</p>\n\n<ol>\n<li>Convert the range in <em>Sheet2</em> into a Table. Make sure you include the headings.</li>\n<li>From the Table menu, add a Pivot Table to a new sheet.</li>\n<li>At the right of your screen, select <em>Sales-person</em> and drag it into the \"Rows\" box.</li>\n<li>Then select each of the days u want to have and drag them into the \"Measures\" box. Change from <em>Count</em> to <em>Sum</em>.</li>\n</ol>\n\n<p>You will have to add a new day every time that the table is updated, and I'm assuming it's every day... so I would suggest changing the structure of the original table, so you have one column with the date of each transaction, instead of one column per date.</p>\n"}], "owner": {"reputation": 161, "user_id": 5847288, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dda2fadf981ca09c990415c821421e0e?s=128&d=identicon&r=PG&f=1", "display_name": "robin", "link": "https://stackoverflow.com/users/5847288/robin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453912786, "creation_date": 1453910229, "question_id": 35042090, "link": "https://stackoverflow.com/questions/35042090/excel-vb-sum-copy-range-with-criteria", "title": "excel vb sum &amp; copy range with criteria", "body": "<p>I am new to excel visual basic, need some help as have been searching thru the web and can't figure out what is the right coding.</p>\n\n<p>I want to sum up the daily sales by first criteria sales person - Robin &amp; Ray from sheet2 (data range) to sheet1. I manged to do it and copy on 1/1, but unable to copy the rest of the colum from B,C,D...(2/1,3/1...)</p>\n\n<p>Secondly, if i want to add second criteria on status, only pick up those 'Active' in column C (sheet2), what is the right code to use?</p>\n\n<p>Can anyone direct me to the right place or coding? would very much appreciate your help.</p>\n\n<p>Thanks</p>\n\n<p><a href=\"http://i.stack.imgur.com/5mEE8.png\" rel=\"nofollow\">enter image description here</a></p>\n"}, {"tags": ["excel", "timestamp", "vba"], "comments": [{"owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "edited": false, "score": 0, "creation_date": 1453910998, "post_id": 35042035, "comment_id": 57809037, "body": "Hi, could you please post what you&#39;ve tried so far?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5847661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4510567584e69560ae96599c920804b2?s=128&d=identicon&r=PG", "display_name": "chailof", "link": "https://stackoverflow.com/users/5847661/chailof"}, "edited": false, "score": 0, "creation_date": 1453912154, "post_id": 35042439, "comment_id": 57809846, "body": "This worked perfectly. Thank you so much. I initially got it to do offset if it was blank before i posted the question, and wasn&#39;t sure how to proceed to do two different values. Your code was spot on!. Thanks again!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1453911160, "creation_date": 1453911160, "answer_id": 35042439, "question_id": 35042035, "link": "https://stackoverflow.com/questions/35042035/how-to-add-a-timestamp-when-a-cell-data-is-equal-to-certain-values/35042439#35042439", "title": "How to add a timestamp when a cell data is equal to certain values", "body": "<p>Format columns <strong>Q</strong> and <strong>R</strong> to meet your requirements and then enter this small Event Macro:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n   Dim A As Range: Set A = Range(\"A:A\")\n   Dim v As String\n   If Intersect(Target, A) Is Nothing Then Exit Sub\n\n   Application.EnableEvents = False\n      v = Target.Value\n      If v = \"PENDING AUDIT\" Then Target.Offset(0, 16) = Now()\n      If v = \"COMPLETED\" Then Target.Offset(0, 17) = Now()\n   Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Because it is worksheet code, it is very easy to install and automatic to use:</p>\n\n<ol>\n<li>right-click the tab name near the bottom of the Excel window</li>\n<li>select View Code - this brings up a VBE window</li>\n<li>paste the stuff in and close the VBE window</li>\n</ol>\n\n<p>If you have any concerns, first try it on a trial worksheet.</p>\n\n<p>If you save the workbook, the macro will be saved with it.\nIf you are using a version of Excel later then 2003, you must save\nthe file as .xlsm rather than .xlsx</p>\n\n<p>To remove the macro:</p>\n\n<ol>\n<li>bring up the VBE windows as above</li>\n<li>clear the code out</li>\n<li>close the VBE window</li>\n</ol>\n\n<p>To learn more about macros in general, see:</p>\n\n<p><a href=\"http://www.mvps.org/dmcritchie/excel/getstarted.htm\" rel=\"nofollow\">http://www.mvps.org/dmcritchie/excel/getstarted.htm</a></p>\n\n<p>and</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/ee814735(v=office.14).aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/ee814735(v=office.14).aspx</a></p>\n\n<p>To learn more about Event Macros (worksheet code), see:</p>\n\n<p><a href=\"http://www.mvps.org/dmcritchie/excel/event.htm\" rel=\"nofollow\">http://www.mvps.org/dmcritchie/excel/event.htm</a></p>\n\n<p><strong>Macros must be enabled for this to work!</strong></p>\n"}], "owner": {"reputation": 23, "user_id": 5847661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4510567584e69560ae96599c920804b2?s=128&d=identicon&r=PG", "display_name": "chailof", "link": "https://stackoverflow.com/users/5847661/chailof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1628, "favorite_count": 0, "accepted_answer_id": 35042439, "answer_count": 1, "score": 2, "last_activity_date": 1453911160, "creation_date": 1453910055, "last_edit_date": 1531161705, "question_id": 35042035, "link": "https://stackoverflow.com/questions/35042035/how-to-add-a-timestamp-when-a-cell-data-is-equal-to-certain-values", "title": "How to add a timestamp when a cell data is equal to certain values", "body": "<p>I am looking for a solution on how to enter 2 timestamps based on one cell's value without either one going blank when changed.</p>\n\n<p>Example: Column A has a dropdown list for \"COMPLETED\" and \"PENDING AUDIT\" - I want a time stamp to appear in column 17 for that same row when PENDING AUDIT is selected. And once it changes from pending audit to COMPLETED for that same row, enter a timestamp into column 18. That way two timestamps are created from pending to completion and can be documented to analyze how much time it took from pending to completion. </p>\n\n<p>Timestamp format to be \"M:D:Y H:M\"</p>\n"}, {"tags": ["vba", "excel", "timestamp"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1453911197, "post_id": 35041833, "comment_id": 57809178, "body": "Could you not start the code as <code>If Target.Address = &quot;$BH$21&quot; Then</code> This is a worksheet_change event, you don&#39;t require to set variables for the sheet, because you are already on the sheet."}], "answers": [{"tags": [], "owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "is_accepted": false, "score": 1, "last_activity_date": 1476211489, "last_edit_date": 1476211489, "creation_date": 1453911202, "answer_id": 35042453, "question_id": 35041833, "link": "https://stackoverflow.com/questions/35041833/excel-vba-method-clearcontents-of-object-range-failed/35042453#35042453", "title": "Excel VBA Method &#39;ClearContents&#39; of Object Range Failed", "body": "<p>You have it cycling through an infinite loop due to you editing the file when you change the value of BH21. You will need another if or something else to avoid the infinite loop. Mine worked just fine with editing cell with a blank.</p>\n\n<p>You should also change your if statement from </p>\n\n<pre><code>Target.Address = ws.Range(\"$BG$21\")\n</code></pre>\n\n<p>to </p>\n\n<pre><code>Target.Address = \"$BG$21\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": true, "score": 2, "last_activity_date": 1453911427, "creation_date": 1453911427, "answer_id": 35042542, "question_id": 35041833, "link": "https://stackoverflow.com/questions/35041833/excel-vba-method-clearcontents-of-object-range-failed/35042542#35042542", "title": "Excel VBA Method &#39;ClearContents&#39; of Object Range Failed", "body": "<p>I couldn't get the error, but there are two things in your code you made wrong.</p>\n\n<ol>\n<li><code>Target.Address = ws.Range(\"$BG$21\")</code> Default property for <code>Range</code> is <code>Value</code>, so you compare Address with Value here.</li>\n<li><p><code>ws.Range(\"$BH$21\").ClearContents</code> will cause infinite loop, as this code changes worksheet, so <code>Change</code> event occurs and macro starts again. Use <code>EnableEvents</code> to avoid this.</p>\n\n<pre><code>Application.EnableEvents = False\nws.Range(\"$BH$21\").ClearContents\nApplication.EnableEvents = True\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 1180, "user_id": 2132230, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/247c0ea21dcbf6fd84c5e21a34cb0b18?s=128&d=identicon&r=PG", "display_name": "Sanya", "link": "https://stackoverflow.com/users/2132230/sanya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4301, "favorite_count": 0, "accepted_answer_id": 35042542, "answer_count": 2, "score": 1, "last_activity_date": 1476211489, "creation_date": 1453909575, "last_edit_date": 1459772203, "question_id": 35041833, "link": "https://stackoverflow.com/questions/35041833/excel-vba-method-clearcontents-of-object-range-failed", "title": "Excel VBA Method &#39;ClearContents&#39; of Object Range Failed", "body": "<p>I've looked at the similar questions about \"Method of Object Range Failed\" but none seem to help me solve my problem.</p>\n\n<p>The error I receive is: \"Method 'ClearContents' of Object Range Failed\"</p>\n\n<p>Essentially what I'm trying to achieve is that if cell value of BG21 = 1 And the length of the string in adjacent cell (BH21) is 0 Then timestamp the adjacent cell (BH21). Ideally I want to repeat this for Range (BG21:BG35). I know I could use a for each method but I want to get this error cleared first.</p>\n\n<p>I don't want to use the cell formula because I need a timestamp the moment the cell BG21 changes to 1. If I use a cell formula then anytime the workbook is opened the timestamp changes. </p>\n\n<p>The code I have is:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n   Dim wb As Workbook, ws As Worksheet\n\n   Set wb = ThisWorkbook\n   Set ws = wb.Worksheets(\"Submittal Kickoff Meeting\")\n\n    If (ws.Range(\"$BG$21\").Value = 1 And len(ws.Range(\"$BH$21\").Value) = 0 And Target.Address = ws.Range(\"$BG$21\")) Then\n        ws.Range(\"$BH$21\").Value = Format(Now(), \"m/dd/yyyy hh:mm:ss AM/PM\")\n    Else\n        ws.Range(\"$BH$21\").ClearContents  '&lt;--- Error occurs here\n    End If\nEnd Sub\n</code></pre>\n\n<p>The error occurs on line:</p>\n\n<pre><code>ws.Range(\"$BH$21\").ClearContents\n</code></pre>\n\n<p>I have also tried:</p>\n\n<pre><code>ws.Range(\"$BH$21\").Value = \"\"\n</code></pre>\n\n<p>But I received the same error code</p>\n\n<p>Any advice??</p>\n\n<p>.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5847594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9ba2385c6d3409c8a230e2d33f86ab?s=128&d=identicon&r=PG&f=1", "display_name": "AnneD", "link": "https://stackoverflow.com/users/5847594/anned"}, "edited": false, "score": 0, "creation_date": 1453918483, "post_id": 35041862, "comment_id": 57814160, "body": "Thank you for your response.  What I&#39;m actually looking for is a method to construct the Union statement using range names that are held in an array."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 11, "user_id": 5847594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9ba2385c6d3409c8a230e2d33f86ab?s=128&d=identicon&r=PG&f=1", "display_name": "AnneD", "link": "https://stackoverflow.com/users/5847594/anned"}, "edited": false, "score": 0, "creation_date": 1453921573, "post_id": 35041862, "comment_id": 57816080, "body": "@AnneD see revision."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 3, "last_activity_date": 1453921499, "last_edit_date": 1453921499, "creation_date": 1453909630, "answer_id": 35041862, "question_id": 35041656, "link": "https://stackoverflow.com/questions/35041656/excel-vba-dynamically-supply-ranges-to-union-method/35041862#35041862", "title": "Excel VBA - Dynamically supply ranges to Union method", "body": "<p>You'll have to substitute the actual range names or objects in the statement, but here is how to use the <code>Union</code> function to set a <code>PrintArea</code>:</p>\n\n<pre><code>Sub foo()\n    Dim setup As PageSetup\n    Set setup = ActiveSheet.PageSetup\n\n    setup.PrintArea = Union(Range(\"MyRange1\"), Range(\"MyRange2\")).Address\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>What I'm actually looking for is a method to construct the Union statement using range names that are held in an array</p>\n</blockquote>\n\n<p>OK, then use the above method and a custom function to construct the Union in a loop:</p>\n\n<pre><code>Sub foo()\n    Dim setup As PageSetup\n    Dim RangeArray(1) As Range\n\n    Set setup = ActiveSheet.PageSetup\n    Set RangeArray(0) = Range(\"MyRange1\")\n    Set RangeArray(1) = Range(\"MyRange2\")\n\n    setup.PrintArea = GetUnion(RangeArray)\nEnd Sub\nFunction GetUnion(arr As Variant) As String\n    Dim itm As Variant\n    Dim ret As Range\n    For Each itm In arr\n        If Not ret Is Nothing Then\n            Set ret = Union(ret, itm)\n        Else\n            Set ret = itm\n        End If\n    Next\n    If Not ret Is Nothing Then\n        GetUnion = ret.Address\n    Else\n        GetUnion = \"\"  'May cause an error...\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5847594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9ba2385c6d3409c8a230e2d33f86ab?s=128&d=identicon&r=PG&f=1", "display_name": "AnneD", "link": "https://stackoverflow.com/users/5847594/anned"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1327, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459770323, "creation_date": 1453909110, "last_edit_date": 1459770323, "question_id": 35041656, "link": "https://stackoverflow.com/questions/35041656/excel-vba-dynamically-supply-ranges-to-union-method", "title": "Excel VBA - Dynamically supply ranges to Union method", "body": "<p>User has defined named ranges to print in Excel. </p>\n\n<p>I am reading these ranges into a VBA array. Is there a way to supply the range names to the Union method to set non-contiguous print ranges. </p>\n\n<p>For example, something like:\n<code>ActiveSheet.PageSetup.PrintArea = Union(Range(array(1)), Range(array(2))).Address</code></p>\n\n<p>The number of ranges held in the array can vary.  I've experimented with looping through the array and building a string variable, but no success.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 104, "user_id": 2132992, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/70286dcb42281043dd345a7b064bcf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Tango_Mike", "link": "https://stackoverflow.com/users/2132992/tango-mike"}, "edited": false, "score": 0, "creation_date": 1454064977, "post_id": 35041585, "comment_id": 57887354, "body": "As far as I understand, you want to protect only Range(&quot;N10:Q20&quot;) and all the other cells on this sheet should be unprotected. Is it correct?"}], "answers": [{"tags": [], "owner": {"reputation": 104, "user_id": 2132992, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/70286dcb42281043dd345a7b064bcf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Tango_Mike", "link": "https://stackoverflow.com/users/2132992/tango-mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1454065580, "creation_date": 1454065580, "answer_id": 35082942, "question_id": 35041585, "link": "https://stackoverflow.com/questions/35041585/unprotect-sheet-not-working-in-excel-2013-vba/35082942#35082942", "title": "unprotect sheet not working in excel 2013 (vba)", "body": "<p>Following my comment, if your goal is to protect only range \"N10:Q20\" on \"sheetb\" and leave the rest unprotected, then you can do that  very easily: simply select the whole range on the worksheet (CTRL+A), press the right-mouse button and go to \"Format the cells..\"; select Protection tab and untick \"Locked\" box. Next, select your range \"N10:Q20\" and do the same procedure but this time tick the \"Lock\" box. Now, run your code and you will notice that only your selected range will be protected, all the other cells on \"sheetb\" will stay unlocked and editable. </p>\n"}], "owner": {"reputation": 29, "user_id": 5436308, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/be7c36f1aea401252ccb3e513eef0c19?s=128&d=identicon&r=PG&f=1", "display_name": "Maya", "link": "https://stackoverflow.com/users/5436308/maya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 592, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454065580, "creation_date": 1453908929, "last_edit_date": 1531164843, "question_id": 35041585, "link": "https://stackoverflow.com/questions/35041585/unprotect-sheet-not-working-in-excel-2013-vba", "title": "unprotect sheet not working in excel 2013 (vba)", "body": "<p>I have a workook in which userform will pop-up only if somesheets as present (say Sheeta). On clicking submit in userform will do and some calculation and store it in Sheetb. I need to lock some cells from editing in sheetb. </p>\n\n<p>code used in submit click</p>\n\n<pre><code>Sheets(\"sheetb\").unprotect password=\"test\"\n'code for calculation\nsheets(\"sheetb\").protect password=\"test\" , AllowFormattingcells:=true 'This statement locks the unlocked cells\n</code></pre>\n\n<p>The above code works fine when pop-up the userform through button say (loadfile).</p>\n\n<p>I don't know what mistake I made.\nPlease help me to get rid of this...</p>\n\n<p>Note : I want to prevent cells Sheets(\"sheetb\").Range(\"N10:Q20\") only from editing. Is it possible to prevent cells from editing without protecting a sheet.</p>\n\n<p>Thanks in advance!!!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1453908169, "post_id": 35041167, "comment_id": 57806865, "body": "how about just reading up on the topic straight from the sources mouth <a href=\"https://msdn.microsoft.com/en-us/library/dk008ty4(v=vs.90).aspx\" rel=\"nofollow noreferrer\">MSDN Dir</a>. Then supplement that with plenty of other articles written on the topic! ... I also VTC because this off-topic for reason of looking for a tutorial. Lastly, welcome to SO. Please read <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a> to receive better help in the future. :)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453908250, "post_id": 35041167, "comment_id": 57806933, "body": "I&#39;d start by looking at the DIR function, looks like you&#39;re picking up files, then when the file is nothing, i.e len=0 stop.  While = while this is true do this."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1453909157, "post_id": 35041167, "comment_id": 57807683, "body": "It won&#39;t help you if you don&#39;t know C -- but is some ways <code>Dir</code> in VBA has always reminded me a bit of <code>strtok()</code> in C -- they are used in loops in roughly similar ways."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5847506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b9ebf6f8ca832752ecb5d87689fdd57?s=128&d=identicon&r=PG&f=1", "display_name": "royce1ma", "link": "https://stackoverflow.com/users/5847506/royce1ma"}, "edited": false, "score": 0, "creation_date": 1453998206, "post_id": 35043179, "comment_id": 57856522, "body": "Thank you, this makes a lot of sense. The function call with and without a parameter was tripping me up."}], "tags": [], "owner": {"reputation": 66, "user_id": 5840970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc6f8cf09f7d1a435579092fd4e30e7b?s=128&d=identicon&r=PG&f=1", "display_name": "tiesja", "link": "https://stackoverflow.com/users/5840970/tiesja"}, "is_accepted": true, "score": 5, "last_activity_date": 1529460238, "last_edit_date": 1529460238, "creation_date": 1453913069, "answer_id": 35043179, "question_id": 35041167, "link": "https://stackoverflow.com/questions/35041167/can-someone-explain-how-a-while-loop-using-the-dir-function-works-in-vba/35043179#35043179", "title": "Can someone explain how a While Loop using the Dir function works in VBA?", "body": "<p>The Dir function returns, one at the time, filenames from a directory. </p>\n\n<p>When you call Dir() with a path to a directory as an argument, it will return to you the first filename from that directory.</p>\n\n<p>When you call Dir() without an argument, it will return to you the next filename from the directory until there are no more files, in which case a null name is returned.</p>\n\n<p>So in order to process all the files in directory you need Dir(path) once, followed by Dir() as long as that returns a name.</p>\n\n<p>How do you test if a name is returned?<br>\n<code>fname&gt;\"\"</code><br>\nis a way, here they use<br>\n<code>len(fname)&gt;0</code><br>\nwhere len is another function that takes a string as argument and returns the length of that string.</p>\n\n<p>So comes the \"as long as there are files\" part. That is implemented with a loop structure</p>\n\n<pre><code>while *condition*  \n    ... do things  \nend while \n</code></pre>\n\n<p>in this case</p>\n\n<pre><code>While (Len(fname) &gt; 0)\n    '...\n    fname=Dir\nWend\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5847506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b9ebf6f8ca832752ecb5d87689fdd57?s=128&d=identicon&r=PG&f=1", "display_name": "royce1ma", "link": "https://stackoverflow.com/users/5847506/royce1ma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1128, "favorite_count": 0, "accepted_answer_id": 35043179, "answer_count": 1, "score": 1, "last_activity_date": 1529460238, "creation_date": 1453907872, "question_id": 35041167, "link": "https://stackoverflow.com/questions/35041167/can-someone-explain-how-a-while-loop-using-the-dir-function-works-in-vba", "title": "Can someone explain how a While Loop using the Dir function works in VBA?", "body": "<p>I'm fairly new to VBA and needed to make a script for work. The script would look in a directory and import any .txt files found into a new worksheet in the workbook. I.e. if there were 20 .txt files, I would end up with 20 worksheets. I found some code online that does this perfectly, exactly as I want it to. The problem is, I don't really understand how it works. I've never used the Dir function, and it appears the loop focuses on this, but I'm still confused as to how this is looping from one file to the next. If someone could help me understand, or add comments to the code, that would be really helpful. Thanks. </p>\n\n<p>Code is:</p>\n\n<pre><code>    Sub LoadFiles()\nDim idx As Integer\nDim fpath As String\nDim fname As String\nDim ws As Worksheet\nidx = 0\nfpath = \"C:\\MyFolderLocation\"\nfname = Dir(fpath)\nWhile (Len(fname) &gt; 0)\n    idx = idx + 1\n    Sheets.Add.Name = fname\n    With ActiveSheet.QueryTables.Add(Connection:=\"TEXT;\" _\n      &amp; fpath &amp; fname, Destination:=Range(\"A1\"))\n        .Name = \"a\" &amp; idx\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = False\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = False\n        .TextFileOtherDelimiter = \",\"\n        .TextFileColumnDataTypes = Array(1, 1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n        fname = Dir\n    End With\nWend\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1453909798, "post_id": 35041137, "comment_id": 57808152, "body": "the cell on the top row would be sheet.cells(1,&quot;k&quot;)"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1453916032, "post_id": 35041137, "comment_id": 57812543, "body": "Please take a moment to click the checkmark next to Nathan_Sav&#39;s &quot;Answer&quot; so that people who look this up at a later point can quickly recognize it as the answer. (And also give Nathan some rep points :-))"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 1, "last_activity_date": 1453910150, "creation_date": 1453910150, "answer_id": 35042066, "question_id": 35041137, "link": "https://stackoverflow.com/questions/35041137/in-vba-is-it-possible-to-select-a-cell-relative-to-a-dynamic-range/35042066#35042066", "title": "In VBA, is it possible to select a cell relative to a dynamic range?", "body": "<p>the cell on the top row would be sheet.cells(1,\"k\")\u2013</p>\n"}], "owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 35042066, "answer_count": 1, "score": 0, "last_activity_date": 1453910150, "creation_date": 1453907775, "question_id": 35041137, "link": "https://stackoverflow.com/questions/35041137/in-vba-is-it-possible-to-select-a-cell-relative-to-a-dynamic-range", "title": "In VBA, is it possible to select a cell relative to a dynamic range?", "body": "<p>Let's say I set 'Rng' as a dynamic range, like (\"A\" &amp; i) where 'i=2' and i increases by 1 whenever a certain condition is met. At the same time, I also set 'k = 2' and increase k whenever another condition is met. Is it possible to write a command that says 'If.... Then Copy \"the cell on the top row of whatever column 'rng.offset(0,k)' happens to be at the moment?\"</p>\n\n<p>It would be easy to write this as another Offset command, but if the column and row of Rng is changing, is it possible to write a command that copies the top row of this?</p>\n\n<p>Thanks in advance,</p>\n"}, {"tags": ["forms", "ms-access", "combobox", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453907133, "post_id": 35040689, "comment_id": 57806093, "body": "I think you&#39;ll need to requery the combo, so me.ColName.requery"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1453907650, "post_id": 35040689, "comment_id": 57806477, "body": "@Nathan_Sav: changing the RowSource does an automatic requery, the same as with changing a Form.RecordSource."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5847390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba885545d6f43286cdf2fd8db4e9f1af?s=128&d=identicon&r=PG&f=1", "display_name": "Sophie", "link": "https://stackoverflow.com/users/5847390/sophie"}, "edited": false, "score": 0, "creation_date": 1453908204, "post_id": 35041064, "comment_id": 57806892, "body": "Thank you, I&#39;ve tried this earlier (this is how it was in the original code, but it didn&#39;t work, so I ended up switching to double-quotes. I pasted what you wrote here and I still have the same problem: after typing 3 letters, a blank dropdown appears, but nothing else happens, the names don&#39;t seem to be pulling through."}, {"owner": {"reputation": 21, "user_id": 5847390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba885545d6f43286cdf2fd8db4e9f1af?s=128&d=identicon&r=PG&f=1", "display_name": "Sophie", "link": "https://stackoverflow.com/users/5847390/sophie"}, "edited": false, "score": 0, "creation_date": 1453910136, "post_id": 35041064, "comment_id": 57808394, "body": "I&#39;m really sorry to be a pain, but something is still not okay. I edited the code as you suggested, pasted the SQL in a Query, which returns some names. Still, nothing appears in the combo box, the dropdown remains blank. What am I doing wrong?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 21, "user_id": 5847390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba885545d6f43286cdf2fd8db4e9f1af?s=128&d=identicon&r=PG&f=1", "display_name": "Sophie", "link": "https://stackoverflow.com/users/5847390/sophie"}, "edited": false, "score": 0, "creation_date": 1453910735, "post_id": 35041064, "comment_id": 57808847, "body": "@Sophie: the query returns 1 column - does your combobox perhaps have 2 columns, with the width of the first column = 0 ?"}, {"owner": {"reputation": 21, "user_id": 5847390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba885545d6f43286cdf2fd8db4e9f1af?s=128&d=identicon&r=PG&f=1", "display_name": "Sophie", "link": "https://stackoverflow.com/users/5847390/sophie"}, "edited": false, "score": 0, "creation_date": 1453912730, "post_id": 35041064, "comment_id": 57810257, "body": "No, it only has one column, 2.54 cm wide. It was working perfectly when I only had a SELECT DISTINCT query as a RowSource, just took ages to load. Row Source is blank, so is Row Source Type. Limit to List: Yes. Show only row source values: No. Event &gt; all blank, except for On Change, that has the Event Procedure that is above."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 21, "user_id": 5847390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba885545d6f43286cdf2fd8db4e9f1af?s=128&d=identicon&r=PG&f=1", "display_name": "Sophie", "link": "https://stackoverflow.com/users/5847390/sophie"}, "edited": false, "score": 1, "creation_date": 1453912991, "post_id": 35041064, "comment_id": 57810438, "body": "@Sophie: Ah, there&#39;s the culprit: <code>RowSourceType</code> must be &quot;Table/Query&quot;, because you are going to set a query as RowSource. I just reproduced it, with an empty <code>RowSourceType</code> it doesn&#39;t work."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1453908908, "last_edit_date": 1495541047, "creation_date": 1453907595, "answer_id": 35041064, "question_id": 35040689, "link": "https://stackoverflow.com/questions/35040689/limiting-rowsource-in-combobox-access/35041064#35041064", "title": "Limiting RowSource in ComboBox (Access)", "body": "<p>You only have some double-quote mixup there. It is much easier to use single quotes instead of double double-quotes.</p>\n\n<pre><code>Me.CollName.RowSource = _\n \"SELECT CollPerf.Colleague FROM CollPerf WHERE CollPerf.Colleague LIKE '*\" &amp; strText &amp; \"*';\"\n</code></pre>\n\n<p>But your query would be way faster if you would only use the starting letters, i.e. remove the leading <code>*</code></p>\n\n<pre><code>Me.CollName.RowSource = _\n \"SELECT CollPerf.Colleague FROM CollPerf WHERE CollPerf.Colleague LIKE '\" &amp; strText &amp; \"*';\"\n</code></pre>\n\n<p>But that depends on your requirements.</p>\n\n<p><strong>EDIT</strong> to debug:</p>\n\n<pre><code>Dim strText As String\nDim strSelect As String\n\nstrText = Nz(Me.CollName.Text, \"\")\n\nIf Len(strText) &gt; 2 Then\n\n    strSelect = \"SELECT CollPerf.Colleague FROM CollPerf WHERE CollPerf.Colleague LIKE '*\" &amp; strText &amp; \"*';\"\n    Debug.Print strSelect \n\n    Me.CollName.RowSource = strSelect \n    Me.CollName.Dropdown\n\nEnd If\n</code></pre>\n\n<p>Copy strSelect from the Immediate Window into a query, and try it out. It should help resolve the problem.</p>\n\n<p>See <a href=\"https://stackoverflow.com/a/1099570/3820271\">How to debug dynamic SQL in VBA</a></p>\n"}], "owner": {"reputation": 21, "user_id": 5847390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba885545d6f43286cdf2fd8db4e9f1af?s=128&d=identicon&r=PG&f=1", "display_name": "Sophie", "link": "https://stackoverflow.com/users/5847390/sophie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 502, "favorite_count": 0, "accepted_answer_id": 35041064, "answer_count": 1, "score": 1, "last_activity_date": 1453922366, "creation_date": 1453906636, "last_edit_date": 1453922366, "question_id": 35040689, "link": "https://stackoverflow.com/questions/35040689/limiting-rowsource-in-combobox-access", "title": "Limiting RowSource in ComboBox (Access)", "body": "<p>I have a form which has a ComboBox on it that pulls all DISTINCT colleague names from a huge table that includes all of our sales (50k+ records). It works perfectly fine, but it takes 3-4 minutes to open the form because it takes so long for Access to find all unique colleague names in the table.</p>\n\n<p>I've been trying to research this and found something that looks useful, but can't seem to get it right.</p>\n\n<p>The code I have at the moment:</p>\n\n<pre><code>Private Sub CollName_Change()\nDim strText As String\n\nstrText = Nz(Me.CollName.Text, \"\")\n\nIf Len(strText) &gt; 2 Then\n\nMe.CollName.RowSource = \"SELECT CollPerf.Colleague FROM CollPerf WHERE CollPerf.Colleague LIKE \"\"*\"\" &amp; strText &amp; \"\"*\"\"; \"\n\nMe.CollName.Dropdown\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I found this code on two forums, this is supposed to do the following: \"the key is to not have a Row Source defined for the Combo Box.  The row source will be defined as the user starts typing letters.  Once they get to 3 letters then the row source of the combo box will be defined and the combo box will be told to dropdown.\"</p>\n\n<p>When I get to 3 letters, a dropdown appears, but it's blank, it doesn't display any results.</p>\n\n<p>I'm relatively new to Access, although already built two databases, but they all have relatively basic SQL queries, so I have no idea what I'm not doing right here.</p>\n\n<p>Any advice? Or alternatively a different solution as to how take my combo box faster and still keep values unique?</p>\n"}, {"tags": ["vba", "for-loop", "controls", "each", "userform"], "comments": [{"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1453982086, "post_id": 35040650, "comment_id": 57844231, "body": "why did you call it ufField.Value when it would be ufControl.value? (after if TypeOf ufControl IS....)"}, {"owner": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "reply_to_user": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1453986571, "post_id": 35040650, "comment_id": 57847468, "body": "Ah that was the old naming convention I gave it but ufControl made a bit more sense so I changed it. Thanks for spotting that one. However the error probably lies within the method I am trying to use to achieve what I want?"}], "answers": [{"comments": [{"owner": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "edited": false, "score": 0, "creation_date": 1453992830, "post_id": 35062743, "comment_id": 57852299, "body": "This seems to produce:  Run-time Error &#39;438&#39;: Object doesn&#39;t support this property or method... Been getting this a lot with userforms recently.  This errors on the line: idCell.Offset(0, Counter).Value = ufControl.Result"}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "reply_to_user": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "edited": false, "score": 0, "creation_date": 1453993328, "post_id": 35062743, "comment_id": 57852755, "body": "change &quot;idCell.Offset(0,Counter).Value&quot; to &quot;idCell.CurrentRegion.Offset(0, Counter).Value&quot; for a sec and see if it still throws the error."}, {"owner": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "edited": false, "score": 0, "creation_date": 1453993766, "post_id": 35062743, "comment_id": 57853109, "body": "I have selected your response as the answer because I only had to make a very small change to get it to work. I just changed the .result and .value to .text and that seems to do the trick. Thanks very much for your help :)"}], "tags": [], "owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "is_accepted": true, "score": 0, "last_activity_date": 1453987421, "creation_date": 1453987421, "answer_id": 35062743, "question_id": 35040650, "link": "https://stackoverflow.com/questions/35040650/loop-through-userform-paste-to-offset-cells/35062743#35062743", "title": "Loop Through Userform &amp; Paste to Offset Cells", "body": "<p>I saw some things that I have adapted down below. May I ask you to test that bit of code?</p>\n\n<pre><code>Option Explicit\n\nSub cbSubmit_Click()\n\n    Dim dbFood As Worksheet\n    Set dbFood = ActiveWorkbook.Sheets(\"dbFood\")\n\n    Dim lRow As Long\n    lRow = dbFood.Cells(dbFood.Rows.Count, 1).End(xlUp).Row\n\n    Dim lCol As Long\n    lCol = dbFood.Cells(1, dbFood.Columns.Count).End(xlLeft).Row\n\n    Dim idCell As Range\n\n\n    If dbFood.Cells(lRow, 1).Value = \"ID\" Then\n        Set idCell = dbFood.Range(\"A2\")\n        idCell.Value = 1\n\n        Dim ufControl As Control\n        Dim Counter As Long\n        Counter = 1\n\n        For Each ufControl In Me.Controls\n\n            If TypeOf ufControl Is MSForms.TextBox Then\n                idCell.Offset(0, Counter).Value = ufControl.Result\n                Counter = Counter + 1\n            ElseIF TypeOf ufControl Is MSForms.ComboBox\n                idCell.Offset(0, Counter).Value = ufControl.SeletedItem.Value\n            End If\n\n       Next ufControl\n\n       MsgBox \"Added to database!\"\n\n    ElseIf dbFood.Cells(lRow, 1).Value &gt;= 0.1 Then\n        Dim lastID As Long\n        lastID = dbFood.Cells(lRow, 1).Value\n\n        Set idCell = dbFood.Cells(lRow + 1, 1)\n        idCell.Value = lastID + 1\n\n    Else\n        MsgBox (\"ERROR - Cannot Create Record\")\n        Exit Sub\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>As you can see I have divided the types of the ufcontrol as I am not sure that with a combobox you can directly say .Value so you'll have to add .SelectedItem. You can at least try it once :)</p>\n"}, {"comments": [{"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1453993804, "post_id": 35064951, "comment_id": 57853144, "body": "hahaha ok I didn&#39;t think this would give the error, but really happy that I could help you figuring out how to make it work ;)"}], "tags": [], "owner": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "is_accepted": false, "score": 1, "last_activity_date": 1453993460, "creation_date": 1453993460, "answer_id": 35064951, "question_id": 35040650, "link": "https://stackoverflow.com/questions/35040650/loop-through-userform-paste-to-offset-cells/35064951#35064951", "title": "Loop Through Userform &amp; Paste to Offset Cells", "body": "<p>I managed to solve this by using the method Kathara suggested to me but edited it to avoid the 438 error. Below is the small adjustment I made to make it work:</p>\n\n<pre><code>For Each ufControl In Me.Controls\n\n        If TypeOf ufControl Is MSForms.TextBox Then\n            idCell.Offset(0, Counter).Value = ufControl.Text\n            Counter = Counter + 1\n        ElseIf TypeOf ufControl Is MSForms.ComboBox Then\n            idCell.Offset(0, Counter).Value = ufControl.Text\n            Counter = Counter + 1\n        End If\n\n    Next ufControl\n</code></pre>\n\n<p>Many thanks for your help :)</p>\n"}], "owner": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 35062743, "answer_count": 2, "score": 0, "last_activity_date": 1453993460, "creation_date": 1453906565, "last_edit_date": 1453986497, "question_id": 35040650, "link": "https://stackoverflow.com/questions/35040650/loop-through-userform-paste-to-offset-cells", "title": "Loop Through Userform &amp; Paste to Offset Cells", "body": "<p>It's me again!</p>\n\n<p>I am trying to input data into a database with a userform by looping through each control and pasting it into a cell via an offset with a counter. I am getting an error on the line which actually inputs the data to the cell and cannot figure out how to do this via a loop. It would be easy to do it field by field but I do not want to write that many lines of code.</p>\n\n<p>Here is my most recent attempt:</p>\n\n<pre><code>Option Explicit\n\nSub cbSubmit_Click()\n' Set worksheet\nDim dbFood As Worksheet\nSet dbFood = Sheets(\"dbFood\")\n\n'Set last row and column\nDim lRow As Long\nlRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nDim lCol As Long\nlCol = Cells(1, Columns.Count).End(xlLeft).Row\n\n'Define idCell as Range type\nDim idCell As Range\n\n' If no records exit, add first record\nIf Cells(lRow, 1).Value = \"ID\" Then\n    Set idCell = dbFood.Range(\"A2\")\n    idCell.Value = 1\n\n' Add Data\nDim ufControl As Control\nDim Counter As Long\nCounter = 1\n\nFor Each ufControl In Me.Controls\n\nIf TypeOf ufControl Is MSForms.ComboBox Or MSForms.TextBox Then\nidCell.Offset(0, Counter).Value = ufField.Value\nCounter = Counter + 1\n\nEnd If\n\nNext ufControl\n\nMsgBox \"Added to database!\"\n\n' Else add next record\nElseIf Cells(lRow, 1).Value &gt;= 0.1 Then\n    Dim lastID As Long\n    lastID = Cells(lRow, 1).Value\n\n    Set idCell = dbFood.Cells(lRow + 1, 1)\n    idCell.Value = lastID + 1\n\n' Add Data\n\n\n' If none of the above display ERROR and exit sub\nElse: MsgBox (\"ERROR - Cannot Create Record\")\nExit Sub\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>If anyone could help me figure out how to solve this one then great!</p>\n"}, {"tags": ["vba", "excel", "charts"], "comments": [{"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1453906647, "post_id": 35040347, "comment_id": 57805723, "body": "Why <code>&quot;110%&quot;</code>??? Or is a Typo?? Can you share a screen shot of the chart??"}, {"owner": {"reputation": 131, "user_id": 1034643, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/677785807/picture?type=large", "display_name": "Tina Malina", "link": "https://stackoverflow.com/users/1034643/tina-malina"}, "reply_to_user": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1453907572, "post_id": 35040347, "comment_id": 57806426, "body": "It&#39;s not a typo, default value is 150%.  The value refers to the width (thickness) of the bar. If you want the spacing between bars to be thicker than the bars themselves, you set it to be over 100%.   Image: <a href=\"http://i.imgur.com/Y22eBjw.jpg\" rel=\"nofollow noreferrer\">i.imgur.com/Y22eBjw.jpg</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 1, "creation_date": 1454166826, "post_id": 35040949, "comment_id": 57927611, "body": "Next time you&#39;re stuck, turn on the macro recorder and do it manually. The code might be ugly, but it will give you a better insight into the syntax you need."}], "tags": [], "owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "is_accepted": true, "score": 3, "last_activity_date": 1596792269, "last_edit_date": 1596792269, "creation_date": 1453907311, "answer_id": 35040949, "question_id": 35040347, "link": "https://stackoverflow.com/questions/35040347/excel-vba-a-macro-to-format-data-series-gap-width-in-a-chart/35040949#35040949", "title": "Excel VBA - a macro to &#39;Format Data Series - Gap Width&#39; in a chart?", "body": "<p>You can try the following code:</p>\n<pre><code>ActiveChart.ChartGroups(1).GapWidth = 110\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 1034643, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/677785807/picture?type=large", "display_name": "Tina Malina", "link": "https://stackoverflow.com/users/1034643/tina-malina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4553, "favorite_count": 0, "accepted_answer_id": 35040949, "answer_count": 1, "score": 2, "last_activity_date": 1596792269, "creation_date": 1453905749, "last_edit_date": 1498509249, "question_id": 35040347, "link": "https://stackoverflow.com/questions/35040347/excel-vba-a-macro-to-format-data-series-gap-width-in-a-chart", "title": "Excel VBA - a macro to &#39;Format Data Series - Gap Width&#39; in a chart?", "body": "<p>I have to change the design of about 100 charts in Excel 2011, and I'm trying to speed things up a little with macros.</p>\n\n<p>The problem is that Excel doesn't want to simply record some actions into a macro, it seems they need to be manually written.</p>\n\n<p>I've managed to make a macro for changing the formatting of Data Labels using tips from this thread:\n<a href=\"https://stackoverflow.com/questions/21232870/formatting-data-labels-in-excel-charts-using-vba\">Formatting data labels in Excel charts using VBA</a></p>\n\n<p>But now I'd like to also edit Label Series- Gap Width percentage, through a macro. I don't know the exact VBA syntax for this action. Maybe someone here can help.</p>\n\n<p>I've tried </p>\n\n<pre><code>ActiveChart.SeriesCollection(1).DataSeries.GapWidth = \"110%\"\n</code></pre>\n\n<p>But it didn't work. Run-time error 438, Object doesn't support property or method.</p>\n\n<p>Does anyone know the correct syntax?  </p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1453906608, "post_id": 35040294, "comment_id": 57805686, "body": "Which application is the code for?  You&#39;ve used early binding on Excel and late binding on Outlook and you create an instance of both - <code>Set xlApp = GetObject(, &quot;Excel.Application&quot;)</code> and <code>Set OutLookApp = CreateObject(&quot;Outlook.application&quot;)</code>.  I added the code to Outlook and stepped through it - it failed on <code>Application.DisplayAlerts = True</code> as that&#39;s an Excel command (should be <code>xlApp.DisplayAlerts = True</code>).  <code>ActiveWorkbook</code> will also fail - set a reference to the workbook as well as the application and worksheet."}, {"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1453913344, "post_id": 35040294, "comment_id": 57810727, "body": "It&#39;s meant to be used in Excel. Thanks for the insights, I won&#39;t get a chance to test the code until next week. Cheers!"}], "answers": [{"comments": [{"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 0, "creation_date": 1453918968, "post_id": 35044176, "comment_id": 57814492, "body": "Thanks for this. I tested it on 2013 and works, but won&#39;t be until next week till I can test on 2010"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1453915884, "creation_date": 1453915884, "answer_id": 35044176, "question_id": 35040294, "link": "https://stackoverflow.com/questions/35040294/vba-code-works-on-excel-2013-but-not-excel-2010/35044176#35044176", "title": "VBA Code works on Excel 2013 but not Excel 2010;", "body": "<p>This code works for me in 2010.<br>\nYou'll need to give a worksheet the codename of <code>shtAnalysis</code> (look at Properties of the sheet in the Visual Basic Editor).<br>\nJust noticed - I haven't checked the type of the mail object, so will need to add that in.</p>\n\n<pre><code>Public Sub CreateReport()\n\n    Dim oOutlook As Object 'Outlook.Application\n    Dim nNameSpace As Object 'Outlook.Namespace\n    Dim mFolderSelected As Object 'Outlook.MAPIFolder\n\n    'GetObject also creates if need be with Outlook.\n    Set oOutlook = GetObject(, \"Outlook.Application\")\n    Set nNameSpace = oOutlook.GetNameSpace(\"MAPI\")\n\n    'Ask for a folder or get the Inbox.\n    'Set mFolderSelected = nNameSpace.PickFolder\n    Set mFolderSelected = nNameSpace.GetDefaultFolder(6) 'olFolderInbox\n\n    shtAnalysis.Cells.Delete Shift:=xlUp\n    shtAnalysis.Range(\"A1:D1\") = Array(\"Sent On\", \"Sender\", \"Subject\", \"Received\")\n\n    ProcessFolder mFolderSelected, oOutlook\n\nEnd Sub\n\nPrivate Sub ProcessFolder(oParent As Object, OLApp As Object)\n\n    Dim oFolder As Object 'Outlook.MAPIFolder\n    Dim oMail As Object\n    Dim sName As String\n\n    On Error Resume Next\n    For Each oMail In oParent.Items\n        PlaceDetails oMail, oParent, OLApp\n    Next oMail\n\n    If (oParent.Folders.Count &gt; 0) Then\n        For Each oFolder In oParent.Folders\n            ProcessFolder oFolder, OLApp\n        Next oFolder\n    End If\n    On Error GoTo 0\n\nEnd Sub\n\nPrivate Sub PlaceDetails(oMailItem As Object, oFolder As Object, OLApp As Object)\n\n    Dim rLastCell As Range\n\n    Set rLastCell = LastCell(shtAnalysis).Offset(1)\n\n    With shtAnalysis\n        .Cells(rLastCell.Row, 1) = oMailItem.SentOn\n        .Cells(rLastCell.Row, 2) = ResolveDisplayNameToSMTP(oMailItem.senderemailaddress, OLApp)\n        .Cells(rLastCell.Row, 3) = oMailItem.Subject\n        .Cells(rLastCell.Row, 4) = oMailItem.receivedtime\n    End With\n\nEnd Sub\n\n'----------------------------------------------------------------------------------\n' Procedure : ResolveDisplayNameToSMTP\n' Author    : Sue Mosher - updated by D.Bartrup-Cook to work in Excel late binding.\n'-----------------------------------------------------------------------------------\nPrivate Function ResolveDisplayNameToSMTP(sFromName, OLApp As Object) As String\n\n    Select Case Val(OLApp.Version)\n        Case 11 'Outlook 2003\n\n            Dim oSess As Object\n            Dim oCon As Object\n            Dim sKey As String\n            Dim sRet As String\n\n            Set oCon = OLApp.CreateItem(2) 'olContactItem\n\n            Set oSess = OLApp.GetNameSpace(\"MAPI\")\n            oSess.Logon \"\", \"\", False, False\n            oCon.Email1Address = sFromName\n            sKey = \"_\" &amp; Replace(Rnd * 100000 &amp; Format(Now, \"DDMMYYYYHmmss\"), \".\", \"\")\n            oCon.FullName = sKey\n            oCon.Save\n\n            sRet = Trim(Replace(Replace(Replace(oCon.email1displayname, \"(\", \"\"), \")\", \"\"), sKey, \"\"))\n            oCon.Delete\n            Set oCon = Nothing\n\n            Set oCon = oSess.GetDefaultFolder(3).Items.Find(\"[Subject]=\" &amp; sKey) '3 = 'olFolderDeletedItems\n            If Not oCon Is Nothing Then oCon.Delete\n\n            ResolveDisplayNameToSMTP = sRet\n\n        Case 14 'Outlook 2010\n\n            Dim oRecip As Object 'Outlook.Recipient\n            Dim oEU As Object 'Outlook.ExchangeUser\n            Dim oEDL As Object 'Outlook.ExchangeDistributionList\n\n            Set oRecip = OLApp.Session.CreateRecipient(sFromName)\n            oRecip.Resolve\n            If oRecip.Resolved Then\n                Select Case oRecip.AddressEntry.AddressEntryUserType\n                    Case 0, 5 'olExchangeUserAddressEntry &amp; olExchangeRemoteUserAddressEntry\n                        Set oEU = oRecip.AddressEntry.GetExchangeUser\n                        If Not (oEU Is Nothing) Then\n                            ResolveDisplayNameToSMTP = oEU.PrimarySmtpAddress\n                        End If\n                    Case 10, 30 'olOutlookContactAddressEntry &amp; 'olSmtpAddressEntry\n                            ResolveDisplayNameToSMTP = oRecip.AddressEntry.Address\n                End Select\n            Else\n                ResolveDisplayNameToSMTP = sFromName\n            End If\n        Case Else\n            'Name not resolved so return sFromName.\n            ResolveDisplayNameToSMTP = sFromName\n    End Select\nEnd Function\n\n'---------------------------------------------------------------------------------------\n' Procedure : LastCell\n' Author    : Darren Bartrup-Cook\n' Date      : 26/11/2013\n' Purpose   : Finds the last cell containing data or a formula within the given worksheet.\n'             If the Optional Col is passed it finds the last row for a specific column.\n'---------------------------------------------------------------------------------------\nPrivate Function LastCell(wrkSht As Worksheet, Optional Col As Long = 0) As Range\n\n    Dim lLastCol As Long, lLastRow As Long\n\n    On Error Resume Next\n\n    With wrkSht\n        If Col = 0 Then\n            lLastCol = .Cells.Find(\"*\", , , , xlByColumns, xlPrevious).Column\n            lLastRow = .Cells.Find(\"*\", , , , xlByRows, xlPrevious).Row\n        Else\n            lLastCol = .Cells.Find(\"*\", , , , xlByColumns, xlPrevious).Column\n            lLastRow = .Columns(Col).Find(\"*\", , , , xlByColumns, xlPrevious).Row\n        End If\n\n        If lLastCol = 0 Then lLastCol = 1\n        If lLastRow = 0 Then lLastRow = 1\n\n        Set LastCell = wrkSht.Cells(lLastRow, lLastCol)\n    End With\n    On Error GoTo 0\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 35044176, "answer_count": 1, "score": 1, "last_activity_date": 1593517630, "creation_date": 1453905645, "last_edit_date": 1593517630, "question_id": 35040294, "link": "https://stackoverflow.com/questions/35040294/vba-code-works-on-excel-2013-but-not-excel-2010", "title": "VBA Code works on Excel 2013 but not Excel 2010;", "body": "<p>This code I found on SO works perfectly on Excel 2013 but not on Excel 2010. The code executes on 2010 but halfway through running, it produces an </p>\n\n<blockquote>\n  <p>\"Object not defined error\" at <code>xlSh.Range(\"A1\").Resize(UBound(aOutput, 1), UBound(aOutput, 2)).Value = aOutput</code>. </p>\n</blockquote>\n\n<p>The new output workbook does indeed have the information I require, but only half of it. So it seems that the code runs smoothly until something messes up, but I can't source from where the error starts.</p>\n\n<p>If anyone has 2010 and can give me some insights that would be great. </p>\n\n<pre><code>Option Explicit\n\nDim aOutput() As Variant\nDim lCnt As Long\n\nSub SubFolders()\n'\n' Code for Outlook versions 2007 and subsequent\n' Declare with Folder rather than MAPIfolder\n'\nDim xlApp As Excel.Application\nDim xlSh As Excel.Worksheet\nDim wbo As Workbook\nDim olNs As Namespace\nDim OutLookApp As Object\nDim OutLookMailItem As Object\nDim olParentFolder As Folder\nDim subj As String\nDim bod As String\nDim MailDest As String\n\n\nSet olNs = GetNamespace(\"MAPI\")\nSet olParentFolder = olNs.GetDefaultFolder(olFolderInbox)\n\nlCnt = 0\nReDim aOutput(1 To 100000, 1 To 5)\n\nProcessFolder olParentFolder\n\nOn Error Resume Next\nSet xlApp = GetObject(, \"Excel.Application\")\nOn Error GoTo 0\nIf xlApp Is Nothing Then Set xlApp = CreateObject(\"Excel.Application\")\n\nSet xlSh = xlApp.Workbooks.Add.Sheets(1)\n\nxlSh.Range(\"A1\").Resize(UBound(aOutput, 1), UBound(aOutput, 2)).Value = aOutput\nxlApp.Visible = True\n\nApplication.DisplayAlerts = False\n\nxlSh.SaveAs Filename:=\"C:\\Users\\rliu\\Desktop\\BarryReport.xls\", FileFormat:=56\n\n\nActiveWorkbook.Close SaveChanges:=True\n\n\n\nSet OutLookApp = CreateObject(\"Outlook.application\")\n    Set OutLookMailItem = OutLookApp.CreateItem(0)\n\n    With OutLookMailItem\n        subj = \"\"\n        MailDest = \"anemail@myemail.com\"\n        bod = \"\"\n\n        .BCC = MailDest\n        .Subject = \"Barry Monthly Update\"\n        .Body = \" \"\n        .Attachments.Add (\"C:\\Users\\rliu\\Desktop\\BarryReport.xls\")\n        .Send\n\n        End With\n\n\n\nApplication.DisplayAlerts = True\n\nExitRoutine:\n    Set olNs = Nothing\n    Set olParentFolder = Nothing\n    Set xlApp = Nothing\n    Set xlSh = Nothing\n\n\nEnd Sub\n\nPrivate Sub ProcessFolder(ByVal oParent As Folder)\n\nDim oFolder As Folder\nDim oMail As Object\nDim wbo As Workbook\n\n\nFor Each oMail In oParent.Items\n\n    If TypeName(oMail) = \"MailItem\" Then\n        lCnt = lCnt + 1\n        aOutput(lCnt, 1) = oMail.SenderEmailAddress\n        aOutput(lCnt, 2) = oMail.ReceivedTime\n        aOutput(lCnt, 3) = oMail.Subject\n    End If\n\nNext\n\nIf (oParent.Folders.Count &gt; 0) Then\n    For Each oFolder In oParent.Folders\n        ProcessFolder oFolder\n    Next\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453907901, "post_id": 35040099, "comment_id": 57806675, "body": "where is your code failing to do what you want? what results do you get when you loop through that and what do you expect?"}, {"owner": {"reputation": 11, "user_id": 5847133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2bde890fbf5fb291baed5a7738163b?s=128&d=identicon&r=PG&f=1", "display_name": "ronald hopman", "link": "https://stackoverflow.com/users/5847133/ronald-hopman"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453918660, "post_id": 35040099, "comment_id": 57814288, "body": "MsgBox (TDelements2.Item(i).innertext) is where the code fails. I use the msgbox to see what returns before putting this in an excel cell. I was hoping to get the rate from the website returned in the msgbox."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530637235, "post_id": 35040099, "comment_id": 89302629, "body": "Was &quot;properrounding(&quot; present anywhere else? You could split on this."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1530637829, "creation_date": 1530637829, "answer_id": 51159832, "question_id": 35040099, "link": "https://stackoverflow.com/questions/35040099/excel-vba-web-scaping-element-challenge/51159832#51159832", "title": "Excel VBA web scaping element challenge", "body": "<p>You could parse the <code>document.body.innerHTML</code> for that string. Let's say you were using <code>properrounding</code> to target the section of interest. </p>\n\n<p>Using just the HTML as a guide, you would have</p>\n\n<pre><code>Debug.Print Replace(Split(Split(.document.body.innerHTML, \" properrounding(\")(2), \", 2\")(0), Chr$(39), vbNullString)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5847133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2bde890fbf5fb291baed5a7738163b?s=128&d=identicon&r=PG&f=1", "display_name": "ronald hopman", "link": "https://stackoverflow.com/users/5847133/ronald-hopman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1530637829, "creation_date": 1453905080, "last_edit_date": 1459771831, "question_id": 35040099, "link": "https://stackoverflow.com/questions/35040099/excel-vba-web-scaping-element-challenge", "title": "Excel VBA web scaping element challenge", "body": "<p>I am trying to collect pricing data from a travel website. </p>\n\n<p>Below is the HTML and I want to retrieve the number 2145.66 and put that in an Excel Cell.</p>\n\n<pre><code>&lt;ul class=\"hotelresults\"&gt; \n\n&lt;li class=\"image\"&gt;&lt;img src=\"http://images.libertytravel.com/shared/cpl/fcl/images/upload/suppliers/H/AUA/REM/img_148208_MEDIUM.jpg\" width=\"120\" onerror=\"this.src='/images/book.libertytravel.com/no-pic.gif';\"&gt;&lt;/li&gt;\n&lt;li class=\"detail\"&gt;\n&lt;h4&gt;Renaissance Marina Hotel &amp;nbsp;&lt;img src=\"http://static0.traveltek.net/images/book.libertytravel.com/1star.png\" alt=\"Star\"&gt;&lt;img src=\"http://static0.traveltek.net/images/book.libertytravel.com/1star.png\" alt=\"Star\"&gt;&lt;img src=\"http://static0.traveltek.net/images/book.libertytravel.com/1star.png\" alt=\"Star\"&gt;&lt;img src=\"http://static0.traveltek.net/images/book.libertytravel.com/1star.png\" alt=\"Star\"&gt;&lt;/h4&gt;\n&lt;span class=\"myTime\"&gt;&lt;/span&gt;&lt;span class=\"hotelPref\"&gt;&lt;/span&gt;\n&lt;h5&gt;Aruba&lt;/h5&gt;\n&lt;span id=\"desc_555_0.1\"&gt;Experience a fresh twist on stay and play in a stylish, sophisticated atmosphere at the Renaissance Aruba Resort and Casino. &lt;/span&gt;&lt;a href=\"/fusion/searchsinglehotel.pl?sessionkey=F5AFD4B1-782Cl4A8B-9B26-AC8EAE88C1E5&amp;amp;chosenhotel=555_0.1&amp;amp;chosenflight=617_0.0\"&gt;See Details&lt;/a&gt;\n&lt;/li&gt;\n&lt;li class=\"price\"&gt;\n    &lt;script language=\"Javascript\"&gt;\nEvent.observe(window, \"load\", function() {\n\n$$('span.roomprice').each(function(element) {\n         element.innerHTML = properrounding(element.innerHTML, 2);\n     });\n\n});\n&lt;/script&gt;\n\n&lt;table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" class=\"roomsrow\"&gt;\n    &lt;tr class=\"hide\"&gt;\n        &lt;td colspan=\"3\" class=\"sectionHeader\"&gt;\n            &lt;a href=\"#\" onclick=\"showmore('hotelDetails'); return false\"&gt;\n                &lt;div id=\"hotelExpand\"&gt;\n                    &lt;div class=\"plusMinus\"&gt;&lt;/div&gt;\n                &lt;/div&gt; Show/Hide extra room selections\n            &lt;/a&gt;\n        &lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;td colspan=\"3\" style=\"border:none\"&gt;\n\n            &lt;div id=\"hotelDetails\" style=\"display:none\"&gt;\n\n                &lt;table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\"&gt;        \n                    &lt;tr class=\"hide\"&gt;\n                        &lt;th align=\"left\"&gt;Room Description&lt;/th&gt;\n                        &lt;th align=\"right\"&gt;Total Basket Cost&lt;/th&gt;\n                        &lt;th&gt;&amp;nbsp;&lt;/th&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                    &lt;td colspan=\"3\"&gt;\n                    &lt;script language=\"Javascript\"&gt;\nEvent.observe(window, \"load\", function() {\n\n$('rightprice_div_555_0.1_555:0').innerHTML = properrounding('2145.66', 2);\n</code></pre>\n\n<p>My code is as follows:</p>\n\n<pre><code>r = 0\nc = 0\n\nSet TDelements2 = .document.getelementsbyclassname(\"price\")\nl = TDelements2.Length\n\nFor i = 0 To l\n\nMsgBox (TDelements2.Item(i).innertext)\nMsgBox (i)\ni = i + 0\n\nSheet2.Range(\"A1\").Offset(r, c).Value = TDelements2.Item(i).innertext\nr = r + 1\nc = c + 0\nNext\n</code></pre>\n\n<p>However, this in not returning the rate/number I am looking for.</p>\n\n<p>Any help/suggestions are appreciated. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453904937, "post_id": 35039882, "comment_id": 57804375, "body": "<code>Dim varData as Range</code> and <code>varContent as String</code>? Otherwise, what line do you get the error on?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1453906512, "post_id": 35039882, "comment_id": 57805615, "body": "Also, I&#39;d look in to <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\"><code>avoiding the use of .Select&#47;.ActiveCell</code></a>, which may also cause some issues."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 1, "creation_date": 1453907777, "post_id": 35039882, "comment_id": 57806576, "body": "Merged cells is the greatest evil in Excel and VBA. Don&#39;t use it."}, {"owner": {"reputation": 23, "user_id": 5847227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c36ba249bddc912c535ce83daa75028?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Anderson", "link": "https://stackoverflow.com/users/5847227/cory-anderson"}, "edited": false, "score": 0, "creation_date": 1453993187, "post_id": 35039882, "comment_id": 57852628, "body": "Scott, I made your changes with no luck.  The behavior is the same.  It&#39;s giving me the error on the line  &#39;Range (strMyRange) .Merge&#39;  I believe that the strMyRange variable gets too long.  Is there away of putting my merge statement in the For loop and after merging to drop off the set of merged cells?"}], "answers": [{"tags": [], "owner": {"reputation": 832, "user_id": 5137019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b5d97d531f0c8180ad9543cb5efc530?s=128&d=identicon&r=PG&f=1", "display_name": "dev1998", "link": "https://stackoverflow.com/users/5137019/dev1998"}, "is_accepted": false, "score": 0, "last_activity_date": 1454100491, "creation_date": 1454100491, "answer_id": 35093781, "question_id": 35039882, "link": "https://stackoverflow.com/questions/35039882/merge-cells-with-duplicate-data-vba/35093781#35093781", "title": "Merge Cells with Duplicate Data VBA", "body": "<p>I have recreated the issue using the code you posted and it is working for me. I did what you suggested and put the merge into the For loop. Then I split strMyRange using the comma as the delimiter. I set up a test to look for the \":\" character in TestArray(0). If it is in that target string, then I know it is ready for the merge. After that I reset strMyRange to the TestArray(1) which is the beginning of the next range.</p>\n\n<p>Note: I was able to step through it with the debugger with 100 cells and it worked. Then I tried running it without any code breakpoints, but it merged all the selected cells. I put a 1 second wait statement right before the final merge and that seems to work.</p>\n\n<p>Here is the code:</p>\n\n<pre><code> Sub MergeDuplicates()\n Dim varData As Variant, varContent As Variant\n Dim strMyRange As String\n Dim TestArray() As String\n Dim target As String\n Dim pos As Integer\n\n\n\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n strMyRange = ActiveCell.Address\n varContent = ActiveCell.Value\n For Each varData In Selection.Cells\n     If varData.Value &lt;&gt; varContent Then\n         strMyRange = strMyRange &amp; \":\" &amp; Cells(varData.Row - 1, varData.Column).Address &amp; \", \" &amp; Cells(varData.Row, varData.Column).Address\n         TestArray = Split(strMyRange, \",\")\n         target = TestArray(0)\n         pos = InStr(target, \":\")\n         If (pos &gt; 0) Then\n            Range(target).Merge\n            strMyRange = TestArray(1)\n         End If\n         varContent = Cells(varData.Row, varData.Column).Value\n     End If\n Next\n strMyRange = strMyRange &amp; Mid(Selection.Address, InStr(1, Selection.Address, \":\"), Len(Selection.Address))\n Application.Wait (Now + #12:00:01 AM#) 'This helps the application run OK if there are no breakpoints.\n Range(strMyRange).Merge\n Application.DisplayAlerts = True\n Application.ScreenUpdating = True\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5847227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c36ba249bddc912c535ce83daa75028?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Anderson", "link": "https://stackoverflow.com/users/5847227/cory-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 374, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1454100491, "creation_date": 1453904504, "question_id": 35039882, "link": "https://stackoverflow.com/questions/35039882/merge-cells-with-duplicate-data-vba", "title": "Merge Cells with Duplicate Data VBA", "body": "<p>I'm trying to get a Macro working to merge cells with duplicate data.  It will work on small numbers of cells, but I get the following error if I try to run it on a larger group of cells.  I'm not sure if there's a more efficient way for excel to run through this.</p>\n\n<p>Run-Time error '1004':\nMethod 'Range' of object '_Global' failed </p>\n\n<p>Here's the code:</p>\n\n<pre><code>Sub MergeDuplicates()\n Dim varData As Variant, varContent As Variant\n Dim strMyRange As String\n Application.ScreenUpdating = False\n Application.DisplayAlerts = False\n     strMyRange = ActiveCell.Address\n     varContent = ActiveCell.Value\n     For Each varData In Selection.Cells\n         If varData.Value &lt;&gt; varContent Then\n             strMyRange = strMyRange &amp; \":\" &amp; Cells(varData.Row - 1, varData.Column).Address &amp; \", \" &amp; Cells(varData.Row, varData.Column).Address\n             varContent = Cells(varData.Row, varData.Column).Value\n         End If\n     Next\n     strMyRange = strMyRange &amp; Mid(Selection.Address, InStr(1, Selection.Address, \":\"), Len(Selection.Address))\n     Range(strMyRange).Merge\n Application.DisplayAlerts = True\n Application.ScreenUpdating = True\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1453904386, "post_id": 35039754, "comment_id": 57803943, "body": "Change the <code>&quot;A&quot;</code> to the column number <code>1</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1453904711, "post_id": 35039754, "comment_id": 57804199, "body": "And there is no row at -1 cells is not relative to active cell but the parent. In this case the active sheet. You are looking for r1c1"}], "answers": [{"tags": [], "owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "is_accepted": true, "score": 1, "last_activity_date": 1453906134, "creation_date": 1453906134, "answer_id": 35040499, "question_id": 35039754, "link": "https://stackoverflow.com/questions/35039754/vba-insert-formula-with-dynamic-cell-reference/35040499#35040499", "title": "VBA insert formula with dynamic cell reference", "body": "<p>Use the offset to reference a cell relative to another. </p>\n\n<pre><code>ActiveCell.Offset(-1, 0)\n</code></pre>\n\n<p>if the activecell is A4 then the offset refers to A3. use <code>.Address</code> property to get the address you need in a formula. for example:</p>\n\n<pre><code>ActiveCell.Formula = \"=\" &amp; ActiveCell.Offset(-1, 0).Address\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5847159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a9942c773f8383dee60ec9600a6cfda?s=128&d=identicon&r=PG&f=1", "display_name": "ssnch", "link": "https://stackoverflow.com/users/5847159/ssnch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2612, "favorite_count": 0, "accepted_answer_id": 35040499, "answer_count": 1, "score": 1, "last_activity_date": 1453906134, "creation_date": 1453904129, "last_edit_date": 1531164843, "question_id": 35039754, "link": "https://stackoverflow.com/questions/35039754/vba-insert-formula-with-dynamic-cell-reference", "title": "VBA insert formula with dynamic cell reference", "body": "<p>I am creating subtotals and would like to have in the empty cells (no sum) of the subtotal line reference the cell above. The formula would reference the cell above. For example: if row 4 is the subtotal line and cell A4 is an empty cell than I was the formula in A4 to read \"=A3\"</p>\n\n<pre><code>ActiveCell.Formula = \"=\" &amp; Cells(-1, \"A\").Address(False, False)\n</code></pre>\n\n<p>I have the above code written but I get Run-time error 1004 Application -defined or object defined error.</p>\n\n<p>I have also tried the code below but error out as well.</p>\n\n<pre><code>ActiveCell.Formula = \"=\" &amp; Cells(-1, A).Address(False, False)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5436308, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/be7c36f1aea401252ccb3e513eef0c19?s=128&d=identicon&r=PG&f=1", "display_name": "Maya", "link": "https://stackoverflow.com/users/5436308/maya"}, "edited": false, "score": 0, "creation_date": 1453958194, "post_id": 35041001, "comment_id": 57830776, "body": "One More Question: 1) Is it possible to disable the picture selection without protecting the sheet ?"}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "reply_to_user": {"reputation": 29, "user_id": 5436308, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/be7c36f1aea401252ccb3e513eef0c19?s=128&d=identicon&r=PG&f=1", "display_name": "Maya", "link": "https://stackoverflow.com/users/5436308/maya"}, "edited": false, "score": 0, "creation_date": 1453969095, "post_id": 35041001, "comment_id": 57835565, "body": "Is the above code is working? If yes please accept it as an answer (tick mark) and please ask the new question in an another post so that everyone will come to know.."}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1453982430, "post_id": 35041001, "comment_id": 57844451, "body": "what is the error message you get and on which line?"}, {"owner": {"reputation": 29, "user_id": 5436308, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/be7c36f1aea401252ccb3e513eef0c19?s=128&d=identicon&r=PG&f=1", "display_name": "Maya", "link": "https://stackoverflow.com/users/5436308/maya"}, "edited": false, "score": 0, "creation_date": 1453985384, "post_id": 35041001, "comment_id": 57846608, "body": "&quot;The Password you supplied is not correct.Verfiy that the CAPS LOCK key is off and be sure to use the correct capitalization&quot;. Eventhough i&#39;ve given the correct password."}], "tags": [], "owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "is_accepted": false, "score": 0, "last_activity_date": 1453907428, "last_edit_date": 1495541757, "creation_date": 1453907428, "answer_id": 35041001, "question_id": 35039562, "link": "https://stackoverflow.com/questions/35039562/unprotect-not-working-in-excel-2013/35041001#35041001", "title": "Unprotect not working in excel 2013", "body": "<p>Password should be given as given below, please try the below code..</p>\n\n<pre><code>Sheets(\"test\").unProtect \"aaaa\"\n\nSheets(\"test\").Protect \"aaaa\"\n</code></pre>\n\n<p>FYR <a href=\"https://stackoverflow.com/questions/3690793/how-to-protect-excel-workbook-using-vba\">click here</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5857081"}, "is_accepted": false, "score": 0, "last_activity_date": 1454312767, "creation_date": 1454312767, "answer_id": 35125314, "question_id": 35039562, "link": "https://stackoverflow.com/questions/35039562/unprotect-not-working-in-excel-2013/35125314#35125314", "title": "Unprotect not working in excel 2013", "body": "<p>You can try the following codes:</p>\n\n<pre><code>Sub sheetUnprotect()\n    ThisWorkbook.Sheets(\"test\").Unprotect \"aaaa\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5436308, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/be7c36f1aea401252ccb3e513eef0c19?s=128&d=identicon&r=PG&f=1", "display_name": "Maya", "link": "https://stackoverflow.com/users/5436308/maya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1424, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1454312767, "creation_date": 1453903617, "last_edit_date": 1453904471, "question_id": 35039562, "link": "https://stackoverflow.com/questions/35039562/unprotect-not-working-in-excel-2013", "title": "Unprotect not working in excel 2013", "body": "<p>I've a macro which unprotect the sheet and do some calculation and protect the sheet after calculation. </p>\n\n<pre><code>Sheets(\"test\").unProtect Password:=\"aaaa\"\n\n'calculation\n\nSheets(\"test\").Protect Password:=\"aaaa\", AllowFormattingcells:=true\n</code></pre>\n\n<p>It works fine in excel 2010, but in excel 2013 sheet is not unprotected and throws error.</p>\n\n<p>I don't know what mistake I made? Please help me to get rid of this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1453903980, "post_id": 35039556, "comment_id": 57803605, "body": "What doesn&#39;t work?  Have you tried stepping through your code in the VBA editor (with F8)?  I think that will reveal what is going wrong."}, {"owner": {"reputation": 121, "user_id": 5144196, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6bb748d8cbf37e4d99c47303d9811f84?s=128&d=identicon&r=PG&f=1", "display_name": "Sree", "link": "https://stackoverflow.com/users/5144196/sree"}, "reply_to_user": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1453904014, "post_id": 35039556, "comment_id": 57803622, "body": "If the value is not empty i get green color but if the value is empty or blank its does not set to Colorindex 3. Any help is appreciated"}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1453904126, "post_id": 35039556, "comment_id": 57803723, "body": "Then step up to the line with the = &quot;&quot; check, pause it there, and put this in the Immediate window: Debug.Print rs.Fields.Item(n)    &lt;enter&gt;"}, {"owner": {"reputation": 121, "user_id": 5144196, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6bb748d8cbf37e4d99c47303d9811f84?s=128&d=identicon&r=PG&f=1", "display_name": "Sree", "link": "https://stackoverflow.com/users/5144196/sree"}, "reply_to_user": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1453904851, "post_id": 35039556, "comment_id": 57804300, "body": "when the value is Empty rs.EOF is true. and its not stepping to For loop so  Is there any way I can do if rs is empty I can change the cell to red"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 5144196, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6bb748d8cbf37e4d99c47303d9811f84?s=128&d=identicon&r=PG&f=1", "display_name": "Sree", "link": "https://stackoverflow.com/users/5144196/sree"}, "edited": false, "score": 0, "creation_date": 1453908853, "post_id": 35041194, "comment_id": 57807452, "body": "rs.EOF is true and its exiting the if loop and not reaching For so the reverse code could not help me \u2013 if the value is empty rs. EOF is true"}], "tags": [], "owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "is_accepted": false, "score": 0, "last_activity_date": 1453907953, "creation_date": 1453907953, "answer_id": 35041194, "question_id": 35039556, "link": "https://stackoverflow.com/questions/35039556/change-the-color-of-the-cell-to-red-if-the-value-in-the-database-is-empty/35041194#35041194", "title": "Change the color of the cell to red if the value in the Database is empty", "body": "<p>Try the same code in reverse..</p>\n\n<pre><code>If UCase(rs.Fields.Item(n)) &lt;&gt; \"\" Then\n    objSheet.Cells(iRow, iCol).Interior.ColorIndex = 4\n    Else\n    objSheet.Cells(iRow, iCol).Interior.ColorIndex = 3\nEnd If\n</code></pre>\n\n<p>Hope this will help you :)</p>\n"}], "owner": {"reputation": 121, "user_id": 5144196, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6bb748d8cbf37e4d99c47303d9811f84?s=128&d=identicon&r=PG&f=1", "display_name": "Sree", "link": "https://stackoverflow.com/users/5144196/sree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459771847, "creation_date": 1453903598, "last_edit_date": 1459771847, "question_id": 35039556, "link": "https://stackoverflow.com/questions/35039556/change-the-color-of-the-cell-to-red-if-the-value-in-the-database-is-empty", "title": "Change the color of the cell to red if the value in the Database is empty", "body": "<p>I have developed Excel Macros, Which fetches the data from the database. I want to change the color of the cell if the value in the database is empty. I have this code. But the below code  does not work.</p>\n\n<pre><code>If Not rs.EOF Then\nFor n = 0 To rs.Fields.Count - 1\n   objSheet.Cells(iRow, iCol).Value = rs.Fields.Item(n)\n         If UCase(rs.Fields.Item(n).Name) = \"ORDER_STATUS\" Then\n            If UCase(rs.Fields.Item(n)) = \"\" Then\n                objSheet.Cells(iRow, iCol).Interior.ColorIndex = 3\n                  Else\n                   objSheet.Cells(iRow, iCol).Interior.ColorIndex = 4\n                    End If\n                      End If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453903077, "post_id": 35039249, "comment_id": 57802886, "body": "Welcome to SO. You will receive <i>a lot</i> more help if you read <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a> and edit your question with your coding efforts and let us know where it is failing."}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453903276, "post_id": 35039249, "comment_id": 57803047, "body": "As @ScottHoltzman says please read the <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a>. Provide screenshots of you data and how you try to acomplish your job, and we will help you."}, {"owner": {"reputation": 1, "user_id": 5847096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2823487ffc3d025495a2fb98757e02d?s=128&d=identicon&r=PG&f=1", "display_name": "M. Wilmot", "link": "https://stackoverflow.com/users/5847096/m-wilmot"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453903752, "post_id": 35039249, "comment_id": 57803420, "body": "Cheers @ScottHoltzman and ElbertV,  will do - Matt"}], "answers": [{"tags": [], "owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "is_accepted": false, "score": 0, "last_activity_date": 1453920116, "creation_date": 1453920116, "answer_id": 35045488, "question_id": 35039249, "link": "https://stackoverflow.com/questions/35039249/vba-copy-list-of-years-in-column-up-to-keyword/35045488#35045488", "title": "VBA Copy list of years in column up to keyword", "body": "<p>Give this a try: </p>\n\n<pre><code>Sub getInfo()\nDim counter As Integer, lastRow As Integer\ncounter = 1\nlastRow = Cells.Find(What:=\"Grand Total\", After:=[A4], SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\nFor i = 4 To lastRow\n    If Cells(counter, 1).Value &lt; lastRow Then\n        counter = counter + 1\n    End If\nNext i\n\nRange(\"A4:A\" &amp; counter + 1).Copy Destination:=Sheets(\"Sheet2\").Columns(1)\nSheets(\"Sheet2\").Activate\nFor i = 1 To lastRow\n    If Cells(i, 1).Value = \"\" Then\n        Cells(i, 1).Delete\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5847096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2823487ffc3d025495a2fb98757e02d?s=128&d=identicon&r=PG&f=1", "display_name": "M. Wilmot", "link": "https://stackoverflow.com/users/5847096/m-wilmot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453920116, "creation_date": 1453902790, "question_id": 35039249, "link": "https://stackoverflow.com/questions/35039249/vba-copy-list-of-years-in-column-up-to-keyword", "title": "VBA Copy list of years in column up to keyword", "body": "<p>I'm currently trying to create a feedback sheet on Excel, I am completely new to VBA. </p>\n\n<p>I have a column populated with years (2014...2015 etc..) starting in cell A4 (sheet 1) continuing until the cell containing \"Grand Total\"</p>\n\n<p>I would like copy all of the years up to the \"Grand Total\" cell in this column to sheet 2, bearing in mind that the year values and row locations are constantly changing...I would also like the new list on sheet 2 to not include the empty rows that are present between the years on sheet 1.</p>\n\n<p>Any tips?</p>\n\n<p>Cheers, \nMatt</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 1, "creation_date": 1453902252, "post_id": 35038902, "comment_id": 57802308, "body": "are you deleting a range on the General Input sheet?  That will cause ref errors..."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 3, "creation_date": 1453902441, "post_id": 35038902, "comment_id": 57802450, "body": "At some point, those REF! items pointed to particularly places which no longer exist. Either the cells themselves were deleted, or a link to another workbook was cut, or they referred to a legitimate location once but were copied elsewhere and the relative reference ran it off the page. There is no way to get it back without accessing a version of the file without these errors, or manually recreating the references yourself."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1453902989, "post_id": 35038902, "comment_id": 57802817, "body": "If there are macros within the file, it&#39;s quit possible that something in the code execution does something to wipe out the reference as @Grade&#39;Eh&#39;Bacon points out."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1453917784, "post_id": 35038902, "comment_id": 57813745, "body": "A good rule of thumb is to <i>always</i> check for instances of #REF! as you change a workbook. Allowing invalid references to creep in &quot;when they dont matter&quot; makes it harder to see them when they really do matter."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5846891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9289fcfc5b7138a2482489fc6fbe9b3a?s=128&d=identicon&r=PG&f=1", "display_name": "caito", "link": "https://stackoverflow.com/users/5846891/caito"}, "edited": false, "score": 0, "creation_date": 1454334256, "post_id": 35097389, "comment_id": 57983720, "body": "Thank all of you for the help. Unfortunately I don&#39;t have the original file without these errors, so I will have to give up."}], "tags": [], "owner": {"reputation": 33, "user_id": 5857337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66590c214b83ad737f58e7b23b63d28d?s=128&d=identicon&r=PG&f=1", "display_name": "Ted", "link": "https://stackoverflow.com/users/5857337/ted"}, "is_accepted": false, "score": 0, "last_activity_date": 1454121903, "creation_date": 1454121903, "answer_id": 35097389, "question_id": 35038902, "link": "https://stackoverflow.com/questions/35038902/all-reference-values-in-excel-sheet-becomes-ref-when-refering-values-from-an/35097389#35097389", "title": "All reference values in Excel sheet becomes &#39;!#REF! when refering values from another sheet", "body": "<p>!#REF! used to be a cell reference - e.g. $G$9</p>\n\n<pre><code> ='General Input'!#REF!*(0.0063/0.0111)*EXP(-1*0.0214*$C$9)\n</code></pre>\n\n<p>However, such link/reference to G9 doesn't exist anymore - e.g. G9 was deleted.</p>\n\n<p>The best hope is that you saved different version of such Excel. If yes, go back to an older version and copy those formula.</p>\n\n<p>Good luck.</p>\n"}], "owner": {"reputation": 29, "user_id": 5846891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9289fcfc5b7138a2482489fc6fbe9b3a?s=128&d=identicon&r=PG&f=1", "display_name": "caito", "link": "https://stackoverflow.com/users/5846891/caito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1454121903, "creation_date": 1453901910, "last_edit_date": 1453903852, "question_id": 35038902, "link": "https://stackoverflow.com/questions/35038902/all-reference-values-in-excel-sheet-becomes-ref-when-refering-values-from-an", "title": "All reference values in Excel sheet becomes &#39;!#REF! when refering values from another sheet", "body": "<p>One of our excel program stops working and I am trying to figure out why.</p>\n\n<p>In the program, there are multiple sheets. The one cannot calculate value is called \"Piston\", and the reason is that all reference values from another sheet called \"General Input\" fail to refer.</p>\n\n<p>The following are some failed cells in \"Piston\" sheets:</p>\n\n<pre><code>='General Input'!#REF!*(0.0063/0.0111)*EXP(-1*0.0214*$C$9)\n='General Input'!#REF!*EXP(-1*0.0214*$C$9)\n=AB5*(AD5+AC5*DG5)/(AD5+AB5*DG5)/'General Input'!#REF!\n=$C$8*0.0000032/('General Input'!#REF!*Piston!$C$4*Piston!N10*(2*$C$6/1000)^2*('General Input'!$C$16/1000)^2)\n=((BV9^3)*(BQ9^2)/DJ9/8+(BW9^3)*(BR9^2)/DK9/4+(BX9^3)*(BS9^2)/AE9/4+(BY9^3)*(BT9^2)/DL9/4+(BZ9^3)*(BU9^2)/DM9/8)/12/'General Input'!#REF!*$G$26/(1000000)^3\n</code></pre>\n\n<p>Apparantly all different values in \"General Input\" fail suddenly at the same time. I am not the one who wrote the code, and I don't use it as well. I am just asked to fix the bug.</p>\n\n<p>But I just want to ask, is there any reason that suddenly make all referred value fail from a sheet?</p>\n\n<p>Sorry if the information I provided is too vague.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 3, "creation_date": 1453901404, "post_id": 35038638, "comment_id": 57801720, "body": "the line <code>username.Value = &quot;&quot;</code> indicates that the <code>username</code> variable <i>should be</i> set as a <code>Range</code>. It appears in your code that <code>username</code> is a variant type, since you do not ever declare <code>username</code> as a specific variable type. The quick fix is to make the line <code>username = &quot;&quot;</code>. The correct fix is to use <a href=\"https://msdn.microsoft.com/en-us/library/y9341s4f.aspx\" rel=\"nofollow noreferrer\">Option Explicit</a> at the top of your module and declare all your variable types explicitly. In the case of <code>username</code>: <code>Dim username as String</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453901409, "post_id": 35038638, "comment_id": 57801725, "body": "What is the loop meant to do? i is never used?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453901609, "post_id": 35038638, "comment_id": 57801855, "body": "Granted, but these are outside the loop."}, {"owner": {"reputation": 212, "user_id": 4469751, "user_type": "registered", "profile_image": "https://graph.facebook.com/286604070/picture?type=large", "display_name": "Henry W", "link": "https://stackoverflow.com/users/4469751/henry-w"}, "edited": false, "score": 0, "creation_date": 1453901755, "post_id": 35038638, "comment_id": 57801953, "body": "Surely the Do is in the wrong place? If it were below the i = cmbRow line then it would Vicky through the users correctly? As it is, it would surely be on an endless loop of the same username?"}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1453901847, "post_id": 35038638, "comment_id": 57802010, "body": "Hence the &quot;I&#39;m a rookie to VBA and am struggling with a code I have written&quot; :)"}, {"owner": {"reputation": 372, "user_id": 5846934, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f7f3764722606cc30f91315ce4f4e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Walker", "link": "https://stackoverflow.com/users/5846934/steven-walker"}, "edited": false, "score": 0, "creation_date": 1453901866, "post_id": 35038638, "comment_id": 57802019, "body": "I tried to use <code>username = &quot;&quot;&#39;</code>, however it got me stuck in an infinite loop.   The loop is there because the code is intended to go through a list of email addresses and send an email to each one, so e.g. the starting point is cell A1, it will email the address held in A1, then go on to A2 etc. until a blank is found, at which point the loop will end."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453902001, "post_id": 35038638, "comment_id": 57802136, "body": "@StevenWalker - I am drafting an answer now that should clean your code and having it working correctly :)"}, {"owner": {"reputation": 372, "user_id": 5846934, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f7f3764722606cc30f91315ce4f4e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Walker", "link": "https://stackoverflow.com/users/5846934/steven-walker"}, "reply_to_user": {"reputation": 212, "user_id": 4469751, "user_type": "registered", "profile_image": "https://graph.facebook.com/286604070/picture?type=large", "display_name": "Henry W", "link": "https://stackoverflow.com/users/4469751/henry-w"}, "edited": false, "score": 0, "creation_date": 1453902079, "post_id": 35038638, "comment_id": 57802186, "body": "Thanks @HenryW. I thought it might have been but I was struggling to puzzle it out. That part is now resolved although I&#39;m still getting the object error."}, {"owner": {"reputation": 372, "user_id": 5846934, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f7f3764722606cc30f91315ce4f4e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Walker", "link": "https://stackoverflow.com/users/5846934/steven-walker"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453902129, "post_id": 35038638, "comment_id": 57802225, "body": "Thanks @ScottHoltzman - I&#39;m looking forward to it!! :)"}, {"owner": {"reputation": 212, "user_id": 4469751, "user_type": "registered", "profile_image": "https://graph.facebook.com/286604070/picture?type=large", "display_name": "Henry W", "link": "https://stackoverflow.com/users/4469751/henry-w"}, "edited": false, "score": 0, "creation_date": 1453902180, "post_id": 35038638, "comment_id": 57802258, "body": "You may find that by saying where username= &quot; &quot; you inadvertently run a blank username through the loop which causes the error. Instead, try username.offset(1,0)=&quot; &quot;   This should cause it to stop when the cell below the current one is blank"}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 1, "creation_date": 1453902291, "post_id": 35038638, "comment_id": 57802348, "body": "@StevenWalker: one big tip I can give you is to indent your code properly and consistently (a good habit); this will allow you to see more easily why the loop never ends.  And of course the tip from Scott Holtzman about Option Explicit; it prevents typing mistakes and also gives you access to Intellisense which shows you what members are allowed or not (i.e. it tells you &quot;username.&quot; leads to nothing)."}], "answers": [{"comments": [{"owner": {"reputation": 372, "user_id": 5846934, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f7f3764722606cc30f91315ce4f4e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Walker", "link": "https://stackoverflow.com/users/5846934/steven-walker"}, "edited": false, "score": 0, "creation_date": 1453902964, "post_id": 35039088, "comment_id": 57802799, "body": "Thanks Scott. I now get a Run-time error 13 = type mismatch? Not sure if there&#39;s something else in my set up I have wrong?  Edit: I removed the <code>i = &quot;&quot; or</code> and left the <code>If UserNameCol = &quot; &quot;...</code> which seemed to resovle it."}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 2, "creation_date": 1453903112, "post_id": 35039088, "comment_id": 57802908, "body": "Nice clean-up, but the checking for UserName=&quot;&quot; can best be done before the mail creation; i.e. make it a do while... loop, or wrap the whole innards of the loop in a (secondary) big If Then statement checking for &lt;&gt;&quot;&quot;."}, {"owner": {"reputation": 372, "user_id": 5846934, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f7f3764722606cc30f91315ce4f4e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Walker", "link": "https://stackoverflow.com/users/5846934/steven-walker"}, "reply_to_user": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1453903244, "post_id": 35039088, "comment_id": 57803022, "body": "@CarlColijn - Edited previous, I just had to make a slight tweak and it works :)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 372, "user_id": 5846934, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f7f3764722606cc30f91315ce4f4e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Walker", "link": "https://stackoverflow.com/users/5846934/steven-walker"}, "edited": false, "score": 0, "creation_date": 1453903574, "post_id": 35039088, "comment_id": 57803277, "body": "@StevenWalker - yes, I see my error in the way I originally set it up. A <code>Long</code> variable cannot <code>=&quot;&quot;</code>. I adjusted the test to continue the code in my edit. Please let me know if there is anything else that is not working."}, {"owner": {"reputation": 372, "user_id": 5846934, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f7f3764722606cc30f91315ce4f4e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Walker", "link": "https://stackoverflow.com/users/5846934/steven-walker"}, "edited": false, "score": 0, "creation_date": 1453903807, "post_id": 35039088, "comment_id": 57803465, "body": "All perfect @ScottHoltzman :) It gives me one extra email with a blank &#39;To&#39;. I&#39;m guessing this is because the instruction to create an email is before the loop until statement?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 372, "user_id": 5846934, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f7f3764722606cc30f91315ce4f4e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Walker", "link": "https://stackoverflow.com/users/5846934/steven-walker"}, "edited": false, "score": 0, "creation_date": 1453904245, "post_id": 35039088, "comment_id": 57803819, "body": "@StevenWalker - I fixed that. Carl Colijn had the find on that one. Try the edited code now."}, {"owner": {"reputation": 372, "user_id": 5846934, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f7f3764722606cc30f91315ce4f4e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Walker", "link": "https://stackoverflow.com/users/5846934/steven-walker"}, "edited": false, "score": 0, "creation_date": 1453904710, "post_id": 35039088, "comment_id": 57804198, "body": "Works perfectly, thanks everyone. Looking forward to trying to build on it :)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 3, "last_activity_date": 1453904214, "last_edit_date": 1453904214, "creation_date": 1453902354, "answer_id": 35039088, "question_id": 35038638, "link": "https://stackoverflow.com/questions/35038638/cant-figure-out-object-required-error/35039088#35039088", "title": "Can&#39;t figure out Object required error", "body": "<p>There are few syntax and understanding mistakes in the code. I have listed them below and refactored your code a bit to help to get it work as you desire.</p>\n\n<ol>\n<li>It's always best to use <a href=\"https://msdn.microsoft.com/en-us/library/y9341s4f.aspx\" rel=\"nofollow\">Option Explicit</a> at the top of each module and <strong>explicitly</strong> declare variables with the desired type</li>\n<li>Place the setting of the username inside the loop so it resets each time with a new email based on the <code>i = i+1</code> counter.</li>\n</ol>\n\n<p>Rest of comments are in code:</p>\n\n<pre><code>Option Explicit\n\nSub cmdGo_Click()\n\nApplication.DisplayAlerts = False\n\nIf cmbRow = \"\" or cmbColumn = \"\" Then \n    Exit Sub\nEnd If\n\nDim i As Long\ni = cmbRow\n\nDim UserNameCol As String 'created a new variable just to get column letter so can be used later in the loop and removed the `Select Case` block.\nUserNameCol = cmbColumn\n\n'set outlook outside loop since you only need to call it once, doing it in loop creates unneccesary processing\nDim OutApp As Object\nDim OutMail As Object\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nDo Until Len(Cells(i, UserNameCol).Value) = 0 'will stop when blank cell appears\n\n    Dim UserName As String\n    UserName = Cells(i, UserNameCol).Value 'always will user whatever column choosen\n\n    Set OutMail = OutApp.CreateItem(0) 'this goes here because a new email is needed each time\n    On Error Resume Next\n    With OutMail\n\n        .To = UserName\n        '.CC = \"\" 'you can remove this lines because you are not putting anything in the field\n        '.BCC = \"\" 'you can remove this lines because you are not putting anything in the field\n        .Importance = 1\n        .Subject = \"Hello\"\n        .HTMLBody = \"Message\"\n\n        'display shows each email before sending\n        .Display\n        'send sends email automatically\n        '.Send\n\n    End With\n    On Error GoTo 0\n\n    i = i + 1\n\nLoop \n\n'destroy outlook when finished processing all mails\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 372, "user_id": 5846934, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f7f3764722606cc30f91315ce4f4e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Walker", "link": "https://stackoverflow.com/users/5846934/steven-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "accepted_answer_id": 35039088, "answer_count": 1, "score": 1, "last_activity_date": 1453904214, "creation_date": 1453901135, "last_edit_date": 1531164843, "question_id": 35038638, "link": "https://stackoverflow.com/questions/35038638/cant-figure-out-object-required-error", "title": "Can&#39;t figure out Object required error", "body": "<p>The purpose of the code is to send an email to a list of addresses. To determine the start point, a user form will appear asking for the stating Column and Row (with plans that as I improve, I'll add other options in).</p>\n\n<p>I had the code working, however, I made some tweaks and not keep getting an Object required error which I've tried figuring out for hours without luck. Please can you take a look at my code and suggest where I might be going wrong? </p>\n\n<p>NB. I also tried declaring all variables but it didn't fix the issue.</p>\n\n<p>The error is on the <em>Loop Until username.Value = \"\"</em></p>\n\n<pre><code>Sub cmdGo_Click()\n\nApplication.DisplayAlerts = False\n\ni = cmbRow\n\nIf i = \"\" Then\n    Exit Sub\nEnd If\n\nusername = cmbColumn\n\nIf username = \"\" Then\n    Exit Sub\nEnd If\n\nSelect Case username\n\n    Case \"A\", \"a\"\n        username = Cells(i, \"a\").Value\n    Case \"B\", \"b\"\n        username = Cells(i, \"b\").Value\n    Case \"C\", \"c\"\n        username = Cells(i, \"c\").Value\n    Case \"D\", \"d\"\n        username = Cells(i, \"d\").Value\n    Case \"E\", \"e\"\n        username = Cells(i, \"e\").Value\n\nEnd Select\n\nDo\n\nDim OutApp As Object\n    Dim OutMail As Object\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n    On Error Resume Next\n    With OutMail\n\n        .To = username\n        .CC = \"\"\n        .BCC = \"\"\n        .Importance = 1\n        .Subject = \"Hello\"\n        .HTMLBody = \"Message\"\n\n'display shows each email before sending\n          .Display\n'send sends email automatically\n'         .Send\n\n    End With\n    On Error GoTo 0\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n\nApplication.DisplayAlerts = True\n\ni = i + 1\n\nLoop Until username.Value = \"\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "edited": false, "score": 0, "creation_date": 1453901039, "post_id": 35038527, "comment_id": 57801451, "body": "Is it not Possible to do that with Conditional Format?"}], "answers": [{"tags": [], "owner": {"reputation": 208, "user_id": 5615421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/e5Rqn.png?s=128&g=1", "display_name": "Herry Markowitz", "link": "https://stackoverflow.com/users/5615421/herry-markowitz"}, "is_accepted": false, "score": 0, "last_activity_date": 1453901233, "creation_date": 1453901233, "answer_id": 35038677, "question_id": 35038527, "link": "https://stackoverflow.com/questions/35038527/excel-cells-formatting-with-visual-basic/35038677#35038677", "title": "Excel Cells Formatting with Visual Basic", "body": "<p>Replace this;</p>\n\n<pre><code> If ActiveCell = \"OK\" Then\n</code></pre>\n\n<p>with this;</p>\n\n<pre><code> If ActiveCell.value = \"OK\" Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 422, "user_id": 5226518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/M08sM.jpg?s=128&g=1", "display_name": "Blind Seer", "link": "https://stackoverflow.com/users/5226518/blind-seer"}, "is_accepted": false, "score": 0, "last_activity_date": 1453901678, "creation_date": 1453901678, "answer_id": 35038818, "question_id": 35038527, "link": "https://stackoverflow.com/questions/35038527/excel-cells-formatting-with-visual-basic/35038818#35038818", "title": "Excel Cells Formatting with Visual Basic", "body": "<p>First of all try to avoid <code>select</code> or <code>active*</code> if not really needed. They can be avoided most of the time and slow down your code.\nSo instead of <code>Range(\"A13:E13\").Select</code> folowed by `selection.interior\u00b4 go for\n\u00b4Range(\"A13:E13\").Interior\u00b4.</p>\n\n<p>You want to check for the value of the cell. So it is \u00b4activecell.value\u00b4not only activecell. Even better \u00b4worksheets(x).cells(y, z).value\u00b4 or \u00b4worksheets(x).range(\"yz\").value\u00b4</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 3333331, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a766ecfc5aa4a5a6e701d1564011012?s=128&d=identicon&r=PG&f=1", "display_name": "GunnRos86", "link": "https://stackoverflow.com/users/3333331/gunnros86"}, "edited": false, "score": 0, "creation_date": 1453921586, "post_id": 35040005, "comment_id": 57816088, "body": "It work great man, impeccably! I think the same, that Conditional Formatting make this stuff much easier. Thanks!"}], "tags": [], "owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "is_accepted": true, "score": 0, "last_activity_date": 1453904815, "creation_date": 1453904815, "answer_id": 35040005, "question_id": 35038527, "link": "https://stackoverflow.com/questions/35038527/excel-cells-formatting-with-visual-basic/35040005#35040005", "title": "Excel Cells Formatting with Visual Basic", "body": "<p>Here is my answer... </p>\n\n<pre><code>Private Sub Worksheet_Activate()\n  If ActiveCell.Value = \"OK\" Then\n     'Here ActiveCell is any cell that is active,\n     'but you say, that you want to test the cells of\n     'a particular column, in that case you could use\n     'Opt 01:\n     'If ActiveCell.Column = 1 Then 'Here you are asking for the column\n                                    'for the ActiveCell\n                                    ' use a nested if\n     'If ActiveCell.Value = \"OK\" Then ' here if the activecell is in the\n                                      ' right column and is with the right\n                                      'value, you get the rows colored\n    'Range(\"A13:E13\").Select 'Well you are using this... but you say\n                             'that you want to color the row of the corresponding cell\n                             'in that case you can use this:\n    Dim r\n    Dim rng As Range\n\n    r = ActiveCell.Row\n    Set rng = Range(Cells(r, 1), Cells(r, 20)) 'you store inside rng the cells:\n                                               'from column 1 = A, Row x\n                                               'to column 20 = T, row x\n                                               ' where x is the row of the activecell\n                                               'you can change the column as you need\n    With rng.Interior 'here you can use rng instead selection\n                      'and you affect the cells without selecting them.\n     .ColorIndex = 4\n     .Pattern = xlSolid\n   End With\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Or you can use a conditional formating... </p>\n\n<p>Where you evaluate the contents of cells of the column you need. I think this a better aproach for whay you'r saying. </p>\n\n<p><a href=\"https://i.stack.imgur.com/5Z6OU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5Z6OU.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 41, "user_id": 3333331, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a766ecfc5aa4a5a6e701d1564011012?s=128&d=identicon&r=PG&f=1", "display_name": "GunnRos86", "link": "https://stackoverflow.com/users/3333331/gunnros86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 35040005, "answer_count": 3, "score": 0, "last_activity_date": 1453904815, "creation_date": 1453900825, "question_id": 35038527, "link": "https://stackoverflow.com/questions/35038527/excel-cells-formatting-with-visual-basic", "title": "Excel Cells Formatting with Visual Basic", "body": "<p>I am just trying to put together some Visual Basic lines for an Excel File so when the content of the cells of a particular column meet a specific comparison condition the color of the corresponding row will take a predefined color. Here is some testing code:</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n  If ActiveCell = \"OK\" Then\n    Range(\"A13:E13\").Select\n    With Selection.Interior\n     .ColorIndex = 4\n     .Pattern = xlSolid\n   End With\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Apparently, this has to function for all the sheet not just for 13. Also, the problem is that the above does't work with <strong>ActiveCell</strong>. Is there a more effective way to try that? Some help please!  </p>\n"}, {"tags": ["vba", "excel", "security", "password-protection"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1453901064, "post_id": 35038502, "comment_id": 57801465, "body": "Excel passwords are not secure; it is trivially easy to break them if the file is on your computer. If the data being sent to all individuals is truly sensitive, you need another delivery method. For example, have Excel create the files (while under ownership of you or someone with authority to see all the sensitive data), and drop them into network folders which only you &amp; the particular owner has access to."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1453901193, "post_id": 35038502, "comment_id": 57801548, "body": "If on the other hand this is more of a convenience thing (no reason to bog down a salesperson with IT manuals on a combined project, or something like that), then an Excel password would be fine. For example, when using template files where the background calculations are all automated and would break if a user interfered, I will lock down those sheets. While the users would still have access to those sheets if they bothered to break the password, having that as an extra step is a pretty effective way of saying &#39;you have stepped outside of the limits of what I will support&#39;."}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1453901573, "post_id": 35038502, "comment_id": 57801831, "body": "@Grade&#39;Eh&#39;Bacon: a slight nuance: the file password is actually secure since Office 2007, but the rest indeed is not."}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 1, "creation_date": 1453901640, "post_id": 35038502, "comment_id": 57801874, "body": "The only way to manipulate the VBA password is to cheat and use SendKeys.  There&#39;s no API for it that is exposed by Excel (or any other Office app for that matter).  See: <a href=\"http://stackoverflow.com/questions/16174469/unprotect-vbproject-from-vb-code\" title=\"unprotect vbproject from vb code\">stackoverflow.com/questions/16174469/&hellip;</a>"}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1453901987, "post_id": 35038502, "comment_id": 57802123, "body": "I understand that Excel&#39;s protection isn&#39;t the most secure, however the idea is that even if a user hacks the protection they will not be able to see anything but their own data, i.e. what the code does is it saves a copy of the master file with all the data in, goes into each data sheet and deletes everything that is not appropriate to the recipient, hides all the sheets except what we want them to see, then locks the sheets and workbook down - so if they do hack in they won&#39;t be able to find anything. But what I want to do is prevent them from looking at the code behind the files..."}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1453902052, "post_id": 35038502, "comment_id": 57802169, "body": "... if they see the code then it isn&#39;t the end of the world because there&#39;s nothing damaging in there to see, but for the sake of consistency and tidiness it would be good to password protect the code from being viewed"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1453902258, "post_id": 35038502, "comment_id": 57802314, "body": "@BenSmith Instead of pulling the whole sheet and then deleting the data meant for other users, why don&#39;t you just pull the single tab relevant to that user? Also, if a user runs Excel and it has access to a location on the network storing the master sheet, then isn&#39;t that file unsecured, meaning they could just go to the folder and grab it?"}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1453902623, "post_id": 35038502, "comment_id": 57802560, "body": "@Grade&#39;Eh&#39;Bacon The reason for not just pulling the single tab is because there are two main tabs that we want the recipient to be able to look at, and on these tabs they can change certain measurements, such as time period, that would change the data they see - so the data sheets are still necessary. And these files will be emailed out, as opposoed to on a shared network, so they will not be able to get to the master copy."}, {"owner": {"reputation": 30926, "user_id": 767890, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e169a8a6d170a77b83dd8244df5f6890?s=128&d=identicon&r=PG", "display_name": "InBetween", "link": "https://stackoverflow.com/users/767890/inbetween"}, "edited": false, "score": 1, "creation_date": 1453902856, "post_id": 35038502, "comment_id": 57802714, "body": "@BenSmith I don&#39;t get it. You are basically creating new files with relevant editable data to the client where everything else has been erased. So you&#39;ll have to somehow merge the data the recipient sends back to you into your master file. In that scenario, what is keeping you from simply making the master file generate new code free files with all relevant tabs of any given recipient and sending that file instead of an edited copy of the master file with vba code you don&#39;t want to show?"}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "reply_to_user": {"reputation": 30926, "user_id": 767890, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e169a8a6d170a77b83dd8244df5f6890?s=128&d=identicon&r=PG", "display_name": "InBetween", "link": "https://stackoverflow.com/users/767890/inbetween"}, "edited": false, "score": 0, "creation_date": 1453903224, "post_id": 35038502, "comment_id": 57803008, "body": "@InBetween sorry I don&#39;t understand where you are getting your scenarios from, the recipients do not send anything back, I do not update the master file with anything that they send back - these files are created and sent to the recipients so that they can view their own appropriate information, they do not send anything back - if they did and they needed to edit the files then there would be no point in locking the files down."}, {"owner": {"reputation": 30926, "user_id": 767890, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e169a8a6d170a77b83dd8244df5f6890?s=128&d=identicon&r=PG", "display_name": "InBetween", "link": "https://stackoverflow.com/users/767890/inbetween"}, "edited": false, "score": 1, "creation_date": 1453904660, "post_id": 35038502, "comment_id": 57804157, "body": "@BenSmith Even better. I still dont understand why  you need to send a pruned master file? Can&#39;t you have a blank template .xls file with all the necessary structure (sheets, charts, etc.) and strictly required code for viewing purposes already conveniently protected? Any time you need to send data to a recipient, make a copy of the template, copy only relevant data to it and send that file."}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "reply_to_user": {"reputation": 30926, "user_id": 767890, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e169a8a6d170a77b83dd8244df5f6890?s=128&d=identicon&r=PG", "display_name": "InBetween", "link": "https://stackoverflow.com/users/767890/inbetween"}, "edited": false, "score": 0, "creation_date": 1453905090, "post_id": 35038502, "comment_id": 57804507, "body": "@InBetween copying relevant data to the recipients would be too time consuming, there are many sheets within this file and many recipients, it would take me many hours to copy the relevant data into a blank template for each recipient. Besides, this is not what I&#39;m asking in the question, I need a way to lock down the code using VBA so that a user has to enter a password to view it."}, {"owner": {"reputation": 30926, "user_id": 767890, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e169a8a6d170a77b83dd8244df5f6890?s=128&d=identicon&r=PG", "display_name": "InBetween", "link": "https://stackoverflow.com/users/767890/inbetween"}, "edited": false, "score": 1, "creation_date": 1453905277, "post_id": 35038502, "comment_id": 57804654, "body": "@BenSmith You&#39;d obviously need to have the necessary code in the master file to create the new files automatically, I can&#39;t imagine it would be too hard to  code what is basically copies, pastes and save as operations, and I very much doubt that would be significantly slower than pruning the master file once for every recipient. And yes I know you are asking something else, but what you are asking is not easily done, I&#39;m not even surre its possible at all without some extreme hacks, so its always smart to look for workarounds."}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "reply_to_user": {"reputation": 30926, "user_id": 767890, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e169a8a6d170a77b83dd8244df5f6890?s=128&d=identicon&r=PG", "display_name": "InBetween", "link": "https://stackoverflow.com/users/767890/inbetween"}, "edited": false, "score": 0, "creation_date": 1453905929, "post_id": 35038502, "comment_id": 57805160, "body": "@InBetween the code to run probably takes about an hour, if I were to do this manually (and this is disregarding any human errors that could be made) it would take me around 3 hours, so you&#39;re suggestion isn&#39;t even a workaround and, whilst I appreciate your effort, does not help me with what I need to do."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1453914643, "post_id": 35038502, "comment_id": 57811646, "body": "Does the code actually have to be in the files you&#39;re distributing? Why not have the master file that you&#39;re customizing have NO code? Store the code in a different workbook, loaded as an Add-in, perhaps, and run it on the master file..."}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1612206644, "post_id": 35038502, "comment_id": 116689323, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/16757119/best-way-to-protect-excel-vba-code\">Best way to protect Excel VBA code?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 1803783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f028b3ce4ad54f44881bd2e0818c9c60?s=128&d=identicon&r=PG", "display_name": "Andy Bethell", "link": "https://stackoverflow.com/users/1803783/andy-bethell"}, "is_accepted": true, "score": 3, "last_activity_date": 1453915359, "last_edit_date": 1453915359, "creation_date": 1453914626, "answer_id": 35043734, "question_id": 35038502, "link": "https://stackoverflow.com/questions/35038502/vba-how-can-i-password-protect-modules-using-code/35043734#35043734", "title": "VBA: How can I password protect modules using code?", "body": "<p>Notwithstanding the good advice already given about the security of Excel passwords/protection, and the comprehensive (non-SendKeys) solution linked by Carl Colijn, I have used the dirty SendKeys method myself with some success - see example below, and <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.send(v=vs.110).aspx\" rel=\"nofollow\">here</a> for more details on SendKeys.  YMMV etc.</p>\n\n<p>Note you will have to find the option \"Trust access to the VBA project object model\" in the Excel Trust Center > Macro Settings, or equivalent for your version of Excel</p>\n\n<pre><code>Sub UnprotectVBProj(ByRef WB As Workbook, ByVal Pwd As String)\n\n    Dim vbProj As Object\n\n    Set vbProj = WB.VBProject\n\n    If vbProj.Protection &lt;&gt; 1 Then Exit Sub ' already unprotected\n\n    Set Application.VBE.ActiveVBProject = vbProj\n\n    SendKeys \"%TE\" &amp; Pwd &amp; \"~~\"\n\nEnd Sub\n\nSub ProtectVBProj(ByRef WB As Workbook, ByVal Pwd As String)\n\n    Dim vbProj As Object\n\n    Set vbProj = WB.VBProject\n\n    If vbProj.Protection = 1 Then Exit Sub ' already protected\n\n    Set Application.VBE.ActiveVBProject = vbProj\n\n    SendKeys \"%TE+{TAB}{RIGHT}%V%P\" &amp; Pwd &amp; \"%C\" &amp; Pwd &amp; \"{TAB}{ENTER}\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4232, "favorite_count": 2, "accepted_answer_id": 35043734, "answer_count": 1, "score": 3, "last_activity_date": 1453915359, "creation_date": 1453900747, "question_id": 35038502, "link": "https://stackoverflow.com/questions/35038502/vba-how-can-i-password-protect-modules-using-code", "title": "VBA: How can I password protect modules using code?", "body": "<p>I have an file which saves a copy of itself to go to certain recipients, so you end up with many files that only contain recipient-specific information and the original maste file that contains all information. When the recipient-specific files are made, I have code that deletes everything but information that is related to that recipient and locks down the workbook and sheets with a randomly made password using the below function:</p>\n\n<pre><code>Function Pwd(iLength As Integer) As String\nDim i As Integer, iTemp As Integer, bOK As Boolean, strTemp As String\n'48-57 = 0 To 9, 65-90 = A To Z, 97-122 = a To z\n'amend For other characters If required\nFor i = 1 To iLength\n    Do\n        iTemp = Int((122 - 48 + 1) * Rnd + 48)\n        Select Case iTemp\n        Case 48 To 57, 65 To 90, 97 To 122: bOK = True\n        Case Else: bOK = False\n        End Select\n    Loop Until bOK = True\n    bOK = False\n    strTemp = strTemp &amp; Chr(iTemp)\nNext i\nPwd = strTemp\nEnd Function\n</code></pre>\n\n<p>Is it possible to also lock down the modules so that they cannot be edited? What I want is the same functionality that Excel provide in Visual Basic by going to Tools -> VBAProject - Project Properties -> Protection, but to do this through the code so that it can be applied to each of the recipient specific files.</p>\n\n<p>I can apply protection to the sheets using code like:</p>\n\n<pre><code>Sheets(1).Protect Password, True, True\n</code></pre>\n\n<p>And to the workbook with code like: </p>\n\n<pre><code>ActiveWorkbook.Protect Password, True, False\n</code></pre>\n\n<p>But is there something that I can use to lock down the modules?</p>\n"}, {"tags": ["json", "xml", "vba", "ms-access", "msxml"], "comments": [{"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 1, "creation_date": 1453903694, "post_id": 35038469, "comment_id": 57803370, "body": "Welcome to Stack Overflow. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> to get a better idea of what constitutes a &quot;good&quot; question. Specifically, this question covers at least three separate issues: (1) connecting to a web service with authentication, (2) sending it a search request with parameters, and (3) importing the results it returns. They should be distinct questions."}, {"owner": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "edited": false, "score": 0, "creation_date": 1454092428, "post_id": 35038469, "comment_id": 57905005, "body": "HTTPS has nothing to do with requiring authentication.  Also see <a href=\"https://msdn.microsoft.com/en-us/library/ms757849(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms757849(v=vs.85).aspx</a> for the <code>.open</code> method&#39;s signature.  For that matter there are several JSON parsers that have been or can be adapted to VBA."}], "answers": [{"comments": [{"owner": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "edited": false, "score": 0, "creation_date": 1454617547, "post_id": 35113035, "comment_id": 58137007, "body": "Perhaps you didn&#39;t look at the link provided above.  User/PW can be passed to the <code>open</code> method, you don&#39;t have to wait for a popup dialog."}], "tags": [], "owner": {"reputation": 82, "user_id": 5846626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade36847c10f286255946190513bcfb5?s=128&d=identicon&r=PG&f=1", "display_name": "dbWizard", "link": "https://stackoverflow.com/users/5846626/dbwizard"}, "is_accepted": false, "score": 0, "last_activity_date": 1454237860, "creation_date": 1454237860, "answer_id": 35113035, "question_id": 35038469, "link": "https://stackoverflow.com/questions/35038469/passing-userid-and-password-in-xml-request/35113035#35113035", "title": "passing userid and password in xml request", "body": "<p>thanks Bob.  If figured out the authentication issue, a popup dialog is used to enter userid and password and the client was satisfied with that.</p>\n\n<p>And given the structure of the returned string, I was able to parse the data myself without too much difficulty.</p>\n"}], "owner": {"reputation": 82, "user_id": 5846626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade36847c10f286255946190513bcfb5?s=128&d=identicon&r=PG&f=1", "display_name": "dbWizard", "link": "https://stackoverflow.com/users/5846626/dbwizard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454237860, "creation_date": 1453900669, "question_id": 35038469, "link": "https://stackoverflow.com/questions/35038469/passing-userid-and-password-in-xml-request", "title": "passing userid and password in xml request", "body": "<p>I have a potential client who wants to pull some data from a website via VBA.  I am new to XML and JSON.</p>\n\n<p>I found a link somewhere that provides the following code which uses MSXML to return data for a single item from that particular website.</p>\n\n<pre><code>Public Function GetItemSalePrice(item As String) As Double\nDim dblItem As Long\nWith CreateObject(\"msxml2.xmlhttp\")\n    .Open \"GET\", \"http://www.gw2spidy.com/api/v0.9/json/item/\" &amp; item, False\n    .send\n    dblItem = Split(Split(.responsetext, \"min_sale_unit_price\"\":\")(1), \",\")(0)\n    GetItemSalePrice = dblItem / 100\nEnd With\nEnd Function\n</code></pre>\n\n<p>However, the data my client wants to return comes in pages of up to 500 records at a time.  He indicates that the \nhe wants to pass in date ranges, and a page number, similar to the following.</p>\n\n<p><a href=\"https://api.appfigures.com/v2/reviews?client_key=xxxxxxxf&amp;start=2015-01-01&amp;end=2016-01-21&amp;page=1\" rel=\"nofollow\">https://api.appfigures.com/v2/reviews?client_key=xxxxxxxf&amp;start=2015-01-01&amp;end=2016-01-21&amp;page=1</a></p>\n\n<p>But because this is an https site, it wants a userid and password.  Can I simply reformat that string to include userid and password?  Or is there another method or property of the MSXML object that can be set for authentication? </p>\n\n<p>The client indicates that the return value looks like:</p>\n\n<pre><code>{\n\"total\": 140,\n\"pages\": 28,\n\"this_page\": 1,\n\"reviews\": [{\n    \"author\": \"DeveloperToDeveloper\",\n    \"title\": \"Just Spectacular\",\n    \"review\": \"Finally able to remove the ads! The description is hilarious!! Thanks!!!\",\n    \"original_title\": null,\n    \"original_review\": null,\n    \"stars\": \"5.00\",\n    \"iso\": \"US\",\n    \"version\": \"1.2\",\n    \"date\": \"2012-09-19T17:05:00\",\n    \"product\": 6567539,\n    \"weight\": 0,\n    \"id\": \"5561747L7xnbsMRu8UbPvy7A71Dv6A==\"\n}]\n}\n</code></pre>\n\n<p>But with multiple records returned, as many as 500 at a time.  Is there an efficient way of reading data in that format into a table? One or more records at a time?  I can obviously write a text parser but I assume that someone has probably already done that leg work.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1451, "user_id": 4879022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHKqx.png?s=128&g=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4879022/techie"}, "edited": false, "score": 0, "creation_date": 1453901128, "post_id": 35038357, "comment_id": 57801503, "body": "Refer to this <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822490.aspx\" rel=\"nofollow noreferrer\">MSDN KB</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5254, "user_id": 24447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da74b7df5db7590fc140329c62b3e498?s=128&d=identicon&r=PG", "display_name": "nekomatic", "link": "https://stackoverflow.com/users/24447/nekomatic"}, "is_accepted": false, "score": 0, "last_activity_date": 1453901765, "creation_date": 1453901765, "answer_id": 35038845, "question_id": 35038357, "link": "https://stackoverflow.com/questions/35038357/hyperlink-in-excel-macro/35038845#35038845", "title": "Hyperlink in excel macro", "body": "<p>Use the HYPERLINK function:</p>\n\n<p><code>=HYPERLINK(link_location, friendly_name)</code></p>\n\n<blockquote>\n  <p>Creates a shortcut or jump that opens a document stored on your hard drive, a network server, or on the Internet.</p>\n</blockquote>\n\n<p>For example in macro code:</p>\n\n<p><code>Worksheets(\"Sheet1\").Range(\"A1\").Formula = \"=HYPERLINK(\"\"\" &amp; link_destination &amp; \"\"\",\"\"\" &amp; link_text &amp; \"\"\")\"</code></p>\n\n<p>Note the use of \"\" (two double quotes) in the VBA code to produce a single double quote in the cell formula.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 5810049, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207184738829161/picture?type=large", "display_name": "Shubham Agarwal", "link": "https://stackoverflow.com/users/5810049/shubham-agarwal"}, "edited": false, "score": 0, "creation_date": 1453917960, "post_id": 35038866, "comment_id": 57813857, "body": "1. abc = InputBox(&quot;Enter the link&quot;) 2. A = &quot;=Hyperlink(abc, &quot;&quot;friendlyname&quot;&quot;)&quot; 3. wb2.Sheets(&quot;Rest&quot;).Range(&quot;A&quot; &amp; restcounter) = A this is what i want. i want to get the link(ex. www.google.com) as input. then i want to create a hyperlink and store it some variable A, then i paste the value in some cell of a excel sheet. please provide me the solution or best approach to solve this issue."}, {"owner": {"reputation": 99, "user_id": 3379611, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bcaad6272961d96c659efa3570af522d?s=128&d=identicon&r=PG&f=1", "display_name": "Nelsons Development Solutions", "link": "https://stackoverflow.com/users/3379611/nelsons-development-solutions"}, "reply_to_user": {"reputation": 11, "user_id": 5810049, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207184738829161/picture?type=large", "display_name": "Shubham Agarwal", "link": "https://stackoverflow.com/users/5810049/shubham-agarwal"}, "edited": false, "score": 0, "creation_date": 1453922139, "post_id": 35038866, "comment_id": 57816400, "body": "Edited my answer from this morning. Code is tested and working. Let me know."}, {"owner": {"reputation": 11, "user_id": 5810049, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207184738829161/picture?type=large", "display_name": "Shubham Agarwal", "link": "https://stackoverflow.com/users/5810049/shubham-agarwal"}, "edited": false, "score": 0, "creation_date": 1453959513, "post_id": 35038866, "comment_id": 57831232, "body": "i have some other doubt too..i hope you can help me. how can i contact you?"}, {"owner": {"reputation": 99, "user_id": 3379611, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bcaad6272961d96c659efa3570af522d?s=128&d=identicon&r=PG&f=1", "display_name": "Nelsons Development Solutions", "link": "https://stackoverflow.com/users/3379611/nelsons-development-solutions"}, "reply_to_user": {"reputation": 11, "user_id": 5810049, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207184738829161/picture?type=large", "display_name": "Shubham Agarwal", "link": "https://stackoverflow.com/users/5810049/shubham-agarwal"}, "edited": false, "score": 0, "creation_date": 1453986032, "post_id": 35038866, "comment_id": 57847065, "body": "Nelsons Development Solutions @gmail . com no spaces"}], "tags": [], "owner": {"reputation": 99, "user_id": 3379611, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bcaad6272961d96c659efa3570af522d?s=128&d=identicon&r=PG&f=1", "display_name": "Nelsons Development Solutions", "link": "https://stackoverflow.com/users/3379611/nelsons-development-solutions"}, "is_accepted": true, "score": 1, "last_activity_date": 1453922690, "last_edit_date": 1453922690, "creation_date": 1453901802, "answer_id": 35038866, "question_id": 35038357, "link": "https://stackoverflow.com/questions/35038357/hyperlink-in-excel-macro/35038866#35038866", "title": "Hyperlink in excel macro", "body": "<p>OK, here is the code. What it is doing is\n1. Asking what URL you want\n2. Storing the URL in a variable called URL\n3. Going to Sheet 1, adding the hyperlink function to cell A5, linking it to the URL you input\n4. Displaying the friendly name you give it in the code</p>\n\n<p>Let me know if you have any questions | you will just need to modify the code for the URL you want or place the links where you want. </p>\n\n<p>Tested and working. Please vote as answer :) </p>\n\n<pre><code>Sub CreateHyperLink()\nDim URL As String\nURL = InputBox(\"Enter the link\")\nWith Worksheets(\"Sheet1\")\n.Hyperlinks.Add Anchor:=.Range(\"A5\"), _\nAddress:=\"http://www.\" &amp; URL, _\nTextToDisplay:=\"Google\"\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5810049, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207184738829161/picture?type=large", "display_name": "Shubham Agarwal", "link": "https://stackoverflow.com/users/5810049/shubham-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "accepted_answer_id": 35038866, "answer_count": 2, "score": 0, "last_activity_date": 1453922690, "creation_date": 1453900321, "last_edit_date": 1531161705, "question_id": 35038357, "link": "https://stackoverflow.com/questions/35038357/hyperlink-in-excel-macro", "title": "Hyperlink in excel macro", "body": "<p>I want a method to create a hyperlink of some variable in excel macro.\nMy requirement is I have to capture a link in some variable for ex:</p>\n\n<pre><code>abc = InputBox(\"Enter the path\")\n</code></pre>\n\n<p>now I want to use this abc as a parameter to a hyperlink function and create a hyperlink with name xyz.\nCan you  help me to solve this issue?</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 224, "user_id": 3383525, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/bINgE.jpg?s=128&g=1", "display_name": "SpaceSteak", "link": "https://stackoverflow.com/users/3383525/spacesteak"}, "edited": false, "score": 2, "creation_date": 1453900010, "post_id": 35038198, "comment_id": 57800736, "body": "So your problem now is looping through files and writing to an Excel sheet? Please try a few ideas and ask specific questions to problems you&#39;re having with code. Right now your question is really general and mostly just asking people to write your code for you..."}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1453913391, "creation_date": 1453913391, "answer_id": 35043310, "question_id": 35038198, "link": "https://stackoverflow.com/questions/35038198/scraping-word-with-excel-vba/35043310#35043310", "title": "Scraping Word with Excel VBA", "body": "<p>The code to which you link is not particularly robust. I've extracted the assignment to the cell in Excel (<code>ExR(1, 1) = WDR ' place at Excel cursor</code>) and built more robust Word code around it.</p>\n\n<p>The code uses the Word <code>Range</code> object instead of <code>Selection</code>. This is more efficient, more predictable and the screen won't jump around. The Find uses a wildcard search for the specific text, plus the digits between \"Length \" and \" words\". Since a successful Find includes the found Range, all that's necessary is to assign the Range's Text to the cell in Excel.</p>\n\n<p>The Find plus assignment is built into a LOOP, which runs as long as Find.Execute is successful. For the cell assignment in Excel a COUNTER is incremented in each loop so you don't need to hard-code the target cell indices.</p>\n\n<pre><code>Dim strFind As String\nDim rngFind As word.Range 'or As Object if you don't set a Reference to the Word object library\nDim bFound As Boolean\nDim iCellCounter As Long\n\nstrFind = \"Length: [0-9]{1;} words\"\nbFound = False\niCellCounter = 1\nSet rngFind = WApp.ActiveDocument.Content\nWith rngFind.Find\n    .ClearAllFuzzyOptions\n    .ClearFormatting\n    .ClearHitHighlight\n    .Format = False\n    .MatchWildcards = True\n    .Text = strFind\n    .wrap = wdFindStop   '0 if you don't use a Reference to the Word object library\n    Do\n        bFound = .Execute\n        If bFound Then\n            ExR(1, iCellCounter) = rngFind.Text\n            iCellCounter = iCellCounter + 1\n        End If\n    Loop While bFound\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5846830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83a11b6b2b173fedc78799e2b14384a1?s=128&d=identicon&r=PG&f=1", "display_name": "schrodingers-dog", "link": "https://stackoverflow.com/users/5846830/schrodingers-dog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 965, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1453913391, "creation_date": 1453899856, "last_edit_date": 1495542208, "question_id": 35038198, "link": "https://stackoverflow.com/questions/35038198/scraping-word-with-excel-vba", "title": "Scraping Word with Excel VBA", "body": "<p>I have a Word document full of newspaper articles. Each newspaper article is preceded by the article title and the string \"Length:\", which is followed by the number of words in the article (i.e. \"Length: 1500 words\"). I simply need an Excel Macro that will comb the Word document and extract the length value for each article - placing these values in an Excel column.</p>\n\n<p>Through my Googling, I found this: <a href=\"https://stackoverflow.com/questions/3567441/extract-data-from-word-document-to-an-excel-spreadsheet?answertab=oldest#tab-top\">Extract Data from Word Document to an Excel SpreadSheet</a></p>\n\n<p>This is <em>almost</em> what I need, but it only returns the first article length value found by the search. How do I modify the code to find every article length value, return these values to an Excel column and then terminate?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 293, "user_id": 5366091, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/1029941630378984/picture?type=large", "display_name": "Robert Kendall", "link": "https://stackoverflow.com/users/5366091/robert-kendall"}, "edited": false, "score": 0, "creation_date": 1453984677, "post_id": 35037867, "comment_id": 57846076, "body": "Public Sub Import2(FileName As Variant) Dim wb As Object, ws As Object Dim xl As Object Set xl = CreateObject(&quot;excel.Application&quot;) Dim qs As String Dim ValueString As String  Set wb = xl.Workbooks.Open(FileName)         Set ws = wb.worksheets(&quot;For Export&quot;)         data1 = ws.cells(2, 1)         Data2 = ws.cells(2, 2)         Data3 = ws.cells(2, 3)   ValueString = &quot;(&quot; &amp; data1 &amp; &quot;)&quot; qs = &quot;INSERT INTO MAF (FormDate) VALUES &amp; valuestring&quot; DoCmd.RunSQL qs &#39;CurrentDb.Execute qs  &#39;When I run this I get &quot;Syntax error in INSERT INTO statement&quot;  Locals window shows (4/1/2016), which is what I want."}], "answers": [{"comments": [{"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 1, "creation_date": 1453899988, "post_id": 35038032, "comment_id": 57800721, "body": "Remove the apostrophes to return the desired result. currently this answer gives  <code>&#39;(6&#39;)</code>"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": false, "score": 2, "last_activity_date": 1453900216, "last_edit_date": 1495540755, "creation_date": 1453899411, "answer_id": 35038032, "question_id": 35037867, "link": "https://stackoverflow.com/questions/35037867/entering-parentheses-in-string-values/35038032#35038032", "title": "Entering parentheses in string values", "body": "<p>Include spaces before and after the <code>&amp;</code> characters:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>ValueString = \"'(\" &amp; data1 &amp; \"')\"\n</code></pre>\n\n<p>The problem was because Access interpreted <code>data1&amp;</code> to mean a variable named <code>data1</code> whose type is Long.</p>\n\n<p>As <a href=\"https://stackoverflow.com/questions/35037867/entering-parentheses-in-string-values/35038032?noredirect=1#comment57800721_35038032\">LiamH pointed out</a>, if you want <code>ValueString</code> to contain <em>(6)</em> instead of <em>'(6')</em>, remove the apostrophes:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>ValueString = \"(\" &amp; data1 &amp; \")\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1453902799, "creation_date": 1453902799, "answer_id": 35039252, "question_id": 35037867, "link": "https://stackoverflow.com/questions/35037867/entering-parentheses-in-string-values/35039252#35039252", "title": "Entering parentheses in string values", "body": "<p>Or use Format:</p>\n\n<pre><code>ValueString = Format(data1, \"(0)\")\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 5366091, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/1029941630378984/picture?type=large", "display_name": "Robert Kendall", "link": "https://stackoverflow.com/users/5366091/robert-kendall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1204, "favorite_count": 0, "accepted_answer_id": 35039252, "answer_count": 2, "score": 0, "last_activity_date": 1453902799, "creation_date": 1453898925, "last_edit_date": 1453899760, "question_id": 35037867, "link": "https://stackoverflow.com/questions/35037867/entering-parentheses-in-string-values", "title": "Entering parentheses in string values", "body": "<p>I'm trying to enter a value for a string variable which contains parentheses.  </p>\n\n<pre><code>ValueString = \"'(\"&amp;data1&amp;\"')\"\n</code></pre>\n\n<p>For this example, Data1 has a value of 6 ( I confirmed that the variable has a value prior to this line of code)</p>\n\n<p>I want the value of ValueString to be (6)</p>\n\n<p>When run, I get \"expected end of statement\"  with the  <code>&amp;\"')\"</code> highlighted.  </p>\n\n<p>I have tried many variations of this syntax, with the same result.  </p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 56, "user_id": 5816366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71b52aaf74a5117eb484396ec50234b4?s=128&d=identicon&r=PG&f=1", "display_name": "EamonnT", "link": "https://stackoverflow.com/users/5816366/eamonnt"}, "edited": false, "score": 0, "creation_date": 1453900062, "post_id": 35037611, "comment_id": 57800768, "body": "That&#39;s odd, I ran your code and it worked fine for me. Have you tried it on another machine?"}, {"owner": {"reputation": 121, "user_id": 5727371, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8e99e2fa4dbf2c38b02dfddef3e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "OliEshmade", "link": "https://stackoverflow.com/users/5727371/olieshmade"}, "reply_to_user": {"reputation": 56, "user_id": 5816366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71b52aaf74a5117eb484396ec50234b4?s=128&d=identicon&r=PG&f=1", "display_name": "EamonnT", "link": "https://stackoverflow.com/users/5816366/eamonnt"}, "edited": false, "score": 1, "creation_date": 1453903105, "post_id": 35037611, "comment_id": 57802903, "body": "It was my own stupid mistake, I had the code stored under &#39;ThisWorkbook&#39; instead of a seperate module or anything. Not really sure why that would cause it, but it did - thank you for trying it :)"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 5727371, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8e99e2fa4dbf2c38b02dfddef3e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "OliEshmade", "link": "https://stackoverflow.com/users/5727371/olieshmade"}, "edited": false, "score": 0, "creation_date": 1454075043, "post_id": 35061759, "comment_id": 57893601, "body": "Very helpful, thank you! Didn&#39;t think of doing it that way, it does make it a lot easier to work with - have a great weekend! :)"}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "reply_to_user": {"reputation": 121, "user_id": 5727371, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8e99e2fa4dbf2c38b02dfddef3e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "OliEshmade", "link": "https://stackoverflow.com/users/5727371/olieshmade"}, "edited": false, "score": 0, "creation_date": 1454093071, "post_id": 35061759, "comment_id": 57905370, "body": "No problem and you too :)"}], "tags": [], "owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "is_accepted": true, "score": 1, "last_activity_date": 1453984778, "creation_date": 1453984778, "answer_id": 35061759, "question_id": 35037611, "link": "https://stackoverflow.com/questions/35037611/windowsvariable-activate-error/35061759#35061759", "title": "Windows(variable).Activate error", "body": "<pre><code>Dim filepath As String\nfilepath = ActiveWorkbook.Path + \"\\\"\n\nApplication.ScreenUpdating = False\n\nDim file As String\nDim fullfilepath As String\n\nfile = Dir$(filepath &amp; \"*Example*\" &amp; \".*\")\nfullfilepath = filepath &amp; file\n\nApplication.EnableEvents = False\n\nDim NewWB As Workbook\nSet NewWB = Workbooks.Open (fullfilepath)\n\nSet ActiveWindow = NewWB\n\nApplication.EnableEvents = True\n</code></pre>\n\n<p>I believe this is a little more elegant and easier to work with. If you declare NewWB either as static or as public variable then you can use this as a reference over multiple modules or subs. :)</p>\n"}], "owner": {"reputation": 121, "user_id": 5727371, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8e99e2fa4dbf2c38b02dfddef3e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "OliEshmade", "link": "https://stackoverflow.com/users/5727371/olieshmade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 941, "favorite_count": 0, "accepted_answer_id": 35061759, "answer_count": 1, "score": 0, "last_activity_date": 1453984778, "creation_date": 1453898262, "question_id": 35037611, "link": "https://stackoverflow.com/questions/35037611/windowsvariable-activate-error", "title": "Windows(variable).Activate error", "body": "<pre><code>Dim filepath As String\nfilepath = ActiveWorkbook.Path + \"\\\"\nApplication.ScreenUpdating = False\nDim file As String\nDim fullfilepath As String\nfile = Dir$(filepath &amp; \"*Example*\" &amp; \".*\")\nfullfilepath = filepath &amp; file\nApplication.EnableEvents = False\nWorkbooks.Open (fullfilepath)\nWindows(file).Activate\nApplication.EnableEvents = True\n</code></pre>\n\n<p>With the above code, it is quite happily populating the filepath, quite happily locating the file 'New Example.xlsm' and fullfilepath ends up correct too.</p>\n\n<p>When it gets to Windows(file).Activate I get a subscript out of range error (before it even gets any further)</p>\n\n<p>Is it something obvious? It works in another one of my coding examples.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1453898450, "post_id": 35037560, "comment_id": 57799683, "body": "There is nothing like <code>Sheet5.Activate</code>. You probably need <code>Sheets(&quot;Sheet5&quot;).Activate</code>."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1453899692, "post_id": 35037560, "comment_id": 57800547, "body": "What line is highlighted on the error?"}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 1, "creation_date": 1453900268, "post_id": 35037560, "comment_id": 57800920, "body": "@EganWolf: no worries; if one of his sheets has the code name Sheet5 then it can be accessed like that perfectly fine."}], "answers": [{"comments": [{"owner": {"reputation": 207, "user_id": 3870593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/621efb00d74eb64a3d6b6dbab2cd0f7b?s=128&d=identicon&r=PG&f=1", "display_name": "RobK", "link": "https://stackoverflow.com/users/3870593/robk"}, "edited": false, "score": 0, "creation_date": 1453900158, "post_id": 35038144, "comment_id": 57800837, "body": "Or keep it a string and use sheets(passPartNo1workbook)"}], "tags": [], "owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "is_accepted": true, "score": 0, "last_activity_date": 1453900031, "last_edit_date": 1453900031, "creation_date": 1453899693, "answer_id": 35038144, "question_id": 35037560, "link": "https://stackoverflow.com/questions/35037560/add-1-to-cell-in-same-row-but-different-column-from-vlooked-up-item/35038144#35038144", "title": "Add +1 to cell in same row but different column from Vlooked-up item", "body": "<p>Your passPartNo1workbook is Dim'ed as a String; you cannot take a .Row from it.  I assume you want to get the row at which the value from the VLookup function is found?  In that case you need the .Match function.</p>\n"}], "owner": {"reputation": 3, "user_id": 5846558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6763f2147bd6dd91d670c60ee1b866e?s=128&d=identicon&r=PG&f=1", "display_name": "Tr6637", "link": "https://stackoverflow.com/users/5846558/tr6637"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 35038144, "answer_count": 1, "score": 0, "last_activity_date": 1453900031, "creation_date": 1453898116, "last_edit_date": 1531164843, "question_id": 35037560, "link": "https://stackoverflow.com/questions/35037560/add-1-to-cell-in-same-row-but-different-column-from-vlooked-up-item", "title": "Add +1 to cell in same row but different column from Vlooked-up item", "body": "<p>I'm quite new to VBA so I apologise in advance for coding mistakes ;)</p>\n\n<p>What I'd like my code to do is:</p>\n\n<ol>\n<li>Take the caption from a label on the form </li>\n<li>Lookup that alphanumerical caption on the workbook\u2019s sheet</li>\n<li><p>Add +1 to a number which is on the same row of the Vlook part but on a <strong>different column</strong>. </p>\n\n<pre><code>Private Sub submitButton_Click()\n'Declaring variables that will be used to Vlookup on the top level part number list\n\nDim passPartNo1form As String\nDim passPartNo1workbook As String\nDim failPartNo1workbook As String\nDim rowPass1 As Integer\n\nSheets(\"Sheet5\").Activate\n\n'If Pass checkbox is selected\nIf pass1.Value = True Then\n\n    'Assign variable passPartNo1form to the caption of the PartNumber1 label\n    passPartNo1form = partNumber1.Caption\n\n    'Look up the risk score in the Top Level list\n    passPartNo1workbook = Application.WorksheetFunction.VLookup(passPartNo1form, Range(\"TopLevelList\"), 3, False)\n\n    'This should define the row of the code that has been V looked up\n    rowPass1 = passPartNo1workbook.Row\n\n    'Add +1 to the number in column 3, and row the same as the part which has been V looked up\n    Cells(rowPass1, 3).Value = Cells(2, 3).Value + 1\n\nEnd If\n\nEnd Sub\n</code></pre></li>\n</ol>\n\n<p>I\u2019ve been trying to get my head round this for ages but I always get a \u201cInvalid qualifier\u201d error. Any suggestion would be really appreciated, thanks!</p>\n"}, {"tags": ["excel", "csv", "vba"], "comments": [{"owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "edited": false, "score": 2, "creation_date": 1453898295, "post_id": 35037327, "comment_id": 57799578, "body": "Those extra separators have to be there to have a valid csv."}, {"owner": {"reputation": 439, "user_id": 2427506, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cdde9925ddfc38036f4047e4b586d914?s=128&d=identicon&r=PG", "display_name": "Yoshidk", "link": "https://stackoverflow.com/users/2427506/yoshidk"}, "reply_to_user": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "edited": false, "score": 0, "creation_date": 1453900977, "post_id": 35037327, "comment_id": 57801402, "body": "Is there a way to get around this then? Or delete them from the csv afterwards?"}, {"owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "edited": false, "score": 0, "creation_date": 1453902961, "post_id": 35037327, "comment_id": 57802792, "body": "If you&#39;re using vba, you could as well generate the file from code, or trim the trailing comma&#39;s. But it shouldn&#39;t be called a csv, or be used as a csv then. And if it has to be used as a csv, the comma&#39;s can be left in there."}, {"owner": {"reputation": 439, "user_id": 2427506, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cdde9925ddfc38036f4047e4b586d914?s=128&d=identicon&r=PG", "display_name": "Yoshidk", "link": "https://stackoverflow.com/users/2427506/yoshidk"}, "reply_to_user": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "edited": false, "score": 0, "creation_date": 1453905850, "post_id": 35037327, "comment_id": 57805104, "body": "well its an export from ABB microSCADA HMI configuration tool, here there are not seperators in those cells.  And when I later make the import the only valid files are &quot;*.csv&quot; and it returns an error if there are seperators in those fields. So i guess its ABBs fault then, but since I proberbly cant make them change this I have to make a work around"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1453908199, "creation_date": 1453908199, "answer_id": 35041289, "question_id": 35037327, "link": "https://stackoverflow.com/questions/35037327/avoid-empty-cells-on-csv-export-for-varying-row-length/35041289#35041289", "title": "Avoid empty cells on CSV export for varying row length", "body": "<p>This small macro will:</p>\n\n<ul>\n<li>avoid creating empty <em>CSV</em> records corresponding to empty Excel rows</li>\n<li>avoid trailing commas</li>\n</ul>\n\n<p><br></p>\n\n<pre><code>Option Explicit\n\nSub CSV_Makerr()\n   Dim r As Range\n   Dim sOut As String, k As Long, M As Long\n   Dim N As Long, nFirstRow As Long, nLastRow As Long\n   Dim MyFilePath As String, MyFileName As String\n   Dim fs, a, mm As Long\n   Dim separator As String\n\n   ActiveSheet.UsedRange\n   Set r = ActiveSheet.UsedRange\n   nLastRow = r.Rows.Count + r.Row - 1\n   nFirstRow = r.Row\n   separator = \",\"\n\n   MyFilePath = \"C:\\TestFolder\\\"\n   MyFileName = \"whatever\"\n   Set fs = CreateObject(\"Scripting.FileSystemObject\")\n   Set a = fs.CreateTextFile(MyFilePath &amp; MyFileName &amp; \".csv\", True)\n\n   For N = nFirstRow To nLastRow\n       k = Application.WorksheetFunction.CountA(Cells(N, 1).EntireRow)\n       sOut = \"\"\n       If k = 0 Then\n\n       Else\n           M = Cells(N, Columns.Count).End(xlToLeft).Column\n           For mm = 1 To M\n               sOut = sOut &amp; Cells(N, mm).Text &amp; separator\n           Next mm\n           sOut = Left(sOut, Len(sOut) - 1)\n           a.writeline (sOut)\n       End If\n   Next\n\n   a.Close\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 439, "user_id": 2427506, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cdde9925ddfc38036f4047e4b586d914?s=128&d=identicon&r=PG", "display_name": "Yoshidk", "link": "https://stackoverflow.com/users/2427506/yoshidk"}, "is_accepted": true, "score": 0, "last_activity_date": 1454408523, "creation_date": 1454408523, "answer_id": 35150734, "question_id": 35037327, "link": "https://stackoverflow.com/questions/35037327/avoid-empty-cells-on-csv-export-for-varying-row-length/35150734#35150734", "title": "Avoid empty cells on CSV export for varying row length", "body": "<p>I found it was pretty simple to solve, I just added a loop to check and delete if the last symbol in a line was a seperator</p>\n\n<pre><code>With Selection\nStartRow = .Cells(1).Row\nStartCol = .Cells(1).Column\nEndRow = .Cells(.Cells.Count).Row\nEndCol = .Cells(.Cells.Count).Column\nEnd With\nElse\nWith ActiveSheet.UsedRange\nStartRow = .Cells(1).Row\nStartCol = .Cells(1).Column\nEndRow = .Cells(.Cells.Count).Row\nEndCol = .Cells(.Cells.Count).Column\nEnd With\nEnd If\n\nFor RowNdx = StartRow To EndRow\nWholeLine = \"\"\nFor ColNdx = StartCol To EndCol\nIf Cells(RowNdx, ColNdx).Value = \"\" Then\nCellValue = \"\"\nElse\nCellValue = Cells(RowNdx, ColNdx).Value\nEnd If\nWholeLine = WholeLine &amp; CellValue &amp; Sep\nNext ColNdx\nWholeLine = Left(WholeLine, Len(WholeLine) - Len(Sep))\n\n//I added this to delete the last seperator in a line before printing\nDim last As String\nlast = Right(WholeLine, 1)\nDo Until last &lt;&gt; \",\"\nWholeLine = Left(WholeLine, Len(WholeLine) - 1)\nlast = Right(WholeLine, 1)\nLoop\n\nPrint #nFileNum, WholeLine\nNext RowNdx\n</code></pre>\n"}], "owner": {"reputation": 439, "user_id": 2427506, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cdde9925ddfc38036f4047e4b586d914?s=128&d=identicon&r=PG", "display_name": "Yoshidk", "link": "https://stackoverflow.com/users/2427506/yoshidk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1550, "favorite_count": 0, "accepted_answer_id": 35150734, "answer_count": 2, "score": 1, "last_activity_date": 1539709448, "creation_date": 1453897502, "last_edit_date": 1592644375, "question_id": 35037327, "link": "https://stackoverflow.com/questions/35037327/avoid-empty-cells-on-csv-export-for-varying-row-length", "title": "Avoid empty cells on CSV export for varying row length", "body": "<p>My rows do not have the same length and I need to avoid the &quot;blanks&quot; in between when I export to CSV.</p>\n<p>For example, when I export this:</p>\n<blockquote>\n<p>1 2   3   4   5</p>\n<p>1 2</p>\n<p>1 3   3   4</p>\n<p>1 2   3   4   5</p>\n</blockquote>\n<p>I get this:</p>\n<blockquote>\n<p>1,2,3,4,5</p>\n<p>1,2,,,</p>\n<p>1,3,3,4,</p>\n<p>1,2,3,4,5</p>\n</blockquote>\n<p>And I need to remove the extra seperators from the empty cells between.\nI am already running a macro to export as CSV, so it would be best if I could &quot;delete&quot; the empty cells in the beginning of this.</p>\n"}, {"tags": ["sql", "excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 5846514, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/857112c37d6d58cabbf53d21f8817ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Machin", "link": "https://stackoverflow.com/users/5846514/paul-machin"}, "edited": false, "score": 1, "creation_date": 1453897652, "post_id": 35036997, "comment_id": 57799119, "body": "Yea its got both Letters and Numbers in, so it needs to be a string. But your changes with the &#39;&quot; &amp; &amp;&quot;&#39; worked! thank you very much :)"}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "reply_to_user": {"reputation": 39, "user_id": 5846514, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/857112c37d6d58cabbf53d21f8817ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Machin", "link": "https://stackoverflow.com/users/5846514/paul-machin"}, "edited": false, "score": 0, "creation_date": 1453898227, "post_id": 35036997, "comment_id": 57799527, "body": "I was just checking because in many cases <code>column(0)</code> is given to the primary key and autonumber, so would be a number. glad I could help!"}], "tags": [], "owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "is_accepted": true, "score": 1, "last_activity_date": 1453897032, "last_edit_date": 1453897032, "creation_date": 1453896606, "answer_id": 35036997, "question_id": 35036853, "link": "https://stackoverflow.com/questions/35036853/access-sql-enter-parameter-value-when-trying-to-export-to-excel/35036997#35036997", "title": "Access SQL Enter Parameter Value when trying to export to excel", "body": "<p>the <code>selecteduser</code> in your query needs to be outside of the quotes. as it is a string it needs to be in single quotes like <code>'selecteduser'</code>. Now if you msgbox your query and you should see that the <code>selecteduser</code> equals your <code>column (0)</code>. are you sure that <code>selecteduser</code> needs to be a string and not a number e.g. <code>long</code>?</p>\n\n<pre><code>Private Sub Command12_Click()\nDim strSQL As String\nDim strQry As String\nDim selecteduser As String\nDim db As DAO.Database\nDim Qdf As QueryDef\n\nselecteduser = Me.Combo6.Column(0)\n\nstrSQL = \"SELECT tblPra.praNo, tblFolder.folder, tblFolder.fullTitle FROM \" &amp;_ \n         \"tblPra INNER JOIN (tblFolder INNER JOIN tblRelationship ON \" &amp;_\n         \"tblFolder.folderID = tblRelationship.folderID) ON \" &amp;_\n         \"tblPra.praID = tblRelationship.praID \" &amp;_\n         \"WHERE (((tblPra.praNo)='\" &amp; selecteduser &amp; \"'));\"\nstrQry = \"tempuser\"\n\nSet db = CurrentDb\nSet Qdf = db.CreateQueryDef(strQry, strSQL)\n\nOn Error Resume Next\nDoCmd.DeleteObject acQuery, \"strQry\"\n\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel8, _\nstrQry, \"C:\\Users\\prc93\\Desktop\\test.xls\", True\n\nDoCmd.DeleteObject acQuery, strQry\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5846514, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/857112c37d6d58cabbf53d21f8817ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Machin", "link": "https://stackoverflow.com/users/5846514/paul-machin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "accepted_answer_id": 35036997, "answer_count": 1, "score": 0, "last_activity_date": 1453897032, "creation_date": 1453896175, "question_id": 35036853, "link": "https://stackoverflow.com/questions/35036853/access-sql-enter-parameter-value-when-trying-to-export-to-excel", "title": "Access SQL Enter Parameter Value when trying to export to excel", "body": "<p>I Am trying to run this SQL statement and then export the result to an excel spread sheet. I've looked through the the internet and found this, which seemed to work for other users. </p>\n\n<p>It runs but asks me to \"Enter Parameter Value\" linking to \"selecteduser\" on line 4 of the code, the message box shows up at the point where the code starts here: DoCmd.TransferSpreadsheet. If I click ok the excel sheet is created but with nothing in except the titles from the selected columns from the tables in the database. If i put valid data into the text box and press ok, then the excel spreadsheet is created with the correct data showing. </p>\n\n<p>I know that the selected data in the ComboBox is been stored, because if I do a Message box it shows the selected data from the combobox. </p>\n\n<p>Any ideas anyone? It's obvious the data isn't been passed through somewhere, but I can't see where. </p>\n\n<pre><code>Private Sub Command12_Click()\nDim strSQL As String\nDim strQry As String\nDim selecteduser As String\nDim db As DAO.Database\nDim Qdf As QueryDef\n\nselecteduser = Me.Combo6.Column(0)\n\nstrSQL = \"SELECT tblPra.praNo, tblFolder.folder, tblFolder.fullTitle FROM tblPra INNER JOIN (tblFolder INNER JOIN tblRelationship ON tblFolder.folderID = tblRelationship.folderID) ON tblPra.praID = tblRelationship.praID WHERE (((tblPra.praNo)=selecteduser));\"\nstrQry = \"tempuser\"\n\nSet db = CurrentDb\nSet Qdf = db.CreateQueryDef(strQry, strSQL)\n\nOn Error Resume Next\nDoCmd.DeleteObject acQuery, \"strQry\"\n\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel8, _\nstrQry, \"C:\\Users\\prc93\\Desktop\\test.xls\", True\n\nDoCmd.DeleteObject acQuery, strQry\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1453895539, "post_id": 35036375, "comment_id": 57797535, "body": "What is the issue? Sheets(&quot;DataDetail&quot;).Range(Cells(2, 80)).Copy is fixed, you need to add your row counter for the row number"}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1453895819, "post_id": 35036375, "comment_id": 57797761, "body": "Try changing <code>Sheets(&quot;DataDetail&quot;).Range(Cells(2, 80)).Copy</code> to <code>Sheets(&quot;DataDetail&quot;).Range(Sheets(&quot;DataDetail&quot;).Cells(2, 80)).Copy</code> Or even you dont need to specify range, if you wana select only single cell e.g <code>Sheets(&quot;DataDetail&quot;).Cells(2, 80).copy</code> (and please try to format your code example)"}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1453897991, "post_id": 35036375, "comment_id": 57799365, "body": "What range are you actually trying to copy? <code>CB2</code> which is <code>Cells(2, 80) refers to or are you trying to copy </code>B2:CB2`?"}, {"owner": {"reputation": 1, "user_id": 5846463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84af39928dd0f8084f92b23e1adc5185?s=128&d=identicon&r=PG&f=1", "display_name": "Carl M", "link": "https://stackoverflow.com/users/5846463/carl-m"}, "edited": false, "score": 0, "creation_date": 1454086008, "post_id": 35036375, "comment_id": 57901370, "body": "I&#39;m trying to copy the entire sheet (last column and last row). But i must be able to do this without creating a new tab, as i have conditional formatting in the destination sheet"}], "owner": {"reputation": 1, "user_id": 5846463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84af39928dd0f8084f92b23e1adc5185?s=128&d=identicon&r=PG&f=1", "display_name": "Carl M", "link": "https://stackoverflow.com/users/5846463/carl-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453951060, "creation_date": 1453894831, "last_edit_date": 1531164843, "question_id": 35036375, "link": "https://stackoverflow.com/questions/35036375/copying-all-columns-based-on-specific-if-statement", "title": "Copying All columns based on specific IF statement", "body": "<p>I'm having an issue with this line of the code in the debugger:</p>\n\n<pre><code>Sheets(\"DataDetail\").Range(Cells(2, 80)).Copy\n</code></pre>\n\n<p>I am trying to copy all the columns in DataDetail(worksheet) based on if the user \"Olive Thompson\" is in column1 of DataDetail. However, it doesn't like my column copy. I'd like the range of column cells to be dynamic if possible.</p>\n\n<p>Here is the code below.</p>\n\n<pre><code>Sub copycolumns()\n  Dim i As Variant\n  Dim lastrow As Long, erow As Long\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Sheets(\"TRACKERdetail\").Rows(\"2:\" &amp; Rows.Count).ClearContents\n  lastrow = Sheets(\"DataDetail\").Cells(Rows.Count, 2).End(xlUp).Row\n  For i = 2 To lastrow\n    If Sheets(\"DataDetail\").Cells(i, 1) = \"Oliver Thompson\" Then\n      Sheets(\"DataDetail\").Range(Cells(2, 80)).Copy \n      erow = Sheets(\"TRACKERdetail\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n      Sheets(\"DataDetail\").Paste Destination:=Worksheets(\"TRACKERdetail\").Cells(erow, 1)\n    End If\n  Next i\n  Application.CutCopyMode = False\n  Sheets(\"TRACKERdetail\").Columns().AutoFit\n  Range(\"A1\").Select\n  Application.EnableEvents = True\n  Application.ScreenUpdating = True\n  Dayleftsort\nEnd Sub \n\nSub Dayleftsort() \n  ' \n  ' Dayleftsort Macro \n  ' sorts the tracker tab by days left \n  ' \n  ' Keyboard Shortcut: Ctrl+d \n  ' \n  Cells.Select\n  ActiveWorkbook.Worksheets(\"TRACKERdetail\").Sort.SortFields.Clear\n  ActiveWorkbook.Worksheets(\"TRACKERdetail\").Sort.SortFields.Add Key:=Range(\"N2:N1000\") _ \n    , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal \n  With ActiveWorkbook.Worksheets(\"TRACKERdetail\").Sort \n    .SetRange Range(\"A1:AF1000\") \n    .Header = xlYes \n    .MatchCase = False \n    .Orientation = xlTopToBottom \n    .SortMethod = xlPinYin \n    .Apply \n  End With \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1453896929, "post_id": 35036152, "comment_id": 57798606, "body": "See <a href=\"http://www.fontstuff.com/vba/vbatut07.htm\" rel=\"nofollow noreferrer\">A Pop-up Calendar for Excel</a>."}], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 4768070, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d006733940e0268bb67c5607755766ac?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael", "link": "https://stackoverflow.com/users/4768070/rafael"}, "is_accepted": false, "score": 1, "last_activity_date": 1453899724, "creation_date": 1453899724, "answer_id": 35038148, "question_id": 35036152, "link": "https://stackoverflow.com/questions/35036152/pop-up-calendar-for-date-selection-in-place-of-input-box/35038148#35038148", "title": "Pop up calendar for date selection in place of input box", "body": "<p>Here u can find answer to ur question <a href=\"http://www.fontstuff.com/vba/vbatut07.htm\" rel=\"nofollow\">link</a> </p>\n"}], "owner": {"reputation": 89, "user_id": 4933823, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6da7cea6e6e500282f2463a2842c5a60?s=128&d=identicon&r=PG&f=1", "display_name": "KISHOR BHOIR", "link": "https://stackoverflow.com/users/4933823/kishor-bhoir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3211, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453899724, "creation_date": 1453894250, "last_edit_date": 1531161705, "question_id": 35036152, "link": "https://stackoverflow.com/questions/35036152/pop-up-calendar-for-date-selection-in-place-of-input-box", "title": "Pop up calendar for date selection in place of input box", "body": "<p>I am currently using a macro, in which I am using input box for manually typing date for <code>.autofilter</code> The two lines as below.</p>\n\n<pre><code>key1 = InputBox(\"Expiry Date\", \"Title\")\n.Range(\"A1\").CurrentRegion.AutoFilter Field:=2, Criteria1:=key1\n</code></pre>\n\n<p>Here I need and pop up a calendar, so that instead of manually typing date, I can choose a date from calendar.</p>\n"}, {"tags": ["vba", "excel", "filter", "autofilter"], "answers": [{"comments": [{"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1453899635, "post_id": 35036537, "comment_id": 57800504, "body": "Is there a way of doing this without protecting the sheet through code? I.e. just protecting it through Excel&#39;s &quot;Protect Sheet&quot; button?"}, {"owner": {"reputation": 36, "user_id": 5846360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f4172ee25b0f33902a1f4bf5d81834c?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro Duprat", "link": "https://stackoverflow.com/users/5846360/pedro-duprat"}, "reply_to_user": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1453924778, "post_id": 35036537, "comment_id": 57817957, "body": "Hi @BenSmith. Yes, there is. On the &quot;Protect Sheet&quot; dialog there is a list of protection options. One of them is &quot;Use AutoFilter&quot; (I&#39;m using Excel 2013. I don&#39;t remember if the name is different on earlier versions of Excel. But its there!). Just mark that checkbox and you&#39;re good to go!"}], "tags": [], "owner": {"reputation": 36, "user_id": 5846360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f4172ee25b0f33902a1f4bf5d81834c?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro Duprat", "link": "https://stackoverflow.com/users/5846360/pedro-duprat"}, "is_accepted": true, "score": 1, "last_activity_date": 1453896044, "last_edit_date": 1453896044, "creation_date": 1453895285, "answer_id": 35036537, "question_id": 35035776, "link": "https://stackoverflow.com/questions/35035776/vba-how-do-i-allow-filters-to-be-turned-on-and-off-on-a-protected-sheet/35036537#35036537", "title": "VBA: How do I allow filters to be turned on and off on a protected sheet?", "body": "<p>How are you?</p>\n\n<p>It will depend on the setup of the protection. When you protect a worksheet, there is an option to allow filtering (AutoFilter).</p>\n\n<p>If you're the one who's protecting the sheet, you can use any of the worksheet's <strong>protect</strong> method's parameters to set the protection options. Here are the protect method's parameters:</p>\n\n<pre><code>sheetName.Protect(Password, DrawingObjects, Contents, Scenarios, UserInterfaceOnly, AllowFormattingCells, AllowFormattingColumns, AllowFormattingRows, AllowInsertingColumns, AllowInsertingRows, AllowInsertingHyperlinks, AllowDeletingColumns, AllowDeletingRows, AllowSorting, AllowFiltering, AllowUsingPivotTables)\n</code></pre>\n\n<p>If you want to be able to implement filters only by code, then you can set the  UserInterfaceOnly parameter to TRUE. The protection will block only the users changes. Code changes will be fully allowed.</p>\n\n<pre><code>sheetName.Protect UserInterfaceOnly:=True\n</code></pre>\n\n<p>Or, if you want to allow users to filter the contents of the worksheet from the interface, just set the AllowFiltering parameter to TRUE as well as the UserInterfaceOnly parameter.</p>\n\n<pre><code>sheetName.Protect UserInterfaceOnly:=True, AllowFiltering:=True\n</code></pre>\n\n<p>Your code should work with both options.</p>\n\n<p>Hope it helps!</p>\n"}], "owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6094, "favorite_count": 0, "accepted_answer_id": 35036537, "answer_count": 1, "score": 1, "last_activity_date": 1453896044, "creation_date": 1453893278, "question_id": 35035776, "link": "https://stackoverflow.com/questions/35035776/vba-how-do-i-allow-filters-to-be-turned-on-and-off-on-a-protected-sheet", "title": "VBA: How do I allow filters to be turned on and off on a protected sheet?", "body": "<p>I have the following piece of code, which removes filters and then re-applies them from selected cells:</p>\n\n<pre><code>Range(\"A10:AM10\").Select\n\nSelection.AutoFilter\nSelection.AutoFilter\n</code></pre>\n\n<p>The problem I have is that when the sheet is protected and I try to run the code it errors, so is there a way of allowing filters to be turned on and off on a protected sheet?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": false, "score": 0, "last_activity_date": 1453894922, "creation_date": 1453894922, "answer_id": 35036406, "question_id": 35035419, "link": "https://stackoverflow.com/questions/35035419/trying-to-automate-a-process-of-sorting-one-column-all-the-way-from-dd-to-z/35036406#35036406", "title": "Trying to automate a process of sorting one column, all the way from &quot;D:D&quot; to &quot;ZZ:ZZ&quot;", "body": "<p>Here's an example of how you would sort columns 1-500 individually:</p>\n\n<pre><code>  Dim col As Integer\n  Dim r As Range\n  Dim ws As Worksheet\n\n  Set ws = ActiveSheet\n\n  For col = 1 To 500\n\n    Set r = Cells(1, col).EntireColumn\n\n    With ws\n      .Sort.SortFields.Clear\n      .Sort.SortFields.Add Key:=r, _\n          SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n      With ws.Sort\n        .SetRange r\n        .Apply\n      End With\n    End With\n\n  Next col\n</code></pre>\n\n<p>There are a lot of other settings you can apply, depending on your data and how you want to handle things (ie does your data have headers).</p>\n\n<p>I can never remember them all -- what I would usually do from here is record a macro with the settings I want and then manually peel them out and add them to the code above.</p>\n\n<p>For example, if you wanted to sort descending, you would have to add <code>Order:=xlDescending</code> to the inner <code>With</code> clause.</p>\n"}], "owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453894922, "creation_date": 1453892291, "question_id": 35035419, "link": "https://stackoverflow.com/questions/35035419/trying-to-automate-a-process-of-sorting-one-column-all-the-way-from-dd-to-z", "title": "Trying to automate a process of sorting one column, all the way from &quot;D:D&quot; to &quot;ZZ:ZZ&quot;", "body": "<p>In short, I have about five hundred or so columns, all of which to sort alphabetically (with headers). Although this may have an easier solution involving highlighting the entire dataset and doing a custom sort of some sort.... I've taken a stab at writing a script for it. What I have so far is:</p>\n\n<pre><code>Sub ColumnSort()\n\nDim Rng As Range\nDim i As Long \nDim aCell As Range\n   i = 0 \nSet Rng = Range(\"D:D\")\n\nWhile i &lt;= 5000\n\nRng.Offset(0, i).Sort Order1:=xlAscending, Header:=xlYes\ni = i + 1\n\nEnd\n\nWend \nEnd Sub\n</code></pre>\n\n<p>You can probably see my reasoning, but the line <code>Rng.Offset(0, i).Sort Order1:xlAscending, Header: =xlYes</code> is giving me an error. Is this the correct syntax to use for this particular problem? Is there a better way to do this?</p>\n\n<p>thanks,</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "edited": false, "score": 1, "creation_date": 1453892934, "post_id": 35035003, "comment_id": 57795846, "body": "Does this <code>Me.SApp.Form.RecordSource = &quot;SELECT * FROM Application WHERE Item LIKE &#39;*&quot; &amp; Me.Item.Value &amp; &quot;*&#39;;&quot;</code> help?"}, {"owner": {"reputation": 57, "user_id": 4701094, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e4fe838bff2992781ced4fb0e990b43c?s=128&d=identicon&r=PG&f=1", "display_name": "nescionomen93", "link": "https://stackoverflow.com/users/4701094/nescionomen93"}, "reply_to_user": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "edited": false, "score": 1, "creation_date": 1453893421, "post_id": 35035003, "comment_id": 57796132, "body": "OK , IT works , you saved me thanks"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 4701094, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e4fe838bff2992781ced4fb0e990b43c?s=128&d=identicon&r=PG&f=1", "display_name": "nescionomen93", "link": "https://stackoverflow.com/users/4701094/nescionomen93"}, "edited": false, "score": 0, "creation_date": 1453892256, "post_id": 35035132, "comment_id": 57795433, "body": "I tried putting * instead of % , but nothing. Looks like he&#39;s having problem identifiyng a string into a string (s inside the query string)"}], "tags": [], "owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "is_accepted": false, "score": 1, "last_activity_date": 1453891471, "creation_date": 1453891471, "answer_id": 35035132, "question_id": 35035003, "link": "https://stackoverflow.com/questions/35035003/vba-like-operator-with-string/35035132#35035132", "title": "VBA LIKE operator with string", "body": "<p>Use the * wildcard in MsAccess, in other dbs it's usually %.</p>\n\n<p>Ref: <a href=\"https://msdn.microsoft.com/en-us/library/bb208897(v=office.12).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/bb208897(v=office.12).aspx</a></p>\n"}], "owner": {"reputation": 57, "user_id": 4701094, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e4fe838bff2992781ced4fb0e990b43c?s=128&d=identicon&r=PG&f=1", "display_name": "nescionomen93", "link": "https://stackoverflow.com/users/4701094/nescionomen93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453895140, "creation_date": 1453891098, "last_edit_date": 1453895140, "question_id": 35035003, "link": "https://stackoverflow.com/questions/35035003/vba-like-operator-with-string", "title": "VBA LIKE operator with string", "body": "<p>I have this code:</p>\n\n<pre><code>Private Sub Item_AfterUpdate()\nMe.SApp.Form.RecordSource = \"SELECT * FROM Application WHERE Item = '\" &amp; Me.Item.Value &amp; \"';\"\nEnd Sub\n</code></pre>\n\n<p>Now , this works so it filters SApp (a subform) base on the value in the combobox Item.\nI wanna do something similar however not with equal but with like.\nSo , something like:</p>\n\n<pre><code>Private Sub Item_AfterUpdate()\nMe.SApp.Form.RecordSource = \"SELECT * FROM Application WHERE Item LIKE '\" &amp; Me.Item.Value &amp; \"';\"\nEnd Sub\n</code></pre>\n\n<p>I tried :</p>\n\n<pre><code>'% Me.Item.Value %'\n\n'% '\" &amp; Me.Item.Value &amp; \"' %'\n\n'% s %' with (Dim s as string ; s = Me.Item.Value)\n</code></pre>\n\n<p>None of this solutions works , any idea on how to fix this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1453891069, "post_id": 35034650, "comment_id": 57794642, "body": "At least you have to call your function/sub in<code>ThisWorkbook </code> module. Then you can keep other codes in custome module."}], "answers": [{"comments": [{"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1453892798, "post_id": 35035407, "comment_id": 57795776, "body": "Your code seems to come from Word as it&#39;s using ActiveDocument?  Won&#39;t work in Excel as-is...  And &quot;clsLoeschen&quot; indiscriminately kills the first VBComponent in the project, and not the specific module being upgraded."}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "reply_to_user": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1453894632, "post_id": 35035407, "comment_id": 57796928, "body": "@CarlColijn Ops. Yeah you are right. Forget to Change that. The Code was Original from a Visio Project. But i Changed it. So now it works fine with Excel. Thansk for the hint!"}], "tags": [], "owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "is_accepted": false, "score": 0, "last_activity_date": 1453893537, "last_edit_date": 1453893537, "creation_date": 1453892258, "answer_id": 35035407, "question_id": 35034650, "link": "https://stackoverflow.com/questions/35034650/how-to-use-workbook-beforeclose-from-a-custom-module/35035407#35035407", "title": "How to use Workbook_BeforeClose from a custom module", "body": "<p>There is a way how you can Import the <strong>ThisWorkbook Module</strong>. I wrote some Code for that a long Time ago.</p>\n\n<p>So how does it work.</p>\n\n<ol>\n<li>First you have to Export the <strong>ThisWorkbook Module</strong>. Right click on the Module and Export.</li>\n<li>Save the <strong>ThisWorkbook.cls</strong> on the Server where you have your other Module's or send it with the Modules (Like how you do the Upgrade of the other Modules)</li>\n<li><p>Open the <strong>ThisWorkbook.cls</strong> File with a Editor (Like Notepad++)\nAnd Delete The First Rows. They Look like This.</p>\n\n<p><strong>VERSION 1.0 CLASS</strong></p>\n\n<p><strong>BEGIN</strong></p>\n\n<p><strong>MultiUse = -1  'True</strong></p>\n\n<p><strong>END</strong></p></li>\n<li><p>Execute the <strong>UpdateThisDocument</strong> Subrutine.</p>\n\n<p>The Only Question how have to answer yourself is how you will Execute The Code ^^ (I wrote en Extern Updater that Executed the Code)</p>\n\n<pre><code>Sub UpdateThisDocument()\n  Dim ModuleName As String\n  ModuleName = \"DieseArbeitsmappe\"\n  Dim aDoc As Workbook\n  Set aDoc = ThisWorkbook\n  Dim strPath As String\n  'Put here the Path to the Folder where the cls File of This Workbook is.\n  strPath = \"C:\\Users\\z002mkvy\\Desktop\\\"\n  With aDoc          \n     If ModuleExists(ModuleName) = True Then\n       Call clsLoeschen\n     End If\n    '\n\n    With ThisWorkbook.VBProject\n      .VBComponents(ModuleName).CodeModule.AddFromFile _\n        strPath &amp; \"\\DieseArbeitsmappe.cls\"\n  Fehler:\n      End With\n  End With\n  End Sub\n\n\n\nPrivate Function ModuleExists(ModuleName As String) _\n  As Boolean\n  On Error Resume Next\n  ModuleExists = Len(ThisWorkbook.VBProject _\n  .VBComponents(ModuleName).Name) &lt;&gt; 0\nEnd Function\n\nPrivate Sub clsLoeschen()\n  Dim modcls\n  Dim awcl As Integer\n  On Error Resume Next\n  Set modcls = ThisWorkbook.VBProject.VBComponents.Item(\"DieseArbeitsmappe\")\n  awcl = modcls.CodeModule.CountOfLines\n  modcls.CodeModule.DeleteLines 1, awcl\n  Set modcls = Nothing\nEnd Sub\n</code></pre></li>\n</ol>\n\n<p>I hope This can Help you</p>\n"}, {"tags": [], "owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "is_accepted": false, "score": 0, "last_activity_date": 1453892952, "last_edit_date": 1453892952, "creation_date": 1453892266, "answer_id": 35035410, "question_id": 35034650, "link": "https://stackoverflow.com/questions/35034650/how-to-use-workbook-beforeclose-from-a-custom-module/35035410#35035410", "title": "How to use Workbook_BeforeClose from a custom module", "body": "<p>You can use the Application.VBE object and Workbook.VBProject to modify a file's VBA.  Note however that it requires that the Excel performing the upgrade has to have the setting \"Trust access to the VBA project\" toggled on (it can be found in the Trust center under the tab Macro settings).  When not needed anymore, it's an option best left off though for security reasons.</p>\n"}], "owner": {"reputation": 93, "user_id": 4450876, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8bb6627537711f2a79258a3864bbf287?s=128&d=identicon&r=PG&f=1", "display_name": "Amelie Peter", "link": "https://stackoverflow.com/users/4450876/amelie-peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1453893537, "creation_date": 1453890145, "question_id": 35034650, "link": "https://stackoverflow.com/questions/35034650/how-to-use-workbook-beforeclose-from-a-custom-module", "title": "How to use Workbook_BeforeClose from a custom module", "body": "<p>I am trying to prompt the user when he tries to close a workbook like this</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel as Boolean) \n MsgBox \"Changes has been detected. Do you want to export the data ?\"\nEnd Sub\n</code></pre>\n\n<p>I know that this code need to be placed in ThisWorkbook module. \nIs there a way to do that from my custom module ? I need to add this functionality to multiple workbooks used by my client as a part of up-gradation, which is usually done by replacing old modules with new modules.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1453915878, "creation_date": 1453915878, "answer_id": 35044174, "question_id": 35034602, "link": "https://stackoverflow.com/questions/35034602/excel-activating-a-previous-workbook-after-leaving-it/35044174#35044174", "title": "Excel - activating a previous workbook after leaving it", "body": "<p>The best way to deal with something like this is to work with the object model: Declare objects for the workbooks you need to keep track of and assign the workbooks to them. Such objects don't depend on what's \"active\" or \"selected\". For example:</p>\n\n<pre><code>Dim wkbOriginal as Excel.Workbook\nDim wkbNew as Excel.Workbook\n\nSet wkbOriginal = ActiveWorkbook\n'Do things here\nSet wkbNew = Workbooks.Add\n'Do more things\nwkbNew.Close\n'wkbOriginal is still accessible and can be used in your code\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5136653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e32d5e2c604cdd6e11237c27d9d18113?s=128&d=identicon&r=PG&f=1", "display_name": "David Woollin", "link": "https://stackoverflow.com/users/5136653/david-woollin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5027, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453915878, "creation_date": 1453890037, "last_edit_date": 1453896866, "question_id": 35034602, "link": "https://stackoverflow.com/questions/35034602/excel-activating-a-previous-workbook-after-leaving-it", "title": "Excel - activating a previous workbook after leaving it", "body": "<p>I am working on a current workbook in Excel. In the VBA, I have done the following : </p>\n\n<pre><code>Sheets(\"Upload File\").Select\nCells.Select\nSelection.Copy\nWorkbooks.Add\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n</code></pre>\n\n<p>So now, \"Book1\" is the new workbook. Once I've done what I need to do on there, I need to it then activate the original workbook, the one where I have all the VBA etc.</p>\n\n<p>I close \"Book1\" with : </p>\n\n<pre><code>ActiveWindow.Close\n</code></pre>\n\n<p>But then in the next Sub in a process, I can't call any of the sheets within the active workbook : </p>\n\n<pre><code>Sheets(\"Upload File\").Range(\"A1:AB65536\").ClearContents \n</code></pre>\n\n<p>as i get a \"Subscript Out Of Range\" error due to the Workbook that \"Upload File\" sits in not actually being activated again.</p>\n\n<p>Thank you for taking the time to look at this. </p>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "edited": false, "score": 0, "creation_date": 1453894631, "post_id": 35034626, "comment_id": 57796927, "body": "Hell yeah! This is nice. Quick question: this function sends me to a <code>.ini</code> file, which has a header such as <code>[Header Text]</code> and several entries/keys below, such as &quot;Company=company name&quot;. Trying to access the entries returns the error &quot;Invalid root in registry key&quot;. Any idea how I can specifically return the value of a key?"}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "reply_to_user": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "edited": false, "score": 0, "creation_date": 1453895113, "post_id": 35034626, "comment_id": 57797248, "body": "@Holene Can you Post some Code? Because i don&#39;t understand your Question."}, {"owner": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "edited": false, "score": 0, "creation_date": 1453896235, "post_id": 35034626, "comment_id": 57798042, "body": "Ah, yeah, I did some more searching, and what I&#39;m basically asking is if there is an easy way to read <code>.ini</code> files in Excel VBA?"}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "reply_to_user": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "edited": false, "score": 0, "creation_date": 1453897677, "post_id": 35034626, "comment_id": 57799134, "body": "@Holene <a href=\"http://stackoverflow.com/questions/27185865/vba-read-all-text-in-a-text-file\">VBA Read Text File</a>"}], "tags": [], "owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "is_accepted": true, "score": 3, "last_activity_date": 1453890098, "creation_date": 1453890098, "answer_id": 35034626, "question_id": 35034169, "link": "https://stackoverflow.com/questions/35034169/excel-vba-equivalent-to-word-vba-system/35034626#35034626", "title": "Excel VBA equivalent to Word VBA System", "body": "<p>Hi if you wand to read the regesty in Excel you can do it this way.</p>\n\n<pre><code>Sub test()\nDim strPath As String\n    strPath = RegKeyRead(\"HKEY_CURRENT_USER\\Volatile Environment\\HOMESHARE\")\nEnd Sub\n\nFunction RegKeyRead(i_RegKey As String) As String\nDim myWS As Object\n\n  On Error Resume Next\n  'access Windows scripting\n  Set myWS = CreateObject(\"WScript.Shell\")\n  'read key from registry\n  RegKeyRead = myWS.RegRead(i_RegKey)\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1379931"}, "is_accepted": false, "score": 1, "last_activity_date": 1453903353, "creation_date": 1453903353, "answer_id": 35039475, "question_id": 35034169, "link": "https://stackoverflow.com/questions/35034169/excel-vba-equivalent-to-word-vba-system/35039475#35039475", "title": "Excel VBA equivalent to Word VBA System", "body": "<p>Assuming (as per your other question) your Excel code has a reference to a word Object, let's say \"objWord\", it should be...</p>\n\n<pre><code>strHomeSharePath = objWord.System.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Volatile Environment\", \"HOMESHARE\")\n</code></pre>\n\n<p>IMO the word \"System\" is a bit misleading, suggesting that it isn't to do with Word. But it's a class in the Word library.</p>\n"}], "owner": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 954, "favorite_count": 0, "accepted_answer_id": 35034626, "answer_count": 2, "score": 4, "last_activity_date": 1453903353, "creation_date": 1453888936, "last_edit_date": 1495541285, "question_id": 35034169, "link": "https://stackoverflow.com/questions/35034169/excel-vba-equivalent-to-word-vba-system", "title": "Excel VBA equivalent to Word VBA System", "body": "<p>I have a Word VBA function that I'm trying to build in Excel VBA (the reason behind this choice comes from <a href=\"https://stackoverflow.com/questions/34993589/how-to-access-a-word-public-variable-in-excel-vba?noredirect=1#comment57722516_34993589\">this question</a>) and I'm stuck at the following problem:</p>\n\n<p>The Word VBA function uses <code>System.PrivateProfileString</code> extensively, which throws the <code>Compile Error: invalid qualifier</code> error when applied to Excel VBA. What's the equivalent statement in Excel? Alternatively, how do I work my way around this? </p>\n\n<p>Example of use: </p>\n\n<pre><code>strHomeSharePath = System.PrivateProfileString(\"\", \"HKEY_CURRENT_USER\\Volatile Environment\", \"HOMESHARE\")\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1453891418, "post_id": 35033850, "comment_id": 57794867, "body": "You probably have a typo in your code; StRng.End(xlDown).Offset(o, j - 1) contains an &#39;o&#39; (small letter), which is an undefined name.  Have you used Option Explicit?  If not, better start using it now to catch these types of errors and replace the &#39;0&#39; with a zero."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5845770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b47de693f7a05ab78b8255f779cf8bf?s=128&d=identicon&r=PG&f=1", "display_name": "Any1There", "link": "https://stackoverflow.com/users/5845770/any1there"}, "edited": false, "score": 0, "creation_date": 1453912896, "post_id": 35034876, "comment_id": 57810371, "body": "Thank you very much. Your suggestions worked very well."}], "tags": [], "owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "is_accepted": false, "score": 0, "last_activity_date": 1453891693, "last_edit_date": 1453891693, "creation_date": 1453890785, "answer_id": 35034876, "question_id": 35033850, "link": "https://stackoverflow.com/questions/35033850/cut-paste-overwriting-range-object-definitions/35034876#35034876", "title": "Cut &amp; Paste Overwriting Range Object definitions", "body": "<p>If you use the .Paste method, then all defined ranges that fall withing the paste boundaries will be reset.  The exact \"Why?\" is something only Microsoft can explain I'm afraid.</p>\n\n<p>A better alternative is to work with the Range.Value and Range.Clear members; these won't cause this issue, are faster, and also don't mess with the clipboard.  Note however that this only copies the values and not the formatting nor any formulas.</p>\n\n<p>The code for this can be something like this:</p>\n\n<pre><code>  Dim SourceRng As Range\n  Set SourceRng = Range(StRng.Offset(x, 0), StRng.End(xlDown).Offset(0, j - 1))\n  Set StRng = StRng.Offset(0, j + 1)\n  Dim DestRng As Range\n  Set DestRng = StRng.Resize(SourceRng.Rows.Count, SourceRng.Columns.Count)\n  DestRng.Value = SourceRng.Value\n  Call SourceRng.Clear\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 5845770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b47de693f7a05ab78b8255f779cf8bf?s=128&d=identicon&r=PG&f=1", "display_name": "Any1There", "link": "https://stackoverflow.com/users/5845770/any1there"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1453891693, "creation_date": 1453888097, "last_edit_date": 1531164843, "question_id": 35033850, "link": "https://stackoverflow.com/questions/35033850/cut-paste-overwriting-range-object-definitions", "title": "Cut &amp; Paste Overwriting Range Object definitions", "body": "<p>I've found an interesting problem with Excel VBA's Cut and paste involving the use of a defined Range Object.</p>\n\n<p>Here's the code that doesn't work:</p>\n\n<pre><code>Sub PasteToRangeDoesntWork()\nDim StRng As Range\nDim j, k, x, y As Integer\n\nSet StRng = Range(\"A3\")\nx = 0\nj = Range(StRng, StRng.End(xlToRight)).Columns.Count\nk = WorksheetFunction.Max(Range(StRng, StRng.End(xlDown)))\n\nFor y = 1 To k\n    While StRng.Offset(x, 0) = y\n        x = x + 1\n    Wend\n    If y &lt; k Then\n        Range(StRng.Offset(x, 0), StRng.End(xlDown).Offset(o, j - 1)).Select\n        Selection.Cut\n        Set StRng = StRng.Offset(0, j + 1)\n        ActiveSheet.Paste Destination:=StRng\n        x = 0\n    End If\nNext y\nEnd Sub\n</code></pre>\n\n<p>The problem is that when pasting to the defined <code>StRng</code>, the <code>StRng</code> object disappears and becomes and undefined object.</p>\n\n<p>There's a simple fix, which I've done below.</p>\n\n<pre><code>Sub PasteToRangeWorks()\nDim StRng As Range\nDim j, k, x, y As Integer\n\nSet StRng = Range(\"A3\")\nx = 0\nj = Range(StRng, StRng.End(xlToRight)).Columns.Count\nk = WorksheetFunction.Max(Range(StRng, StRng.End(xlDown)))\n\nFor y = 1 To k\n    While StRng.Offset(x, 0) = y\n        x = x + 1\n    Wend\n    If y &lt; k Then\n        Range(StRng.Offset(x, 0), StRng.End(xlDown).Offset(o, j - 1)).Select\n        Selection.Cut\n        Set StRng = StRng.Offset(0, j)\n        ActiveSheet.Paste Destination:=StRng.Offset(0, 1)\n        Set StRng = StRng.Offset(0, 1)\n        x = 0\n    End If\nNext y\nEnd Sub\n</code></pre>\n\n<p>This works -- i.e. by not pasting the new cells directly to the <code>StRng</code> and instead to <code>StRng.offset(0,1)</code>, the <code>StRng</code> object remains defined.</p>\n\n<p>The Data in question are five columns across. The first column is an integer (with values going from 1 to 7), the next column is text followed by a column with dates and finally, two columns of general format data (2 decimal points).</p>\n\n<p>The fix is not difficult but I'm perplexed as to why the first code doesn't work. Does anyone have ideas?</p>\n"}, {"tags": ["excel", "import", "import-from-excel", "vba"], "comments": [{"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 1, "creation_date": 1453885873, "post_id": 35032814, "comment_id": 57791084, "body": "Welcome to SO, please keep in mind this is not a code service, please have a look <a href=\"https://stackoverflow.com/help/how-to-ask\">here</a>, <a href=\"https://stackoverflow.com/help/on-topic\">here</a> and <a href=\"https://stackoverflow.com/help/dont-ask\">here</a>."}, {"owner": {"reputation": 11, "user_id": 5845742, "user_type": "registered", "profile_image": "https://graph.facebook.com/1273744675985295/picture?type=large", "display_name": "Alexandru Cirdei", "link": "https://stackoverflow.com/users/5845742/alexandru-cirdei"}, "reply_to_user": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1453888715, "post_id": 35032814, "comment_id": 57793080, "body": "I have made the changes, would that suffice?"}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1453894653, "post_id": 35032814, "comment_id": 57796946, "body": "There is still no specific problem or error or a clear desired behavior. Where do you exactly want your data, do you want to add your data exactly for example. You&#39;ve simply copied the code from <a href=\"http://stackoverflow.com/a/16270208/5661165\">this answer</a> and tried the first comment. Do a little research!"}], "owner": {"reputation": 11, "user_id": 5845742, "user_type": "registered", "profile_image": "https://graph.facebook.com/1273744675985295/picture?type=large", "display_name": "Alexandru Cirdei", "link": "https://stackoverflow.com/users/5845742/alexandru-cirdei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 302, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1453894089, "creation_date": 1453885263, "last_edit_date": 1531161705, "question_id": 35032814, "link": "https://stackoverflow.com/questions/35032814/excel-import-data-from-an-online-xls-file", "title": "Excel - import data from an online xls file", "body": "<p>I am trying to get the data from an Excel that is found online to a sheet on my computer. I have tried the script from this post (<a href=\"https://stackoverflow.com/questions/16269422/excel-import-data-from-an-online-xls-file-daily?newreg=f3dcb95fa8c34df4a22df93c1a6e549c\">Excel - import data from an online xls file daily</a> ), but I would like to get the data in the same sheet, instead of creating a new sheet/having a new workbook open whenever I want to run the macro. </p>\n\n<p>I have tried replacing this line:</p>\n\n<pre><code>Set wsNew = wbMe.Sheets.Add(After:=wbMe.Sheets(w))\n</code></pre>\n\n<p>with: <code>Set wsNew = wbMe.Sheets(\"Sheet9\")</code></p>\n\n<p>This way, tried to have the sheet9 always updated, instead of opening a new worksheet everytime I run the macro.</p>\n\n<p>The full VBA code that I used was:</p>\n\n<pre><code>Sub OpenXLSfromURL()\nDim wbMe As Workbook\nDim wsNew As Worksheet\nDim w As Integer\nDim wbURL As Workbook\nDim url As String\n\nSet wbMe = ThisWorkbook\nurl = \"https://google.com/test.xls\"\nSet wbURL = Workbooks.Open(url)\n\n'## Add code to copy this data to your workbook and/or manipulate the data...'\nw = wbMe.Sheets.Count\n\n'## Add a new worksheet to the end of ThisWorkbook:'\nSet wsNew = wbMe.Sheets(Sheet9)\n\n'## Copy &amp; Paste this data in to our new worksheet:'\nwbURL.Sheets(1).Cells.Copy Destination:=wsNew.Range(\"A1\")\n\n'## Close the downloaded version which we no longer need:'\nwbURL.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "paste"], "comments": [{"owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "edited": false, "score": 0, "creation_date": 1453885104, "post_id": 35032622, "comment_id": 57790651, "body": "Could you show us what you&#39;ve tried already? So we can see if you&#39;ve gone wrong with any of them or so we know what not to try, cheers."}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "edited": false, "score": 0, "creation_date": 1453888797, "post_id": 35032727, "comment_id": 57793132, "body": "Actually the sheet user is copying from is in an unknown workbook and unknown sheet. The sheet to copy to is &quot;PasteTemplate&quot;. QuoteData is the sheet that is active when the user runs the macro. So i dont think this will work.."}, {"owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "reply_to_user": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "edited": false, "score": 0, "creation_date": 1453893331, "post_id": 35032727, "comment_id": 57796085, "body": "Oh I see, I&#39;m afraid this won&#39;t then, no. Thank you for bringing that to my attention."}], "tags": [], "owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "is_accepted": false, "score": 0, "last_activity_date": 1453884984, "creation_date": 1453884984, "answer_id": 35032727, "question_id": 35032622, "link": "https://stackoverflow.com/questions/35032622/excel-vba-paste-from-clipboard-to-another-sheet-only-values/35032727#35032727", "title": "Excel vba paste from clipboard to another sheet only values", "body": "<p>Have you tried..?</p>\n\n<pre><code>Range(\"A1\").Copy Destination:=Workbooks(\"QuoteDate\").Sheets(\"PasteTemplate\").Range(\"A1\")\n</code></pre>\n\n<p>This copies from the quote Date sheet and pastes in the Paste template sheet, swap those names if you want it the other way around.</p>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "edited": false, "score": 0, "creation_date": 1453889044, "post_id": 35033512, "comment_id": 57793300, "body": "I think i can go around the clear before pasting since this is just a to be sure the sheet is empty. I do clear after the macro is completed as well..At the moment my code described abode is working, the issue is that its pasting with formats and other &quot;not so fynny&quot; things. :) But maybe the clear is what has destroyd my other attempts.. In this case, what would you recommend for pasting values only? If i can take out the &quot;clear command&quot;?"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "edited": false, "score": 0, "creation_date": 1453896744, "post_id": 35033512, "comment_id": 57798448, "body": "<code>wsPT.Range(&quot;A1&quot;).PasteSpecial xlPasteValues</code> is supposed to work for this. Does it not?"}], "tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": false, "score": 2, "last_activity_date": 1453896812, "last_edit_date": 1453896812, "creation_date": 1453887174, "answer_id": 35033512, "question_id": 35032622, "link": "https://stackoverflow.com/questions/35032622/excel-vba-paste-from-clipboard-to-another-sheet-only-values/35033512#35033512", "title": "Excel vba paste from clipboard to another sheet only values", "body": "<p>The reason it fails is because the clipboard doesn't contain anything to be pasted, due to this line:</p>\n\n<pre><code>wsPT.Cells.Clear\n</code></pre>\n\n<p>When you clear the cells, you also clear the copy-command that was issued prior. Similarly, the copy-command will be cleared if you enter or modify information in another cell, or even if you just enter the cell itself.</p>\n\n<p>I don't have a perfect workaround for your specific workflow, but if you are willing to modify step 4 so that the macro can be run from any sheet (specifically, the user must run the command from the same sheet they are copying from, either from the menu or by you placing the macro on the toolbar), this code should work:</p>\n\n<pre><code>Dim wb As Workbook\nDim wsPT As Worksheet\nDim wsQD As Worksheet\nDim pRng As Range\n\nSet wb = ActiveWorkbook\nSet wsPT = wb.Sheets(\"PasteTemplate\")\nSet wsQD = wb.Sheets(\"QuoteData\")\nSet pRng = Selection                   &lt;~~ Store the range we want to copy\n\nwsPT.Cells.Clear                       &lt;~~ Clear the contents of the worksheet we are pasting to\npRng.Copy                              &lt;~~ Copy the range\nwsPT.Range(\"A1\").PasteSpecial xlPasteValues\n</code></pre>\n\n<p>Run the macro from the sheet where data is being copied from after the desired range has been <strong>selected</strong>.</p>\n"}], "owner": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7547, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1453896812, "creation_date": 1453884647, "question_id": 35032622, "link": "https://stackoverflow.com/questions/35032622/excel-vba-paste-from-clipboard-to-another-sheet-only-values", "title": "Excel vba paste from clipboard to another sheet only values", "body": "<p>I have a workbook i need to paste data to.\nWhat im trying to achieve:</p>\n\n<ol>\n<li>Workbook i want to paste data to is active</li>\n<li>Sheet in workbook i want to paste data to is not active</li>\n<li>User activates another workbook that is already open selecting the entire sheet and copies it to the clipboard.</li>\n<li>User goes back to the workbook data is going to be pasted to and runs a macro that pastes that data into another empty sheet with predefined sheet name.</li>\n<li>Paste must paste values only, no formatting, no comments, shapes, no merged cells. Only the values.</li>\n</ol>\n\n<p>And i have tried alot of combinations .Paste Destination[...] and so on.</p>\n\n<p>What im using today is:</p>\n\n<pre><code>Dim wb As Workbook\nDim wsPT As Worksheet\nDim wsQD As Worksheet\n\nSet wb = ActiveWorkbook\nSet wsPT = wb.Sheets(\"PasteTemplate\")\nSet wsQD = wb.Sheets(\"QuoteData\")\n\nwsPT.Cells.Clear\nwsPT.Range(\"A1\").PasteSpecial xlPasteValues\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1453884542, "post_id": 35032352, "comment_id": 57790357, "body": "What is &quot;the xmlDoc function&quot;? If you have some code to show, show it, including the table definition with regard to field types."}, {"owner": {"reputation": 122, "user_id": 5534881, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1KnxnCM_WMs/AAAAAAAAAAI/AAAAAAAAAFY/NzBIFdE9PiE/photo.jpg?sz=128", "display_name": "DukeOfHazard", "link": "https://stackoverflow.com/users/5534881/dukeofhazard"}, "edited": false, "score": 0, "creation_date": 1453891214, "post_id": 35032352, "comment_id": 57794724, "body": "VBA will get this as a string data type : 123,456.78   So, you can simply replace &quot;,&quot; by  &quot;.&quot; and vice versa. No need of use a magic function out of XMLDOC library."}, {"owner": {"reputation": 1, "user_id": 5785305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bcadf40001cbdbf2073a87dbab59a82?s=128&d=identicon&r=PG&f=1", "display_name": "Piedy", "link": "https://stackoverflow.com/users/5785305/piedy"}, "reply_to_user": {"reputation": 122, "user_id": 5534881, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1KnxnCM_WMs/AAAAAAAAAAI/AAAAAAAAAFY/NzBIFdE9PiE/photo.jpg?sz=128", "display_name": "DukeOfHazard", "link": "https://stackoverflow.com/users/5534881/dukeofhazard"}, "edited": false, "score": 0, "creation_date": 1453892157, "post_id": 35032352, "comment_id": 57795362, "body": "@Fnayou thats it! Thank you very much! :-)"}], "owner": {"reputation": 1, "user_id": 5785305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bcadf40001cbdbf2073a87dbab59a82?s=128&d=identicon&r=PG&f=1", "display_name": "Piedy", "link": "https://stackoverflow.com/users/5785305/piedy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453897127, "creation_date": 1453883901, "last_edit_date": 1453884430, "question_id": 35032352, "link": "https://stackoverflow.com/questions/35032352/access-vba-decimal-seperator-point-istead-of-comma-in-xml-download", "title": "Access VBA decimal seperator point istead of comma in XML Download", "body": "<p>We run a simple MS Access Database where we can import data either from a XLS or a XML File (Webservice).</p>\n\n<p>The problem is that numbers in the XLS file have the format: 123.456,78\nand in the XML file: 123,456.78.</p>\n\n<p>Since we are in Germany we need the the first format. Is there a simple method in VBA to change the format type when using the xmlDoc function?</p>\n"}, {"tags": ["vba", "excel", "bloomberg"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 5845394, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/dQYR6.jpg?s=128&g=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/5845394/ken"}, "edited": false, "score": 0, "creation_date": 1453886726, "post_id": 35032078, "comment_id": 57791680, "body": "That works, awesome, thanks. But what do those commands actually do/mean?"}, {"owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "reply_to_user": {"reputation": 89, "user_id": 5845394, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/dQYR6.jpg?s=128&g=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/5845394/ken"}, "edited": false, "score": 0, "creation_date": 1453886984, "post_id": 35032078, "comment_id": 57791844, "body": "Go to that cell and click on the little arrow near AutoSum on the HOME menu then More Functions. Click on the &quot;Help on this function&quot; link at the bottom of the window and it will open a help window with all the arguments that you can provide to BDH. Days=A means &quot;retrieve [A]ll days, including week-ends&quot; and Fill=P means &quot;if you don&#39;t have data on a given day, fill with [P]revious available data&quot;."}], "tags": [], "owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "is_accepted": true, "score": 2, "last_activity_date": 1453883031, "creation_date": 1453883031, "answer_id": 35032078, "question_id": 35031822, "link": "https://stackoverflow.com/questions/35031822/bloomberg-and-updating-formula-if-holidays-give-n-a/35032078#35032078", "title": "Bloomberg and updating formula if holidays give N/A", "body": "<p>You could probably use an override instead:</p>\n\n<pre><code>=BDH($B4&amp;\" index\",\"px_last\",$I$1,$I$1,\"Days=A,Fill=P\")\n</code></pre>\n\n<p>That will retrieve the last available price as of yesterday's close, which may be the day before yesterday's close (or an earlier date) if that specific instrument did not trade yesterday.</p>\n"}], "owner": {"reputation": 89, "user_id": 5845394, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/dQYR6.jpg?s=128&g=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/5845394/ken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14612, "favorite_count": 0, "accepted_answer_id": 35032078, "answer_count": 1, "score": 3, "last_activity_date": 1513984878, "creation_date": 1453882068, "last_edit_date": 1513984878, "question_id": 35031822, "link": "https://stackoverflow.com/questions/35031822/bloomberg-and-updating-formula-if-holidays-give-n-a", "title": "Bloomberg and updating formula if holidays give N/A", "body": "<p>We use the BDH function to get closing prices at the end of each trading day, and do this for a list of different types of securities and indices at once.</p>\n\n<p>Currently every BDH-of-index in the list refers to the same date at the top of the sheet, and if one index gives <code>N/A</code> because there is no trading on that day, we manually make it refer to a cell with another date.  </p>\n\n<pre><code>=BDH($B4&amp;\" index\",\"px_last\",$I$1,$I$1)  \n</code></pre>\n\n<p>Where <code>B4</code> refers to an index (\"SPX\" etc.) and <code>I1</code> = yesterday's date. </p>\n\n<p>I've just written a VBA routine that updates the dates at the top, but now I want it to also check if any of the indices gives an <code>N/A</code> and, if so, let that one refer to another cell date automatically. </p>\n\n<p>Can someone give me some advice on how to check the values in a row ranging c4:c20, and then change the cell that formula uses. Or should I alter the formula itself as well?</p>\n"}, {"tags": ["xml", "vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 104, "user_id": 2132992, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/70286dcb42281043dd345a7b064bcf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Tango_Mike", "link": "https://stackoverflow.com/users/2132992/tango-mike"}, "is_accepted": true, "score": 0, "last_activity_date": 1454495853, "last_edit_date": 1454495853, "creation_date": 1454494677, "answer_id": 35174197, "question_id": 35031732, "link": "https://stackoverflow.com/questions/35031732/excel-custom-function-to-retrieve-xml-data/35174197#35174197", "title": "Excel Custom Function to Retrieve XML Data", "body": "<p>Thanks to the AnalystCave.com website run by @Dick Kusleika, I have been able to adapt the information presented there on the topic of \"Working with XML files\" to my problem and have successfully resolved it. Just in case someone has the same problem, here is my code (I just hope it is programmatically efficient):</p>\n\n<pre><code>Public Function GetCurrToUZS(ByRef Curr As String, ByRef date_param As Date) As Currency\n    Dim XDoc As Object\n    Dim lists\n    Dim getThirdChild\n    Dim corrDate As String\n\n    If Len(Curr) &lt;&gt; 3 Then\n        MsgBox \"Currency name must be 3 letters long!\", vbCritical + vbOKOnly _\n            , \"VARIABLE ERROR!\"\n        Exit Function\n    End If\n    'corrects the entered date to the required format of \"YYYY-MM-DD\"\n    corrDate = Year(date_param) &amp; \"-\" &amp; Month(date_param) &amp; \"-\" &amp; Day(date_param)\n\n    Set XDoc = CreateObject(\"MSXML2.DOMDocument\")\n    XDoc.async = False: XDoc.validateOnParse = False\n    XDoc.Load \"http://www.cbu.uz/section/rates/widget/xml/\" &amp; Curr &amp; \"/\" &amp; corrDate\n\n    'Get Document Elements\n    Set lists = XDoc.DocumentElement\n    Set getThirdChild = lists.ChildNodes(2)\n\n    GetCurrToUZS = getThirdChild.Text 'output of the function\n\n    Set XDoc = Nothing 'terminates xDoc Object\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 104, "user_id": 2132992, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/70286dcb42281043dd345a7b064bcf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Tango_Mike", "link": "https://stackoverflow.com/users/2132992/tango-mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 35174197, "answer_count": 1, "score": 0, "last_activity_date": 1459771250, "creation_date": 1453881737, "last_edit_date": 1495540787, "question_id": 35031732, "link": "https://stackoverflow.com/questions/35031732/excel-custom-function-to-retrieve-xml-data", "title": "Excel Custom Function to Retrieve XML Data", "body": "<p>I would like to create a custom function that would retrieve specific data available in the form of XML URL link. This is the first time I am dealing with XML in Excel, let alone VBA, and am struggling with it. </p>\n\n<p>I have been able to write a procedure (local currency exchange rate retrieval) which one can run by simply pressing a custom button, which runs the code below:</p>\n\n<pre><code>Sub FX_Retrieve()\n    Dim FX As String\n    Dim CustomDate As String\n\n    FX = Range(\"FX\")\n    CustomDate = Range(\"CustomDate\")\n\n    Application.ScreenUpdating = False\n\n    ActiveSheet.Unprotect \n    Rows(2).Clear\n    ActiveWorkbook.XmlImport URL:= _\n        \"http://www.cbu.uz/section/rates/widget/xml/\" &amp; FX &amp; \"/\" &amp; CustomDate, ImportMap:= _\n        Nothing, Overwrite:=True, Destination:=Range(\"C2\")\n    Range(\"D:D\").EntireColumn.AutoFit\n    Rows(2).HorizontalAlignment = xlCenter\n    Columns(6).ClearContents\n    ActiveSheet.Protect \n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Just in case, the XML output looks like this:\n    \n    2015-12-29\n    USD\n    2809.98\n    1\n    \nHence, the need for some formatting in my code.</p>\n\n<p>No problem with that procedure in the case of a single call for the FX rate! \nNow, I want to go a bit further than that and create a function. And this is where I come up with several problems:</p>\n\n<ol>\n<li>I need to extract specific child node (rate) from the xml output, which looks as this:</li>\n</ol>\n\n<p>'</p>\n\n<pre><code>&lt;response&gt;\n&lt;date_act&gt;2015-12-29&lt;/date_act&gt;\n&lt;symbol&gt;USD&lt;/symbol&gt;\n&lt;rate&gt;2809.98&lt;/rate&gt;\n&lt;size&gt;1&lt;/size&gt;\n&lt;/response&gt;\n</code></pre>\n\n<p>I have found something similar already (as in here: <a href=\"https://stackoverflow.com/questions/21047044/excel-vba-getting-specific-node-from-xml\">Excel VBA getting specific node from XML</a>), yet I am not able to apply it in my case.</p>\n\n<ol start=\"2\">\n<li>the creation of function as far as I can see it will not allow the same approach as I had in my procedure.</li>\n</ol>\n\n<p>Any help would be much appreciated!</p>\n"}, {"tags": ["excel", "vba", "3d"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5845178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b61222a9437661e94a2438f3bece838?s=128&d=identicon&r=PG&f=1", "display_name": "zack", "link": "https://stackoverflow.com/users/5845178/zack"}, "edited": false, "score": 0, "creation_date": 1453907253, "post_id": 35030972, "comment_id": 57806177, "body": "Thanks for the response.   I need to fit a surface to my data, i need a program or a way to fit a mathematical equation like  &quot;z = x^2+y^3&quot; to my data. Like you would do a curve fit in a 2d space."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 1, "user_id": 5845178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b61222a9437661e94a2438f3bece838?s=128&d=identicon&r=PG&f=1", "display_name": "zack", "link": "https://stackoverflow.com/users/5845178/zack"}, "edited": false, "score": 0, "creation_date": 1453936477, "post_id": 35030972, "comment_id": 57824276, "body": "You don&#39;t like to follow instructions, apparently. Your choice."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1453878998, "creation_date": 1453878998, "answer_id": 35030972, "question_id": 35030390, "link": "https://stackoverflow.com/questions/35030390/how-to-fit-a-3d-surface-to-data-in-excel/35030972#35030972", "title": "How to fit a 3d surface to data in excel?", "body": "<p>You can plot this data as a 3D-surface chart and it will look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LZnWm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LZnWm.png\" alt=\"enter image description here\"></a></p>\n\n<p>The rest of your question requires a LOT more detail about what you want to achieve. Don't just throw a concept into the ring. Edit your question and explain what you want to achieve, what you have tried, where you are stuck.</p>\n\n<p>This answer will probably be downvoted because it is not an answer to your questions, but the requests for clarification was not suitable for a comment. </p>\n\n<p>Over to you. Add a comment to your question when you've added the required detail.</p>\n"}], "owner": {"reputation": 1, "user_id": 5845178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b61222a9437661e94a2438f3bece838?s=128&d=identicon&r=PG&f=1", "display_name": "zack", "link": "https://stackoverflow.com/users/5845178/zack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 857, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1453878998, "creation_date": 1453876773, "question_id": 35030390, "link": "https://stackoverflow.com/questions/35030390/how-to-fit-a-3d-surface-to-data-in-excel", "title": "How to fit a 3d surface to data in excel?", "body": "<p>I have a 10x16 table with 3d surface data in excel. I would like to fit this data to a surface where I can use this surface to calculate new points. </p>\n\n<p>I made some VBA code that 2d interpolates but the above would suit me better and I cannot seem to make it happen.</p>\n\n<p>Is there anyway to make this happen in excel? or can someone show me a software capable of doing this?</p>\n\n<p>Pretty much posting this as a last result</p>\n\n<hr>\n\n<p>This snippet doesn't run but is a representation of the data</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>'       172.74\t322.77\t472.80\t770.51\t1068.23\t1365.94\t1803.76\t2241.58\t2679.40\t3126.00\t\r\n10.67\t1.6\t    1.776\t1.96\t2.24\t4.132\t5.12\t5.756\t7    \t8.2\t    9.4\r\n15.33\t1.6\t    1.772\t1.96\t2.272\t4.012\t5.156\t5.52\t7    \t8.2    \t9.4\r\n18.67\t1.6\t    1.836\t2.044\t2.58\t4.024\t5.036\t5.4\t    7    \t8.2\t    9.4\r\n27.67\t1.6\t    1.848\t2.088\t2.64\t3.796\t4.708\t5.948\t7    \t8.2\t    9.4\r\n32.00\t1.6\t    1.824\t2.088\t2.62\t3.8\t    4.512\t5.832\t7    \t8.2\t    9.4\r\n37.00\t1.6\t    1.836\t2.152\t2.54\t3.996\t4.556\t5.02\t7    \t8.2\t    9.4\r\n46.67\t1.6\t    1.832\t2.14\t2.648\t3.884\t4.62\t4.796\t7\t    8.2\t    9.4\r\n51.67\t1.6\t    1.892\t2.1\t    2.692\t3.54\t4.876\t5.312\t6.836\t8.2\t    9.4\r\n60.00\t1.6    \t1.872\t2.076\t2.748\t3.688\t4.66\t5.768\t6.932\t8.404\t9.6\r\n68.33\t1.6\t    1.864\t2.064\t2.712\t3.62\t4.744\t5.552\t7.016\t8.384\t9.69\r\n76.67\t1.6    \t1.888\t2.152\t2.736\t3.536\t4.716\t5.656\t6.568\t8.336\t9.7\r\n83.33\t1.6    \t1.864\t2.16\t2.7    \t3.716\t4.708\t5.4\t    6.508\t8.352\t9.90\r\n91.67\t1.6    \t1.896\t2.216\t2.756\t3.584\t4.42\t5.52\t6.472\t8.488\t9.97\r\n100.00\t1.6\t    1.744\t2.036\t2.808\t3.708\t4.356\t5.672\t6.728\t8.42\t10.\r\n108.33\t1.6\t    1.644\t1.932\t2.74\t3.464\t4.348\t5.312\t7.26\t8.212\t10.07\r\n116.67\t1.6    \t1.684\t2.376\t2.688\t3.664\t4.564\t5.42\t7.072\t8.892\t10.33</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["mysql", "ms-access", "vba", "odbc"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1453993361, "post_id": 35030316, "comment_id": 57852781, "body": "As far as I know, linked tables by default do not persist connections as they are locally stored/cached in app&#39;s tabledefs or in-memory recordsets.Connections are needed to first link/open tables then during query processing or transactions. Like if PHP website runs a MySQL query, only in the seconds to call select statement is connection/cursor made. From there PHP keeps results in memory. Are you running a constant loop? Where do you receive timeout message?"}, {"owner": {"reputation": 5, "user_id": 5256887, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205022168900315/picture?type=large", "display_name": "Ahmed Taha", "link": "https://stackoverflow.com/users/5256887/ahmed-taha"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1454156165, "post_id": 35030316, "comment_id": 57924249, "body": "ty for your reply .. i store the data on remote mysql server but the data entry and the queries are local .. about the loop connection that&#39;s my idea coz if you were idle in the data entry section or queries for a min the &quot;odbc call failed&quot; will show up and have to restart ms access to connect again .. i though maybe creating a loop of connection every 50 sec .. so i would make sure it wont disconnect after 60 sec"}], "owner": {"reputation": 5, "user_id": 5256887, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205022168900315/picture?type=large", "display_name": "Ahmed Taha", "link": "https://stackoverflow.com/users/5256887/ahmed-taha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 483, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459413927, "creation_date": 1453876483, "last_edit_date": 1459413927, "question_id": 35030316, "link": "https://stackoverflow.com/questions/35030316/relinking-odbc-tables-using-vba", "title": "Relinking ODBC Tables using VBA", "body": "<p>I'm having connection errors from connecting ms access to <code>Mysql</code> via <code>ODBC</code> \nit timeout after a min from been \"idle\". iIasked my server provider and he said he can't modify any changes coz it's shared mysql server, So i tried to use codes that auto relink <code>ODBC</code>, When it's about to timeout like this one : </p>\n\n<pre><code>'Delete the link tables to avoid the timeout issue\nFunction RemoveLinkTables()\nDim TableList, TableName\nOn Error Resume Next\nTableList = Array(\"table1\", \"table2\")\nFor Each TableName In TableList\n    CurrentDb.TableDefs.Delete TableName\nNext\n\nEnd Function\n\nFunction CreateLinkTables2()\n\n   Dim Mytdf As TableDef, MyLocal As String, MySource As String, MyConnectStr As String\n\n\n    'Define the ODBC connect strings\n    MyConnectStr = \"ODBC;DSN=CON;DESC=MySQL ODBC 3.51 Driver DSN;DATABASE=DATABASE;SERVER=********;UID=Admin;PASSWORD=*****;PORT=3306;OPTION=131075;STMT=;TIMEOUT=6000;\"\n\n    'Create the ODBC table\n    'Repeat this for each table\n    MySource = \"T1\"\n    MyLocal = \"Table1\"\n    GoSub MakeItNow\n\n    MySource = \"T2\"\n    MyLocal = \"Table2\"\n    GoSub MakeItNow\n\nExit Function\n\nMakeItNow:\n    Set Mytdf = CurrentDb.CreateTableDef(MyLocal)\n    Mytdf.Connect = MyConnectStr\n    Mytdf.SourceTableName = MySource\n    CurrentDb.TableDefs.Append Mytdf\n\n    Return\n\n\n\nEnd Function\n</code></pre>\n\n<p>the connection is a bit faster but still timeout after a min from been idle ... is this code doing its jop ? or i missed something :/ ... i found too many other codes to fix the errors (which has something like \"If connect>0 then ..\" but idk how to modify them coz i have 2 tables need to work on .. </p>\n\n<p>what i really need is to reconnect to the tables every 30 sec so i wont get disconnected \"the error which appear is Mysql server has gone away\" after 60 sec idle</p>\n\n<p>i want something to reconnect and refresh tables links every min so i wont lose connection to mysql</p>\n"}, {"tags": ["vba", "excel", "csv"], "answers": [{"comments": [{"owner": {"reputation": 7556, "user_id": 2761425, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e4c6951078654e01f8e31294982ccc3b?s=128&d=identicon&r=PG&f=1", "display_name": "bryan", "link": "https://stackoverflow.com/users/2761425/bryan"}, "edited": false, "score": 0, "creation_date": 1511306970, "post_id": 35033566, "comment_id": 81803770, "body": "I get <code>Run-time error &#39;429&#39;: ActiveX component can&#39;t create object</code>"}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "reply_to_user": {"reputation": 7556, "user_id": 2761425, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e4c6951078654e01f8e31294982ccc3b?s=128&d=identicon&r=PG&f=1", "display_name": "bryan", "link": "https://stackoverflow.com/users/2761425/bryan"}, "edited": false, "score": 0, "creation_date": 1511356499, "post_id": 35033566, "comment_id": 81825442, "body": "@bryan can you open a new Quetsion and Poste your Code?"}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "reply_to_user": {"reputation": 7556, "user_id": 2761425, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e4c6951078654e01f8e31294982ccc3b?s=128&d=identicon&r=PG&f=1", "display_name": "bryan", "link": "https://stackoverflow.com/users/2761425/bryan"}, "edited": false, "score": 0, "creation_date": 1511512200, "post_id": 35033566, "comment_id": 81892609, "body": "@bryan Where do you get the Error? And Please Open a new Question"}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "reply_to_user": {"reputation": 7556, "user_id": 2761425, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e4c6951078654e01f8e31294982ccc3b?s=128&d=identicon&r=PG&f=1", "display_name": "bryan", "link": "https://stackoverflow.com/users/2761425/bryan"}, "edited": false, "score": 0, "creation_date": 1511512644, "post_id": 35033566, "comment_id": 81892857, "body": "@bryan replace &#39;CreateObject(&quot;WScript.Shell&quot;).specialfolders(&quot;Desktop&quot;) &amp; &quot;\\&quot;&#39; with the path you want to have the CSV"}], "tags": [], "owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "is_accepted": false, "score": 0, "last_activity_date": 1453887348, "creation_date": 1453887348, "answer_id": 35033566, "question_id": 35029680, "link": "https://stackoverflow.com/questions/35029680/export-csv-to-desktop-on-os-x-with-excel-macro/35033566#35033566", "title": "Export CSV to ~/Desktop on OS X with Excel Macro", "body": "<p>The Problem is, that i don't have any OS X to test it. But i think one Problem can be if there are to many Sheets in your Workbook.</p>\n\n<pre><code>Sub CSV()\nDim ws As Excel.Worksheet\n\nDim strDirectory As String\nDim strCurWB As String\nDim longCurFor As Long\n\nstrCurWB = ThisWorkbook.FullName\nlongCurFor = ThisWorkbook.FileFormat\n' Store current details for the workbook\n\n'get Path for User Desktp\nstrDirectory = CreateObject(\"WScript.Shell\").specialfolders(\"Desktop\") &amp; \"\\\"\n'Loop though each Sheet in the Workbook\nFor Each ws In ThisWorkbook.Worksheets\n    Sheets(ws.Name).Copy\n    ActiveWorkbook.SaveAs Filename:=strDirectory &amp; ThisWorkbook.Name &amp; \"-\" &amp; ws.Name &amp; \".csv\", FileFormat:=xlCSV\n    ActiveWorkbook.Close savechanges:=False\n    ThisWorkbook.Activate\nNext\n\nApplication.DisplayAlerts = False\nThisWorkbook.SaveAs Filename:=strCurWB, FileFormat:=longCurFor\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>I hope This Code Example can Help you and you can take some over to the OSX.</p>\n"}], "owner": {"reputation": 1, "user_id": 5845005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3923a6382f96e792a2400ee7d4f14c73?s=128&d=identicon&r=PG&f=1", "display_name": "clem", "link": "https://stackoverflow.com/users/5845005/clem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 632, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453946914, "creation_date": 1453873355, "last_edit_date": 1453946914, "question_id": 35029680, "link": "https://stackoverflow.com/questions/35029680/export-csv-to-desktop-on-os-x-with-excel-macro", "title": "Export CSV to ~/Desktop on OS X with Excel Macro", "body": "<p>I'm trying to export a CSV using a macro in Excel on OS X (2015). The code below worked previously...but now it's failing. Unfortunately all the info I'm finding it unique to Windows. </p>\n\n<p>I could define the exact file path but need this to work on any OS X machine so defining the users home directory is important. </p>\n\n<pre><code>Sub export_csv()\n    ' export csv to ~/Desktop\n    user_dir = user_dir + MacScript(\"(do shell script \"\"cd ~; pwd \"\")\")\n    file_name = user_dir &amp; \"/Desktop/excel_export.csv\"\n\n    ActiveWorkbook.SaveAs Filename:=file_name, FileFormat:=xlCSV, CreateBackup:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1453872705, "post_id": 35029444, "comment_id": 57785059, "body": "plus one - it&#39;s been a long time since I&#39;ve seen <code>appTGGL</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1453873148, "post_id": 35029444, "comment_id": 57785223, "body": "How is <i>&#39;Keywords like Stainless wire - dispenser&#39;</i> intended to be derived?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1453873481, "post_id": 35029444, "comment_id": 57785343, "body": "Not that long @Jeeped, it&#39;s your code, <a href=\"http://stackoverflow.com/questions/34845719/categorize-each-string-under-group-1-time-based-on-string-content-excel\" title=\"categorize each string under group 1 time based on string content excel\">stackoverflow.com/questions/34845719/&hellip;</a>"}, {"owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "edited": false, "score": 0, "creation_date": 1453873841, "post_id": 35029444, "comment_id": 57785498, "body": "@Jeeped thanks Jeeped, I&#39;ve been trying to macguyver your code for a few other processes, it&#39;s been working well. <i>&#39;Keywords like stainless wire - dispenser&#39;</i> will be derived using a separate script I will implement, originally that cell would just say <i>&#39;dispenser&#39;</i>. Cell A1 (<i>Keywords like Stainless wire - dispenser</i>) will be the header of column <i>&#39;Keywords like Stainless wire - dispenser&#39;</i> in the excel worksheet, and the contents of cell B1 will be all of the keywords that are listed below that particular header cell."}, {"owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "edited": false, "score": 0, "creation_date": 1454024909, "post_id": 35029444, "comment_id": 57871712, "body": "@Jeeped - The code <i>almost</i> works, but only for two of the sheets, instead of all 30... have any input on what is wrong in the code?"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 5857337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66590c214b83ad737f58e7b23b63d28d?s=128&d=identicon&r=PG&f=1", "display_name": "Ted", "link": "https://stackoverflow.com/users/5857337/ted"}, "is_accepted": false, "score": 1, "last_activity_date": 1454121397, "creation_date": 1454121397, "answer_id": 35097344, "question_id": 35029444, "link": "https://stackoverflow.com/questions/35029444/excel-how-to-extract-each-column-and-save-it-as-its-own-csv-file/35097344#35097344", "title": "(Excel) How to extract each column (and save it) as its own CSV file?", "body": "<p>Fisrt glance, change below code</p>\n\n<pre><code>If sht.Name &lt;&gt; \"AA\" And sht.Name &lt;&gt; \"Word Frequency\" Then\n</code></pre>\n\n<p>to</p>\n\n<pre><code>If sht.Name &lt;&gt; \"AA\" OR sht.Name &lt;&gt; \"Word Frequency\" Then\n</code></pre>\n\n<p>Come back and we can look further. HTH.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "is_accepted": true, "score": 0, "last_activity_date": 1454375819, "creation_date": 1454375819, "answer_id": 35143421, "question_id": 35029444, "link": "https://stackoverflow.com/questions/35029444/excel-how-to-extract-each-column-and-save-it-as-its-own-csv-file/35143421#35143421", "title": "(Excel) How to extract each column (and save it) as its own CSV file?", "body": "<p><strong>With help from @Elbert Villarreal I was able to get the code to work.</strong></p>\n\n<p>The last (almost working) code I had in the example was (almost) right, Elbert pointed out that:<br><br></p>\n\n<p><strong>Within <code>Create_CSVs_AllSheets()</code> subroutine:</strong>\n<br>I needed to pass <code>sht.Index</code> to the <code>Create_CSVs_v3()</code>subroutine to get <code>Create_CSVs_v3()</code> to run across all sheets.<br>\nPassing the <code>counter</code> variable was incorrect since it's a <code>Public</code> (global) variable. If it's changed within any subroutine, the new value will stick for wherever else the variable is called.\n<br><br>\n<strong>Within <code>Create_CSVs_v3()</code> subroutine: <br></strong>\nNeeded to <code>Set ws = Sheets(shtIndex)</code> in order to set it to the exact sheet, not just the one which is active.\n<br><br></p>\n\n<p><strong>Working Code:</strong></p>\n\n<pre><code>Option Explicit\n\nPublic counter As Integer\n\nSub Create_CSVs_AllSheets()\n\n    Dim sht As Worksheet        '[????????????????]just a tmp var[????????????????]\n\n    counter = 1                 'this counter will provide the unique number for our 1.csv, 2.csv.... 999.csv, etc                         \n\n    appTGGL bTGGL:=False\n\n    For Each sht In Worksheets  ' for each sheet inside the worksheets of the workbook\n\n        If sht.Name &lt;&gt; \"AA\" And sht.Name &lt;&gt; \"Word Frequency\" Then\n\n\n        'IF sht.name is different to AA AND sht.name is diffent to WordFrecuency THEN\n\n        'TIP:\n\n        'If Not sht.Name = noSht01 And Not sht.Name = noSht02 Then 'This equal\n\n        'IF (NOT =&gt; negate the sentence) sht.name is NOT equal to noSht01 AND\n\n        '                                sht.name is NOT equal to noSht02 THEN\n\n        sht.Activate 'go to that Sheet!\n\n        Create_CSVs_v3 sht.Index 'run the code, and pass the counter variable (NOT for naming the .csv's)\n\n                                 'Run the code, and pass the sheet.INDEX of the current sheet to select that sheet\n\n                                 'you will affect the counter inside Create_CSVs_v3\n\n        End If '\n\n    Next sht 'next one please!\n\n    appTGGL\n\nEnd Sub\n\n\n\nSub Create_CSVs_v3(shtIndex As Integer)\n\n    Dim ws As Worksheet\n\n    Dim i As Integer\n\n    Dim j As Integer\n\n    Dim k As Integer\n\n    Dim sHead As String\n\n    Dim sText As String\n\n\n\n    Dim maxCol As Long\n\n    Dim maxRow As Long\n\n    Set ws = Sheets(shtIndex)    'Set the exact sheet, not just which one is active.\n\n                                 'and then you will go over all the sheets\n\n    'NOT NOT Set ws = ActiveSheet    'the sheet with the data, _\n\n                            'and we take the name of that sheet to do the job\n\n\n\n    maxCol = ws.Cells(1, Columns.Count).End(xlToLeft).Column\n\n    For j = 5 To maxCol\n\n        If ws.Cells(1, j) &lt;&gt; \"\" And ws.Cells(2, j) &lt;&gt; \"\" Then 'this IF is innecesary if you use\n\n                                                               'ws.Cells(1, Columns.Count).End(xlToLeft).Column\n\n                                                               'you'r using a double check over something that you check it\n\n            sHead = ws.Cells(1, j)\n\n            sText = ws.Cells(2, j)\n\n\n\n            If ws.Cells(rows.Count, j).End(xlUp).Row &gt; 2 Then\n\n                maxRow = ws.Cells(rows.Count, j).End(xlUp).Row 'Use vars, instead put the whole expression inside the\n\n                                                               'for loop\n\n\n\n                For i = 3 To maxRow   'i=3 because above we defined that_\n\n                                      'sText = ws.Cells(2, j) above_\n\n                                      'Note the \"2\" above and the sText below\n\n                     sText = sText &amp; Chr(10) &amp; ws.Cells(i, j)\n\n                Next i\n\n            End If\n\n            Workbooks.Add\n\n            ActiveSheet.Range(\"A1\") = sHead\n\n            'ActiveSheet.Range(\"B1\") = Chr(34) &amp; sText &amp; Chr(34)\n\n            ActiveSheet.Range(\"B1\") = Chr(10) &amp; sText 'Modified above line to start with \"Return\" character (Chr(10))\n\n                                                      'instead of enclosing with quotation marks (Chr(34))\n\n\n\n            ActiveWorkbook.SaveAs Filename:=ThisWorkbook.Path &amp; \"\\\" &amp; counter &amp; \".csv\", _\n            FileFormat:=xlCSV, CreateBackup:=False 'counter variable will provide unique number to each .csv\n\n\n\n            ActiveWorkbook.Close SaveChanges:=True\n\n                                                  'Application.Wait (Now + TimeValue(\"0:00:01\"))\n\n            counter = counter + 1                 'increment counter by 1, to make sure every .csv has a unique number\n\n        End If\n\n    Next j\n\n    Set ws = Nothing\n\nEnd Sub\n\n\n\nPublic Sub appTGGL(Optional bTGGL As Boolean = True)\n\n    Debug.Print Timer\n\n    Application.ScreenUpdating = bTGGL\n\n    Application.EnableEvents = bTGGL\n\n    Application.DisplayAlerts = bTGGL\n\n    Application.Calculation = IIf(bTGGL, xlCalculationAutomatic, xlCalculationManual)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1614, "favorite_count": 1, "accepted_answer_id": 35143421, "answer_count": 2, "score": 3, "last_activity_date": 1454375819, "creation_date": 1453872066, "last_edit_date": 1454023450, "question_id": 35029444, "link": "https://stackoverflow.com/questions/35029444/excel-how-to-extract-each-column-and-save-it-as-its-own-csv-file", "title": "(Excel) How to extract each column (and save it) as its own CSV file?", "body": "<p><strong>Is it possible to save each column in a worksheet as its own CSV file? That's the main thing I'm trying to accomplish, though there are more details.</strong></p>\n\n<p><strong>EDIT:</strong> Code <strong>almost</strong> works, except for some reason it seems to be only looping for two of the ~30 worksheets. It outputs anywhere from 125-135 csv files (not sure why it varies?), however it should be outputting closer to ~1000 csv files.</p>\n\n<p><strong>Any idea on why the code isn't looping across all sheets?</strong> (Code at bottom + updated workbook)</p>\n\n<hr>\n\n<p><br>\nAll of the other solutions I found involve python or other scripting languages, I couldn't find anything specific for automating extracting a column from an excel worksheet and saving it as a separate CSV.</p>\n\n<p><strong>Goal:</strong> \n<br>\n(Across all worksheets, except \"AA\" and \"Word Frequency\")<br>\nTo save each column (starting at column E) as its own CSV file </p>\n\n<p><strong>Purpose:</strong>\n<br> To create individual data CSV files for further processing by another program. (This program needs the data organized this way)</p>\n\n<p><strong>Conditions / Constraints:</strong>\n<br><br>\n1. Number of columns will vary for each worksheet. First column will always be column E <br> <br>\n2. Number each individual CSV (1.csv, 2.csv, 3.csv\u2026. 9999.csv), and save in the working folder of the excel file. Iterate the number (+1) so no other CSV\u2019s are overwritten\n<br><br>\n3. Format new CSV file such that the first row (header) is left as is, and the rest of the cells (below the header) are enclosed with quotation marks, and pasted into the first cell in the 2nd column</p>\n\n<p><strong>Resources:</strong>\n<br><a href=\"https://drive.google.com/file/d/0ByUcHTNcynugampfd2N0VUFvQ1E/view?usp=sharing\" rel=\"nofollow noreferrer\">Link to worksheet</a><br>\n<a href=\"https://drive.google.com/file/d/0ByUcHTNcynugVGU0Njg5LVpOVkk/view?usp=sharing\" rel=\"nofollow noreferrer\">Link to updated workbook</a> <br>\n<a href=\"https://drive.google.com/file/d/0ByUcHTNcynugTVJGMUcwNEFISGs/view?usp=sharing\" rel=\"nofollow noreferrer\">Link to 3.csv</a> (Sample output CSV)</p>\n\n<hr>\n\n<p><strong>Visual Examples:</strong>\n<br><br>\n<a href=\"https://i.stack.imgur.com/HKCwR.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HKCwR.jpg\" alt=\"View of worksheet data\"></a>\n<strong>View of how Worksheet Data is organized</strong>\n<br><br><br>\n<a href=\"https://i.stack.imgur.com/RYo0G.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RYo0G.jpg\" alt=\"How I&#39;m trying to save CSV data files\"></a>\n<strong>How I'm trying to have the CSV files saved (numerical iteration, so it will be easy for other program to load all CSV files with loop)</strong>\n<br><br><br>\n<a href=\"https://i.stack.imgur.com/hdtZu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hdtZu.jpg\" alt=\"3.csv example\"></a>\n<strong>Example of how each CSV file contents will look like - (Cell A1 is the \"Header\" value, and Cell B1 is all of the keywords (that existed below the header in the master excel sheet) bunched into one cell, contained by quotation marks \"\")</strong></p>\n\n<h2><br><br></h2>\n\n<p><strong>Code that is almost working, however only loops for 2 worksheets instead of all worksheets besides \"AA\" and \"Word Frequency\":</strong>\n<br><a href=\"https://drive.google.com/file/d/0ByUcHTNcynugVGU0Njg5LVpOVkk/view?usp=sharing\" rel=\"nofollow noreferrer\">Newest workbook I'm working with</a>\n<br></p>\n\n<pre><code>Option Explicit\n\nPublic counter As Integer\n\n\nSub Create_CSVs_AllSheets()\n\n    Dim sht 'just a tmp var\n\n    counter = 1                 'this counter will provide the unique number for our 1.csv, 2.csv.... 999.csv, etc\n    appTGGL bTGGL:=False\n    For Each sht In Worksheets  ' for each sheet inside the worksheets of the workbook\n        If sht.Name &lt;&gt; \"AA\" And sht.Name &lt;&gt; \"Word Frequency\" Then\n        'IF sht.name is different to AA AND sht.name is diffent to WordFrecuency THEN\n\n        'TIP:\n        'If Not sht.Name = noSht01 And Not sht.Name = noSht02 Then 'This equal\n        'IF (NOT =&gt; negate the sentence) sht.name is NOT equal to noSht01 AND\n        '                                sht.name is NOT equal to noSht02 THEN\n\n            sht.Activate 'go to that Sheet!\n            Create_CSVs_v3 (counter) 'run the code, and pass the counter variable (for naming the .csv's)\n\n\n        End If '\n    Next sht 'next one please!\n    appTGGL\nEnd Sub\n\nSub Create_CSVs_v3(counter As Integer)\nDim ws As Worksheet, i As Integer, j As Integer, k As Integer, sHead As String, sText As String\nSet ws = ActiveSheet    'the sheet with the data, _\n                        'and we take the name of that sheet to do the job\n\nFor j = 5 To ws.Cells(1, Columns.Count).End(xlToLeft).Column\n     If ws.Cells(1, j) &lt;&gt; \"\" And ws.Cells(2, j) &lt;&gt; \"\" Then\n          sHead = ws.Cells(1, j)\n          sText = ws.Cells(2, j)\n          If ws.Cells(rows.Count, j).End(xlUp).Row &gt; 2 Then\n               For i = 3 To ws.Cells(rows.Count, j).End(xlUp).Row   'i=3 because above we defined that_\n                                                                    'sText = ws.Cells(2, j) above_\n                                                                    'Note the \"2\" above and the sText below\n                    sText = sText &amp; Chr(10) &amp; ws.Cells(i, j)\n                    Next i\n               End If\n          Workbooks.Add\n          ActiveSheet.Range(\"A1\") = sHead\n          'ActiveSheet.Range(\"B1\") = Chr(34) &amp; sText &amp; Chr(34)\n          ActiveSheet.Range(\"B1\") = Chr(10) &amp; sText 'Modified above line to start with \"Return\" character (Chr(10))\n          'instead of enclosing with quotation marks (Chr(34))\n\n          ActiveWorkbook.SaveAs Filename:=ThisWorkbook.Path &amp; \"\\\" &amp; counter &amp; \".csv\", _\n          FileFormat:=xlCSV, CreateBackup:=False 'counter variable will provide unique number to each .csv\n\n          ActiveWorkbook.Close SaveChanges:=True\n          'Application.Wait (Now + TimeValue(\"0:00:01\"))\n          counter = counter + 1                 'increment counter by 1, to make sure every .csv has a unique number\n          End If\n     Next j\n\nSet ws = Nothing\nEnd Sub\n\nPublic Sub appTGGL(Optional bTGGL As Boolean = True)\n    Debug.Print Timer\n    Application.ScreenUpdating = bTGGL\n    Application.EnableEvents = bTGGL\n    Application.DisplayAlerts = bTGGL\n    Application.Calculation = IIf(bTGGL, xlCalculationAutomatic, xlCalculationManual)\nEnd Sub\n</code></pre>\n\n<p><br>Any idea on what is wrong with the latest code? <br>Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1453869017, "post_id": 35028890, "comment_id": 57784000, "body": "Have you considered repairing the data so that apples are apples and not oranges?"}, {"owner": {"reputation": 2275, "user_id": 2040286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38346fd1ac7ec2130b6644fa44acb88c?s=128&d=identicon&r=PG", "display_name": "Paresh J", "link": "https://stackoverflow.com/users/2040286/paresh-j"}, "edited": false, "score": 0, "creation_date": 1453869861, "post_id": 35028890, "comment_id": 57784224, "body": "Instead of Searchrange.Find use WHILE loop and compare cell by cell and before compare cast the same to date format and then compare. I think your problem will be resolved by this..."}, {"owner": {"reputation": 1, "user_id": 5844764, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153739800640289/picture?type=large", "display_name": "Tobias Cortese", "link": "https://stackoverflow.com/users/5844764/tobias-cortese"}, "edited": false, "score": 0, "creation_date": 1453912749, "post_id": 35028890, "comment_id": 57810274, "body": "@Jeeped - We&#39;ve experimented with that approach but have not been able to figure out how to consistently enforce the desired formatting using PowerQuery. In production, the result is that no matter how we define the date in PowerQuery, the Excel Table produced fails to reflect those formats and VBA reads the data as a date serial number, which means that it is unable to match it to the same date formatted as yyyy-mm-dd."}, {"owner": {"reputation": 1, "user_id": 5844764, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153739800640289/picture?type=large", "display_name": "Tobias Cortese", "link": "https://stackoverflow.com/users/5844764/tobias-cortese"}, "reply_to_user": {"reputation": 2275, "user_id": 2040286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38346fd1ac7ec2130b6644fa44acb88c?s=128&d=identicon&r=PG", "display_name": "Paresh J", "link": "https://stackoverflow.com/users/2040286/paresh-j"}, "edited": false, "score": 0, "creation_date": 1453912877, "post_id": 35028890, "comment_id": 57810350, "body": "@PareshJ - I employed similar logic using nested For Each/Next loops, however, I was interested in a more elegant solution because I figured that leveraging a method from the API would be more efficient and less expensive with regards to system load, memory, processing, etc."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5844764, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153739800640289/picture?type=large", "display_name": "Tobias Cortese", "link": "https://stackoverflow.com/users/5844764/tobias-cortese"}, "edited": false, "score": 0, "creation_date": 1453920806, "post_id": 35029090, "comment_id": 57815646, "body": "thanks for the detailed response! and sorry I wasn&#39;t initially clearer. In production, this date will become part of a Unique ID, so I actually want it formatted as Text and not as a Date (I realize that the searchRange is already formatted as Text within the workbook, but I want to control that programmatically as well because there is a chance that the underlying formatting could change). So I need both the inputRange and searchRange converted to (or seen as) Text. If I&#39;m understanding correctly, the first two solutions above convert the inputRange but not the searchRange."}, {"owner": {"reputation": 1, "user_id": 5844764, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153739800640289/picture?type=large", "display_name": "Tobias Cortese", "link": "https://stackoverflow.com/users/5844764/tobias-cortese"}, "edited": false, "score": 0, "creation_date": 1453920995, "post_id": 35029090, "comment_id": 57815764, "body": "I attempted to use the TextToColumns per the following but it was not successful. see Answer for code..."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1453872453, "last_edit_date": 1453872453, "creation_date": 1453869972, "answer_id": 35029090, "question_id": 35028890, "link": "https://stackoverflow.com/questions/35028890/vba-find-dates-serial-number-dates-and-the-data-type-properties-text-val/35029090#35029090", "title": "VBA .Find, dates, serial number dates, and the data type properties (.Text, .Value, .Value2)", "body": "<p>If you need to keep your data as true dates and text-that-looks-like-dates then format the true date values on the he fly to locate matches within the 'text-dates'.</p>\n\n<pre><code>Sub FindTest()\n    Dim inputRange As Range, i As Range\n    Dim searchRange As Range, found As Range\n\n    Set inputRange = Worksheets(1).Cells(2, 1).Resize(99, 1)\n    Set searchRange = Worksheets(2).Columns(1)\n\n    For Each i In inputRange\n        If IsDate(i) Then                      ' \u25bc format into TXT  here \u25bc\n            Set found = searchRange.Find(What:=Format(i.Value2, \"yyyy-mm-dd\"), _\n                            after:=Cells(1), LookIn:=xlValues, LookAt:=xlWhole, _\n                            SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                            MatchCase:=False, SearchFormat:=False)\n            If Not (found Is Nothing) Then\n                With Worksheets(3)\n                    .Cells(i.Row, i.Column) = i.Address(external:=True)\n                    .Cells(i.Row, i.Column + 1) = i.Address(external:=True)\n                End With\n            Else\n                With Worksheets(4)\n                    .Cells(i.Row, i.Column) = i.Address(external:=True)\n                    .Cells(i.Row, i.Column + 1) = i.Address(external:=True)\n                End With\n            End If\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Alternately, the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840217.aspx\" rel=\"nofollow\">Range.Text property</a> should provide the same answer. Apply the Trim command to make sure that the inputRange dates are not formatted with a trailing <code>_)</code> in the format mask.</p>\n\n<pre><code>        Set found = searchRange.Find(What:=Trim(i.Text), _\n                        after:=Cells(1), LookIn:=xlValues, LookAt:=xlWhole, _\n                        SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                        MatchCase:=False, SearchFormat:=False)\n</code></pre>\n\n<p>Addendum:</p>\n\n<p>If there is a possibility of leading or trailing spaces in the <code>searchRange</code>, then change the parameters of your search to <code>LookAt:=xlPart</code>. While repairing the data beforehand would still be the better option, it will ignore extraneous characters that could interfere with a successful match.</p>\n\n<p>If repairing the data can be considered an option then a blanket <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193593.aspx\" rel=\"nofollow\">Range.TextToColumns method</a> on the text values with a YMD <a href=\"https://msdn.microsoft.com/en-us/library/bb241018%28v=office.12%29.aspx\" rel=\"nofollow\">xlColumnDataType</a> will quickly convert your <code>yyyy-mm-dd</code> 'text-dates' into real dates.</p>\n\n<pre><code>    With searchRange\n        .TextToColumns Destination: .Cells (1), DataType:=xlFixedWidth, _\n                       FieldInfo:=Array(0, 5)\n    End With\n</code></pre>\n\n<p>This will remove leading/trailing extraneous characters and leave you with a column of true dates.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5844764, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153739800640289/picture?type=large", "display_name": "Tobias Cortese", "link": "https://stackoverflow.com/users/5844764/tobias-cortese"}, "is_accepted": false, "score": 0, "last_activity_date": 1453921092, "creation_date": 1453921092, "answer_id": 35045749, "question_id": 35028890, "link": "https://stackoverflow.com/questions/35028890/vba-find-dates-serial-number-dates-and-the-data-type-properties-text-val/35045749#35045749", "title": "VBA .Find, dates, serial number dates, and the data type properties (.Text, .Value, .Value2)", "body": "<p>TextToColumn code (unsuccessful)</p>\n\n<pre><code>Sub FindTest()\nDim inputRange As Range\nDim i As Range\nDim searchRange As Range\nDim found As Range\nSet inputRange = Worksheets(1).Cells(1, 1).Resize(7, 1)\nSet searchRange = Worksheets(2).Cells(1, 1).Resize(5, 1)\nsearchRange.TextToColumns Destination:=Worksheets(2).Cells(1), DataType:=xlDelimited, FieldInfo:=Array(1, xlTextFormat)\nFor Each i In inputRange\n    Set found = searchRange.Find _\n        (What:=i, _\n        after:=Cells(1, 1), _\n        LookIn:=xlValues, _\n        LookAt:=xlWhole, _\n        SearchOrder:=xlByRows, _\n        SearchDirection:=xlNext, _\n        MatchCase:=False, _\n        SearchFormat:=False)\n    If Not (found Is Nothing) Then\n        Worksheets(3).Cells(i.Row, i.Column) = i\n    Else\n        Worksheets(4).Cells(i.Row, i.Column) = i\n    End If\nNext i\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 1, "user_id": 5844764, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153739800640289/picture?type=large", "display_name": "Tobias Cortese", "link": "https://stackoverflow.com/users/5844764/tobias-cortese"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 706, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1453921092, "creation_date": 1453868828, "last_edit_date": 1453871683, "question_id": 35028890, "link": "https://stackoverflow.com/questions/35028890/vba-find-dates-serial-number-dates-and-the-data-type-properties-text-val", "title": "VBA .Find, dates, serial number dates, and the data type properties (.Text, .Value, .Value2)", "body": "<p>Using the Range.Find Method to iterate through each value in one range to see if it exists in the other. Issue is that the format for both ranges is different (but all the values are ostensibly dates), which results in many \"false negatives\" (i.e., values are not matching when they should be). is it possible to control the data type for both the input and search ranges so that the system will compare apples-to-apples and successfully recognize matches?  </p>\n\n<p>Here is the data and code:  </p>\n\n<pre><code>Sheet1 (custom format, \"yyyy-mm-dd\")  \nA1  2016-01-01  \nA2  2016-01-02  \nA3  2016-01-03  \nA4  2016-01-04  \nA5  2016-01-05  \n\nSheet2 (text format)  \nA1  2016-01-01  \nA2  2016-01-03  \nA3  2016-01-05  \n\nSheet3 (display as \"yyyy-mm-dd\")  \n[NO DATA]  \n\nSheet4 (display as \"yyyy-mm-dd\")   \n[NO DATA]  \n</code></pre>\n\n<p><strong>code:</strong>  </p>\n\n<pre><code> Sub FindTest()  \n            Dim inputRange As Range  \n            Dim searchRange As Range  \n            Dim found As Range  \n            Set inputRange = Worksheets(1).Cells(1, 1).Resize(7, 1)  \n            Set searchRange = Worksheets(2).Cells(1, 1).Resize(5, 1)  \n            For Each i In inputRange  \n                Set found = searchRange.Find _  \n                    (What:=i, _  \n                    after:=Cells(1, 1), _  \n                    LookIn:=xlValues, _  \n                    LookAt:=xlWhole, _  \n                    SearchOrder:=xlByRows, _  \n                    SearchDirection:=xlNext, _  \n                    MatchCase:=False, _  \n                    SearchFormat:=False)  \n                If Not (found Is Nothing) Then  \n                    Worksheets(3).Cells(i.Row, i.Column) = i  \n                Else  \n                    Worksheets(4).Cells(i.Row, i.Column) = i  \n                End If  \n            Next i  \n        End Sub  \n</code></pre>\n\n<p>For this to work, I assume that I need all the value in inputRange and searchRange to be compared as .Text, but I'm not sure to get there.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5844622, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/10205554224563645/picture?type=large", "display_name": "Andriano Crs", "link": "https://stackoverflow.com/users/5844622/andriano-crs"}, "edited": false, "score": 0, "creation_date": 1453869417, "post_id": 35028630, "comment_id": 57784106, "body": "THANKS teylyn it&#39;s work &gt;.&lt; so its need double &quot; thanks"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 19, "user_id": 5844622, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/10205554224563645/picture?type=large", "display_name": "Andriano Crs", "link": "https://stackoverflow.com/users/5844622/andriano-crs"}, "edited": false, "score": 0, "creation_date": 1453870197, "post_id": 35028630, "comment_id": 57784322, "body": "If my post solved your problem please mark it as the answer as described in the <a href=\"http://stackoverflow.com/tour\">Tour</a>"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1453867098, "creation_date": 1453867098, "answer_id": 35028630, "question_id": 35028330, "link": "https://stackoverflow.com/questions/35028330/got-true-and-false-when-i-using-formula-in-vba-excel/35028630#35028630", "title": "got TRUE AND FALSE when i using formula in VBA Excel", "body": "<p>Two things:</p>\n\n<ol>\n<li>When you use a string in VBA and there are double quotes inside the string, you need to type two double quote signs. </li>\n<li>your first formula should use  <code>Sheet1.Range(\"UA14\").Formula = \"=Sumifs.....</code></li>\n</ol>\n\n<p>So if you want this formula in a cell</p>\n\n<pre><code>=SUMIFS('Sheet one'!$B:$B,'Sheet one'!$C:$C, \"&gt;=\" &amp; C1)\n</code></pre>\n\n<p>... you need to use this VBA (note the double \"\" around the <code>&gt;=</code>):</p>\n\n<pre><code>Range(\"a1\").Formula = \"=Sumifs('Sheet One'!$B:$B,'Sheet One'!$C:$C, \"\"&gt;=\"\" &amp; C1)\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/PECmk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PECmk.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 664, "user_id": 2977281, "user_type": "registered", "profile_image": "https://graph.facebook.com/561723379/picture?type=large", "display_name": "CustodianOfCode", "link": "https://stackoverflow.com/users/2977281/custodianofcode"}, "is_accepted": false, "score": 0, "last_activity_date": 1453867124, "creation_date": 1453867124, "answer_id": 35028634, "question_id": 35028330, "link": "https://stackoverflow.com/questions/35028330/got-true-and-false-when-i-using-formula-in-vba-excel/35028634#35028634", "title": "got TRUE AND FALSE when i using formula in VBA Excel", "body": "<p>Excel is doing what you are telling it to - evaluating whether the string </p>\n\n<pre><code>\"=SUMIFS('BERKAS MASUK'!R[7]C[-536]:R[1685]C[-536], 'BERKAS MASUK'!R[7]C[-532]:R[1685]C[-532], \" \n</code></pre>\n\n<p>is <strong>GREATER THAN OR EQUAL TO</strong></p>\n\n<pre><code>\" &amp; RANGKUMAN!R[-4]C,'BERKAS MASUK'!R[7]C[-532]:\"\n</code></pre>\n\n<p>Review your code again, and decide what formula you actually want to populate into your cell. </p>\n"}], "owner": {"reputation": 19, "user_id": 5844622, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/10205554224563645/picture?type=large", "display_name": "Andriano Crs", "link": "https://stackoverflow.com/users/5844622/andriano-crs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1462529921, "creation_date": 1453865300, "last_edit_date": 1462529921, "question_id": 35028330, "link": "https://stackoverflow.com/questions/35028330/got-true-and-false-when-i-using-formula-in-vba-excel", "title": "got TRUE AND FALSE when i using formula in VBA Excel", "body": "<p>ok i noob when using vba excel and trying using formula trough vba excel when i trying to use it :</p>\n\n<pre><code>Sheet1.Range(\"UA14\") = ActiveCell.Formula = \"=SUMIFS('BERKAS MASUK'!I20:I1698, 'BERKAS MASUK'!M20:M1698, \" &gt;= \" &amp; RANGKUMAN!TY9,'BERKAS MASUK'!M20:M1698, \" &lt;= \" &amp; RANGKUMAN!TZ9)\"\n</code></pre>\n\n<p>i got FALSE in my UA14 and when i using R1C1</p>\n\n<pre><code>Sheet1.Range(\"UA14\").FormulaR1C1 = \"=SUMIFS('BERKAS MASUK'!R[7]C[-536]:R[1685]C[-536], 'BERKAS MASUK'!R[7]C[-532]:R[1685]C[-532], \" &gt;= \" &amp; RANGKUMAN!R[-4]C,'BERKAS MASUK'!R[7]C[-532]:\"\n</code></pre>\n\n<p>I got TRUE in my UA14 can someone help me solve this >.&lt; i need sumifs result not true or false in my UA14</p>\n"}, {"tags": ["vba", "excel", "save"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 5, "creation_date": 1453858004, "post_id": 35027222, "comment_id": 57780765, "body": "Maybe <code>ThisWorkbook.Save</code>  ...?"}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 1, "creation_date": 1453860132, "post_id": 35027222, "comment_id": 57781380, "body": "If it&#39;s not a VBA solution you&#39;re looking for, then maybe reducing the time between autosaves?"}], "answers": [{"comments": [{"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1453859636, "post_id": 35027318, "comment_id": 57781238, "body": "You should try to avoid <code>active</code> and <code>selection</code>, it is a very common cause of bugs, especially if you have multiple workbooks open. In general it&#39;s best to avoid <code>Active(Workbook&#47;Sheet&#47;Cell)</code> and the <code>.Select&#47;.Activate</code> method or <code>.Selection</code> property. There are of course cases where it is unavoidable but this isn&#39;t one of them."}, {"owner": {"reputation": 1110, "user_id": 3175825, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/82d774bd17bda56f05edf7d9b5dafbea?s=128&d=identicon&r=PG", "display_name": "oro777", "link": "https://stackoverflow.com/users/3175825/oro777"}, "edited": false, "score": 0, "creation_date": 1453859914, "post_id": 35027318, "comment_id": 57781319, "body": "Thank you for the VBA alternative, I was wondering if there was an option in Excel, I search for it but without success."}], "tags": [], "owner": {"reputation": 188, "user_id": 5772563, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DVfEl50m8KI/AAAAAAAAAAI/AAAAAAAAADk/gmX7V01d4u8/photo.jpg?sz=128", "display_name": "Adrian Legaspi", "link": "https://stackoverflow.com/users/5772563/adrian-legaspi"}, "is_accepted": true, "score": 3, "last_activity_date": 1453858545, "creation_date": 1453858545, "answer_id": 35027318, "question_id": 35027222, "link": "https://stackoverflow.com/questions/35027222/excel-save-as-on-run/35027318#35027318", "title": "Excel save as on Run", "body": "<p>Add </p>\n\n<pre><code>ActiveWorkbook.Save\n</code></pre>\n\n<p>at the beginning of your macro</p>\n"}], "owner": {"reputation": 1110, "user_id": 3175825, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/82d774bd17bda56f05edf7d9b5dafbea?s=128&d=identicon&r=PG", "display_name": "oro777", "link": "https://stackoverflow.com/users/3175825/oro777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 35027318, "answer_count": 1, "score": 2, "last_activity_date": 1453858548, "creation_date": 1453857905, "last_edit_date": 1531164843, "question_id": 35027222, "link": "https://stackoverflow.com/questions/35027222/excel-save-as-on-run", "title": "Excel save as on Run", "body": "<p>In Excel, after writing a VBA script, I would like Excel to save the file before running it. </p>\n\n<p>It is common on most of the programming tools.\nWhile testing a program, it may crash and my program may not be saved but if it saves before each run, I won't have this problem anymore.</p>\n\n<p>I know there is a automatically save option in Excel but is there another alternative ?</p>\n"}, {"tags": ["vba", "irr"], "comments": [{"owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "edited": false, "score": 0, "creation_date": 1453857298, "post_id": 35026621, "comment_id": 57780523, "body": "You did NOT use my code - you changed the explicit array bounds <code>0 to 2</code> with <b><i>three</i></b> defined values to implicit array bounds <code>0 to 2</code> with only  <b><i>two</i></b> defined values. You must give a value to a(0) and must have a sign change in the value list."}, {"owner": {"reputation": 981, "user_id": 2227222, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d80812002213736d9576158000e84d98?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/2227222/hans"}, "reply_to_user": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "edited": false, "score": 1, "creation_date": 1453859696, "post_id": 35026621, "comment_id": 57781254, "body": "@PieterGeerkens: I neglected to add &quot;option base 1&quot; at the top previously. I have now added that. I do not like initializing an array at 0 but prefer to start it at 1. Now the code is essentially yours. Do you agree?"}, {"owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "edited": false, "score": 1, "creation_date": 1453859797, "post_id": 35026621, "comment_id": 57781285, "body": "You don&#39;t have a sign change in your input value array, which is required for your &quot;<i>invalid procedure ... argument</i>&quot; to become <i>valid</i>. And, don&#39;t use OPTION BASE 1 because you will run into all sorts of problems doing so, I&#39;ve been there, done that, and learned better."}, {"owner": {"reputation": 981, "user_id": 2227222, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d80812002213736d9576158000e84d98?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/2227222/hans"}, "reply_to_user": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "edited": false, "score": 0, "creation_date": 1453860915, "post_id": 35026621, "comment_id": 57781625, "body": "I see, regarding the sign change. Regarding base 1, are the problems you refer to concern particularly with VBA or programming in general? I ask because I have no problem indexing sequences starting from 1 in Matlab. What kind of problem would I run into?"}], "answers": [{"comments": [{"owner": {"reputation": 981, "user_id": 2227222, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d80812002213736d9576158000e84d98?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/2227222/hans"}, "edited": false, "score": 0, "creation_date": 1453857072, "post_id": 35026987, "comment_id": 57780439, "body": "I tried your method and get the error message as shown in the second part of the question."}, {"owner": {"reputation": 981, "user_id": 2227222, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d80812002213736d9576158000e84d98?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/2227222/hans"}, "edited": false, "score": 0, "creation_date": 1453860698, "post_id": 35026987, "comment_id": 57781559, "body": "Yes, you are right. Once the sign problem of &quot;a&quot; is corrected. Thank you."}], "tags": [], "owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "is_accepted": false, "score": 2, "last_activity_date": 1453856497, "creation_date": 1453856497, "answer_id": 35026987, "question_id": 35026621, "link": "https://stackoverflow.com/questions/35026621/how-to-use-irr-function-in-vba/35026987#35026987", "title": "How to use IRR() function in VBA", "body": "<p>No, <code>a</code> is NOT an array; it is \"<em>a variant containing an array\"</em>. VBA is NOT a C-type language, and doesn't have the initializers that those do. Try this code:</p>\n\n<pre><code>Dim a(0 To 2) As Double\na(0) = -3#\na(1) = 4#\na(2) = 5#\n\nDim v As Double: v = irr(a(), 0.1)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "edited": false, "score": 2, "creation_date": 1453857389, "post_id": 35027119, "comment_id": 57780555, "body": "Although the first element in the array is USUALLY negative, it is sufficient that there be at least one sign change. There are (in general) as many solutions as there are sign changes in the value list provided, which can be problematic when there is a continuing investment after the first positive return."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "edited": false, "score": 0, "creation_date": 1453857540, "post_id": 35027119, "comment_id": 57780622, "body": "Good point @PieterGeerkens - thank you for the clarification on the use of the <a href=\"https://support.office.com/en-us/article/IRR-function-64925EAA-9988-495B-B290-3AD0C163C1BC\" rel=\"nofollow noreferrer\">IRR function</a>. I&#39;m afraid I&#39;m better at the the mechanics than the actual operation of the function."}, {"owner": {"reputation": 981, "user_id": 2227222, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d80812002213736d9576158000e84d98?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/2227222/hans"}, "reply_to_user": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "edited": false, "score": 0, "creation_date": 1453859114, "post_id": 35027119, "comment_id": 57781100, "body": "Thank you both, jeeped and @PieterGeerkens. Adding application. resolves the problem."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1453857277, "creation_date": 1453857277, "answer_id": 35027119, "question_id": 35026621, "link": "https://stackoverflow.com/questions/35026621/how-to-use-irr-function-in-vba/35027119#35027119", "title": "How to use IRR() function in VBA", "body": "<p>You need to apply either the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194565.aspx\" rel=\"nofollow\">Excel Application object</a>, the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834434.aspx\" rel=\"nofollow\">WorksheetFunction object</a> or both. Additionally, the first element in the array is expected to be negative.</p>\n\n<pre><code>    Dim a As Variant, b As Double\n\n    a = Array(-6, 4, 5)\n\n    b = Application.IRR(a, 0.1)\n    Debug.Print b\n\n    b = WorksheetFunction.IRR(a, 0.1)\n    Debug.Print b\n\n    b = Application.WorksheetFunction.IRR(a, 0.1)\n    Debug.Print b\n</code></pre>\n\n<p>Results from the VBE's Immediate window ([ctrl]+G)</p>\n\n<pre><code> 0.305158649140883 \n 0.305158649140883 \n 0.305158649140883 \n</code></pre>\n"}], "owner": {"reputation": 981, "user_id": 2227222, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d80812002213736d9576158000e84d98?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/2227222/hans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2463, "favorite_count": 1, "accepted_answer_id": 35027119, "answer_count": 2, "score": 1, "last_activity_date": 1453859529, "creation_date": 1453854289, "last_edit_date": 1453859529, "question_id": 35026621, "link": "https://stackoverflow.com/questions/35026621/how-to-use-irr-function-in-vba", "title": "How to use IRR() function in VBA", "body": "<p>I am trying to use the IRR function in VBA. IRR() works well in Excel. As I scripted it in VBA as follows,</p>\n\n<pre><code>a = Array(3, 4, 5)\nb = IRR(a, 0.1)\n</code></pre>\n\n<p>it complained of \"Compile error: Type mismatch: array or user-defined type expected\". What dumbfounds me is a IS an array. What is wrong?</p>\n\n<hr>\n\n<p>I rewrote the function according to Pieter Geerkens as follows:</p>\n\n<pre><code>option base 1\n\nFunction trial()\nDim a(2) As Double, b As Double\n\na(1) = 1.2\na(2) = 3.4\nb = IRR(a(), 0.1)\nEnd Function\n</code></pre>\n\n<p>I get the error message: Run-time error '5': Invalid procedure call or argument.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1453854547, "post_id": 35026544, "comment_id": 57779759, "body": "Can you be more clear with you question? It si vague and confusing... You got the headers From E1 to E100 and plus... And you want to change every header with the name of the sheet??? That all you need??? All you want????"}, {"owner": {"reputation": 1315, "user_id": 1250422, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/92d73842659c8dda791788d0fbaac4c5?s=128&d=identicon&r=PG", "display_name": "Archimaredes", "link": "https://stackoverflow.com/users/1250422/archimaredes"}, "edited": false, "score": 0, "creation_date": 1453855342, "post_id": 35026544, "comment_id": 57779995, "body": "You seem to be attempting to change things in a list object, which is a specific object in a worksheet and does not represent the data in the sheet..."}, {"owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "reply_to_user": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1453857111, "post_id": 35026544, "comment_id": 57780458, "body": "@ElbertV I just want to add the name of the Worksheet (&quot;Beverage - &quot;) in front of each column (aluminum, tablecraft, indoor, etc). So final result would be &quot;Beverage - aluminum&quot;, &quot;Beverage - tablecraft&quot;, etc."}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1453858364, "post_id": 35026544, "comment_id": 57780888, "body": "Well tell me if my answer is right..."}, {"owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "reply_to_user": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1453858844, "post_id": 35026544, "comment_id": 57781028, "body": "@ElbertV Yes, just ran it and it worked, thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "edited": false, "score": 0, "creation_date": 1453861365, "post_id": 35026776, "comment_id": 57781754, "body": "Thank you for the code and especially the comments, it really helps for someone new to VBA like me"}, {"owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "edited": false, "score": 0, "creation_date": 1453862034, "post_id": 35026776, "comment_id": 57781939, "body": "btw, would you happen to know how to get this script to run across all sheets (except 2) in my workbook? Here is my attempt at modifying the code you gave me, but it still only works for the local sheet: <a href=\"http://www.savwire.com/wp-content/uploads/2016/01/SOLVED_Worksheet_Name_Prefix_v2.txt\" rel=\"nofollow noreferrer\">savwire.com/wp-content/uploads/2016/01/&hellip;</a>"}, {"owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "edited": false, "score": 0, "creation_date": 1453864504, "post_id": 35026776, "comment_id": 57782670, "body": "I would just put it inside a regular module, run it once, and it would run across all worksheets (Except worksheets &quot;AA&quot; and &quot;Word Frequency&quot;)"}, {"owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "edited": false, "score": 0, "creation_date": 1453913536, "post_id": 35026776, "comment_id": 57810860, "body": "Thank you @Elbert Villarreal! It works, though I had to replace &#39; If sht.Name &lt;&gt; noSht01 And sht.Name &lt;&gt; noSht02 Then&#39; with &#39;If sht.Name &lt;&gt; &quot;AA&quot; And sht.Name &lt;&gt; &quot;Word Frequency&quot; Then&#39; because I was getting &#39;error 438 Object doesn&#39;t support this property&#39;, and I couldn&#39;t get my microsoft office 2010 to update. But the code works perfectly, especially how it&#39;s separated, I will use that template for other scripts as well. Many thanks, muy amable"}], "tags": [], "owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "is_accepted": true, "score": 2, "last_activity_date": 1453913829, "last_edit_date": 1453913829, "creation_date": 1453855213, "answer_id": 35026776, "question_id": 35026544, "link": "https://stackoverflow.com/questions/35026544/excel-how-can-i-add-worksheet-name-as-prefix-for-each-column-header/35026776#35026776", "title": "(Excel) How Can I Add Worksheet Name as Prefix for Each Column Header?", "body": "<p>I hope this help you... </p>\n\n<pre><code>Sub Worksheet_Name_Prefix_v2()\n    Dim h 'to store the last columns/header\n    Dim rngHeaders As Range 'the whole range with the headers from E1 to x1\n    Dim i 'just and index\n    Dim sht As Worksheet 'the sheet where you want the job done\n\n    h = Range(\"E1\").End(xlToRight).Column 'find the last column with the data/header\n    Set rngHeaders = Range(Cells(1, 5), Cells(1, h)) 'the range with the headers E = column 5\n    'Cells 1 5 = E1\n    'Cells 1 h = x1 where x is the last column with data\n    Set sht = ActiveSheet 'the sheet with the data, _\n                          'and we take the name of that sheet to do the job\n\n    For Each i In rngHeaders 'for each cell in the headers (every cells in row 1)\n        i.Value = sht.Name &amp; \" - \" &amp; i.Value\n        'set the value \"sheet_name - cell_value\" in every cell\n    Next i\nEnd Sub\n</code></pre>\n\n<p>If you need any emprovement please tell me... I'm not sure if I get the real idea of what you need. </p>\n\n<p><strong>Edit #1</strong></p>\n\n<p>Use this in a regular module:</p>\n\n<pre><code>Option Explicit\n\nSub goForEverySheet()\n    Dim noSht01 As Worksheet 'store the first sheet\n    Dim noSht02 As Worksheet 'store the second sheet\n    Dim sht 'just a tmp var\n\n    Set noSht01 = Sheets(\"AA\") 'the first sheet\n    Set noSht02 = Sheets(\"Word Frequency\") 'the second sheet\n\n    appTGGL bTGGL:=False\n    For Each sht In Worksheets ' for each sheet inside the worksheets of the workbook\n        If sht.Name &lt;&gt; noSht01.Name And sht.Name &lt;&gt; noSht02.Name Then\n        'IF sht.name is different to AA AND sht.name is diffent to WordFrecuency THEN\n\n        'TIP:\n        'If Not sht.Name = noSht01.Name And Not sht.Name = noSht02.name Then 'This equal\n        'IF (NOT =&gt; negate the sentence) sht.name is NOT equal to noSht01 AND\n        '                                sht.name is NOT equal to noSht02 THEN\n\n            sht.Activate 'go to that Sheet!\n            Worksheet_Name_Prefix_v3 'run the code\n        End If '\n    Next sht 'next one please!\n    appTGGL\nEnd Sub\n\n\nSub Worksheet_Name_Prefix_v3()\n    Dim h 'to store the last columns/header\n    Dim rngHeaders As Range 'the whole range with the headers from E1 to x1\n    Dim i 'just and index\n    Dim sht As Worksheet 'the sheet where you want the job done\n\n    h = Range(\"E1\").End(xlToRight).Column 'find the last column with the data/header\n    Set rngHeaders = Range(Cells(1, 5), Cells(1, h)) 'the range with the headers E = column 5\n    'Cells 1 5 = E1\n    'Cells 1 h = x1 where x is the last column with data\n    Set sht = ActiveSheet 'the sheet with the data, _\n                          'and we take the name of that sheet to do the job\n\n    For Each i In rngHeaders 'for each cell in the headers (every cells in row 1)\n        i.Value = sht.Name &amp; \" - \" &amp; i.Value\n        'set the value \"sheet_name - cell_value\" in every cell\n    Next i\nEnd Sub\n\nPublic Sub appTGGL(Optional bTGGL As Boolean = True)\n    Debug.Print Timer\n    Application.ScreenUpdating = bTGGL\n    Application.EnableEvents = bTGGL\n    Application.DisplayAlerts = bTGGL\n    Application.Calculation = IIf(bTGGL, xlCalculationAutomatic, xlCalculationManual)\nEnd Sub\n</code></pre>\n\n<p>Your code was not running because, you do not use this line <code>sht.Activate</code> you say, <code>for every sheet in the workbook do this</code>, but you not say to go to every sheet, and the the code run <em><code>n</code></em> times in the same sheet (as many sheets there in the workbook less two). But if you say, <code>for every sheet do this</code>, AND got to each of one of that sheets and do this (less that two sheets) you will get whay you want</p>\n"}], "owner": {"reputation": 71, "user_id": 5728416, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c926c789a3dc73581051ee6bd99b1197?s=128&d=identicon&r=PG&f=1", "display_name": "sikorloa", "link": "https://stackoverflow.com/users/5728416/sikorloa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1052, "favorite_count": 0, "accepted_answer_id": 35026776, "answer_count": 1, "score": 0, "last_activity_date": 1453913829, "creation_date": 1453853763, "last_edit_date": 1495542208, "question_id": 35026544, "link": "https://stackoverflow.com/questions/35026544/excel-how-can-i-add-worksheet-name-as-prefix-for-each-column-header", "title": "(Excel) How Can I Add Worksheet Name as Prefix for Each Column Header?", "body": "<p>I have a header that starts in Column E and might go on for 100+ columns.</p>\n\n<p><strong>I am trying to change each column header to add a prefix (the name of the \"tab\" aka. worksheet)</strong> (ie. if Worksheet is called 'Beverage', I'd like each column header to be prefixed with \"Beverage -\")</p>\n\n<p>I will be running script across multiple sheets, so am trying to find a way to reference the current sheet name.</p>\n\n<hr>\n\n<p><strong>Before:</strong> (For Worksheet \"Beverage\")</p>\n\n<h2><a href=\"https://i.stack.imgur.com/XWlui.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XWlui.jpg\" alt=\"enter image description here\"></a></h2>\n\n<p><strong>After:</strong> (For Worksheet \"Beverage\". Note: Columns don't need to be resized, just did it to demonstrate)\n<a href=\"https://i.stack.imgur.com/NZt3M.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NZt3M.jpg\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>I've tried adapting code from <a href=\"https://stackoverflow.com/questions/18231100/excel-vb-re-ordering-renaming-columns\">this thread</a>, however I can't get it to work.</p>\n\n<p><strong>Here is the code I have so far (non-working):</strong></p>\n\n<pre><code>Sub Worksheet_Name_Prefix()\n\nDim columnNumber As Long, x As Integer\n\nDim myTab As ListObject\nSet myTab = ActiveSheet.ListObjects(rows.Count, 1)\n\nFor x = 5 To rows.Count  ' For Columns E through last header cell with value\n    columnNumber = x\n    myTab.HeaderRowRange(1, columnNumber) = ActiveSheet.Name\nNext x\n\nEnd Sub\n</code></pre>\n\n<p>Any suggestions on what's wrong with my code? Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "array-formulas"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5843990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d640bba4eba8ccf46613bbcd3b3354a7?s=128&d=identicon&r=PG&f=1", "display_name": "fundesign", "link": "https://stackoverflow.com/users/5843990/fundesign"}, "edited": false, "score": 0, "creation_date": 1453861635, "post_id": 35026654, "comment_id": 57781830, "body": "That works! Thank you so much for your response. Mon is only the column number from activecell.column."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 33, "user_id": 5843990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d640bba4eba8ccf46613bbcd3b3354a7?s=128&d=identicon&r=PG&f=1", "display_name": "fundesign", "link": "https://stackoverflow.com/users/5843990/fundesign"}, "edited": false, "score": 0, "creation_date": 1453863520, "post_id": 35026654, "comment_id": 57782365, "body": "Admittedly, this is a bit of a &#39;hack&#39; or &#39;band-aid&#39; approach. However, since the character expansion of a formula can very often be attributed to the necessary addition of long worksheet names, it should be considered as an alternative to defined names or &#39;partnered formulas&#39;  containing portions of the full array formula."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1453854479, "creation_date": 1453854479, "answer_id": 35026654, "question_id": 35025697, "link": "https://stackoverflow.com/questions/35025697/overcoming-the-255-char-limit-for-formulaarray-in-excel-vba/35026654#35026654", "title": "Overcoming the 255 char. limit for formulaArray in Excel VBA", "body": "<p>Depending upon how long the value in the <em>mon</em> variable is, it seems that your array formula is only marginally over the limit at ~290-310 characters and a large portion of that is comprised of the external worksheet name (e.g. '2016 Summary'). Changing the worksheet name temporarily to a single character is sufficient to bring the formula down to the ~190-210 character range; more than adequate to stuff the formula into the cell's <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837104.aspx\" rel=\"nofollow\">Range.FormulaArray property</a>.</p>\n\n<pre><code>    Dim strWS As String, chrWS As String\n\n    strWS = \"2016 Summary\"\n    chrWS = Chr(167)    '&lt;~~ any unque, legal, single character that can be temporarily used as a worksheet name\n\n    With Worksheets(strWS)\n        .Name = Chr(167)\n    End With\n\n    With Worksheets(\"worksheet_with_array_formula\")\n        .Range(\"o37\").FormulaArray = \"=CONCATENATE(SUM(IF((\" &amp; chrWS &amp; \"!$T$4:$T$39&lt;=\" &amp; mon &amp; \")*\" &amp; _\n            \"(\" &amp; chrWS &amp; \"!$D$4:$D$39&gt;0)*(\" &amp; chrWS &amp; \"!$T$4:$T$39+\" &amp; chrWS &amp; \"!$D$4:$D$39&gt;\" &amp; mon &amp; \")*\" &amp; _\n            \"(\" &amp; chrWS &amp; \"!$S$4:$S$39=TRUE),(1),IF((\" &amp; chrWS &amp; \"!$T$4:$T$39&lt;=\" &amp; mon &amp; \")*(\" &amp; chrWS &amp; \"!$S$4:$S$39=TRUE)*\" &amp; _\n            \"(\" &amp; chrWS &amp; \"!$D$4:$D$39=0),(1),0)))&amp;\"\" - Employees\"\")\"\n    End With\n\n    With Worksheets(chrWS)\n        .Name = strWS\n    End With\n</code></pre>\n\n<p>Excel will change the worksheet name within the formula, adding wrapping ticks (e.g. <code>'2016 Summary'!$T$4:$T$39</code>) to compensate for the space in the new (old) worksheet name.</p>\n\n<p>If you provided more detail on the value of <em>mon</em> and some sample data from the '2016 Summary' worksheet, it also possible that the formula could be improved. At first glance, it looks like an array formula may not be absolutely necessary at all.</p>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 9265070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7d01001a22dfc0a6ee237d185a085f?s=128&d=identicon&r=PG&f=1", "display_name": "yamashiro.akihito", "link": "https://stackoverflow.com/users/9265070/yamashiro-akihito"}, "is_accepted": false, "score": 0, "last_activity_date": 1595508815, "creation_date": 1595508815, "answer_id": 63054775, "question_id": 35025697, "link": "https://stackoverflow.com/questions/35025697/overcoming-the-255-char-limit-for-formulaarray-in-excel-vba/63054775#63054775", "title": "Overcoming the 255 char. limit for formulaArray in Excel VBA", "body": "<pre><code>Sub SetTooLongArrayFormula(ByVal rn As Range, ByVal sFormula As String)\n    Dim sFormat As String\n    sFormat = rn.Cells(1, 1).NumberFormat\n    rn.FormulaArray = &quot;&quot;\n    rn.Cells(1, 1).NumberFormat = &quot;@&quot;\n    rn.Value = sFormula\n    rn.Cells(1, 1).NumberFormat = sFormat\n    rn.Select\n    DoEvents\n    SendKeys &quot;{F2}&quot;, True\n    DoEvents\n    SendKeys &quot;+^{ENTER}&quot;, True\n    \nEnd Sub\nSub Test()\n    'Do not run this macro from VBE Editor\n    'Run this macro from the Macros ribbon on the Developer tab with the Excel worksheet in front.\n    Dim sFormula As String\n    sFormula = &quot;=&quot;&quot;1&quot;&quot;&quot;\n    For i = 1 To 250\n        sFormula = sFormula &amp; &quot;&amp;&quot;&quot;1&quot;&quot;&quot;\n    Next\n    SetTooLongArrayFormula Range(&quot;A1:A2&quot;), sFormula\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5843990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d640bba4eba8ccf46613bbcd3b3354a7?s=128&d=identicon&r=PG&f=1", "display_name": "fundesign", "link": "https://stackoverflow.com/users/5843990/fundesign"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3176, "favorite_count": 0, "closed_date": 1612032533, "accepted_answer_id": 35026654, "answer_count": 2, "score": 3, "last_activity_date": 1595508815, "creation_date": 1453849121, "last_edit_date": 1453852172, "question_id": 35025697, "link": "https://stackoverflow.com/questions/35025697/overcoming-the-255-char-limit-for-formulaarray-in-excel-vba", "closed_reason": "Duplicate", "title": "Overcoming the 255 char. limit for formulaArray in Excel VBA", "body": "<p>I need an array to be inserted into a specific cell and I keep running into the 1004 error. Here is the code:</p>\n\n<pre><code>Range(\"o37\").FormulaArray = \"=CONCATENATE(SUM(IF(('2016 Summary'!$T$4:$T$39&lt;=\" &amp; mon &amp; \")*\" &amp; _\n    \"('2016 Summary'!$D$4:$D$39&gt;0)*('2016 Summary'!$T$4:$T$39+'2016 Summary'!$D$4:$D$39&gt;\" &amp; mon &amp; \")*\" &amp; _\n    \"('2016 Summary'!$S$4:$S$39=TRUE),(1),IF(('2016 Summary'!$T$4:$T$39&lt;=\" &amp; mon &amp; \")*('2016 Summary'!$S$4:$S$39=TRUE)*\" &amp; _\n    \"('2016 Summary'!$D$4:$D$39=0),(1),0)))&amp;\"\" - Employees\"\")\"\n</code></pre>\n\n<p>That array is supposed to be inserted into <code>O37</code> with the \"mon\" variable based on the activecell column. The formula works when I manually put it in the sheet. I have tried splitting it with .replace and I get the same error. What can I do to make this work with formulaArray?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5843817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134223b36b6a66ecec192840d46a444f?s=128&d=identicon&r=PG&f=1", "display_name": "belau", "link": "https://stackoverflow.com/users/5843817/belau"}, "edited": false, "score": 0, "creation_date": 1453911698, "post_id": 35025830, "comment_id": 57809535, "body": "This works perfect!  Saving me such a headache, Thank You for your help!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1453851282, "last_edit_date": 1453851282, "creation_date": 1453849782, "answer_id": 35025830, "question_id": 35025432, "link": "https://stackoverflow.com/questions/35025432/auto-fill-the-date-in-a-cell-when-change-is-made-into-an-adjacent-cell/35025830#35025830", "title": "Auto-fill the date in a cell, when change is made into an adjacent cell", "body": "<p>These modification take care of your first two specifications.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"M:M,X:X\"), Range(\"10:\" &amp; Rows.Count)) Is Nothing Then\n        If Target.Count &lt; Columns.Count Then\n            On Error GoTo bm_Safe_Exit\n            Application.EnableEvents = False\n            Dim r As Range\n            For Each r In Intersect(Target, Range(\"M:M,X:X\"), Range(\"10:\" &amp; Rows.Count))\n                With r.Offset(0, 1)\n                    .Value = Now   'use Now to retain the time as well as the date\n                    .NumberFormat = \"dd-mmm-yyyy hh:mm:ss\"  'change to what you prefer\n                End With\n            Next r\n        End If\n    End If\nbm_Safe_Exit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>As far as the third, I would humbly suggest that you get used to using the preferred method of tapping <kbd>Esc</kbd> to abandon an 'in-cell' edit rather than <kbd>Enter\u21b5</kbd> or selecting another cell. Using Esc does not change the value in the cell and the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839775.aspx\" rel=\"nofollow noreferrer\">Worksheet_Change</a> event macro is not triggered. Using Enter or selecting another cell DOES change the value in the cell and coding against lackadaisical practises is simply not worth the overhead when proper keyboard practises could be applied.</p>\n\n<p>Addendum:</p>\n\n<p>If your hand is still on the mouse, you can also click the <strong>\u00d7</strong> in the formula bar to [Esc] an in-cell edit.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/WHNqt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WHNqt.png\" alt=\"in-cell-edit_escape\"></a></p>\n"}], "owner": {"reputation": 15, "user_id": 5843817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134223b36b6a66ecec192840d46a444f?s=128&d=identicon&r=PG&f=1", "display_name": "belau", "link": "https://stackoverflow.com/users/5843817/belau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3316, "favorite_count": 1, "accepted_answer_id": 35025830, "answer_count": 1, "score": 1, "last_activity_date": 1454285335, "creation_date": 1453847994, "last_edit_date": 1531161705, "question_id": 35025432, "link": "https://stackoverflow.com/questions/35025432/auto-fill-the-date-in-a-cell-when-change-is-made-into-an-adjacent-cell", "title": "Auto-fill the date in a cell, when change is made into an adjacent cell", "body": "<p>I found code to work in <code>Excel</code> that almost does what I need.</p>\n\n<p>My need is to have today's date added automatically in one column's cell when a change is made in another column's cell. So if I click in Column M Row 20's cell &amp; change data or add data (in this case it is a Status column with a dropdown list) then in Column N Row 20's cell it will put today's date or replace old date with today's date. (Every time Status dropdown is changed.)</p>\n\n<p>This code does that for 2 different columns because I altered it.</p>\n\n<p>The Problems:</p>\n\n<ol>\n<li><p>If I insert rows it will put today's date in the newly inserted\nrows or if I delete rows, let's say 3 rows it will add the date or\noverwrite the date in the 3 rows below the 3 just deleted. This is\nnot good. I only want a date added if I make a change in the cell\nitself. Simply auto add date when we add or change the status (Data)\nin the cell to the left of it.</p></li>\n<li><p>Also I need the top 9 rows not to be affected by this auto date\n    add.</p></li>\n<li><p>Lastly if I double click in Column M Row 20's cell but do not\n    enter any data then click out of the cell it will still add date to\n    Column N Row 20's cell.</p></li>\n</ol>\n\n<p>I found the original code at:\n<a href=\"https://stackoverflow.com/questions/26411407/auto-fill-the-date-in-a-cell-when-the-user-enters-information-in-an-adjacent-ce\">Auto-fill the date in a cell, when the user enters information in an adjacent cell</a></p>\n\n<p>My version of the code is:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim A As Range, M As Range, X As Range, Inte As Range, r As Range\nSet A = Range(\"M:M,X:X\")\nSet Inte = Intersect(A, Target)\nIf Inte Is Nothing Then Exit Sub\nApplication.EnableEvents = False\n    For Each r In Inte\n        r.Offset(0, 1).Value = Date\n    Next r\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "email", "outlook", "directory", "attachment"], "comments": [{"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 0, "creation_date": 1453846690, "post_id": 35025059, "comment_id": 57776866, "body": "We know what you want it to do, but what <i>does</i> this code do?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1453848462, "post_id": 35025059, "comment_id": 57777656, "body": "The filename prefix format should use <code>&quot;yyyymmddhhmm-&quot;</code>. But you should do another check if there is a file of the resultant name exists. Also You don&#39;t need the Outlook App if this macro is to be executed in Outlook."}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1453863046, "last_edit_date": 1453863046, "creation_date": 1453861951, "answer_id": 35027806, "question_id": 35025059, "link": "https://stackoverflow.com/questions/35025059/save-attachments-from-outlook-with-receivedtime-on-file-name/35027806#35027806", "title": "Save Attachments from Outlook with ReceivedTime on file name", "body": "<p>Use objMsg not itm.</p>\n\n<pre><code>' StrDate = Format(itm.ReceivedTime, \"yyyy-mm-dd Hmm \")\n StrDate = Format(objMsg.ReceivedTime, \"yyyy-mm-dd Hmm \")\n</code></pre>\n\n<p>Additionally drop other code with itm and as well objOL</p>\n\n<pre><code>' Set itm = Application.CreateItem(olMailItem)\n' Dim CurrentMsg As Outlook.MailItem\n\n' On Error Resume Next\n' Instantiate an Outlook Application object.\n' Set objOL = CreateObject(\"Outlook.Application\")\n</code></pre>\n\n<p>Do not use On Error Resume Next until you know what you are doing.</p>\n"}], "owner": {"reputation": 1, "user_id": 5843822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89cfd6f335f83e23dbe48e2ff037617e?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Rivera", "link": "https://stackoverflow.com/users/5843822/frank-rivera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1678, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453863046, "creation_date": 1453846363, "question_id": 35025059, "link": "https://stackoverflow.com/questions/35025059/save-attachments-from-outlook-with-receivedtime-on-file-name", "title": "Save Attachments from Outlook with ReceivedTime on file name", "body": "<p>I'm trying to create a macro where I can save the attachments from an email. The problem I'm currently having is that I want the macro to add the ReceivedTime of the email on the file name it saves (i.e.: File TESTSHEET.xls was received on 2016-01-01 3:02AM. I want the saved file to show 201601010302AM-TESTSHEET.xls or something similar)</p>\n\n<p>Here's my current code:</p>\n\n<pre><code>Public itm As Object\n\nPublic Sub saveAttachtoDisk()\n    Dim objAtt As Outlook.Attachment\n    Dim saveFolder As String\n        saveFolder = \"C:\\Users\\Username\\Documents\\TEST REPORTS\"\n        For Each objAtt In itm.Attachments\n        objAtt.SaveAsFile objAtt.DisplayName\n    Next objAtt\nEnd Sub\n\nPublic Sub SaveAttachments()\nDim objOL As Outlook.Application\nDim objMsg As Outlook.MailItem 'Object\nDim objAttachments As Outlook.Attachments\nDim objSelection As Outlook.Selection\nDim objDate As String\nDim i As Long\nDim lngCount As Long\nDim strFile As String\nDim StrDate As String\nDim strFolderpath As String\nDim strDeletedFiles As String\nSet itm = Application.CreateItem(olMailItem)\nDim CurrentMsg As Outlook.MailItem\n\n\n ' Get the path to your My Documents folder\nstrFolderpath = CreateObject(\"WScript.Shell\").SpecialFolders(16)\nOn Error Resume Next\n\n' Instantiate an Outlook Application object.\nSet objOL = CreateObject(\"Outlook.Application\")\n\n' Get the collection of selected objects.\nSet objSelection = objOL.ActiveExplorer.Selection\n\n' Set the Attachment folder.\nstrFolderpath = strFolderpath &amp; \"\\TEST REPORTS\\\"\n\n' Check each selected item for attachments. If attachments exist,\n' save them to the strFolderPath folder and strip them from the item.\nFor Each objMsg In objSelection\n\n    ' This code only strips attachments from mail items.\n    ' If objMsg.class=olMail Then\n    ' Get the Attachments collection of the item.\n    Set objAttachments = objMsg.Attachments\n    lngCount = objAttachments.Count\n    strDeletedFiles = \"\"\n\n    If lngCount &gt; 0 Then\n\n        ' We need to use a count down loop for removing items\n        ' from a collection. Otherwise, the loop counter gets\n        ' confused and only every other item is removed.\n\n        For i = lngCount To 1 Step -1\n\n            ' Save attachment before deleting from item.\n            ' Get the file name.\n            strFile = objAttachments.Item(i).FileName\n\n            ' Combine with the path to the Save folder.\n            StrDate = Format(itm.ReceivedTime, \"yyyy-mm-dd Hmm \")\n            strFile = strFolderpath &amp; StrDate &amp; strFile\n\n            ' Save the attachment as a file.\n            MsgBox strFile\n            objAttachments.Item(i).SaveAsFile strFile\n\n            ' Delete the attachment.\n            objAttachments.Item(i).Delete\n\n            'write the save as path to a string to add to the message\n            'check for html and use html tags in link\n            If objMsg.BodyFormat &lt;&gt; olFormatHTML Then\n                strDeletedFiles = strDeletedFiles &amp; vbCrLf &amp; \"&lt;file://\" &amp; strFile &amp; \"&gt;\"\n            Else\n                strDeletedFiles = strDeletedFiles &amp; \"&lt;br&gt;\" &amp; \"&lt;a href='file://\" &amp; _\n                strFile &amp; \"'&gt;\" &amp; strFile &amp; \"&lt;/a&gt;\"\n            End If\n\n            'Use the MsgBox command to troubleshoot. Remove it from the final code.\n            'MsgBox strDeletedFiles\n\n        Next i\n\n        ' Adds the filename string to the message body and save it\n        ' Check for HTML body\n        If objMsg.BodyFormat &lt;&gt; olFormatHTML Then\n            objMsg.Body = vbCrLf &amp; \"The file(s) were saved to \" &amp; strDeletedFiles &amp; vbCrLf &amp; objMsg.Body\n        Else\n            objMsg.HTMLBody = \"&lt;p&gt;\" &amp; \"The file(s) were saved to \" &amp; strDeletedFiles &amp; \"&lt;/p&gt;\" &amp; objMsg.HTMLBody\n        End If\n        objMsg.Save\n    End If\nNext\n\nExitSub:\n\nSet objAttachments = Nothing\nSet objMsg = Nothing\nSet objSelection = Nothing\nSet objOL = Nothing\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance for your help!!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1453877384, "post_id": 35025056, "comment_id": 57786810, "body": "Hi there, welcome to StackOverflow. Just to be clear, you want four Columns to be added after every forth column? Then you want to be able to do the same for every 5th, 6th and 7th Columns?"}], "answers": [{"tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": false, "score": 0, "last_activity_date": 1453895669, "creation_date": 1453895669, "answer_id": 35036684, "question_id": 35025056, "link": "https://stackoverflow.com/questions/35025056/excel-inserting-function-columns-utilizing-a-macro/35036684#35036684", "title": "Excel Inserting Function Columns Utilizing a Macro", "body": "<p>The code below will insert 3 <code>Columns</code> after every fourth Column, the first column will be added into the sixth Column and then from there after every four columns there will be three columns inserted.</p>\n\n<p>The data from the last two columns in the set of four columns will be pasted into the fist two columns of the new columns.</p>\n\n<p>Two things to remember. You always want to use direct referencing to <code>WorkBooks</code> <code>WorkSheets</code> to avoid confusion in the program when multiple <code>WorkBooks</code> and <code>WorkSheets</code> are available.</p>\n\n<pre><code> Option Explicit\n\n Sub InsertingColumns()\n\n      'Always want to directly reference the WorkBook and WorkSheet which contains your data\n      'Change Book1 and Sheet1 as per your requirement\n      Dim CurrentWorkSheet As Worksheet\n      Set CurrentWorkSheet = Workbooks(\"Book1\").Worksheets(\"Sheet1\")\n\n      Dim LastColumn As Long\n      LastColumn = CurrentWorkSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n\n      'Step 7 to cater for the every forth Column plus the 7 columns being added\n      'Started at 6 because \"After every four columns\" means the fith Column and catering for the Cal Day in Column 1\n      Dim CurrentColumn As Long\n      For CurrentColumn = 6 To LastColumn Step 7\n\n           'Current Column to CurrentColumn + 2 will have 3 Cells selected\n           CurrentWorkSheet.Range(Cells(1, CurrentColumn), Cells(1, CurrentColumn + 2)).Insert Shift:=xlToRight\n\n           'Copy Data from the second column from the right and paste into the first new column\n           CurrentWorkSheet.Columns(CurrentColumn - 2).Copy\n           CurrentWorkSheet.Columns(CurrentColumn).PasteSpecial Paste:=xlPasteValues\n\n           'Copy Data from the first column from the right and paste into the second new column\n           CurrentWorkSheet.Columns(CurrentColumn - 1).Copy\n           CurrentWorkSheet.Columns(CurrentColumn + 1).PasteSpecial Paste:=xlPasteValues\n\n\n      Next CurrentColumn\n\n End Sub\n</code></pre>\n\n<p>See BEFORE and AFTER Below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VMJLg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VMJLg.png\" alt=\"enter image description here\"></a></p>\n\n<p>For the 5, 6 and 7 inserts you can then just edit this four insert loop to cater for the others.</p>\n"}], "owner": {"reputation": 13, "user_id": 5249311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9df08f471b11f2e6f4519e4be1f3ab4?s=128&d=identicon&r=PG&f=1", "display_name": "Adorn", "link": "https://stackoverflow.com/users/5249311/adorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454284917, "creation_date": 1453846348, "last_edit_date": 1454284917, "question_id": 35025056, "link": "https://stackoverflow.com/questions/35025056/excel-inserting-function-columns-utilizing-a-macro", "title": "Excel Inserting Function Columns Utilizing a Macro", "body": "<p>I would like is a macro that after every 4 rows it inserts a function column which for row 3 down will include a function and rows 1 &amp; 2 would be identical to the previous one and row 3 would say Planned orders. </p>\n\n<p>I would like to add this identical macro to create every 5 after this one, then one for every 6 and one for every 7. </p>\n\n<p>It can be 4 macros I just have to click in the right order not anything to fancy. </p>\n\n<p>I created the macro below which inserts a row every 4th column, but I have to move the table over three columns to begin with and it doesn't generate the last column. How could I get the functions I want added to this column?</p>\n\n<pre><code>Sub insert_column_after_interval_4()\n\n  Dim iLastCol As Integer\n\n  iLastCol = Cells(1, Columns.Count).End(xlToLeft).Column ' same as CTRL+RIGHT ARROW\n\n  For colx = 5 To iLastCol Step 5\n\n     Columns(colx).Insert Shift:=xlToRight\n\n  Next\n\nEnd Sub\n</code></pre>\n\n<p>Picture included for how the table currently looks, the end result would be just 4 additional formula columns after that and after every subsequent 4 columns in the spreadsheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/6E0jO.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6E0jO.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 1, "creation_date": 1453847414, "post_id": 35024869, "comment_id": 57777235, "body": "What have you tried so far, keep in mind SO is not a coding service, also you might just use a <code>=COUNTIF</code> formula in column L"}], "answers": [{"tags": [], "owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "is_accepted": false, "score": 1, "last_activity_date": 1453847831, "last_edit_date": 1453847831, "creation_date": 1453847463, "answer_id": 35025302, "question_id": 35024869, "link": "https://stackoverflow.com/questions/35024869/vba-nested-loops-in-tabular-data/35025302#35025302", "title": "VBA Nested loops in tabular data", "body": "<p>I dont really understand your ultimate goal however i hope the code below will help you to go to the right direction. </p>\n\n<p>As far as i understand i wrote a code that COUNT how many cells for each row where there s data.</p>\n\n<p>I am not really sure if it is what you want but let me know and i will edit my code to your requirement.</p>\n\n<p>Option Explicit</p>\n\n<pre><code>Sub test()\n\nDim wb As Workbook\nDim ws As Worksheet\nDim Lastrow As Long\nDim i As Long, j As Long, c As Long\n\nSet wb = ThisWorkbook\nSet ws = wb.Sheets(\"Sheet1\") '  Change the name of your worksheet\n\nLastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row ' Find the las row\n\nWith ws\n\n        For i = 1 To Lastrow 'Start at row 1 until the last row\n\n            c = 0\n\n                For j = 2 To 11 ' 10 Variables (until the column \"L\")\n                        If Not IsEmpty(.Cells(i, j)) Then c = c + 1  ' Count and record the number of populated data points in each columns\n                Next j\n\n            .Cells(i, 12).Value = c 'Past the result in column \"L\"\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5843792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84b2225011370977989a1281fc0447c8?s=128&d=identicon&r=PG&f=1", "display_name": "hlbau", "link": "https://stackoverflow.com/users/5843792/hlbau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455889285, "creation_date": 1453845645, "last_edit_date": 1455889285, "question_id": 35024869, "link": "https://stackoverflow.com/questions/35024869/vba-nested-loops-in-tabular-data", "title": "VBA Nested loops in tabular data", "body": "<p>I've had a pretty thorough search but I'm still struggling with this problem. Essentially, I have a list of various titles, each of which has 10 variables corresponding, which may or may not have data points.</p>\n\n<p><img src=\"https://i.stack.imgur.com/iv5p2.png\" alt=\"Table\"></p>\n\n<p>I'd like to loop through the first column, with a nested loop going through each row to count and record the number of populated data points in each. Mostly I'm not sure how to reference cells in the second loop. Any help would be greatly appreciated!</p>\n"}, {"tags": ["regex", "vba"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1453846313, "post_id": 35024856, "comment_id": 57776662, "body": "Try this regex: <a href=\"https://regex101.com/r/fS7yR4/1\" rel=\"nofollow noreferrer\"><code>(?:\\.\\s+(?=[A-Z]))([^;]+(?:,\\s+p\\.\\s+\\d+(?:\\-\\d+)?))</code></a>. The value you need is inside submatches. If it works, I will post with code."}, {"owner": {"reputation": 57, "user_id": 1583016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2ce76e55e3e5a8aec251e8acbe651e?s=128&d=identicon&r=PG", "display_name": "user1583016", "link": "https://stackoverflow.com/users/1583016/user1583016"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1453846919, "post_id": 35024856, "comment_id": 57776984, "body": "That works! Thank you! In your answer would you mind walking me through how it works or linking to relevant explanations to <a href=\"http://www.regular-expressions.info/\" rel=\"nofollow noreferrer\">regular-expressions.info</a> as this was just a simplified example and I need to fit these changes into a much larger more complex regular expression that handles other cases."}, {"owner": {"reputation": 57, "user_id": 1583016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2ce76e55e3e5a8aec251e8acbe651e?s=128&d=identicon&r=PG", "display_name": "user1583016", "link": "https://stackoverflow.com/users/1583016/user1583016"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1453847105, "post_id": 35024856, "comment_id": 57777076, "body": "On second thought, the link you provided does walk me through most of it."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 1583016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2ce76e55e3e5a8aec251e8acbe651e?s=128&d=identicon&r=PG", "display_name": "user1583016", "link": "https://stackoverflow.com/users/1583016/user1583016"}, "edited": false, "score": 0, "creation_date": 1453853664, "post_id": 35025412, "comment_id": 57779471, "body": "After trying this on my actual text I&#39;ve noticed that it doesn&#39;t work when there are <a href=\"https://regex101.com/r/vT5gP9/1\" rel=\"nofollow noreferrer\">two citations</a>. How can I get this to be match 1 = &quot;Bookwriter, Johnny J., Book Title, 50th Edition, Publishing Company, United States, 2016, p. 18&quot; and match 2 = &quot;Another, Person I., Another Title, 20th Edition, Publishing Company, US, 2016, pp. 19-20&quot;)."}, {"owner": {"reputation": 57, "user_id": 1583016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2ce76e55e3e5a8aec251e8acbe651e?s=128&d=identicon&r=PG", "display_name": "user1583016", "link": "https://stackoverflow.com/users/1583016/user1583016"}, "edited": false, "score": 0, "creation_date": 1453854494, "post_id": 35025412, "comment_id": 57779747, "body": "I was actually able to solve that one on my own with <a href=\"https://regex101.com/r/fS7yR4/2\" rel=\"nofollow noreferrer\">this</a> in case anyone has the same issue."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 57, "user_id": 1583016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2ce76e55e3e5a8aec251e8acbe651e?s=128&d=identicon&r=PG", "display_name": "user1583016", "link": "https://stackoverflow.com/users/1583016/user1583016"}, "edited": false, "score": 0, "creation_date": 1453877424, "post_id": 35025412, "comment_id": 57786838, "body": "The Global RegExp property should be set to True to be able to find several matches. HHowever, this option works when you intend to get fully nonoverlapping matches (those that do not start with the same letter) abd for greedy dot matching patterns. Your regex should work fine since it is  based on a negated character class."}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 1, "last_activity_date": 1453847894, "creation_date": 1453847894, "answer_id": 35025412, "question_id": 35024856, "link": "https://stackoverflow.com/questions/35024856/vba-regular-expression-using-lookahead/35025412#35025412", "title": "VBA regular expression using lookahead", "body": "<p>Here is a sample VBA sub that can get what you need:</p>\n\n<pre><code>Sub Test1()\nDim str As String\nDim objMatches As Object\nstr = \"First there is a sentence or two, then a citation which I'd like to extract. Bookwriter, Johnny J., Book Title, 50th Edition, Publishing Company, United States, 2016, p. 18.\"\nSet objRegExp = CreateObject(\"VBScript.RegExp\") ' Declare the RegExp object\nobjRegExp.Pattern = \"(?:\\.\\s+(?=[A-Z]))([^;]+(?:,\\s+p\\.\\s+\\d+(?:-\\d+)?))\" ' Set pattern\nSet objMatches = objRegExp.Execute(str)  ' Execute the regex match\nIf objMatches.Count &lt;&gt; 0 Then            ' Check if there are any items in the result\n  Debug.Print objMatches.Item(0).SubMatches.Item(0) ' Print Match 1, Submatch 1\n  ' &gt; Bookwriter, Johnny J., Book Title, 50th Edition, Publishing Company, United States, 2016, p. 18\nEnd If\nEnd Sub\n</code></pre>\n\n<p>The pattern is</p>\n\n<pre><code>(?:\\.\\s+(?=[A-Z]))([^;]+(?:,\\s+p\\.\\s+\\d+(?:-\\d+)?))\n</code></pre>\n\n<p>See <a href=\"https://regex101.com/r/fS7yR4/1\" rel=\"nofollow\">demo</a></p>\n\n<p>The main addition to yours is the leading <code>(?:\\.\\s+(?=[A-Z]))</code> subpattern. It matches a <code>.</code> followed by one or more whitespaces (<code>\\s+</code>) that are followed by an uppercase letter (that is NOT <em>consumed</em>, but just <em>checked</em> inside a positive lookahead <code>(?=[A-Z])</code>). I also merged <code>(\\d+\\-\\d+|\\d+)</code> into <code>\\d+(?:-\\d+)?</code>.</p>\n"}], "owner": {"reputation": 57, "user_id": 1583016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2ce76e55e3e5a8aec251e8acbe651e?s=128&d=identicon&r=PG", "display_name": "user1583016", "link": "https://stackoverflow.com/users/1583016/user1583016"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1580, "favorite_count": 0, "accepted_answer_id": 35025412, "answer_count": 1, "score": 1, "last_activity_date": 1453847894, "creation_date": 1453845603, "last_edit_date": 1495540346, "question_id": 35024856, "link": "https://stackoverflow.com/questions/35024856/vba-regular-expression-using-lookahead", "title": "VBA regular expression using lookahead", "body": "<p>Given a string like the following:</p>\n\n<blockquote>\n  <p>\"First there is a sentence or two, then a citation which I'd like to\n  extract. Bookwriter, Johnny J., <em>Book Title</em>, 50th Edition, Publishing\n  Company, United States, 2016, p. 18.\"</p>\n</blockquote>\n\n<p>Using this regular expression:<code>\"\\b[^\\.\\;]+(,\\s+p+\\.\\s+(\\d+\\-\\d+|\\d+))\"</code></p>\n\n<p>I'm able to match this portion of the string:</p>\n\n<blockquote>\n  <p>\"<em>Book Title</em>, 50th Edition, Publishing Company, United States, 2016,\n  p. 18\"</p>\n</blockquote>\n\n<p>My desired match is:</p>\n\n<blockquote>\n  <p>\"Bookwriter, Johnny J., <em>Book Title</em>, 50th Edition, Publishing\n  Company, United States, 2016, p. 18\"</p>\n</blockquote>\n\n<p>To oversimplify it a bit, the current regex finds strings between a period and a page reference like \", p. 18\" that doesn't have a semicolon or period in it.</p>\n\n<p>I'd like to adjust this such that the regex permits a period to occur if it is preceded by a space and a capital letter. I'm aware that <a href=\"https://stackoverflow.com/questions/9150552/lookbehind-on-regex-for-vba\">vba doesn't have lookbehind functionality</a>.</p>\n\n<p>The VBA code to run the example I've given is as follows:</p>\n\n<pre><code>Dim exampleString As String\nexampleString = \"First there is a sentence or two, then a citation which I'd like to extract. Bookwriter, Johnny J., Book Title, 50th Edition, Publishing Company, United States, 2016, p. 18.\"\nSet re = CreateObject(\"vbscript.regexp\")\nWith re\n    .Global = True\n    .pattern = \"\\b[^\\.\\;]+(,\\s+p\\.\\s(\\d+\\-\\d+|\\d+))\"\n    Set matches = .Execute(exampleString)\nEnd With\n</code></pre>\n"}, {"tags": ["javascript", "vba", "input"], "comments": [{"owner": {"reputation": 442, "user_id": 5773951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ab4118ae0aebf82f87404d8315e47eb?s=128&d=identicon&r=PG&f=1", "display_name": "dnep", "link": "https://stackoverflow.com/users/5773951/dnep"}, "edited": false, "score": 0, "creation_date": 1453898227, "post_id": 35024809, "comment_id": 57799528, "body": "What are the tagname and type of <code>ReportParameterPicker1_rp_StartDate_picker</code>? Could you include the corresponding fragment from the page source?"}, {"owner": {"reputation": 19, "user_id": 5692405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67fc814a56d3e2c9a84362cdd3ad2adc?s=128&d=identicon&r=PG&f=1", "display_name": "Jules Hill", "link": "https://stackoverflow.com/users/5692405/jules-hill"}, "reply_to_user": {"reputation": 442, "user_id": 5773951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ab4118ae0aebf82f87404d8315e47eb?s=128&d=identicon&r=PG&f=1", "display_name": "dnep", "link": "https://stackoverflow.com/users/5773951/dnep"}, "edited": false, "score": 0, "creation_date": 1453905252, "post_id": 35024809, "comment_id": 57804635, "body": "Sorry, there was supposed to be a screenshot: <a href=\"https://gyazo.com/4a74664e00b10f97f8e0c0009cfdcfc3\" rel=\"nofollow noreferrer\">gyazo.com/4a74664e00b10f97f8e0c0009cfdcfc3</a>"}, {"owner": {"reputation": 19, "user_id": 5692405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67fc814a56d3e2c9a84362cdd3ad2adc?s=128&d=identicon&r=PG&f=1", "display_name": "Jules Hill", "link": "https://stackoverflow.com/users/5692405/jules-hill"}, "reply_to_user": {"reputation": 442, "user_id": 5773951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ab4118ae0aebf82f87404d8315e47eb?s=128&d=identicon&r=PG&f=1", "display_name": "dnep", "link": "https://stackoverflow.com/users/5773951/dnep"}, "edited": false, "score": 0, "creation_date": 1453905337, "post_id": 35024809, "comment_id": 57804691, "body": "Also, I realize there&#39;s a typo, I added an &quot;s&quot; in &quot;getElementsById&quot;.  I correct it, but still doesn&#39;t work."}], "owner": {"reputation": 19, "user_id": 5692405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67fc814a56d3e2c9a84362cdd3ad2adc?s=128&d=identicon&r=PG&f=1", "display_name": "Jules Hill", "link": "https://stackoverflow.com/users/5692405/jules-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1453845444, "creation_date": 1453845444, "question_id": 35024809, "link": "https://stackoverflow.com/questions/35024809/using-vba-to-enter-data-into-website-text-javascript-field", "title": "Using VBA to enter data into website text/javascript field", "body": "<p>I'm trying to automate the running of a report. So far, I'm able to navigate to the report page and login, but I am stuck on how to enter data into the form to create the parameters of the report (other than by using SendKeys, which seems ineffective)</p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>Dim HTMLDoc As HTMLDocument\nDim MyBrowser As InternetExplorer\n\nSub Login2()\n\nDim MyHTML_Element As IHTMLElement\nDim MyURL As String\n\nMyURL = \"https://mc.s7.exacttarget.com/cloud/#app/Email/Content/Tracking/SubscriberReports/AsyncReportCreate.aspx?r=/ExactTarget/Tracking Reports/Recent Email Sending Summary&amp;HistoryNodeID=REPORT_HISTORY\"\nMyUsername = \"*************\"\nMyPassword = \"*************\"\n\nSet MyBrowser = New InternetExplorer\nMyBrowser.Silent = True\nMyBrowser.Top = 0\nMyBrowser.Left = 0\nMyBrowser.AddressBar = 0\nMyBrowser.StatusBar = 0\nMyBrowser.Toolbar = 0\nMyBrowser.Visible = True\n\nMyBrowser.Navigate MyURL\n\nDo\nLoop Until MyBrowser.ReadyState = 4\n\nSet HTMLDoc = MyBrowser.document\nHTMLDoc.all.UserName.Value = MyUsername\nHTMLDoc.all.Password.Value = MyPassword\n\nFor Each MyHTML_Element In HTMLDoc.getElementsByTagName(\"input\")\nIf MyHTML_Element.Type = \"submit\" Then MyHTML_Element.Click: Exit For\nNext\n\nDo\nLoop Until MyBrowser.ReadyState = 4\n\nHTMLDoc.getElementsById(\"ReportParameterPicker1_rp_StartDate_picker\").Value = \"2014.01.01.0.0.0\"\n\n\nEnd Sub\n</code></pre>\n\n<p>I get the Run-time error '438: Object doesn't support this property of method.</p>\n\n<p>Screenshot of the report form:\n[url]<a href=\"https://gyazo.com/db1a5e7d74bc836e771b7915d33f5abd[/url]\" rel=\"nofollow\">https://gyazo.com/db1a5e7d74bc836e771b7915d33f5abd[/url]</a></p>\n\n<p>Ideally, I'd like to scroll through the form, filling out input areas with data populated on my Excel sheet.</p>\n\n<p>Another issue I faced when trying to do this, is the program trying to take actions before the webpage had loaded fully, even though I have the \"ReadyState\" part in there. </p>\n\n<p>Any help would be greatly appreciated! </p>\n\n<p>Thanks!</p>\n"}]