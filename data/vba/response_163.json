[{"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1519258315, "post_id": 48917418, "comment_id": 84841671, "body": "Although inefficient, this would have worked if the numbers were in ascending order rather than descending."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1519258424, "post_id": 48917418, "comment_id": 84841696, "body": "@Jeeped, well some \u2018GRADELETTER_PM = X\u2019 would still be missing"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1519258539, "post_id": 48917418, "comment_id": 84841723, "body": "@DisplayName - Granted that but it isn&#39;t clear what is done with the globally public X in any event."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9393657, "user_type": "registered", "profile_image": "https://graph.facebook.com/2004971339762460/picture?type=large", "display_name": "Brandon Myers", "link": "https://stackoverflow.com/users/9393657/brandon-myers"}, "edited": false, "score": 0, "creation_date": 1519258163, "post_id": 48917540, "comment_id": 84841629, "body": "Your code still spits out a value error... I am unfamiliar with Case is and what that does."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 1, "user_id": 9393657, "user_type": "registered", "profile_image": "https://graph.facebook.com/2004971339762460/picture?type=large", "display_name": "Brandon Myers", "link": "https://stackoverflow.com/users/9393657/brandon-myers"}, "edited": false, "score": 0, "creation_date": 1519258194, "post_id": 48917540, "comment_id": 84841633, "body": "@BrandonMyers How are you using it?"}, {"owner": {"reputation": 1, "user_id": 9393657, "user_type": "registered", "profile_image": "https://graph.facebook.com/2004971339762460/picture?type=large", "display_name": "Brandon Myers", "link": "https://stackoverflow.com/users/9393657/brandon-myers"}, "edited": false, "score": 0, "creation_date": 1519258399, "post_id": 48917540, "comment_id": 84841690, "body": "<a href=\"https://imgur.com/a/PEdxk\" rel=\"nofollow noreferrer\">imgur.com/a/PEdxk</a> is where I&#39;m trying to use it and <a href=\"https://imgur.com/a/oitdl\" rel=\"nofollow noreferrer\">imgur.com/a/oitdl</a> is the new code that&#39;s not working still."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 1, "user_id": 9393657, "user_type": "registered", "profile_image": "https://graph.facebook.com/2004971339762460/picture?type=large", "display_name": "Brandon Myers", "link": "https://stackoverflow.com/users/9393657/brandon-myers"}, "edited": false, "score": 1, "creation_date": 1519258628, "post_id": 48917540, "comment_id": 84841745, "body": "@BrandonMyers You have defined the function within the <code>Sheet1</code> module, and so the scope of the function will be limited to this worksheet. If you want the function to be available throughout the workbook, you should insert a module in which the code should reside."}, {"owner": {"reputation": 1, "user_id": 9393657, "user_type": "registered", "profile_image": "https://graph.facebook.com/2004971339762460/picture?type=large", "display_name": "Brandon Myers", "link": "https://stackoverflow.com/users/9393657/brandon-myers"}, "edited": false, "score": 0, "creation_date": 1519260003, "post_id": 48917540, "comment_id": 84842104, "body": "The code is working. So let me try to break what I got so far. The GRADELETTER_PM = part assigns the output. The Case subsitutes the actual varialble. But what is the ByVal part?"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 1, "user_id": 9393657, "user_type": "registered", "profile_image": "https://graph.facebook.com/2004971339762460/picture?type=large", "display_name": "Brandon Myers", "link": "https://stackoverflow.com/users/9393657/brandon-myers"}, "edited": false, "score": 0, "creation_date": 1519260080, "post_id": 48917540, "comment_id": 84842127, "body": "Please consult Google first."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 1, "last_activity_date": 1519259651, "last_edit_date": 1519259651, "creation_date": 1519257742, "answer_id": 48917540, "question_id": 48917418, "link": "https://stackoverflow.com/questions/48917418/vba-value-error-in/48917540#48917540", "title": "VBA #Value Error in", "body": "<p>I would suggest using a <code>Select Case</code> statement, for example:</p>\n\n<pre><code>Function GRADELETTER_PM(ByVal Num_Grade As Double) As String\n    Select Case Num_Grade\n        Case Is &gt;= 0.93: GRADELETTER_PM = \"A\"\n        Case Is &gt;= 0.9:  GRADELETTER_PM = \"A-\"\n        Case Is &gt;= 0.88: GRADELETTER_PM = \"B+\"\n        Case Is &gt;= 0.83: GRADELETTER_PM = \"B\"\n        Case Is &gt;= 0.8:  GRADELETTER_PM = \"B-\"\n        Case Is &gt;= 0.78: GRADELETTER_PM = \"C+\"\n        Case Is &gt;= 0.73: GRADELETTER_PM = \"C\"\n        Case Is &gt;= 0.7:  GRADELETTER_PM = \"C-\"\n        Case Is &gt;= 0.67: GRADELETTER_PM = \"D+\"\n        Case Is &gt;= 0.6:  GRADELETTER_PM = \"D\"\n        Case Else:       GRADELETTER_PM = \"F\"\n    End Select\n End Function\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/select-case-statement\" rel=\"nofollow noreferrer\">Here</a> is a reference.</p>\n"}], "owner": {"reputation": 1, "user_id": 9393657, "user_type": "registered", "profile_image": "https://graph.facebook.com/2004971339762460/picture?type=large", "display_name": "Brandon Myers", "link": "https://stackoverflow.com/users/9393657/brandon-myers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519260073, "creation_date": 1519256915, "last_edit_date": 1519257747, "question_id": 48917418, "link": "https://stackoverflow.com/questions/48917418/vba-value-error-in", "title": "VBA #Value Error in", "body": "<p>I'm having a bit of a headache when it comes to VBA. I had tried to search online for an answer but to no luck. I have learned Python, but VBA is a different ballpark.</p>\n\n<pre><code>Dim X As String\n\nFunction GRADELETTER_PM(Num_Grade As Double)\nX = \"A\"\nIf Num_Grade &gt;= 0.93 Then 'finds corresponding letter to a grade'\n    X = \"A\"\n    MsgBox X\n\nEnd If\nIf Num_Grade &gt;= 0.9 Then\n    X = \"A-\"\n\nEnd If\nIf Num_Grade &gt;= 0.88 Then\n    X = \"B+\"\n\nEnd If\nIf Num_Grade &gt;= 0.83 Then\n    X = \"B\"\n\nEnd If\nIf Num_Grade &gt;= 0.8 Then\n    X = \"B-\"\n\nEnd If\nIf Num_Grade &gt;= 0.78 Then\n   X = \"C+\"\n\nEnd If\nIf Num_Grade &gt;= 0.73 Then\n    X = \"C\"\n\nEnd If\nIf Num_Grade &gt;= 0.7 Then\nX = \"C-\"\n\nEnd If\nIf Num_Grade &gt;= 0.67 Then\n    X = \"D+\"\n\nEnd If\nIf Num_Grade &gt;= 0.6 Then\n    X = \"D\"\n\nEnd If\nIf Num_Grade &lt; 0.6 Then\n\n    X = \"F\"\n\nEnd If\n End Function\n</code></pre>\n\n<p>The program is supposed to calculate a grade to its letter. IE a 93% (input) is an <code>\"A\"</code> (Output) while a 64% is a <code>\"D\"</code>. The only input is the grade. The sheet itself has multiple tables that do not aline themselves perfectly (ie, not the same Col x Row) and the formula will be used 40+ times on that one sheet when it works. Thanks in advance.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 9393614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d780befd203abea617d8b5216e11eac?s=128&d=identicon&r=PG&f=1", "display_name": "liamthequietman", "link": "https://stackoverflow.com/users/9393614/liamthequietman"}, "edited": false, "score": 0, "creation_date": 1519256007, "post_id": 48917254, "comment_id": 84841033, "body": "Pardon the messy message! My first post!"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1519257386, "post_id": 48917254, "comment_id": 84841421, "body": "It may be clearer to use <code>Select Case</code> in place of a chain of <code>If``ElseIf</code> statements. I don&#39;t understand why you need 10 separate functions? If each function will use different logic then we don&#39;t have enough information; if each function is to use the same logic, then you can just use the one function you have already."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1519259139, "post_id": 48917254, "comment_id": 84841886, "body": "Edit your original question rather than using the comments section to provide additional information."}], "answers": [{"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1519258926, "creation_date": 1519258926, "answer_id": 48917702, "question_id": 48917254, "link": "https://stackoverflow.com/questions/48917254/vba-calculated-field-for-multiple-fields-in-a-query/48917702#48917702", "title": "VBA calculated field for multiple fields in a query", "body": "<p>Since you have stated that the logic is to be the same for all fields, simply pass each of your fields to the function.</p>\n\n<p>As noted in my comments, I would first suggest using a <code>Select Case</code> statement:</p>\n\n<pre><code>Function UpdateSURF(ByVal mySURF As Integer) As String\n    Select Case mySURF\n        Case 1: UpdateSURF = \"D\"\n        Case 2: UpdateSURF = \"T\"\n        Case 3: UpdateSURF = \"W\"\n        Case 4: UpdateSURF = \"A\"\n        Case Else: UpdateSURF = \"x\"\n    End Select\nEnd Function\n</code></pre>\n\n<p>This may then be evaluated for any of your fields using expressions such as:</p>\n\n<pre><code>UpdateSURF([nPP1SURF])\nUpdateSURF([nPP2SURF])\n...\nUpdateSURF([nPP0SURF])\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9393614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d780befd203abea617d8b5216e11eac?s=128&d=identicon&r=PG&f=1", "display_name": "liamthequietman", "link": "https://stackoverflow.com/users/9393614/liamthequietman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594637314, "creation_date": 1519255860, "last_edit_date": 1594637314, "question_id": 48917254, "link": "https://stackoverflow.com/questions/48917254/vba-calculated-field-for-multiple-fields-in-a-query", "title": "VBA calculated field for multiple fields in a query", "body": "<p>I have no experience writing VBA code but I can follow the logic. </p>\n\n<p>Thank you for everyone's help in advance!</p>\n\n<p>I found a VBA code that calculates a single field in a query (see pic). Because I have 10 fields I would need to create 10 separate functions: <code>nPP1SURF</code>, <code>nPP2SURF</code>, <code>nPP3SURF</code> ... ending with <code>nPP0SURF</code>.</p>\n\n<p>Can I accomplish this with a single function?</p>\n\n<pre><code>Public Function UpdatePP1SURF(ByVal nPP1SURF As Integer) As String\n\n    If nPP1SURF = 1 Then\n        UpdatePP1SURF = \"D\"\n    ElseIf nPP1SURF = 2 Then\n        UpdatePP1SURF = \"T\"\n    ElseIf nPP1SURF = 3 Then\n        UpdatePP1SURF = \"W\"\n    ElseIf nPP1SURF = 4 Then\n        UpdatePP1SURF = \"A\"\n    Else\n        UpdatePP1SURF = \"x\"\n    End If\n\n    'Expr1: UpdatePP1SURF([nPP1SURF])\n\nEnd Function\n</code></pre>\n\n<p>The logic for all 10 fields is the same.The vba functions I've seen that can accomplish what I want has the word \"array\" in it.</p>\n\n<p>BRILLIANT! Works great Lee Mac!!</p>\n\n<p>My concern is my other calculated fields are much more complex. Is my original function better suited to handle these IIf statements? For example:</p>\n\n<p>IIf([xPSHF2] Between ([xPSHF_TOP]+1.1) And [xPSHF2]&lt;([xPSHF_TOP]+10),\"OR\",\"x\")</p>\n\n<p>I greatly appreciate your help Lee Mac!!</p>\n\n<p>I Googled \"access select case statement\" and I'll begin learning more about this type of coding. I see there is a IF-THEN-ELSE statement.</p>\n\n<p>Cheers!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1519254953, "post_id": 48917088, "comment_id": 84840667, "body": "So you explained what you are trying to do, but can you let us know what&#39;s not working? Are you receiving errors? Do you have an unexpected result?"}, {"owner": {"reputation": 35, "user_id": 5991922, "user_type": "registered", "profile_image": "https://graph.facebook.com/1127734540569917/picture?type=large", "display_name": "Andy Moore", "link": "https://stackoverflow.com/users/5991922/andy-moore"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1519255033, "post_id": 48917088, "comment_id": 84840703, "body": "I apologize! I\u2019m actually getting no results from the code. Nothing showing up on the sheet at all."}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1519257429, "last_edit_date": 1519257429, "creation_date": 1519257062, "answer_id": 48917439, "question_id": 48917088, "link": "https://stackoverflow.com/questions/48917088/vba-copy-column-range-values-to-specific-sheet-remove-duplicates/48917439#48917439", "title": "VBA - Copy column range values to specific sheet, remove duplicates", "body": "<p>You can try out this function I have stowed away in my personal Macro workbook:</p>\n\n<pre><code>Function rngToUniqueArr(ByVal rng As Range) As Variant\n\n    'Reference to [Microsoft Scripting Runtime] Required\n    Dim dict As New Scripting.Dictionary, cel As Range\n    For Each cel In rng.Cells\n        dict(cel.Value) = 1\n    Next cel\n    rngToUniqueArr = dict.Keys\n\nEnd Function\n</code></pre>\n\n<blockquote>\n  <p>Notice: You will need to create a reference to the <strong>Microsoft Scripting Runtime Library</strong></p>\n</blockquote>\n\n<p>Which you would use in conjunction with your new sub:</p>\n\n<pre><code>Sub CopyUnique()\n\n    Dim s1 As Worksheet, s2 As Worksheet\n    Set s1 = ThisWorkbook.ActiveSheet\n    Set s2 = ThisWorkbook.Worksheets(\"Products\")\n\n    Dim rngToCopy As Range, valArr() As Variant\n    Set rngToCopy = s1.UsedRange.Columns(\"A\")\n    valArr = rngToUniqueArr(rngToCopy)\n\n    ' A10 start is an example. You may start at any row by changing the below value\n    Dim copyToRng As Range\n    Set copyToRng = s2.Range(\"A10:A\" &amp; 10 + UBound(valArr))\n\n    With Application.WorksheetFunction\n        copyToRng = .Transpose(valArr)\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Essentially, with this dictionary, you are creating unique \"keys\" and outputting the result of the dictionary to an array.</p>\n\n<p>The reason you need to <code>transpose</code> this array is that it's one dimensional. A 1-D array in excel is a horizontal line, so we do this to make it vertical. You can also create a 2-D array to avoid using <code>Transpose</code>, but it's generally an easier task to do it this way.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 5991922, "user_type": "registered", "profile_image": "https://graph.facebook.com/1127734540569917/picture?type=large", "display_name": "Andy Moore", "link": "https://stackoverflow.com/users/5991922/andy-moore"}, "edited": false, "score": 0, "creation_date": 1519258578, "post_id": 48917531, "comment_id": 84841734, "body": "This worked very well, thank you very much. It copied all my formatting/cell borders and is counting those factors when removing duplicates. But this gives me an excellent opportunity to do some problem solving. Thanks!"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 35, "user_id": 5991922, "user_type": "registered", "profile_image": "https://graph.facebook.com/1127734540569917/picture?type=large", "display_name": "Andy Moore", "link": "https://stackoverflow.com/users/5991922/andy-moore"}, "edited": false, "score": 1, "creation_date": 1519258922, "post_id": 48917531, "comment_id": 84841829, "body": "You are welcome. If you wanted to paste values only you can use \u2018.Cells(.Rows.Count, 1).End(xlUp).Offset(1).Resize(30).Value = s1.Range(&quot;C4:C33&quot;).Value\u2019 instead of ,s1.Range(&quot;C4:C33&quot;).Copy .Cells(.Rows.Count, 1).End(xlUp).Offset(1)\u2018"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 2, "last_activity_date": 1519258544, "last_edit_date": 1519258544, "creation_date": 1519257690, "answer_id": 48917531, "question_id": 48917088, "link": "https://stackoverflow.com/questions/48917088/vba-copy-column-range-values-to-specific-sheet-remove-duplicates/48917531#48917531", "title": "VBA - Copy column range values to specific sheet, remove duplicates", "body": "<p>You may try this</p>\n\n<pre><code>Sub CopyUnique()\n    Dim s1 As Worksheet, FirstEmptyRow As Long, expCol As Long\n    Set s1 = ActiveSheet\n    With Sheets(\"Products\")\n        .Range(\"A:A\").Name = \"types\"\n        expCol = .Range(\"types\").Column\n        FirstEmptyRow = .Cells(.Rows.Count, expCol).End(xlUp).Row + 1\n        s1.Range(\"C4:C33\").Copy .Cells(FirstEmptyRow, expCol)\n        .Range(\"types\").RemoveDuplicates Columns:=1, Header:=xlNo\n    End With\nEnd Sub\n</code></pre>\n\n<p>But from what I can see in your code, you could reduce it to:</p>\n\n<pre><code>Sub CopyUnique()\n    Dim s1 As Worksheet\n    Set s1 = ActiveSheet\n    With Sheets(\"Products\")\n        s1.Range(\"C4:C33\").Copy .Cells(.Rows.Count, 1).End(xlUp).Offset(1)\n        Intersect(.UsedRange, .Columns(1)).RemoveDuplicates Columns:=1, Header:=xlNo\n        .Range(\"A\" &amp; .Cells(.Rows.Count, 1).End(xlUp)).Name = \"types\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5991922, "user_type": "registered", "profile_image": "https://graph.facebook.com/1127734540569917/picture?type=large", "display_name": "Andy Moore", "link": "https://stackoverflow.com/users/5991922/andy-moore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 0, "accepted_answer_id": 48917531, "answer_count": 2, "score": 0, "last_activity_date": 1519258544, "creation_date": 1519254736, "last_edit_date": 1519254898, "question_id": 48917088, "link": "https://stackoverflow.com/questions/48917088/vba-copy-column-range-values-to-specific-sheet-remove-duplicates", "title": "VBA - Copy column range values to specific sheet, remove duplicates", "body": "<p>I'm attempting to copy a specific range on an active sheet, then add those values to an existing list on a different sheet within the same workbook.</p>\n\n<p>After that is finished, I would like to remove any duplicates that have been added.</p>\n\n<pre><code>Sub CopyUnique()\n    Dim s1 As Worksheet, s2 As Worksheet, FirstEmptyRow As Long, expCol As Long\n    Set s1 = ActiveSheet\n    Set s2 = Sheets(\"Products\")\n    Range(\"A:A\").Cells.Name = \"types\"\n    expCol = Range(\"types\").Column\n    FirstEmptyRow = Cells(Rows.Count, expCol).End(xlUp).Row + 1\n    s1.Range(\"C4:C33\").Copy s2.Range(FirstEmptyRow)\n    s2.Range(\"Products\").Column.RemoveDuplicates Columns:=1, Header:=xlNo\nEnd Sub\n</code></pre>\n\n<p>I am rather new to VBA, and I may have been staring at this for too long, but I am not gaining any ground with the above code.</p>\n\n<p>Any advice is appreciated.</p>\n"}, {"tags": ["vba", "sendto"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1519256533, "post_id": 48917030, "comment_id": 84841168, "body": "There are no static arrays in VBA, they are always allocated dynamically."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1519257664, "post_id": 48917030, "comment_id": 84841504, "body": "<code>VarPtrArray(SendBuf) + 12</code> is still not correct.  Did you even READ the articles I directed you to? The <a href=\"http://bytecomb.com/vba-internals-array-variables-and-pointers-in-depth/\" rel=\"nofollow noreferrer\">Array Variables</a> article shows you exactly how to use <code>VarPtrArray()</code> correctly"}, {"owner": {"reputation": 443, "user_id": 1468850, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/ikI2b.jpg?s=128&g=1", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/1468850/anonymous"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1519258195, "post_id": 48917030, "comment_id": 84841634, "body": "I read, but I hardly understand that. I took already existing code from the web, and it did not work. You write that I need to read from offset +12, and then it appears to be wrong too. I just need a solution. And thank you for guiding me to it. Now I am able to send valid ping request."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1519258411, "post_id": 48917030, "comment_id": 84841692, "body": "&quot;<i>You write that I need to read from offset +12, and then it appears to be wrong too</i>&quot; - because you didn&#39;t do it CORRECTLY. You did not read and comprehend what the articles were explaining to you. Go back and read them again more carefully. &quot;<i>I just need a solution</i>&quot; - I gave you one. The articles even had detailed code examples, which you clearly skipped."}], "answers": [{"comments": [{"owner": {"reputation": 443, "user_id": 1468850, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/ikI2b.jpg?s=128&g=1", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/1468850/anonymous"}, "edited": false, "score": 0, "creation_date": 1519257015, "post_id": 48917351, "comment_id": 84841312, "body": "VarPtrArray: &quot;sub or function is not defined&quot;. I will greatly appreciate if you just write the lines how they must look like and explain why."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 443, "user_id": 1468850, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/ikI2b.jpg?s=128&g=1", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/1468850/anonymous"}, "edited": false, "score": 0, "creation_date": 1519257538, "post_id": 48917351, "comment_id": 84841466, "body": "Obviously, you didn&#39;t read the <a href=\"http://bytecomb.com/vba-internals-getting-pointers/\" rel=\"nofollow noreferrer\">Getting Pointers</a> article I linked to: &quot;<i>Due to VBA\u2019s syntax, there is no way to directly pass an array variable to <code>VarPtr</code>. <b>In order to get a pointer to an array variable you must declare an alternate form of <code>VarPtr</code>, traditionally aliased as <code>VarPtrArray</code></b>. Naturally you could call it anything you want.</i>&quot; And it gives you the actual declaration of <code>VarPtrArray</code>. The <a href=\"http://bytecomb.com/vba-internals-array-variables-and-pointers-in-depth/\" rel=\"nofollow noreferrer\">Array Variables</a> article then shows you how to use <code>VarPtrArray</code>"}, {"owner": {"reputation": 443, "user_id": 1468850, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/ikI2b.jpg?s=128&g=1", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/1468850/anonymous"}, "edited": false, "score": 0, "creation_date": 1519257663, "post_id": 48917351, "comment_id": 84841503, "body": "Updated the question, I still get the garbage in the packet data field."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 443, "user_id": 1468850, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/ikI2b.jpg?s=128&g=1", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/1468850/anonymous"}, "edited": false, "score": 0, "creation_date": 1519259045, "post_id": 48917351, "comment_id": 84841858, "body": "Updated my answer"}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1519258904, "last_edit_date": 1519258904, "creation_date": 1519256500, "answer_id": 48917351, "question_id": 48917030, "link": "https://stackoverflow.com/questions/48917030/sendto-sends-garbage-vba/48917351#48917351", "title": "sendto sends garbage (VBA)", "body": "<p>You are passing the wrong memory address in the <code>buf</code> parameter of <code>sendto()</code>, so it retrieves bytes from the wrong memory.  That is why you see \"garbage\" in the packet payload.</p>\n\n<p>Your use of <code>ByRef buf() as Byte</code> for the <code>buf</code> parameter of <code>sendto()</code> is all wrong.  <code>sendto()</code> expects a pointer directly to the actual bytes to be sent.  But your <code>SendBuf</code> variable is a dynamic array (it is a wrapper for a COM <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms221482.aspx\" rel=\"nofollow noreferrer\"><code>SAFEARRAY</code></a> containing a pointer to the actual bytes).  By passing <code>SendBuf</code> as-is using <code>ByRef</code>, you are actually passing <code>sendto()</code> the memory address of your <code>SendBuf</code> variable itself, not the memory address of the byte data (located elsewhere in memory) that <code>SendBuf</code> refers to.</p>\n\n<p>From <a href=\"http://bytecomb.com/vba-internals-whats-in-a-variable/\" rel=\"nofollow noreferrer\">VBA Internals: What\u2019s in a variable</a>:</p>\n\n<blockquote>\n  <p>Arrays in VBA are built from at least 3 pointers. First, calling <code>VarPtrArray()</code> on a array variable will get you the address to the variable content. If you directly read the variable content you will get another pointer \u2014 to the start of a <code>SAFEARRAY</code> struct. Finally, if you directly read from byte offset 12 (the <code>pvData</code> field) of the <code>SAFEARRAY</code>, you will get <strong>a pointer to the start of the array elements data</strong>.</p>\n</blockquote>\n\n<p>That last value (\"a pointer to the start of the array elements data\") is the memory address that you need to pass to the <code>buf</code> parameter of <code>sendto()</code>.  So, change the <code>buf</code> parameter to <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/longptr-data-type\" rel=\"nofollow noreferrer\"><code>LongPtr</code></a>, and then use a combination of <code>VarPtrArray()</code> and <code>CopyMemory()</code> to extract the pointer to the byte data from <code>SendBuf</code>'s internal <code>SAFEARRAY</code>.</p>\n\n<p>See <a href=\"http://bytecomb.com/vba-internals-getting-pointers/\" rel=\"nofollow noreferrer\">VBA Internals: Getting Pointers</a> (which provides the appropriate declaration for <code>VarPtrArray()</code> depending on your version of Office), and <a href=\"http://bytecomb.com/vba-internals-array-variables-and-pointers-in-depth/\" rel=\"nofollow noreferrer\">VBA Internals: Array Variables and Pointers in Depth</a> (which shows you how to use <code>VarPtrArray()</code> to get the internal data pointer from an array variable).</p>\n\n<p>For example:</p>\n\n<pre><code>Public Declare PtrSafe Function VarPtrArray Lib \"VBE7\" Alias \"VarPtr\" (Var() As Any) As LongPtr\n' Public Declare Function VarPtrArray Lib \"VBE6\" Alias \"VarPtr\" (Var() As Any) As Long\n...\nPrivate Declare Function sendto Lib \"Ws2_32.dll\" (ByVal socket As Long, ByVal buf As LongPtr, ByVal length As Long, ByVal flags As Long, ByRef toaddr As sockaddr_in, tolen As Long) As Long\n...\n\nDim SendBuf(0 To 1023) As Byte\nDim ptrToArrayVar As LongPtr\nDim ptrToSafeArray As LongPtr\nDim ptrToArrayData As LongPtr\nDim uSAFEARRAY As SAFEARRAY_VECTOR\n\n...\n\n' Get pointer to array *variable*\nptrToArrayVar = VarPtrArray(SendBuf)\n\n' Get the pointer to the *SAFEARRAY* by directly\n' reading the variable's address\nCopyMemory ptrToSafeArray, ByVal ptrToArrayVar, PTR_LENGTH\n\n' Read the SAFEARRAY struct\nCopyMemory uSAFEARRAY, ByVal ptrToSafeArray, LenB(uSAFEARRAY)\n\n' Get the pointer to the actual vector of bytes\nptrToArrayData = uSAFEARRAY.pvData\n\niResult = sendto(send_sock, ptrToArrayData, buf + 1, 0, RecvAddr, Len(RecvAddr))\n</code></pre>\n\n<p><strong>Update</strong>: apparently, you don't need to access the <code>SAFEARRAY</code> directly at all.  <code>VarPtr()</code> is able to get the memory address of a specific element of an array variable.  So, you can use the following instead to get the memory address of the first byte in <code>SendBuf</code> (which is effectively the same memory address that the internal <code>SAFEARRAY</code> points to):</p>\n\n<pre><code>iResult = sendto(send_sock, VarPtr(SendBuf(0)), buf + 1, 0, RecvAddr, Len(RecvAddr))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1519282101, "creation_date": 1519282101, "answer_id": 48921230, "question_id": 48917030, "link": "https://stackoverflow.com/questions/48917030/sendto-sends-garbage-vba/48921230#48921230", "title": "sendto sends garbage (VBA)", "body": "<p>The method <code>sendto</code> takes the address of the beginning of data in your buffer.</p>\n\n<p>Declare the argument with <code>ByRef buffer As Any</code>:</p>\n\n<pre><code>Private Declare PtrSafe Function sendto Lib \"Ws2_32.dll\" ( _\n    ByVal socket As Long, _\n    ByRef buffer As Any, _\n    ByVal length As Long, _\n    ByVal flags As Long, _\n    ByRef toaddr As Any, _\n    ByVal tolen As Long) As Long\n</code></pre>\n\n<p>and provide the first element by reference:</p>\n\n<pre><code>Dim buffer() As Byte, size As Long\n\nbuffer = StrConv(Message, vbFromUnicode)  ' UTF-16 2 bytes to ANSI 1 byte\nsize = UBound(buffer) + 1\n\niResult = sendto(send_sock, buffer(0), size, 0, RecvAddr, Len(RecvAddr))\n</code></pre>\n"}], "owner": {"reputation": 443, "user_id": 1468850, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/ikI2b.jpg?s=128&g=1", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/1468850/anonymous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 273, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1546557058, "creation_date": 1519254380, "last_edit_date": 1546557058, "question_id": 48917030, "link": "https://stackoverflow.com/questions/48917030/sendto-sends-garbage-vba", "title": "sendto sends garbage (VBA)", "body": "<p>I am reusing the code from <a href=\"http://forums.codeguru.com/showthread.php?524835-Send-UDP-Packets-in-VBA\" rel=\"nofollow noreferrer\">here</a> with some changes - added <em>private</em> keyword to some definitions because Excel VBA was reporting errors and changed type to IPRAW/ICMP.  </p>\n\n<p>At the end I see garbage in the wireshark <em>in the data section</em> of the packet, however data size is correct (3 bytes). I checked that sendBuf is really containing first bytes as three 'a' when sendTo is executed. What is wrong?</p>\n\n<p>Data is sent using <code>CommandButton1_Click()</code> sub at the bottom of the listing.</p>\n\n<p>Here's the code</p>\n\n<pre><code>'reference\n'http://msdn.microsoft.com/en-us/library/windows/desktop/ms740673(v=vs.85).aspx\nConst INVALID_SOCKET = -1\nConst WSADESCRIPTION_LEN = 256\n\nEnum AF\n  AF_UNSPEC = 0\n  AF_INET = 2\n  AF_IPX = 6\n  AF_APPLETALK = 16\n  AF_NETBIOS = 17\n  AF_INET6 = 23\n  AF_IRDA = 26\n  AF_BTH = 32\nEnd Enum\n\nEnum sock_type\n   SOCK_STREAM = 1\n   SOCK_DGRAM = 2\n   SOCK_RAW = 3\n   SOCK_RDM = 4\n   SOCK_SEQPACKET = 5\nEnd Enum\n\nEnum Protocol\n   IPPROTO_ICMP = 1\n   IPPROTO_IGMP = 2\n   BTHPROTO_RFCOMM = 3\n   IPPROTO_TCP = 6\n   IPPROTO_UDP = 17\n   IPPROTO_ICMPV6 = 58\n   IPPROTO_RM = 113\nEnd Enum\n\n'Type sockaddr\n'   sa_family As Integer\n'   sa_data(0 To 13) As Byte\n'End Type\n\nPrivate Type sockaddr_in\n  sin_family As Integer\n  sin_port As Integer\n  sin_addr(0 To 3) As Byte\n  sin_zero(0 To 7) As Byte\nEnd Type\n\nPrivate Type socket\n   pointer As Long\nEnd Type\n\nPrivate Type LPWSADATA_Type\n   wVersion As Integer\n   wHighVersion As Integer\n   szDescription(0 To WSADESCRIPTION_LEN) As Byte\n   szSystemStatus(0 To WSADESCRIPTION_LEN) As Byte\n   iMaxSockets As Integer\n   iMaxUdpDg As Integer\n   lpVendorInfo As Long\nEnd Type\n\nPrivate Declare Function WSAGetLastError Lib \"Ws2_32.dll\" () As Integer\nPrivate Declare Function WSAStartup Lib \"Ws2_32.dll\" (ByVal wVersionRequested As Integer, ByRef lpWSAData As LPWSADATA_Type) As Long\nPrivate Declare Function sendto Lib \"Ws2_32.dll\" (ByVal socket As Long, ByRef buf() As Byte, ByVal length As Long, ByVal flags As Long, ByRef toaddr As sockaddr_in, tolen As Long) As Long\nPrivate Declare Function f_socket Lib \"Ws2_32.dll\" Alias \"socket\" (ByVal AF As Long, ByVal stype As Long, ByVal Protocol As Long) As Long\nPrivate Declare Function closesocket Lib \"Ws2_32.dll\" (ByVal socket As Long) As Long\nPrivate Declare Sub WSACleanup Lib \"Ws2_32.dll\" ()\n\nSub SendPacket(Message As String, IP As String, Port As Integer)\n   Dim ConnectSocket As socket\n   Dim wsaData As LPWSADATA_Type\n   Dim iResult As Integer: iResult = 0\n   Dim send_sock As sock_type: send_sock = INVALID_SOCKET\n   Dim iFamily As AF: iFamily = AF_INET\n   Dim iType As Integer: iType = SOCK_RAW 'SOCK_UDP\n   Dim iProtocol As Integer: iProtocol = IPPROTO_ICMP 'IPPROTO_UDP\n   Dim SendBuf(0 To 1023) As Byte\n   Dim BufLen As Integer: BufLen = 1024\n   Dim RecvAddr As sockaddr_in: RecvAddr.sin_family = AF_INET: RecvAddr.sin_port = Port\n   Dim SplitArray As Variant: SplitArray = Split(IP, \".\")\n\n   RecvAddr.sin_addr(0) = SplitArray(0)\n   RecvAddr.sin_addr(1) = SplitArray(1)\n   RecvAddr.sin_addr(2) = SplitArray(2)\n   RecvAddr.sin_addr(3) = SplitArray(3)\n\n\n   For buf = 1 To Len(Message)\n      SendBuf(buf - 1) = Asc(Mid(Message, buf, 1))\n   Next buf\n   SendBuf(buf + 1) = 0\n\n   iResult = WSAStartup(&amp;H202, wsaData)\n   If iResult &lt;&gt; 0 Then\n      MsgBox (\"WSAStartup failed: \" &amp; iResult)\n      Exit Sub\n   End If\n\n   send_sock = f_socket(iFamily, iType, iProtocol)\n   If send_sock = INVALID_SOCKET Then\n      Errno = WSAGetLastError()\n      Exit Sub\n   End If\n\n   iResult = sendto(send_sock, SendBuf, Len(Message), 0, RecvAddr, Len(RecvAddr)) ' BufLen, 0, RecvAddr, Len(RecvAddr))\n   If iResult = -1 Then\n      MsgBox (\"sendto failed with error: \" &amp; WSAGetLastError())\n      closesocket (send_sock)\n      Call WSACleanup\n      Exit Sub\n   End If\n\n   iResult = closesocket(send_sock)\n   If iResult &lt;&gt; 0 Then\n      MsgBox (\"closesocket failed with error : \" &amp; WSAGetLastError())\n      Call WSACleanup\n   End If\nEnd Sub\n\n\nPrivate Sub CommandButton1_Click()\n    Call SendPacket(\"aaa\", \"192.168.1.55\", 1000)\nEnd Sub\n</code></pre>\n\n<p><strong>Update:</strong> As per Remy Lebeau's advice I did the following changes</p>\n\n<pre><code>Private Declare Function sendto Lib \"Ws2_32.dll\" (ByVal socket As Long, ByVal buf As LongPtr, ByVal length As Long, ByVal flags As Long, ByRef toaddr As sockaddr_in, tolen As Long) As Long\n</code></pre>\n\n<p>changing <code>ByRef buf() As Byte</code> with <code>ByVal buf As LongPtr</code>,</p>\n\n<pre><code>Private Declare PtrSafe Function VarPtrArray Lib \"VBE7\" Alias \"VarPtr\" (Var() As Any) As LongPtr\n...\niResult = sendto(send_sock, VarPtrArray(SendBuf) + 12, Len(Message), 0, RecvAddr, Len(RecvAddr))\n</code></pre>\n\n<p>changing <code>SendBuf</code> to <code>VarPtrArray(SendBuf) + 12</code>.</p>\n\n<p>but I still get the garbage.</p>\n\n<p><strong>Update 2:</strong> success:</p>\n\n<p>added</p>\n\n<pre><code>Private Declare PtrSafe Function VarPtrArray Lib \"VBE7\" Alias \"VarPtr\" (Var() As Any) As LongPtr\n</code></pre>\n\n<p>modified</p>\n\n<pre><code>iResult = sendto(send_sock, VarPtr(SendBuf(0)), Len(Message), 0, RecvAddr, Len(RecvAddr))\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy-paste", "autofilter"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1519253686, "post_id": 48916828, "comment_id": 84840218, "body": "The code you posted...are you sure it&#39;s right? <code>ws.result.Range</code>? And the lines are broken? No way to encode"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519253755, "post_id": 48916828, "comment_id": 84840244, "body": "add a column count to the resize: <code>Resize (.Rows.Count - 1,5)</code>  This should exclude column F"}, {"owner": {"reputation": 15, "user_id": 9363033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84dfaa6db7310cf4d433ce295b32fef5?s=128&d=identicon&r=PG&f=1", "display_name": "JayH", "link": "https://stackoverflow.com/users/9363033/jayh"}, "edited": false, "score": 0, "creation_date": 1519254157, "post_id": 48916828, "comment_id": 84840393, "body": "Perfect Scott! Thanks"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1519254069, "creation_date": 1519254069, "answer_id": 48916987, "question_id": 48916828, "link": "https://stackoverflow.com/questions/48916828/how-to-copy-a-select-amount-of-columns-with-all-rows-that-have-a-specific-number/48916987#48916987", "title": "How to copy a select amount of columns with all rows that have a specific number in column A", "body": "<p>Rewritten as,</p>\n\n<pre><code>With ws.Result.Range (\"A1:F\" &amp; .Cells(.Rows.Count, \"F\").End(xlUp).Row)\n    ' checks row F to see  whether the number in cell C1 matches any in row F\n    .AutoFilter Field := 6, Criteria1 := wsResult.Range(\"C1\") \n    with .resize(.rows.count-1, 5).offset(1, 0)\n        If cbool(Application.Subtotal(103, .Cells)) Then\n            .SpecialCells(xlCellTypeVisible).Copy Destination:= Main.Range(\"A22\") \n        end if\n    end with\nend with\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 9363033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84dfaa6db7310cf4d433ce295b32fef5?s=128&d=identicon&r=PG&f=1", "display_name": "JayH", "link": "https://stackoverflow.com/users/9363033/jayh"}, "is_accepted": false, "score": 0, "last_activity_date": 1519254237, "creation_date": 1519254237, "answer_id": 48917010, "question_id": 48916828, "link": "https://stackoverflow.com/questions/48916828/how-to-copy-a-select-amount-of-columns-with-all-rows-that-have-a-specific-number/48917010#48917010", "title": "How to copy a select amount of columns with all rows that have a specific number in column A", "body": "<p>Thanks to Scott Craner for the answer. Correct code is below.\n\"add a column count to the resize: Resize (.Rows.Count - 1,5) This should exclude column F \u2013\"</p>\n\n<pre><code>With ws.Result.Range (\"A1:F\" &amp; .Cells(.Rows.Count, \"F\").End(xlUp).Row\n.AutoFilter Field := 6, Criteria1 := wsResult.Range(\"C1\") ' checks row F to \nsee  whether the number in cell C1 matches any in row F\n\nIf Application.WorksheetFunction.Subtotal(103, .Columns(1)&gt;1 Then .\nOffset(1). Resize (.Rows.Count - 1,5).SpecialCells(xlCellTypeVisible).Copy \nDestination:= Main.Range(\"A22\") \n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9363033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84dfaa6db7310cf4d433ce295b32fef5?s=128&d=identicon&r=PG&f=1", "display_name": "JayH", "link": "https://stackoverflow.com/users/9363033/jayh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 48916987, "answer_count": 2, "score": 1, "last_activity_date": 1519254365, "creation_date": 1519253256, "last_edit_date": 1519254365, "question_id": 48916828, "link": "https://stackoverflow.com/questions/48916828/how-to-copy-a-select-amount-of-columns-with-all-rows-that-have-a-specific-number", "title": "How to copy a select amount of columns with all rows that have a specific number in column A", "body": "<p>I'm trying to copy columns A to E from one sheet that has certain values in Column F.\nFor example I want to copy rows A:E that have a 'X' in column F and paste them to another sheet. </p>\n\n<p>I have a code that can copy and paste All rows that have an 'X' but not sure what to change to be able to only copy rows A to E.</p>\n\n<p>Here is my code.</p>\n\n<pre><code>With ws.Result.Range (\"A1:F\" &amp; .Cells(.Rows.Count, \"F\").End(xlUp).Row\n.AutoFilter Field := 6, Criteria1 := wsResult.Range(\"C1\") ' checks row F to \nsee  whether the number in cell C1 matches any in row F\n\nIf Application.WorksheetFunction.Subtotal(103, .Columns(1)&gt;1 Then .\nOffset(1). Resize (.Rows.Count - 1).SpecialCells(xlCellTypeVisible).Copy \nDestination:= Main.Range(\"A22\") \n</code></pre>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 13, "user_id": 2620128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ccea719be085581c730e9ce48266d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr M", "link": "https://stackoverflow.com/users/2620128/mr-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "closed_date": 1519251287, "answer_count": 0, "score": 1, "last_activity_date": 1519251183, "creation_date": 1519251183, "last_edit_date": 1531161705, "question_id": 48916398, "link": "https://stackoverflow.com/questions/48916398/worksheet-changebyval-target-as-range", "closed_reason": "Duplicate", "title": "Worksheet_Change(Byval Target as Range)", "body": "<p>I know this question has been asked multiple times but I am really struggling to get my head around it and make it work. </p>\n\n<p>I have a spreadsheet with 5 columns on it, \nas in the screenshot below </p>\n\n<p><a href=\"https://i.stack.imgur.com/pleid.png\" rel=\"nofollow noreferrer\">ScreenShot of Sheet</a></p>\n\n<p>I am trying to populate column \"B\" with a timestamp when a change occurs in Column \"C\" and Populate Column \"E\" with a time stamp when a change occurs in Column \"D\". </p>\n\n<p>I have the following code so far </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\nIf Intersect(Target, [C:C]) Is Nothing Or Target.Count &gt; 1 Then Exit Sub\nTarget.Offset(, -1) = Time \nEnd Sub\n</code></pre>\n\n<p>But no matter what i have tried so far i cannot figure out the code to enable the timestamps to be created independantly within the same Worksheet_Change() sub </p>\n\n<p>Any help would be greatly appreciated</p>\n\n<p>Thanks </p>\n\n<p>M </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1519254371, "post_id": 48916321, "comment_id": 84840473, "body": "When you say &quot;I do not even get an option to confirm the delete&quot;, you mean in the child form? Child form events won&#39;t trigger if you delete from the Main (active) form."}, {"owner": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1519257095, "post_id": 48916321, "comment_id": 84841337, "body": "Sorry for not being clear. I want the Parent form&#39;s AfterDelConfirm to trigger. I do not get an option to confirm the delete when deleting records in the Parent form. Right now I am manually doing it with the Respone = MsgBox(&quot;...&quot;) line"}, {"owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "edited": false, "score": 0, "creation_date": 1519271195, "post_id": 48916321, "comment_id": 84844880, "body": "You say you have 2 subforms. is it really 2 subforms or is it a form with a subform? if it&#39;s 2 subforms, can you explain?"}, {"owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "edited": false, "score": 0, "creation_date": 1519272670, "post_id": 48916321, "comment_id": 84845306, "body": "If it is 2 subforms, can you rework it so the parent data is in the form, and the child data is in a subform?"}, {"owner": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "edited": false, "score": 0, "creation_date": 1519276409, "post_id": 48916321, "comment_id": 84846442, "body": "Yeah they are two subforms that reside within the main form and exist on the same layer. It is possible for me to do that but the entire program is already written so it would be cumbersome to adjust the rest of the program accordingly."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1519291089, "post_id": 48916321, "comment_id": 84853418, "body": "How are you deleting records? Are you using the normal GUI (click record selector, hit delete key?)"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1519292395, "post_id": 48916321, "comment_id": 84854269, "body": "If you are deleting records from subforms in a main form, events of subforms won&#39;t trigger unless you use what @ErikvonAsmuth says. My guess is that you delete with VBA records in subforms but you do it from main form, so those confirms won&#39;t trigger never ever"}, {"owner": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "edited": false, "score": 0, "creation_date": 1519343920, "post_id": 48916321, "comment_id": 84885367, "body": "So only the main form can trigger after delete events?? That seems rather short-sighted. And yeah I am using the normal GUI, record selector of the subform to delete a record within the same subform. I do get an onDelete event but not an on AfterDeleteConfirm event."}], "owner": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 299, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519257129, "creation_date": 1519250847, "last_edit_date": 1519257129, "question_id": 48916321, "link": "https://stackoverflow.com/questions/48916321/afterdelconfirm-event-not-triggering-microsoft-access-vba", "title": "AfterDelConfirm event not triggering Microsoft Access VBA", "body": "<p>I have two subforms each representing a table in my database. These subforms display all the records in those tables and they have a 1 to many relationship between each other. </p>\n\n<p>When a record is deleted in the parent subform, it deletes all the children in the other one (I have cascade delete on).</p>\n\n<p>I need to do some handling in the child form once the deletion is complete. I would like to use the AfterDelConfirm event but I cannot get it to fire.</p>\n\n<p>I do not even get an option to confirm the delete (in the parent form). In fact I am doing it manually:</p>\n\n<pre><code>  Private Sub Form_Delete(Cancel As Integer)\n     Dim PhaseID As Long\n     Dim Response As Long\n     Dim style As Long\n     style = vbYesNo + vbQuestion\n     Response = MsgBox(\"Are you sure you wish to delete this phase and all related scenarios and nodes?\", style)\n     If Response = vbNo Then\n        Cancel = True\n     End If\n  End Sub\n</code></pre>\n\n<p>Trying to get this to run:</p>\n\n<pre><code>  Private Sub Form_AfterDelConfirm(Status As Integer)\n     Debug.Print \"trigger plz\"\n  End Sub\n</code></pre>\n\n<p>Is there a way I can get this event to fire with the way I have things set up?</p>\n"}, {"tags": ["vba", "image", "excel"], "comments": [{"owner": {"reputation": 333, "user_id": 3393081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p0WfA.jpg?s=128&g=1", "display_name": "MrDogme", "link": "https://stackoverflow.com/users/3393081/mrdogme"}, "edited": false, "score": 0, "creation_date": 1519249305, "post_id": 48915865, "comment_id": 84838363, "body": "What error message? Is it about macro enabling? Could you keep the .XLSM for yourself and send a dated copy in .XLSX format to those clients ?"}, {"owner": {"reputation": 246, "user_id": 9361443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adec54ed9e27194eaa721d4f8079d40?s=128&d=identicon&r=PG&f=1", "display_name": "shash", "link": "https://stackoverflow.com/users/9361443/shash"}, "edited": false, "score": 0, "creation_date": 1519249579, "post_id": 48915865, "comment_id": 84838487, "body": "It is possible that the same server location is mapped under a different letter for the user. I don&#39;t know what event fires your Macro, but if it does, it may not find the location.   A trivial check, but I would start with that."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1519253800, "post_id": 48915865, "comment_id": 84840262, "body": "I don&#39;t see any issues in posted code. You can see those images from the attachment in Sent items? Does the client see a shape placeholder at all? if you can remove business confidential contents and then share the file, it may be easier to find the cause. It should not be unable to access your server share as it&#39;s a copy of the image being inserted, not a link."}], "answers": [{"tags": [], "owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "is_accepted": false, "score": 1, "last_activity_date": 1519262885, "creation_date": 1519262885, "answer_id": 48918195, "question_id": 48915865, "link": "https://stackoverflow.com/questions/48915865/send-file-with-images-which-are-stored-internally-to-external-recipients/48918195#48918195", "title": "Send file, with images which are stored internally, to external recipients", "body": "<p>I'm assuming that the clients you're sending the file to are external clients.</p>\n\n<p>The Pictures.Insert method only creates a link to the picture, so external clients which don't have access to your company server won't be able to see the pictures.</p>\n\n<p>You need to instead use the Shapes.AddPicture method, which can embed the picture in the file.</p>\n\n<pre><code>Activesheet.Shapes.AddPicture Filename:=pathForPicture &amp; pictureName &amp; \".jpg\", _\n    LinkToFile:=msoFalse, SaveWithDocument:=msoTrue, _\n    Left:=Selection.Left, Top:=Selection.Top, Width:=-1, Height:=-1\n</code></pre>\n\n<p>Note that the Width and Height parameters are mandatory, but you can set them to -1, which then maintains the height and width of the original image!</p>\n"}], "owner": {"reputation": 11, "user_id": 9393267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z6WmpW9EEDc/AAAAAAAAAAI/AAAAAAAADtQ/4JSQafajfns/photo.jpg?sz=128", "display_name": "Becky", "link": "https://stackoverflow.com/users/9393267/becky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1522448957, "creation_date": 1519248889, "last_edit_date": 1522448957, "question_id": 48915865, "link": "https://stackoverflow.com/questions/48915865/send-file-with-images-which-are-stored-internally-to-external-recipients", "title": "Send file, with images which are stored internally, to external recipients", "body": "<p>I send a file with images to clients.  When the client opens the file all the images are gone or there is an error message.  This document is updated weekly with new inventory data.</p>\n\n<p>All images reference column E and images are saved to a folder within the company server.</p>\n\n<p>The code I have been using is:</p>\n\n<pre><code>Sub IMAGEINSERT()\n\nDim pictureNameColumn As String 'column where picture name is found\nDim picturePasteColumn As String 'column where picture is to be pasted\n\nDim pictureName As String 'picture name\nDim lastPictureRow As Long 'last row in use where picture names are\nDim pictureRow As Long 'current picture row to be processed\nDim pathForPicture As String 'path of pictures\n\npictureNameColumn = \"E\"\npicturePasteColumn = \"A\"\n\npictureRow = 2 'starts from this row\n\n'error handler\nOn Error GoTo Err_Handler\n\n'find row of the last cell in use in the column where picture names are\nlastPictureRow = Cells(Rows.Count, pictureNameColumn).End(xlUp).Row\n\n'stop screen updates while macro is running\nApplication.ScreenUpdating = False\n\npathForPicture = \"M:\\Sales\\Accessories\\Hope G\\_OFF PRICE\\_ATS REPORTS\\ATS LIST\\images\\\"\n\n'loop till last row\nDo While (pictureRow &lt;= lastPictureRow)\n\n    pictureName = Cells(pictureRow, \"E\") 'This is the picture name\n\n    'if picture name is not blank then\n    If (pictureName &lt;&gt; vbNullString) Then\n\n        'check if pic is present\n        If (Dir(pathForPicture &amp; pictureName &amp; \".jpg\") &lt;&gt; vbNullString) Then\n\n            'This is where picture will be inserted\n            Cells(pictureRow, picturePasteColumn).Select\n\n            'Path to where pictures are stored\n            ActiveSheet.Pictures.Insert(pathForPicture &amp; pictureName &amp; \".jpg\").Select\n\n            With Selection\n                .Left = Cells(pictureRow, picturePasteColumn).Left\n                .Top = Cells(pictureRow, picturePasteColumn).Top\n                .ShapeRange.LockAspectRatio = msoFalse\n                .ShapeRange.Height = 80#\n                .ShapeRange.Width = 60#\n                .ShapeRange.Rotation = 0#\n            End With\n        Else\n            'picture name was there, but no such picture\n           Cells(pictureRow, picturePasteColumn) = \"\"\n        End If\n    Else\n        'picture name cell was blank\n    End If\n\n    'increment row count\n    pictureRow = pictureRow + 1\nLoop\n\nExit_Sub:\nRange(\"A10\").Select\nApplication.ScreenUpdating = True\nExit Sub\n\nErr_Handler:\nMsgBox \"Error encountered. \" &amp; Err.Description, vbCritical, \"Error\"\nGoTo Exit_Sub\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Xetsl.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xetsl.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 246, "user_id": 9361443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adec54ed9e27194eaa721d4f8079d40?s=128&d=identicon&r=PG&f=1", "display_name": "shash", "link": "https://stackoverflow.com/users/9361443/shash"}, "is_accepted": true, "score": 1, "last_activity_date": 1519248777, "creation_date": 1519248777, "answer_id": 48915837, "question_id": 48915650, "link": "https://stackoverflow.com/questions/48915650/excel-vb-copy-cells-from-on-sheet-to-another/48915837#48915837", "title": "excel VB copy cells from on sheet to another", "body": "<p>Since you have not mentioned the exact problem or the error you see, I can see some possible sources of an issue. </p>\n\n<p>Replace</p>\n\n<pre><code>Sheets(\"sheet2\").Cells(filalibre, 3) = ActiveSheet.Offset(0, 0) \nSheets(\"sheet2\").Cells(filalibre, 4) = ActiveSheet.Offset(0, 1)\n</code></pre>\n\n<p>By </p>\n\n<pre><code>Sheets(\"sheet2\").Cells(filalibre, 3) = ActiveCell.Offset(0, 0) \nSheets(\"sheet2\").Cells(filalibre, 4) = ActiveCell.Offset(0, 1)\n</code></pre>\n\n<p>Besides this,there are a few other improvements that can be done to your code. But first try to get it working without an error.</p>\n"}], "owner": {"reputation": 15, "user_id": 9393220, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Juan Lynn", "link": "https://stackoverflow.com/users/9393220/juan-lynn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 48915837, "answer_count": 1, "score": 1, "last_activity_date": 1519248777, "creation_date": 1519247919, "last_edit_date": 1531164843, "question_id": 48915650, "link": "https://stackoverflow.com/questions/48915650/excel-vb-copy-cells-from-on-sheet-to-another", "title": "excel VB copy cells from on sheet to another", "body": "<p>I\u00b4m having problems with my code\nI want this code to copy cells from one sheet to another but with the following trick\n(english is not my first language, Sorry )</p>\n\n<p>In \"sheet1\" there is \"date and ticket number\" always in the same cell, but I also want to copy a list of values that can change in amount...(A10)\nall these values go to \"sheet2\" in the same row... \n\"date1\" \"ticket123\" \"itemA\" \"amount\"\n\"date1\" \"ticket123\" \"itemB\" \"amount2\"</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nfilalibre = Sheets(\"sheet2\").Range(\"a1048576\").End(xlUp).Row + 1\nActiveSheet.Range(\"a10\").Select\nfila = 10\n\nWhile ActiveCell.Value &lt;&gt; \"\"\nSheets(\"sheet2\").Cells(filalibre, 1) = ActiveSheet.Range(\"E4\") \nSheets(\"sheet2\").Cells(filalibre, 2) = ActiveSheet.Range(\"E2\") \n\nSheets(\"sheet2\").Cells(filalibre, 3) = ActiveSheet.Offset(0, 0) \nSheets(\"sheet2\").Cells(filalibre, 4) = ActiveSheet.Offset(0, 1) \n\n\nfilalibre = filalibre + 1\n\nActiveCell.Offset(1, 0).Select\nWend\nCall limpieza\nEnd Sub\n</code></pre>\n\n<p>What can I read to fix this... or can anyone help me </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 1, "creation_date": 1519248372, "post_id": 48915436, "comment_id": 84837887, "body": "For an event-triggered sub to work, it has to be placed in the correct location. Do you have this sub in the relevant sheet&#39;s code? A quick way to check, is to look at the left drop down box at top of the code module the sub is in. When your cursor is in that section of code, does that selection box say &quot;Worksheet&quot;?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1519253120, "post_id": 48915436, "comment_id": 84840023, "body": "Use the macro recorder to see what is the code to sort data by descending values. And then adapt it you your needs. If you get stuck, then you can ask here in SO"}, {"owner": {"reputation": 11, "user_id": 9393180, "user_type": "registered", "profile_image": "https://graph.facebook.com/1615752435156877/picture?type=large", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9393180/daniel"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1519315608, "post_id": 48915436, "comment_id": 84870744, "body": "Thank you for your comments. @Mistella I see I have my sub in the right place, when I checked the way you mentioned. Also, when I change the &quot;Target.Row&quot; into any constant number, I get the result I want. So I think the Target.Row is the cause of the problem."}, {"owner": {"reputation": 11, "user_id": 9393180, "user_type": "registered", "profile_image": "https://graph.facebook.com/1615752435156877/picture?type=large", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9393180/daniel"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1519315798, "post_id": 48915436, "comment_id": 84870882, "body": "@FoxfireAndBurnsAndBurns I have also tried the recorder, but I couldn&#39;t find out the way to set up the macro for something to affect the other cells in the same row."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1519316613, "post_id": 48915436, "comment_id": 84871444, "body": "When I tested it in a sample workbook, it worked fine for me. If the value I put in column G was smaller than the value from column H, it switched the two values. <b>Note</b> The code will only look at values from columns G and H on the <i>one</i> specific worksheet with the code. Another thought, do you have any protection on the sheets or workbook? Sometimes that can cause unexpected results."}], "owner": {"reputation": 11, "user_id": 9393180, "user_type": "registered", "profile_image": "https://graph.facebook.com/1615752435156877/picture?type=large", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9393180/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519247009, "creation_date": 1519247009, "last_edit_date": 1531164843, "question_id": 48915436, "link": "https://stackoverflow.com/questions/48915436/compare-cells-and-exchange-data", "title": "Compare Cells and exchange data", "body": "<p>I am beginner in VBA-excel, and got stuck on one thing.\nI tried to make my two columns to get in descending order every time\nI change its data. Because I only had two columns, I thought I could just compare the cells and exchange them when the left one is smaller.</p>\n\n<p>Below is the code I made, but doesn't work at all.\nCould you tell me which parts I made mistakes?\nAlso, I would really appreciate if you have any methods to sort the data\nwhenever I update them.</p>\n\n<p>Thank you in advance.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim temp As String\nIf Cells(Target.Row, 7).Value &lt; Cells(Target.Row, 8).Value Then\ntemp = Cells(Target.Row, 8).Value\nCells(Target.Row, 8).Value = Cells(Target.Row, 7).Value\nCells(Target.Row, 7).Value = temp\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "loops"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1519248868, "post_id": 48915358, "comment_id": 84838147, "body": "FYI that <code>intCount</code> loop appears to be completely redundant; the second iteration would simply overwrite everything the first one did."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1519276389, "last_edit_date": 1519276389, "creation_date": 1519247324, "answer_id": 48915504, "question_id": 48915358, "link": "https://stackoverflow.com/questions/48915358/vba-continue-if-array-empty/48915504#48915504", "title": "VBA Continue If Array Empty", "body": "<p>With some test values</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\nDim ii As Long\nDim iii As Long\n\nii = 2\niii = 3\n\nDim FullName As String\nDim Name() As String\n\nWith ActiveSheet\n\n    FullName = .Cells(37, ii).Value\n\n    If InStrRev(FullName, \" \", -1) &gt; 0 Then   'space present\n\n        Name = Split(FullName, \" \")\n\n        If UBound(Name) &gt; 1 Then Exit Sub 'there was more than one space present. Handling this was not specified so exit sub.\n\n        .Range(\"C\" &amp; iii).Value = Name(0)\n        .Range(\"D\" &amp; iii).Value = Name(1)\n\n    Else\n\n         .Range(\"C\" &amp; iii).Value = FullName\n         .Range(\"D\" &amp; iii).Value = vbNullString\n\n    End If\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "is_accepted": false, "score": 1, "last_activity_date": 1519249066, "last_edit_date": 1519249066, "creation_date": 1519247784, "answer_id": 48915623, "question_id": 48915358, "link": "https://stackoverflow.com/questions/48915358/vba-continue-if-array-empty/48915623#48915623", "title": "VBA Continue If Array Empty", "body": "<p>If you want to avoid using <code>On Error Resume Next</code>, you can try this:</p>\n\n<pre><code>FullName = ActiveSheet.Cells(37, ii).Value\nName = Split(FullName, \" \")\n\nIf Len(Join(Name)) &gt; 0 Then\n    sData.Range(\"C\" &amp; iii).Value = Name(0)\n    sData.Range(\"D\" &amp; iii).Value = Name(1)\nEnd If\n</code></pre>\n\n<p>which was originally posted <a href=\"https://stackoverflow.com/a/206526/5936117\">here</a>. <code>Join</code> essentially reverts to the FullName value but without the space. Alternatively, you could just use <code>If InStr(1, FullName, \" \", vbBinaryCompare) &gt; 0 Then</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1519248162, "last_edit_date": 1519248162, "creation_date": 1519247853, "answer_id": 48915635, "question_id": 48915358, "link": "https://stackoverflow.com/questions/48915358/vba-continue-if-array-empty/48915635#48915635", "title": "VBA Continue If Array Empty", "body": "<p>Since the two columns are consecutive, you can just paste the array in-place, using <code>Range.Resize</code> to dump the array across as many columns as needed - the only thing to watch for is if <code>Name</code> can contain more than a single space:</p>\n\n<pre><code>FullName = ActiveSheet.Cells(37, ii).Value\nName = Split(FullName, \" \")\nIf UBound(Name) &lt;= 1 Then\n    sData.Range(\"C\" &amp; iii).Resize(, UBound(Name) + 1).Value = Name\nElse\n    'there was more than one space...\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 6594698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87eac23949c91b8bc3a27bc509c4e2b2?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Hardy", "link": "https://stackoverflow.com/users/6594698/steven-hardy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 48915635, "answer_count": 3, "score": 2, "last_activity_date": 1519276389, "creation_date": 1519246774, "question_id": 48915358, "link": "https://stackoverflow.com/questions/48915358/vba-continue-if-array-empty", "title": "VBA Continue If Array Empty", "body": "<p><br/><br/>\nI am extremely new to VBA. I am currently creating a script that will save me a lot of time <em>fingers crossed</em>\n<br/><br/>I am just wondering how i can skip over an error if the array is not full? For example, 1 loop goes over whether the array has a first and last name, if there is no last name i would like the script to continue.\n<br/><br/></p>\n\n<pre><code>FullName = ActiveSheet.Cells(37, ii).Value\nName = Split(FullName, \" \")\n\nFor intCount = LBound(Name) To UBound(Name)\n  sData.Range(\"C\" &amp; iii).Value = Name(0)\n  sData.Range(\"D\" &amp; iii).Value = Name(1)\nNext\n</code></pre>\n\n<p>If <code>Name(1)</code> is empty then how can the code continue? </p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1519250794, "post_id": 48915235, "comment_id": 84839025, "body": "Please add the Sub...End Sub lines - it&#39;s not clear whether this is a single procedure or more than one. If one, don&#39;t &quot;Dim&quot; iShp again, just use it (IOW comment out the second <code>Dim</code> line and test)."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1519264899, "post_id": 48915235, "comment_id": 84843294, "body": "Place your Dim statements at the top of your procedure where they belong, not in the code. Then you will see that you declare <code>iShp</code> twice which causes an error, and rightly so. Once declared you can use the same variable multiple times within its scope, here presumed to be one procedure."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9393130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed31e93fcbf5667cdbf2bf82d7db51ca?s=128&d=identicon&r=PG&f=1", "display_name": "beewerks", "link": "https://stackoverflow.com/users/9393130/beewerks"}, "is_accepted": false, "score": 0, "last_activity_date": 1520288711, "creation_date": 1520288711, "answer_id": 49120513, "question_id": 48915235, "link": "https://stackoverflow.com/questions/48915235/how-to-toggle-button-size/49120513#49120513", "title": "How to toggle button size?", "body": "<p>Thanks for the tips!  Combining advice from both of you got my code working right.  I had to toss a 'Next' below the last 'End If' statement to get everything working right.</p>\n"}, {"tags": [], "owner": {"reputation": 2844, "user_id": 8740349, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FRL1s.jpg?s=128&g=1", "display_name": "Top-Master", "link": "https://stackoverflow.com/users/8740349/top-master"}, "is_accepted": false, "score": 0, "last_activity_date": 1556623046, "creation_date": 1556623046, "answer_id": 55919746, "question_id": 48915235, "link": "https://stackoverflow.com/questions/48915235/how-to-toggle-button-size/55919746#55919746", "title": "How to toggle button size?", "body": "<p>Here is what worked for me:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPrivate Type SizeCache\n    width As Integer\n    height As Integer\nEnd Type\n\nPrivate Sub ShowPrintDialog(Optional ByVal doc As Document)\n    Dim wasProtected As Boolean\n    Dim currentShape As InlineShape\n    Dim dimensions() As SizeCache, size As Long, entry As SizeCache\n    ' Prepare Document\n    If doc Is Nothing Then\n        Set doc = ThisDocument\n    End If\n    If doc.ProtectionType = wdAllowOnlyFormFields Then\n        wasProtected = True\n        doc.Unprotect\n    End If\n    ' Hide all buttons\n    For Each currentShape In doc.InlineShapes\n        If Not currentShape.OLEFormat Is Nothing Then\n            entry.width = currentShape.width\n            entry.height = currentShape.height\n            size = size + 1\n            ReDim Preserve dimensions(size)\n            dimensions(size) = entry\n            With dimensions(UBound(dimensions))\n                Debug.Print currentShape.OLEFormat.Object.Name &amp; \": \" &amp; .width &amp; \"x\" &amp; .height\n            End With\n            currentShape.width = 1\n            currentShape.height = 1\n        End If\n    Next\n    '\n    ' At last, allows user to select Printer and print\n    '\n    Dialogs(wdDialogFilePrint).Show\n    ' Restore all buttons\n    Dim i As Long: i = 1\n    For Each currentShape In doc.InlineShapes\n        If Not currentShape.OLEFormat Is Nothing Then\n            With dimensions(i)\n                currentShape.width = .width\n                currentShape.height = .height\n            End With\n            i = i + 1\n        End If\n    Next\n    ' Restore Document\n    If wasProtected Then\n        doc.Protect wdAllowOnlyFormFields, True\n    End If\nEnd Sub\n\nPublic Sub CommandButton1_Click()\n    Call ShowPrintDialog\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9393130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed31e93fcbf5667cdbf2bf82d7db51ca?s=128&d=identicon&r=PG&f=1", "display_name": "beewerks", "link": "https://stackoverflow.com/users/9393130/beewerks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 858, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1609404244, "creation_date": 1519246322, "last_edit_date": 1609404244, "question_id": 48915235, "link": "https://stackoverflow.com/questions/48915235/how-to-toggle-button-size", "title": "How to toggle button size?", "body": "<p>I'm working on VBA code for a command button. The button needs to shrink (hide) after being clicked, then the print dialog appears, and then after printing, the button needs to return to it's normal size.</p>\n<p>The first two parts work.</p>\n<p>Getting the button to return to it's correct size after printing isn't working.</p>\n<p>I'm calling iShp twice which is causing errors.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Dim iShp As Word.InlineShape\nFor Each iShp In ActiveDocument.InlineShapes\n    If iShp.OLEFormat.Object.Name = &quot;cmdSaveCert&quot; Then\n        iShp.Width = 1\n        iShp.Height = 1\n    End If\nNext\n    \nWith ActiveDocument\n    Dialogs(wdDialogFilePrint).Show   'allows user to select Printer\nEnd With\n\nDim iShp As Word.InlineShape\nFor Each iShp In ActiveDocument.InlineShapes\n    If iShp.OLEFormat.Object.Name = &quot;cmdSaveCert&quot; Then\n        iShp.Width = 28185\n        iShp.Height = 13710\n    End If\n</code></pre>\n"}, {"tags": ["vba", "excel", "directory", "create-directory"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519244287, "post_id": 48914585, "comment_id": 84835781, "body": "I think you need to step through with a 5 digit code and track the changes in value. It may well be that there are other dependencies such as Len(Folder) = 8 And Len(MainFolder) = 23   looks like tests on Folder length might increase if Folder = &quot;NC-&quot; &amp; Mid(objFile.Name, i, 5) changes to have a 6 etc....."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519244466, "post_id": 48914585, "comment_id": 84835897, "body": "The locals window will be of use and perhaps watch windows. Put one file through where it works noting the values that are being generated so you have a better idea of what is going on. There are lots of tutorials on debugging.. how to step through the code with F8, how to use the immediate window, watch window and locals window. It is an invaluable skill and is a few hours of your time to get a basic understanding."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519246317, "post_id": 48914585, "comment_id": 84836887, "body": "Are <i>all</i> your files now 6 digits, or are you also dealing with 5-digit names still?"}, {"owner": {"reputation": 11, "user_id": 9392522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-u4z1eEjcdpw/AAAAAAAAAAI/AAAAAAAAKYU/Dps399E_Cws/photo.jpg?sz=128", "display_name": "S H", "link": "https://stackoverflow.com/users/9392522/s-h"}, "edited": false, "score": 0, "creation_date": 1519246384, "post_id": 48914585, "comment_id": 84836920, "body": "Thanks,  I want to be able to put the time in to learn all of this.  My employer doesn&#39;t feel like me spending the time to learn to edit the code is valuable at this point.  I will have to manually create the folders and move the files until I figure it out on my personal time.  I appreciate your tips.  I want to learn this."}, {"owner": {"reputation": 11, "user_id": 9392522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-u4z1eEjcdpw/AAAAAAAAAAI/AAAAAAAAKYU/Dps399E_Cws/photo.jpg?sz=128", "display_name": "S H", "link": "https://stackoverflow.com/users/9392522/s-h"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519246486, "post_id": 48914585, "comment_id": 84836963, "body": "@TimWilliams I still deal with 5 digit names.  I need to be able to handle both."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519251671, "post_id": 48914585, "comment_id": 84839432, "body": "Just so it&#39;s clear, can you describe exactly what the function of the code is?  What should it do?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519253086, "post_id": 48914585, "comment_id": 84840007, "body": "For example it would help to show some examples of exactly how your subfolders are named (covering both 5-digit and 6-digit cases).  Can the correct subfolder name be predicted just from the file number?"}, {"owner": {"reputation": 11, "user_id": 9392522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-u4z1eEjcdpw/AAAAAAAAAAI/AAAAAAAAKYU/Dps399E_Cws/photo.jpg?sz=128", "display_name": "S H", "link": "https://stackoverflow.com/users/9392522/s-h"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519254281, "post_id": 48914585, "comment_id": 84840444, "body": "@Tim Williams   This spreadsheet will automatically place files into their respective Nonconformance Folders.  These files can be pictures, Word docs, Excel docs, etc.  This tool will also create folders where they should be if a folder does not already exist.  The only requirement is that the file contains the NC number.  See below for instructions on how to use this tool: 1 ) Save files in current folder - &quot;R:\\Field Assurance\\FA PHOTOS AND INFORMATION\\&quot;. 2) Ensure the NC# is located within the file name, before other 5-digit numbers. 3) Open this file.  Press the &quot;Execute&quot; button."}, {"owner": {"reputation": 11, "user_id": 9392522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-u4z1eEjcdpw/AAAAAAAAAAI/AAAAAAAAKYU/Dps399E_Cws/photo.jpg?sz=128", "display_name": "S H", "link": "https://stackoverflow.com/users/9392522/s-h"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519255043, "post_id": 48914585, "comment_id": 84840704, "body": "@Tim Williams  the issue began when the subfolder was named NC-98001 thru NC-101000.  Prior subfolders were named NC-95001 thru NC-98000, NC-92001 thru NC-95000.  The sub folder with the 6-digit number is what I think is causing the issue.  I would like to rename the folder to give me some time to work but it is a group folder and people leave it open all the time."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519256127, "post_id": 48914585, "comment_id": 84841058, "body": "&quot;NC-95001 thru NC-98000&quot; (for example) is the <i>exact</i> folder name?"}, {"owner": {"reputation": 11, "user_id": 9392522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-u4z1eEjcdpw/AAAAAAAAAAI/AAAAAAAAKYU/Dps399E_Cws/photo.jpg?sz=128", "display_name": "S H", "link": "https://stackoverflow.com/users/9392522/s-h"}, "edited": false, "score": 0, "creation_date": 1519257243, "post_id": 48914585, "comment_id": 84841378, "body": "R:\\Field Assurance\\FA PHOTOS AND INFORMATION\\NC-95001 thru NC-98000\\NC-97050  Would be the complete file path for NC-97050.  The files I am attempting to move in the FA PHOTOS AND INFORMATION folder into their own subfolder would have 97050 somewhere in the file name."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519258242, "post_id": 48914585, "comment_id": 84841649, "body": "OK, got it.  I will have a go at this a little later..."}, {"owner": {"reputation": 11, "user_id": 9392522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-u4z1eEjcdpw/AAAAAAAAAAI/AAAAAAAAKYU/Dps399E_Cws/photo.jpg?sz=128", "display_name": "S H", "link": "https://stackoverflow.com/users/9392522/s-h"}, "edited": false, "score": 0, "creation_date": 1519258666, "post_id": 48914585, "comment_id": 84841754, "body": "I appreciate any assistance.  I will be working on figuring it out but it probably won&#39;t be elegant or efficient."}], "answers": [{"tags": [], "owner": {"reputation": 246, "user_id": 9361443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adec54ed9e27194eaa721d4f8079d40?s=128&d=identicon&r=PG&f=1", "display_name": "shash", "link": "https://stackoverflow.com/users/9361443/shash"}, "is_accepted": false, "score": 0, "last_activity_date": 1519244271, "creation_date": 1519244271, "answer_id": 48914730, "question_id": 48914585, "link": "https://stackoverflow.com/questions/48914585/code-to-include-longer-file-name-where-the-file-name-is-a-number/48914730#48914730", "title": "Code to include longer file name where the file name is a number", "body": "<p>You need to change the lower limit in IF condition also. Like</p>\n\n<pre><code>If Test &gt;= 10000 And Test &lt;= 99999 Then\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>If Test &gt;= 100000 And Test &lt;= 999999 Then\n</code></pre>\n\n<p>Currently the loop could be exiting when it finds the first five digit number.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9392522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-u4z1eEjcdpw/AAAAAAAAAAI/AAAAAAAAKYU/Dps399E_Cws/photo.jpg?sz=128", "display_name": "S H", "link": "https://stackoverflow.com/users/9392522/s-h"}, "edited": false, "score": 1, "creation_date": 1519265339, "post_id": 48917944, "comment_id": 84843401, "body": "Thank you so much!! This worked beautifully!!  I really appreciate you taking the time to help me out.  This will save me hours of folder creation and file moving.  My attempts to make it work so far have failed."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1519371207, "last_edit_date": 1519371207, "creation_date": 1519260863, "answer_id": 48917944, "question_id": 48914585, "link": "https://stackoverflow.com/questions/48914585/code-to-include-longer-file-name-where-the-file-name-is-a-number/48917944#48917944", "title": "Code to include longer file name where the file name is a number", "body": "<p>This is a bit more complex than your original code but I think it's more robust...</p>\n\n<p>Lightly tested.</p>\n\n<pre><code>Option Explicit\n\nSub CopyPics()\n\n    'use constants for fixed values\n    Const DEST As String = \"R:\\Field Assurance\\FA PHOTOS AND INFORMATION\\\"\n\n    Dim objFSO As Object, srcFolder As Object, objFile As Object\n    Dim objSubFolder As Object, destFolder As Object, fNum, folderName, picFolderName\n    Dim FileWasMoved As Boolean, sMsg\n\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    Set srcFolder = objFSO.GetFolder(Application.ActiveWorkbook.Path) 'ThisWorkbook.Path ?\n    Set destFolder = objFSO.GetFolder(DEST) 'parent destination folder\n\n    'Loop through each file in this folder\n    For Each objFile In srcFolder.Files\n\n        FileWasMoved = False 'reset \"moved\" flag\n\n        fNum = ExtractNumber(objFile.Name) 'get the file number\n\n        If Len(fNum) &gt; 0 Then 'any number found?\n\n            folderName = \"NC-\" &amp; fNum\n\n            For Each objSubFolder In destFolder.subfolders 'Find the subfolder.\n                If IsTheCorrectFolder(objSubFolder.Name, fNum) Then\n\n                    picFolderName = objSubFolder.Path &amp; \"\\\" &amp; folderName\n                    If Not objFSO.folderexists(picFolderName) Then\n                        objFSO.CreateFolder picFolderName\n                    End If\n                    'move the file\n                    Name objFile.Path As picFolderName &amp; \"\\\" &amp; objFile.Name\n                    FileWasMoved = True 'flag file as moved\n                    Exit For\n                End If\n            Next objSubFolder\n        End If 'filename contains a number\n\n        'if file was not moved then add it to the list....\n        If Not FileWasMoved Then sMsg = sMsg &amp; vbLf &amp; objFile.Name\n\n    Next objFile\n\n    'warn user if some files were not moved\n    If Len(sMsg) &gt; 0 Then\n        MsgBox \"Some files were not moved:\" &amp; vbLf &amp; sMsg, vbExclamation\n    End If\n\n\nEnd Sub\n\n'Return true/false depending on whether this is the correct\n'  folder to hold the specified filenumber \nFunction IsTheCorrectFolder(folderName, fileNumber) As Boolean\n    Dim arr, num1, num2, rv As Boolean\n    rv = False 'default return value\n    arr = Split(folderName, \"thru\") 'split folder name on \"thru\"\n    If UBound(arr) = 1 Then 'should have two parts\n        'get the numbers from each part and compare against the file number\n        num1 = ExtractNumber(arr(0))\n        num2 = ExtractNumber(arr(1))\n        If Len(num1) &gt; 0 And Len(num2) &gt; 0 Then\n            fileNumber = CLng(fileNumber) 'convenrt to Long for comparison\n            rv = (fileNumber &gt;= CLng(num1) And fileNumber &lt;= CLng(num2))\n        End If\n    End If\n    IsTheCorrectFolder = rv\nEnd Function\n\n'Extract the first 5- or 6-digit number from a string\n' Match is \"greedy\" so if there are six digits it will match 6 and\n'   not just the first 5...\nFunction ExtractNumber(txt)\n    Dim re As Object, allMatches, rv\n    Set re = CreateObject(\"VBScript.RegExp\")\n    re.Pattern = \"(\\d{5,6})\"\n    re.ignorecase = True\n    re.Global = True\n    Set allMatches = re.Execute(txt)\n    If allMatches.Count &gt; 0 Then rv = allMatches(0) 'if there's a match then return the first one\n    ExtractNumber = rv\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9392522, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-u4z1eEjcdpw/AAAAAAAAAAI/AAAAAAAAKYU/Dps399E_Cws/photo.jpg?sz=128", "display_name": "S H", "link": "https://stackoverflow.com/users/9392522/s-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519371207, "creation_date": 1519243761, "last_edit_date": 1531164843, "question_id": 48914585, "link": "https://stackoverflow.com/questions/48914585/code-to-include-longer-file-name-where-the-file-name-is-a-number", "title": "Code to include longer file name where the file name is a number", "body": "<p>I am trying to edit code that someone else wrote.  I have done NO VBA and very little coding in general.  </p>\n\n<p>The original code is written for a 5 digit number and we now have files that are six digits.  I have tried to copy the code but change it to 6 digit numbers below the current code above <code>Next objFile</code> at the end.  This has not worked.  </p>\n\n<p>The main issue here is I didn't write the original code and I don't understand the logic.  I have tried just changing all of the 5's to 6's and the 99999 to 999999.  I have tried copying from Folder = \"\" down, changing them to 6 digits and pasting below <code>Next objFile</code>.  This didn't work either.  </p>\n\n<pre><code>Sub CopyPics()\n\nDim objFSO As Object\nDim objFolder As Object\nDim objFile As Object\nDim varDirectory As Variant\nDim objSubFolder As Object\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFolder = objFSO.GetFolder(Application.ActiveWorkbook.Path)\n\nDim Dest As String\nDest = \"R:\\Field Assurance\\FA PHOTOS AND INFORMATION\\\"\n\n'Loop through each file in this folder\nFor Each objFile In objFolder.Files\n\n    Folder = \"\" 'Empty old folder name\n    MainFolder = \"\" 'Empty old folder name\n    For i = 1 To Len(objFile.Name)\n        Test = Mid(objFile.Name, i, 5)\n        If Test &gt;= 10000 And Test &lt;= 99999 Then     'For files: Find any five numbers in a row and assume it to be the file number.\n            Folder = \"NC-\" &amp; Mid(objFile.Name, i, 5) 'If found, create new folder.\n            i = Len(objFile.Name) 'In other words, take the first 5 numbers, then get out.\n        End If\n    Next\n\n    For Each objSubFolder In objFolder.subfolders 'Find the main folder.\n    If Right(Folder, 5) &gt;= Mid(objSubFolder.Name, 4, 5) And Right(Folder, 5) &lt;= Mid(objSubFolder.Name, 18, 5) Then 'If my file number is within the main folder bounds...\n    MainFolder = objSubFolder.Name &amp; \"\\\" 'Use that folder.\n    End If\n    Next objSubFolder\n\n    If Len(Folder) = 8 And Len(MainFolder) = 23 Then 'If real folders are identified...\n\n    On Error Resume Next\n    If Dir(Dest &amp; MainFolder &amp; Folder) = \"\" Then 'Check to see if the directory/folder does not exist...\n        objFSO.CreateFolder (Dest &amp; MainFolder &amp; Folder) 'If not, make one.\n    End If\n\n    'Rename that file's directory to be the new one - aka cut and paste file into new folder.\n    Name Application.ActiveWorkbook.Path &amp; \"\\\" &amp; objFile.Name As Dest &amp; MainFolder &amp; Folder &amp; \"\\\" &amp; objFile.Name\n\n    End If\n\nNext objFile\n\nActiveWorkbook.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "pdf", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1519241386, "post_id": 48913813, "comment_id": 84834164, "body": "Do you have a problem creating the path, or populating the web browser control with it? These sound like very separate issues."}, {"owner": {"reputation": 456, "user_id": 7304157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/L8EC8.gif?s=128&g=1", "display_name": "tanvi", "link": "https://stackoverflow.com/users/7304157/tanvi"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1519241702, "post_id": 48913813, "comment_id": 84834338, "body": "@ErikvonAsmuth, I am having trouble determining where to specify the path. Because it will depend on which record is open on the form, the path cannot be constant. I need to define it in a way that allows the key variable to be part of the path string."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1519242148, "post_id": 48913813, "comment_id": 84834592, "body": "That doesn&#39;t narrow it down a lot. Can you construct the string (e.g. create a function that returns it) or not?"}, {"owner": {"reputation": 456, "user_id": 7304157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/L8EC8.gif?s=128&g=1", "display_name": "tanvi", "link": "https://stackoverflow.com/users/7304157/tanvi"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1519242780, "post_id": 48913813, "comment_id": 84834944, "body": "@ErikvonAsmuth,   This is what I have so far:    <code>Dim path As String       Dim filename As String    path = &quot;S:\\MDM\\MIRS\\SCOPE-MP\\&quot;       filename = Me.cboPSENumber.Value + &quot;_MP.pdf&quot;       &#39;Final path should be path + filename </code>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1519243176, "post_id": 48913813, "comment_id": 84835151, "body": "And does that return the desired filename?"}, {"owner": {"reputation": 456, "user_id": 7304157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/L8EC8.gif?s=128&g=1", "display_name": "tanvi", "link": "https://stackoverflow.com/users/7304157/tanvi"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1519243353, "post_id": 48913813, "comment_id": 84835260, "body": "@ErikvonAsmuth I get the correct filename if i just print it in a message box to test it, but how do I get the browser control to display the file under that pathname"}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1537979159, "last_edit_date": 1537979159, "creation_date": 1519244012, "answer_id": 48914652, "question_id": 48913813, "link": "https://stackoverflow.com/questions/48913813/custom-paths-in-web-browser-control-for-pdfs-in-ms-access/48914652#48914652", "title": "Custom Paths in Web Browser Control for PDFs in MS Access", "body": "<p>Let's say you have a form with a web browser control called MyWebbrowserControl, and you want to get the PDF in there:</p>\n\n<pre><code>Public Sub LoadPDF(MyPdfLocation As String)\n    Dim wb As Object\n    Dim strHTML As String\n    strHTML = \"&lt;html&gt;&lt;head&gt;&lt;title&gt;My PDF&lt;/title&gt;&lt;/head&gt;&lt;body&gt;\" &amp; _\n    \"&lt;embed style=\"\"width:100%;height:100%;\"\" src=\"\"\" &amp; Application.HtmlEncode(MyPdfLocation) &amp; \"\"\" type=\"\"application/pdf\"\"&gt;&lt;/embed&gt;&lt;/body&gt;&lt;/html&gt;\"\n    Set wb = MyWebbrowserControl.Object\n    With wb\n        .Navigate2 \"about:blank\"\n        Do Until .ReadyState = 4 '=READYSTATE_COMPLETE\n            'This is an inefficient way to wait, but loading a blank page should only take a couple of milliseconds\n            DoEvents\n        Loop\n        .Document.Open\n        .Document.Write strHTML \n        .Document.Close\n    End With\nEnd Sub\n</code></pre>\n\n<p>(I'm using very generic HTML, it might benefit from some tweaking).</p>\n\n<p>Them call it on <code>Form_Current</code>, for example:</p>\n\n<pre><code>Private Sub Form_Current()\n    Dim path As String \n    Dim filename As String \n    path = \"S:\\MDM\\MIRS\\SCOPE-MP\\\" \n    filename = Me.cboPSENumber.Value + \"_MP.pdf\" 'Final path should be path + filename \n    Me.LoadPDF path &amp; filename\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 456, "user_id": 7304157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/L8EC8.gif?s=128&g=1", "display_name": "tanvi", "link": "https://stackoverflow.com/users/7304157/tanvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 792, "favorite_count": 0, "accepted_answer_id": 48914652, "answer_count": 1, "score": 0, "last_activity_date": 1594628408, "creation_date": 1519240791, "last_edit_date": 1594628408, "question_id": 48913813, "link": "https://stackoverflow.com/questions/48913813/custom-paths-in-web-browser-control-for-pdfs-in-ms-access", "title": "Custom Paths in Web Browser Control for PDFs in MS Access", "body": "<p>I want to display PDF files for each separate record on my form in Access. The form is populated from a combo box's result (select a key field from combo box), and form gets populated with a large amount of info from a query. </p>\n\n<p>For each unique value in the underlying table, there is a pdf file related to it. I want to use the web browser control to define the file path for each unique key. For example, </p>\n\n<blockquote>\n  <p>S:\\FolderPath\\xyz\\keyvalue.pdf\"</p>\n</blockquote>\n\n<p>where <code>keyvalue.pdf</code> is literally the contents of a text box on the form that has the text field source for that record followed by a '.pdf' so if my key is 1, it will be <code>1.pdf</code>, if it is A-22ds, the file will be <code>A-22ds.pdf</code>.</p>\n"}, {"tags": ["vba", "ms-access", "while-loop"], "comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1519243744, "post_id": 48913535, "comment_id": 84835496, "body": "Have you tried using the <code>DoCmd.TransferText</code> method? <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/docmd-transfertext-method-access\" rel=\"nofollow noreferrer\">MSDN</a>"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1519243789, "post_id": 48913535, "comment_id": 84835529, "body": "I don&#39;t know how many records are you importing, but in my case In my job, got some macros that import into MS Access Database around 25.000 records daily into temp table. First, I use Excel to organise my TXT data into the columns i need in a template file adapted to exportation needs. And then I use <code>DoCmd.TransferSpreadsheet Method</code> to import the 25.000 records to Access. It takes about 1 minute. Biggest isue is creating the template file. More info <a href=\"https://msdn.microsoft.com/es-es/library/office/ff844793(v=office.14).aspx\" rel=\"nofollow noreferrer\">here</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "is_accepted": false, "score": 1, "last_activity_date": 1519246612, "creation_date": 1519246612, "answer_id": 48915311, "question_id": 48913535, "link": "https://stackoverflow.com/questions/48913535/need-to-optimize-code-snippet-in-ms-access-vba/48915311#48915311", "title": "Need to optimize code snippet in ms access vba", "body": "<p>You don't need all that VBA code.\nCreate an import specification, save it and use the Do.Cmd TransferText method.\nHere's a step to step guide:</p>\n\n<p><a href=\"https://access-programmers.com/creating-an-import-specification-in-access-2003\" rel=\"nofollow noreferrer\">Creating an Import Specification in Access 2003</a></p>\n"}, {"tags": [], "owner": {"reputation": 573, "user_id": 8497252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d67538554b474d977f956003e2febeaf?s=128&d=identicon&r=PG&f=1", "display_name": "Cahaba Data", "link": "https://stackoverflow.com/users/8497252/cahaba-data"}, "is_accepted": false, "score": 0, "last_activity_date": 1520552962, "creation_date": 1520552962, "answer_id": 49184426, "question_id": 48913535, "link": "https://stackoverflow.com/questions/48913535/need-to-optimize-code-snippet-in-ms-access-vba/49184426#49184426", "title": "Need to optimize code snippet in ms access vba", "body": "<p>this is a record set task - not a coding task.  you are using the wrong approach.  Do as Rene posts - or another way is:</p>\n\n<p>create a link to the text file\nset up a Make Table query using the text file as the source</p>\n"}], "owner": {"reputation": 1, "user_id": 5009066, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BX2g5dy53dI/AAAAAAAAAAI/AAAAAAAABa4/fVxmtT-LufA/photo.jpg?sz=128", "display_name": "Shubham Swarup", "link": "https://stackoverflow.com/users/5009066/shubham-swarup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1520552962, "creation_date": 1519239742, "last_edit_date": 1519244997, "question_id": 48913535, "link": "https://stackoverflow.com/questions/48913535/need-to-optimize-code-snippet-in-ms-access-vba", "title": "Need to optimize code snippet in ms access vba", "body": "<p>We have a txt file with more than 100,000 records. We are importing this into a Microsoft Access database. The file has 4 columns separated by space (vbTab as separator, \"Sep\" variable in code). The given code separates each column value from each row and stores in temporary variables. Then using sql it is inserted into database.</p>\n\n<p>This code use used to take at most 10 minutes to complate. Currently it is taking around 1 hour for same data. Can anyone please help. Will query optimization resolve or there is another issue.</p>\n\n<pre><code>While Not EOF(1)\nLine Input #1, WholeLine\nIf WholeLine = \"\" Then GoTo EndMacro\nNextPos = InStr(1, WholeLine, Sep)\nTempVal1 = Mid(WholeLine, 1, NextPos - 1)\nPos = NextPos + 1\nNextPos = InStr(Pos, WholeLine, Sep)\nTempVal = Mid(WholeLine, Pos, NextPos - Pos)\nstrSignum = Trim(TempVal)\nPos = NextPos + 1\nNextPos = InStr(Pos, WholeLine, Sep)\nTempVal2 = Mid(WholeLine, Pos, NextPos - Pos)\nPos = NextPos + 1\nNextPos = InStrRev(WholeLine, Sep)\nTempVal3 = Mid(WholeLine, NextPos, Len(WholeLine) - NextPos)\nIf strSignum = \"\" Then GoTo NextRow\n    strSQL1 = \"INSERT INTO HRMS_DATA \n(User,OrgUnit,JobName,ParentOrganizationUnit) VALUES('\" &amp; Trim(TempVal) &amp; \"','\" &amp; Trim(TempVal1) &amp; \"','\" &amp; Trim(TempVal2) &amp; \"','\" &amp; Trim(TempVal3) &amp; \"');\"\n\nDoCmd.RunSQL strSQL1\nRowNdx = RowNdx + 1\nNextRow:\nWend\n\nGoTo EndMacro\n</code></pre>\n"}, {"tags": ["html", "vba", "runtime-error", "getelementbyid"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1519241626, "post_id": 48913475, "comment_id": 84834294, "body": "What&#39;s the declaration (Dim) of wb? What&#39;s WB1?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519241902, "post_id": 48913475, "comment_id": 84834445, "body": "Is the error occuring on the first line or the second?"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1519241976, "post_id": 48913475, "comment_id": 84834496, "body": "this line certainly doesn&#39;t make sense <code>Set wb.getElementById(&quot;booktitle&quot;).Value = book</code>. The <code>.Value</code> of something won&#39;t be an object, so remove the <code>Set</code> keyword (I can see you&#39;ve tried that - so this is confirmation!)"}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 7100195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20f5f029b79ab03dae87aaf9631c73c9?s=128&d=identicon&r=PG&f=1", "display_name": "dragonfromdreams", "link": "https://stackoverflow.com/users/7100195/dragonfromdreams"}, "edited": false, "score": 0, "creation_date": 1519243514, "post_id": 48914347, "comment_id": 84835364, "body": "Yes I changed it to try set earlier in the day when I originally had what you posted, it does not work with or without set."}, {"owner": {"reputation": 99, "user_id": 7100195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20f5f029b79ab03dae87aaf9631c73c9?s=128&d=identicon&r=PG&f=1", "display_name": "dragonfromdreams", "link": "https://stackoverflow.com/users/7100195/dragonfromdreams"}, "edited": false, "score": 0, "creation_date": 1519244338, "post_id": 48914347, "comment_id": 84835814, "body": "I don&#39;t believe the issue to be with .value or .innertext, both work because I can iterate through debug and the result comes out with the userform filled out. I just can&#39;t tell what else would cause this error"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 99, "user_id": 7100195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20f5f029b79ab03dae87aaf9631c73c9?s=128&d=identicon&r=PG&f=1", "display_name": "dragonfromdreams", "link": "https://stackoverflow.com/users/7100195/dragonfromdreams"}, "edited": false, "score": 0, "creation_date": 1519244420, "post_id": 48914347, "comment_id": 84835858, "body": "@bella98789 did you see my 2nd update? Add the <code>If</code> statement and see if the msgbox shows or not."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 99, "user_id": 7100195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20f5f029b79ab03dae87aaf9631c73c9?s=128&d=identicon&r=PG&f=1", "display_name": "dragonfromdreams", "link": "https://stackoverflow.com/users/7100195/dragonfromdreams"}, "edited": false, "score": 0, "creation_date": 1519245404, "post_id": 48914347, "comment_id": 84836400, "body": "Then can you specify which line exactly raises the error? Because from what you are saying, the object is set because it didn&#39;t prompt the msgbox. The VBE will stop and highlight in yellow the line causing the error."}, {"owner": {"reputation": 99, "user_id": 7100195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20f5f029b79ab03dae87aaf9631c73c9?s=128&d=identicon&r=PG&f=1", "display_name": "dragonfromdreams", "link": "https://stackoverflow.com/users/7100195/dragonfromdreams"}, "edited": false, "score": 0, "creation_date": 1519245474, "post_id": 48914347, "comment_id": 84836434, "body": "wb.getElementById(&quot;booktitle&quot;).Value = book. this is the line causing the runtime error. book is a string previously parsed from a text document while wb is set from the line in my post"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 99, "user_id": 7100195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20f5f029b79ab03dae87aaf9631c73c9?s=128&d=identicon&r=PG&f=1", "display_name": "dragonfromdreams", "link": "https://stackoverflow.com/users/7100195/dragonfromdreams"}, "edited": false, "score": 0, "creation_date": 1519245549, "post_id": 48914347, "comment_id": 84836470, "body": "Where did you declare <code>book</code>? Where does <code>book</code> receive its value?"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1519244084, "last_edit_date": 1519244084, "creation_date": 1519242763, "answer_id": 48914347, "question_id": 48913475, "link": "https://stackoverflow.com/questions/48913475/runtime-error-424-object-required-on-vba-macro/48914347#48914347", "title": "Runtime error &#39;424&#39; object required on vba macro", "body": "<p>You have a couple options when dealing with <em>properties</em>. <code>.Value</code> <em>is</em> a property, but you are using the <code>Set</code> command, which is reserved for <em>objects</em>.</p>\n\n<p>You can <strong>set</strong> the object to a variable, such as:</p>\n\n<pre><code>Dim oBookTitle As Object\nSet oBookTitle = wb.getElementById(\"booktitle\")\noBookTitle.Value = book\n</code></pre>\n\n<p><code>getElementByID()</code> returns an object --- <code>.Value</code> returns or sets the value <em>of the object</em> (it's a property).</p>\n\n<p>Or you can simply use the property directly:</p>\n\n<pre><code>wb.getElementById(\"booktitle\").Value = book   \n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><em>\"Yes I changed it to try set earlier in the day when I originally had what you posted, it does not work with or without set.\"</em> \u2013 <a href=\"https://stackoverflow.com/users/7100195/bella98789\">bella98789</a></p>\n</blockquote>\n\n<p>I don't see a \"Value\" in the HTML code. You can try <code>.innerText</code> or <code>.outerText</code> instead of <code>.Value</code> and see if that resolves your issue.</p>\n\n<p>Also, if you are not waiting for your webpage to load completely, then your object won't be available. Add this line for debugging purposes:</p>\n\n<pre><code>If wb.getElementById(\"booktitle\") Is Nothing Then MsgBox \"Obj not set\"\n</code></pre>\n\n<hr>\n"}], "owner": {"reputation": 99, "user_id": 7100195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20f5f029b79ab03dae87aaf9631c73c9?s=128&d=identicon&r=PG&f=1", "display_name": "dragonfromdreams", "link": "https://stackoverflow.com/users/7100195/dragonfromdreams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4021, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1519244084, "creation_date": 1519239558, "last_edit_date": 1519243336, "question_id": 48913475, "link": "https://stackoverflow.com/questions/48913475/runtime-error-424-object-required-on-vba-macro", "title": "Runtime error &#39;424&#39; object required on vba macro", "body": "<p>I am receiving a </p>\n\n<blockquote>\n  <p>'424 runtime error; object required'</p>\n</blockquote>\n\n<p>on my excel macro when it comes to the code posted below. I am trying to set the contents of an html userform to the strings I have parsed out of a text document.</p>\n\n<pre><code>Set wb = WB1.document\nSet wb.getElementById(\"booktitle\").Value = book\n</code></pre>\n\n<p>I've also tried:</p>\n\n<pre><code>Set wb = WB1.document\n\nWith wb\n    .getElementById(\"booktitle\").Value = book\nEnd With\n</code></pre>\n\n<p>this is my HTML:</p>\n\n<pre><code> &lt;div class=\"section\"&gt;&lt;span&gt;1&lt;/span&gt;Book&lt;/div&gt;\n &lt;div class=\"inner-wrap\"&gt;\n     &lt;label&gt;Full Book Title &lt;input id=\"booktitle\" type=\"text\" name=\"bookTitle\" /&gt;&lt;/label&gt;\n</code></pre>\n\n<p>WB1 is my userform webbrowser</p>\n"}, {"tags": ["vba", "ms-access", "oauth-2.0", "quickbooks-online"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10905687, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/0e7121463bc977055d2a9d2479c09f32?s=128&d=identicon&r=PG", "display_name": "user10905687", "link": "https://stackoverflow.com/users/10905687/user10905687"}, "is_accepted": false, "score": 1, "last_activity_date": 1547336474, "last_edit_date": 1547336474, "creation_date": 1547318648, "answer_id": 54162782, "question_id": 48913443, "link": "https://stackoverflow.com/questions/48913443/oauth2-for-quickbooks-online-getting-invalid-client-in-vba-when-trying-to-exch/54162782#54162782", "title": "Oauth2 for Quickbooks Online - Getting Invalid Client in VBA when trying to exchange Authorization Code for Token", "body": "<p>I had the same issue.  The authorization code was incorrect.  If you try to debug.print the encoded authorization you will find a carriage return.  I fixed it by removing it.</p>\n\n<pre><code>AuthorizationHeader = \n    Replace(Base64Encode(client_id &amp; \":\" &amp; client_secret), Chr(10), \"\")\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9308372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6016660f66e5498e481e8339619de0da?s=128&d=identicon&r=PG&f=1", "display_name": "Doug C.", "link": "https://stackoverflow.com/users/9308372/doug-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 690, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594619647, "creation_date": 1519239434, "last_edit_date": 1594619647, "question_id": 48913443, "link": "https://stackoverflow.com/questions/48913443/oauth2-for-quickbooks-online-getting-invalid-client-in-vba-when-trying-to-exch", "title": "Oauth2 for Quickbooks Online - Getting Invalid Client in VBA when trying to exchange Authorization Code for Token", "body": "<p>I have a customer who recently upgraded to Quickbooks Online. In the past they used a MS Access database to interface Quickbooks with other data sources. Since they still want to utilize the Access database with Quickbooks and I need to run through the oAuth2 process. I have been able to get the first step done (handshake/authorization) and get code. I am stuck when it comes to exchanging that for a token. I am using the following VBA Code:</p>\n\n<pre><code>Dim httpReq As New MSXML2.ServerXMLHTTP60 'MSXML2.ServerXMLHTTP\nDim sBase64 as string\nDim sBody as string\nDim sKey as string\n\nsBase64 = \"Basic \" &amp; EncodeBase64 &lt;myclient_idXXX:myclient_secretXXX&gt;\nsKey = &lt;Authorization Code from step 1 of oAuth process&gt;\n\nhttpReq.Open \"POST\", \"https://oauth.platform.intuit.com/oauth2/v1/tokens/bearer? HTTP/1.1\"\n\nhttpReq.setRequestHeader \"Accept\", \"application/json\"\nhttpReq.setRequestHeader \"Authorization\", sBase64\nhttpReq.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\nhttpReq.setRequestHeader \"Host\", \"oauth.platform.intuit.com\"\n\nsBody = \"grant_type=authorization_code&amp;code=\" &amp; skey &amp; \"&amp;redirect_uri=http://localhost\"\n\nhttpReq.send sBody\n</code></pre>\n\n<p>The error I get is a 401 and it description is {\"error\":\"invalid_client\"}</p>\n\n<p>I have been working on this for days, there is very little documentation for using VBA on oAuth2 process and none with Quickbooks, but I have to believe someone, somewhere has to have done this with Quickbooks before and that the above code is close to working. </p>\n\n<p>I have been using this document from intuit:\n<a href=\"https://developer.intuit.com/docs/00_quickbooks_online/2_build/10_authentication_and_authorization/10_oauth_2.0#/Sample_code\" rel=\"nofollow noreferrer\">https://developer.intuit.com/docs/00_quickbooks_online/2_build/10_authentication_and_authorization/10_oauth_2.0#/Sample_code</a></p>\n\n<p>The above code is translated into VBA from this:</p>\n\n<pre><code>POST https://oauth.platform.intuit.com/oauth2/v1/tokens/bearer HTTP/1.1\nAccept: application/json\nAuthorization: Basic UTM0dVBvRDIwanp2OUdxNXE1dmlMemppcTlwM1d2\nNzRUdDNReGkwZVNTTDhFRWwxb0g6VEh0WEJlR3dheEtZSlVNaFhzeGxma1l\nXaFg3ZlFlRzFtN2szTFRwbw==\nContent-Type: application/x-www-form-urlencoded\nHost: oauth.platform.intuit.com\nBody: grant_type=authorization_code&amp;\ncode=L3114709614564VSU8JSEiPkXx1xhV8D9mv4xbv6sZJycibMUI&amp;\nredirect_uri=https://www.mydemoapp.com/oauth-redirect\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9295902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e0e9373037ea8fa321ed144870d2cb?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Martinez", "link": "https://stackoverflow.com/users/9295902/joshua-martinez"}, "edited": false, "score": 0, "creation_date": 1519417126, "post_id": 48913254, "comment_id": 84918015, "body": "Thank you so much. It works. Now I&#39;m just trying to figure out how to make it paste at the first empty cell in column A. And make it delete what it copied from &quot;Active&quot; sheet after it pastes it into &quot;Geoff&quot; sheet."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1519238648, "creation_date": 1519238648, "answer_id": 48913254, "question_id": 48913226, "link": "https://stackoverflow.com/questions/48913226/find-certain-text-copy-and-paste-into-new-sheet/48913254#48913254", "title": "Find certain text, copy and paste into new sheet", "body": "<pre><code>r.EntireRow.Copy w2.Cells(K, 1)\n</code></pre>\n\n<p>should work</p>\n\n<p>Or if you want to be more selective:</p>\n\n<pre><code>r.EntireRow.Cells(1).Resize(1, numColsToCopy).Copy w2.Cells(K, 1)\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9295902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e0e9373037ea8fa321ed144870d2cb?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Martinez", "link": "https://stackoverflow.com/users/9295902/joshua-martinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 48913254, "answer_count": 1, "score": 1, "last_activity_date": 1519238648, "creation_date": 1519238528, "last_edit_date": 1531164843, "question_id": 48913226, "link": "https://stackoverflow.com/questions/48913226/find-certain-text-copy-and-paste-into-new-sheet", "title": "Find certain text, copy and paste into new sheet", "body": "<p>I have this code here that goes through my sheet column C and and find all the cells with \"Geoff\" in it and copies it and pastes it in \"Geoff\" sheet from active sheet. what I need it to accomplish is copying the whole row and pasting it into \"Geoff\" sheet.</p>\n\n<pre><code>Dim K As Long, r As Range, v As Variant\nK = 1\nDim w1 As Worksheet, w2 As Worksheet\nSet w1 = Sheets(\"Active\")\nSet w2 = Sheets(\"Geoff\")\nw1.Activate\nFor Each r In Intersect(Range(\"C:C\"), ActiveSheet.UsedRange)\n    v = r.Value\n    If InStr(v, \"Geoff\") &gt; 0 Then\n        r.Copy w2.Cells(K, 1)\n        K = K + 1\n    End If\nNext r\n</code></pre>\n\n<p>it only copies Geoff from Column C I need it to copy the entire row. Any help or ideas?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1519239629, "post_id": 48913002, "comment_id": 84833272, "body": "See <a href=\"http://www.vbforums.com/showthread.php?640709-RESOLVED-Outlook-WithEvents-Compile-Error-quot-Only-valid-in-object-module-quot\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 13, "user_id": 8357095, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MyXLTMPGGLA/AAAAAAAAAAI/AAAAAAAAA2Y/Rb22vexJngc/photo.jpg?sz=128", "display_name": "Chai Ben Shabat", "link": "https://stackoverflow.com/users/8357095/chai-ben-shabat"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1519551779, "post_id": 48913002, "comment_id": 84949396, "body": "I mange to get it work, but now the event is not happening... Any thoughts?"}], "answers": [{"comments": [{"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "reply_to_user": {"reputation": 13, "user_id": 8357095, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MyXLTMPGGLA/AAAAAAAAAAI/AAAAAAAAA2Y/Rb22vexJngc/photo.jpg?sz=128", "display_name": "Chai Ben Shabat", "link": "https://stackoverflow.com/users/8357095/chai-ben-shabat"}, "edited": false, "score": 0, "creation_date": 1519301831, "post_id": 48913524, "comment_id": 84860498, "body": "You shouldn&#39;t be. I verified it does work pasted in a class module. Are you sure you actually inserted a class module? Try using the <code>Insert</code> menu which has <code>Class Module</code> and <code>Module</code> both listed and choosing the <code>Class Module</code>."}], "tags": [], "owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "is_accepted": false, "score": 0, "last_activity_date": 1519239709, "creation_date": 1519239709, "answer_id": 48913524, "question_id": 48913002, "link": "https://stackoverflow.com/questions/48913002/only-valid-in-object-module/48913524#48913524", "title": "Only valid in object module", "body": "<p>I'm presuming this code is currently on a standard VBA module. You cannot have an <code>WithEvents</code> variable on such modules. It must be either a class module or a document module (e.g. one of Outlook's code-behind for instance) in order to receive events from that mail item. </p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8357095, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MyXLTMPGGLA/AAAAAAAAAAI/AAAAAAAAA2Y/Rb22vexJngc/photo.jpg?sz=128", "display_name": "Chai Ben Shabat", "link": "https://stackoverflow.com/users/8357095/chai-ben-shabat"}, "edited": false, "score": 0, "creation_date": 1520254052, "post_id": 48933719, "comment_id": 85226707, "body": "I added all to ThisOutlookSession module and it&#39;s wokring great! Thank you for your response."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 0, "last_activity_date": 1519768325, "last_edit_date": 1519768325, "creation_date": 1519320429, "answer_id": 48933719, "question_id": 48913002, "link": "https://stackoverflow.com/questions/48913002/only-valid-in-object-module/48933719#48933719", "title": "Only valid in object module", "body": "<p><em>The following vba code Must be under ThisOutlookSession module</em> </p>\n\n<pre><code>Private WithEvents myItem As outlook.MailItem\nPrivate Sub myItem_AttachmentRead(ByVal myAttachment As Outlook.Attachment)\n\n If myAttachment.Type = olByValue Then\n\n MsgBox \"If you change this file, also save your changes to the original file.\"\n\n End If\n\nEnd Sub\n</code></pre>\n\n<p><em>And the following vba code could be on regular module</em></p>\n\n<pre><code>Public Sub TestAttachRead()\n\n Dim atts As Outlook.Attachments\n\n Dim myAttachment As Outlook.Attachment\n\n Set myItem = Application.ActiveExplorer.CurrentFolder.Items(\"Test\")\n\n Set atts = myItem.Attachments\n\n myItem.Display\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8357095, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MyXLTMPGGLA/AAAAAAAAAAI/AAAAAAAAA2Y/Rb22vexJngc/photo.jpg?sz=128", "display_name": "Chai Ben Shabat", "link": "https://stackoverflow.com/users/8357095/chai-ben-shabat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3122, "favorite_count": 0, "accepted_answer_id": 48933719, "answer_count": 2, "score": 0, "last_activity_date": 1593069937, "creation_date": 1519237711, "last_edit_date": 1593069937, "question_id": 48913002, "link": "https://stackoverflow.com/questions/48913002/only-valid-in-object-module", "title": "Only valid in object module", "body": "<p>I'm getting this error:</p>\n\n<blockquote>\n  <p>only valid in object module  </p>\n</blockquote>\n\n<p>when I'm trying to run the script below on VBA outlook 2016. </p>\n\n<pre><code>Private WithEvents myItem As outlook.MailItem\n\nPrivate Sub myItem_AttachmentRead(ByVal myAttachment As Outlook.Attachment)\n\n If myAttachment.Type = olByValue Then\n\n MsgBox \"If you change this file, also save your changes to the original file.\"\n\n End If\n\nEnd Sub\n\n\nPublic Sub TestAttachRead()\n\n Dim atts As Outlook.Attachments\n\n Dim myAttachment As Outlook.Attachment\n\n Set myItem = Application.ActiveExplorer.CurrentFolder.Items(\"Test\")\n\n Set atts = myItem.Attachments\n\n myItem.Display\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "autofilter"], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 4, "last_activity_date": 1519238234, "last_edit_date": 1519238234, "creation_date": 1519237888, "answer_id": 48913052, "question_id": 48913000, "link": "https://stackoverflow.com/questions/48913000/is-it-possible-to-specify-dynamic-range-in-auto-filter-syntax/48913052#48913052", "title": "Is it possible to specify dynamic range in auto filter syntax?", "body": "<p>You could use <code>Cells()</code> within <code>Range()</code>:</p>\n\n<pre><code>...Range(Cells(1,1),Cells(lastRow,myCol))...\n</code></pre>\n\n<p><code>Cells(1,1)</code> is the cell <code>A1</code>.  The format is <code>Cells([row],[column])</code></p>\n\n<p>Edit: Just realized you could also use <code>Range(\"A1\",Cells(lastRow,myCol))</code>.  Personally, if I use <code>Cells()</code> I do it in both places in <code>Range()</code>, but that's personal preference and this other way should work for you too.</p>\n"}], "owner": {"reputation": 70, "user_id": 9160429, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9526a011bd7f2900e60c5cefb2484be4?s=128&d=identicon&r=PG&f=1", "display_name": "D. Ace", "link": "https://stackoverflow.com/users/9160429/d-ace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 48913052, "answer_count": 1, "score": 1, "last_activity_date": 1519238234, "creation_date": 1519237704, "question_id": 48913000, "link": "https://stackoverflow.com/questions/48913000/is-it-possible-to-specify-dynamic-range-in-auto-filter-syntax", "title": "Is it possible to specify dynamic range in auto filter syntax?", "body": "<p>I have written below code to apply auto filter. Code is working fine. However I have specified static range, here: <code>*Range(\"A1\", **\"M\"** &amp; lastRow).AutoFilter*</code> .\nIs there a way to replace <code>\"M\"</code> with last existing column number in sheet2.\nI have calculated last existing column <code>*myCol = rngFound.Column - 1*</code>. But not sure how to use it.\nPlease help !!!</p>\n\n<p>My Code:</p>\n\n<pre><code>Sub testfilter1()\nDim lastRow As Long\nDim myCol As Long\nDim rngFound As Range\n\nThisWorkbook.Sheets(\"sheet2\").Activate\n\n lastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n        Set rngFound = ActiveSheet.Rows(1).Find(What:=\"\", LookIn:=xlValues, LookAt:=xlWhole, _\n            SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False)\n\n            myCol = rngFound.Column - 1 ' this will give last used column\n\nRows(\"1:1\").Select\nSelection.AutoFilter\nActiveSheet.Range(\"A1\", \"M\" &amp; lastRow).AutoFilter Field:=4, Criteria1:=\"*somename*\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "select", "range", "vba"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1519238467, "creation_date": 1519238467, "answer_id": 48913214, "question_id": 48912494, "link": "https://stackoverflow.com/questions/48912494/select-range-a1-to-the-lastrow-in-column-a/48913214#48913214", "title": "Select range A1 to the lastrow in column A", "body": "<p>There are various ways. If you are using CurrentRegion you scarcely need the variable (but this only detects contiguous blocks of data). And don't use Select - usually unecessary and slows your code down.</p>\n\n<pre><code>Sub x()\n\nDim sht As Worksheet\nDim LastRow As Long\n\nSet sht = ActiveSheet\n\nLastRow = sht.Range(\"A1\").CurrentRegion.Rows.Count\n\n'everything works properly up to this point\n\nsht.Range(\"A1\", sht.Range(\"A\" &amp; LastRow)).Select\n'sht.Range(\"A1\").Resize(LastRow).Select\n'sht.Range(\"A1\", sht.Cells(LastRow, 1)).Select\n'sht.Range(\"A1\", sht.Cells(LastRow, \"A\")).Select\n'sht.Range(\"A1\").CurrentRegion.Resize(, 1).Select ' this one doesn't need LastRow\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7099, "favorite_count": 0, "accepted_answer_id": 48913214, "answer_count": 1, "score": 0, "last_activity_date": 1519238467, "creation_date": 1519235806, "last_edit_date": 1531164843, "question_id": 48912494, "link": "https://stackoverflow.com/questions/48912494/select-range-a1-to-the-lastrow-in-column-a", "title": "Select range A1 to the lastrow in column A", "body": "<p>I'm new to VBA so sorry if this is an elementary question. I am trying to select a range from A1 down to the last cell in column A using the Dim LastRow.\nMy code as follows.</p>\n\n<pre><code>Sub\n\nDim sht As Worksheet\n\nDim LastRow As Long\n\nSet sht = ActiveSheet\n\nLastRow = sht.range(\"A1\").CurrentRegion.Rows.Count\n\n'everything works properly up to this point\n\nrange(A,LastRow\").Select\n\nEnd Sub \n</code></pre>\n\n<p>I know the problem is with that last line of code... I just don't know how to properly refer to a range variable to select it. \nThanks for you help! </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 1, "creation_date": 1519232943, "post_id": 48911579, "comment_id": 84829593, "body": "No, the <code>.Find</code> method returns a range object. There is an example on the documentation page. <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-find-method-excel\" rel=\"nofollow noreferrer\">MSDN</a>"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 2, "last_activity_date": 1519234016, "last_edit_date": 1519234016, "creation_date": 1519233127, "answer_id": 48911715, "question_id": 48911579, "link": "https://stackoverflow.com/questions/48911579/if-statement-checking-if-one-of-two-strings-is-on-the-worksheet/48911715#48911715", "title": "If statement, checking if one of two strings is on the worksheet", "body": "<p>You can use two range variables:</p>\n\n<pre><code>Sub t()\nDim foundRange1 As Range, foundRange2 As Range\nDim varID As String\nSet foundRange1 = ActiveWorkbook.ActiveSheet.Range(\"A1:BZ999\").Find(\"AAA\")\nSet foundRange2 = ActiveWorkbook.ActiveSheet.Range(\"A1:BZ999\").Find(\"BBB\")\nIf Not foundRange1 Is Nothing Then ' If foundRange is *not* empty (Nothing), then it found the string.\n    varID = \"AAA\"\n    MsgBox varID\nElseIf Not foundRange2 Is Nothing Then\n    varID = \"BBB\"\n    MsgBox varID\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Alternatively, if you have a bunch of strings, you can use something like this loop:</p>\n\n<pre><code>Sub t2()\nDim strings() As Variant\nDim varID As String\n\nstrings = Array(\"AAA\", \"BBB\", \"CCC\", \"DDD\")\n\nDim i As Long\ni = 0\n\nFor i = LBound(strings) To UBound(strings)\n    Do While Not ActiveWorkbook.ActiveSheet.Range(\"A1:BZ999\").Find(strings(i)) Is Nothing\n        varID = strings(i)\n        MsgBox (varID)\n        Exit For\n    Loop\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 655, "user_id": 5183031, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ea1e2e43efd4e65f4b06cff36e36f1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Riply", "link": "https://stackoverflow.com/users/5183031/mr-riply"}, "edited": false, "score": 0, "creation_date": 1519233324, "post_id": 48911716, "comment_id": 84829829, "body": "yeah, just saw the MsgBox syntax, it was an accident, don&#39;t really care about it. I was trying to simplify the issue. Thank you"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1519236039, "post_id": 48911716, "comment_id": 84831424, "body": "You should be able to  shrink this down to an inline query: <code>If Not(ActiveWorkbook.ActiveSheet.Range(&quot;A1:BZ999&quot;).Find(&quot;AAA&quot;) Is Nothing) Then</code>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1519240856, "post_id": 48911716, "comment_id": 84833897, "body": "@Chronocidal For teaching purposes, I chose to make minimal changes to the OP&#39;s code.  If your goal is short code (fewest keystrokes), the following is equivalent: <code>If Not [a1:bz999].Find(&quot;AAA&quot;) Is Nothing Then</code>"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1519249132, "post_id": 48911716, "comment_id": 84838279, "body": "@RonRosenfeld Ah, I made my comment because I thought that running the evaluation inline was less of a change to the code than adding an extra object and splitting each <code>If</code> into two lines."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1519251824, "post_id": 48911716, "comment_id": 84839503, "body": "@Chronocidal Just goes to show there are different approaches, and many different ways of solving a problem. In general, I prefer to work with defined objects; I find subsequent debugging easier, but YMMV."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 3, "last_activity_date": 1519238136, "last_edit_date": 1519238136, "creation_date": 1519233128, "answer_id": 48911716, "question_id": 48911579, "link": "https://stackoverflow.com/questions/48911579/if-statement-checking-if-one-of-two-strings-is-on-the-worksheet/48911716#48911716", "title": "If statement, checking if one of two strings is on the worksheet", "body": "<p>You need to first check if there is a found range object.\nAlso your syntax for MsgBox is incorrect:</p>\n\n<pre><code>Dim R       As Range\nSet R = ActiveWorkbook.ActiveSheet.Range(\"A1:BZ999\").Find(\"AAA\")\n\nIf Not R Is Nothing Then\n    VarID = \"AAA\"\n    MsgBox VarID\nElse\n    Set R = ActiveWorkbook.ActiveSheet.Range(\"A1:BZ999\").Find(\"BBB\")\n    If Not R Is Nothing Then\n        VarID = \"BBB\"\n        MsgBox VarID\n    End If\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1519233212, "creation_date": 1519233212, "answer_id": 48911752, "question_id": 48911579, "link": "https://stackoverflow.com/questions/48911579/if-statement-checking-if-one-of-two-strings-is-on-the-worksheet/48911752#48911752", "title": "If statement, checking if one of two strings is on the worksheet", "body": "<p>Perhaps:</p>\n\n<pre><code>Sub qwerty()\nIf Not ActiveWorkbook.ActiveSheet.Range(\"A1:BZ999\").Find(\"AAA\") Is Nothing Then\n\n        VarID = \"AAA\"\n        MsgBox VarID\n\n    ElseIf Not ActiveWorkbook.ActiveSheet.Range(\"A1:BZ999\").Find(\"BBB\") Is Nothing Then\n\n        VarID = \"BBB\"\n        MsgBox VarID\n\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1519233281, "creation_date": 1519233281, "answer_id": 48911774, "question_id": 48911579, "link": "https://stackoverflow.com/questions/48911579/if-statement-checking-if-one-of-two-strings-is-on-the-worksheet/48911774#48911774", "title": "If statement, checking if one of two strings is on the worksheet", "body": "<p>Another way to perform what other answers have expressed is the issue of the <code>.Find</code> function returning a range object:</p>\n\n<pre><code>Dim mySheet As Worksheet\nSet mySheet = Worksheets(\"Sheet1\") 'change as needed\n\nWith mySheet\n\n    Dim searchRng As Range\n    Set searchRng = .Range(\"A1:BZ999\")\n\nEnd With\n\nWith searchRng\n\n    If Not .Find(\"AAA\") Is Nothing Then\n\n        varID = \"AAA\"\n\n    ElseIf Not .Find(\"BBB\") Is Nothing Then\n\n        varID = \"BBB\"\n\n    End If\n\nEnd With\n\nMsgBox varID\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "is_accepted": false, "score": 1, "last_activity_date": 1519233309, "creation_date": 1519233309, "answer_id": 48911783, "question_id": 48911579, "link": "https://stackoverflow.com/questions/48911579/if-statement-checking-if-one-of-two-strings-is-on-the-worksheet/48911783#48911783", "title": "If statement, checking if one of two strings is on the worksheet", "body": "<p>You just have to declare <code>VarID</code> as <code>Variant</code> and remove the <code>=</code> in MsgBox:</p>\n\n<pre><code>Sub find()\n\nDim VarID As Variant\n\n    If ActiveWorkbook.ActiveSheet.Range(\"A1:BZ999\").Find(\"AAA\") = \"AAA\" Then\n\n        VarID = \"AAA\"\n        MsgBox VarID\n\n    ElseIf ActiveWorkbook.ActiveSheet.Range(\"A1:BZ999\").Find(\"BBB\") = \"BBB\" Then\n\n        VarID = \"BBB\"\n        MsgBox VarID\n\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 655, "user_id": 5183031, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ea1e2e43efd4e65f4b06cff36e36f1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Riply", "link": "https://stackoverflow.com/users/5183031/mr-riply"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 48911716, "answer_count": 5, "score": 0, "last_activity_date": 1519252453, "creation_date": 1519232696, "last_edit_date": 1519252453, "question_id": 48911579, "link": "https://stackoverflow.com/questions/48911579/if-statement-checking-if-one-of-two-strings-is-on-the-worksheet", "title": "If statement, checking if one of two strings is on the worksheet", "body": "<p>I am stuck on this simple if statement. If the string \"AAA\" is not on the sheet, but string \"BBB\" is. The code will not go to the ElseIf line of the code, but it will only throw an error. </p>\n\n<blockquote>\n  <p>Run time error 91: object variable or with block not set</p>\n</blockquote>\n\n<p>I have tried many different variations of the code, I will not post all of them as they all give me some sort of an error. :/</p>\n\n<pre><code>    If ActiveWorkbook.ActiveSheet.Range(\"A1:BZ999\").Find(\"AAA\") = \"AAA\" Then\n\n        VarID= \"AAA\"\n        MsgBox = VarID\n\n    ElseIf ActiveWorkbook.ActiveSheet.Range(\"A1:BZ999\").Find(\"BBB\") = \"BBB\" Then\n\n        VarID= \"BBB\"\n        MsgBox = VarID\n\n    End If\n</code></pre>\n\n<p>Disregard the = sign next to MsgBox, MsgBox used just for simplification of the issue</p>\n"}, {"tags": ["mysql", "ms-access", "vba", "union-all"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1519232741, "post_id": 48911356, "comment_id": 84829448, "body": "That&#39;s a terrible reason not to use hyperlinks. <code>Application.FollowHyperlink &quot;location_of_my_pdf&quot;</code> will automatically open it in the default reader, be it acrobat or reader.exe, and there are many other ways to open PDFs as well. You can even open a PDF inside Access by using a webbrowser control."}, {"owner": {"reputation": 456, "user_id": 7304157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/L8EC8.gif?s=128&g=1", "display_name": "tanvi", "link": "https://stackoverflow.com/users/7304157/tanvi"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1519233602, "post_id": 48911356, "comment_id": 84829987, "body": "@ErikvonAsmuth, I get an error message saying that &lt;myUsername&gt; does not have access to open &lt;readerName&gt;.exe  I tried this already with Acrobat Pro and Acrobat Reader. This is why I switched to using Attachments in the first place.  About opening PDFs inside Access - could you please elaborate on how I could use the webbrowser control?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1519234148, "post_id": 48911356, "comment_id": 84830354, "body": "Well, the web browser control just displays a web page. You can embed pdf&#39;s inside web pages. See <a href=\"https://stackoverflow.com/questions/291813/recommended-way-to-embed-pdf-in-html\">here</a> for how to embed pdfs in web pages. If you ask a specific question about that, I can try to come up with a specific answer."}, {"owner": {"reputation": 456, "user_id": 7304157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/L8EC8.gif?s=128&g=1", "display_name": "tanvi", "link": "https://stackoverflow.com/users/7304157/tanvi"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1519234347, "post_id": 48911356, "comment_id": 84830456, "body": "@ErikvonAsmuth Thank you, I will post a different question for that if I am not able to find substantial info online! :)"}], "owner": {"reputation": 456, "user_id": 7304157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/L8EC8.gif?s=128&g=1", "display_name": "tanvi", "link": "https://stackoverflow.com/users/7304157/tanvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519233721, "creation_date": 1519232079, "last_edit_date": 1519233721, "question_id": 48911356, "link": "https://stackoverflow.com/questions/48911356/combining-2-tables-with-attachments-i-e-multivalued-fields-in-ms-access-13", "title": "Combining 2 tables with attachments i.e., multivalued fields in MS Access 13", "body": "<p>I have two tables in MS Access that contain exactly three columns; a primary key, and two attachment fields which will be either MS Word or PDF documents. </p>\n\n<p>These two tables contain a range of documents (A to P in the first table and Q to Z in the second table). </p>\n\n<p>I need to perform a union query to get a resultant table with these three fields where the range is A to Z but I cannot, because of the multi-valued (attachment) fields that prevent a UNION query from being executed. </p>\n\n<p>I cannot simply store all the data in one table to begin with because they are linked tables from another database that have to be combined in a different database. </p>\n\n<p>Is there any way to have all three columns put into one table? I'm open to suggestions about changing the data type as well, but keep in mind that I could not use Hyperlinks because I am at a client terminal that only has acrobat reader and I do not have access to ACROBAT.EXE to open the PDF files (which is why I switched to attachments in the first place), and I cannot run Shell commands to find the Reader exe file either.</p>\n\n<p>Edit:  I get an error message saying that 'myUsername' does not have access to open 'readerName'.exe. I tried this already with Acrobat Pro and Acrobat Reader.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1519231248, "post_id": 48910689, "comment_id": 84828384, "body": "What formulas have you tried? Should be a more or less simple one, checking if the date is equal, then if that date is a Monday."}, {"owner": {"reputation": 107, "user_id": 4840382, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58df1d57edd5ca9e48f017593974bf0b?s=128&d=identicon&r=PG&f=1", "display_name": "Surmeet", "link": "https://stackoverflow.com/users/4840382/surmeet"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1519232574, "post_id": 48910689, "comment_id": 84829336, "body": "Tried this =IF(J3,VLOOKUP(J3,Parameters!A2:A54,1)) but it is taking numerical value instead of date where J3 is the particular date value cell and Parameter!A2:A54 is the date range having all mondays."}], "answers": [{"comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1519239403, "post_id": 48911573, "comment_id": 84833169, "body": "For the conditional formatting, if you want to highlight the same day of the week as the date you entered, you can use this formula: <code>=WEEKDAY($A2)=WEEKDAY($J$3)</code>"}], "tags": [], "owner": {"reputation": 1355, "user_id": 3097559, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lvowV.jpg?s=128&g=1", "display_name": "tysonwright", "link": "https://stackoverflow.com/users/3097559/tysonwright"}, "is_accepted": true, "score": 1, "last_activity_date": 1519232689, "creation_date": 1519232689, "answer_id": 48911573, "question_id": 48910689, "link": "https://stackoverflow.com/questions/48910689/highlight-cells-if-a-particular-date-falls-in-range-of-dates-in-excel/48911573#48911573", "title": "Highlight cells if a particular date falls in range of dates in Excel", "body": "<p>If you just want to highlight the cell if it's a Monday, you don't need to lookup a range of dates. Add a new conditional formatting rule with this formula (assuming the cell you want to format is F3):</p>\n\n<pre><code>=WEEKDAY($F$3) = 2\n</code></pre>\n\n<p>On the other hand, if you really want to match to a list on Sheet 2, cells A1 - A3, use the following formula:</p>\n\n<pre><code>=IF(ISNUMBER(MATCH(F3,Sheet2!A1:A3,0)),1,0)\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 4840382, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58df1d57edd5ca9e48f017593974bf0b?s=128&d=identicon&r=PG&f=1", "display_name": "Surmeet", "link": "https://stackoverflow.com/users/4840382/surmeet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 48911573, "answer_count": 1, "score": -2, "last_activity_date": 1519232689, "creation_date": 1519230065, "last_edit_date": 1531161705, "question_id": 48910689, "link": "https://stackoverflow.com/questions/48910689/highlight-cells-if-a-particular-date-falls-in-range-of-dates-in-excel", "title": "Highlight cells if a particular date falls in range of dates in Excel", "body": "<p>I want to put conditional formatting for below:</p>\n\n<p>In a particular cell if I enter a date value as 12-Feb-18, then it searches in another worksheet a date range containing all Mondays like 01-Jan-18, 08-Jan-18, 15-Jan-18 and so on. If the value entered is a correct value then No highlighting is required, if value is not a Monday then cell value should be highlighted.</p>\n\n<p>Please help.</p>\n"}, {"tags": ["vba", "excel", "copy", "display"], "answers": [{"comments": [{"owner": {"reputation": 5048, "user_id": 68348, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5bf50e2e9914ce342c80377f77051300?s=128&d=identicon&r=PG", "display_name": "tintincutes", "link": "https://stackoverflow.com/users/68348/tintincutes"}, "edited": false, "score": 0, "creation_date": 1519599850, "post_id": 48910862, "comment_id": 84963891, "body": "Thank you so much for your corrections and help. I would like to add a drop down box where it says please enter a value. Is that possible?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1519231880, "last_edit_date": 1519231880, "creation_date": 1519230598, "answer_id": 48910862, "question_id": 48910682, "link": "https://stackoverflow.com/questions/48910682/copy-function-in-vba/48910862#48910862", "title": "Copy function in VBA", "body": "<p>In general, from your screenshot, \"Mailbox\" is in column <code>D</code>, and you are checking column <code>E</code>. Write \"Mailbox\" in column <code>E</code> and it should work.</p>\n\n<hr>\n\n<p>Nevertheless:</p>\n\n<p>The problem is that you do not refer to the worksheet, thus VBA refers to the <code>ActiveSheet</code>. E.g., instead of:</p>\n\n<pre><code>Range(\"E\" &amp; CStr(LSearchRow)).Value = LSearchValue\n</code></pre>\n\n<p>you should write:</p>\n\n<pre><code>Worksheets(2).Range(\"E\" &amp; CStr(LSearchRow)).Value = LSearchValue\n</code></pre>\n\n<p>Or instead of:</p>\n\n<pre><code>While Len(Range(\"A\" &amp; CStr(LSearchRow)).Value) &gt; 0\n</code></pre>\n\n<p>the code should be like this:</p>\n\n<pre><code>While Len(Worksheets(1).Range(\"A\" &amp; CStr(LSearchRow)).Value) &gt; 0\n</code></pre>\n\n<p>Thus, try to rewrite the code, defining correctly the <code>Range</code>, <code>Column</code>, <code>Rows</code>, <code>Cell</code> with the corresponding <code>Worksheet(1)</code> and it should probably work. In general, using <code>Select</code> and <code>ActiveCell</code> is considered bad practice - <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>, but it is the first step, when you going from recording macros to VBA writing.</p>\n"}, {"comments": [{"owner": {"reputation": 5048, "user_id": 68348, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5bf50e2e9914ce342c80377f77051300?s=128&d=identicon&r=PG", "display_name": "tintincutes", "link": "https://stackoverflow.com/users/68348/tintincutes"}, "edited": false, "score": 0, "creation_date": 1519599760, "post_id": 48911347, "comment_id": 84963877, "body": "Thank you very much for your message. I obviously had the columns wrong. When I changed it; then it worked. But somehow I had to update the code. I am stuck a bit with the &quot;Please enter a value&quot; would that be possible to have a drop down there instead. Like a combo box?"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 5048, "user_id": 68348, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5bf50e2e9914ce342c80377f77051300?s=128&d=identicon&r=PG", "display_name": "tintincutes", "link": "https://stackoverflow.com/users/68348/tintincutes"}, "edited": false, "score": 0, "creation_date": 1519620026, "post_id": 48911347, "comment_id": 84968163, "body": "Sure - remove the inputbox line and set <code>LSearchValue =</code> to the cell value you want to check (example: <code>LSearchValue = Sheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;)</code>). Then, just use data validation or whatever else to create a dropdown list from a range."}], "tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": false, "score": 2, "last_activity_date": 1519232553, "last_edit_date": 1519232553, "creation_date": 1519232059, "answer_id": 48911347, "question_id": 48910682, "link": "https://stackoverflow.com/questions/48910682/copy-function-in-vba/48911347#48911347", "title": "Copy function in VBA", "body": "<p>Instead of using <code>Select</code>, you can simply stay what cell you're actually looking for as Vityata said.</p>\n\n<p>All the selecting will slow you down.</p>\n\n<p>Instead of:</p>\n\n<pre><code>Sheets(\"Sheet2\").Select\nRange(\"A5\").Select\nActiveCell.Copy\n</code></pre>\n\n<p>You can simply do</p>\n\n<pre><code>Sheets(\"Sheet2\").Range(\"A5\").Copy\n</code></pre>\n\n<p>You may also consider using <code>With</code> statements if you're going to be referencing a sheet a lot.</p>\n\n<p><code>With</code> statements let you leave off parts of the string.</p>\n\n<p>So you can simply say:</p>\n\n<pre><code>With Sheets(\"Sheet1\")\n    .Cells(1,1) = \"Hi\"    'Same as Sheets(\"Sheet1\").Cells(1,1)\n    .Cells(1,2) = \"Hello\" 'Same as Sheets(\"Sheet1\").Cells(1,2)\nEnd With\n</code></pre>\n\n<p>Just a few pointers - let me know if you have any questions.</p>\n\n<p>Here's your code simplified.</p>\n\n<pre><code>Sub SearchForString()\nDim c, LSearchValue, LSearchRow, LCopyToRow, LastRow\nOn Error GoTo ErrHandle\nLSearchValue = InputBox(\"Please enter a value to search for.\", \"Enter value\")\nLastRow = Sheets(\"Sheet1\").Cells(Rows.CountLarge, \"D\").End(xlUp).Row\nLSearchRow = 4\nLCopyToRow = 2\nFor Each c In Sheets(\"Sheet1\").Range(\"D\" &amp; LSearchRow &amp; \":D\" &amp; LastRow)\n    If c = LSearchValue Then\n        c.EntireRow.Copy Sheets(\"Sheet2\").Cells(LCopyToRow, \"A\")\n        LCopyToRow = LCopyToRow + 1\n    End If\nNext c\nApplication.CutCopyMode = False\nMsgBox \"All matching data has been copied.\"\nExit Sub\nErrHandle: MsgBox \"An Error Has Occured: \" &amp; Err.Description\nEnd Sub\n</code></pre>\n\n<p>Sheet1 Input:</p>\n\n<p><a href=\"https://i.stack.imgur.com/OsWd5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OsWd5.png\" alt=\"Input\"></a></p>\n\n<p>Sheet2 Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qPndI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qPndI.png\" alt=\"Sheet2 Output\"></a></p>\n"}], "owner": {"reputation": 5048, "user_id": 68348, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5bf50e2e9914ce342c80377f77051300?s=128&d=identicon&r=PG", "display_name": "tintincutes", "link": "https://stackoverflow.com/users/68348/tintincutes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1811, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1519600621, "creation_date": 1519230053, "last_edit_date": 1519600621, "question_id": 48910682, "link": "https://stackoverflow.com/questions/48910682/copy-function-in-vba", "title": "Copy function in VBA", "body": "<p>Thank you so much for the support. I saw where the mistake was. </p>\n\n<p>I wonder if its possible to make the input box as a drop down as well? </p>\n\n<hr>\n\n<p>This code seems not to copy to \"Sheet2\"</p>\n\n<p>I have this data set<a href=\"https://i.stack.imgur.com/tYPdH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tYPdH.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/YfTsJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YfTsJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>But when I checked my \"Sheet2\" it is blank. Did I miss something? </p>\n\n<p>Thanks a lot for your advice</p>\n\n<p>`Sub SearchForString()</p>\n\n<pre><code>Dim LSearchRow As Integer\nDim LCopyToRow As Integer\nDim LSearchValue As String\n\nOn Error GoTo Err_Execute\n\nLSearchValue = InputBox(\"Please enter a value to search for.\", \"Enter value\")\n\n'Start search in row 4\nLSearchRow = 4\n\n'Start copying data to row 2 in Sheet2 (row counter variable)\nLCopyToRow = 2\n\nWhile Len(Range(\"A\" &amp; CStr(LSearchRow)).Value) &gt; 0\n\n    'If value in column E = LSearchValue, copy entire row to Sheet2\n    If Range(\"E\" &amp; CStr(LSearchRow)).Value = LSearchValue Then\n\n        'Select row in Sheet1 to copy\n        Rows(CStr(LSearchRow) &amp; \":\" &amp; CStr(LSearchRow)).Select\n        Selection.Copy\n\n        'Paste row into Sheet2 in next row\n        Sheets(\"Sheet2\").Select\n        Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Select\n        ActiveSheet.Paste\n\n        'Move counter to next row\n        LCopyToRow = LCopyToRow + 1\n\n        'Go back to Sheet1 to continue searching\n        Sheets(\"Sheet1\").Select\n\n    End If\n\n    LSearchRow = LSearchRow + 1\n\nWend\n\n'Position on cell A3\nApplication.CutCopyMode = False\nRange(\"A3\").Select\n\nMsgBox \"All matching data has been copied.\"\n\nExit Sub\n</code></pre>\n\n<p>Err_Execute:\n    MsgBox \"An error occurred.\"</p>\n\n<p>End Sub`</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1519229845, "post_id": 48910508, "comment_id": 84827365, "body": "If you create a blank worksheet, add code to the worksheet&#39;s code sheet and hide it, you can copy it or use it as a template for future new worksheets and the code will follow. Alternately you can opt for a Workbook_SheetChange event handler."}, {"owner": {"reputation": 3, "user_id": 5258374, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205819253175252/picture?type=large", "display_name": "Skibur", "link": "https://stackoverflow.com/users/5258374/skibur"}, "edited": false, "score": 0, "creation_date": 1519232157, "post_id": 48910508, "comment_id": 84829068, "body": "Question, how does Excel knows which worksheet to run the macros? I thought it was limited to only the selected worksheet it&#39;s focus? In this case, the code to update cell was hidden, but how does the code continue to run on another worksheet? Sounds like a override function happening in Excel?  Also the problem with this one is that I may want to only use the sub on certain worksheet instead of all."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1519232392, "post_id": 48910508, "comment_id": 84829222, "body": "A Worksheet_Change has only Target passed to it; a Workbook_SheetChange has Sh for the worksheet and Target. I like to use a Select Case to parse the worksheet name."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1519232519, "post_id": 48910508, "comment_id": 84829304, "body": "... and yes, your DataChange will require proper parent worksheet referencing for all range and cell calls but tbh, those should have been there from the start."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5258374, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205819253175252/picture?type=large", "display_name": "Skibur", "link": "https://stackoverflow.com/users/5258374/skibur"}, "edited": false, "score": 0, "creation_date": 1519232497, "post_id": 48910806, "comment_id": 84829285, "body": "Great answer, but how does it assign to specific worksheets?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1519234185, "post_id": 48910806, "comment_id": 84830374, "body": "The <code>Workbook_SheetChange</code> event will fire when <i>any</i> worksheet in the workbook is changed so it isn&#39;t assigned to a specific worksheet but to all worksheets.  The sheet being changed is held in the <code>sh</code> argument and the cells that were changed are held in the <code>Target</code> argument."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1519230433, "creation_date": 1519230433, "answer_id": 48910806, "question_id": 48910508, "link": "https://stackoverflow.com/questions/48910508/excel-vba-worksheet-change-event-assigned/48910806#48910806", "title": "Excel VBA Worksheet Change Event assigned", "body": "<p>I'd go for the last @Jeeped's suggestion</p>\n\n<p>place this code in <code>ThisWorkbook</code> code pane</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    DataChange Target ' this sub will be called at any change of any worksheet passing the chenged range\nEnd Sub\n</code></pre>\n\n<p>then place this in the same code pane or in any other Module</p>\n\n<pre><code>Public Sub DataChange(ByVal Target As Range)\n  ' this will check and see if the user or operator has change the column field\n  ' if they fill in \"X\", mark the whole row to red color\n  ' otherwise leave it black\n  Dim KeyCells As Range\n  Set KeyCells = Range(\"L2:L\" &amp; Cells(Rows.Count, 1).End(xlUp).Row)\n\n  If Not Application.Intersect(KeyCells, Target) Is Nothing Then Target.EntireRow.Font.color = IIf(UCase(Target.Value2) = \"X\", vbRed, vbBlack)\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5258374, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205819253175252/picture?type=large", "display_name": "Skibur", "link": "https://stackoverflow.com/users/5258374/skibur"}, "edited": false, "score": 0, "creation_date": 1519232038, "post_id": 48910871, "comment_id": 84828975, "body": "Interesting. This looks like explicitly creating subs on the fly rather than assigning pre-existing subs. Much more complex this way but that&#39;s a great alternative solution. Thanks!"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 5258374, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205819253175252/picture?type=large", "display_name": "Skibur", "link": "https://stackoverflow.com/users/5258374/skibur"}, "edited": false, "score": 0, "creation_date": 1519233421, "post_id": 48910871, "comment_id": 84829879, "body": "@Skibur I&#39;ve edited my answer to include a way to copy code from one worksheet to another, hope this helps. :)"}, {"owner": {"reputation": 3, "user_id": 5258374, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205819253175252/picture?type=large", "display_name": "Skibur", "link": "https://stackoverflow.com/users/5258374/skibur"}, "edited": false, "score": 0, "creation_date": 1519233568, "post_id": 48910871, "comment_id": 84829965, "body": "Even better! Thank you so much for your answer. I did mention that I wanted to apply this rule to only the newly created worksheet. So far this is the best solution."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 5258374, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205819253175252/picture?type=large", "display_name": "Skibur", "link": "https://stackoverflow.com/users/5258374/skibur"}, "edited": false, "score": 0, "creation_date": 1519233876, "post_id": 48910871, "comment_id": 84830168, "body": "@Skibur, another note, when referencing the Sheet name it should be the CodeName of the Sheet and not the tab Name, which you can get by using something like <code>Worksheets(&quot;Sheet1&quot;).CodeName</code>, hope this makes sense."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1519245562, "last_edit_date": 1519245562, "creation_date": 1519230617, "answer_id": 48910871, "question_id": 48910508, "link": "https://stackoverflow.com/questions/48910508/excel-vba-worksheet-change-event-assigned/48910871#48910871", "title": "Excel VBA Worksheet Change Event assigned", "body": "<p>As mentioned by Jeeped, probably the easiest way would be to copy the sheet that already had the <code>Private Sub Worksheet_Change</code> code behind it, but there is also another way, if you place the following code under <code>ThisWorkbook</code>, whenever a new sheet is created it will add the desired code behind it:</p>\n\n<pre><code>Private Sub Workbook_NewSheet(ByVal Sh As Object)\n    Dim NewSheet As Worksheet\n    Set NewSheet = Sheets(ActiveSheet.Name)\n    Code = \"Private Sub Worksheet_Change(ByVal Target As Range)\" &amp; vbCrLf\n    Code = Code &amp; \"MsgBox \"\"your code here\"\"\" &amp; vbCrLf\n    Code = Code &amp; \"End Sub\"\n    With ThisWorkbook.VBProject.VBComponents(NewSheet.Name).CodeModule\n    NextLine = .CountOfLines + 1\n    .InsertLines NextLine, Code\n    End With\nEnd Sub\n</code></pre>\n\n<p>The drawback here is that the Trust Settings for Macros would need to be changed by clicking on the <code>Trust access to the VBA project object model</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fyEsc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fyEsc.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>You could also copy code from one worksheet to another using a similar method:</p>\n\n<pre><code>Sub test()\nDim CodeCopy As VBIDE.CodeModule\nDim CodePaste As VBIDE.CodeModule\nDim numLines As Long\n\nSet CodeCopy = ActiveWorkbook.VBProject.VBComponents(\"Sheet1\").CodeModule\nSet CodePaste = ActiveWorkbook.VBProject.VBComponents(\"Sheet2\").CodeModule\n\nnumLines = CodeCopy.CountOfLines\n'Use this line to erase all code that might already be in sheet2\n'If CodePaste.CountOfLines &gt; 1 Then CodePaste.DeleteLines 1, CodePaste.CountOfLines\n\nCodePaste.AddFromString CodeCopy.Lines(1, numLines)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5258374, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205819253175252/picture?type=large", "display_name": "Skibur", "link": "https://stackoverflow.com/users/5258374/skibur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 48910871, "answer_count": 2, "score": 0, "last_activity_date": 1519245562, "creation_date": 1519229594, "last_edit_date": 1519229640, "question_id": 48910508, "link": "https://stackoverflow.com/questions/48910508/excel-vba-worksheet-change-event-assigned", "title": "Excel VBA Worksheet Change Event assigned", "body": "<p>Using Excel 2007, I understand that I can create worksheet_change event on the worksheet it's created.</p>\n\n<p>But how do I assign a global sub change events to a newly created worksheet? </p>\n\n<p>e.g. </p>\n\n<pre><code>Public Sub DataChange(ByVal Target As Range)\n  ' this will check and see if the user or operator has change the column field\n  ' if they fill in \"X\", mark the whole row to red color\n  ' otherwise leave it black\n  Dim KeyCells As Range\n  Dim LastRow As Long\n  LastRow = Cells(Rows.Count, 1).END(xlUp).Row\n  Set KeyCells = Range(\"L2:L\" &amp; LastRow)\n\n  If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n    Is Nothing Then\n    If Target.Value = \"X\" Or Target.Value = \"x\" Then\n        Target.EntireRow.Font.color = vbRed\n    Else\n        Target.EntireRow.Font.color = vbBlack\n    End If\n  End If\nEnd Sub\n</code></pre>\n\n<p>Then in a separate sub procedure in Module1...</p>\n\n<pre><code>Public Sub CreateWorkSheet() \n  Dim ws As Worksheet\n\n  Set ws = Sheets.Add\n  ws.Name = \"Test1\"\n  ' Here where I want to set the event but I do not know the syntax\n  ' ws.OnChange = DataChange\n\n  Debug.Print \"Done\"\n\nEnd Sub \n</code></pre>\n\n<p>I'm used to assign events on the fly when creating controls (C#/WPF/Pascal), so I figured there would be one in Excel world. Any advice or help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "post"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1519229491, "post_id": 48910428, "comment_id": 84827093, "body": "When you do a <code>POST</code> you send data. Are you submitting a form or something? Right now you are sending nothing. You would add the data on the <code>.send</code> line. GET returns data, like loading a page."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1519229567, "post_id": 48910428, "comment_id": 84827149, "body": "^^this^^ see <a href=\"https://stackoverflow.com/questions/29723571/post-website-form-data-and-retrieve-results/29724280#29724280\">example</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1519229654, "post_id": 48910428, "comment_id": 84827220, "body": "Does your API handle POST in the first place? If it does you can add debug output from it."}, {"owner": {"reputation": 11, "user_id": 9391919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19af94f0dc11f4d3dfa0cc587fb0240f?s=128&d=identicon&r=PG&f=1", "display_name": "tomekkp", "link": "https://stackoverflow.com/users/9391919/tomekkp"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1519230316, "post_id": 48910428, "comment_id": 84827699, "body": "Hi, API handle POST. I have a working powershell script sending the same with POST to retrieve list of workflows I can start with my powershell.  @Ryan-Wildry  thanks for the suggestion, however it seems it doesn&#39;t matter if I try to send any parameters or not. It literally acts like it doesn&#39;t recognize word &#39;POST&#39; (if I change it to &quot;Whatever&quot;) I get the same error."}, {"owner": {"reputation": 1179, "user_id": 4687466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ce36551a4b92edd40ac7b0c353a4e22?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Makarov", "link": "https://stackoverflow.com/users/4687466/mike-makarov"}, "edited": false, "score": 0, "creation_date": 1519230492, "post_id": 48910428, "comment_id": 84827825, "body": "You have probably used wrong URI or made typo... HTTP 405 means that for that exact endpoint you are calling, POST is <b>not</b> allowed."}, {"owner": {"reputation": 11, "user_id": 9391919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19af94f0dc11f4d3dfa0cc587fb0240f?s=128&d=identicon&r=PG&f=1", "display_name": "tomekkp", "link": "https://stackoverflow.com/users/9391919/tomekkp"}, "edited": false, "score": 0, "creation_date": 1519232124, "post_id": 48910428, "comment_id": 84829048, "body": "Yeah. I was SURE that&#39;s excel thing, that my request is not send.. And huh.. It was easier for me to:  google for like an hour, create this question, and after that I checked the logs from my API to see that&#39;s the responses from it. Thanks guys."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9391919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19af94f0dc11f4d3dfa0cc587fb0240f?s=128&d=identicon&r=PG&f=1", "display_name": "tomekkp", "link": "https://stackoverflow.com/users/9391919/tomekkp"}, "is_accepted": true, "score": 0, "last_activity_date": 1519233047, "creation_date": 1519233047, "answer_id": 48911687, "question_id": 48910428, "link": "https://stackoverflow.com/questions/48910428/post-not-working-while-get-works-fine-xmlhttp/48911687#48911687", "title": "POST not working, while GET works fine (xmlhttp)", "body": "<p>Upon further investigation there was nothing wrong with my VBA code. The response I got, was sent from my API. Thank you for comments, they helped me to resolve the issue by including XML body into xmlhttp.send command.</p>\n"}], "owner": {"reputation": 11, "user_id": 9391919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19af94f0dc11f4d3dfa0cc587fb0240f?s=128&d=identicon&r=PG&f=1", "display_name": "tomekkp", "link": "https://stackoverflow.com/users/9391919/tomekkp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 48911687, "answer_count": 1, "score": 1, "last_activity_date": 1519495699, "creation_date": 1519229291, "last_edit_date": 1519495699, "question_id": 48910428, "link": "https://stackoverflow.com/questions/48910428/post-not-working-while-get-works-fine-xmlhttp", "title": "POST not working, while GET works fine (xmlhttp)", "body": "<p>I'm writing an Excel macro to communicate with my API, and it seems I cannot send an request via POST, only GET is working.</p>\n\n<p>My code:</p>\n\n<pre><code>Private Sub button1_Click()\n   Dim xmlhttp As New MSXML2.xmlhttp, myurl As String\n   myurl = \"https://{my_url}\"\n   xmlhttp.Open \"POST\", myurl, False\n   xmlhttp.setRequestHeader \"Content-Type\", \"application/xml\"\n   xmlhttp.send\n   MsgBox (xmlhttp.responseText)\nEnd Sub\n</code></pre>\n\n<p>Macro run returns:</p>\n\n<p><strong>No resource method found for POST, return 405 with Allow header</strong></p>\n\n<p>When I modify the code, changing POST to GET:</p>\n\n<pre><code>xmlhttp.Open \"GET\", myurl, False\n</code></pre>\n\n<p>It works fine, I get the response. How can I force excel to cooperate with POST method? Since my API for more advanced communication requires POST?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1519229832, "last_edit_date": 1519229832, "creation_date": 1519229338, "answer_id": 48910440, "question_id": 48910277, "link": "https://stackoverflow.com/questions/48910277/make-selected-column-bold-and-unbold-other-column-in-excel/48910440#48910440", "title": "Make selected column bold and unbold other column in excel", "body": "<p>Try like this:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Cells.Font.Bold = False\nWorksheets(\"Sheet1\").Range(\"C9:C1000\").Font.Bold = True\n</code></pre>\n\n<p>First it will unbold anything, and then it bolds only the <code>Range(\"C9:C1000\")</code>. If you do not have merged cells, you may use one of the following two:</p>\n\n<ul>\n<li><code>Worksheets(\"Sheet1\").Range(\"C:C\").Font.Bold = True</code></li>\n<li><code>Worksheets(\"Sheet1\").Columns(3).Font.Bold = True</code></li>\n</ul>\n\n<p>Concerning that you are working with <code>Selection</code>, if you want to bold the all the column of given selection, you may use this:</p>\n\n<pre><code>Selection.EntireColumn.Font.Bold = True\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8412229, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6r1rcy7w_gY/AAAAAAAAAAI/AAAAAAAAAFw/SOZpniw1oBE/photo.jpg?sz=128", "display_name": "V_immo", "link": "https://stackoverflow.com/users/8412229/v-immo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2747, "favorite_count": 0, "accepted_answer_id": 48910440, "answer_count": 1, "score": 2, "last_activity_date": 1519231372, "creation_date": 1519228805, "last_edit_date": 1519231372, "question_id": 48910277, "link": "https://stackoverflow.com/questions/48910277/make-selected-column-bold-and-unbold-other-column-in-excel", "title": "Make selected column bold and unbold other column in excel", "body": "<p>I have a Excel Sheet with Macros in it. I want to change the entire column bold when I click on associated button. The click should also unbold all other bold columns.    </p>\n\n<pre><code>Public row As Integer, VerticalRange As Range\nSub Sort_Macro_C()\nSet VerticalRange = Worksheets(\"Sheet1\").Range(\"b9:b1000\")\nWorksheets(\"Sheet1\").Range(\"c9:c1000\").Font.Bold = True\nrow = Application.WorksheetFunction.CountA(VerticalRange) + 10\nRange(Cells(10, 2), Cells(row, 16)).sort Key1:=Range(\"C9\"), Order1:=xlDescending, Header:= _\n    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\n    DataOption1:=xlSortTextAsNumbers\nEnd Sub\n</code></pre>\n\n<p>The above code bolds the entire column but I am not figuring out how to unbold the remaining columns. Any help is appreciated.</p>\n\n<p>Cheers.</p>\n"}, {"tags": ["vba", "rename", "directory"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1519228901, "post_id": 48910043, "comment_id": 84826702, "body": "Using <code>Option Explicit</code> always helps identify problems.  Also, it&#39;s not enough to declare an object variable: it remains as <code>Nothing</code> until you actually create it."}, {"owner": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "edited": false, "score": 0, "creation_date": 1519229686, "post_id": 48910043, "comment_id": 84827245, "body": "I&#39;m not sure but you might need to start from the children folder to the parent. If you change the parent name when you go and try to change the child, It&#39;s not going to find the path..."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9391857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aba7cf60ac96835ca8f9b4c6064cbfe5?s=128&d=identicon&r=PG&f=1", "display_name": "John.doe", "link": "https://stackoverflow.com/users/9391857/john-doe"}, "edited": false, "score": 0, "creation_date": 1523389659, "post_id": 48910654, "comment_id": 86538940, "body": "Hello, revisiting this code, I am getting error 58 that the file already exists when it comes to:         If Folder.name &lt;&gt; newName Then Folder.name = newName"}, {"owner": {"reputation": 1451, "user_id": 4406670, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bc474af2baef160870a2478d40adcbbf?s=128&d=identicon&r=PG", "display_name": "Daniel L. VanDenBosch", "link": "https://stackoverflow.com/users/4406670/daniel-l-vandenbosch"}, "edited": false, "score": 0, "creation_date": 1549551882, "post_id": 48910654, "comment_id": 95950086, "body": "What references are you using?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1549567924, "post_id": 48910654, "comment_id": 95958945, "body": "I used \u201cMicrosoft Scripting Runtime\u201d"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 3, "last_activity_date": 1519231186, "last_edit_date": 1519231186, "creation_date": 1519229951, "answer_id": 48910654, "question_id": 48910043, "link": "https://stackoverflow.com/questions/48910043/vba-folder-renaming/48910654#48910654", "title": "VBA Folder Renaming", "body": "<p><strong>edited</strong>: after user feedback</p>\n\n<p>you have to set all object variables before using them</p>\n\n<p>and you have to be consistent with the name you chose for them... (<code>myObj</code> shoudl be <code>objFSO</code>) </p>\n\n<p>as per following code</p>\n\n<pre><code>Option Explicit\n\nSub File_renaming2()\n    Dim objFSO As FileSystemObject, myObj As Object, mySource As Object, Folder As Variant\n    Dim newName As String\n\n    Set objFSO = New FileSystemObject\n    Set mySource = objFSO.GetFolder(\"C:\\Users\\John.Doe\\Desktop\\ABC\\VBA Test folder\")\n\n    For Each Folder In mySource.SubFolders\n        newName = Folder.name\n        newName = Replace(newName, \"-\", \" \")  'replace - with space\n        newName = Replace(newName, \":\", \" \")  'replace : with space\n        newName = Replace(newName, \";\", \" \")  'replace ; with space\n        newName = Replace(newName, \"/\", \" \")  'replace / with space\n        If Folder.name &lt;&gt; newName Then Folder.name = newName ' assign new name. the check is to (possibly) ensure you're not processing the same folder twice\n    Next Folder\nEnd Sub\n</code></pre>\n\n<p>since it seems FSO would not allow to change twice the name of the same folder in the same \"session\".</p>\n"}], "owner": {"reputation": 3, "user_id": 9391857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aba7cf60ac96835ca8f9b4c6064cbfe5?s=128&d=identicon&r=PG&f=1", "display_name": "John.doe", "link": "https://stackoverflow.com/users/9391857/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4578, "favorite_count": 0, "accepted_answer_id": 48910654, "answer_count": 1, "score": 0, "last_activity_date": 1519231186, "creation_date": 1519228122, "last_edit_date": 1519229877, "question_id": 48910043, "link": "https://stackoverflow.com/questions/48910043/vba-folder-renaming", "title": "VBA Folder Renaming", "body": "<p>I am looking to use VBA to rename a set of folders. The purpose is to remove special characters from the folder names such as - : ; /, etc. Here is what I have so far:</p>\n\n<pre><code>Sub File_renaming2()\nDim objFSO As FileSystemObject, myObj As Object, mySource As Object, Folder As Variant\nSet mySource = myObj.GetFolder(\"C:\\Users\\John.Doe\\Desktop\\ABC\\VBA Test folder\")\n\nFor Each Folder In mySource.Folder\n    Folder.Name.Replace What:=\"-\", Replacement:=\" \" 'replace - with space\n    Folder.Name.Replace What:=\":\", Replacement:=\" \" 'replace : with space\n    Folder.Name.Replace What:=\";\", Replacement:=\" \" 'replace ; with space\n    Folder.Name.Replace What:=\"/\", Replacement:=\" \" 'replace / with space\n\n    Next Folder\n\nEnd Sub\n</code></pre>\n\n<p>I am new to VBA and made the code off of the solutions to similar questions online, but this appears to give me </p>\n\n<blockquote>\n  <p>run-time error '91'- Object variable or With block variable not set.</p>\n</blockquote>\n\n<p>Any help is appreciated, thanks!</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 451, "user_id": 4242042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33b5052c0f05a43739f1e9e2c4d21e77?s=128&d=identicon&r=PG&f=1", "display_name": "Stilgar", "link": "https://stackoverflow.com/users/4242042/stilgar"}, "edited": false, "score": 0, "creation_date": 1519229746, "post_id": 48909968, "comment_id": 84827289, "body": "I saw an article on how to do that very thing in Excel using the BeforePrint event.  Perhaps that could be adapted to your needs? <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2010-customize/how-can-i-put-a-value-from-a-cell-into-a-footer-or/972b5bca-f6ea-4935-84a1-7d542a4a2ba2\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/office/forum/office_2010-customi&zwnj;&#8203;ze/&hellip;</a>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1519235245, "post_id": 48909968, "comment_id": 84830963, "body": "You can assign any macro to a keyboard shortcut. Whether the keyboard shortcut can continue in the user interface in the manner you wish, however, depends to a certain extent which version of Word is involved."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 3109887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835f66d941287b9dea6f9dca9c03de5e?s=128&d=identicon&r=PG&f=1", "display_name": "Samantha1154", "link": "https://stackoverflow.com/users/3109887/samantha1154"}, "edited": false, "score": 0, "creation_date": 1608211276, "post_id": 50790100, "comment_id": 115517340, "body": "Hi, if i make a template out of this, can i do it so it&#39;s scripts are automatically copies on every files created off of it? Also can the scripts be applied to pre-existing files when opened above template?"}], "tags": [], "owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "is_accepted": false, "score": 1, "last_activity_date": 1528687018, "creation_date": 1528687018, "answer_id": 50790100, "question_id": 48909968, "link": "https://stackoverflow.com/questions/48909968/running-a-macro-before-printing-a-word-document/50790100#50790100", "title": "Running a macro before printing a word document", "body": "<p><a href=\"http://forums.whirlpool.net.au/archive/2603917\" rel=\"nofollow noreferrer\">http://forums.whirlpool.net.au/archive/2603917</a></p>\n\n<p>You need to do Three things for this to work:</p>\n\n<p>Open VBA Editor via ALT+F11</p>\n\n<p>To create a module or class, right click and go Insert >> Module/Class</p>\n\n<p>To Test: Close and Re-Open and Print</p>\n\n<ul>\n<li>It should display a box saying \"Before Print\"</li>\n</ul>\n\n<p>Insert >> Module</p>\n\n<pre><code>Reg_Event_Handler\n\n\nDim X As New EventClassModule\nSub Register_Event_Handler()\nSet X.App = Word.Application\nEnd Sub\n</code></pre>\n\n<p>For this one, Double Click \"ThisDocument\" and paste this in the box that opens.</p>\n\n<pre><code>Private Sub Document_Open()\nRegister_Event_Handler\nEnd Sub\n</code></pre>\n\n<p>Insert >> Class Module</p>\n\n<pre><code>EventClassModule\n\n\nPublic WithEvents App As Word.Application\nPrivate Sub App_DocumentBeforePrint(ByVal Doc As Document, Cancel As Boolean)\n' Run code directly inside this Sub OR\nMsgBox \"Before Print\"\n' Call another Sub here, note, Sub and Module name can't match\nCall Greetings\n' See https://www.freesoftwareservers.com/wiki/compile-error-expected-variable-or-procedure-not-module-macros-microsoft-office-29982732.html\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/P1Ipc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P1Ipc.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 63, "user_id": 9144708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617372902420f24fb59d5a455e8a09de?s=128&d=identicon&r=PG&f=1", "display_name": "mpa", "link": "https://stackoverflow.com/users/9144708/mpa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2850, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1593731114, "creation_date": 1519227916, "last_edit_date": 1593731114, "question_id": 48909968, "link": "https://stackoverflow.com/questions/48909968/running-a-macro-before-printing-a-word-document", "title": "Running a macro before printing a word document", "body": "<p>I have a macro in word 2010, that adds a footer to documents when you print them (i.e. after you click the \"final\" print button, in the print preview screen). </p>\n\n<p>Currently, in order to foot the document, the user needs to run the macro first, and only after running it, when they print the document, the footer is added.</p>\n\n<p>I would like to automate the part of running the macro, so that selecting a printing option (Ctrl+P / File>Print) would run the macro automatically and open the print preview screen for the final printing.</p>\n\n<p>How can this be done?</p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["mysql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1519228035, "post_id": 48909882, "comment_id": 84825999, "body": "Is the control source property of the combobox a field name from your table or is it blank?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1519228078, "post_id": 48909882, "comment_id": 84826037, "body": "Just use an unbound control, and populate it on <code>Form_Current</code>."}, {"owner": {"reputation": 884, "user_id": 6651080, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EY45JeKlPi8/AAAAAAAAAAI/AAAAAAAAG8I/5bwaHIx2IoQ/photo.jpg?sz=128", "display_name": "Dzintars", "link": "https://stackoverflow.com/users/6651080/dzintars"}, "edited": false, "score": 0, "creation_date": 1519230279, "post_id": 48909882, "comment_id": 84827674, "body": "I cant leave Control Source empty because i need to see actual Route in main grid. What do you mean with Unbound Control? I think the actual Route also will be empty in this case."}, {"owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "edited": false, "score": 0, "creation_date": 1519249525, "post_id": 48909882, "comment_id": 84838460, "body": "So what&#39;s the &quot;default update behavior of this control&quot; you need to disable?"}, {"owner": {"reputation": 884, "user_id": 6651080, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EY45JeKlPi8/AAAAAAAAAAI/AAAAAAAAG8I/5bwaHIx2IoQ/photo.jpg?sz=128", "display_name": "Dzintars", "link": "https://stackoverflow.com/users/6651080/dzintars"}, "edited": false, "score": 0, "creation_date": 1519250281, "post_id": 48909882, "comment_id": 84838786, "body": "When you select some other value (click event on item) Access is trying to update it, but it cant. And i get Non-Updatable recordset Error. I need to disable that event at all."}], "owner": {"reputation": 884, "user_id": 6651080, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-EY45JeKlPi8/AAAAAAAAAAI/AAAAAAAAG8I/5bwaHIx2IoQ/photo.jpg?sz=128", "display_name": "Dzintars", "link": "https://stackoverflow.com/users/6651080/dzintars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519230472, "creation_date": 1519227700, "last_edit_date": 1519230472, "question_id": 48909882, "link": "https://stackoverflow.com/questions/48909882/update-ms-access-non-updatable-recordset-form-control-via-vba-sql", "title": "Update MS Access non-updatable recordset form control via VBA SQL", "body": "<p>I have MySQL ODBC datasource. I have datasheet view form or MySQL view which are build from 3 tables by joining them and summarizing some data (Totals).\nLet's say I have Orders view with subtotals in them and I need to see full list of those orders and its summaries in simple datasheet view.\nIn this datasheet view I have <code>cmb</code> column <code>order_route</code> which are Lookup field to <code>routes</code> MySQL ODBC table.\nBecause of grouped data in my MySQL view I can't make any direct update to this view. It is fine.\nWhat I want to do is - I want to left Control Source of this <code>cmb</code> column as it is to <code>vwOrdersDetails</code>.<code>route_id</code> BUT Row Source as SELECT <code>routes</code>.<code>id</code>,... FROM routes table.\nSo till now it is fine - I have grid with orders, its summaries and I have combobox which I can expand and to select Route I want.\nThe challenge is to run custom VBA SQL when I select value of this combobox. I need to disable default update behavior of this control and let it run my custom VBA event. Right now I can run this VBA event and order Route is updated, but I don't know how to disable that build-in update behavior because it is trying to update non-updatable recordset.\nP.S. - NO! I don't want to make Updatable record-set without summaries in it. And i cant force user to open every record's Profile view just to update Route because it takes too many clicking.</p>\n\n<p>Similar topic: <a href=\"https://stackoverflow.com/questions/42650108/vba-access-how-to-link-an-updatable-recordset-to-an-updatable-form-and-save-the\">VBA Access: How to link an updatable recordset to an updatable FORM and save the changes in SQL Server</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/OQ1o1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OQ1o1.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "macos", "excel-2016"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1519226459, "post_id": 48909401, "comment_id": 84824905, "body": "(1) don&#39;t cross post, at least not without link: <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_mac-mso_mac2016/visual-basic-editor-single-column-bug/3d8d114d-7c26-4deb-b893-c55c400397b4\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/msoffice/forum/&hellip;</a> (2) This looks like a bug, therefore the Microsoft Support is the correct point to contact."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9391764, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "formicaman", "link": "https://stackoverflow.com/users/9391764/formicaman"}, "edited": false, "score": 0, "creation_date": 1519226573, "post_id": 48909473, "comment_id": 84825007, "body": "That&#39;s what I did. It says there are no updates available."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519226724, "post_id": 48909473, "comment_id": 84825120, "body": "Try to update MacOS, remove Office completely and reinstall."}], "tags": [], "owner": {"reputation": 3021, "user_id": 9208197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e545ac8c6a4f6c5cad3832d7463c15?s=128&d=identicon&r=PG&f=1", "display_name": "L&#233;o R.", "link": "https://stackoverflow.com/users/9208197/l%c3%a9o-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1519226498, "creation_date": 1519226498, "answer_id": 48909473, "question_id": 48909401, "link": "https://stackoverflow.com/questions/48909401/excel-2016-mac-visual-basic-editor-single-column/48909473#48909473", "title": "Excel 2016 (Mac) - Visual Basic Editor Single Column", "body": "<p>Try update again your MS Office, this should solve your problem :</p>\n\n<ol>\n<li><p>Open any Office application:</p></li>\n<li><p>Make sure your Mac has a working internet connection</p></li>\n<li><p>Go to the Help menu and choose Check for Updates</p></li>\n<li><p>Let AutoUpdate check for and install updates</p></li>\n</ol>\n\n<p>SOURCE : <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_mac-mso_mac2016/visual-basic-editor-single-column-bug/3d8d114d-7c26-4deb-b893-c55c400397b4\" rel=\"nofollow noreferrer\">https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_mac-mso_mac2016/visual-basic-editor-single-column-bug/3d8d114d-7c26-4deb-b893-c55c400397b4</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9391764, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "formicaman", "link": "https://stackoverflow.com/users/9391764/formicaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 363, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593675361, "creation_date": 1519226262, "last_edit_date": 1593675361, "question_id": 48909401, "link": "https://stackoverflow.com/questions/48909401/excel-2016-mac-visual-basic-editor-single-column", "title": "Excel 2016 (Mac) - Visual Basic Editor Single Column", "body": "<p><a href=\"https://i.stack.imgur.com/nkff5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nkff5.png\" alt=\"problem\"></a></p>\n\n<p>I am having this issue with Visual Basic Editor for Excel 2016 -- I have updated my computer and Excel to the latest version.</p>\n"}, {"tags": ["r", "excel", "vba", "reshape", "spss"], "comments": [{"owner": {"reputation": 12083, "user_id": 5414452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MJKg0.jpg?s=128&g=1", "display_name": "jogo", "link": "https://stackoverflow.com/users/5414452/jogo"}, "edited": false, "score": 2, "creation_date": 1519225294, "post_id": 48909001, "comment_id": 84824095, "body": "Welcome to SO! Please read <a href=\"https://stackoverflow.com/questions/5963269/how-to-make-a-great-r-reproducible-example\" title=\"how to make a great r reproducible example\">stackoverflow.com/questions/5963269/&hellip;</a> Do <b>not</b> use images to show your data."}, {"owner": {"reputation": 176623, "user_id": 1270695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KTfkF.png?s=128&g=1", "display_name": "A5C1D2H2I1M1N2O1R2T1", "link": "https://stackoverflow.com/users/1270695/a5c1d2h2i1m1n2o1r2t1"}, "edited": false, "score": 0, "creation_date": 1519225878, "post_id": 48909001, "comment_id": 84824488, "body": "In R, load the &quot;reshape2&quot; package or &quot;data.table&quot; and use <code>melt</code>. Search for &quot;reshape wide to long&quot; to find many solutions. If blank rows are created, they&#39;re easy to remove."}, {"owner": {"reputation": 176623, "user_id": 1270695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KTfkF.png?s=128&g=1", "display_name": "A5C1D2H2I1M1N2O1R2T1", "link": "https://stackoverflow.com/users/1270695/a5c1d2h2i1m1n2o1r2t1"}, "edited": false, "score": 0, "creation_date": 1519225976, "post_id": 48909001, "comment_id": 84824558, "body": "In SPSS, you&#39;re going to want to look at <code>varstocases</code>."}, {"owner": {"reputation": 176623, "user_id": 1270695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KTfkF.png?s=128&g=1", "display_name": "A5C1D2H2I1M1N2O1R2T1", "link": "https://stackoverflow.com/users/1270695/a5c1d2h2i1m1n2o1r2t1"}, "edited": false, "score": 0, "creation_date": 1519226621, "post_id": 48909001, "comment_id": 84825042, "body": "And see <a href=\"https://stackoverflow.com/a/19532976/1270695\">this answer</a> for Excel, using the Tableau plugin for reshaping data."}, {"owner": {"reputation": 43, "user_id": 9391432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ae42a8ec399e94ebee4ef8114c4cf16?s=128&d=identicon&r=PG&f=1", "display_name": "ashurtz", "link": "https://stackoverflow.com/users/9391432/ashurtz"}, "edited": false, "score": 0, "creation_date": 1519226679, "post_id": 48909001, "comment_id": 84825085, "body": "Thank you, everyone. I changed it to R to satisfy requirements about displaying questions. Sorry, I&#39;m new to both R and SO"}, {"owner": {"reputation": 43, "user_id": 9391432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ae42a8ec399e94ebee4ef8114c4cf16?s=128&d=identicon&r=PG&f=1", "display_name": "ashurtz", "link": "https://stackoverflow.com/users/9391432/ashurtz"}, "edited": false, "score": 0, "creation_date": 1519227199, "post_id": 48909001, "comment_id": 84825426, "body": "The desired outcome is to separate rows into individual observations, instead of having multiple persons included in one row. So instead of having a row say &quot;there&#39;s two people in this household, one is male and the other female&quot; I would have one row that says &quot;a male lives in a two-person household&quot; and a seperate row that say &quot;a female lives in a two-person household&quot; while still copying the other data associated with them into the new rows"}], "answers": [{"tags": [], "owner": {"reputation": 4391, "user_id": 8506548, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yW1F3.jpg?s=128&g=1", "display_name": "niko", "link": "https://stackoverflow.com/users/8506548/niko"}, "is_accepted": false, "score": 1, "last_activity_date": 1519227946, "creation_date": 1519227946, "answer_id": 48909975, "question_id": 48909001, "link": "https://stackoverflow.com/questions/48909001/how-do-i-copy-a-set-of-columns-into-new-rows/48909975#48909975", "title": "How do I copy a set of columns into new rows?", "body": "<p>This might be of help</p>\n\n<pre><code>library(reshape2)\n\nGender_ideal &lt;- melt(Gender_Example, id=c(names(Gender_Example)[1:4]))\nrows.to.remove &lt;- which(Gender_ideal$value == \"-\")\nGender_ideal &lt;- Gender_ideal[-rows.to.remove,]\nGender_ideal\n   ID State County Household      variable  value\n1   1    FL   Lake         2  First.Gender   Male\n2   2    FL   Lake         1  First.Gender Female\n3   3    FL   Lake         3  First.Gender   Male\n4   4    FL Orange         2  First.Gender Female\n5   5    FL Orange         1  First.Gender   Male\n6   1    FL   Lake         2 Second.Gender   Male\n8   3    FL   Lake         3 Second.Gender Female\n9   4    FL Orange         2 Second.Gender Female\n13  3    FL   Lake         3  Third.Gender   Male\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 176623, "user_id": 1270695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KTfkF.png?s=128&g=1", "display_name": "A5C1D2H2I1M1N2O1R2T1", "link": "https://stackoverflow.com/users/1270695/a5c1d2h2i1m1n2o1r2t1"}, "is_accepted": true, "score": 3, "last_activity_date": 1519228369, "creation_date": 1519228369, "answer_id": 48910136, "question_id": 48909001, "link": "https://stackoverflow.com/questions/48909001/how-do-i-copy-a-set-of-columns-into-new-rows/48910136#48910136", "title": "How do I copy a set of columns into new rows?", "body": "<h1>R</h1>\n\n<p>In R, your best choices are going to be <code>melt</code> from \"data.table\" (which lets you use \"patterns\" to identify your measure variables. With that, you would do:</p>\n\n<pre><code>library(data.table)\nmelt(setDT(Gender_Example), measure.vars = patterns(\"Gender$\"))[value != \"-\"]\n</code></pre>\n\n<p>Alternatively, there's the \"tidyverse\" approach.</p>\n\n<pre><code>library(tidyverse)\nGender_Example %&gt;%\n  gather(variable, value, ends_with(\"Gender\")) %&gt;%\n  filter(value != \"-\")\n</code></pre>\n\n<hr>\n\n<h1>SPSS</h1>\n\n<p>In SPSS, you would want to look at <code>varstocases</code>. There's a pretty good <a href=\"https://www.spss-tutorials.com/spss-varstocases-what-and-why/\" rel=\"nofollow noreferrer\">writeup here that should help you get started</a>.</p>\n\n<hr>\n\n<h1>Excel</h1>\n\n<p>This might depend on the version of Excel you're using. If you are using 2016, you can use the pivot table wizard on your data, and then double click on the grand totals to access the underlying \"long\" table that would have been used to create the table.</p>\n\n<p>The process is outlined <a href=\"https://www.youtube.com/watch?v=-mzpLg1gI98\" rel=\"nofollow noreferrer\">at this video</a>.</p>\n\n<p>Alternatively, you can use the <a href=\"https://community.tableau.com/docs/DOC-10394\" rel=\"nofollow noreferrer\">Tableau reshaping tool</a> as described <a href=\"https://www.youtube.com/watch?v=1YAZj_0DHuM\" rel=\"nofollow noreferrer\">at this video</a></p>\n"}], "owner": {"reputation": 43, "user_id": 9391432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ae42a8ec399e94ebee4ef8114c4cf16?s=128&d=identicon&r=PG&f=1", "display_name": "ashurtz", "link": "https://stackoverflow.com/users/9391432/ashurtz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 48910136, "answer_count": 2, "score": 4, "last_activity_date": 1519228580, "creation_date": 1519225011, "last_edit_date": 1519228580, "question_id": 48909001, "link": "https://stackoverflow.com/questions/48909001/how-do-i-copy-a-set-of-columns-into-new-rows", "title": "How do I copy a set of columns into new rows?", "body": "<p>Sorry if this has been answered before, I'm not even sure how to search for it. I'm happy with any automated solution in R, VBA, or SPSS.</p>\n\n<p>I have a huge set of demographic data like this:   </p>\n\n<pre><code>ID &lt;- c(1, 2, 3, 4, 5)\nState &lt;- c(\"FL\", \"FL\", \"FL\", \"FL\", \"FL\")\nCounty &lt;- c(\"Lake\", \"Lake\", \"Lake\", \"Orange\", \"Orange\")\nHousehold &lt;- c (2, 1, 3, 2, 1)\nFirst.Gender &lt;- c(\"Male\", \"Female\", \"Male\", \"Female\", \"Male\")\nSecond.Gender &lt;- c(\"Male\", \"-\", \"Female\", \"Female\", \"-\")\nThird.Gender &lt;- c(\"-\", \"-\", \"Male\", \"-\", \"-\")\n\nGender_Example &lt;- data.frame(ID, State, County, Household, First.Gender, Second.Gender, Third.Gender)\n</code></pre>\n\n<p>and I'd like to find a way to create new rows based on what's in the column (without creating blank rows). Something that looks like this:</p>\n\n<pre><code>ID_i &lt;- c(1, 1, 2, 3, 3, 3, 4, 4, 5) # _i designates my ideal set\nState_i &lt;- c(\"FL\", \"FL\", \"FL\", \"FL\", \"FL\", \"FL\", \"FL\", \"FL\", \"FL\")\nCounty_i &lt;- c(\"Lake\", \"Lake\", \"Lake\", \"Lake\", \"Lake\", \"Lake\", \"Orange\", \"Orange\", \"Orange\")\nHousehold_i &lt;- c(2, 2, 1, 3, 3, 3, 2, 2, 1)\nGender_i &lt;- c(\"Male\", \"Male\", \"Female\", \"Male\", \"Female\", \"Male\", \"Female\", \"Female\", \"Male\")\n\nGender_ideal &lt;- data.frame(ID_i, State_i, County_i, Household_i, Gender_i)\n</code></pre>\n\n<p>If this has already been asked then I'd be happy just have a link. Thank you!</p>\n"}, {"tags": ["excel", "pdf", "printing", "formatting", "vba"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1519224142, "post_id": 48908047, "comment_id": 84823232, "body": "Same font set as default? Same Printer?"}, {"owner": {"reputation": 783, "user_id": 1082410, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2fd9ea2cafe88dda86f7663839fa12c5?s=128&d=identicon&r=PG", "display_name": "Tolure", "link": "https://stackoverflow.com/users/1082410/tolure"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1519224583, "post_id": 48908047, "comment_id": 84823575, "body": "Yes to the same font. and as for printer its all being done with print to pdf. I&#39;ll edit my question and paste the pdf generating code."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1519225015, "post_id": 48908047, "comment_id": 84823884, "body": "If you are seeing a different number of characters per line between users they must be using either a different font or a different typesize, or the width of the column is different . Could one set of users be using windows fonts and the others the matching postscript version?"}, {"owner": {"reputation": 783, "user_id": 1082410, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2fd9ea2cafe88dda86f7663839fa12c5?s=128&d=identicon&r=PG", "display_name": "Tolure", "link": "https://stackoverflow.com/users/1082410/tolure"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1519225241, "post_id": 48908047, "comment_id": 84824052, "body": "The entire program is a self contained application in an excel file. All the worksheets but a few input fields have been locked down. The user does not have the choice to change fonts or text size."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1519914386, "post_id": 48908047, "comment_id": 85108023, "body": "The user can choose in Printer settings in Windows whether to use Truetype or Postscript fonts for some printers - it&#39;s independent of Excel and over rides any excel settings. My understanding is that if you print to pdf it uses your printer settings."}], "owner": {"reputation": 783, "user_id": 1082410, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2fd9ea2cafe88dda86f7663839fa12c5?s=128&d=identicon&r=PG", "display_name": "Tolure", "link": "https://stackoverflow.com/users/1082410/tolure"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519224688, "creation_date": 1519222386, "last_edit_date": 1531161705, "question_id": 48908047, "link": "https://stackoverflow.com/questions/48908047/excel-document-printing-differently-between-users", "title": "excel document printing differently between users", "body": "<p>I have inherited an excel program built in vba that generates a document in a worksheet to be printed into pdf. </p>\n\n<p>My problem is that with the exact same inputs I can get two different documents. The main differences is the line spacing between cells. For one user there might be 2 words that appear on the last line of the cell leaving no space between the cells while for another user might have all their words appear on the previous line and now has a line space between the two cells. </p>\n\n<p>I have tried manually adding line break at the end of the cells to try to make sure that all cells have some spacing between the two but this has now caused a few users to get double line spacing between their cells. </p>\n\n<p>I'm a little lost as to what might be causing this. All my users are running the same version of excel and since this is still in the testing phase are using the exact same inputs. Also we are all part of the same organization and I believe our environments are almost identical ( did not set up so no guarantee ) </p>\n\n<p>How do I go about to make sure that when my vba sends the worksheet the be printed as a pdf that it comes out identical for all my users.</p>\n\n<pre><code>Function RDB_Create_PDF(Myvar As Object, FixedFilePathName As String, _\n    OverwriteIfFileExist As Boolean, OpenPDFAfterPublish As Boolean) As String\nDim FileFormatstr As String\nDim Fname As Variant\n\n    'Test to see if the Microsoft Create/Send add-in is installed.\n    If Dir(Environ(\"commonprogramfiles\") &amp; \"\\Microsoft Shared\\OFFICE\" _\n         &amp; Format(Val(Application.Version), \"00\") &amp; \"\\EXP_PDF.DLL\") &lt;&gt; \"\" Then\n\n        If FixedFilePathName = \"\" Then\n            'Open the GetSaveAsFilename dialog to enter a file name for the PDF file.\n            FileFormatstr = \"PDF Files (*.pdf), *.pdf\"\n            Fname = Application.GetSaveAsFilename(\"\", filefilter:=FileFormatstr, _\n                  Title:=\"Create PDF\")\n\n            'If you cancel this dialog, exit the function.\n            If Fname = False Then Exit Function\n        Else\n            Fname = FixedFilePathName\n        End If\n\n        'If OverwriteIfFileExist = False then test to see if the PDF\n        'already exists in the folder and exit the function if it does.\n        If OverwriteIfFileExist = False Then\n            If Dir(Fname) &lt;&gt; \"\" Then Exit Function\n        End If\n\n        'Now export the PDF file.\n        On Error Resume Next\n        Myvar.ExportAsFixedFormat _\n                Type:=xlTypePDF, _\n                Filename:=Fname, _\n                Quality:=xlQualityStandard, _\n                IncludeDocProperties:=True, _\n                IgnorePrintAreas:=False, _\n                OpenAfterPublish:=OpenPDFAfterPublish\n        On Error GoTo 0\n\n        'If the export is successful, return the file name.\n        If Dir(Fname) &lt;&gt; \"\" Then RDB_Create_PDF = Fname\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "tabular"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9121888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5b8ce5a34f9c316ca41bd80e8e41ee?s=128&d=identicon&r=PG&f=1", "display_name": "Usman Bhinder", "link": "https://stackoverflow.com/users/9121888/usman-bhinder"}, "edited": false, "score": 0, "creation_date": 1519284203, "post_id": 48908315, "comment_id": 84849733, "body": "hi, thank you for your answers, but the tbl.Columns(1).Width = CentimetersToPoints(5.5)"}, {"owner": {"reputation": 158, "user_id": 2794327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36471432ab0c7779ea037601058ab197?s=128&d=identicon&r=PG&f=1", "display_name": "Arjeel", "link": "https://stackoverflow.com/users/2794327/arjeel"}, "reply_to_user": {"reputation": 23, "user_id": 9121888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5b8ce5a34f9c316ca41bd80e8e41ee?s=128&d=identicon&r=PG&f=1", "display_name": "Usman Bhinder", "link": "https://stackoverflow.com/users/9121888/usman-bhinder"}, "edited": false, "score": 0, "creation_date": 1519295917, "post_id": 48908315, "comment_id": 84856653, "body": "Haha, Nice observation mate. I just missed that. I hope that apart from that minor miss, I was able to help you with your query."}], "tags": [], "owner": {"reputation": 158, "user_id": 2794327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36471432ab0c7779ea037601058ab197?s=128&d=identicon&r=PG&f=1", "display_name": "Arjeel", "link": "https://stackoverflow.com/users/2794327/arjeel"}, "is_accepted": false, "score": 0, "last_activity_date": 1519223142, "creation_date": 1519223142, "answer_id": 48908315, "question_id": 48907896, "link": "https://stackoverflow.com/questions/48907896/adjusting-the-width-of-columns-of-all-tables-in-a-word-document/48908315#48908315", "title": "Adjusting the width of columns of all tables in a Word document", "body": "<p>As far as I can recall all the tables in a word file are a part of  <code>Tables</code> collection and we can access the individual table item using an index. Assuming that you wont know the number of tables, here's the code that works for me.</p>\n\n<pre><code>For Each tbl In Doc.Tables\n      tbl.Columns(3).Width = 40\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 9121888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5b8ce5a34f9c316ca41bd80e8e41ee?s=128&d=identicon&r=PG&f=1", "display_name": "Usman Bhinder", "link": "https://stackoverflow.com/users/9121888/usman-bhinder"}, "edited": false, "score": 0, "creation_date": 1519284745, "post_id": 48913560, "comment_id": 84850010, "body": "Hi thank you for your help, but it seems like the width command works without columns arguments. but with arguments its give error."}, {"owner": {"reputation": 23, "user_id": 9121888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5b8ce5a34f9c316ca41bd80e8e41ee?s=128&d=identicon&r=PG&f=1", "display_name": "Usman Bhinder", "link": "https://stackoverflow.com/users/9121888/usman-bhinder"}, "edited": false, "score": 0, "creation_date": 1519288600, "post_id": 48913560, "comment_id": 84851941, "body": "i am receiving error 5941 for Colomns 2,3 and 4. can you please help me out why is it so... thank you"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 23, "user_id": 9121888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5b8ce5a34f9c316ca41bd80e8e41ee?s=128&d=identicon&r=PG&f=1", "display_name": "Usman Bhinder", "link": "https://stackoverflow.com/users/9121888/usman-bhinder"}, "edited": false, "score": 0, "creation_date": 1519298306, "post_id": 48913560, "comment_id": 84858217, "body": "@UsmanBhinder What&#39;s the text of the error? The number doesn&#39;t tell me anything..."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 23, "user_id": 9121888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5b8ce5a34f9c316ca41bd80e8e41ee?s=128&d=identicon&r=PG&f=1", "display_name": "Usman Bhinder", "link": "https://stackoverflow.com/users/9121888/usman-bhinder"}, "edited": false, "score": 0, "creation_date": 1519307750, "post_id": 48913560, "comment_id": 84864842, "body": "@UsmanBhinder I made a small correction to the code, but it had nothing to do with the columns, like you report. Does your table have four columns?"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1519307679, "last_edit_date": 1519307679, "creation_date": 1519239869, "answer_id": 48913560, "question_id": 48907896, "link": "https://stackoverflow.com/questions/48907896/adjusting-the-width-of-columns-of-all-tables-in-a-word-document/48913560#48913560", "title": "Adjusting the width of columns of all tables in a Word document", "body": "<p>I'm going to interpret your question literally: that you merely want to process all the tables in the document and that your code is using <code>Find</code> only in order to locate a table...</p>\n\n<p>The following example shows how you can work with the underlying objects in Word directly, rather than relying on the current Selection, which is what the macro recorder gives you.</p>\n\n<p>So, at the beginning we declare object variables for the Document and a Table. The current document with the focus is assigned to the first. Then, with <code>For Each...Next</code> we can loop through each Table object in that document and perform the same actions on each one.</p>\n\n<p>In this case, the style is specified and the column widths set. Note that in order to give a column width in centimeters it's necessary to use a built-in conversion function <code>CentimetersToPoints</code> since Word measures column width in Points.</p>\n\n<pre><code>Sub FormatTables\n  Dim doc as Document\n  Dim tbl as Table\n\n  Set doc = ActiveDocument\n  For Each tbl in doc.Tables\n    tbl.Style = \"eo_tabelle_2\"\n    tbl.Columns(1).Width = CentimetersToPoints(5.5)\n    tbl.Columns(2).Width = CentimetersToPoints(8.5)\n    tbl.Columns(3).Width = CentimetersToPoints(7.5)\n    tbl.Columns(4).Width = CentimetersToPoints(1.1)\n  Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9121888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5b8ce5a34f9c316ca41bd80e8e41ee?s=128&d=identicon&r=PG&f=1", "display_name": "Usman Bhinder", "link": "https://stackoverflow.com/users/9121888/usman-bhinder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2883, "favorite_count": 0, "accepted_answer_id": 48913560, "answer_count": 2, "score": 0, "last_activity_date": 1593885186, "creation_date": 1519221920, "last_edit_date": 1593885186, "question_id": 48907896, "link": "https://stackoverflow.com/questions/48907896/adjusting-the-width-of-columns-of-all-tables-in-a-word-document", "title": "Adjusting the width of columns of all tables in a Word document", "body": "<p>In my Word document, I have over 300 tables and I want to change the table style and adjust the columns' widths. I am using the following code in my VBA macro. It's working for a style but not for column width. Please help me find where the problem is.</p>\n\n<pre><code>Sub Makro1()\n'\n' Makro1 Makro\n'\n'\n    Selection.Find.ClearFormatting\n    With Selection.Find\n        .Text = \"Variable\"\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = False\n        .MatchCase = True\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Selection.Find.Execute\n    Selection.MoveRight Unit:=wdCharacter, Count:=1\n    Selection.MoveRight Unit:=wdCharacter, Count:=4, Extend:=wdExtend\n    Selection.Tables(1).Style = \"eo_tabelle_2\"\n    With Tables(1).Spacing\n     .Item(1) = 5.5 'adjusts width of text box 1 in cm\n     .Item(2) = 8.5 'adjusts width of text box 2 in cm\n     .Item(3) = 7.5 'adjusts width of text box 3 in cm\n     .Item(4) = 1.1 'adjusts width of text box 4 in cm\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vb6", "vba"], "comments": [{"owner": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "edited": false, "score": 1, "creation_date": 1519221466, "post_id": 48907293, "comment_id": 84821260, "body": "If this is VB6 then why the MS Access tags?  In any case you probably either have a report that is too wide or else you forgot to set landscape orientation (DataReport.Orientation property).  There is nothing in the DataReport that is going to break pages horizontally when too wide though."}, {"owner": {"reputation": 9, "user_id": 6616082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jcns.jpg?s=128&g=1", "display_name": "Chakde", "link": "https://stackoverflow.com/users/6616082/chakde"}, "reply_to_user": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "edited": false, "score": 0, "creation_date": 1519222971, "post_id": 48907293, "comment_id": 84822289, "body": "Thanks for your reply. Is there any option to print all column fit in one page....?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1519225401, "post_id": 48907293, "comment_id": 84824162, "body": "When you manually export table to PDF, are you sure the width of new pdf created is 1 paper width? Make sure your table does not break into several pages, checking all pages or your pdf."}, {"owner": {"reputation": 9, "user_id": 6616082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jcns.jpg?s=128&g=1", "display_name": "Chakde", "link": "https://stackoverflow.com/users/6616082/chakde"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1519230094, "post_id": 48907293, "comment_id": 84827558, "body": "@FoxfireAndBurnsAndBurns Yes, my table break to several pages. I want to fit all columns into single page. How can I do this? Please help"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "edited": false, "score": 0, "creation_date": 1519230588, "post_id": 48907293, "comment_id": 84827901, "body": "As @Bob77 said before, you will have to design your report and make sure it fits in 1 page. Change all columns widths to adjuts them to 1 page width and then try again"}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1519279787, "post_id": 48907293, "comment_id": 84847706, "body": "If you google &quot;vb6 datareport report width is larger than paper width&quot; you will find all sorts of help."}], "owner": {"reputation": 9, "user_id": 6616082, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jcns.jpg?s=128&g=1", "display_name": "Chakde", "link": "https://stackoverflow.com/users/6616082/chakde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519219979, "creation_date": 1519219979, "question_id": 48907293, "link": "https://stackoverflow.com/questions/48907293/print-ms-access-table-into-pdf-using-vb6-0", "title": "Print MS Access Table into pdf using vb6.0", "body": "<p>I have saved my output (normally varies every time) as MS Access Table. I need to submit the table content to my client as \"pdf\" file. Can someone help me print or export MS Access table content into pdf format.</p>\n\n<p>I tried DataReport in VB6.0 and I couldn't save output into pdf. I am getting \"Report width is larger than the paper width\". </p>\n\n<p>When I manually export MS Access table to pdf, there was no error. </p>\n\n<p>My print DataReport coding is here,</p>\n\n<pre><code>With DataReport\n    .ExportFormats.Add \"OutputReport4\", rptFmtText, \"OutputReport (*.pdf)\", \"*.pdf\"\n    .ExportReport \"OutputReport4\", , False, True, rptRangeAllPages\n    .PrintReport True\nEnd With\n</code></pre>\n\n<p>Can some one help me please...</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19, "user_id": 9359146, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919199318114012/picture?type=large", "display_name": "Jerome", "link": "https://stackoverflow.com/users/9359146/jerome"}, "edited": false, "score": 0, "creation_date": 1519219947, "post_id": 48907268, "comment_id": 84820179, "body": "As you can see I already tried autoFilter.ApplyFilter, which doesn&#39;t give me anything."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519220156, "post_id": 48907268, "comment_id": 84820354, "body": "&quot;<i>Not sure why this is so.</i>&quot; Why is what? What would you expect instead?"}, {"owner": {"reputation": 19, "user_id": 9359146, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919199318114012/picture?type=large", "display_name": "Jerome", "link": "https://stackoverflow.com/users/9359146/jerome"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519220251, "post_id": 48907268, "comment_id": 84820427, "body": "@PehI would expect the filter to apply itself. Instead I am left with a list of zero results, but simply (manually) reactivating the filter fixes the problem."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1519220559, "post_id": 48907268, "comment_id": 84820662, "body": "OK, thx for clarification, but wouldn&#39;t the next loop kick out the filter criteria of the previous loop? So only the last loop criteria would apply to the data at all? And I recommend to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid <code>.Select</code> and <code>.Activate</code></a> when ever possible."}, {"owner": {"reputation": 19, "user_id": 9359146, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919199318114012/picture?type=large", "display_name": "Jerome", "link": "https://stackoverflow.com/users/9359146/jerome"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519221342, "post_id": 48907268, "comment_id": 84821169, "body": "Yes, that&#39;s because the code block is missing it&#39;s second (not yet active) half, where I take the values and copy them to another table. But since I didn&#39;t get the first part right I have nothing to copy. :-)  Will do, cheers"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519234133, "post_id": 48907268, "comment_id": 84830344, "body": "I do have another question. What does happen if we assume on start all entries are visible: If you run your code do the entries remain visible (just not being filtered at all) or does something other happen?"}, {"owner": {"reputation": 19, "user_id": 9359146, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919199318114012/picture?type=large", "display_name": "Jerome", "link": "https://stackoverflow.com/users/9359146/jerome"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1519289446, "post_id": 48907268, "comment_id": 84852413, "body": "Good morning, Peh. Nope, Filters apply, but no entries are found. (But entries are found if filtered manually)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519297271, "post_id": 48907268, "comment_id": 84857527, "body": "<b>Ahhh, now that turns out to be something complete different now!</b> Your title is &quot;<i>Auto filter doesn&#39;t seem to apply</i>&quot; but that&#39;s just wrong, it <b>does</b> apply, but it does not filter correctly! So this is not a &quot;filter does not apply&quot;  error it is a &quot;filter applies but does not filter correctly&quot;. If you ask the wrong question you will obviously get the wrong answers. You <b>must</b> be very specific if you ask here. This make a huge difference. So it is definitely an issue with your criteria, probably something with the <code>.</code> and <code>,</code> or text/value based filter."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519297495, "post_id": 48907268, "comment_id": 84857672, "body": "How are your columns (HOEHE_VON and HOEHE_BIS) formatted? Are they formatted as (Default = Standard) or are they formatted as text or any specific number format applied? Can you maybe provide a screenshot of these columns?"}, {"owner": {"reputation": 19, "user_id": 9359146, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919199318114012/picture?type=large", "display_name": "Jerome", "link": "https://stackoverflow.com/users/9359146/jerome"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1519303860, "post_id": 48907268, "comment_id": 84861831, "body": "Well, it does not apply in terms of the result is not correct. I&#39;ve made a screen recording, but didn&#39;t know where to upload it. But since it seems to be about the decimal separator I don&#39;t think the code is broken, but rather the method how VBA handles the separator in the German version. I gonna take a detour by reading the values into an array (which works fine) and get the discussion about the separator to the support guys from Microsoft. Thanks for your help, and sorry for the misunderstanding"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9359146, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919199318114012/picture?type=large", "display_name": "Jerome", "link": "https://stackoverflow.com/users/9359146/jerome"}, "edited": false, "score": 0, "creation_date": 1519221241, "post_id": 48907506, "comment_id": 84821090, "body": "Thanks for the fast response, Mike. Unfortunately this does not work either. I still have a list with zero results. Do you think I need to define that I wanna use a numeric filter?"}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "reply_to_user": {"reputation": 19, "user_id": 9359146, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919199318114012/picture?type=large", "display_name": "Jerome", "link": "https://stackoverflow.com/users/9359146/jerome"}, "edited": false, "score": 0, "creation_date": 1519222013, "post_id": 48907506, "comment_id": 84821596, "body": "@Jerome I&#39;ve made some slight modifications to the code, please try the second iteration."}, {"owner": {"reputation": 19, "user_id": 9359146, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919199318114012/picture?type=large", "display_name": "Jerome", "link": "https://stackoverflow.com/users/9359146/jerome"}, "edited": false, "score": 0, "creation_date": 1519228531, "post_id": 48907506, "comment_id": 84826400, "body": "Nope, still nothing. Thank you anyway."}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "reply_to_user": {"reputation": 19, "user_id": 9359146, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919199318114012/picture?type=large", "display_name": "Jerome", "link": "https://stackoverflow.com/users/9359146/jerome"}, "edited": false, "score": 0, "creation_date": 1519229173, "post_id": 48907506, "comment_id": 84826904, "body": "@Jerome Are you stepping through the code so that you see each time it is setting the auto-filter or just hitting run? These both work fine for me."}, {"owner": {"reputation": 19, "user_id": 9359146, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919199318114012/picture?type=large", "display_name": "Jerome", "link": "https://stackoverflow.com/users/9359146/jerome"}, "edited": false, "score": 0, "creation_date": 1519231145, "post_id": 48907506, "comment_id": 84828326, "body": "Single steps, I gonny try to take a short video-recording later"}], "tags": [], "owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1519229094, "last_edit_date": 1519229094, "creation_date": 1519220635, "answer_id": 48907506, "question_id": 48907268, "link": "https://stackoverflow.com/questions/48907268/auto-filter-doesnt-seem-to-apply/48907506#48907506", "title": "Auto filter doesn&#39;t seem to apply", "body": "<p>Maybe you need to clear the filters first:</p>\n\n<pre><code>Dim zaehlerHeights As Double\nzaehlerHeights = 0.4\nSheets(\"Rohdaten WG22\").Select\nActiveSheet.Range(\"Tabelle13\").AutoFilter Field:=19\nActiveSheet.Range(\"Tabelle13\").AutoFilter Field:=20\nWhile zaehlerHeights &lt;= 25\n\n    ActiveSheet.ListObjects(\"Tabelle13\").Range.AutoFilter Field:=19, Criteria1 _\n    :=\"&lt;\" &amp; zaehlerHeights, Operator:=xlAnd\n\n    ActiveSheet.ListObjects(\"Tabelle13\").Range.AutoFilter Field:=20, Criteria1 _\n    :=\"&gt;\" &amp; zaehlerHeights, Operator:=xlAnd\n</code></pre>\n\n<p>I also removed some unneeded code. You don't need to select or activate what you are going to be filtering, that is in the filter line.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>Try this code, I've made a couple of slight modifications</p>\n\n<pre><code>Dim zaehlerHeights As Double\nzaehlerHeights = 0.4\nSheets(\"Rohdaten WG22\").Select\nActiveSheet.Range(\"Tabelle13\").AutoFilter Field:=19\nActiveSheet.Range(\"Tabelle13\").AutoFilter Field:=20\nWhile zaehlerHeights &lt;= 25\n\n    ActiveSheet.Range(\"Tabelle13\").AutoFilter Field:=19, Criteria1 _\n    :=\"&lt;\" &amp; zaehlerHeights, Operator:=xlAnd\n\n    ActiveSheet.Range(\"Tabelle13\").AutoFilter Field:=20, Criteria1 _\n    :=\"&gt;\" &amp; zaehlerHeights, Operator:=xlAnd\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 9359146, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919199318114012/picture?type=large", "display_name": "Jerome", "link": "https://stackoverflow.com/users/9359146/jerome"}, "edited": false, "score": 0, "creation_date": 1519228435, "post_id": 48908235, "comment_id": 84826332, "body": "I guess why &quot;=0.4&quot; doesn&#39;t work is that Excel changes into a text based filter. Anyhow, still no results. This drives me mad, in the end it&#39;s gonna be so obvious. Thanks for your help tho!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 19, "user_id": 9359146, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919199318114012/picture?type=large", "display_name": "Jerome", "link": "https://stackoverflow.com/users/9359146/jerome"}, "edited": false, "score": 0, "creation_date": 1519231179, "post_id": 48908235, "comment_id": 84828342, "body": "@Jerome yes I assume the same, that it changes into a text based filter, but this sucks because even a filter like <code>&quot;=0,40&quot;</code> doesn&#39;t work on a value that is <code>0,4</code>. The value is the same but the text filter makes it useless in VBA. On the other hand manual filtering for <code>0,40</code> works. This makes filtering values a real pain. An idea (just in case you didn&#39;t check) make sure the columns you try to filter are formatted as numbers not as text."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1519224092, "last_edit_date": 1519224092, "creation_date": 1519222887, "answer_id": 48908235, "question_id": 48907268, "link": "https://stackoverflow.com/questions/48907268/auto-filter-doesnt-seem-to-apply/48908235#48908235", "title": "Auto filter doesn&#39;t seem to apply", "body": "<p>In your code is much that you don't need. You won't need all the <code>.Select</code> the field number in your filter already says which column to filter <code>Field:=19</code>.</p>\n\n<pre><code>Dim zaehlerHeights As Double\n\nzaehlerHeights = 0.4\nWhile zaehlerHeights &lt;= 25\n    With Worksheets(\"Rohdaten WG22\")\n        .ListObjects(\"Tabelle13\").Range.AutoFilter Field:=19, Criteria1 _\n        :=\"&lt;\" &amp; zaehlerHeights, Operator:=xlAnd\n\n        .ListObjects(\"Tabelle13\").Range.AutoFilter Field:=20, Criteria1 _\n        :=\"&gt;\" &amp; zaehlerHeights, Operator:=xlAnd\n    End With\n</code></pre>\n\n<p>or even shorter</p>\n\n<pre><code>    With Worksheets(\"Rohdaten WG22\").ListObjects(\"Tabelle13\").Range\n        .AutoFilter Field:=19, Criteria1:=\"&lt;\" &amp; zaehlerHeights, Operator:=xlAnd\n        .AutoFilter Field:=20, Criteria1:=\"&gt;\" &amp; zaehlerHeights, Operator:=xlAnd\n    End With\n</code></pre>\n\n<p>So this should already filter, and apply the filter immediately.</p>\n\n<p><strong>Note</strong><br>\nOn non-English Excel versions where <code>,</code> comma is the digit separator you might run into problems when using a <code>=</code> like <code>\"=\" &amp; zaehlerHeights</code> because <code>zaehlerHeights = 0.4</code> is a dot (which cannot be changed) but Excel might need a <code>,</code> in the filter criteria so you might need to replace that <code>.</code> by a <code>,</code> (e.g. with the <code>replace()</code> function).</p>\n\n<p>But the odd thing is when using a <code>&gt;</code> or <code>&lt;</code> or <code>&lt;=</code> or <code>&gt;=</code> then Excel awaits a <code>.</code></p>\n\n<p>Example:<br>\neg. On a German Excel where the values are eg. <code>0,3</code>; <code>0,4</code>; <code>0,5</code> (note the comma) in Field19</p>\n\n<pre><code>'these work \u2026\n.AutoFilter Field:=19, Criteria1:=\"&lt;0.4\"\n.AutoFilter Field:=19, Criteria1:=\"&lt;=0.4\"\n.AutoFilter Field:=19, Criteria1:=\"&gt;0.4\"\n.AutoFilter Field:=19, Criteria1:=\"&gt;=0.4\"\n\n'this doesn't work \u2026\n.AutoFilter Field:=19, Criteria1:=\"=0.4\"\n\n'but this works \u2026\n.AutoFilter Field:=19, Criteria1:=\"=0,4\"\n</code></pre>\n\n<p>So this might be why it doesn't work with VBA but it works later when you hit the apply filter manually. </p>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 9359146, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919199318114012/picture?type=large", "display_name": "Jerome", "link": "https://stackoverflow.com/users/9359146/jerome"}, "is_accepted": true, "score": 0, "last_activity_date": 1540540983, "creation_date": 1540540983, "answer_id": 53004159, "question_id": 48907268, "link": "https://stackoverflow.com/questions/48907268/auto-filter-doesnt-seem-to-apply/53004159#53004159", "title": "Auto filter doesn&#39;t seem to apply", "body": "<p>A bit of time has gone by but to close the question:</p>\n\n<p>It was in fact not an error by code (all tough it might could've been prevented by better code), but rather a problem with how MS Excel handles the decimal separator in the German version. </p>\n\n<p>Short term solution: take a detour by reading the values into an array.</p>\n\n<p>I posted the problem to Microsoft, but can't find the post anymore. In the meantime I switched to an English client, so the problem for me is no longer relevant. </p>\n\n<p>Thanks for all the help\nJerome</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 9359146, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919199318114012/picture?type=large", "display_name": "Jerome", "link": "https://stackoverflow.com/users/9359146/jerome"}, "edited": false, "score": 0, "creation_date": 1541401629, "post_id": 53127266, "comment_id": 93189859, "body": "Hey @alpenjoe77 thank you for your input, unfortunately the script itself doesn&#39;t exist in this form anymore so I can&#39;t evaluate your suggestion, but since we tried different replace approaches I am not sure about it.   All the best Jerome :-)"}], "tags": [], "owner": {"reputation": 1, "user_id": 8891008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb00316a960ddb644d4866c5a7e6fa?s=128&d=identicon&r=PG&f=1", "display_name": "alpenjoe77", "link": "https://stackoverflow.com/users/8891008/alpenjoe77"}, "is_accepted": false, "score": 0, "last_activity_date": 1541204262, "creation_date": 1541204262, "answer_id": 53127266, "question_id": 48907268, "link": "https://stackoverflow.com/questions/48907268/auto-filter-doesnt-seem-to-apply/53127266#53127266", "title": "Auto filter doesn&#39;t seem to apply", "body": "<p>in case you still need a solution for comma-based Excel versions (e.g. German):</p>\n\n<pre><code>Dim minDateString as String\nminDateString = Replace(CStr(CDbl([minDate])), \",\", \".\")\nDebug.Print minDateString\n</code></pre>\n\n<p>... where [minDate] refers to a named range, you can replace with any value you'd like to.</p>\n\n<p>Basically, what it does:</p>\n\n<p>1) Get correct value in integer form => <code>CDbl([minDate])</code></p>\n\n<p>2) Convert from integer to string => <code>CStr ()</code></p>\n\n<p>3) Replace comma with point => <code>Replace</code></p>\n\n<p>Afterwards, you can call it like that:</p>\n\n<pre><code>.AutoFilter Field:=11, Criteria1:=\"&gt;=\" &amp; minDateString, Operator:=xlFilterValues\n</code></pre>\n\n<p>It should work! :)</p>\n"}], "owner": {"reputation": 19, "user_id": 9359146, "user_type": "registered", "profile_image": "https://graph.facebook.com/1919199318114012/picture?type=large", "display_name": "Jerome", "link": "https://stackoverflow.com/users/9359146/jerome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2436, "favorite_count": 0, "accepted_answer_id": 53004159, "answer_count": 4, "score": 0, "last_activity_date": 1541204262, "creation_date": 1519219911, "last_edit_date": 1531164843, "question_id": 48907268, "link": "https://stackoverflow.com/questions/48907268/auto-filter-doesnt-seem-to-apply", "title": "Auto filter doesn&#39;t seem to apply", "body": "<p>I've got a list of values, and am trying to apply an auto filter to it.\nAll this set in a while loop. While the filter value seems right, I have to enter Excel click on the filter menu and click okay again.</p>\n\n<pre><code>Dim zaehlerHeights As Double\n\nzaehlerHeights = 0.4\nWhile zaehlerHeights &lt;= 25\n    Sheets(\"Rohdaten WG22\").Select\n\n        Columns(\"S:S\").Select\n        Range(\"Tabelle13[[#Headers],[HOEHE_VON]]\").Activate\n        ActiveSheet.ListObjects(\"Tabelle13\").Range.AutoFilter Field:=19, Criteria1 _\n        :=\"&lt;\" &amp; zaehlerHeights, Operator:=xlAnd\n\n        Columns(\"T:T\").Select\n        Range(\"Tabelle13[[#Headers],[HOEHE_BIS]]\").Activate\n        ActiveSheet.ListObjects(\"Tabelle13\").Range.AutoFilter Field:=20, Criteria1 _\n        :=\"&gt;\" &amp; zaehlerHeights, Operator:=xlAnd\n    ActiveSheet.AutoFilter.ApplyFilter\n</code></pre>\n\n<p>Not sure why this is so. Any ideas?</p>\n\n<hr>\n\n<p><strong>Edit:</strong>\nSo, thanks to Mike and Peh, we narrowed down the problem. It seems that the decimal separator is the problem.\nI use the German version of Excel, while Mike, for whom his solution works, probably uses the English/American version.\nThe separator for me is the comma, while for Mike it is the dot. VBA, though translating my dot to a comma, won't apply the filter properly.\nWe tried replace() for the variable, but that doesn't work either.\nIf I go through enough loops to reach a integer value (e.g. 1.0) the filters work just fine.</p>\n\n<p>So, still no solution, but a better picture of the error.\nI assume, that if I would using the English version of Excel, the code would work just fine. For me this is more of a bug.</p>\n\n<hr>\n\n<p>Thanks in advance\nJerome</p>\n"}, {"tags": ["excel", "loops", "datetime", "vba"], "answers": [{"comments": [{"owner": {"reputation": 502, "user_id": 5615571, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1N7Uh.jpg?s=128&g=1", "display_name": "aspan88", "link": "https://stackoverflow.com/users/5615571/aspan88"}, "edited": false, "score": 0, "creation_date": 1519219448, "post_id": 48907015, "comment_id": 84819788, "body": "Thank you so much \u263a"}, {"owner": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 2, "creation_date": 1519220240, "post_id": 48907015, "comment_id": 84820416, "body": "You could also complete the formatting within the VBA code by adding the following just before Next i: ActiveCell.Offset(i, 0).NumberFormat = &quot;mm/dd/yyyy hh:mm AM/PM&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 2, "creation_date": 1519220766, "post_id": 48907015, "comment_id": 84820794, "body": "@Thom - Good point. I was thinking it would be best in bulk outside the loop but there was insufficient sample code to offer a solution."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 4, "last_activity_date": 1519219117, "creation_date": 1519219117, "answer_id": 48907015, "question_id": 48906814, "link": "https://stackoverflow.com/questions/48906814/concatenate-date-and-decimal-time-in-format-mm-dd-yyyy-hhmm-format/48907015#48907015", "title": "Concatenate Date and Decimal Time in format mm/dd/yyyy hh:mm format", "body": "<p>Add the time to the date to achieve a datetime.</p>\n\n<pre><code>ActiveCell.Offset(i, 0).Value = dateofProject + c\n</code></pre>\n\n<p>Format the result cells as <code>mm/dd/yyyy hh:mm am/pm</code>.</p>\n\n<p>This assumes that the date is a real date and the times are real times not text-that-looks-like-a-date-or-time.</p>\n"}], "owner": {"reputation": 502, "user_id": 5615571, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1N7Uh.jpg?s=128&g=1", "display_name": "aspan88", "link": "https://stackoverflow.com/users/5615571/aspan88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 48907015, "answer_count": 1, "score": 4, "last_activity_date": 1519219968, "creation_date": 1519218630, "last_edit_date": 1531161705, "question_id": 48906814, "link": "https://stackoverflow.com/questions/48906814/concatenate-date-and-decimal-time-in-format-mm-dd-yyyy-hhmm-format", "title": "Concatenate Date and Decimal Time in format mm/dd/yyyy hh:mm format", "body": "<p>For timings <code>7:00 AM</code>; <code>7:15 AM</code>,.... <code>17:00</code>;<code>17:15</code> in rows and date in a Range B6, I am trying to concatenate the values but the value I am getting is in format <code>02/21/2018 0.29917</code> format. How can I convert it into format <code>02/21/2018 7:00</code> so on... </p>\n\n<p><code>c</code> is time value( <code>7:00 AM</code>, <code>7:15 AM</code>... <code>6:00 PM</code>)</p>\n\n<pre><code>For i = 0 To lRow - 1\n    c = ActiveCell.Offset(i, 0).Value\n    ActiveCell.Offset(i, 0).Value = dateofProject &amp; \" \" &amp; c\nNext i\n</code></pre>\n"}, {"tags": ["excel", "excel-2016", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1519218144, "post_id": 48906559, "comment_id": 84818893, "body": "<code>lro = lasrow</code> and <code>MsgBox (&quot;lRow is &quot; &amp; lRow)</code>? Typos? Use Option Explicit."}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 0, "creation_date": 1519218346, "post_id": 48906559, "comment_id": 84819022, "body": "On what line is the error and what exactly is the error?"}, {"owner": {"reputation": 1, "user_id": 9390871, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Harry Shuttleworth", "link": "https://stackoverflow.com/users/9390871/harry-shuttleworth"}, "edited": false, "score": 0, "creation_date": 1519218389, "post_id": 48906559, "comment_id": 84819052, "body": "ah yes, thanks for the help, i have added option explicit now. This was just a problem as i changed some variable names before posting on here, but the problem with the function not calling still persists"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1519218506, "post_id": 48906559, "comment_id": 84819132, "body": "You are declaring a variable with the same name as your function. Remove the <code>Dim lasrow As Long</code>."}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 0, "creation_date": 1519218577, "post_id": 48906559, "comment_id": 84819180, "body": "There is a much simpler way to find the last row. If you know what column will get you the last row you can use something like this <code>lro = ActiveSheet.Cells(ActiveSheet.Rows.count, 1).End(xlUp).row</code> Then you won&#39;t need a separate function. Which I&#39;m not sure is actually finding the last row."}, {"owner": {"reputation": 1, "user_id": 9390871, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Harry Shuttleworth", "link": "https://stackoverflow.com/users/9390871/harry-shuttleworth"}, "edited": false, "score": 0, "creation_date": 1519218621, "post_id": 48906559, "comment_id": 84819211, "body": "Hey Mike, so when calling the lasrow function the sub should pull through a number. So the line &#39;lro = lasrow&#39; should set variable lro to something like 70 in my example. However this does not work, and so when the rest of the code executes it works with lro as if it were 0."}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519218746, "post_id": 48906559, "comment_id": 84819301, "body": "That&#39;s because lasrow is 0. Like @SJR says you are declaring a variable with the same name as your function so you are never calling the function."}, {"owner": {"reputation": 1, "user_id": 9390871, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Harry Shuttleworth", "link": "https://stackoverflow.com/users/9390871/harry-shuttleworth"}, "edited": false, "score": 0, "creation_date": 1519218801, "post_id": 48906559, "comment_id": 84819341, "body": "Mike does &#39;LastRow = ActiveSheet.Cells(ActiveSheet.Rows.count, 1).End(xlUp).row&#39; account for blank cells? Sorry I am quite new to VBA"}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 0, "creation_date": 1519218857, "post_id": 48906559, "comment_id": 84819385, "body": "Yes, what it does is look for the last row that has data by going from the bottom up, not the top down."}, {"owner": {"reputation": 1, "user_id": 9390871, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Harry Shuttleworth", "link": "https://stackoverflow.com/users/9390871/harry-shuttleworth"}, "edited": false, "score": 1, "creation_date": 1519218963, "post_id": 48906559, "comment_id": 84819455, "body": "Ah i ok i will use this instead thank you! And thank you guys, SJR you were correct, removing Dim lasrow As Long made it work!"}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 1, "creation_date": 1519219146, "post_id": 48906559, "comment_id": 84819565, "body": "Just as an FYI, if you use an <code>@</code> in front of a users name then it will send an alert to that user."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519219814, "post_id": 48906559, "comment_id": 84820068, "body": "Also I suggest you read up on how to avoid Select."}], "answers": [{"tags": [], "owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1519219699, "creation_date": 1519219699, "answer_id": 48907203, "question_id": 48906559, "link": "https://stackoverflow.com/questions/48906559/vba-function-not-calling-correctly/48907203#48907203", "title": "VBA function not calling correctly", "body": "<p>Just to sum things up:</p>\n\n<p>To fix the problem you are having you need to remove the variable declaration that has the same name as your function.</p>\n\n<p>To make it even simpler you can just remove the function and have your sub like this:</p>\n\n<pre><code>Sub Submit_data()\n\n    Dim lRow As Long\n    Dim lCol As Long\n    Dim colName As Long\n    Dim resetrange As Range\n    Dim indicator As String\n    Dim Dire(1 To 6, 1 To 2) As String\n    Dim i As Integer\n    Dim lasCol As Long\n    Dim lro As Long\n\n\n    Dire(1, 1) = \"B2\": Dire(1, 2) = \"D2\"\n    Dire(2, 1) = \"B3\": Dire(2, 2) = \"D3\"\n    Dire(3, 1) = \"B4\": Dire(3, 2) = \"D4\"\n    Dire(4, 1) = \"G7\": Dire(4, 2) = \"I7\"\n    Dire(5, 1) = \"G11\": Dire(5, 2) = \"I11\"\n    Dire(6, 1) = \"G13\": Dire(6, 2) = \"I13\"\n\n    Application.ScreenUpdating = False\n\n    If IsEmpty(Range(\"I15\")) = False Then\n        'Change this so find the last row without the function\n        'The \"1\" is telling it to look in column \"A\"\n        'The ActiveSheet.Rows.Count is using the maximum number of possible rows as the row which is 1048576\n        'So it is starting in A1048576 and going up till it finds the first non-empty row and returning that row number\n        lro = ActiveSheet.Cells(ActiveSheet.Rows.count, 1).End(xlUp).row\n        Worksheets(\"User\").Select\n        Range(\"I15\").Select\n        Application.CutCopyMode = False\n        Selection.Copy\n        Sheets(\"Data - Complete\").Select\n        Cells(lro + 1, 5).Select 'problem with selecting column\n        ActiveSheet.Paste\n        Worksheets(\"User\").Select\n        Range(\"I15\").Select\n        Selection.ClearContents\n    MsgBox (\"lRow is \" &amp; lro)\n\n    End If\n</code></pre>\n\n<p>and you still don't need the lasrow variable with what is showing here.</p>\n"}], "owner": {"reputation": 1, "user_id": 9390871, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Harry Shuttleworth", "link": "https://stackoverflow.com/users/9390871/harry-shuttleworth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 379, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519219699, "creation_date": 1519217934, "last_edit_date": 1531161705, "question_id": 48906559, "link": "https://stackoverflow.com/questions/48906559/vba-function-not-calling-correctly", "title": "VBA function not calling correctly", "body": "<p>I have the following function which finds the last row in a worksheet and am trying to call it in my Sub Submit_data(). The sub doesn't seem to recognise it and so the message box returns 0. However, if I place the exact same code in a test sub with nothing else in it it works. Anyone have any idea why this would be? note: my submit data sub is longer so I have just included the the first portion where the error occurs.</p>\n\n<pre><code>Private Function lasrow() As Long\nWorksheets(\"Data - Complete\").Select\nlasrow = Cells.Find(What:=\"*\", _\nAfter:=Range(\"A1\"), _\nLookAt:=xlPart, _\nLookIn:=xlFormulas, _\nSearchOrder:=xlByRows, _\nSearchDirection:=xlPrevious, _\nMatchCase:=False).Row\nEnd Function\n\nSub Submit_data()\n\nDim lRow As Long\nDim lCol As Long\nDim colName As Long\nDim resetrange As Range\nDim indicator As String\nDim Dire(1 To 6, 1 To 2) As String\nDim i As Integer\nDim lasrow As Long, lasCol As Long\nDim lro As Long\n\n\nDire(1, 1) = \"B2\": Dire(1, 2) = \"D2\"\nDire(2, 1) = \"B3\": Dire(2, 2) = \"D3\"\nDire(3, 1) = \"B4\": Dire(3, 2) = \"D4\"\nDire(4, 1) = \"G7\": Dire(4, 2) = \"I7\"\nDire(5, 1) = \"G11\": Dire(5, 2) = \"I11\"\nDire(6, 1) = \"G13\": Dire(6, 2) = \"I13\"\n\nApplication.ScreenUpdating = False\n\nIf IsEmpty(Range(\"I15\")) = False Then\n    lro = lasrow\n    Worksheets(\"User\").Select\n    Range(\"I15\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Data - Complete\").Select\n    Cells(lro + 1, 5).Select 'problem with selecting column\n    ActiveSheet.Paste\n    Worksheets(\"User\").Select\n    Range(\"I15\").Select\n    Selection.ClearContents\nMsgBox (\"lRow is \" &amp; lro)\n\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9390972, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jasper Nathan Nery", "link": "https://stackoverflow.com/users/9390972/jasper-nathan-nery"}, "edited": false, "score": 0, "creation_date": 1519263582, "post_id": 48908669, "comment_id": 84843006, "body": "Thank you sir! This was the first one I tried and it worked perfectly."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1519224090, "creation_date": 1519224090, "answer_id": 48908669, "question_id": 48906403, "link": "https://stackoverflow.com/questions/48906403/how-to-code-a-vba-macro-that-can-copy-a-row-from-a-local-workbook-to-another-wor/48908669#48908669", "title": "How to code a VBA macro that can copy a row from a local workbook to another workbook in a network drive?", "body": "<p>Use ADO to treat the master spreadsheet as a database that your local files write to</p>\n\n<p><a href=\"http://visualbasic.happycodings.com/database-sql-stuff/code14.html\" rel=\"nofollow noreferrer\">http://visualbasic.happycodings.com/database-sql-stuff/code14.html</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9390972, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jasper Nathan Nery", "link": "https://stackoverflow.com/users/9390972/jasper-nathan-nery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519224090, "creation_date": 1519217446, "last_edit_date": 1531164843, "question_id": 48906403, "link": "https://stackoverflow.com/questions/48906403/how-to-code-a-vba-macro-that-can-copy-a-row-from-a-local-workbook-to-another-wor", "title": "How to code a VBA macro that can copy a row from a local workbook to another workbook in a network drive?", "body": "<p>The excel template I'm working on requires me to transfer data (all text) from a local workbook to a masterfile on a network drive (with an IP address). The macro is preferably on the local file. </p>\n\n<p>The most basic scenario would be having multiple copies of the local workbook used simultaneously on different computers and all the data inputted would be copied to the masterfile on the network via a button in the local files. </p>\n\n<p>Any insight or help is very much appreciated! Thank you.    </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2285, "user_id": 903783, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000813825134/picture?type=large", "display_name": "George Birbilis", "link": "https://stackoverflow.com/users/903783/george-birbilis"}, "edited": false, "score": 1, "creation_date": 1519217651, "post_id": 48906333, "comment_id": 84818540, "body": "For starters try calculating/creating loop invariant objects outside the loops. E.g. maybe change For Each x In Range(&quot;A:A&quot;) to For Each x in RangeA and assign RangeA before the loops. Also, good practice might be to clear those variables before exiting the macro"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 2285, "user_id": 903783, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000813825134/picture?type=large", "display_name": "George Birbilis", "link": "https://stackoverflow.com/users/903783/george-birbilis"}, "edited": false, "score": 0, "creation_date": 1519217797, "post_id": 48906333, "comment_id": 84818643, "body": "By using full columns you are doing at least a million million loops! Do as @GeorgeBirbilis says and limit to the used range."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1519218047, "post_id": 48906333, "comment_id": 84818819, "body": "I tried it , but how  should I assign RangeA before loops as e.g ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1519218066, "post_id": 48906333, "comment_id": 84818836, "body": "<code>Set CompareRange = Sheets(&quot;Feuil1&quot;).Range(&quot;A:A&quot;).resize(derlignC, 1)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1519218170, "post_id": 48906333, "comment_id": 84818908, "body": "<code>For Each x In Range(&quot;A:A&quot;).resize(derlignE, 1)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1519218499, "post_id": 48906333, "comment_id": 84819130, "body": "Thank you , it is working perfectly ."}], "owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519217455, "creation_date": 1519217215, "last_edit_date": 1531164843, "question_id": 48906333, "link": "https://stackoverflow.com/questions/48906333/vba-loop-and-fill-the-missing-data", "title": "VBA-Loop and fill the missing Data", "body": "<p>I'm creating a macro that loop in sheet for specific value and then fill the missing data that  are mentionned in another sheet \nthe code works fine but the problem it take toooo much time to fill the missing values and sometime the excel file doesn't respond which oblige me to repeat the whole thing again</p>\n\n<p><strong>My code :</strong> </p>\n\n<pre><code>Sub TraiterNoms()\n  Application.ScreenUpdating = False\n  Application.DisplayAlerts = False\n  Dim i As Variant\n  Dim CompareRange As Variant\n  Dim x As Variant\n  Dim y As Variant\n  Dim derlignE As Variant\n  Dim derlignC As Variant\n\n\n  derlignE = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n  derlignC = Sheets(\"Feuil1\").Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n  Set CompareRange = Sheets(\"Feuil1\").Range(\"A:A\")\n\n  For i = Range(\"A\" &amp; Rows.Count).End(xlUp).Row To 1 Step -1\n    If Range(\"B\" &amp; i) = \"\" Then\n      For Each x In Range(\"A:A\")\n        For Each y In CompareRange\n          If x = y Then x.Offset(0, 1) = y.Offset(0, 1)\n        Next y\n      Next x\n    End If\n  Next i\n  Application.ScreenUpdating = True\n  Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>Anyone can light me please about Optimizing this code </p>\n"}, {"tags": ["sql-server", "vba", "ssis", "script-task"], "comments": [{"owner": {"reputation": 20094, "user_id": 1832636, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/03182c8b98caa6f9af95e4f4afd7c018?s=128&d=identicon&r=PG", "display_name": "Dan Bracuk", "link": "https://stackoverflow.com/users/1832636/dan-bracuk"}, "edited": false, "score": 0, "creation_date": 1519217452, "post_id": 48906327, "comment_id": 84818406, "body": "What is the question?"}, {"owner": {"reputation": 197, "user_id": 3482527, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/96b3307b013f7e65308599f8c6e8b8d5?s=128&d=identicon&r=PG&f=1", "display_name": "user3482527", "link": "https://stackoverflow.com/users/3482527/user3482527"}, "reply_to_user": {"reputation": 20094, "user_id": 1832636, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/03182c8b98caa6f9af95e4f4afd7c018?s=128&d=identicon&r=PG", "display_name": "Dan Bracuk", "link": "https://stackoverflow.com/users/1832636/dan-bracuk"}, "edited": false, "score": 0, "creation_date": 1519217714, "post_id": 48906327, "comment_id": 84818580, "body": "How to use above vba in SSIS script task ?"}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 3482527, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/96b3307b013f7e65308599f8c6e8b8d5?s=128&d=identicon&r=PG&f=1", "display_name": "user3482527", "link": "https://stackoverflow.com/users/3482527/user3482527"}, "edited": false, "score": 0, "creation_date": 1519223099, "post_id": 48907700, "comment_id": 84822393, "body": "Hi @KeithL Many thanks for your reply. Rest of the code looks great, however getting an error message on wc.Credentials = new System.Net.NetworkCredentials"}, {"owner": {"reputation": 197, "user_id": 3482527, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/96b3307b013f7e65308599f8c6e8b8d5?s=128&d=identicon&r=PG&f=1", "display_name": "user3482527", "link": "https://stackoverflow.com/users/3482527/user3482527"}, "edited": false, "score": 0, "creation_date": 1519223597, "post_id": 48907700, "comment_id": 84822784, "body": "Type or namespace name NetworkCredentials doesnot exist in namespace system.Net(or Are you missing an assembly referance?)"}, {"owner": {"reputation": 4496, "user_id": 3325290, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba85b021834dcc4f71e91234f93332b6?s=128&d=identicon&r=PG&f=1", "display_name": "KeithL", "link": "https://stackoverflow.com/users/3325290/keithl"}, "reply_to_user": {"reputation": 197, "user_id": 3482527, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/96b3307b013f7e65308599f8c6e8b8d5?s=128&d=identicon&r=PG&f=1", "display_name": "user3482527", "link": "https://stackoverflow.com/users/3482527/user3482527"}, "edited": false, "score": 0, "creation_date": 1519223785, "post_id": 48907700, "comment_id": 84822931, "body": "In solution explorer usually on right side. ricght click reference and &quot;Add Reference&quot; and add System.Net"}, {"owner": {"reputation": 197, "user_id": 3482527, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/96b3307b013f7e65308599f8c6e8b8d5?s=128&d=identicon&r=PG&f=1", "display_name": "user3482527", "link": "https://stackoverflow.com/users/3482527/user3482527"}, "edited": false, "score": 0, "creation_date": 1519225168, "post_id": 48907700, "comment_id": 84824000, "body": "Hi Keith, Did that, now error lines have gone. But still when i tried to close the script task after saving the code, it pops up with error message that compiled script has errors in it. I can&#39;t execute script error task."}, {"owner": {"reputation": 197, "user_id": 3482527, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/96b3307b013f7e65308599f8c6e8b8d5?s=128&d=identicon&r=PG&f=1", "display_name": "user3482527", "link": "https://stackoverflow.com/users/3482527/user3482527"}, "edited": false, "score": 0, "creation_date": 1519227031, "post_id": 48907700, "comment_id": 84825320, "body": "This is the actual error Keith &#39;NetworkCredentials&#39; does not implement interface member &#39;ICredentials.GetCredential(Uri, string)&#39;"}, {"owner": {"reputation": 197, "user_id": 3482527, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/96b3307b013f7e65308599f8c6e8b8d5?s=128&d=identicon&r=PG&f=1", "display_name": "user3482527", "link": "https://stackoverflow.com/users/3482527/user3482527"}, "edited": false, "score": 0, "creation_date": 1519255636, "post_id": 48907700, "comment_id": 84840912, "body": "Many thanks Keith. Took me good few hours but managed to find the issue.Rest of the code is correct, however new System.Net.NetworkCredentials is without &quot;s&quot; at the end. Many thanks for your help. Top man."}, {"owner": {"reputation": 4496, "user_id": 3325290, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba85b021834dcc4f71e91234f93332b6?s=128&d=identicon&r=PG&f=1", "display_name": "KeithL", "link": "https://stackoverflow.com/users/3325290/keithl"}, "reply_to_user": {"reputation": 197, "user_id": 3482527, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/96b3307b013f7e65308599f8c6e8b8d5?s=128&d=identicon&r=PG&f=1", "display_name": "user3482527", "link": "https://stackoverflow.com/users/3482527/user3482527"}, "edited": false, "score": 0, "creation_date": 1519261509, "post_id": 48907700, "comment_id": 84842489, "body": "Sorry. I had to type it out without visual studio. Glad you got your answer"}], "tags": [], "owner": {"reputation": 4496, "user_id": 3325290, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba85b021834dcc4f71e91234f93332b6?s=128&d=identicon&r=PG&f=1", "display_name": "KeithL", "link": "https://stackoverflow.com/users/3325290/keithl"}, "is_accepted": true, "score": 1, "last_activity_date": 1519261637, "last_edit_date": 1519261637, "creation_date": 1519221231, "answer_id": 48907700, "question_id": 48906327, "link": "https://stackoverflow.com/questions/48906327/how-to-download-a-file-with-a-script-task-in-ssis/48907700#48907700", "title": "How to download a file with a script Task in SSIS", "body": "<p>in a script task using C#:</p>\n\n<pre><code>System.Net.WebClient wc = new System.Net.WebClient();\nwc.Credentials = new System.Net.NetworkCredential(\"1234\",\"1234\"); // user,pword\nwc.DownloadFile(\"https://123.123.co.uk?filename=Test.xls\"\n                ,@\"c:\\Test\"+DateTime.Now.ToString(\"yyyyMMdd\")+\".xls\");\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 3482527, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/96b3307b013f7e65308599f8c6e8b8d5?s=128&d=identicon&r=PG&f=1", "display_name": "user3482527", "link": "https://stackoverflow.com/users/3482527/user3482527"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1527, "favorite_count": 0, "accepted_answer_id": 48907700, "answer_count": 1, "score": -1, "last_activity_date": 1519309878, "creation_date": 1519217201, "last_edit_date": 1519309878, "question_id": 48906327, "link": "https://stackoverflow.com/questions/48906327/how-to-download-a-file-with-a-script-task-in-ssis", "title": "How to download a file with a script Task in SSIS", "body": "<p>I am struggling to use below vba in SSIS script Task. Basically it downloads a file from web and saves it on a shared drive . File is then loaded in SQL server.I have tried the code and it works in Excel VBA.I have modified the URL for security purposes. Below is just an example</p>\n\n<pre><code>`Const MYURL = \"https://123.123.co.uk&amp;filename=Test.xls\"\n\n Sub DataScraping()\n\nSet objHTTP = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\nobjHTTP.Open \"GET\", MYURL, False\nobjHTTP.SetCredentials \"1234\", \"1234\", HTTPREQUEST_SETCREDENTIALS_FOR_SERVER\n\nobjHTTP.Send\n\nSet oStream = CreateObject(\"ADODB.Stream\")\noStream.Open\noStream.Type = 1\noStream.Write objHTTP.ResponseBody\noStream.SaveToFile (\"\\\\C\\files\\Test\\file13 \" &amp; Format(Now(), \"ddMMyyyy \nHHmmss\") &amp; \".xls\")\noStream.Close\nEnd Sub'\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 397, "user_id": 7950833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/407c76d0b44d62e6ff0159337f2ecac9?s=128&d=identicon&r=PG&f=1", "display_name": "kulapo", "link": "https://stackoverflow.com/users/7950833/kulapo"}, "edited": false, "score": 0, "creation_date": 1519217001, "post_id": 48906113, "comment_id": 84818089, "body": "Here&#39;s a good reference for <a href=\"https://stackoverflow.com/questions/13860894/ms-excel-crashes-when-vba-code-runs\">Worksheet_Change</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9097353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hes1CNF0b2A/AAAAAAAAAAI/AAAAAAAAAB4/1PY65I2t6b0/photo.jpg?sz=128", "display_name": "Aashay Sukhthankar", "link": "https://stackoverflow.com/users/9097353/aashay-sukhthankar"}, "edited": false, "score": 0, "creation_date": 1519224855, "post_id": 48906180, "comment_id": 84823781, "body": "Oh Thanks!! I&#39;m relatively new to VBA so I had no idea you could even turn off events. I dabbled with the If Else construct to make it a nested if without else to see if that made a difference but it didn&#39;t. Also, my 1-D arrays are always with Base 1. I use Excel 2010. Does that make a difference? I believe to make it 0-based you need an OPTION BASE 0 command at the start of the module."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1, "user_id": 9097353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hes1CNF0b2A/AAAAAAAAAAI/AAAAAAAAAB4/1PY65I2t6b0/photo.jpg?sz=128", "display_name": "Aashay Sukhthankar", "link": "https://stackoverflow.com/users/9097353/aashay-sukhthankar"}, "edited": false, "score": 0, "creation_date": 1519225266, "post_id": 48906180, "comment_id": 84824074, "body": "Well, if something is not blank then by strict definition is that the else is blank. <code>ElseIf (Target.Value = &quot;&quot;) Then</code> could be just <code>Else</code>. You haven&#39;t provided enough detail on purpose and sample data to suggest anything else."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1519217605, "last_edit_date": 1519217605, "creation_date": 1519216766, "answer_id": 48906180, "question_id": 48906113, "link": "https://stackoverflow.com/questions/48906113/infinite-loop-and-crash-when-trying-to-execute-this-code-in-worksheet-change-met/48906180#48906180", "title": "Infinite loop and crash when trying to execute this code in Worksheet_Change method", "body": "<p>You need to turn off events before changing values on the same worksheet or you trigger another event.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim arr() As String\n    Dim i As Byte\n    Dim j As Byte\n\n    If (Target.Column = 1) Then\n        APPLICATION.ENABLEEVENTS = FALSE\n        If (Target.Value &lt;&gt; \"\") Then\n            arr() = BreakupWord(\"perform\")\n            For i = 1 To 10\n                Cells(Target.Row, i + 1) = arr(i)\n            Next i\n        ElseIf (Target.Value = \"\") Then\n            For j = 1 To 10\n                Cells(Target.Row, i + 1) = \"\"    'should i be j?\n            Next j\n        End If\n    End If\n    APPLICATION.ENABLEEVENTS = TRUE\nEnd Sub\n</code></pre>\n\n<p>You are not covering a situation where Target could be more than a single cell.</p>\n\n<p>I do not understand the nested If ... ElseIf ... End If. It reads If not blank ElseIf blank.</p>\n\n<p>Does BreakupWord return a 1-based array? By default a 1-D array is zero-based.</p>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1519225935, "creation_date": 1519225935, "answer_id": 48909286, "question_id": 48906113, "link": "https://stackoverflow.com/questions/48906113/infinite-loop-and-crash-when-trying-to-execute-this-code-in-worksheet-change-met/48909286#48909286", "title": "Infinite loop and crash when trying to execute this code in Worksheet_Change method", "body": "<p>you've already been told about the relevant issue of avoiding recursive call of the same event handler</p>\n\n<p>here's another code that:</p>\n\n<ul>\n<li><p>manages that issue</p></li>\n<li><p>adds an error trapping to prevent any error leave you with disabled event handling </p></li>\n<li><p>check for proper changed range to act on (one-cell range in column A)</p></li>\n<li><p>simplifies the cell writing</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim arr As Variant ' a Variant can handle arrays too\n\n    With Target 'reference changed range\n        If .Count = 1 Then ' if only one cell changed\n            If .Column = 1 Then ' if changed cell in column \"A\"\n                On Error GoTo ExitSafely 'handle possible errors\n                Application.EnableEvents = False 'prevent subsequent sheet changing rise and infinite loop by calling recursively thsi very same sub\n                If .value &lt;&gt; \"\" Then\n                    arr = BreakupWord(\"perform\")\n                    .Offset(, 1).Resize(, UBound(arr) - LBound(arr) + 1) = arr 'write next to changed cell into as many cells as array elements\n                Else\n                    .Parent.Range(.Parent.Cells(.Row, .Parent.Cells.Columns.Count).End(xlToLeft), .Offset(, 1)).ClearContents 'clear the content of any cell right of changed one\n'                    .Offset(, 1).Resize(, 10).ClearContents ' clear 10 cells right of changed one\n                End If\n            End If\n        End If\n    End With\n\nExitSafely:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre></li>\n</ul>\n\n<p>just be sure that your <code>BreakupWord()</code> function returns a <code>Variant</code> array, like for instance</p>\n\n<pre><code>Function BreakupWord(strng As String) As Variant\n    '....\n    BreakupWord = Array(\"1\", \"2\", \"3\", \"4\")\n\n    'in the end\n    BreakupWord = Array(\"1\", \"2\", \"3\", \"4\") ' or any other way to assign an array to BreakupWord \nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9097353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hes1CNF0b2A/AAAAAAAAAAI/AAAAAAAAAB4/1PY65I2t6b0/photo.jpg?sz=128", "display_name": "Aashay Sukhthankar", "link": "https://stackoverflow.com/users/9097353/aashay-sukhthankar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "closed_date": 1546869520, "answer_count": 2, "score": 0, "last_activity_date": 1519225935, "creation_date": 1519216595, "last_edit_date": 1531164843, "question_id": 48906113, "link": "https://stackoverflow.com/questions/48906113/infinite-loop-and-crash-when-trying-to-execute-this-code-in-worksheet-change-met", "closed_reason": "Duplicate", "title": "Infinite loop and crash when trying to execute this code in Worksheet_Change method", "body": "<p>So I have developed an algorithm that breaks down a word into multiple parts based on certain rules about letter occurrences within the word. I have managed to debug the entire algorithm and now for the sake of convenience for the user, I am trying to put it into a Worksheet_Change method like this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim arr() As String\n    Dim i As Byte\n    Dim j As Byte\n\n    If (Target.Column = 1) Then\n        If (Target.Value &lt;&gt; \"\") Then\n            arr() = BreakupWord(\"perform\")\n            For i = 1 To 10\n                Cells(Target.Row, i + 1) = arr(i)\n            Next i\n        ElseIf (Target.Value = \"\") Then\n            For j = 1 To 10\n                Cells(Target.Row, i + 1) = \"\"\n            Next j\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>Basically, the variable arr() stores the broken down components of the word \"Target\" in its array and via a For loop I try to print out the contents into cells on the worksheet <strong><em>considering the user has made a change only in column A of the worksheet as given by the conditions</em></strong></p>\n\n<p>Now, the problem is such: I tested multiple words one line after the other and the code runs smoothly. However, if I go to an already entered word in <strong><em>column A</em></strong> and delete it via <strong>Backspace</strong> or <strong>Delete</strong>, my code seems to enter an infinite loop and Excel crashes. What is possibly the problem and how can I avoid it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1519220430, "post_id": 48906076, "comment_id": 84820561, "body": "You can use just one <code>With</code> block here instead of two as they&#39;re both addressing the same Object"}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "edited": false, "score": 0, "creation_date": 1519217493, "post_id": 48906302, "comment_id": 84818435, "body": "yes, this is what I want, but it has to be under a button. That is the reason of  not using a worksheet change event..."}, {"owner": {"reputation": 4740, "user_id": 1148564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eQICm.jpg?s=128&g=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/1148564/joseph"}, "reply_to_user": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "edited": false, "score": 0, "creation_date": 1519217646, "post_id": 48906302, "comment_id": 84818537, "body": "@alex2002 I see. That could get a bit complicated. That would mean that when your workbook loads, you need to collect the current state of the worksheet you want to monitor. From there, you would have to keep a <code>Range</code> object that holds the addresses of existing values."}, {"owner": {"reputation": 4740, "user_id": 1148564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eQICm.jpg?s=128&g=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/1148564/joseph"}, "reply_to_user": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "edited": false, "score": 0, "creation_date": 1519220224, "post_id": 48906302, "comment_id": 84820406, "body": "@alex2002 check out the latest version"}, {"owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "edited": false, "score": 0, "creation_date": 1519315462, "post_id": 48906302, "comment_id": 84870640, "body": "I have tried to implement this code for other columns in the same worksheet i.e. copy from <i>column C</i> and paste it in <i>column F</i>. At the end, I receive the error that there is a duplication based on <b>CopyDataRange</b> when I am trying to run the macro, which is understandable as the macro doesn&#39;t know in which column should it look 1st, A or C. Is there any way I can add other columns that need to be pasted in different columns by using the code?  like, when i press the button, the values from col.A goes to col.D while the ones from col.C goes to column D?Thanks"}, {"owner": {"reputation": 4740, "user_id": 1148564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eQICm.jpg?s=128&g=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/1148564/joseph"}, "reply_to_user": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "edited": false, "score": 0, "creation_date": 1519325393, "post_id": 48906302, "comment_id": 84876763, "body": "@alex2002 if you only need to add one more column you could have separate variables to track separate columns like <code>CopyDataRangeA</code> and <code>CopyDataRangeC</code>. If you end up needing more than this, I would recommend considering a more advanced data structure like a custom type (see <a href=\"https://bettersolutions.com/vba/data-types/user-defined-types.htm\" rel=\"nofollow noreferrer\">bettersolutions.com/vba/data-types/user-defined-types.htm</a>)"}, {"owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "edited": false, "score": 0, "creation_date": 1519900071, "post_id": 48906302, "comment_id": 85099491, "body": "back again with a simple question. Is it possible to add in the code to copy the data only as values and not the all format? Thanks"}, {"owner": {"reputation": 4740, "user_id": 1148564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eQICm.jpg?s=128&g=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/1148564/joseph"}, "reply_to_user": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "edited": false, "score": 0, "creation_date": 1519909051, "post_id": 48906302, "comment_id": 85104650, "body": "@alex2002 yes, change <code>CopyDataRange.Copy CopyDataRange.Offset(0, 3)</code> into two lines: 1) <code>CopyDataRange.Copy</code> and 2) <code>CopyDataRange.Offset(0, 3).PasteSpecial Paste:=xlPasteValues</code>. That should do the trick."}], "tags": [], "owner": {"reputation": 4740, "user_id": 1148564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eQICm.jpg?s=128&g=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/1148564/joseph"}, "is_accepted": true, "score": 2, "last_activity_date": 1522201520, "last_edit_date": 1522201520, "creation_date": 1519217126, "answer_id": 48906302, "question_id": 48906076, "link": "https://stackoverflow.com/questions/48906076/range-copy-paste-vba/48906302#48906302", "title": "Range copy-paste vba", "body": "<p>Based on the requirements:</p>\n\n<ul>\n<li>Only copy new data</li>\n<li>Has to be copied when user clicks a button</li>\n</ul>\n\n<p>Here's what you could do:</p>\n\n<p>In the Worksheet that the button / data lives on:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal target As Range)\n    Dim sh As Worksheet\n    Set sh = ActiveSheet\n\n    Dim newdata As Range\n    Set newdata = Application.Intersect(target, sh.Range(\"A5\", \"A\" &amp; sh.Rows.Count))\n\n    If (Not newdata Is Nothing) Then\n        If (CopyDataRange Is Nothing) Then\n            Set CopyDataRange = newdata\n        Else\n            Set CopyDataRange = Application.Union(CopyDataRange, newdata)\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>In a Module:</p>\n\n<pre><code>Option Explicit\n\nPublic CopyDataRange As Range\n\nPublic Sub CommandButton1_Click()\n    If (Not CopyDataRange Is Nothing) Then\n        CopyDataRange.Copy CopyDataRange.Offset(0, 3)\n        Set CopyDataRange = Nothing\n    End If\nEnd Sub\n</code></pre>\n\n<p>What this will do is keep track of the new values only (this is what the <code>Worksheet_Change</code> event does), then when you click the button, it will copy only the new values to column D. It also resets the static range <code>CopyDataRange</code> back to <code>Nothing</code> so you don't repeat copying the same data from previous button clicks. Essentially, the button click will flush out the <code>CopyDataRange</code> range.</p>\n\n<p>EDIT:</p>\n\n<p>I decided to write a post about this <a href=\"https://www.spreadsheetsmadeeasy.com/copy-new-data-vba/\" rel=\"nofollow noreferrer\">here</a> to explain it further.</p>\n"}, {"tags": [], "owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "is_accepted": false, "score": 0, "last_activity_date": 1519218669, "creation_date": 1519218669, "answer_id": 48906826, "question_id": 48906076, "link": "https://stackoverflow.com/questions/48906076/range-copy-paste-vba/48906826#48906826", "title": "Range copy-paste vba", "body": "<p>As you guys said that it is a bit complicated, i modified the code and what it does now is to copy everything from the beginning. Not sure if this is the smart solution to use...</p>\n\n<pre><code>Private Sub CommandButton3_Click()\n\nApplication.ScreenUpdating = False\n     With Sheets(\"Creation\")\n        .Range(\"a1\", .Range(\"a1\").End(xlDown)).Copy End With\n\nWith Sheets(\"Creation\")\n        .Range(\"d1\").PasteSpecial Paste:=xlPasteValues\n\nEnd With End Sub\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "accepted_answer_id": 48906302, "answer_count": 2, "score": 0, "last_activity_date": 1522201520, "creation_date": 1519216484, "last_edit_date": 1519217089, "question_id": 48906076, "link": "https://stackoverflow.com/questions/48906076/range-copy-paste-vba", "title": "Range copy-paste vba", "body": "<p>The code below is transfering the values from column A to column D. When copied from column A, the values are always pasted on the next row empty in column D.</p>\n\n<p>Is it possible to make this code to copy the values from column A only when new values are inserted? because what it does now, it takes all the values from column A and paste them again in column D.</p>\n\n<p>i.e. Column A: a1 = 2; a2 = 3, a3 = 4 ---> Column D becomes: d1 = 2; d2 = 3; d3 = 4.</p>\n\n<p>now if I insert two other values in column A: a4 = 1; a5 = 2, I want only those two values two be transfered in column D, and not the all numbers again. So column D becomes d1 = 2; d2 = 3; d3 = 4, d4 = 1; d5 = 2.</p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>Private Sub CommandButton3_Click()\n\nApplication.ScreenUpdating = False\n\nWith Sheets(\"Sheet1\")\n     .Range(\"a5\", .Range(\"a5\").End(xlDown)).Copy\nEnd With\n\nWith Sheets(\"Sheet1\")\n     .Range(\"d\" &amp; .Rows.Count).End(xlUp)(2).PasteSpecial Paste:=xlPasteValues\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519216459, "post_id": 48906023, "comment_id": 84817734, "body": "The destination should be <code>Destination:=ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)</code> as you have already defined <code>ws</code> as a sheet in <code>wb</code>."}, {"owner": {"reputation": 55, "user_id": 8449681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a9808e69d1c7700906886d27f4455bd?s=128&d=identicon&r=PG&f=1", "display_name": "user8449681", "link": "https://stackoverflow.com/users/8449681/user8449681"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1519216907, "post_id": 48906023, "comment_id": 84818029, "body": "Makes sense now, thank you, it worked! how can I mark the comment as answer?"}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1519217008, "creation_date": 1519217008, "answer_id": 48906263, "question_id": 48906023, "link": "https://stackoverflow.com/questions/48906023/excel-vba-copy-destination-syntax-with-variables-for-workbook-worksheet/48906263#48906263", "title": "Excel VBA Copy Destination syntax with variables for Workbook/Worksheet", "body": "<p>Rather than</p>\n\n<p><code>Destination:=wb.ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)</code></p>\n\n<p>the destination should be</p>\n\n<p><code>Destination:=ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)</code></p>\n\n<p>as you have already defined ws as a sheet in wb.</p>\n"}], "owner": {"reputation": 55, "user_id": 8449681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a9808e69d1c7700906886d27f4455bd?s=128&d=identicon&r=PG&f=1", "display_name": "user8449681", "link": "https://stackoverflow.com/users/8449681/user8449681"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3592, "favorite_count": 0, "accepted_answer_id": 48906263, "answer_count": 1, "score": 1, "last_activity_date": 1519217008, "creation_date": 1519216280, "last_edit_date": 1531164843, "question_id": 48906023, "link": "https://stackoverflow.com/questions/48906023/excel-vba-copy-destination-syntax-with-variables-for-workbook-worksheet", "title": "Excel VBA Copy Destination syntax with variables for Workbook/Worksheet", "body": "<p>I am copying data from one workbook to another, both declared as variables, but my Copy Destination method throws us either Runtime Error 13 'Type mismatch' or Runtime Error 438 'Object doesn't support this property or method'. </p>\n\n<p>Could you please help me with the Syntax? Is it possible to have something like</p>\n\n<blockquote>\n  <p>Range(\"\").Copy Destination:=wb1.ws.Range(\"a\" &amp; Rows.Count).End(xlUp).Offset(1)</p>\n</blockquote>\n\n<p>or</p>\n\n<blockquote>\n  <p>Range(\"\").Copy Destination:=wb1.ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)</p>\n</blockquote>\n\n<p>My code</p>\n\n<pre><code>Sub Sundry_AllFiles(wb1, wbsource, rl, wsctrl, Mths6, Mths12)\n(==Declared elsewhere - Dim wb1,wbsource as Workbook\nSet wb1 = ThisWorkbook\nSet wbsource = Workbooks.Open(FPath &amp; Finame, ReadOnly:=True, Local:=True)\n===)\nDim ws As Worksheet\nDim r, rw As Long\nDim fnd As String\nDim fnm As String\n\nfnd = \"TOTAL\"\nfnm = wbsource.Name\nSet ws = wb1.Worksheets(\"Sundry\")\n\n'=====Macro runs from wb1 and analyses data in the wbsource\n\nIf IsEmpty(Range(\"A1\")) = True Then\nwbsource.Close SaveChanges:=False\nExit Sub\n\nElse\n            Application.CutCopyMode = False 'POSSIBLE SOLUTION DELETE IF DIDNT WORK\n            Columns(\"A:A\").Select\n            Selection.Insert shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n            With wbsource.Worksheets(1)\n                    For rw = 2 To .Cells(Rows.Count, 6).End(xlUp).Row\n                    .Cells(rw, 1) = Application.VLookup(fnd, wbsource.Worksheets(1). _\n                    Range(\"B:E\"),4, False)\n                    Next rw\n\n                For rw = 2 To .Cells(Rows.Count, 1).End(xlUp).Row\n                .Cells(rw, 15) = \"=IF(RC[-13]&lt;=TODAY()-90,\"\"Yes\"\",\"\"No\"\")\"\n                Next rw\n                .AutoFilterMode = False\n            End With\n\n            'Autofilter by tranDate&gt;90 days, copy and append to the ws sheet\n            With Range(\"N\" &amp; Rows.Count).End(xlUp)\n            .AutoFilter 15, \"Yes\"\n            With wbsource.Worksheets(1)\n            Dim LR As Long\n            On Error Resume Next\n            LR = Range(\"N\" &amp; Rows.Count).End(xlUp).Row\n            Range(\"A2:N\" &amp; LR).SpecialCells(xlCellTypeVisible).Copy _\nDestination:=wb1.ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\n\n'#Alternative to Copy Destination that works\n            'wb1.Activate\n            'ws.Range(\"a\" &amp; Rows.Count).End(xlUp).Offset(1).PasteSpecial\n\n            End With\n            End With\n\n            wbsource.Close SaveChanges:=False\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1519216425, "post_id": 48905913, "comment_id": 84817711, "body": "What is in Range(&quot;E4&quot;).value? Is it a real time or real datetime or a string?"}, {"owner": {"reputation": 19, "user_id": 1778577, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d890fe3a2ea63d79fd3d3c98bce72d96?s=128&d=identicon&r=PG", "display_name": "Gluons", "link": "https://stackoverflow.com/users/1778577/gluons"}, "edited": false, "score": 0, "creation_date": 1519216829, "post_id": 48905913, "comment_id": 84817979, "body": "It is Time format 12:30:55"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1519217321, "creation_date": 1519217321, "answer_id": 48906368, "question_id": 48905913, "link": "https://stackoverflow.com/questions/48905913/excel-vba-application-ontime-can-i-pass-a-time-value-to-it/48906368#48906368", "title": "Excel VBA Application.OnTime. Can I pass a time value to it?", "body": "<p>TimeValue converts text-that-looks-like-time into real time. It doesn't work well turning real time into time.</p>\n\n<pre><code>Application.OnTime endtime, Procedure:=\"Button1_Click\", Schedule:=False\n</code></pre>\n\n<p>You may want/need to include the current date. Typically, OnTime is launched on a datetime, not a time.</p>\n\n<pre><code>Application.OnTime Date + endtime, Procedure:=\"Button1_Click\", Schedule:=False\n</code></pre>\n\n<p>Date + endtime may have to be Date + endtime - int(endtime &lt; time) to run OnTime tomorrow if the scheduled time is earlier than now.</p>\n"}], "owner": {"reputation": 19, "user_id": 1778577, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d890fe3a2ea63d79fd3d3c98bce72d96?s=128&d=identicon&r=PG", "display_name": "Gluons", "link": "https://stackoverflow.com/users/1778577/gluons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "accepted_answer_id": 48906368, "answer_count": 1, "score": 0, "last_activity_date": 1519217487, "creation_date": 1519215954, "last_edit_date": 1519217487, "question_id": 48905913, "link": "https://stackoverflow.com/questions/48905913/excel-vba-application-ontime-can-i-pass-a-time-value-to-it", "title": "Excel VBA Application.OnTime. Can I pass a time value to it?", "body": "<p>I have an macro that runs and stops fine based on a button click, but I wanted to add the ability to automatically stop the \"start click\" at a time set in an excel field that would be adjustable by the user.\nI cannot find any details around being able to pass a time in from and excel field say E4 in this case to the OnTime function.   I don't want to hard code a time as it could change on when I want the <code>Button1_Click</code> to stop.   Any ideas?</p>\n\n<pre><code> Sub StopApp()\n    Dim timeout As Date\n    endtime = Sheets(\"MAIN\").Range(\"E4\").value\n    Application.OnTime TimeValue(endtime), Procedure:=\"Button1_Click\", Schedule:=False\n    MsgBox \"App has Stopped\"\n    Sheets(\"MAIN\").Range(\"B1\").value = \"DISCONNECTED\"\n End Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 6409941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a502a9e2300c2bf8493687e022c807b0?s=128&d=identicon&r=PG&f=1", "display_name": "jhalf2008", "link": "https://stackoverflow.com/users/6409941/jhalf2008"}, "edited": false, "score": 0, "creation_date": 1519216360, "post_id": 48905896, "comment_id": 84817659, "body": "You hit the nail on the head. Thank you."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1519215903, "creation_date": 1519215903, "answer_id": 48905896, "question_id": 48905761, "link": "https://stackoverflow.com/questions/48905761/unable-to-resolve-error-3061-too-few-parameters-expected-1/48905896#48905896", "title": "Unable to resolve &quot;Error 3061. Too few parameters. Expected 1&quot;", "body": "<p>The usual suspect, in this case, is the query you're selecting from (CM_qryBOM).</p>\n\n<p>It likely is using form or report values as parameters (or querying off other queries that do). Those aren't available when using <code>CurrentDb.OpenRecordset</code>.</p>\n\n<p>You can manually set them by using a querydef and parameters, or you can construct a query that only queries tables, not other queries, to be safe.</p>\n"}], "owner": {"reputation": 45, "user_id": 6409941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a502a9e2300c2bf8493687e022c807b0?s=128&d=identicon&r=PG&f=1", "display_name": "jhalf2008", "link": "https://stackoverflow.com/users/6409941/jhalf2008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 48905896, "answer_count": 1, "score": 0, "last_activity_date": 1519215903, "creation_date": 1519215491, "question_id": 48905761, "link": "https://stackoverflow.com/questions/48905761/unable-to-resolve-error-3061-too-few-parameters-expected-1", "title": "Unable to resolve &quot;Error 3061. Too few parameters. Expected 1&quot;", "body": "<p>I have these lines in VBA</p>\n\n<pre><code>strTOP = \"SELECT * FROM CM_qryBOM WHERE BOM_Address Like '*\" &amp; Me.Part_No &amp; \"'\"\nSet rsTOP = CurrentDb.OpenRecordset(strTOP, dbOpenSnapshot)\n</code></pre>\n\n<p>Which results in the following SQL statement that I verified in the Immediate window.</p>\n\n<pre><code>SELECT * FROM CM_qryBOM WHERE BOM_Address Like '*601541-19'\n</code></pre>\n\n<p>The query does not execute and throws error code 3061 when running from VBA. However, when I copy and paste the same query into Query Design SQL view it runs just fine.</p>\n\n<p>Never encountered this before and not sure how to fix. Tried bracketing the [table name] and [field name] but that didn't help either.</p>\n"}, {"tags": ["vba", "loops", "range"], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 1, "last_activity_date": 1519215398, "creation_date": 1519215398, "answer_id": 48905726, "question_id": 48905395, "link": "https://stackoverflow.com/questions/48905395/looping-vba-within-selected-range/48905726#48905726", "title": "Looping VBA within selected range", "body": "<p>Here is a quote from the help text on FindNext</p>\n\n<blockquote>\n  <p>When the search reaches the end of the specified search range, it wraps around to the beginning of the range. To stop a search when this wraparound occurs, save the address of the first found cell, and then test each successive found-cell address against this saved address.  </p>\n</blockquote>\n\n<p>I think that applies to your situation</p>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1519215703, "creation_date": 1519215703, "answer_id": 48905836, "question_id": 48905395, "link": "https://stackoverflow.com/questions/48905395/looping-vba-within-selected-range/48905836#48905836", "title": "Looping VBA within selected range", "body": "<p>it's because Find() method keeps on going inside the range\nso you have to stop it when it wraps back to the first found cell by monitoring its address, as follows (along with some other refactoring):</p>\n\n<pre><code>Sub Macro()\n\n    Dim oWs As Worksheet\n    Dim rSearchRng As Range\n    Dim lEndNum As Long\n    Dim vFindVar As Variant\n    Dim loc As Range\n    Dim LastRow As Long\n    Dim LRow As Long\n    Dim Copy As Range\n\n    Set oWs = ActiveWorkbook.Worksheets(\"Sheet1\")\n    LastRow = Sheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Offset(1).Row\n\n    lEndNum = oWs.Range(\"A2\").End(xlDown).Row\n    Set Copy = oWs.Range(\"A2\" &amp; LRow)\n    Set rSearchRng = oWs.Range(\"A2:A\" &amp; CStr(lEndNum))\n\n    Dim locFirstAddress As String\n\n    Set loc = rSearchRng.Cells.Find(Range(\"O2\").value)\n\n    If Not loc Is Nothing Then\n        locFirstAddress = loc.Address\n        Do\n            Range(ActiveCell.Offset(0, 0), ActiveCell.Offset(0, 12)).Copy\n            With Sheets(\"Sheet2\")\n                .Range(\"A\" &amp; .Cells(.Rows.Count, 1).End(xlUp).Offset(1).Row).PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                .Paste\n            End With\n            Application.CutCopyMode = False\n            Set loc = rSearchRng.FindNext(loc)\n        Loop While loc.Address &lt;&gt; locFirstAddress\n    End If\n\n    Set loc = Nothing\n\n\n    MsgBox \"Complete\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9390764, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Aydos", "link": "https://stackoverflow.com/users/9390764/aydos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 48905836, "answer_count": 2, "score": 0, "last_activity_date": 1519390860, "creation_date": 1519214404, "question_id": 48905395, "link": "https://stackoverflow.com/questions/48905395/looping-vba-within-selected-range", "title": "Looping VBA within selected range", "body": "<p>I am unable to stop my VBA from looping within the range that I have specified, could someone please check my code and tell me where I am going wrong with it.</p>\n\n<pre><code>Option Explicit\n\nSub Macro()\n\nDim oWs As Worksheet\nDim rSearchRng As Range\nDim lEndNum As Long\nDim vFindVar As Variant\nDim loc As Range\nDim LastRow As Long\nDim LRow As Long\nDim Copy As Range\n\nSet oWs = ActiveWorkbook.Worksheets(\"Sheet1\")\nLastRow = Sheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Offset(1).Row\n\nlEndNum = oWs.Range(\"A2\").End(xlDown).Row\nSet Copy = oWs.Range(\"A2\" &amp; LRow)\nSet rSearchRng = oWs.Range(\"A2:A\" &amp; CStr(lEndNum))\n\nSet loc = rSearchRng.Cells.Find(Range(\"O2\").Value)\n\nIf Not loc Is Nothing Then\n Do Until loc Is Nothing\n loc.Select\n Range(ActiveCell.Offset(0, 0), ActiveCell.Offset(0, 12)).Select\n Selection.Copy\n Sheets(\"Sheet2\").Select\n LastRow = Sheets(\"Sheet2\").Cells(Rows.Count, 1).End(xlUp).Offset(1).Row\n Range(\"A\" &amp; LastRow).Select\n Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, _\n SkipBlanks:=False, Transpose:=False\n ActiveSheet.Paste\n Sheets(\"Sheet1\").Select\n Application.CutCopyMode = False\n Set loc = rSearchRng.FindNext(loc)\n Loop\nEnd If\n\nSet loc = Nothing\n\n\nMsgBox \"Complete\"\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance</p>\n\n<p>Aydos</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1519214964, "post_id": 48905050, "comment_id": 84816691, "body": "Finally came to me with this version of your question. Try .GetInspector to get the mail <a href=\"https://stackoverflow.com/questions/45661919/outlook-run-script-rule-not-triggering-vba-script-for-incoming-messages\">Outlook \u201cRun Script\u201d rule not triggering VBA script for incoming messages</a>"}, {"owner": {"reputation": 6898, "user_id": 1430420, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/E8oP0.jpg?s=128&g=1", "display_name": "Steve Ives", "link": "https://stackoverflow.com/users/1430420/steve-ives"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1519215982, "post_id": 48905050, "comment_id": 84817422, "body": "@niton Yes - this is a new problem for the solution I am working on, so though it best to start a new question. I&#39;ve added that line to my script so I&#39;ll wait and see what happens. Unfortunately I&#39;d never touched VBA until Monday, so that doesn&#39;t help. I&#39;ll have another question soon as to why my script can&#39;t set the mail item&#39;s category. :-)"}, {"owner": {"reputation": 6898, "user_id": 1430420, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/E8oP0.jpg?s=128&g=1", "display_name": "Steve Ives", "link": "https://stackoverflow.com/users/1430420/steve-ives"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1519293910, "post_id": 48905050, "comment_id": 84855306, "body": "@niton The solution pointed to didn&#39;t work  for me - I&#39;m pretty sure it added a delay, as when I ran the rule containing the script against a whole folder, Outlook died :-), but it&#39;s definitely the folder move that causes the script to not work,  as if I take that out the script runs OK."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1519320708, "post_id": 48905050, "comment_id": 84874236, "body": "There may be an explanation but in the meantime try ItemAdd code for the Incidents folder."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1519474564, "post_id": 48905050, "comment_id": 84931360, "body": "&quot;on this computer only&quot; could be the issue as indicated in a comment here <a href=\"https://stackoverflow.com/questions/22966209/vba-change-outlook-subject-line-on-receipt-of-email\">VBA - Change Outlook Subject Line on Receipt Of Email</a>"}], "owner": {"reputation": 6898, "user_id": 1430420, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/E8oP0.jpg?s=128&g=1", "display_name": "Steve Ives", "link": "https://stackoverflow.com/users/1430420/steve-ives"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3100, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1592723282, "creation_date": 1519213396, "last_edit_date": 1592723282, "question_id": 48905050, "link": "https://stackoverflow.com/questions/48905050/outlook-rules-changing-email-subject-via-script-in-rule-not-working", "title": "Outlook Rules - changing email subject via script in rule not working.", "body": "<p>I've created a rule in Outlook that automatically moves incoming messages to a folder and runs a script to modify the subject. </p>\n\n<p>This is the rule:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8a8pq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8a8pq.png\" alt=\"enter image description here\"></a></p>\n\n<p>and here  is my script:</p>\n\n<pre><code>Public Sub RemoveIrDateTime(Item As Outlook.MailItem)\n'Item As Outlook.MailItem\n\n    'stringToMatch = \"issued at 11/14/17 6:28 PM\"\n\n    Set issuedMsg = New RegExp\n    Set priSev = New RegExp\n    Set iR = New RegExp\n\n    With issuedMsg\n        .Pattern = \"issued at \\d{1,2}/\\d{1,2}/\\d\\d .+\"\n        .Global = True\n        End With\n\n    With priSev\n        '.Pattern = \"^P\\d/S\\d - IR\"\n        .Pattern = \"^.+IR\"\n        .Global = True\n        End With\n\n    Item.Subject = issuedMsg.Replace(Item.Subject, \"\")\n    Item.Subject = priSev.Replace(Item.Subject, \"IR\")\n    'Item.Subject = Left(EmItemail.Subject, 60)\n\n    Item.Save\n\nEnd Sub\n</code></pre>\n\n<p>When a matching message arrives, it gets moved to the designated folder, but the subject does not get updated.</p>\n\n<p>However, if I use the 'Manage rules &amp; Alerts' option, and run my rule against the target folder 'Incidents', then the subject of the emails in the folder gets updated as I expect.</p>\n\n<p>Is there a bug in Outlook such that moving the message prevents the script from running? any ideas on how to resolve?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519229452, "post_id": 48904823, "comment_id": 84827073, "body": "If you only want to check for 404 then using HEAD in place of GET is better.  Have you tried monitoring the problem HTTP call using a tool like Fiddler ?  That should give you some clues."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1519229877, "post_id": 48904823, "comment_id": 84827392, "body": "Check this URL instead: <code>http:&#47;&#47;www.ifz-berlin.de&#47;</code>"}, {"owner": {"reputation": 2868, "user_id": 2582968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BKlgI.png?s=128&g=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/2582968/jan"}, "edited": false, "score": 0, "creation_date": 1519279693, "post_id": 48904823, "comment_id": 84847664, "body": "Thanks Ryan, I need to check for that specific sub-site. So that&#39;s not an option"}, {"owner": {"reputation": 2868, "user_id": 2582968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BKlgI.png?s=128&g=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/2582968/jan"}, "edited": false, "score": 0, "creation_date": 1519283560, "post_id": 48904823, "comment_id": 84849342, "body": "hi Tim, I checked this. it works fine with <a href=\"http://www.ifz-berlin.de/index.html\" rel=\"nofollow noreferrer\">ifz-berlin.de/index.html</a> but <a href=\"http://www.ifz-berlin.de/index.html#/rescue\" rel=\"nofollow noreferrer\">ifz-berlin.de/index.html#/rescue</a> fails on VBA but works fine in any browser.  The issue is that the # is needed but gets converted in VBA to %23. I&#39;m currently searching a method to prevent this"}], "answers": [{"tags": [], "owner": {"reputation": 2868, "user_id": 2582968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BKlgI.png?s=128&g=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/2582968/jan"}, "is_accepted": true, "score": 0, "last_activity_date": 1519284470, "creation_date": 1519284470, "answer_id": 48921765, "question_id": 48904823, "link": "https://stackoverflow.com/questions/48904823/vba-to-check-url-status-fails-on-certain-websites-with-404-even-though-website-e/48921765#48921765", "title": "VBA to check URL Status fails on certain websites with 404 even though website exists", "body": "<p><a href=\"https://stackoverflow.com/questions/308826/msxml2-xmlhttp-send-method-works-with-early-binding-fails-with-late-binding\" title=\"this answer\">This answer</a> provides the necsearry information for my solution. The URL has to be split. The # and everything beyond has to be transferred via send() like so:</p>\n\n<pre><code>Set objXMLHTTP = CreateObject(\"MSXML2.XMLHTTP\")\nobjXMLHTTP.Open \"GET\", \"http://www.ifz-berlin.de/index.html\", False\nobjXMLHTTP.Send (\"#/rescue\")\nStatus = objXMLHTTP.Status\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8424203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/492442f572fa02566c9bbbcb7840d44b?s=128&d=identicon&r=PG&f=1", "display_name": "driller", "link": "https://stackoverflow.com/users/8424203/driller"}, "is_accepted": false, "score": -1, "last_activity_date": 1529682750, "last_edit_date": 1529682750, "creation_date": 1529662460, "answer_id": 50985727, "question_id": 48904823, "link": "https://stackoverflow.com/questions/48904823/vba-to-check-url-status-fails-on-certain-websites-with-404-even-though-website-e/50985727#50985727", "title": "VBA to check URL Status fails on certain websites with 404 even though website exists", "body": "<p>testing website if exists -->answer (404 or else,..)\nthanks to Jan &amp; ....for function above </p>\n\n<p>adapted to test</p>\n\n<pre><code>'------------------------------------------------------------\n'   check if website exits\n'   sub part testet --&gt; ok  22.6.18\n'------------------------------------------------------------\nDim reWebsite, txtTmp As Variant\nSet IE = CreateObject(\"InternetExplorer.Application\")\nreWebsite = CallHTTPRequest(Urls)\nIf reWebsite = 404 Then\n    Debug.Print \" website not existing --&gt; Fehler \"; reWebsite _\n    &amp; vbLf &amp; \" Sheet Name: \"; wsTmp\n    Debug.Print \"sheet --&gt;( \"; ws.name; \" ) NOT updated\"\n    GoTo jump1\nElse\nDebug.Print \"sheet --&gt;( \"; ws.name; \" ) exits\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 2868, "user_id": 2582968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BKlgI.png?s=128&g=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/2582968/jan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 925, "favorite_count": 0, "accepted_answer_id": 48921765, "answer_count": 2, "score": 0, "last_activity_date": 1529682750, "creation_date": 1519212729, "question_id": 48904823, "link": "https://stackoverflow.com/questions/48904823/vba-to-check-url-status-fails-on-certain-websites-with-404-even-though-website-e", "title": "VBA to check URL Status fails on certain websites with 404 even though website exists", "body": "<p>I have an Excel-list of some URLs I want to check regularly, if they still exist. In some cases I get a 404 error eventhough the website exists (but some images on it produce 404 errors. \nMy code is as follows:</p>\n\n<pre><code>Sub Schaltfl\u00e4che1_Klicken()\n    Set sh = ThisWorkbook.Sheets(\"Tabelle1\")\n    Dim column_number: column_number = 2\n\n    sh.Range(\"C2:D1000\").Clear\n\n    i = 2\n    'Row starts from 2\n    Do Until sh.Cells(i, column_number).Value = \"\"\n        strURL = sh.Cells(i, column_number)\n        sh.Cells(i, column_number + 1) = CallHTTPRequest(strURL)\n        i = i + 1\n    Loop\n\nEnd Sub\n\n\nFunction CallHTTPRequest(strURL)\n    Set objXMLHTTP = CreateObject(\"MSXML2.XMLHTTP\")\n    objXMLHTTP.Open \"GET\", strURL, False\n    objXMLHTTP.Send\n    Status = objXMLHTTP.Status\n\n    Set objXMLHTTP = Nothing\n    CallHTTPRequest = Status\nEnd Function\n</code></pre>\n\n<p>The problematic URL is <a href=\"http://www.ifz-berlin.de/#/rescue\" rel=\"nofollow noreferrer\">http://www.ifz-berlin.de/#/rescue</a></p>\n\n<p>Any help is appreciated on how I could solve this issue.</p>\n"}, {"tags": ["vba", "excel", "sharepoint"], "comments": [{"owner": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 0, "creation_date": 1519220773, "post_id": 48904640, "comment_id": 84820799, "body": "Have you defined the name anywhere else in the code, it is possible that you are missing that part."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519229545, "post_id": 48904640, "comment_id": 84827130, "body": "There should be a WebDAV path which may support use of <code>Dir</code>: you can&#39;t use a HTTP path for that."}, {"owner": {"reputation": 103, "user_id": 8752009, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/00ad86e9cced999b851bd5b300bc197b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Hill", "link": "https://stackoverflow.com/users/8752009/mike-hill"}, "edited": false, "score": 0, "creation_date": 1519311606, "post_id": 48904640, "comment_id": 84867727, "body": "Hi Thom, I have defined Name earlier in the code"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 8752009, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/00ad86e9cced999b851bd5b300bc197b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Hill", "link": "https://stackoverflow.com/users/8752009/mike-hill"}, "edited": false, "score": 0, "creation_date": 1519311190, "post_id": 48911995, "comment_id": 84867378, "body": "Hi All, the issue isn&#39;t actually to get the Dir() to work, because I already have the code working in a different spreadsheet, and have basically copied over to another spreadsheet and it doesn&#39;t work. Unless I use the saveas before the code, is there anything else you would need to do to get the Dir() to work?"}, {"owner": {"reputation": 103, "user_id": 8752009, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/00ad86e9cced999b851bd5b300bc197b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Hill", "link": "https://stackoverflow.com/users/8752009/mike-hill"}, "edited": false, "score": 0, "creation_date": 1519311575, "post_id": 48911995, "comment_id": 84867698, "body": "I have edited my question to hopefully make more sense"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1519234011, "creation_date": 1519234011, "answer_id": 48911995, "question_id": 48904640, "link": "https://stackoverflow.com/questions/48904640/why-i-can-connect-to-a-sharepoint-site-with-vba-from-one-spreadsheet-but-not-ano/48911995#48911995", "title": "Why i can connect to a sharepoint site with vba from one spreadsheet but not another", "body": "<p>If your URL is \"<a href=\"https://teamspace.healthcare.siemens.com/content/90002613/Documents/\" rel=\"nofollow noreferrer\">https://teamspace.healthcare.siemens.com/content/90002613/Documents/</a>\" then you should be able to use Dir() as shown below:</p>\n\n<pre><code>Sub TestWebDAVDir()\n\n    Const MY_PATH As String = \"\\\\teamspace.healthcare.siemens.com\\content\\90002613\\Documents\\\"\n\n    Dim f\n    f = Dir(MY_PATH &amp; \"*\")\n    Do While Len(f) &gt; 0\n        Debug.Print f\n        f = Dir()\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 8752009, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/00ad86e9cced999b851bd5b300bc197b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Hill", "link": "https://stackoverflow.com/users/8752009/mike-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519311389, "creation_date": 1519212229, "last_edit_date": 1519311389, "question_id": 48904640, "link": "https://stackoverflow.com/questions/48904640/why-i-can-connect-to-a-sharepoint-site-with-vba-from-one-spreadsheet-but-not-ano", "title": "Why i can connect to a sharepoint site with vba from one spreadsheet but not another", "body": "<p>I have an odd issue where I can connect and upload files to a sharepoint site using a vba script, however using practically the same vba script from another spreadsheet and uploading to the same sharepoint site I can't connect and upload files.</p>\n\n<p>The weird thing with the vba script that doesn't work is that if I add the below code to it before the rest of the script, the rest of the script works.</p>\n\n<pre><code> xPath= \"https://teamspace.healthcare.siemens.com/content/90002613/Documents/\"\n With ActiveWorkbook\n\n    Application.ActiveWorkbook.SaveAs Filename:=xPath &amp; Name &amp; \".xlsm\"\n    Application.ActiveWorkbook.Close False\n\n End With\n</code></pre>\n\n<p>No idea why but xPath is a valid file path when using the SaveAs command, but when I use the same path or variant of it with the \"Dir\" tag it doesn't work and either give me a error code \"Runtime 52 Bad File name or number\" or \"Runtime 76 path not found\". Please can someone help with this, I have been trying everything I can think of for about the last 2 days</p>\n\n<p>Thanks</p>\n\n<p>Edit :</p>\n\n<p>this is the code that works in one of the spreadsheets</p>\n\n<pre><code>If Dir(\"//teamspace.healthcare.siemens.com/content/90002613/Documents/GB_Invivo_RSM/\" &amp; xWs.Name &amp; \"\", vbDirectory) = \"\" Then\n\n            MkDir (\"//teamspace.healthcare.siemens.com/content/90002613/Documents/GB_Invivo_RSM/\" &amp; xWs.Name &amp; \"\")\n\n            Else\n\n            End If\n\n  With ActiveWorkbook\n\nApplication.ActiveWorkbook.SaveAs Filename:=xPath &amp; \"\\GB_RSM_P\" &amp; Format(LDate, \"mm\") &amp; \"FY\" &amp; Format(LDate, \"yyyy\") &amp; \" \" &amp; xWs.Name &amp; \".xlsx\"\n           End With\n</code></pre>\n\n<p>The code in the 2nd spreadsheet wont work unless I put another SaveAs() before all of this, and save a dummy spreadsheet, then have to delete it after, because obviously I don't want it there. I can't understand why the same code would work from one spreadsheet and not another, and also its almost like the saveAs() is creating a connection or something, but this wasn't needed in the 1st spreadsheet</p>\n"}, {"tags": ["excel", "pivot", "vba"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519213743, "post_id": 48905071, "comment_id": 84815854, "body": "The due dates are from multiple years, but it is a 12 month rolling count. I have some VBA code that adds a date filter for time between now and a year ago if that makes sense?  I have just tried your code, and I am still getting error 1004, &#39;unable to set visible property of the PivotItem class. When I press debug it highlights &#39;Pi.visible = true&#39;"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "reply_to_user": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519214543, "post_id": 48905071, "comment_id": 84816388, "body": "Then I cannot help since it works for me. But as often with pivot table questions there are much other things which can be wrong and without having the source data and all of the used VBA, helping is nearly impossible then."}, {"owner": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519214711, "post_id": 48905071, "comment_id": 84816505, "body": "Ok, thats fair enough thanks for trying. I will try to see what is causing this issue then as it might be able to point me in the right direction."}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": false, "score": 1, "last_activity_date": 1519217827, "last_edit_date": 1519217827, "creation_date": 1519213474, "answer_id": 48905071, "question_id": 48903804, "link": "https://stackoverflow.com/questions/48903804/how-can-i-filter-pivot-table-position-in-vba/48905071#48905071", "title": "How can I filter pivot table position in VBA?", "body": "<p>Are the due dates from multiple years? If so, your pivoting is wrong since you are showing only the months and Feb in year 1 will be added to Feb in year 2 and Feb in year 3 ...</p>\n\n<p>But nevertheless, in a date column of a pivot table are blanks lower than the minimal given date = blank = 0 = 1900-01-00. And then there is an item greater than the maximal given date. Both the dates are variable. But the following should work:</p>\n\n<pre><code>Set pt = ActiveSheet.PivotTables(\"PivotTable1\")\nSet pf = pt.PivotFields(\"Due Date\")\n\nFor Each pit In pf.PivotItems\n pit.Visible = True\n If Left(pit.Name, 1) = \"&lt;\" Then 'lower than the minimal given date = blank = 0 = 1900-01-00\n  pit.Visible = False '\n End If\n If Left(pit.Name, 1) = \"&gt;\" Then 'greater than the maximal given date\n  pit.Visible = False '\n End If\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519214044, "post_id": 48905120, "comment_id": 84816042, "body": "I&#39;m 99% sure. I have a piece of code that sorts everything into order, which puts these two at the bottom. If I replace what is in my for loop with your code, I get the error 1004, unable to set visible propert of the pivotitem class. When I debug, it highlights the first line of your code"}, {"owner": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "reply_to_user": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519216894, "post_id": 48905120, "comment_id": 84818022, "body": "I see it creates the same issue for both my answer and answer of Axel Richter. When you debug you should be able to identify what is the Pi that caused the error in the Locals window. Could you see what position or name that is?"}, {"owner": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519217119, "post_id": 48905120, "comment_id": 84818172, "body": "The name of it is showing as &quot;&lt;01/10/2015&quot; and it&#39;s showing its position as -2146826246. It has a source name that is error 2042"}, {"owner": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "reply_to_user": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519217298, "post_id": 48905120, "comment_id": 84818294, "body": "ok, that position means it is hidden. I am only wondering how it got to that &quot;&lt;01/10/2015&quot; because you dont even have it in the printscreen. Is it removed using another filter? I mean when you filter the vendor does this item disappear?"}, {"owner": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "reply_to_user": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519217794, "post_id": 48905120, "comment_id": 84818638, "body": "Do you have another pivot table just below the pivot table you are using in this macro? Because if I try to show so many lines so it would overlap pivot table that is just below this one it shows Error 1004 Unable to set the visible property of the PivotItem class. So exactly what it shows to you."}, {"owner": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519217983, "post_id": 48905120, "comment_id": 84818775, "body": "I don&#39;t have another pivot table, but something I didn&#39;t mention which never occurred to me is that these dates are grouped. So if I ungroup there shows a record for everyday in the last 3 years. So I group the data by month, then filter for just the dates I need. Could this be the issue?  Another thing I have noticed in the locals windows is the sourcenamestandard is &quot;&lt;10/1/2015&quot;, but it shows the value as &quot;&lt;01/10/2015&quot; Could this also be an issue?"}, {"owner": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "reply_to_user": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519218742, "post_id": 48905120, "comment_id": 84819295, "body": "I dont think either of those are issue. I created it in the way you describe it and tried macro from answer of Axel Richter and it works fine for me just like it worked for him."}, {"owner": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519218955, "post_id": 48905120, "comment_id": 84819452, "body": "I know this would seem irrelevant but are you by any chance in the US? Something I&#39;ve just been reading about error 2042 shows an issue with the UK locale on dates? If this is the case I am a step closer to solving my issue"}, {"owner": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "reply_to_user": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519219200, "post_id": 48905120, "comment_id": 84819600, "body": "nope. I am from Czech Republic. My Excel is set to english, but my date format has Czech Locale = &quot;14.3.2012&quot;"}, {"owner": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "reply_to_user": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519219716, "post_id": 48905120, "comment_id": 84820000, "body": "try this thing - write there an IF stantement to skip the &quot;&lt;10/1/2015&quot; to see if it will crash when it tries to show another one or it finishes without error. If it crashes on next show that I would bet there is some conflict on the sheet... something else than another pivot"}, {"owner": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519220168, "post_id": 48905120, "comment_id": 84820364, "body": "I added &quot;if not pit = &quot;&lt;10/1/2015&quot; then do alex&#39;s code&quot; which errored on a different date, which is the &gt;15/05/2018 date"}, {"owner": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "reply_to_user": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519220231, "post_id": 48905120, "comment_id": 84820409, "body": "but that one was visible was it not?"}, {"owner": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519220336, "post_id": 48905120, "comment_id": 84820494, "body": "Yes, on the table that is the one at the bottom along with (blank). It&#39;s position for this one is position 0"}, {"owner": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519221156, "post_id": 48905120, "comment_id": 84821035, "body": "I have also tried running your code again with the first pi.visible = true line taken out and I get a RTE 13 type mismatch"}, {"owner": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "reply_to_user": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519222705, "post_id": 48905120, "comment_id": 84822090, "body": "so whatever I try I am unable to get the same error as you have (1004). In this case I guess it probably really is some version-language/format problem..."}, {"owner": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "edited": false, "score": 0, "creation_date": 1519226881, "post_id": 48905120, "comment_id": 84825217, "body": "I&#39;ve just been on a skype call with a colleague from across the pond, the file works fine on his computer, it comes up with the error over here. We have come up with a way around it that is not a fix, but we have no idea how to solve the actual issue at hand. Thanks for all the help, sorry we never got anywhere"}], "tags": [], "owner": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "is_accepted": false, "score": 0, "last_activity_date": 1519213617, "creation_date": 1519213617, "answer_id": 48905120, "question_id": 48903804, "link": "https://stackoverflow.com/questions/48903804/how-can-i-filter-pivot-table-position-in-vba/48905120#48905120", "title": "How can I filter pivot table position in VBA?", "body": "<p>If you are absolutely sure that it will always be lines 13&amp;14 did you try something like this?</p>\n\n<pre><code>Pi.Visible = True\nIf Pi.Position &gt; 12 Then\n Pi.Visible = False\nEnd If\n</code></pre>\n\n<p>inside your for loop.</p>\n"}], "owner": {"reputation": 41, "user_id": 9390235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02cdde7232e1bd65c54d855a97b52329?s=128&d=identicon&r=PG&f=1", "display_name": "Kippa2005", "link": "https://stackoverflow.com/users/9390235/kippa2005"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519217827, "creation_date": 1519209553, "last_edit_date": 1531161705, "question_id": 48903804, "link": "https://stackoverflow.com/questions/48903804/how-can-i-filter-pivot-table-position-in-vba", "title": "How can I filter pivot table position in VBA?", "body": "<p>I've tried finding an answer to this on this site and I'm having no luck so hopefully someone can help me. I can't provide an example sheet as the data is private, but I will attach a screen shot.</p>\n\n<p><a href=\"https://i.stack.imgur.com/EEnc0.png\" rel=\"nofollow noreferrer\">This is the graph and pivot table</a></p>\n\n<p>I am wanting to try and remove the bottom two lines (Blank and the >15/5/18). The 15/5/18 date changes daily, so I can't reference it by name, and if I try to hide the one called blank, I get a 1004 error.</p>\n\n<pre><code>Sub removeblanks()\nDim pt As PivotTable\nDim pf As PivotField\nDim pi As PivotItem\n\nApplication.ScreenUpdating = False\n\nSet pt = ActiveSheet.PivotTables(\"PivotTable1\")\nSet pf = pt.PivotFields(\"Due Date\")\n\nFor Each pi In pf.PivotItems\n    pi.Visible = False 'Hide each by default, then show only the ones we want\n    If pi.Value = \"Jan\" Then pi.Visible = True\n    If pi.Value = \"Feb\" Then pi.Visible = True\n    If pi.Value = \"Mar\" Then pi.Visible = True\n    If pi.Value = \"Apr\" Then pi.Visible = True\n    If pi.Value = \"May\" Then pi.Visible = True\n    If pi.Value = \"Jun\" Then pi.Visible = True\n    If pi.Value = \"Jul\" Then pi.Visible = True\n    If pi.Value = \"Aug\" Then pi.Visible = True\n    If pi.Value = \"Sep\" Then pi.Visible = True\n    If pi.Value = \"Oct\" Then pi.Visible = True\n    If pi.Value = \"Nov\" Then pi.Visible = True\n    If pi.Value = \"Dec\" Then pi.Visible = True\nNext\n\nApplication.ScreenUpdating = True   end sub\n</code></pre>\n\n<p>I tried other ways but none of them worked, and this was giving me the most success as I could hide or show the month fields, but once I try to hide the others, it errors.</p>\n\n<p>In my picture I have 0 values, and in my data I have months with no data. These need to appear in this chart which is why it shows zero values, so I can't hide lines with no data. </p>\n\n<p>There is a sort going on on VBA which puts everything in order, so the two lines I want gone will always be lines 13 &amp; 14.</p>\n\n<p>Any help is greatly appreciated, thanks</p>\n"}, {"tags": ["vba", "excel", "label", "userform"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1519209134, "post_id": 48903336, "comment_id": 84812623, "body": "I&#39;m just curious about this comment...<code>ColNum = 72 &#39;letter H</code> ??"}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1519209234, "post_id": 48903336, "comment_id": 84812699, "body": "<code>MSWorkbook.Close False</code> - Is the userform in that workbook? if so change false to true."}, {"owner": {"reputation": 64, "user_id": 7523912, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b105ab057505dc74f823ada41d276af?s=128&d=identicon&r=PG&f=1", "display_name": "KawaRu", "link": "https://stackoverflow.com/users/7523912/kawaru"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 2, "creation_date": 1519209477, "post_id": 48903336, "comment_id": 84812858, "body": "@CallumDA 72 is the ASCII value of the letter H."}, {"owner": {"reputation": 64, "user_id": 7523912, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b105ab057505dc74f823ada41d276af?s=128&d=identicon&r=PG&f=1", "display_name": "KawaRu", "link": "https://stackoverflow.com/users/7523912/kawaru"}, "reply_to_user": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1519209505, "post_id": 48903336, "comment_id": 84812886, "body": "@Zerk No it isn&#39;t. But in fact since I use a userform it doesn&#39;t want to close the other workbook anymore."}, {"owner": {"reputation": 64, "user_id": 7523912, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b105ab057505dc74f823ada41d276af?s=128&d=identicon&r=PG&f=1", "display_name": "KawaRu", "link": "https://stackoverflow.com/users/7523912/kawaru"}, "edited": false, "score": 0, "creation_date": 1519210530, "post_id": 48903336, "comment_id": 84813672, "body": "I think I have found the answer to my own question.  If I only let update one label it works, so I do believe that it&#39;s maybe just because excel can&#39;t handle it that he doesn&#39;t do it as he should."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1519224465, "post_id": 48903336, "comment_id": 84823473, "body": "DoEvents  between updates to give excel a chance to redraw might work?"}, {"owner": {"reputation": 64, "user_id": 7523912, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b105ab057505dc74f823ada41d276af?s=128&d=identicon&r=PG&f=1", "display_name": "KawaRu", "link": "https://stackoverflow.com/users/7523912/kawaru"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1519293261, "post_id": 48903336, "comment_id": 84854889, "body": "What do you mean @harassed dad"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1519914562, "post_id": 48903336, "comment_id": 85108128, "body": "put the command    DoEvents   after the line ParetoPerCategorie.lblAantal.Caption = &quot;categorie ..."}], "owner": {"reputation": 64, "user_id": 7523912, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b105ab057505dc74f823ada41d276af?s=128&d=identicon&r=PG&f=1", "display_name": "KawaRu", "link": "https://stackoverflow.com/users/7523912/kawaru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519208233, "creation_date": 1519208233, "last_edit_date": 1531164843, "question_id": 48903336, "link": "https://stackoverflow.com/questions/48903336/labels-not-updating", "title": "Labels not updating", "body": "<p>I'm trying to update a label while a code executes. Now this works in two other userforms with exact the same code (to update) but in this one he doesn't want to update the info. </p>\n\n<p>The strange thing is, when I execute the code line by line it will update it though. So the name of the labels etc are not wrong. </p>\n\n<p>This is my code:</p>\n\n<pre><code>        Dim MSWorkbook As Workbook, MSSheet As Worksheet, GMSheet As Worksheet, i As Integer, LastRow As Integer, LastRowGM As Integer\n        Dim aantal As Integer, ColNum As Integer\n\n        'variabelen toewijzen\n        Set GMSheet = ThisWorkbook.ActiveSheet\n        Set MSWorkbook = Workbooks.Open(\"....\")\n        Set MSSheet = MSWorkbook.ActiveSheet\n        GMSheet.Activate\n        ColNum = 72 'letter H\n\n        'progress bar opmaken\n        ParetoPerCategorie.PGB.Max = 11\n        ParetoPerCategorie.PGB.Min = 0\n        ParetoPerCategorie.PGB.Value = 1\n        ParetoPerCategorie.lblInfo.Caption = \"Voorbereidend werk\"\n\n        LastRow = MSSheet.Range(\"G5\").End(xlDown).Row\n        LastRowGM = GMSheet.Range(\"A3\").End(xlDown).Row\n\n        'Data ophalen (per categorie alle 40 getallen optellen en plaatsen in de juiste cel.\n        For j = 3 To LastRowGM\n            aantal = 0\n            ParetoPerCategorie.lblInfo.Caption = \"Bezig met categorie \" &amp; GMSheet.Range(\"A\" &amp; j).Value\n            ParetoPerCategorie.lblAantal.Caption = \"categorie \" &amp; j - 2 &amp; \" van de \" &amp; LastRowGM - 2\n            ParetoPerCategorie.PGB.Value = j - 1\n            Application.Wait (Now + TimeValue(\"00:00:01\"))\n\n                For i = LastRow - 40 To LastRow\n                    aantal = aantal + MSSheet.Cells(i, Chr(ColNum)).Value\n                Next i\n            GMSheet.Range(\"B\" &amp; j).Value = aantal\n            ColNum = ColNum + 1\n        Next j\n\n        MSWorkbook.Close False\n        Unload Me\n</code></pre>\n\n<p>I have no idea why it doesn't do it when I just run it. Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 9288118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1861c173a08a832453b762deaeda399?s=128&d=identicon&r=PG&f=1", "display_name": "yassine zagliz", "link": "https://stackoverflow.com/users/9288118/yassine-zagliz"}, "edited": false, "score": 0, "creation_date": 1519208178, "post_id": 48903212, "comment_id": 84811904, "body": "I tried the code that you posted but it doesn&#39;t work"}, {"owner": {"reputation": 41, "user_id": 9288118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1861c173a08a832453b762deaeda399?s=128&d=identicon&r=PG&f=1", "display_name": "yassine zagliz", "link": "https://stackoverflow.com/users/9288118/yassine-zagliz"}, "edited": false, "score": 0, "creation_date": 1519208426, "post_id": 48903212, "comment_id": 84812101, "body": "The code have to take for example the dara (1,B) and l look for it in the column &quot;E&quot; and not just to compare (1,B) and (1,F)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1519208424, "last_edit_date": 1519208424, "creation_date": 1519207856, "answer_id": 48903212, "question_id": 48903140, "link": "https://stackoverflow.com/questions/48903140/how-to-comare-two-columns-using-vba-excel/48903212#48903212", "title": "How to comare two columns using VBA EXCEL", "body": "<p>Just guessing that you want to compare each cell with each cell, thus you need a nested loop like this one:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim ws1         As Worksheet\n    Dim LastRow     As Long\n    Dim LastRowE    As Long\n    Dim i           As Long\n    Dim ii          As Long\n\n    Set ws1 = Worksheets(1)\n    With ws1\n        LastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n        LastRowE = .Cells(.Rows.Count, \"E\").End(xlUp).Row\n    End With\n\n    For i = 1 To LastRow\n        Dim codeFound As Boolean\n        codeFound = False\n        For ii = 1 To LastRowE\n            If ws1.Cells(i, 2) = ws1.Cells(ii, 5) Then codeFound = True\n        Next ii\n\n        If codeFound Then\n            ws1.Cells(i, 6) = \"OK\"\n        Else\n            ws1.Cells(i, 6) = \"FALSE\"\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1519208399, "creation_date": 1519208399, "answer_id": 48903393, "question_id": 48903140, "link": "https://stackoverflow.com/questions/48903140/how-to-comare-two-columns-using-vba-excel/48903393#48903393", "title": "How to comare two columns using VBA EXCEL", "body": "<p>No need for a loop or even VBA for that matter.</p>\n\n<pre><code>Sub ComparerCP()\n    Dim LastRow As Long\n    with Worksheets(\"Feuil1\")\n        LastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row  'thanks Vityata!\n        with .range(\"F1:F\" &amp; lastrow)\n            .formula = \"=if(isnumber(match(B1, E:E, 0)), \"\"Ok\"\")\"\n            'optionally convert formulas to values\n            '.value = .value\n        end with\n    end with\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1519208814, "last_edit_date": 1519208814, "creation_date": 1519208410, "answer_id": 48903399, "question_id": 48903140, "link": "https://stackoverflow.com/questions/48903140/how-to-comare-two-columns-using-vba-excel/48903399#48903399", "title": "How to comare two columns using VBA EXCEL", "body": "<p>You can try this two ways. First VBA:</p>\n\n<pre><code>Public Sub ComparerCP()\n    Dim rng As Range\n    Dim arr As Variant\n    Dim c\n\n    ' Update to your sheet name\n    With ActiveSheet\n        ' Set the range that we want to check\n        Set rng = .Range(.Cells(1, 2), .Cells(.Cells(.Rows.Count, 2).End(xlUp).Row, 2))\n        ' This array contains the range to check against\n        ' We transpose the array to get a 1D array from the range\n        arr = Application.Transpose(.Range(.Cells(1, 5), .Cells(.Cells(.Rows.Count, 5).End(xlUp).Row, 5)))\n\n        ' Loop through check range and test if each value is in the range to check against\n        For Each c In rng\n            If IsInArray(c.Value2, arr) Then\n                c.Offset(0, 1).Value2 = \"Ok\"\n            End If\n        Next c\n    End With\nEnd Sub\n\n\nPublic Function IsInArray(v As Variant, FilterArray As Variant) As Boolean\n    IsInArray = (UBound(Filter(FilterArray, v)) &gt; -1)\nEnd Function\n</code></pre>\n\n<p>Second, you could just use Excel Formulas. In Column <code>C</code> I've entered:</p>\n\n<pre><code>=IF(COUNT(MATCH(B1,$E:$E,0)),\"Ok\",\"\")\n</code></pre>\n\n<p>Which outputs the same thing</p>\n"}], "owner": {"reputation": 41, "user_id": 9288118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1861c173a08a832453b762deaeda399?s=128&d=identicon&r=PG&f=1", "display_name": "yassine zagliz", "link": "https://stackoverflow.com/users/9288118/yassine-zagliz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 48903399, "answer_count": 3, "score": 1, "last_activity_date": 1519208814, "creation_date": 1519207667, "question_id": 48903140, "link": "https://stackoverflow.com/questions/48903140/how-to-comare-two-columns-using-vba-excel", "title": "How to comare two columns using VBA EXCEL", "body": "<p>I need a macro VBA that will takes a code in columns \"B\" and look for it in column \"E\" row by row until the end and if it exist => Ok in column \"F\" else \"FALSE\"\nThere are so many code in columns B and E.</p>\n\n<p>I tried this code but it doesn't works</p>\n\n<pre><code>Sub ComparerCP()\nDim ws1 As Worksheet: Set ws1 = Worksheets(\"Feuil1\")\nDim LastRow As Long\nLastRow = ws1.Cells(ws1.Rows.Count, \"A\").End(xlUp).Row\nFor i = 1 To LastRow\n    If ws1.Cells(i, 2) = ws1.Cells(i, 5) Then \n        ws1.Cells(i, 6) = \"OK\"\n        Else: ws1.Cells(i, 6) = \"FALSE\"\n      End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 1, "creation_date": 1519206841, "post_id": 48902698, "comment_id": 84810878, "body": "Looks like you have too many AND() logicals: <code>=IF(AND(COUNTIF(A:A;A2)&gt;1; AND(C2=&quot;&quot;;D2=&quot;&quot;)); &quot;Yes&quot;; &quot;No&quot;)</code> Further, if it&#39;s Excel 2007 or later you can just list all the operands in a single AND(): <code>=IF(AND(COUNTIF(A:A;A2)&gt;1; C2=&quot;&quot;; D2=&quot;&quot;); &quot;Yes&quot;; &quot;No&quot;)</code>. Otherwise nest the if statements, it&#39;s just a little harder to read: <code>=IF(COUNTIF(A:A;A2)&gt;1; IF(AND(C2=&quot;&quot;;D2=&quot;&quot;); &quot;Yes&quot;; &quot;No&quot;); &quot;No&quot;)</code>"}, {"owner": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1519206961, "post_id": 48902698, "comment_id": 84810988, "body": "OK. But i need the 2nd conditions to be satisfied in the formula. Do u have idea"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 1, "creation_date": 1519207159, "post_id": 48902698, "comment_id": 84811144, "body": "might be able to help in my lunch break if it doesn&#39;t get picked up by someone before hand, won&#39;t have time to write up the formula / explanation now unfortunately... Usually a fast turn around in here so I doubt it&#39;ll still be open by lunch break."}, {"owner": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1519207260, "post_id": 48902698, "comment_id": 84811232, "body": "Okay. Thank you"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519210369, "post_id": 48902698, "comment_id": 84813530, "body": "Why have you included a VBA tag?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1519212998, "post_id": 48902698, "comment_id": 84815320, "body": "Do you mean &quot;Previous&quot; (E5 looks at rows 1-5) or &quot;Other&quot; (look at entire columns)?  If &quot;Previous&quot; then E4 and E5 are correct.  Also, the rules as you wrote them should mean that E<b>2</b> is &quot;Yes&quot;, not &quot;No&quot; because C2 and D2 are empty.   Finally, try using <code>COUNTIFS</code> to check 2 conditions at once"}], "answers": [{"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 1, "last_activity_date": 1519213635, "creation_date": 1519213635, "answer_id": 48905124, "question_id": 48902698, "link": "https://stackoverflow.com/questions/48902698/how-to-use-nested-and-to-check-two-rows-values-in-excel/48905124#48905124", "title": "How to use nested AND to check two rows values in Excel", "body": "<p><strong>N.B. The formula and screenshot posted do not match rule 2 as stated.</strong>  If you are looking for a value <em>anywhere</em> in Columns C or D instead of just previous rows, then change any Ranges (<code>A1:$An</code> to <code>A:A</code>)</p>\n\n<hr>\n\n<p>Using <code>COUNTIFS</code> will let you check multiple conditions as an <code>AND</code>.  (i.e. <code>COUNTIFS(A:A,1001,B:B,\"C\")</code> will count rows with Code 1001 <code>AND</code> Type \"B\")</p>\n\n<p>You appear to want to check the current row and previous rows, so rather than <code>A:A</code> we will look in the range <code>A$1:An</code>, where <em>n</em> is the current row.  If <em>n</em>=2 (cell <code>E2</code>) then you want <code>A$1:A2</code></p>\n\n<p>This means we have 2 things to look for:</p>\n\n<p>1) Rows where A$1:A<em>n</em> matches A<em>n</em> <code>AND</code> C$1:C<em>n</em> matches C<em>n</em></p>\n\n<p><code>OR</code></p>\n\n<p>2) Rows where A$1:A<em>n</em> matches A<em>n</em> <code>AND</code> D$1:D<em>n</em> matches D<em>n</em></p>\n\n<p>We can write these as a pair of <code>COUNTIFS</code>s and add them together - this will mean that the row is counted twice if you have a number in both \"Value 1\" and \"Value 2\", but we don't care about the actual value (only if it is >0 or not)</p>\n\n<p>(Formula is for cell E2)</p>\n\n<p><code>COUNTIFS(A$1:A2,A2,C$1:C2,\"&lt;&gt;\")+COUNTIFS(A$1:A2,A2,D$1:D2,\"&lt;&gt;\")</code></p>\n\n<p>So, if this is >0 then there is a row from 1 to <em>n</em> (currently 2) where Code = A<em>n</em> <code>AND</code> (Value 1 not blank <code>OR</code> Value 2 not blank)</p>\n\n<p><code>=IF((COUNTIFS(A$1:A2,A2,C$1:C2,\"&lt;&gt;\")+COUNTIFS(A$1:A2,A2,D$1:D2,\"&lt;&gt;\"))&gt;0,\"No\",\"Yes\")</code></p>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1519213688, "creation_date": 1519213688, "answer_id": 48905140, "question_id": 48902698, "link": "https://stackoverflow.com/questions/48902698/how-to-use-nested-and-to-check-two-rows-values-in-excel/48905140#48905140", "title": "How to use nested AND to check two rows values in Excel", "body": "<p>Try this formula:</p>\n\n<pre><code>=IF(AND(COUNTIF(A:A,A2) &gt; 1,D2=\"\",C2=\"\",OR(D1&lt;&gt;\"\",C1&lt;&gt;\"\")),\"NO\",IF(OR(C2&lt;&gt;\"\",D2&lt;&gt;\"\"),\"NO\",\"YES\"))\n</code></pre>\n\n<p>It will return different result from the one you posted, as it's wrong. Also, review your logic, because you are thinking about it in wrong order, if you know what I mean :) Conditions should be checked in different order than you stated :) and <code>OR</code> operators should also be used.</p>\n\n<p>Also, formula references to previous row, in first row you have none, so you should determine Expiry value by yourself.</p>\n"}], "owner": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1519306380, "creation_date": 1519206383, "last_edit_date": 1531161705, "question_id": 48902698, "link": "https://stackoverflow.com/questions/48902698/how-to-use-nested-and-to-check-two-rows-values-in-excel", "title": "How to use nested AND to check two rows values in Excel", "body": "<p>I have a table. I need to check whether the values will expire or not. </p>\n\n<p>My conditions are </p>\n\n<ul>\n<li>If the number is repeating or not repeating in column A and contains value in Column C OR D. Then the expiry is NO.</li>\n<li><strong>If the number is repeating in column A and does not contains value in\nColumn C OR D but contains value in all other Column C OR D. Then the expiry is NO.</strong></li>\n<li>If the number is repeating or not repeating in column A and does not contains value in Column C OR D. Then the expiry is Yes.</li>\n</ul>\n\n<p>For eg: In my image, In column A 1001 is repeating (A4 &amp; A5), but C4:D4 have no values and C5:D5 have values. So i need E4 and E5 values as NO</p>\n\n<p>I used the formula below but it is not working. How can i change the formula. Help me</p>\n\n<p><code>=IF(AND(AND(COUNTIF(A:A;A2)&gt;1); AND(C2=\"\";D2=\"\")); \"Yes\"; \"No\")</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/xkWlM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xkWlM.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1519206260, "post_id": 48902444, "comment_id": 84810433, "body": "Could you use <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/391dd00a-61a7-4d28-8fd1-88a0047513b7/use-filesystemwatcher-in-access?forum=vsto\" rel=\"nofollow noreferrer\">FileWatcher</a>? And as idea: the large csv file could be splittted to smaller ones e.g. each 1000 lines goes to separate file. Then the original file will be closed and the processing starts with each of the small files."}], "answers": [{"comments": [{"owner": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "edited": false, "score": 2, "creation_date": 1519206441, "post_id": 48902676, "comment_id": 84810557, "body": "Sorry forgot to mention, the file contains unicode chars also."}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "edited": false, "score": 0, "creation_date": 1519206686, "post_id": 48902676, "comment_id": 84810748, "body": "Ok, so for handling unicode characters you can refer to <a href=\"https://stackoverflow.com/questions/5290182/how-many-bytes-does-one-unicode-character-take\">this SO post</a>."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1519206310, "creation_date": 1519206310, "answer_id": 48902676, "question_id": 48902444, "link": "https://stackoverflow.com/questions/48902444/calculate-the-file-size-vba-macro/48902676#48902676", "title": "Calculate the file size - VBA macro", "body": "<p>One character = 1 byte. So when user modifies CSV you can track chnges in the following manner:</p>\n\n<p>On cell-value-changed event you add amount of characters in cell + 1 (for comma or any other separator) as amount of bytes to size of file at the beginning. This way you control the size during modifying file.</p>\n\n<p>Keep in mind, if cell already had \"something\" in it, you have to subtract this value (amount of characters/bytes), as it will be overwritten.</p>\n"}, {"comments": [{"owner": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "edited": false, "score": 0, "creation_date": 1519229128, "post_id": 48906087, "comment_id": 84826869, "body": "FileLen return size in bytes, and 1000 means, 1KB not MB"}], "tags": [], "owner": {"reputation": 41, "user_id": 6234417, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6ZspY06pf-s/AAAAAAAAAAI/AAAAAAAAAFU/rkgsK4rFht8/photo.jpg?sz=128", "display_name": "Vinayaka V", "link": "https://stackoverflow.com/users/6234417/vinayaka-v"}, "is_accepted": false, "score": 1, "last_activity_date": 1519233951, "last_edit_date": 1519233951, "creation_date": 1519216513, "answer_id": 48906087, "question_id": 48902444, "link": "https://stackoverflow.com/questions/48902444/calculate-the-file-size-vba-macro/48906087#48906087", "title": "Calculate the file size - VBA macro", "body": "<p>The below code might help you, in the below code i have used 1 MB as reference. you can change it for 1GB or based on your attributes.  </p>\n\n<hr>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Call FileSize\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub FileSize()\n    Dim LResult As Long\n    strFileFullName = ActiveWorkbook.FullName\n    LResult = FileLen(strFileFullName)\n    If LResult &gt; 1000 Then\n        MsgBox \"FileSize is large \" &amp; (LResult)\n        ActiveWorkbook.Close (savechanges)\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2415, "favorite_count": 0, "accepted_answer_id": 48902676, "answer_count": 2, "score": 1, "last_activity_date": 1519233951, "creation_date": 1519205692, "question_id": 48902444, "link": "https://stackoverflow.com/questions/48902444/calculate-the-file-size-vba-macro", "title": "Calculate the file size - VBA macro", "body": "<p>I am working on a VBA macro which will process a CSV file by creating a temporary file.\nI am using <code>Microsoft Excel 2010 32-bit</code>. The 32-bit versions have the <code>2 Gigabyte</code> memory limits.</p>\n\n<p>The size of CSV file that is being processed using macro is > 1GB. \nAs stated previously, while processing the CSV file we are saving it to a temporary *xls file. \nSo the total size while processing the CSV file will be the <code>size of CSV file</code> + <code>size of the temp xls</code> file that we are creating during the processing. \nThe size of both the files together is beyond the limit of 2GB and hence excel is crashing.</p>\n\n<p>We have 2 scenarios:</p>\n\n<ol>\n<li>When the user opens a CSV file using macro, I show a message box to the user if the user opens a CSV file whose size is > 1GB and close the excel.</li>\n<li>When the user opens a CSV file using macro, and the CSV file size &lt; 1GB and then user adds some data to it which will make its \nsize > 1GB, I have to show a message box to the user as soon as the file size reaches 1GB and close the excel without losing any data.</li>\n</ol>\n\n<p>My question, </p>\n\n<ul>\n<li>For the first case, I can use FileLen which returns a Long value specifying the length of a file in bytes.</li>\n<li>For the second case: I am not getting how to calculate the file size when user is editing the CSV file using macro.</li>\n</ul>\n\n<p>Need help,\nThanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 2, "creation_date": 1519206478, "post_id": 48902402, "comment_id": 84810583, "body": "In your post you say &quot;I want to make a macro&quot;, so...GO FOR IT AND CREATE IT!"}, {"owner": {"reputation": 23, "user_id": 9196916, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fPqqXlNBS6c/AAAAAAAAAAI/AAAAAAAANVA/nr1jB9TELjA/photo.jpg?sz=128", "display_name": "Ghozian pribadi", "link": "https://stackoverflow.com/users/9196916/ghozian-pribadi"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1519207176, "post_id": 48902402, "comment_id": 84811156, "body": "Ah yes my bad, edited."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 2, "creation_date": 1519207564, "post_id": 48902402, "comment_id": 84811468, "body": "Now you say &quot;Can anyone help me&quot; so don&#39;t forget to read <a href=\"https://meta.stackoverflow.com/questions/284236/why-is-can-someone-help-me-not-an-actual-question\">Why is \u201cCan someone help me?\u201d not an actual question?</a>. This is going to be a long day for you, my friend xD. Post the code you have tried, please."}, {"owner": {"reputation": 23, "user_id": 9196916, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fPqqXlNBS6c/AAAAAAAAAAI/AAAAAAAANVA/nr1jB9TELjA/photo.jpg?sz=128", "display_name": "Ghozian pribadi", "link": "https://stackoverflow.com/users/9196916/ghozian-pribadi"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1519207973, "post_id": 48902402, "comment_id": 84811750, "body": "To be honest I don&#39;t have sufficient knowledge how to write vba code from scratch for such complex features, but I always tried to learn the codes from answers in here, at least I tried to understand the logic behind the code. For this case, this is way too steep for my knowledge haha :( Sure, for me today&#39;s almost over and yea it&#39;s a long day, Stack Overflow will gladly extend my day..  This is the only thing I could write which is the logic: Identify the value in A1:A5 column, scan the folder and loop, if match copy B9 &amp; E9 from matched system generated workbook to B2 &amp; C2 master&#39;s cell"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 2, "creation_date": 1519208255, "post_id": 48902402, "comment_id": 84811967, "body": "If you don&#39;t know VBA, then hire a developer. Anyways, about your problem. &#191;Have you tried just liinking the workbooks? I mean, no need of VBA, you can type a formula to make reference to those cells, something like <code>=&#39;Z:\\YourWorkbookFolder\\[YourWorkbookName.xlsx]Worksheet&#39;!$B&zwnj;&#8203;$9</code>"}, {"owner": {"reputation": 23, "user_id": 9196916, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fPqqXlNBS6c/AAAAAAAAAAI/AAAAAAAANVA/nr1jB9TELjA/photo.jpg?sz=128", "display_name": "Ghozian pribadi", "link": "https://stackoverflow.com/users/9196916/ghozian-pribadi"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1519208710, "post_id": 48902402, "comment_id": 84812344, "body": "Hiring developer is a no go because of reasons. The problem is I have a master cell with &gt;600 account number and &gt;2000 of excel generated by system with random name so I have to open it one by one"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1519213768, "post_id": 48902402, "comment_id": 84815874, "body": "@Ghozianpribadi so somewhere in your root folder (e.g. C:\\Work\\2017) you have a file named by Account Number, such as 10001.xlsx? Also on the Master workbook, you have account numbers as 10001, 10002, etc. but on the second image you have the account number on the top as 1001?? Finally on the second image it says &quot;Loan Provision&quot; but on your last image it says &quot;Loss Provision&quot;, please could you clarify these??"}, {"owner": {"reputation": 23, "user_id": 9196916, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fPqqXlNBS6c/AAAAAAAAAAI/AAAAAAAANVA/nr1jB9TELjA/photo.jpg?sz=128", "display_name": "Ghozian pribadi", "link": "https://stackoverflow.com/users/9196916/ghozian-pribadi"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1519216132, "post_id": 48902402, "comment_id": 84817516, "body": "@Xabier oops, sorry, take a look again I already fix it.  No, I have files with random names that contains data like the 2nd pic"}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1519222613, "last_edit_date": 1519222613, "creation_date": 1519221227, "answer_id": 48907698, "question_id": 48902402, "link": "https://stackoverflow.com/questions/48902402/excel-vba-macro-to-match-cell-value-from-workbooks-in-a-root-folder-then-copy-sp/48907698#48907698", "title": "Excel VBA Macro to match cell value from workbooks in a root folder then copy specific cell", "body": "<p>If I understood correctly then the following will loop through a given directory and it will open and check each file for the required information, if found, it will add the values to your Master workbook.</p>\n\n<p><strong>Note</strong>: This code will not open a file if it has \"Master\" in its filename. </p>\n\n<pre><code>Sub LoopThroughFolder()\nDim FSO As New FileSystemObject\nDim myFolder As Folder\nDim wb As Workbook\nDim ws As Worksheet: Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\nDim myFile As File\nDim AccNumber As String\nDim LastRow As Long, i As Long\nDim sPath As String\nsPath = \"C:\\Work\\2017\"\n\nLastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n'get the last row with data on Column A\nApplication.DisplayAlerts = False\n'do not display alerts\nSet myFolder = FSO.GetFolder(sPath) 'set the root folder\n    For Each myFile In myFolder.Files 'for each file in the folder\n        If InStr(myFile.Name, \"Master\") = 0 Then\n        'if file to open does not have \"Master\" in it's name then\n            Set wb = Workbooks.Open(myFile.Path) 'open the file\n            AccNumber = wb.Sheets(1).Range(\"B2\") 'check for account number on first Sheet\n            For i = 1 To LastRow 'loop through current Sheet to check if we have a match for the account number\n                If ws.Cells(i, 1) = AccNumber Then 'if match\n                ws.Cells(i, 2) = wb.Sheets(1).Range(\"B9\") 'pass the values from the required range\n                ws.Cells(i, 3) = wb.Sheets(1).Range(\"E9\")\n                End If\n            Next i\n            wb.Close False 'close and do not save changes\n            Set wb = Nothing\n        End If\n    Next\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>Also you might have to set a reference to the relevant library to use <code>FileSystemObject</code>, to do that:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/3233203/how-do-i-use-filesystemobject-in-vba\">How do I use FileSystemObject in VBA?</a></p>\n\n<p>Within Excel you need to set a reference to the VB script run-time library.\nThe relevant file is usually located at <code>\\Windows\\System32\\scrrun.dll</code></p>\n\n<ul>\n<li>To reference this file, load the\nVisual Basic Editor (<kbd>ALT</kbd>+<kbd>F11</kbd>)</li>\n<li>Select Tools > References from the drop-down menu</li>\n<li>A listbox of available references will be displayed</li>\n<li>Tick the check-box next to '<code>Microsoft Scripting Runtime</code>'</li>\n<li>The full name and path of the <code>scrrun.dll</code> file will be displayed below the listbox</li>\n<li>Click on the <kbd>OK</kbd> button.</li>\n</ul>\n"}], "owner": {"reputation": 23, "user_id": 9196916, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fPqqXlNBS6c/AAAAAAAAAAI/AAAAAAAANVA/nr1jB9TELjA/photo.jpg?sz=128", "display_name": "Ghozian pribadi", "link": "https://stackoverflow.com/users/9196916/ghozian-pribadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 48907698, "answer_count": 1, "score": -1, "last_activity_date": 1519222613, "creation_date": 1519205573, "last_edit_date": 1519216452, "question_id": 48902402, "link": "https://stackoverflow.com/questions/48902402/excel-vba-macro-to-match-cell-value-from-workbooks-in-a-root-folder-then-copy-sp", "title": "Excel VBA Macro to match cell value from workbooks in a root folder then copy specific cell", "body": "<p><a href=\"https://i.stack.imgur.com/ky30h.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ky30h.png\" alt=\"enter image description here\"></a></p>\n\n<p>Picture above is the master workbook. Can anyone help me to write the vba so it will find workbooks throughout the root folder (e.g. C:\\Work\\2017) that match with the account number and copy the B9 and E9 cells to the master cell. The 2nd picture is a system generated workbook with random name (e.g. export!-097a0sdk.xls), that's why I need a shortcut to make this task easier.</p>\n\n<p><a href=\"https://i.stack.imgur.com/TQQvc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TQQvc.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the result I expected by using the code\n<a href=\"https://i.stack.imgur.com/eSBRc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eSBRc.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the excel generated by system\n<a href=\"https://i.stack.imgur.com/1UdvT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1UdvT.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel", "timer", "negative-number"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1519207299, "post_id": 48902328, "comment_id": 84811267, "body": "If your code takes 18 hours to run -- perhaps it is in need of <a href=\"https://codereview.stackexchange.com\">Code Review</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1519223696, "post_id": 48902445, "comment_id": 84822864, "body": "Nice answer (+1 from me).. also noticed you recently picked up your VBA gold badge... congrats!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 4, "last_activity_date": 1519205695, "creation_date": 1519205695, "answer_id": 48902445, "question_id": 48902328, "link": "https://stackoverflow.com/questions/48902328/timing-a-vba-code-returned-a-negative-time/48902445#48902445", "title": "Timing a VBA code returned a negative time", "body": "<p>The code uses <code>Timer</code>. </p>\n\n<blockquote>\n  <p>The <code>Timer</code> returns a Single representing the number of seconds elapsed since midnight. SyntaxTimerRemarks In Microsoft Windows the Timer function returns fractional portions of a second. On the Macintosh, timer resolution is one second. <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/timer-function\" rel=\"nofollow noreferrer\">MSDN</a></p>\n</blockquote>\n\n<p>Thus, if you start running at <code>15:00</code>, the code would return something meaningful, if you end up to <code>23:59</code>. If you end the next day at <code>09:00</code>, it would return negative value.</p>\n\n<p>You can rebuild the code, in order to get the date in account as well. Use <code>Now</code>, which returns the date and the time - <code>21.02.2018 10:33:55</code></p>\n\n<p>This looks like a good possible alternative:</p>\n\n<pre><code>Sub WorkstAtMidnight()\n\n    Dim StartTime As Date\n    StartTime = Now()\n    'Do something incredible\n    MsgBox Round((Now() - StartTime) * 24 * 60 * 60, 0)\n    '24 hours times 60 minutes times 60 seconds (usually I just do 24*3600)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 2, "last_activity_date": 1519206865, "creation_date": 1519206865, "answer_id": 48902845, "question_id": 48902328, "link": "https://stackoverflow.com/questions/48902328/timing-a-vba-code-returned-a-negative-time/48902845#48902845", "title": "Timing a VBA code returned a negative time", "body": "<p>Another alternative:</p>\n\n<pre><code>MinutesElapsed = Format((Timer - StartTime) / 86400 + IIf(Timer &lt; StartTime, 1, 0), \"hh:mm:ss\")\n</code></pre>\n\n<p>This keeps track of the hours and minutes accurately up to a whole day (i.e. it resets at 24 hours of runtime). After which the real question is <em>why does your code take so long!</em></p>\n"}], "owner": {"reputation": 1964, "user_id": 2123706, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7f9f8aacaafd903d700846efd805bd55?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/2123706/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 942, "favorite_count": 0, "accepted_answer_id": 48902445, "answer_count": 2, "score": 3, "last_activity_date": 1519206865, "creation_date": 1519205388, "last_edit_date": 1519205716, "question_id": 48902328, "link": "https://stackoverflow.com/questions/48902328/timing-a-vba-code-returned-a-negative-time", "title": "Timing a VBA code returned a negative time", "body": "<p>I ran some code in VBA as per <a href=\"https://www.thespreadsheetguru.com/the-code-vault/2015/1/28/vba-calculate-macro-run-time\" rel=\"nofollow noreferrer\">https://www.thespreadsheetguru.com/the-code-vault/2015/1/28/vba-calculate-macro-run-time</a> and had a return of a negative value:</p>\n\n<p>-20439 seconds</p>\n\n<p>Does anyone know why? It actually ran for ~ 18hrs (1500 - 0900 next day)</p>\n\n<pre><code>Option Explicit\n\nSub CalculateRunTime_Minutes()\n'PURPOSE: Determine how many minutes it took for code to completely run\n'SOURCE: www.TheSpreadsheetGuru.com/the-code-vault\n\nDim StartTime As Double\nDim MinutesElapsed As String\n\n'Remember time when macro starts\n  StartTime = Timer\n\n'*****************************\n'Insert Your Code Here...\n'*****************************\n\n'Determine how many seconds code took to run\n  MinutesElapsed = Format((Timer - StartTime) / 86400, \"hh:mm:ss\")\n\n'Notify user in seconds\n  MsgBox \"This code ran successfully in \" &amp; MinutesElapsed &amp; \" minutes\", vbInformation\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "regex", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1519203107, "post_id": 48901520, "comment_id": 84808396, "body": "Can you please also show the VBA code that you already have tried?"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 1, "creation_date": 1519203206, "post_id": 48901520, "comment_id": 84808460, "body": "<a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\" title=\"how to use regular expressions regex in microsoft excel both in cell and loops\">stackoverflow.com/questions/22542834/&hellip;</a>"}], "owner": {"reputation": 604, "user_id": 3064448, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LOvOX.png?s=128&g=1", "display_name": "davinceleecode", "link": "https://stackoverflow.com/users/3064448/davinceleecode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "closed_date": 1519203595, "answer_count": 0, "score": 0, "last_activity_date": 1519203118, "creation_date": 1519202930, "last_edit_date": 1519203118, "question_id": 48901520, "link": "https://stackoverflow.com/questions/48901520/what-is-the-equivalent-c-regex-matches-function-to-vba-macro", "closed_reason": "Duplicate", "title": "What is the equivalent C# REGEX matches function to vba macro?", "body": "<p>I have code here in c# and I want it to convert to vba macro but I can't find the Matches function on it. How can I convert this code to vba macro? here's my sample code:</p>\n\n<pre><code>String input1 = \"CODE.0002 ,TESTING.0002  CODE.0001\";\nvar m1 = Regex.Matches(input1, @\"(CODE\\.\\d{0,5})\");\nvar list = new List&lt;string&gt;();\n\nforeach (Match match in m1)\n{\n   list.Add(match.Value);\n}\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy", "rows"], "answers": [{"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1519213258, "post_id": 48901758, "comment_id": 84815503, "body": "@Xabier there was a typo: edited code accordingly. Thanks"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1519213203, "last_edit_date": 1519213203, "creation_date": 1519203674, "answer_id": 48901758, "question_id": 48901346, "link": "https://stackoverflow.com/questions/48901346/vba-copy-entire-row-if-cell-matches-a-value-for-entire-sheet/48901758#48901758", "title": "VBA Copy entire row if cell matches a value for entire sheet", "body": "<p>Edit: as per comment corrected sht to sht2</p>\n\n<p>when deleting items from a <code>Collection</code> (like rows in a <code>Range</code> is) you should proceed from bottom to top and avoid both skipping items and processing nonexistent ones</p>\n\n<p>moreover your code didn't update <code>lastRow(n)</code> of \"tagret\" sheets</p>\n\n<p>do consider following code (untested, but commented)</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n'Declare variables\n    Dim sht1 As Worksheet\n    Dim sht2 As Worksheet\n    Dim sht3 As Worksheet\n    Dim iRow As Long\n\n'Set variables\n    Set sht1 = Sheets(\"To DO\")\n    Set sht2 = Sheets(\"Ongoing\")\n    Set sht3 = Sheets(\"Done\")\n\n    With sht2\n        With Range(\"H1\", .Cells(.Rows.Count, \"H\").End(xlUp)) 'reference its column H from row 1 down to last not empty one\n            iRow = .Rows.Count 'initialize row index from the bottom\n            Do\n                With .Cells(iRow, 1) 'reference referenced range cell in its current row\n                    Select Case .Value\n                        Case \"Not started\"\n                            .Rows(iRow).Copy Destination:=sht1.Cells(sht1.Rows.Count, \"A\").End(xlUp)\n                            .Rows(iRow).Delete\n\n                        Case \"Closed\"\n                            .Rows(iRow).Copy Destination:=sht3.Cells(sht3.Rows.Count, \"A\").End(xlUp)\n                            .Rows(iRow).Delete\n                    End Select\n                End With\n                iRow = iRow - 1\n             Loop While iRow &gt;= 1\n        End With\n    End With\n\n    MsgBox \"Update Done!\"\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 3512870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69d96645c36ab22f37b802c3b69e6ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Axi\u03a9mega", "link": "https://stackoverflow.com/users/3512870/axi%ce%a9mega"}, "edited": false, "score": 0, "creation_date": 1519204270, "post_id": 48901785, "comment_id": 84809101, "body": "Thanks this worked perfectly! Also thank you for explaining where I went wrong and what the correct MO is."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 5, "user_id": 3512870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69d96645c36ab22f37b802c3b69e6ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Axi\u03a9mega", "link": "https://stackoverflow.com/users/3512870/axi%ce%a9mega"}, "edited": false, "score": 0, "creation_date": 1519206167, "post_id": 48901785, "comment_id": 84810368, "body": "@Axi\u03a9mega You&#39;re welcome! Glad it worked as desired and you found the explanation helpful."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 2, "last_activity_date": 1519203741, "creation_date": 1519203741, "answer_id": 48901785, "question_id": 48901346, "link": "https://stackoverflow.com/questions/48901346/vba-copy-entire-row-if-cell-matches-a-value-for-entire-sheet/48901785#48901785", "title": "VBA Copy entire row if cell matches a value for entire sheet", "body": "<p>Normally when you need to delete the rows based on a criteria, you should use a counter variable and loop through the cells in the <code>reverse order</code>.</p>\n\n<p>But if you are looping through cells using range/cell objects, you should not delete the row just after copying it to another sheet. Instead, you should declare a range variable and store the address of all the cells which qualify for the row delete criteria and delete them all at once in the end.</p>\n\n<p>In this scenario, the <code>Autofilter</code> is an ideal candidate to use.</p>\n\n<p>Please try the tweaked version of your original code.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n'Declare variables\n    Dim sht1 As Worksheet\n    Dim sht2 As Worksheet\n    Dim sht3 As Worksheet\n    Dim lastRow1 As Long, lastRow2 As Long, lastRow3 As Long\n    Dim Cell As Range\n    Dim RngToDelete As Range\n\n    Application.ScreenUpdating = False\n'Set variables\n    Set sht1 = Sheets(\"To DO\")\n    Set sht2 = Sheets(\"Ongoing\")\n    Set sht3 = Sheets(\"Done\")\n\n'Select Entire Row\n    'Selection.EntireRow.Select\n\n'Move row to destination sheet &amp; Delete source row\n    lastRow1 = sht1.Range(\"A\" &amp; sht1.Rows.Count).End(xlUp).Row\n    lastRow2 = sht2.Range(\"A\" &amp; sht2.Rows.Count).End(xlUp).Row\n    lastRow3 = sht3.Range(\"A\" &amp; sht3.Rows.Count).End(xlUp).Row\n\n    With sht2\n    ' loop column H untill last cell with value (not entire column)\n    For Each Cell In .Range(\"H2:H\" &amp; .Cells(.Rows.Count, \"H\").End(xlUp).Row)\n        If Cell.Value = \"Not started\" Then\n            If RngToDelete Is Nothing Then\n                Set RngToDelete = Cell\n            Else\n                Set RngToDelete = Union(RngToDelete, Cell)\n            End If\n            lastRow1 = sht1.Range(\"A\" &amp; sht1.Rows.Count).End(xlUp).Row\n             ' Copy&gt;&gt;Paste in 1-line (no need to use Select)\n            .Rows(Cell.Row).Copy Destination:=sht1.Rows(lastRow1 + 1)\n            '.Rows(Cell.Row).Delete\n\n        ElseIf Cell.Value = \"Closed\" Then\n            If RngToDelete Is Nothing Then\n                Set RngToDelete = Cell\n            Else\n                Set RngToDelete = Union(RngToDelete, Cell)\n            End If\n            lastRow3 = sht3.Range(\"A\" &amp; sht3.Rows.Count).End(xlUp).Row\n             ' Copy&gt;&gt;Paste in 1-line (no need to use Select)\n            .Rows(Cell.Row).Copy Destination:=sht3.Rows(lastRow3 + 1)\n            '.Rows(Cell.Row).Delete\n\n        End If\n     Next Cell\n\n    End With\n\n    If Not RngToDelete Is Nothing Then RngToDelete.EntireRow.Delete\n    Application.CutCopyMode = 0\n    Application.ScreenUpdating = True\n    MsgBox \"Update Done!\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 3512870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69d96645c36ab22f37b802c3b69e6ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Axi\u03a9mega", "link": "https://stackoverflow.com/users/3512870/axi%ce%a9mega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5768, "favorite_count": 0, "accepted_answer_id": 48901785, "answer_count": 2, "score": 0, "last_activity_date": 1519213203, "creation_date": 1519202341, "last_edit_date": 1519203468, "question_id": 48901346, "link": "https://stackoverflow.com/questions/48901346/vba-copy-entire-row-if-cell-matches-a-value-for-entire-sheet", "title": "VBA Copy entire row if cell matches a value for entire sheet", "body": "<p>I'm trying to have an update button where it checks the cells in column H for values \"not started\" or \"closed\" and cut/paste these cells to the corresponding sheet. The code I currently have doesn't treat every cell and only copies one row to each sheet.</p>\n\n<p>Screenshot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XFXnF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XFXnF.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n'Declare variables\n    Dim sht1 As Worksheet\n    Dim sht2 As Worksheet\n    Dim sht3 As Worksheet\n    Dim lastRow As Long\n    Dim Cell As Range\n\n'Set variables\n    Set sht1 = Sheets(\"To DO\")\n    Set sht2 = Sheets(\"Ongoing\")\n    Set sht3 = Sheets(\"Done\")\n\n'Select Entire Row\n    Selection.EntireRow.Select\n\n'Move row to destination sheet &amp; Delete source row\n    lastRow1 = sht1.Range(\"A\" &amp; sht1.Rows.Count).End(xlUp).Row\n    lastRow2 = sht2.Range(\"A\" &amp; sht2.Rows.Count).End(xlUp).Row\n    lastRow3 = sht3.Range(\"A\" &amp; sht3.Rows.Count).End(xlUp).Row\n\n    With sht2\n    ' loop column H untill last cell with value (not entire column)\n    For Each Cell In .Range(\"H1:H\" &amp; .Cells(.Rows.Count, \"H\").End(xlUp).Row)\n        If Cell.Value = \"Not started\" Then\n             ' Copy&gt;&gt;Paste in 1-line (no need to use Select)\n            .Rows(Cell.Row).Copy Destination:=sht1.Rows(lastRow1 + 1)\n            .Rows(Cell.Row).Delete\n\n        ElseIf Cell.Value = \"Closed\" Then\n             ' Copy&gt;&gt;Paste in 1-line (no need to use Select)\n            .Rows(Cell.Row).Copy Destination:=sht3.Rows(lastRow3 + 1)\n            .Rows(Cell.Row).Delete\n\n        End If\n     Next Cell\n\n    End With\n\n    MsgBox \"Update Done!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "range", "ms-word", "selection"], "answers": [{"comments": [{"owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1519279430, "post_id": 48913102, "comment_id": 84847563, "body": "I am getting  &#39;Compiler error Object Required&#39; at <code>Set CON = selection.Text</code>."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1519279759, "post_id": 48913102, "comment_id": 84847694, "body": "@IbneAshiq Ah? I copied that line from your code and didn&#39;t look at it closely, assuming you provided working code. You need to change it to selection.Range."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1519279827, "last_edit_date": 1519279827, "creation_date": 1519238079, "answer_id": 48913102, "question_id": 48901298, "link": "https://stackoverflow.com/questions/48901298/select-a-particular-sentence-in-range-using-find-method-and-making-it-bold/48913102#48913102", "title": "Select a particular sentence in range using find method and making it bold", "body": "<p>Declare an additional Range variable, for example </p>\n\n<pre><code>Dim conFind as Word.Range\n</code></pre>\n\n<p>then set it to be a <em>duplicate</em> of the original Range. Use this for the Find - if Find is successful <code>conFind</code> will be the found Range. Then set the End point of the original Range to the end point of the found Range and apply the bold formatting.</p>\n\n<p>Note: I prefer to also create a boolean variable to hold the success of Find.Found, rather than testing Range.Find.Found as in my experience it's more reliable. I've left the code as you have it, however...</p>\n\n<pre><code>Set CON = selection.Range\nselection.ExtendMode = False\nSet conFIND = CON.Duplicate\nWith conFind.Find\n  .Text = \". \"\n  .Forward = False\n  .Wrap = wdFindStop\n  .Execute\nEnd With\nIf conFind.Find.Found Then\n  CON.End = conFind.End\n  CON.Font.Bold = True\nelse \nend if\n</code></pre>\n"}], "owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 48913102, "answer_count": 1, "score": 0, "last_activity_date": 1519288227, "creation_date": 1519202175, "last_edit_date": 1519288227, "question_id": 48901298, "link": "https://stackoverflow.com/questions/48901298/select-a-particular-sentence-in-range-using-find-method-and-making-it-bold", "title": "Select a particular sentence in range using find method and making it bold", "body": "<p>Using following code firstly I make the selected paragraph as range and then I want to <strong>bold</strong> text from start of the paragraph till first sentence end which in my case it is \". \"</p>\n\n<p>How its is possible to select the first sentence in given range?</p>\n\n<pre><code>Dim CON As Range\nselection.MoveDown Unit:=wdParagraph, COUNT:=1, Extend:=wdExtend\nIf selection.Range.ComputeStatistics(wdStatisticLines) &lt; 3 Then\nselection.Font.Bold = True\nselection.MoveRight Unit:=wdCharacter, COUNT:=1\nElse\nselection.MoveLeft Unit:=wdCharacter, COUNT:=1\nselection.ExtendMode = True\nselection.EndKey Unit:=wdLine\nselection.MoveDown Unit:=wdLine, COUNT:=2\nSet CON = selection.Range\nselection.ExtendMode = False\nWith CON.Find\n.Text = \". \"\n.Forward = False\n.Wrap = wdFindStop\n.Execute\nEnd With\nIf CON.Find.Found Then\n'' Now here I want to bold the sentence \nelse \nend if\n</code></pre>\n\n<p><strong>UPDATE</strong> </p>\n\n<p>I set the code and now it can evaluation what it is found.</p>\n\n<pre><code>Set CON = selection.Range\nselection.ExtendMode = False\nSet conFind = CON.Duplicate\n'''''''''''''&gt;&gt;''''''''''''\n    With conFind.Find\n    .Text = \"&gt;&gt;\"\n    .Forward = False\n    .Wrap = wdFindStop\n    .Execute\n    End With\n    If conFind.Find.Found Then\n      CON.End = conFind.End\n      CON.Font.Bold = True\n    Else\n'''''''''''''. ''''''''''''\n        With conFind.Find\n        .Text = \"^?. \"\n        .Forward = False\n        .Wrap = wdFindStop\n        .Execute\n        End With\n        If conFind.Find.Found Then\n\n                If confind = \"S. \" Then\n                conFind.Find.Execute\n                If conFind.Find.found Then\n                CON.End = conFind.End\n                CON.Font.Bold = True\n                Else\n                End If\n\n            Else\n            CON.End = conFind.End\n            CON.Font.Bold = True\n            End If\n\n\n        Else\n''''''''''''', ''''''''''''\n            With conFind.Find\n            .Text = \", \"\n            .Forward = False\n            .Wrap = wdFindStop\n            .Execute\n            End With\n            If conFind.Find.Found Then\n            CON.End = conFind.End\n            CON.Font.Bold = True\n            Else\n            End If\n        End If\n    End If\n</code></pre>\n"}, {"tags": ["string", "vba", "validation"], "comments": [{"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 2, "creation_date": 1519202013, "post_id": 48901092, "comment_id": 84807838, "body": "RegExp can be used."}, {"owner": {"reputation": 320, "user_id": 5892997, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh5.googleusercontent.com/-Wg5QDVBjdU8/AAAAAAAAAAI/AAAAAAAABPs/sfpR6VW3P0U/photo.jpg?sz=128", "display_name": "&#193;d&#225;m Bukovinszki", "link": "https://stackoverflow.com/users/5892997/%c3%81d%c3%a1m-bukovinszki"}, "reply_to_user": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1519202772, "post_id": 48901092, "comment_id": 84808218, "body": "Yes, and thanks for the tip, but that would involve an even more complex code. Starting with the object creation: CreateObject(&quot;vbscript.regexp&quot;). So there is no inbuilt, fancy oneliner?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1519205059, "post_id": 48901092, "comment_id": 84809588, "body": "<a href=\"https://stackoverflow.com/questions/29633517/how-can-i-check-if-a-string-only-contains-letters\" title=\"how can i check if a string only contains letters\">stackoverflow.com/questions/29633517/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519205607, "post_id": 48901092, "comment_id": 84809951, "body": "No fancy one liner. Using the API call for <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms646979(v=vs.85).aspx\" rel=\"nofollow noreferrer\">IsCharAlpha</a>  will likely be more efficient when iterating and exiting at first false e.g.<a href=\"https://stackoverflow.com/questions/93105/whats-the-best-way-to-determine-if-a-character-is-a-letter-in-vb6\" title=\"whats the best way to determine if a character is a letter in vb6\">stackoverflow.com/questions/93105/&hellip;</a>"}, {"owner": {"reputation": 320, "user_id": 5892997, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh5.googleusercontent.com/-Wg5QDVBjdU8/AAAAAAAAAAI/AAAAAAAABPs/sfpR6VW3P0U/photo.jpg?sz=128", "display_name": "&#193;d&#225;m Bukovinszki", "link": "https://stackoverflow.com/users/5892997/%c3%81d%c3%a1m-bukovinszki"}, "edited": false, "score": 0, "creation_date": 1519215506, "post_id": 48901092, "comment_id": 84817084, "body": "Thanks guys, i totally accept this:  <code>IsAlpha = strValue Like WorksheetFunction.Rept(&quot;[a-zA-Z]&quot;, Len(strValue))</code> as a oneliner. I accept it as a solution, especially as it does not require external stuff."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 2, "creation_date": 1519221930, "post_id": 48901092, "comment_id": 84821548, "body": "use <code>If text Like &quot;*[!A-Za-z]&quot;</code> to test if a string has some characters not in range <code>A-Za-z</code>."}, {"owner": {"reputation": 320, "user_id": 5892997, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh5.googleusercontent.com/-Wg5QDVBjdU8/AAAAAAAAAAI/AAAAAAAABPs/sfpR6VW3P0U/photo.jpg?sz=128", "display_name": "&#193;d&#225;m Bukovinszki", "link": "https://stackoverflow.com/users/5892997/%c3%81d%c3%a1m-bukovinszki"}, "edited": false, "score": 0, "creation_date": 1519245624, "post_id": 48901092, "comment_id": 84836505, "body": "Needs an extra * to work properly, like <code>&quot;*[!A-Za-z]*&quot;</code> ; but otherwise YES, that &quot;!&quot; is the simplest expression i was hoping to logically exist in the first place. thanks"}], "answers": [{"tags": [], "owner": {"reputation": 320, "user_id": 5892997, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh5.googleusercontent.com/-Wg5QDVBjdU8/AAAAAAAAAAI/AAAAAAAABPs/sfpR6VW3P0U/photo.jpg?sz=128", "display_name": "&#193;d&#225;m Bukovinszki", "link": "https://stackoverflow.com/users/5892997/%c3%81d%c3%a1m-bukovinszki"}, "is_accepted": true, "score": 0, "last_activity_date": 1519285915, "last_edit_date": 1519285915, "creation_date": 1519216004, "answer_id": 48905933, "question_id": 48901092, "link": "https://stackoverflow.com/questions/48901092/limit-text-to-allowed-characters-only-not-by-enumerating-the-wrong-characters/48905933#48905933", "title": "Limit text to allowed characters only - (not by enumerating the wrong characters) | VBA", "body": "<p>Ok, it seems my question was a bit of a duplicate, even though that did not pop in my search results.\nSo credits for @QHarr   for posting the link.</p>\n\n<p>The solution I can forge from that idea for my \"oneliner\" is:</p>\n\n<pre><code>If myText Like WorksheetFunction.Rept(\"[a-zA-Z]\", Len(myText))=false then 'do something.\n</code></pre>\n\n<p>Using .rept is inspiringly clever and elegant in my oppinion.\nSo what is does: Multiplies the search criteria for each charater instead of looping through the characters.</p>\n\n<p><strong>EDIT:</strong><br>\nIn an overaboundance of nice and elegant solutions, the most recent leader is:</p>\n\n<pre><code>If not myText Like \"*[!A-Za-z]*\" then '... do something\n</code></pre>\n\n<p><strong>Statistics update:</strong><br>\nI have tested the last 3 solutions' performance:\nI have pasted @ in the below text strin at the beginning, at the end or nowhere.\nThe criteria were: <code>\"*[a-zA-Z \\S.,]*\"</code> <br>\nFor 100000 repetitions <br></p>\n\n<pre><code>text = \"This will be a very Long text, with one unwanted in the middle, to be able to test the difference in performance of the approaches.\"\n</code></pre>\n\n<p>1.) Using the [!...]  -> <strong>30ms</strong> with error, <strong>80ms</strong> if no error <br>\n2.) Using .Rept   -> around <strong>1800ms</strong> for all cases <br>\n3.) Using characterLoop+Mid -> around <strong>3000ms</strong> if no error / <strong>40-80ms</strong> ms if early error <br></p>\n\n<hr>\n"}], "owner": {"reputation": 320, "user_id": 5892997, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh5.googleusercontent.com/-Wg5QDVBjdU8/AAAAAAAAAAI/AAAAAAAABPs/sfpR6VW3P0U/photo.jpg?sz=128", "display_name": "&#193;d&#225;m Bukovinszki", "link": "https://stackoverflow.com/users/5892997/%c3%81d%c3%a1m-bukovinszki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 1, "accepted_answer_id": 48905933, "answer_count": 1, "score": 0, "last_activity_date": 1519285915, "creation_date": 1519201414, "last_edit_date": 1519204244, "question_id": 48901092, "link": "https://stackoverflow.com/questions/48901092/limit-text-to-allowed-characters-only-not-by-enumerating-the-wrong-characters", "title": "Limit text to allowed characters only - (not by enumerating the wrong characters) | VBA", "body": "<p>I would like to limit certain textboxes to accept only [A-Za-z]\nI hope, a counterpart to Like exists.\nWith Like I would have to make a long list of not allowed characters to be able to filter.</p>\n\n<pre><code>Not MyString like [?;!\u00b0%/=....]\n</code></pre>\n\n<p>I can think of a solution in the form of:</p>\n\n<pre><code>For Counter = 1 To Len(MyString)\n    if Mid(MyString, Counter, 1) Like \"*[a-z]*\" = false then\n        MsgBox \"String contains bad characters\"\n        exit sub\n    end if\nnext\n</code></pre>\n\n<p><strong>... but is there a more sophisticated 1liner solution ?</strong></p>\n\n<p>Until then, I have created a function to make it \"Oneliner\":</p>\n\n<pre><code>Function isPureString(myText As String) As Boolean\n    Dim i As Integer\n    isPureString = True\n    For i = 1 To Len(myText)\n        If Mid(myText, i, 1) Like \"*[a-zA-Z_\u00ed\u00e9\u00e1\u0171\u00fa\u0151\u00f6\u00fc\u00f3\u00d3\u00dc\u00d6\u00da\u0150\u0170\u00c1\u00c9\u00cd]*\" = False Then\n            isPureString = False\n        End If\n    Next\nEnd Function\n</code></pre>\n\n<p>If i add 1 more parameter, its also possible to define the allowed characters upon calling the function.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1519201269, "post_id": 48900915, "comment_id": 84807442, "body": "Use <code>Sub Worksheet_Change</code> with <code>Range(YourRange).Calculate</code>"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 1, "creation_date": 1519202171, "post_id": 48900915, "comment_id": 84807938, "body": "@AntiDrondert, <code>Worksheet_Change</code> event handler doesn&#39;t get triggered by a cell color change"}], "answers": [{"tags": [], "owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "is_accepted": false, "score": 2, "last_activity_date": 1519203549, "last_edit_date": 1519203549, "creation_date": 1519202353, "answer_id": 48901349, "question_id": 48900915, "link": "https://stackoverflow.com/questions/48900915/how-execute-a-user-defined-function-automatically-in-an-update/48901349#48901349", "title": "How execute a user defined function automatically in an update?", "body": "<p>Unfortunatelly there is no default event which would trace cell color change (assuming that we are talking about normal formatting and not conditional formatting).  There are some workarounds, however require loops or Class module (<a href=\"https://www.mrexcel.com/forum/excel-questions/574405-capturing-cell-color-change-vba.html\" rel=\"nofollow noreferrer\">workarounds</a>).</p>\n\n<p>Additionaly, by default, UDF's (User Defined Functions) in Excel VBA are not volatile. If you try to add <code>Application.Volatile</code> at the begining of your function, you will see that after change of cell colour and pressing F9 (or any other change in the workbook) the function should recalculate.</p>\n"}], "owner": {"reputation": 21, "user_id": 9363810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9304752250bf71d0a4bbcfc0fd98a8a5?s=128&d=identicon&r=PG&f=1", "display_name": "fightsaber", "link": "https://stackoverflow.com/users/9363810/fightsaber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561983484, "creation_date": 1519200750, "last_edit_date": 1561983484, "question_id": 48900915, "link": "https://stackoverflow.com/questions/48900915/how-execute-a-user-defined-function-automatically-in-an-update", "title": "How execute a user defined function automatically in an update?", "body": "<p>I have this VBA function in an Excel 2003 sheet:</p>\n\n<pre><code>Function ContarColor(range_data As Range, criteria As Range) As Long\n    Dim datax As Range\n    Dim xcolor As Long\n    xcolor = criteria.Interior.ColorIndex\n    For Each datax In range_data\n        If datax.Interior.ColorIndex = xcolor Then\n            ContarColor = ContarColor + 1\n        End If\n    Next datax\nEnd Function\n</code></pre>\n\n<p>I use the function to count the colors in a range.</p>\n\n<p>For example I use:</p>\n\n<pre><code>=ContarColor(D4:AG5;Y31)\n</code></pre>\n\n<p>Where D4:AG5 is the range of rows, and Y31 is the referenced row color.</p>\n\n<p>If I add or remove a color, and don't press enter in the formula, it does not refresh.</p>\n\n<p>What can I do to automatically refresh on editing the range?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3393, "user_id": 2373410, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/684a479ecdc16beb9c6ddd01073f2fee?s=128&d=identicon&r=PG", "display_name": "Pangu", "link": "https://stackoverflow.com/users/2373410/pangu"}, "edited": false, "score": 0, "creation_date": 1519201558, "post_id": 48901081, "comment_id": 84807591, "body": "not sure what you mean (still learning), can you provide code sample based on my example?"}, {"owner": {"reputation": 3393, "user_id": 2373410, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/684a479ecdc16beb9c6ddd01073f2fee?s=128&d=identicon&r=PG", "display_name": "Pangu", "link": "https://stackoverflow.com/users/2373410/pangu"}, "edited": false, "score": 0, "creation_date": 1519241049, "post_id": 48901081, "comment_id": 84834006, "body": "tried your suggestion but I&#39;m getting an error: <code>Data type mismatch in criteria expression</code>. I do see that when I do a <code>Debug.Print Criteria</code>, the following shows: <code>FirstName = &#39;John&#39; And MiddleName = &#39;David&#39; And LastName = &#39;Doe&#39;</code> which is the data that I input....however, I&#39;m not exactly sure what the issue is"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 3393, "user_id": 2373410, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/684a479ecdc16beb9c6ddd01073f2fee?s=128&d=identicon&r=PG", "display_name": "Pangu", "link": "https://stackoverflow.com/users/2373410/pangu"}, "edited": false, "score": 0, "creation_date": 1519247517, "post_id": 48901081, "comment_id": 84837471, "body": "It may be that the <i>bound column</i> of the listbox is not ID. It should be so, however, with an assigned columnwidth of zero, as you probably don&#39;t want to display the ID."}, {"owner": {"reputation": 3393, "user_id": 2373410, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/684a479ecdc16beb9c6ddd01073f2fee?s=128&d=identicon&r=PG", "display_name": "Pangu", "link": "https://stackoverflow.com/users/2373410/pangu"}, "edited": false, "score": 0, "creation_date": 1519248023, "post_id": 48901081, "comment_id": 84837721, "body": "I actually resolved it, in my real code, I have some <code>Text Box</code> and <code>Check Box</code>...i.e. <code>Me.checkBox_Something</code>, and when I removed the <code>Check Box</code> from the criteria....i.e. <code>&quot;MyCheckBox = &#39;&quot; &amp; Me.checkBox_Something &amp; &quot;&#39;</code> it worked fine, but is there a way to include the <code>Check Box</code> in the criteria?....The <code>True</code> or <code>False</code> values of the <code>Check Box</code> are just strings also, so I&#39;m not sure why it is complaining?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 3393, "user_id": 2373410, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/684a479ecdc16beb9c6ddd01073f2fee?s=128&d=identicon&r=PG", "display_name": "Pangu", "link": "https://stackoverflow.com/users/2373410/pangu"}, "edited": false, "score": 0, "creation_date": 1519287026, "post_id": 48901081, "comment_id": 84851179, "body": "That&#39;s because <code>True&#47;False</code> <i>not</i> are text. See extended answer, please."}, {"owner": {"reputation": 3393, "user_id": 2373410, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/684a479ecdc16beb9c6ddd01073f2fee?s=128&d=identicon&r=PG", "display_name": "Pangu", "link": "https://stackoverflow.com/users/2373410/pangu"}, "edited": false, "score": 0, "creation_date": 1519289202, "post_id": 48901081, "comment_id": 84852276, "body": "great!....one last question...is there a reason why you used the bang notation vs dot notation? I used the dot notation, i.e. <code>Me.MyList.Value</code> and the result was the same"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 3393, "user_id": 2373410, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/684a479ecdc16beb9c6ddd01073f2fee?s=128&d=identicon&r=PG", "display_name": "Pangu", "link": "https://stackoverflow.com/users/2373410/pangu"}, "edited": false, "score": 0, "creation_date": 1519294000, "post_id": 48901081, "comment_id": 84855361, "body": "In some rare cases dots only can cause misbehaviour. So, it&#39;s mostly a matter of preference. The Bang clearly indicates, that <code>MyList</code> is a <i>control</i>, not a method or property."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1519286950, "last_edit_date": 1519286950, "creation_date": 1519201382, "answer_id": 48901081, "question_id": 48900695, "link": "https://stackoverflow.com/questions/48900695/how-to-select-the-recently-added-record-in-the-listbox/48901081#48901081", "title": "How to select the recently added record in the listbox?", "body": "<p>No, there isn't.</p>\n\n<p>But why not set the <em>value</em> of the ListBox to that of the newly entered value? </p>\n\n<p>That would display that entry right away. Something like:</p>\n\n<pre><code>Dim Criteria As String\n\nCriteria = _\n    \"FirstName = '\" &amp; Me.textBox_FirstName &amp; \"' And \" &amp; _\n    \"MiddleName = '\" &amp; Me.textBox_MiddleName &amp; \"' And \" &amp; _\n    \"LastName = '\" &amp; Me.textBox_LastName &amp; \"' And \" &amp; _\n    \"YesNoField = \" &amp; Me.checkbox_Something &amp; \"\"\n\nMe!MyList.Value = DLookup(\"ID\", \"tblMyData\", Criteria)\n</code></pre>\n"}], "owner": {"reputation": 3393, "user_id": 2373410, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/684a479ecdc16beb9c6ddd01073f2fee?s=128&d=identicon&r=PG", "display_name": "Pangu", "link": "https://stackoverflow.com/users/2373410/pangu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 48901081, "answer_count": 1, "score": 0, "last_activity_date": 1594637426, "creation_date": 1519199706, "last_edit_date": 1594637426, "question_id": 48900695, "link": "https://stackoverflow.com/questions/48900695/how-to-select-the-recently-added-record-in-the-listbox", "title": "How to select the recently added record in the listbox?", "body": "<p>First off, my question is <strong>not</strong> in regards to selecting the last added record in a <code>List Box</code>. That can be achieved using this:</p>\n\n<pre><code>Me.MyList.Selected(Me.MyList.ListCount - 1) = True\n</code></pre>\n\n<p>Basically, I have a <code>Form</code> with a <code>List Box</code> that is bounded to a table. Let's call this table <code>tblMyData</code>. In this table, I have 4 fields, lets call it <code>ID, FirstName, MiddleName, LastName</code>.</p>\n\n<p>I have 3 <code>Text Box</code> that corresponds to the appropriate <code>FirstName, MiddleName, and LastName</code> field values that can be entered.</p>\n\n<p>When the form loads up, the <code>List Box</code> queries the table for data and displays it appropriately.</p>\n\n<p>I've implemented the functionality to add the user input data to the <code>tblMyData</code> table:</p>\n\n<pre><code>Private Sub addRecord_Click()\n\n    CurrentDB.Execute \"INSERT INTO tblMyData (FirstName, MiddleName, LastName)\" _\n        &amp; \"VALUES ('\" &amp; Me.textBox_FirstName &amp; \"', '\" &amp; Me.textBox_MiddleName &amp; \"', '\" &amp; Me.textBox_LastName &amp; \"')\"\n\n    Me.MyList.Requery\n\nEnd Sub\n</code></pre>\n\n<p>The problem is that the <code>tblMyData</code> is sorted <strong>first</strong> by <code>FirstName</code>, <strong>then</strong> by <code>LastName</code>. Once the record has been added to the table and I call <code>Me.MyList.Requery</code>, <code>MyList</code> pulls the data from <code>tblMyData</code>, which is already sorted, including the <strong>newly</strong> added record.</p>\n\n<p>It would be difficult to know where that added record is if there are 1000s of records to scroll through in the list.</p>\n\n<p>Therefore, is there way to go about highlighting the row in the <code>List Box</code> containing that <strong>recently</strong> added record to ensure it has been added correctly?</p>\n\n<p>I would like to call it after <code>Me.MyList.Requery</code>.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519195232, "post_id": 48899432, "comment_id": 84804406, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/aa227579(v=vs.60).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa227579(v=vs.60).aspx</a>"}, {"owner": {"reputation": 569, "user_id": 9142561, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/2003968199891958/picture?type=large", "display_name": "nick318", "link": "https://stackoverflow.com/users/9142561/nick318"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519195237, "post_id": 48899432, "comment_id": 84804409, "body": "just inside a module. I did not find any type definition for SystemInfo, only initialization like new SystemInfo"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519195725, "post_id": 48899432, "comment_id": 84804635, "body": "What method was then used on this class? SysInfo.something... What was the something?"}, {"owner": {"reputation": 569, "user_id": 9142561, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/2003968199891958/picture?type=large", "display_name": "nick318", "link": "https://stackoverflow.com/users/9142561/nick318"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519195935, "post_id": 48899432, "comment_id": 84804737, "body": "@QHarr SysInfo.UserDetails"}, {"owner": {"reputation": 569, "user_id": 9142561, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/2003968199891958/picture?type=large", "display_name": "nick318", "link": "https://stackoverflow.com/users/9142561/nick318"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519197914, "post_id": 48899432, "comment_id": 84805693, "body": "I looked around, and yes you are right!"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1519195612, "creation_date": 1519195612, "answer_id": 48899715, "question_id": 48899432, "link": "https://stackoverflow.com/questions/48899432/systeminfo-explanation-in-vba/48899715#48899715", "title": "SystemInfo explanation in vba", "body": "<p>You will find more information on this by reading Chapter 9 of the VBA Developer's handbook</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/aa227582(v=vs.60).aspx\" rel=\"nofollow noreferrer\">VBA and System Information</a></p>\n\n<p>Using the <a href=\"https://msdn.microsoft.com/en-us/library/aa227579(v=vs.60).aspx\" rel=\"nofollow noreferrer\">SystemInfo Class</a></p>\n\n<p>There is little within VBA for getting system info. This primarily done through Windows API calls.</p>\n"}], "owner": {"reputation": 569, "user_id": 9142561, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/2003968199891958/picture?type=large", "display_name": "nick318", "link": "https://stackoverflow.com/users/9142561/nick318"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519197531, "creation_date": 1519194470, "last_edit_date": 1519197275, "question_id": 48899432, "link": "https://stackoverflow.com/questions/48899432/systeminfo-explanation-in-vba", "title": "SystemInfo explanation in vba", "body": "<p>In vba code I have following line:<br></p>\n\n<pre><code>Public SysInfo As SystemInfo\ndim details = SysInfo.UserDetails\n</code></pre>\n\n<p>I have no luck to find that SystemInfo class on google, could you help me to get description of the class?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1519194784, "post_id": 48899346, "comment_id": 84804219, "body": "Dude! I&#39;m not your research assistant. Get started on a solution and if you run into trouble, come back with a specific question. Failing that, hire a programmer. I suggest you read the link I provided and heed the advice given."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1519196031, "post_id": 48899346, "comment_id": 84804790, "body": "Did you try recording macro? This is how I studied VBA at first (sort of)."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1519196044, "post_id": 48899346, "comment_id": 84804795, "body": "It&#39;s always good to start with a tutorial."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 1, "creation_date": 1519196486, "post_id": 48899346, "comment_id": 84804999, "body": "You might be confused where to start, so I&#39;ll decompose this task for you. First you need to define your data range (calculate <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920\">last non empty cell</a> in column A and define your range). Then you need to sort it by columns A and B ascending, C descending. After that, figure out how to check for similiar values and merge these cells accordingly."}], "answers": [{"comments": [{"owner": {"reputation": 299, "user_id": 4527488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wn23p.png?s=128&g=1", "display_name": "Vipul Karkar", "link": "https://stackoverflow.com/users/4527488/vipul-karkar"}, "reply_to_user": {"reputation": 1, "user_id": 6772643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d2b1cfdf377a64eee4f7079b0e2e6bb?s=128&d=identicon&r=PG&f=1", "display_name": "agastyateja", "link": "https://stackoverflow.com/users/6772643/agastyateja"}, "edited": false, "score": 0, "creation_date": 1519216573, "post_id": 48903350, "comment_id": 84817805, "body": "Glad to help. If it helped you, please mark this question as Answered so it doesn&#39;t reflect in the list of &quot;Unanswered&quot; category."}], "tags": [], "owner": {"reputation": 299, "user_id": 4527488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wn23p.png?s=128&g=1", "display_name": "Vipul Karkar", "link": "https://stackoverflow.com/users/4527488/vipul-karkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1519208268, "creation_date": 1519208268, "answer_id": 48903350, "question_id": 48899346, "link": "https://stackoverflow.com/questions/48899346/excel-vba-automating-merge-and-centering-sorting/48903350#48903350", "title": "Excel VBA automating Merge and Centering, Sorting", "body": "<p>This code will help you what you have asked.</p>\n\n<pre><code>Sub MergeSameCells()\nDim Rng As Range\nDim xRows, lastRow As Integer\n\nlastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nRange(\"A2:C\" &amp; lastRow).Select\n\nWith ActiveWorkbook.ActiveSheet.Sort\n    With .SortFields\n    .Clear\n    .Add Key:=Range(\"A2:A\" &amp; lastRow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    .Add Key:=Range(\"B2:B\" &amp; lastRow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    .Add Key:=Range(\"C2:C\" &amp; lastRow), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\n    End With\n    .SetRange Range(\"A2:C\" &amp; lastRow)\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\nSet WorkRng = Range(\"A2:B\" &amp; lastRow)\nxRows = WorkRng.Rows.Count\n\nIf WorkRng Is Nothing Then Exit Sub\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nFor Each Rng In WorkRng.Columns\n    For i = 1 To xRows - 1\n        For j = i + 1 To xRows\n            If Rng.Cells(i, 1).Value &lt;&gt; Rng.Cells(j, 1).Value Then\n                Exit For\n            End If\n        Next\n        WorkRng.Parent.Range(Rng.Cells(i, 1), Rng.Cells(j - 1, 1)).Merge\n        i = j - 1\n    Next\nNext\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Try and let me know if it works.</p>\n"}], "owner": {"reputation": 1, "user_id": 6772643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d2b1cfdf377a64eee4f7079b0e2e6bb?s=128&d=identicon&r=PG&f=1", "display_name": "agastyateja", "link": "https://stackoverflow.com/users/6772643/agastyateja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1519208268, "creation_date": 1519194114, "last_edit_date": 1519195554, "question_id": 48899346, "link": "https://stackoverflow.com/questions/48899346/excel-vba-automating-merge-and-centering-sorting", "title": "Excel VBA automating Merge and Centering, Sorting", "body": "<p>I am trying to automate a report generation process in excel.\nSo, let me give you guys a background:-\nI have 3 columns in my datasheet:<br>\n<a href=\"https://i.stack.imgur.com/oIhK9.png\" rel=\"nofollow noreferrer\" title=\"Data Sheet\"><img src=\"https://i.stack.imgur.com/oIhK9.png\" alt=\"enter image description here\" title=\"Data Sheet\"></a></p>\n\n<p>Column A is manufacturing location</p>\n\n<p>Column B is Vehicle line</p>\n\n<p>Column C is Progress Update</p>\n\n<p>I trying to generate a report which merges and centers MFG Locations in Column A and the same time Merge and Centers Vehicle lines in that plant with Column B</p>\n\n<p>I am attaching a sample of the output I need. As of now , I am manually doing this process, I hope someone can guide me with automating this process</p>\n\n<p><a href=\"https://i.stack.imgur.com/JMfQs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JMfQs.png\" alt=\"Data Sheet and Output report required\"></a></p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1519190018, "post_id": 48898435, "comment_id": 84802523, "body": "You&#39;re getting a not defined error because you didn&#39;t declare <code>C1</code>."}, {"owner": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1519191080, "post_id": 48898435, "comment_id": 84802851, "body": "how it has to be declared?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1519191122, "post_id": 48898435, "comment_id": 84802869, "body": "It would be declared the same as <code>r1</code>, so in your case: <code>C1 As Range</code>. When using a <code>For Each...Next</code> statement, the two variables should be the same data type."}, {"owner": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1519191855, "post_id": 48898435, "comment_id": 84803130, "body": "i declared.. now it is not showing error. But no selected item is removed from the list box"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1519192183, "post_id": 48898435, "comment_id": 84803246, "body": "Your code appears to want to delete the row, not the listbox item. <code>C1.EntireRow.Delete</code> has nothing to do with the listbox. And why are you wanting to &quot;Bold&quot; <code>C1</code> when you are going to immediately delete it?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1519192444, "post_id": 48898435, "comment_id": 84803338, "body": "But you need to look into the <code>ListBox1.RemoveItem()</code> method."}, {"owner": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1519192679, "post_id": 48898435, "comment_id": 84803422, "body": "actually i need to select some values from list box..then if i click remove button it should remove from list box as well as the source column and it should move the column cells up...rowsource is ListBox1.RowSource = &quot;Sheet3!A2:A&quot; &amp; Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row"}], "answers": [{"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519198244, "post_id": 48899791, "comment_id": 84805884, "body": "which line is throwing it?"}, {"owner": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519198264, "post_id": 48899791, "comment_id": 84805898, "body": "debug took me to this line  .RemoveItem (iItem) &#39; remove selected item from the listbox"}, {"owner": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519198500, "post_id": 48899791, "comment_id": 84806011, "body": "how to delete only that specific cell and not the entire row? i have only single column data"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519198672, "post_id": 48899791, "comment_id": 84806107, "body": "I tested it with no issue, so may be it&#39;s related to some strange data values from other pieces of code. use Immediate Window (CTRL-G to pop it put while in the VBA IDE) and check your relevant variables (e.g.: type <code>?iItem</code> or <code>?Me.ListBox1.Count</code> and then press return) to see what&#39;s going on at that point"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519198776, "post_id": 48899791, "comment_id": 84806154, "body": "<i>&quot;how to delete only that specific cell and not the entire row?&quot;</i>  this seems not to be related with the error you say is thrown from <code>.RemoveItem (iItem)</code> code line. Do the variables checks as per my last comment and see what&#39;s happening"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519200702, "post_id": 48899791, "comment_id": 84807124, "body": "@qwww, any feedback?"}, {"owner": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519203345, "post_id": 48899791, "comment_id": 84808547, "body": "i ran it again..got same error..then i could see that the value of iItem was once 5, then it became 6 in next run,, then finally 2 in last run"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519203771, "post_id": 48899791, "comment_id": 84808802, "body": "<code>iItem </code> is being decremented by <code>iItem = iItem - 1 </code> line:  how can you have it pass from 5 to 6? you&#39;d better show the whole code"}, {"owner": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519206873, "post_id": 48899791, "comment_id": 84810911, "body": "it is getting removed... when i check the worksheet, i can see that removal is happening..but it is showing error...is it because the update listbox is not shown?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519214978, "post_id": 48899791, "comment_id": 84816702, "body": "when the error hist the line <code>.RemoveItem (iItem)</code>, click &quot;debug&quot; button and then typ the following in Immediate Window : <code>?Me.ListBox1.Count</code> and press return to see both if there&#39;s still some valid reference to the userform and its ListBox component and how many values there are left"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519279612, "post_id": 48899791, "comment_id": 84847624, "body": "Sorry, my mistake: you have to type : ?Me.ListBox1.ListCount"}, {"owner": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519280866, "post_id": 48899791, "comment_id": 84848111, "body": "how can i remove those items and show the updated listbox?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519283640, "post_id": 48899791, "comment_id": 84849386, "body": "to delete all elements from a list box named after <code>ListBox1</code> you simply use <code>Me.ListBox1.Clear</code>. If my answer solved your original question, please consider marking it as accepted. thank you"}, {"owner": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519292890, "post_id": 48899791, "comment_id": 84854638, "body": "no its not delete all elements..delete the selected elements, then show what is remaining"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519294119, "post_id": 48899791, "comment_id": 84855438, "body": "then use the code in my answer. in my test it worked so if you have issues it may be a matter of your actual scenario (data and its <i>structure</i>). you may then want to step thorugh the code: while in VBA IDE press F8 and step through each code line one by one, and query relevant variable state/value through Immediate Window (CTRL-G to pop it out)"}, {"owner": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519297181, "post_id": 48899791, "comment_id": 84857474, "body": "i did this and it took me to Sub UserForm_Initialize() Range(&quot;A2&quot;).Select End Sub this part and after end sub, it loaded the userform"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519301523, "post_id": 48899791, "comment_id": 84860299, "body": "so.. go on: fill userform with some sample data and click the wanted button. and then keep on stepping through your code and see what&#39;s happening"}, {"owner": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519301809, "post_id": 48899791, "comment_id": 84860478, "body": "now it showed error and took me to this line :  erow = &quot;Sheet3!A2:A&quot; &amp; Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row"}, {"owner": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "edited": false, "score": 0, "creation_date": 1519301878, "post_id": 48899791, "comment_id": 84860533, "body": "actually  &quot;Sheet3!A2:A&quot; &amp; Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row  this is the column from which my labels are to be created and the count of this column is the number of texboxes that has to be created. values have to be stored adjacebt to each"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1519196022, "creation_date": 1519196022, "answer_id": 48899791, "question_id": 48898435, "link": "https://stackoverflow.com/questions/48898435/how-to-delete-multiple-listbox-items-and-update-that-in-the-rowsource/48899791#48899791", "title": "How to delete multiple listbox items and update that in the rowsource?", "body": "<p>when deleting items from <code>Collections</code> (like rows in a <code>Range</code> o items in a <code>ListBox</code> are) you should proceed from bottom to top and avoid both skipping items and processing nonexistent ones</p>\n\n<p>like follows (explanations in comments)</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n    Dim r1 As Range\n    Dim iItem As Long, iRow As Long\n\n    With Sheet3 'reference Sheet3\n        Set r1 = .Range(\"A2:A\" &amp; .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row) ' set current data range\n    End With\n\n    With Me.ListBox1 'reference your list box\n        iItem = .ListCount - 1 ' start from last listbox item\n        Do\n            If .Selected(iItem) Then ' if current listbox item selected\n                For iRow = r1.Rows.Count To 1 Step -1 'loop through data range rows from bottom to top\n                    If r1.Cells(iRow).Value = .List(iItem) Then r1.Cells(iRow).EntireRow.Delete 'if current selected listbox index matches current data range cell value then delete this latter entire row\n                Next\n                .RemoveItem (iItem) ' remove selected item from the listbox\n            End If\n            iItem = iItem - 1 'update listbox item to the \"next\" one (i.e. the one above)\n        Loop While iItem &gt;= 0 ' loop till reaching first listbox item\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1087, "user_id": 9228407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2afa510ffdff9be4f0ab5d75256fd178?s=128&d=identicon&r=PG&f=1", "display_name": "qwww", "link": "https://stackoverflow.com/users/9228407/qwww"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1363, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1519204334, "creation_date": 1519189099, "last_edit_date": 1519204334, "question_id": 48898435, "link": "https://stackoverflow.com/questions/48898435/how-to-delete-multiple-listbox-items-and-update-that-in-the-rowsource", "title": "How to delete multiple listbox items and update that in the rowsource?", "body": "<p>I have a column that is updated dynamically using a text box. I am able to update the column using the text box and those values are updated in the list box. </p>\n\n<p>I tried to delete multiple data from list box. But it is showing me error.\nI need to get the data removed from list box as well as the worksheet column without and updating the column by removing the spaces and moving up.</p>\n\n<p>My data column that is used to feed data to list box is dynamic. Ending range is not fixed.</p>\n\n<p>I am getting a variable not defined error, if I make some tweaks I will get debug error or errors with codes</p>\n\n<p>My code :</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n Dim iItem As Long, iRow As Long\n\n    With Sheet3 'reference Sheet3\n        Set r1 = .Range(\"A2:A\" &amp; .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row) ' set current data range\n    End With\n\n    With Me.ListBox1 'reference your list box\n        iItem = .ListCount - 1 ' start from last listbox item\n        Do\n            If .Selected(iItem) Then ' if current listbox item selected\n                For iRow = r1.Rows.Count To 1 Step -1 'loop through data range rows from bottom to top\n                    If r1.Cells(iRow).Value = .List(iItem) Then r1.Cells(iRow).EntireRow.Delete 'if current selected listbox index matches current data range cell value then delete this latter entire row\n                Next\n                .RemoveItem (iItem) ' remove selected item from the listbox\n            End If\n            iItem = iItem - 1 'update listbox item to the \"next\" one (i.e. the one above)\n        Loop While iItem &gt;= 0 ' loop till reaching first listbox item\n    End With\nEnd Sub\n\nPrivate Sub ListBox1_Click()\n\nEnd Sub\n\nSub UserForm_Initialize()\nRange(\"A2\").Select\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\nIf TextBox1.Value = \"\" Then\n    MsgBox (\"Please Add the component name\")\n\nElse\n\n    ActiveCell = TextBox1.Value\n    ActiveCell.Offset(1, 0).Select\n\n    ListBox1.RowSource = \"Sheet3!A2:A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Call resetForm\n\n\nEnd If\nEnd Sub\n\nSub resetForm()\nTextBox1.Value = \"\"\nTextBox1.SetFocus\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 432, "user_id": 2391873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9813e629bb4baf25e0eb9d250bd38722?s=128&d=identicon&r=PG", "display_name": "Ejaz Ahmed", "link": "https://stackoverflow.com/users/2391873/ejaz-ahmed"}, "edited": false, "score": 0, "creation_date": 1519298005, "post_id": 48899852, "comment_id": 84857995, "body": "I want to control a user form in another instance of excel. Your code will position it based on the &quot;parent&quot; instance, not the instance in which the form was opened. Correct me if I am wrong."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 432, "user_id": 2391873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9813e629bb4baf25e0eb9d250bd38722?s=128&d=identicon&r=PG", "display_name": "Ejaz Ahmed", "link": "https://stackoverflow.com/users/2391873/ejaz-ahmed"}, "edited": false, "score": 0, "creation_date": 1519302679, "post_id": 48899852, "comment_id": 84861077, "body": "Actually I don&#39;t know since I never used such a feature. But should that be the case, you could store in a <code>Public</code> variable the application instance you want to refer to and then use it"}, {"owner": {"reputation": 432, "user_id": 2391873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9813e629bb4baf25e0eb9d250bd38722?s=128&d=identicon&r=PG", "display_name": "Ejaz Ahmed", "link": "https://stackoverflow.com/users/2391873/ejaz-ahmed"}, "edited": false, "score": 0, "creation_date": 1519302943, "post_id": 48899852, "comment_id": 84861270, "body": "I realise I can pass the form and the application to the sub. Thank you for giving me that idea. It&#39;d still be nice to somehow extract a reference to the application that created a form, from the form object itself."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 432, "user_id": 2391873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9813e629bb4baf25e0eb9d250bd38722?s=128&d=identicon&r=PG", "display_name": "Ejaz Ahmed", "link": "https://stackoverflow.com/users/2391873/ejaz-ahmed"}, "edited": false, "score": 0, "creation_date": 1519305957, "post_id": 48899852, "comment_id": 84863462, "body": "That latter I wouldn\u2019t know. But if you get it you\u2019d be welcome to post here. As for the very subject of your question if my answer solved it please consider marking as accepted. Thank you"}, {"owner": {"reputation": 432, "user_id": 2391873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9813e629bb4baf25e0eb9d250bd38722?s=128&d=identicon&r=PG", "display_name": "Ejaz Ahmed", "link": "https://stackoverflow.com/users/2391873/ejaz-ahmed"}, "edited": false, "score": 0, "creation_date": 1519310927, "post_id": 48899852, "comment_id": 84867182, "body": "I will wait for someone to suggest a way to extract the reference. I&#39;m up voting your answer now."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1519196302, "creation_date": 1519196302, "answer_id": 48899852, "question_id": 48898391, "link": "https://stackoverflow.com/questions/48898391/how-do-i-get-a-reference-to-the-application-object-of-a-userform/48899852#48899852", "title": "How do I get a reference to the Application object of a UserForm?", "body": "<p>in Excel the following works:</p>\n\n<pre><code>Sub PositionForm(WhichForm As Object)\n    WhichForm.Left = Application.Left\nEnd Sub\n</code></pre>\n\n<p>to be called from any UserForm code as:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\n   ... any code\n\n    PositionForm Me\n\n    ... any code\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 432, "user_id": 2391873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9813e629bb4baf25e0eb9d250bd38722?s=128&d=identicon&r=PG", "display_name": "Ejaz Ahmed", "link": "https://stackoverflow.com/users/2391873/ejaz-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519196302, "creation_date": 1519188779, "question_id": 48898391, "link": "https://stackoverflow.com/questions/48898391/how-do-i-get-a-reference-to-the-application-object-of-a-userform", "title": "How do I get a reference to the Application object of a UserForm?", "body": "<p>If I want to write a <code>Sub</code> that positions a <code>UserForm</code> relative to the <code>Application</code> object that displays it, How would I go about doing it?</p>\n\n<p>I want to write a sub that goes like this:</p>\n\n<pre><code>Sub PositionForm(WhichForm as Object)\nWhichForm.Left = &lt;WhichForm Application Object&gt;.Left\nEnd Sub\n</code></pre>\n\n<p>I understand that there are many workarounds to this. I am interested in knowing whether there is a way to getting that reference.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1470, "user_id": 1128648, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb464a864fb919f9b29294b23191d93f?s=128&d=identicon&r=PG", "display_name": "acr", "link": "https://stackoverflow.com/users/1128648/acr"}, "edited": false, "score": 0, "creation_date": 1519190856, "post_id": 48898511, "comment_id": 84802787, "body": "I may have more than 200 months of data and this will change for each run. So prefer to use VBA rather than adding formula"}, {"owner": {"reputation": 1470, "user_id": 1128648, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb464a864fb919f9b29294b23191d93f?s=128&d=identicon&r=PG", "display_name": "acr", "link": "https://stackoverflow.com/users/1128648/acr"}, "edited": false, "score": 1, "creation_date": 1519191974, "post_id": 48898511, "comment_id": 84803170, "body": "I am marking this answer. I was able to convert this into a VBA script and looped through all rows."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 1470, "user_id": 1128648, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb464a864fb919f9b29294b23191d93f?s=128&d=identicon&r=PG", "display_name": "acr", "link": "https://stackoverflow.com/users/1128648/acr"}, "edited": false, "score": 0, "creation_date": 1519197834, "post_id": 48898511, "comment_id": 84805655, "body": "Sorry for the late reply as I was away from the system. Well in that case, to implement the formula through VBA, you don&#39;t need to loop through the cells. You can apply the formula in column C at once."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 1470, "user_id": 1128648, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb464a864fb919f9b29294b23191d93f?s=128&d=identicon&r=PG", "display_name": "acr", "link": "https://stackoverflow.com/users/1128648/acr"}, "edited": false, "score": 0, "creation_date": 1519198350, "post_id": 48898511, "comment_id": 84805936, "body": "I have edited the solution and added the VBA code to implement the formula in column C. See if that helps."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 3, "last_activity_date": 1519198322, "last_edit_date": 1519198322, "creation_date": 1519189510, "answer_id": 48898511, "question_id": 48898135, "link": "https://stackoverflow.com/questions/48898135/sum-row-values-based-on-start-and-date-of-a-month-in-another-column/48898511#48898511", "title": "Sum row values based on start and date of a month in another column", "body": "<p>Why do you need VBA to get the desired output?</p>\n\n<p>You may use the formulas to achieve the desired output.</p>\n\n<p>Try this...</p>\n\n<p>In C2</p>\n\n<pre><code>=B2\n</code></pre>\n\n<p>In C3</p>\n\n<pre><code>=IF(MONTH(A3)&lt;&gt;MONTH(A2),B3,C2+B3)\n</code></pre>\n\n<p>and copy it down.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>If you want to implement the formula through VBA, you may try something like this...</p>\n\n<pre><code>Sub MonthInt()\n    Dim MaxGain As Workbook\n    Dim DailyData As Worksheet\n    Dim n As Long\n\n    Set MaxGain = Excel.Workbooks(\"MaxGain.xlsm\")\n    Set DailyData = MaxGain.Worksheets(\"DailyData\")\n\n    n = DailyData.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    With DailyData\n        .Range(\"C2\").Value = .Range(\"B2\").Value\n        .Range(\"C3:C\" &amp; n).Formula = \"=IF(MONTH(A3)&lt;&gt;MONTH(A2),B3,C2+B3)\"\n        .Range(\"C3:C\" &amp; n).Value = .Range(\"C3:C\" &amp; n).Value\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/7U025.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7U025.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1470, "user_id": 1128648, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fb464a864fb919f9b29294b23191d93f?s=128&d=identicon&r=PG", "display_name": "acr", "link": "https://stackoverflow.com/users/1128648/acr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "accepted_answer_id": 48898511, "answer_count": 1, "score": 4, "last_activity_date": 1519198322, "creation_date": 1519186966, "last_edit_date": 1519192404, "question_id": 48898135, "link": "https://stackoverflow.com/questions/48898135/sum-row-values-based-on-start-and-date-of-a-month-in-another-column", "title": "Sum row values based on start and date of a month in another column", "body": "<p>Attaching image for better understanding of question:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SjOLB.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SjOLB.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Here, Column A has dates, B has daily amount and C has the cumulative sum of each days.</p>\n\n<p>I want to stop the cumulative calculation at end of each month based on A column and start recalculating for next month. Just like shown in image.</p>\n\n<p>I am using below code to find the end of month and on first day of month assigning B=C, But confused how can I start calculating cumulative amount from next day onward for that month. </p>\n\n<p>Appreciate if someone provide me a logic to achieve this.</p>\n\n<pre><code>Sub MonthInt()\n\n    Dim MaxGain As Workbook\n    Dim DailyData As Worksheet\n    Dim n As Long, J As Long\n\n    Set MaxGain = Excel.Workbooks(\"MaxGain.xlsm\")\n    Set DailyData = MaxGain.Worksheets(\"DailyData\")\n\n\n   n = DailyData.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n\n   DailyData.Range(\"B2\") = DailyData.Range(\"C2\")\n\n   For J = 3 To n\n\n   If DailyData.Range(\"A\" &amp; J) = Application.WorksheetFunction.EoMonth(DailyData.Range(\"A\" &amp; J), 0) Then\n\n   DailyData.Range(\"C\" &amp; J + 1) = DailyData.Range(\"B\" &amp; J)\n\n\n   End If\n\n    Next\n   End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "worksheet", "intersect"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1519187551, "last_edit_date": 1519187551, "creation_date": 1519186937, "answer_id": 48898129, "question_id": 48898113, "link": "https://stackoverflow.com/questions/48898113/trying-to-run-a-worksheet-change-event-twice/48898129#48898129", "title": "Trying to run a worksheet change event twice", "body": "<p>Just expand the range you set to the A variable.</p>\n\n<pre><code>Set A = Range(\"A:A, I:I\")\n</code></pre>\n\n<p>Rewritten as,</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    if not intersect(range(\"A:A, I:I\"), target) is nothing then\n        'add error control\n        on error goto safe_exit\n        'don't do anything until you know something has to be done\n        dim r as range\n        Application.EnableEvents = False\n        For Each r In intersect(range(\"A:A, I:I\"), target)\n            r.Offset(0, 1).Value = Date   'do you want Date or Now?\n        Next r\n    end if\nsafe_exit:\n    Application.EnableEvents = True \nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 9388203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KkpJeuzghqM/AAAAAAAAAAI/AAAAAAAAAGg/TqFMewNXkoI/photo.jpg?sz=128", "display_name": "Edwin Skalla II", "link": "https://stackoverflow.com/users/9388203/edwin-skalla-ii"}, "edited": false, "score": 0, "creation_date": 1519236616, "post_id": 48899948, "comment_id": 84831741, "body": "Hmmm, one thing that i have ntocied is thislogic is applied even if all i am doing is &quot;deleting&quot; the information in the target range, which happens to be columns A and I. Is there a way to prevent this from happening? This is only a slight nuisance but would only make things easier for users who interface with my spreadsheet im making. Again, thank you"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 25, "user_id": 9388203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KkpJeuzghqM/AAAAAAAAAAI/AAAAAAAAAGg/TqFMewNXkoI/photo.jpg?sz=128", "display_name": "Edwin Skalla II", "link": "https://stackoverflow.com/users/9388203/edwin-skalla-ii"}, "edited": false, "score": 0, "creation_date": 1519237328, "post_id": 48899948, "comment_id": 84832065, "body": "@EdwinSkallaII, see edited answer. if it solves your question you may consider marking it as accepted. thank you"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1519237298, "last_edit_date": 1519237298, "creation_date": 1519196764, "answer_id": 48899948, "question_id": 48898113, "link": "https://stackoverflow.com/questions/48898113/trying-to-run-a-worksheet-change-event-twice/48899948#48899948", "title": "Trying to run a worksheet change event twice", "body": "<p>edited after OP's comment</p>\n\n<p>expanding on @Jeeped solution, you can avoid looping:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim rng As Range\n\n    Set rng = Intersect(Range(\"A:A, I:I\"), Target) ' define range of interest\n    If Not rng Is Nothing Then ' check it's not \"nothing\"\n        If WorksheetFunction.CountA(rng) = rng.Count Then 'check for all of its cells being not empty\n            On Error GoTo safe_exit 'add error control\n            Application.EnableEvents = False 'don't do anything until you know something has to be done\n            rng.Offset(, 1).Value = Date 'write Date next to all relevant changed cells\n        End If\n    End If\n\nsafe_exit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9388203, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KkpJeuzghqM/AAAAAAAAAAI/AAAAAAAAAGg/TqFMewNXkoI/photo.jpg?sz=128", "display_name": "Edwin Skalla II", "link": "https://stackoverflow.com/users/9388203/edwin-skalla-ii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "accepted_answer_id": 48899948, "answer_count": 2, "score": 2, "last_activity_date": 1519237298, "creation_date": 1519186779, "last_edit_date": 1519187392, "question_id": 48898113, "link": "https://stackoverflow.com/questions/48898113/trying-to-run-a-worksheet-change-event-twice", "title": "Trying to run a worksheet change event twice", "body": "<p>I am trying to run this worksheet change event for two different columns(A) and (I)...</p>\n\n<pre><code>    Private Sub Worksheet_Change(ByVal Target As Range)\n        Dim A As Range, B As Range, Inte As Range, r As Range\n        Set A = Range(\"A:A\")\n        Set Inte = Intersect(A, Target)\n        If Inte Is Nothing Then Exit Sub\n        Application.EnableEvents = False\n            For Each r In Inte\n                r.Offset(0, 1).Value = Date\n            Next r\n        Application.EnableEvents = True \n    End Sub\n</code></pre>\n\n<p>This event is something i found on this forum. Its purpose is to make it so whenever data is ever entered into column \"a\" it auto inputs the date into the cell directly right of it. I want this to happen twice on the worksheet. I can't figure out how to change/add to it. I am trying to get it to run the logic for column A and I on my spreadsheet.</p>\n"}, {"tags": ["sql", "vba", "ms-access", "ms-access-2016"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1519182122, "post_id": 48897382, "comment_id": 84800656, "body": "Use VBA to manipulate a recordset object and in looping structure read each record of the recordset."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1519185687, "post_id": 48897382, "comment_id": 84801395, "body": "is this a &quot;one-time thing&quot;, to make a reference table? (If yes, I would suggest creating your list manually in Excel.)   Or would this be run regularly?  (If so, what is it accomplishing, and surely the output table needs more than one field?)"}], "answers": [{"tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 2, "last_activity_date": 1519197769, "creation_date": 1519197769, "answer_id": 48900193, "question_id": 48897382, "link": "https://stackoverflow.com/questions/48897382/split-string-separated-by-commas-in-access/48900193#48900193", "title": "Split string separated by commas in access", "body": "<p>Create an <code>Append</code> query with a single parameter, the word to be imported. The query's source SQL should be something like this:</p>\n\n<pre><code>PARAMETERS [prmWord] Text (50);\nINSERT INTO T ( Words )\nSELECT [prmWord] AS _Word;\n</code></pre>\n\n<p>Where <code>T</code> is the name of your Table (master) and <code>Words</code> is the name of the Field.</p>\n\n<p>Then just loop through the Partnerships recordset, split the value and import each word using the above query.</p>\n\n<pre><code>Sub SplitAndImport()\n    On Error GoTo ErrorTrap\n\n    Dim rs As DAO.Recordset\n    Set rs = CurrentDb().OpenRecordset(\"SELECT Partnerships FROM tblPartnerships;\", dbOpenSnapshot)\n    With rs\n        If .EOF Then GoTo Leave\n        .MoveLast\n        .MoveFirst\n    End With\n\n    Dim arr As Variant\n    Dim i As Long, ii As Long\n    For i = 1 To rs.RecordCount\n        arr = Split(rs![Partnerships], \",\")\n        For ii = LBound(arr) To UBound(arr)\n            With CurrentDb().QueryDefs(\"QueryName\")\n                .Parameters(\"[prmWord]\").Value = Trim(arr(ii))\n                .Execute dbFailOnError\n            End With\n        Next\n        rs.MoveNext\n    Next\n\nLeave:\n    If Not rs Is Nothing Then rs.Close\n    On Error GoTo 0\n    Exit Sub\n\nErrorTrap:\n    MsgBox Err.Description, vbCritical\n    Resume Leave\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 146, "user_id": 5528758, "user_type": "registered", "profile_image": "https://graph.facebook.com/1009569782419677/picture?type=large", "display_name": "Salman Saleh", "link": "https://stackoverflow.com/users/5528758/salman-saleh"}, "is_accepted": false, "score": 0, "last_activity_date": 1615659555, "creation_date": 1615659555, "answer_id": 66617023, "question_id": 48897382, "link": "https://stackoverflow.com/questions/48897382/split-string-separated-by-commas-in-access/66617023#66617023", "title": "Split string separated by commas in access", "body": "<p>This may not work as accurately with your current database design.\nYou may try using multivalued fields. Later, if you want view multi values each on single row then use &quot;AssignedTo&quot; command.</p>\n<pre><code>SELECT [title], [lcs].[AssignedTo].[value] AS Expr1\nFROM Product;\n</code></pre>\n<p>Where lcs is a multivalued field and title is a text field.</p>\n"}], "owner": {"reputation": 107, "user_id": 8319935, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ecbc7a0e85e9e069765594ae08aa717e?s=128&d=identicon&r=PG&f=1", "display_name": "Anup", "link": "https://stackoverflow.com/users/8319935/anup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2405, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1615659555, "creation_date": 1519180845, "question_id": 48897382, "link": "https://stackoverflow.com/questions/48897382/split-string-separated-by-commas-in-access", "title": "Split string separated by commas in access", "body": "<p>I have a table tblPartnerships structured as<br>\nID &nbsp;&nbsp;&nbsp;&nbsp; Partnerships<br>\n1&nbsp;&nbsp;&nbsp;&nbsp; Finance, IT, Operations<br>\n2&nbsp;&nbsp;&nbsp;&nbsp; Legal, Compliance, IT, HR  </p>\n\n<p>I need to extract all of the comma separated keywords from Partnerships column and put it in another mastertable  with each word as a separate row so that it shows up as </p>\n\n<p>Finance<br>\nIT<br>\nOperations<br>\nLegal<br>\nCompliance<br>\nIT<br>\nHR</p>\n\n<p>I know there is a split function such as varList = Split(stTmp, \",\") but i am completely lost how to iterate through the entire column tblPartnerships.Partnerships insert it into MasterTable.Rowheading<br>\nAny Access query or vba code will be highly appreciated</p>\n"}, {"tags": ["excel", "vba", "dynamic", "cell", "worksheet"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1519181133, "post_id": 48897305, "comment_id": 84800409, "body": "I was going to vote-to-close this question as a typographical error but after  some thought, decided to let it stand. You can mark this as &#39;the answer&#39; in a day or so. Kudos for figuring it out yourself."}], "tags": [], "owner": {"reputation": 41, "user_id": 8999284, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f4c62653280e186b7a8081a8f858578c?s=128&d=identicon&r=PG&f=1", "display_name": "Manu221", "link": "https://stackoverflow.com/users/8999284/manu221"}, "is_accepted": false, "score": 1, "last_activity_date": 1519180244, "creation_date": 1519180244, "answer_id": 48897305, "question_id": 48897283, "link": "https://stackoverflow.com/questions/48897283/dynamically-calculating-values-when-cell-changes-vba/48897305#48897305", "title": "Dynamically Calculating Values when cell changes VBA", "body": "<p>Sorry I figured it out. I was running it under <code>Private Sub Worksheet_SelectionChange(ByVal target As Range)</code> rather than <code>Private Sub Worksheet_Change(ByVal target As Range)</code></p>\n"}], "owner": {"reputation": 41, "user_id": 8999284, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f4c62653280e186b7a8081a8f858578c?s=128&d=identicon&r=PG&f=1", "display_name": "Manu221", "link": "https://stackoverflow.com/users/8999284/manu221"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1519180244, "creation_date": 1519180113, "question_id": 48897283, "link": "https://stackoverflow.com/questions/48897283/dynamically-calculating-values-when-cell-changes-vba", "title": "Dynamically Calculating Values when cell changes VBA", "body": "<p>So I am running a spread sheet that has a live data feed of stock prices. \nI have written this into the worksheet so that when the price updates, the value of the position updates and calculates the new total value of the portfolio. </p>\n\n<p>So I have 5 main headings being Players, Stock Code, Units, Current Price, Value. </p>\n\n<p>Now this code works, but partially. When the price updates, it doesn't automatically update the value unless I go back and forth from the cell. </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal target As Range)\nDim i As Integer, j As Integer, m As Integer, t As Integer\nDim firstrow As Integer, lastrow As Integer\nDim fr As Integer, lr As Integer, lr2 As Integer\nDim sum As Double\nDim name As Range, stock As Range, value As Range, units As Range, cp As Range\n\nWith ActiveSheet.Range(\"A:Z\")\n\n    Set stock = .find(what:=\"Stock Code\", After:=.Cells(.Cells.count), LookIn:=xlValues, _\n                Lookat:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\n    Set value = .find(what:=\"Value\", After:=.Cells(.Cells.count), LookIn:=xlValues, _\n                Lookat:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\n    Set name = .find(what:=\"Players\", After:=.Cells(.Cells.count), LookIn:=xlValues, _\n                Lookat:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\n    Set units = .find(what:=\"Units\", After:=.Cells(.Cells.count), LookIn:=xlValues, _\n                Lookat:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\n    Set cp = .find(what:=\"Current Price\", After:=.Cells(.Cells.count), LookIn:=xlValues, _\n                Lookat:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\n\n    fr = stock.Row + 1\n    lr = .Cells(.Rows.count, stock.Column).End(xlUp).Row\n\n    If Cells(name.Row + 1, name.Column) = \"\" Then\n        End\n    End If\n\n    For i = fr To lr\n\n'checks to ensure that there is a player in the spreadsheet\n        If Cells(i, name.Column) &lt;&gt; \"\" Then\n         m = i\n        End If\n\n'each player has a total row. The word Total identifies the last row for a player\n        For j = m To lr\n            If Cells(j, stock.Column) = \"TOTAL\" Then\n                lr2 = j\n                Exit For\n            End If\n        Next j\n\n'checks the range where there are stock codes in the sheet, and when the current price updates it\n                If Not Intersect(target, target.Worksheet.Range(.Cells(m, cp.Column), .Cells((lr2 - 1), cp.Column))) Is Nothing Then\n                    For t = m To (lr2 - 1)\n                        Cells(t, value.Column) = Cells(t, cp.Column) * Cells(t, units.Column)\n                    Next t\n                End If\n\n'checks to see if there has been a change in the value column for each stock and recalculates the new total\n            sum = 0\n                If Not Intersect(target, target.Worksheet.Range(.Cells(m, value.Column), .Cells((lr2 - 1), value.Column))) Is Nothing Then\n                    For t = m To (lr2 - 1)\n                        sum = sum + Cells(t, value.Column)\n                    Next t\n                    Cells(lr, value.Column) = sum\n                End If\n\n    Next i\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I'm just not sure why when the current price updates, i need to go into the value cell and out again before it actually updates. </p>\n\n<p>Appreciate any feedback. </p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 4740, "user_id": 1148564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eQICm.jpg?s=128&g=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/1148564/joseph"}, "edited": false, "score": 0, "creation_date": 1519180192, "post_id": 48897271, "comment_id": 84800179, "body": "Does the issue usually happen when the list is just one item?"}, {"owner": {"reputation": 31, "user_id": 9388688, "user_type": "registered", "profile_image": "https://graph.facebook.com/1799421180081207/picture?type=large", "display_name": "Shane Harris", "link": "https://stackoverflow.com/users/9388688/shane-harris"}, "reply_to_user": {"reputation": 4740, "user_id": 1148564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eQICm.jpg?s=128&g=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/1148564/joseph"}, "edited": false, "score": 0, "creation_date": 1519180710, "post_id": 48897271, "comment_id": 84800294, "body": "No, this does not seem to impact it."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1519186367, "post_id": 48897271, "comment_id": 84801574, "body": "How many documents are we talking about?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1519186911, "post_id": 48897271, "comment_id": 84801696, "body": "...also, I&#39;m surprised no one else asked: <b><i>what software is generating these documents?</i></b> (Why not fix the <i>source</i> of the problem?)"}, {"owner": {"reputation": 31, "user_id": 9388688, "user_type": "registered", "profile_image": "https://graph.facebook.com/1799421180081207/picture?type=large", "display_name": "Shane Harris", "link": "https://stackoverflow.com/users/9388688/shane-harris"}, "edited": false, "score": 0, "creation_date": 1519188798, "post_id": 48897271, "comment_id": 84802158, "body": "Hi ashleedawg, This is on one document at a time. Getting fixed from the software end has been an ongoing battle long before my time and is just not going to happen. We have been told of other users who apply their own macros to solve the problems and am hoping we can do the same to greatly improve productivity."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9388688, "user_type": "registered", "profile_image": "https://graph.facebook.com/1799421180081207/picture?type=large", "display_name": "Shane Harris", "link": "https://stackoverflow.com/users/9388688/shane-harris"}, "edited": false, "score": 0, "creation_date": 1519189020, "post_id": 48898022, "comment_id": 84802217, "body": "Thank you Racil Hilan, this is perfect!!!!! Worked amazingly!!! I have spent hours trying to solve this. Very much appreciated.!!!!"}, {"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "edited": false, "score": 1, "creation_date": 1519203927, "post_id": 48898022, "comment_id": 84808883, "body": "If this has solved your problem please consider accepting it as answer."}], "tags": [], "owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "is_accepted": false, "score": 2, "last_activity_date": 1519186112, "creation_date": 1519186112, "answer_id": 48898022, "question_id": 48897271, "link": "https://stackoverflow.com/questions/48897271/vba-code-not-exiting-list-ms-word/48898022#48898022", "title": "VBA code not exiting list (MS Word)", "body": "<p>According to the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa223009(v=office.11).aspx\" rel=\"nofollow noreferrer\">MSDN</a>:</p>\n\n<blockquote>\n  <p><strong>List Object:</strong> Represents a single list format that's been applied to specified paragraphs in a document.</p>\n</blockquote>\n\n<p>So if you have more than one list with some non-bulleted paragraph(s) in the middle, the <code>Range</code> will start with the first item of the first list and end with the last item of the last list including all non-bulleted paragraph(s) in the middle.</p>\n\n<p>To fix this issue, you need to separate the lists (right-click on the bullet and select <strong>Separate List</strong>). However, you mentioned that the document was generated by some software, so that is probably not an option. In that case, you will have to iterate though the paragraphs of the <code>Range</code> of each <code>List</code> and check if it has a <code>ListFormat.ListTemplate</code> which indicates that it is a list item, otherwise it is a non-bulleted paragraph:</p>\n\n<pre><code>Sub Paragraph()\n    ActiveDocument.Range.ParagraphFormat.SpaceAfter = 0\n    ActiveDocument.Range.ParagraphFormat.SpaceBefore = 0\n\n    Dim li As Word.List\n    Dim p As Paragraph\n\n    For Each li In ActiveDocument.Lists\n        For Each p In li.Range.Paragraphs\n            If Not p.Range.ListFormat.ListTemplate Is Nothing Then\n                p.Range.ParagraphFormat.SpaceBefore = 3\n                p.Range.ParagraphFormat.SpaceAfter = 3\n                p.Range.HighlightColorIndex = wdYellow\n            End If\n        Next p\n    Next li\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": false, "score": 0, "last_activity_date": 1519188635, "creation_date": 1519188635, "answer_id": 48898375, "question_id": 48897271, "link": "https://stackoverflow.com/questions/48897271/vba-code-not-exiting-list-ms-word/48898375#48898375", "title": "VBA code not exiting list (MS Word)", "body": "<p>Even before touching VBA:</p>\n\n<ul>\n<li>Use Styles in the document.</li>\n<li>Limit the use of Styles in the document to only those that are in the\ntemplate.</li>\n<li>Set your spacing in the Styles.</li>\n</ul>\n\n<p>If, at some stage, you change your mind and want to use <code>6pt</code> spacing, you can adjust the template and re-apply it, rather than finding all the VBA code and re-writing it. Not only that, but by using Styles, you can avoid having VBA code, or having VBA-enabled documents which may interfere with some corporate security settings.</p>\n\n<p>Oh, and set up your corporate structure to limit the use of templates to only the approved ones.</p>\n"}], "owner": {"reputation": 31, "user_id": 9388688, "user_type": "registered", "profile_image": "https://graph.facebook.com/1799421180081207/picture?type=large", "display_name": "Shane Harris", "link": "https://stackoverflow.com/users/9388688/shane-harris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1519189064, "creation_date": 1519180027, "last_edit_date": 1519182462, "question_id": 48897271, "link": "https://stackoverflow.com/questions/48897271/vba-code-not-exiting-list-ms-word", "title": "VBA code not exiting list (MS Word)", "body": "<p>Writing a macro to automatically fix paraphrase spacing issues in MS Word docs generated from software we use.</p>\n\n<p><strong>Goal:</strong></p>\n\n<ul>\n<li>All standard paragraphs have <code>0pt</code> before and after spacing.</li>\n<li>All bullet lists have <code>3pt</code> before and after spacing.</li>\n</ul>\n\n<p><strong>Progress:</strong><br />\nCurrently I have a function that sets the entire document to <code>0pt</code>, then looks through for all lists and changes them to <code>3pt</code>. (currently also have a highlight on so I can easily see what is being treated as a list).</p>\n\n<p>It works great on some parts, but on other parts (I assume based on how the software we use generates the document), the list doesn't exist and it will continue to format blocks of text and heading to <code>3pt</code> when it is not wanted (see attached images).</p>\n\n<p>Current code is:</p>\n\n<pre><code>Sub Paragraph()\n    ActiveDocument.Range.ParagraphFormat.SpaceAfter = 0\n    ActiveDocument.Range.ParagraphFormat.SpaceBefore = 0\n\n    Dim li As Word.list\n\n    For Each li In ActiveDocument.lists\n            li.Range.ParagraphFormat.SpaceBefore = 3\n            li.Range.ParagraphFormat.SpaceAfter = 3\n            li.Range.HighlightColorIndex = wdYellow\n    Next li\nEnd Sub\n</code></pre>\n\n<p><strong>Working:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/8dN7i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8dN7i.png\" alt=\"Working\"></a></p>\n\n<p><strong>Not working:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/URc4X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/URc4X.png\" alt=\"Not working\"></a></p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 8190828, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/51c31b40e579fc794f5b51b3632b9746?s=128&d=identicon&r=PG&f=1", "display_name": "linktheory", "link": "https://stackoverflow.com/users/8190828/linktheory"}, "edited": false, "score": 0, "creation_date": 1519230050, "post_id": 48897439, "comment_id": 84827523, "body": "I get an error: &quot;Compile Error: User-defined type not defined.&quot; on this part of the code:   &#39;Dim wdDoc As Word.Document&#39;  Do I need to add any particular reference in VBA to allow this code to work?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 361, "user_id": 8190828, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/51c31b40e579fc794f5b51b3632b9746?s=128&d=identicon&r=PG&f=1", "display_name": "linktheory", "link": "https://stackoverflow.com/users/8190828/linktheory"}, "edited": false, "score": 2, "creation_date": 1519248740, "post_id": 48897439, "comment_id": 84838090, "body": "@linktheory Yes, you will have to add reference to <code>Microsoft Word xx.x Object Library</code>."}, {"owner": {"reputation": 361, "user_id": 8190828, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/51c31b40e579fc794f5b51b3632b9746?s=128&d=identicon&r=PG&f=1", "display_name": "linktheory", "link": "https://stackoverflow.com/users/8190828/linktheory"}, "edited": false, "score": 0, "creation_date": 1519249998, "post_id": 48897439, "comment_id": 84838677, "body": "@0m3r Is there a way to keep the image and still allow content (text, etc.) to be present in the body of the e-mail?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 361, "user_id": 8190828, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/51c31b40e579fc794f5b51b3632b9746?s=128&d=identicon&r=PG&f=1", "display_name": "linktheory", "link": "https://stackoverflow.com/users/8190828/linktheory"}, "edited": false, "score": 1, "creation_date": 1519252603, "post_id": 48897439, "comment_id": 84839827, "body": "@linktheory Yes, you will have to set the destination on the <a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/range-object-word\" rel=\"nofollow noreferrer\"><code>Range Method</code></a>"}, {"owner": {"reputation": 361, "user_id": 8190828, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/51c31b40e579fc794f5b51b3632b9746?s=128&d=identicon&r=PG&f=1", "display_name": "linktheory", "link": "https://stackoverflow.com/users/8190828/linktheory"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1519253054, "post_id": 48897439, "comment_id": 84839996, "body": "@L42 are you saying range.body(\u201cbody of text\u201d)? This is still new to me so I am not entirely sure where this would be placed."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 361, "user_id": 8190828, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/51c31b40e579fc794f5b51b3632b9746?s=128&d=identicon&r=PG&f=1", "display_name": "linktheory", "link": "https://stackoverflow.com/users/8190828/linktheory"}, "edited": false, "score": 1, "creation_date": 1519255192, "post_id": 48897439, "comment_id": 84840762, "body": "@linktheory Try <code>wdDoc.Range.InsertAfter &quot;Hello 0m3r&quot;</code> after <code>wdDoc.Range.PasteAndFormat Type:=wdChartPicture</code> look at this answer <a href=\"https://stackoverflow.com/a/42662697/4539709\">stackoverflow.com/a/42662697/4539709</a> the benefit of adding reference to Outlook Library is you will have access to all Word Objects - you may wanna post new question and we will help fix it- thanks"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 361, "user_id": 8190828, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/51c31b40e579fc794f5b51b3632b9746?s=128&d=identicon&r=PG&f=1", "display_name": "linktheory", "link": "https://stackoverflow.com/users/8190828/linktheory"}, "edited": false, "score": 0, "creation_date": 1520230198, "post_id": 48897439, "comment_id": 85213872, "body": "@linktheory see here another example using Paragraphs <a href=\"https://stackoverflow.com/a/49104427/4539709\">stackoverflow.com/a/49104427/4539709</a>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1608572113, "post_id": 48897439, "comment_id": 115619119, "body": "@Om3r - if you ever get bored, here is another <a href=\"https://stackoverflow.com/q/65396620/6706419\">email question</a> that I think would be of interest. You seem to provide best solutions relating to Outlook so figured id share with you. I was able to provide a workaround solution but curious if you know the actual problem"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 5, "last_activity_date": 1519181282, "creation_date": 1519181282, "answer_id": 48897439, "question_id": 48896499, "link": "https://stackoverflow.com/questions/48896499/copy-excel-range-as-picture-to-outlook/48897439#48897439", "title": "Copy Excel range as Picture to Outlook", "body": "<p><em>To get better picture on Outlook, work with <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/mailitem-getinspector-property-outlook\" rel=\"noreferrer\">Word object model with MailItem.GetInspector Property (Outlook)</a></em></p>\n\n<p><em>Example</em></p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim rng As Range\n    Dim olApp As Object\n    Dim Email As Object\n    Dim Sht As Excel.Worksheet\n    Dim wdDoc As Word.Document\n\n    Set Sht = ActiveWorkbook.Sheets(\"Dashboard\")\n    Set rng = Sht.Range(\"B4:L17\")\n        rng.CopyPicture Appearance:=xlScreen, Format:=xlPicture\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    Set olApp = CreateObject(\"Outlook.Application\")\n    Set Email = olApp.CreateItem(0)\n    Set wdDoc = Email.GetInspector.WordEditor\n\n    With Email\n        .To = \"\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"\"\n        .Attachments.Add ActiveWorkbook.FullName\n\n         wdDoc.Range.PasteAndFormat Type:=wdChartPicture\n\n'        if need setup inlineshapes hight &amp; width\n         With wdDoc\n            .InlineShapes(1).Height = 130\n         End With\n\n        .Display\n    End With\n\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\n    Set Email = Nothing\n    Set olApp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 1, "last_activity_date": 1519182189, "last_edit_date": 1519182189, "creation_date": 1519181460, "answer_id": 48897463, "question_id": 48896499, "link": "https://stackoverflow.com/questions/48896499/copy-excel-range-as-picture-to-outlook/48897463#48897463", "title": "Copy Excel range as Picture to Outlook", "body": "<p>Something like this should work:</p>\n\n<pre><code>Dim ol As Object 'Outlook.Application\nDim olEmail As Object 'Outlook.MailItem\nDim olInsp As Object 'Outlook.Inspector\nDim wd As Object 'Word.Document\n\nSheets(\"Dashboard\").Range(\"B4:L17\").SpecialCells(xlCellTypeVisible).Copy\n\nSet ol = GetObject(, \"Outlook.Application\") '/* if outlook is running, create otherwise */\nSet olEmail = ol.CreateItem(0) 'olMailItem\n\nWith olEmail\n    Set olInsp = .GetInspector\n    If olInsp.EditorType = 4 Then 'olEditorWord\n        Set wd = olInsp.WordEditor\n        wd.Range.PasteAndFormat 13 'wdChartPicture\n    End If\n    .Display\nEnd With\n</code></pre>\n\n<p>If sure that your version of Outlook uses Word Editor, you can do it like:</p>\n\n<pre><code>With olEmail\n    .GetInspector.WordEditor.Range.PasteAndFormat 13\n    .Display\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11269228, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/e342d2022ef1cc97c05fb654401dcae0?s=128&d=identicon&r=PG", "display_name": "AskDNA", "link": "https://stackoverflow.com/users/11269228/askdna"}, "is_accepted": false, "score": 1, "last_activity_date": 1553732484, "last_edit_date": 1553732484, "creation_date": 1553730700, "answer_id": 55388185, "question_id": 48896499, "link": "https://stackoverflow.com/questions/48896499/copy-excel-range-as-picture-to-outlook/55388185#55388185", "title": "Copy Excel range as Picture to Outlook", "body": "<p>If you want to add Text, use this code.</p>\n\n<pre><code>Dim ol As Object 'Outlook.Application\nDim olEmail As Object 'Outlook.MailItem\nDim olInsp As Object 'Outlook.Inspector\nDim wd As Object 'Word.Document\n\nSheets(\"Dashboard\").Range(\"B4:L17\").SpecialCells(xlCellTypeVisible).Copy\n\nSet ol = GetObject(, \"Outlook.Application\") '/* if outlook is running, create otherwise */\nSet olEmail = ol.CreateItem(0) 'olMailItem\n\nWith olEmail\n    Set olInsp = .GetInspector\n    If olInsp.EditorType = 4 Then 'olEditorWord\n        Set wd = olInsp.WordEditor\n        wd.Range.PasteAndFormat 13 'wdChartPicture\n    End If\n\n    wd.Paragraphs(1).Range.InsertAfter \"Hi, There\" &amp; Chr(10)\n\n    Sheets(\"chart\").Range(\"B4:L17\").SpecialCells(xlCellTypeVisible).Copy\n    wd.Paragraphs(wd.Paragraphs.Count).Range.Characters.First.PasteAndFormat 13\n    wd.Paragraphs.Add\n\n    Sheets(\"chart\").Range(\"B4:L17\").SpecialCells(xlCellTypeVisible).Copy\n    wd.Paragraphs(wd.Paragraphs.Count).Range.Characters.First.PasteAndFormat 13\n    wd.Paragraphs.Add\n\n    wd.Paragraphs(wd.Paragraphs.Count).Range.InsertAfter Chr(10) &amp; Chr(10) &amp; \"BR\"\n\n    .Display\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 361, "user_id": 8190828, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/51c31b40e579fc794f5b51b3632b9746?s=128&d=identicon&r=PG&f=1", "display_name": "linktheory", "link": "https://stackoverflow.com/users/8190828/linktheory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11045, "favorite_count": 2, "accepted_answer_id": 48897439, "answer_count": 3, "score": 5, "last_activity_date": 1592694831, "creation_date": 1519173679, "last_edit_date": 1592694831, "question_id": 48896499, "link": "https://stackoverflow.com/questions/48896499/copy-excel-range-as-picture-to-outlook", "title": "Copy Excel range as Picture to Outlook", "body": "<p>How can I use the command \"Paste Special - As Picture\" that you access in Excel from the right-click menu?</p>\n\n<p>I have viewed various posts, but they seem to be outdated when using Excel 2016. It seems it has to be in this section, </p>\n\n<pre><code>With TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    .Cells(1).PasteSpecial xlPasteValues, , False, False\n    .Cells(1).PasteSpecial xlPasteFormats, , False, False\n    .Cells(1).Select\n</code></pre>\n\n<p>How do I alter to allow copy and paste as picture?</p>\n\n<p>When using the original code below, I lose all column and row sizing in the email body.</p>\n\n<pre><code>Dim rng As Range\nDim OutApp As Object\nDim outMail As Object\n\nSet rng = Nothing\n' Only send the visible cells in the selection.\n\nSet rng = Sheets(\"Dashboard\").Range(\"B4:L17\").SpecialCells(xlCellTypeVisible)\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet outMail = OutApp.CreateItem(0)\n\nWith outMail\n    .To = \"\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"\"\n    .HTMLBody = RangetoHTML(rng)\n    .Display\nEnd With\nOn Error GoTo 0\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\n\nSet outMail = Nothing\nSet OutApp = Nothing\nEnd Sub\n\n\nFunction RangetoHTML(rng As Range)\n' By Ron de Bruin.\n    Dim fso As Object\n    Dim ts As Object\n    Dim TempFile As String\n    Dim TempWB As Workbook\n\n    TempFile = Environ$(\"temp\") &amp; \"/\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n    'Copy the range and create a new workbook to past the data in\n    rng.Copy\n    Set TempWB = Workbooks.Add(1)\n    With TempWB.Sheets(1)\n        .Cells(1).PasteSpecial Paste:=8\n        .Cells(1).PasteSpecial xlPasteValues, , False, False\n        .Cells(1).PasteSpecial xlPasteFormats, , False, False\n        .Cells(1).Select\n        Application.CutCopyMode = False\n        On Error Resume Next\n        .DrawingObjects.Visible = True\n        .DrawingObjects.Delete\n        On Error GoTo 0\n    End With\n\n    'Publish the sheet to a htm file\n    With TempWB.PublishObjects.Add( _\n         SourceType:=xlSourceRange, _\n         Filename:=TempFile, _\n         Sheet:=TempWB.Sheets(1).Name, _\n         Source:=TempWB.Sheets(1).UsedRange.Address, _\n         HtmlType:=xlHtmlStatic)\n        .Publish (True)\n    End With\n\n    'Read all data from the htm file into RangetoHTML\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\n    RangetoHTML = ts.ReadAll\n    ts.Close\n    RangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                          \"align=left x:publishsource=\")\n\n    'Close TempWB\n    TempWB.Close savechanges:=False\n\n    'Delete the htm file we used in this function\n    Kill TempFile\n\n    Set ts = Nothing\n    Set fso = Nothing\n    Set TempWB = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "vbscript", "excel-formula"], "comments": [{"owner": {"reputation": 1762, "user_id": 3661120, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2945ed0aa05dd03ab9ebbc5f33668360?s=128&d=identicon&r=PG&f=1", "display_name": "dashnick", "link": "https://stackoverflow.com/users/3661120/dashnick"}, "edited": false, "score": 1, "creation_date": 1519174398, "post_id": 48896460, "comment_id": 84798866, "body": "Try using the <code>TimeSerial()</code> function as here <a href=\"http://www.ozgrid.com/VBA/autofilter-date-times.htm\" rel=\"nofollow noreferrer\">ozgrid.com/VBA/autofilter-date-times.htm</a>.  I think the issue is somehow with the date construction as a string.  Also, changing to OR basically makes it catch everything I think."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1519174433, "post_id": 48896460, "comment_id": 84798878, "body": "What does it say in the formula bar when you select a cell containing <code>2018-02-16T00:00:20.488Z[UTC]</code> ?"}, {"owner": {"reputation": 121, "user_id": 2764522, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/048c297de0a951cb6d927353ac784a34?s=128&d=identicon&r=PG&f=1", "display_name": "Raa", "link": "https://stackoverflow.com/users/2764522/raa"}, "edited": false, "score": 0, "creation_date": 1519176186, "post_id": 48896460, "comment_id": 84799291, "body": "Nothing. Same content is displayed."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1519178414, "post_id": 48896460, "comment_id": 84799802, "body": "Are you planning to convert the strings-that-look-like-datetimes anywhere in the near future?"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 2764522, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/048c297de0a951cb6d927353ac784a34?s=128&d=identicon&r=PG&f=1", "display_name": "Raa", "link": "https://stackoverflow.com/users/2764522/raa"}, "edited": false, "score": 0, "creation_date": 1519770842, "post_id": 48897317, "comment_id": 85043308, "body": "Sorry for late reply. Thank you @Jeeped."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1519180331, "last_edit_date": 1592644375, "creation_date": 1519180331, "answer_id": 48897317, "question_id": 48896460, "link": "https://stackoverflow.com/questions/48896460/excel-apply-filter-for-select-multiple-minutes-in-vba/48897317#48897317", "title": "Excel Apply filter for select multiple minutes in VBA", "body": "<blockquote>\n<p>Column has Date with Hours &amp; minutes (Ex:2018-02-16T00:00:20.488Z[UTC]).</p>\n</blockquote>\n<p>No, it does not. You have a column with a bunch of strings that represent coded date, time and timezone information; something like a Twitter feed timestamp. In order to deal with the pieces as real dates and real times (optionally offset to the local timezone) you will have to parse out the information.</p>\n<p>It is probably best to parse and convert the strings-that-look-like-datetimes to actual datetimes\u00b9 before you do any further work but you can run through the strings, parsing to true datetimes on-the-fly and collect matching strings in a dictionary. The dictionary's key values can be used as an array to filter the time column.</p>\n<p><a href=\"https://i.stack.imgur.com/m7rqy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m7rqy.png\" alt=\"enter image description here\" /></a></p>\n<pre><code>Option Explicit\n\n\nSub reqwews()\n    Dim dict As Object, k As Long, sr As Variant\n    Dim str As String, tmp As Variant\n    Dim sdt As Long, stm As Double, tm As Double, mns As Long\n    \n    Set dict = CreateObject(&quot;scripting.dictionary&quot;)\n    dict.CompareMode = vbBinaryCompare\n    \n    With Worksheets(&quot;sheet12&quot;)\n        sdt = .Cells(9, &quot;E&quot;).Value2\n        stm = .Cells(9, &quot;F&quot;).Value2\n        mns = .Cells(9, &quot;G&quot;).Value2\n        sr = Application.Match(Format(sdt, &quot;yyyy-mm-dd\\T&quot;) &amp; Chr(42), .Columns(&quot;A&quot;), 0)\n        If IsError(sr) Then Exit Sub\n    \n        For k = sr To .Cells(.Rows.Count, &quot;A&quot;).End(xlUp).Row\n            str = .Cells(k, &quot;A&quot;).Value2\n            If DateValue(CStr(Split(str, Chr(84))(0))) = sdt Then\n                tm = TimeValue(Left(Split(str, Chr(84))(1), 8))\n                If tm &gt;= stm And tm &lt; (stm + TimeSerial(0, mns, 0)) Then\n                    dict.Item(str) = DateValue(CStr(Split(str, Chr(84))(0))) + _\n                                     TimeValue(Left(Split(str, Chr(84))(1), 8))\n                ElseIf tm &gt;= (stm + TimeSerial(0, mns, 0)) Then\n                    'if the datetimes are in ascending order there is no point in going further\n                    Exit For\n                End If\n            ElseIf DateValue(CStr(Split(str, Chr(84))(0))) &gt; sdt Then\n                'if the datetimes are in ascending order there is no point in going further\n                Exit For\n            End If\n        Next k\n        \n        If CBool(dict.Count) Then\n            If .AutoFilterMode Then .AutoFilterMode = False\n            With .Cells(1, &quot;A&quot;).CurrentRegion\n                .AutoFilter field:=1, Criteria1:=dict.keys, Operator:=xlFilterValues\n                With .Resize(.Rows.Count - 1, .Columns.Count).Offset(1, 0)\n                    If CBool(Application.Subtotal(103, .Cells)) Then\n                        'do something with filtered cells\n                        .SpecialCells(xlCellTypeVisible).Select\n                    End If\n                End With\n            End With\n            'If .AutoFilterMode Then .AutoFilterMode = False\n        End If\n    \n    End With\nEnd Sub\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/uZUX3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uZUX3.png\" alt=\"enter image description here\" /></a></p>\n<p>\u00b9 <sub>All the code needed to parse your strings-that-look-like-datetimes to actual datetimes in in the above. I just haven't written the real datetimes back to the worksheet.</sub></p>\n"}], "owner": {"reputation": 121, "user_id": 2764522, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/048c297de0a951cb6d927353ac784a34?s=128&d=identicon&r=PG&f=1", "display_name": "Raa", "link": "https://stackoverflow.com/users/2764522/raa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519181607, "creation_date": 1519173369, "last_edit_date": 1519181607, "question_id": 48896460, "link": "https://stackoverflow.com/questions/48896460/excel-apply-filter-for-select-multiple-minutes-in-vba", "title": "Excel Apply filter for select multiple minutes in VBA", "body": "<p>Column has Date with Hours &amp; minutes <code>(Ex:2018-02-16T00:00:20.488Z[UTC])</code>. I want to Filter data every 30 minutes using VBA. </p>\n\n<p>For Ex, first iteration should give me all data between 00:00 to 00:30 minutes of data. I tried the below code;</p>\n\n<pre><code>Dim t As String\nt = \"T0\"\ncnt = 4\n\nFor n = 1 To 23\n    ActiveSheet.Range(\"$A$1:$P$1000000\").AutoFilter Field:=2, Criteria1:= _\n    \"&gt;=\" &amp; FromTime &amp; t &amp; n &amp; \":00\", Operator:=xlAnd, Criteria2:=\" &lt;= \" &amp; FromTime &amp; t &amp; n &amp; \":30\"\nNext n\n</code></pre>\n\n<p>When ran, filter will be applied see image</p>\n\n<p><a href=\"https://i.stack.imgur.com/2miZs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2miZs.png\" alt=\"enter image description here\"></a>. </p>\n\n<p>Data will not be filtered. However, manually if i change from And to Or I get all relevant data.</p>\n\n<p>What is wrong with my Code?</p>\n"}, {"tags": ["vba", "excel", "dictionary", "watch"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1519176846, "creation_date": 1519176846, "answer_id": 48896896, "question_id": 48896394, "link": "https://stackoverflow.com/questions/48896394/dictionary-exists-returning-different-values-for-variable-and-constant-key/48896896#48896896", "title": "Dictionary.Exists Returning Different Values for Variable and Constant Key", "body": "<p>Can't replicate here - on the first pass though the loop all three Exists watch values are false. </p>\n\n<p>What other watches do you have set though? It's possible another watch is altering the <code>Exists</code> result: you need to be careful with the watch window when using a Dictionary object. </p>\n\n<p>E.g. see:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/48437731/dictionary-is-populated-with-an-empty-item-after-checking-dictionary-item-in-wat\">Dictionary is populated with an empty item after checking dictionary item in watch window</a></p>\n\n<p>EDIT: as suspected, after adding a watch on </p>\n\n<pre><code>dColLenFreqs.Item(lColLen) \n</code></pre>\n\n<p>the watch on </p>\n\n<pre><code>dColLenFreqs.Exists(lColLen) \n</code></pre>\n\n<p>now outputs True.</p>\n\n<p>If you delete all your watches and just look at the Debug output you'll also see it's as expected.</p>\n"}], "owner": {"reputation": 168, "user_id": 3953471, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85150069b1f4ba0583cbbf979e8e32c7?s=128&d=identicon&r=PG&f=1", "display_name": "nateAtwork", "link": "https://stackoverflow.com/users/3953471/nateatwork"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 694, "favorite_count": 0, "closed_date": 1519177138, "accepted_answer_id": 48896896, "answer_count": 1, "score": 2, "last_activity_date": 1603815255, "creation_date": 1519172733, "last_edit_date": 1603815255, "question_id": 48896394, "link": "https://stackoverflow.com/questions/48896394/dictionary-exists-returning-different-values-for-variable-and-constant-key", "closed_reason": "Duplicate", "title": "Dictionary.Exists Returning Different Values for Variable and Constant Key", "body": "<p>I've been using MS Scripting Runtime Library dictionaries as my goto data structure for the VBA project I'm currently working on, and I just ran into a frustrating issue that is making me think that they might not really be as good as I thought they were.  The <code>.Exists</code> method seems like a very useful method, but I get some weird behavior when I try to use it inside a For loop:</p>\n<pre><code>Sub TestExists()\nDim i As Long\nDim dRowsInEachCol As Dictionary\nSet dRowsInEachCol = New Dictionary\n\nDim lColLen As Long, lColLenFreq As Long\n\nFor i = 0 To 100\n    dRowsInEachCol.Add i, i\nNext\n\nDim dColLenFreqs As Dictionary\nFor i = 0 To dRowsInEachCol.Count - 1\n        \n    lColLen = dRowsInEachCol.Items()(i)\n    \n    If i = 0 Then\n        Set dColLenFreqs = New Dictionary\n    End If\n    Debug.Print dColLenFreqs.Exists(0), _\n                dColLenFreqs.Exists(1), _\n                dColLenFreqs.Exists(lColLen)\n                \n    If dColLenFreqs.Exists(lColLen) Then\n         lColLenFreq = dColLenFreqs.Item(lColLen) + 1\n    Else\n        lColLenFreq = 1\n    End If\n    \n'        'This will add a new item to dUniqColLengths _\n'            w/ key = column length, or overwrite item w/ _\n'            new column number if that key exists already _\n'            (INTENDED result is unique col lengths only in dict):\n    dColLenFreqs.Item(lColLen) = lColLenFreq\nNext\nEnd Sub\n</code></pre>\n<p>First, there seems to be a key without an item that is added implicitly when I create the dictionary <a href=\"https://stackoverflow.com/questions/11400898/dictionary-object-adding-items-before-add-is-called\">(similar to the issue in this question)</a>.  But I can't just accept that issue for what it is and work around it, because I actually get different result for the Exists method when I check <code>lColLen</code> compared to a constant with the same value as <code>lColLen</code>.  This is the state of the watch window right after the line <code>Set dColLenFreqs = New Dictionary</code> has been executed:\n<a href=\"https://i.stack.imgur.com/MUi3m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MUi3m.png\" alt=\"How could this watch window be possible ever?\" /></a></p>\n<p>I have tried switching to late binding and fully qualifying my dictionary variable declarations and this did not fix the issue.</p>\n<p>In case it's relevant, the purpose of the function is to take a dictionary input (dRowsInEachCol is the intended input, but I modified to create the dictionary within the function to eliminate this as the issue and shorten the code), and return a dictionary with the unique items in dRowsInEachCol as the keys, and the frequency of each unique item in dRowsInEachCol as the items.</p>\n<p>I would like to know:</p>\n<ol>\n<li>Is this just a bug in the Scripting.Dictionary object, or am I missing something?</li>\n<li>If it is a bug in the Scripting.Dictionary object, what workarounds are available?  I have read about mac-compatible dictionary classes <a href=\"https://sysmod.wordpress.com/2011/11/02/dictionary-class-in-vba-instead-of-scripting-dictionary/\" rel=\"nofollow noreferrer\">like this one</a> and <a href=\"https://github.com/VBA-tools/VBA-Dictionary\" rel=\"nofollow noreferrer\">this one</a>, but I'm worried these would cause other glitches. Are these fears founded? Another idea would be to just switch to temporary excel ranges or collections and arrays, possibly wrapped in a class. I'm open to other suggestions as well.</li>\n</ol>\n<p><a href=\"https://stackoverflow.com/questions/21049114/vba-dictionary-existskey-method-always-true\">This previous question</a> also seems somewhat related to my issue and might be useful for reference.</p>\n<p><strong>Edit wrt Duplicate:</strong> This was marked as duplicate because of <a href=\"https://stackoverflow.com/questions/48437731/dictionary-is-populated-with-an-empty-item-after-checking-dictionary-item-in-wat\">this question</a>, and after reading the answer by Tim Williams, I can see why these questions are related, although the other question is different because it assumes Tim Williams's answer, and then asks why.  I don't really have anything to add to my question to differentiate it further, and I agree that having a link to the other question is a helpful, but if someone is having the same issue as me and doesn't realize that it was caused by the watch window, they will be much more likely to find this question in their search results.</p>\n"}, {"tags": ["excel", "split", "match", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519210751, "post_id": 48895881, "comment_id": 84813835, "body": "&quot;my Sud&quot;? It doesn&#39;t find e.g. CDPH. What is it finding that you think it shouldn&#39;t. It&#39;s pretty hard to tell just using a message box to see what is found though."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519210934, "post_id": 48895881, "comment_id": 84813960, "body": "Btw your function seems redundant."}], "owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519219461, "creation_date": 1519169420, "last_edit_date": 1531164843, "question_id": 48895881, "link": "https://stackoverflow.com/questions/48895881/split-cell-value-on-comma-and-match-ins-elements-to-a-list", "title": "Split cell value on comma and match ins elements to a list", "body": "<p>I am trying to split cell values on a comma when they exit in col A of sheet Orgs</p>\n\n<p>And then I want to match the elements of the split cell to a list of values in column A on sheet Orgs_Helper</p>\n\n<p>But my Sud always says there is a match even though that cant be true</p>\n\n<p>Thanks</p>\n\n<p>Orgs Sheet Looks Like:</p>\n\n<pre><code>ColA\nMaryland Community Health Resources Commission\nBaltimore City Schools\n\n\nCDPH\nDPSS, DMH\nAlex\nDHS, DPH, DPSS, LASD\nLos Angeles Sherrif Dept, Whole Person Care, Housing for Health, Office of \nImmigrant Affairs\nLAC+USC Medical Center\n\nMiddlesex Sheriff's Office\n\nBehavioral Health Systems Baltimore\nNIH\n</code></pre>\n\n<p>Orgs_Helper looks like</p>\n\n<pre><code>ColAor\nAACP\nAlex\nBaltimore City Schools\nBehavioral Health Systems Baltimore\nBoys and Girls Club\nDepartment of Health\nDepartment of Labor\nDepartment of Social Services\nHOPWA\nHousing Authority\nHousing for Health\nHUD\nJustice System\nLAC+USC Medical Center\nLASD\nLos Angeles Sherrif Dept\n</code></pre>\n\n<p>What I have so far\n    Sub FindReplace_DilimCellValues()\n    Dim G As Variant\n    Dim wsFV As Worksheet, wsRV As Worksheet\n    Dim sLR As Long, tLR As Long, i As Long, n As Long</p>\n\n<pre><code>Set wsFV = ThisWorkbook.Worksheets(\"Orgs\")\nSet wsRV = ThisWorkbook.Worksheets(\"Orgs_Helper\")\n\nsLR = wsFV.Range(\"A\" &amp; wsFV.Rows.Count).End(xlUp).Row\ntLR = wsRV.Range(\"A\" &amp; wsRV.Rows.Count).End(xlUp).Row\n\n    For i = 2 To sLR\n\n      G = Split(wsFV.Cells(i, 1).value, \", \")\n      For n = LBound(G) To UBound(G)\n            If Not IsError(Application.Match(splitCell(wsFV.Cells(i, 1).value, \", \", n), wsRV.Range(\"A2:A\" &amp; tLR), 0)) Then\n              MsgBox \"Match found\"\n\n          End If\n       Next n\n\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Helper Function:</p>\n\n<pre><code>Function splitCell(strValue As String, delim As String, n As Long) As String\n\n  If strValue &lt;&gt; \"\" Then\n   splitCell = Split(strValue, delim)(n)\n Else\n   strValue = \"\"\n End If\n</code></pre>\n\n<p>End Function</p>\n"}, {"tags": ["excel", "vba", "numbers", "move"], "comments": [{"owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1519169118, "post_id": 48895757, "comment_id": 84797432, "body": "Is there always going to be one space before the number at the end of each address? For example, will <i>Street</i> always have one space after it before the house number?"}, {"owner": {"reputation": 3, "user_id": 2120000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee595f48b0119f6112d7ef5584ee2602?s=128&d=identicon&r=PG", "display_name": "Liamc3000", "link": "https://stackoverflow.com/users/2120000/liamc3000"}, "reply_to_user": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1519169484, "post_id": 48895757, "comment_id": 84797536, "body": "yes, the formatting will be consistent in that respect"}, {"owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1519492619, "post_id": 48895757, "comment_id": 84936767, "body": "Did you ever get an answer to your question?"}], "answers": [{"tags": [], "owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "is_accepted": false, "score": 0, "last_activity_date": 1519171504, "creation_date": 1519171504, "answer_id": 48896222, "question_id": 48895757, "link": "https://stackoverflow.com/questions/48895757/excel-retrieve-number-from-end-of-cell-and-move-to-start/48896222#48896222", "title": "Excel - Retrieve number from end of cell and move to start", "body": "<p>It's <em>incredibly</em> convoluted, but one way you could go about this is to use the following formula to get what you're looking for:</p>\n\n<pre><code>=RIGHT(SUBSTITUTE($A2,\" \",\"/\",LEN($A2)-LEN(SUBSTITUTE($A2,\" \",\"\"))),LEN($A2)-SEARCH(\"/\",SUBSTITUTE($A2,\" \",\"/\",LEN($A2)-LEN(SUBSTITUTE($A2,\" \",\"\")))))&amp;\" \"&amp;LEFT(SUBSTITUTE($A2,\" \",\"/\",LEN($A2)-LEN(SUBSTITUTE($A2,\" \",\"\"))),SEARCH(\"/\",SUBSTITUTE($A2,\" \",\"/\",LEN($A2)-LEN(SUBSTITUTE($A2,\" \",\"\"))))-1)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/qBPEO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qBPEO.png\" alt=\"enter image description here\"></a></p>\n\n<p>Personally, I would assign the following part to a <em>defined name</em> and use that in the formula instead:</p>\n\n<p><code>SUBSTITUTE($A2,\" \",\"/\",LEN($A2)-LEN(SUBSTITUTE($A2,\" \",\"\")))</code></p>\n\n<p>Doing so would just make it a lot easier to read.</p>\n"}, {"tags": [], "owner": {"reputation": 369, "user_id": 5477223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zEaP8.jpg?s=128&g=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/5477223/jan"}, "is_accepted": false, "score": 0, "last_activity_date": 1519171897, "creation_date": 1519171897, "answer_id": 48896293, "question_id": 48895757, "link": "https://stackoverflow.com/questions/48895757/excel-retrieve-number-from-end-of-cell-and-move-to-start/48896293#48896293", "title": "Excel - Retrieve number from end of cell and move to start", "body": "<p>You might not have the numbers at the end of each cell to search.  Here's a formula that checks the last five characters for a space and if none will leave the cell alone else will swap what's found.</p>\n\n<p>=IF(IFERROR(FIND(\" \",MID(A2,LEN(A2) -5,50)),0)=0,A2,MID(A2,LEN(A2) - (FIND(\" \",MID(A2,LEN(A2) -5,50)) -1),40) &amp; \" \" &amp; MID(A2,1,LEN(A2) - FIND(\" \",MID(A2,LEN(A2) -5,50))))</p>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1519197896, "creation_date": 1519197896, "answer_id": 48900222, "question_id": 48895757, "link": "https://stackoverflow.com/questions/48895757/excel-retrieve-number-from-end-of-cell-and-move-to-start/48900222#48900222", "title": "Excel - Retrieve number from end of cell and move to start", "body": "<p>a VBA solution:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim cell As Range\n    Dim element As Variant\n\n    With Worksheets(\"MySheetName\") ' change \"MySheetName\" to your actual sheet name\n        For Each cell In .Range(\"A1:A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row) ' loop through columns A cells from row 1 down to last not empty one\n            For Each element In Split(cell.value, \" \") 'loop through current cell content string \"elements\" separated by spaces\n                If IsNumeric(element) Then ' if current element is a \"numeric\" one\n                    cell.value = element &amp; \" \" &amp; Replace(cell.value, element, \"\") 'move element at the beginning of the cell content\n                    Exit For\n                End If\n            Next\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 2120000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee595f48b0119f6112d7ef5584ee2602?s=128&d=identicon&r=PG", "display_name": "Liamc3000", "link": "https://stackoverflow.com/users/2120000/liamc3000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1519197896, "creation_date": 1519168566, "question_id": 48895757, "link": "https://stackoverflow.com/questions/48895757/excel-retrieve-number-from-end-of-cell-and-move-to-start", "title": "Excel - Retrieve number from end of cell and move to start", "body": "<p>I have an outputted excel table that has addresses in single cells in one column but the house number is at the end of the cell value. </p>\n\n<pre><code>AAA Street 10\nBBB Street 11\n</code></pre>\n\n<p>Is there a script that if a cell contains a number it will grab this number and place it at the start of the cell so it looks like:</p>\n\n<pre><code>10 AAA Street\n11 BBB Steet\n</code></pre>\n\n<p>I have a system that generates this information into address labels but my countries postal service requires the number at the start.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1519168403, "post_id": 48895714, "comment_id": 84797209, "body": "Please put the code in the Post as text and not a picture."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 4392011, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NxQlI.png?s=128&g=1", "display_name": "TKE-439", "link": "https://stackoverflow.com/users/4392011/tke-439"}, "edited": false, "score": 0, "creation_date": 1519223303, "post_id": 48895771, "comment_id": 84822551, "body": "Perfect.  Thank you and sorry for the original code format."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1519168657, "creation_date": 1519168657, "answer_id": 48895771, "question_id": 48895714, "link": "https://stackoverflow.com/questions/48895714/vba-format-cells-based-on-another-sheet/48895771#48895771", "title": "VBA Format Cells based on another sheet", "body": "<p><code>lastcol</code> is a number not a letter and Range, when using strings, expects letters.</p>\n\n<p>Change to Cells():</p>\n\n<pre><code>sht.Cells(i,lastcol-3).Value = Application.WorksheetFunction.Sum(sht.Range(sht.Cells(i,7),sht.Cells(i,lastcol-4)))\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 4392011, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NxQlI.png?s=128&g=1", "display_name": "TKE-439", "link": "https://stackoverflow.com/users/4392011/tke-439"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 48895771, "answer_count": 1, "score": 0, "last_activity_date": 1519168657, "creation_date": 1519168325, "question_id": 48895714, "link": "https://stackoverflow.com/questions/48895714/vba-format-cells-based-on-another-sheet", "title": "VBA Format Cells based on another sheet", "body": "<p>I am needing to add a variable range, per row starting in G2 (always) and carrying through the lastrow/lastcol -4 and then subtracting the value in the D column for each row &amp; entering that result in lastcol-3.  I've pieced this code together from other codes, and never used function.Sum, so I may be way off. \n Here is what I currently have for my code:\n<a href=\"https://i.stack.imgur.com/aGrch.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aGrch.jpg\" alt=\"Current Code\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 8599843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1de3fe1790d8576483922c1605d49d5?s=128&d=identicon&r=PG&f=1", "display_name": "Loveburner", "link": "https://stackoverflow.com/users/8599843/loveburner"}, "edited": false, "score": 0, "creation_date": 1519228013, "post_id": 48904833, "comment_id": 84825982, "body": "Actually the always on top checkbox works very well, and adds value to the module since the user then can control how the window should behaive. Maybee I&#39;ll add an option for the user to select the default behavour as well."}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": true, "score": 0, "last_activity_date": 1519212752, "creation_date": 1519212752, "answer_id": 48904833, "question_id": 48895670, "link": "https://stackoverflow.com/questions/48895670/put-userform-on-top-allow-user-to-hide-it/48904833#48904833", "title": "put userform on top, allow user to hide it", "body": "<p>Unfortunately this is the designated behaviour of windows and applications. However, I can suggest some workarounds: </p>\n\n<ol>\n<li>Use TOPMOST option and make the userform clickable, e.g. capture the ProgressForm_Click and toggle between TOPMOST and NOTOPMOST state. ALternatively use can employ an \"Always On Top\" checkbox on ProgressForm like it is in the Task Manager. </li>\n<li>Use TOP option and resize the workbook window behind to as small as possible, or even move aside (out of the screen), and restore size and position after the external app finished. </li>\n<li>It may be worthy making a try with ProgressForm.Show(vbModeless) and TOP</li>\n</ol>\n"}], "owner": {"reputation": 37, "user_id": 8599843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1de3fe1790d8576483922c1605d49d5?s=128&d=identicon&r=PG&f=1", "display_name": "Loveburner", "link": "https://stackoverflow.com/users/8599843/loveburner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 48904833, "answer_count": 1, "score": 1, "last_activity_date": 1519212752, "creation_date": 1519168013, "last_edit_date": 1531164843, "question_id": 48895670, "link": "https://stackoverflow.com/questions/48895670/put-userform-on-top-allow-user-to-hide-it", "title": "put userform on top, allow user to hide it", "body": "<p>I have an excel vba application that runs a separate process. During the external process a progress indicator with abort button is initialized. It is crucial for the end users that the abort button is available. It is also usefull to see the external process running.</p>\n\n<p>I would like to have the progress indicator/abort button placed on top of the external process. but I do NOT wont to force the userform on top of everything.</p>\n\n<p>I have tried to use findwindow / setwindowpos, resulting in the following problems:</p>\n\n<p>If I initialize HWND_TOPMOST before running the process, then the userform is always on top, regardless of what the user wants. I find this very annoying, especially if some sort of errors occur where the debuging window might be blocked by the inactive vba userform. However the workbook remains in the background which is desired.</p>\n\n<p>If I use HWND_TOP (after the external process is up and running) then the entire workbook is activated (not just the userform), which then hides to progress of the external application. Not very benificial compared to activating the workbook.</p>\n\n<p>Are there any suggestions on how to put the userform in front of the external applicaiton, while still allowing the user to deactivate it?</p>\n\n<p>code snippets:</p>\n\n<pre><code>Option Explicit\n\n' Code stolen with pride from various sources.\nPrivate Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\nPrivate Declare Function BringWindowToTop Lib \"user32\" (ByVal hwnd As Long) As Long\nPrivate Declare Function SetForegroundWindow Lib \"user32\" (ByVal hwnd As Long) As Long\nPrivate Declare Function SetWindowPos Lib \"user32\" ( _\n                    ByVal hwnd As Long, _\n                    ByVal hWndInsertAfter As Long, _\n                    ByVal X As Long, _\n                    ByVal Y As Long, _\n                    ByVal cx As Long, _\n                    ByVal cy As Long, _\n                    ByVal wFlags As Long) As Long\n\nPublic Const SWP_NOMOVE = &amp;H2\nPublic Const SWP_NOSIZE = &amp;H1\n\nPublic Const HWND_TOP = 0\nPublic Const HWND_BOTTOM = 1\nPublic Const HWND_TOPMOST = -1\nPublic Const HWND_NOTOPMOST = -2\n\nPublic id As Integer\nPublic ProgressForm As fProgress\n\n' Main routine, launch application and progress indicator.\nSub LoadForm()\n\n    Set ProgressForm = New fProgress\n    ProgressForm.Show\n\n    ' Force userform to front, makes it on top but does not allow reorder of windows.\n    ForceToFront ProgressForm\n\n    ' Run external process, notepad used for example.\n    id = Shell(\"notepad\", vbNormalFocus)\n\nEnd Sub\n\n\n' Routine to bring userform to front after the external program is up and running.\nSub TestBringToFront()\n    BringToFront ProgressForm\nEnd Sub\n\nSub BringToFront(fm As fProgress)\n    Dim hwnd As Long, ret As Variant\n    hwnd = FindWindow(\"ThunderDFrame\", fm.Caption)\n    ret = SetWindowPos(hwnd, HWND_TOP, 0, 0, 0, 0, SWP_NOMOVE Or SWP_NOSIZE)\nEnd Sub\n\nSub ForceToFront(fm As fProgress)\n    Dim hwnd As Long, ret As Variant\n    hwnd = FindWindow(\"ThunderDFrame\", fm.Caption)\n    ret = SetWindowPos(hwnd, HWND_TOPMOST, 0, 0, 0, 0, SWP_NOMOVE Or SWP_NOSIZE)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1519166965, "post_id": 48895419, "comment_id": 84796740, "body": "What happens when that first formula is evaluated? BTW it&#39;s usually a good idea to use the <code>Worksheet.Evaluate</code> form, which you can scope to a specific worksheet, and not the <code>Application.Evaluate</code> version which defaults to the ActiveSheet."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1519167166, "post_id": 48895419, "comment_id": 84796813, "body": "Why do you need to <code>Evaluate</code> the formulas? don&#39;t the cells contain the value you need?"}, {"owner": {"reputation": 1041, "user_id": 1811159, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/JBmj0.png?s=128&g=1", "display_name": "Nicholas Humphrey", "link": "https://stackoverflow.com/users/1811159/nicholas-humphrey"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519167173, "post_id": 48895419, "comment_id": 84796816, "body": "@TimWilliams Sorry I forgot to mention that I got a #REF error. I checked the worksheet and $D$2 does exist."}, {"owner": {"reputation": 1041, "user_id": 1811159, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/JBmj0.png?s=128&g=1", "display_name": "Nicholas Humphrey", "link": "https://stackoverflow.com/users/1811159/nicholas-humphrey"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1519167277, "post_id": 48895419, "comment_id": 84796858, "body": "@Mat&#39;sMug It&#39;s a bit complicated. My cells actually contain formula, not text, because I need to fill down the whole sheet. So in the cell you will see something like = &quot;=&quot; &amp; &quot;&#39;&quot; &amp; $H98 &amp; $I98 &amp; $E98 &amp; &quot;&#39;!&quot; &amp; &quot;$D$2&quot;, this will produce a text and will then be evaluated with the EVALUATE() formula. I&#39;ll see if I can use the worksheet.evaluate instead."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1519167447, "post_id": 48895419, "comment_id": 84796902, "body": "@Mat&#39;sMug continuation of <a href=\"https://stackoverflow.com/questions/48892588/is-it-possible-to-use-excel-functions-to-evaluate-the-result-of-a-function\">This Post</a>"}, {"owner": {"reputation": 1041, "user_id": 1811159, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/JBmj0.png?s=128&g=1", "display_name": "Nicholas Humphrey", "link": "https://stackoverflow.com/users/1811159/nicholas-humphrey"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519167615, "post_id": 48895419, "comment_id": 84796957, "body": "@TimWilliams I tried Worksheet.Evaluate but still doesn&#39;t work (works for the others, just not the first one). I wish I could upload the file but it&#39;s kind of sensitive...I&#39;ll see if I can create a similar workbook."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1519167806, "post_id": 48895419, "comment_id": 84797027, "body": "Just a general hint about the <code>Worksheet.Evaluate</code> thing.  The same scoping advice applies to other parts your posted code too - it&#39;s a good idea to never use unqualified <code>Range()</code> or <code>Cells()</code> calls."}, {"owner": {"reputation": 1041, "user_id": 1811159, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/JBmj0.png?s=128&g=1", "display_name": "Nicholas Humphrey", "link": "https://stackoverflow.com/users/1811159/nicholas-humphrey"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519168231, "post_id": 48895419, "comment_id": 84797148, "body": "@TimWilliams Thanks for the hint! Cells() part is OK because I&#39;m using the same one in the same loop. BTW I found something stranger, if you have time, could you please look at the part I just edited (starting from &quot;Stranger is, this also works&quot;)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1519168314, "post_id": 48895419, "comment_id": 84797182, "body": "instead of ending the first IF try using Elseif.  You are doing both Ifs and maybe throwing off what you expect."}, {"owner": {"reputation": 1041, "user_id": 1811159, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/JBmj0.png?s=128&g=1", "display_name": "Nicholas Humphrey", "link": "https://stackoverflow.com/users/1811159/nicholas-humphrey"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519168512, "post_id": 48895419, "comment_id": 84797239, "body": "@ScottCraner Actually the first IF doesn&#39;t do anything, because I begin the counting from row 98, so the first IF is redundant. However, I need to keep the first IF to avoid the #REF error. That&#39;s what I don&#39;t understand. Stranger is, it works as long as I keep the first IF, even if it doesn&#39;t contain Cells(RowBegin, 6) = Evaluate(Cells(RowBegin, 10).Value)."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 2, "creation_date": 1519176129, "post_id": 48895419, "comment_id": 84799280, "body": "Actually I&#39;m surprised this works at all.   For me Evaluate ing a reference to a closed wb always returns #Ref error.  An alternative that does work is writing the string to the cells .Formula property. You can overwrite with the value after that if required"}, {"owner": {"reputation": 1041, "user_id": 1811159, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/JBmj0.png?s=128&g=1", "display_name": "Nicholas Humphrey", "link": "https://stackoverflow.com/users/1811159/nicholas-humphrey"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1519181995, "post_id": 48895419, "comment_id": 84800629, "body": "@chrisneilsen I forgot to mention that I gave up writing code for closed wb and wrote code to open the wb before doing anything to them. It&#39;s clumsy but at least got the job done..."}], "answers": [{"comments": [{"owner": {"reputation": 1041, "user_id": 1811159, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/JBmj0.png?s=128&g=1", "display_name": "Nicholas Humphrey", "link": "https://stackoverflow.com/users/1811159/nicholas-humphrey"}, "edited": false, "score": 0, "creation_date": 1519176052, "post_id": 48896675, "comment_id": 84799262, "body": "Hi I think that&#39;s the case. I&#39;ll check tomorrow to see if there are better methods. Wish I could program Excel with C++ or Python."}, {"owner": {"reputation": 1762, "user_id": 3661120, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2945ed0aa05dd03ab9ebbc5f33668360?s=128&d=identicon&r=PG&f=1", "display_name": "dashnick", "link": "https://stackoverflow.com/users/3661120/dashnick"}, "reply_to_user": {"reputation": 1041, "user_id": 1811159, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/JBmj0.png?s=128&g=1", "display_name": "Nicholas Humphrey", "link": "https://stackoverflow.com/users/1811159/nicholas-humphrey"}, "edited": false, "score": 1, "creation_date": 1519176171, "post_id": 48896675, "comment_id": 84799289, "body": "You could use C# with Interop if you want, but I bet you have the same issue.  Some sort of internal timeout or something with Excel I bet."}], "tags": [], "owner": {"reputation": 1762, "user_id": 3661120, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2945ed0aa05dd03ab9ebbc5f33668360?s=128&d=identicon&r=PG&f=1", "display_name": "dashnick", "link": "https://stackoverflow.com/users/3661120/dashnick"}, "is_accepted": true, "score": 1, "last_activity_date": 1519175082, "creation_date": 1519175082, "answer_id": 48896675, "question_id": 48895419, "link": "https://stackoverflow.com/questions/48895419/strange-occurence-with-vba-evaluate-and-for-loop/48896675#48896675", "title": "Strange occurence with VBA Evaluate and For loop", "body": "<p>I think the first time it kind of opens the external reference - but not in time - and throws an error, and then from then on it is okay.  So the reason the <code>IF</code> works and not the <code>ELSEIF</code> is because when you use the <code>IF</code> it redoes it again, while the <code>ELSEIF</code> it doesnt.  This explains all that weird behavior.  Just keep a dummy line in there to open it, like:</p>\n\n<pre><code>RowBegin = 98 \nCells(RowBegin, 6).Value = Evaluate(Cells(RowBegin, 10).Value) ' Dummy\nFor RowCount = RowBegin To RowBegin + 23   'Total 24 rows per site per day\n    If (RowCount Mod 4 &lt;&gt; 1) Then\n        Cells(RowCount, 6).Value = Evaluate(Cells(RowCount, 10).Value)\n        Cells(RowCount, 7).Value = Evaluate(Cells(RowCount, 11).Value)\n    End If\nNext RowCount\n</code></pre>\n"}], "owner": {"reputation": 1041, "user_id": 1811159, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/JBmj0.png?s=128&g=1", "display_name": "Nicholas Humphrey", "link": "https://stackoverflow.com/users/1811159/nicholas-humphrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 48896675, "answer_count": 1, "score": 1, "last_activity_date": 1519175082, "creation_date": 1519166574, "last_edit_date": 1519168145, "question_id": 48895419, "link": "https://stackoverflow.com/questions/48895419/strange-occurence-with-vba-evaluate-and-for-loop", "title": "Strange occurence with VBA Evaluate and For loop", "body": "<p>I'm using Evaluate() in a loop, and everything goes fine except the first evaluate in the whole loop.</p>\n\n<pre><code>RowBegin = 98 \nFor RowCount = RowBegin To RowBegin + 23   'Total 24 rows per site per day\n    If (RowCount Mod 4 &lt;&gt; 1) Then\n        Cells(RowCount, 6).Value = Evaluate(Cells(RowCount, 10).Value)\n        Cells(RowCount, 7).Value = Evaluate(Cells(RowCount, 11).Value)\n    End If\nNext RowCount\n</code></pre>\n\n<p>Please note that 1 of the 4 rows is skipped because I have a formula there. All the Evaluate() works perfectly except for the first one:</p>\n\n<pre><code>Evaluate(Cells(98, 10).Value)\n</code></pre>\n\n<p>This one shows a #REF error. I double checked the formula and it is alright. In fact, even the next one within the same loop works:</p>\n\n<pre><code>Evaluate(Cells(98, 11).Value)\n</code></pre>\n\n<p>This is the formula I put in Cells(98,10):</p>\n\n<pre><code>='R:\\20180220\\[Filename.xlsb]Summary'!$D$2\n</code></pre>\n\n<p>And this is the formula I put in Cells(98,11):</p>\n\n<pre><code>='R:\\20180220\\[Filename.xlsb]Summary'!$D$3\n</code></pre>\n\n<p>However, if I modify the code to:</p>\n\n<pre><code>RowBegin = 98\nFor RowCount = RowBegin To RowBegin + 23   'Total 24 rows per site per day\n    If (RowCount = RowBegin) Then\n        Cells(RowBegin, 6).Value = Evaluate(Cells(RowBegin, 10).Value)\n        Cells(RowBegin, 7).Value = Evaluate(Cells(RowBegin, 11).Value)\n    End If\n    If (RowCount Mod 4 &lt;&gt; 1) Then\n        Cells(RowCount, 6).Value = Evaluate(Cells(RowCount, 10).Value)\n        Cells(RowCount, 7).Value = Evaluate(Cells(RowCount, 11).Value)\n    End If\nNext RowCount\n</code></pre>\n\n<p>Then everything works. </p>\n\n<p>Stranger is, this also works:</p>\n\n<pre><code>RowBegin = 98\nFor RowCount = RowBegin To RowBegin + 23   'Total 24 rows per site per day\n    If (RowCount = RowBegin) Then\n        Cells(RowBegin, 7).Value = Evaluate(Cells(RowBegin, 11).Value)\n    End If\n    If (RowCount Mod 4 &lt;&gt; 1) Then\n        Cells(RowCount, 6).Value = Evaluate(Cells(RowCount, 10).Value)\n        Cells(RowCount, 7).Value = Evaluate(Cells(RowCount, 11).Value)\n    End If\nNext RowCount\n</code></pre>\n\n<p>Please note that in the first IF, it actually does not touch Cells(RowCount, 6)!</p>\n\n<p>I'm scratching my head because I think the first piece of code and the second one is exactly the same (because when RowCount = 98 it is not skipped anyway). Does it have anything to do with the loop or the Mod operator?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007", "dao"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1519242483, "post_id": 48895390, "comment_id": 84834774, "body": "Probably won&#39;t make any difference but because the Function does not return a value to the calling procedure, it could just be a Sub."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1519243150, "post_id": 48895390, "comment_id": 84835140, "body": "Code to set datStart should not even compile. Do you run Debug&gt;Compile after code edits?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519219842, "post_id": 48896668, "comment_id": 84820097, "body": "It is still stopping at this point.  I am afraid I did not pin-point the actual failure in my description and that would have been helpful.  There is a reference in Public Sub loadReportYearCalendar that builds the calendar based on the first day of the year, referenced in the code as datStart. In the example it is 1/1/2017 and you can see my attempts at referencing the form.  Anytime I time I try to reference the form I get the Run time Error 3061.  I&#39;m not sure what YourFieldnameHere references and what do I need to with the datStart reference in the Public Sub"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519241946, "post_id": 48896668, "comment_id": 84834478, "body": "YourFieldnameHere must be replaced with name of field from query that has the Year value. Suggested syntax is correct for opening filtered recordset (I did edit answer for a couple of typos). If qr_SafetyCal2 does nothing but filter qr_SafetyCal by the year then perhaps you should reference qr_SafetyCal instead. You did not provide query statements for review. Apparently have several issues within code and probably should be separate questions to deal with each one at a time. Get the function running properly first. Call it from the VBA Immediate window to test it independently of the Sub."}, {"owner": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519262102, "post_id": 48896668, "comment_id": 84842636, "body": "Tried checking the datStart variable in the immediate window and returned nothing.  I think you are getting the jest of my question but I am not sure how to get the function running properly first."}, {"owner": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519263295, "post_id": 48896668, "comment_id": 84842942, "body": "Hopefully seeing the queries will help.  I think I mentioned above, if I did I apologize but if I place 2017 in the query field CalYear of the second query, qr_SafetyCal2 and then assign &quot;1/1/2017&quot; to the datStart varibale in the code, it works great!  However, when I reference the the form cboYear, dop down box containing the year value in the qr_SafetyCal2 and reference the following in the Public Sub LoadReportYearCalendar datStart = &quot;1/1/&quot; &amp; Forms![fr_SafetyCal]![cboYear]... it crashes"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519268621, "post_id": 48896668, "comment_id": 84844257, "body": "Calling getCalendarData() function from Immediate window has nothing to do with the datStart variable."}, {"owner": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519268639, "post_id": 48896668, "comment_id": 84844263, "body": "Note indicates the edit is under peer review and I guess will be visible once its approved"}, {"owner": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519268737, "post_id": 48896668, "comment_id": 84844281, "body": "I added it to the original post"}, {"owner": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519268993, "post_id": 48896668, "comment_id": 84844341, "body": "In answer to the immediate window response, I&#39;m not sure what you are referring to as getting the function running properly first."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519269407, "post_id": 48896668, "comment_id": 84844431, "body": "So the function opens the recordset object and doesn&#39;t error. Get that working then look at setting the datStart variable. Include a <code>Debug.Print rs!(ShortName)</code> line in the loop and value will show in immediate if the recordset opens properly."}, {"owner": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519269498, "post_id": 48896668, "comment_id": 84844452, "body": "I honestly thought I was getting the function to operate correctly by testing its operation before I tried to call the variables from the form.  I appreciate your patients."}, {"owner": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519271078, "post_id": 48896668, "comment_id": 84844842, "body": "I tried your suggestion and got no result so I set all the perimeters back to the original state and tested it&#39;s operation, it worked, then inserted Debug.Print rs!(Short Name) in the code just under where the rs is called and got &quot;Compile Error: Variable not defined&quot; with Short Name highlighted in blue.  I am not doing something right!"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519277968, "post_id": 48896668, "comment_id": 84847012, "body": "The Debug goes inside the loop. Did you type a space in <code>Short Name</code>? Sorry, no parens. Two versions: <code>rs!ShortName</code> or <code>rs.Fields(&quot;ShortName&quot;)</code>. Only you can drop the <code>rs</code> because of the <code>With</code>."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519278310, "post_id": 48896668, "comment_id": 84847141, "body": "I meant inside the <code>For</code> loop."}, {"owner": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519309276, "post_id": 48896668, "comment_id": 84865877, "body": "June7 I have created a separate functional database with all component pieces so you can see everything... very small but I am not sure how I can get it to you.  Suggestion?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519327608, "post_id": 48896668, "comment_id": 84877974, "body": "Upload to a fileshare site such as Box.com and post a link to the file. Or use a forum that allows attaching files to posts."}, {"owner": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519333938, "post_id": 48896668, "comment_id": 84881369, "body": "The file is uploaded to my Google Drive at the following link: <a href=\"https://drive.google.com/file/d/1N8eiz8sMy0RREgeRY3FQVwS5O8WeK82q/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/1N8eiz8sMy0RREgeRY3FQVwS5O8WeK82q/&hellip;</a>  Double click iCalendar12 to see the result."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519463020, "post_id": 48896668, "comment_id": 84928488, "body": "OK, have to concatenate reference to the combobox. I thought the SQL could evaluate the full form/control reference syntax within quote marks but apparently not. See edit to my answer. Then fix the code for building the date. I don&#39;t get an error message but the report won&#39;t open unless I delete month 12 and change code to cycle only 11 times. But then I see only 9 months on each page and the report is 322 pages. This question has its answer. Time to go back to drawing board and a new question."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519464377, "post_id": 48896668, "comment_id": 84928777, "body": "Okay, bizarre, don&#39;t know what I did but now getting all 12 months. Works great!"}, {"owner": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519478132, "post_id": 48896668, "comment_id": 84932307, "body": "SUCCESS, it worked!  I tested each year, initiated from the input form and worked flawlessly.  I have marked the question as answered but I can&#39;t figure out how rate your input.  Thank You for your help."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "edited": false, "score": 0, "creation_date": 1519502349, "post_id": 48896668, "comment_id": 84939714, "body": "Thank you for the answer approval. Rate a post with up/down vote."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 1, "last_activity_date": 1519464950, "last_edit_date": 1519464950, "creation_date": 1519175038, "answer_id": 48896668, "question_id": 48895390, "link": "https://stackoverflow.com/questions/48895390/runtime-error-3061-too-few-parameters-expected-1-dao-declarations/48896668#48896668", "title": "Runtime Error 3061 too few parameters expected 1 DAO declarations", "body": "<p>No need to reference QueryDef.</p>\n\n<p>Open the recordset object with filtered dataset by referencing the combobox like:</p>\n\n<pre><code>Set rs = CurrentDb.OpenRecordset(\"SELECT * FROM qr_SafetyCal2 WHERE CalYear=\" &amp; [Forms]![fr_SafetyCal]![cboYear], dbOpenDynaset)\n</code></pre>\n\n<p>or if the code is behind the form:</p>\n\n<pre><code>Set rs = CurrentDb.OpenRecordset(\"SELECT * FROM qr_SafetyCal2 WHERE CalYear=\" &amp; Me.[cboYear], dbOpenDynaset)\n</code></pre>\n\n<p>Both examples assume the field is a number type.</p>\n\n<p>If there is no field in query with the year value, it can be extracted from date value field in the VBA construct:</p>\n\n<pre><code>Set rs = CurrentDb.OpenRecordset(\"SELECT * FROM qr_SafetyCal2 WHERE Year([YourFieldnameHere])=\" &amp; [Forms]![fr_SafetyCal]![cboYear], dbOpenDynaset)\n</code></pre>\n\n<p>Code for setting datStart variable:</p>\n\n<pre><code>'Get the first month of the specified year\ndatStart = \"1/1/\" &amp; Forms![fr_SafetyCal].[cboYear]\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7698593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6899ce01977375df4e5b55512df25866?s=128&d=identicon&r=PG&f=1", "display_name": "caryw", "link": "https://stackoverflow.com/users/7698593/caryw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 1, "accepted_answer_id": 48896668, "answer_count": 1, "score": 1, "last_activity_date": 1528535810, "creation_date": 1519166383, "last_edit_date": 1528535810, "question_id": 48895390, "link": "https://stackoverflow.com/questions/48895390/runtime-error-3061-too-few-parameters-expected-1-dao-declarations", "title": "Runtime Error 3061 too few parameters expected 1 DAO declarations", "body": "<p>I have been looking for some code that creates a calendar year and will take data from a table and place it in the corresponding date on the calendar.  I found some code online (from an older version of access) that pretty much fit the bill, with some modifications it does exactly what I need it to do.  Originally, the code pulled data from one table and it was set up to run on the current year.  I use two queries, qr_SafetyCal and qr_SafetyCal2, to refine data from the one table. The first query prioritizes the data and eliminates multiple events on any given day.  The second query uses the results from the first and specifies the year in the query criteria.</p>\n\n<p>The code works flawlessly as long as I set the year criteria in the qr_SafetyCal2 and specify the first day, ex. 1/1/2017 (datStart) in the underlying code of the calendar year I want displayed.</p>\n\n<p>After getting the code squared away I created a pop up form the user to select the year for the report but when I run the report I get the following error, Runtime Error 3061 too few parameters expected 1.</p>\n\n<p>From what I have been able to research, I believe I changed the dynamic of the code when I referenced the form in the query criteria that the DAO Recordset Used. \nAs I understand it, the criteria in the query is not passed to the rs and therefore needs to be declared in the code.  What I can't figure out is how to declare the variables in the code through reference to the form.  I hope that makes some sense to somebody, long explanation but hard to describe something you don't understand.</p>\n\n<p>Below is all the code and you will see some things I've rem'd out that I have tried but did not work.  Any help would be greatly appreciated. I apologize ahead of time if the code is not formatted correctly.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Compare Database\nOption Explicit\n\nPrivate m_strCTLLabel  As String\nPrivate m_strCTLLabelHeader As String\nPrivate colCalendarDates As Collection\n\nFunction getCalendarData() As Boolean\nDim rs As DAO.Recordset\nDim strDate As String\nDim strCode As String\n\nDim i As Integer\n\n    'Dim qdf As DAO.QueryDef\n    'Set qdf = CurrentDb.QueryDef(\"qr_SafetyCal2\")\n    'qdf.Parameters(\"[Forms]![fr_SafetyCal]![cboYear]\") = [Forms]![fr_SafetyCal]![cboYear]\n    'Set rs = qdf.OpenRecordset(\"qr_SafetyCal2\", dbOpenDynaset)\n\n    Set rs = CurrentDb.OpenRecordset(\"qr_SafetyCal2\", dbOpenDynaset)\n\n    Set colCalendarDates = New Collection\n    With rs\n        If (Not .BOF) Or (Not .EOF) Then\n            .MoveLast\n            .MoveFirst\n        End If\n        If .RecordCount &gt; 0 Then\n            For i = 1 To .RecordCount\n                strDate = .Fields(\"Date\")\n                strCode = .Fields(\"ShortName\")\n                colCalendarDates.Add strCode, strDate\n                .MoveNext\n            Next i\n        End If\n        .Close\n    End With\n    'Return of dates and data collection form qr_SafetyCal2\n    Set rs = Nothing\n\nEnd Function\n\nPublic Sub loadReportYearCalendar(theReport As Report)\nDim i As Integer\nDim datStart As Date\nDim rptControl As Report\n\n    m_strCTLLabel = \"labelCELL\"\n    m_strCTLLabelHeader = \"labelDAY\"\n\n    'Load calendar data for the specified year into the collection\n    Call getCalendarData\n\n    With theReport\n        'Get the first month of the specified year\n        datStart = \"1/1/2017\" '\"1/1/\" &amp; Year(Date), \"1/1/\" &amp; Forms!\n        [fr_SafetyCal]![cboYear], Forms![fr_SafetyCal]![txtCalYear]\n        'Add the specified year to the report's label\n        .Controls(\"labelCalendarHeaderLine2\").Caption = Year(datStart) &amp; \" \n        iCalendar\"\n        For i = 1 To 12\n            'Set pointer to subreport control hosting the mini-calendar\n            Set rptControl = .Controls(\"childCalendarMonth\" &amp; i).Report\n            'Run procedure to populate control with it's respective year\n            Call loadReportCalendar(rptControl, datStart)\n            'Reset and obtain first day of the following month\n            datStart = DateAdd(\"m\", 1, datStart)\n        Next i\n     End With\n    'Clean up\n    Set colCalendarDates = Nothing\n    Set rptControl = Nothing\nEnd Sub\n\n\nPublic Sub loadReportCalendar(theReport As Report, Optional StartDate As \nDate, Optional theHeaderColor As Variant)\nDim i As Integer\nDim intCalDay As Integer\nDim datStartDate As Date\nDim intWeekDay As Integer\n\n    datStartDate = StartDate\n    intWeekDay = Weekday(datStartDate)\n\n    With theReport\n\n        .Controls(\"labelMONTH\").Caption = Format(StartDate, \"mmmm\")\n\n        'Change the day label's backcolor if necessary\n        If Not (IsMissing(theHeaderColor)) Then\n             For i = 1 To 7\n                 .Controls(\"labelDayHeader\" &amp; i).BackColor = theHeaderColor\n            Next\n        End If\n\n        For i = 1 To 42\n            With .Controls(m_strCTLLabel &amp; i)\n                If (i &gt;= intWeekDay) And (Month(StartDate) = \n                Month(datStartDate)) Then\n                    If (datStartDate = Date) Then\n                        .BackColor = 14277081\n                    End If\n\n                    On Error Resume Next\n\n                    Dim strCaption As String\n                    Dim strKey As String\n\n                    strKey = datStartDate\n                    strCaption = \"\"\n                    strCaption = colCalendarDates.Item(strKey)\n                    colCalendarDates.Remove strKey\n                    'Set back color to grean on days in the past that have \n                    no corresponding event\n                    If (datStartDate &lt; Date) And (strCaption = vbNullString) Then\n                    .Caption = Day(datStartDate)\n                    .Bold = False\n                    .BackColor = vbGreen\n                    .ForeColor = vbWhite\n                    .Heavy = True\n                'Do not set a back color for days in the future\n                ElseIf (datStartDate &gt; Date) And (strCaption = vbNullString) Then\n                    .Caption = Day(datStartDate)\n                    .Bold = False\n                'Set the corresponding labels and formats for each specified event\n                Else\n                    .Caption = strCaption\n                    .Bold = True\n                    Select Case strCaption\n                        Case \"FA\"\n                            .BackColor = vbYellow\n                            .ForeColor = 0\n                            .LeftMargin = 0\n                            .TextAlign = 2\n                        Case \"FAM\"\n                            .BackColor = vbYellow\n                            .ForeColor = 0\n                            .LeftMargin = 0\n                            .TextAlign = 2\n                            .Heavy = True\n                        Case \"LTA\"\n                            .BackColor = vbRed\n                            .ForeColor = vbWhite\n                            .LeftMargin = 0\n                            .TextAlign = 2\n                        Case \"MED\"\n                            .BackColor = vbRed\n                            .ForeColor = vbWhite\n                            .LeftMargin = 0\n                            .TextAlign = 2\n                    End Select\n\n                End If\n\n               datStartDate = DateAdd(\"d\", 1, datStartDate)\n            Else\n                .Caption = \"\"\n            End If\n        End With\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Here is SQL for the two queries, the first is qr_SafetyCal and the second is qr_SafetyCal2:  </p>\n\n<pre><code>SELECT tb_CaseLog.Date, Max(tb_Treatment.Priority) AS MaxOfPriority, \nCount(tb_Treatment.TreatmentID) AS CountOfTreatmentID\nFROM tb_Treatment INNER JOIN tb_CaseLog ON tb_Treatment.TreatmentID = \ntb_CaseLog.Treatment\nGROUP BY tb_CaseLog.Date;\n\nSELECT qr_SafetyCal.Date, tb_Treatment.ShortName, \nqr_SafetyCal.CountOfTreatmentID AS [Count], Year([Date]) AS CalYear\nFROM qr_SafetyCal INNER JOIN tb_Treatment ON qr_SafetyCal.MaxOfPriority = \ntb_Treatment.Priority;\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1519164631, "post_id": 48895058, "comment_id": 84795897, "body": "What&#39;s the literal cell formula say? <code>=-Notice</code> which returns <code>#NAME</code>? And you want just <code>=Notice</code>? Are you sure there&#39;s a UDF with that name, or a formula with that name, in your Excel version?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5889203"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1519164833, "post_id": 48895058, "comment_id": 84795972, "body": "@BruceWayne it&#39;s supposed to be an informational message, so I just want the message, what was input was the message with a leading &quot;=-&quot;, so if it says &quot;=- Notice, XYZ&quot;, all I want is the &quot;Notice, XYZ&quot;, or even getting rid of the #name? would be good enough.  I just need the data usable and not sitting in there as an error"}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1519165473, "last_edit_date": 1519165473, "creation_date": 1519165017, "answer_id": 48895144, "question_id": 48895058, "link": "https://stackoverflow.com/questions/48895058/data-imported-to-excel-as-general-text-started-with-getting-name-is/48895144#48895144", "title": "Data imported to Excel as &quot;general&quot;, text started with &quot;=&quot;, getting &quot;#name?&quot; Is there a way to get it back to text?", "body": "<p>Instead of using <code>.Value</code> you have to use <code>.Formula</code>, since it's being interpreted as such here:</p>\n\n<pre><code>sub convert_it()\n  if left(cells(1,1).formula,2) =\"=-\" then cells(1,1).formula = _\n  right(cells(1,1).formula, len(cells(1,1).formula) -2)\nend sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/CVcKM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CVcKM.png\" alt=\"enter image description here\"></a></p>\n\n<p>Naturally you would place your code within a loop for the column. But I agree that it might be easier to just do a large find/replace.</p>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1519165159, "post_id": 48895152, "comment_id": 84796106, "body": "This is probably the quickest/easiest way. To be sure, OP could Find <code>=-Notice</code> and replace <code>&#39;=-Notice</code>."}], "tags": [], "owner": {"reputation": 1355, "user_id": 3097559, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lvowV.jpg?s=128&g=1", "display_name": "tysonwright", "link": "https://stackoverflow.com/users/3097559/tysonwright"}, "is_accepted": false, "score": 1, "last_activity_date": 1519165051, "creation_date": 1519165051, "answer_id": 48895152, "question_id": 48895058, "link": "https://stackoverflow.com/questions/48895058/data-imported-to-excel-as-general-text-started-with-getting-name-is/48895152#48895152", "title": "Data imported to Excel as &quot;general&quot;, text started with &quot;=&quot;, getting &quot;#name?&quot; Is there a way to get it back to text?", "body": "<p>You can do this with VB, or just highlight the whole sheet, hit CTRL-H, type <strong>=</strong> in the Find and <strong>'=</strong> in the Replace, then click Replace All.  This will make Excel stop thinking that these are formulas.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5889203"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1519165473, "creation_date": 1519164500, "last_edit_date": 1519164916, "question_id": 48895058, "link": "https://stackoverflow.com/questions/48895058/data-imported-to-excel-as-general-text-started-with-getting-name-is", "title": "Data imported to Excel as &quot;general&quot;, text started with &quot;=&quot;, getting &quot;#name?&quot; Is there a way to get it back to text?", "body": "<p>On of our offices started their text data with an equals sign, which, when imported into the spreadsheet, gave the #NAME? error.  </p>\n\n<p>Now, I know I can change the cell format to text and then click in the formula bar, and excel recognizes the cell as text, but is there a way to do this through VBA?</p>\n\n<p>EXAMPLE:</p>\n\n<p>Cell display value: #NAME?</p>\n\n<p>cell text =-Notice, ABC</p>\n\n<p>Desired OUTPUT:  Notice, ABC</p>\n\n<p>now, normally, I'd do something like</p>\n\n<pre><code>sub convert_it()\n  if left(cells(1,1).value,2) =\"=-\" then cells(1,1).value = _\n  right(cells(1,1).value, len(cells(1,1).value) -2)\nend sub\n</code></pre>\n\n<p>but that returns a type mismatch error.</p>\n\n<p>Is there some way I can get the text in the cell without manually clicking?</p>\n\n<p>I can click a few thousand times and then Excel recognizes it as text again, and not as an error, but I'd rather avoid that.</p>\n"}, {"tags": ["vba", "pivot-table"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1519164231, "post_id": 48894846, "comment_id": 84795742, "body": "Can&#39;t say I&#39;m surprised you don&#39;t get any errors when you start your subroutine with <code>On Error Resume Next</code>... Remove that and try running again :)"}, {"owner": {"reputation": 1, "user_id": 9388064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13e7a7e6785f13793f3dc0b77bbb9f7?s=128&d=identicon&r=PG&f=1", "display_name": "Keltie", "link": "https://stackoverflow.com/users/9388064/keltie"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1519167771, "post_id": 48894846, "comment_id": 84797016, "body": "Oops, that explains that one! Thank you!"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1519239889, "post_id": 48894846, "comment_id": 84833400, "body": "So what line is throwing the error?"}, {"owner": {"reputation": 1, "user_id": 9388064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13e7a7e6785f13793f3dc0b77bbb9f7?s=128&d=identicon&r=PG&f=1", "display_name": "Keltie", "link": "https://stackoverflow.com/users/9388064/keltie"}, "edited": false, "score": 0, "creation_date": 1519240750, "post_id": 48894846, "comment_id": 84833845, "body": "One of the heading names was off by a space, the first With line should have been &quot;Work Category &quot; not &quot;Work Category&quot;."}], "owner": {"reputation": 1, "user_id": 9388064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13e7a7e6785f13793f3dc0b77bbb9f7?s=128&d=identicon&r=PG&f=1", "display_name": "Keltie", "link": "https://stackoverflow.com/users/9388064/keltie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519163597, "creation_date": 1519163597, "question_id": 48894846, "link": "https://stackoverflow.com/questions/48894846/vba-code-for-pivot-table-wont-generate-table", "title": "VBA - Code for pivot table won&#39;t generate table", "body": "<p>This is my first time trying to write a VBA code that generates a pivot table. The following is my code, when I run it I don't get any errors and the new worksheet is generated but not a pivot table in sight. </p>\n\n<p>Thanks!</p>\n\n<pre><code>On Error Resume Next\nApplication.DisplayAlerts = False\nWorksheets(\"WorkCat PT\").Delete\nSheets.Add Before:=ActiveSheet\nActiveSheet.Name = \"WorkCat PT\"\nApplication.DisplayAlerts = True\nSet PSheet = Worksheets(\"WorkCat PT\")\nDSheet = ActiveSheet.Data\n\nLastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\nLastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\nSet PRange = DSheet.Cells(1, 1).Resize(LastRow, LastCol)\n\nSet PCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=PRange)\n\nSet PTable = PCache.CreatePivotTable(TableDestination:=DSheet.Cells(2, 16), TableName:=\"WorkCatPivotTable\")\n\nWith ActiveSheet.PTable.PivotFields(\"Work Category\")\n.Orientation = xlRowField\n.Position = 1\nEnd With\n\nWith ActiveSheet.PTable.PivotFields(\"Total Cost\")\n.Orientation = xlColumnField\n.Position = 1\nEnd With\n\nWith ActiveSheet.PTable.PivotFields(\"Total Cost\")\n.Orientation = xlDataField\n.Position = 1\n.Function = xlSum\n.NumberFormat = \"$ #,##0\"\n.Name = \"Work Category\"\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "edited": false, "score": 0, "creation_date": 1519180070, "post_id": 48894657, "comment_id": 84800157, "body": "Having a column per date could get messy. What about each row starting with a date, so that each row resembles a database record. Then it&#39;s really easy to look at data for just one date or even for a range of dates. You can do what you&#39;re describing with VBA but it would be a clunky experience - you paste data then it gets moved somewhere else. If you&#39;re still stuck tomorrow maybe I can help more usefully."}, {"owner": {"reputation": 1, "user_id": 6397188, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mYJZbGeTOPY/AAAAAAAAAAI/AAAAAAAACDU/p9WjJfBJvKs/photo.jpg?sz=128", "display_name": "Gopi Krishna", "link": "https://stackoverflow.com/users/6397188/gopi-krishna"}, "reply_to_user": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "edited": false, "score": 0, "creation_date": 1519196975, "post_id": 48894657, "comment_id": 84805238, "body": "Hi Scott,    in mastersheet each column having date and daily basis I have to update the data in respective date. Means I have to update data under yesterday&#39;s date"}], "answers": [{"comments": [{"owner": {"reputation": 246, "user_id": 9361443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adec54ed9e27194eaa721d4f8079d40?s=128&d=identicon&r=PG&f=1", "display_name": "shash", "link": "https://stackoverflow.com/users/9361443/shash"}, "reply_to_user": {"reputation": 1, "user_id": 6397188, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mYJZbGeTOPY/AAAAAAAAAAI/AAAAAAAACDU/p9WjJfBJvKs/photo.jpg?sz=128", "display_name": "Gopi Krishna", "link": "https://stackoverflow.com/users/6397188/gopi-krishna"}, "edited": false, "score": 0, "creation_date": 1519223719, "post_id": 48894782, "comment_id": 84822882, "body": "Using the IF condition I showed in the answer, along with the simple copy-paste should do the trick for you. Here&#39;s a reference, for your code <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-copy-method-excel\" rel=\"nofollow noreferrer\">Range.Copy</a>"}], "tags": [], "owner": {"reputation": 246, "user_id": 9361443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adec54ed9e27194eaa721d4f8079d40?s=128&d=identicon&r=PG&f=1", "display_name": "shash", "link": "https://stackoverflow.com/users/9361443/shash"}, "is_accepted": false, "score": 0, "last_activity_date": 1519163343, "creation_date": 1519163343, "answer_id": 48894782, "question_id": 48894657, "link": "https://stackoverflow.com/questions/48894657/how-to-paste-the-data-in-another-workbook-by-yerterday-date-using-vba/48894782#48894782", "title": "How to paste the data in another workbook by yerterday date using vba", "body": "<p>Use something like</p>\n\n<pre><code>If DateAdd(\"d\", -1, Date)= ActiveSheet.Range(\"\") Then 'Address the date cell \n    'Do something\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6397188, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mYJZbGeTOPY/AAAAAAAAAAI/AAAAAAAACDU/p9WjJfBJvKs/photo.jpg?sz=128", "display_name": "Gopi Krishna", "link": "https://stackoverflow.com/users/6397188/gopi-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1519163343, "creation_date": 1519162765, "last_edit_date": 1531164843, "question_id": 48894657, "link": "https://stackoverflow.com/questions/48894657/how-to-paste-the-data-in-another-workbook-by-yerterday-date-using-vba", "title": "How to paste the data in another workbook by yerterday date using vba", "body": "<p>I am genarating some data in excel let say B3 to b8 and I would like to paste the rows into mastersheet under a yesterday column. Like example: master sheet having dates like \n2/20/2018 2/21/2018 in A1 and B1 column.\nI want paste the data under 2/20/2018 that means I want publish the data under yesterday date.\nCan some please help on this.. </p>\n"}, {"tags": ["excel", "vba", "decimal", "copy-paste"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1519160285, "post_id": 48894046, "comment_id": 84793951, "body": "might be 15 digit floating point problems. try rounding to a large number of decimal points; e.g round(a1, 14)"}, {"owner": {"reputation": 15, "user_id": 9363033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84dfaa6db7310cf4d433ce295b32fef5?s=128&d=identicon&r=PG&f=1", "display_name": "JayH", "link": "https://stackoverflow.com/users/9363033/jayh"}, "edited": false, "score": 0, "creation_date": 1519160375, "post_id": 48894046, "comment_id": 84793996, "body": "cheers, the max amount of decimal places are 3 but still wont work"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519161143, "post_id": 48894046, "comment_id": 84794378, "body": "3 <i>display</i> decimals, or 3 actual underlying decimals ?"}, {"owner": {"reputation": 15, "user_id": 9363033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84dfaa6db7310cf4d433ce295b32fef5?s=128&d=identicon&r=PG&f=1", "display_name": "JayH", "link": "https://stackoverflow.com/users/9363033/jayh"}, "edited": false, "score": 0, "creation_date": 1519161274, "post_id": 48894046, "comment_id": 84794443, "body": "im not quite sure what you mean by that. The max is for example 12.435"}, {"owner": {"reputation": 137, "user_id": 5860060, "user_type": "registered", "profile_image": "https://graph.facebook.com/1746576902242715/picture?type=large", "display_name": "Cody Pace", "link": "https://stackoverflow.com/users/5860060/cody-pace"}, "edited": false, "score": 0, "creation_date": 1519161464, "post_id": 48894046, "comment_id": 84794551, "body": "Did you check the formatting of the destination cell? Could be the cell format is cutting the decimals off"}, {"owner": {"reputation": 15, "user_id": 9363033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84dfaa6db7310cf4d433ce295b32fef5?s=128&d=identicon&r=PG&f=1", "display_name": "JayH", "link": "https://stackoverflow.com/users/9363033/jayh"}, "edited": false, "score": 0, "creation_date": 1519162032, "post_id": 48894046, "comment_id": 84794812, "body": "I don&#39;t think it is to do with the formatting of the destination cell as when it is a decimal place nothing is pasted to the new sheet at all. This makes me think that either when the matching is occurring that it only registers the whole number and thus wont see an exact match but not sure...  maybe I should put a &quot;Double&quot; command somewhere?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519162162, "post_id": 48894046, "comment_id": 84794866, "body": "You&#39;re not using the correct syntax for passing named arguments: for example <code>Field = 6</code> should be <code>Field := 6</code>  Or maybe you just need to fix up your posted code?"}, {"owner": {"reputation": 15, "user_id": 9363033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84dfaa6db7310cf4d433ce295b32fef5?s=128&d=identicon&r=PG&f=1", "display_name": "JayH", "link": "https://stackoverflow.com/users/9363033/jayh"}, "edited": false, "score": 0, "creation_date": 1519162493, "post_id": 48894046, "comment_id": 84795011, "body": "Thanks, Yeah I have it correct in my actual code, I&#39;ll fix it here."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9363033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84dfaa6db7310cf4d433ce295b32fef5?s=128&d=identicon&r=PG&f=1", "display_name": "JayH", "link": "https://stackoverflow.com/users/9363033/jayh"}, "edited": false, "score": 0, "creation_date": 1519248432, "post_id": 48900901, "comment_id": 84837920, "body": "Thanks! I later have found that I am dealing with numbers that have up to 10 decimal places.  would changing the code to below work? .AutoFilter field:=6, Criteria1:=&quot;&gt;=&quot; &amp; Round(.Range(&quot;J1&quot;).Value2, 10) - 0.00000000001, Operator:=xlAnd, Criteria2:=&quot;&lt;=&quot; &amp; Round(.Range(&quot;J1&quot;).Value2, 8) + 0.00000000001"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 15, "user_id": 9363033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84dfaa6db7310cf4d433ce295b32fef5?s=128&d=identicon&r=PG&f=1", "display_name": "JayH", "link": "https://stackoverflow.com/users/9363033/jayh"}, "edited": false, "score": 0, "creation_date": 1519248835, "post_id": 48900901, "comment_id": 84838132, "body": "Well, go ahead and try it yourself! And if my answer provided the solution to your original question then please consider marking it as accepted. Thank you"}, {"owner": {"reputation": 15, "user_id": 9363033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84dfaa6db7310cf4d433ce295b32fef5?s=128&d=identicon&r=PG&f=1", "display_name": "JayH", "link": "https://stackoverflow.com/users/9363033/jayh"}, "edited": false, "score": 0, "creation_date": 1519252659, "post_id": 48900901, "comment_id": 84839849, "body": "Couldn&#39;t get it to work. instead I rounded the larger numbers to 3 decimal points. Thanks for all your help"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 15, "user_id": 9363033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84dfaa6db7310cf4d433ce295b32fef5?s=128&d=identicon&r=PG&f=1", "display_name": "JayH", "link": "https://stackoverflow.com/users/9363033/jayh"}, "edited": false, "score": 0, "creation_date": 1519256361, "post_id": 48900901, "comment_id": 84841127, "body": "You are welcome. So my answer didn\u2019t solve the question, did it?"}, {"owner": {"reputation": 15, "user_id": 9363033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84dfaa6db7310cf4d433ce295b32fef5?s=128&d=identicon&r=PG&f=1", "display_name": "JayH", "link": "https://stackoverflow.com/users/9363033/jayh"}, "edited": false, "score": 0, "creation_date": 1519338231, "post_id": 48900901, "comment_id": 84883361, "body": "It works for the three decimal points however i couldn&#39;t get it to work for the 10. not sure if its an excel issue or not but for my solution to the three decimal points was accurate enough. thanks for everything"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1519200680, "creation_date": 1519200680, "answer_id": 48900901, "question_id": 48894046, "link": "https://stackoverflow.com/questions/48894046/how-to-read-decimal-number-from-cell-and-copy-all-rows-that-have-that-cell-numbe/48900901#48900901", "title": "How to read decimal number from cell and copy all rows that have that cell number - EXCEL", "body": "<p>to get around any decimal formatting issue, you could try the following code (explanations in comments):</p>\n\n<pre><code>With wsResult ' be sure 'wsResult' is properly set to a valid 'WorkSheet' object before reaching this line\n    With .Range(\"A1:F\" &amp; .Cells(.Rows.Count, \"F\").End(xlUp).Row) 'reference its columns A:F cells from row 1 (header) down to last not empty one in column \"F\"\n        .AutoFilter field:=6, Criteria1:=\"&gt;=\" &amp; Round(.Range(\"J1\").Value2, 3) - 0.0001, Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; Round(.Range(\"J1\").Value2, 3) + 0.0001 ' filter referenced cells on 6th column with content in a range of 0.0001 from referenced range \"J1\" cell content rounded to three decimals\n        If Application.WorksheetFunction.Subtotal(103, .Columns(1)) &gt; 1 Then .Offset(1).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible).Copy Destination:=Main.Range(\"A22\") ' if any filtered cell other than the header then copy and paste them to 'Main' worksheet starting from its A22 cell\n    End With\n    .AutoFilterMode = False\nEnd With\n</code></pre>\n\n<p>and should your actual cell content decimal separator be a dot (<code>.</code>), then be sure to substitute the comma (<code>,</code>) decimal separator read from \"J1\" cell content with a dot by changing:</p>\n\n<pre><code>        .AutoFilter field:=6, Criteria1:=\"&gt;=\" &amp; Round(.Range(\"J1\").Value2, 3) - 0.0001, Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; Round(.Range(\"J1\").Value2, 3) + 0.0001 ' filter referenced cells on 6th column with content in a range of 0.0001 from referenced range \"J1\" cell content rounded to three decimals\n</code></pre>\n\n<p>to </p>\n\n<pre><code>        .AutoFilter field:=6, Criteria1:=\"&gt;=\" &amp; Replace(Round(.Range(\"J1\").Value2, 3) - 0.0001, \",\", \".\"), Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; Replace(Round(.Range(\"J1\").Value2, 3) + 0.0001, \",\", \".\") ' filter referenced cells on 6th column with content in a range of 0.0001 from referenced range \"J1\" cell content rounded to three decimals\n</code></pre>\n\n<p>as a side note, just be aware that <code>.Range(\"J1\")</code> is pointing at the cell in the first row and 10th column of the referenced range. \nIn this case your referenced range starts from cell \"A1\" of referenced <code>wsResult</code> worksheet, so that is equivalent to<code>wsResult.Range(\"J1\")</code>.</p>\n"}], "owner": {"reputation": 15, "user_id": 9363033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84dfaa6db7310cf4d433ce295b32fef5?s=128&d=identicon&r=PG&f=1", "display_name": "JayH", "link": "https://stackoverflow.com/users/9363033/jayh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 0, "accepted_answer_id": 48900901, "answer_count": 1, "score": 0, "last_activity_date": 1519200680, "creation_date": 1519160081, "last_edit_date": 1519162519, "question_id": 48894046, "link": "https://stackoverflow.com/questions/48894046/how-to-read-decimal-number-from-cell-and-copy-all-rows-that-have-that-cell-numbe", "title": "How to read decimal number from cell and copy all rows that have that cell number - EXCEL", "body": "<p>I am trying to read a number from a Cell (this number changes so I have referenced the cell) and then copy it to a new sheet. There are no issues with the reading or copying. The issue I have is that the number that is being read from another cell doesn't work with decimal numbers. I can read cells with all whole numbers and copy their respective rows but just not decimals. I have tried a work around solution that rounded the numbers to whole numbers but later found this just wont work for the accuracy required in my solution.</p>\n\n<p>A Snippet of code is below:</p>\n\n<pre><code>With ws.Result.Range (\"A1:F\" &amp; .Cells(.Rows.Count, \"F\").End(xlUp).Row\n.AutoFilter Field := 6, Criteria1 := wsResult.Range(\"J1\") ' checks row F to see \nwhether the number in cell J1 matches any in row F\n\nIf Application.WorksheetFunction.Subtotal(103, .Columns(1)&gt;1 Then .\nOffset(1). Resize (.Rows.Count - 1).SpecialCells(xlCellTypeVisible).Copy \nDestination:= Main.Range(\"A22\") ' Paste all rows starting at A22 on the main page.\n</code></pre>\n\n<p>I know the rest of the code works as planned its purely just being able to get the numbers that\n are decimal to work.</p>\n\n<p>Any help would greatly be appreciated.</p>\n"}, {"tags": ["excel", "printing", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9387428, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213754828998666/picture?type=large", "display_name": "genjalol", "link": "https://stackoverflow.com/users/9387428/genjalol"}, "edited": false, "score": 1, "creation_date": 1519292502, "post_id": 48893945, "comment_id": 84854340, "body": "Thank you, this is what I was looking for!"}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 0, "last_activity_date": 1519159628, "creation_date": 1519159628, "answer_id": 48893945, "question_id": 48893253, "link": "https://stackoverflow.com/questions/48893253/excel-macro-to-print-varying-numbers-of-copies-of-multiple-sheets/48893945#48893945", "title": "Excel macro to print varying numbers of copies of multiple sheets", "body": "<p>If you rename, add and remove sheets, you will have to update your list before printing. This sub will clear <code>Range(\"A2:A100\")</code> and it will insert all sheets names in your first sheet. Make sure your \"command center\" sheet is the first one (or change the index reference to the name of that special sheet).</p>\n\n<pre><code>Sub LIST_SHEETS()\nApplication.ScreenUpdating = False\nDim ws As Worksheet\nDim i As Byte\nThisWorkbook.Sheets(1).Range(\"A2:A100\").Clear\n\ni = 2\n\nFor Each ws In ThisWorkbook.Sheets\n    ThisWorkbook.Sheets(1).Range(\"A\" &amp; i).Value = ws.Name\n    i = i + 1\nNext ws\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I'm afraid you will have to figure out where to put the code. I don't know your needs, so maybe after renaming/adding/deleting all sheets, or maybe when Workbook opens or something like that. Try it!.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9387428, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213754828998666/picture?type=large", "display_name": "genjalol", "link": "https://stackoverflow.com/users/9387428/genjalol"}, "edited": false, "score": 0, "creation_date": 1519292685, "post_id": 48894011, "comment_id": 84854483, "body": "I am not exactly sure how to implement this. If I refer to the sheets this way, how can I combine this with the individual numbers of copies (input in column B on Sheet1 in the workbook) that I should be printed?"}, {"owner": {"reputation": 246, "user_id": 9361443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adec54ed9e27194eaa721d4f8079d40?s=128&d=identicon&r=PG&f=1", "display_name": "shash", "link": "https://stackoverflow.com/users/9361443/shash"}, "reply_to_user": {"reputation": 3, "user_id": 9387428, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213754828998666/picture?type=large", "display_name": "genjalol", "link": "https://stackoverflow.com/users/9387428/genjalol"}, "edited": false, "score": 0, "creation_date": 1519308857, "post_id": 48894011, "comment_id": 84865621, "body": "You can get the name of each sheet using <code>sht.Name</code> or <code>ActiveSheet.Name</code>. Look for it in the list in Sheet1 and get the corresponding number of copies."}], "tags": [], "owner": {"reputation": 246, "user_id": 9361443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adec54ed9e27194eaa721d4f8079d40?s=128&d=identicon&r=PG&f=1", "display_name": "shash", "link": "https://stackoverflow.com/users/9361443/shash"}, "is_accepted": false, "score": 0, "last_activity_date": 1519159929, "creation_date": 1519159929, "answer_id": 48894011, "question_id": 48893253, "link": "https://stackoverflow.com/questions/48893253/excel-macro-to-print-varying-numbers-of-copies-of-multiple-sheets/48894011#48894011", "title": "Excel macro to print varying numbers of copies of multiple sheets", "body": "<p>It appears that a name in the list of sheets, does not exactly match the actual name. You can use either of the two options below, to loop through each sheet</p>\n\n<pre><code>For Each sht in ThisWorkbook.Sheets\n     'Do Something\nNext\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>Dim sht as Worksheet\n    For i= 0 to ThisWorkbook.Sheets.Count\n    Set sht=ThisWorkbook.Sheets(i)\n    'Do something\nNext\n</code></pre>\n\n<p>The second option is not reliable when the sheets are deleted (their integer index may not be sequential then) so I would prefer the first option.</p>\n"}], "owner": {"reputation": 3, "user_id": 9387428, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213754828998666/picture?type=large", "display_name": "genjalol", "link": "https://stackoverflow.com/users/9387428/genjalol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 729, "favorite_count": 0, "accepted_answer_id": 48893945, "answer_count": 2, "score": 0, "last_activity_date": 1519159929, "creation_date": 1519156693, "last_edit_date": 1531161705, "question_id": 48893253, "link": "https://stackoverflow.com/questions/48893253/excel-macro-to-print-varying-numbers-of-copies-of-multiple-sheets", "title": "Excel macro to print varying numbers of copies of multiple sheets", "body": "<p>I have an excel workbook that contains multiple sheets. In this workbook sheets occasionally are removed, renamed, or added. This workbook features a sheet (Sheet1) that is supposed to be used as a command center for printing copies of the other sheets in the workbook. Unfortunately, this printing command center does not work as intended.</p>\n\n<p>The command center has only two columns. In column A is a list with the names of the other Sheets. In column B the user can specify how many copies to print of the respective sheet in column A.</p>\n\n<p>This is the current code:</p>\n\n<pre><code>Sub PrintSheets()\n    Dim mysheets As Range\n    For Each mySheets In Sheet1.Range(\"A2:A100\")\n    If mySheets.Offset(0, 1).Value &lt;&gt; \"\" Then Sheets(mySheets.Value).PrintOut Copies:=mySheets.Offset(0, 1).Value\n    Next mySheets\nEnd Sub\n</code></pre>\n\n<p>The first two sheets are printed as intended and then I get a \"Run-time error '9': Subscript out of range\"</p>\n\n<p>1) How can I fix the error? </p>\n\n<p>2) Can the list with the sheet names be generated automatically and sorted by their position (i.e., left to right in the sheet tab -> top to bottom in the column)?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1519158610, "post_id": 48893244, "comment_id": 84793052, "body": "Does it throw any error if the setting is disabled? FWIW all I&#39;m getting is a white border around the client area (Win7 Pro x64, 32-bit Office 2010)... is that the intended effect? Would be nice to include screenshots of &quot;expected vs actual&quot;. Also you should wrap the <code>Declare</code> functions in <code>#If</code> conditional compilation blocks, and provide VBA6 <i>and</i> VBA7 signatures.. are all clients using the same version &amp; bitness?"}, {"owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1519160851, "post_id": 48893244, "comment_id": 84794236, "body": "@mats-mug, I have updated the OP with some additional information"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1519164470, "post_id": 48893244, "comment_id": 84795837, "body": "If you&#39;re just not going to call it if the setting is disabled, what difference does it make, since the code doesn&#39;t error?"}, {"owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "edited": false, "score": 0, "creation_date": 1519165404, "post_id": 48893244, "comment_id": 84796190, "body": "Hi Rory, I would like to draw a border in the case that is disabled. I don&#39;t think the totally flat version clearly identifies the area as a userform."}], "owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519166670, "creation_date": 1519156649, "last_edit_date": 1531164843, "question_id": 48893244, "link": "https://stackoverflow.com/questions/48893244/vba-testing-desktop-composition", "title": "VBA Testing Desktop Composition", "body": "<p>I have a few excel projects which utilize userforms. Those userforms have some code which uses Windows API calls to modify their style. An example of this can be found here:</p>\n\n<pre><code>Private Declare PtrSafe Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\nPrivate Declare PtrSafe Function DwmSetWindowAttribute Lib \"dwmapi\" (ByVal hwnd As Long, ByVal attr As Integer, ByRef attrValue As Integer, ByVal attrSize As Integer) As Long\nPrivate Declare PtrSafe Function DwmExtendFrameIntoClientArea Lib \"dwmapi\" (ByVal hwnd As Long, ByRef NEWMARGINS As MARGINS) As Long\nPrivate UFSHADOW As Long\nPrivate Type MARGINS\n    leftWidth As Long\n    rightWidth As Long\n    topHeight As Long\n    bottomHeight As Long\nEnd Type\n\nSub all_userForms_AddShadow(frm As Object)\n'Sub adds a shadow\n\nDim MARGINS As MARGINS\n\nUFSHADOW = FindWindow(\"ThunderDFrame\", vbNullString) 'Create a new Window\n\nDwmSetWindowAttribute UFSHADOW, 2, 2, 4 'DWMAPI\n\n'Determine Margins\nWith MARGINS\n    .rightWidth = 1\n    .leftWidth = 1\n    .topHeight = 1\n    .bottomHeight = 1\nEnd With\n\nDwmExtendFrameIntoClientArea UFSHADOW, MARGINS 'DWMAPI\n\n'Resize\nfrm.Width = frm.Width - 1\nfrm.Height = frm.Height - 1\n\nEnd Sub\n</code></pre>\n\n<p>The issue is that on certain clients, this will compile fine, but the result will not be displayed when the userform is initialized. I believe this is because on some clients, the windows setting \"Enable Desktop Composition\" is disabled by default and unable to be modified. A workaround I plan on using is to test whether or not Desktop Composition is enabled and if it is not, I will not call the sub.</p>\n\n<p>My issue is that I cannot figure out how to test this. In the remarks section of this link <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa969524(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/aa969524(v=vs.85).aspx</a> describes what should be returned if the <code>DwmSetWindowAttribute</code> function fails: <code>DWM_E_COMPOSITIONDISABLED</code>. I have tried setting this function equal to a few variable types, but it will not work. </p>\n\n<p>Examples:</p>\n\n<p>Desktop Composition Disabled\n<a href=\"https://i.stack.imgur.com/kbKAP.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kbKAP.jpg\" alt=\"No Shadow Visible\"></a>\nDesktop Composition Enabled</p>\n\n<p><a href=\"https://i.stack.imgur.com/HaLSK.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HaLSK.jpg\" alt=\"Shadow Visible\"></a></p>\n\n<p>Any Suggestions? Thanks</p>\n\n<p>Edit: In response to Mat's Mug's questions:\nNo error is thrown, it simply just does not draw the shadow.</p>\n\n<p>You probably did not get the intended result as there are a few other API functions I call in relation to the \"Add Shadow\" sub which turn of the window caption and another which turns off the border. I can post those as well, but would make this post quite long.</p>\n\n<p>I am a bit new to using windows API functions, I don't quite know your comments on the IF conditionals and VB Signatures, but I am researching it now.. </p>\n\n<p>As far as the bitness go, it's very likely that this tool will be accessed on both 32 and 64 bit OS. update.. I have just tested on both versions, my local machine has 64bit OS, the problem version has 32bit</p>\n"}, {"tags": ["vba", "email", "ms-access"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1519157312, "post_id": 48892872, "comment_id": 84792367, "body": "FYI variables <code>StrSQL1</code> and <code>NameSpaceOutlook</code> are neither assigned nor used. Protip: avoid such wall-of-declarations-at-the-top, and declare variables immediately before you assign them. You&#39;ll reduce the constant back-and-forth scrolling up and down while debugging/maintaining the code, you&#39;ll easily avoid declaring variables you&#39;re not using, and you&#39;ll remove the &quot;need&quot; to have that <a href=\"https://www.joelonsoftware.com/2005/05/11/making-wrong-code-look-wrong/\" rel=\"nofollow noreferrer\">useless Systems Hungarian</a> prefix on everything, thereby doubly enhancing readability."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 9169197, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b589be7775ae21b764f01ff018cc066b?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/9169197/katie"}, "edited": false, "score": 0, "creation_date": 1520278341, "post_id": 48893659, "comment_id": 85241462, "body": "I made that change and it didn&#39;t work.  Now it returns that &#39;If&#39; condition in all cases--so even if there is only one record or multiple records in the recordset."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "reply_to_user": {"reputation": 105, "user_id": 9169197, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b589be7775ae21b764f01ff018cc066b?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/9169197/katie"}, "edited": false, "score": 0, "creation_date": 1520346971, "post_id": 48893659, "comment_id": 85271219, "body": "Yeah, sorry, you also need <code>rst.MoveNext</code> right after <code>rst.MoveFirst</code> for the cursor to actually hit the end of the recordset. I edited my answer."}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1520347047, "last_edit_date": 1520347047, "creation_date": 1519158409, "answer_id": 48893659, "question_id": 48892872, "link": "https://stackoverflow.com/questions/48892872/formatting-email-items-in-vba/48893659#48893659", "title": "Formatting email items in VBA", "body": "<p>I have found that <code>RecordCount</code> is not reliable with Access. I use something like <code>rst.BOF=true AND rst.EOF=true</code> to check for no returned records.</p>\n\n<p>To see if more than one record was returned use</p>\n\n<pre><code>rst.MoveNext    \nif rst.EOF=false then &lt;more than one record&gt;\n</code></pre>\n\n<p>right after</p>\n\n<pre><code>rst.MoveFirst\n</code></pre>\n\n<p>essentially checking if reading after the first record got you to the end of the data.</p>\n"}], "owner": {"reputation": 105, "user_id": 9169197, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b589be7775ae21b764f01ff018cc066b?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/9169197/katie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520347047, "creation_date": 1519155151, "last_edit_date": 1519155684, "question_id": 48892872, "link": "https://stackoverflow.com/questions/48892872/formatting-email-items-in-vba", "title": "Formatting email items in VBA", "body": "<p>I'm working on VBA to format an email that will have different text based on the values in the CheckReturnReason column in t1stNoticeEmails table.</p>\n\n<p>I'm trying to format it so that if the specific reason is only listed once in the table, the email is formatted a specific way with a table displayed inside of it, and if a reason is listed more than once, a spreadsheet is attached with the information.  This is how the code currently looks, which does not include anything addressing the Excel attachment for multiple entries.</p>\n\n<p>How would I include different formatting if rst2.RecordCount > 1?</p>\n\n<pre><code>Sub FirstEmail_DuplicatePayment_ReviewVBA()\nDim rst As DAO.Recordset\nDim olApp As Outlook.Application\nDim objMail As Outlook.MailItem\nDim rst2 As DAO.Recordset\nDim strTableBeg As String\nDim strTableBody As String\nDim strTableEnd As String\nDim strFntNormal As String\nDim strTableHeader As String\nDim strFntEnd As String\nDim CheckNum As String\nDim NameOfRecipient As String\nDim StrSQL1 As String\nDim NameSpaceOutlook As Outlook.Namespace\nDim sAddressText As String\nDim sAddress1 As Variant\nDim sAddress2 As Variant\nDim sAddressCity As Variant\nDim sAddressState As Variant\nDim sAddressZip As Variant\n\ngPARAttachment = \"S:\\UPAY\\Z_NewStructure\\...\"\n\n'SEND FIRST NOTICE EMAILS'\n'------------------'\n\nSet rst2 = CurrentDb.OpenRecordset(\"select distinct ContactEmails from t1stNoticeEmails WHERE CheckReturnReason = 'DuplicatePayment'\")\n\n\nIf rst2.RecordCount = 0 Then 'checks if recordset returns any records and continues if records found and exits if no records found\n    Exit Sub\nEnd If\n\nrst2.MoveFirst\n\n'Create e-mail item\nSet olApp = Outlook.Application\nSet objMail = olApp.CreateItem(olMailItem)\n\n'Do Until rst2.EOF\n\nSet olApp = Outlook.Application\nSet objMail = olApp.CreateItem(olMailItem)\n\n'Define format for output\nstrTableBeg = \"&lt;table border=1 cellpadding=3 cellspacing=0&gt;\"\nstrTableEnd = \"&lt;/table&gt;\"\nstrTableHeader = \"&lt;font size=3 face='Calibri'&gt;&lt;b&gt;\" &amp; _\n                    \"&lt;tr bgcolor=#4DB84D&gt;\" &amp; _\n                        td(\"CheckNumber\") &amp; _\n                        td(\"PayeeName\") &amp; _\n                        td(\"VendorID\") &amp; _\n                        td(\"DocNo / ERNo / PONo\") &amp; _\n                        td(\"Amount\") &amp; _\n                        td(\"CheckDate\") &amp; _\n                        \"&lt;/tr&gt;&lt;/b&gt;&lt;/font&gt;\"\nstrFntNormal = \"&lt;font color=black face='Calibri' size=3&gt;\"\nstrFntEnd = \"&lt;/font&gt;\"\n\nSet rst = CurrentDb.OpenRecordset(\"SELECT * FROM t1stNoticeEmails where ContactEmails='\" &amp; rst2!ContactEmails &amp; \"' AND CheckReturnReason = 'DuplicatePayment' \" _\n&amp; \"Order by FullName asc\")\n\nIf rst.RecordCount = 0 Then\n    rst2.Close\n    Set rst2 = Nothing\n    Exit Sub\nEnd If\n\nsAddress1 = rst!OriginalCheckAddress1\nsAddress2 = rst!OriginalCheckAddress2\nsAddressCity = rst!OriginalCheckCity\nsAddressState = rst!OriginalCheckState\nsAddressZip = rst!OriginalCheckZip\nsAddressText = \"&lt;Font face='Calibri'&gt;\" _\n&amp; \"The following check(s) sent to \" _\n&amp; sAddress1 &amp; \" \" &amp; sAddress2 &amp; \" \" &amp; sAddressCity &amp; \" \" &amp; sAddressState &amp; \" \" &amp; sAddressZip _\n&amp; \" have been returned to the University by the payee. &lt;br&gt;&lt;br&gt;\"\n\nrst.MoveFirst\n\nNameOfRecipient = rst!FullName\nCheckNum = rst!CheckNumber\n\n'Build HTML Output for the DataSet\nstrTableBody = strTableBeg &amp; strFntNormal &amp; strTableHeader\n\nDo Until rst.EOF\n    strTableBody = _\n    strTableBody &amp; _\n    \"&lt;tr&gt;\" &amp; _\n    \"&lt;TD nowrap&gt;\" &amp; rst!CheckNumber &amp; \"&lt;/TD&gt;\" &amp; _\n    \"&lt;TD nowrap&gt;\" &amp; rst!FullName &amp; \"&lt;/TD&gt;\" &amp; _\n    \"&lt;TD nowrap&gt;\" &amp; rst![VendorID/UIN] &amp; \"&lt;/TD&gt;\" &amp; _\n    \"&lt;TD nowrap&gt;\" &amp; rst![DocNo / ERNo / PONo] &amp; \"&lt;/TD&gt;\" &amp; _\n    \"&lt;TD align='right' nowrap&gt;\" &amp; Format(rst!AmountDue, \"currency\") &amp; \"&lt;/TD&gt;\" &amp; _\n    \"&lt;TD nowrap&gt;\" &amp; rst!OriginalCheckDate &amp; \"&lt;/TD&gt;\" &amp; _\n    \"&lt;/tr&gt;\"\n    rst.MoveNext\nLoop\n'rst.MoveFirst\n\nstrTableBody = strTableBody &amp; strFntEnd &amp; strTableEnd\n\n'rst.Close\n\n'Set rst2 = CurrentDb.OpenRecordset(\"select distinct ch_email from t_TCard_CH_Email\")\n'rst2.MoveFirst\n\n\n\nCall CaptureDPBodyText\n\nWith objMail\n    'Set body format to HTML\n    .To = rst2!ContactEmails\n    .BCC = gDPEmailBCC\n    .Subject = gDPEmailSubject &amp; \" - Check# \" &amp; CheckNum &amp; \" - \" &amp; NameOfRecipient\n    .BodyFormat = olFormatHTML\n\n    .HTMLBody = .HTMLBody\n\n    .HTMLBody = .HTMLBody &amp; \"&lt;HTML&gt;&lt;BODY&gt;\" &amp; strFntNormal &amp; sAddressText &amp; strTableBody &amp; \" &lt;/BODY&gt;&lt;/HTML&gt;\"\n\n    .HTMLBody = .HTMLBody &amp; gDPBodySig\n\n    .SentOnBehalfOfName = \"...\"\n    .Attachments.Add gPARAttachment\n    .Display\n    '.Send\nEnd With\n\nrst2.MoveNext\n\n'Loop\n\nrst.Close\nSet rst = Nothing\nrst2.Close\nSet rst2 = Nothing\n\nEnd Sub`\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 181, "user_id": 8716356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94a4135b0d5c80f8f69ad528b94d89b4?s=128&d=identicon&r=PG&f=1", "display_name": "SQLCliff", "link": "https://stackoverflow.com/users/8716356/sqlcliff"}, "edited": false, "score": 1, "creation_date": 1519154359, "post_id": 48892623, "comment_id": 84790875, "body": "You can remove the ORDER BY part, as it won&#39;t do anything. ORDER BY is about output, not input. Here, you&#39;re putting records into a table, not reading them out. Not scolding, just helping you simplify your problems. Still thinking about the rest of it... just thought I&#39;d add the side note."}, {"owner": {"reputation": 181, "user_id": 8716356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94a4135b0d5c80f8f69ad528b94d89b4?s=128&d=identicon&r=PG&f=1", "display_name": "SQLCliff", "link": "https://stackoverflow.com/users/8716356/sqlcliff"}, "edited": false, "score": 0, "creation_date": 1519154510, "post_id": 48892623, "comment_id": 84790936, "body": "have you stepped through the code or used a watch to make sure the value of strSql is what you think it is when it hits DoCmd?"}, {"owner": {"reputation": 503, "user_id": 1241307, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8315fcc03b6ee64131da447c340ccd49?s=128&d=identicon&r=PG", "display_name": "FrugalTPH", "link": "https://stackoverflow.com/users/1241307/frugaltph"}, "reply_to_user": {"reputation": 181, "user_id": 8716356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94a4135b0d5c80f8f69ad528b94d89b4?s=128&d=identicon&r=PG&f=1", "display_name": "SQLCliff", "link": "https://stackoverflow.com/users/8716356/sqlcliff"}, "edited": false, "score": 0, "creation_date": 1519163194, "post_id": 48892623, "comment_id": 84795300, "body": "Yeah, I wasn&#39;t really precious about ORDER BY as I can do the ordering in the XSLT script to render the XML."}, {"owner": {"reputation": 503, "user_id": 1241307, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8315fcc03b6ee64131da447c340ccd49?s=128&d=identicon&r=PG", "display_name": "FrugalTPH", "link": "https://stackoverflow.com/users/1241307/frugaltph"}, "reply_to_user": {"reputation": 181, "user_id": 8716356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94a4135b0d5c80f8f69ad528b94d89b4?s=128&d=identicon&r=PG&f=1", "display_name": "SQLCliff", "link": "https://stackoverflow.com/users/8716356/sqlcliff"}, "edited": false, "score": 0, "creation_date": 1519163371, "post_id": 48892623, "comment_id": 84795390, "body": "I had stepped through the code and the strSql was fine at the point of execution. I even ran strSql as a normal SELECT query in the GUI (removing the &quot;INTO rpt_TEMP&quot; part), and it returned the desired results.   I&#39;d still be interested to find out why the WHERE clause didn&#39;t work as part of the INTO query. Perhaps that&#39;s a limitation of SQL?"}], "answers": [{"comments": [{"owner": {"reputation": 503, "user_id": 1241307, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8315fcc03b6ee64131da447c340ccd49?s=128&d=identicon&r=PG", "display_name": "FrugalTPH", "link": "https://stackoverflow.com/users/1241307/frugaltph"}, "edited": false, "score": 0, "creation_date": 1519163114, "post_id": 48893265, "comment_id": 84795259, "body": "Just incorporated this in my application, and it solved my problem. I added in a line immediately before CurrentDb.TableDefs.Append td to delete the temp table if it already exists."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1519156732, "creation_date": 1519156732, "answer_id": 48893265, "question_id": 48892623, "link": "https://stackoverflow.com/questions/48892623/filtered-ordered-form-datasheet-to-local-table/48893265#48893265", "title": "Filtered &amp; ordered form datasheet to local table", "body": "<p>You can solve this problem pretty easily by using a helper function that outputs a recordset to a table.</p>\n\n<p>Helper function:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub RecordSetToTable(rs As DAO.Recordset, tableName As String)\n    Dim td As DAO.TableDef\n    Set td = CurrentDb.CreateTableDef(tableName)\n    Dim fld As DAO.Field\n    For Each fld In rs.Fields\n        td.Fields.Append td.CreateField(fld.Name, fld.Type, fld.Size)\n    Next\n    CurrentDb.TableDefs.Append td\n    Dim tableRS As DAO.Recordset\n    Set tableRS = CurrentDb.OpenRecordset(tableName)\n    rs.MoveFirst\n    Do While Not rs.EOF\n        tableRS.AddNew\n        For Each fld In rs.Fields\n            tableRS.Fields(fld.Name).Value = fld.Value\n        Next\n        tableRS.Update\n        rs.MoveNext\n    Loop\nEnd Sub\n</code></pre>\n\n<p>On the form:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub CacheLocalTemp()\n     RecordSetToTable Me.Recordset, \"rpt_TEMP\"\nEnd Sub\n</code></pre>\n\n<p>No messing around with constructing queries, ordering, etc. Just write the recordset straight to a new table.</p>\n"}], "owner": {"reputation": 503, "user_id": 1241307, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8315fcc03b6ee64131da447c340ccd49?s=128&d=identicon&r=PG", "display_name": "FrugalTPH", "link": "https://stackoverflow.com/users/1241307/frugaltph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 48893265, "answer_count": 1, "score": 1, "last_activity_date": 1519156732, "creation_date": 1519154089, "last_edit_date": 1519155404, "question_id": 48892623, "link": "https://stackoverflow.com/questions/48892623/filtered-ordered-form-datasheet-to-local-table", "title": "Filtered &amp; ordered form datasheet to local table", "body": "<p>I've been struggling all afternoon to write a function that will cache the displayed records in a form datasheet to a temporary table. </p>\n\n<p>The use-case is that the user uses the datasheet auto-filters &amp; sorting to get the records into their desired form. Then they're running a report function that outputs what they see as xml, runs it through an xslt transform to html. I can't get MSXML working direct from queries, hence the need for a local cached copy of what the user sees in the form datasheet. </p>\n\n<p>What I have so far works, but seemingly ignores the filter &amp; order by clauses in the sql string. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub CacheLocalTemp()\n\n      Dim strSql As String: strSql = \"SELECT * INTO rpt_TEMP FROM tbl_Outputs\"\n\n      If Len(Me.Filter) &gt; 0 Then\n          strSql = strSql &amp; \" WHERE \" &amp; Me.Filter\n      End If\n\n      If Len(Me.OrderBy) &gt; 0 Then\n          strSql = strSql &amp; \" ORDER BY \" &amp; Me.OrderBy\n      End If\n\n      DoCmd.SetWarnings False\n          DoCmd.RunSQL strSql\n      DoCmd.SetWarnings True\n\nEnd Sub\n</code></pre>\n\n<p>I've seen methods using INSERT and SELECT INTO VALUES (x, y z), but didn't want to go down this route as it would mean I need to hard-code all field names, and there are a lot over about 10 different forms. </p>\n\n<p>All the code I'm finding is long-winded / excessive, and I am astounded there isn't a more elegant / straight-forward way of just dumping a snapshot copy of what is displayed in the datasheet straight into its own table. </p>\n\n<p>Any help would be much appreciated. Thanks.</p>\n"}, {"tags": ["vba", "excel", "barcode-scanner", "excel-2016"], "comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1519154183, "post_id": 48892504, "comment_id": 84790802, "body": "Have a look at this link <a href=\"https://www.myonlinetraininghub.com/create-barcodes-with-excel-vba\" rel=\"nofollow noreferrer\">Create Barcodes With (Or Without) Excel VBA</a>"}, {"owner": {"reputation": 31, "user_id": 7897402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L6Zvb.jpg?s=128&g=1", "display_name": "Lex", "link": "https://stackoverflow.com/users/7897402/lex"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1519154604, "post_id": 48892504, "comment_id": 84790981, "body": "Thank you @YasserKhail. However, this shows how to create the barcodes. What I would like read a barcode from a printed paper to a cell in Microsoft excel"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1519155363, "post_id": 48892504, "comment_id": 84791353, "body": "The space between <code>Range(&quot;A1&quot;).</code> and <code>Value</code> would be illegal, for one. <code>Input</code> is a reserved keyword, used for reading text or binary data from files. So your question is basically, <i>what tools and/or libraries can I use with VBA to read barcodes?</i>, correct?"}, {"owner": {"reputation": 31, "user_id": 7897402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L6Zvb.jpg?s=128&g=1", "display_name": "Lex", "link": "https://stackoverflow.com/users/7897402/lex"}, "edited": false, "score": 0, "creation_date": 1519156632, "post_id": 48892504, "comment_id": 84792035, "body": "@Mat...let&#39;s say you have 123456678 barcode on a paper. I want to read this barcode and enter the read value (12345...) in a cell, say, A1."}, {"owner": {"reputation": 31, "user_id": 7897402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L6Zvb.jpg?s=128&g=1", "display_name": "Lex", "link": "https://stackoverflow.com/users/7897402/lex"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1519156680, "post_id": 48892504, "comment_id": 84792053, "body": "@Mat&#39;sMug Yes, what libs?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1519156685, "post_id": 48892504, "comment_id": 84792056, "body": "If you select a cell and read a barcode, then as long as your reader is configured to append a newline/enter after the barcode it will work just fine.  You don&#39;t need any code to do this, and there is no &quot;translation&quot; required: the reader will send the barcode value just as if you&#39;d typed it in manually and hit Enter.  Should also work for inputbox."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1519156782, "post_id": 48892504, "comment_id": 84792113, "body": "A barcode scanner is nothing but a fancypants keyboard... treat it as you would a keyboard."}, {"owner": {"reputation": 31, "user_id": 7897402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L6Zvb.jpg?s=128&g=1", "display_name": "Lex", "link": "https://stackoverflow.com/users/7897402/lex"}, "edited": false, "score": 0, "creation_date": 1519157453, "post_id": 48892504, "comment_id": 84792436, "body": "Ooh, OK! Looks like the solution is easier! Let me try"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1519161283, "post_id": 48892504, "comment_id": 84794451, "body": "I used a scanner to read barcodes from products into excel for years.  It&#39;s really just point and scan.  If I remember it will just go to the next row of whatever column you are in."}], "answers": [{"tags": [], "owner": {"reputation": 1355, "user_id": 3097559, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lvowV.jpg?s=128&g=1", "display_name": "tysonwright", "link": "https://stackoverflow.com/users/3097559/tysonwright"}, "is_accepted": false, "score": 0, "last_activity_date": 1519167362, "creation_date": 1519167362, "answer_id": 48895549, "question_id": 48892504, "link": "https://stackoverflow.com/questions/48892504/excel-vba-to-read-code-128-barcode/48895549#48895549", "title": "Excel VBA to read Code 128 barcode", "body": "<p>You need the barcode fonts installed, and your barcode reader set up to write to the cell you're interested in. The scanner really does work like a keyboard - it will read the code and 'type' the results wherever you direct it to. This isn't something you do in VBA (unless I'm misunderstanding your question).</p>\n"}], "owner": {"reputation": 31, "user_id": 7897402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L6Zvb.jpg?s=128&g=1", "display_name": "Lex", "link": "https://stackoverflow.com/users/7897402/lex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1815, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519167362, "creation_date": 1519153612, "last_edit_date": 1531164843, "question_id": 48892504, "link": "https://stackoverflow.com/questions/48892504/excel-vba-to-read-code-128-barcode", "title": "Excel VBA to read Code 128 barcode", "body": "<p>I am trying to create a VBA code to read input from a barcode scanner. Specifically I'm interested in reading code 128 barcodes. I read on a different post that the barcode scanner is basically a \"keyboard\" that types the input when scanning to the application. I don't whether this can be replicated in Excel using VBA. Any ideas will be appreciated.\nI am looking for something like this:</p>\n\n<pre><code>Sub BarcodeScannerReader()\n   Dim sMyCode As String\n   sMyCode=input(\"Scan Code:\")\n   Range(\"A1\"). Value=sMyCode\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "internet-explorer"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9387444, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N3jTXlgQLh0/AAAAAAAAAAI/AAAAAAAAChk/I_mCAZ5iIqQ/photo.jpg?sz=128", "display_name": "Gustavo R", "link": "https://stackoverflow.com/users/9387444/gustavo-r"}, "edited": false, "score": 0, "creation_date": 1519674695, "post_id": 48903331, "comment_id": 84997405, "body": "That worked perfectly. Now, i would like to copy the entire new page, with the required data to then paste on my worksheet and work with the numbers.  Can you help me on that?  I&#39;ve tried:          IE.execWB 17, 0         IE.execWB 12, 0  but it copied the page #1, the original one and not the new one with the data."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 1, "user_id": 9387444, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N3jTXlgQLh0/AAAAAAAAAAI/AAAAAAAAChk/I_mCAZ5iIqQ/photo.jpg?sz=128", "display_name": "Gustavo R", "link": "https://stackoverflow.com/users/9387444/gustavo-r"}, "edited": false, "score": 0, "creation_date": 1519678085, "post_id": 48903331, "comment_id": 84998981, "body": "First check it out <a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question</a>? You can always open a new thread to ask a new question."}], "tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": false, "score": 0, "last_activity_date": 1519208221, "creation_date": 1519208221, "answer_id": 48903331, "question_id": 48892307, "link": "https://stackoverflow.com/questions/48892307/vba-to-click-html-input-radio-button/48903331#48903331", "title": "VBA to click HTML Input Radio button", "body": "<p>Try the below approach. The script will first click on <code>IRF-M</code> and then <code>Consultar</code>. However, when the both click are successfully initiated then you will see a new window with the required data you are after.</p>\n\n<pre><code>Sub Get_Data()\n\n    With CreateObject(\"InternetExplorer.Application\")\n        .Visible = True\n        .navigate \"http://www.anbima.com.br/ima/ima.asp\"\n        While .Busy = True Or .readyState &lt; 4: DoEvents: Wend\n\n        .document.querySelector(\"input[value='irf-m']\").Click\n        .document.querySelector(\"img[name='Consultar']\").Click\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9387444, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N3jTXlgQLh0/AAAAAAAAAAI/AAAAAAAAChk/I_mCAZ5iIqQ/photo.jpg?sz=128", "display_name": "Gustavo R", "link": "https://stackoverflow.com/users/9387444/gustavo-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1164, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519208221, "creation_date": 1519152762, "last_edit_date": 1519154181, "question_id": 48892307, "link": "https://stackoverflow.com/questions/48892307/vba-to-click-html-input-radio-button", "title": "VBA to click HTML Input Radio button", "body": "<p>i would like a vba code to go to this url \"<a href=\"http://www.anbima.com.br/ima/ima.asp\" rel=\"nofollow noreferrer\">http://www.anbima.com.br/ima/ima.asp</a>\", then click on the \"IRF-M\" button, then click on the \"Consultar\" button.</p>\n\n<p>I've tried this but failed miserably:</p>\n\n<pre><code>'inserir website com os valores a serem buscados\nsitedv01 = \"http://www.anbima.com.br/ima/ima.asp\"\n\n'busca no site\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\nIE.Visible = True\n\nIE.navigate sitedv01\n\n'espera o carregamento\nDo While IE.Busy\n    Application.Wait DateAdd(\"s\", 1, Now)\nLoop\n\nSet tags = IE.document.getElementsByValue(\"irf-m\")\nFor Each tagx In tags\n    If tagx.src = \"http://www.bmf.com.br/bmfbovespa/images/comum/mais.gif\" Then\n        tagx.Click\n    End If\nNext\n</code></pre>\n"}, {"tags": ["excel", "html-table", "html-tableextract", "vba"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1519151120, "post_id": 48891879, "comment_id": 84789168, "body": "You need to wait for the page to load &amp; &quot;grid sc&quot; is not a TagName."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1519151264, "post_id": 48891879, "comment_id": 84789249, "body": "<i>grid sc</i> is <b>not</b> an html tag name; probably a class."}], "answers": [{"tags": [], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "is_accepted": true, "score": 0, "last_activity_date": 1519153574, "last_edit_date": 1519153574, "creation_date": 1519151869, "answer_id": 48892097, "question_id": 48891879, "link": "https://stackoverflow.com/questions/48891879/results-extraction-from-website/48892097#48892097", "title": "Results extraction from website", "body": "<p>Try that code</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>    Sub Test()\r\n        Dim ie              As New InternetExplorer\r\n        Dim competitionLink As String\r\n        Dim rank            As String\r\n\r\n        competitionLink = ThisWorkbook.Worksheets(\"Settings\").Range(\"B2\")\r\n\r\n        With ie\r\n            .Visible = True\r\n            .navigate competitionLink\r\n            Do: DoEvents: Loop Until .readyState = 4\r\n\r\n            rank = .document.getElementsByClassName(\"grid sc\")(0).Rows(1).Cells(2).innerText\r\n            Debug.Print rank\r\n        End With\r\n    End Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>** You can also grab all the table data .. Have a look at this link\n<a href=\"https://stackoverflow.com/questions/48850470/scrape-a-html-table-using-excel-vba\">Scrape HTML Table</a></p>\n"}], "owner": {"reputation": 1, "user_id": 6764872, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205248265964517/picture?type=large", "display_name": "Alvija Gra\u017eulyt\u0117", "link": "https://stackoverflow.com/users/6764872/alvija-gra%c5%beulyt%c4%97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 48892097, "answer_count": 1, "score": -1, "last_activity_date": 1519153574, "creation_date": 1519151033, "last_edit_date": 1531164843, "question_id": 48891879, "link": "https://stackoverflow.com/questions/48891879/results-extraction-from-website", "title": "Results extraction from website", "body": "<p>I was trying to extract results from similar table:</p>\n\n<p><a href=\"https://data.fei.org/Result/ResultList.aspx?p=D6E828828E450E2880525ABCEE800008C1D381967CBAF718D9DE41BEBA3B9F06\" rel=\"nofollow noreferrer\">https://data.fei.org/Result/ResultList.aspx?p=D6E828828E450E2880525ABCEE800008C1D381967CBAF718D9DE41BEBA3B9F06</a></p>\n\n<p>I have applied following code but doesn't seem to work. Any ideas on what table elements should be used?:</p>\n\n<pre><code>Sub Macro1()\nDim IE As New InternetExplorer\nDim CompetitionLink As String\nCompetitionLink = ThisWorkbook.Worksheets(\"Settings\").Range(\"B2\")\nIE.Navigate CompetitionLink\nIE.Visible = True\n\nRank = IE.Document.getElementsByTagName(\"grid sc\")(0).Rows(1).Cells(2).innerText\n\nDebug.Print Rank\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1519152593, "last_edit_date": 1519152593, "creation_date": 1519151999, "answer_id": 48892128, "question_id": 48891831, "link": "https://stackoverflow.com/questions/48891831/vba-find-cell-from-list-column/48892128#48892128", "title": "VBA - Find Cell from List (column)", "body": "<ol>\n<li>Find our lastrow value on Tab2</li>\n<li>Loop through all the cell values in column A of Tab2. If one of those cell values equals our value in A1 on Tab1, activate Tab2 (if not already active) and select the entire row.</li>\n</ol>\n\n<p><code>Sub Test()</code></p>\n\n<pre><code>lastrow = Worksheets(\"Tab2\").Cells(Worksheets(\"Tab2\").Rows.Count, \"A\").End(xlUp).Row\n\nFor i = 1 To lastrow\n    If Worksheets(\"Tab2\").Range(\"A\" &amp; i).Value = Worksheets(\"Tab1\").Range(\"A1\").Value Then\n        Worksheets(\"Tab2\").Activate\n        Worksheets(\"Tab2\").Rows(i).EntireRow.Select\n        Exit For\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>EDIT: This numbered list formatting is giving me a headache...</p>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1519159326, "creation_date": 1519159326, "answer_id": 48893867, "question_id": 48891831, "link": "https://stackoverflow.com/questions/48891831/vba-find-cell-from-list-column/48893867#48893867", "title": "VBA - Find Cell from List (column)", "body": "<p>You can try this</p>\n\n<pre><code>Sub Test()\n    Dim found As Range\n    With Worksheets(\"Tab2\")\n        Set found = .Range(\"A1:A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row).Find(What:=Worksheets(\"Tab1\").Range(\"A1\").Value, LookIn:=xlValues, lookAt:=xlWhole)\n        If Not found Is Nothing Then\n            .Activate\n            found.EntireRow.Select\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9387266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/9387266/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 245, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519159326, "creation_date": 1519150851, "question_id": 48891831, "link": "https://stackoverflow.com/questions/48891831/vba-find-cell-from-list-column", "title": "VBA - Find Cell from List (column)", "body": "<p>First time asking a question here. Finding it hard to find an answer even if I'm sure it already exists but hoping you can help me out.</p>\n\n<p>So I have cell A1 in Tab1 that I need to find in column A of Tab2 and make it the active cell and select the entire row. How do I do that?</p>\n\n<p>It seems pretty simple but for some reason, I can't get to this solution. Can someone help? Thanks!</p>\n"}, {"tags": ["vba", "ms-access", "subform"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9299874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76bc4857be4294039ff7d4d57325891?s=128&d=identicon&r=PG&f=1", "display_name": "RSD", "link": "https://stackoverflow.com/users/9299874/rsd"}, "edited": false, "score": 0, "creation_date": 1519150131, "post_id": 48891545, "comment_id": 84788621, "body": "Thank you for the quick response. I tried to add your code to the Close button when adding a new task (And also a test button on the main page) But i get error 2465 &quot;can&#39;t find the field &#39;Task_List&#39; referred...&quot;"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 25, "user_id": 9299874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76bc4857be4294039ff7d4d57325891?s=128&d=identicon&r=PG&f=1", "display_name": "RSD", "link": "https://stackoverflow.com/users/9299874/rsd"}, "edited": false, "score": 0, "creation_date": 1519150192, "post_id": 48891545, "comment_id": 84788656, "body": "Are you sure the subform <i>control name</i>, not the <i>form name</i> is Task_List? Also, if you&#39;re using a navigation control, you need to specify that."}, {"owner": {"reputation": 25, "user_id": 9299874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76bc4857be4294039ff7d4d57325891?s=128&d=identicon&r=PG&f=1", "display_name": "RSD", "link": "https://stackoverflow.com/users/9299874/rsd"}, "edited": false, "score": 0, "creation_date": 1519150231, "post_id": 48891545, "comment_id": 84788681, "body": "How do I check the control name?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 25, "user_id": 9299874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76bc4857be4294039ff7d4d57325891?s=128&d=identicon&r=PG&f=1", "display_name": "RSD", "link": "https://stackoverflow.com/users/9299874/rsd"}, "edited": false, "score": 0, "creation_date": 1519150259, "post_id": 48891545, "comment_id": 84788692, "body": "You click on the control, open up the property sheet, and check the name property"}, {"owner": {"reputation": 25, "user_id": 9299874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76bc4857be4294039ff7d4d57325891?s=128&d=identicon&r=PG&f=1", "display_name": "RSD", "link": "https://stackoverflow.com/users/9299874/rsd"}, "edited": false, "score": 0, "creation_date": 1519150841, "post_id": 48891545, "comment_id": 84789005, "body": "The datasheet name is &quot;Task_List&quot;. I do have a textbox named &quot;Task_Title&quot; and tried using that instead but same thing. The datasheets record source is: Task_Query_Priority_1_High. I free like something simple is just flying over my head here... I don&#39;t no why I am struggling so much"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 25, "user_id": 9299874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76bc4857be4294039ff7d4d57325891?s=128&d=identicon&r=PG&f=1", "display_name": "RSD", "link": "https://stackoverflow.com/users/9299874/rsd"}, "edited": false, "score": 0, "creation_date": 1519151038, "post_id": 48891545, "comment_id": 84789127, "body": "Start by supplying the right information. Your question states the subform is named Task_List, and that that subform contains 2 datasheet forms. I can&#39;t help you if your answer contains wrong information."}, {"owner": {"reputation": 25, "user_id": 9299874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76bc4857be4294039ff7d4d57325891?s=128&d=identicon&r=PG&f=1", "display_name": "RSD", "link": "https://stackoverflow.com/users/9299874/rsd"}, "edited": false, "score": 0, "creation_date": 1519151453, "post_id": 48891545, "comment_id": 84789350, "body": "Yes it does, (Main_Hub) has navigation button that has target (Task_List). Task_List form contains 1 button to add task and 3 Datasheet forms (Task_Form_Priority_1_High), med, and low. Those datasheet use queries as there record source (Task_Query_Priority_1_High), med, low."}, {"owner": {"reputation": 25, "user_id": 9299874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76bc4857be4294039ff7d4d57325891?s=128&d=identicon&r=PG&f=1", "display_name": "RSD", "link": "https://stackoverflow.com/users/9299874/rsd"}, "edited": false, "score": 0, "creation_date": 1519152339, "post_id": 48891545, "comment_id": 84789866, "body": "Figured out issue. Because Task_List is called from a Nav button it is place on a NavigationSubForm control. code works when that is switched."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1519149786, "creation_date": 1519149786, "answer_id": 48891545, "question_id": 48891468, "link": "https://stackoverflow.com/questions/48891468/requery-datasheet-in-subform-from-main-form/48891545#48891545", "title": "Requery Datasheet in Subform from Main form", "body": "<p>You can trim down through all the forms in the following way:</p>\n\n<pre><code>Forms!Main_Hub!Task_List.Form!Task_Form_Priority_1_High.Form.Requery\n</code></pre>\n\n<p>The general syntax is:</p>\n\n<pre><code>Forms!MainForm!SubFormControlName1.Form!SubformControlName2.Form\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9299874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76bc4857be4294039ff7d4d57325891?s=128&d=identicon&r=PG&f=1", "display_name": "RSD", "link": "https://stackoverflow.com/users/9299874/rsd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1519, "favorite_count": 0, "accepted_answer_id": 48891545, "answer_count": 1, "score": 0, "last_activity_date": 1609629536, "creation_date": 1519149457, "last_edit_date": 1609629536, "question_id": 48891468, "link": "https://stackoverflow.com/questions/48891468/requery-datasheet-in-subform-from-main-form", "title": "Requery Datasheet in Subform from Main form", "body": "<p>I am using Access 2013.</p>\n<p>I am coding a requery on a datasheet inside a subform.</p>\n<p>My setup:</p>\n<ul>\n<li>Using a navigation form with top and side buttons.</li>\n<li>Main active form is (Main_Hub)</li>\n<li>When Task tab is active the subform is (Task_List)</li>\n<li>On that subform are 3 datasheet forms (Task_Form_Priority_1_High) etc...</li>\n</ul>\n<p>This is when the issue starts</p>\n<ul>\n<li>After adding a new task the datasheet form (Task_Form_Priority_1_High) does not update unless I click on the Task button (either the main task tab button or the side tab button)</li>\n</ul>\n<p>I know I need to use something with <code>Forms!subform!form.requery</code>.</p>\n<p>Here is an image of the form:<br />\n<a href=\"https://i.stack.imgur.com/nWXA3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nWXA3.jpg\" alt=\"enter image description here\" /></a></p>\n<p>Edit:<br />\n(Main_Hub) has navigation button that has target (Task_List).<br />\nTask_List form contains 1 button to add task and 3 Datasheet forms (Task_Form_Priority_1_High), med, and low.<br />\nThose datasheet use queries as there record source (Task_Query_Priority_1_High), med, low.</p>\n"}, {"tags": ["arrays", "vba", "matrix", "diagonal"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1519148705, "post_id": 48891243, "comment_id": 84787780, "body": "What&#39;s the <i>problem</i> you&#39;re having?  Do you get an error message?  What does it do <i>instead</i> of work?"}, {"owner": {"reputation": 11, "user_id": 9387077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a4d1602ec30fb57481d1b34af956c39?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Block", "link": "https://stackoverflow.com/users/9387077/robert-block"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519148914, "post_id": 48891243, "comment_id": 84787909, "body": "I just get #VALUE! when I call the function"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519148984, "post_id": 48891243, "comment_id": 84787954, "body": "Try calling the function from a Sub instead - that will give you a more-useful error message."}, {"owner": {"reputation": 11, "user_id": 9387077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a4d1602ec30fb57481d1b34af956c39?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Block", "link": "https://stackoverflow.com/users/9387077/robert-block"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519149574, "post_id": 48891243, "comment_id": 84788312, "body": "From what I can see I get a type mismatch when I divide c(i)/temp. Do i need temp As Variant ?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519149682, "post_id": 48891243, "comment_id": 84788370, "body": "What are <code>c(i)</code> and <code>temp</code> when it errors?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519149708, "post_id": 48891243, "comment_id": 84788381, "body": "Remove the <code>()</code> from the <code>Dim</code> statement. <code>Dim temp As Double</code>"}, {"owner": {"reputation": 11, "user_id": 9387077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a4d1602ec30fb57481d1b34af956c39?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Block", "link": "https://stackoverflow.com/users/9387077/robert-block"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519150469, "post_id": 48891243, "comment_id": 84788811, "body": "Thank you @ScottCraner that was causing the type mismatch. I changed the function to a variant type and the variable x() to a variant type as well so I am returning the same type. I now get an error saying the subscript is out of range for the fourth line c(1) = c(1)/b(1). Any ideas?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519150705, "post_id": 48891243, "comment_id": 84788929, "body": "Well without seeing the data inputs it is hard to know.  you will need to look into the Locals window to ensure that the arrays have an item at that location."}, {"owner": {"reputation": 11, "user_id": 9387077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a4d1602ec30fb57481d1b34af956c39?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Block", "link": "https://stackoverflow.com/users/9387077/robert-block"}, "edited": false, "score": 0, "creation_date": 1519151384, "post_id": 48891243, "comment_id": 84789313, "body": "Looking at my locals window...the a,b,c,d arrays seem to all have the values that I had input on my worksheet. I posted the data above."}, {"owner": {"reputation": 11, "user_id": 9387077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a4d1602ec30fb57481d1b34af956c39?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Block", "link": "https://stackoverflow.com/users/9387077/robert-block"}, "edited": false, "score": 0, "creation_date": 1519151789, "post_id": 48891243, "comment_id": 84789569, "body": "Ive also added in my Sub for reference"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519156895, "post_id": 48891243, "comment_id": 84792170, "body": "Your <code>ArrayA</code>, etc in the calling sub are 2-D arrays (1 to 9, 1 to 1), so you need to account for that."}, {"owner": {"reputation": 11, "user_id": 9387077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a4d1602ec30fb57481d1b34af956c39?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Block", "link": "https://stackoverflow.com/users/9387077/robert-block"}, "edited": false, "score": 0, "creation_date": 1519159587, "post_id": 48891243, "comment_id": 84793565, "body": "Thanks Tim I recently realized that the 2-D arrays were the problem and was finally able to get a solution."}, {"owner": {"reputation": 11, "user_id": 9387077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a4d1602ec30fb57481d1b34af956c39?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Block", "link": "https://stackoverflow.com/users/9387077/robert-block"}, "edited": false, "score": 0, "creation_date": 1519159713, "post_id": 48891243, "comment_id": 84793639, "body": "Edited in the resolved code"}], "owner": {"reputation": 11, "user_id": 9387077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a4d1602ec30fb57481d1b34af956c39?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Block", "link": "https://stackoverflow.com/users/9387077/robert-block"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 278, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519159681, "creation_date": 1519148603, "last_edit_date": 1519159681, "question_id": 48891243, "link": "https://stackoverflow.com/questions/48891243/tri-diagonal-matrix-in-vba", "title": "Tri-Diagonal Matrix in VBA", "body": "<p><a href=\"https://i.stack.imgur.com/XQrRj.png\" rel=\"nofollow noreferrer\">The array data</a> </p>\n\n<p>In using cubic spline interpolation, I need to solve a tri-diagonal matrix to get the coefficients. Given four arrays ( first 3 are the diagonals of the matrix, and the fourth is the vector b for A^-1*b = x), I want to return an array that will be my M-values. Once I have the M-values I can calculate the coefficients. </p>\n\n<p>I am pretty unfamiliar with VBA so I am not sure that I am passing the arrays correctly, but my code is as follows:</p>\n\n<pre><code>Function DiagSolv(a() As Variant, b() As Variant, c() As Variant, d() As Variant) As Variant\n\nDim N As Double\n\nN = 9  \n\nc(1, 1) = c(1, 1) / b(1, 1)\n\nd(1, 1) = d(1, 1) / b(1, 1)\n\nd(N, 1) = (d(N, 1) - a(N, 1) * d(N - 1, 1)) / (b(N, 1) - a(N, 1) * c(N - 1, 1))\n\nDim temp As Double\n\nFor i = 2 To N - 1 Step 1\n    temp = b(i, 1) - a(i, 1) * c(i - 1, 1)\n    c(i, 1) = c(i, 1) / temp\n    d(i, 1) = (d(i, 1) - a(i, 1) * d(i - 1, 1)) / temp\nNext i\n\nDim x(8, 0) As Variant\n\nx(N - 1, 0) = d(N, 1)\n\nFor J = N - 1 To 1 Step -1\n    x(J - 1, 0) = d(J, 1) - c(J, 1) * x(J, 0)\nNext J\n\nDiagSolv = x()\n\nEnd Function\n\nSub Solver()\n\nDim ArrayA() As Variant\nArrayA = Range(\"AH39:AH47\").Value\n\nDim ArrayB() As Variant\nArrayB = Range(\"AI39:AI47\").Value\n\nDim ArrayC() As Variant\nArrayC = Range(\"AJ39:AJ47\").Value\n\nDim ArrayD() As Variant\nArrayD = Range(\"AK39:AK47\").Value\n\nDim m() As Variant\n\nm() = DiagSolv(ArrayA, ArrayB, ArrayC, ArrayD)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "rows"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 1, "creation_date": 1519148243, "post_id": 48891106, "comment_id": 84787534, "body": "Do you mean that you want the formula to then calculate row 41, then row 42, then etc for 200 rows?  what cell is your formula going in?Your question is a bit vague."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519148284, "post_id": 48891106, "comment_id": 84787555, "body": "If you just remove the $ from the row then fill down, you can sum the results."}, {"owner": {"reputation": 1, "user_id": 9387081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0f90d5fe7d0c5a6bc65f0d689e7e88c?s=128&d=identicon&r=PG&f=1", "display_name": "Stokie", "link": "https://stackoverflow.com/users/9387081/stokie"}, "edited": false, "score": 0, "creation_date": 1519148668, "post_id": 48891106, "comment_id": 84787764, "body": "Yes exactly that I want to repeat the calc. I need the whole 200 calcs to be summed in a single cell"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9387081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0f90d5fe7d0c5a6bc65f0d689e7e88c?s=128&d=identicon&r=PG&f=1", "display_name": "Stokie", "link": "https://stackoverflow.com/users/9387081/stokie"}, "edited": false, "score": 0, "creation_date": 1519150041, "post_id": 48891214, "comment_id": 84788572, "body": "excuse my ignorance but where does my if statement fit into the formula?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 9387081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0f90d5fe7d0c5a6bc65f0d689e7e88c?s=128&d=identicon&r=PG&f=1", "display_name": "Stokie", "link": "https://stackoverflow.com/users/9387081/stokie"}, "edited": false, "score": 0, "creation_date": 1519156505, "post_id": 48891214, "comment_id": 84791973, "body": "<code>AM1:AM400&gt;0.01</code> is the part checking for values &gt; 0.01"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1519156540, "last_edit_date": 1519156540, "creation_date": 1519148480, "answer_id": 48891214, "question_id": 48891106, "link": "https://stackoverflow.com/questions/48891106/vba-loop-to-repeat-an-excel-calc-over-multiple-row/48891214#48891214", "title": "VBA loop to repeat an Excel Calc over multiple row", "body": "<p>Something like:</p>\n\n<pre><code>=SUMPRODUCT(--(AM1:AM200&gt;0.01),(AM1:AM200*G1:G200))\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9387081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0f90d5fe7d0c5a6bc65f0d689e7e88c?s=128&d=identicon&r=PG&f=1", "display_name": "Stokie", "link": "https://stackoverflow.com/users/9387081/stokie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519156540, "creation_date": 1519148099, "last_edit_date": 1519148313, "question_id": 48891106, "link": "https://stackoverflow.com/questions/48891106/vba-loop-to-repeat-an-excel-calc-over-multiple-row", "title": "VBA loop to repeat an Excel Calc over multiple row", "body": "<p>Evening Boffins,</p>\n\n<p>I think I have what you will find a relatively easy question.</p>\n\n<p>I would like to repeat the excel calc below on circa 200 rows in excel and sum the result;</p>\n\n<pre><code>=IF('By Project'!$AM$40&gt;0.01,'By Project'!$AM$40*'By Project'!G$40,0)\n</code></pre>\n\n<p>Any help greatly appreciated</p>\n\n<p>Thanks\nNewbie</p>\n"}, {"tags": ["excel", "vba", "cursor", "selection"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1519146446, "post_id": 48890506, "comment_id": 84786445, "body": "Remember touching the &lt;kbd&gt;DOWNARROW&lt;/kbd&gt; only moves the <code>ActiveCell</code> down, not all of <code>Selection</code>"}, {"owner": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1519146574, "post_id": 48890506, "comment_id": 84786528, "body": "Thanks. I don&#39;t need to move the active cell starting from a complicated selection (e.g. several selected cells). I&#39;ll assume I&#39;m starting from a single selected cell and then just want to mimic moving the active cell as if I&#39;ve used an arrow key."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1519146625, "post_id": 48890506, "comment_id": 84786553, "body": "Lets look at SendKeys"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1519147077, "post_id": 48890506, "comment_id": 84786844, "body": "check my answer below"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1519147707, "post_id": 48890506, "comment_id": 84787216, "body": "Using <code>SendKeys</code> is generally warned against, but there are certainly applications for it.  However, more broadly, <i>why</i> do you want the cell selection to change on a shortcut?  Is it to run a macro, after the selection is changed? This might be an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a>"}, {"owner": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1519150357, "post_id": 48890506, "comment_id": 84788750, "body": "@BruceWayne Just checked your link...perhaps this <i>is</i> an XY problem. My motivation: I want selection movement without moving my hands from their default position over the keyboard, i.e. I don&#39;t want to move my hands to the arrow keys. That&#39;s it. I don&#39;t know how to re-assign standard keyboard functions (like the arrow keys) in Excel without using macros. So I&#39;ve been trying to solve this with VBA. I say I don&#39;t want plugins or add-ins because I also just want to get VBA to do what I want, but if you know of a more appropriate solution to my problem, I&#39;m listening."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1519150642, "post_id": 48890506, "comment_id": 84788904, "body": "So, basically, you are looking to navigate your worksheet <i>without</i> using arrow keys? Any particular reason (i.e. could a different keyboard fix the reach for the arrow keys), or is there a technical reason you&#39;re avoiding them?"}, {"owner": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "edited": false, "score": 0, "creation_date": 1519150917, "post_id": 48890506, "comment_id": 84789059, "body": "Simply keyboard ergonomics. I&#39;ve used various other tools in the past for remapping things like simple cursor movements, and I know that I <i>love</i> using, say, H/J/K/L with various modifier keys for left, down, up and right. Really speeds up my work if I don&#39;t have to constantly move my whole arm. In some circles, the H/J/K/L combo is kind of a standard. So I don&#39;t think a different keyboard would solve my problem."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1519152757, "post_id": 48890506, "comment_id": 84790097, "body": "Anything in <a href=\"https://www.reddit.com/r/excel/comments/6bnpw2/a_little_program_that_helped_me_tons_with_excel/\" rel=\"nofollow noreferrer\">this reddit thread</a> help?  Or this <a href=\"https://github.com/kjnh10/ExcelLikeVim\" rel=\"nofollow noreferrer\">github</a> project?  And I haven&#39;t used it personally, but hear good things about <a href=\"https://autohotkey.com/\" rel=\"nofollow noreferrer\">AutoHotkey</a>, which some threads have also suggested in using for <code>HJKL</code> movement in Excel."}, {"owner": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "edited": false, "score": 0, "creation_date": 1519154079, "post_id": 48890506, "comment_id": 84790750, "body": "Those look interesting, and I&#39;ll investigate further. However, once upon a time I had also found a (different) generic tool I could use for all my cursor movements in all programs, and I loved it...and then it stopped working after an OS update. So I&#39;m a little hesitant to try other (non-Excel) tools. Furthermore, I&#39;m working on a Mac running Parallels running Windows running Excel, so Windows-based tools like AutoHotKey etc make me quite nervous. Thanks for the suggestions though. The more complicated the VBA solution looks, the more interesting those other suggestions look."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1519155531, "post_id": 48890506, "comment_id": 84791435, "body": "I&#39;m thinking Autohotkey might be a good option. You can use SendInput to mirror the keyboard button press. Getting WinAPIs working in VBA is a pain. Example AHK that works. <code>#ifWinActive, ahk_Class XLMAIN ^j:: \tSendInput, {DOWN} \treturn ;Turn off Conditional #IfWinActive</code> You can use Post/SendMessage to send <code>DOWN</code> too."}], "answers": [{"comments": [{"owner": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "edited": false, "score": 0, "creation_date": 1519147415, "post_id": 48890741, "comment_id": 84787030, "body": "If I assign this macro to &quot;CTRL+J&quot;, this will now move my cursor down and it will skip over hidden rows as desired. However, for it to work a second time, I need to lift my finger off both the CTRL and J keys before pressing them both again instead of allowing me to continue holding down the CTRL key and just re-pressing the J key. When I use <code>ActiveCell.Offset(1, 0).Range(&quot;A1&quot;).Select</code> it moves the cursor but inappropriately moves into hidden rows, as I indicated in my question but at least it doesn&#39;t require me to un-press the CTRL key each time. Thus I&#39;m still hoping for a better solution."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1519147417, "post_id": 48890741, "comment_id": 84787032, "body": "Very smart Gary! :)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "edited": false, "score": 0, "creation_date": 1519147738, "post_id": 48890741, "comment_id": 84787236, "body": "@AndrewWillems Holding the CTRL key down will NOT work.  This is because Excel needs distinct combo-keystrokes to trigger the macro!!"}, {"owner": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "edited": false, "score": 0, "creation_date": 1519148097, "post_id": 48890741, "comment_id": 84787449, "body": "My apologies, but I don&#39;t understand your comment. When my macro uses <code>ActiveCell.Offset(1, 0).Range(&quot;A1&quot;).Select</code> I do use CTRL+J just fine, i.e. I press the CTRL key a single time, press J ten times, and the active cell will move down ten times. I would like to reproduce that responsiveness to my keystrokes except ignoring hidden rows."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "edited": false, "score": 0, "creation_date": 1519148261, "post_id": 48890741, "comment_id": 84787544, "body": "@AndrewWillems  I did not explain clearly....my previous comment concerned using CNTRL-j to trigger my macro...........sorry"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "edited": false, "score": 0, "creation_date": 1519148434, "post_id": 48890741, "comment_id": 84787634, "body": "@AndrewWillems  Clearly if you just keep DOWNARROW depressed, the activecell will rapidly move down the column...................my macro approach cannot replicate that behavior."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519148667, "post_id": 48890741, "comment_id": 84787762, "body": "Gary&#39;sStudent the use of sendkeys appears not only to select the cell but to activate it also.  While the original code only selects and thus the release of the ctrl is not required with the first but is with yours.  As to how to get around it.....IDK."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1519147384, "last_edit_date": 1519147384, "creation_date": 1519146885, "answer_id": 48890741, "question_id": 48890506, "link": "https://stackoverflow.com/questions/48890506/use-vba-in-excel-2013-to-mimic-moving-using-arrow-keys/48890741#48890741", "title": "Use VBA in Excel 2013 to mimic moving using arrow keys", "body": "<p>Assign your shortcut keys to:</p>\n\n<pre><code>Sub MoveDown()\n    Application.SendKeys \"{DOWN}\"\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/oM835.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oM835.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519149989, "post_id": 48891407, "comment_id": 84788544, "body": "I do not get the overflow error I tested with row 1048562 and it moves down like it should."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519150062, "post_id": 48891407, "comment_id": 84788580, "body": "If you are getting an overflow it is in how you are using it, which leads me to believe that @BruceWaynes comment is correct."}, {"owner": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519151263, "post_id": 48891407, "comment_id": 84789248, "body": "The overflow error may be due to my exact setup, i.e. using Excel 2013 in Windows 7 run on Parallels Desktop 13 for Mac. However, if the overflow error were the only problem, I&#39;d probably just use this. However, my more recent edit to this solution discusses other bigger (but potentially solveable?!) problems with this solution."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519152128, "post_id": 48891407, "comment_id": 84789759, "body": "I have a solution for up, I do not want to make my own answer as it is just an addition to yours, do you mind if I edit and add to yours?"}, {"owner": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519152400, "post_id": 48891407, "comment_id": 84789898, "body": "If your solution to &quot;up&quot; is successful, that is great. Just know that I haven&#39;t yet tested &quot;left&quot; and &quot;right&quot;, and I obviously need those to work as well. Also note that I don&#39;t mind you editing my solution, but I don&#39;t think you&#39;ll get credit for the answer then. If you want to copy from mine into your own, that&#39;s fine with me as well."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1519152443, "post_id": 48891407, "comment_id": 84789927, "body": "Left and right will just be modifications to the up and down, respectively."}, {"owner": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519153145, "post_id": 48891407, "comment_id": 84790292, "body": "This is getting much closer. It skips hidden cells nicely. It moves essentially as quickly as with arrow keys. However, there are lingering problems: Moving up from the second row to the first row causes a bizarre jump to somewhere else. Moving left produces bizarre jumps every time."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519153624, "post_id": 48891407, "comment_id": 84790512, "body": "You will need to create checks for when the cursor is near the extents of the sheet, to deal with it so it does not do that, this is why I did not create my own answer.  I knew this was going to require a lot of work for the fringe elements."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519153938, "post_id": 48891407, "comment_id": 84790677, "body": "I have fixed the Left, but you will notice the same problems when you get to the last two columns.  you will need to use <code>If then</code> statement to test for those columns to deal with the errors."}, {"owner": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519154141, "post_id": 48891407, "comment_id": 84790780, "body": "Thanks so much for your help. I&#39;ll look into those edge cases."}], "tags": [], "owner": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "is_accepted": false, "score": 2, "last_activity_date": 1519153870, "last_edit_date": 1519153870, "creation_date": 1519149198, "answer_id": 48891407, "question_id": 48890506, "link": "https://stackoverflow.com/questions/48890506/use-vba-in-excel-2013-to-mimic-moving-using-arrow-keys/48891407#48891407", "title": "Use VBA in Excel 2013 to mimic moving using arrow keys", "body": "<p><strong>This was initially written as a solution, but I've since discovered it also has problems. I'll leave it because others have already commented, but note that it is <em>not</em> a solution (at least not in its current form).</strong></p>\n\n<p>I found another web site <a href=\"https://www.pcreview.co.uk/threads/move-cursor-down-skipping-hidden-rows.998950/\" rel=\"nofollow noreferrer\">here</a> that answers my exact question. Here is the solution proposed:</p>\n\n<pre><code>Dim rng As Range\nSet rng = Range( _\n  Cells(ActiveCell.Row + 1, ActiveCell.Column), _\n  Cells(Rows.Count, ActiveCell.Column) _\n)\nrng.SpecialCells(xlCellTypeVisible).Cells(1).Select\n</code></pre>\n\n<p>However, upon closer examination, this <em>does</em> work for moving down, but does <em>not</em> work for moving up. Specifically, you can move down past hidden rows, but it you try to move up past hidden rows the upward movement stops.</p>\n\n<p>For Upwards:</p>\n\n<pre><code>Dim rng As Range\nSet rng = Range( _\n  Cells(1, ActiveCell.Column), _\n  Cells(ActiveCell.Row - 1, ActiveCell.Column) _\n)\nDim rw As Long\nrw = rng.SpecialCells(xlCellTypeVisible).Areas( _\n    rng.SpecialCells(xlCellTypeVisible).Areas.Count _\n    ).Row + rng.SpecialCells(xlCellTypeVisible).Areas( _\n    rng.SpecialCells(xlCellTypeVisible).Areas.Count).Rows.Count - 1\nrng.SpecialCells(xlCellTypeVisible).Cells(rw).Select\n</code></pre>\n\n<p>Right:</p>\n\n<pre><code>Dim rng As Range\nSet rng = Range( _\n  Cells(ActiveCell.Row, ActiveCell.Column + 1), _\n  Cells(ActiveCell.Row, Columns.Count) _\n)\nrng.SpecialCells(xlCellTypeVisible).Cells(1).Select\n</code></pre>\n\n<p>Left:</p>\n\n<pre><code>Set rng = Range( _\n  Cells(ActiveCell.Row, 1), _\n  Cells(ActiveCell.Row, ActiveCell.Column - 1) _\n)\nDim rw As Long\nrw = rng.SpecialCells(xlCellTypeVisible).Areas( _\n    rng.SpecialCells(xlCellTypeVisible).Areas.Count _\n    ).Column + rng.SpecialCells(xlCellTypeVisible).Areas( _\n    rng.SpecialCells(xlCellTypeVisible).Areas.Count).Columns.Count - 1\nrng.SpecialCells(xlCellTypeVisible).Cells(rw).Select\n</code></pre>\n\n<p>I'm going to continue to work on this, but because this is my own answer to my own question, if someone else (who knows more about VBA than I do) wants to take this solution and modify it successfully in your own answer, you have my full blessings to do so.</p>\n\n<p>Note also that even for the successful downward movement this solution produces an \"Overflow\" error if the row number is greater than 32766.</p>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1519150959, "post_id": 48891848, "comment_id": 84789084, "body": "The problem is that these do not skip non visible rows/columns, which is what the OP is after."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519151236, "post_id": 48891848, "comment_id": 84789233, "body": "@ScottCraner - Ah, whoops.  Edited."}, {"owner": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "edited": false, "score": 0, "creation_date": 1519151635, "post_id": 48891848, "comment_id": 84789467, "body": "This works. However, if I have hidden 1000 rows and I&#39;m now trying to move down past them, it takes almost a full 2 seconds for me to move down that &quot;one&quot; row. In contrast, the partial solution I posted in a different answer essentially moves instantaneously past the hidden rows."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "edited": false, "score": 0, "creation_date": 1519151781, "post_id": 48891848, "comment_id": 84789559, "body": "@AndrewWillems - See my edit. This went from row 3, skipped 2000 hidden rows, then selected the next cell in less than a second."}, {"owner": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "edited": false, "score": 0, "creation_date": 1519152336, "post_id": 48891848, "comment_id": 84789863, "body": "Again, it works. However, it slows down the regular cursor movement, i.e. when hidden rows aren&#39;t an issue. For example, normal arrow key movement can go down 290 rows in 10 seconds, while with this code it can only go down 80 rows in 10 seconds. I&#39;m not nitpicking: (1) I move the cursor constantly, so delays like this would drive me mad. (2) The other solution I posted does not seem to have this delay. I think the fact that it requires VBA-based looping (as opposed to, say, native looping in the Excel code itself, accessed by things like <code>rng.SpecialCells...</code>) makes this less useable."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "edited": false, "score": 0, "creation_date": 1519152523, "post_id": 48891848, "comment_id": 84789966, "body": "@AndrewWillems - How much data do you have? I&#39;m able to skip 10,000 rows in a second...  Edit: See <a href=\"https://i.stack.imgur.com/YX37S.gif\" rel=\"nofollow noreferrer\">this screenshot</a> showing a &quot;Down&quot; move. I have data from <code>A4:A9256</code> in there."}, {"owner": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "edited": false, "score": 0, "creation_date": 1519154472, "post_id": 48891848, "comment_id": 84790920, "body": "I&#39;m not talking about skipping rows. I&#39;m talking about just moving simply from one non-hidden cell to the next, e.g. from cell J12 to J13. I&#39;m referring to how it takes to do that 10,000 times versus how long it takes to do the same thing using the arrow key."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "edited": false, "score": 0, "creation_date": 1519238054, "post_id": 48891848, "comment_id": 84832461, "body": "@AndrewWillems - Maybe I&#39;m still not understanding something...when I run the above, it works in a second at most, even if it has to skip 10,000 rows or columns."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 2, "last_activity_date": 1519151754, "last_edit_date": 1519151754, "creation_date": 1519150913, "answer_id": 48891848, "question_id": 48890506, "link": "https://stackoverflow.com/questions/48890506/use-vba-in-excel-2013-to-mimic-moving-using-arrow-keys/48891848#48891848", "title": "Use VBA in Excel 2013 to mimic moving using arrow keys", "body": "<p>Not sure what you're really going for, but what about this?</p>\n\n<pre><code>Option Explicit\n\nSub move_right()\nNextVisible \"Right\"\nEnd Sub\n\nSub move_left()\nNextVisible \"Left\"\nEnd Sub\n\nSub move_up()\nNextVisible \"Up\"\nEnd Sub\n\nSub move_down()\nNextVisible \"Down\"\nEnd Sub\n\nPrivate Sub NextVisible(direction As String)\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n\nDim i As Long\nDim r As Range\nSet r = ActiveCell\nFor i = 1 To Rows.Count\n    On Error Resume Next 'If you're in A1 and try to go up one, it'll error. This skips that error.\n    Select Case direction\n        Case \"Up\"\n            Set r = r.Offset(-1, 0)\n        Case \"Down\"\n            Set r = r.Offset(1, 0)\n        Case \"Left\"\n            Set r = r.Offset(0, -1)\n        Case \"Right\"\n            Set r = r.Offset(0, 1)\n        Case Else\n            Set r = r\n    End Select\n    On Error Goto 0\n\n    If r.EntireRow.Hidden = False And r.EntireColumn.Hidden = False Then\n        r.Select\n        Exit Sub\n    End If\nNext i\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Then, simply assign a shortcut to each one...</p>\n\n<p><a href=\"https://i.stack.imgur.com/SMrmH.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SMrmH.gif\" alt=\"enter image description here\"></a></p>\n\n<p>So, pressing <kbd>CTRL+I</kbd> moves the active cell up.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11880456, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tpCR3FRXCBA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdOy4gD9H-TUh-qhARSh2ZO9umBSQ/photo.jpg?sz=128", "display_name": "Vinay Bhade", "link": "https://stackoverflow.com/users/11880456/vinay-bhade"}, "is_accepted": false, "score": -1, "last_activity_date": 1564920722, "last_edit_date": 1564920722, "creation_date": 1564919522, "answer_id": 57346307, "question_id": 48890506, "link": "https://stackoverflow.com/questions/48890506/use-vba-in-excel-2013-to-mimic-moving-using-arrow-keys/57346307#57346307", "title": "Use VBA in Excel 2013 to mimic moving using arrow keys", "body": "<p>To move one cell down, provided there is no filter applied where rows are hidden.</p>\n\n<pre><code>Selection.End(xlDown).Select\nSelection.End(xlUp).Offset(1).Select\n</code></pre>\n"}], "owner": {"reputation": 9650, "user_id": 5218951, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6e779359515d3dc72ff22838811ac26?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Willems", "link": "https://stackoverflow.com/users/5218951/andrew-willems"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8345, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1564920722, "creation_date": 1519146157, "question_id": 48890506, "link": "https://stackoverflow.com/questions/48890506/use-vba-in-excel-2013-to-mimic-moving-using-arrow-keys", "title": "Use VBA in Excel 2013 to mimic moving using arrow keys", "body": "<p>I want to create a VBA macro for Excel 2013 to move the cursor. I am simply re-mapping keyboard shortcuts, e.g. I want to move the cursor down using CTRL+J instead of the down arrow. So I don't need anything fancy, just a simple cursor move. I also want to do this in VBA, so I'm not looking for, e.g., an Excel plugin or add-in or anything like that.</p>\n\n<p>If, under the \"Developer\" tab, I select \"Use Relative References\", and then simply record a macro moving the cursor down, I get the following, which <em>does</em> move the cursor:</p>\n\n<pre><code>ActiveCell.Offset(1, 0).Range(\"A1\").Select\n</code></pre>\n\n<p>However, this is not a complete mimic of the down arrow. This subroutine/macro will move into hidden rows, which I do not want.</p>\n\n<p>Each of the following give me an \"Object doesn't support this property or method\" error:</p>\n\n<pre><code>Selection.MoveDown Unit:=xlCell, Count:=1, Extend:=xlMove\n...\nSelection.MoveDown Unit:=xlWorksheetCell, Count:=1, Extend:=xlMove\n...\nSelection.MoveDown xlCell, 1, xlMove\n...\nSelection.MoveDown xlWorksheetCell, 1, xlMove\n</code></pre>\n\n<p>The following gives me a syntax error:</p>\n\n<pre><code>Selection.MoveDown(xlWorksheetCell, 1, xlMove)\n</code></pre>\n\n<p>I can imagine a moderatelymacro that moves the cursor, checks whether the new cell is hidden and, if so, repeats until it is not. However, I have a hard time believing that there isn't a command/method/etc that doesn't simply and easily mimic moving the cursor the way the arrow key does,ignoring hidden rows/columns. For example, I <em>can</em> mimic using the arrow keys while holding down the control key using, g., <code>Selection.End(xlDown).Select</code>. So I want to just mimic moving the cursor with an arrow key as simply as possible.</p>\n\n<p><em>(This seems like such a simple problem that I'm guessing someone has asked/answered this before. However, if so, and if you mark my question as a duplicate, please indicate where the original answer is, as I've looked and can't find it.)</em></p>\n"}, {"tags": ["vba", "excel", "for-loop", "advanced-filter"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519146359, "post_id": 48890417, "comment_id": 84786399, "body": "Probably not the cause of your problem but using <code>Option Explicit</code> would have picked up <code>DegreeLvel</code>."}, {"owner": {"reputation": 95, "user_id": 4293071, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e3692af0a02d4dfeaa3522c3b35e164e?s=128&d=identicon&r=PG&f=1", "display_name": "FruitUser", "link": "https://stackoverflow.com/users/4293071/fruituser"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519146754, "post_id": 48890417, "comment_id": 84786640, "body": "Added Option Explicit and had the same results. The error I get is Run-Time &#39;1004&#39;, Application-defined or object-defined error"}, {"owner": {"reputation": 95, "user_id": 4293071, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e3692af0a02d4dfeaa3522c3b35e164e?s=128&d=identicon&r=PG&f=1", "display_name": "FruitUser", "link": "https://stackoverflow.com/users/4293071/fruituser"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519147292, "post_id": 48890417, "comment_id": 84786961, "body": "I just restructured my macro and rather than using a loop for m (degree level), I just copied everything three times and reassigning values for DegreeLevel. On the second degree level (what would be m=2), I am having the same error message so I do not believe the issue is in the For Next loop."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519147410, "post_id": 48890417, "comment_id": 84787026, "body": "It&#39;s not helpful to post code which clearly does not compile. You are also missing an <code>End If</code>. Please post your actual code or a minimal replica of your code that exhibits your problem. Have you tried stepping through your code etc?"}, {"owner": {"reputation": 95, "user_id": 4293071, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e3692af0a02d4dfeaa3522c3b35e164e?s=128&d=identicon&r=PG&f=1", "display_name": "FruitUser", "link": "https://stackoverflow.com/users/4293071/fruituser"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519147809, "post_id": 48890417, "comment_id": 84787281, "body": "Edited (I removed the if statement evaluating m since it is not immediately to this question). I have stepped through, same error."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519150367, "post_id": 48890417, "comment_id": 84788756, "body": "Check the values of variables as you step through. It&#39;s good practice to avoid Select."}, {"owner": {"reputation": 95, "user_id": 4293071, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e3692af0a02d4dfeaa3522c3b35e164e?s=128&d=identicon&r=PG&f=1", "display_name": "FruitUser", "link": "https://stackoverflow.com/users/4293071/fruituser"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519151490, "post_id": 48890417, "comment_id": 84789376, "body": "When I step through, variable values are correct. What do you recommend I use in place of Select? @SJR"}], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 4293071, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e3692af0a02d4dfeaa3522c3b35e164e?s=128&d=identicon&r=PG&f=1", "display_name": "FruitUser", "link": "https://stackoverflow.com/users/4293071/fruituser"}, "is_accepted": false, "score": 0, "last_activity_date": 1519153548, "creation_date": 1519153548, "answer_id": 48892484, "question_id": 48890417, "link": "https://stackoverflow.com/questions/48890417/advanced-filter-not-working-on-second-iteration-of-nested-for-next-loop-vba-exce/48892484#48892484", "title": "Advanced Filter not working on second iteration of nested For Next loop vba excel", "body": "<p>So I'm not sure why this worked, but I made a filtered data tab for each degree level and then a separate If statement for each degree level option. The following is within each If level. Thanks for trying @everyonewhohelped</p>\n\n<pre><code>'Check if the \"Filter Data\" Tab exists and delete it then add a blank sheet with the same name.\nApplication.DisplayAlerts = False\nOn Error Resume Next\nThisWorkbook.Sheets(\"Filter Data B\").Delete\nOn Error GoTo 0\nApplication.DisplayAlerts = True\nSheets.Add.Name = \"Filter Data B\"\nSheets(\"Filter Data B\").Range(\"A1\").Select\n\n'Populate filtered data sheet using the advance filter function\nSheets(\"Merged Data\").Range(\"A1\").CurrentRegion.AdvancedFilter _\nAction:=xlFilterCopy, _\nCriteriaRange:=Sheets(\"Advance Filter\").Range(\"A5:AB7\"), _\nCopyToRange:=Range(\"A1\"), _\nUnique:=False\n\n'Length of filtered data minus one to not include the variable titles is the number of graduates for that major\nGrads = ActiveSheet.Cells(Rows.count, \"A\").End(xlUp).Row - 1\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 4293071, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e3692af0a02d4dfeaa3522c3b35e164e?s=128&d=identicon&r=PG&f=1", "display_name": "FruitUser", "link": "https://stackoverflow.com/users/4293071/fruituser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 431, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519153548, "creation_date": 1519145862, "last_edit_date": 1531164843, "question_id": 48890417, "link": "https://stackoverflow.com/questions/48890417/advanced-filter-not-working-on-second-iteration-of-nested-for-next-loop-vba-exce", "title": "Advanced Filter not working on second iteration of nested For Next loop vba excel", "body": "<p>I am writing a macro that will take a large data sheet and filter it onto another sheet, with the first criteria being based on a variable (Degree Level) determined by the iteration of the for next loop based on m, and the second criteria based on a variable (Major) determined by the iteration of the nested for next loop based on i. </p>\n\n<p>The filter works on the first iteration of m but not on the second (there are only three iterations). Not sure what would cause the bug, but it is on the line below  'Populate filtered data sheet...' Below is my code. Thanks in advance!</p>\n\n<pre><code>Public SelColCode as string \nSub FilterGrads()\nDim DegreeLevel as string\n\nSelColCode = \"H\"\n\nFor m = 1 To 3\nIf m = 1 Then\n    DegreeLevel = \"B\"\n    Number_Of_Majors = Sheets(\"MajorList\").Range(\"AC1\").Value '16 in this case\nElseIf m = 2 Then\n    DegreeLevel = \"M\"\n    Number_Of_Majors = Sheets(\"MajorList\").Range(\"AE1\").Value '12 in this case\nElseIf m = 3 Then\n    DegreeLevel = \"D\"\n    Number_Of_Majors = Sheets(\"MajorList\").Range(\"AE1\").Value '8 in this case\nEnd If\n\n'Look through all the majors and fill in each row one at a time on the report\nFor i = 5 To 4 + Number_Of_Majors * 2 Step 2\n'Select the Report Tab and select the major\n    Sheets(SelColCode &amp; \" \" &amp; DegreeLevel &amp; \" Report\").Select\n    Major = Range(\"B\" &amp; i)\n\n'Unhide the advance filter tab and then input the Degree level and major from above\nThisWorkbook.Worksheets(\"Advance Filter\").Visible = True\nThisWorkbook.Worksheets(\"Advance Filter\").Select\nRange(\"A6:AA15\").ClearContents\nRange(\"E6\").Value = DegreeLevel &amp; \".*\"\nRange(\"F6\").Value = Major\n\n'Check if the \"Filter Data\" Tab exists and delete it then add a blank sheet with the same name.\nApplication.DisplayAlerts = False\nOn Error Resume Next\nThisWorkbook.Sheets(\"Filter Data\").Delete\nOn Error GoTo 0\nApplication.DisplayAlerts = True\nSheets.Add.Name = \"Filter Data\"\nSheets(\"Filter Data\").Select\nSheets(\"Filter Data\").Move After:=Sheets(\"Merged Data\")\n\n'Populate filtered data sheet using the advance filter function\nSheets(\"Merged Data\").Range(Data_Range).AdvancedFilter Action:=xlFilterCopy, _\n    CriteriaRange:=Sheets(\"Advance Filter\").Range(\"A5:AB6\"), CopyToRange:=Range(\"A1\"), Unique:=True\n\n'Length of filtered data minus one to not include the variable titles is the number of graduates for that major\nGrads = ActiveSheet.Cells(Rows.count, \"A\").End(xlUp).Row - 1\n\n'do some stuff, then loop\n\nNext 'i, major\nNext 'm, degreelevel\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "menu", "ribbon"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1519150097, "post_id": 48890351, "comment_id": 84788595, "body": "Change the macro names - I&#39;m pretty sure <code>R</code> + a number is reserved for something else in VBA. Try renaming them to something different and see what happens."}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 2, "last_activity_date": 1519150279, "creation_date": 1519150279, "answer_id": 48891680, "question_id": 48890351, "link": "https://stackoverflow.com/questions/48890351/vba-macro-list-box-not-letting-editing-some-macros/48891680#48891680", "title": "vba macro list box not letting editing some macros", "body": "<p>Confirmed it's the macro names - go to Developer -> View Code (or type Alt + f11), then select the module with your code in it and rename them. For whatever reason it's that <code>R#</code> syntax:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GIrMt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GIrMt.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "accepted_answer_id": 48891680, "answer_count": 1, "score": 0, "last_activity_date": 1519202194, "creation_date": 1519145626, "last_edit_date": 1531164843, "question_id": 48890351, "link": "https://stackoverflow.com/questions/48890351/vba-macro-list-box-not-letting-editing-some-macros", "title": "vba macro list box not letting editing some macros", "body": "<p>I have an Excel project with a lot of macros.\nWhat I want is assign macros to buttons in the ribbons.\nFor that I created macros like:</p>\n\n<pre><code>Sub R10_parallel_device()\nhelp.helpON (\"parallel_device \")\nCall sub_novelty_claims(\"parallel_device\")\nEnd Sub\n</code></pre>\n\n<p>So the three conditions are met:\na) the macro <code>SUB R10_parallel_device()</code> do not accept parameters\nb) it is not private\nc) It is not hide </p>\n\n<p>when I go to the list of macros I see all the list of macros named Rnn but all THE BUTTONS ARE GREY OUT EXCEPTFOR CREATE.\nNow if I click in that sub for instance <code>SUB R10_parallel_device()</code> I can not edit it and if I click \"create\" excel sends me to a new created module where \n    Sub R10_parallel_device()</p>\n\n<pre><code>End Sub\n</code></pre>\n\n<p>appears.</p>\n\n<p>&amp;\nWhen I go to file/options/ribbon if I want to add that macro to a button it is listed and it is possible to assigne the macro to a button but it would not run, giving the error that such a macro is not found.</p>\n\n<p>NOTE: I checked which macro are listed thisworkbook/all/ etc.\nnote2: <a href=\"https://stackoverflow.com/questions/41234838/macros-not-showing-up-in-macro-table\">this</a> did not help me. <a href=\"https://stackoverflow.com/questions/45922417/macros-not-showing-up-in-the-run-macro-menu\">this</a> neither</p>\n\n<p>thx</p>\n\n<p><a href=\"https://i.stack.imgur.com/PGiAw.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PGiAw.jpg\" alt=\"enter image description here\"></a></p>\n"}]