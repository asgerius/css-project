[{"tags": ["excel", "vba", "email", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1447887626, "last_edit_date": 1447887626, "creation_date": 1447887318, "answer_id": 33792067, "question_id": 33791893, "link": "https://stackoverflow.com/questions/33791893/add-email-address-to-outlook-email-message-if-the-value-of-a-cell-is-1/33792067#33792067", "title": "Add email address to Outlook email message if the value of a cell is = 1", "body": "<p>The basic answer is this: </p>\n\n<pre><code>For Each cl In emailRng\n    If cl.Offset(,1) = 1 Then sTo = sTo &amp; \";\" &amp; cl.Value\nNext\n</code></pre>\n\n<p>Here you are checking if 1 column away from the email address (Event 1 in col E) is checked for notification.</p>\n\n<p>However, since you stated you could have <em>n</em> number of events, you will need a way to determine which event you are sending an email for. I don't know how you plan to process that, but you could, for example, call the Sub from another Sub and pass the event number and use that as the offset. </p>\n\n<p>So </p>\n\n<pre><code>Sub EmailEvent()\n\n    SendEventEmail 1 'send event 1 email\n    SendEventEmail 2 'send event 2 email\n    SendEventEmail 3 'send event 3 email\n\nEnd Sub\n</code></pre>\n\n<p>Then in your sub that actually sends the mail it would say</p>\n\n<pre><code>Sub SendEventEmail(n as Long)\nRem n is the Event Number\n\nRem Your Code ... \n\nFor Each cl in emailRng\n     If cl.Offset(,n) = 1 Then sTo = sTo &amp; \";\" &amp; cl.Value\nNext\n\nRem Rest of code ... \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5578752, "user_type": "registered", "profile_image": "https://graph.facebook.com/1048414598512424/picture?type=large", "display_name": "Donald McKee", "link": "https://stackoverflow.com/users/5578752/donald-mckee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1447887626, "creation_date": 1447886631, "question_id": 33791893, "link": "https://stackoverflow.com/questions/33791893/add-email-address-to-outlook-email-message-if-the-value-of-a-cell-is-1", "title": "Add email address to Outlook email message if the value of a cell is = 1", "body": "<p>I am trying to get some help with sending an email message to anyone with a \"1\" in column E.  I have a worksheet with a range of employees and their phone numbers.  Following their phone numbers is a list of events they want to be notified for. If I place a 1 in one of the columns after their name I would like their email address added to the email.  </p>\n\n<p>The column headers would be something like A=Last Name, B=First name, C=Phone Number, D=Email Address, E=Event 1, F=Event 2, G=event 3 and so on. </p>\n\n<p>I was able to get the email code to pull all email addresses from a set range but I can't figure out how to add the if command to look for a set value in one of the event columns (E, F, G...).  It would need to loop through the entire range and then pull address only for those selected individuals who had the set value in one of the event columns.  </p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>Dim OutApp As Object\nDim OutMail As Object\nDim strto As String, strcc As String, strbcc As String\nDim strsub As String, strbody As String\nDim emailRng As Range, cl As Range\nDim sTo As String\n\nSet emailRng = Worksheets(\"Sheet1\").Range(\"D1:D500\")\n\nFor Each cl In emailRng\n    sTo = sTo &amp; \";\" &amp; cl.Value\nNext\n\nsTo = Mid(sTo, 2)\n\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\n\nstrto = sTo\n\nstrcc = \"\"\nstrbcc = \"\"\nstrsub = \"'NOTIFICATION'  - \" &amp; \"Notification\"\nstrbody = \"&lt;img src=Z:\\Logo2.jpg width=624 height=74&gt;\" &amp; _\n          \"&lt;font size=2 font face=Verdana color=black&gt;\" &amp; \"&lt;br&gt;\" &amp; _\n          \"The following notification was received:&lt;/B&gt;&lt;br&gt;&lt;br&gt;\" &amp; _\n          \"COPY AND PAST NOTIFICATION RECEIVED HERE\" &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n          \"&lt;b&gt;Control Center&lt;/b&gt;&lt;br&gt;&lt;br&gt;\"\n\n\nWith OutMail\n    '.SentOnBehalfOfName = \"\"\n    .to = strto\n    .cc = strcc\n    .bcc = strbcc\n    .Subject = strsub\n    'You can add a file to the mail like this\n    .HTMLBody = strbody\n    .Display    ' or use .Send\nEnd With\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n</code></pre>\n"}, {"tags": ["excel", "vba", "overflow"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1447887619, "post_id": 33791848, "comment_id": 55351205, "body": "An signed long integer or <b>Long</b> has a range of \u20132,147,483,648 to 2,147,483,647 (<a href=\"https://msdn.microsoft.com/en-us/library/s3f49ktz.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Data Type Ranges</a>). You&#39;re trying to stuff in 3,800,040,260."}], "answers": [{"tags": [], "owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "is_accepted": false, "score": 0, "last_activity_date": 1447887146, "creation_date": 1447887146, "answer_id": 33792017, "question_id": 33791848, "link": "https://stackoverflow.com/questions/33791848/mystery-overflow-error-6/33792017#33792017", "title": "Mystery Overflow (Error 6)", "body": "<p>needed to cast as double. Although I am not sure why Long isn't enough. I thought that data type had much more potential</p>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 4, "last_activity_date": 1510158321, "last_edit_date": 1510158321, "creation_date": 1447889593, "answer_id": 33792565, "question_id": 33791848, "link": "https://stackoverflow.com/questions/33791848/mystery-overflow-error-6/33792565#33792565", "title": "Mystery Overflow (Error 6)", "body": "<p>A <code>Long</code> is a 32-bit signed data type. The largest number you can produce with 32-bits (signed) is <strong><code>2,147,486,647</code></strong></p>\n\n<hr>\n\n<p><strong>TL;DR</strong></p>\n\n<p>32 bits refers to 32 bits <em>of memory</em></p>\n\n<p>The reason <strong><code>2,147,486,647</code></strong> is the largest number available is because:</p>\n\n<pre><code>'// Dec to Binary\n2,147,486,647 = 11111111111111111111111111111111\n2,147,486,648 = 100000000000000000000000000000000\n                                                ^\n                                     '// That's a 33rd bit\n</code></pre>\n\n<p>That 33rd bit <strong><em>overflows</em></strong> the amount of memory available for that data type - hence the overflow error.</p>\n\n<hr>\n\n<p>A <code>Double</code> however, is a 64 bit signed integer and has plenty of room for you :)</p>\n"}], "owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 33792565, "answer_count": 2, "score": 1, "last_activity_date": 1510158321, "creation_date": 1447886437, "last_edit_date": 1447890667, "question_id": 33791848, "link": "https://stackoverflow.com/questions/33791848/mystery-overflow-error-6", "title": "Mystery Overflow (Error 6)", "body": "<p>I have a sub routine that immediately errors out for reasons I can't understand. </p>\n\n<p>First line in the routine tries to load a value into a variable and it errors out.</p>\n\n<pre><code>UPCTGT = CLng(Sheets(\"Settings\").Range(\"C3\").Value)\n</code></pre>\n\n<p>The value in cell C3 is 3800040260 ..Why would that cause an overflow error?</p>\n"}, {"tags": ["vba", "excel", "vbscript", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 3837782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea49dc5b3a2ddad07c5d9d47dbfadb7f?s=128&d=identicon&r=PG&f=1", "display_name": "batman", "link": "https://stackoverflow.com/users/3837782/batman"}, "edited": false, "score": 0, "creation_date": 1447941987, "post_id": 33791943, "comment_id": 55377495, "body": "Do you know however if there is any way to instantiate an outlook application through a VB script or VBA and then run the outlook script?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 11, "user_id": 3837782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea49dc5b3a2ddad07c5d9d47dbfadb7f?s=128&d=identicon&r=PG&f=1", "display_name": "batman", "link": "https://stackoverflow.com/users/3837782/batman"}, "edited": false, "score": 0, "creation_date": 1447953763, "post_id": 33791943, "comment_id": 55386236, "body": "No, but you can read the PR_EMS_AB_THUMBNAIL_PHOTO (DASL name <code>http:&#47;&#47;schemas.microsoft.com&#47;mapi&#47;proptag&#47;0x8C9E0102</code>) using AddressEnttry.PropertyAccessor.GetProperty and then just save it as an JPG file."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 3, "last_activity_date": 1447886850, "creation_date": 1447886850, "answer_id": 33791943, "question_id": 33791796, "link": "https://stackoverflow.com/questions/33791796/outlook-get-exchange-users-pictures/33791943#33791943", "title": "Outlook get Exchange users pictures", "body": "<p>The picture can only be retrieved when running inside the outlook.exe process, i.e. if your code is in Outlook VBA or a COM addin:</p>\n\n<p>From <a href=\"https://msdn.microsoft.com/en-us/library/office/ff864210.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff864210.aspx</a>:</p>\n\n<p><strong>You can only call GetPicture from code that runs in-process as Outlook. An StdPicture object cannot be marshaled across process boundaries. If you attempt to call GetPicture from out-of-process code, an exception occurs</strong></p>\n"}], "owner": {"reputation": 11, "user_id": 3837782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea49dc5b3a2ddad07c5d9d47dbfadb7f?s=128&d=identicon&r=PG&f=1", "display_name": "batman", "link": "https://stackoverflow.com/users/3837782/batman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1135, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1447891108, "creation_date": 1447886232, "last_edit_date": 1447891108, "question_id": 33791796, "link": "https://stackoverflow.com/questions/33791796/outlook-get-exchange-users-pictures", "title": "Outlook get Exchange users pictures", "body": "<p>I'm trying to get the picture for a user with a specific name in a distribution list. In OUTLOOK VBA the code works. In EXCEL VBA the code fails on the <code>getpicture</code> call. running the code from generic VBS the code executes the <code>getpicture</code> call however it returns null. The <code>getexchangeuser</code> call however works in all three cases. I need help getting the picture and then saving it depending on if the format is difficult to save from in VBA.</p>\n\n<pre><code>Sub test()\n    HeroName = \"test\"\n    HLastName = Split(HeroName, \" \")(1)\n    Dim olApp As Outlook.Application\n    Dim olNS As Outlook.NameSpace\n    Dim olAL As Outlook.AddressList\n    Dim olEntry As Outlook.AddressEntry\n    Dim olMember As Outlook.AddressEntry\n    Dim lMemberCount As Long\n    Dim objMail As Outlook.MailItem\n    Set olApp = Outlook.Application\n    Set olNS = olApp.GetNamespace(\"MAPI\")\n    Set olAL = olNS.AddressLists(\"Global Address List\")\n    Set objMail = olApp.CreateItem(olMailItem)\n    ' enter the list name\n    Set olEntry = olAL.AddressEntries(\"##distribution list##\")\n    ' get count of dist list members\n    lMemberCount = olEntry.Members.Count\n    ' loop through dist list and extract members\n    Dim i As Long\n    For i = 1 To lMemberCount\n        Set olMember = olEntry.Members.Item(i)\n        ' NONE OF THIS CODE IS NECESSARY UNLESS IN THE FUTURE SVIL HAS MEMBERS WHO SHARE THE SAME LAST NAME\n        'AS A RESULT THE CODE IS NOT BEING UTILIZED\n        strName = olMember.Name\n        LastName = Split(strName, \",\")(0)\n        'MsgBox (LastName)\n        If (InStr(HLastName, LastName)) Then\n            MsgBox (LastName)\n            'ActiveWorkbook.Sheets(\"Sheet2\").Pictures.Insert\n            Dim returnValue As StdPicture\n            'MsgBox (olMember.GetExchangeUser)\n            'MsgBox (olMember.GetExchangeUser.GetPicture)\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>`</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1447935189, "post_id": 33791770, "comment_id": 55372601, "body": "Add the code of <code>StructuredFolderName</code>, <code>WriteToATextFile</code> and <code>LoopFolders</code> that is where the magic is happening"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 5459987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0921cbd152de2cbae6f9ff50074e966?s=128&d=identicon&r=PG&f=1", "display_name": "Ferekikoo", "link": "https://stackoverflow.com/users/5459987/ferekikoo"}, "is_accepted": true, "score": 0, "last_activity_date": 1448057973, "creation_date": 1448057973, "answer_id": 33837010, "question_id": 33791770, "link": "https://stackoverflow.com/questions/33791770/can-i-add-number-of-emails-beside-folder-name-using-this-vba-macro-in-outlook-20/33837010#33837010", "title": "Can i add number of emails beside Folder name using this vba macro in Outlook 2013?", "body": "<p>I found the solution, adding <strong>.Items.Count</strong> to foldername as below:</p>\n\n<pre><code>Dim MyFile, Structured, Base\n\nCall ExportFolderNamesSelect()\n\nPublic Sub ExportFolderNamesSelect()\n  Dim objOutlook\n  Set objOutlook = CreateObject(\"Outlook.Application\")\n\n  Dim F, Folders\n  Set F = objOutlook.Session.PickFolder\n\n  If Not F Is Nothing Then\n    Set Folders = F.Folders\n\n    Dim Result\n    Result = MsgBox(\"Do you want to structure the output?\", vbYesNo+vbDefaultButton2+vbApplicationModal, \"Output structuring\")\n    If Result = 6 Then\n      Structured = True\n    Else\n      Structured = False\n    End If\n\n    MyFile = GetDesktopFolder() &amp; \"\\outlookfolders.txt\"\n    Base = Len(F.FolderPath) - Len(Replace(F.FolderPath, \"\\\", \"\")) + 1\n\n    WriteToATextFile (StructuredFolderName(F.FolderPath, F.Name) &amp; \" \" &amp; F.Items.Count)\n\n    LoopFolders Folders\n\n    Set F = Nothing\n    Set Folders = Nothing\n    Set objOutlook = Nothing\n  End If\nEnd Sub\n\nPrivate Function GetDesktopFolder()\n  Dim objShell\n  Set objShell = CreateObject(\"WScript.Shell\")\n  GetDesktopFolder = objShell.SpecialFolders(\"Desktop\")\n  Set objShell = Nothing\nEnd Function\n\nPrivate Sub LoopFolders(Folders)\n  Dim F\n\n  For Each F In Folders\n    WriteToATextFile (StructuredFolderName(F.FolderPath, F.Name) &amp; \" \" &amp; F.Items.Count)\n    LoopFolders F.Folders\n  Next\nEnd Sub\n\nPrivate Sub WriteToATextFile(OLKfoldername)\n  Dim objFSO, objTextFile\n  Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n  Set objTextFile = objFSO.OpenTextFile (MyFile, 8, True)\n  objTextFile.WriteLine (OLKfoldername)\n  objTextFile.Close\n  Set objFSO = Nothing\n  Set objTextFile = Nothing\nEnd Sub\n\nPrivate Function StructuredFolderName(OLKfolderpath, OLKfoldername)\n  If Structured = False Then\n    StructuredFolderName = Mid(OLKfolderpath, 3)\n  Else\n    Dim i, x, OLKprefix\n    i = Len(OLKfolderpath) - Len(Replace(OLKfolderpath, \"\\\", \"\"))\n\n    For x = Base To i\n      OLKprefix = OLKprefix &amp; \"-\"\n    Next\n\n    StructuredFolderName = OLKprefix &amp; OLKfoldername\n  End If\nEnd Function\n</code></pre>\n\n<p>Thanks for helping me...</p>\n"}], "owner": {"reputation": 13, "user_id": 5459987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0921cbd152de2cbae6f9ff50074e966?s=128&d=identicon&r=PG&f=1", "display_name": "Ferekikoo", "link": "https://stackoverflow.com/users/5459987/ferekikoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 33837010, "answer_count": 1, "score": 0, "last_activity_date": 1593518361, "creation_date": 1447886125, "last_edit_date": 1593518361, "question_id": 33791770, "link": "https://stackoverflow.com/questions/33791770/can-i-add-number-of-emails-beside-folder-name-using-this-vba-macro-in-outlook-20", "title": "Can i add number of emails beside Folder name using this vba macro in Outlook 2013?", "body": "<p>I have this macro to print out folders tree for selected Outlook folder, but i need to add number of email  beside each folder name (each folder separately not includes subfolder): </p>\n\n<pre><code>Dim MyFile, Structured, Base\n\nCall ExportFolderNamesSelect()\n\nPublic Sub ExportFolderNamesSelect()\n  Dim objOutlook\n  Set objOutlook = CreateObject(\"Outlook.Application\")\n\n  Dim F, Folders\n  Set F = objOutlook.Session.PickFolder\n\n  If Not F Is Nothing Then\n    Set Folders = F.Folders\n\n    Dim Result\n    Result = MsgBox(\"Do you want to structure the output?\", vbYesNo+vbDefaultButton2+vbApplicationModal, \"Output structuring\")\n    If Result = 6 Then\n      Structured = True\n    Else\n      Structured = False\n    End If\n\n    MyFile = GetDesktopFolder() &amp; \"\\outlookfolders.txt\"\n    Base = Len(F.FolderPath) - Len(Replace(F.FolderPath, \"\\\", \"\")) + 1\n\n    WriteToATextFile (StructuredFolderName(F.FolderPath, F.Name))\n\n    LoopFolders Folders\n\n    Set F = Nothing\n    Set Folders = Nothing\n    Set objOutlook = Nothing\n  End If\nEnd Sub\n\nPrivate Function GetDesktopFolder()\n  Dim objShell\n  Set objShell = CreateObject(\"WScript.Shell\")\n  GetDesktopFolder = objShell.SpecialFolders(\"Desktop\")\n  Set objShell = Nothing\nEnd Function\n\nPrivate Sub LoopFolders(Folders)\n  Dim F\n\n  For Each F In Folders\n    WriteToATextFile (StructuredFolderName(F.FolderPath, F.Name))\n    LoopFolders F.Folders\n  Next\nEnd Sub\n\nPrivate Sub WriteToATextFile(OLKfoldername)\n  Dim objFSO, objTextFile\n  Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n  Set objTextFile = objFSO.OpenTextFile (MyFile, 8, True)\n  objTextFile.WriteLine (OLKfoldername)\n  objTextFile.Close\n  Set objFSO = Nothing\n  Set objTextFile = Nothing\nEnd Sub\n\nPrivate Function StructuredFolderName(OLKfolderpath, OLKfoldername)\n  If Structured = False Then\n    StructuredFolderName = Mid(OLKfolderpath, 3)\n  Else\n    Dim i, x, OLKprefix\n    i = Len(OLKfolderpath) - Len(Replace(OLKfolderpath, \"\\\", \"\"))\n\n    For x = Base To i\n      OLKprefix = OLKprefix &amp; \"-\"\n    Next\n\n    StructuredFolderName = OLKprefix &amp; OLKfoldername\n  End If\nEnd Function\n</code></pre>\n\n<p>would you please help me?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447885214, "post_id": 33791545, "comment_id": 55350218, "body": "See <a href=\"http://stackoverflow.com/questions/3232920/how-can-i-programmatically-freeze-the-top-row-of-an-excel-worksheet-in-excel-200\">here</a>."}, {"owner": {"reputation": 5383, "user_id": 3664960, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fbcd9ff6662774ee78e2026b3671a4e1?s=128&d=identicon&r=PG&f=1", "display_name": "davejal", "link": "https://stackoverflow.com/users/3664960/davejal"}, "edited": false, "score": 0, "creation_date": 1447889999, "post_id": 33791545, "comment_id": 55352106, "body": "not sure why you added vba and the answers also suggest a vba option. just select the row/colum (either or both) and then the option freeze panes"}, {"owner": {"reputation": 53, "user_id": 5560299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf7d7d581d8694e71b38f77a9f04833?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/5560299/brian"}, "edited": false, "score": 0, "creation_date": 1447951828, "post_id": 33791545, "comment_id": 55384879, "body": "Thanks Scott, but from what I can tell, that thread provides a solution to freeze the row, but not dynamically.  I updated the post with more information and in the example, I only want row 6 to freeze when it is the top row of the sheet.  I&#39;m still new to VBA and I suppose I could write a check to see if row 6 is the first row and then use the freeze code from the other thread, but that seems inefficient."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5560299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf7d7d581d8694e71b38f77a9f04833?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/5560299/brian"}, "edited": false, "score": 0, "creation_date": 1447952511, "post_id": 33791761, "comment_id": 55385373, "body": "Thanks Jeeped!  This is almost exactly what I was looking for.  By freezing the header row and adding your code, it achieves the desired result with the only caveat that the active cell has to be below iVISROWS, meaning the up/down arrows work great but not the scroll bar/buttons.  Good stuff and I&#39;m going to keep playing around with it."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1447886074, "creation_date": 1447886074, "answer_id": 33791761, "question_id": 33791545, "link": "https://stackoverflow.com/questions/33791545/scroll-then-lock-row/33791761#33791761", "title": "Scroll then lock row", "body": "<p>Use this in the worksheet's code page (right-click worksheet name tab, View Code).</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim iVISROWS As Long\n    Dim iHDRROWS As Long\n    iVISROWS = 5\n    iHDRROWS = 3\n    Cells(1, 1).Resize(iHDRROWS, 1).EntireRow.Hidden = _\n       Target(Target.Rows.Count).Row &gt; iVISROWS\nEnd Sub\n</code></pre>\n\n<p>Optionally, take out the declaration and assignment of <code>iVISROWS</code> and <code>iHDRROWS</code> and out the following into the declaration area (top) of a module code sheet.</p>\n\n<pre><code>Option Explicit\n\nPublic Const iVISROWS As Long = 5\nPublic Const iHDRROWS As Long = 3\n</code></pre>\n\n<p>Play with the number of header rows (iHDRROWS) and the bottom of the current selection that triggers hiding the header rows (iVISROWS) untilo you get the results you are looking for.</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 5560299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf7d7d581d8694e71b38f77a9f04833?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/5560299/brian"}, "edited": false, "score": 0, "creation_date": 1447952777, "post_id": 33792373, "comment_id": 55385567, "body": "Thanks Helena!  Your answer gave me a different perspective that I hadn&#39;t thought about.  Jeeped&#39;s answer above is what I had (mostly) envisioned but you bring up a great point about having to scroll back to the top to see the settings.  I also have buttons that will be useful to be able to see the active row and the button at the same time, so your solution of using a button to hide the settings/button area is a better design.  Thank you!!!"}, {"owner": {"reputation": 284, "user_id": 3286675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/CUYQa.png?s=128&g=1", "display_name": "helena4", "link": "https://stackoverflow.com/users/3286675/helena4"}, "reply_to_user": {"reputation": 53, "user_id": 5560299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf7d7d581d8694e71b38f77a9f04833?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/5560299/brian"}, "edited": false, "score": 0, "creation_date": 1447955921, "post_id": 33792373, "comment_id": 55387533, "body": "There is an even larger benefit to frozen navigation. If you have the first 10 rows frozen and scroll to row 10000, Clicking a hyperlink in the frozen A3 that takes you to another sheet KEEPS your scrolling position when you come back at row 10000. Hyperlink nav is real nice. I have a whole hub page for it."}], "tags": [], "owner": {"reputation": 284, "user_id": 3286675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/CUYQa.png?s=128&g=1", "display_name": "helena4", "link": "https://stackoverflow.com/users/3286675/helena4"}, "is_accepted": true, "score": 0, "last_activity_date": 1447888589, "creation_date": 1447888589, "answer_id": 33792373, "question_id": 33791545, "link": "https://stackoverflow.com/questions/33791545/scroll-then-lock-row/33792373#33792373", "title": "Scroll then lock row", "body": "<p>As far as i understood you want to keep visible a row or column thats not first. Which is kinda exotic.</p>\n\n<p>If you want to hide configureables to save visual space and keep headers at all times:</p>\n\n<p>Simply freeze as many rows/columns as you need for both your configs and headers. And then HIDE the rows/columns you won't want always in view.</p>\n\n<p>You can even have a simple button that does this hiding and unhiding via one click:</p>\n\n<pre><code>Sub transaction1()\n    Rows(\"10:50\").Hidden = Not Rows(\"10:50\").Hidden\nEnd Sub\n</code></pre>\n\n<p>As for the freeze panes, in case someone doesn't know you can freeze as many as you want. If you want to freeze columns A and B and rows 1 and 2 simply click on C3 and then use the freeze function. If you want to freeze 10 rows only - click on A11 and then use the freeze.</p>\n\n<p>Though i usually just offload my service space to elsewhere and quickly jump to and from it with =HYPERLINK()</p>\n\n<p>In any event your required result isn't any more convenient than the other ways you can achieve navigational ease. So if I've scrolled to row 14000 if i want to scroll back to the beginning to view my settings i still have to go through 14k rows. Having an always frozen settings area as well as headers is quicker to navigate. And if your settings area takes that much space either move it and create more compact navigations for it or simply hide/show it on demand.</p>\n\n<p>There is no doubt you can have even more exotic ways to achieve the effect, but is it mandatory to do it that way?</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9055128, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b4e34e709db01397c2c015e78edb715e?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/9055128/adam"}, "is_accepted": false, "score": 0, "last_activity_date": 1512463420, "creation_date": 1512463420, "answer_id": 47649344, "question_id": 33791545, "link": "https://stackoverflow.com/questions/33791545/scroll-then-lock-row/47649344#47649344", "title": "Scroll then lock row", "body": "<p>I had the same problem and have much less tech savvy to do all the coding above.\nMy workaround is very simple.\nInsert a new row right at the top of the sheet.\nCopy the headings of the table to the new row 1 and then freeze the top row as normal.\nAs you scroll the top dummy row stays above your table and the rest disapears.\nYour original headings still stay in place for filtering as needed if you scroll up.</p>\n"}], "owner": {"reputation": 53, "user_id": 5560299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf7d7d581d8694e71b38f77a9f04833?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/5560299/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1886, "favorite_count": 0, "accepted_answer_id": 33792373, "answer_count": 3, "score": 1, "last_activity_date": 1512463420, "creation_date": 1447885132, "last_edit_date": 1447951352, "question_id": 33791545, "link": "https://stackoverflow.com/questions/33791545/scroll-then-lock-row", "title": "Scroll then lock row", "body": "<p>I have a worksheet that has header data in the first few rows, followed by a table with column headers.  The header data includes parameters that are used to calculate values in the table.</p>\n\n<p>What I want is to allow the user to scroll the sheet so that the header data is no longer visible but then freeze the table heading row when it becomes the first row.  Then if they need to change a parameter, they can scroll back up and the top few rows come back into view.</p>\n\n<p>I thought this was fairly easy to do but I can't remember how to do it.  The only option I can find is the Freeze Panes option, but that freezes everything and I only want it to freeze when the header row is at the top.  </p>\n\n<p>Is this even possible?</p>\n\n<p>Edited - To add a little more clarification, the freeze panes option freezes everything above the selected row (unless I have missed it), which is not what I am looking for.  I want the sheet to behave similar to a website where there may be an ad banner at the top, followed by a navigation bar/logo/etc., then the content.  As you scroll down, the ad banner moves out of view but when the nav bar is at the top, it stops and remains in view while the content continues to scroll.</p>\n\n<p>Let's say I have the first 5 rows that have cells to capture input values.  Then row 6 is a table heading and rows 7-100 are the table data.  I want the user to be able to hit the scroll down button 5 times to move past the input values.  Then I want row 6 to freeze at the top so that as the user continues scrolling, the table heading is visible.  Conversely, when the user scrolls up, row 6 remains at the top until the user gets to row 7, then if they continue scrolling, the input values move into view.</p>\n\n<p>Excel does something similar if you use the \"format as table\" function and indicate that the selection has a header row.  Then when scrolling, the column headers will replace the \"A\", \"B\", \"C\", etc. address labels.  This won't work directly for me because the table structure is a little more complex.</p>\n"}, {"tags": ["vba", "range", "delete-row"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447883368, "post_id": 33791060, "comment_id": 55349255, "body": "Do you want to delete it if a whole column is blank or just one cell?"}, {"owner": {"reputation": 83, "user_id": 5477060, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10153083819422115/picture?type=large", "display_name": "Asim Ahmed", "link": "https://stackoverflow.com/users/5477060/asim-ahmed"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447884314, "post_id": 33791060, "comment_id": 55349758, "body": "no i am looking to delete a column if range of cells is blank the column, the columns have headers and another row of a data so i want to select start at a specific row (4)  to the end row"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447886386, "post_id": 33791060, "comment_id": 55350726, "body": "1)You can&#39;t do what you want with <code>isempty</code> 2) your <code>Cells()</code> references are wrong.  Study the answer I gave you, particularly the <code>IF</code> statement and how I did the <code>Cells()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5477060, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10153083819422115/picture?type=large", "display_name": "Asim Ahmed", "link": "https://stackoverflow.com/users/5477060/asim-ahmed"}, "edited": false, "score": 0, "creation_date": 1447886110, "post_id": 33791498, "comment_id": 55350617, "body": "kablam! this works, i&#39;m going to put my second attempt up in an edit, can you tell me what&#39;s wrong with it? i&#39;m going forward with your macro but want to see what i&#39;m doing wrong with mine and the differences in process from yours"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1447884918, "creation_date": 1447884918, "answer_id": 33791498, "question_id": 33791060, "link": "https://stackoverflow.com/questions/33791060/delete-column-if-range-is-blank/33791498#33791498", "title": "Delete column if range is blank", "body": "<p>Try this</p>\n\n<pre><code>Sub sbDelete_Columns_IF_Cell_Is_empty()\nDim lColumn As Long\nDim iCntr As Long\nDim ws As Worksheet\nDim rwsToCheck As Long\n\nSet ws = ActiveSheet\nrwsToCheck = 1000 'Change to what ever you want\nlColumn = 103\nFor iCntr = lColumn To 1 Step -1\n    If WorksheetFunction.CountA(ws.Range(ws.Cells(4, iCntr), ws.Cells(rwsToCheck, iCntr))) = 0 Then\n        ws.Columns(iCntr).Delete\n    End If\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5477060, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10153083819422115/picture?type=large", "display_name": "Asim Ahmed", "link": "https://stackoverflow.com/users/5477060/asim-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3243, "favorite_count": 0, "accepted_answer_id": 33791498, "answer_count": 1, "score": 2, "last_activity_date": 1447935203, "creation_date": 1447883295, "last_edit_date": 1447935203, "question_id": 33791060, "link": "https://stackoverflow.com/questions/33791060/delete-column-if-range-is-blank", "title": "Delete column if range is blank", "body": "<p>I am looking to find guidance on building a macro to delete columns depending if the range is empty. I am having trouble defining my range so it changes with every loop, i'm new to VBA so information on setting up this range would be helpful for this code and building code in the future!</p>\n\n<pre><code>Sub sbDelete_Columns_IF_Cell_Is_empty()\nDim lColumn As Long\nDim iCntr As Long\nlColumn = 103\nFor iCntr = lColumn To 1 Step -1\n    If IsEmpty(Range()\n        Columns(iCntr).Delete\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>second attempt, this is being weird and deleting columns that i don't want it to delete</p>\n\n<pre><code>Sub sbDelete_Columns_IF_Cell_Is_Blank()\nDim lColumn As Long\nDim iCntr As Long\nDim i As Integer\nDim f As Integer\ni = 4\nf = 100\n\nlColumn = 103\nFor iCntr = lColumn To 1 Step -1\n    If IsEmpty(Range(Cells(f, i), (Cells(f, i)))) = True Then\n        Columns(iCntr).Delete\n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447882794, "post_id": 33790917, "comment_id": 55348936, "body": "And using vlookup will not work?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447885128, "post_id": 33790917, "comment_id": 55350177, "body": "In B2 <code>=Vlookup(A2,&#39;Rebel Alliance Personnel: Ship and Weapon Preferences&#39;!A:C,2,False)</code> and Fill Down."}, {"owner": {"reputation": 1, "user_id": 4288843, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yBAzuCbMd1U/AAAAAAAAAAI/AAAAAAAAADE/BU9mNJ7S62A/photo.jpg?sz=128", "display_name": "Matthew Fuller", "link": "https://stackoverflow.com/users/4288843/matthew-fuller"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447945906, "post_id": 33790917, "comment_id": 55380433, "body": "Scott- Vlookup was my first goto but it returns &quot;Data Type Mismatch&quot; even though both cell values are set to &quot;Text&quot;. I have a special character in the cell, &quot; &#39; &quot;, which I think is throwing it off."}, {"owner": {"reputation": 1, "user_id": 4288843, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yBAzuCbMd1U/AAAAAAAAAAI/AAAAAAAAADE/BU9mNJ7S62A/photo.jpg?sz=128", "display_name": "Matthew Fuller", "link": "https://stackoverflow.com/users/4288843/matthew-fuller"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447946182, "post_id": 33790917, "comment_id": 55380661, "body": "I can&#39;t figure out how to format my comment reply to format the code either......"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447951040, "post_id": 33790917, "comment_id": 55384323, "body": "So you have a column filled with numbers or something else that you have forced to be text by placing the single quote in front?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447951823, "post_id": 33790917, "comment_id": 55384873, "body": "This may be one of those instances where we need a copy of your true data to be able to help."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4288843, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yBAzuCbMd1U/AAAAAAAAAAI/AAAAAAAAADE/BU9mNJ7S62A/photo.jpg?sz=128", "display_name": "Matthew Fuller", "link": "https://stackoverflow.com/users/4288843/matthew-fuller"}, "edited": false, "score": 0, "creation_date": 1447946333, "post_id": 33791558, "comment_id": 55380766, "body": "Thanks Dave- I tried copying and pasting the code in and changing the worksheet names to match my read document but I had no luck. I appreciate the effort you put in though!"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 1, "user_id": 4288843, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yBAzuCbMd1U/AAAAAAAAAAI/AAAAAAAAADE/BU9mNJ7S62A/photo.jpg?sz=128", "display_name": "Matthew Fuller", "link": "https://stackoverflow.com/users/4288843/matthew-fuller"}, "edited": false, "score": 0, "creation_date": 1447947396, "post_id": 33791558, "comment_id": 55381554, "body": "I edited the code for column H like you had in your original code, show a picture of the sheet and columns if it doesn&#39;t work"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1447947366, "last_edit_date": 1447947366, "creation_date": 1447885207, "answer_id": 33791558, "question_id": 33790917, "link": "https://stackoverflow.com/questions/33790917/after-finding-a-matching-value-return-a-different-value-in-corresponding-row/33791558#33791558", "title": "After finding a matching value, return a different value in corresponding row", "body": "<p>You cant have a worksheet with \":\" in the name,</p>\n\n<p>Try this Looping code, change the names of the worksheets accordingly.</p>\n\n<pre><code>Sub Button1_Click()\n    Dim sh1 As Worksheet, sh2 As Worksheet\n    Dim LsRw As Long, Rng As Range, c As Range, x As Range\n    Dim Lr As Long, Wrng As Range\n\n    Set sh1 = Sheets(\"Names\")\n    Set sh2 = Sheets(\"Weapons\")\n\n    With sh1\n        LsRw = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        Set Rng = .Range(\"A2:A\" &amp; LsRw)\n    End With\n\n    With sh2\n        Lr = .Cells(.Rows.Count, \"H\").End(xlUp).Row\n        Set Wrng = .Range(\"H2:H\" &amp; Lr)\n    End With\n\n    For Each c In Rng.Cells\n        For Each x In Wrng\n            If x = c Then\n                c.Offset(0, 1) = x.Offset(0, 1)\n                c.Offset(0, 2) = x.Offset(0, 2)\n            End If\n        Next x\n    Next c\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4288843, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yBAzuCbMd1U/AAAAAAAAAAI/AAAAAAAAADE/BU9mNJ7S62A/photo.jpg?sz=128", "display_name": "Matthew Fuller", "link": "https://stackoverflow.com/users/4288843/matthew-fuller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544433970, "creation_date": 1447882728, "last_edit_date": 1544433970, "question_id": 33790917, "link": "https://stackoverflow.com/questions/33790917/after-finding-a-matching-value-return-a-different-value-in-corresponding-row", "title": "After finding a matching value, return a different value in corresponding row", "body": "<p>Every day for work, I have around 400 unique values and I need to search for that value in a different sheet and pull a corresponding value back to the original sheet. I figured I'd take a shot at automating this as it's incredibly tedious to CRTL-F, CRTL-C, CRTL-V 400 times a day. </p>\n\n<p>To (attempt) to explain this better, I've set up a scenario below:</p>\n\n<p><strong>Worksheet(\"BattleOfEndor\")</strong></p>\n\n<p>Name</p>\n\n<p>Han Solo</p>\n\n<p>RedLeader1</p>\n\n<p>RedSquadron1</p>\n\n<p>RedSquadron2</p>\n\n<p>RedSquadron4</p>\n\n<p>BlueLeader1</p>\n\n<p>BlueSquadron4</p>\n\n<p><strong>Worksheet(\"Rebel Alliance Personnel: Ship and Weapon Preferences\")</strong></p>\n\n<p>(assume spaces are column breaks)</p>\n\n<p>Name Ship Weapon</p>\n\n<p>Luke_Skywalker X-Wing Lightsaber</p>\n\n<p>Leia_Skywalker N/A Blaster</p>\n\n<p>Gial_Ackbar Home_One N/A</p>\n\n<p>Han_Solo YT-1300_492727ZED Blaster</p>\n\n<p>RedLeader1 X-Wing Blaster</p>\n\n<p>RedSquadron1 X-Wing Blaster</p>\n\n<p>RedSquadron2 X-Wing Blaster</p>\n\n<p>RedSquadron3 X-Wing Blaster</p>\n\n<p>RedSquadron4 Y-Wing Blaster</p>\n\n<p>RedSquadron5 Y-Wing Blaster</p>\n\n<p>BlueLeader1 Z-95 Blaster</p>\n\n<p>BlueSquadron1 X-Wing Blaster</p>\n\n<p>BlueSquadron2 X-Wing Blaster</p>\n\n<p>BlueSquadron3 Y-Wing Blaster</p>\n\n<p>BlueSquadron4 Y-Wing Blaster</p>\n\n<p>BlueSquadron5 Y-Wing Blaster</p>\n\n<p>So regardless of who is first in the battle, I want my code to find him/her in my alternate sheet, copy his ship value and paste it in the adjacent column in the battle spreadsheet, then move to the next person in the battle to find out what ship they'd prefer to fly.</p>\n\n<pre><code>Dim Count As Integer\nDim Target As String\n\nWhile Count &lt; 433\nCount = Count + 1\nTarget = Worksheets(\"BattleOfEndor\").Range(\"A2:A433\").Cells(Count)\n\nWith Worksheets(\"Rebel Alliance Personnel: Ship and Weapon Preferences\").Range(\"H2:H433\")\nDim C As Range\nSet C = .Find(Target, LookIn:=xlValues)\n</code></pre>\n\n<p>I've copied much of the above from some other answers that related back to the .find or .findnext but I'm stumped on what my next steps are. </p>\n\n<p>Any ideas? Am I even close?</p>\n"}, {"tags": ["vba", "checkbox", "excel-formula"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447883183, "post_id": 33790851, "comment_id": 55349158, "body": "Does the formula work when added by itself to the sheet as an array formula?"}, {"owner": {"reputation": 1, "user_id": 5578594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e70aadcc2144e06f44b4a12336f201?s=128&d=identicon&r=PG&f=1", "display_name": "jap7675", "link": "https://stackoverflow.com/users/5578594/jap7675"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447918530, "post_id": 33790851, "comment_id": 55361548, "body": "Yes, it does what i want to to exactly! Just not as smoothly or as flexibly."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5578594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e70aadcc2144e06f44b4a12336f201?s=128&d=identicon&r=PG&f=1", "display_name": "jap7675", "link": "https://stackoverflow.com/users/5578594/jap7675"}, "edited": false, "score": 0, "creation_date": 1447920013, "post_id": 33791214, "comment_id": 55362332, "body": "Hi, Thanks so much for your hel - im getting really close to solving my problem.    Private Sub CheckBox1_Click()  If CheckBox1.Value = True Then     Sheets(&quot;Sheet1&quot;).Range(&quot;J4:J40&quot;).FormulaArray = &quot;=IFERROR(INDEX(C$2:C$14, SMALL(IF($B$2:$B$14=1, ROW($B$2:$B$14)-1),ROWS(G$2:G2))),&quot;&quot;&quot;&quot;)&quot;     Sheets(&quot;Sheet1&quot;).Range(&quot;J4:J40&quot;).Columns().AutoFit  ElseIf CheckBox1.Value = False Then     Range(&quot;J4:J40&quot;).Value = &quot; &quot; End If      End Sub    I just need the (G$2:G2) to occur sequentially {e.g. ((G$2:G3), (G$2:G4)), (G$2:G5)) etc}when the formula is repeated across the rane. Is this possible?"}, {"owner": {"reputation": 361, "user_id": 4406125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d283087551dc05b73a84f9efdd24e43b?s=128&d=identicon&r=PG&f=1", "display_name": "area9", "link": "https://stackoverflow.com/users/4406125/area9"}, "edited": false, "score": 1, "creation_date": 1447944965, "post_id": 33791214, "comment_id": 55379740, "body": "Doesn&#39;t an array formula require the range that the values are going into? i.e. change &quot;.Range(&quot;J4&quot;).FormulaArray&quot; to the array needed like &quot;.Range(&quot;J4:P23&quot;).FormulaArray&quot;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1, "user_id": 5578594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e70aadcc2144e06f44b4a12336f201?s=128&d=identicon&r=PG&f=1", "display_name": "jap7675", "link": "https://stackoverflow.com/users/5578594/jap7675"}, "edited": false, "score": 0, "creation_date": 1449356538, "post_id": 33791214, "comment_id": 55973686, "body": "@jap7675 sorry for the delay I missed your last comment I have edited the answer.  I hope you had found the answer else where."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1449356554, "last_edit_date": 1449356554, "creation_date": 1447883892, "answer_id": 33791214, "question_id": 33790851, "link": "https://stackoverflow.com/questions/33790851/apply-a-formula-from-check-box-in-vba/33791214#33791214", "title": "Apply a formula from check box in VBA", "body": "<p>The array formula <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837104.aspx\" rel=\"nofollow\">must be R1C1 format not A1</a>.</p>\n\n<p>So:</p>\n\n<pre><code>Private Sub CheckBox1_Click()\nIf OptionButton1.Value = True Then\n    Sheets(\"Sheet1\").Range(\"J4\").FormulaArray = \"=IFERROR(INDEX(R2C[-9]:R14C[-9], SMALL(IF(R2C2:R14C2=1, ROW(R2C2:R14C2)-1),ROWS(R2C[-5]:R[-2]C[-5]))),\"\"\"\")\"\n    Sheets(\"Sheet1\").Range(\"J4\").Columns().AutoFit\n    Sheets(\"Sheet1\").Range(\"J4:J40\").AutoFill\nElseIf OptionButton1.Value = False Then\n    Range(\"J4\").Value = \" \"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5578594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e70aadcc2144e06f44b4a12336f201?s=128&d=identicon&r=PG&f=1", "display_name": "jap7675", "link": "https://stackoverflow.com/users/5578594/jap7675"}, "edited": false, "score": 0, "creation_date": 1447919996, "post_id": 33791233, "comment_id": 55362317, "body": "Hi, Thanks so much for your hel - im getting really close to solving my problem.    Private Sub CheckBox1_Click()  If CheckBox1.Value = True Then     Sheets(&quot;Sheet1&quot;).Range(&quot;J4:J40&quot;).FormulaArray = &quot;=IFERROR(INDEX(C$2:C$14, SMALL(IF($B$2:$B$14=1, ROW($B$2:$B$14)-1),ROWS(G$2:G2))),&quot;&quot;&quot;&quot;)&quot;     Sheets(&quot;Sheet1&quot;).Range(&quot;J4:J40&quot;).Columns().AutoFit  ElseIf CheckBox1.Value = False Then     Range(&quot;J4:J40&quot;).Value = &quot; &quot; End If      End Sub    I just need the (G$2:G2) to occur sequentially {e.g. ((G$2:G3), (G$2:G4)), (G$2:G5)) etc}when the formula is repeated across the rane. Is this possible?"}, {"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "reply_to_user": {"reputation": 1, "user_id": 5578594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e70aadcc2144e06f44b4a12336f201?s=128&d=identicon&r=PG&f=1", "display_name": "jap7675", "link": "https://stackoverflow.com/users/5578594/jap7675"}, "edited": false, "score": 0, "creation_date": 1449071901, "post_id": 33791233, "comment_id": 55849014, "body": "Do you think you could explain in words what you&#39;re trying to do? I&#39;ve been playing with your formula and it does some really weird stuff.  I&#39;m not sure, for example, why you bother referencing column G at all.  Maybe this is my opportunity to learn something, but it seems like ROWS(G$2:Gn) would give you a row count at the current row. That&#39;s exactly what ROW($B$2:$B$14)-1 gives you.  Also, if one of the values in column B is not 1, the &quot;IF&quot; returns FALSE causing SMALL to error.  Only, I&#39;m observing that as an array formula it doesn&#39;t error but seems to shift the rows up.  Confusing."}], "tags": [], "owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "is_accepted": false, "score": 0, "last_activity_date": 1447883972, "creation_date": 1447883972, "answer_id": 33791233, "question_id": 33790851, "link": "https://stackoverflow.com/questions/33790851/apply-a-formula-from-check-box-in-vba/33791233#33791233", "title": "Apply a formula from check box in VBA", "body": "<p>Not sure if this is the only problem, but consider changing this line:</p>\n\n<pre><code>Selection.FormulaArray = \"=IFERROR(INDEX(C$2:C$14, SMALL(IF($B$2:$B$14=1, ROW($B$2:$B$14)-1),ROWS(G$2:G2))),\"\")\"\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>Selection.FormulaArray = \"=IFERROR(INDEX(C$2:C$14, SMALL(IF($B$2:$B$14=1, ROW($B$2:$B$14)-1),ROWS(G$2:G2))),\"\"\"\")\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5578594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e70aadcc2144e06f44b4a12336f201?s=128&d=identicon&r=PG&f=1", "display_name": "jap7675", "link": "https://stackoverflow.com/users/5578594/jap7675"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1449356554, "creation_date": 1447882474, "last_edit_date": 1447887813, "question_id": 33790851, "link": "https://stackoverflow.com/questions/33790851/apply-a-formula-from-check-box-in-vba", "title": "Apply a formula from check box in VBA", "body": "<p>I've been struggling with this for a while now. I have this code:</p>\n\n<pre><code> Private Sub CheckBox1_Click()\n If OptionButton1.Value = True Then\n Sheets(\"Sheet1\").Select\n Range(\"J4\").Select\n Selection.FormulaArray = \"=IFERROR(INDEX(C$2:C$14, SMALL(IF($B$2:$B$14=1, ROW($B$2:$B$14)-1),ROWS(G$2:G2))),\"\")\"\n Selection.Columns.AutoFit\n\n ElseIf OptionButton1.Value = False Then\n Range(\"J4\").Value = \" \"\n End If\n\n End Sub\n</code></pre>\n\n<p>Where I'm trying to get the formula performed in cell J4. It just won't do it! And I don't really get why!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447882325, "post_id": 33790743, "comment_id": 55348668, "body": "Guessing there&#39;s an error? If so, where and what?"}, {"owner": {"reputation": 21, "user_id": 5530723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YcLId.jpg?s=128&g=1", "display_name": "ejdav", "link": "https://stackoverflow.com/users/5530723/ejdav"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447882944, "post_id": 33790743, "comment_id": 55349021, "body": "Run-time error &#39;1004&#39;:  Unable to set the locked property of the range class. When ActiveWorkbook.ActiveSheet.Cells.Locked = True is used"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447884063, "post_id": 33790743, "comment_id": 55349621, "body": "1) At what point did you got that error, can&#39;t see the command <code>ActiveWorkbook.ActiveSheet.Cells.Locked = True</code> in your code.  2) is &quot;locked&quot; the password of the worksheet?"}, {"owner": {"reputation": 21, "user_id": 5530723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YcLId.jpg?s=128&g=1", "display_name": "ejdav", "link": "https://stackoverflow.com/users/5530723/ejdav"}, "edited": false, "score": 0, "creation_date": 1447884333, "post_id": 33790743, "comment_id": 55349771, "body": "1) the error occurs where you have listed, 2) &quot;locked&quot; is the password"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447884381, "post_id": 33790743, "comment_id": 55349802, "body": "@EEM and ejdav my bad I have deleted my answer.  I got a phone call while reading the question and made an assumption."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447885734, "post_id": 33790743, "comment_id": 55350450, "body": "Something does not makes sense here I tried the code with the <code>ActiveWorkbook.ActiveSheet.Cells.Locked = True</code> in the right place and it works, so please bear with me:  1) Is this button in the same worksheet you want to unprotect?  2) Do you mind editing your code and placing this line <code>ActiveWorkbook.ActiveSheet.Cells.Locked = True</code> as it was at the time of the error in your code? thanks..."}, {"owner": {"reputation": 21, "user_id": 5530723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YcLId.jpg?s=128&g=1", "display_name": "ejdav", "link": "https://stackoverflow.com/users/5530723/ejdav"}, "edited": false, "score": 0, "creation_date": 1447943527, "post_id": 33790743, "comment_id": 55378675, "body": "I now think my issue is related to cells being merged in the worksheet, I am exploring un-merging the cells before locking the cells. I see some advice on locking merged cells but I can&#39;t make it work. <a href=\"http://stackoverflow.com/questions/9184818/error-1004-when-setting-range-locked\" title=\"error 1004 when setting range locked\">stackoverflow.com/questions/9184818/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5530723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YcLId.jpg?s=128&g=1", "display_name": "ejdav", "link": "https://stackoverflow.com/users/5530723/ejdav"}, "edited": false, "score": 0, "creation_date": 1447882742, "post_id": 33790833, "comment_id": 55348900, "body": "I tried that and got a run time error 1004: unable to set the locked property of the range class"}, {"owner": {"reputation": 361, "user_id": 4406125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d283087551dc05b73a84f9efdd24e43b?s=128&d=identicon&r=PG&f=1", "display_name": "area9", "link": "https://stackoverflow.com/users/4406125/area9"}, "reply_to_user": {"reputation": 21, "user_id": 5530723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YcLId.jpg?s=128&g=1", "display_name": "ejdav", "link": "https://stackoverflow.com/users/5530723/ejdav"}, "edited": false, "score": 1, "creation_date": 1447882863, "post_id": 33790833, "comment_id": 55348978, "body": "Did you have the sheet unprotected first?"}, {"owner": {"reputation": 21, "user_id": 5530723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YcLId.jpg?s=128&g=1", "display_name": "ejdav", "link": "https://stackoverflow.com/users/5530723/ejdav"}, "edited": false, "score": 0, "creation_date": 1447884140, "post_id": 33790833, "comment_id": 55349664, "body": "yes and I also unlocked the protection on the workbook structure"}], "tags": [], "owner": {"reputation": 361, "user_id": 4406125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d283087551dc05b73a84f9efdd24e43b?s=128&d=identicon&r=PG&f=1", "display_name": "area9", "link": "https://stackoverflow.com/users/4406125/area9"}, "is_accepted": false, "score": 1, "last_activity_date": 1447882422, "creation_date": 1447882422, "answer_id": 33790833, "question_id": 33790743, "link": "https://stackoverflow.com/questions/33790743/vba-to-change-cell-protection-format-from-unlocked-to-locked/33790833#33790833", "title": "VBA to change cell protection format from unlocked to locked", "body": "<p>Is this what you mean:</p>\n\n<pre><code>ActiveWorkbook.ActiveSheet.Cells.Locked = True\n</code></pre>\n\n<p>This will set all the cells in the sheet to locked</p>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 0, "last_activity_date": 1447969015, "creation_date": 1447969015, "answer_id": 33814810, "question_id": 33790743, "link": "https://stackoverflow.com/questions/33790743/vba-to-change-cell-protection-format-from-unlocked-to-locked/33814810#33814810", "title": "VBA to change cell protection format from unlocked to locked", "body": "<p>The problem seems to be triggered by the Events in your workbook. try this:</p>\n\n<pre><code>Sub Button9_Click()\nConst kPassWord As String = \"locked\"\nConst kCll As String = \"I109\"\n\n    With ActiveWorkbook.ActiveSheet\n        If .Range(kCll) = Empty Then\n            If MsgBox(\"Are you sure you want to sign-off COMPLETE as Reviewer?\", vbYesNo) = vbNo Then Exit Sub\n            Application.EnableEvents = False\n            .Unprotect kPassWord\n            .Range(kCll).Value = \"Reviewed: \" &amp; _\n                Format(Date, \"mm/dd/yyyy\") &amp; \" By: \" &amp; Application.UserName\n            .Cells.Locked = True\n            .Cells.FormulaHidden = False\n            .Protect kPassWord\n            Application.EnableEvents = True\n    End If: End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5530723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YcLId.jpg?s=128&g=1", "display_name": "ejdav", "link": "https://stackoverflow.com/users/5530723/ejdav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2606, "favorite_count": 0, "accepted_answer_id": 33814810, "answer_count": 2, "score": 0, "last_activity_date": 1447969015, "creation_date": 1447882123, "last_edit_date": 1531164843, "question_id": 33790743, "link": "https://stackoverflow.com/questions/33790743/vba-to-change-cell-protection-format-from-unlocked-to-locked", "title": "VBA to change cell protection format from unlocked to locked", "body": "<p>My worksheet contains cells that are locked to protect formulas and unlocked to allow data entry.  At the end of the worksheet is a sign-off button for a reviewer.  I want to add VBA to this button that will lock the previously unlocked cells (by cell format) to prevent changes after the review is complete for the worksheet.</p>\n\n<p>Here is my current code - </p>\n\n<pre><code>Sub Button9_Click()\nIf Range(\"I108\") = Empty Then\nIf MsgBox(\"Are you sure you want to sign-off COMPLETE as Reviewer?\", vbYesNo) = vbNo Then Exit Sub\nActiveWorkbook.ActiveSheet.Unprotect \"locked\"\nActiveWorkbook.ActiveSheet.Range(\"I109\").Value = \"Reviewed: \" &amp; Format(Date, \"mm/dd/yyyy\") &amp; \" By: \" &amp; Application.UserName\nActiveWorkbook.ActiveSheet.Protect \"locked\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2013", "delete-row", "vba"], "comments": [{"owner": {"reputation": 81, "user_id": 3142412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23537625b3984ddb96da966921a4b33?s=128&d=identicon&r=PG&f=1", "display_name": "user3142412", "link": "https://stackoverflow.com/users/3142412/user3142412"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1447940509, "post_id": 33790644, "comment_id": 55376371, "body": "@pnuts : That did the trick! Thank you"}, {"owner": {"reputation": 284, "user_id": 3286675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/CUYQa.png?s=128&g=1", "display_name": "helena4", "link": "https://stackoverflow.com/users/3286675/helena4"}, "edited": false, "score": 0, "creation_date": 1447967336, "post_id": 33790644, "comment_id": 55394315, "body": "do you need to actually delete it or just empty it? VBA can be avoided if you don&#39;t need to delete the row."}], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1517105204, "creation_date": 1517105204, "answer_id": 48482489, "question_id": 33790644, "link": "https://stackoverflow.com/questions/33790644/macro-to-delete-last-row-in-table/48482489#48482489", "title": "Macro to delete last row in table", "body": "<p>Seems this suited:</p>\n\n<blockquote>\n  <p>select a cell within it and run <code>Selection.End(xlDown).Delete Shift:=xlUp</code></p>\n</blockquote>\n"}], "owner": {"reputation": 81, "user_id": 3142412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23537625b3984ddb96da966921a4b33?s=128&d=identicon&r=PG&f=1", "display_name": "user3142412", "link": "https://stackoverflow.com/users/3142412/user3142412"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4731, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517105204, "creation_date": 1447881701, "last_edit_date": 1531161705, "question_id": 33790644, "link": "https://stackoverflow.com/questions/33790644/macro-to-delete-last-row-in-table", "title": "Macro to delete last row in table", "body": "<p>I have a table in Excel filled with data.  </p>\n\n<p>Is there any way to create a macro that deletes the last row in the table and automatically updates the new table range to NOT include that row?</p>\n"}, {"tags": ["vba", "excel", "hyperlink"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1447881921, "post_id": 33790587, "comment_id": 55348426, "body": "Concatenate constant, column A and column B then use <code>hyperlink</code> in column D?"}, {"owner": {"reputation": 13, "user_id": 5578488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a853ec59d927d2f21577af439b7c107?s=128&d=identicon&r=PG&f=1", "display_name": "C.Sophia", "link": "https://stackoverflow.com/users/5578488/c-sophia"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447883745, "post_id": 33790587, "comment_id": 55349460, "body": "If the project number is 32508 and the field is structural the file is stored in T/project/32&#39;s/32508/structural . so after clicking file &quot;project&quot; it will show like 21s, 22s,.... till 34s, then when i click each of them, the full Project name is  then shown."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447884452, "post_id": 33790587, "comment_id": 55349848, "body": "I don&#39;t really understand how your data looks so can&#39;t help further :/"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447884767, "post_id": 33790587, "comment_id": 55350005, "body": "I&#39;m trying to understand but it&#39;s really confusing. 1) What&#39;s the logic behind this statement:  &quot;so after clicking file &quot;project&quot; it will show like 21s, 22s,.... till 34s, then when i click each of them, the full Project name is then shown&quot;  2)What will trigger to show all that with just one click?"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447884859, "post_id": 33790587, "comment_id": 55350051, "body": "could you post a meaningful piece of your data with the expected URLs"}, {"owner": {"reputation": 13, "user_id": 5578488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a853ec59d927d2f21577af439b7c107?s=128&d=identicon&r=PG&f=1", "display_name": "C.Sophia", "link": "https://stackoverflow.com/users/5578488/c-sophia"}, "edited": false, "score": 0, "creation_date": 1447886658, "post_id": 33790587, "comment_id": 55350845, "body": "I&#39;ve added some pictures. The first picture shows what the file looks like in the local computer.The second picture shows what i want to show in the Excel. Hope that helps...."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447888137, "post_id": 33790587, "comment_id": 55351413, "body": "Ok. So you need a few more columns. Concatenate them all then do hyperlink. Hardest part is getting full project. Your best bet is to use filesystem object to loop through folder to retrieve them."}, {"owner": {"reputation": 13, "user_id": 5578488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a853ec59d927d2f21577af439b7c107?s=128&d=identicon&r=PG&f=1", "display_name": "C.Sophia", "link": "https://stackoverflow.com/users/5578488/c-sophia"}, "edited": false, "score": 0, "creation_date": 1447888328, "post_id": 33790587, "comment_id": 55351498, "body": "Could you Pls explain a little bit more in detail.... THANK YOU VERY MUCH~~~~"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447888478, "post_id": 33790587, "comment_id": 55351555, "body": "If you can comment that it doesn&#39;t work, you know how to concatenate. The part I guess you don&#39;t know is FSO. Study it <a href=\"https://msdn.microsoft.com/en-us/library/aa711216(v=vs.71).aspx\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1447903918, "post_id": 33790587, "comment_id": 55356176, "body": "Where does the address between the &#39;34011&#39; and the &#39;Geotech&#39; come from?"}, {"owner": {"reputation": 13, "user_id": 5578488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a853ec59d927d2f21577af439b7c107?s=128&d=identicon&r=PG&f=1", "display_name": "C.Sophia", "link": "https://stackoverflow.com/users/5578488/c-sophia"}, "edited": false, "score": 0, "creation_date": 1447986574, "post_id": 33790587, "comment_id": 55401778, "body": "oh that&#39;s the name of the project file.."}], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1447886297, "creation_date": 1447886297, "answer_id": 33791812, "question_id": 33790587, "link": "https://stackoverflow.com/questions/33790587/adding-hyperlinks-with-vba/33791812#33791812", "title": "Adding Hyperlinks with VBA", "body": "<p>A data sample will certainly help to understand what you are trying to achieve. Please update your question and then leave a comment to notify people who are watching this thread. </p>\n\n<p>As far as I understand your question, you want to concatenate several cells into a string that can then be used to construct a hyperlink. Consider this screenshot</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ecn6H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ecn6H.png\" alt=\"enter image description here\"></a></p>\n\n<p>the formula in cell C2 is</p>\n\n<pre><code>=\"\\nas1\\backup\\dop4\\jobdata\\projects\\\"&amp;LEFT(TEXT(A2,\"0\"),2)&amp;\"s\"\n</code></pre>\n\n<p>Copy down. In D2 you can use the Hyperlink() function to refer to the Address in C2, or wrap a hyperlink function around the formula in C2.</p>\n"}], "owner": {"reputation": 13, "user_id": 5578488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a853ec59d927d2f21577af439b7c107?s=128&d=identicon&r=PG&f=1", "display_name": "C.Sophia", "link": "https://stackoverflow.com/users/5578488/c-sophia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 33791812, "answer_count": 1, "score": 1, "last_activity_date": 1447887254, "creation_date": 1447881507, "last_edit_date": 1447887254, "question_id": 33790587, "link": "https://stackoverflow.com/questions/33790587/adding-hyperlinks-with-vba", "title": "Adding Hyperlinks with VBA", "body": "<p>I have two columns in an Excel sheet containing Project names (Column A) and Fields (Column B) and I'm trying to add hyperlink for each row to local files. There's one specific local file for each row. </p>\n\n<p>I don't know how to use Hyperlink function to get the corresponding URLs automatically because there are around 10,000 Project names. I also don't know if it is easier to use VBA. </p>\n\n<p>The URLs are all identical except from \"projects\":</p>\n\n<p>\\nas1\\backup\\dop4\\jobdata\\projects\\34s\\34038 - 10 Wharaora Tce\\Structural</p>\n\n<p>The Project name in Column A is something like <code>34038</code>, <code>25794</code> etc. and Filed in Column B is something like <code>Structural</code>, <code>Civil</code> etc.</p>\n\n<p>So my plan is to write a VBA program that adds hyperlinks using URLs constructed from: </p>\n\n<p>\\nas1\\backup\\dop4\\jobdata\\projects</p>\n\n<p>Because the Project name in column A is 5 digits, I'm thinking of using the LEFT function to get the first two digits to find the files after \"Project file\".</p>\n\n<p><a href=\"https://i.stack.imgur.com/b4G7q.png\" rel=\"nofollow noreferrer\">Folders</a><br>\n<a href=\"https://i.stack.imgur.com/b4G7q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/b4G7q.png\" alt=\"Folders\"></a>\n<a href=\"https://i.stack.imgur.com/qEFV1.png\" rel=\"nofollow noreferrer\">Excel file</a>\n<a href=\"https://i.stack.imgur.com/qEFV1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qEFV1.png\" alt=\"Excel file\"></a></p>\n"}, {"tags": ["vba", "excel", "unpivot", "sas-macro"], "comments": [{"owner": {"reputation": 51, "user_id": 5472914, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10205303802534072/picture?type=large", "display_name": "Xinxin Li", "link": "https://stackoverflow.com/users/5472914/xinxin-li"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1447881025, "post_id": 33790370, "comment_id": 55347909, "body": "If it&#39;s possible to do it in SAS macro language"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447881108, "post_id": 33790370, "comment_id": 55347967, "body": "Instead of screenshots, can you copy/paste the data in there? That way we can use it on our end to try it out."}, {"owner": {"reputation": 51, "user_id": 5472914, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10205303802534072/picture?type=large", "display_name": "Xinxin Li", "link": "https://stackoverflow.com/users/5472914/xinxin-li"}, "edited": false, "score": 0, "creation_date": 1447881632, "post_id": 33790370, "comment_id": 55348257, "body": "Thanks. I copy paste it."}], "answers": [{"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 1, "creation_date": 1447882576, "post_id": 33790599, "comment_id": 55348804, "body": "As the currency is later needed for the <code>HLOOKUP</code>, instead of &quot;moving it out of the way&quot; it can be &quot;filtered out&quot; in the Pivot Table"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447883119, "post_id": 33790599, "comment_id": 55349115, "body": "Thanks to you, for the wizard and the reverse PivotTable concept. Learned something new today, great..."}, {"owner": {"reputation": 51, "user_id": 5472914, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10205303802534072/picture?type=large", "display_name": "Xinxin Li", "link": "https://stackoverflow.com/users/5472914/xinxin-li"}, "edited": false, "score": 1, "creation_date": 1447959284, "post_id": 33790599, "comment_id": 55389586, "body": "Thank you all for the suggestions!"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 4, "last_activity_date": 1447881546, "last_edit_date": 1495540238, "creation_date": 1447881546, "answer_id": 33790599, "question_id": 33790370, "link": "https://stackoverflow.com/questions/33790370/efficiently-reformat-data-layout/33790599#33790599", "title": "Efficiently reformat data layout", "body": "<p>Turn on Record Macro if desired. In Excel, move the currency row out of the way. 'Reverse pivot' (as detailed <a href=\"https://stackoverflow.com/a/20543651/1505120\">here</a>), sort the Table on Column A to Z, switch the order of Columns B and C and fill Column D with a lookup of the company name against your currency indicators.  </p>\n"}], "owner": {"reputation": 51, "user_id": 5472914, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10205303802534072/picture?type=large", "display_name": "Xinxin Li", "link": "https://stackoverflow.com/users/5472914/xinxin-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 1, "accepted_answer_id": 33790599, "answer_count": 1, "score": -1, "last_activity_date": 1448815241, "creation_date": 1447880776, "last_edit_date": 1448815241, "question_id": 33790370, "link": "https://stackoverflow.com/questions/33790370/efficiently-reformat-data-layout", "title": "Efficiently reformat data layout", "body": "<p>I have several Excel spreadsheets with data layout like this <a href=\"https://i.stack.imgur.com/QOju9.jpg\" rel=\"nofollow noreferrer\">raw data</a>: </p>\n\n<p><a href=\"https://i.stack.imgur.com/uxbVq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uxbVq.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>company company1    company2    company3\ncurrency     $        Y          E\n1/1/2013    32.68   12          3\n1/2/2013    12.5    13          4\n1/3/2013    45      45          8  \n</code></pre>\n\n<p>which basically are time series data grouped together. I need the final layout transformed into panel data, like this <a href=\"https://i.stack.imgur.com/h7O7V.jpg\" rel=\"nofollow noreferrer\">wanted panel data</a>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/BFZrB.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BFZrB.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Since my observations are usually very large, it is not practical manually to reformat it.  </p>\n\n<p>Is there a macro code that can achieve such a goal?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "edited": false, "score": 2, "creation_date": 1447878831, "post_id": 33789568, "comment_id": 55346682, "body": "have a look at this: <a href=\"http://stackoverflow.com/questions/9827715/get-list-of-subdirs-in-vba\" title=\"get list of subdirs in vba\">stackoverflow.com/questions/9827715/get-list-of-subdirs-in-v&zwnj;&#8203;ba</a>"}], "answers": [{"tags": [], "owner": {"reputation": 361, "user_id": 4406125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d283087551dc05b73a84f9efdd24e43b?s=128&d=identicon&r=PG&f=1", "display_name": "area9", "link": "https://stackoverflow.com/users/4406125/area9"}, "is_accepted": false, "score": 1, "last_activity_date": 1447879173, "creation_date": 1447879173, "answer_id": 33789922, "question_id": 33789568, "link": "https://stackoverflow.com/questions/33789568/open-workbooks-in-a-folder-and-subfolders-and-update-each/33789922#33789922", "title": "Open workbooks in a folder and subfolders and update each", "body": "<p>Ok, you'll need to use the FileSystemObject and add a reference to the Windows Script Host Object Model in Tools->References. Then try the code below.</p>\n\n<pre><code>Sub AllWorkbooks()\n\n    Dim MyFolder As String 'Path collected from the folder picker dialog\n    Dim MyFile As String 'Filename obtained by DIR function\n    Dim wbk As Workbook 'Used to loop through each workbook\n    Dim FSO As New FileSystemObject ' Requires \"Windows Script Host Object Model\" in Tools -&gt; References\n    Dim ParentFolder As Object, ChildFolder As Object\n\n    On Error Resume Next\n    Application.ScreenUpdating = False\n\n    'Opens the folder picker dialog to allow user selection\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .Title = \"Please select a folder\"\n        .Show\n        .AllowMultiSelect = False\n\n        If .SelectedItems.Count = 0 Then 'If no folder is selected, abort\n            MsgBox \"You did not select a folder\"\n            Exit Sub\n        End If\n\n        MyFolder = .SelectedItems(1) &amp; \"\\\" 'Assign selected folder to MyFolder\n    End With\n\n    MyFile = Dir(MyFolder) 'DIR gets the first file of the folder\n\n    'Loop through all files in a folder until DIR cannot find anymore\n    Do While MyFile &lt;&gt; \"\"\n        'Opens the file and assigns to the wbk variable for future use\n        Set wbk = Workbooks.Open(Filename:=MyFolder &amp; MyFile)\n        'Replace the line below with the statements you would want your macro to perform\n        ActiveWorkbook.RefreshAll\n        Application.Wait (Now + TimeValue(\"0:00:05\"))\n        wbk.Close savechanges:=True\n        MyFile = Dir 'DIR gets the next file in the folder\n    Loop\n\n    For Each ChildFolder In FSO.GetFolder(MyFolder).SubFolders\n        MyFile = Dir(MyFolder &amp; ChildFolder.Name) 'DIR gets the first file of the folder\n        'Loop through all files in a folder until DIR cannot find anymore\n        Do While MyFile &lt;&gt; \"\"\n            'Opens the file and assigns to the wbk variable for future use\n            Set wbk = Workbooks.Open(Filename:=MyFolder &amp; ChildFolder.Name &amp; \"\\\" &amp; MyFile)\n            'Replace the line below with the statements you would want your macro to perform\n            ActiveWorkbook.RefreshAll\n            Application.Wait (Now + TimeValue(\"0:00:05\"))\n            wbk.Close savechanges:=True\n            MyFile = Dir 'DIR gets the next file in the folder\n        Loop\n    Next ChildFolder\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1447890308, "creation_date": 1447890308, "answer_id": 33792692, "question_id": 33789568, "link": "https://stackoverflow.com/questions/33789568/open-workbooks-in-a-folder-and-subfolders-and-update-each/33792692#33792692", "title": "Open workbooks in a folder and subfolders and update each", "body": "<p>Or, you can just use CMD and read the output, much faster for drilling down through subfolders.</p>\n\n<p>I've used <code>\".xl*\"</code> as the file filter (I assume you only want Excel files?) but change this as you see fit:</p>\n\n<pre><code>Sub MM()\n\nConst startFolder As String = \"C:\\Users\\MacroMan\\Folders\\\" '// note trailing '\\'\nDim file As Variant, wb As Excel.Workbook\n\nFor Each file In Filter(Split(CreateObject(\"WScript.Shell\").Exec(\"CMD /C DIR \"\"\" &amp; startFolder &amp; \"*.xl*\"\" /S /B /A:-D\").StdOut.ReadAll, vbCrLf), \".\")\n    Set wb = Workbooks.Open(file)\n    '// Do what you want here with the workbook\n    wb.Close SaveChanges:=True '// or false...\n    Set wb = Nothing\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 1282217, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8e49c788b1719274725cba678884b186?s=128&d=identicon&r=PG", "display_name": "Michael Sigman", "link": "https://stackoverflow.com/users/1282217/michael-sigman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3081, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1447890308, "creation_date": 1447877883, "last_edit_date": 1447878663, "question_id": 33789568, "link": "https://stackoverflow.com/questions/33789568/open-workbooks-in-a-folder-and-subfolders-and-update-each", "title": "Open workbooks in a folder and subfolders and update each", "body": "<p>I am running the following VBA in Ecel to open a folder and then update all Excel sheets within this folder.   However I would like it to include all subfolders as well.</p>\n\n<pre><code> Sub AllWorkbooks()\n    Dim MyFolder As String 'Path collected from the folder picker dialog\n    Dim MyFile As String 'Filename obtained by DIR function\n    Dim wbk As Workbook 'Used to loop through each workbook\n\n    On Error Resume Next\n\n    Application.ScreenUpdating = False\n\n    'Opens the folder picker dialog to allow user selection\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .Title = \"Please select a folder\"\n        .Show\n        .AllowMultiSelect = False\n        If .SelectedItems.Count = 0 Then 'If no folder is selected, abort\n            MsgBox \"You did not select a folder\"\n            Exit Sub\n        End If\n\n        MyFolder = .SelectedItems(1) &amp; \"\\\" 'Assign selected folder to MyFolder\n\n    End With\n\n    MyFile = Dir(MyFolder) 'DIR gets the first file of the folder\n\n    'Loop through all files in a folder until DIR cannot find anymore\n    Do While MyFile &lt;&gt; \u201c\u201d\n       'Opens the file and assigns to the wbk variable for future use\n       Set wbk = Workbooks.Open(Filename:=MyFolder &amp; MyFile)\n       'Replace the line below with the statements you would want your macro to perform\n       ActiveWorkbook.RefreshAll\n       Application.Wait (Now + TimeValue(\"0:00:05\"))\n       wbk.Close savechanges:=True\n       MyFile = Dir 'DIR gets the next file in the folder\n    Loop\n\n    Application.ScreenUpdating = True\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447878603, "post_id": 33789392, "comment_id": 55346550, "body": "See <a href=\"http://stackoverflow.com/questions/15630035/how-to-clear-the-vba-code-of-a-worksheet-via-a-macro\">here</a>.  It will point you in the right direction."}], "answers": [{"tags": [], "owner": {"reputation": 361, "user_id": 4406125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d283087551dc05b73a84f9efdd24e43b?s=128&d=identicon&r=PG&f=1", "display_name": "area9", "link": "https://stackoverflow.com/users/4406125/area9"}, "is_accepted": false, "score": 0, "last_activity_date": 1447881361, "creation_date": 1447881361, "answer_id": 33790544, "question_id": 33789392, "link": "https://stackoverflow.com/questions/33789392/deleting-workbook-open-code-with-button-click-before-save/33790544#33790544", "title": "Deleting Workbook_open() code with button click before save", "body": "<p>Try adding this:</p>\n\n<pre><code>With ThisWorkbook.VBProject.VBComponents(\"ThisWorkbook\").CodeModule\n    .DeleteLines 1, .CountOfLines\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5578285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d6b439de2d460d47458180f76bdd44?s=128&d=identicon&r=PG&f=1", "display_name": "Urabea", "link": "https://stackoverflow.com/users/5578285/urabea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447881361, "creation_date": 1447877285, "last_edit_date": 1531164843, "question_id": 33789392, "link": "https://stackoverflow.com/questions/33789392/deleting-workbook-open-code-with-button-click-before-save", "title": "Deleting Workbook_open() code with button click before save", "body": "<p>I am new to VBA, I have a workbook that I am using to generate purchase orders.\nIn ThisWorkbook I have the below code.</p>\n\n<pre><code>Private Sub Workbook_open()\nSheet1.[g6] = Sheet1.[g6] + 1\nSheet1.[b4] = \"\"\nSheet1.[c10] = \"\"\nSheet1.[a17] = \"\"\nSheet1.[a20:h35] = \"\"\nSheet1.CommandButton2.Enabled = False\nSheet1.CommandButton1.Enabled = False\nEnd Sub\n</code></pre>\n\n<p>I also have the attached code on Sheet1. Is there a way to delete the Workbook_open coding in the commandbutton2_click()? The workbook is emailed and saved appropriately, however everytime it is re-opened it repeats the workbook_open() and clears out the data. The saved workbook still needs to have Macro's enabled, because of an approval process. </p>\n\n<pre><code>Private Sub CommandButton2_Click()\n  If IsEmpty(Sheet1.Range(\"B4\")) Then\n        MsgBox \"Please fill Highlighted cells before closing.\"\n        Cancel = True\n    End If\n    If IsEmpty(Sheet1.Range(\"C10\")) Then\n        MsgBox \"Please fill Highlighted cells before closing.\"\n        Cancel = True\n    End If\n    If IsEmpty(Sheet1.Range(\"A17\")) Then\n        MsgBox \"Please fill Highlighted cells before closing.\"\n        Cancel = True\n    End If\n\n\nDim FileName As String\n Dim Path As String\n\nApplication.DisplayAlerts = False\n\nPath = \"\\\\COSRVR1\\Data\\Purchase orders\\\"\n FileName = Sheet1.Range(\"G6\").Value &amp; \".xlsm\"\n\nThisWorkbook.SaveAs Path &amp; FileName, xlOpenXMLWorkbookMacroEnabled\n\nCommandButton2.Visible = False\n\nDim olapp As Outlook.Application\nSet olapp = CreateObject(\"outlook.application\")\n\nDim olmail As Outlook.MailItem\nSet olmail = olapp.CreateItem(olMailItem)\nolmail.To = Sheet1.Range(\"a8\")\nolmail.Subject = \"Approval needed_\" &amp; Sheet1.Range(\"g6\")\nolmail.Attachments.Add ActiveWorkbook.FullName\nolmail.send\nActiveWorkbook.Close\n\nEnd Sub\n\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If Sheet1.Range(\"i38\").Value &gt; 1999 Then\n        CommandButton2.Enabled = True\n    Else\n        CommandButton2.Enabled = False\nEnd If\n    If Sheet1.Range(\"i38\").Value = 0 Then\n        CommandButton1.Enabled = False\n    Else\n    End If\n    If Sheet1.Range(\"i38\").Value &lt; 2000 Then\n        CommandButton1.Enabled = True\n    Else\n        CommandButton1.Enabled = False\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447877494, "post_id": 33789378, "comment_id": 55345891, "body": "First to your requested answer.  Remove the <code>()</code>.  The are not needed unless you use the <code>Call</code> method or have a variable you want to <code>=</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1447877584, "post_id": 33789378, "comment_id": 55345947, "body": "Second you will get an error when you try to run it, You need to <code>dim v(0 to 2)</code>.  I would not use Values as it is close to a protect word, but that is preference."}], "answers": [{"tags": [], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "is_accepted": true, "score": 3, "last_activity_date": 1447877446, "creation_date": 1447877446, "answer_id": 33789428, "question_id": 33789378, "link": "https://stackoverflow.com/questions/33789378/passing-a-variant-array-to-sub-expected/33789428#33789428", "title": "Passing a Variant array to sub, &quot;Expected: =&quot;", "body": "<p>You need tu use </p>\n\n<p>call AddDataRow(tbloverview, v)</p>\n"}], "owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "accepted_answer_id": 33789428, "answer_count": 1, "score": 1, "last_activity_date": 1447877446, "creation_date": 1447877257, "question_id": 33789378, "link": "https://stackoverflow.com/questions/33789378/passing-a-variant-array-to-sub-expected", "title": "Passing a Variant array to sub, &quot;Expected: =&quot;", "body": "<p>I found a function to append a record to a table in Excel using VBA.  I have implemented it but I'm not familiar with the <code>Variant</code> data type.  I did some research and am attempting to use it as I would an array in VB but I keep getting a weird error that it's expecting an <code>=</code> sign.</p>\n\n<p><a href=\"https://i.stack.imgur.com/MVWKn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MVWKn.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the code in non-screenshot form:</p>\n\n<pre><code>Sub AddDataRow(tableName As String, Values() As Variant)\n    Dim sheet As Worksheet\n    Dim table As ListObject\n    Dim col As Integer\n    Dim lastRow As Range\n\n    Set sheet = ActiveWorkbook.Worksheets(\"Sheet1\")\n    Set table = sheet.ListObjects.Item(tableName)\n\n    'First check if the last row is empty; if not, add a row\n    If table.ListRows.Count &gt; 0 Then\n        Set lastRow = table.ListRows(table.ListRows.Count).Range\n        For col = 1 To lastRow.Columns.Count\n            If Trim(CStr(lastRow.Cells(1, col).Value)) &lt;&gt; \"\" Then\n                table.ListRows.Add\n                Exit For\n            End If\n        Next col\n    End If\n\n    'Iterate through the last row and populate it with the entries from values()\n    Set lastRow = table.ListRows(table.ListRows.Count).Range\n    For col = 1 To lastRow.Columns.Count\n        If col &lt;= UBound(Values) + 1 Then lastRow.Cells(1, col) = Values(col - 1)\n    Next col\nEnd Sub\n\nSub btnNewGateway_Click()\n    pName = Application.InputBox(\"Enter New Participant Name\", \"New Participant\")\n    Worksheets(\"TemplateGateway\").Copy After:=Worksheets(\"TemplateGateway\")\n    ActiveSheet.Name = pName + \" Gateway\"\n    Dim Values()\n    v(0) = pName\n    v(1) = \"Gateway\"\n    v(2) = Today()\n    AddDataRow (\"tblOverview\",????)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447876795, "post_id": 33789211, "comment_id": 55345452, "body": "Look into worksheet_change and Worksheet_Calculate events."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447879032, "post_id": 33789852, "comment_id": 55346775, "body": "In your intersect function you do not need the <code>Range(Target.Address)</code> just <code>Target</code> will suffice.  It is a range and does not need to be called with the <code>Range</code> keyword."}, {"owner": {"reputation": 838, "user_id": 862427, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/866dd9f4bd43830ca0e530a5f2df2994?s=128&d=identicon&r=PG", "display_name": "Ric Gaudet", "link": "https://stackoverflow.com/users/862427/ric-gaudet"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447879544, "post_id": 33789852, "comment_id": 55347051, "body": "True; I was actually copying MS code from its webpage to give the example.  My own code did just as you suggested."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447879815, "post_id": 33789852, "comment_id": 55347197, "body": "Typical MS, doing it in a way that is more difficult than it needs to be."}, {"owner": {"reputation": 838, "user_id": 862427, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/866dd9f4bd43830ca0e530a5f2df2994?s=128&d=identicon&r=PG", "display_name": "Ric Gaudet", "link": "https://stackoverflow.com/users/862427/ric-gaudet"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447880016, "post_id": 33789852, "comment_id": 55347317, "body": "Actually, my new code does not work so well...I will try to fix it in a bit."}, {"owner": {"reputation": 13, "user_id": 3210171, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/30d0887d341c270ab7528cad951e82c7?s=128&d=identicon&r=PG&f=1", "display_name": "user3210171", "link": "https://stackoverflow.com/users/3210171/user3210171"}, "edited": false, "score": 0, "creation_date": 1447881144, "post_id": 33789852, "comment_id": 55347982, "body": "Well, I said I was new so..... if I double click on the PP sheet (in the VBA window), there are 2 drop down lists. the first one has General and Worksheet. Which one of those do I select? Then, based on selecting General and Worksheet, the list of options in the 2nd drop down change. What do I select there?"}, {"owner": {"reputation": 13, "user_id": 3210171, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/30d0887d341c270ab7528cad951e82c7?s=128&d=identicon&r=PG&f=1", "display_name": "user3210171", "link": "https://stackoverflow.com/users/3210171/user3210171"}, "edited": false, "score": 0, "creation_date": 1447881873, "post_id": 33789852, "comment_id": 55348398, "body": "I messed around and got this working automatically and only in the one PP sheet so I&#39;m really excited and THANKS for all the help!"}, {"owner": {"reputation": 13, "user_id": 3210171, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/30d0887d341c270ab7528cad951e82c7?s=128&d=identicon&r=PG&f=1", "display_name": "user3210171", "link": "https://stackoverflow.com/users/3210171/user3210171"}, "edited": false, "score": 0, "creation_date": 1447966175, "post_id": 33789852, "comment_id": 55393696, "body": "It turns out that when the formulas are showing if I insert or delete a row, the formula&#39;s don&#39;t dynamically updates. So I need to have the ability to switch back and forth between showing formulas or showing the results. I can use the original VBA to show the formulas but how do i switch back to results so I can insert / delete rows and have my formulas update correctly?"}], "tags": [], "owner": {"reputation": 838, "user_id": 862427, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/866dd9f4bd43830ca0e530a5f2df2994?s=128&d=identicon&r=PG", "display_name": "Ric Gaudet", "link": "https://stackoverflow.com/users/862427/ric-gaudet"}, "is_accepted": true, "score": 0, "last_activity_date": 1447887850, "last_edit_date": 1447887850, "creation_date": 1447878905, "answer_id": 33789852, "question_id": 33789211, "link": "https://stackoverflow.com/questions/33789211/run-an-excel-macro-after-every-update/33789852#33789852", "title": "Run an excel macro after every update", "body": "<p>Microsoft Support has this:\n[<a href=\"https://support.microsoft.com/en-us/kb/213612][1]\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/213612][1]</a></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim KeyCells As Range\n\n' The variable KeyCells contains the cells that will\n' cause an alert when they are changed.\nSet KeyCells = Range(\"A1:C10\")\n\nIf Not Application.Intersect(KeyCells, Range(Target.Address)) _\n       Is Nothing Then\n\n    ' Display a message when one of the designated cells has been \n    ' changed.\n    ' Place your code here.\n    MsgBox \"Cell \" &amp; Target.Address &amp; \" has changed.\"\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>You may also need to place the VB code within the code section for the worksheet (as opposed to general). Alternatively, narrow the parameter  target to include only the desired sheet.</p>\n"}], "owner": {"reputation": 13, "user_id": 3210171, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/30d0887d341c270ab7528cad951e82c7?s=128&d=identicon&r=PG&f=1", "display_name": "user3210171", "link": "https://stackoverflow.com/users/3210171/user3210171"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1860, "favorite_count": 0, "accepted_answer_id": 33789852, "answer_count": 1, "score": 0, "last_activity_date": 1447887850, "creation_date": 1447876682, "last_edit_date": 1447876825, "question_id": 33789211, "link": "https://stackoverflow.com/questions/33789211/run-an-excel-macro-after-every-update", "title": "Run an excel macro after every update", "body": "<p>I have an Excel 2013 workbook with multiple sheets. On one sheet, I have a macro that show the formula in cells E7:E999. It works fine except for 2 things.</p>\n\n<ol>\n<li>I would like to have the macro automatically run every time a user enters a new formula in the range noted.</li>\n<li>I only want this macro to run for the one sheet named \"PP\" but right now if I run the macro it runs on any sheet.</li>\n</ol>\n\n<p>Here's the macro I currently have. It does what I want, it just doesn't do it automatically and it runs on any sheet. I'm new to VBA in Excel so if you could give a few more details to your answers that would be most helpful.</p>\n\n<pre><code>Sub ShowFormulas()\nDim DQ As String, mesage As String\nDim rng As Range, r As Range\n\nDQ = Chr(34)\nSet rng = Range(\"E7:E999\").Cells.SpecialCells(xlCellTypeFormulas)\n\nFor Each r In rng\n   mesage = DQ &amp; r.Formula &amp; DQ\n   r.NumberFormat = mesage &amp; \";\" &amp; mesage &amp; \";\" &amp; mesage &amp; \";\"\nNext r\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "selection", "vba"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1447876450, "post_id": 33789126, "comment_id": 55345219, "body": "Its worth mentioning that I started off with just one entry, but plan on making this 2-300 long."}], "answers": [{"comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1447877448, "post_id": 33789263, "comment_id": 55345867, "body": "Ran into the same issue i was getting on my own- It would only filter the first selection. This time it didnt even bother with the OR part of the first IF criteria"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1447878473, "post_id": 33789263, "comment_id": 55346482, "body": "see my edited code. I had a thought that may help. I see your sample data as well. Are you sure the leading zero will always be there (because it&#39;s not in your sample data). If it&#39;s not, get rid of the leading zero in the vba If statement."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1447878623, "post_id": 33789263, "comment_id": 55346559, "body": "Posted a screen shot of the result. Ill mess with it some more when I get home :)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1447878808, "post_id": 33789263, "comment_id": 55346668, "body": "It appears to be a leading &#39;0&#39; problem."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1447878968, "post_id": 33789263, "comment_id": 55346743, "body": "what is a leading &quot;0&quot; problem?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1447888381, "post_id": 33789263, "comment_id": 55351515, "body": "@ScottHoltzman You know I didnt realize that excel was taking the leading zero off. Is there a way to stop that? Or just account for it in the vba lines? Also this worked like a charm.   Dumb question time:  Why declare the data type conversion as an object? Is it b/c it needs to be referenced on a per cell basis which is why my original code was failing?  Though I did learn alot form this: Value2 is my new go to, and cstr from my googling is pretty awesome too."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1447891159, "post_id": 33789263, "comment_id": 55352496, "body": "@DougCoats - setting <code>sValue</code> isn&#39;t necessary. I added that before I saw your data set as I add a hunch it was something in the way the data was translating with the written code. You can leave it. It won&#39;t hurt, in a way it&#39;s cleaner, and easier to read. I don&#39;t know how your data gets populated, but if you format the cells as text before you data comes in it will keep any leading 0s."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1447894111, "post_id": 33789263, "comment_id": 55353519, "body": "Awesome. Thanks a a bunch Scott. Not only have you been pretty bad ass, I learned quite a bit. One day Maybe i&#39;ll graduate above &quot;script kiddie&quot; level XD"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1447878910, "last_edit_date": 1447878910, "creation_date": 1447876845, "answer_id": 33789263, "question_id": 33789126, "link": "https://stackoverflow.com/questions/33789126/vba-macro-checking-range-for-multiple-criteria/33789263#33789263", "title": "VBA Macro Checking range for multiple Criteria", "body": "<p>The short answer is this. The correct syntax is to refer to the object <em>each time</em> in multiple condition <code>If</code> statements.</p>\n\n<pre><code> Dim cell As Range, sVal as String\n\n For Each cell In Selection\n\n    sVal = Cstr(cell.Value2)\n\n    If sVal = \"DZC\" Or sVal = \"654548\" Then 'sVal = \"0654548\" Then\n        cell.Value = \"Douglas C\"\n    ElseIf sVal = \"RLP\" Or sVal = \"623344\" Then 'sVal = \"0623344\" Then\n        cell.Value = \"Ryan P\"\n    End If\n\n Next\n</code></pre>\n\n<p>If you are going to have many lookup values it may serve you better to make a list in your workbook and replace the cell values with the associated value in the lookup list. You can also use <code>Select Case</code>, but that can even be ugly with ~ 300 options.</p>\n\n<p>Assuming your build your list in <code>mySheet</code> in Range A1:B300, the code for that would be:</p>\n\n<pre><code>Dim cell As Range\n\n For Each cell In Selection\n\n    If Not IsErr(Application.WorksheetFunction.VLookup(cell.Value2, Sheets(\"mySheets\").Range(\"A1:B300\"), 2, 0)) Then\n\n        cell.Value = Application.WorksheetFunction.VLookup(cell.Value2, Sheets(\"mySheets\").Range(\"A1:B300\"), 2, 0)\n\n    End If\n\n Next\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1447877404, "post_id": 33789309, "comment_id": 55345838, "body": "tried this and it didnt work. However Ill go back to it in a bit. User error is a thing :)"}], "tags": [], "owner": {"reputation": 361, "user_id": 4406125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d283087551dc05b73a84f9efdd24e43b?s=128&d=identicon&r=PG&f=1", "display_name": "area9", "link": "https://stackoverflow.com/users/4406125/area9"}, "is_accepted": false, "score": 2, "last_activity_date": 1447877018, "creation_date": 1447877018, "answer_id": 33789309, "question_id": 33789126, "link": "https://stackoverflow.com/questions/33789126/vba-macro-checking-range-for-multiple-criteria/33789309#33789309", "title": "VBA Macro Checking range for multiple Criteria", "body": "<p>Use 'Select Case' for a long list:</p>\n\n<pre><code>For Each cell In Selection\n    Select Case cell.Value\n        Case \"DZC\", \"0654548\"\n             cell.Value = \"Douglas C\"\n        Case \"RLP\", \"0623344\"\n             cell.Value = \"Ryan P\"\n        ...\n        Case Else\n             ...\n     End Select\nNext cell\n</code></pre>\n"}], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1890, "favorite_count": 0, "accepted_answer_id": 33789263, "answer_count": 2, "score": 0, "last_activity_date": 1449597000, "creation_date": 1447876388, "last_edit_date": 1531164843, "question_id": 33789126, "link": "https://stackoverflow.com/questions/33789126/vba-macro-checking-range-for-multiple-criteria", "title": "VBA Macro Checking range for multiple Criteria", "body": "<p>I wrote a macro to check a selection for a value, and if it fits that value, to replace it with something else. Ok this is pretty easy when it is just one value. When I try adding multiple values, I keep running into different errors. hopefully one of you can point out where I'm missing the point :)</p>\n\n<pre><code> Sub PTranslate()\n Dim cell As Range\n On Error Resume Next\n For Each cell In Selection\n If cell = \"DZC\" Or \"0654548\" Then\n cell.Value = \"Douglas C\"\n      ElseIf cell = \"RLP\" Or \"0623344\" Then\n cell.Value = \"Ryan P\"\n End If\n Next\n\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "listbox"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447881564, "post_id": 33789003, "comment_id": 55348218, "body": "Typically for this you&#39;d create a class to handle the events associated with the listboxes.  See answers here for example:  <a href=\"https://groups.google.com/forum/?hl=en#!topic/microsoft.public.excel.programming/k9d8Uu4jnvk\" rel=\"nofollow noreferrer\">groups.google.com/forum/?hl=en#!topic/&hellip;</a>"}, {"owner": {"reputation": 83, "user_id": 2025478, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1a6a7fb9fa3189a9d5aa4c2cfcca3d08?s=128&d=identicon&r=PG", "display_name": "BBDev", "link": "https://stackoverflow.com/users/2025478/bbdev"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447889259, "post_id": 33789003, "comment_id": 55351822, "body": "Thanks Tim. You pointed me I the right direction and found this <a href=\"http://stackoverflow.com/questions/3014421/how-to-add-events-to-controls-created-at-runtime-in-excel-with-vba\" title=\"how to add events to controls created at runtime in excel with vba\">stackoverflow.com/questions/3014421/&hellip;</a> which is easier to understand"}], "owner": {"reputation": 83, "user_id": 2025478, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1a6a7fb9fa3189a9d5aa4c2cfcca3d08?s=128&d=identicon&r=PG", "display_name": "BBDev", "link": "https://stackoverflow.com/users/2025478/bbdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1447875974, "creation_date": 1447875974, "question_id": 33789003, "link": "https://stackoverflow.com/questions/33789003/how-can-i-call-functions-on-proceduraly-generated-controls", "title": "How can I call functions on proceduraly generated Controls?", "body": "<p>I've added 3 column Listboxes to a range of cells that are procedurally created when a button is clicked. The Listboxes are 3 columns and hold a lot of data so I was using GotFocus() and LostFocus() to expand and collapse them so all items are visible, but this was for Listboxes I manually created. How can I get the generated Listboxes to have this behavior?</p>\n\n<pre><code>Public Sub CreateListbox()\n Dim rCell As Range\n    Dim rRng As Range\n    Set rRng = ActiveSheet.Range(\"AA3:AA45\")\n    For Each rCell In rRng.Cells\n        Set oLISTBOX = ActiveSheet.OLEObjects.Add(classtype:=\"Forms.ListBox.1\")\nWith oLISTBOX\n        .Object.IntegralHeight = False\n        .Object.Font.Size = 11\n        .Top = rCell.Top\n        .Left = rCell.Left\n        .Width = rCell.Width\n        .Height = rCell.Height\n        .LinkedCell = rCell.Address\n        .ListFillRange = \"ValSocDeterm.\"\n        .Object.ColumnCount = 3\n        .MultiSelect = 1\n    End With\n\n    Next rCell\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447877437, "post_id": 33788941, "comment_id": 55345856, "body": "If you write the formula into several (or several thousand) rows at once then the <code>$F2</code> will automatically adjust the same way it would on a worksheet when you Fill Down. Alternately, change the formula to xlR1C1 style and it will be the same for all rows if you have to write them individually."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "edited": false, "score": 0, "creation_date": 1447945754, "post_id": 33789018, "comment_id": 55380322, "body": "I changed the formula so that &quot;$F4&quot; will not always reference that cell, but always references the cell to the immediate left. I thought what I did below would work, but it doesn&#39;t. It looks similar to another relative reference formula I wrote, but this one sees RC1 as literally RC1. Here is the formula, please advise what I did wrong. Thanks.    ActiveCell.FormulaR1C1 = &quot;=IFERROR(VLOOKUP(RC1,&#39;&quot; &amp; var_SN &amp; &quot;&#39;!$B:$BD,&#39;&quot; &amp; var_SN &amp; &quot;&#39;!AS$50,0),&quot;&quot;&quot;&quot;)&quot;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "edited": false, "score": 0, "creation_date": 1447950767, "post_id": 33789018, "comment_id": 55384112, "body": "@lindqmx1 If you are going to use r1c1 then all references must be in that format. in you case I would use <code>$F&quot; &amp; somevariableforrow &amp; &quot;</code> where obviously somevariableforrow is just that a variable that denotes the row on which the formulas is being placed."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "edited": false, "score": 0, "creation_date": 1447951953, "post_id": 33789018, "comment_id": 55384971, "body": "@lindqmx1 or use the filldown method.  That will automatically change the references."}, {"owner": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "edited": false, "score": 0, "creation_date": 1447953931, "post_id": 33789018, "comment_id": 55386352, "body": "OK thanks. This is how I got it to work using your advice.    <code>var_SRN = ActiveCell.Row</code>   <code>wsFormula = &quot;=IFERROR(VLOOKUP($F&quot; &amp; var_SRN &amp; &quot;,&#39;&quot; &amp; var_SN &amp; &quot;&#39;!$B:$BD,&#39;&quot; &amp; var_SN &amp; &quot;&#39;!AS$50,0),&quot;&quot;&quot;&quot;)&quot;</code>        <code>ActiveCell.Formula = wsFormula</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "edited": false, "score": 0, "creation_date": 1447954006, "post_id": 33789018, "comment_id": 55386397, "body": "@lindqmx1 Glad I could help. please consider marking as correct."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1447876372, "last_edit_date": 1447876372, "creation_date": 1447876024, "answer_id": 33789018, "question_id": 33788941, "link": "https://stackoverflow.com/questions/33788941/run-time-error-1004-with-vlookup/33789018#33789018", "title": "Run-time Error 1004 with Vlookup", "body": "<p>You have too many \"</p>\n\n<p>Every where you have <code>17402</code> change to <code>\" &amp; var_SN &amp; \"</code>.</p>\n\n<p>And the <code>\"\"</code> Needs to be <code>\"\"\"\"</code></p>\n\n<pre><code>\"=IF(ISERROR(VLOOKUP($F4,'\" &amp; var_SN &amp; \"'!$B:$BD,'\" &amp; var_SN &amp; \"'!AS$50,0))=TRUE,\"\"\"\",(VLOOKUP($F4,'\" &amp; var_SN &amp; \"'!$B:$BD,'\" &amp; var_SN &amp; \"'!AS$50,0)))\"\n</code></pre>\n\n<p>But you also do not need the <code>IF</code> and <code>ISERROR</code>.  You can use the <code>IFERROR</code>:</p>\n\n<pre><code>\"=IFERROR(VLOOKUP($F4,'\" &amp; var_SN &amp; \"'!$B:$BD,'\" &amp; var_SN &amp; \"'!AS$50,0),\"\"\"\")\"\n</code></pre>\n\n<p>The <code>IFERROR</code> will do the first argument unless there is an error then it does the second argument.</p>\n"}], "owner": {"reputation": 79, "user_id": 5548048, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1aa9cb3e37de2bae9a8690371d834083?s=128&d=identicon&r=PG&f=1", "display_name": "lindqmx1", "link": "https://stackoverflow.com/users/5548048/lindqmx1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 33789018, "answer_count": 1, "score": 2, "last_activity_date": 1447876372, "creation_date": 1447875762, "question_id": 33788941, "link": "https://stackoverflow.com/questions/33788941/run-time-error-1004-with-vlookup", "title": "Run-time Error 1004 with Vlookup", "body": "<p>I want to create the below formula in Excel using VBA:</p>\n\n<pre><code>=IF(ISERROR(VLOOKUP($F4,'17402'!$B:$BD,'17402'!AS$50,0))=TRUE,\"\",(VLOOKUP($F4,'17402'!$B:$BD,'17402'!AS$50,0)))\n</code></pre>\n\n<p>This is my code:</p>\n\n<pre><code>Dim wsFormula          As String\nwsFormula = \"=IF(ISERROR(VLOOKUP($F4,\" &amp; \"\" '\"\" var_SN &amp; \"\"'!\"\" &amp; \"$B:$BD,\" &amp; \"\"'\"\" &amp; var_SN &amp; \"\"'!\"\" &amp; \"AS$50,0))=TRUE,0,(VLOOKUP($F4,\" &amp; \"\"'\"\" var_SN &amp; \"\"'!\"\" &amp; \"$B:$BD,\" &amp; \"\"'\"\" var_SN &amp; \"\"'!\"\" &amp; \"AS$50,0)))\"\nActiveCell.Formula = wsFormula\n</code></pre>\n\n<p>Where \u201cvar_SN\u201d is \u201c17402\u201d. I receive a Run-time error 1004, Application-defined or Object Define error error, so I wonder if the variable is the problem. I read about double stacking the quotes around ' and ! but that doesn't help.</p>\n\n<p>I also wonder if the lookup value $F2 will become a problem for me as the row reference changes each time I run the macro. For instance, if I am in row 4, I do not want this code writing a formula that would reference cell F1 as the lookup value. Thanks much.</p>\n"}, {"tags": ["excel", "vba", "copy-paste"], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447878264, "post_id": 33788609, "comment_id": 55346368, "body": "@user2130444 Did this help?"}, {"owner": {"reputation": 3, "user_id": 2130444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a56426aa40490d8563229bc62f8bd51?s=128&d=identicon&r=PG", "display_name": "user2130444", "link": "https://stackoverflow.com/users/2130444/user2130444"}, "edited": false, "score": 0, "creation_date": 1447976101, "post_id": 33788609, "comment_id": 55398469, "body": "Thank you Scott for the very timely reply.  The solution provided worked with one small addition: I had to use newsht.Name = newName &amp; &quot; &quot; &amp; j."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 2130444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a56426aa40490d8563229bc62f8bd51?s=128&d=identicon&r=PG", "display_name": "user2130444", "link": "https://stackoverflow.com/users/2130444/user2130444"}, "edited": false, "score": 0, "creation_date": 1447976210, "post_id": 33788609, "comment_id": 55398517, "body": "@user2130444 opps, you are correct.  I will change.  Please consider marking as correct.  big green check mark by the down arrow."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1447976221, "last_edit_date": 1447976221, "creation_date": 1447874675, "answer_id": 33788609, "question_id": 33788495, "link": "https://stackoverflow.com/questions/33788495/auto-rename-multiple-sheets-and-copy-content-of-main-to-all-newly-created-sheets/33788609#33788609", "title": "Auto rename multiple sheets and copy content of main to all newly created sheets", "body": "<p>The easiest way is to  set the new sheet as variable when added.  Then you can refer to it.</p>\n\n<pre><code>Sub AddSheets()\n    Dim j As Integer\n    Dim prevSheet As String\n    Dim newsht As Worksheet\n    'Dim summarySheet As Workbook\n\n    newName = Application.InputBox(\"Name\", \"Rename Sheet\", \"\", Type:=2)\n    numSheets = Application.InputBox(\"Range\", \"Number of Sheets\", \"\", Type:=1)\n\n    prevSheet = \"Main\"\n    'Set summarySheet = Sheets(\"Main\").UsedRange.Copy\n\n\n    For j = 1 To numSheets\n        Set newsht = Sheets.Add(After:=Sheets(CStr(prevSheet)))\n        newsht.Name = newName &amp; \" \" &amp; j\n        Sheets(\"Main\").UsedRange.Copy newsht.Range(\"A1\")\n        prevSheet = newsht.Name\n\n    Next j\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 2130444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a56426aa40490d8563229bc62f8bd51?s=128&d=identicon&r=PG", "display_name": "user2130444", "link": "https://stackoverflow.com/users/2130444/user2130444"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 33788609, "answer_count": 1, "score": 0, "last_activity_date": 1447976221, "creation_date": 1447874298, "last_edit_date": 1447875560, "question_id": 33788495, "link": "https://stackoverflow.com/questions/33788495/auto-rename-multiple-sheets-and-copy-content-of-main-to-all-newly-created-sheets", "title": "Auto rename multiple sheets and copy content of main to all newly created sheets", "body": "<p>I have a master sheet that contains formatted columns (B2:Y14 and A18:B24) and am trying to create as many sheets as there are in the forthcoming month and then copy the master sheet data into each of the newly created sheets.</p>\n\n<p>For example: for the month of December I would need to create 31 sheets named DEC1...DEC31 that contain the data from the master sheet.</p>\n\n<p>What I have tried is the following:</p>\n\n<pre><code>Sub AddSheets()\n    Dim j As Integer\n    Dim curSheet As String\n    Dim prevSheet As String\n\n    'Dim summarySheet As Workbook\n\n    newName = Application.InputBox(\"Name\", \"Rename Sheet\", \"\", Type:=2)\n    numSheets = Application.InputBox(\"Range\", \"Number of Sheets\", \"\", Type:=1)\n\n    prevSheet = \"Main\"\n    'Set summarySheet = Sheets(\"Main\").UsedRange.Copy\n\n\n    For j = 1 To numSheets\n        Sheets.Add After:=Sheets(CStr(prevSheet))\n        curSheet = newName &amp; \" \" &amp; j\n        Sheets(CStr(curSheet)).Name = curSheet\n        Sheets(\"Main\").UsedRange.Copy\n        Sheets(CStr(curSheet)).Select\n        Sheets(CStr(curSheet)).Paste\n        prevSheet = curSheet\n        'ActiveSheet.Paste\n    Next j\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447873780, "post_id": 33788317, "comment_id": 55343568, "body": "<code>to run whenever the excel sheets open</code> but you do have it set to run when it opens via <code>Workbook_Open()</code>?"}, {"owner": {"reputation": 69, "user_id": 5490317, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/580d2780b0ecd1767968d3b1be0a5932?s=128&d=identicon&r=PG&f=1", "display_name": "Silent Observer", "link": "https://stackoverflow.com/users/5490317/silent-observer"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447873895, "post_id": 33788317, "comment_id": 55343630, "body": "@findwindow Yeah I already set to run when the excel opens. But if the excel doesn&#39;t open on 1st, the contents wont get reset right? I want to check the month on the previous run of the excel and if it has changed, I want to reset it. that is what I am trying to do."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 2, "creation_date": 1447873958, "post_id": 33788317, "comment_id": 55343672, "body": "You&#39;re going to need to store the value of &quot;today&quot; on workbook_close <i>somewhere</i> and compare it on workbook_open"}, {"owner": {"reputation": 69, "user_id": 5490317, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/580d2780b0ecd1767968d3b1be0a5932?s=128&d=identicon&r=PG&f=1", "display_name": "Silent Observer", "link": "https://stackoverflow.com/users/5490317/silent-observer"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1447874070, "post_id": 33788317, "comment_id": 55343745, "body": "@Raystafarian I tried that. But since it is today value, it also changes in the next run. I was not able to paste the values of today in one cell. That is where I need some help."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447874109, "post_id": 33788317, "comment_id": 55343764, "body": "I am confused. If it&#39;s not getting opened, why does it need to update?"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1447874118, "post_id": 33788317, "comment_id": 55343772, "body": "That&#39;s why you need to store the value somewhere not at the function."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1447874208, "post_id": 33788317, "comment_id": 55343837, "body": "@Raystafarian I didn&#39;t mean to steal your answer. I was working it up and posted it just to see that you and I were going in the same direction."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447874237, "post_id": 33788317, "comment_id": 55343855, "body": "@ScottCraner no worries!"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447874310, "post_id": 33788317, "comment_id": 55343892, "body": "Same to both of you - ScottCraner &amp; Raystafarian... Once I caught on more clearly after the OP&#39;s comment on my original answer, I edited my answer to fix the dilemma."}, {"owner": {"reputation": 69, "user_id": 5490317, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/580d2780b0ecd1767968d3b1be0a5932?s=128&d=identicon&r=PG&f=1", "display_name": "Silent Observer", "link": "https://stackoverflow.com/users/5490317/silent-observer"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1447876757, "post_id": 33788317, "comment_id": 55345425, "body": "@Raystafarian Thanks a lot !!"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 5490317, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/580d2780b0ecd1767968d3b1be0a5932?s=128&d=identicon&r=PG&f=1", "display_name": "Silent Observer", "link": "https://stackoverflow.com/users/5490317/silent-observer"}, "edited": false, "score": 0, "creation_date": 1447874000, "post_id": 33788370, "comment_id": 55343697, "body": "@Scott Holtzmann Thanks for the reply. But if the sheet is not opened on 1st date, it doesn&#39;t reset right? that is my problem."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 3, "last_activity_date": 1447874188, "last_edit_date": 1447874188, "creation_date": 1447873865, "answer_id": 33788370, "question_id": 33788317, "link": "https://stackoverflow.com/questions/33788317/check-if-the-month-changes-and-reset-the-cells-if-the-month-has-changed/33788370#33788370", "title": "Check if the month changes and reset the cells if the month has changed", "body": "<p>Store the date each time the workbook closes and compare against the date on opening.</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nWith ThisWorkbook.Sheets(\"Output\")\n      If Month(.Range(\"A4\")) &lt;&gt; Month (.Cells(.Rows.Count,.Columns.Count))Then .Range(\"B4:T4\").ClearContents\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Put this in the workbook close event.</p>\n\n<pre><code>Private Sub Workbook_Close()\n\nWith ThisWorkbook.Sheets(\"Output\")\n     .Cells(.Rows.Count,.Columns.Count).Value = .Range(\"A4\")\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447874524, "post_id": 33788431, "comment_id": 55344030, "body": "nice. cleaner than my solution :) The only caveat is that it will clear the cells the <i>very first</i> it&#39;s used unless the current month value is stored in <code>Z4</code> before the next workbook open."}, {"owner": {"reputation": 69, "user_id": 5490317, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/580d2780b0ecd1767968d3b1be0a5932?s=128&d=identicon&r=PG&f=1", "display_name": "Silent Observer", "link": "https://stackoverflow.com/users/5490317/silent-observer"}, "edited": false, "score": 0, "creation_date": 1447876783, "post_id": 33788431, "comment_id": 55345445, "body": "@ScottCraner Thanks a lot!!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 69, "user_id": 5490317, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/580d2780b0ecd1767968d3b1be0a5932?s=128&d=identicon&r=PG&f=1", "display_name": "Silent Observer", "link": "https://stackoverflow.com/users/5490317/silent-observer"}, "edited": false, "score": 0, "creation_date": 1447876857, "post_id": 33788431, "comment_id": 55345491, "body": "@SilentObserver Glad to help."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1447874797, "last_edit_date": 1447874797, "creation_date": 1447874079, "answer_id": 33788431, "question_id": 33788317, "link": "https://stackoverflow.com/questions/33788317/check-if-the-month-changes-and-reset-the-cells-if-the-month-has-changed/33788431#33788431", "title": "Check if the month changes and reset the cells if the month has changed", "body": "<p>As the Raystafarian stated you will need to store the present month in a cell.  I have it in Z4, you can change it.</p>\n\n<p>Try this:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    if Sheets(\"Output\").Range(\"Z4\").value &gt; 0 then\n        If Month(Sheets(\"Output\").Range(\"A4\")) &lt;&gt; Sheets(\"Output\").Range(\"Z4\") Then\n            Range(\"B4:T4\").ClearContents\n            Sheets(\"Output\").Range(\"Z4\") = Month(Sheets(\"Output\").Range(\"A4\"))\n        End If\n    End IF\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 5490317, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/580d2780b0ecd1767968d3b1be0a5932?s=128&d=identicon&r=PG&f=1", "display_name": "Silent Observer", "link": "https://stackoverflow.com/users/5490317/silent-observer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1409, "favorite_count": 0, "accepted_answer_id": 33788431, "answer_count": 2, "score": 1, "last_activity_date": 1447874797, "creation_date": 1447873675, "question_id": 33788317, "link": "https://stackoverflow.com/questions/33788317/check-if-the-month-changes-and-reset-the-cells-if-the-month-has-changed", "title": "Check if the month changes and reset the cells if the month has changed", "body": "<p>I am having the current date (TODAY()) in A4 cell. The format is Nov-15 and Values from B4:T4. I want to reset the values to 0 when the month changes from Nov to Dec. The following is my try,</p>\n\n<pre><code>Private Sub Workbook_Open()\n    If Sheets(\"Output\").Range(\"A4\").Value Like \"01*\" Then Range(\"B4:T4\").ClearContents\nEnd Sub\n</code></pre>\n\n<p>But my problem is, The sheet wont be opened every day. Suppose if the excel sheet is not opened on 1st, the values wont get reset. Can we modify this macro to run whenever the excel sheets open and check for the month on the previous run and if it has changed, we can reset the contents of the cell.</p>\n\n<p>Can anybody help me in doing this? </p>\n"}, {"tags": ["ms-access", "search", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5394516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ac068b8a658aabef53fe6c65fb4e4b6?s=128&d=identicon&r=PG&f=1", "display_name": "Mouse", "link": "https://stackoverflow.com/users/5394516/mouse"}, "edited": false, "score": 0, "creation_date": 1447943951, "post_id": 33789772, "comment_id": 55379002, "body": "yep, that worked. I knew it was something simple and I was overlooking it. I just couldn&#39;t figure out what. Thank you."}], "tags": [], "owner": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "is_accepted": true, "score": 1, "last_activity_date": 1447878584, "creation_date": 1447878584, "answer_id": 33789772, "question_id": 33788052, "link": "https://stackoverflow.com/questions/33788052/performing-a-query-search-to-match-characters-instead-of-exact-words/33789772#33789772", "title": "Performing a query search to match characters instead of exact words.", "body": "<p>You need to set your query to use the LIKE operator and then enclose your search terms in *'s. So if you wanted to find the word cable anywhere in the field you would put;</p>\n\n<pre><code>WHERE Fieldname LIKE '*cable*'\n</code></pre>\n\n<p>in your query's SQL statement.</p>\n"}], "owner": {"reputation": 21, "user_id": 5394516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ac068b8a658aabef53fe6c65fb4e4b6?s=128&d=identicon&r=PG&f=1", "display_name": "Mouse", "link": "https://stackoverflow.com/users/5394516/mouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 33789772, "answer_count": 1, "score": 0, "last_activity_date": 1447878584, "creation_date": 1447872772, "question_id": 33788052, "link": "https://stackoverflow.com/questions/33788052/performing-a-query-search-to-match-characters-instead-of-exact-words", "title": "Performing a query search to match characters instead of exact words.", "body": "<p>I have a form that contains a command button, six unbound text boxes, and a query subform. The user enters data in the unbound text boxes to search for. When they press the search command button the query will search for the data entered into the text boxes. I have no problem with this working with my current code. However, if the user does not enter the information exactly as it is in the main table then a message box saying \u201cNo records found\u201d is displayed. I know this may be a very simple fix but I would like for when the user enters data (example: cable) the query should display all records that contain the word or characters (example: rj-45 cable). </p>\n\n<pre><code> If DCount(\"*\", \"Admin Customer Owned Parts Query\") = 0 Then\n    MsgBox \"No Records Found\"\n    Else\n        Me.Admin_Customer_Owned_Parts_Query_Subform.Requery\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447873210, "post_id": 33787963, "comment_id": 55343242, "body": "A image of your data and desired output would be great.  Just load something into imugr and post the link in your original post.  As your question stands it is very difficult to understand."}], "answers": [{"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 2, "creation_date": 1447872971, "post_id": 33788080, "comment_id": 55343080, "body": "why the assumption that the number is just one digit?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1447873046, "post_id": 33788080, "comment_id": 55343146, "body": "@pnuts The way OP phrased it, <code>#</code> is last char?"}, {"owner": {"reputation": 1, "user_id": 5578020, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f4py4bsFkAg/AAAAAAAAAAI/AAAAAAAAAAw/ONXVPIZw5YA/photo.jpg?sz=128", "display_name": "Angry Octopus", "link": "https://stackoverflow.com/users/5578020/angry-octopus"}, "edited": false, "score": 0, "creation_date": 1447873410, "post_id": 33788080, "comment_id": 55343354, "body": "I have a consolidated worksheet that combines many sheets into one. In this particular step, the engineers write &quot;Qty. typical for 3&quot; if the exact same quantity of parts are used for three separate units. In order to get a correct count, I need to program a way to take the phrase and multiply the amount mentioned to the quantities listed."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447873588, "post_id": 33788080, "comment_id": 55343464, "body": "Is it always one digit? If not, easier with<code>instr</code> in VBA."}, {"owner": {"reputation": 1, "user_id": 5578020, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f4py4bsFkAg/AAAAAAAAAAI/AAAAAAAAAAw/ONXVPIZw5YA/photo.jpg?sz=128", "display_name": "Angry Octopus", "link": "https://stackoverflow.com/users/5578020/angry-octopus"}, "edited": false, "score": 0, "creation_date": 1447873760, "post_id": 33788080, "comment_id": 55343555, "body": "It can be between 2 and 200."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447876823, "post_id": 33788080, "comment_id": 55345474, "body": "Well, when OP says <code>engineers write &quot;Qty. typical for 3&quot;</code>, isn&#39;t it somewhat of a fantasy to add <code>Kubota fork</code> inside the quotes? I know it&#39;s just your years of coding speaking ^_^ Perhaps you&#39;re one of those that press 5 on an elevator when you mean 6 ^_^;"}], "tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": false, "score": 0, "last_activity_date": 1447874287, "last_edit_date": 1447874287, "creation_date": 1447872852, "answer_id": 33788080, "question_id": 33787963, "link": "https://stackoverflow.com/questions/33787963/search-for-string-and-multiply/33788080#33788080", "title": "Search for string and multiply", "body": "<p>Edited per pnuts' and Eem's suggestion and after OP's clarification.</p>\n\n<p>In column C just do <code>=RIGHT(A1,LEN(A1)-FIND(\"for\",A1,1)-3)*B1</code> and drag formula down. Works for any number of digits.</p>\n\n<p><a href=\"https://i.stack.imgur.com/xgP0h.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xgP0h.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If you need VBA, just drop the formula via a loop?</p>\n"}], "owner": {"reputation": 1, "user_id": 5578020, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f4py4bsFkAg/AAAAAAAAAAI/AAAAAAAAAAw/ONXVPIZw5YA/photo.jpg?sz=128", "display_name": "Angry Octopus", "link": "https://stackoverflow.com/users/5578020/angry-octopus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1447880663, "creation_date": 1447872446, "last_edit_date": 1447880663, "question_id": 33787963, "link": "https://stackoverflow.com/questions/33787963/search-for-string-and-multiply", "title": "Search for string and multiply", "body": "<p>I have a consolidated worksheet with all of my part quantities listed. In column B are my quantity values. I need to be able to search for this phrase: <code>Qty. typical for #</code> in column A and then multiply all quantity values in column B until B is blank.</p>\n\n<p>I can search and find the phrase, but I'm at a standstill as to how to manipulate the data in VBA to do precisely what I want:</p>\n\n<p>Search for \"Qty. typical for #\"</p>\n\n<p>Take #(A) and multiply by Qty.(B)</p>\n\n<p>Do Until IsEmpty</p>\n\n<p>Edit:</p>\n\n<p><a href=\"http://i.stack.imgur.com/j0RIU.png\" rel=\"nofollow\">Data Pull</a></p>\n\n<p>Sorry, I wrote in a hurry.</p>\n\n<p>I want to replace the values with the updated quantity. The consolidated file can have up to 5000 lines, which is why I am looking for something in vba. This is just a small part of a bunch of macros I put together for the engineers.</p>\n\n<p>Obviously, I am not good at coding. I'm trying to learn, but my job comes first. This is just something I've been messing with on my free time, but it is very much script kiddie amateur hour on my part.</p>\n\n<p>Thanks for the help so far, but the formula isn't exactly working for me either.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447873012, "post_id": 33787894, "comment_id": 55343117, "body": "what would cause you to press the spacebar? what is the trigger? Or is that you just want to stop the code execution and be able to determine which line it stopped on (hence the different color)?"}, {"owner": {"reputation": 361, "user_id": 4406125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d283087551dc05b73a84f9efdd24e43b?s=128&d=identicon&r=PG&f=1", "display_name": "area9", "link": "https://stackoverflow.com/users/4406125/area9"}, "edited": false, "score": 0, "creation_date": 1447873581, "post_id": 33787894, "comment_id": 55343457, "body": "you&#39;ll need a separate instance of excel to run a separate monitoring macro or event. The other way is to stop in the middle of the code to check for something and then continue running."}, {"owner": {"reputation": 163, "user_id": 4611636, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/CApZY.png?s=128&g=1", "display_name": "Iluvpresident", "link": "https://stackoverflow.com/users/4611636/iluvpresident"}, "reply_to_user": {"reputation": 361, "user_id": 4406125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d283087551dc05b73a84f9efdd24e43b?s=128&d=identicon&r=PG&f=1", "display_name": "area9", "link": "https://stackoverflow.com/users/4406125/area9"}, "edited": false, "score": 0, "creation_date": 1447874663, "post_id": 33787894, "comment_id": 55344116, "body": "@area9 I chose to stop in the middle of the code, my code just isn&#39;t correct &quot;If <b>Spacebar_pressed</b> Then&quot;"}, {"owner": {"reputation": 361, "user_id": 4406125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d283087551dc05b73a84f9efdd24e43b?s=128&d=identicon&r=PG&f=1", "display_name": "area9", "link": "https://stackoverflow.com/users/4406125/area9"}, "edited": false, "score": 0, "creation_date": 1447875176, "post_id": 33787894, "comment_id": 55344431, "body": "ok, have a look here: <a href=\"http://stackoverflow.com/questions/5495613/check-if-a-certain-key-is-being-pressed\" title=\"check if a certain key is being pressed\">stackoverflow.com/questions/5495613/&hellip;</a> and here: <a href=\"http://www.cpearson.com/excel/keytest.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/keytest.aspx</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447880611, "post_id": 33787894, "comment_id": 55347659, "body": "Does your macro not run very fast?  If it&#39;s a fast macro, how are you going to press the space bar in time?  What determines if you want to press the space bar? I ask because there may be a better trigger to look out for, or perhaps we can use a message box and ask the user if they want the macro to do the equivalent if the space bar was pressed."}, {"owner": {"reputation": 163, "user_id": 4611636, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/CApZY.png?s=128&g=1", "display_name": "Iluvpresident", "link": "https://stackoverflow.com/users/4611636/iluvpresident"}, "edited": false, "score": 0, "creation_date": 1447880910, "post_id": 33787894, "comment_id": 55347841, "body": "Well as you can see i&#39;m using a function sleep which slows down the macro to whichever speed u like. I&#39;m basically trying to make this minigame, there&#39;s a black cell that keeps circling under the colored cells on the right. When you press spacebar it stops circling, the point is to press the spacebar at the right moment so your black cell is under the green cell. <a href=\"https://gyazo.com/4776cb56efa38218fa96655199f8f376\" rel=\"nofollow noreferrer\">gyazo.com/4776cb56efa38218fa96655199f8f376</a>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1447890825, "post_id": 33787894, "comment_id": 55352386, "body": "It&#39;s not a &quot;quick tweak&quot; - you&#39;re going to have to play with that sleep function, the <code>DoEvents</code> command and the <code>WM_Keydown</code> Win API or similar"}], "owner": {"reputation": 163, "user_id": 4611636, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/CApZY.png?s=128&g=1", "display_name": "Iluvpresident", "link": "https://stackoverflow.com/users/4611636/iluvpresident"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1447890674, "creation_date": 1447872237, "last_edit_date": 1447890674, "question_id": 33787894, "link": "https://stackoverflow.com/questions/33787894/execute-code-during-loop-after-keypress", "title": "Execute code during loop after keypress", "body": "<p>I'd like to execute some code whenever I for example press space bar at any time during that loop. Just not sure how to do it.</p>\n\n<pre><code>Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\nSub Startvogelpiek()\nDim rngCursor As Range\nDim rgbWit As Long\nDim rgbZwart As Long\nDim lngSnelheid As Long\n\nSet rngCursor = Range(\"AL5:AX5\")\nrgbWit = RGB(255, 255, 255)\nrgbZwart = RGB(0, 0, 0)\nlngSnelheid = Range(\"AZ8\").Value\n\nFor aantalkeer = 1 To 20\nFor teller = 1 To 13\n    If rngCursor.Cells(teller - 1).Interior.Color = rgbZwart Then\n        rngCursor.Cells(teller - 1).Interior.Color = rgbWit\n    End If\n    rngCursor.Cells(teller).Interior.Color = rgbZwart\n\n'If **Spacebar_pressed** Then\n\nrngCursor.Cells(teller).Interior.Color = RGB(125,125,125)\n\nExit Sub\n\nEnd If\n\n        Sleep lngSnelheid\n        If rngCursor.Cells(13).Interior.Color = rgbZwart Then\n            rngCursor.Cells(13).Interior.Color = rgbWit\n        End If\n    Next\n    If aantalkeer = 20 Then\n        MsgBox (\"Uw tijd is afgelopen.\")\n        Exit For\n    End If\n    Next\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447876398, "post_id": 33787842, "comment_id": 55345192, "body": "I think I just sort of addressed this in your previous question..."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 47, "user_id": 4686429, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8912e3a335138f9636e1af30e30f94c8?s=128&d=identicon&r=PG&f=1", "display_name": "Techie2015", "link": "https://stackoverflow.com/users/4686429/techie2015"}, "edited": false, "score": 0, "creation_date": 1447872835, "post_id": 33787908, "comment_id": 55342988, "body": "@PublicTechie2015 Feel free to accept either answer as correct."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1447872276, "creation_date": 1447872276, "answer_id": 33787908, "question_id": 33787842, "link": "https://stackoverflow.com/questions/33787842/function-that-returns-a-string-representing-a-worksheet-row/33787908#33787908", "title": "Function that returns a string representing a worksheet row", "body": "<p>This should return what you want:</p>\n\n<pre><code>Function CreateRowRange(CellAddress) As String\n    CreateRowRange = Range(Range(CellAddress),Range(\"M\" &amp; Range(CellAddress).Row)).Address(False,False)\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447872797, "post_id": 33787989, "comment_id": 55342963, "body": "This is nice, I got caught by the OPs use of range and forgot that the input and output are both strings."}], "tags": [], "owner": {"reputation": 361, "user_id": 4406125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d283087551dc05b73a84f9efdd24e43b?s=128&d=identicon&r=PG&f=1", "display_name": "area9", "link": "https://stackoverflow.com/users/4406125/area9"}, "is_accepted": false, "score": 2, "last_activity_date": 1447873225, "last_edit_date": 1447873225, "creation_date": 1447872573, "answer_id": 33787989, "question_id": 33787842, "link": "https://stackoverflow.com/questions/33787842/function-that-returns-a-string-representing-a-worksheet-row/33787989#33787989", "title": "Function that returns a string representing a worksheet row", "body": "<p>Ok, try this:</p>\n\n<pre><code>Function CreateRowRange(CellAddress as String) as String\n    CreateRowRange = Replace(CellAddress, \"$\", \"\")\n    CreateRowRange = CreateRowRange &amp; \":\" &amp; Replace(CreateRowRange, \"A\", \"M\")\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 0, "last_activity_date": 1447873329, "creation_date": 1447873329, "answer_id": 33788220, "question_id": 33787842, "link": "https://stackoverflow.com/questions/33787842/function-that-returns-a-string-representing-a-worksheet-row/33788220#33788220", "title": "Function that returns a string representing a worksheet row", "body": "<p>Excel already has built in properties and methods to modify ranges. If you're going to use it like</p>\n\n<pre><code>Range(CreateRowRange(\"$A$14\")).Value = \"X\"\n</code></pre>\n\n<p>then you can achieve the same thing with</p>\n\n<pre><code>Range(\"$A$14\").Resize(1,13).Value = \"X\"\n</code></pre>\n\n<p>If you're building a formula like</p>\n\n<pre><code>ActiveCell.Formula = \"=SUM(\" &amp; CreateRowRange(\"$A$14\") &amp; \")\"\n</code></pre>\n\n<p>then you can achieve the same thing with</p>\n\n<pre><code>ActiveCell.Formula = \"=SUM(\" &amp; Range(\"A14\").Resize(1,13).Address(0,0) &amp; \")\"\n</code></pre>\n\n<p>The <code>0,0</code> part makes the address relateive - no dollar signs</p>\n"}], "owner": {"reputation": 47, "user_id": 4686429, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8912e3a335138f9636e1af30e30f94c8?s=128&d=identicon&r=PG&f=1", "display_name": "Techie2015", "link": "https://stackoverflow.com/users/4686429/techie2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 33787908, "answer_count": 3, "score": 1, "last_activity_date": 1447873329, "creation_date": 1447872085, "last_edit_date": 1495542617, "question_id": 33787842, "link": "https://stackoverflow.com/questions/33787842/function-that-returns-a-string-representing-a-worksheet-row", "title": "Function that returns a string representing a worksheet row", "body": "<p>I'm trying to create a function (named <code>CreateRowRange</code>) that will take a string having the form \"$A$5\" and produce a string having the form \"A5:M5\". Similarly, if I call the function with \"$A$14\", it will return \"A14:M14\". I have an Excel spreadsheet with data in columns \"A\" through \"M\". I found a similar post on Stack Overflow (<a href=\"https://stackoverflow.com/questions/6945949/concatenating-variables-into-string-to-be-set-to-a-range-in-vba\">Concatenating Variables Into String to be Set to a Range in VBA</a>), but it seems overly complicated. The code written thus far for the function is:</p>\n\n<pre><code>Function CreateRowRange(CellAddress) As String\n    CreateRowRange = Range(CellAddress).Row\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447871112, "post_id": 33787133, "comment_id": 55341911, "body": "When and where exactly does the error occur?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447871776, "post_id": 33787133, "comment_id": 55342289, "body": "I don&#39;t understand your textbox. Is this a continuous form? What are [qty_rec] and [sub]? Counting controls (?) is a little odd."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447872442, "post_id": 33787133, "comment_id": 55342704, "body": "For totaling values you probably want <code>Sum()</code> instead of <code>Count()</code>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447872693, "post_id": 33787133, "comment_id": 55342898, "body": "BTW, when using <code>Sum()</code> it seems to work for me. It&#39;s still an unusual and perhaps error-prone way to implement things, though."}, {"owner": {"reputation": 189, "user_id": 3661800, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bAhMe.jpg?s=128&g=1", "display_name": "Kaw4Life", "link": "https://stackoverflow.com/users/3661800/kaw4life"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447873970, "post_id": 33787133, "comment_id": 55343681, "body": "What I was trying to do with that is get a line count and a % of those lines that have a value in the qty_rec field.  It does not matter what value just that there is one there.  I am looking to get those from the query right now."}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 3661800, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bAhMe.jpg?s=128&g=1", "display_name": "Kaw4Life", "link": "https://stackoverflow.com/users/3661800/kaw4life"}, "edited": false, "score": 0, "creation_date": 1447872515, "post_id": 33787930, "comment_id": 55342757, "body": "I suspected it was a timing issue.  That is why I tried &#39;current&#39; rather than load.  I will re- think the flow logic.  Thank you."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1447872333, "creation_date": 1447872333, "answer_id": 33787930, "question_id": 33787133, "link": "https://stackoverflow.com/questions/33787133/vba-overflow-error-6-not-really/33787930#33787930", "title": "VBA Overflow Error 6 Not really", "body": "<p>I have reproduced the effect, and I think what happens here is:</p>\n\n<p>Calculated controls are evaluated after the form has finished loading. If you remove the event code, and open the form, you will notice that the value of <code>txt_percent_received</code> is displayed with a slight delay.<br>\nYou may even notice that at first it displays <code>#Number!</code>, and then calculates the value.</p>\n\n<p>But the form events happen before that, so what you get is a division of <code>0/0</code>, and this gets runtime error 6 \"Overflow\". </p>\n\n<p><code>1/0</code> would get error 11 \"Division by zero\".</p>\n\n<p>You need a different way either to calculate <code>txt_percent_received</code>, or to implement your <code>cbtn_shortage</code> logic.</p>\n"}], "owner": {"reputation": 189, "user_id": 3661800, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bAhMe.jpg?s=128&g=1", "display_name": "Kaw4Life", "link": "https://stackoverflow.com/users/3661800/kaw4life"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 33787930, "answer_count": 1, "score": 0, "last_activity_date": 1594655804, "creation_date": 1447869794, "last_edit_date": 1594655804, "question_id": 33787133, "link": "https://stackoverflow.com/questions/33787133/vba-overflow-error-6-not-really", "title": "VBA Overflow Error 6 Not really", "body": "<p>=Count([qty_rec])/Count([sub]) is the control source for a text box.  Format for the control is 'percentage'.  I have also tried 'standard', fixed and leaving it blank.  I suspect the evaluation is comparing apples to oranges.</p>\n\n<pre><code>Private Sub Form_Current()\nIf Me.txt_percent_received = 0.5 Then\n    Me.cbtn_shortage.Visible = False\nElse\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I put breakpoint at If and goto to immediate and type ?Me.txt_percent_received </p>\n\n<p>It says 0.5</p>\n\n<p>Why does system think this number is too big?</p>\n\n<p>and why does it work if I step thru the code?</p>\n\n<p>Updated</p>\n\n<pre><code>Dim intTemp As Integer\nintTemp = Me.txt_percent_received\nIf intTemp = 0.5 Then\nMe.cbtn_shortage.Visible = False\nElse\nEnd If\n</code></pre>\n\n<p>Now the error is on intTemp = Me.txt_percent_received</p>\n\n<p>qty_rec and sub are for totaling populated fields.</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5573212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a3bed3e102e91a6dea80ea94d8671e?s=128&d=identicon&r=PG&f=1", "display_name": "mays", "link": "https://stackoverflow.com/users/5573212/mays"}, "edited": false, "score": 0, "creation_date": 1447904267, "post_id": 33787366, "comment_id": 55356281, "body": "Do While ie.readystate &lt;&gt; 4 Or ie.Busy     Application.Wait Now + TimeValue(&quot;00:00:01&quot;) Loop for those lines it giving intrerface is unknown error"}], "tags": [], "owner": {"reputation": 361, "user_id": 4406125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d283087551dc05b73a84f9efdd24e43b?s=128&d=identicon&r=PG&f=1", "display_name": "area9", "link": "https://stackoverflow.com/users/4406125/area9"}, "is_accepted": false, "score": 0, "last_activity_date": 1447870573, "creation_date": 1447870573, "answer_id": 33787366, "question_id": 33786954, "link": "https://stackoverflow.com/questions/33786954/getting-run-time-error-214741784880010108-automation-error-the-object-invo/33787366#33787366", "title": "Getting Run-time-error &#39;-2147417848(80010108): Automation error. The object invoked has disconnected from its clients", "body": "<p>With Internet Explorer, I prefer to use the InternetExplorerMedium object (I have just found it a bit more reliable in the past):</p>\n\n<pre><code>Dim ie as InternetExplorer\n\nSet ie = New InternetExplorerMedium\n</code></pre>\n\n<p>In any case, waiting for the browser can be the following:</p>\n\n<pre><code>Do While ie.readystate &lt;&gt; 4 Or ie.Busy\n    Application.Wait Now + TimeValue(\"00:00:01\")\nLoop\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5573212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a3bed3e102e91a6dea80ea94d8671e?s=128&d=identicon&r=PG&f=1", "display_name": "mays", "link": "https://stackoverflow.com/users/5573212/mays"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 932, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447870573, "creation_date": 1447869162, "question_id": 33786954, "link": "https://stackoverflow.com/questions/33786954/getting-run-time-error-214741784880010108-automation-error-the-object-invo", "title": "Getting Run-time-error &#39;-2147417848(80010108): Automation error. The object invoked has disconnected from its clients", "body": "<p>Getting error for below code:</p>\n\n<pre><code>Sub test()\n    Set ie = CreateObject(\"InternetExplorer.application\")\n    ie.Visible = True\n    ie.navigate (\"http://www.siteminder.com\" &amp; ActiveCell)\n    Do\n            If ie.readyState = 4 Then\n                ie.Visible = True\n                Exit Do\n        Else\n            DoEvents\n        End If\n    Loop\n\n    ie.document.forms(0).all(\"User\").Value = \"me\"\n    ie.document.forms(0).all(\"Password\").Value = \"mypasssword\"\n    ie.document.forms(0).submit\nEnd Sub\n</code></pre>\n\n<p>getting error for line:If ie.readyState = 4 Then</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1447869338, "post_id": 33786885, "comment_id": 55340885, "body": "This is bacause if you write just <code>Sheets</code> it is the same as <code>ActiveWorkbook.Sheets</code>. So you would need to add the workbook qualifier something like <code>Workbooks(&quot;MyBook&quot;).Sheets(...)</code>."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1447869388, "post_id": 33786885, "comment_id": 55340918, "body": "Use <code>ThisWorkbook.Sheets(&quot;Dashboard&quot;)</code>"}, {"owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1447869449, "post_id": 33786885, "comment_id": 55340950, "body": "@dee: Your answer worked perfectly.  Please post as answer so I can accept."}], "answers": [{"tags": [], "owner": {"reputation": 361, "user_id": 4406125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d283087551dc05b73a84f9efdd24e43b?s=128&d=identicon&r=PG&f=1", "display_name": "area9", "link": "https://stackoverflow.com/users/4406125/area9"}, "is_accepted": false, "score": 3, "last_activity_date": 1447869599, "last_edit_date": 1447869599, "creation_date": 1447869445, "answer_id": 33787024, "question_id": 33786885, "link": "https://stackoverflow.com/questions/33786885/reduce-scope-of-vba-to-single-document/33787024#33787024", "title": "Reduce scope of VBA to single document?", "body": "<p>Change the code to the following:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    If ThisWorkbook.Sheets(\"Dashboard\").Range(\"Z11\").Value &gt; 0 Then\n        ThisWorkbook.Sheets(\"Dashboard\").Shapes(\"tileOverdueTasks\").Fill.ForeColor.RGB = RGB(185, 0, 0)\n    Else\n        ThisWorkbook.Sheets(\"Dashboard\").Shapes(\"tileOverdueTasks\").Fill.ForeColor.RGB = RGB(0, 185, 0)\n    End If\nEnd Sub\n</code></pre>\n\n<p>By referencing the workbook with \"ThisWorkbook\", the code will only check in the workbook which the code resides in.</p>\n"}, {"tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": true, "score": 7, "last_activity_date": 1447869805, "creation_date": 1447869805, "answer_id": 33787136, "question_id": 33786885, "link": "https://stackoverflow.com/questions/33786885/reduce-scope-of-vba-to-single-document/33787136#33787136", "title": "Reduce scope of VBA to single document?", "body": "<p>This is bacause if you write just <code>Sheets</code> it is the same as <code>ActiveWorkbook.Sheets</code>. So you would need to add the workbook qualifier something like <code>Workbooks(\"MyBook\").Sheets(\"SheetName\")</code>. </p>\n\n<p>Or you could use <code>ThisWorkbook.Sheets(\"SheetName\")</code>. Then the sheets collection of the workbook where the VBA code is running will be used. </p>\n"}], "owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 33787136, "answer_count": 2, "score": 3, "last_activity_date": 1447869805, "creation_date": 1447868912, "question_id": 33786885, "link": "https://stackoverflow.com/questions/33786885/reduce-scope-of-vba-to-single-document", "title": "Reduce scope of VBA to single document?", "body": "<p>I have the following subroutine that works like I want when I only have this particular Excel file open</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    If Sheets(\"Dashboard\").Range(\"Z11\").Value &gt; 0 Then\n        Sheets(\"Dashboard\").Shapes(\"tileOverdueTasks\").Fill.ForeColor.RGB = RGB(185, 0, 0)\n    Else\n        Sheets(\"Dashboard\").Shapes(\"tileOverdueTasks\").Fill.ForeColor.RGB = RGB(0, 185, 0)\n    End If\nEnd Sub\n</code></pre>\n\n<p>The problem is, if I open another document while this one is open, I get the following error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0XEAd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0XEAd.png\" alt=\"enter image description here\"></a></p>\n\n<p>Debugging reveals where the issue is.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0kZQL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0kZQL.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm new to VBA, but I tried adding <code>ActiveSheet</code> before all the Sheets references and that did not alleviate the error.  How can I make sure this only runs on the \"Dashboard\" Sheet in the document the script is located in?</p>\n"}, {"tags": ["excel", "autofill", "vba"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 5, "last_activity_date": 1447870523, "last_edit_date": 1495542665, "creation_date": 1447868926, "answer_id": 33786887, "question_id": 33786823, "link": "https://stackoverflow.com/questions/33786823/macro-to-autofill/33786887#33786887", "title": "Macro to Autofill", "body": "<p>The issue is that the column when it is added is empty.  So your code is telling excel to go to P65000 and mimic hitting <kbd>ctrl</kbd>-<kbd>upArrow</kbd>.  This would find the first cell with a value, but since there are no values it stops at the top cell P1, thus LastRow = 1. So the fill area is P2:P1.  Use a column that has data in it.  I used the K column because it is in your formula.</p>\n\n<p>This is great example of the use of the Record macro and attempt at cleaning.  When cleaning the code one focus should be to get rid of the <code>.Select</code>.  See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">here</a> for a great compilation of methods to reference ranges without the <code>.Select</code></p>\n\n<p>Also when using the <code>.FormulaR1C1</code> the entire range can be set at once and does not need the fill down.</p>\n\n<p>Change the above code to:</p>\n\n<pre><code>Dim LastRow As Long\n\n LastRow = Range(\"K65000\").End(xlUp).Row\n\nRange(\"P1\").value = \"Age of Ticket\"\nRange(\"P2:P\" &amp; LastRow).FormulaR1C1 = \"=RC[-5]-RC[-8]\"\n</code></pre>\n\n<p>Also if you wanted to use the Autofill, there is no need to use the r1c1 formula.</p>\n\n<pre><code>Range(\"P2\").Formula = \"=K2-H2\"\nRange(\"P2\").AutoFill Destination:=Range(\"P2:P\" &amp; LastRow)\n</code></pre>\n\n<p>This would automatically change the relative references to keep the rows correct.</p>\n"}], "owner": {"reputation": 43, "user_id": 5574195, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JNO_AruyFgA/AAAAAAAAAAI/AAAAAAAAAj0/44YRnlJYD7M/photo.jpg?sz=128", "display_name": "Pri Bee", "link": "https://stackoverflow.com/users/5574195/pri-bee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "accepted_answer_id": 33786887, "answer_count": 1, "score": 4, "last_activity_date": 1447870523, "creation_date": 1447868691, "last_edit_date": 1531161705, "question_id": 33786823, "link": "https://stackoverflow.com/questions/33786823/macro-to-autofill", "title": "Macro to Autofill", "body": "<p>I want to create a column in P called <code>Age of Ticket</code>. It is calculating two dates and then autofill. This macro will be used for reports that vary the number of rows. When I use this, it basically does the calculation on P2, then it does the calculation on P1 (where the label is) and doesn't autofill.</p>\n\n<pre><code>Dim LastRow As Long\n\nLastRow = Range(\"P65000\").End(xlUp).Row\n\nRange(\"P1\").Select\nActiveCell.FormulaR1C1 = \"Age of Ticket\"\nRange(\"P2\").Select\nActiveCell.FormulaR1C1 = \"=RC[-5]-RC[-8]\"\nRange(\"P2\").Select\nSelection.AutoFill Destination:=Range(\"P2:P\" &amp; LastRow)\nRange(\"P2:P3000\").Select\nActiveWindow.SmallScroll Down:=210\n</code></pre>\n\n<p>[Results]</p>\n\n<p><a href=\"https://i.stack.imgur.com/FYTjy.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FYTjy.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ms-access", "combobox", "vba"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 4529336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cd99403316803c24ed8fda3ff80b991?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4529336/chris"}, "edited": false, "score": 0, "creation_date": 1447884373, "post_id": 33787604, "comment_id": 55349795, "body": "Thank you so much! I did not know about the MonthName() function, but I will look into it. Still very much a beginner at this stuff."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 2, "last_activity_date": 1447871337, "creation_date": 1447871337, "answer_id": 33787604, "question_id": 33786434, "link": "https://stackoverflow.com/questions/33786434/how-to-return-value-of-unbound-column-in-combo-box/33787604#33787604", "title": "How to return value of unbound column in combo box", "body": "<p>You need the <code>.Column</code> property.</p>\n\n<pre><code>=[Forms]![frmMyForm]![Combo10].Column(1)\n</code></pre>\n\n<p>is the second column.</p>\n\n<p>BTW, there is also the <code>MonthName()</code> function.</p>\n"}], "owner": {"reputation": 145, "user_id": 4529336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cd99403316803c24ed8fda3ff80b991?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4529336/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2629, "favorite_count": 0, "accepted_answer_id": 33787604, "answer_count": 1, "score": 1, "last_activity_date": 1447871337, "creation_date": 1447867463, "question_id": 33786434, "link": "https://stackoverflow.com/questions/33786434/how-to-return-value-of-unbound-column-in-combo-box", "title": "How to return value of unbound column in combo box", "body": "<p>How can I get the value of an unbound column of a combo box using the expression builder in Access 2007?</p>\n\n<p>I have a form that controls a query through a combo box where I select a month on the form and Access runs a query for items pertaining to that month. Then I have a report that based on that query.</p>\n\n<p>I'd like the report header to display the month that was selected. I made a text box in the report that uses an expression as the control source like so \"=[Forms]![frm Annual Notices Report]![Combo10]\". Which works expect it returns the value in Col1. How can I make my text box display the month in Col2? I've tried \"=[Forms]![frmMyform]![Combo10(1)]\", but it returns an error.</p>\n\n<p>My combo box is setup like this:</p>\n\n<pre><code>Col1       Col2\n1          January\n2          February\n3          March\n4          April\n...        ...\n</code></pre>\n\n<p>I need to use the month index to control the query, but I also want to make a text box in a report show the month as written.</p>\n\n<p>TL;DR:\nHow can I make a text box display the month in Col2?</p>\n\n<p>Currently I have this: \"=[Forms]![frmMyForm]![Combo10]\"</p>\n\n<p>I think I need something like this: \"=[Forms]![frmMyform]![Combo10(1)]\"</p>\n"}, {"tags": ["vba", "excel", "events", "worksheet"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 1052599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3e7b573c0656e884ae23a2f704c697f?s=128&d=identicon&r=PG", "display_name": "Conor Bradley", "link": "https://stackoverflow.com/users/1052599/conor-bradley"}, "edited": false, "score": 0, "creation_date": 1447931906, "post_id": 33786162, "comment_id": 55370321, "body": "Perfect ! Thank you for your time and effort"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 0, "last_activity_date": 1447866604, "creation_date": 1447866604, "answer_id": 33786162, "question_id": 33785880, "link": "https://stackoverflow.com/questions/33785880/excel-addin-detecting-if-named-worksheet-exists-and-if-so-run-marco/33786162#33786162", "title": "Excel Addin Detecting if named worksheet exists and if so run Marco", "body": "<p>Create a class to handle the event when a workbook is opened and check for the sheet in that workbook:</p>\n\n<p><strong><em>Class Module (rename module to \"xlApp\"):</em></strong></p>\n\n<pre><code>Private WithEvents xlApp As Excel.Application\n\nPrivate Sub Class_Initialize()\n    Set xlApp = Application\nEnd Sub\n\nPrivate Sub xlApp_WorkbookOpen(ByVal wb As Excel.Workbook)\n\n    Dim ws As Excel.Worksheet\n\n    For Each ws In wb.Sheets\n        If ws.Name = \"VaR\" Then '// amend as required\n            Call SomeMacro '// amend as required\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p><strong><em>In the Workbook_Open event in your add-in:</em></strong></p>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim XL As xlApp\n    Set XL = New xlApp\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 1052599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3e7b573c0656e884ae23a2f704c697f?s=128&d=identicon&r=PG", "display_name": "Conor Bradley", "link": "https://stackoverflow.com/users/1052599/conor-bradley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 33786162, "answer_count": 1, "score": 1, "last_activity_date": 1448897410, "creation_date": 1447865669, "last_edit_date": 1448897410, "question_id": 33785880, "link": "https://stackoverflow.com/questions/33785880/excel-addin-detecting-if-named-worksheet-exists-and-if-so-run-marco", "title": "Excel Addin Detecting if named worksheet exists and if so run Marco", "body": "<p>Through my addin I am trying to Detect is a named worksheet called VaR exists and if so run a macro. </p>\n\n<p>In my addin ThisWorksheet Object I have included the code </p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    ActiveWorkbook.RefreshAll\n    Application.Wait (Now + TimeValue(\"0:00:05\"))\n    Application.Run (\"Macro\")  \n\nEnd Sub\n</code></pre>\n\n<p>It doesnt work as on opening a spreadsheet that I know has the worksheet that I am looking for e.g. \"VAR\" Doesnt get loaded before the addin so its not found.</p>\n\n<p>Is this action possible. I only want the event to fire for users who open the workbook that contains the worksheet called \"VaR\".</p>\n\n<p>Kind regards.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447865757, "post_id": 33785768, "comment_id": 55338606, "body": "You could use an Array that holds all the words you want to look for.  Or, if you have this list in Excel, you can use that list, throw into an array, then loop through the array and cells.  Also, I don&#39;t know, but perhaps Conditional Formatting would be a good bet too - I just don&#39;t know if you can have 100 conditions :P"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1447867421, "post_id": 33785768, "comment_id": 55339730, "body": "@pnuts - I misread and didn&#39;t realize it was to color a single word out of many, d&#39;oh!"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447865958, "post_id": 33785911, "comment_id": 55338753, "body": "Just to ask - do you know if a conditional format (set up via VBA, since it&#39;d be easier I think) that could hold essentially an <code>Or()</code> formula looking for the 100 names?  That way it could be set up and be dynamic, so if anything changes, the colors would too. I just don&#39;t know the upper limit to Conditional Formatting&#39;s condition amount."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1447866239, "post_id": 33785911, "comment_id": 55338948, "body": "You cannot set part of a string to different font color the way that this sub is doing with a CF rule. However, it would be simple enough to enact it with a Worksheet_Change. Single cell changes wouldn&#39;t even be noticeable and I haven&#39;t met too many people that cannot pause for a second to let a large bulk paste process."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1447865777, "creation_date": 1447865777, "answer_id": 33785911, "question_id": 33785768, "link": "https://stackoverflow.com/questions/33785768/changing-word-color-to-red-based-on-list-of-words/33785911#33785911", "title": "Changing word color to red based on list of words", "body": "<p>Work with an array of pets. After getting to each individual cell, cycle through the array, testing each value and adjusting the text color as necessary.</p>\n\n<pre><code>Sub test()\n    Dim changeRange As Range, oneCell As Range\n    Dim testStr As String, seekstr As String\n    Dim startPosition As String\n    Dim v As Long, vPETs As Variant\n\n    vPETs = Array(\"dog\", \"cat\", \"hamster\")\n\n    Set changeRange = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A2:B21\"): Rem adjust\n\n    For Each oneCell In changeRange.Cells\n        testStr = CStr(oneCell.Value)\n        testStr = LCase(testStr): seekstr = LCase(seekstr): Rem For Case insensitive\n\n        oneCell.Font.ColorIndex = xlAutomatic: Rem remove all colors\n\n        For v = LBound(vPETs) To UBound(vPETs)\n            seekstr = vPETs(v)\n            startPosition = 1\n            Do While 0 &lt; InStr(startPosition, \" \" &amp; testStr &amp; \" \", \" \" &amp; seekstr &amp; \" \", 1)\n                startPosition = InStr(startPosition, \" \" &amp; testStr &amp; \" \", \" \" &amp; seekstr &amp; \" \") + 1\n                oneCell.Characters(startPosition - 1, Len(seekstr)).Font.ColorIndex = 3\n            Loop\n        Next v\n\n    Next oneCell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5577638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb641e889d8e4af062a98e47a2659d0d?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/5577638/sarah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1447865777, "creation_date": 1447865388, "last_edit_date": 1531161705, "question_id": 33785768, "link": "https://stackoverflow.com/questions/33785768/changing-word-color-to-red-based-on-list-of-words", "title": "Changing word color to red based on list of words", "body": "<p>I have the following code which allows me to change one word to a different color. Is there a way to change multiple words to different colors so I don't have to set up the macro for 100 different words, and then run the macro 100 different times? </p>\n\n<p>For example - this is the code when searching for word 'dog'. Can I also add in 'cat' somehow? </p>\n\n<pre><code>Sub test()\n    Dim changeRange As Range, oneCell As Range\n    Dim testStr As String, seekstr As String\n    Dim startPosition As String\n    seekstr = \"dog\": Rem adjust\n\n    Set changeRange = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A2:B21\"): Rem adjust\n\n    For Each oneCell In changeRange.Cells\n        testStr = CStr(oneCell.Value)\n        testStr = LCase(testStr): seekstr = LCase(seekstr): Rem For Case insensitive\n\n        oneCell.Font.ColorIndex = xlAutomatic: Rem remove all colors\n\n        startPosition = 1\n        Do While 0 &lt; InStr(startPosition, \" \" &amp; testStr &amp; \" \", \" \" &amp; seekstr &amp; \" \", 1)\n            startPosition = InStr(startPosition, \" \" &amp; testStr &amp; \" \", \" \" &amp; seekstr &amp; \" \") + 1\n            oneCell.Characters(startPosition - 1, Len(seekstr)).Font.ColorIndex = 3\n        Loop\n\n    Next oneCell\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "unique", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447864800, "post_id": 33785467, "comment_id": 55337911, "body": "<code>countif</code> <a href=\"https://support.office.com/en-us/article/COUNTIF-function-e0de10c6-f885-4e71-abb4-1f464816df34\" rel=\"nofollow noreferrer\">counts</a> the number of occurrences of the second argument in a given range (first argument)."}, {"owner": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447865934, "post_id": 33785467, "comment_id": 55338733, "body": "Edited out &quot;Duplicates&quot; (in paragraph 3). I understand that <code>countif</code>counts the occurences: I&#39;m trying to figure out why it isn&#39;t more than one as it goes down the list and gets additional - and how to solve that bit."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447866035, "post_id": 33785467, "comment_id": 55338802, "body": "Because of the method that the for each goes the code above will not find only unique.  The for each loop move left to right top to bottom.  So when it is moving across row 3 it is doing what is wanted but when it drops down to the next row the range it is comparing is B3:B4 not B3:G3 and B4.  Thus it will give duplicates.  So if your plan is to only get unique values then a collection may be the best method."}, {"owner": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "edited": false, "score": 0, "creation_date": 1447866817, "post_id": 33785467, "comment_id": 55339361, "body": "That makes sense - I was wondering if it was something like that, but I couldn&#39;t explain it. Thank you. I&#39;ll try to work it out with a collection - it just seemed like this was so close and small it was a shame to ditch it."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "edited": false, "score": 0, "creation_date": 1447876063, "post_id": 33786631, "comment_id": 55344976, "body": "Thank you, Scott - I was working on getting a collection to work and came back to see you had added this. I incorporated what you had to make mine a few lines shorter and <i>ahem</i> work. :-) This helped: thank you. (I edited mine to show what code I added.)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "edited": false, "score": 0, "creation_date": 1447876523, "post_id": 33786631, "comment_id": 55345264, "body": "@JGR Glad I could help."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1447868374, "last_edit_date": 1447868374, "creation_date": 1447868022, "answer_id": 33786631, "question_id": 33785467, "link": "https://stackoverflow.com/questions/33785467/excel-macro-understanding-code-get-unique-values-rows-cols-to-use-in-ma/33786631#33786631", "title": "Excel (macro): understanding code - get unique values (rows &amp; cols) to use in macro", "body": "<p>Here is a Function that uses Collection to return an Array of unique values.</p>\n\n<pre><code>Function UniqueArray(rng As Range) As Variant()\n    Dim cUnique As Collection\n    Dim Cell As Range\n    Dim vNum As Variant\n    Dim tempArr() As Variant\n    Dim j As Long\n\n    Set cUnique = New Collection\n\n    On Error Resume Next\n        For Each Cell In rng.Cells\n            cUnique.Add Cell.Value, CStr(Cell.Value)\n        Next Cell\n    On Error GoTo 0\n\n    ReDim tempArr(0 To cUnique.Count - 1)\n    j = 0\n    For Each vNum In cUnique\n        tempArr(j) = vNum\n        j = j + 1\n    Next vNum\n\n    UniqueArray = tempArr\nEnd Function\n</code></pre>\n\n<p>You would call it like this</p>\n\n<pre><code>Dim tArr as Variant\ntArr = UniqueArray(\"rHFilter\")\n</code></pre>\n\n<p>Then loop through tArr to get your unique values.</p>\n"}], "owner": {"reputation": 151, "user_id": 1613210, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbB6n.jpg?s=128&g=1", "display_name": "JGR", "link": "https://stackoverflow.com/users/1613210/jgr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 0, "accepted_answer_id": 33786631, "answer_count": 1, "score": 0, "last_activity_date": 1447876715, "creation_date": 1447864548, "last_edit_date": 1531164843, "question_id": 33785467, "link": "https://stackoverflow.com/questions/33785467/excel-macro-understanding-code-get-unique-values-rows-cols-to-use-in-ma", "title": "Excel (macro): understanding code - get unique values (rows &amp; cols) to use in macro", "body": "<p>(First, I understand that <a href=\"https://stackoverflow.com/questions/15799172/use-vba-to-get-unique-values-for-use-within-vba\">this</a> may work well for me - I'm trying to understand what's going on with a piece of code from somewhere else.)</p>\n\n<p>I have a macro connected to buttons to hide columns and rows in range \"rHFilter\" that do not contain the value I want (whatever is in the drop-down in cell \"M2\"). To get the values for the drop-down, I am trying to check all the values in my range \"rHFilter\".\n<a href=\"https://i.stack.imgur.com/PMsDz.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>I'm getting <s>duplicates in my code</s>  <em>multiple instances of values in my \"strFilter\" variable</em>, though, and I don't understand what this bit is doing, exactly, that it allows duplicates:</p>\n\n<pre><code>    For Each c In Range(\"rHFilter\").Cells\n    If Application.CountIf(Range(Cells(3, 2), c), c.Value) = 1 Then\n        strFilter = strFilter &amp; \",\" &amp; c.Value\n    End If\n    Next c\n</code></pre>\n\n<p>That seems to be the smallest way to get unique values from a range to use in my macro - but if I can't make it work, I'm looking at trying the \"collection\" code from the other page. Can anyone help me?</p>\n\n<p>As an aside, I don't understand what this is doing, either:</p>\n\n<pre><code>'=========\n'What is this statement supposed to do?\n'If Application.CountIf(ThisWorkbook.Sheets(1).Columns(2), \"-\") _\n   = Range(\"rHFilter\").Rows.Count Then Exit Sub\n'=========\n</code></pre>\n\n<p>Here's the larger bit of code (for anyone interested):</p>\n\n<pre><code>    Sub SetrHFilterRange()\n    On Error Resume Next\n    Application.ScreenUpdating = False\n    strSN = ActiveSheet.name\n    Set ws = Sheets(strSN)\n\n    ' Get the Last Cell of the Used Range\n    ' Set lastCell = ThisWorkbook.Sheets(1).usedRange.SpecialCells(xlCellTypeLastCell)\n    Set lastCell = ws.Columns(\"B:G\").Find(\"*\", ws.[B3], xlValues, , xlByRows, xlPrevious)\n    lastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n    Set usedRange = Range(\"B3:G\" &amp; lastRow)\n\n    ' Reset Range \"rHFilter\" from Cell C2 to last cell in Used Range\n    ThisWorkbook.Names.Add name:=\"rHFilter\", RefersTo:=usedRange\n\n    ' Set filtering cell value and formatting\n    With Cells(2, 13)\n        .Value = \"-\"\n        .FormatConditions.Delete\n        .FormatConditions.Add Type:=xlCellValue, Operator:=xlNotEqual, Formula1:=\"=\"\"-\"\"\"\n        .FormatConditions(1).Interior.ColorIndex = 44\n        .Interior.ColorIndex = 17\n    End With\n\n    strFilter = \"-\"\n\n    For Each c In Range(\"rHFilter\").Cells\n        If Application.CountIf(Range(Cells(3, 2), c), c.Value) = 1 Then\n            strFilter = strFilter &amp; \",\" &amp; c.Value\n        End If\n    Next c\n\n    With Cells(2, 13).Validation\n        .Delete\n        .Add Type:=xlValidateList, Formula1:=strFilter &amp; \",Blank Cells\"\n        .InCellDropdown = True\n    End With\n\n    strFilter = \"\"\n    Application.ScreenUpdating = True\n\n    On Error GoTo 0\n\nEnd Sub\n\nSub SetrHFilter()\n\n    strSN = ActiveSheet.name\n    Set ws = Sheets(strSN)\n\n    If lastCell Is Nothing Then\n        Set lastCell = ws.Columns(\"B:G\").Find(\"*\", ws.[B3], xlValues, , xlByRows, xlPrevious)\n    End If\n\n    On Error Resume Next\n'=========\n    'What is this statement supposed to do?\n    'If Application.CountIf(ThisWorkbook.Sheets(1).Columns(2), \"-\") _\n       = Range(\"rHFilter\").Rows.Count Then Exit Sub\n'=========\n\n    ' reset unhide in case the user didn't clear\n    ThisWorkbook.Sheets(1).Columns.Hidden = False\n    ThisWorkbook.Sheets(1).Rows.Hidden = False\n\n    eName = Cells(2, 13).Value\n    If eName = \"-\" Then Exit Sub\n\n    ' Speed the code up changing the Application settings\n    With Application\n        lCalc = .Calculation\n        .Calculation = xlCalculationManual\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    FilterRowsNCols:\n\n    ' Hide columns if cells don't match the values in filter cell\n    If eName &lt;&gt; \"Blank Cells\" Then\n        For Each hFilterCol In Range(\"rHFilter\").Columns\n            Set fName = hFilterCol.Find(what:=eName, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, _\n                                                        SearchDirection:=xlNext, MatchCase:=False)\n            If fName Is Nothing Then 'not found\n                hFilterCol.EntireColumn.Hidden = True\n            End If\n        Next hFilterCol\n    Else\n        'Do something if the user selects blank - but what??\n    End If\n\n    If eName &lt;&gt; \"Blank Cells\" Then\n        For Each hFilterRow In Range(\"rHFilter\").Rows\n            Set fName = hFilterRow.Find(what:=eName, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n                                                        SearchDirection:=xlNext, MatchCase:=False)\n            If fName Is Nothing Then 'not found\n                hFilterRow.EntireRow.Hidden = True\n            End If\n        Next hFilterRow\n    Else\n        'Do something if the user selects blank - but what??\n    End If\n\n    Set lastCell = Nothing\n\n    If bFilter = False Then\n        bFilter = True\n        GoTo FilterRowsNCols\n    End If\n\n    ' Change the Application settings back\n    With Application\n        .Calculation = lCalc\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\n    On Error GoTo 0\n\n\n    End Sub\n\n    Sub ResetrHFilter()\n    On Error Resume Next\n    ThisWorkbook.Sheets(1).Columns.Hidden = False\n    ThisWorkbook.Sheets(1).Rows.Hidden = False\n    SetrHFilterRange\n    On Error GoTo 0\n\n    End Sub\n</code></pre>\n\n<p>==================================</p>\n\n<h1>Edit</h1>\n\n<p><em>Added the following edit after reading &amp; testing Scott's answer:</em></p>\n\n<p>I changed my code from:</p>\n\n<pre><code>strFilter = \"-\"\n\nFor Each c In Range(\"rHFilter\").Cells\n    If Application.CountIf(Range(Cells(3, 2), c), c.Value) = 1 Then\n        strFilter = strFilter &amp; \",\" &amp; c.Value\n    End If\nNext c\n\nWith Cells(2, 13).Validation\n    .Delete\n    .Add Type:=xlValidateList, Formula1:=strFilter &amp; \",Blank Cells\"\n    .InCellDropdown = True\nEnd With\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>strFilter = \"-\"\nSet uniqCol = New Collection\n\nFor Each c In Range(\"rHFilter\").Cells\n    If Not IsNumeric(c.Value) And Not IsDate(c.Value) Then\n       uniqCol.Add c.Value, CStr(c.Value)\n    End If\nNext c\nFor Each itmVal In uniqCol\n    strFilter = strFilter &amp; \",\" &amp; itmVal\nNext\n\nWith Cells(3, 34).Validation\n    .Delete\n    .Add Type:=xlValidateList, Formula1:=strFilter &amp; \",Blank Cells\"\n    .InCellDropdown = True\nEnd With\n</code></pre>\n\n<p>Thank you, Scott</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 2, "creation_date": 1447864001, "post_id": 33785030, "comment_id": 55337331, "body": "It sure is possible.  Look at Worksheet_Change, and you&#39;ll need to find the sheet by sheet name, etc..  Get some code started and post it back here when/if you hit a wall."}, {"owner": {"reputation": 148, "user_id": 5127918, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-mr5CiqzTDDw/AAAAAAAAAAI/AAAAAAAAAcQ/1kbu8VmI45Y/photo.jpg?sz=128", "display_name": "Christian Shields", "link": "https://stackoverflow.com/users/5127918/christian-shields"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1447864366, "post_id": 33785030, "comment_id": 55337611, "body": "You are a rockstar Matthew, that is exactly the kind of answer I was looking for. I will certainly do that!"}, {"owner": {"reputation": 148, "user_id": 5127918, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-mr5CiqzTDDw/AAAAAAAAAAI/AAAAAAAAAcQ/1kbu8VmI45Y/photo.jpg?sz=128", "display_name": "Christian Shields", "link": "https://stackoverflow.com/users/5127918/christian-shields"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1447873500, "post_id": 33785030, "comment_id": 55343405, "body": "@pnuts, thanks! I have some experience with Google sheets, even more than Excel, but I need a fully robust offline experience for this one."}], "owner": {"reputation": 148, "user_id": 5127918, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-mr5CiqzTDDw/AAAAAAAAAAI/AAAAAAAAAcQ/1kbu8VmI45Y/photo.jpg?sz=128", "display_name": "Christian Shields", "link": "https://stackoverflow.com/users/5127918/christian-shields"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1447863321, "creation_date": 1447863321, "last_edit_date": 1531161705, "question_id": 33785030, "link": "https://stackoverflow.com/questions/33785030/adding-a-new-line-of-data-on-a-sheet-based-on-drop-down-information", "title": "Adding a new line of data on a sheet based on drop down information", "body": "<p>I have a question of \"is it possible\" more than \"how exactly do I do this\". I am contemplating shelling out cash for accounting software, but as I look at them I keep thinking \"I bet excel could do all of this\". I am a semi-experienced computer programmer (I went to school for CS and have VB experience but never used it professionally) so I am not afraid of code. Here is what I am wondering is possible.</p>\n\n<p>I have one sheet that tally's the total number of donations given on a particular day, along with each line includes a name of the person donating, and the amount donated. Then each individual person each also has their own sheet detailing all of their donations for a year. Is it possible that when I enter the first set of data (A line with a name and then a donation amount) that excel could read the name, and then based on that name update that persons own unique sheet of total donations? If so, can you suggest a term or phrase to Google that I may not know so I can look it up? Thanks!</p>\n"}, {"tags": ["excel", "vba", "naming", "worksheet"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1447862898, "post_id": 33784855, "comment_id": 55336579, "body": "use <code>cstr(name)</code>. with name being the variable.  It will change the numbers to strings."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5170702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bdac14071049be50f87d6e7791ff98?s=128&d=identicon&r=PG&f=1", "display_name": "Clay", "link": "https://stackoverflow.com/users/5170702/clay"}, "edited": false, "score": 0, "creation_date": 1447874932, "post_id": 33784981, "comment_id": 55344289, "body": "And here I thought I had found something new. Thanks, that was exactly the problem!"}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 3, "last_activity_date": 1447863511, "last_edit_date": 1447863511, "creation_date": 1447863168, "answer_id": 33784981, "question_id": 33784855, "link": "https://stackoverflow.com/questions/33784855/index-number-worksheet-name-confusion-with-variables-when-worksheet-names-are-nu/33784981#33784981", "title": "Index number/worksheet name confusion with variables when worksheet names are numerical", "body": "<p>Your problem is caused by this line:</p>\n\n<pre><code>Dim source, old_filename, old_tab, new_filename As String\n</code></pre>\n\n<p>...though it does not manifest itself until you attempt to access the Worksheets collection.</p>\n\n<p>This is a very common mistake. The ONLY variable in the above line that is of type String is the last one. Each of the others is of type Variant.</p>\n\n<p>When assigning to the variant <code>old_tab</code> any numerical value will be stored as a number, not a string. And the problem with that is that the Worksheets collection needs a string value as a key to return the correct worksheet.</p>\n\n<p>If each of the variables in the above line is supposed to be of type String then do this:</p>\n\n<pre><code>Dim source As String, old_filename As String, old_tab As String, new_filename As String\n</code></pre>\n\n<p>...and now that <code>old-tab</code> is a String, it's value will work properly as a key to the Worksheets collection.</p>\n"}], "owner": {"reputation": 25, "user_id": 5170702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bdac14071049be50f87d6e7791ff98?s=128&d=identicon&r=PG&f=1", "display_name": "Clay", "link": "https://stackoverflow.com/users/5170702/clay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 33784981, "answer_count": 1, "score": 1, "last_activity_date": 1447863511, "creation_date": 1447862793, "last_edit_date": 1447863251, "question_id": 33784855, "link": "https://stackoverflow.com/questions/33784855/index-number-worksheet-name-confusion-with-variables-when-worksheet-names-are-nu", "title": "Index number/worksheet name confusion with variables when worksheet names are numerical", "body": "<p>I might have found a novel problem! I'm trying to select worksheets based on the name of the worksheet, using a variable for the name since this is all part of a loop. But I run into trouble when the worksheet's name is a number, since if I have, say, name = 5, then Worksheets(name) gives me the index number 5 worksheet and Worksheets(\"name\") of course looks for a worksheet named \"name\". </p>\n\n<p>I could do a workaround with adding a letter to each worksheet's name so it's not treated as a number, and then removing those letters afterwards, but is there a better way?</p>\n\n<pre><code>Sub RenameFiles()\nDim source, old_filename, old_tab, new_filename As String\nDim i As Integer\nsource = Range(\"path\").Value\nFor i = 1 To Range(\"total_file_number\").Value\n    old_filename = Worksheets(\"Import and combine\").Cells(3 + i, 2).Value\n    old_tab = Worksheets(\"Import and combine\").Cells(3 + i, 3).Value\n    new_filename = Worksheets(old_tab).Cells(1, 1).Value 'If old_tab is a number, VBA treats Worksheets(old_tab) as looking up a worksheet by index number rather than name\n    If Left(Worksheets(old_tab).Cells(1, 1).Value, 1) = \"*\" Then new_filename = Right(new_filename, Len(new_filename) - 2) 'removes asterisk from name\n    new_filename = Replace(new_filename, \"&gt;\", \"\") 'removes &gt; from name, since &gt; can't be used in file names\n    Worksheets(old_tab).Name = new_filename\n    Worksheets(\"Import and combine\").Cells(3 + i, 3).Value = new_filename\n    Name source &amp; \"\\\" &amp; old_filename As source &amp; \"\\\" &amp; new_filename\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "excel", "vba", "combobox"], "answers": [{"tags": [], "owner": {"reputation": 312, "user_id": 4496336, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cfa08924ecf4108c3544de8e4dfb574e?s=128&d=identicon&r=PG&f=1", "display_name": "Darw1n34", "link": "https://stackoverflow.com/users/4496336/darw1n34"}, "is_accepted": false, "score": 0, "last_activity_date": 1447875282, "creation_date": 1447875282, "answer_id": 33788808, "question_id": 33784527, "link": "https://stackoverflow.com/questions/33784527/changing-the-index-of-a-combobox-in-excel-from-c/33788808#33788808", "title": "Changing the index of a combobox in Excel from C#", "body": "<p>So I was able to figure out that I was doing too much thinking.   I went back to VBA then transposed that back to C#.  The result was the following code, which yu will notice is considerably shorter and succinct.  I had to test the oleObject's programID which for ALL activeX comboboxes is \"Forms.ComboBox.1\" then grab that object's name, then call it by name, with an extra \"Object\" in there for good measure.</p>\n\n<pre><code> private void ResetComboBoxes2(string[] comboboxes, Excel.Application xlApp)\n    {\n        Excel.Worksheet wksht = new Excel.Worksheet();\n\n        for (int i = 0; i &lt; comboboxes.Length; i++)\n        {\n                string[] comboBoxesSplit = comboboxes[i].Split(':');\n                string sheetName = comboBoxesSplit[0].ToString();\n                wksht = xlApp.ActiveWorkbook.Worksheets[sheetName];\n\n                foreach (Excel.OLEObject oleobj in wksht.OLEObjects())\n                {\n                    if (oleobj.progID == \"Forms.ComboBox.1\")//oleobj.Name.ToString() == oleObjName)\n                    {\n                        string cbName = oleobj.Name.ToString();\n                        wksht.OLEObjects(cbName).Object.ListIndex = 0;\n                    }\n                }\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 312, "user_id": 4496336, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cfa08924ecf4108c3544de8e4dfb574e?s=128&d=identicon&r=PG&f=1", "display_name": "Darw1n34", "link": "https://stackoverflow.com/users/4496336/darw1n34"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1447875282, "creation_date": 1447861859, "question_id": 33784527, "link": "https://stackoverflow.com/questions/33784527/changing-the-index-of-a-combobox-in-excel-from-c", "title": "Changing the index of a combobox in Excel from C#", "body": "<p>I am writing a program that accesses an excel template containing columns of data (with an unique ID number in the first column). Based on the first two numbers of the ID number, the row will either be kept or deleted.   In the template, this unique ID number column feeds an ActiveX Combobox's (located on the Worksheet) ListFill attribute.  When the non-matching rows are removed, the ListFill attribute is reset, but the text is not reset.</p>\n\n<p>Example, if I select rows based on '02' being the first two numbers of the unique ID in Column A, I have no problem removing everything that does not start with '02' but the Combobox text still reads \"010001\" since that is the first Unique ID in the template, even though it doesn't exist in the new list.  </p>\n\n<p>I tell you all this to ask if anyone knows a better way to access the combobox?  I can access it as an OLEObject, but that does not allow me to change the index or text properties of the combobox as they are 'read only' as per the following intellisense error in VS 2013:</p>\n\n<blockquote>\n  <p>Property or Indexer 'Microsoft.Office.Interop.Excel_OLEObject.Index' cannot be assinged to -- it is read only.</p>\n</blockquote>\n\n<p>The error appears on the line:</p>\n\n<blockquote>\n  <p>oleobj.Index = 1;</p>\n</blockquote>\n\n<p>The code snippet is below.  The current Excel application is passed as xlApp and the array comboboxes is passed.  Each member of the comboboxes array contains the sheet name the combobox is on, the name of the control and the ListFillRange it has on the template.  Example array member would be:</p>\n\n<blockquote>\n  <p>Sheet1!:cbTest:$A$1:$A$10</p>\n</blockquote>\n\n<pre><code>private void ResetComboBoxes2(string[] comboboxes, Excel.Application xlApp)\n    {\n        Excel.Worksheet wksht = new Excel.Worksheet();\n        Excel.Range rng;\n        int listEndCellNum;\n        string listEndCellApha;\n        string listEndCell;\n\n        for (int i = 0; i &lt; comboboxes.Length; i++)\n        {\n            string[] comboBoxesSplit = comboboxes[i].Split(':');\n            string sheetName = comboBoxesSplit[0].ToString();\n            string oleObjName = comboBoxesSplit[1].ToString();\n            string[] rangeArray = comboBoxesSplit[2].Split(':');\n            string rangeStart = rangeArray[0];\n            listEndCellNum = wksht.Range[rangeStart].End[Excel.XlDirection.xlDown].Offset[1, 0].Row - 1;\n            string[] cellBreakdown = rangeStart.Split('$');\n            listEndCellApha = cellBreakdown[1];\n            listEndCell = \"$\" + listEndCellApha + \"$\" + listEndCellNum;\n            string listFull = rangeStart + \":\" + listEndCell;\n            wksht = xlApp.ActiveWorkbook.Worksheets[sheetName];\n\n            foreach (Excel.OLEObject oleobj in wksht.OLEObjects())\n            {\n                if (oleobj.Name.ToString() == oleObjName)\n                {\n                    oleobj.ListFillRange = listFull;\n                    oleobj.Index = 1;\n                }\n            }\n\n        }\n    }\n</code></pre>\n\n<p>I'm not even sure there IS a way to do this properly.  I could always make a chunk of VBA code to reset it before saving and access that through C# but I am hoping to do it here.</p>\n"}, {"tags": ["excel", "filter", "vba"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "edited": false, "score": 0, "creation_date": 1447862548, "post_id": 33784593, "comment_id": 55336292, "body": "Thanks @Scott, that worked, but now it&#39;s copying to every single column down to IV! D: It looks horrendous.  I only need column C to be copied to Column A either in the same workbook on Sheet2, or to the new Excel_Test workbook, which I am trying to figure out the code for. Either one is fine."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "edited": false, "score": 0, "creation_date": 1447862906, "post_id": 33784593, "comment_id": 55336586, "body": "see my edited answer. technically it&#39;s a separate question, but it was simple enough to fix here. please mark as answered (see you say it worked)."}, {"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "edited": false, "score": 1, "creation_date": 1447863141, "post_id": 33784593, "comment_id": 55336760, "body": "Thanks so much! I will remember these small details for future macros and study on the references further. This just saved me a ton of time with daily operations for URL searching. It&#39;s always those small things that get me when I&#39;m coding :("}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1447862843, "last_edit_date": 1447862843, "creation_date": 1447862103, "answer_id": 33784593, "question_id": 33784312, "link": "https://stackoverflow.com/questions/33784312/filtering-excel-data-by-row-and-copying-a-specific-column/33784593#33784593", "title": "Filtering Excel Data by Row and Copying a Specific Column", "body": "<p>Since you are already working <em>only</em> with column C in this statement:</p>\n\n<pre><code>With .Range(\"C2:C\" &amp; lRow)\n</code></pre>\n\n<p>You can just eliminate the <code>EntireRow</code> property from this statement</p>\n\n<pre><code>Set copyFrom = .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow\n</code></pre>\n\n<p>And it will set the range to visible cells in column C <em>only</em>, like this:</p>\n\n<pre><code>Set copyFrom = .Offset(1, 0).SpecialCells(xlCellTypeVisible)\n</code></pre>\n\n<h2>EDIT (to address issue in comment)</h2>\n\n<p>The line:</p>\n\n<pre><code>copyFrom.Copy .Rows(lRow)\n</code></pre>\n\n<p>Is going to paste the data into <em>every column</em> of that row. So make the line this to copy only into Column A.</p>\n\n<pre><code>copyFrom.Copy .Cells(lRow,1)\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 33784593, "answer_count": 1, "score": 0, "last_activity_date": 1447862843, "creation_date": 1447861259, "last_edit_date": 1531161705, "question_id": 33784312, "link": "https://stackoverflow.com/questions/33784312/filtering-excel-data-by-row-and-copying-a-specific-column", "title": "Filtering Excel Data by Row and Copying a Specific Column", "body": "<p>I've been having a bit of trouble with my Excel code. What I want to do is to search the rows by text criteria, filter/sort those rows with the specific criteria by column, and be able to copy and hold all of the values in the clipboard for an automation software to take over from that point. </p>\n\n<p>So far, I have been able to sort the rows by the specified criteria (text string), but I cannot seem to figure out the code to copy only the column range (to the end of the row). I can copy the rows, but I'm not sure what the code is to copy an individual column (in this case these are all web addresses, and the column to be copied would be C). I am using Excel 2010.</p>\n\n<pre><code>Sub USPS_Select2()\n\nDim wb1 As Workbook, wb2 As Workbook\nDim ws1 As Worksheet, ws2 As Worksheet\nDim copyFrom As Range\nDim lRow As Long \nDim strSearch As String\nDim rng As Range\nDim cl As Object\nDim strMatch As String\nDim filterRange As Range\nDim copyRange As Range\nDim lastRow As Long\n\n\nSet wb1 = Application.Workbooks.Open(\"\\\\S51\\CompanyFolder\\Employee Folders\\Jason\\TrackingDeliveryStatus.xls\")\nSet ws1 = wb1.Worksheets(\"TrackingDeliveryStatusResults\")\n\nstrSearch = \"usps.com\"\n\n\nWith ws1\n\n\n    .AutoFilterMode = False\n\n\n    lRow = .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row\n\n    With .Range(\"C2:C\" &amp; lRow)\n        .AutoFilter field:=1, Criteria1:=\"=*\" &amp; strSearch &amp; \"*\"\n        Set copyFrom = .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow\n    End With\n\n\n    .AutoFilterMode = False\nEnd With\n\n\nSet wb2 = Application.Workbooks.Open(\"C:\\Users\\CompanyFolder\\Desktop\\Excel_Test.xls\")\nSet ws2 = wb2.Worksheets(\"Sheet1\")\n\nWith ws2\n    If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n        lRow = .Cells.Find(What:=\"*\", _\n                      After:=.Range(\"A1\"), _\n                      LookAt:=xlPart, _\n                      LookIn:=xlFormulas, _\n                      SearchOrder:=xlByRows, _\n                      SearchDirection:=xlPrevious, _\n                      MatchCase:=False).Row\n\n    Else\n        lRow = 1\n    End If\n\n    copyFrom.Copy .Rows(lRow)\nEnd With\n\n\n\n\n'wb2.Save\n'wb2.close\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "char"], "answers": [{"comments": [{"owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "edited": false, "score": 0, "creation_date": 1447955722, "post_id": 33784196, "comment_id": 55387436, "body": "Thank you. I tried this and it worked. Now I have the same problem with a DELETE query. Can you help me? <code>&quot;DELETE FROM Track WHERE Track.WebAddressCompareString LIKE &#39;&quot; &amp; chr(i) &amp; &quot;*&#39;&quot; </code>"}, {"owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "reply_to_user": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "edited": false, "score": 0, "creation_date": 1448009387, "post_id": 33784196, "comment_id": 55410073, "body": "You can do it similarly - create <code>QueryDef</code> object, but change the <code>qry</code> you pass to this object."}], "tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 2, "last_activity_date": 1447860936, "creation_date": 1447860936, "answer_id": 33784196, "question_id": 33783748, "link": "https://stackoverflow.com/questions/33783748/inserting-an-apostrophe-or-quotes-in-code/33784196#33784196", "title": "Inserting an apostrophe, or quotes in code", "body": "<p>You can use <code>QueryDef</code> class to avoid problems with apostrophes. Even if there are any other characters that would give you problems, this class ensures that they will be properly escaped. </p>\n\n<p>Below is the code that should do the trick:</p>\n\n<pre><code>Sub test()\n    Dim i As Long\n    Dim qry As String\n    Dim qryDef As QueryDef\n\n\n    qry = \"INSERT INTO whiteTable VALUES ([a], [b], [c])\"\n\n\n    Set qryDef = CurrentDb.CreateQueryDef(\"FillTable\", qry)\n\n\n    For i = 1 To 127\n        With qryDef\n            .Parameters(\"a\").Value = Chr(i) &amp; \"field\"\n            .Parameters(\"b\").Value = \"fie\" &amp; Chr(i) &amp; \"ld\"\n            .Parameters(\"c\").Value = \"field\" &amp; Chr(i)\n            Call .Execute(dbFailOnError)\n        End With\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "accepted_answer_id": 33784196, "answer_count": 1, "score": 2, "last_activity_date": 1447860936, "creation_date": 1447859807, "question_id": 33783748, "link": "https://stackoverflow.com/questions/33783748/inserting-an-apostrophe-or-quotes-in-code", "title": "Inserting an apostrophe, or quotes in code", "body": "<p>The following code fails when the loop's <code>i</code> equals an apostrophe.</p>\n\n<pre><code>For i = 1 To 127\n    fillTable = \"INSERT INTO whiteTable VALUES ('\" &amp; Chr(i) &amp; \"field', 'fie\" &amp; Chr(i) &amp; \"ld', 'field\" &amp; Chr(i) &amp; \"')\"\n    DoCmd.RunSQL fillTable\nNext i\n</code></pre>\n\n<p>I assume that when the <code>chr(i)</code> equals quotes there will be a problem as well. I have searched for ways to add an apostrophe and came up with using double quotes, \"\"x\"\" , or double apostrophes, ''x''. For some reason this does not work, as I keep on receiving errors. Besides, I assume that this solution is only suitable when I <strong>know</strong> there is an apostrophe, but here there will be a problem only when the <code>i</code> is 39 or 34. Do you know of a way to use these characters in the code?</p>\n\n<p>If there is no way to do this, I will exclude 39 and 34 (', \") from the loop. Are there any other characters that will give me problems (such as `)?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1447859512, "post_id": 33783627, "comment_id": 55333892, "body": "See the article on the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195734.aspx\" rel=\"nofollow noreferrer\">Application.GetSaveAsFileName</a> for complete information"}, {"owner": {"reputation": 9405, "user_id": 701346, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ACosU.jpg?s=128&g=1", "display_name": "oscilatingcretin", "link": "https://stackoverflow.com/users/701346/oscilatingcretin"}, "edited": false, "score": 0, "creation_date": 1447860205, "post_id": 33783627, "comment_id": 55334430, "body": "Love magic strings.  It works as expected.  I was hoping to be able to use the <code>XlFileFormat</code> enum, but it apparently doesn&#39;t work.  Thx.  Edit:  Also, I was really hoping to get the same behavior as the traditional Save As dialog where xlsx is the default and you can see all others.  Any way to duplicate that behavior?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1447860587, "post_id": 33783627, "comment_id": 55334721, "body": "You can have multiple filters: <code>Application.GetSaveAsFilename(&quot;defaultname&quot;, &quot;Excel Files (*.xlsx), *.xlsx, All Files (*.*), *.*&quot;) </code>"}, {"owner": {"reputation": 9405, "user_id": 701346, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ACosU.jpg?s=128&g=1", "display_name": "oscilatingcretin", "link": "https://stackoverflow.com/users/701346/oscilatingcretin"}, "edited": false, "score": 0, "creation_date": 1447863099, "post_id": 33783627, "comment_id": 55336729, "body": "@AlexK., yes, but <code>*.*</code> doesn&#39;t mean show all types, but show the filter that specifies all types.  In order for all types to display like the traditional Save As dialog, it looks like you&#39;d literally have to hardcode every single filter.  I want this macro to be dynamic across multiple versions of Excel, so this runs the risk of not behaving properly in the event of an Excel upgrade."}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1447859475, "creation_date": 1447859475, "answer_id": 33783627, "question_id": 33783500, "link": "https://stackoverflow.com/questions/33783500/including-extension-when-using-application-getsaveasfilename/33783627#33783627", "title": "Including extension when using Application.GetSaveAsFilename()", "body": "<p>Pass it a <em>filter</em> and it will append automagically:</p>\n\n<pre><code>Application.GetSaveAsFilename(\"defaultname\", \"Excel Files (*.xlsx), *.xlsx\") \n</code></pre>\n"}], "owner": {"reputation": 9405, "user_id": 701346, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ACosU.jpg?s=128&g=1", "display_name": "oscilatingcretin", "link": "https://stackoverflow.com/users/701346/oscilatingcretin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1258, "favorite_count": 0, "accepted_answer_id": 33783627, "answer_count": 1, "score": 1, "last_activity_date": 1447859851, "creation_date": 1447859122, "last_edit_date": 1531164843, "question_id": 33783500, "link": "https://stackoverflow.com/questions/33783500/including-extension-when-using-application-getsaveasfilename", "title": "Including extension when using Application.GetSaveAsFilename()", "body": "<p>I am using <code>Application.GetSaveAsFilename</code> in VBA to implement my own custom Save As function.  It works when I do this:</p>\n\n<pre><code>Application.GetSaveAsFilename(\"defaultname\")\n</code></pre>\n\n<p>The <code>File name</code> field says <em>defaultname</em>.  However, the expected .xlsx extension doesn't show in the dialog box.  Okay, so I'll just add it like this, right?</p>\n\n<pre><code>Application.GetSaveAsFilename(\"defaultname.xlsx\")\n</code></pre>\n\n<p>When I do that, the <code>File name</code> field is blank.  Apparently, Excel doesn't like the <code>.</code> because when I do this...</p>\n\n<pre><code>Application.GetSaveAsFilename(\"defaultnamexlsx\")\n</code></pre>\n\n<p>...it shows <em>defaultnamexlsx</em> in the <code>File name</code> field, though this is obviously not the format I am looking for.</p>\n\n<p>Do I have to do something special to get this to work?</p>\n"}, {"tags": ["excel", "vba", "csv"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447859027, "post_id": 33783351, "comment_id": 55333510, "body": "You could try the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837097.aspx\" rel=\"nofollow noreferrer\">Workbooks.OpenText method</a> but from my own experience, it is better to have the file as a TXT extension. Using this to open something with a CSV extension seems to disregard certain options in favor of CSV-style defaults. Never had a problem opening TXT this way though."}, {"owner": {"reputation": 109, "user_id": 4297499, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c949ca43c033099636373ae506e51b33?s=128&d=identicon&r=PG&f=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/4297499/geoff"}, "edited": false, "score": 0, "creation_date": 1447907304, "post_id": 33783351, "comment_id": 55357171, "body": "So I would open my file as a text file and then save it as an Excel workbook? I&#39;ll give it a shot, Thanks @Jeeped"}, {"owner": {"reputation": 109, "user_id": 4297499, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c949ca43c033099636373ae506e51b33?s=128&d=identicon&r=PG&f=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/4297499/geoff"}, "edited": false, "score": 0, "creation_date": 1447911663, "post_id": 33783351, "comment_id": 55358534, "body": "Tried Workbooks.OpenText method and it has the same outcome. Ill Post what i tried below."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447912812, "post_id": 33783351, "comment_id": 55359031, "body": "Maybe get some redacted portion of your XLSX or CSV sent to a public file upload area and return here to edit your post and include the link. The problem is originating in the quotes used to represent <i>inches</i> being mistaken as <i>text qualifiers</i>. Some hands-on testing might produce a solution but I&#39;m not retyping the data from your images (even if I could). The worse case scenario is that you will have to write your own export routine."}, {"owner": {"reputation": 109, "user_id": 4297499, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c949ca43c033099636373ae506e51b33?s=128&d=identicon&r=PG&f=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/4297499/geoff"}, "edited": false, "score": 0, "creation_date": 1447942341, "post_id": 33783351, "comment_id": 55377750, "body": "<a href=\"https://www.dropbox.com/s/hliglz1cq18k9dh/DOORS.csv?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/hliglz1cq18k9dh/DOORS.csv?dl=0</a>"}, {"owner": {"reputation": 109, "user_id": 4297499, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c949ca43c033099636373ae506e51b33?s=128&d=identicon&r=PG&f=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/4297499/geoff"}, "edited": false, "score": 0, "creation_date": 1447942500, "post_id": 33783351, "comment_id": 55377877, "body": "Hmm that&#39;s interesting that the quotes would do that. I would have never thought of that. See file in link above. @Jeeped"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447944505, "post_id": 33783351, "comment_id": 55379426, "body": "OK, the file already has problems. The <code>&quot;</code> used for <i>inches</i> increments have been doubled up as <code>&quot;&quot;</code>. This was likely due to bad interpretation of <i>text qualifies</i> somewhere between the origin or of the information and where it is now. While these problems are minor and could be repaired, it is band-aid post-processing of a problem that shouldn&#39;t be there to begin with. I&#39;ve reread your narrative and I cannot figure out what stage of the whole process this CSV is coming from. The problem should be dealt with at the origin of the information; not repaired somewhere down the road after ..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447944626, "post_id": 33783351, "comment_id": 55379535, "body": "... bad processing. Please detail step-by-step what you are trying to accomplish, including the origin or the information and any steps that require conversion to and from XLSX \u25c4-\u25ba CSV. Essentially, what do you start with, what do you have to do, and what are you trying to ultimately accomplish."}, {"owner": {"reputation": 109, "user_id": 4297499, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c949ca43c033099636373ae506e51b33?s=128&d=identicon&r=PG&f=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/4297499/geoff"}, "edited": false, "score": 0, "creation_date": 1447981910, "post_id": 33783351, "comment_id": 55400418, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/95634/discussion-between-geoff-and-jeeped\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 4297499, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c949ca43c033099636373ae506e51b33?s=128&d=identicon&r=PG&f=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/4297499/geoff"}, "is_accepted": false, "score": 0, "last_activity_date": 1447911839, "creation_date": 1447911839, "answer_id": 33796123, "question_id": 33783351, "link": "https://stackoverflow.com/questions/33783351/save-as-not-recognizing-delimiter/33796123#33796123", "title": "Save As not recognizing delimiter", "body": "<pre><code>Private Sub XLSMSAVEBTN_Click()\nDim myfile As Workbook\nApplication.DisplayAlerts = False\n\nWorkbooks.OpenText FileName:= _\n    \"C:\\Users\\Geoffrey\\Dropbox\\DCS PROGRAM\\FILES\\1. QUOTES\\3. PROGRAM FILES\\DOOR QT REQUESTS\\DOORS_COMBINED.grouped.csv\"\n\nSet myfile = ActiveWorkbook\n\nmyfile.SaveAs FileName:=\"C:\\Users\\Geoffrey\\Dropbox\\DCS PROGRAM\\FILES\\1.  QUOTES\\3. PROGRAM FILES\\DOOR QT REQUESTS\\DOORS_COMBINED.grouped.xlsx\", _\nFileFormat:=51, CreateBackup:=False, local:=True\n\nWorkbooks(\"DOORS_COMBINED.grouped.xlsx\").Close\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 4297499, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c949ca43c033099636373ae506e51b33?s=128&d=identicon&r=PG&f=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/4297499/geoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447911839, "creation_date": 1447858756, "last_edit_date": 1447860323, "question_id": 33783351, "link": "https://stackoverflow.com/questions/33783351/save-as-not-recognizing-delimiter", "title": "Save As not recognizing delimiter", "body": "<p>I had a similar problem before when saving to .csv except all the data would be moved to column A. This time it is spreading it out across the columns at every comma. My list separator is set to semicolon because my descriptions contain commas. The solution when saving as .csv was setting Local to True. The code I use below is to save a .csv file as a .xlsx, so I can perform operations on it like deleting empty rows between data. Tried doing that to the .csv file and it didn't work. First image below is the .csv and the second one is what happens when I save it as .xlsx.</p>\n\n<pre><code>Dim CSVFILE As Workbook\nApplication.DisplayAlerts = False\n\nSet CSVFILE = Workbooks.Open(\"C:DOORS_COMBINED.grouped.csv\") \n\n\nCSVFILE.SaveAs FileName:=\"C:DOORS_COMBINED.grouped.xlsx\", _\nFileFormat:=51, CreateBackup:=False, local:=True\n\n\n\nWorkbooks(\"DOORS_COMBINED.grouped.xlsx\").Close\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/cnkdo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cnkdo.png\" alt=\"(Before) .CSV File\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/isCVo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/isCVo.png\" alt=\"(After) .xlsx File\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447858226, "post_id": 33782930, "comment_id": 55332938, "body": "if I understand your question correctly, replace everything from <code>For Each sht ... </code> to  <code>... Next sht</code> with <code>Sheets(&quot;Data&quot;).Range(&quot;A1:B10&quot;).Replace ... and rest of the existing replace arguments</code>"}, {"owner": {"reputation": 904, "user_id": 4519709, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c6b1f82af788e90e52773d9007bae416?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/4519709/gonzalo"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447863291, "post_id": 33782930, "comment_id": 55336850, "body": "Thanks for the reply. I updated the code above - please have a look. But i get an error : subscript out of arrange. Can you check if something is wrong?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447863405, "post_id": 33782930, "comment_id": 55336930, "body": "you missed the last part of my comment. <code>... and rest of the existing replace arguments</code> (or maybe it wasn&#39;t clear). In other words, the replace statement you originally had there, add those same arguments to the replace statement I gave you against <code>Sheets(&quot;Data&quot;).Range(&quot;A1:B10&quot;)</code>"}, {"owner": {"reputation": 904, "user_id": 4519709, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c6b1f82af788e90e52773d9007bae416?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/4519709/gonzalo"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447863792, "post_id": 33782930, "comment_id": 55337186, "body": "I am getting lost.. sorry. Could you please edit my code above and suggest a answer? Many thanks"}], "answers": [{"comments": [{"owner": {"reputation": 904, "user_id": 4519709, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c6b1f82af788e90e52773d9007bae416?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/4519709/gonzalo"}, "edited": false, "score": 0, "creation_date": 1447865377, "post_id": 33785587, "comment_id": 55338322, "body": "Still gives me script out of range, I edit my first code for you to see what am I missing."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 904, "user_id": 4519709, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c6b1f82af788e90e52773d9007bae416?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/4519709/gonzalo"}, "edited": false, "score": 0, "creation_date": 1447865492, "post_id": 33785587, "comment_id": 55338414, "body": "see edit, I thought you originally wrote that the sheet name was &quot;Data&quot;. I changed it to &quot;DataMatch&quot;"}, {"owner": {"reputation": 904, "user_id": 4519709, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c6b1f82af788e90e52773d9007bae416?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/4519709/gonzalo"}, "edited": false, "score": 0, "creation_date": 1447865607, "post_id": 33785587, "comment_id": 55338500, "body": "DataMatch is the sheet with the Table1 (data to use in the replace); Data is the sheet I really want to use the command replace. Please see my updated code on top. Something is missing there right?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 904, "user_id": 4519709, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c6b1f82af788e90e52773d9007bae416?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/4519709/gonzalo"}, "edited": false, "score": 0, "creation_date": 1447865963, "post_id": 33785587, "comment_id": 55338757, "body": "how many columns in your table? can you post a screenshot of your table?"}, {"owner": {"reputation": 904, "user_id": 4519709, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c6b1f82af788e90e52773d9007bae416?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/4519709/gonzalo"}, "edited": false, "score": 0, "creation_date": 1447866728, "post_id": 33785587, "comment_id": 55339298, "body": "I added some prints to my question with sheet i want to change and the sheet which has the table1 . thanks again!"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 904, "user_id": 4519709, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c6b1f82af788e90e52773d9007bae416?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/4519709/gonzalo"}, "edited": false, "score": 0, "creation_date": 1447869067, "post_id": 33785587, "comment_id": 55340743, "body": "is <code>Table1</code> an actual Excel Table or is it a named range called <code>Table1</code>? I just tested the code on my end as if it was an actual Excel Table and it worked. The only suggestion I would make is to set <code>LookAt:=xlWhole</code>, so that it does not keep searching for parts of words after they are replaced."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1447866621, "last_edit_date": 1447866621, "creation_date": 1447864840, "answer_id": 33785587, "question_id": 33782930, "link": "https://stackoverflow.com/questions/33782930/replace-cells-of-a-specific-sheet-with-cells-based-on-a-table-in-other-sheet/33785587#33785587", "title": "replace cells of a specific sheet with cells based on a table in other sheet", "body": "<p>You just need to replace everything inside the myArray loop with the following code to only replace the information in the <code>Range(A1:B10)</code> in the <code>Data</code> worksheet</p>\n\n<pre><code> For x = LBound(myArray, 1) To UBound(myArray, 2)\n\n      Sheets(\"Data\").Range(\"A1:B10\").Replace What:=myArray(fndList, x), Replacement:=myArray(rplcList, x), _\n            LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n            SearchFormat:=False, ReplaceFormat:=False\n\n  Next \n</code></pre>\n"}], "owner": {"reputation": 904, "user_id": 4519709, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c6b1f82af788e90e52773d9007bae416?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/4519709/gonzalo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 33785587, "answer_count": 1, "score": 0, "last_activity_date": 1447866679, "creation_date": 1447857650, "last_edit_date": 1531161705, "question_id": 33782930, "link": "https://stackoverflow.com/questions/33782930/replace-cells-of-a-specific-sheet-with-cells-based-on-a-table-in-other-sheet", "title": "replace cells of a specific sheet with cells based on a table in other sheet", "body": "<p>How could I improve below code to replace cells based to a table named \"Table1\" (which is in sheet \"DataMatch\") but only replace in a specific sheet called \"data\" the cells A1:B10. Do not do anything for the other sheets. The code below is not working.</p>\n\n<pre><code>    Sub replacecells1()\n\n    Dim sht As Worksheet\nDim fndList As Integer\nDim rplcList As Integer\nDim tbl As ListObject\nDim myArray As Variant\n\n'Create variable to point to your table\n  Set tbl = Worksheets(\"DataMatch\").ListObjects(\"Table1\")\n\n'Create an Array out of the Table's Data\n  Set TempArray = tbl.DataBodyRange\n  myArray = Application.Transpose(TempArray)\n\n'Designate Columns for Find/Replace data\n  fndList = 1\n  rplcList = 2\n\n'Loop through each item in Array lists\nFor x = LBound(myArray, 1) To UBound(myArray, 2)\n\n      Sheets(\"Data\").Range(\"A1:B10\").Replace What:=myArray(fndList, x), Replacement:=myArray(rplcList, x), _\n            LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n            SearchFormat:=False, ReplaceFormat:=False\n\n  Next\n\nEnd Sub\n</code></pre>\n\n<p>My \"Data\" Sheet is (where the replace must happen):</p>\n\n<p><a href=\"https://i.stack.imgur.com/k6fJO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k6fJO.png\" alt=\"enter image description here\"></a></p>\n\n<p>My \"MatchData\" sheet (where have the table1)is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/37p6z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/37p6z.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vbscript", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447858394, "post_id": 33782825, "comment_id": 55333056, "body": "<i>The two files exist</i> - I may be reading this wrong, but if the MHT file already exists the <code>Workbook.SaveAs</code> will not overwrite it automatically. You will have to delete the existing MHT files before saving it again."}, {"owner": {"reputation": 1150, "user_id": 4872413, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/428bfe49a7ab1d0e8c95c95c5999b50b?s=128&d=identicon&r=PG&f=1", "display_name": "devopsfun", "link": "https://stackoverflow.com/users/4872413/devopsfun"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447859246, "post_id": 33782825, "comment_id": 55333674, "body": "You were right. The MHT file does not exist :D."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447859607, "post_id": 33782825, "comment_id": 55333962, "body": "just curious, what is the value of <code>MHT_Filename</code> when you try to save it?"}, {"owner": {"reputation": 1150, "user_id": 4872413, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/428bfe49a7ab1d0e8c95c95c5999b50b?s=128&d=identicon&r=PG&f=1", "display_name": "devopsfun", "link": "https://stackoverflow.com/users/4872413/devopsfun"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447860251, "post_id": 33782825, "comment_id": 55334472, "body": "@ScottHoltzman I edited the question with the output of the script when running."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447861365, "post_id": 33782825, "comment_id": 55335331, "body": "I just ran this with the exact script and arguments you provided and it worked smoothly. I have a few questions ... Is that the exact path you are using or is just a test path? Is there something in the file that would make it not be able to convert to HTML without some kind of compatibility warning (For example, what happens if you try it to save as an MHT file manually?)"}], "answers": [{"tags": [], "owner": {"reputation": 1150, "user_id": 4872413, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/428bfe49a7ab1d0e8c95c95c5999b50b?s=128&d=identicon&r=PG&f=1", "display_name": "devopsfun", "link": "https://stackoverflow.com/users/4872413/devopsfun"}, "is_accepted": true, "score": 0, "last_activity_date": 1448044314, "creation_date": 1448044314, "answer_id": 33833663, "question_id": 33782825, "link": "https://stackoverflow.com/questions/33782825/converting-from-xlsx-to-mht-error-microsoft-office-excel-saveas-method-of-work/33833663#33833663", "title": "Converting from xlsx to mht error: Microsoft Office Excel: SaveAs method of Workbook class failed", "body": "<p>I think I found the solution (for my case). I tried, like Scott Holtzman suggested, open that file in Excel manually and see what Excel does. Excel was not activated. I activated it. The error disappeared.</p>\n"}], "owner": {"reputation": 1150, "user_id": 4872413, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/428bfe49a7ab1d0e8c95c95c5999b50b?s=128&d=identicon&r=PG&f=1", "display_name": "devopsfun", "link": "https://stackoverflow.com/users/4872413/devopsfun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 701, "favorite_count": 0, "accepted_answer_id": 33833663, "answer_count": 1, "score": 0, "last_activity_date": 1448044314, "creation_date": 1447857409, "last_edit_date": 1531161705, "question_id": 33782825, "link": "https://stackoverflow.com/questions/33782825/converting-from-xlsx-to-mht-error-microsoft-office-excel-saveas-method-of-work", "title": "Converting from xlsx to mht error: Microsoft Office Excel: SaveAs method of Workbook class failed", "body": "<p>I have a VBScript which converts from xlsx to mht using Excel 2007. Here is the VBScript</p>\n\n<pre><code>' This script takes two parameters\n' $1: XLSX Filename (should be full path if possible, with ending)\n' $2: MHT Filename (should be full path if possible, with ending)\n\n' Constant definitions\nConst xlWebArchive = 45\n\n' Store the arguments in a variable:\nSet objArgs = Wscript.Arguments\nXLSX_Filename = Wscript.Arguments.Item(0)\nMHT_Filename = Wscript.Arguments.Item(1)\n\nWscript.Echo \"XLSX Filename: \" &amp; XLSX_Filename\nWscript.Echo \"MHT Filename: \" &amp; MHT_Filename\n\n' Create an instance of Excel and open the workbook...\nSet objExcel = CreateObject(\"Excel.Application\")\nobjExcel.Workbooks.Open XLSX_Filename\n\n' Save the workbook as an MHTML page...\nobjExcel.ActiveWorkbook.SaveAs MHT_Filename, xlWebArchive\n\n' Close Excel...\nobjExcel.Quit\n</code></pre>\n\n<p>But using that method, I am getting the error:</p>\n\n<pre><code>xlsx_to_mht.vbs(24, 1) Microsoft Office Excel: SaveAs method of Workbook class failed\n</code></pre>\n\n<p>which is the line</p>\n\n<pre><code>objExcel.ActiveWorkbook.SaveAs MHT_Filename, xlWebArchive\n</code></pre>\n\n<p>So why that error?</p>\n\n<p><strong>EDIT: Example output of the script</strong></p>\n\n<pre><code># converting from xlsx to mht\nMicrosoft (R) Windows Script Host Version 5.8\nCopyright (C) Microsoft Corporation. All rights reserved.\n\nXLSX Filename: C:\\path\\to\\project\\ThirdPartyLicense.xlsx\nMHT Filename: C:\\path\\to\\project\\ThirdPartyLicense.mht\nC:\\path\\to\\vbscript\\xlsx_to_mht_conv\\xlsx_to_mht.vbs(24, 1) Microsoft Office Excel: SaveAs method of Workbook class failed\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447858057, "post_id": 33782812, "comment_id": 55332812, "body": "it will help us if you edit your question to tell us which line the overload error occurs on."}, {"owner": {"reputation": 21, "user_id": 5577091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ba795545563b9573d702daaf0266c2?s=128&d=identicon&r=PG&f=1", "display_name": "htown", "link": "https://stackoverflow.com/users/5577091/htown"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447858377, "post_id": 33782812, "comment_id": 55333045, "body": "sorry it is the line that has &lt;-------- This is where error occurs"}, {"owner": {"reputation": 21, "user_id": 5577091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ba795545563b9573d702daaf0266c2?s=128&d=identicon&r=PG&f=1", "display_name": "htown", "link": "https://stackoverflow.com/users/5577091/htown"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447858381, "post_id": 33782812, "comment_id": 55333047, "body": "aiCum(iCol) = aiCnt(iCol) * aiCum(iCol + 1)"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1447871434, "post_id": 33782812, "comment_id": 55342087, "body": "How many rows and columns are you working with? If <code>rows^columns</code> &gt; 2^20 you run out of room."}], "owner": {"reputation": 21, "user_id": 5577091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ba795545563b9573d702daaf0266c2?s=128&d=identicon&r=PG&f=1", "display_name": "htown", "link": "https://stackoverflow.com/users/5577091/htown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1447880686, "creation_date": 1447857370, "last_edit_date": 1531164843, "question_id": 33782812, "link": "https://stackoverflow.com/questions/33782812/how-to-receive-all-combinations-of-all-columns", "title": "How to receive all combinations of all columns?", "body": "<p>I am trying to get all row combinations of all columns (say 8 columns).  The following vba macro can do that but I get an error that says data overload:</p>\n\n<pre><code>Option Explicit\n\nConst sTitle        As String = \"shg Cartesian Product\"\n\nSub CartesianProduct()\n\n' shg 2012, 2013\n' Choose one from col A, one from col B, ...\n\nDim rInp        As Range\nDim avInp       As Variant  ' ragged input list\nDim nCol        As Long     ' # columns in list\nDim rOut        As Range    ' output range\nDim iCol        As Long     ' column index\nDim iRow        As Long     ' row index\nDim aiCum()     As Long     ' cum count of arrangements from right to left\nDim aiCnt()     As Long     ' count of items in each column\nDim iArr        As Long     ' arrangement number\nDim avOut       As Variant  ' output buffer\n\nApplication.ScreenUpdating = False\n\nSet rInp = Range(\"rgnInp\")\nIf VarType(rInp.Value) = vbEmpty Then\n    MsgBox Prompt:=\"No input!\", _\n           Buttons:=vbOKOnly, _\n           Title:=sTitle\n    Exit Sub\nEnd If\n\nSet rInp = rInp.CurrentRegion\nIf rInp.Columns.Count &lt; 2 Or rInp.Rows.Count &lt; 2 Then\n    MsgBox Prompt:=\"Must have more than one row and more than one columns!\", _\n           Buttons:=vbOKOnly, _\n           Title:=sTitle\n    Exit Sub\nEnd If\n\nWith rInp\n    .Style = \"Input\"\n    avInp = .Value\n    nCol = .Columns.Count\n    Set rOut = .Resize(1).Offset(.Rows.Count + 1)\n    Range(rOut.Offset(-1, -1), Cells(Rows.Count, Columns.Count)).Clear\nEnd With\n\nReDim aiCum(1 To nCol + 1)\nReDim aiCnt(1 To nCol)\naiCum(nCol + 1) = 1\n\nFor iCol = nCol To 1 Step -1\n    For iRow = 1 To UBound(avInp, 1)\n        If IsEmpty(avInp(iRow, iCol)) Then Exit For\n        aiCnt(iCol) = aiCnt(iCol) + 1\n    Next iRow\n\n    aiCum(iCol) = aiCnt(iCol) * aiCum(iCol + 1)   &lt;------ This is where it says error is\nNext iCol\n\nIf aiCum(1) &gt; Rows.Count - rOut.Row + 1 Then\n    MsgBox Prompt:=Format(aiCum(1), \"#,##0\") &amp; _\n                   \" is too many rows!\", _\n           Buttons:=vbOKOnly, Title:=sTitle\n    Exit Sub\nEnd If\n\nReDim avOut(1 To aiCum(1), 1 To nCol)\nFor iArr = 1 To aiCum(1)\n    For iCol = 1 To nCol\n        avOut(iArr, iCol) = avInp((Int((iArr - 1) * aiCnt(iCol) / aiCum(iCol))) Mod aiCnt(iCol) + 1, iCol)\n    Next iCol\nNext iArr\n\nWith rOut.Resize(aiCum(1), nCol)\n    .NumberFormat = \"@\"\n    .Value = avOut\n    .Style = \"Code\"\n    .Cells(1, 0).Value = 1\n    .Cells(2, 0).Value = 2\n    .Cells(1, 0).Resize(2).AutoFill .Columns(0)\nEnd With\n\nActiveWindow.FreezePanes = False\nrOut.EntireColumn.AutoFit\nActiveSheet.UsedRange\nBeep\nEnd Sub\n</code></pre>\n\n<p>Is there away to adjust for this? I also want it to not bring back the same values for a row. So lets say that two columns had the exact same data. If column A has lets say Ice cream, cake, and cookies and so does Column B, I don't want Row 1 to have cookies in column B if it is already picked in Column A.</p>\n"}, {"tags": ["arrays", "vba"], "comments": [{"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1447855163, "post_id": 33781917, "comment_id": 55330461, "body": "Is this in Access? I cant get the code to work in Excel (no <code>Application.Match</code>)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1447855176, "post_id": 33781917, "comment_id": 55330477, "body": "For extra clarity, could you paste up the code in the not-working state?"}, {"owner": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "edited": false, "score": 0, "creation_date": 1447855315, "post_id": 33781917, "comment_id": 55330587, "body": "This is in the VBA environment in Excel 2010."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1447855474, "post_id": 33781917, "comment_id": 55330703, "body": "I think that <code>match</code> is expecting a 2-D array (which is how ranges are represented) and doesn&#39;t know how to handle a pointer to a 1-D array. The underlying C/C++ code must be trying to treat it as a 2-D array (just a guess)."}, {"owner": {"reputation": 361, "user_id": 4406125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d283087551dc05b73a84f9efdd24e43b?s=128&d=identicon&r=PG&f=1", "display_name": "area9", "link": "https://stackoverflow.com/users/4406125/area9"}, "edited": false, "score": 0, "creation_date": 1447856298, "post_id": 33781917, "comment_id": 55331389, "body": "Would you not need to loop through the array to check for a match?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1447856498, "post_id": 33781917, "comment_id": 55331548, "body": "@JohnColeman you can use a single dimension array with <code>Match</code> - for example <code>Application.Match(3, Array(2, 3, 4), 0)</code> will work"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1447858342, "post_id": 33781917, "comment_id": 55333021, "body": "@MacroMan Well -- it seems my guess was false! I had never used <code>Match</code> on anything other than a range."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1447858421, "post_id": 33781917, "comment_id": 55333074, "body": "@JohnColeman your theory is correct - when used as a worksheet function there must be some conversion as a column would return a 2-D array. But unfortunately as there is no view-able source code we will never know!"}], "answers": [{"comments": [{"owner": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "edited": false, "score": 0, "creation_date": 1447856272, "post_id": 33782375, "comment_id": 55331363, "body": "Could you please elaborate why this solves the problem, and why it occures? Is @John Coleman right?"}, {"owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "reply_to_user": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "edited": false, "score": 1, "creation_date": 1447856487, "post_id": 33782375, "comment_id": 55331541, "body": "@Holene No, he&#39;s not right, since as you said, the function works properly for second item if there are three items in your array - that means it accepts 1D arrays. I edited my answer to explain it. If you try the same function in Excel worksheet it will give you the same error for third item."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "edited": false, "score": 0, "creation_date": 1447856567, "post_id": 33782375, "comment_id": 55331612, "body": "@Holene - For both <a href=\"https://support.office.com/en-us/article/vlookup-function-adceda66-30de-4f26-923b-7257939faa65\" rel=\"nofollow noreferrer\">VLOOKUP</a> and <a href=\"https://support.office.com/en-us/article/match-function-0600e189-9f3c-4e4f-98c1-943a0eb427ca\" rel=\"nofollow noreferrer\">MATCH</a> the data must be sorted if anything but <b>0</b> or FALSE is specified. For MATCH this could be ascending or descending depending upon whether <b>-1</b> or <b>1</b> is specified for the <i>range_lookup</i> parameter."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1447856837, "post_id": 33782375, "comment_id": 55331811, "body": "Note that since <code>Application.Match</code> <i>can</i> return an error type, OP may want to do some error-handling in case the match isn&#39;t found.  But otherwise, good answer + explanation!!"}, {"owner": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "edited": false, "score": 0, "creation_date": 1447856944, "post_id": 33782375, "comment_id": 55331889, "body": "@Jeeped So if I understand you guys correctly, it&#39;s a little random that my code doesn&#39;t work properly? Using <code>myArray=[6, 7, 8]</code> and searching for 8 works as the array now is populated by strictly increasing values. Thanks!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "edited": false, "score": 2, "creation_date": 1447857460, "post_id": 33782375, "comment_id": 55332289, "body": "@Holene - Strictly speaking, if the values were in ascending order then it should work reliably without the <b>0</b> parameter. However, since that was not intentional there is no guarantee that the ascending order would be maintained so any correct result can only be considered coincidental."}], "tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 2, "last_activity_date": 1447856387, "last_edit_date": 1447856387, "creation_date": 1447856141, "answer_id": 33782375, "question_id": 33781917, "link": "https://stackoverflow.com/questions/33781917/index-of-last-element-in-array-vba-using-application-match/33782375#33782375", "title": "Index of last element in array VBA using Application.Match", "body": "<p>Give 0 as optional parameter <code>match_type</code>:</p>\n\n<pre><code>Index = Application.Match(test, myArray, 0)\n</code></pre>\n\n<p>It causes that the function will return the exact match. </p>\n\n<p>According to the Excel help, if this parameter is omitted, by default <code>match_type = 1</code> is used. </p>\n\n<p>In that case\n\"MATCH finds the largest value that is less than or equal to lookup_value. The values in the lookup_array argument must be placed in ascending order, for example: ...-2, -1, 0, 1, 2, ..., A-Z, FALSE, TRUE.\"</p>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 2, "last_activity_date": 1447858353, "creation_date": 1447858353, "answer_id": 33783200, "question_id": 33781917, "link": "https://stackoverflow.com/questions/33781917/index-of-last-element-in-array-vba-using-application-match/33783200#33783200", "title": "Index of last element in array VBA using Application.Match", "body": "<p>You need to specify an exact match type, as the strings are not compared as actual text:</p>\n\n<hr>\n\n<p><strong><em>Example 1: No argument supplied</em></strong></p>\n\n<pre><code>Sub MM()\n\nDim myArray As Variant\n\nmyArray = Array(\"test\", \"best\", \"rest\")\n\nIndex = Application.Match(\"test\", myArray)\nDebug.Print Index    '// Prints \"3\"\n\nIndex = Application.Match(\"rest\", myArray)\nDebug.Print Index    '// Also prints \"3\"\n\nEnd Sub\n</code></pre>\n\n<p>The default match type argument is <strong>1</strong> - <em>Less Than</em> which appears to implicilty evalute each item on it's code value rather than it's text value - even when <code>Option Compare</code> statements are used. For this reason it is always advised to use these type of function with data that has already been sorted.</p>\n\n<p>This <em>kind of</em> makes sense as there has to be a numerical value derived at <em>some</em> level in order for a 'less than' comparison to occur.</p>\n\n<hr>\n\n<p><strong><em>Example 2: Match Argument Supplied</em></strong></p>\n\n<pre><code>Sub MM()\n\nDim myArray As Variant\n\nmyArray = Array(\"test\", \"best\", \"rest\")\n\nIndex = Application.Match(\"test\", myArray, 0)\nDebug.Print Index    '// Prints \"1\"\n\nIndex = Application.Match(\"rest\", myArray, 0)\nDebug.Print Index    '// Prints \"3\"\n\nEnd Sub\n</code></pre>\n\n<p>As you can see - this gives the <em>expected</em> output. We have supplied the match argument <strong>0</strong> - <em>Exact Match</em> which when supplied with a <strong>valid</strong> lookup value will return the correct index whether comparing on a binary <em>or</em> text basis because the values are identical.</p>\n"}], "owner": {"reputation": 543, "user_id": 1324681, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Owe3c.png?s=128&g=1", "display_name": "Holene", "link": "https://stackoverflow.com/users/1324681/holene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2015, "favorite_count": 0, "accepted_answer_id": 33782375, "answer_count": 2, "score": 2, "last_activity_date": 1447858353, "creation_date": 1447854924, "last_edit_date": 1447857034, "question_id": 33781917, "link": "https://stackoverflow.com/questions/33781917/index-of-last-element-in-array-vba-using-application-match", "title": "Index of last element in array VBA using Application.Match", "body": "<p>Consider the following piece of VBA code, which generates an array with only two elements, searching for the latter of the two elements. The two commented lines will add a third entry to the array. This produces the output</p>\n\n<blockquote>\n  <p>Error 2042</p>\n</blockquote>\n\n<p>in the Immediate window. If I change the script to a three element array, and try to <code>Match</code> the second element, I get the proper index in return. If I, however, search for the last element, I get the same error. </p>\n\n<p>Why is this happening?</p>\n\n<p>Working MWE</p>\n\n<pre><code>Sub testArray()\nDim myArray() As Variant\n' ReDim myArray(1 To 2)\nReDim myArray(1 To 3)\nmyArray(1) = \"Trondheim\"\nmyArray(2) = \"Levanger\"\nmyArray(3) = \"Dummy\"\n\nDim Index As Variant\nDim test As Variant\n\ntest = \"Levanger\"\nIndex = Application.Match(test, myArray)\nDebug.Print Index\nEnd Sub\n</code></pre>\n\n<p>Minimal non-working example</p>\n\n<pre><code>Sub testArray()\nDim myArray() As Variant\n' ReDim myArray(1 To 2)\nReDim myArray(1 To 3)\nmyArray(1) = \"Trondheim\"\nmyArray(2) = \"Levanger\"\nmyArray(3) = \"Dummy\"\n\nDim Index As Variant\nDim test As Variant\n\n'test = \"Levanger\"\ntest = \"Dummy\"\nIndex = Application.Match(test, myArray)\nDebug.Print Index\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "batch-file", "ms-access", "taskkill"], "comments": [{"owner": {"reputation": 11858, "user_id": 1417694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adedbee0609fe9349993fedfd446acdc?s=128&d=identicon&r=PG", "display_name": "Squashman", "link": "https://stackoverflow.com/users/1417694/squashman"}, "edited": false, "score": 2, "creation_date": 1447854768, "post_id": 33781749, "comment_id": 55330113, "body": "Read the help for the TASKKILL command.  You are not using the <code>&#47;FI</code> option correctly. You are confusing it with the syntax for the TASKLIST command. You do not need /FI"}, {"owner": {"reputation": 431, "user_id": 3919505, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e9f009ef47476c5d4706cdb2aa2a36d9?s=128&d=identicon&r=PG&f=1", "display_name": "TMY", "link": "https://stackoverflow.com/users/3919505/tmy"}, "reply_to_user": {"reputation": 11858, "user_id": 1417694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adedbee0609fe9349993fedfd446acdc?s=128&d=identicon&r=PG", "display_name": "Squashman", "link": "https://stackoverflow.com/users/1417694/squashman"}, "edited": false, "score": 0, "creation_date": 1447860230, "post_id": 33781749, "comment_id": 55334451, "body": "@Squashman - thanks for the extra set of eyes. Removing /fi worked and the process successfully killed. Unfortunately I&#39;m still getting part of my original issue, which is &quot;the process cannot access the file because it is being used by another process&quot;. -- Hopefully by using your response coupled with the answer from Andre451 of sleeping the batch, I will be able to get this completed.  Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 431, "user_id": 3919505, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e9f009ef47476c5d4706cdb2aa2a36d9?s=128&d=identicon&r=PG&f=1", "display_name": "TMY", "link": "https://stackoverflow.com/users/3919505/tmy"}, "edited": false, "score": 0, "creation_date": 1447859883, "post_id": 33782644, "comment_id": 55334186, "body": "Ahh nice!  I already tired that as well, but without the sleep.  I&#39;ll give this a try and mark as correct if it works."}, {"owner": {"reputation": 431, "user_id": 3919505, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e9f009ef47476c5d4706cdb2aa2a36d9?s=128&d=identicon&r=PG&f=1", "display_name": "TMY", "link": "https://stackoverflow.com/users/3919505/tmy"}, "edited": false, "score": 0, "creation_date": 1447861144, "post_id": 33782644, "comment_id": 55335156, "body": "I ended up using TIMEOUT rather than sleep.exe, but works perfect.  Thanks!"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1447856938, "creation_date": 1447856938, "answer_id": 33782644, "question_id": 33781749, "link": "https://stackoverflow.com/questions/33781749/issues-with-batch-taskkill-of-parent-msaccess-process/33782644#33782644", "title": "Issues with Batch Taskkill of Parent MSAccess Process", "body": "<p>I have a similar setup, but without TASKKILL.</p>\n\n<p>Directly after launching my update batch, I do <code>Application.Quit</code></p>\n\n<pre><code>' If need to update\nShell UPDATE_BATCH, vbNormalFocus\nApplication.Quit\n</code></pre>\n\n<p>And in the update batch, I wait for 3 seconds so that Access has enough time to exit (and release the lock on the frontend).</p>\n\n<pre><code>sleep.exe 3\nREM ... copy new frontend ...\nsleep.exe 1\nREM ... start MSACCESS command line ...\n</code></pre>\n\n<p>How to \"sleep\"? See here: <a href=\"http://ss64.com/nt/sleep.html\" rel=\"nofollow\">SLEEP.exe (2003 Resource Kit)</a> for different variants.</p>\n"}], "owner": {"reputation": 431, "user_id": 3919505, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e9f009ef47476c5d4706cdb2aa2a36d9?s=128&d=identicon&r=PG&f=1", "display_name": "TMY", "link": "https://stackoverflow.com/users/3919505/tmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "accepted_answer_id": 33782644, "answer_count": 1, "score": 2, "last_activity_date": 1611817188, "creation_date": 1447854490, "question_id": 33781749, "link": "https://stackoverflow.com/questions/33781749/issues-with-batch-taskkill-of-parent-msaccess-process", "title": "Issues with Batch Taskkill of Parent MSAccess Process", "body": "<p><strong>Process Tree:</strong></p>\n\n<p>I have an MS Access version control macro that checks users current file version on open, and if not up-to-date, the macro launches a batch file that 1) <em>should</em> delete their current file, and then 2) copies the up-to-date front-end version from the network and pastes it on their local system.</p>\n\n<p><strong>My issue:</strong></p>\n\n<p>Everything works EXCEPT for the deletion of the users original file.  Since this file is the parent process of the batch file I haven't found a way to Kill the task so it can be deleted.</p>\n\n<p><strong>Current Code:</strong></p>\n\n<pre><code>TASKKILL /F /fi /IM MSACCESS.EXE /T\n\ndel \"%originalFile%\"\n</code></pre>\n\n<p>**I thought maybe I was having issues because the batch was a child of the Access process, so I've also tried with no luck:</p>\n\n<pre><code>TASKKILL /F /fi /IM MSACCESS.EXE\n</code></pre>\n\n<p>I always get the error:</p>\n\n<blockquote>\n  <p>ERROR: Invalid syntax. Value expected for '/fi'.</p>\n</blockquote>\n\n<p>Its been a long day, so I assume I'm missing something simple and would love an extra set of eyes.  Any help would be greatly appreciated!</p>\n"}, {"tags": ["excel", "vba", "hyperlink"], "comments": [{"owner": {"reputation": 105, "user_id": 5424994, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ac765563fd1868d4e5831a420f198fd?s=128&d=identicon&r=PG&f=1", "display_name": "RBS", "link": "https://stackoverflow.com/users/5424994/rbs"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1447852972, "post_id": 33781112, "comment_id": 55328712, "body": "It is.. strange that I didn&#39;t find it while Googling for &#39;Excel hyperlink formula&#39;... Thanks!"}, {"owner": {"reputation": 105, "user_id": 5424994, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ac765563fd1868d4e5831a420f198fd?s=128&d=identicon&r=PG&f=1", "display_name": "RBS", "link": "https://stackoverflow.com/users/5424994/rbs"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1447859209, "post_id": 33781112, "comment_id": 55333641, "body": "As it turns out, <code>=HYPERLINK()</code> is not good enough, please see the edit in the original question."}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 1, "last_activity_date": 1448654240, "creation_date": 1448654240, "answer_id": 33964108, "question_id": 33781112, "link": "https://stackoverflow.com/questions/33781112/create-hyperlinks-in-column-to-address-in-other-column/33964108#33964108", "title": "Create hyperlinks in column to address in other column", "body": "<p>Try Hyperlinks.Add <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822490.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff822490.aspx</a></p>\n\n<p>Say cell f5 contains <a href=\"http://stackoverflow.com\">http://stackoverflow.com</a> as text. The code converts it to a link that displays the original text in e5.</p>\n\n<pre><code>Sub ConvertToHyperlink()\nWith Worksheets(1)\n .Hyperlinks.Add Anchor:=.Range(\"e5\"), _\n Address:=.Range(\"f5\"), _\n ScreenTip:=\"test web site\"\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 5424994, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ac765563fd1868d4e5831a420f198fd?s=128&d=identicon&r=PG&f=1", "display_name": "RBS", "link": "https://stackoverflow.com/users/5424994/rbs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1448750064, "creation_date": 1447852571, "last_edit_date": 1448750064, "question_id": 33781112, "link": "https://stackoverflow.com/questions/33781112/create-hyperlinks-in-column-to-address-in-other-column", "title": "Create hyperlinks in column to address in other column", "body": "<p>Is it possible to (perhaps with a hotkey) change the text in a cell in column <code>E</code> into a hyperlink to a website that is listed in column <code>F</code>. </p>\n\n<p>I think that is the easiest way to create these links, and to update them if needed.</p>\n\n<p>Edit: It turns out that the HYPERLINK function isn't good enough. I need to export the excel file to a .pdf, but using the HYPERLINK function results in a .pdf file without working hyperlinks. The cause seems to be the .pdf conversion first resolves all Excel formulas before converting it into a .pdf file. Therefore, the only way to create working links is to have the text in a cell become a hyperlink by doing it manually. Is it possible for a macro to do this automatically, without using the HYPERLINK function?</p>\n"}, {"tags": ["excel", "loops", "vba"], "comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447856242, "post_id": 33780855, "comment_id": 55331343, "body": "1) where is located your Pivot Table? 2) When you copy columns <code>A:A,C:D</code> It&#39;s your intention to copy only records from the Pivot Table? 3) Would it be ok to copy only values? As you have seen in the answers already provided there are several improvements to be done to your code, however there may be others that has not been mentioned due to the lack of info. Would you post a picture of your PivotTable and the data to be copy if not within the pivot table and one of the sheets after the copy just a reasonable size so we can see expected output."}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447856515, "post_id": 33780855, "comment_id": 55331566, "body": "1) the pivot is in the same workbook. 2) i changed the selection    Range(&quot;A1:A118,C1:D118&quot;).Select"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447856635, "post_id": 33780855, "comment_id": 55331665, "body": "as you might can tell this is my first time posting ;)"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447857472, "post_id": 33780855, "comment_id": 55332303, "body": "1) I referred to the address of the PT so I guess starts at <code>A1</code> 2) so you are copying data from the PT only 3) what about copying only values (not formatting)?"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447858486, "post_id": 33780855, "comment_id": 55333118, "body": "@EEM 1 and 2 are corect. ive added formating in column D (shows values &lt;=0) that needs to be moved."}, {"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 0, "creation_date": 1447860015, "post_id": 33780855, "comment_id": 55334282, "body": "for my understanding ... shouldn&#39;t the last statement before <code>Loop</code> read <code>Store</code> instead of <code>butikk</code>?"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447862751, "post_id": 33780855, "comment_id": 55336456, "body": "Its just me forgetting to change that value before posting"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447865754, "post_id": 33780855, "comment_id": 55338602, "body": "what is copied in cell <code>A2</code> is same as the value of the scope variable?"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447874113, "post_id": 33780855, "comment_id": 55343769, "body": "nothing is copied from <code>A2</code> that only sets the active cell"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447874674, "post_id": 33780855, "comment_id": 55344124, "body": "well not really... if you look at this line <code>ActiveSheet.Name = Range(&quot;A2&quot;).Value</code> you are using whatever was copied into cell <code>A2</code> of the new sheet (when the range <code>A:A,C:D</code> was copied) to name the new sheet... that&#39;s is my question what it&#39;s there it&#39;s same as the value of <code>store</code>?"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447875030, "post_id": 33780855, "comment_id": 55344353, "body": "Aah I see now as I tried it once more. The <code>A2</code>is a &quot;hidden&quot; cell with a formula that looks after the name of the store. If that ain a store, its a fault witch sets of another cell. With the new macro you made these &quot;help&quot;cells now show, that&#39;s a thing I need to work out how to hide"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447875229, "post_id": 33780855, "comment_id": 55344466, "body": "so the cell hidden using formatting, do you want to retain the formula? once again question number 3 that you did not answer?"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447875415, "post_id": 33780855, "comment_id": 55344585, "body": "I might not been to clear in my answer but I mentioned that I had formatting in column D that needs to be moved. There are no formulas that needs to be moved over no. Again, thx for your patience&#39;s. This just opened a new door after a few years in the shadows"}], "answers": [{"comments": [{"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447855841, "post_id": 33781232, "comment_id": 55330999, "body": "exactly where in the macro should this be posted. Same as the other, this is New to me, the way i can use this"}], "tags": [], "owner": {"reputation": 361, "user_id": 4406125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d283087551dc05b73a84f9efdd24e43b?s=128&d=identicon&r=PG&f=1", "display_name": "area9", "link": "https://stackoverflow.com/users/4406125/area9"}, "is_accepted": false, "score": 2, "last_activity_date": 1447853313, "last_edit_date": 1447853313, "creation_date": 1447852949, "answer_id": 33781232, "question_id": 33780855, "link": "https://stackoverflow.com/questions/33780855/create-faster-loop/33781232#33781232", "title": "Create faster loop", "body": "<p>Before altering the pivot table, stop the calculations with:</p>\n\n<pre><code>ActiveSheet.PivotTables(\"Pivottabell1\").ManualUpdate = True\n</code></pre>\n\n<p>After the changes, resume the calculations with:</p>\n\n<pre><code>ActiveSheet.PivotTables(\"Pivottabell1\").ManualUpdate = False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447855524, "post_id": 33781299, "comment_id": 55330746, "body": "suggest to use <code>Set PT = Sheets(&quot;salescube&quot;).PivotTables(&quot;Pivottabell1&quot;)</code> instead of <code>ActiveSheet.PivotTables(&quot;Pivottabell1&quot;)</code> &quot;avoid select&quot;"}, {"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447855643, "post_id": 33781299, "comment_id": 55330837, "body": "of course ... I was about to update this - done ... thanks for that"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447855764, "post_id": 33781299, "comment_id": 55330933, "body": "can i bother you With a bigger example. This is a bit New to me, the way you explain it ;)"}, {"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 0, "creation_date": 1447855858, "post_id": 33781299, "comment_id": 55331014, "body": "sure &amp; with pleasure ... allow +/- 1 hour"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447858677, "post_id": 33781299, "comment_id": 55333255, "body": "theres a flaw (or something im missing) but it wont Select active cell after first round"}], "tags": [], "owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "is_accepted": false, "score": 2, "last_activity_date": 1447868229, "last_edit_date": 1447868229, "creation_date": 1447853171, "answer_id": 33781299, "question_id": 33780855, "link": "https://stackoverflow.com/questions/33780855/create-faster-loop/33781299#33781299", "title": "Create faster loop", "body": "<p>generic hints: work with objects and avoid <code>.Select</code></p>\n\n<p>example: instead of</p>\n\n<pre><code>Sheets(\"Stores\").Select\nRange(\"A2\").Select\nStore= ActiveCell.Value\n</code></pre>\n\n<p>use</p>\n\n<pre><code>Store = Sheets(\"Stores\").[A2]\n</code></pre>\n\n<p>(or <code>Sheets(\"Stores\").Range(\"A2\")</code> if you don't like the square brackets notation ... and yes we know that this is hardcoding and you may want to make some extra thoughts on how to avoid that as well ...)</p>\n\n<p>instead of</p>\n\n<pre><code>Sheets(\"salescube\").Select\nActiveSheet.PivotTables(\"Pivottabell1\").PivotFields( _\n    \"[DimGeography].[Location].[Country]\").VisibleItemsList = Array(\"\")\n</code></pre>\n\n<p>use</p>\n\n<pre><code>Dim PT As PivotTable\n    ' ...\n    Set PT = Sheets(\"salescube\").PivotTables(\"Pivottabell1\")\n    ' ... Do While\n        PT.PivotFields(\"...\").VisibleItemsList = \"...\"\n    ' ... Loop\n</code></pre>\n\n<p>same for the Copy/paste ... and you may eliminate the <code>ScreenUpdating</code> alltogether.</p>\n\n<hr>\n\n<p><strong>Details:</strong></p>\n\n<pre><code>Sub GetStores()\nDim StoreIndex As Integer\nDim StoreRange As Range\nDim PT As PivotTable\nDim NewSheet As Worksheet\n\n    ' prepare range and index for stores\n    Set StoreRange = Sheets(\"Stores\").[A2]\n    StoreIndex = 1\n\n    ' starting from here you can access all stores using StoreRange(StoreIndex, 1)\n\n    ' prepare Pivot Table object\n    Set PT = Sheets(\"SalesCube\").PivotTables(\"PivotTabell1\")\n\n\n    Do While StoreRange(StoreIndex, 1) &lt;&gt; \"\"\n        ' can't run this without having precise design of PT\n        ' however at the end we have pivot filtered by current store\n\n        ' PT.PivotFields( _\n            \"[DimGeography].[Location].[Country]\").VisibleItemsList = Array(\"\")\n        ' PT.PivotFields( _\n            \"[DimGeography].[Location].[Region]\").VisibleItemsList = Array(\"\")\n        ' PT .PivotFields( _\n            \"[DimGeography].[Location].[SalesChannel]\").VisibleItemsList = Array( _\n            \"[DimGeography].[Location].[SalesChannel].&amp;[\" &amp; StoreRange(StoreIndex, 1) &amp; \"]\")\n\n        ' create new sheet object and give it the name of current store\n        Set NewSheet = Sheets.Add(, Sheets(Sheets.Count))\n        NewSheet.Name = StoreRange(StoreIndex, 1)\n\n        ' copy to new sheet PT in current filter mode by intersecting PT with \"A:A,C:D\"\n        ' note: Application.Intersect(range1, range2) returns a range\n        Application.Intersect(PT.RowRange.CurrentRegion, PT.Parent.Range(\"A:A,C:D\")).Copy NewSheet.[A1]\n\n        ' increment loop counter\n        StoreIndex = StoreIndex + 1\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447854343, "post_id": 33781580, "comment_id": 55329768, "body": "forgot to change butikk when posting."}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447856266, "post_id": 33781580, "comment_id": 55331357, "body": "the &quot;.&quot; needs to be there, else a error is generated, but the function was a. The Copy-part was a great ad tho i only used     &#39;Range(&quot;A1:A118&quot;).Select&#39;"}], "tags": [], "owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "is_accepted": false, "score": 0, "last_activity_date": 1447853961, "creation_date": 1447853961, "answer_id": 33781580, "question_id": 33780855, "link": "https://stackoverflow.com/questions/33780855/create-faster-loop/33781580#33781580", "title": "Create faster loop", "body": "<p><code>butikk = ActiveCell.Value</code> needs to be <code>store = ActiveCell.Value</code>; otherwise you recalculate the same values again and again.<br>\n<code>\"[DimGeography].[Location].[SalesChannel].&amp;[\" &amp; store &amp; \"]\")</code> - I think there should be no \"&amp;\" after the last dot.<br>\nWhat really takes time is that you copy whole columns <code>A:A</code> and <code>C:D</code>. You should find the last used row and copy from row 1 to that last row only. You can use this to get the last row number:  </p>\n\n<pre><code>Public Function lastrow(Optional aSheet As Worksheet) As Long\n    If aSheet Is Nothing Then Set aSheet = ActiveSheet\n    lastrow = aSheet.Cells.Find(\"*\", SearchOrder:=xlByRows, _\n        SearchDirection:=xlPrevious).Row\nEnd Function\n</code></pre>\n\n<p>and then use <code>range(cells(1,1),cells(lastrow(),1)</code> and <code>range(cells(1,3),cells(lastrow(),4)</code> instead.<br>\nAs you are working on several sheets qualify ranges and <code>cells</code> with the appropriate sheet name to avoid mistakes.</p>\n"}, {"comments": [{"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447874125, "post_id": 33786329, "comment_id": 55343774, "body": "Impressive @EEM. Thats a brand new way for me to write codes. Gonna learn alot from this post."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447874432, "post_id": 33786329, "comment_id": 55343965, "body": "That&#39;s the idea to encourage you to continue working and developing your programming skills..."}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447874451, "post_id": 33786329, "comment_id": 55343974, "body": "Two things i Wonder: 1) i need to get the columns to     <code>Columns(&quot;A:C&quot;).EntireColumn.AutoFit</code> I can see where i should put it, but i dont wanna mess up your work. 2) the column C that&#39;s copied is % and that&#39;s lost during <code>copy&#47;paste</code>-parte"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447874695, "post_id": 33786329, "comment_id": 55344143, "body": "Ive already tried it on a few sheets where I got columns with regions and stores that needs to be put in sheets, so I just changed <code>[SalesChannel]</code>to <code>[region]</code>. Not sure if its much faster, but its wait cooler ;)"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447875259, "post_id": 33786329, "comment_id": 55344487, "body": "1) will add that to the code 2)That was the reason of my question number 3) about copying values only (no formatting)... It will be help a lot to see a picture of the pivot table."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447875386, "post_id": 33786329, "comment_id": 55344565, "body": "Can&#39;t tell you about the changed [SalesChannel]to [region] as I don&#39;t have a visual on the pivot table but try and measure the timing."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447875485, "post_id": 33786329, "comment_id": 55344626, "body": "so please answer pending question because that will imply some changes to the code."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447875663, "post_id": 33786329, "comment_id": 55344737, "body": "Ok i&#39;ll do some small changes to the code and let know you know hen ready so you can try again.. about the [SalesChannel] to [region] what columns are they?"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447876018, "post_id": 33786329, "comment_id": 55344951, "body": "the regeion/saleschannel are listed in the same sheets <code>stores</code> where stores are in column A and region in C. But I just use the same macro you created and do the changes and <code>Call</code> when regions needs to get up there"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447878616, "post_id": 33786329, "comment_id": 55346556, "body": "@amazing. ive been reading your links the last few hours. going to lots by the looks of things. thx for your help an patience with my first post."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447878671, "post_id": 33786329, "comment_id": 55346583, "body": "Changes done, now keeps the original format of the <code>A2</code> and the % in columns <code>C</code>"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447878809, "post_id": 33786329, "comment_id": 55346669, "body": "No problem... as I said the idea is that you feel part of the community and are encourage to work on your skills, we are always here to help you on that. Glad to be of service. If you are satisfy with the answer then acknowledge it and help us to keep the site updated..."}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447879108, "post_id": 33786329, "comment_id": 55346813, "body": "With my first day here im sure that I will be in here regularly and I will help with what I can, not sure how yet, but I guess that it will come with time."}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1447880542, "post_id": 33786329, "comment_id": 55347614, "body": "I sorry to bother you with one more question. I get the formats but I loose the hyperlink that&#39;s in <code>C3</code> (see picture in my initial post) and the columns doesn&#39;t <code>autofit</code>"}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1447878283, "last_edit_date": 1447878283, "creation_date": 1447867129, "answer_id": 33786329, "question_id": 33780855, "link": "https://stackoverflow.com/questions/33780855/create-faster-loop/33786329#33786329", "title": "Create faster loop", "body": "<p>This procedure includes some validations missing in your original code:</p>\n\n<ul>\n<li>Highlights the store value in worksheet <code>Stores</code> if fails the pivot table filter</li>\n<li>Deletes the worksheet to copy the selected data if already exist</li>\n<li>Avoids the use of the clipboard - optional (it also includes the option to use the clipboard as we need to copy the format of the original cells)</li>\n<li>Improves performance by disabling some application properties</li>\n<li>refresh the pivot table before proceeding with the filters</li>\n<li>use the pivottable properties to determine the range to be copied </li>\n</ul>\n\n<p>Suggest to read these pages for deeper understanding of the resources used in the procedure</p>\n\n<p><a href=\"http://www.excelfunctions.net/VBA-Variables-And-Constants.html\" rel=\"nofollow\">Variables &amp; Constants</a>, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194565.aspx\" rel=\"nofollow\">Application Object (Excel)</a>, <a href=\"http://www.excelfunctions.net/Excel-Objects.html\" rel=\"nofollow\">Excel Objects</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264723.aspx\" rel=\"nofollow\">With Statement</a>, <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg251648.aspx\" rel=\"nofollow\">GoSub...Return Statement</a>, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range Object (Excel)</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/EN-US/library/office/ff835831.aspx\" rel=\"nofollow\">PivotTable Members (Excel)</a>, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839476(v=office.15).aspx\" rel=\"nofollow\">Range.PasteSpecial Method (Excel)</a></p>\n\n<p>Let me know of any questions you might have about the procedure.</p>\n\n<pre><code>Option Explicit\n\nSub GetStores_Published()\nDim Ptb As PivotTable\nDim Wsh As Worksheet\nDim rStore As Range, sStore As String\nDim rSrc As Range\nDim blErr As Boolean\nDim sShtName As String\nDim lPtbRowLst As Long\n\n    Rem Application Settings\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\n    Application.DisplayAlerts = False\n    Application.ScreenUpdating = False\n\n    With ThisWorkbook\n\n        Rem Set Objects\n        Set rStore = .Sheets(\"Stores\").Range(\"A2\")\n        sStore = rStore.Value2\n        'Assuming there is only one PivotTable in Sheet salescube\n        Set Ptb = .Sheets(\"salescube\").PivotTables(1)\n        'Otherwise use line below\n        'Set Ptb = .Sheets(\"salescube\").PivotTables(\"Pivottabell1\")\n\n        Rem PivotTable Refresh and Set to Manual\n        Ptb.RefreshTable\n\n        Do\n            With Ptb\n\n                Rem Filter Pivot Table\n                .PivotFields(\"[DimGeography].[Location].[Country]\").VisibleItemsList = Array(\"\")\n                .PivotFields(\"[DimGeography].[Location].[Region]\").VisibleItemsList = Array(\"\")\n                blErr = False\n                On Error Resume Next\n                .PivotFields(\"[DimGeography].[Location].[SalesChannel]\").VisibleItemsList = _\n                    Array(\"[DimGeography].[Location].[SalesChannel].&amp;[\" &amp; sStore &amp; \"]\")\n                Rem Validates Filter on Store\n                If Err.Number &lt;&gt; 0 Then blErr = True\n                On Error GoTo 0\n                If blErr Then GoTo NEXT_Store\n\n                Rem Set PivotTable Last Row\n                lPtbRowLst = -1 + .TableRange1.Row + .TableRange1.Rows.Count\n\n                Rem Set New Sheet Name &amp; Range to be Copied\n                sShtName = .Parent.Range(\"A2\").Value2\n                Set rSrc = .Parent.Range(\"A1:A\" &amp; lPtbRowLst &amp; \",C1:D\" &amp; lPtbRowLst)\n\n            End With\n\n            Rem Add Worksheet - Store\n            On Error Resume Next\n            .Sheets(sShtName).Delete\n            On Error GoTo 0\n            Set Wsh = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n\n\n            Rem Copy Values from Source Range\n            With Wsh\n                .Name = sShtName\n\n                Rem Use these lines to copy only values - does not use clipboard\n                '.Range(\"A1:A\" &amp; lPtbRowLst).Value = rSrc.Areas(1).Value2\n                '.Range(\"B1:C\" &amp; lPtbRowLst).Value = rSrc.Areas(2).Value2\n\n                Rem use these lines to copy\\paste values &amp; formats as in the original sheet - uses of clipboard\n                rSrc.Copy\n                .Cells(1).PasteSpecial Paste:=xlPasteValues\n                .Cells(1).PasteSpecial Paste:=xlPasteFormats\n                Application.CutCopyMode = False     'Clears the clipboard\n\n                .Cells(3, 2).Activate\n            End With\n\n            Rem Copy Values from Source Range\n            With Wsh\n                .Name = sShtName\n                .Range(\"A1:A\" &amp; lPtbRowLst).Value = rSrc.Areas(1).Value2\n                .Range(\"B1:C\" &amp; lPtbRowLst).Value = rSrc.Areas(2).Value2\n                .Cells(3, 2).Activate\n            End With\n\nNEXT_Store:\n            Rem Reset Store Range\n            'Highlights Cell If PT Filter By Scope Failed\n            If blErr Then rStore.Interior.Color = RGB(255, 255, 0)\n            Set rStore = rStore.Offset(1, 0)\n            sStore = rStore.Value2\n\n        Loop Until sStore = Empty\n\n    End With\n\n    Rem Application Settings\n    Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "is_accepted": true, "score": -1, "last_activity_date": 1448014980, "creation_date": 1448014980, "answer_id": 33824242, "question_id": 33780855, "link": "https://stackoverflow.com/questions/33780855/create-faster-loop/33824242#33824242", "title": "Create faster loop", "body": "<p>I just wanted to show the code I ended up with that works perfectly. Again thanks @EEM</p>\n\n<pre><code>Sub GetStores_Published()\nDim Ptb As PivotTable\nDim Wsh As Worksheet\nDim rStore As Range, sStore As String\nDim rSrc As Range\nDim blErr As Boolean\nDim sShtName As String\nDim lPtbRowLst As Long\n\nRem Application Settings\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\nWith ThisWorkbook\n\n    Rem Set Objects\n    Set rStore = .Sheets(\"Stores\").Range(\"C3\")\n    sStore = rStore.Value2\n    'Assuming there is only one PivotTable in Sheet salescube\n    Set Ptb = .Sheets(\"Salescube\").PivotTables(1)\n    'Otherwise use line below\n    'Set Ptb = .Sheets(\"salescube\").PivotTables(\"Pivottabell1\")\n\n    Rem PivotTable Refresh and Set to Manual\n    Ptb.RefreshTable\n\n    Do\n        With Ptb\n\n            Rem Filter Pivot Table\n            .PivotFields(\"[DimGeography].[Location].[Country]\").VisibleItemsList = Array(\"\")\n            .PivotFields(\"[DimGeography].[Location].[Region]\").VisibleItemsList = Array(\"\")\n            blErr = False\n            On Error Resume Next 'change [SalesChannel] med [Region]\n            .PivotFields(\"[DimGeography].[Location].[Region]\").VisibleItemsList = _\n                Array(\"[DimGeography].[Location].[Region].&amp;[\" &amp; sStore &amp; \"]\")\n            Rem Validates Filter on Store\n            If Err.Number &lt;&gt; 0 Then blErr = True\n            On Error GoTo 0\n            If blErr Then GoTo NEXT_Store\n\n            Rem Set PivotTable Last Row\n            lPtbRowLst = -1 + .TableRange1.Row + .TableRange1.Rows.Count\n\n            Rem Set New Sheet Name &amp; Range to be Copied\n            sShtName = .Parent.Range(\"B4\").Value2\n            Set rSrc = .Parent.Range(\"A1:A\" &amp; lPtbRowLst &amp; \",C1:D\" &amp; lPtbRowLst)\n\n        End With\n\n        Rem Add Worksheet - Store\n        On Error Resume Next\n        .Sheets(sShtName).Delete\n        On Error GoTo 0\n        Set Wsh = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n\n\n        Rem Copy Values from Source Range\n        With Wsh\n            .Name = sShtName\n\n            Rem Use these lines to copy only values - does not use clipboard\n            '.Range(\"A1:A\" &amp; lPtbRowLst).Value = rSrc.Areas(1).Value2\n            '.Range(\"B1:C\" &amp; lPtbRowLst).Value = rSrc.Areas(2).Value2\n\n            Rem use these lines to copy\\paste values &amp; formats as in the original sheet - uses of clipboard. Added one more that gets all formats\n            rSrc.Copy\n            .Cells(1).PasteSpecial\n            Columns().AutoFit\n            '.Cells(1).PasteSpecial Paste:=xlPasteValues\n            '.Cells(1).PasteSpecial Paste:=xlPasteFormats\n            Application.CutCopyMode = False     'Clears the clipboard\n\n            .Cells(3, 2).Activate\n        End With\n\n        Rem Copy Values from Source Range\n        With Wsh\n            .Name = sShtName\n            .Range(\"A1:A\" &amp; lPtbRowLst).Value = rSrc.Areas(1).Value2\n            .Range(\"B1:C\" &amp; lPtbRowLst).Value = rSrc.Areas(2).Value2\n            .Cells(3, 2).Activate\n        End With\n\nNEXT_Store:\n        Rem Reset Store Range\n        'Highlights Cell If PT Filter By Scope Failed\n        If blErr Then rStore.Interior.Color = RGB(255, 255, 0)\n        Set rStore = rStore.Offset(1, 0)\n        sStore = rStore.Value2\n\n    Loop Until sStore = Empty\n\nEnd With\n\nRem Application Settings\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 2, "accepted_answer_id": 33824242, "answer_count": 5, "score": -1, "last_activity_date": 1448014980, "creation_date": 1447851867, "last_edit_date": 1531164843, "question_id": 33780855, "link": "https://stackoverflow.com/questions/33780855/create-faster-loop", "title": "Create faster loop", "body": "<p>Got a loop that I think takes forever. It's working but takes 10 minutes to finish. Can any point me in a direction that makes this go faster? I know the Pivot takes time, but I hope any here have a idea. The loop goes through about 40-80 cells.</p>\n\n<pre><code>Sub GetStores()\n\nDim store As String\n\nApplication.ScreenUpdating = False\n\nSheets(\"Stores\").Select\nRange(\"A2\").Select\nStore= ActiveCell.Value\n\n\nDo Until IsEmpty(ActiveCell)\n\nSheets(\"salescube\").Select\nActiveSheet.PivotTables(\"Pivottabell1\").PivotFields( _\n    \"[DimGeography].[Location].[Country]\").VisibleItemsList = Array(\"\")\nActiveSheet.PivotTables(\"Pivottabell1\").PivotFields( _\n    \"[DimGeography].[Location].[Region]\").VisibleItemsList = Array(\"\")\nActiveSheet.PivotTables(\"Pivottabell1\").PivotFields( _\n    \"[DimGeography].[Location].[SalesChannel]\").VisibleItemsList = Array( _\n    \"[DimGeography].[Location].[SalesChannel].&amp;[\" &amp; store &amp; \"]\")\n\n   Range(\"A:A,C:D\").Select\nSelection.Copy\n Sheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Paste\nActiveSheet.Name = Range(\"A2\").Value\nRange(\"B3\").Select\n\n\n\nSheets(\"Stores\").Select\nActiveCell.Offset(1, 0).Select\nStore = ActiveCell.Value\n\nLoop\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>EDIT\n<a href=\"http://i.stack.imgur.com/phOe7.jpg\" rel=\"nofollow\">The Pivot, most cant be shown</a></p>\n\n<p>Forgot to mention the hyperlink that refers back to the first sheet (\"Stores\")</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1447851035, "post_id": 33780475, "comment_id": 55327354, "body": "Show us what you&#39;ve tried first, you probably aren&#39;t that far off."}, {"owner": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "edited": false, "score": 0, "creation_date": 1447852849, "post_id": 33780475, "comment_id": 55328619, "body": "What exactly did go wrong with selection_change? nothing happens or error pops up?"}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "edited": false, "score": 0, "creation_date": 1447853254, "post_id": 33781056, "comment_id": 55328938, "body": "or try : If Not Intersect(Target, Me.Range(&quot;B:B&quot;)) Is Nothing Then Macro it makes just user input data work"}], "tags": [], "owner": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "is_accepted": true, "score": 0, "last_activity_date": 1583537642, "last_edit_date": 1583537642, "creation_date": 1447852375, "answer_id": 33781056, "question_id": 33780475, "link": "https://stackoverflow.com/questions/33780475/vba-auto-populates-a-cell-when-another-cell-is-populated/33781056#33781056", "title": "VBA auto populates a cell when another cell is populated", "body": "<p>copy this into your sheet in vba</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n    Dim xrow As Long\n\n    xrow = 2\n    Set KeyCells = Range(\"B:B\")\n\n    If Not Application.Intersect(KeyCells, Target) Is Nothing Then\n        Do\n            If Cells(xrow, 2).Value &lt;&gt; \"\" Then\n                If Cells(xrow, 1).Value = \"\" Then\n                    Cells(xrow, 1).Value = Cells(xrow - 1, 1).Value + 1\n                End If\n            End If\n        xrow = xrow + 1\n        Loop Until Cells(xrow, 2) = \"\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>hope I helped :)</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1447856151, "creation_date": 1447856151, "answer_id": 33782380, "question_id": 33780475, "link": "https://stackoverflow.com/questions/33780475/vba-auto-populates-a-cell-when-another-cell-is-populated/33782380#33782380", "title": "VBA auto populates a cell when another cell is populated", "body": "<p>There are a few things to consider when implementing a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839775.aspx\" rel=\"nofollow\">Worksheet_Change</a> event macro.</p>\n\n<p>First thing to consider when you plan to change/delete/add any value to the worksheet within the event macro is that you are going to trigger another event and the Worksheet_Change is going to try to run on top of itself. ALWAYS disable event handling with <code>Application.EnableEvents = False</code> before changing anything n the worksheet and remember to turn it back on again with <code>Application.EnableEvents = True</code> before leaving the event macro or no future event will trigger another Worksheet_Change until event handling is turned back on.</p>\n\n<p>The second thing to consider is how you are going to deal with more than a single cell receiving a change. This could occur if several values were pasted into column B. You also need to isolate the values that were pasted into column B only; other columns could conceivably receive values at the same time.</p>\n\n<p>What to do with the ID if a city value is cleared and checking for duplicates in the city column are other considerations that you should decide on appropriate actions for.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Columns(2)) Is Nothing Then\n        On Error GoTo bm_Safe_Exit\n        Application.EnableEvents = False\n        Dim cty As Range\n        For Each cty In Intersect(Target, Columns(2))\n            If CBool(Len(cty.Value2)) Then\n                cty.Offset(0, -1) = Application.Max(Columns(1)) + 1\n                'check for duplicates and mark xlRed if found\n                'comment or delete this if not required\n                If Application.CountIf(Columns(2), cty.Value2) &gt; 1 Then\n                    cty.Interior.Color = vbRed\n                Else\n                    cty.Interior.Pattern = xlNone\n                End If\n            Else\n                'not sure whether you want to clear the\n                'ID column if the city column is cleared\n                cty.Offset(0, -1).ClearContents\n                'or clear any background fill from a duplicate\n                cty.Interior.Pattern = xlNone\n            End If\n        Next cty\n    End If\nbm_Safe_Exit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>While I'm using <code>application.Max</code> to ensure a unique number, the IDs in column A can be manually edited without any interference from the event macro.</p>\n\n<p>There is a lot that can be done with a Worksheet_Change. The above is pretty good framework to get you started and you should be able to expand on its functionality while 'colouring inside the lines'.</p>\n"}], "owner": {"reputation": 3895, "user_id": 4972716, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/a7c5b54d4f13c6bb4d1d4d40ca4d4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Stacey", "link": "https://stackoverflow.com/users/4972716/stacey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 33781056, "answer_count": 2, "score": 0, "last_activity_date": 1583620890, "creation_date": 1447850736, "last_edit_date": 1583620890, "question_id": 33780475, "link": "https://stackoverflow.com/questions/33780475/vba-auto-populates-a-cell-when-another-cell-is-populated", "title": "VBA auto populates a cell when another cell is populated", "body": "<p>I have a 2 columns in a spreadsheet:</p>\n\n<ul>\n<li>Column A is an ID (incremented by one for each new record)</li>\n<li>Column B is the name of a City</li>\n</ul>\n\n<p>Is it possible when a new city is added to column B (and only when column B changes) that the ID automatically populates with a value one greater than the previous record.  So for example if I have the current record set:</p>\n\n<pre><code>   A    B\n   ________\n1 | ID  City\n2 | 1   London\n3 | 2   Paris\n4 | 3   New York\n</code></pre>\n\n<p>and I add say Moscow to the list, then value 4 will automatically populate in column A? </p>\n\n<pre><code>   A    B\n   ________\n1 | ID  City\n2 | 1   London\n3 | 2   Paris\n4 | 3   New York\n5 | **4**   Moscow\n</code></pre>\n\n<p>It needs to be range based so I can enter as many new records as I need.</p>\n\n<p>I have tried <code>Private Sub Worksheet_SelectionChange</code> but cannot get it to work.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1447852362, "post_id": 33780355, "comment_id": 55328282, "body": "Either use INDIRECT or VBA, there is no other solution. And if you want to use VBA, this site is not the right place to just ask for code; this is for Q&amp;A. Why do you think INDIRECT would require you to have 70 files open, anyway?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447852563, "post_id": 33780355, "comment_id": 55328404, "body": "There is the INDIRECT.EXT solution from the free third-party MoreFunc add-on library but it would have to be installed on every machine opening the workbook (and I cannot remember what its current state with 64-bit Excel is)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1447852663, "post_id": 33780355, "comment_id": 55328475, "body": "@Grade&#39;Eh&#39;Bacon - The <a href=\"https://support.office.com/en-us/article/indirect-function-21f8bcfc-b174-4a50-9dc6-4dfb5b3361cd\" rel=\"nofollow noreferrer\">INDIRECT function</a> does not work on closed workbooks and it seems that there are 70-odd external workbooks referenced from those formulas."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1447852772, "post_id": 33780355, "comment_id": 55328558, "body": "Ah, that makes sense - yes in that case to pull data you would need a VBA solution."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447854107, "post_id": 33780355, "comment_id": 55329591, "body": "I&#39;m unclear on why the macro mentioned in <i>&quot;...are copied in via a macro and cells c2 down and right are formulas.&quot;</i> does not adjust the formulas to suit the new data."}, {"owner": {"reputation": 11, "user_id": 5576526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e880a1c90c58691c6af2754c2a858bb?s=128&d=identicon&r=PG&f=1", "display_name": "UncleBob", "link": "https://stackoverflow.com/users/5576526/unclebob"}, "edited": false, "score": 0, "creation_date": 1447855801, "post_id": 33780355, "comment_id": 55330962, "body": "Hi Jeeped, Copying &amp; pasting is about my limits on macros. Replacing text is beyond me."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5576526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e880a1c90c58691c6af2754c2a858bb?s=128&d=identicon&r=PG&f=1", "display_name": "UncleBob", "link": "https://stackoverflow.com/users/5576526/unclebob"}, "edited": false, "score": 0, "creation_date": 1447944011, "post_id": 33800274, "comment_id": 55379048, "body": "On the first printscreen Col A is pasteded in from the &quot;Resource&quot; tab, C1 right is pasted in from the &quot;Project List&quot; tab, C2 &amp; c3 are lookups to Project List, C4 right &amp; B5 down are simple count formulas."}, {"owner": {"reputation": 11, "user_id": 5576526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e880a1c90c58691c6af2754c2a858bb?s=128&d=identicon&r=PG&f=1", "display_name": "UncleBob", "link": "https://stackoverflow.com/users/5576526/unclebob"}, "edited": false, "score": 0, "creation_date": 1447944536, "post_id": 33800274, "comment_id": 55379454, "body": "Try again! ......On the printscreen Col A is pasteded in from the &quot;Resource&quot; tab, C1 right is pasted in from the &quot;Project List&quot; tab, C2 &amp; c3 are lookups to Project List, C4 right &amp; B5 down are simple count formulas. This tab tells us who is forecast to be on how many projects.The trouble is that the formulas in C5 down &amp; right will need to change every time this is run as the Project List is pretty fluid. (this data is then transfered on to the &quot;Resource by Week&quot; tab and the formulas will need to be changed on there as well - happy days!)"}, {"owner": {"reputation": 284, "user_id": 3286675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/CUYQa.png?s=128&g=1", "display_name": "helena4", "link": "https://stackoverflow.com/users/3286675/helena4"}, "reply_to_user": {"reputation": 11, "user_id": 5576526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e880a1c90c58691c6af2754c2a858bb?s=128&d=identicon&r=PG&f=1", "display_name": "UncleBob", "link": "https://stackoverflow.com/users/5576526/unclebob"}, "edited": false, "score": 0, "creation_date": 1447945617, "post_id": 33800274, "comment_id": 55380217, "body": "What is preventing you from using indirect?"}, {"owner": {"reputation": 11, "user_id": 5576526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e880a1c90c58691c6af2754c2a858bb?s=128&d=identicon&r=PG&f=1", "display_name": "UncleBob", "link": "https://stackoverflow.com/users/5576526/unclebob"}, "edited": false, "score": 0, "creation_date": 1447946118, "post_id": 33800274, "comment_id": 55380600, "body": "Indirect needs the target files open and there are about 70 project files so it&#39;s just not practical."}, {"owner": {"reputation": 284, "user_id": 3286675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/CUYQa.png?s=128&g=1", "display_name": "helena4", "link": "https://stackoverflow.com/users/3286675/helena4"}, "reply_to_user": {"reputation": 11, "user_id": 5576526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e880a1c90c58691c6af2754c2a858bb?s=128&d=identicon&r=PG&f=1", "display_name": "UncleBob", "link": "https://stackoverflow.com/users/5576526/unclebob"}, "edited": false, "score": 0, "creation_date": 1447947960, "post_id": 33800274, "comment_id": 55381960, "body": "You can check out the revised answer"}, {"owner": {"reputation": 11, "user_id": 5576526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e880a1c90c58691c6af2754c2a858bb?s=128&d=identicon&r=PG&f=1", "display_name": "UncleBob", "link": "https://stackoverflow.com/users/5576526/unclebob"}, "edited": false, "score": 0, "creation_date": 1447948862, "post_id": 33800274, "comment_id": 55382685, "body": "Hi Helena, I&#39;m being dragged off to a meeting so will have another go tomorrow but I&#39;m pretty sure I&#39;ve tried this and it didn&#39;t work. Thanks, Paul"}, {"owner": {"reputation": 284, "user_id": 3286675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/CUYQa.png?s=128&g=1", "display_name": "helena4", "link": "https://stackoverflow.com/users/3286675/helena4"}, "reply_to_user": {"reputation": 11, "user_id": 5576526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e880a1c90c58691c6af2754c2a858bb?s=128&d=identicon&r=PG&f=1", "display_name": "UncleBob", "link": "https://stackoverflow.com/users/5576526/unclebob"}, "edited": false, "score": 0, "creation_date": 1447948994, "post_id": 33800274, "comment_id": 55382783, "body": "Have fun - it works if you get the address correctly in the concatenation. I just pried it off existing files i use. Its just easy to mess up - 1 symbol off in the concatenation and the formula breaks without giving you a hint that its broken"}, {"owner": {"reputation": 11, "user_id": 5576526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e880a1c90c58691c6af2754c2a858bb?s=128&d=identicon&r=PG&f=1", "display_name": "UncleBob", "link": "https://stackoverflow.com/users/5576526/unclebob"}, "edited": false, "score": 0, "creation_date": 1448036057, "post_id": 33800274, "comment_id": 55427556, "body": "Meetings meetings!......Thank you everyone, I&#39;ll try fixing this over the weekend. Paul"}], "tags": [], "owner": {"reputation": 284, "user_id": 3286675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/CUYQa.png?s=128&g=1", "display_name": "helena4", "link": "https://stackoverflow.com/users/3286675/helena4"}, "is_accepted": false, "score": 0, "last_activity_date": 1447948945, "last_edit_date": 1447948945, "creation_date": 1447926433, "answer_id": 33800274, "question_id": 33780355, "link": "https://stackoverflow.com/questions/33780355/change-the-file-reference-in-a-formula-using-the-content-of-another-cell/33800274#33800274", "title": "Change the file reference in a formula using the content of another cell", "body": "<p>Show us a full circle of what you want to use, what you want to do with it and what the end result should look like. (you can reference the screenshot provided) as I'm not quite clear of want you want to do and don't want to guess.</p>\n\n<p>In any case:\n=CELL(\"filename\",A1) should help you with current file name however you rename the document you work on.</p>\n\n<p>Other than that you can import however many filenames you have on a list without needing to open them. We will expand on that should it be needed.</p>\n\n<p>PS Based on updated info:</p>\n\n<pre><code>=INDIRECT(CONCATENATE(\"'\",$C$3,\"'\",\"!\",\"A\",ROW()))\nThe reference to make that formula work is C3\n\nThis is integrated instead of your\n\" 'g:\\it\\capex\\2015 etc etc tec ... Plan'!$B$20:$B$119   \"\n\nC3=\"C:\\folder\\[filename.xlsx]sheet name\"\n</code></pre>\n\n<p>(derived by formula or however you want - the result shows the address)</p>\n\n<p>If you want to put in the sheet name independently or more flexibly simply add one more ,references for it to the concatenation.</p>\n\n<p>Either adjust the formula to accommodate your C3 or adjust your c3 to accommodate the formula its fairly simple = you can do it more easily when you remove the INDIRECT and see what remains as text. Get the correct text running through that and you can need correct reference. You can use the general idea to create dynamic address lists that you can reference from 1 location. Further more vba can pull names from directories so you can compile an active list, leaving you with little to no manual work... Yes - most people usually frown upon crafting location addresses in formulas and usually tell you to reorganize your work files, but some times its necessary to access files ad-hoc on value based references.</p>\n"}], "owner": {"reputation": 11, "user_id": 5576526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e880a1c90c58691c6af2754c2a858bb?s=128&d=identicon&r=PG&f=1", "display_name": "UncleBob", "link": "https://stackoverflow.com/users/5576526/unclebob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1393, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1447948945, "creation_date": 1447850412, "last_edit_date": 1531161705, "question_id": 33780355, "link": "https://stackoverflow.com/questions/33780355/change-the-file-reference-in-a-formula-using-the-content-of-another-cell", "title": "Change the file reference in a formula using the content of another cell", "body": "<p>I need help with a formula (or macro) please.\nOn the printscreen below ColA and Row1 are copied in via a macro and cells c2 down and right are formulas.\nThe problem I have is when Row1 is copied in next time the project names might change (say a new one called \"100 Project\") and I will need to change the filename in the formulas in C5 onwards.\nI don't want to use INDIRECT as I can't have 70 or so files open.  </p>\n\n<p>Is there a formula I can use please or does anyone have a macro that'll do the job?</p>\n\n<p><strong><a href=\"http://i.stack.imgur.com/ue83t.png\" rel=\"nofollow\">Printscreen</a></strong></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 0, "last_activity_date": 1447850982, "creation_date": 1447850982, "answer_id": 33780544, "question_id": 33780314, "link": "https://stackoverflow.com/questions/33780314/update-code-to-copy-paste-values-no-formulas/33780544#33780544", "title": "Update code to copy paste values (no formulas)", "body": "<p>Change your code like below. Comments in the code.</p>\n\n<pre><code>Sub dayweek()\n\n    Dim i As Integer\n    Dim data As Variant\n    Dim destinationRange As Range\n    Dim Ws As Worksheet, cs As Worksheet\n\n    Set Ws = Sheets(\"Incidents_data\")\n\n    'This is redundant. You don't need to activate worksheet\n    'in order to get data from it.\n    'Ws.Select\n\n    'Since you said you need only values (without formulas nor\n    'formatting), instead of copying cells, we copy only their content.\n    data = Ws.Range(\"r2\", Ws.Range(\"r2\").End(xlDown))\n\n    'Ws.Range(\"r2\", Ws.Range(\"r2\").End(xlDown)).Select     'Update for different data column\n    'Selection.Copy\n\n\n\n    Sheets.Add After:=Sheets(Sheets.Count)\n    ActiveSheet.Name = \"Day_week\"               'Update for different data column\n    Set cs = Sheets(\"Day_week\")                 'Update for different data column\n\n\n    'Again, you don't need to activate worksheet to paste data in it.\n    'cs.Range(\"A2\").Select\n    'cs.Paste\n    Set destinationRange = cs.Range(\"A2\").Resize(UBound(data, 1), UBound(data, 2))\n    destinationRange = data\n\n\n    Application.CutCopyMode = False\n    cs.Range(\"A2\", cs.Range(\"A2\").End(xlDown)).RemoveDuplicates Columns:=1, Header:=xlNo\n    cs.Range(\"A1\") = Ws.Range(\"r1\").Value          'Update for different data column (only ws.Range(\"A1\").Value) (this is just the column heading)\n    cs.Range(\"B1\") = \"Number of occurrences\"\n\n    For i = 1 To cs.Range(\"A2\", cs.Range(\"A2\").End(xlDown)).Rows.Count\n        cs.Cells(1 + i, 2) = Application.CountIf(Ws.Range(\"r2\", Ws.Range(\"r2\").End(xlDown)), cs.Cells(1 + i, 1))          'Update for different data column\n    Next i\n\n    cs.Range(cs.Cells(2, 1), cs.Cells(cs.Range(\"A2\").End(xlDown).Row, 2)).Sort Key1:=cs.Range(\"B1\"), order1:=xlDescending, Header:=xlNo\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1447851905, "last_edit_date": 1495542190, "creation_date": 1447851905, "answer_id": 33780875, "question_id": 33780314, "link": "https://stackoverflow.com/questions/33780314/update-code-to-copy-paste-values-no-formulas/33780875#33780875", "title": "Update code to copy paste values (no formulas)", "body": "<p>I'm not sure just how important bringing across the formatting to the new worksheet is but a direct value transfer is a much more efficient method as opposed to a Copy, Paste Special Values.</p>\n\n<p>I've reduced your code's reliance on <code>.Select</code> and <code>ActiveSheet</code>, preferring instead to rely on the assigned worksheet variables and the parent worksheet reference of a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a>.</p>\n\n<pre><code>Sub dayweek()\n\n    Dim i As Long, csName As String\n    Dim Ws As Worksheet, cs As Worksheet\n\n    csName = \"Day_week\"  '&lt;~~ 'Update for different data column IN ONE PLACE\n    With Sheets.Add(After:=Sheets(Sheets.Count))\n        .Name = csName\n    End With\n    Set cs = Sheets(csName)\n\n    Set Ws = Sheets(\"Incidents_data\")\n\n    With Ws\n        With .Range(\"r2\", .Range(\"r2\").End(xlDown))      'Update for different data column\n            cs.Range(\"A2\").Resize(.Rows.Count, .Columns.Count) = .Value\n        End With\n    End With\n\n    With cs\n        .Range(\"A1:B1\") = Array(Ws.Range(\"A1\").Value, \"Number of occurrences\")\n        With .Range(\"A2\", .Range(\"A2\").End(xlDown))\n            .RemoveDuplicates Columns:=1, Header:=xlNo\n        End With\n        'restate this as it may have changed rows\n        With .Range(\"A2\", .Range(\"A2\").End(xlDown))\n            .Offset(0, 1).Formula = \"=COUNTIF(A:A, A2)\"\n            .Value = .Value\n        End With\n        With .Range(\"A1\").CurrentRegion\n            .Cells.Sort Key1:=.Columns(2), Order1:=xlAscending, _\n                        Orientation:=xlTopToBottom, Header:=xlYes\n        End With\n    End With\n\n\nEnd Sub\n</code></pre>\n\n<p>If the formatting was mission-critical, a subsequent Copy, Paste Special Formats operation could be made.</p>\n\n<hr>\n\n<p><sub>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</sub></p>\n"}], "owner": {"reputation": 904, "user_id": 4519709, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c6b1f82af788e90e52773d9007bae416?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/4519709/gonzalo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 33780544, "answer_count": 2, "score": 0, "last_activity_date": 1447851905, "creation_date": 1447850308, "last_edit_date": 1447850518, "question_id": 33780314, "link": "https://stackoverflow.com/questions/33780314/update-code-to-copy-paste-values-no-formulas", "title": "Update code to copy paste values (no formulas)", "body": "<p>How could I update below code to copy paste to new sheet \"day_week\"in values? Asking because is giving error when the cell is in a formula, so i would like to transform the cell content to value. </p>\n\n<pre><code>Sub dayweek()\n\n    Dim i As Integer\n    Dim Ws As Worksheet, cs As Worksheet\n\n    Set Ws = Sheets(\"Incidents_data\")\n    Ws.Select\n\n    Ws.Range(\"r2\", Ws.Range(\"r2\").End(xlDown)).Select     'Update for different data column\n    Selection.Copy\n\n\n    Sheets.Add After:=Sheets(Sheets.Count)\n    ActiveSheet.Name = \"Day_week\"               'Update for different data column\n    Set cs = Sheets(\"Day_week\")                 'Update for different data column\n\n    cs.Range(\"A2\").Select\n    cs.Paste\n    Application.CutCopyMode = False\n    cs.Range(\"A2\", cs.Range(\"A2\").End(xlDown)).RemoveDuplicates Columns:=1, Header:=xlNo\n    cs.Range(\"A1\") = Ws.Range(\"r1\").Value          'Update for different data column (only ws.Range(\"A1\").Value) (this is just the column heading)\n    cs.Range(\"B1\") = \"Number of occurrences\"\n\n    For i = 1 To cs.Range(\"A2\", cs.Range(\"A2\").End(xlDown)).Rows.Count\n        cs.Cells(1 + i, 2) = Application.CountIf(Ws.Range(\"r2\", Ws.Range(\"r2\").End(xlDown)), cs.Cells(1 + i, 1))          'Update for different data column\n    Next i\n\n    cs.Range(cs.Cells(2, 1), cs.Cells(cs.Range(\"A2\").End(xlDown).Row, 2)).Sort Key1:=cs.Range(\"B1\"), order1:=xlDescending, Header:=xlNo\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "csv", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1447870814, "creation_date": 1447870814, "answer_id": 33787432, "question_id": 33780270, "link": "https://stackoverflow.com/questions/33780270/vba-populate-word-document-with-csv-table-values/33787432#33787432", "title": "VBA - Populate Word document with CSV table values", "body": "<p>The most effective method is to use Range.InsertFile to bring the CSV file into the document then use the Range.ConvertToTable method to transform it into a Word table. You'll find a discussion and detailed code example in this article:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/aa537149%28v=office.11%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/aa537149%28v=office.11%29.aspx?f=255&amp;MSPPError=-2147217396</a> </p>\n"}], "owner": {"reputation": 723, "user_id": 1960423, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d362538f28b861adee82f7e7079b64a4?s=128&d=identicon&r=PG", "display_name": "LeeWay", "link": "https://stackoverflow.com/users/1960423/leeway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2151, "favorite_count": 0, "accepted_answer_id": 33787432, "answer_count": 1, "score": 0, "last_activity_date": 1447870814, "creation_date": 1447850171, "question_id": 33780270, "link": "https://stackoverflow.com/questions/33780270/vba-populate-word-document-with-csv-table-values", "title": "VBA - Populate Word document with CSV table values", "body": "<p><em>I apologize in advance for my question, I didn't had much to do with MsWord macros till now.</em></p>\n\n<p>Until now I executed the script below to add one-by-one some well-formatted tables to a word document via a VBA Word macro:</p>\n\n<pre><code>Sub InsertTableToWord()    \n\nDim TCID As String, TCTitle As String, TCObjective As String\n\nTCID = InputBox(\"Provide TCID: \")\nTCTitle = InputBox(\"Provide TCTitle: \")\nTCObjective = InputBox(\"Provide TCObjective: \")\n\n' some code to format the entered data\nSelection.TypeText Text:=TCID\nSelection.TypeText Text:=TCTitle\nSelection.TypeText Text:=TCObjective\n\nEnd Sub\n</code></pre>\n\n<p>I had to execute the above presented macro 10 to 40 times for different TC* values.</p>\n\n<p>What I would like to do now:</p>\n\n<ul>\n<li>store the TC* values in a CSV (done, 1st column TCID, 2nd - TCTitle, 3rd - TCObjective)</li>\n<li>modify my code to load the values stored in the CSV file and repeat the action until all the data from the CSV file is used.</li>\n</ul>\n\n<p>Could you guys help me with this?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1447850732, "post_id": 33780190, "comment_id": 55327131, "body": "Figured it out.  Thank you Gents!  Appreciated!"}], "tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 2, "last_activity_date": 1447850066, "last_edit_date": 1447850066, "creation_date": 1447849950, "answer_id": 33780190, "question_id": 33780111, "link": "https://stackoverflow.com/questions/33780111/creating-an-range-object-error/33780190#33780190", "title": "Creating an range object error", "body": "<p>Below is how you can get the reference to the range:</p>\n\n<pre><code>Sub test()\n    Dim testObj As Range\n\n    row_number = 3\n    dataCol = \"O\"\n\n    Set testObj = ActiveSheet.Range(dataCol &amp; row_number)\n\n\nEnd Sub\n</code></pre>\n\n<p>This will create the reference to the cell O3 in the currently active worksheet.</p>\n\n<p>If you need the reference to the range from other worksheet you can do it like that:</p>\n\n<pre><code>Set testObj = Worksheets(\"sheet_name\").Range(dataCol &amp; row_number)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "edited": false, "score": 0, "creation_date": 1447864335, "post_id": 33780194, "comment_id": 55337580, "body": "Don&#39;t skip references, they&#39;re useful and make your posts outstanding."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1447849975, "creation_date": 1447849975, "answer_id": 33780194, "question_id": 33780111, "link": "https://stackoverflow.com/questions/33780111/creating-an-range-object-error/33780194#33780194", "title": "Creating an range object error", "body": "<p>You cannot simply construct a string and expect it to be a valid <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range object</a>. However, you can use that string to create one.</p>\n\n<pre><code>Set testObj = Range(dataCol &amp; row_number)\n</code></pre>\n\n<p>This could equate to the <a href=\"https://support.office.com/en-us/article/indirect-function-21f8bcfc-b174-4a50-9dc6-4dfb5b3361cd\" rel=\"nofollow\">INDIRECT function</a> on a worksheet turing a text string into a valid cell reference.</p>\n"}], "owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 33780190, "answer_count": 2, "score": 0, "last_activity_date": 1447850066, "creation_date": 1447849735, "question_id": 33780111, "link": "https://stackoverflow.com/questions/33780111/creating-an-range-object-error", "title": "Creating an range object error", "body": "<p>So i've read a ton of posts on stack about this and for some reason I can't understand what my problem is.  I'm new to excel VBA so it's possible it's very obvious so I apologize.  Trying to create a range object using a variable column and row_number. (this isn't the actual project, but it's a lot less convoluted to create a simple example than my real project.)  I get a Run-time error '424' Object required when I try and compile.  Any ideas? </p>\n\n<pre><code>Sub test()\n    Dim testObj As Range\n    row_number = 3\n    dataCol = \"O\"\n    Set testObj = (dataCol &amp; row_number)\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1447846864, "post_id": 33778917, "comment_id": 55324618, "body": "Note that your &quot;should become&quot; is incorrect. The new line is in the wrong place."}], "answers": [{"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1447849544, "post_id": 33779022, "comment_id": 55326278, "body": "Shouldn&#39;t that be <code>If (pos &gt;= 51) Then</code> in case the 51st character is a space?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1447850071, "post_id": 33779022, "comment_id": 55326639, "body": "#DevProbs - Everyone counts from 1, we count from 0!"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 3, "last_activity_date": 1447849861, "last_edit_date": 1447849861, "creation_date": 1447846538, "answer_id": 33779022, "question_id": 33778917, "link": "https://stackoverflow.com/questions/33778917/vba-insert-vbnewline-in-the-first-blank-character/33779022#33779022", "title": "VBA insert vbNewLine in the first blank character", "body": "<p>Since your question is so nicely posed, here's a solution</p>\n\n<pre><code>Sub solution()\n\n    Dim test As String\n    Dim pos As Integer\n\n    test = \"At company employees with the right skills have good prospects to be promoted then a relevant position becomes available\"\n\n    pos = InStr(51, test, \" \") 'search for a space on or after the 51st character\n\n    If (pos &gt;= 51) Then\n        'found a space\n        test = Left(test, pos) &amp; vbNewLine &amp; Mid(test, pos + 1) 'miss out that space\n    End If\n\n    Debug.Print test\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1447847110, "creation_date": 1447847110, "answer_id": 33779200, "question_id": 33778917, "link": "https://stackoverflow.com/questions/33778917/vba-insert-vbnewline-in-the-first-blank-character/33779200#33779200", "title": "VBA insert vbNewLine in the first blank character", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/bt3szac5%28v=vs.90%29.aspx\" rel=\"nofollow\">Replace function</a> can start at a certain point and replace a single occurrance of a character using parameters that are usually left to defaults.</p>\n\n<pre><code>Dim str As String, i As Long\ni = 50\nstr = \"At company employees with the right skills have good prospects to be promoted then a relevant position becomes available\"\nstr = Left(str, i - 1) &amp; Replace(str, Chr(32), Chr(10), _\n                                 Start:=i, Count:=1)\nDebug.Print str\n</code></pre>\n\n<p>Use 50 as the starting point, the result I receive is,</p>\n\n<pre><code>At company employees with the right skills have good\nprospects to be promoted then a relevant position becomes available\n</code></pre>\n"}], "owner": {"reputation": 389, "user_id": 3387046, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/569dfbe91a3c66c3542c21b4952785dc?s=128&d=identicon&r=PG&f=1", "display_name": "user3387046", "link": "https://stackoverflow.com/users/3387046/user3387046"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 33779200, "answer_count": 2, "score": 1, "last_activity_date": 1447849861, "creation_date": 1447846237, "question_id": 33778917, "link": "https://stackoverflow.com/questions/33778917/vba-insert-vbnewline-in-the-first-blank-character", "title": "VBA insert vbNewLine in the first blank character", "body": "<p>I need to insert a vbNewLine in a cell string value after the first blank character encountered after the 50 first characters?</p>\n\n<p>For example:\n\"At company employees with the right skills have good prospects to be promoted then a relevant position becomes available\" should become</p>\n\n<p>\"At company employees with the right skills <em>(vbNewLine)</em>\n have good prospects to be promoted then a relevant position becomes available\"</p>\n"}, {"tags": ["sql-server", "excel", "alm", "hp-quality-center", "vba"], "comments": [{"owner": {"reputation": 685, "user_id": 3046872, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/27e38083d4d02d18fabc18488d894ce7?s=128&d=identicon&r=PG&f=1", "display_name": "CPMunich", "link": "https://stackoverflow.com/users/3046872/cpmunich"}, "edited": false, "score": 0, "creation_date": 1447851024, "post_id": 33778781, "comment_id": 55327344, "body": "the scipt in VBA is the same as in SQL-Server. Just put the SQL-Statemen in a String-Variable and open a Recordset"}, {"owner": {"reputation": 2163, "user_id": 546810, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/312f22553424f5b4ade5a58454f871c8?s=128&d=identicon&r=PG", "display_name": "Lokesh Sah", "link": "https://stackoverflow.com/users/546810/lokesh-sah"}, "reply_to_user": {"reputation": 685, "user_id": 3046872, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/27e38083d4d02d18fabc18488d894ce7?s=128&d=identicon&r=PG&f=1", "display_name": "CPMunich", "link": "https://stackoverflow.com/users/3046872/cpmunich"}, "edited": false, "score": 0, "creation_date": 1447851095, "post_id": 33778781, "comment_id": 55327390, "body": "Will it work for multiple statement query ?"}, {"owner": {"reputation": 100127, "user_id": 67392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95e28ac250c4604a6f9d7e34705c3259?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/67392/richard"}, "edited": false, "score": 1, "creation_date": 1447853795, "post_id": 33778781, "comment_id": 55329379, "body": "Yes it will. You&#39;ll need to use <a href=\"https://msdn.microsoft.com/en-us/library/ms677539%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\"><code>NextRecordset</code></a> after you&#39;ve read all the rows from one statement to start the rows from the next."}], "answers": [{"comments": [{"owner": {"reputation": 100127, "user_id": 67392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95e28ac250c4604a6f9d7e34705c3259?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/67392/richard"}, "edited": false, "score": 0, "creation_date": 1447853678, "post_id": 33780660, "comment_id": 55329303, "body": "That&#39;s a SQL Injection Vulnerability: <b><i>always</i></b> use parameters."}, {"owner": {"reputation": 100127, "user_id": 67392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95e28ac250c4604a6f9d7e34705c3259?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/67392/richard"}, "edited": false, "score": 0, "creation_date": 1447859018, "post_id": 33780660, "comment_id": 55333505, "body": "There are three parts to why. Firstly always using parameters avoids needing to decide when you need to (and updating to parameters) when code is reused. Secondly as a script expands and is reused that value starts coming from a parameter\u2026. Thirdly it  means you do not need to think about quoting in strings or formatting of dates: it simplifies the code."}, {"owner": {"reputation": 100127, "user_id": 67392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95e28ac250c4604a6f9d7e34705c3259?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/67392/richard"}, "edited": false, "score": 0, "creation_date": 1447859117, "post_id": 33780660, "comment_id": 55333573, "body": "IMHO it is everyone&#39;s job to avoid developers seeing practice that has lead to many hacks succeeding (perhaps more than any other cause of vulnerabilities)."}, {"owner": {"reputation": 100127, "user_id": 67392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95e28ac250c4604a6f9d7e34705c3259?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/67392/richard"}, "edited": false, "score": 0, "creation_date": 1447859160, "post_id": 33780660, "comment_id": 55333605, "body": "(My last two comments respond to now deleted comments. And I&#39;ll take back the down vote now this is fixed.)"}], "tags": [], "owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "is_accepted": true, "score": 1, "last_activity_date": 1447859010, "last_edit_date": 1447859010, "creation_date": 1447851305, "answer_id": 33780660, "question_id": 33778781, "link": "https://stackoverflow.com/questions/33778781/how-to-write-a-cte-recursive-query-in-vba-script/33780660#33780660", "title": "How to write a CTE Recursive Query in VBA script?", "body": "<p>Here is your code with your query embedded and your query variable declared as a VBA variable and referenced in the SQL script:</p>\n\n<pre><code>Sub Extractor()\n\n    Const QCADDRESS = \"http://alm/qcbin\"\n    Const DOMAIN = \"DOMAIN\"\n    Const PROJECT = \"PROJECT\"\n    Const QCUSR = \"user.name\"\n    Const QCPWD = \"123456\"\n    Dim par(0) As Variant\n\n    Dim QCConnection, com, recset\n    Dim XLS, Wkb, Wks, i\n\n    Set QCConnection = CreateObject(\"TDApiOle80.TDConnection\")\n    QCConnection.InitConnectionEx QCADDRESS\n    QCConnection.Login QCUSR, QCPWD\n    QCConnection.Connect DOMAIN, PROJECT\n\n    Set com = QCConnection.Command\n    par(0) = 4 'set parameter value for Father_ID in SQL\n\n    com.CommandText = \"with ReqCTE as (\" &amp; _\n                        \"SELECT RQ_REQ_ID, RQ_REQ_NAME, RQ_FATHER_ID, 0 as lvl FROM td.REQ \" &amp; _\n                        \"where RQ_REQ_ID = ? \" &amp; _\n                        \"Union all \" &amp; _\n                        \"select Folders.RQ_REQ_ID, Folders.RQ_REQ_NAME, Folders.RQ_FATHER_ID, Child.lvl +1 from ReqCTE as Child \" &amp; _\n                        \"join td.REQ as Folders on Folders.RQ_REQ_ID = Child.RQ_FATHER_ID); \" &amp; _\n                        \"select * from ReqCTE;\"\n\n\n    Set recset = com.Execute(, par)\n\n    Set XLS = CreateObject(\"Excel.Application\")\n    XLS.Visible = False\n    Set Wkb = XLS.Workbooks.Add\n    Set Wks = Wkb.Worksheets(1)\n\n    i = 1\n    Wks.Cells(i, 1).Value = \"Data\"\n\n\n    If recset.RecordCount &gt; 0 Then\n    i = 2\n    recset.First\n    Do While Not (recset.EOR)\n    Wks.Cells(i, 1).Value = recset.FieldValue(0) 'fieldvalue(0) because the query extract only 1 field.\n    i = i + 1\n    recset.Next\n    Loop\n    Wkb.SaveAs \"C:\\myfile.xls\"\n    End If\n\n\n    Wkb.Close\n    XLS.Quit\n\n    QCConnection.Disconnect\n\n    Set recset = Nothing\n    Set com = Nothing\n    Set QCConnection = Nothing\n    Set XLS = Nothing\n    Set Wkb = Nothing\n    Set Wks = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>UPDATED to avoid injection</p>\n"}], "owner": {"reputation": 2163, "user_id": 546810, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/312f22553424f5b4ade5a58454f871c8?s=128&d=identicon&r=PG", "display_name": "Lokesh Sah", "link": "https://stackoverflow.com/users/546810/lokesh-sah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1037, "favorite_count": 0, "accepted_answer_id": 33780660, "answer_count": 1, "score": 0, "last_activity_date": 1447859010, "creation_date": 1447845828, "last_edit_date": 1531161705, "question_id": 33778781, "link": "https://stackoverflow.com/questions/33778781/how-to-write-a-cte-recursive-query-in-vba-script", "title": "How to write a CTE Recursive Query in VBA script?", "body": "<p>I have a VBA script written to query HP ALM database using OTA API.</p>\n\n<p>I want to query the database using a Recursive CTE. I don't know how to write that script within this VBA script.</p>\n\n<p>VBA Script:::</p>\n\n<pre><code>Sub Extractor()\n\n    Const QCADDRESS = \"http://alm/qcbin\"\n    Const DOMAIN = \"DOMAIN\"\n    Const PROJECT = \"PROJECT\"\n    Const QCUSR = \"user.name\"\n    Const QCPWD = \"123456\"\n\n    Dim QCConnection, com, recset\n    Dim XLS, Wkb, Wks, i\n\n    Set QCConnection = CreateObject(\"TDApiOle80.TDConnection\")\n    QCConnection.InitConnectionEx QCADDRESS\n    QCConnection.Login QCUSR, QCPWD\n    QCConnection.Connect DOMAIN, PROJECT\n\n    Set com = QCConnection.Command\n\n    com.CommandText = \"Select * from ALL_LISTS\"\n\n    Set recset = com.Execute\n\n    Set XLS = CreateObject(\"Excel.Application\")\n    XLS.Visible = False\n    Set Wkb = XLS.Workbooks.Add\n    Set Wks = Wkb.Worksheets(1)\n\n    i = 1\n    Wks.Cells(i, 1).Value = \"Data\"\n\n\n    If recset.RecordCount &gt; 0 Then\n    i = 2\n    recset.First\n    Do While Not (recset.EOR)\n    Wks.Cells(i, 1).Value = recset.FieldValue(0) 'fieldvalue(0) because the query extract only 1 field.\n    i = i + 1\n    recset.Next\n    Loop\n    Wkb.SaveAs \"C:\\myfile.xls\"\n    End If\n\n\n    Wkb.Close\n    XLS.Quit\n\n    QCConnection.Disconnect\n\n    Set recset = Nothing\n    Set com = Nothing\n    Set QCConnection = Nothing\n    Set XLS = Nothing\n    Set Wkb = Nothing\n    Set Wks = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>CTE Query::::</p>\n\n<pre><code>with ReqCTE\nas\n(\nSELECT\nRQ_REQ_ID,\nRQ_REQ_NAME,\nRQ_FATHER_ID, \n0 as lvl\nFROM\ntd.REQ\nwhere\nRQ_REQ_ID = {?Father_ID}\n\nunion all\n\nselect\nFolders.RQ_REQ_ID,\nFolders.RQ_REQ_NAME, \nFolders.RQ_FATHER_ID,\nChild.lvl +1\nfrom\nReqCTE as Child\njoin td.REQ as Folders on Folders.RQ_REQ_ID = Child.RQ_FATHER_ID\n);\n\nselect * from ReqCTE;\n</code></pre>\n"}, {"tags": ["vba", "excel", "pdf", "iframe"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1447849601, "post_id": 33778267, "comment_id": 55326327, "body": "Given that you probably do not want to have to install a redistributable on every computer that will be opening your workbook, I would suggest embedding a browser into a userform. Most everyone already has a browser add-on that can open a PDF and it should be close enough to your iframe idea."}, {"owner": {"reputation": 11, "user_id": 5576179, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BlZoRkEuo8k/AAAAAAAAAAI/AAAAAAAAAOI/jOSQGfIai5Q/photo.jpg?sz=128", "display_name": "Saleem Muhammed", "link": "https://stackoverflow.com/users/5576179/saleem-muhammed"}, "edited": false, "score": 0, "creation_date": 1447990674, "post_id": 33778267, "comment_id": 55402890, "body": "Hi Jeeped; I never thought to that idea. Let me work-around and I shall post the outcome. Thanks :D"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5576179, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BlZoRkEuo8k/AAAAAAAAAAI/AAAAAAAAAOI/jOSQGfIai5Q/photo.jpg?sz=128", "display_name": "Saleem Muhammed", "link": "https://stackoverflow.com/users/5576179/saleem-muhammed"}, "edited": false, "score": 0, "creation_date": 1447990561, "post_id": 33778772, "comment_id": 55402857, "body": "Hi Helena4, thanks for the reply. Here, I do not wanna convert PDF to word/JPEG because te users need to use the pdf tools to check certain items in the pdf and update that to excel. :(. Any spark? thanks in advance."}, {"owner": {"reputation": 284, "user_id": 3286675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/CUYQa.png?s=128&g=1", "display_name": "helena4", "link": "https://stackoverflow.com/users/3286675/helena4"}, "reply_to_user": {"reputation": 11, "user_id": 5576179, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BlZoRkEuo8k/AAAAAAAAAAI/AAAAAAAAAOI/jOSQGfIai5Q/photo.jpg?sz=128", "display_name": "Saleem Muhammed", "link": "https://stackoverflow.com/users/5576179/saleem-muhammed"}, "edited": false, "score": 0, "creation_date": 1448012043, "post_id": 33778772, "comment_id": 55411718, "body": "What awesome tools does pdf have that word 2013 can&#39;t compete with? Either way - if you find a coder to make it happen for you. Either post it for free or sell it online, i imagine its not just you that would like to load pdfs in excel."}], "tags": [], "owner": {"reputation": 284, "user_id": 3286675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/CUYQa.png?s=128&g=1", "display_name": "helena4", "link": "https://stackoverflow.com/users/3286675/helena4"}, "is_accepted": false, "score": 0, "last_activity_date": 1447852984, "last_edit_date": 1495539870, "creation_date": 1447845793, "answer_id": 33778772, "question_id": 33778267, "link": "https://stackoverflow.com/questions/33778267/open-a-pdf-file/33778772#33778772", "title": "Open a .pdf file", "body": "<p>you could probably get the filenames via vba.\nhere's some that claim to work:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba\">Loop through files in a folder using VBA?</a></p>\n\n<p>So far as opening a pdf in excel - thats kinda pushing it.\nSince your request is exotic I can think of an exotic workaround:</p>\n\n<p>If you can spare the interactivity you can simply make copies and convert your pdfs to word formats to work with them and load them in that way. I've seen people convert pdfs to Jpgs just to load them in some other documents but thats rudimentary and really fringe.</p>\n\n<p>Otherwise you are facing a lot of custom coding that needs to make it possible.</p>\n"}], "owner": {"reputation": 11, "user_id": 5576179, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BlZoRkEuo8k/AAAAAAAAAAI/AAAAAAAAAOI/jOSQGfIai5Q/photo.jpg?sz=128", "display_name": "Saleem Muhammed", "link": "https://stackoverflow.com/users/5576179/saleem-muhammed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1447852984, "creation_date": 1447844367, "last_edit_date": 1447844561, "question_id": 33778267, "link": "https://stackoverflow.com/questions/33778267/open-a-pdf-file", "title": "Open a .pdf file", "body": "<p>I am trying to open a .pdf file within Excel like an iframe in HTML. \nMy requirement is:</p>\n\n<ol>\n<li>Save the path of multiple PDF files in Excel. </li>\n<li>Excel should open each .pdf file within Excel itself (no need to open that in a separate .pdf window). </li>\n<li>It should be like iframe in HTML. The user should be able\nto view the .pdf within Excel itself.</li>\n</ol>\n\n<p>I know this is little weird, but can anybody help me?</p>\n"}, {"tags": ["excel", "vba", "tfs", "tfs-workitem", "tfs-sdk"], "comments": [{"owner": {"reputation": 25359, "user_id": 5425825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cb2be754626c633f6062ef8b9b0952f?s=128&d=identicon&r=PG&f=1", "display_name": "Cece Dong - MSFT", "link": "https://stackoverflow.com/users/5425825/cece-dong-msft"}, "edited": false, "score": 0, "creation_date": 1447929165, "post_id": 33778067, "comment_id": 55368414, "body": "There is not a default way to achieve your requirement. To get desired output, you have to do some coding to have your own solution."}, {"owner": {"reputation": 695, "user_id": 585277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82594a5ee232e2caa2b74583a84e222d?s=128&d=identicon&r=PG", "display_name": "Zephan Schroeder", "link": "https://stackoverflow.com/users/585277/zephan-schroeder"}, "reply_to_user": {"reputation": 25359, "user_id": 5425825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cb2be754626c633f6062ef8b9b0952f?s=128&d=identicon&r=PG&f=1", "display_name": "Cece Dong - MSFT", "link": "https://stackoverflow.com/users/5425825/cece-dong-msft"}, "edited": false, "score": 0, "creation_date": 1460593910, "post_id": 33778067, "comment_id": 60820467, "body": "I can accept some coding if there are any APIs or  I can also accept connecting directly (read-only!) to TFS DB tables."}], "owner": {"reputation": 695, "user_id": 585277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82594a5ee232e2caa2b74583a84e222d?s=128&d=identicon&r=PG", "display_name": "Zephan Schroeder", "link": "https://stackoverflow.com/users/585277/zephan-schroeder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2600, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1594150840, "creation_date": 1447843873, "last_edit_date": 1594150840, "question_id": 33778067, "link": "https://stackoverflow.com/questions/33778067/tfs-query-results-with-a-list-of-linked-work-item-ids-in-excel", "title": "TFS Query results with a list of linked work item IDs in Excel?", "body": "<p>How can I get a list of linked work item IDs for a set of work items?</p>\n\n<ul>\n<li>Excel-hosted queries preferred. API Sample is acceptable.</li>\n<li>Direct DB   table query is acceptable (read-only and unsupported of course!)</li>\n</ul>\n\n<p><em>Many thanks in advance! -Zephan</em></p>\n\n<h2>MORE INFORMATION</h2>\n\n<p>UPDATE: No answers for my original Q so broadening scope of acceptable answers as follows:</p>\n\n<ol>\n<li><p>Answer for TFS2015 (migrating very shortly) or TFS2013 (potentially useful for TFS2015) is preferred over TFS2010</p></li>\n<li><p>Coding acceptable if there are any APIs or PowerShell cmdlets (MS or community).</p></li>\n<li><p>Connecting directly (read-only!) to TFS DB tables is acceptable (source tables and related relationship link table names). Yes, directly referencing TFS DB tables is VERY unsupported, read-only, and \"AT YOUR OWN RISK.\" Still beats having to manually copy/paste data or reconstruct list of links in Excel.</p></li>\n</ol>\n\n<h2>ORIGINAL QUESTION &amp; DETAILS</h2>\n\n<p>My team uses TFS2010 (soon 2013 or hoping 2015) and VS2010-2015. I need to support traceability reports and analyze/quantify our coverage of ~300 <strong>Test Case</strong> work items linked to ~400 <strong>Requirement</strong> work items. Direct Link and Tree queries are close but don't give me related links on the same row as parent work item. Many thanks in advance for your suggestions and any related code fragments.</p>\n\n<h2>Example:</h2>\n\n<p>3 test cases (Test1, Test2, Test3)<br>\n4 Requirements (Req1, Req2, Req3, Req4)  </p>\n\n<ul>\n<li>For simplicity let's just use TFS work item IDs to represent each TestN and ReqN. In actuality, I have a keyword to identify my validation requirements (separate from the 1,000's of other requirements in this Team Project). The only Test Case WI I care about for this problem are those linked to one or more Validation Requirement trace-ability.</li>\n</ul>\n\n<p>Scenarios:</p>\n\n<ol>\n<li>1:1 (simple) Test1 is linked to Req1</li>\n<li>1:2 (1:n) Test2 is linked to Req2 and Req3</li>\n<li>2:1 (n:1) Test3 (and Test2) are both linked to Req3</li>\n<li>0:1 (Requirement missing Test coverage) Req4 has no test case links\n\n<ul>\n<li>I have a good coverage gap query by creating a Direct Link query for all Requirements then set \"linking filters\" to Only return items that do not have the specified links.</li>\n</ul></li>\n</ol>\n\n<p>Desired output (all tests with list of related work items):</p>\n\n<pre><code>|Test1 | Req1       |\n|Test2 | Req2, Req3 |\n|Test3 | Req3       |\n</code></pre>\n\n<p>For row #2 I am OK with other separators or even entire list using same separator (.CSV or TAB delimited).\nSkip right to answer now if you have a tidy answer. If not then I added considerable RELATED RESEARCH info below to help kick-start an idea that fits the need! Especially since this hasn't been discoverably solved in the last 5 years :-).</p>\n\n<h1>RELATED RESEARCH (loooong but may be useful)</h1>\n\n<h2>1. Visual Studio Queries</h2>\n\n<ul>\n<li><p><strong>Flat Queries</strong>  should support a list of linked items out-of-the-box... but it does not. RelatedLinkCount field is handy for knowing if there are any links to chase, but that's it for flat queries.\u00a0</p></li>\n<li><p><strong>Direct Link queries</strong> give a list of all direct links, but the related IDs are on rows below the parent work item. I am seriously considering creating a formula to look on the next X rows to build a list of IDs, but this would be fragile especially when over 3 requirements are linked to same test. Still might solve 80% of my tracing needs.</p></li>\n<li><p><strong>Tree Queries</strong> also show links, but on different rows. Additionally they tend to follow just one link type. Ideally I will need list of User Requirements linked to Functional Requirements linked to Test Case(s).</p></li>\n</ul>\n\n<h2>2. Tools / Plug-ins</h2>\n\n<ul>\n<li><strong>SmartExcel4TFS</strong> (eDEVTech, <a href=\"http://www.modernrequirements.com/smartexcel4tfs/\" rel=\"nofollow noreferrer\">http://www.modernrequirements.com/smartexcel4tfs/</a>) has 3 reports it supports, but none get me the core data I need in easily used format. At least it is <a href=\"http://www.modernrequirements.com/?s=MSDN\" rel=\"nofollow noreferrer\">FREE if you have an MSDN Premium subscription</a>.\n\n<ul>\n<li><strong>Requirements to Tests Trace Matrix</strong> is super-interesting. Alass, right now I need to go the other way (Requirements linked to a given test case). Also it merges cells and has sub-sections that are hard to manipulate I think. (I may revisit this option though.)</li>\n<li><strong>Intersection Traceability Matrix</strong> report is WAY too wide for a full 300 x 400 grid :-O.</li>\n<li><strong>Work Item Decomposition Matrix</strong> also didn't give me desired contents. (though frankly I've forgotten this report layout from when I checked ~1 month ago.)</li>\n</ul></li>\n</ul>\n\n<h2>3. TFS API calls</h2>\n\n<p>I have actually avoided this route in favor of native Excel solution... but if I can get an example of Excel VBA code (or other code with link to calling within Excel) I may go this route. At this point I don't have time to dig into rolling my own... but this would be cool assuming performance is acceptable.</p>\n\n<p>Relevant API/code fragments:</p>\n\n<ul>\n<li><p><a href=\"http://blogs.msdn.com/b/jsocha/archive/2012/02/22/retrieving-tfs-results-from-a-tree-query.aspx\" rel=\"nofollow noreferrer\">Retrieving TFS Results from a Tree Query</a> (Blogs.msdn.com 2012.02.22) - Looks like this would get me the data I need, but it is not in Excel so I'd need a bridge example of some sort calling this within Excel.</p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/10748412/retrieving-work-items-and-their-linked-work-items-in-a-single-query-using-the-tf\">Retrieving work items and their linked work items in a single query using the TFS APIs</a> (stackoverflow.com 2012.01.12) - Also looks very promising, but not connected to Excel. Gives hints for 2 level and 3 level nested links and performance consideration (don't make second call for each item returned!)</p></li>\n<li><p><a href=\"http://pwee167.github.io/posts/retrieving-work-items-using-the-team-foundation-server-api/\" rel=\"nofollow noreferrer\">Retrieving work items using the Team Foundation Server API</a> (pwee167.github.io 2012.09.18) - Excellently written introductory walkthrough blog posting to learn how to build an (ASP.Net MVC3) app that calls TFS APIs to run Flat or Tree queries. Start here if writing C# (which I could do but don't have time/justification unless easy example to integrate with Excel).</p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/5956570/how-can-i-query-work-items-and-their-linked-changesets-in-tfs\">How can I query work items and their linked changesets in TFS?</a> (stackoverflow.com 2011.05.10) - I don't need changesets but this has VB code to instantiate new TfsTeamProjectCollection which might work directly in Excel VBA (assuming proper reference is found and added)\n    var projectCollection = new TfsTeamProjectCollection(\n        new Uri(\"<a href=\"http://localhost:8080/tfs\" rel=\"nofollow noreferrer\">http://localhost:8080/tfs</a>\"),\n        new UICredentialsProvider());</p></li>\n</ul>\n\n<p>OK, that's everything I have gathered on this problem. Please help contribute with the missing magic tool/snippet or follow the info above to build that last bit I have not had time to prototype &amp; debug. Many thanks in advance!! <em>-Zephan</em></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "edited": false, "score": 0, "creation_date": 1447843734, "post_id": 33777812, "comment_id": 55322475, "body": "&quot;Changing xlsx to xls just crashes my system.&quot; So if you run your code with the &quot;.xls&quot; files, your Excel crashes? What&#39;s the error? Can you open the &quot;.xls&quot; files manually?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5576062, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156267839720215/picture?type=large", "display_name": "Maximus Parker", "link": "https://stackoverflow.com/users/5576062/maximus-parker"}, "edited": false, "score": 0, "creation_date": 1447848204, "post_id": 33778565, "comment_id": 55325498, "body": "I will attempt to upgrade all users to 2007 but this will cost up to &#163;1000. Is there any possible way I could incorporate something into my VBA to open  all the .xls versions and save them as xlsx? Then my VBA can continue with it&#39;s process and export all the data as text for me then to use?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "reply_to_user": {"reputation": 1, "user_id": 5576062, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156267839720215/picture?type=large", "display_name": "Maximus Parker", "link": "https://stackoverflow.com/users/5576062/maximus-parker"}, "edited": false, "score": 0, "creation_date": 1447848305, "post_id": 33778565, "comment_id": 55325562, "body": "Install the compatibility pack and Excel 2000 should be able to open .xlsx"}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1447845147, "creation_date": 1447845147, "answer_id": 33778565, "question_id": 33777812, "link": "https://stackoverflow.com/questions/33777812/vba-code-to-open-different-versions-of-excel-files-as-some-users-are-using-offi/33778565#33778565", "title": "VBA code to open different versions of excel files, as some users are using office 2000 and some are using office 2013", "body": "<p>The VBA would work however Excel 2000 cannot by default open .xlsx files.  </p>\n\n<p>Either have whatever is generating the files in the first place switch to generating .xls format files or install the <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=3\" rel=\"nofollow\">Office 2007 Compatibility Pack</a> on machines running Office 2000 to enable them to work with the newer format files.</p>\n"}], "owner": {"reputation": 1, "user_id": 5576062, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156267839720215/picture?type=large", "display_name": "Maximus Parker", "link": "https://stackoverflow.com/users/5576062/maximus-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447845147, "creation_date": 1447843147, "question_id": 33777812, "link": "https://stackoverflow.com/questions/33777812/vba-code-to-open-different-versions-of-excel-files-as-some-users-are-using-offi", "title": "VBA code to open different versions of excel files, as some users are using office 2000 and some are using office 2013", "body": "<p>Here is my VBA code.\nIt currently opens all excel documents in a file that are xlsx and the name of each document ends with \"Daily\" in the name. I have unfortunately just found that several users of these documents will be accessing them through a much older version of excel \"2000\" and my VBA will not work with their versions? \nCan someone help me? Changing xlsx to xls just crashes my system.**</p>\n\n<pre><code>Option Explicit\n\nPublic Sub processFiles()\n\nDim strProductivityFiles As String, strProductivityArchive As String,       \nstrProductivityResult As String\n\nLet Application.DisplayAlerts = False\n\nLet strProductivityFiles = \"\\*Daily.xlsx*\"\nLet strProductivityArchive = \"\\Archive\\\"\nLet strProductivityResult = \"\\daily_productivity.txt\"\n\nAgentProductivity strProductivityFiles, strProductivityArchive,\nstrProductivityResult\n\nLet Application.DisplayAlerts = True\n\nApplication.ActiveWorkbook.Close\n\nEnd Sub\n\nPrivate Sub AgentProductivity(strImportFile As String, strArchivePath As    \nString, strResultFile As String)\n\nDim wbk As Workbook\nDim wbkData As Workbook\nDim wksData As Worksheet\nDim namData As Name\nDim ranData As Range\nDim ranCell As Range\nDim strAgent As String\nDim strQueue As String\nDim datDate As Date\nDim dblVolume As Double\nDim dblTime As Double\nDim lngArrayRow As Long\nDim varOutput() As Variant\nReDim varOutput(200000, 12)\n\nSet wbk = Application.ActiveWorkbook\n\nIf (Dir(wbk.Path &amp; strResultFile) &lt;&gt; \"\") Then\nKill wbk.Path &amp; strResultFile\nEnd If\n\nLet strImportFile = Dir(wbk.Path &amp; strImportFile)\nLet lngArrayRow = 0\n\nDo While strImportFile &lt;&gt; \"\"\nIf Right(strImportFile, 4) = \"xlsx*\" Then\n\n    Set wbkData = Workbooks.Open(wbk.Path &amp; \"\\\" &amp; strImportFile)\n    'Let lngArrayRow = 0\n    'ReDim Preserve varOutput(20000, 5)\n\n    For Each namData In wbkData.Names\n        If (namData.Name = \"Data\") Then\n            Set ranData = Range(namData)\n        End If\n        If (namData.Name = \"User\") Then\n            Let strAgent = Range(namData).Value\n        End If\n    Next namData\n\n    For Each ranCell In ranData\n        If (ranCell.Row &gt;= 3) And (ranCell.Column &gt;= 3) And ((ranCell.Row  \n    Mod 2) &gt; 0) Then\n            Let strQueue = Cells(ranCell.Row, 1)\n            Let datDate = Cells(2, ranCell.Column)\n            Let dblVolume = Cells(ranCell.Row + 1, ranCell.Column)\n            Let dblTime = Cells(ranCell.Row, ranCell.Column)\n            If (dblVolume &gt; 0) Or (dblTime &gt; 0) Then\n                Let varOutput(lngArrayRow, 0) = strAgent\n                Let varOutput(lngArrayRow, 1) = strQueue\n                Let varOutput(lngArrayRow, 2) = datDate\n                Let varOutput(lngArrayRow, 3) = dblVolume\n                Let varOutput(lngArrayRow, 4) = dblTime\n                Let lngArrayRow = lngArrayRow + 1\n            End If\n        End If\n    Next ranCell\n\n    wbkData.SaveAs wbk.Path &amp; strArchivePath &amp; wbkData.Name,   \n    xlOpenXMLWorkbook\n    wbkData.Close\n\n    Let strImportFile = Dir()\n\n    End If\n    Loop\n\nExportData5Fields wbk.Path &amp; strResultFile, varOutput\n\nEnd Sub\n\nPrivate Sub ExportData5Fields(strFile As String, varArray() As Variant)\n\nDim lngFile As Long\nLet lngFile = FreeFile()\nDim lngCounter As Long\n\nIf (Dir(strFile) &lt;&gt; \"\") Then\nOpen strFile For Append As #lngFile\nElse\nOpen strFile For Append As #lngFile\nPrint #lngFile, \"\"\"\" &amp; \"CitrixID\" &amp; \"\"\",\" &amp; _\n                \"\"\"\" &amp; \"Workstream\" &amp; \"\"\",\" &amp; _\n                \"\"\"\" &amp; \"Date\" &amp; \"\"\",\" &amp; _\n                \"\"\"\" &amp; \"Volume\" &amp; \"\"\",\" &amp; _\n                \"\"\"\" &amp; \"Minutes\" &amp; \"\"\"\"\nEnd If\n\nFor lngCounter = 0 To UBound(varArray, 1)\nIf Not IsEmpty(varArray(lngCounter, 0)) Then\n    Print #lngFile, \"\"\"\" &amp; varArray(lngCounter, 0) &amp; \"\"\",\" &amp; _\n                    \"\"\"\" &amp; varArray(lngCounter, 1) &amp; \"\"\",\" &amp; _\n                    \"\"\"\" &amp; varArray(lngCounter, 2) &amp; \"\"\",\" &amp; _\n                    \"\"\"\" &amp; varArray(lngCounter, 3) &amp; \"\"\",\" &amp; _\n                    \"\"\"\" &amp; varArray(lngCounter, 4) &amp; \"\"\"\"\nEnd If\nNext lngCounter\n\nenter code here\n\nClose #lngFile\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "outlook", "vba", "exchange-server"], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447867121, "post_id": 33780358, "comment_id": 55339543, "body": "I think you missed the <code>Outlook&#47;Exchange 2013</code> part."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447894112, "post_id": 33780358, "comment_id": 55353520, "body": "Yep I did. Please don&#39;t downvote me. I have kids to feed."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447918530, "post_id": 33780358, "comment_id": 55361547, "body": "Hahaha :-) You are aware that you can delete your answer? @Delmer"}], "tags": [], "owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "is_accepted": false, "score": 0, "last_activity_date": 1447850419, "creation_date": 1447850419, "answer_id": 33780358, "question_id": 33777791, "link": "https://stackoverflow.com/questions/33777791/microsoft-access-vba-create-public-folder-subfolder/33780358#33780358", "title": "Microsoft Access VBA Create Public-Folder Subfolder", "body": "<p>Use the Shell command in VBA. You can execute DOS commands to make folders. \n<a href=\"https://msdn.microsoft.com/en-us/library/office/gg278437%28v=office.15%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/gg278437%28v=office.15%29.aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1447852129, "creation_date": 1447852129, "answer_id": 33780948, "question_id": 33777791, "link": "https://stackoverflow.com/questions/33777791/microsoft-access-vba-create-public-folder-subfolder/33780948#33780948", "title": "Microsoft Access VBA Create Public-Folder Subfolder", "body": "<p>No doubt this code can be tidied up.  It will create a folder called 'New One' within the Inbox.\nYou'll need to update the code to point to the correct folder and ask for the new name.    </p>\n\n<pre><code>Sub CreateFolder()\n\n        Dim oOutlook As Object          'Outlook.Application\n        Dim nNameSpace As Object        'Outlook.Namespace\n        Dim oFolder As Object\n\n        Dim sFolder As String\n        sFolder = \"Mailbox - Bill Gates\\Inbox\"\n\n        Set oOutlook = CreateObject(\"Outlook.Application\")\n        Set nNameSpace = oOutlook.GetNameSpace(\"MAPI\")\n\n        Set oFolder = GetFolderPath(sFolder)\n        oFolder.Folders.Add \"New One\" 'Add the 'New One' folder to the Inbox.\n\n    End Sub\n\n    '----------------------------------------------------------------------------------\n    ' Procedure : GetFolderPath\n    ' Author    : Diane Poremsky\n    ' Date      : 09/06/2015\n    ' Original  : http://www.slipstick.com/developer/working-vba-nondefault-outlook-folders/\n    ' Purpose   :\n    '-----------------------------------------------------------------------------------\n    Function GetFolderPath(ByVal FolderPath As String) As Object 'Outlook.Folder\n\n        Dim oOutlook As Object          'Outlook.Application\n        Dim nNameSpace As Object        'Outlook.Namespace\n\n        Dim oFolder As Object 'Outlook.Folder\n        Dim FoldersArray As Variant\n        Dim i As Integer\n\n        On Error GoTo GetFolderPath_Error\n\n        Set oOutlook = CreateObject(\"Outlook.Application\")\n\n        If Left(FolderPath, 2) = \"\\\\\" Then\n            FolderPath = Right(FolderPath, Len(FolderPath) - 2)\n        End If\n        FoldersArray = Split(FolderPath, \"\\\")\n        Set oFolder = oOutlook.Session.Folders.Item(FoldersArray(0))\n        If Not oFolder Is Nothing Then\n            For i = 1 To UBound(FoldersArray, 1)\n                Dim SubFolders As Object\n                Set SubFolders = oFolder.Folders\n                Set oFolder = SubFolders.Item(FoldersArray(i))\n                If oFolder Is Nothing Then\n                    Set GetFolderPath = Nothing\n                End If\n            Next\n        End If\n        Set GetFolderPath = oFolder\n        Exit Function\n\n    GetFolderPath_Error:\n        Set GetFolderPath = Nothing\n        Exit Function\n    End Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4580569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/053a3c04c9bf4ed53a6ae6a897e76b18?s=128&d=identicon&r=PG&f=1", "display_name": "Zak Hargreaves", "link": "https://stackoverflow.com/users/4580569/zak-hargreaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 614, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1449692919, "creation_date": 1447843107, "last_edit_date": 1449692919, "question_id": 33777791, "link": "https://stackoverflow.com/questions/33777791/microsoft-access-vba-create-public-folder-subfolder", "title": "Microsoft Access VBA Create Public-Folder Subfolder", "body": "<p>I'm looking for some advice on Microsoft Access VBA - Basically, I have been asked to create a button on a form, upon this button being clicked it will display a box asking for a folder name (I can manually type in, then click 'Ok') which will then create a subfolder in a public folder within Outlook/Exchange 2013.</p>\n\n<p>Any information / advice on this would be fantastic. I have tried some examples on the Internet but my VBA knowledge doesn't allow me to amend the code for my needs.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1447841778, "post_id": 33777031, "comment_id": 55321067, "body": "Add <code>xl.Quit</code> to your code."}, {"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1447842724, "post_id": 33777031, "comment_id": 55321751, "body": "Give us a bare bones demo to repro. People lets try and solve this without resorting to killing the Excel.exe process"}, {"owner": {"reputation": 382, "user_id": 4478288, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f2e89e5d8a9f55e63df7b1936f7c75bd?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty", "link": "https://stackoverflow.com/users/4478288/lefty"}, "reply_to_user": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1447843480, "post_id": 33777031, "comment_id": 55322308, "body": "@JeremyThompson OK, I&#39;ll add it to the question, give me a few minutes to strip it down...."}], "answers": [{"comments": [{"owner": {"reputation": 382, "user_id": 4478288, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f2e89e5d8a9f55e63df7b1936f7c75bd?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty", "link": "https://stackoverflow.com/users/4478288/lefty"}, "edited": false, "score": 0, "creation_date": 1447842285, "post_id": 33777292, "comment_id": 55321436, "body": "Thanks for this, I&#39;ve just tried it and it seems to be releasing the spreadsheet now - but the EXCEL process still remains in my task manager. That&#39;s obviously a minor problem but it does make me think I&#39;m doing something else wrong...?"}, {"owner": {"reputation": 361, "user_id": 4406125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d283087551dc05b73a84f9efdd24e43b?s=128&d=identicon&r=PG&f=1", "display_name": "area9", "link": "https://stackoverflow.com/users/4406125/area9"}, "reply_to_user": {"reputation": 382, "user_id": 4478288, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f2e89e5d8a9f55e63df7b1936f7c75bd?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty", "link": "https://stackoverflow.com/users/4478288/lefty"}, "edited": false, "score": 0, "creation_date": 1447842966, "post_id": 33777292, "comment_id": 55321939, "body": "ok, how about this: Excel.Application.quit instead of xl.quit - I don&#39;t see you creating an instance of the application in your code."}, {"owner": {"reputation": 382, "user_id": 4478288, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f2e89e5d8a9f55e63df7b1936f7c75bd?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty", "link": "https://stackoverflow.com/users/4478288/lefty"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1447864368, "post_id": 33777292, "comment_id": 55337612, "body": "@Macro Man/@area9 Excellent! That actually did it! I just made it &quot;New&quot; and commented the &quot;Set&quot; and that did the job. In words of one syllable, are you able to explain why this works please?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 382, "user_id": 4478288, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f2e89e5d8a9f55e63df7b1936f7c75bd?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty", "link": "https://stackoverflow.com/users/4478288/lefty"}, "edited": false, "score": 0, "creation_date": 1447864448, "post_id": 33777292, "comment_id": 55337668, "body": "@Lefty sure, have a <a href=\"http://stackoverflow.com/questions/32498851/reason-for-setting-variables-in-vba/32499195#32499195\">read of this</a>"}, {"owner": {"reputation": 382, "user_id": 4478288, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f2e89e5d8a9f55e63df7b1936f7c75bd?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty", "link": "https://stackoverflow.com/users/4478288/lefty"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1447866207, "post_id": 33777292, "comment_id": 55338927, "body": "@MacroMan That is an excellent explanation of something that&#39;s always troubled me: Dim/Set/New. I understand that somewhat better now but will have to re-read a few times I think. So, (if I understand correctly) in your solution, &quot;New&quot; is the important thing, it forces initialisation of the object. Does that mean that it can successfully be destroyed at the end as in Jeremy Thompson&#39;s comment about Garbage Collection?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1447866804, "post_id": 33777292, "comment_id": 55339353, "body": "Garbage Collection is pretty specific to more complex OOP languages - in VBA, assuming you&#39;re not working with a really old version - any variables that go out of scope are automatically destroyed. If you&#39;ve started a <i>process</i> however (such as an application) then you need to explicitly end that process through it&#39;s native method (such as <code>.Quit</code>) before it&#39;s destroyed"}, {"owner": {"reputation": 361, "user_id": 4406125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d283087551dc05b73a84f9efdd24e43b?s=128&d=identicon&r=PG&f=1", "display_name": "area9", "link": "https://stackoverflow.com/users/4406125/area9"}, "edited": false, "score": 0, "creation_date": 1447867108, "post_id": 33777292, "comment_id": 55339533, "body": "&quot;New&quot; creates an instance of the object. if you reference it to a variable, then you can control it: xl.quit, set xl = nothing etc. Think what your code was doing before was just opening a workbook and, after some code, closing it - you had no reference to the application, only the workbook in the application. By referencing the application, you can close that instance and would therefore not affect other excel instances you may have open at the same time."}, {"owner": {"reputation": 382, "user_id": 4478288, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f2e89e5d8a9f55e63df7b1936f7c75bd?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty", "link": "https://stackoverflow.com/users/4478288/lefty"}, "edited": false, "score": 0, "creation_date": 1448093910, "post_id": 33777292, "comment_id": 55447146, "body": "@area9 All this seems very logical to me - however, issuing the QUIT to Excel DID NOT actually make Excel quit. What did the job was when I changed the Dim to &quot;New&quot; for the &quot;xl&quot; variable. I&#39;m really having trouble understanding that."}], "tags": [], "owner": {"reputation": 361, "user_id": 4406125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d283087551dc05b73a84f9efdd24e43b?s=128&d=identicon&r=PG&f=1", "display_name": "area9", "link": "https://stackoverflow.com/users/4406125/area9"}, "is_accepted": true, "score": 1, "last_activity_date": 1447849799, "last_edit_date": 1447849799, "creation_date": 1447841774, "answer_id": 33777292, "question_id": 33777031, "link": "https://stackoverflow.com/questions/33777031/locking-excel-spreadsheet/33777292#33777292", "title": "Locking Excel spreadsheet", "body": "<pre><code>xl.quit\n</code></pre>\n\n<p>This will close the application (you are only closing the workbook and not the application in your code), so just put this before setting the variable to nothing.</p>\n\n<p>Edit: Please change your sub to the following:</p>\n\n<pre><code>Dim xl As New Excel.Application\nDim xlwb As Excel.Workbook\nDim xlsheet As Excel.Worksheet\nDim ol As Outlook.Application\nDim Mail As MailItem\n\nSet ol = Outlook.Application\nSet xlwb = xl.Workbooks.Open(\"C:\\sheet.xlsx\", ReadOnly)\nFor Each xlsheet In xlwb.Worksheets\n\nFor xlRow = 1 To 5\n\nIf xlsheet.Cells(xlRow, 1).Value = \"John\" Then\n    msg = msg &amp; xlsheet.Cells(xlRow, 2).Value\n\nEnd If\n\nNext\n\nNext\n\nSet Mail = ol.CreateItem(olMailItem)\n\nMail.To = \"A@b.c\"\nMail.Subject = \"John's email\"\nMail.Body = msg\nMail.Send\n\nxlwb.Close\n\nxl.Quit\n\nSet ol = Nothing\nSet xlsheet = Nothing\nSet xlwb = Nothing\nSet xl = Nothing\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 382, "user_id": 4478288, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f2e89e5d8a9f55e63df7b1936f7c75bd?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty", "link": "https://stackoverflow.com/users/4478288/lefty"}, "edited": false, "score": 0, "creation_date": 1447842485, "post_id": 33777466, "comment_id": 55321581, "body": "Thanks, see my comment to area9&#39;s answer. I tend to do the &quot;Nothing&quot; thing as good practice when I remember and I always add it in desperation when I get this kind of problem. It never seems to help!"}, {"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1447844319, "post_id": 33777466, "comment_id": 55322873, "body": "Hey mate, +10 cause you&#39;re right, the core object model objects aren&#39;t being released. Hence the exe has a root ref <i>somehwere</i> and the garbage collector cant pick it up and finalize that last method or two. So the GC completes this resurrection process and once its happy can do the malloc operation."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1447849980, "post_id": 33777466, "comment_id": 55326575, "body": "Glad someone else realises this! <code>Set xl = Nothing</code> basically detaches the object reference from the variable - it does nothing to the instance of Excel that&#39;s been created. Unless you&#39;re working with really old VBA, variables are cleared down once they go out of scope anyway so no need for this."}], "tags": [], "owner": {"reputation": 55, "user_id": 5541800, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156874785225377/picture?type=large", "display_name": "Alex Gale", "link": "https://stackoverflow.com/users/5541800/alex-gale"}, "is_accepted": false, "score": 2, "last_activity_date": 1447842251, "creation_date": 1447842251, "answer_id": 33777466, "question_id": 33777031, "link": "https://stackoverflow.com/questions/33777031/locking-excel-spreadsheet/33777466#33777466", "title": "Locking Excel spreadsheet", "body": "<p>you need to Quit the Application <code>xl.Quit</code> the <code>Set \"\" = Nothing</code> isn't really necessary</p>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1447864676, "creation_date": 1447864676, "answer_id": 33785528, "question_id": 33777031, "link": "https://stackoverflow.com/questions/33777031/locking-excel-spreadsheet/33785528#33785528", "title": "Locking Excel spreadsheet", "body": "<p>You could try something like this</p>\n\n<pre><code>Option Explicit\nSub Excel()\n    '//  Declare variables\n    Dim xlApp As Excel.Application\n    Dim xlWb As Excel.Workbook\n    Dim xlSheet As Excel.Worksheet\n    Dim xlStarted As Boolean\n\n\n    On Error Resume Next\n    Set xlApp = GetObject(, \"Excel.Application\")\n\n    If Err &lt;&gt; 0 Then\n        Application.StatusBar = \"Please wait while Excel source is opened ... \"\n        Set xlApp = CreateObject(\"Excel.Application\")\n        xlStarted = True\n    End If\n\n\n\n    ' your code here\n\n\n\n\n    '// Close &amp; SaveChanges\n    xlWb.Close SaveChanges:=True\n    If xlStarted Then\n        xlApp.Quit\n    End If\n\n    '// clean up\n    Set xlApp = Nothing\n    Set xlWb = Nothing\n    Set xlSheet = Nothing\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 382, "user_id": 4478288, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f2e89e5d8a9f55e63df7b1936f7c75bd?s=128&d=identicon&r=PG&f=1", "display_name": "Lefty", "link": "https://stackoverflow.com/users/4478288/lefty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 33777292, "answer_count": 3, "score": 1, "last_activity_date": 1593518239, "creation_date": 1447841128, "last_edit_date": 1593518239, "question_id": 33777031, "link": "https://stackoverflow.com/questions/33777031/locking-excel-spreadsheet", "title": "Locking Excel spreadsheet", "body": "<p>I've written a program in Outlook VBA which creates some emails dependent upon the contents of an Excel spreadsheet. It all works fine, BUT when the program terminates I continue to have an \"EXCEL.EXE\" process running which locks the spreadsheet so no-one else can open it.</p>\n\n<p>Within the code I have three Excel objects: </p>\n\n<pre><code>Dim xl As Excel.Application\nDim xlwb As Excel.Workbook\nDim xlsheet As Excel.Worksheet\n</code></pre>\n\n<p>At the end I close the workbook and set all of the variables to Nothing:</p>\n\n<pre><code>xlwb.Close\n\nSet xlsheet = Nothing\nSet xlwb = Nothing\nSet xl = Nothing\n</code></pre>\n\n<p>What am I missing?</p>\n\n<p>EDIT:</p>\n\n<p>This is the bare bones of the code including the new \"Quit\" line:</p>\n\n<pre><code>Dim xl As Excel.Application\nDim xlwb As Excel.Workbook\nDim xlsheet As Excel.Worksheet\nDim ol As Outlook.Application\nDim Mail As MailItem\nSet xl = Excel.Application\nSet ol = Outlook.Application\nSet xlwb = xl.Workbooks.Open(\"C:\\sheet.xlsx\", ReadOnly)\nFor Each xlsheet In xlwb.Worksheets\n\nfor xlrow = 1 to 5\n\nIf xlsheet.Cells(xlRow, 1).Value = \"John\" Then\n\n   msg=msg &amp; xlsheet.Cells(xlRow, 2).Value\n\nend if\n\nnext\n\nnext\n\nSet Mail = ol.CreateItem(olMailItem)\n\nMail.To = \"A@b.c\"\nMail.Subject = \"John's email\"\nMail.Body = msg\nMail.Send\n\nxlwb.Close\n\nxl.Quit\n\nSet ol = Nothing\nSet xlsheet = Nothing\nSet xlwb = Nothing\nSet xl = Nothing\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447839331, "post_id": 33775870, "comment_id": 55319245, "body": "Why is A7 in the <a href=\"http://i.stack.imgur.com/aTmXm.png\" rel=\"nofollow noreferrer\">Data Sample</a> blank?"}, {"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 0, "creation_date": 1447839472, "post_id": 33775870, "comment_id": 55319362, "body": "I guess [A8:A10] should rather be at [A7:A9]"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1447846343, "post_id": 33775870, "comment_id": 55324291, "body": "Matches of what? You picture does not show the desired results."}, {"owner": {"reputation": 11, "user_id": 3324004, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/730675294/picture?type=large", "display_name": "Asim Adnan", "link": "https://stackoverflow.com/users/3324004/asim-adnan"}, "edited": false, "score": 0, "creation_date": 1447851113, "post_id": 33775870, "comment_id": 55327403, "body": "added details now! i want to know how many of the things in the column [C:3,C:5] (the size of this will be variable) are present in each bundle in each sheet"}], "answers": [{"tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 0, "last_activity_date": 1447840411, "last_edit_date": 1592644375, "creation_date": 1447839447, "answer_id": 33776377, "question_id": 33775870, "link": "https://stackoverflow.com/questions/33775870/how-to-loop-through-selected-portions-of-all-sheets/33776377#33776377", "title": "How to loop through selected portions of all sheets?", "body": "<blockquote>\n<p>(1) So how do i break where one bundle ends and next starts?<br />\n(2) how do i stop when i have reached the end of the sheet?</p>\n<p>How can i do this in VBA?<br />\nLike this:</p>\n</blockquote>\n<pre><code>Private Sub CommandButton1_Click()\n  Dim i As Long, j As Long, lastrow As Long\n  'use every sheet exept the first one\n  For i = 2 To Sheets.Count\n    'get last row / last entry\n    lastrow = Sheets(i).Cells(Rows.Count, 1).End(xlUp).Row '(2)\n    'loop from second to last used row\n    For j = 2 To lastrow\n \n      'here comes your code like Sheets(i).Cells(j,x) (x is the column)\n      'if len(Sheets(i).Cells(j,1)) and len(Sheets(i).Cells(j,1)) = 0 then &lt;- this is the header of a new group (1)\n   \n    Next\n  Next\nEnd Sub\n</code></pre>\n<p>Asuming there is allways text in column A<br />\nAsuming there is never text in column B at headers</p>\n<p>There is no looking for your data or something like that... still its not clear what you want as return.</p>\n"}, {"comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1447846700, "post_id": 33776454, "comment_id": 55324536, "body": "What would the OP do with this code? Why <code>i=1</code>? Why <code>lastRow = 1</code>? lastrow should be <code>Long</code>, enter something in row 33,000 and see what happens when you run the code"}, {"owner": {"reputation": 9042, "user_id": 5343269, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/b89476ecccf2af60e01baaf9190eb5c3?s=128&d=identicon&r=PG&f=1", "display_name": "11thdimension", "link": "https://stackoverflow.com/users/5343269/11thdimension"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1447850197, "post_id": 33776454, "comment_id": 55326743, "body": "That&#39;s right, they should be Long, edited my answer. I just have a habit of initializing variables, started since the C days. Here it was justified as the the initial value would be 0, and after modifying 10s of times, I finally might miss it and pass it as 0 to Cells or Rows."}], "tags": [], "owner": {"reputation": 9042, "user_id": 5343269, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/b89476ecccf2af60e01baaf9190eb5c3?s=128&d=identicon&r=PG&f=1", "display_name": "11thdimension", "link": "https://stackoverflow.com/users/5343269/11thdimension"}, "is_accepted": false, "score": 0, "last_activity_date": 1447850068, "last_edit_date": 1447850068, "creation_date": 1447839668, "answer_id": 33776454, "question_id": 33775870, "link": "https://stackoverflow.com/questions/33775870/how-to-loop-through-selected-portions-of-all-sheets/33776454#33776454", "title": "How to loop through selected portions of all sheets?", "body": "<pre><code>lastRowNum = sheet1.Cells.Find(\"*\",SearchOrder:=xlByRows,SearchDirection:=xlPrevious).Row\n</code></pre>\n\n<p>Above is the most reliable method of finding the last filled row in an Excel sheet. Half of your task is done after using this.</p>\n\n<p>To check for the start of the a new group you can check if the current row contains \"Bundle/Group\" in column A. Check the example code below</p>\n\n<pre><code>Function test()\n    Dim sh As Worksheet\n    Dim lastRow As Long\n    lastRow = 1\n    Dim i As Long\n    Dim groupSearchText As String\n    groupSearchText = \"Bundle/Group\"\n\n    For Each sh In Worksheets\n        If sh.Index &lt;&gt; 1 Then\n            lastRow = sh.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n            i = 1\n            For i = 1 To lastRow\n                Dim aValue As String\n                Dim cValue As String\n                aValue = sh.Cells(i, 1)\n                cValue = sh.Cells(i, 3)\n\n                If Left(Trim(aValue), Len(groupSearchText)) = groupSearhText Then\n                    ''''group code here, do something with cValue\n                End If\n            Next i\n        End If\n    Next sh\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3324004, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/730675294/picture?type=large", "display_name": "Asim Adnan", "link": "https://stackoverflow.com/users/3324004/asim-adnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1455467778, "creation_date": 1447838080, "last_edit_date": 1455467778, "question_id": 33775870, "link": "https://stackoverflow.com/questions/33775870/how-to-loop-through-selected-portions-of-all-sheets", "title": "How to loop through selected portions of all sheets?", "body": "<p>I have a few Excel sheets with some data like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ni1sN.png\" rel=\"nofollow noreferrer\">Sample Data</a></p>\n\n<p>All sheets have same format one sheet can have many <strong>Groups</strong>. I want to search each group of data in each sheet. I have a list of data in column 3 of my first sheet and a command button.</p>\n\n<p><img src=\"https://i.stack.imgur.com/zaKpG.png\" alt=\"data to be searched\"></p>\n\n<p>What I want to achieve is that when I click the command button, it loops through each group of each sheet and find how many matches were found.\nAnd then show me the result on first sheet.</p>\n\n<p>I want to search each group against a list of data in first sheet.</p>\n\n<p>I want to know how many of the things in the column [C:3,C:5] (the size of this will be variable) are present in each bundle in each sheet</p>\n\n<p>So how do I break where one bundle ends and next starts?  </p>\n\n<p>How do I stop when I have reached the end of the sheet?</p>\n\n<p>I am fairly new to VBA so I know I need to do something like this:</p>\n\n<pre><code>    n=number of worksheets\n    for each worksheet (2 to n) \n    count=0\n      for each row i in column 2\n            for each row j in sheet1.column2\n                while(j not empty)\n                  if(i == j)\n                  count++\n                endwhile\n                output.sheet1.column4(count)\n            endfor\n      endfor\n    endfor \n</code></pre>\n\n<p>How can I do this in VBA?</p>\n\n<pre><code>    Private Sub CommandButton1_Click()\n    Dim ws As Worksheet, myCounter\n    Dim erow, myCounter As Long\n\n    myCounter = 1\n    For Each ws In Sheets\n        For i = 1 To Rows.Count\n            if cells(i,3) = ___                \n    Next ws\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "word-template"], "answers": [{"comments": [{"owner": {"reputation": 428, "user_id": 2319414, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e338eeb42f4a45404306131fc661d9eb?s=128&d=identicon&r=PG", "display_name": "S.aad", "link": "https://stackoverflow.com/users/2319414/s-aad"}, "edited": false, "score": 0, "creation_date": 1448010802, "post_id": 33785067, "comment_id": 55410887, "body": "Thank you for the response. The pasted image is shrinking to a very small size. How do i retain dimension of the picture content control in which it is being pasted. <a href=\"http://my.jetscreenshot.com/24060/20151120-6ufi-67kb.jpg\" rel=\"nofollow noreferrer\">Here</a> is a screen shot of simply copying from one content control into another of the same size"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 428, "user_id": 2319414, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e338eeb42f4a45404306131fc661d9eb?s=128&d=identicon&r=PG", "display_name": "S.aad", "link": "https://stackoverflow.com/users/2319414/s-aad"}, "edited": false, "score": 1, "creation_date": 1448031205, "post_id": 33785067, "comment_id": 55424100, "body": "In my tests, there was no change in picture  or content control size: the content control resized to fit the different picture. So without more information on how to reproduce your situation it&#39;s impossible to say why that may be happening. The only thing I can suggest is to query the InlineShape&#39;s WIdth and/Or Height property and reapply it after pasting."}, {"owner": {"reputation": 428, "user_id": 2319414, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e338eeb42f4a45404306131fc661d9eb?s=128&d=identicon&r=PG", "display_name": "S.aad", "link": "https://stackoverflow.com/users/2319414/s-aad"}, "edited": false, "score": 0, "creation_date": 1448343401, "post_id": 33785067, "comment_id": 55536200, "body": "Thank you for pointing me in a direction. My content control is inside a text box that is on a shape could that be causing trouble?"}, {"owner": {"reputation": 428, "user_id": 2319414, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e338eeb42f4a45404306131fc661d9eb?s=128&d=identicon&r=PG", "display_name": "S.aad", "link": "https://stackoverflow.com/users/2319414/s-aad"}, "edited": false, "score": 0, "creation_date": 1448347050, "post_id": 33785067, "comment_id": 55537673, "body": "When i pasted it and resized it it induced itself an <a href=\"http://my.jetscreenshot.com/24060/20151124-y23q-15kb.jpg\" rel=\"nofollow noreferrer\">abnormal width</a>. <a href=\"http://my.jetscreenshot.com/24060/20151124-g08l-101kb.jpg\" rel=\"nofollow noreferrer\">Here</a> is my code."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 428, "user_id": 2319414, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e338eeb42f4a45404306131fc661d9eb?s=128&d=identicon&r=PG", "display_name": "S.aad", "link": "https://stackoverflow.com/users/2319414/s-aad"}, "edited": false, "score": 0, "creation_date": 1448379557, "post_id": 33785067, "comment_id": 55558064, "body": "It could have something to do with &quot;inside a text box that is on a shape&quot; - hard to say at this remove. Can you explain why you&#39;re using this kind of &quot;layering&quot;? Would a table work (at least instead of the text box)? Other than that I can only recommend testing as an end-user - trying out various things - until you find a combination that works."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 1, "last_activity_date": 1447863420, "creation_date": 1447863420, "answer_id": 33785067, "question_id": 33775827, "link": "https://stackoverflow.com/questions/33775827/is-there-a-way-to-swap-images-between-content-controls/33785067#33785067", "title": "Is there a way to swap images between content controls?", "body": "<p>This appears to work. It assumes that the content controls are of the Picture type (which is why you've probably been having difficulties switching the contents). One of the pictures is saved to the Clipboard, while the other is put at the end of the document. The one from the clipboard is pasted into the other control, then that at the end of the document is cut and pasted into the first control.</p>\n\n<pre><code>Dim cc1 As word.ContentControl, cc2 As word.ContentControl\nDim ils1 As word.InlineShape, ils2 As word.InlineShape\nDim doc As word.Document, rngTemp As word.Range\n\nSet doc = ActiveDocument\nSet rngTemp = doc.content\nrngTemp.Collapse wdCollapseEnd\nSet cc1 = doc.Contentcontrols(1)\nSet cc2 = doc.Contentcontrols(2)\nSet ils1 = cc1.Range.InlineShapes(1)\nSet ils2 = cc2.Range.InlineShapes(1)\n\nils1.Range.Copy\nrngTemp.FormattedText = ils2.Range.FormattedText\nils2.Range.Paste\nrngTemp.Cut\nils1.Range.Paste\n</code></pre>\n"}], "owner": {"reputation": 428, "user_id": 2319414, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e338eeb42f4a45404306131fc661d9eb?s=128&d=identicon&r=PG", "display_name": "S.aad", "link": "https://stackoverflow.com/users/2319414/s-aad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 604, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1447863420, "creation_date": 1447837926, "question_id": 33775827, "link": "https://stackoverflow.com/questions/33775827/is-there-a-way-to-swap-images-between-content-controls", "title": "Is there a way to swap images between content controls?", "body": "<p>The question pretty much explains every thing. I want to know if there is a way to change image in a picture content control from an image in another picture content control using vba.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1447837836, "post_id": 33775710, "comment_id": 55318187, "body": "You have a reference problem. What references do you have checked in the project?"}], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1447841663, "post_id": 33776767, "comment_id": 55320982, "body": "You cannot change the Excel reference in an Excel workbook, nor would you ever need to because that <b>will</b> adjust automatically."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1447849819, "post_id": 33776767, "comment_id": 55326467, "body": "Respectfully, this answer cannot possibly be correct."}], "tags": [], "owner": {"reputation": 361, "user_id": 4406125, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d283087551dc05b73a84f9efdd24e43b?s=128&d=identicon&r=PG&f=1", "display_name": "area9", "link": "https://stackoverflow.com/users/4406125/area9"}, "is_accepted": true, "score": 0, "last_activity_date": 1447840481, "creation_date": 1447840481, "answer_id": 33776767, "question_id": 33775710, "link": "https://stackoverflow.com/questions/33775710/excel-2013-vba-file-error-when-i-open-in-excel-2010/33776767#33776767", "title": "Excel 2013 vba file error when I open in Excel 2010", "body": "<p>Excel 2013 uses the excel 15.0 library, whilst 2010 uses 14.0. Unfortunately, vba is not backward compatible. You can try to uncheck the invalid excel library and assign the 14.0 again in 2010 (in the VB editor: Tools -> References)</p>\n"}], "owner": {"reputation": 5157, "user_id": 1916002, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/aaa0807501c2afe026302c7d148e05c9?s=128&d=identicon&r=PG&f=1", "display_name": "Refael", "link": "https://stackoverflow.com/users/1916002/refael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 33776767, "answer_count": 1, "score": 0, "last_activity_date": 1447840481, "creation_date": 1447837542, "last_edit_date": 1531164843, "question_id": 33775710, "link": "https://stackoverflow.com/questions/33775710/excel-2013-vba-file-error-when-i-open-in-excel-2010", "title": "Excel 2013 vba file error when I open in Excel 2010", "body": "<p>I have .xlsm file, that has been saved in Excel 2013.\nWhen I open the file in Excel 2010 and try running the code, I get an Error: \"can't find project or library\", And the \"Date\" function marked as problem.</p>\n"}, {"tags": ["sql-server", "excel", "vba", "connection-timeout"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1447837496, "post_id": 33775633, "comment_id": 55317974, "body": "I guess <code>&lt;mssql query&gt;</code> is taking too long to run. I suggest you try and optimise it. A good idea is to paste it into SQL Server Management Studio, press CTRL-L and see if it suggests indexes."}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 1, "creation_date": 1447838013, "post_id": 33775633, "comment_id": 55318320, "body": "Does the error appear after 16 minutes? If your query takes too long, you should post <i>the query</i>, not the VBA macro. Nothing you do in the macro is going to make the query run faster. While you <i>can</i> change the timout, this won&#39;t make the query go faster."}, {"owner": {"reputation": 41, "user_id": 4360006, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257716489/picture?type=large", "display_name": "Erkan &#214;rmeci", "link": "https://stackoverflow.com/users/4360006/erkan-%c3%96rmeci"}, "edited": false, "score": 0, "creation_date": 1447838726, "post_id": 33775633, "comment_id": 55318779, "body": "Thanks for your answers. Actually i have more than 10 query in just one excel. When macro is working, ten or more query is starting. Do i have another solution in excel?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1447973339, "post_id": 33775633, "comment_id": 55397370, "body": "The error would be raised on <i>one</i> of those ten queries. Which one?"}], "owner": {"reputation": 41, "user_id": 4360006, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257716489/picture?type=large", "display_name": "Erkan &#214;rmeci", "link": "https://stackoverflow.com/users/4360006/erkan-%c3%96rmeci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1776, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1447844063, "creation_date": 1447837307, "last_edit_date": 1447844063, "question_id": 33775633, "link": "https://stackoverflow.com/questions/33775633/query-timeout-in-ms-sql-for-excel", "title": "Query timeout in MS SQL for Excel", "body": "<p>I have a macro in Excel connecting to MS SQL, checking some counts and writing in my Excel sheet. It was working properly but it is not working now. I have an error code like this:  </p>\n\n<blockquote>\n  <p>Run-time error -2147217871 Query Timeout Expired  </p>\n</blockquote>\n\n<p>My time out value is <code>960</code> but it showing me this problem.  </p>\n\n<p>How can I solve this problem?  </p>\n\n<p>I am sharing code with you:</p>\n\n<pre><code>Sub GetDataFromADO()\n    'Declare variables'\n    Set objMyConn = New ADODB.Connection\n    Set objMyCmd = New ADODB.Command\n    Set objMyRecordset = New ADODB.Recordset\n    'Open Connection'\n        objMyConn.ConnectionString = \"Provider=SQLOLEDB;Data Source=&lt;server&gt;;User ID=&lt;id&gt;;Password=&lt;pass&gt;;\"\n    'For Timeout'\n        Application.ODBCTimeout = 960\n        objMyConn.Open\n    'Set and Excecute SQL Command'\n        Set objMyCmd.ActiveConnection = objMyConn\n        'Set Recordset'\n        Set objMyRecordset.ActiveConnection = objMyConn\n        currentDate = Worksheets(\"RUN\").Range(\"A1\").Value\n '-----------------------------------------------------------------------------------\n        cnt = 0\n        currentSheet = \"LegalInsCrawling\" 'Seq\n        cell = Worksheets(currentSheet).Range(\"A1\").Value\n        Do\n            cnt = cnt + 1\n            cell = Worksheets(currentSheet).Range(\"A1\").Offset(cnt).Value\n        Loop Until cell = \"\" Or cell = CDate(currentDate)\n        Worksheets(currentSheet).Range(\"A1\").Offset(cnt).Value = currentDate\n        objMyCmd.CommandText = \"&lt;mssql query&gt;\"\n        objMyCmd.Execute\n        'Open Recordset'\n        objMyRecordset.Open objMyCmd\n        Worksheets(currentSheet).Range(\"B1\").Offset(cnt).CopyFromRecordset (objMyRecordset)\n        objMyRecordset.Close\n        '------\n        cnt = 0\n        currentSheet = \"LegalInsCrawling\" 'HomePageCrawlingCount\n        cell = Worksheets(currentSheet).Range(\"A1\").Value\n        Do\n            cnt = cnt + 1\n            cell = Worksheets(currentSheet).Range(\"A1\").Offset(cnt).Value\n        Loop Until cell = \"\" Or cell = CDate(currentDate)\n        Worksheets(currentSheet).Range(\"A1\").Offset(cnt).Value = currentDate\n         objMyCmd.CommandText = \"&lt;mssql query&gt;\"\n        objMyCmd.Execute\n        'Open Recordset'\n        objMyRecordset.Open objMyCmd\n        Worksheets(currentSheet).Range(\"D1\").Offset(cnt).CopyFromRecordset (objMyRecordset)\n        objMyRecordset.Close\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-web-query"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447836849, "post_id": 33775439, "comment_id": 55317571, "body": "Option 1 is possible in a variety of methods. Using an HTTPXML object, it is typically called &#39;scraping&#39;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447837673, "post_id": 33775439, "comment_id": 55318089, "body": "Here&#39;s one. <a href=\"http://stackoverflow.com/questions/29723571/post-website-form-data-and-retrieve-results/29724280#29724280\">link</a>. Click on the question&#39;s [xmlhttp-vba] or [html-parsing] tags for more examples."}, {"owner": {"reputation": 13, "user_id": 2922955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/axyC3.png?s=128&g=1", "display_name": "g.e", "link": "https://stackoverflow.com/users/2922955/g-e"}, "edited": false, "score": 0, "creation_date": 1447840079, "post_id": 33775439, "comment_id": 55319791, "body": "With HTPXML I will get all the data, but I must take table1, table17 ... and put them right below each other, and then table2, table18 put on the right and so on with all other tables, I do not know correctly how to move them because I do not have any reference how to know when finishes one table and begins next one..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447840539, "post_id": 33775439, "comment_id": 55320130, "body": "To give an answer to your question, I would have to see the html code that makes up the web page holding the tables. There are simply too many methods available to put multiple tables on a web page to simply state &#39;do this&#39; without seeing hte HTML layout first."}, {"owner": {"reputation": 13, "user_id": 2922955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/axyC3.png?s=128&g=1", "display_name": "g.e", "link": "https://stackoverflow.com/users/2922955/g-e"}, "edited": false, "score": 0, "creation_date": 1447844352, "post_id": 33775439, "comment_id": 55322902, "body": "@Jeeped please see sample code here <a href=\"http://pastebin.com/vjSRXt62\" rel=\"nofollow noreferrer\">link</a> , from there all tables beginning with Belorussia Kup should be one next to each other horizontally, the same applies to Meksiko 2 and so on"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 2922955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/axyC3.png?s=128&g=1", "display_name": "g.e", "link": "https://stackoverflow.com/users/2922955/g-e"}, "edited": false, "score": 0, "creation_date": 1447844460, "post_id": 33777159, "comment_id": 55322981, "body": "please see my comment above with a sample code <a href=\"http://pastebin.com/vjSRXt62\" rel=\"nofollow noreferrer\">link</a>, transpose is not an option, my example was referring to tables, not just a column of data. I must move each table next to each other every 17 tables, then move down..."}, {"owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "reply_to_user": {"reputation": 13, "user_id": 2922955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/axyC3.png?s=128&g=1", "display_name": "g.e", "link": "https://stackoverflow.com/users/2922955/g-e"}, "edited": false, "score": 0, "creation_date": 1447845101, "post_id": 33777159, "comment_id": 55323433, "body": "@gereqi I edited to clarify (but sorry if I misunderstood your needs)"}], "tags": [], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "is_accepted": true, "score": 0, "last_activity_date": 1447845042, "last_edit_date": 1447845042, "creation_date": 1447841471, "answer_id": 33777159, "question_id": 33775439, "link": "https://stackoverflow.com/questions/33775439/get-multiple-tables-in-one-excel-web-query/33777159#33777159", "title": "Get multiple tables in one Excel web query", "body": "<p>Have you tryed to add transpose?</p>\n\n<pre><code>With ActiveSheet.QueryTables.Add(Connection:=\"URL;http://domain.com\", Destination:=Range(\"$A$1\"))\n    '...\n    .Transpose = True\nEnd With\n</code></pre>\n\n<p>Edit:</p>\n\n<p>I was thinking about using transpose and change </p>\n\n<pre><code>Destination:=Range(\"$A$1\")\n</code></pre>\n\n<p>into</p>\n\n<pre><code>Destination:=Range(StartingCell)'where StartigCell is valued to set the first empty row\n</code></pre>\n\n<p>so to have all data in columns instead of rows</p>\n"}], "owner": {"reputation": 13, "user_id": 2922955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/axyC3.png?s=128&g=1", "display_name": "g.e", "link": "https://stackoverflow.com/users/2922955/g-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1446, "favorite_count": 0, "accepted_answer_id": 33777159, "answer_count": 1, "score": 1, "last_activity_date": 1447848066, "creation_date": 1447836694, "last_edit_date": 1447848066, "question_id": 33775439, "link": "https://stackoverflow.com/questions/33775439/get-multiple-tables-in-one-excel-web-query", "title": "Get multiple tables in one Excel web query", "body": "<p>I have am getting many tables from a web page to Excel using Web Queries.\nThe tables in the web page are listed like this</p>\n\n<ul>\n<li>A1</li>\n<li>A2</li>\n<li>A3</li>\n<li>A4</li>\n<li>A5</li>\n<li>A6</li>\n<li>A7</li>\n<li>A8</li>\n<li>A9</li>\n<li>A10</li>\n<li>A11</li>\n<li>A12</li>\n<li>A13</li>\n<li>A14</li>\n<li>A15</li>\n<li>A16</li>\n<li>A17</li>\n<li>B1</li>\n<li>B2</li>\n<li>B3</li>\n<li>B4</li>\n<li>B5</li>\n<li>B6</li>\n<li>B7</li>\n<li>B8</li>\n<li>B9</li>\n<li>B10</li>\n<li>B11</li>\n<li>B12</li>\n<li>B13</li>\n<li>B14</li>\n<li>B15</li>\n<li>B16</li>\n<li>B17</li>\n<li>...</li>\n</ul>\n\n<p>In Excel I need them to be like this:</p>\n\n<p>A1 B1 C1 D1 E1 F1 G1 ...</p>\n\n<p>A2 B2 C2 D2 E2 F2 G2 ...</p>\n\n<p>I am getting all these tables by running several times this code, by just changing webtables from 1,18,35,52,69... to 2,19,36,53,70...  3,20,37,54,71... until 17,34,51,68,85... and range of putting data from A1 to AE1, BI1... :</p>\n\n<pre><code>With ActiveSheet.QueryTables.Add(Connection:=\"URL;http://domain.com\", Destination:=Range(\"$A$1\"))\n    .Name = \"table-01\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .WebSelectionType = xlSpecifiedTables\n    .WebFormatting = xlWebFormattingNone\n    .WebTables = _\n    \"1,18,35,52,69,86,103,120,137,154,171,188,205,222,239,256,273,290,307,324,341,358,375,392,409,426,443,460,477,494,511,528,545,562,579,596,613,630,647,664,681,698,715,732,749,766,783,800,817,834\"\n    .WebPreFormattedTextToColumns = True\n    .WebConsecutiveDelimitersAsOne = True\n    .WebSingleBlockTextImport = False\n    .WebDisableDateRecognition = True\n    .WebDisableRedirections = False\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n\n<p>The above code runs 17 times to get all the data and move it from all vertical to horizontal into Excel.\nBut it takes a long time and I notice that for each webquery I am opening a new connection, get the data into Excel, close, move to next one, open connection, get the data into Excel, close ... and so on 17 times. But with a high load, the webserver responds sometimes with error and blank page, so I get in my Excel empty parts like:</p>\n\n<p>A1 B1 C1 xx E1 F1 G1 ...</p>\n\n<p>A2 B2 C2 xx E2 F1 G2 ...</p>\n\n<p>I am wondering if is possible to do any of these options, whichever is easier and/or better:</p>\n\n<ol>\n<li>From Excel, open one connection and get all the data in cycles then close connection, or</li>\n<li>Excel detects that the webquery is not returning any data, so webquery is blank, and so it automatically retries that webquery until it gets data and then move to next query</li>\n</ol>\n\n<p><strong>EDIT :</strong> <a href=\"http://i.stack.imgur.com/ibsBK.jpg\" rel=\"nofollow\">Graphical idea of how the tables should be arranged in one call</a></p>\n"}, {"tags": ["vb.net", "vba", "ms-access", "mdb2"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5575575, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4oAotQWIby0/AAAAAAAAAAI/AAAAAAAAE7Y/VkrSPirhJrQ/photo.jpg?sz=128", "display_name": "rachit jani", "link": "https://stackoverflow.com/users/5575575/rachit-jani"}, "edited": false, "score": 0, "creation_date": 1447932360, "post_id": 33779528, "comment_id": 55370617, "body": "Yes I did that already but That is not the reason of that error.  The issue is the database is already open and I am calling sub from the immediate window which calls a .net function which tries to access table of the database which is already open.  kind of simultaneous connectin issue."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1447848062, "creation_date": 1447848062, "answer_id": 33779528, "question_id": 33775203, "link": "https://stackoverflow.com/questions/33775203/error-2147467259-80004005-net-mdb/33779528#33779528", "title": "error -2147467259 (80004005) .net mdb", "body": "<p><code>INPUT</code> is a reserved word, so try:</p>\n\n<pre><code>ADODBcmd.CommandText = \"select count(*) from [input]\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1457726643, "post_id": 35911583, "comment_id": 59554270, "body": "When SO allows it, be sure to click the checkmark next to this to indicate it answers your question."}], "tags": [], "owner": {"reputation": 11, "user_id": 5575575, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4oAotQWIby0/AAAAAAAAAAI/AAAAAAAAE7Y/VkrSPirhJrQ/photo.jpg?sz=128", "display_name": "rachit jani", "link": "https://stackoverflow.com/users/5575575/rachit-jani"}, "is_accepted": true, "score": 1, "last_activity_date": 1457726561, "last_edit_date": 1457726561, "creation_date": 1457599873, "answer_id": 35911583, "question_id": 33775203, "link": "https://stackoverflow.com/questions/33775203/error-2147467259-80004005-net-mdb/35911583#35911583", "title": "error -2147467259 (80004005) .net mdb", "body": "<p>I discovered what the problem was:</p>\n\n<p>It's a Limitation of Access that you can not access a table of a database using a dll from which you are calling the function :-)</p>\n"}], "owner": {"reputation": 11, "user_id": 5575575, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4oAotQWIby0/AAAAAAAAAAI/AAAAAAAAE7Y/VkrSPirhJrQ/photo.jpg?sz=128", "display_name": "rachit jani", "link": "https://stackoverflow.com/users/5575575/rachit-jani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 0, "accepted_answer_id": 35911583, "answer_count": 2, "score": 0, "last_activity_date": 1457726561, "creation_date": 1447835891, "last_edit_date": 1457704036, "question_id": 33775203, "link": "https://stackoverflow.com/questions/33775203/error-2147467259-80004005-net-mdb", "title": "error -2147467259 (80004005) .net mdb", "body": "<p>I am calling a vb.net function of a dll from below VBA code in MDB.\nI am calling Get_GDW_data_final sub from immediate Window.</p>\n\n<pre><code>Public Sub Get_GDW_data_final()\nDim r As New Get_GDW_Data.GDW\nMsgBox r.DetailedWork()\nEnd Sub\n</code></pre>\n\n<p>I have created Get_GDW_Data.dll added reference of it in MDB.</p>\n\n<p>The coding of class is as below.</p>\n\n<pre><code>Public Class GDW\n    Public Function DetailedWork()\n        Dim lastrow As Long\n        Dim ADODBcnn As New OleDb.OleDbConnection(\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=D:\\Access8\\W156_RocketOffset_Backup.mdb;Persist Security Info=False;Mode=read\")\n        Dim ADODBcmd As New OleDb.OleDbCommand\n        Dim ADODBcmd1 As New OleDb.OleDbCommand\n        Dim ADODBrst As OleDb.OleDbDataReader\n        ADODBcnn.Open()\n        ADODBcmd.CommandText = \"select count(*) from input\"\n        lastrow = ADODBcmd.ExecuteScalar()\n        ADODBcnn.Close()\n        Return lastrow.ToString()\n\n    End Function\nEnd Class\n</code></pre>\n\n<p>Here I am getting error </p>\n\n<p>Run-time Error -2147467259 (80004005)\nThe database has been put in a state by admin or machine 'Rachit' that prvents it from being opened or locked.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1447831310, "post_id": 33773836, "comment_id": 55314674, "body": "The text property is only available when a control has focus. Either use the value property or just skip the property and it will default to value."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1447831393, "post_id": 33773836, "comment_id": 55314716, "body": "Could not all these words be in the same table with a definition of noun etc? It would make life a lot easier."}, {"owner": {"reputation": 43, "user_id": 2539380, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/677788026772affca103681a5e3e0b59?s=128&d=identicon&r=PG", "display_name": "Mikael", "link": "https://stackoverflow.com/users/2539380/mikael"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1447831975, "post_id": 33773836, "comment_id": 55314984, "body": "It would make life easier, the issue is that I&#39;m trying to keep word-types together.  E.g. the word k&#246;r, can be present tense for the word &#39;drive&#39;, a verb, yet it also means choir or chorus, a noun, when relating these words back to English, I want to keep the word type (grammatik klass) the separator between reverse translating.  All in all, adding the words to one table is not an option."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 1, "creation_date": 1447832746, "post_id": 33773836, "comment_id": 55315346, "body": "I think it is. All you need is a classifier. You can have the same word a dozen times with a different classifier. So the table has <code>k&#246;r, noun</code> and <code>k&#246;r, verb</code> -- two fields in each case.. You can add a tense if preferred."}, {"owner": {"reputation": 43, "user_id": 2539380, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/677788026772affca103681a5e3e0b59?s=128&d=identicon&r=PG", "display_name": "Mikael", "link": "https://stackoverflow.com/users/2539380/mikael"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1447834291, "post_id": 33773836, "comment_id": 55316091, "body": "Fionnuala, that wouldn&#39;t really help.  Their are 8 noun word forms, 12 verb word forms, and 15 adjective word forms, per each word.  That is a lot of hiding of fields if say I just want to input k&#246;r as a noun, as the other options shouldn&#39;t even been seen unless it relates to the word at hand.  This is why I have separate forms for Nouns, Adjectives and Verbs."}, {"owner": {"reputation": 43, "user_id": 2539380, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/677788026772affca103681a5e3e0b59?s=128&d=identicon&r=PG", "display_name": "Mikael", "link": "https://stackoverflow.com/users/2539380/mikael"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1447840522, "post_id": 33773836, "comment_id": 55320111, "body": "The switch of the subforms works without a hitch, with the same code as above.  My problem was the passing of the textbox&#39;s values between form and subform, anyone have insight to this?  Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 2539380, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/677788026772affca103681a5e3e0b59?s=128&d=identicon&r=PG", "display_name": "Mikael", "link": "https://stackoverflow.com/users/2539380/mikael"}, "edited": false, "score": 0, "creation_date": 1447842332, "post_id": 33777069, "comment_id": 55321472, "body": "Bleh, It switches between the subforms okay, but as for updating the word from the txtbox_Ord, to Singular_Obest&#228;md, Attributivt_Utrum_Singular_Obest&#228;md_Positiv, etc is problematic."}], "tags": [], "owner": {"reputation": 43, "user_id": 2539380, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/677788026772affca103681a5e3e0b59?s=128&d=identicon&r=PG", "display_name": "Mikael", "link": "https://stackoverflow.com/users/2539380/mikael"}, "is_accepted": false, "score": 0, "last_activity_date": 1447841220, "creation_date": 1447841220, "answer_id": 33777069, "question_id": 33773836, "link": "https://stackoverflow.com/questions/33773836/access-dynamically-load-subform-from-combbox-in-mainform/33777069#33777069", "title": "Access - Dynamically load subform from combbox in mainform", "body": "<p>Figured out the issue, here is the code:</p>\n\n<pre><code>Private Sub combobox_Grammatik_Klass_Change()\n\nSelect Case Me.combobox_Grammatik_Klass.Text\n    Case \"Substantiv\"\n        Me.subfrm_Orden.SourceObject = \"frm_Substantiv_Orden\"\n        Me.subfrm_Orden!Singular_Obest\u00e4md = Me.txtbox_Ord\n    Case \"Verb\"\n        Me.subfrm_Orden.SourceObject = \"frm_Verb_Orden\"\n        Me.subfrm_Orden!Attributivt_Utrum_Singular_Obest\u00e4md_Positiv = Me.txtbox_Ord\n    Case \"Adjektiv\"\n        Me.subfrm_Orden.SourceObject = \"frm_Adjektiv_Orden\"\n        Me.subfrm_Orden!Aktiv_Infinitiv = Me.txtbox_Ord\n    Case Else\n        ' Me.subfrm_Orden.SourceObject = \"frm_Alla_Andra_Orden\"\n        ' Me.subfrm_Orden!Ord = Me.txtbox_Ord\nEnd Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 2539380, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/677788026772affca103681a5e3e0b59?s=128&d=identicon&r=PG", "display_name": "Mikael", "link": "https://stackoverflow.com/users/2539380/mikael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447841220, "creation_date": 1447830688, "question_id": 33773836, "link": "https://stackoverflow.com/questions/33773836/access-dynamically-load-subform-from-combbox-in-mainform", "title": "Access - Dynamically load subform from combbox in mainform", "body": "<p>I'm trying to have a combobox change the subform that is on my mainform.  My issue is that in Swedish nouns, verbs and adjectives change form, so if I'm adding a new noun into my mainform, then the subform associated with inputting nouns needs to dynamically load.  </p>\n\n<p>I've wrote a little VBA to assist but I cannot get it to work properly:</p>\n\n<p>Private Sub combobox_Grammatik_Klass_Change()</p>\n\n<pre><code>Select Case Me.combobox_Grammatik_Klass.Text\n    Case \"Substantiv\"\n        Me.subfrm_Orden.SourceObject = \"frm_Substantiv_Ord\"\n        Me.Singular_Obest\u00e4md.Text = Me.txtbox_Ord.Text\n    Case \"Verb\"\n        Me.subfrm_Orden.SourceObject = \"frm_Verb_Ord\"\n        Me.Attributivt_Utrum_Singular_Obest\u00e4md_Positiv.Text = Me.txtbox_Ord.Text\n    Case \"Adjektiv\"\n        Me.subfrm_Orden.SourceObject = \"frm_Adjektiv_Ord\"\n        Me.Aktiv_Infinitiv.Text = Me.txtbox_Ord.Text\n    Case Else\n       ' Me.subfrm_Orden.SourceObject = \"frm_Alla_Andra_Orden\"\n       ' Me.Ord.Text = Me.txtbox_Ord.Text\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p>Main form = Ord_Inmatning_Blankett (Word Input Form)</p>\n\n<p>Subform = frm_Alla_Andra_Orden (All other words), frm_Adjektiv_Ord (Adjective Words), frm_Verb_Ord (Verb Words), and frm_Substantiv_Ord (Noun Words)</p>\n\n<p>Subform control = subfrm_Orden</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1447826025, "post_id": 33772467, "comment_id": 55312537, "body": "There is no <code>Activebook</code> that I know about. Try <code>ActiveWorkbook</code> as in the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821871.aspx\" rel=\"nofollow noreferrer\">ActiveWorkbook property</a>."}, {"owner": {"reputation": 140, "user_id": 4519177, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JlXTy.jpg?s=128&g=1", "display_name": "Monkawee Maneewalaya", "link": "https://stackoverflow.com/users/4519177/monkawee-maneewalaya"}, "edited": false, "score": 0, "creation_date": 1447828001, "post_id": 33772467, "comment_id": 55313289, "body": "Excuse me. Your worksheet name are (1C,2C,3C) or (C1,C2,C3)? You can use <code>&quot;C&quot; + right(ws.name)</code> or <code>left(ws.name) + &quot;C&quot;</code> for condition check at line <code>if ws.name</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5575041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b96ac80b24f64fc0323435d4c104bd8?s=128&d=identicon&r=PG&f=1", "display_name": "Tanzie81", "link": "https://stackoverflow.com/users/5575041/tanzie81"}, "edited": false, "score": 0, "creation_date": 1447874949, "post_id": 33772894, "comment_id": 55344301, "body": "Sorry about that, I accidentally wrote the ws name mask wrong.  It was in the vba as ?C, not &quot;?1&quot;.  The code you have given me unfortunately didn&#39;t work.  When I&#39;ve used your code, and when previously amending mine, the For Next statement does not pick up on any of the worksheets."}, {"owner": {"reputation": 3, "user_id": 5575041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b96ac80b24f64fc0323435d4c104bd8?s=128&d=identicon&r=PG&f=1", "display_name": "Tanzie81", "link": "https://stackoverflow.com/users/5575041/tanzie81"}, "edited": false, "score": 0, "creation_date": 1447875543, "post_id": 33772894, "comment_id": 55344662, "body": "I should also mention that I tried the exact name of the first worksheet &quot;1C&quot; and the code did not find the sheet and just kept looping through the For...Next statement."}, {"owner": {"reputation": 3, "user_id": 5575041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b96ac80b24f64fc0323435d4c104bd8?s=128&d=identicon&r=PG&f=1", "display_name": "Tanzie81", "link": "https://stackoverflow.com/users/5575041/tanzie81"}, "edited": false, "score": 0, "creation_date": 1447875557, "post_id": 33772894, "comment_id": 55344672, "body": "Regarding the worksheet names, there are 42 worksheets in this workbook.  The sheets which I need to insert formulas into are named &quot;1C, 2C, 3C....through to 13C&quot;.  There are also two other sets of sheets with similar naming structure &quot;1O, 2O, 3O... through to 13O&quot; and another set named &quot;1S, 2S... etc&quot;.  In addition to these are are some other worksheets used for analysis (used for charts and lookup tables etc)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 3, "user_id": 5575041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b96ac80b24f64fc0323435d4c104bd8?s=128&d=identicon&r=PG&f=1", "display_name": "Tanzie81", "link": "https://stackoverflow.com/users/5575041/tanzie81"}, "edited": false, "score": 0, "creation_date": 1447875679, "post_id": 33772894, "comment_id": 55344744, "body": "Sorry but I cannot see any way that the loop cannot find each worksheet in the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224508(v=office.11).aspx\" rel=\"nofollow noreferrer\">Worksheets collection</a>. I just stripped out all of the nested If... End If and it reported every ws name in the workbook I threw it into."}, {"owner": {"reputation": 3, "user_id": 5575041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b96ac80b24f64fc0323435d4c104bd8?s=128&d=identicon&r=PG&f=1", "display_name": "Tanzie81", "link": "https://stackoverflow.com/users/5575041/tanzie81"}, "edited": false, "score": 0, "creation_date": 1447877408, "post_id": 33772894, "comment_id": 55345841, "body": "Sorry if this is a stupid question (I&#39;m very much an amateur at this). I&#39;m finding that when I type &quot;worksheets.&quot; and the members of the object pops up that &quot;name&quot; is not an option.  Would this have anything to do with my problem? Is there some basic code I could use to just search and activate a sheet? i.e. If worksheet.name is &quot;1C&quot; then activate cell &quot;A1&quot; and msgbox &quot;found worksheet&quot;?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 3, "user_id": 5575041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b96ac80b24f64fc0323435d4c104bd8?s=128&d=identicon&r=PG&f=1", "display_name": "Tanzie81", "link": "https://stackoverflow.com/users/5575041/tanzie81"}, "edited": false, "score": 0, "creation_date": 1447877736, "post_id": 33772894, "comment_id": 55346039, "body": "You are confusing the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224508(v=office.11).aspx\" rel=\"nofollow noreferrer\">Worksheets collection</a> with individual <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224506(v=office.11).aspx\" rel=\"nofollow noreferrer\">Worksheet objects</a>. The latter has a Worksheet <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196974.aspx\" rel=\"nofollow noreferrer\">.Name property</a>, the former are all of the worksheets in the workbook."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 3, "user_id": 5575041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b96ac80b24f64fc0323435d4c104bd8?s=128&d=identicon&r=PG&f=1", "display_name": "Tanzie81", "link": "https://stackoverflow.com/users/5575041/tanzie81"}, "edited": false, "score": 0, "creation_date": 1447878378, "post_id": 33772894, "comment_id": 55346430, "body": "Please see the short <code>Check_WS_Names</code> sub I added to the reply above."}, {"owner": {"reputation": 3, "user_id": 5575041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b96ac80b24f64fc0323435d4c104bd8?s=128&d=identicon&r=PG&f=1", "display_name": "Tanzie81", "link": "https://stackoverflow.com/users/5575041/tanzie81"}, "edited": false, "score": 0, "creation_date": 1447925425, "post_id": 33772894, "comment_id": 55365605, "body": "Thank you for your help! I&#39;m not sure what has happened or exactly what I was doing wrong before but your code is performing the action as I need it to. I am getting <i>Run-time error &#39;1004&#39;</i> at step <code>.Cells(2, LastCol).Resize(LastRow - 1, 1).FormulaR1C1 = _                     &quot;=VLOOKUP(RC[-1], URLs!C1:C2, 2, FALSE)&quot;</code> but as mentioned, it has completed the actions I wanted it to and inserted the formula so I&#39;m unsure why this has occured"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 3, "user_id": 5575041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b96ac80b24f64fc0323435d4c104bd8?s=128&d=identicon&r=PG&f=1", "display_name": "Tanzie81", "link": "https://stackoverflow.com/users/5575041/tanzie81"}, "edited": false, "score": 0, "creation_date": 1447925989, "post_id": 33772894, "comment_id": 55366001, "body": "Glad you got sorted out. As this post-question discussion has been getting a little elongated, perhaps it&#39;s time to close this question off by accepting one of the replies as the answer and starting a new question if you run into future problems."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1447878345, "last_edit_date": 1447878345, "creation_date": 1447826742, "answer_id": 33772894, "question_id": 33772467, "link": "https://stackoverflow.com/questions/33772467/for-next-loop-to-perform-action-based-on-worksheets-with-similar-names/33772894#33772894", "title": "&#39;For Next&#39; loop to perform action based on worksheets with similar names", "body": "<p>There is no <code>Activebook</code> that I know about. Try <code>ActiveWorkbook</code> as in the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821871.aspx\" rel=\"nofollow\">ActiveWorkbook property</a>.</p>\n\n<p>Further in, you should be dealing with the <code>ws</code> worksheet type variable that is set with for <code>For Each ... Next</code> loop. A <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a> will allow all further operations to reference it as the worksheet to have work performed upon.</p>\n\n<pre><code>Sub InsertURLType()\n\n    Dim ws As Worksheet\n    Dim LastRow As Long, LastCol As Long\n\n    For Each ws In ActiveWorkbook.Sheets\n        With ws\n\n            If .Name Like \"?1\" Then  '&lt;~~ this doesn't appear to pattern match the WS names you described in your narrative\n\n                LastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n                LastRow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row '&lt;~~ look from the bottom up\n\n                .Columns(LastCol).Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n                .Cells(1, LastCol) = \"URL Type\"\n                .Cells(2, LastCol).Resize(LastRow - 1, 1).FormulaR1C1 = _\n                    \"=VLOOKUP(RC[-1], URLs!C1:C2, 2, FALSE)\"\n\n            End If\n        End With\n    Next ws\n\nEnd Sub\n</code></pre>\n\n<p>The mask you are using for <code>If .Name Like \"?1\" Then</code> doe not appear to match the worksheet names you provided in your narrative. If this doesn't work out, provide a list of all of the worksheet names along with a subset of the ones you want to work on.</p>\n\n<p>This short sub will check your worksheet names.</p>\n\n<pre><code>Sub Check_WS_Names()\n\n    Dim ws As Worksheet, strWSs As String\n\n    strWSs = \" 1C 2C 3C 4C 5C 6C 7C 8C 9C 10C 11C 12C 13C\" &amp; _\n             \" 1O 2O 3O 4O 5O 6O 7O 8O 9O 10O 11O 12O 13O\" &amp; _\n             \" 1S 2S 3S 4S 5S 6S 7S 8S 9S 10S 11S 12S 13S \"\n\n    For Each ws In ActiveWorkbook.Sheets\n        With ws\n            If CBool(InStr(1, strWSs, Chr(32) &amp; .Name &amp; Chr(32), vbTextCompare)) Then\n                Debug.Print \"found: \" &amp; .Name\n            End If\n        End With\n    Next ws\n\nEnd Sub\n</code></pre>\n\n<p>Check the VBE's Immediate window (Ctrl+G) for the results after you have run it.</p>\n"}], "owner": {"reputation": 3, "user_id": 5575041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b96ac80b24f64fc0323435d4c104bd8?s=128&d=identicon&r=PG&f=1", "display_name": "Tanzie81", "link": "https://stackoverflow.com/users/5575041/tanzie81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 33772894, "answer_count": 1, "score": 0, "last_activity_date": 1447878345, "creation_date": 1447824564, "last_edit_date": 1447843158, "question_id": 33772467, "link": "https://stackoverflow.com/questions/33772467/for-next-loop-to-perform-action-based-on-worksheets-with-similar-names", "title": "&#39;For Next&#39; loop to perform action based on worksheets with similar names", "body": "<p>I have a set of worksheets with similar names and want to perform an action for all of these worksheets (e.g. sheet names are <code>1C</code>, <code>2C</code>, <code>3C</code> etc.).  I've tried the following code but I'm getting <em>Run-time error 424</em>:</p>\n\n<pre><code>Sub InsertURLType()\n\nDim ws As Worksheet\nDim LastCol As Integer\n\nFor Each ws In Activebook.Sheets\n\nIf ws.Name Like \"?1\" Then\n\n    With ActiveSheet\n        LastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    End With\n\n    LastRow = Range(\"A1\").End(xlDown).Row\n\n    Columns(LastCol).Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    ActiveCell.Select\n    ActiveCell.FormulaR1C1 = \"URL Type\"\n    ActiveCell.Offset(1).Select\n    ActiveCell.FormulaR1C1 = \"=VLOOKUP(RC[-1],URLs!C1:C2,2,FALSE)\"\n    ActiveCell.AutoFill Range(ActiveCell.Address, Cells(LastRow, ActiveCell.Column))\n\nEnd If\n\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 381798, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1447821020, "post_id": 33771854, "comment_id": 55310927, "body": "Please show us the query/code you currently have."}, {"owner": {"reputation": 9, "user_id": 5024963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bab933754fef1ee30af457890efa2a9?s=128&d=identicon&r=PG&f=1", "display_name": "dkjordan", "link": "https://stackoverflow.com/users/5024963/dkjordan"}, "reply_to_user": {"reputation": 381798, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1447821112, "post_id": 33771854, "comment_id": 55310953, "body": "Dim StudentDataAdapter As New OleDbDataAdapter(&quot;Select major, studstanding, from students inner join MIS on students.studentID = MIS.studentID &quot;, StudentDataConnection)"}, {"owner": {"reputation": 381798, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1447821172, "post_id": 33771854, "comment_id": 55310966, "body": "Please post your table schema."}, {"owner": {"reputation": 9, "user_id": 5024963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bab933754fef1ee30af457890efa2a9?s=128&d=identicon&r=PG&f=1", "display_name": "dkjordan", "link": "https://stackoverflow.com/users/5024963/dkjordan"}, "reply_to_user": {"reputation": 381798, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1447821205, "post_id": 33771854, "comment_id": 55310977, "body": "I want an average from my MIS table of a particular column but I have no idea where the code for the average command should be placed."}, {"owner": {"reputation": 9, "user_id": 5024963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bab933754fef1ee30af457890efa2a9?s=128&d=identicon&r=PG&f=1", "display_name": "dkjordan", "link": "https://stackoverflow.com/users/5024963/dkjordan"}, "reply_to_user": {"reputation": 381798, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1447821375, "post_id": 33771854, "comment_id": 55311018, "body": "What exactly should a table schema include? Column headings of the original table(s) or from the desired output?"}, {"owner": {"reputation": 13132, "user_id": 4558437, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/qZulX.png?s=128&g=1", "display_name": "Tharif", "link": "https://stackoverflow.com/users/4558437/tharif"}, "edited": false, "score": 0, "creation_date": 1447821414, "post_id": 33771854, "comment_id": 55311030, "body": "more on inner joins : <a href=\"http://stackoverflow.com/questions/394853/sql-inner-join-syntax\">stackoverflow.com/questions/394853/sql-inner-join-syntax</a>"}, {"owner": {"reputation": 381798, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1447821548, "post_id": 33771854, "comment_id": 55311067, "body": "Show us the columns of the tables involved, along with ideally some sample input and output.  If you do this, you will quickly get an answer.  Please update soon before you are voted off."}, {"owner": {"reputation": 9, "user_id": 5024963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bab933754fef1ee30af457890efa2a9?s=128&d=identicon&r=PG&f=1", "display_name": "dkjordan", "link": "https://stackoverflow.com/users/5024963/dkjordan"}, "edited": false, "score": 0, "creation_date": 1447821641, "post_id": 33771854, "comment_id": 55311105, "body": "From Students: Major, StudentStanding; From MIS: quiz1, quiz2, quiz3 joined with studentID. I need averages for the different quizzes, but not sure where in the query to include the code."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447840433, "post_id": 33771854, "comment_id": 55320037, "body": "Please do not add relevant information in comments. <b>Edit</b> your question and add it there."}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1447844629, "creation_date": 1447844629, "answer_id": 33778364, "question_id": 33771854, "link": "https://stackoverflow.com/questions/33771854/inner-join-sql-in-visual-studio/33778364#33778364", "title": "inner join SQL in Visual Studio", "body": "<p>This will return an average:</p>\n\n<pre><code>SELECT      Students.StudentID, \n            AVG(quiz1) AS AverageOfQuiz1,\n            AVG(quiz2) AS AverageOfQuiz2,\n            AVG(quiz3) AS AverageOfQuiz3\nFROM        Students INNER JOIN MIS ON Students.StudentID = MIS.StudentID\nGROUP BY    Students.StudentID\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5024963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bab933754fef1ee30af457890efa2a9?s=128&d=identicon&r=PG&f=1", "display_name": "dkjordan", "link": "https://stackoverflow.com/users/5024963/dkjordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 781, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1447844629, "creation_date": 1447820900, "last_edit_date": 1447834242, "question_id": 33771854, "link": "https://stackoverflow.com/questions/33771854/inner-join-sql-in-visual-studio", "title": "inner join SQL in Visual Studio", "body": "<p>I am trying to inner join two tables from access, but I am having trouble summarizing information from the second table. What is the proper syntax for averages within a query when using inner join?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "edited": false, "score": 0, "creation_date": 1447836753, "post_id": 33772687, "comment_id": 55317505, "body": "Hi Jeeped, appreciate your answer. I went ahead and went with a combo of the above codes as they were a bit more direct in what I was looking for. Thanks again!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 4, "last_activity_date": 1447825724, "creation_date": 1447825724, "answer_id": 33772687, "question_id": 33771493, "link": "https://stackoverflow.com/questions/33771493/vba-scripting-dictionary-multiple-items-per-key-and-sum-count-on-items/33772687#33772687", "title": "VBA scripting dictionary, multiple items per key and sum/count on items", "body": "<p>I use a method of joining multiple values into a single <code>.Item</code> with a rarely-encountered delimiter. The <code>.Item</code> can be split and have its elements adjusted as the dictionary is constructed.</p>\n\n<pre><code>Sub dictionaryCreate()\n\n    Dim rw As Long, vITM As Variant, vKEY As Variant\n    Dim d As New Dictionary   ' or Object &amp; CreateObject(\"Scripting.Dictionary\")\n\n    d.CompareMode = vbTextCompare\n\n    With Worksheets(\"RAW_DATA\")\n        For rw = 2 To 3000   'maybe this ~&gt; .Cells(Rows.Count, 1).End(xlUp).Row\n            If d.Exists(.Cells(rw, 1).Value2) Then\n                vITM = Split(d.Item(.Cells(rw, 1).Value2), ChrW(8203))\n                d.Item(.Cells(rw, 1).Value2) = _\n                    Join(Array(vITM(0) + .Cells(rw, 2).Value2, vITM(1) + 1), ChrW(8203))  'modify and join on a zero-width space\n            Else\n                d.Add Key:=.Cells(rw, 1).Value2, _\n                      Item:=Join(Array(.Cells(rw, 2).Value2, 1), ChrW(8203))  'join on a zero-width space\n            End If\n        Next rw\n    End With\n\n    Debug.Print \"key\" &amp; Chr(9) &amp; \"sum\" &amp; Chr(9) &amp; \"count\"\n    For Each vKEY In d.Keys\n        Debug.Print vKEY &amp; Chr(9) &amp; _\n                    Split(d.Item(vKEY), ChrW(8203))(0) &amp; Chr(9) &amp; _\n                    Split(d.Item(vKEY), ChrW(8203))(1)\n    Next vKEY\n\n    d.RemoveAll: Set d = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Results from the VBE's Immediate window:</p>\n\n<pre><code>key     sum count\nPersonA 100 2\nPersonB 57  2\nPersonC 13  1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "edited": false, "score": 0, "creation_date": 1447836706, "post_id": 33773072, "comment_id": 55317461, "body": "Hi Tim, Thank you for your answer, it was useful in understanding how the class module works."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 5, "last_activity_date": 1447827567, "creation_date": 1447827567, "answer_id": 33773072, "question_id": 33771493, "link": "https://stackoverflow.com/questions/33771493/vba-scripting-dictionary-multiple-items-per-key-and-sum-count-on-items/33773072#33773072", "title": "VBA scripting dictionary, multiple items per key and sum/count on items", "body": "<p>Using your sample data and a class </p>\n\n<p>clsItem:</p>\n\n<pre><code>Public Sum As Double\nPublic Count As Long\n</code></pre>\n\n<p>Module:</p>\n\n<pre><code>Sub dictionaryCreate()\n\n    Dim Pair As Variant\n    Dim q As Range, v, k\n    Dim RAWDATA As Range\n\n    Dim d As Dictionary\n    Set d = New Dictionary\n\n    Set RAWDATA = [A2:A6]\n    For Each q In RAWDATA\n        Pair = q.Value\n        v = q.Offset(0, 1).Value 'get the value to be added...\n        If d.Exists(Pair) Then\n            d(Pair).Sum = d(Pair).Sum + v\n            d(Pair).Count = d(Pair).Count + 1\n        Else\n            d.Add Pair, NewItem(v)\n        End If\n    Next\n\n    'print out dictionary content\n    For Each k In d\n        Debug.Print k, d(k).Sum, d(k).Count\n    Next k\nEnd Sub\n\nFunction NewItem(v) As clsItem\n    Dim rv As New clsItem\n    rv.Sum = v\n    rv.Count = 1\n    Set NewItem = rv\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1447831730, "post_id": 33774083, "comment_id": 55314879, "body": "@Tim Williams, sorry, didn&#39;t see your answer. Guess that whole class thing jumped out at all of us."}, {"owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "edited": false, "score": 0, "creation_date": 1447832420, "post_id": 33774083, "comment_id": 55315213, "body": "Nevermind, I didn&#39;t realize you had to name your class modules.. testing"}, {"owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "edited": false, "score": 0, "creation_date": 1447836825, "post_id": 33774083, "comment_id": 55317554, "body": "Ok, I ended up using your code and it worked well. I now have a collection with and itemlist and a sum/count for each item. Struggling to get the hang of classes, but I have a lot more to add to this so it&#39;s a great start. Thanks"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "edited": false, "score": 1, "creation_date": 1447846910, "post_id": 33774083, "comment_id": 55324638, "body": "@Citanaf Suggest to visit this page <a href=\"http://www.cpearson.com/excel/classes.aspx\" rel=\"nofollow noreferrer\">Introduction To Classes</a>"}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 7, "last_activity_date": 1447831628, "creation_date": 1447831628, "answer_id": 33774083, "question_id": 33771493, "link": "https://stackoverflow.com/questions/33771493/vba-scripting-dictionary-multiple-items-per-key-and-sum-count-on-items/33774083#33774083", "title": "VBA scripting dictionary, multiple items per key and sum/count on items", "body": "<p>A class object is ideal for this task. For one thing you can create your own data fields, for another you can add further functionality (eg store each individual item or have a function that averages the sum and count) and, most importantly, you can perform arithmetic functions on the fields (such as addition).</p>\n\n<p>The latter is very useful because primitive data types cannot be amended in a <code>Collection</code> type of object. For example you couldn't have in your code <code>d(key) = d(key) + 1</code> if the item in <code>d</code> is, say, an <code>Integer</code>. You'd have to read the value of <code>d(key)</code> into a temporary variable, increment that by 1, remove the old value and then add the new temporary variable (and if the order in the <code>Collection</code> is important to you then you have an even tougher task). However, objects are stored by reference in these types of <code>Collections</code>, so you can amend the properties of that object to your heart's content.</p>\n\n<p>You'll note that I've been referencing <code>Collection</code> more than <code>Dictionary</code>. This is because I think your requirements are better suited to a <code>Collection</code>: a) I note your raw data could be quite large (perhaps in excess of 3000 items), and I believe that adding to a <code>Collection</code> is quicker, and b) you wouldn't have the hassle of referencing the <code>Runtime</code> library.</p>\n\n<p>Below is an example of a class object with a couple of additional functions to show you how it could work. You create it in your editor with <em>Insert ~> Class Module</em> I've called this class <code>cItems</code> in the <em>Name</em> properties window:</p>\n\n<pre><code>Public Key As String\nPublic Sum As Long\nPublic Count As Long\nPublic ItemList As Collection\nPublic Function Mean() As Double\n    Mean = Sum / Count\nEnd Function\nPrivate Sub Class_Initialize()\n    Sum = 0\n    Count = 0\n    Set ItemList = New Collection\nEnd Sub\n</code></pre>\n\n<p>You would then add the items to your collection in your main module as follows:</p>\n\n<pre><code>Dim col As Collection\nDim dataItems As cItems\nDim itemKey As String\nDim item1 As Long\nDim ws As Worksheet\nDim r As Long\n\nSet ws = ThisWorkbook.Worksheets(\"RAW_DATA\")\nSet col = New Collection\n\nFor r = 2 To 3000\n    itemKey = CStr(ws.Cells(r, \"A\").Value2) '~~adjust to your own column(s)\n    item1 = CLng(ws.Cells(r, \"B\").Value2) '~~adjust to your own column(s)\n\n    'Check if key already exists\n    Set dataItems = Nothing: On Error Resume Next\n    Set dataItems = col(itemKey): On Error GoTo 0\n\n    'If key doesn't exist, create a new class object\n    If dataItems Is Nothing Then\n        Set dataItems = New cItems\n        dataItems.Key = itemKey\n        col.Add dataItems, itemKey\n    End If\n\n    'Add cell values to the class object\n    With dataItems\n        .Sum = .Sum + item1\n        .Count = .Count + 1\n        .ItemList.Add item1\n    End With\n\nNext\n</code></pre>\n\n<p>If you wanted to access any or all of the items you'd do it like so:</p>\n\n<pre><code>'Iterating through all of the items\nFor Each dataItems In col\n    Debug.Print dataItems.Mean\nNext\n\n'Selecting one item\nSet dataItems = col(\"PersonA\")\nDebug.Print dataItems.Mean\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 0, "last_activity_date": 1447852226, "creation_date": 1447852226, "answer_id": 33780988, "question_id": 33771493, "link": "https://stackoverflow.com/questions/33771493/vba-scripting-dictionary-multiple-items-per-key-and-sum-count-on-items/33780988#33780988", "title": "VBA scripting dictionary, multiple items per key and sum/count on items", "body": "<p><em>solution is similar with</em> <strong>@Jeeped</strong> <em>answer, but has some difference</em>.<br></p>\n\n<pre><code>Sub test()\n    Dim i, cl As Range, Dic As Object\n    Set Dic = CreateObject(\"Scripting.Dictionary\")\n    Dic.CompareMode = vbTextCompare\n    For Each cl In Sheets(\"RAW_DATA\").[A2:A6]\n        If Not Dic.Exists(cl.Value) Then\n            Dic.Add cl.Value, cl.Offset(, 1).Value2 &amp; \"|\" &amp; 1\n        Else\n            Dic(cl.Value) = Split(Dic(cl.Value), \"|\")(0) + cl.Offset(, 1).Value2 &amp; _\n                        \"|\" &amp; Split(Dic(cl.Value), \"|\")(1) + 1\n        End If\n    Next cl\n    Debug.Print \"Key\", \"Sum\", \"Count\"\n    For Each i In Dic\n        Debug.Print i, Split(Dic(i), \"|\")(0), Split(Dic(i), \"|\")(1)\n    Next i\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><em>test</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/f6H6A.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f6H6A.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 405, "user_id": 4383598, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/511addb992e2bbf153eecf243285fd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Citanaf", "link": "https://stackoverflow.com/users/4383598/citanaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27294, "favorite_count": 7, "accepted_answer_id": 33774083, "answer_count": 4, "score": 10, "last_activity_date": 1447852226, "creation_date": 1447818551, "last_edit_date": 1531164843, "question_id": 33771493, "link": "https://stackoverflow.com/questions/33771493/vba-scripting-dictionary-multiple-items-per-key-and-sum-count-on-items", "title": "VBA scripting dictionary, multiple items per key and sum/count on items", "body": "<p>I am wishing to create a dictionary with multiple items per key. Below is the code I am working with now. I've spend over 7 hours playing with the dictionary and I can't seem to figure it out. I have no problem getting the unique values from a my range input as keys to my dictionary, the problem comes when I want to add items to each key. If the key already exists, I would like to SUM (or add) to that key's item's, or increase the \"count\" for that key, which would be stored in another item of that key. Perhaps it's best explained through visuals.</p>\n\n<pre><code>Key        Item1      Item2\nPersonA    20         SomeOtherVal\nPersonB    40         SomeOtherVal\nPersonA    80         SomeOtherVal\nPersonB    17         SomeOtherVal\nPersonC    13         SomeOtherVal\n\nResult:\nKey        Item1(Sum) Item2(Count)\nPersonA    100        2\nPersonB    57         2\nPersonC    13         1\n</code></pre>\n\n<p>So as you can see, all unique items that exist are created as their own key. If the key already exists, Item1 is added to the key's current total, item 2 has a count and that is increased by 1. Below is the code I'm working with, I appreicate your assistance. </p>\n\n<pre><code>Sub dictionaryCreate()\n\nDim Pair As Variant\nDim q As Range\nDim RAWDATA As Range\n\nDim d As Dictionary                             'Object\nSet d = New Dictionary                          'CreateObject(\"Scripting.Dictionary\")\n\nSet RAWDATA = Worksheets(\"RAW_DATA\").Range(Cells(2, 1), Cells(3000, 1))\nFor Each q In RAWDATA\n    Pair = q.Offset(0, 60).Value + q.Offset(0, 65).Value\n    If d.Exists(Pair) Then\n        'ADD to item1 SUM\n        'Add to item2 COUNT\n    Else\n        d(Pair) = 1 'create new key\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1447821492, "post_id": 33771278, "comment_id": 55311047, "body": "Is <code>id</code> in the <code>listuser</code> table? If there is a <code>john</code> record, which record&#39;s <code>id</code> field gets updated to 1234? All of them? Just the <code>john</code>s?"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1447827214, "post_id": 33771278, "comment_id": 55312986, "body": "Why VBA and not SQL?"}, {"owner": {"reputation": 69, "user_id": 2214296, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/eb0df583785a2d64a8a10a26e9b0b904?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/2214296/leon"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1447828121, "post_id": 33771278, "comment_id": 55313340, "body": "@Brad yes, id is a field from listuser table, just record the id of john."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 2214296, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/eb0df583785a2d64a8a10a26e9b0b904?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/2214296/leon"}, "edited": false, "score": 0, "creation_date": 1447895521, "post_id": 33786524, "comment_id": 55353918, "body": "nice. one question though, if i want to make the UpdateListUser to skip inputing if the ID is not blank, can I write like this?  PARAMETERS newId Long, userName Text ( 255 ); UPDATE listuser  IIf ([id] =null,SET listuser.id = newId , null)   WHERE (((listuser.[name])=userName));"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 69, "user_id": 2214296, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/eb0df583785a2d64a8a10a26e9b0b904?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/2214296/leon"}, "edited": false, "score": 0, "creation_date": 1447896121, "post_id": 33786524, "comment_id": 55354103, "body": "@Leon Are you asking that if you pass in a null <code>id</code> can the update query set listuser.id to null? Or, the way I&#39;m reading <code>IIf ([id] =null,SET listuser.id = newId , null) </code>, I see If <code>id</code> is null then set listuser.id = null (because id = null) otherwise do nothing. ?"}, {"owner": {"reputation": 69, "user_id": 2214296, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/eb0df583785a2d64a8a10a26e9b0b904?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/2214296/leon"}, "edited": false, "score": 0, "creation_date": 1447896390, "post_id": 33786524, "comment_id": 55354176, "body": "sorry, what i meant is if the id is not null, it skip inputting new value on id field. IIf ([id] =null, [leave id value alone] , SET listuser.id = newId). Is it possible to add command inside conditional like this?"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 69, "user_id": 2214296, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/eb0df583785a2d64a8a10a26e9b0b904?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/2214296/leon"}, "edited": false, "score": 0, "creation_date": 1447897680, "post_id": 33786524, "comment_id": 55354509, "body": "@Leon see my edit, this will not allow the update statement to let id ever be null. Now if you really need this strictly enforced you should design your table such that it can never happen anyway. Mark <code>id</code> as either the primary key (likely given the column name) or make it a required column."}, {"owner": {"reputation": 69, "user_id": 2214296, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/eb0df583785a2d64a8a10a26e9b0b904?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/2214296/leon"}, "edited": false, "score": 0, "creation_date": 1447921979, "post_id": 33786524, "comment_id": 55363381, "body": "Thanks, is there any other way running query with passing parameter like that without using DAO?"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 69, "user_id": 2214296, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/eb0df583785a2d64a8a10a26e9b0b904?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/2214296/leon"}, "edited": false, "score": 0, "creation_date": 1447955024, "post_id": 33786524, "comment_id": 55386997, "body": "@Leon You can use ADO, the syntax is different, but that&#39;s the other way. DAO is the default. Is there a reason you don&#39;t want DAO?"}, {"owner": {"reputation": 69, "user_id": 2214296, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/eb0df583785a2d64a8a10a26e9b0b904?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/2214296/leon"}, "edited": false, "score": 0, "creation_date": 1447978737, "post_id": 33786524, "comment_id": 55399427, "body": "the computer I use has some kind of ridiculous admin restriction stuff that won&#39;t let me change the reference, even ADO and DAO not checked on reference. If I use DoCmd.RunSQL, is there any way to apply the conditional? well at least to search if the field name on table contain &quot;john&quot;. Thank you for your help and patience."}], "tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": true, "score": 1, "last_activity_date": 1447897592, "last_edit_date": 1447897592, "creation_date": 1447867747, "answer_id": 33786524, "question_id": 33771278, "link": "https://stackoverflow.com/questions/33771278/how-to-search-if-certain-field-of-table-already-contain-specific-value-using-vba/33786524#33786524", "title": "How to search if certain field of table already contain specific value using VBA in ms access", "body": "<p>A combo of VBA and SQL seems like it can handle this</p>\n\n<p>If we define two queries we can use them in VBA</p>\n\n<p><code>UpdateListUser</code>:</p>\n\n<pre><code>PARAMETERS newId Long, userName Text ( 255 );\nUPDATE listuser SET listuser.id = iif(newId is null, listuser.id, newId)\nWHERE (((listuser.[name])=userName));\n</code></pre>\n\n<p>and <code>InsertNewUser</code>:</p>\n\n<pre><code>PARAMETERS newId Long, userName Text ( 255 );\nINSERT INTO Listuser ( id, name )\nVALUES (newId, username);\n</code></pre>\n\n<p>You would make and save these using the Create > Query Design > SQL View window in the regular Access interface.</p>\n\n<p>Then to use them in VBA you can have a function like this</p>\n\n<pre><code>Dim id As Integer, username As String\nid = 1234\nusername = \"John\"\n\nDim cmd As New DAO.QueryDef\nDim db As DAO.Database\nSet db = CurrentDb\n\nDim updListUser As DAO.QueryDef\nSet updListUser = db.QueryDefs(\"UpdateListUser\")\nupdListUser.Parameters(\"newId\") = id\nupdListUser.Parameters(\"UserName\") = username\nupdListUser.Execute\n\nDebug.Print updListUser.RecordsAffected\n\nIf updListUser.RecordsAffected = 0 Then\n    Dim insertNewUser As DAO.QueryDef\n    Set insertNewUser = db.QueryDefs(\"InsertNewUser\")\n    insertNewUser.Parameters(\"newId\") = id\n    insertNewUser.Parameters(\"UserName\") = username\n    insertNewUser.Execute\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 2214296, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/eb0df583785a2d64a8a10a26e9b0b904?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/2214296/leon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 33786524, "answer_count": 1, "score": 0, "last_activity_date": 1447897592, "creation_date": 1447817050, "question_id": 33771278, "link": "https://stackoverflow.com/questions/33771278/how-to-search-if-certain-field-of-table-already-contain-specific-value-using-vba", "title": "How to search if certain field of table already contain specific value using VBA in ms access", "body": "<p>I would like to do something like,</p>\n\n<pre><code>if field table \"name\" of table \"listuser\" already contain \"john\",\n   update the \"id\" field to 1234.\nelse - create a new record with name \"john\" \n   and update the id field to 1234.\n</code></pre>\n\n<p>how to write the \"field table \"name\" of table \"listuser\" already contain \"john\"\" part in vba?</p>\n"}, {"tags": ["excel", "odbc", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 1, "last_activity_date": 1447816731, "creation_date": 1447816731, "answer_id": 33771233, "question_id": 33770841, "link": "https://stackoverflow.com/questions/33770841/removing-excel-table-object-header-by-vba/33771233#33771233", "title": "Removing Excel Table Object Header by VBA", "body": "<p>The <code>HeaderRowRange</code> is an integral part of the <code>ListObject</code> as such it cannot be deleted. Therefore, if you need to delete the header data then you have to first convert the <code>ListObject</code> to a standard excel range using the <code>Unlist</code> method of the ListObject.  Add this code into your procedure:</p>\n\n<p>The code is actually deleting the entire header row... <em>(select the option you need)</em></p>\n\n<pre><code>Dim rHdr As Range\n\n    Set rHdr = ActiveSheet.ListObjects(\"CURRENT_ACCOUNT_QUERY_0001\").HeaderRowRange\n    Lob.Unlist\n    'Selec the option required\n    rHdr.EntireRow.Delete      'Use this line if you want to delete the entire row\n    'rHdr.Delete Shift:=xlUp    'Use this line if you want to delete only the header cells\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5574667, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153351584494094/picture?type=large", "display_name": "Wong Ka Ming", "link": "https://stackoverflow.com/users/5574667/wong-ka-ming"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1960, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447816731, "creation_date": 1447813905, "last_edit_date": 1531164843, "question_id": 33770841, "link": "https://stackoverflow.com/questions/33770841/removing-excel-table-object-header-by-vba", "title": "Removing Excel Table Object Header by VBA", "body": "<p>I am now working on some VBA code and keep stuck in it.\nI am truly appreciated if someone here may help.</p>\n\n<p>Indeed, I am now applying SQL query through Excel ODBC for extracting data from AS400 .\nHowever, I would like to extract the data only without the header.</p>\n\n<p>Therefore, I am applying the following VBA code to remove the table header </p>\n\n<pre><code>ActiveSheet.ListObjects(\"CURRENT_ACCOUNT_QUERY_0001\").ShowHeaders = False\n</code></pre>\n\n<p>However, this is not working well as the table header value still remained and the extracted value is shifted down 1 row.</p>\n\n<p>Does any one may suggest the way to remove the table header by VBA code\nor Exclude the header row during data extraction.</p>\n\n<p>Thanks a lot</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1, "user_id": 5574553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/660ea2987e747035909cb76ddae6b015?s=128&d=identicon&r=PG&f=1", "display_name": "anujpatel", "link": "https://stackoverflow.com/users/5574553/anujpatel"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1447815561, "post_id": 33770551, "comment_id": 55309592, "body": "Thanks, I will be sure to do that next time."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5574553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/660ea2987e747035909cb76ddae6b015?s=128&d=identicon&r=PG&f=1", "display_name": "anujpatel", "link": "https://stackoverflow.com/users/5574553/anujpatel"}, "edited": false, "score": 0, "creation_date": 1447815620, "post_id": 33770618, "comment_id": 55309607, "body": "When I try to filter it, should it be &quot;does not contain: Location&quot;? and when I do that, it affects the data in column C as well (cannot see locations anymore)."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 1, "user_id": 5574553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/660ea2987e747035909cb76ddae6b015?s=128&d=identicon&r=PG&f=1", "display_name": "anujpatel", "link": "https://stackoverflow.com/users/5574553/anujpatel"}, "edited": false, "score": 0, "creation_date": 1447817074, "post_id": 33770618, "comment_id": 55309955, "body": "1) enter the formula in column <code>C</code> 2) Copy Paste values in column <code>C</code> (so when you clear the cells in column <code>B</code> this is not affected as you have now the values and no the formulas) 3) Filter column <code>B</code> with Location (the Location value still there as you have not done anything as yet to this column 4) Do as you need i.e. delete the entire rows or clear the contents of the filtered cells in column <code>B</code>"}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1447812536, "creation_date": 1447812536, "answer_id": 33770618, "question_id": 33770551, "link": "https://stackoverflow.com/questions/33770551/splitting-data-into-two-columns/33770618#33770618", "title": "Splitting data into two columns", "body": "<p>No need of VBA\nEnter this formula in <code>C2</code> and copy till last record</p>\n\n<pre><code>=IF(LEFT(B3,9)=\"Location:\",B3,\"\")\n</code></pre>\n\n<p>Then copy paste values in column <code>C</code>, filter column <code>B</code> for <code>Location:*</code> and clear the resulting cells in column <code>B</code> or delete the rows (do as needed).</p>\n"}, {"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1447813071, "post_id": 33770664, "comment_id": 55308890, "body": "Yes and you want it to be deleted, by shifting up in column C, B3 is now in C2 also"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": -1, "last_activity_date": 1447812779, "creation_date": 1447812779, "answer_id": 33770664, "question_id": 33770551, "link": "https://stackoverflow.com/questions/33770551/splitting-data-into-two-columns/33770664#33770664", "title": "Splitting data into two columns", "body": "<p>I would copy column B, paste it in column C then select C1 and press ctrl-- (CTRL and Minus together)</p>\n\n<p>Select shift cells up and click OK.</p>\n\n<p>Then either sort by column A or filter out any with a blank in column A.</p>\n"}, {"tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": false, "score": -1, "last_activity_date": 1447824807, "creation_date": 1447824807, "answer_id": 33772509, "question_id": 33770551, "link": "https://stackoverflow.com/questions/33770551/splitting-data-into-two-columns/33772509#33772509", "title": "Splitting data into two columns", "body": "<p>You can also use this:</p>\n\n<pre><code> =IF(ISNUMBER(SEARCH(\"Location\",B2)),B2,\"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/LF6Tc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LF6Tc.png\" alt=\"P1\"></a></p>\n\n<p>Then apply conditional formatting to your data range as following:\n<a href=\"https://i.stack.imgur.com/jdViE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jdViE.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Final Result</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/GDfYe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GDfYe.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 5574553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/660ea2987e747035909cb76ddae6b015?s=128&d=identicon&r=PG&f=1", "display_name": "anujpatel", "link": "https://stackoverflow.com/users/5574553/anujpatel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1447824807, "creation_date": 1447812161, "last_edit_date": 1447813068, "question_id": 33770551, "link": "https://stackoverflow.com/questions/33770551/splitting-data-into-two-columns", "title": "Splitting data into two columns", "body": "<p>I have a very large Excel spreadsheet that looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/E9sOh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E9sOh.png\" alt=\"[What it currently looks like](http://puu.sh/lpsyk/382e7fd3f6.png)\"></a></p>\n\n<p>However, I want to move every cell in the second column that starts with Location to the next column. </p>\n\n<p>So it would look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dzl1T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dzl1T.png\" alt=\"[What I want it to look like](http://puu.sh/lpsDY/482be92bce.png)\"></a></p>\n"}, {"tags": ["vba", "excel", "ime"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1447831052, "post_id": 33769827, "comment_id": 55314575, "body": "isn&#39;t that simply <code>Application.SendKeys (&quot;{CONVERT}&quot;)</code>?"}, {"owner": {"reputation": 167, "user_id": 4622254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3831cbeb09d82e9392aceb71378271?s=128&d=identicon&r=PG&f=1", "display_name": "The Wandering Coder", "link": "https://stackoverflow.com/users/4622254/the-wandering-coder"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1447831342, "post_id": 33769827, "comment_id": 55314689, "body": "@DirkReichel  Not that I can see. I get a [Method &#39;SendKeys of object &#39;_Application&#39; failed error]. Unless I am writing it wrong. Did you want to have a stab at an answer with a bit of code?"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1447831520, "post_id": 33769827, "comment_id": 55314781, "body": "was a LOOONG time ago... i remember something like it was a special key like <code>{UP}</code>... need to search for it again... may take a while (i still remember finding that was like hell) also was for VB and not VBA :/"}, {"owner": {"reputation": 167, "user_id": 4622254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3831cbeb09d82e9392aceb71378271?s=128&d=identicon&r=PG&f=1", "display_name": "The Wandering Coder", "link": "https://stackoverflow.com/users/4622254/the-wandering-coder"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1447831615, "post_id": 33769827, "comment_id": 55314826, "body": "@DirkReichel It is fine if it takes a while. As long as I get there in the end. It would cut off close to 2 hours of input work a day. Working with anything Japanese and attempting to code it is always such a huge hassle."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1447831871, "post_id": 33769827, "comment_id": 55314937, "body": "please try <code>{VK 23}</code>"}, {"owner": {"reputation": 167, "user_id": 4622254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3831cbeb09d82e9392aceb71378271?s=128&d=identicon&r=PG&f=1", "display_name": "The Wandering Coder", "link": "https://stackoverflow.com/users/4622254/the-wandering-coder"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1447832013, "post_id": 33769827, "comment_id": 55315005, "body": "No dice I&#39;m afraid. I am getting the same error."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1447832067, "post_id": 33769827, "comment_id": 55315033, "body": "hmm.... you may check <a href=\"http://orlando.mvps.org/SendKeysMore.asp\" rel=\"nofollow noreferrer\">orlando.mvps.org/SendKeysMore.asp</a>"}, {"owner": {"reputation": 167, "user_id": 4622254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3831cbeb09d82e9392aceb71378271?s=128&d=identicon&r=PG&f=1", "display_name": "The Wandering Coder", "link": "https://stackoverflow.com/users/4622254/the-wandering-coder"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1447832613, "post_id": 33769827, "comment_id": 55315287, "body": "I will give it a look and let you know how it went."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1447832658, "post_id": 33769827, "comment_id": 55315307, "body": "i also remember the keyboard setting needs to be at hiragana-mode... i&#39;ll play with it again... if i got the solution again, i&#39;ll come back"}, {"owner": {"reputation": 167, "user_id": 4622254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3831cbeb09d82e9392aceb71378271?s=128&d=identicon&r=PG&f=1", "display_name": "The Wandering Coder", "link": "https://stackoverflow.com/users/4622254/the-wandering-coder"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1447835387, "post_id": 33769827, "comment_id": 55316666, "body": "I have found the Application.GetPhonetic() function in VBA but it is giving out blank strings (&quot;&quot;). If that was working then this question would have an answer."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1447838120, "post_id": 33769827, "comment_id": 55318383, "body": "i&#39;ll give up for now... sorry... i&#39;m still sure it was a special key, but i cant remember... sorry"}], "answers": [{"tags": [], "owner": {"reputation": 167, "user_id": 4622254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3831cbeb09d82e9392aceb71378271?s=128&d=identicon&r=PG&f=1", "display_name": "The Wandering Coder", "link": "https://stackoverflow.com/users/4622254/the-wandering-coder"}, "is_accepted": true, "score": 1, "last_activity_date": 1448351449, "last_edit_date": 1448351449, "creation_date": 1448338906, "answer_id": 33885423, "question_id": 33769827, "link": "https://stackoverflow.com/questions/33769827/programming-a-japanese-keyboard-henkan-%e5%a4%89%e6%8f%9b-button/33885423#33885423", "title": "Programming a Japanese keyboard &quot;Henkan&quot; \u300c\u5909\u63db\u300d button", "body": "<p>Although I don't like to answer my own questions, I have found a solution.</p>\n\n<p>In order to get the Excel [PHONETIC] function to work properly, [Japanese Editing Tools] must be installed. These are found in either a Language Pack (which for Excel 2010 is USD$25 each) or by installing from a Japanese Language Microsoft Office [2010] installation disk - Just installing the tools to an English Office edition is possible (thus mitigating the need for a full Japanese edition installation).</p>\n\n<p><strong>Failure to install the [Japanese Editing Tools] will mean that the [PHONETIC] function will ALWAYS contain a blank string (unless syntactically incorrect) for both the in-cell and VBA functions.</strong></p>\n\n<p>The full steps are as follows.</p>\n\n<ol>\n<li><p>Install Microsoft Office Japanese Editing Tools for your edition of Microsoft Office (MO2010 > Install JET MO2010 edition)</p></li>\n<li><p>Use the [PHONETIC] Function.</p>\n\n<ul>\n<li>This can be used as an in-cell function with the format</li>\n</ul>\n\n<p><code>=Phonetic(reference)</code></p>\n\n<p>Where [reference] is the name of a cell ie.[A2] - You can <strong>NOT</strong> directly input a string into this in-cell function).</p>\n\n<ul>\n<li>In VBA the function is <code>Application.GetPhonetic(text)</code></li>\n</ul>\n\n<p>Where [text] is either directly inputted, a string variable or a reference to a cell with a string. </p></li>\n<li><p>Assuming automated Hiragana is required as Kanji is entered into a Userform Textbox.</p></li>\n</ol>\n\n<p><em>Kanji Input TextBox => [KanjiBox], Hiragana Reading TextBox => [YomiBox]</em></p>\n\n<pre><code>Private Sub KanjiBox_Change()\n    'Finds last entry in Range (for this example, range is in the [B] column)\n    lastEntry = Sheets(\"Entries\").Range(\"B1048576\").End(xlUp).Row\n    'Finds if entry already exists in range, if it does;_\n     launches MsgBox Warning and clears all fields. Range starts from Row 7.\n    For entryRow = 7 To lastEntry\n        If KanjiBox = Sheets(\"Entries\").Range(\"B\" &amp; entryRow) Then\n            MsgBox \"There is already an entry for \" &amp; KanjiBox\n            KanjiBox = \"\"\n            YomiBox = \"\"\n            Exit For\n        End If\n    Next entryRow\n    'This sets the [YomiBox] as a Hiragana reading of the Kanji_\n     (Uses StrConv to change the Phonetic result from Katakana to Hiragana)\n    YomiBox = StrConv(Application.GetPhonetic(KanjiBox), vbHiragana)\n    'The following fixes leftover reading text when backspacing\n    If KanjiBox = \"\" Then\n        YomiBox = \"\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Using this method, \u300c\u5909\u63db\u300d key emulation was not required.</p>\n\n<p>Any way of Emulating the \u300c\u5909\u63db\u300d key as a key press event, without the use of third party applications is still, as yet, unknown by me. </p>\n"}], "owner": {"reputation": 167, "user_id": 4622254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3831cbeb09d82e9392aceb71378271?s=128&d=identicon&r=PG&f=1", "display_name": "The Wandering Coder", "link": "https://stackoverflow.com/users/4622254/the-wandering-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 880, "favorite_count": 0, "accepted_answer_id": 33885423, "answer_count": 1, "score": 2, "last_activity_date": 1467131046, "creation_date": 1447807201, "last_edit_date": 1447809924, "question_id": 33769827, "link": "https://stackoverflow.com/questions/33769827/programming-a-japanese-keyboard-henkan-%e5%a4%89%e6%8f%9b-button", "title": "Programming a Japanese keyboard &quot;Henkan&quot; \u300c\u5909\u63db\u300d button", "body": "<p>I am programming VBA(7.0) in Excel 2010 and am trying to make a macro that  will change a string variable (containing Kanji) into it's Hiragana constituents. As far as I could tell there are no VBA-specific methods to do this. Hence, I assume the way to go about it, is to attempt to emulate the [henkan] \u300c\u5909\u63db\u300d button on a Japanese Keyboard. </p>\n\n<p>For those not accustomed to Japanese Keyboards, the \u300c\u5909\u63db\u300d button is used to change constituent Hiragana as it is written, into a Kanji compound (likewise highlighting existing text and pressing it will offer options to change it to other Kanji as well as it's constituent Hiragana or Katakana). Pressing the button will bring up a list from the IME which lists possible selections for your entry.</p>\n\n<p>I gathered from <a href=\"https://web.stanford.edu/class/cs140/projects/pintos/specs/kbd/scancodes-7.html\" rel=\"nofollow\">here</a> and <a href=\"https://msdn.microsoft.com/en-GB/library/ms892472.aspx\" rel=\"nofollow\">here</a> that the scancode of the button in question is 79.</p>\n\n<p>Putting 1 + 1 together (getting 3) and trying the code below didn't yield any results.</p>\n\n<pre><code>Private Sub test_Click()\n  Sheets(\"Main\").Range(\"A1\").Select   '&lt;--- A1 contains a Kanji Compound\n  Application.SendKeys (79)   '&lt;--- Both (79) and (\"79\") were tried\nEnd Sub\n</code></pre>\n\n<p>I noticed there are the following VBA functions (which may end up helping with an end result) but they don't seem to help the situation.</p>\n\n<ul>\n<li>StrConv (Can convert Hiragana &lt;> Katakana, but not Kanji)</li>\n<li>Phonetics\n\n<ul>\n<li>.Add (Can add the reading of the Kanji (as Furigana) however this requires user input and is not automatic).</li>\n<li>.CharacterType (Returns or sets the phonetics type; Hiragana, Katakana etc.) </li>\n</ul></li>\n<li>IME (Largely used to set input rules)</li>\n</ul>\n\n<p>A co-worker suggested that I may need to look at the IME API to see firstly, if I can access it (permissions with the API), and secondly if it will let me know the way of accessing the key. However my experience with API'S (especially IME) is nil to none.</p>\n\n<p><strong>Is there a VBA-specific way of emulating the Kanji -> Hiragana Process (only a one way Kanji to Hiragana conversion is required)?</strong></p>\n\n<p><strong>Failing that, is there a process which could sendkey the\u300c\u5909\u63db\u300d button and select the Hiragana option?</strong></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1447808291, "post_id": 33769817, "comment_id": 55307567, "body": "It can be done with vba, but SO is not a &quot;code for me site&quot;.  Look into iterating or looping through cells, inserting rows, copying or filling down and deleting column."}], "answers": [{"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": -2, "last_activity_date": 1447809146, "creation_date": 1447809146, "answer_id": 33770099, "question_id": 33769817, "link": "https://stackoverflow.com/questions/33769817/insert-new-rows-and-populate/33770099#33770099", "title": "Insert new rows and populate", "body": "<p>It's only 10 lines of code. SO is not a code sweatshop where we do the work for you, it is one where we help you work it out for yourself.</p>\n\n<p>This will poll the rows for you going backwards:</p>\n\n<pre><code>For X = Range(\"A\" &amp; Rows.Count).End(xlUp).Row To 1 Step -1\n</code></pre>\n\n<p>This is key because you will be inserting rows, going forwards creates all sort of nastiness.</p>\n\n<p>You will then need a loop inside there using your qty as a reference. Here is one I built but you will need to make some changes for it to work for your columns:</p>\n\n<pre><code>For Y = 1 To Range(\"B\" &amp; X).Value - 1\n</code></pre>\n\n<p>Then you need to copy row X inside this loop</p>\n\n<p>Next line will be an insert with a shift down (like this <code>Insert Shift:=xlDown</code>) on row X + 1 or on an offset of row X by 1 row, your choice how you do this.</p>\n\n<p>Last thing to do is delete column C, This can be done like this <code>Range(\"C1\").EntireColumn.Delete</code></p>\n\n<p>That is it, the whole macro, just drop a couple of nexts and an end sub and run it.</p>\n\n<p>You will need to Dim X and Y, dim them as longs.</p>\n\n<p>Have a go, if you get stuck post back with the code you have put together and we can help you fix it.</p>\n"}], "owner": {"reputation": 101, "user_id": 3339240, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/720632887/picture?type=large", "display_name": "raymantle", "link": "https://stackoverflow.com/users/3339240/raymantle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 492, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1447809146, "creation_date": 1447807131, "last_edit_date": 1447808136, "question_id": 33769817, "link": "https://stackoverflow.com/questions/33769817/insert-new-rows-and-populate", "title": "Insert new rows and populate", "body": "<p>I need help creating a excel macro to split orders based on qty column.\nIn the before sheet we have 4 orders with two of them having a qty greater the 1. see before macro image</p>\n\n<p>What I need is an excel macro that can check the qty field and insert new rows below based on qty value if greater then 1, then populate these rows with the data from the original row. \nThen the last step would be to delete the C column. See After Macro image</p>\n\n<p>I have never used macros before, so i'm not even sure if this can be done.</p>\n\n<p><a href=\"https://i.stack.imgur.com/IA0vv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IA0vv.png\" alt=\"Before Marco\"></a>\n<a href=\"https://i.stack.imgur.com/c8s5Q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c8s5Q.png\" alt=\"After Macro\"></a></p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1447807110, "post_id": 33769790, "comment_id": 55307212, "body": "Have a look at the <code>=AVERAGE()</code>-Function."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447808102, "post_id": 33769790, "comment_id": 55307524, "body": "The <code>AverageIf()</code> or <code>AverageIfs()</code> would work as they allow you to put in criteria to determine which values to average."}], "answers": [{"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 33, "user_id": 5302927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e993a12d361b2bb62479eab78c07ed?s=128&d=identicon&r=PG&f=1", "display_name": "ssteinec", "link": "https://stackoverflow.com/users/5302927/ssteinec"}, "edited": false, "score": 0, "creation_date": 1447814830, "post_id": 33770755, "comment_id": 55309400, "body": "Glad it&#39;s what you needed. Appreciate if you acknowledge the answer as it will help us to keep the site updated and it&#39;ll be a better reference for other users with same question."}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 6, "last_activity_date": 1447813370, "creation_date": 1447813370, "answer_id": 33770755, "question_id": 33769790, "link": "https://stackoverflow.com/questions/33769790/calculate-monthly-average-from-daily-data-without-pivottable/33770755#33770755", "title": "Calculate monthly average from daily data without PivotTable", "body": "<p>Assuming you have the months in column <code>D</code> enter this formula in <code>E2</code> and copy till last month</p>\n\n<pre><code>=AVERAGEIFS($B$1:$B$62,$A$1:$A$62,\"&gt;=\"&amp;D2,$A$1:$A$62,\"&lt;=\"&amp;EOMONTH(D2,0))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/MaFsV.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/MaFsV.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 392, "user_id": 3099567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938d9baf6e29eda581cd3d99ee9b45a2?s=128&d=identicon&r=PG&f=1", "display_name": "PankajR", "link": "https://stackoverflow.com/users/3099567/pankajr"}, "is_accepted": false, "score": 0, "last_activity_date": 1447840028, "creation_date": 1447840028, "answer_id": 33776586, "question_id": 33769790, "link": "https://stackoverflow.com/questions/33769790/calculate-monthly-average-from-daily-data-without-pivottable/33776586#33776586", "title": "Calculate monthly average from daily data without PivotTable", "body": "<blockquote>\n  <p>Some of the days contain no data at all.</p>\n</blockquote>\n\n<p>In case this means that there are no row for some dates and you want to calculate average based on full month than you can use the below formula:</p>\n\n<p>Continuing with example given by EEM</p>\n\n<pre><code>=SUMIFS($B$1:$B$62,$A$1:$A$62,\"&gt;=\"&amp;D2,$A$1:$A$62,\"&lt;=\"&amp;EOMONTH(D2,0))/DAY(EOMONTH(D2,0))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 2541906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb9da36bbe8817c461df33d395ee413?s=128&d=identicon&r=PG", "display_name": "gerdami", "link": "https://stackoverflow.com/users/2541906/gerdami"}, "is_accepted": false, "score": 0, "last_activity_date": 1471421495, "creation_date": 1471421495, "answer_id": 38991343, "question_id": 33769790, "link": "https://stackoverflow.com/questions/33769790/calculate-monthly-average-from-daily-data-without-pivottable/38991343#38991343", "title": "Calculate monthly average from daily data without PivotTable", "body": "<p>In case Daily Data contains some #N/A, one can add a additional criteria to skip non number data:</p>\n\n<pre><code>=AVERAGEIFS($B$1:$B$62,$A$1:$A$62,\"&gt;=\"&amp;D2,$A$1:$A$62,\"&lt;=\"&amp;EOMONTH(D2,0),$B$1:$B$62,\"&lt;10E69\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 11091235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2rrXj.png?s=128&g=1", "display_name": "Rikus Khan", "link": "https://stackoverflow.com/users/11091235/rikus-khan"}, "is_accepted": false, "score": 0, "last_activity_date": 1596132778, "last_edit_date": 1596132778, "creation_date": 1596130205, "answer_id": 63178376, "question_id": 33769790, "link": "https://stackoverflow.com/questions/33769790/calculate-monthly-average-from-daily-data-without-pivottable/63178376#63178376", "title": "Calculate monthly average from daily data without PivotTable", "body": "<p>Given a single date you can calculate both the End of the Month and the First of the Month for that date. Assume any given date is in E4:</p>\n<p>For the End of the Month</p>\n<pre><code>=EOMONTH(E4,0)\n</code></pre>\n<p>For the First of the Month</p>\n<pre><code>=EOMONTH(EDATE(E4,-1),0)+1\n</code></pre>\n<p>If you place a date, any date, of the month you want to review into cell E4 the two above code snipets will give you and last and first days of the month.  EDATE allows you to add and subtract whole numbers to change the month.  We take one month away from the current month, found within the date in cell E4, and then find the end of the month and add a one to it to become the first day of the next month.  It will work with any date.  The below example shows grade averages over a month referencing any given date within the month.</p>\n<p><a href=\"https://i.stack.imgur.com/h2A1A.png\" rel=\"nofollow noreferrer\">Pic of the above Excel example</a></p>\n<pre><code>=AVERAGEIFS(C2:C11, B2:B11,&quot;&gt;=&quot; &amp; EOMONTH(EDATE(E4,-1),0)+1, B2:B11,&quot;&lt;=&quot; &amp;EOMONTH(E4,0), A2:A11, E2)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5302927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e993a12d361b2bb62479eab78c07ed?s=128&d=identicon&r=PG&f=1", "display_name": "ssteinec", "link": "https://stackoverflow.com/users/5302927/ssteinec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37834, "favorite_count": 0, "accepted_answer_id": 33770755, "answer_count": 4, "score": 1, "last_activity_date": 1596132778, "creation_date": 1447806970, "last_edit_date": 1531161705, "question_id": 33769790, "link": "https://stackoverflow.com/questions/33769790/calculate-monthly-average-from-daily-data-without-pivottable", "title": "Calculate monthly average from daily data without PivotTable", "body": "<p>My worksheet contains two columns: column A contains the date in the format <code>dd/mm/yyyy</code> and column B contains the daily data. From the daily data I have to generate the monthly average for each month without a PivotTable. Some of the days contain no data at all. I cannot use a PivotTable as I have to use the monthly average to identify outliers in the daily data at a later stage.</p>\n\n<p>For this example it's important that I don't use a PivotTable and that I can generate the monthly average data for any month and year in my list. The solution can be an Excel formula or VBA.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1447806900, "post_id": 33769735, "comment_id": 55307146, "body": "If you do a search the first thing you&#39;ll find is mention of &#39;disable screen updating&#39;. Why don&#39;t you do a bit of googling."}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1447807427, "post_id": 33769735, "comment_id": 55307316, "body": "I&#39;m guessing with matching you mean the value, therefore you should use <code>FoundCell.Value = cell.Value</code> instead of <code>FoundCell = cell</code>."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447808735, "post_id": 33769735, "comment_id": 55307689, "body": "It&#39;s your data in <code>M2:M60</code> unique?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1447816079, "post_id": 33770214, "comment_id": 55309718, "body": "Might want to use <code>f(i, j).Interior.Color = s(k).DisplayFormat.Interior.Color</code> just in case the background &#39;Fill&#39; in column M is the result of conditional formatting. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838814.aspx\" rel=\"nofollow noreferrer\">Range.DisplayFormat property</a> will pick that up."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1447816800, "post_id": 33770214, "comment_id": 55309896, "body": "@Jeeped Yeah, I did not choose that since OP mentioned a desire to go another route from CF... though I suppose it is possible that he was specifically referring to the left-side range."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447821424, "post_id": 33770214, "comment_id": 55311032, "body": "It does actually slow things down an infinitesimal amount but that same amount can be recovered by using <code>m = s.Value2</code> instead of <code>m = s</code> (same for <code>n</code>). In any event, my comments are often designed more to educate future viewers of the solution than encouraging you to edit your answer to my way of thinking."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1447821740, "post_id": 33770214, "comment_id": 55311131, "body": "@Jeeped Value2 is marginally faster, only if the range includes date/time values."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447821935, "post_id": 33770214, "comment_id": 55311195, "body": "Actually, I picked up 0.03 seconds with your routine with <code>C2:K280, M2:M280</code> filled with a pair of randomized upper case letters. It was pretty much the same amount that I lost when I tried it with <code>.DisplayFormat</code>. (<code>=CHAR(RANDBETWEEN(65, 90))&amp;CHAR(RANDBETWEEN(65, 90))</code> then copied and paste values to generate sample data)"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1447822426, "post_id": 33770214, "comment_id": 55311362, "body": "Which API were you using to measure?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447822471, "post_id": 33770214, "comment_id": 55311377, "body": "Just <code>debug.print Timer</code>. (I didn&#39;t want to make this question a career position) :)"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1447823144, "post_id": 33770214, "comment_id": 55311617, "body": "Understood, but I&#39;m very confident on my position regarding Value2. To get millisecond accuracy you need to use one of the APIs:  <a href=\"https://fastexcel.wordpress.com/2011/05/31/a-quantum-of-time/\" rel=\"nofollow noreferrer\">fastexcel.wordpress.com/2011/05/31/a-quantum-of-time</a>"}, {"owner": {"reputation": 83, "user_id": 4636324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153152965999813/picture?type=large", "display_name": "Cr1kk0", "link": "https://stackoverflow.com/users/4636324/cr1kk0"}, "edited": false, "score": 0, "creation_date": 1448263031, "post_id": 33770214, "comment_id": 55494890, "body": "Thank you, that worked great, now I just need to find the time to look into how it actually works compared to mine."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 2, "last_activity_date": 1447862389, "last_edit_date": 1447862389, "creation_date": 1447809850, "answer_id": 33770214, "question_id": 33769735, "link": "https://stackoverflow.com/questions/33769735/making-for-each-loop-faster/33770214#33770214", "title": "Making &#39;For Each&#39; loop faster", "body": "<p>Try this. It should be instantaneous:</p>\n\n<pre><code>Sub CopyColors()\n\n    Dim i&amp;, j&amp;, k&amp;, m, n, s As Range, f As Range\n\n    Set s = [tally!m2:m60]\n    Set f = [tally!c2:k280]\n    m = s.Value2\n    n = f.Value2\n\n    For k = 1 To UBound(m)\n        With s(k)\n            For i = 1 To UBound(n, 1)\n                For j = 1 To UBound(n, 2)\n                    If LenB(m(k, 1)) Then\n                        If LenB(n(i, j)) Then\n                            If m(k, 1) = n(i, j) Then\n                                f(i, j).Interior.Color = .DisplayFormat.Interior.Color\n                            End If\n                        End If\n                    End If\n                Next\n            Next\n        End With\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1447821151, "creation_date": 1447821151, "answer_id": 33771891, "question_id": 33769735, "link": "https://stackoverflow.com/questions/33769735/making-for-each-loop-faster/33771891#33771891", "title": "Making &#39;For Each&#39; loop faster", "body": "<p>I would have thought that working with blocks of arrays in memory would have been the quickest route but this either ties or beats the nested <code>For ... Next</code> loops through the arrays by a few milliseconds.</p>\n\n<pre><code>Sub Find_FindNext_Colors()\n    Dim rTHIS As Range, rTHAT As Range, rTHOSE As Range\n\n    Debug.Print Timer\n\n    With Worksheets(\"Tally\")\n        With .Range(\"C2:K280, M2:M280\")  '&lt;~~in the union, M has to be same size as C:K\n            For Each rTHIS In .Parent.Range(\"M2:M60\") '&lt;~~only M2:M60\n                Set rTHAT = .Find(What:=rTHIS.Value2, After:=.Parent.Range(\"M60\"), LookAt:=xlWhole, _\n                                  SearchOrder:=xlByColumns, SearchDirection:=xlNext, _\n                                  MatchCase:=False, SearchFormat:=False)\n                Set rTHOSE = rTHAT\n                Do While rTHAT.Column &lt; rTHIS.Column\n                    Set rTHOSE = Union(rTHOSE, rTHAT)\n                    Set rTHAT = .FindNext(After:=rTHAT)\n                Loop\n                rTHOSE.Interior.Color = rTHIS.DisplayFormat.Interior.Color\n            Next rTHIS\n        End With\n    End With\n\n    Debug.Print Timer\n\nEnd Sub\n</code></pre>\n\n<p>I believe the scant few milliseconds are saved by assigning the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840499.aspx\" rel=\"nofollow\">Range.Interior.Color property</a> in groups rather than individually.</p>\n"}], "owner": {"reputation": 83, "user_id": 4636324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153152965999813/picture?type=large", "display_name": "Cr1kk0", "link": "https://stackoverflow.com/users/4636324/cr1kk0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 33770214, "answer_count": 2, "score": 0, "last_activity_date": 1447862389, "creation_date": 1447806604, "last_edit_date": 1447809046, "question_id": 33769735, "link": "https://stackoverflow.com/questions/33769735/making-for-each-loop-faster", "title": "Making &#39;For Each&#39; loop faster", "body": "<p>I have made the following code, however it takes ages to run through. I'm wondering if there may be a faster way. I want to copy the formatting (BG Color) from Range M2:M60 if it matches any cells in C2:K280. I could do conditional formatting, but as I'd need to enter 60+ items that may change was hoping I could use VBA.</p>\n\n<pre><code>Sub CopyColors()\n    Dim FoundCell As Range\n    Dim Search As String\n    Dim Searchrng As Range, cell As Range\n\n\nSet Searchrng = Sheets(\"Tally\").Range(\"M2:M60\")\n\nFor Each cell In Searchrng\n    For Each FoundCell In Sheets(\"Tally\").Range(\"C2:K280\")\n        If FoundCell = cell Then\n            cell.Copy\n            FoundCell.PasteSpecial xlPasteFormats\n        Else\n\n        End If\n    Next FoundCell\nNext cell\n\nRange(\"C2\").Select\n\nEnd Sub\n</code></pre>\n\n<p>-Cr1kk0</p>\n"}, {"tags": ["excel", "date", "vba"], "answers": [{"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 101, "user_id": 4421736, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7620ee5df01f1614bcf9c43a30632631?s=128&d=identicon&r=PG&f=1", "display_name": "Bernat", "link": "https://stackoverflow.com/users/4421736/bernat"}, "edited": false, "score": 0, "creation_date": 1447850510, "post_id": 33771830, "comment_id": 55326975, "body": "Glad it helps you, please acknowledge the answer and help us to keep the site updated and question completed..."}, {"owner": {"reputation": 101, "user_id": 4421736, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7620ee5df01f1614bcf9c43a30632631?s=128&d=identicon&r=PG&f=1", "display_name": "Bernat", "link": "https://stackoverflow.com/users/4421736/bernat"}, "edited": false, "score": 0, "creation_date": 1447851853, "post_id": 33771830, "comment_id": 55327918, "body": "Well to be precise the question is about to &quot;recognise the format without changing the language/location setup or doing some string manipulation&quot;. According to that I am in doubt although thankful. Do you guys go for the green tick in a case like this?"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 101, "user_id": 4421736, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7620ee5df01f1614bcf9c43a30632631?s=128&d=identicon&r=PG&f=1", "display_name": "Bernat", "link": "https://stackoverflow.com/users/4421736/bernat"}, "edited": false, "score": 0, "creation_date": 1447853226, "post_id": 33771830, "comment_id": 55328910, "body": "There is string manipulation, though you have the idea already, it was certainly improved not just by a better setting of the arrays, the loop was shortened and set as a function. Nevertheless, it&#39;s up to you, my concern is more about all those questions that are still open just because what it was asked it&#39;s just not possible, even though good alternatives were proposed. Think of when we revisit a question that still waiting for \u201cthe right answer\u201d and then we found that the answer provided is Ok and there is nothing else that can be done about it, nevertheless the question remains unanswered\u2026"}, {"owner": {"reputation": 101, "user_id": 4421736, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7620ee5df01f1614bcf9c43a30632631?s=128&d=identicon&r=PG&f=1", "display_name": "Bernat", "link": "https://stackoverflow.com/users/4421736/bernat"}, "edited": false, "score": 0, "creation_date": 1447896689, "post_id": 33771830, "comment_id": 55354247, "body": "Nicely put! Thanks again!"}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 1, "last_activity_date": 1447821278, "last_edit_date": 1447821278, "creation_date": 1447820713, "answer_id": 33771830, "question_id": 33769300, "link": "https://stackoverflow.com/questions/33769300/cdate-format-recognition-issue/33771830#33771830", "title": "CDate format recognition issue", "body": "<p>I suggest to create it as a function that way it can be used by any other procedure</p>\n\n<pre><code>Option Base 1\n\nFunction Date_Translation(sDate As String) As Date\nDim aMth1 As Variant, aMth2 As Variant\naMth1 = [{\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\", \"Dec\"}]\naMth2 = [{\"Jan\",\"Feb\",\"M\u00e1r\",\"\u00c1pr\",\"M\u00e1j\",\"J\u00fan\",\"J\u00fal\",\"Aug\",\"Szep\",\"Okt\",\"Nov\", \"Dec\"}]\nDim b As Byte\n    For b = 1 To 12\n        sDate = Replace(sDate, aMth1(b), aMth2(b))\n    Next\n    Date_Translation = CDate(sDate)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 4421736, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7620ee5df01f1614bcf9c43a30632631?s=128&d=identicon&r=PG&f=1", "display_name": "Bernat", "link": "https://stackoverflow.com/users/4421736/bernat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 33771830, "answer_count": 1, "score": 0, "last_activity_date": 1447821278, "creation_date": 1447804128, "last_edit_date": 1531164843, "question_id": 33769300, "link": "https://stackoverflow.com/questions/33769300/cdate-format-recognition-issue", "title": "CDate format recognition issue", "body": "<p>The problem is simple: <code>CDate(\"Oct 01, 2015\")</code> gives me <code>Type mismatch</code> error since I am working with a non-english setup. <code>CDate(\"Okt 01, 2015\")</code> works just fine. The date format is <code>Mon DD, YYYY</code>.</p>\n\n<p>What can I do to make Excel recognise the format without changing the language/location setup or doing some string manipulation?</p>\n\n<p>Using an array for exchanging the name of the month just doesn't look fancy enough.</p>\n\n<pre><code>month_name(0, 0) = \"Jan\"\nmonth_name(0, 1) = \"Jan\"\nmonth_name(1, 0) = \"Feb\"\nmonth_name(1, 1) = \"Feb\"\nmonth_name(2, 0) = \"Mar\"\nmonth_name(2, 1) = \"M\u00e1r\"\nmonth_name(3, 0) = \"Apr\"\nmonth_name(3, 1) = \"\u00c1pr\"\nmonth_name(4, 0) = \"May\"\nmonth_name(4, 1) = \"M\u00e1j\"\nmonth_name(5, 0) = \"Jun\"\nmonth_name(5, 1) = \"J\u00fan\"\nmonth_name(6, 0) = \"Jul\"\nmonth_name(6, 1) = \"J\u00fal\"\nmonth_name(7, 0) = \"Aug\"\nmonth_name(7, 1) = \"Aug\"\nmonth_name(8, 0) = \"Sep\"\nmonth_name(8, 1) = \"Szep\"\nmonth_name(9, 0) = \"Oct\"\nmonth_name(9, 1) = \"Okt\"\nmonth_name(10, 0) = \"Nov\"\nmonth_name(10, 1) = \"Nov\"\nmonth_name(11, 0) = \"Dec\"\nmonth_name(11, 1) = \"Dec\"\n\nstr = \"Oct 01, 2015\"\n\nFor counter = 0 To 11\n    If Left(str, 3) = month_name(counter, 0) Then\n        str = month_name(counter, 1) &amp; Right(str, Len(str) - 3)\n        Exit For\n    End If\nNext counter\n\nday_date = CDate(str)\n</code></pre>\n"}, {"tags": ["vba", "outlook", "hyperlink"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1447810104, "creation_date": 1447810104, "answer_id": 33770250, "question_id": 33768772, "link": "https://stackoverflow.com/questions/33768772/displaying-file-path-when-using-variables-to-create-hyperlinks-in-outlook-vba-h/33770250#33770250", "title": "Displaying file path when using variables to create hyperlinks in Outlook VBA (html and string concatenation)", "body": "<p>Using single-quotes on your attribute values simplifies your quoting a bit:</p>\n\n<pre><code>k = 0\nFor i = 1 To UBound(arr)\n    FilePath = arr(k)\n    oMsg.HTMLBody = \"&lt;a href='file://\" &amp; FilePath &amp; \"'&gt;\" &amp; _\n                      FilePath &amp; \"&lt;/a&gt;&lt;br&gt;\" &amp; oMsg.HTMLBody\n    k = k + 1\nNext i\n</code></pre>\n\n<p>Note - forward slashes are typically used when using <code>file://</code></p>\n"}], "owner": {"reputation": 115, "user_id": 5568811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/698cce8b5804f40bab25e4f216ade792?s=128&d=identicon&r=PG", "display_name": "Hector", "link": "https://stackoverflow.com/users/5568811/hector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1340, "favorite_count": 0, "accepted_answer_id": 33770250, "answer_count": 1, "score": 1, "last_activity_date": 1593518431, "creation_date": 1447801402, "last_edit_date": 1593518431, "question_id": 33768772, "link": "https://stackoverflow.com/questions/33768772/displaying-file-path-when-using-variables-to-create-hyperlinks-in-outlook-vba-h", "title": "Displaying file path when using variables to create hyperlinks in Outlook VBA (html and string concatenation)", "body": "<p>I'm creating a macro in Outlook to read file paths stored in an Excel file and create hyperlinks. I'm so close to getting it working but this last bit of code is driving me nuts. I have the string with the file path stored in a variable called FilePath. When I write the html to hyperlink the text displayed is the word FilePath instead of the string that variable is supposed to hold. I know I'm just messing up the quotations but I'm ripping out my hair trying to figure out where the right place to put them is. Here's my code:</p>\n\n<pre><code>k = 0\nFor i = 1 To UBound(arr)\n    FilePath = arr(k)\n    oMsg.HTMLBody = \"&lt;a href = \"\"file:\\\\\" &amp; FilePath &amp; \"\"\"&gt;FilePath&lt;/a&gt;\" &amp; \"&lt;br&gt;\" &amp; oMsg.HTMLBody\n    k = k + 1\nNext i\n</code></pre>\n\n<p>The hyperlink is correct and I can open the file when I click it but all the links say FilePath instead of the actual file path. Any pointers in the right direction would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447801476, "post_id": 33768756, "comment_id": 55305259, "body": "Google <code>instr</code>, <code>case</code>, loops... Edit: a <code>vlookup</code> should work too (unclear if searched string is whole or not)."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 1, "creation_date": 1447802153, "post_id": 33768756, "comment_id": 55305530, "body": "It&#39;s possible... That&#39;s the answer to your question. If you want to get more details then you must provide more details as well."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5574190, "user_type": "registered", "profile_image": "https://graph.facebook.com/1121518927859777/picture?type=large", "display_name": "Brian Mccaughan", "link": "https://stackoverflow.com/users/5574190/brian-mccaughan"}, "edited": false, "score": 0, "creation_date": 1447807529, "post_id": 33768980, "comment_id": 55307343, "body": "Thanks for your reply. That formula works perfectly for the examples i gave. However I should have realised that each bedroom/ensuite etc will have a specific number e.g. bedroom 1, bedroom 2..... I have tried using the * wildcard but can&#39;t get it to work."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1447889150, "post_id": 33768980, "comment_id": 55351788, "body": "And is that consistent? ie &quot;roomtype #&quot;. If it is  you can change so it compares only with the first word before a space using <code>=SUM(IF(LEFT(A1,FIND(&quot; &quot;,A1)-1)={&quot;bedroom&quot;,&quot;ensuite&quot;,&quot;lounge&quot;,&quot;door&quot;,&quot;fire&quot;},{2,2,2&zwnj;&#8203;,4,6},&quot;&quot;))</code> Cheers"}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": false, "score": 1, "last_activity_date": 1447802721, "last_edit_date": 1447802721, "creation_date": 1447802466, "answer_id": 33768980, "question_id": 33768756, "link": "https://stackoverflow.com/questions/33768756/search-cell-for-multiple-strings-and-return-multiple-values/33768980#33768980", "title": "Search cell for multiple strings and return multiple values", "body": "<p>Please consider using the following formula on cell <code>B1</code>:</p>\n\n<pre><code>=SUM(IF(A1={\"bedroom\",\"ensuite\",\"lounge\",\"door\",\"fire\"},{2,2,2,4,6},\"\"))\n</code></pre>\n\n<p>You can extend this by adding more descriptors with corresponding output values. Note that this does not need to be inputted as an array formula. Regards.</p>\n"}], "owner": {"reputation": 1, "user_id": 5574190, "user_type": "registered", "profile_image": "https://graph.facebook.com/1121518927859777/picture?type=large", "display_name": "Brian Mccaughan", "link": "https://stackoverflow.com/users/5574190/brian-mccaughan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1154, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1447809664, "creation_date": 1447801345, "last_edit_date": 1447809664, "question_id": 33768756, "link": "https://stackoverflow.com/questions/33768756/search-cell-for-multiple-strings-and-return-multiple-values", "title": "Search cell for multiple strings and return multiple values", "body": "<p>I'm creating a spreadsheet which will insert a value in certain cells based on the contents of other cells but have hit a brick wall with the problem below.</p>\n\n<p>Cell A1 will contain one of 16 possible strings.<br>\nBased on which string is in this cell I want to return a number in the range 1-6 in B1.<br>\ne.g. \"bedroom\", \"ensuite\" and \"lounge\" will return 2,\n     \"door\" will return 4,\n     \"fire\" will return 6.</p>\n\n<p>I also want to apply this to each cell in each column.</p>\n\n<p>Is this possible?</p>\n"}, {"tags": ["vba", "excel", "listbox", "listboxitem"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447799807, "post_id": 33768325, "comment_id": 55304548, "body": "<code>FoundCells</code> holds only one cell."}, {"owner": {"reputation": 47, "user_id": 4686429, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8912e3a335138f9636e1af30e30f94c8?s=128&d=identicon&r=PG&f=1", "display_name": "Techie2015", "link": "https://stackoverflow.com/users/4686429/techie2015"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447800019, "post_id": 33768325, "comment_id": 55304646, "body": "I&#39;ve verified that it holds more than one cell. If you plug in the code with multi-column sample code on a worksheet, you&#39;ll see that it will hold multiple cells."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447800219, "post_id": 33768325, "comment_id": 55304734, "body": "<code>For Each FoundCell In FoundCells</code> I meant the former."}, {"owner": {"reputation": 47, "user_id": 4686429, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8912e3a335138f9636e1af30e30f94c8?s=128&d=identicon&r=PG&f=1", "display_name": "Techie2015", "link": "https://stackoverflow.com/users/4686429/techie2015"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447800316, "post_id": 33768325, "comment_id": 55304774, "body": "How do you suggest that I solve my problem?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447800496, "post_id": 33768325, "comment_id": 55304856, "body": "Dump row by row with a loop instead of array? Others may suggest far better architecture."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447800850, "post_id": 33768325, "comment_id": 55304999, "body": "Populating a multi-column listbox:  <a href=\"http://gregmaxey.mvps.org/word_tip_pages/populate_userform_listbox_or_combobox.html\" rel=\"nofollow noreferrer\">gregmaxey.mvps.org/word_tip_pages/&hellip;</a>"}, {"owner": {"reputation": 47, "user_id": 4686429, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8912e3a335138f9636e1af30e30f94c8?s=128&d=identicon&r=PG&f=1", "display_name": "Techie2015", "link": "https://stackoverflow.com/users/4686429/techie2015"}, "edited": false, "score": 0, "creation_date": 1447801287, "post_id": 33768325, "comment_id": 55305174, "body": "Tim: I looked at the link that you provided, but I had trouble understanding how the author&#39;s suggestion will address my problem. Could you please provide a code snippet using the code that I posted to show how you would solve my problem?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447809465, "post_id": 33768325, "comment_id": 55307878, "body": "Sorry - I did some testing and you <i>should</i> be able to populate a multi-column listbox by assigning a 2D array to the <code>List</code> property (I didn&#39;t know that was a thing...)  I&#39;m not sure what you mean by &quot;it only shows the first column of each matching row&quot; - your code should display a single cell value and the address for that cell on each row of the listbox - you don&#39;t see that?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447809796, "post_id": 33768325, "comment_id": 55307966, "body": "Your code works for me as posted.  Did you set the <code>ColumnCount</code> property on the listbox?"}, {"owner": {"reputation": 47, "user_id": 4686429, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8912e3a335138f9636e1af30e30f94c8?s=128&d=identicon&r=PG&f=1", "display_name": "Techie2015", "link": "https://stackoverflow.com/users/4686429/techie2015"}, "edited": false, "score": 0, "creation_date": 1447864424, "post_id": 33768325, "comment_id": 55337648, "body": "Changing the &quot;ColumnCount&quot; property from one to two now displays the first cell of each matching row and the address of that row. Each row in the worksheet contains 12 columns of data. How would I modify the above code to show the remaining 11 columns in the listbox?"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 4686429, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8912e3a335138f9636e1af30e30f94c8?s=128&d=identicon&r=PG&f=1", "display_name": "Techie2015", "link": "https://stackoverflow.com/users/4686429/techie2015"}, "edited": false, "score": 0, "creation_date": 1447882747, "post_id": 33789106, "comment_id": 55348903, "body": "Tim: Sorry for the delay; I just recently saw your reply. I&#39;m testing it now."}, {"owner": {"reputation": 47, "user_id": 4686429, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8912e3a335138f9636e1af30e30f94c8?s=128&d=identicon&r=PG&f=1", "display_name": "Techie2015", "link": "https://stackoverflow.com/users/4686429/techie2015"}, "edited": false, "score": 0, "creation_date": 1447883006, "post_id": 33789106, "comment_id": 55349055, "body": "Tim: Your solution mostly works; one column is duplicated and I no longer need to include the address in the listbox. I posted another question requesting input on removing variant because it&#39;s a performance hog."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 47, "user_id": 4686429, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8912e3a335138f9636e1af30e30f94c8?s=128&d=identicon&r=PG&f=1", "display_name": "Techie2015", "link": "https://stackoverflow.com/users/4686429/techie2015"}, "edited": false, "score": 0, "creation_date": 1447883091, "post_id": 33789106, "comment_id": 55349100, "body": "It wasn&#39;t clear from your question whether all of the found items were expected to be in the same column: that&#39;s why I put both the found value and the full row content as distinct columns.  How many rows are you expecting to find?"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1447876315, "creation_date": 1447876315, "answer_id": 33789106, "question_id": 33768325, "link": "https://stackoverflow.com/questions/33768325/multiple-rows-showing-in-listbox-but-only-one-column-from-worksheet-is-displaye/33789106#33789106", "title": "Multiple rows showing in listbox, but only one column from worksheet is displayed in listbox", "body": "<p>Set your listbox column count to 14 and try this:</p>\n\n<pre><code>Private Sub FindAllMatches()\n'Find all matches on activesheet\n\n    Dim SearchRange As Range\n    Dim FindWhat As Variant\n    Dim FoundCells As Range\n    Dim FoundCell As Range\n    Dim arrResults() As Variant\n    Dim lFound As Long\n    Dim lSearchCol As Long\n    Dim lLastRow As Long\n    Dim rw As Range, c As Long  '&lt;&lt;&lt;&lt; added\n\n    'Do search if text in find box is longer than 1 character.\n    If Len(FSearchAssets.tbSrchSearchString.Value) &gt; 1 Then \n\n        Set SearchRange = ActiveSheet.UsedRange.Cells\n\n        FindWhat = FSearchAssets.tbSrchSearchString.Value\n        'Calls the FindAll function\n        Set FoundCells = FindAll(SearchRange:=SearchRange, _\n                                FindWhat:=FindWhat, _\n                                LookIn:=xlValues, _\n                                LookAt:=xlPart, _\n                                SearchOrder:=xlByColumns, _\n                                MatchCase:=False, _\n                                BeginsWith:=vbNullString, _\n                                EndsWith:=vbNullString, _\n                                BeginEndCompare:=vbTextCompare)\n        If FoundCells Is Nothing Then\n            ReDim arrResults(1 To 1, 1 To 2)\n            arrResults(1, 1) = \"No Results\"\n        Else\n            'Add results of FindAll to an array\n            ReDim arrResults(1 To FoundCells.Count, 1 To 14)\n            lFound = 1\n            For Each FoundCell In FoundCells\n\n                'add the matching value and address\n                arrResults(lFound, 1) = FoundCell.Value\n                arrResults(lFound, 2) = FoundCell.Address\n\n                Set rw = FoundCell.EntireRow 'get the full row for the found cell\n                'add the first 12 values from that row to the listbox\n                For c = 1 To 12\n                    arrResults(lFound, 2 + c) = rw.Cells(c).Value\n                Next c\n\n                lFound = lFound + 1\n            Next FoundCell\n        End If\n\n        'Populate the listbox with the array\n        Me.lbSrchMatchingResults.List = arrResults\n    Else\n        Me.lbSrchMatchingResults.Clear\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 4686429, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8912e3a335138f9636e1af30e30f94c8?s=128&d=identicon&r=PG&f=1", "display_name": "Techie2015", "link": "https://stackoverflow.com/users/4686429/techie2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1301, "favorite_count": 0, "accepted_answer_id": 33789106, "answer_count": 1, "score": 0, "last_activity_date": 1447884044, "creation_date": 1447799526, "last_edit_date": 1525816189, "question_id": 33768325, "link": "https://stackoverflow.com/questions/33768325/multiple-rows-showing-in-listbox-but-only-one-column-from-worksheet-is-displaye", "title": "Multiple rows showing in listbox, but only one column from worksheet is displayed in listbox", "body": "<p>I have a userform that searches through information on a worksheet. It's supposed to display the rows matching the search criteria inside of a listbox named \"lbSrchMatchingResults\"; unfortunately, it only displays the first column of each matching row. My solution builds on code provided by CPearson (<a href=\"http://www.cpearson.com/excel/findall.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/findall.aspx</a>) and Jon Acampora (<a href=\"http://www.excelcampus.com/tools/find-all-vba-form-for-excel/\" rel=\"nofollow noreferrer\">http://www.excelcampus.com/tools/find-all-vba-form-for-excel/</a>). The subroutine responsible for populating the listbox is listed below:</p>\n\n<pre><code>Private Sub FindAllMatches()\n'Find all matches on activesheet\n\nDim SearchRange As Range\nDim FindWhat As Variant\nDim FoundCells As Range\nDim FoundCell As Range\nDim arrResults() As Variant\nDim lFound As Long\nDim lSearchCol As Long\nDim lLastRow As Long\nDim rw As Range, c As Long  '&lt;&lt;&lt;&lt; added\n\n'Do search if text in find box is longer than 1 character.\nIf Len(FSearchAssets.tbSrchSearchString.Value) &gt; 1 Then\n\n    Set SearchRange = ActiveSheet.UsedRange.Cells\n\n    FindWhat = FSearchAssets.tbSrchSearchString.Value\n    'Calls the FindAll function\n    Set FoundCells = FindAll(SearchRange:=SearchRange, _\n                            FindWhat:=FindWhat, _\n                            LookIn:=xlValues, _\n                            LookAt:=xlPart, _\n                            SearchOrder:=xlByColumns, _\n                            MatchCase:=False, _\n                            BeginsWith:=vbNullString, _\n                            EndsWith:=vbNullString, _\n                            BeginEndCompare:=vbTextCompare)\n    If FoundCells Is Nothing Then\n        ReDim arrResults(1 To 1, 1 To 2)\n        arrResults(1, 1) = \"No Results\"\n    Else\n        'Add results of FindAll to an array\n        ReDim arrResults(1 To FoundCells.Count, 1 To 14)\n        lFound = 1\n        For Each FoundCell In FoundCells\n\n            'add the matching value and address\n            'arrResults(lFound, 1) = FoundCell.Value\n            'arrResults(lFound, 2) = FoundCell.Address\n\n            Set rw = FoundCell.EntireRow 'get the full row for the found cell\n            'add the first 13 values from that row to the listbox\n            For c = 1 To 13\n                'arrResults(lFound, 2 + c) = rw.Cells(c).Value\n                arrResults(lFound, c) = rw.Cells(c).Value\n            Next c\n\n            lFound = lFound + 1\n        Next FoundCell\n    End If\n\n    'Populate the listbox with the array\n    Me.lbSrchMatchingResults.List = arrResults\nElse\n    Me.lbSrchMatchingResults.Clear\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1447800884, "post_id": 33768285, "comment_id": 55305010, "body": "Try to emulate row_number in access then you can do the look up for each category. <a href=\"http://stackoverflow.com/questions/21917637/achieving-row-number-partition-by-in-ms-access\" title=\"achieving row number partition by in ms access\">stackoverflow.com/questions/21917637/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 5574165, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iw-pb0fRMkc/AAAAAAAAAAI/AAAAAAAAAEo/ZkPnAKnlXKQ/photo.jpg?sz=128", "display_name": "Ed Blackburn", "link": "https://stackoverflow.com/users/5574165/ed-blackburn"}, "edited": false, "score": 0, "creation_date": 1447949575, "post_id": 33786588, "comment_id": 55383231, "body": "Thank you for your suggestion/example.  I used this and kept getting the whole table back and not the TopN records per group.  Tried several modifications to different sections of the statements with varying results.  I think instead I will use VBA to create a union query stepping through each segment (there are about 20)."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 9, "user_id": 5574165, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iw-pb0fRMkc/AAAAAAAAAAI/AAAAAAAAAEo/ZkPnAKnlXKQ/photo.jpg?sz=128", "display_name": "Ed Blackburn", "link": "https://stackoverflow.com/users/5574165/ed-blackburn"}, "edited": false, "score": 0, "creation_date": 1447950824, "post_id": 33786588, "comment_id": 55384173, "body": "That&#39;s a shame.  My method uses the row numbering that @Juan Carlos Oropeza mentioned in his comment and selects the records that have a row number less than or equal to the desired amount.  It&#39;s well worth looking into."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1447867924, "creation_date": 1447867924, "answer_id": 33786588, "question_id": 33768285, "link": "https://stackoverflow.com/questions/33768285/access-top-n-query-where-n-changes-by-group/33786588#33786588", "title": "Access Top N Query where N changes by group", "body": "<p>I had a similar problem a couple of months ago.</p>\n\n<p>Working with your query, something like this should work:</p>\n\n<pre><code>SELECT      T1.GDate, \n            T1.[Game Type], \n            T1.Denom, \n            T1.Segment, \n            T1.Manufacturer_Description, \n            T1.Stand, \n            T1.Payout\nFROM        Payout T1 INNER JOIN Payout T2 ON\n                T1.[Game Type] = T2.[Game Type] AND\n                T1.Denom = T2.Denom AND\n                T1.Segment = T2.Segment AND\n                T1.Manufacturer_Description = T2.Manufacturer_Description AND\n                T1.Stand = T2.Stand AND\n                T1.Payout = T2.Payout AND\n                T1.GDate &gt;= T2.GDate\nGROUP BY    T1.GDate, \n            T1.[Game Type], \n            T1.Denom, \n            T1.Segment, \n            T1.Manufacturer_Description, \n            T1.Stand, \n            T1.Payout\nHAVING      COUNT(*) &lt;= (\n                         SELECT TopN\n                         FROM   MyOtherTable\n                         WHERE  MyOtherTable.IDField = T1.IDField\n                        )\nORDER BY    T1.GDate\n</code></pre>\n\n<p>Note - the join can probably be reduced to the PK in the Payout table.</p>\n\n<p>For more info check this site:  <a href=\"http://www.sql-ex.com/help/select16.php\" rel=\"nofollow\">http://www.sql-ex.com/help/select16.php</a></p>\n"}], "owner": {"reputation": 9, "user_id": 5574165, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iw-pb0fRMkc/AAAAAAAAAAI/AAAAAAAAAEo/ZkPnAKnlXKQ/photo.jpg?sz=128", "display_name": "Ed Blackburn", "link": "https://stackoverflow.com/users/5574165/ed-blackburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 367, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447867924, "creation_date": 1447799367, "last_edit_date": 1447803373, "question_id": 33768285, "link": "https://stackoverflow.com/questions/33768285/access-top-n-query-where-n-changes-by-group", "title": "Access Top N Query where N changes by group", "body": "<p>I am trying to write a top n value query in Microsoft Access where n may change by group.  For example, one group may be top 3 records, another may be top 2 records, and another may be top 4 records.  I have a table with the field \"TopN\" where I store how many values to show for that group.</p>\n\n<p>Sample of Top 3 query that works, I am trying to replace Top 3 with Top N where N is a DLookup or something that uses the value in TopN field:</p>\n\n<pre><code>SELECT Payout.GDate, Payout.[Game Type], Payout.Denom, Payout.Segment, Payout.Manufacturer_Description, Payout.Stand, Payout.Payout\n  FROM Payout, PayoutShowSegment\n  WHERE (((Payout.Payout) IN (SELECT TOP 3 [Payout] \n                                FROM [Payout] \n                                WHERE [Payout].[Segment]=[PayoutShowSegment].[Segment])))\n  ORDER BY Payout.[Game Type], Payout.Denom, Payout.Payout DESC;\n</code></pre>\n"}, {"tags": ["excel", "vba", "conditional-formatting"], "comments": [{"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1447799910, "post_id": 33768224, "comment_id": 55304589, "body": "Can you post all the code regarding the formatting? It seems you have missed an &#39;End With&#39;. It would be better to see more of the relevant code."}, {"owner": {"reputation": 3, "user_id": 5574144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2630f694581dc34997bf70373ec081c6?s=128&d=identicon&r=PG&f=1", "display_name": "rchllmbrt", "link": "https://stackoverflow.com/users/5574144/rchllmbrt"}, "reply_to_user": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1448044887, "post_id": 33768224, "comment_id": 55432771, "body": "@MacroMarc, see updated original post. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1447801950, "post_id": 33768743, "comment_id": 55305448, "body": "Bracket missing at the end of your list. Would this not be an array formula though? Can conditional formatting deal with it if it is?"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1447802018, "post_id": 33768743, "comment_id": 55305474, "body": "Nevermind about the array formula. Tested it on a regular cell and worked perfectly without array formula. Cheers."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1447860179, "post_id": 33768743, "comment_id": 55334412, "body": "Thanks for catching the missing closing bracket, it has been added.  Glad to hear it is working for you"}, {"owner": {"reputation": 3, "user_id": 5574144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2630f694581dc34997bf70373ec081c6?s=128&d=identicon&r=PG&f=1", "display_name": "rchllmbrt", "link": "https://stackoverflow.com/users/5574144/rchllmbrt"}, "edited": false, "score": 0, "creation_date": 1448044918, "post_id": 33768743, "comment_id": 55432791, "body": "@tigeravatar When I change the line to that, I get the following message: &quot;Run-time error &#39;5&#39;: Invalid procedure call or argument. The option to debug highlights the lines &#39; Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _ &quot;=OR($C1={2025211493,2063919340,2096568626,2184943359,253520&zwnj;&#8203;3630, ... etc."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1447860154, "last_edit_date": 1447860154, "creation_date": 1447801289, "answer_id": 33768743, "question_id": 33768224, "link": "https://stackoverflow.com/questions/33768224/macro-to-conditionally-format-rows-based-on-cell-contents/33768743#33768743", "title": "Macro to Conditionally Format rows based on cell contents", "body": "<p>Try changing your FormatConditions Formula1 line to be $C1 instead of $C2, since you're applying this to Cells.  Otherwise it is looking at one row down instead of the same row:</p>\n\n<pre><code>\"=OR($C1={2025211493,2063919340,2096568626,2184943359,2535203630,2533306498,4055763188,4057014173,4235861076,5019450123,5036781060,5036071088,5094532476,5138697827,5175070612,5409662174,5592714006,5613334173,5626224977,6152069720,6194611018,6206408997,7086919068,7028252742,7173546777,7609497400,7634446852,7702050218,8002263696,8017841482, 8015756500,8063641273,8179243829,8436654968,8476561100,8608150728,8602171111,8669710959,8883420784,9197901354,9199349948,9519245300,9703020157})\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284, "user_id": 3286675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/CUYQa.png?s=128&g=1", "display_name": "helena4", "link": "https://stackoverflow.com/users/3286675/helena4"}, "is_accepted": false, "score": 0, "last_activity_date": 1447841261, "last_edit_date": 1447841261, "creation_date": 1447839736, "answer_id": 33776478, "question_id": 33768224, "link": "https://stackoverflow.com/questions/33768224/macro-to-conditionally-format-rows-based-on-cell-contents/33776478#33776478", "title": "Macro to Conditionally Format rows based on cell contents", "body": "<p>Or you could use 1 column to store ALL your numbers - color each group for easy spotting.</p>\n\n<p>Put the NO call numbers on top.</p>\n\n<p>1 cell =xxxx or whatever unique text to act as visible separator.</p>\n\n<p>and below them and all the numbers you want to check to call or not.</p>\n\n<p>Select Your Column > DATA TAB > Remove duplicates</p>\n\n<p>The original no call numbers stay on top as they are identified and the rest is compared against them and removed.</p>\n\n<p>Then you can select the column F5 and select and delete all empty rows should you need to consolidate. And again your No Calls remain on top, whatever remains below the separator cell is a clear to call.</p>\n\n<p>In case you want to ease navigation in such a column view freeze about 10 of top rows and use them for nav links only:</p>\n\n<p>Such as\n<strong>=HYPERLINK(CONCATENATE(\"#\",CELL(\"Address\",$A$11)),\"TO TOP\")</strong></p>\n\n<p><strong>=HYPERLINK(CONCATENATE(\"#\",CELL(\"Address\",INDEX($A$1:$B$1000,MATCH(\"xxxx\",$A$1:$B$1000,0)+0))),\"TO SEPARATOR\")</strong></p>\n\n<p>where xxxx is the separator your are looking for - this thing simply finds where the separator address is should it move and it will move should change the list. Change the +0 if you want to be offset to +- location.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5574144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2630f694581dc34997bf70373ec081c6?s=128&d=identicon&r=PG&f=1", "display_name": "rchllmbrt", "link": "https://stackoverflow.com/users/5574144/rchllmbrt"}, "edited": false, "score": 0, "creation_date": 1448318918, "post_id": 33834896, "comment_id": 55528892, "body": "This is perfect! Thank you for your help, @macromarc. The first few lines were just to delete extra columns... the bit about formatting cells on certain conditions was the part that wasn&#39;t working. It is now, thanks to you!"}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "reply_to_user": {"reputation": 3, "user_id": 5574144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2630f694581dc34997bf70373ec081c6?s=128&d=identicon&r=PG&f=1", "display_name": "rchllmbrt", "link": "https://stackoverflow.com/users/5574144/rchllmbrt"}, "edited": false, "score": 0, "creation_date": 1448349662, "post_id": 33834896, "comment_id": 55538833, "body": "No problem! Glad it helped"}], "tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": true, "score": 0, "last_activity_date": 1448048778, "creation_date": 1448048778, "answer_id": 33834896, "question_id": 33768224, "link": "https://stackoverflow.com/questions/33768224/macro-to-conditionally-format-rows-based-on-cell-contents/33834896#33834896", "title": "Macro to Conditionally Format rows based on cell contents", "body": "<p>Slightly confused. I don't see how the code above code actually causes several rows to be formatted in any way at all.\nAnyway, here is my suggestion:</p>\n\n<pre><code>Dim r As Range\nSet r = Range(\"A2:G6\") 'figure out how to set this to your appropriate range\n         'It should be a range starting at the first cell in the data range, and end in the last cell\n\nr.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR($C2= 2025211493, $C2=2063919340, $C2=2096568626, $C2=2184943359, $C2=2535203630, $C2=2533306498, $C2=4055763188, $C2=4057014173, $C2=4235861076, $C2=5019450123, $C2=5036781060, $C2=5036071088, $C2=5094532476, $C2=5138697827, $C2=5175070612, $C2=5409662174, $C2=5592714006, $C2=5613334173, $C2=5626224977, $C2=6152069720, $C2=6194611018, $C2=6206408997, $C2=7086919068, $C2=7028252742, $C2=7173546777, $C2=7609497400, $C2=7634446852, $C2=7702050218, $C2=8002263696, $C2=8017841482,  $C2=8015756500, $C2=8063641273, $C2=8179243829, $C2=8436654968, $C2=8476561100, $C2=8608150728, $C2=8602171111, $C2=8669710959, $C2=8883420784, $C2=9197901354, $C2=9199349948, $C2=9519245300, $C2=9703020157)\"\nr.FormatConditions(r.FormatConditions.Count).SetFirstPriority\nWith r.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent2\n    .TintAndShade = 0.399945066682943\nEnd With\nr.FormatConditions(1).StopIfTrue = False\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5574144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2630f694581dc34997bf70373ec081c6?s=128&d=identicon&r=PG&f=1", "display_name": "rchllmbrt", "link": "https://stackoverflow.com/users/5574144/rchllmbrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 0, "accepted_answer_id": 33834896, "answer_count": 3, "score": 0, "last_activity_date": 1448048778, "creation_date": 1447799088, "last_edit_date": 1447943199, "question_id": 33768224, "link": "https://stackoverflow.com/questions/33768224/macro-to-conditionally-format-rows-based-on-cell-contents", "title": "Macro to Conditionally Format rows based on cell contents", "body": "<p>I have a file that I export every morning. I've written a macro to delete unnecessary columns, and to remove hyphens from the phone numbers that are exported in the file. My last step is to highlight rows in which the phone number matches one of those in my list of Do Not Call numbers. </p>\n\n<p>The bottom section SHOULD highlight rows in the sheet where C(n) equals any of the following values (phone numbers...)</p>\n\n<pre><code>Sub Annihilation()\n'\n' Annihilation Macro\n' Highlight bad numbers, formats worksheet.\n'\n\n'\nRange(\"B:B,D:D,E:E,G:G\").Select\nRange(\"G1\").Activate\nSelection.Delete Shift:=xlToLeft\nRange(\"C2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Replace What:=\"-\", Replacement:=\"\", LookAt:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nColumns(\"C:C\").EntireColumn.AutoFit\nRange(\"C2\").Select\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=OR($C2= 2025211493, $C2=2063919340, $C2=2096568626, $C2=2184943359, $C2=2535203630, $C2=2533306498, $C2=4055763188, $C2=4057014173, $C2=4235861076, $C2=5019450123, $C2=5036781060, $C2=5036071088, $C2=5094532476, $C2=5138697827, $C2=5175070612, $C2=5409662174, $C2=5592714006, $C2=5613334173, $C2=5626224977, $C2=6152069720, $C2=6194611018, $C2=6206408997, $C2=7086919068, $C2=7028252742, $C2=7173546777, $C2=7609497400, $C2=7634446852, $C2=7702050218, $C2=8002263696, $C2=8017841482,  $C2=8015756500, $C2=8063641273, $C2=8179243829, $C2=8436654968, $C2=8476561100, $C2=8608150728, $C2=8602171111, $C2=8669710959, $C2=8883420784, $C2=9197901354, $C2=9199349948, $C2=9519245300, $C2=9703020157)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent2\n    .TintAndShade = 0.399945066682943\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n</code></pre>\n\n<p>End Sub\nWhen I run this, rows are highlighted in the color specified, but the rows selected aren't the ones that contain any of these numbers. </p>\n\n<p>Any help at all on this? Is the code incorrect? </p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1447828362, "creation_date": 1447828362, "answer_id": 33773257, "question_id": 33768033, "link": "https://stackoverflow.com/questions/33768033/vba-for-word-2010-bring-selected-shape-into-view/33773257#33773257", "title": "VBA for Word 2010 - Bring selected shape into view", "body": "<p>Try: myDots.ScrollIntoView</p>\n\n<p>BTW your code has a logic problem. It's good that you're trying to loop all the StoryRanges. But at the next level you query ActiveDocument.Shapes which means - I think, can't test as I'm on a mobile machine at the moment - you won't query the Shapes in the StoryRange you've looped to. Try using myRange.ShapeRange</p>\n"}], "owner": {"reputation": 13, "user_id": 5199831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b26331b6cb2183922e4a1f2df6865e99?s=128&d=identicon&r=PG&f=1", "display_name": "Schnerkin", "link": "https://stackoverflow.com/users/5199831/schnerkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447828362, "creation_date": 1447798298, "question_id": 33768033, "link": "https://stackoverflow.com/questions/33768033/vba-for-word-2010-bring-selected-shape-into-view", "title": "VBA for Word 2010 - Bring selected shape into view", "body": "<p>I have the following VBA code for use in MS Word 2010.  It is supposed to step through a document, find a shape, and give me the option to delete it.  The problem I'm having is that the selected shape doesn't show in the viewer window, so when the code asks if I want to delete a shape that it has found, I can't see that shape.  </p>\n\n<pre><code>Sub ShowShapes()\nDim myRange As Range\nDim msgTrap As VbMsgBoxResult\nDim sPrompt As String\nDim myDots As Shape\nFor Each myRange In ActiveDocument.StoryRanges\n    Do\n        For Each myDots In ActiveDocument.Shapes\n                myDots.Select\n                sPrompt = \"Do you want to delete this?\"\n                msgTrap = MsgBox(sPrompt, vbYesNoCancel, \"Images\")\n                Select Case msgTrap\n                    Case vbYes\n                        Selection.Delete\n                    Case vbCancel\n                        MsgBox \"Cancel was clicked.  Exiting Routine\", vbCritical, \"CANCEL\"\n                        Exit Sub\n                    'Note that Case vbNo is not listed.  That is because as the only other option\n                    'the routine will proceed to End Select when vbNo is clicked.\n                    End Select\n        Next\n        Set myRange = myRange.NextStoryRange\n  Loop Until myRange Is Nothing\nNext\nEnd Sub\n</code></pre>\n\n<p>I have tried using Application.ScreenUpdating = True to no effect.  I'm hoping that there is a simple command that I don't know, but I haven't been able to find an answer here or elsewhere online.  TIA.</p>\n"}, {"tags": ["vba", "ms-word", "word-2010"], "answers": [{"tags": [], "owner": {"reputation": 134, "user_id": 3286402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e02bb2c3902a05ceaefb099523f564?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan.s", "link": "https://stackoverflow.com/users/3286402/ivan-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1447925426, "creation_date": 1447925426, "answer_id": 33799891, "question_id": 33767473, "link": "https://stackoverflow.com/questions/33767473/word-2010-macro-to-replace-underlined-text-with-auto-incremented-text/33799891#33799891", "title": "word 2010 macro to replace underlined text with auto-incremented text", "body": "<p>You are missing nothing. \nI think where was errors in method execute!\nTo correct infinite cycling  one of method is to change font.underline=false when replace:</p>\n\n<pre><code>    Do While .Execute( _\n    Replace:=wdReplaceOne, _\n    ReplaceWith:=\"(\" &amp; gapcount &amp; \")\", _\n    Forward:=True)\n.Replacement.Font.Underline = False\n    gapcount = gapcount + 1\n\nLoop\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5573978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S57Ac.png?s=128&g=1", "display_name": "krzwierz79", "link": "https://stackoverflow.com/users/5573978/krzwierz79"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447925426, "creation_date": 1447796193, "question_id": 33767473, "link": "https://stackoverflow.com/questions/33767473/word-2010-macro-to-replace-underlined-text-with-auto-incremented-text", "title": "word 2010 macro to replace underlined text with auto-incremented text", "body": "<p>I'm trying to replace all instances of underlined text in a document with numbered gaps. For some reason the below gives me overflow error:</p>\n\n<pre><code>Sub gapNumber()\nDim myNumber As Integer\ngapCount = 1\n\nWith ActiveDocument.Content.find\n    .ClearFormatting\n    .Font.Underline = True\n    Do While .Execute( _\n        replace:=wdReplaceOne, _\n        ReplaceWith:=\"(\" &amp; gapCount &amp; \")\", _\n        Forward:=True) = True\n\n        gapCount = gapCount + 1\n\n    Loop\nEnd With\nEnd Sub\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1447795695, "post_id": 33767306, "comment_id": 55302424, "body": "When deleting rows, always loop backwards, so your for loop is <code>For iCounter2 =  lastrow to 2 step -1</code>.  as you are deleting rows rows that have not been evaluated are replacing the one deleted.  This row is being skipped."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1447795899, "post_id": 33767306, "comment_id": 55302542, "body": "Just a quick note, I&#39;d add the worksheet in on this line too: <code>If Not IsNumeric(Cells(iCounter2, 9)) Then</code> ...so, it&#39;d be <code>If Not IsNumeric(wsO.Cells(iCounter2, 9)) Then ...</code>  and also at the end, specify which worksheet you want to use with <code>Rows(&quot;2:200&quot;).RowHeight = 30</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447795900, "post_id": 33767306, "comment_id": 55302545, "body": "<a href=\"http://stackoverflow.com/questions/33744149/code-in-vba-loops-and-never-ends-how-to-fix-this\">Here</a> are some great answers as to how to do what you want.  There are three different approaches."}, {"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447796765, "post_id": 33767306, "comment_id": 55303003, "body": "thanks @ScottCraner, code works now cheers!"}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1447860373, "post_id": 33767306, "comment_id": 55334575, "body": "forgot to reference sheet here  <code>If Not IsNumeric(Cells(iCounter2, 9))</code> ,"}], "answers": [{"comments": [{"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 1, "creation_date": 1447835526, "post_id": 33774375, "comment_id": 55316742, "body": "Never knew vba detects automatically, that it needs to count backwards, if the starting value is smaller than the end value!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1447835915, "post_id": 33774375, "comment_id": 55316966, "body": "@MarcoGetrost - Thanks for catching that! I&#39;ve either got to pay better attention or actually run through the code I write."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1447835856, "last_edit_date": 1495541036, "creation_date": 1447832892, "answer_id": 33774375, "question_id": 33767306, "link": "https://stackoverflow.com/questions/33767306/code-not-deleting-every-non-numeric-row/33774375#33774375", "title": "Code not deleting every non numeric row", "body": "<p>There seem to be two problems with your code. The primary issue of skipping some rows that should be deleted can be cleared up by looping from the bottom to the top. Failing to work in ths manner may mean that a row is skipped after a row is deleted, the rows are renumbered and you increment on to the next row.</p>\n\n<p>There is a secondary issue where you have implemented a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a> that references the worksheet to be acted upon and then either reiterate the worksheet reference when referencing cells/ranges/rows or discard it altogether.</p>\n\n<pre><code>With wsO\n    For iCounter1 = 2 To LastRow\n        If .Cells(iCounter1, 9) &gt; 120 Then\n            .Cells(iCounter1, 9).Interior.Color = RGB(255, 101, 101)\n        ElseIf .Cells(iCounter1, 9) &gt; 0 And .Cells(iCounter1, 9) &lt; 120 Then\n            .Cells(iCounter1, 9).Interior.Color = RGB(169, 208, 142)\n        End If\n    Next iCounter1\n\n    'this is the primary change\n    'loop from the bottom to the top when deleting rows\n    For iCounter2 = LastRow To 2 Step -1\n        If Not IsNumeric(.Cells(iCounter2, 9)) Then\n            .Cells(iCounter2, 9).EntireRow.Delete\n        End If\n    Next iCounter2\n\n    .Rows(\"2:200\").RowHeight = 30\nEnd With\n</code></pre>\n\n<p>Note that <code>Cells</code> becomes <code>.Cells</code> and <code>Rows</code> become <code>.Rows</code>. The period (aka <code>.</code> or <em>full stop</em>`) prefix associates each cell/range/row with the parent worksheet referenced in the With ... End With block.</p>\n\n<hr>\n\n<p>\u00b9 <sub>Thanks to <a href=\"https://stackoverflow.com/users/4851590/scott-craner\">Scott Craner</a> for noting the bottom-to-top method in comments.</sub></p>\n"}], "owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 33774375, "answer_count": 1, "score": 2, "last_activity_date": 1447835856, "creation_date": 1447795585, "last_edit_date": 1531161705, "question_id": 33767306, "link": "https://stackoverflow.com/questions/33767306/code-not-deleting-every-non-numeric-row", "title": "Code not deleting every non numeric row", "body": "<p>I have this code here which looks through a column of numbers, colors the cells with numbers and deletes the cells and its corresponding rows if it's a nonnumeric entry(the cells are filled with \"-\"). It deletes some of the non numeric rows but not all of them.</p>\n\n<pre><code>Dim wbI As Workbook, wbO As Workbook\n    Dim wsI As Worksheet, wsO As Worksheet\n    Dim iCounter As Long\n    Dim iCounter1 As Long\n    Dim iCounter2 As Long\n    Dim lrow As Long, rw As Long\n    Dim OutLookApp As Object\n    Dim OutLookMailItem As Object\n    Dim MailDest As String\n    Dim subj As String\n    Dim bod As String\n    Dim lastrow As Long\n    Dim lastrow1 As Long\n\n lastrow = wsI.Cells(Rows.Count, 4).End(xlUp).Row\nlastrow1 = wsO.Cells(Rows.Count, 4).End(xlUp).Row\n\n With wsO\n        For iCounter1 = 2 To lastrow\n        If wsO.Cells(iCounter1, 9) &gt; 120 Then\n\n        wsO.Cells(iCounter1, 9).Interior.Color = RGB(255, 101, 101)\n\n        ElseIf wsO.Cells(iCounter1, 9) &gt; 0 And wsO.Cells(iCounter1, 9) &lt; 120 Then\n\n        wsO.Cells(iCounter1, 9).Interior.Color = RGB(169, 208, 142)\n\n        End If\n        Next iCounter1\n\n        With wsO\n        For iCounter2 = 2 To lastrow\n\n         If Not IsNumeric(Cells(iCounter2, 9)) Then\n         wsO.Cells(iCounter2, 9).EntireRow.Delete\n         End If\n\n        Next iCounter2\n\n\n        Rows(\"2:200\").RowHeight = 30\n        End With\n        End With\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "dcount"], "answers": [{"tags": [], "owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "is_accepted": false, "score": 0, "last_activity_date": 1447834776, "last_edit_date": 1447834776, "creation_date": 1447832991, "answer_id": 33774396, "question_id": 33766929, "link": "https://stackoverflow.com/questions/33766929/dcount-returning-wrong-record-count-when-filtering-by-dates/33774396#33774396", "title": "DCount returning wrong record count when filtering by dates", "body": "<p>have you tried the following:</p>\n\n<pre><code>DCount(\"[ID]\", \"[ComplaintsListMaster]\", \"[ComplaintDate] &gt;= #\" &amp; 11/1/2015 &amp; \"#\")\n</code></pre>\n\n<p>dates are enclosed within the <code>#date#</code> number signs, in a similar way to how strings are enclosed in single quotes/apostrophe symbols <code>'string'</code>.</p>\n\n<p>Im not sure why you need both equal or greater than symbol <code>=&gt;11/1/2015</code> though. I would personally use <code>&gt;10/1/2015</code>.</p>\n\n<pre><code>DCount(\"[ID]\", \"[ComplaintsListMaster]\", \"[ComplaintDate] &gt; #\" &amp; 10/1/2015 &amp; \"#\")\n</code></pre>\n\n<p>But both should work, so just personal preference I guess. </p>\n\n<blockquote>\n  <p>EDIT</p>\n</blockquote>\n\n<p>I have just realised that I assumed dd/mm/yyyy and there was a possibility you are using mm/dd/yyyy so in that case, my answer would be <code>&gt;10/31/2015</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1447835406, "creation_date": 1447835406, "answer_id": 33775037, "question_id": 33766929, "link": "https://stackoverflow.com/questions/33766929/dcount-returning-wrong-record-count-when-filtering-by-dates/33775037#33775037", "title": "DCount returning wrong record count when filtering by dates", "body": "<p>Enclose date in <code>#</code>, and always write your dates the US way (mm/dd/yyyy) in VBA:</p>\n\n<pre><code>DCount(\"[ID]\", \"[ComplaintsListMaster]\", \"[ComplaintDate] &gt;= #11/1/2015#\")\n</code></pre>\n\n<p>Means >= Nov-1.<br>\nThe SQL Server backend has no impact in this case.</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1447847434, "creation_date": 1447847434, "answer_id": 33779311, "question_id": 33766929, "link": "https://stackoverflow.com/questions/33766929/dcount-returning-wrong-record-count-when-filtering-by-dates/33779311#33779311", "title": "DCount returning wrong record count when filtering by dates", "body": "<p>You probably don't have the date hardcoded, so follow this general guide. </p>\n\n<p>Also, <code>DCount</code> needs no field to look up:</p>\n\n<pre><code>Dim FilterDate    As Date\nDim FilterDateSql As String\n\nFilterDate = DateSerial(Year(Date), Month(Date), 1)\nFilterDateSql = Format(FilterDate, \"yyyy\\/mm\\/dd\")\nDCount(\"*\", \"[ComplaintsListMaster]\", \"[ComplaintDate] &gt;= #\" &amp; FilterDateSql &amp; \"#\")\n</code></pre>\n"}], "owner": {"reputation": 428, "user_id": 5520934, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e37c2789254e801492b819df6f8addcd?s=128&d=identicon&r=PG&f=1", "display_name": "SQLSuperHero", "link": "https://stackoverflow.com/users/5520934/sqlsuperhero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 359, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1447847434, "creation_date": 1447794096, "last_edit_date": 1447798254, "question_id": 33766929, "link": "https://stackoverflow.com/questions/33766929/dcount-returning-wrong-record-count-when-filtering-by-dates", "title": "DCount returning wrong record count when filtering by dates", "body": "<p>Trying to get a count of all records from a table called \"ComplaintsListMaster\" that have a \"ComplaintDate\" greater than 11/1/2015. The correct value is around 70. But when I use the dcount pasted below, it returns 3951 which is almost every record in the table.</p>\n\n<p><code>DCount(\"[ID]\", \"[ComplaintsListMaster]\", \"[ComplaintDate] &gt;= 11/1/2015\")</code></p>\n\n<p>Any obvious mistakes?</p>\n\n<p>We use an MS Access front end for a SQL Server backend</p>\n"}, {"tags": ["arrays", "vba", "dictionary"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447794351, "post_id": 33766410, "comment_id": 55301712, "body": "You cannot assign an array to a dictionary like that - you will need to loop over the array and add the items one by one."}, {"owner": {"reputation": 369, "user_id": 4011878, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1d78babefd9a85be90d609807f361d7?s=128&d=identicon&r=PG&f=1", "display_name": "Shan", "link": "https://stackoverflow.com/users/4011878/shan"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447833131, "post_id": 33766410, "comment_id": 55315533, "body": "yes i can. I can loop thorugh dic_cc and i see all elements of that array. i have only problem in this line If dic_cc.Exists(f) Then Me.FilterList.AddItem f"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1447865763, "post_id": 33766410, "comment_id": 55338616, "body": "No you can&#39;t.  Try declaring dic_cc <code>As Object</code> and see what happens.  What you&#39;re doing in your current code is assigning the variable <code>dic_cc</code> to the array <code>flArr</code> - at that point it ceases to be a Dictionary object and becomes an array. That only works if you declare dic_cc as Variant (or at least not as <code>Object</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1447797051, "post_id": 33767356, "comment_id": 55303178, "body": "Declare <code>Dim ar(1 To 3) As Integer</code> and then add some items to it. Then <code>For Each it In ar</code> is valid and can be used."}], "tags": [], "owner": {"reputation": 788, "user_id": 997088, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/354c6358174c3e539ca9fe427d25391c?s=128&d=identicon&r=PG", "display_name": "GisMofx", "link": "https://stackoverflow.com/users/997088/gismofx"}, "is_accepted": false, "score": 0, "last_activity_date": 1447795763, "creation_date": 1447795763, "answer_id": 33767356, "question_id": 33766410, "link": "https://stackoverflow.com/questions/33766410/vba-dictionary-if-exists/33767356#33767356", "title": "VBA Dictionary if exists?", "body": "<p>I don't think an array in VBA is enumerable. You need loop though each element in the array and check against the dictionary like so:</p>\n\n<pre><code>dim i as long\n\nFor i= 0 to to ubound(myArray)\n If dic_cc.Exists(myArray[i]) then\n  me.FilterList.AddItem myArray[i]\n endif\n\nnext i\n</code></pre>\n"}], "owner": {"reputation": 369, "user_id": 4011878, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1d78babefd9a85be90d609807f361d7?s=128&d=identicon&r=PG&f=1", "display_name": "Shan", "link": "https://stackoverflow.com/users/4011878/shan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447795763, "creation_date": 1447792284, "question_id": 33766410, "link": "https://stackoverflow.com/questions/33766410/vba-dictionary-if-exists", "title": "VBA Dictionary if exists?", "body": "<p>I have an array called flArr and i am transferring it to a dictionary and testing elements from an another array if exists then i am adding it to a list box but i don't know, somehow it is not working giving me \"object required\" error. Any idea?.</p>\n\n<pre><code>Set dic_cc = CreateObject(\"scripting.dictionary\")\ndic_cc = flArr 'transferring array to dictionary \n\n    For Each f In heArr 'another array heArr        \n        If dic_cc.Exists(f) Then Me.FilterList.AddItem f    \n    Next\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "vba", "email", "outlook", "winmail.dat"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1449509671, "post_id": 33766323, "comment_id": 56027304, "body": "This describes a non-programming solution <a href=\"https://support.microsoft.com/en-ca/kb/958012\" rel=\"nofollow noreferrer\">support.microsoft.com/en-ca/kb/958012</a>"}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1449524997, "creation_date": 1449524997, "answer_id": 34143900, "question_id": 33766323, "link": "https://stackoverflow.com/questions/33766323/prevent-outlook-from-sending-winmail-dat-tnef-with-vba-or-c/34143900#34143900", "title": "Prevent Outlook from sending winmail.dat (TNEF) with VBA or C#", "body": "<p>Set the special named property UseTnef (DASL name <code>http://schemas.microsoft.com/mapi/id/{00062008-0000-0000-C000-000000000046}/8582000B</code>) to false using <code>MailItem.PropertyAccessor.SetProperty</code>.</p>\n"}], "owner": {"reputation": 25, "user_id": 5530910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bbaa192fb900e8d1106844972a96a82?s=128&d=identicon&r=PG&f=1", "display_name": "Dmytro", "link": "https://stackoverflow.com/users/5530910/dmytro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 521, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1479089046, "creation_date": 1447791944, "last_edit_date": 1479089046, "question_id": 33766323, "link": "https://stackoverflow.com/questions/33766323/prevent-outlook-from-sending-winmail-dat-tnef-with-vba-or-c", "title": "Prevent Outlook from sending winmail.dat (TNEF) with VBA or C#", "body": "<p>I am creating messages from MS Word mail merge instrument using Adobe PDFMaker Office COM Addin. I receive a list of messages with pdf-attachments in my Outbox in MS Outlook. But besides the necessary .pdf-attachment all the emails are being sent  with \"trash\" winmail.dat attachment, which confuses the recipients (who do not use Outlook) a lot.  <br/>\nI want to get rid of these winmail.dat attachments in the letters with VBA (the best way), but possibly - with C# (if it's impossible using VBA).\nI can set using VBA the format of my mails to plain text, but it doesn't help.  </p>\n\n<p>Edit: If one manually deletes winmail.dat, it will be attached again by Outlook during the sending process.</p>\n\n<p>There is a great article <a href=\"http://blogs.msdn.com/b/stephen_griffin/archive/2008/08/04/forcing-plain-text-with-mapi.aspx\" rel=\"nofollow\">Forcing Plain Text With MAPI</a> about the mechanism of getting rid of winmail.dat (how does it work), but unfortunately author used C++, which I am not familiar with.  <br/>\nSo, as far as I understood, it is necessary to set 3 MAPI flags to avoid TNEF comletely:</p>\n\n<ul>\n<li>MAPI_SEND_NO_RICH_INFO </li>\n<li>ENCODING_PREFERENCE  </li>\n<li>ENCODING_MIME</li>\n</ul>\n\n<p>I was using OutlookSpy to investigate MAPI flags in my outgoing emails, but even have not found such flags.  <br/>\nI have read also about <a href=\"http://www.dimastr.com/redemption/objects.htm\" rel=\"nofollow\">Redemption library</a> and its possibilities, but I have not found any hints about these MAPI flags either.  <br/>\nCan anybody explain or just suggest: how to set this flags using VBA or C#?  <br/>\nor probably in other way get rid of winmail.dat sending?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447791240, "post_id": 33766072, "comment_id": 55299951, "body": "you will need to qualify the exact workbook and worksheet the macro should act upon for each sub. The way it works now is that the code will run against the workbook running the code. (except for the <code>workbook_open</code> sub ... so for example, <code>LastRow</code> will always find the last row in the sheet that is active when the macro is run. If that sheet has no data, your row will be 1 and those no loop will ever occur."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1447791317, "post_id": 33766072, "comment_id": 55299995, "body": "&quot;The 4 middle subs don&#39;t do anything&quot; - have you run through the code line by line to see what the code is doing [in the VBA module, press f8 one line at a time]? At which line does it no longer operate as intended / expected?"}, {"owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447791456, "post_id": 33766072, "comment_id": 55300087, "body": "@Scott Holtzman So I would qualify the workbook with a &quot;Workbooks(&quot;tooloutput.xlsx&quot;).Activate&quot; at the start of each sub instead at the end of the first sub?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447791590, "post_id": 33766072, "comment_id": 55300169, "body": "@user2989297 - or <code>With Workbooks(&quot;tooloutput.xlsx&quot;) ... End With</code> that would be better. Or even better <code>Dim wb as Workbook | Set wb = Workbooks(&quot;tooloutput.xlsx&quot;) | With wb.</code> (pipes mean new line). Look up <code>With Blocks</code> if you don&#39;t understand what that is. It&#39;s a powerful way to work directly with objects in VBA that will speed up your code and and make it more readable / editable."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1447791735, "post_id": 33766072, "comment_id": 55300252, "body": "Or just look <a href=\"http://stackoverflow.com/questions/33765258/how-to-find-a-specific-cell-value-in-separate-worksheet\">one question down</a> ^_^;"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1447791926, "post_id": 33766072, "comment_id": 55300358, "body": "you also have all those subs that do the same thing. why not create 1 sub and pass the workbook and sheet name as a parameter for each sheet you want to <code>scrub</code> in the main sub that calls all those subs?"}, {"owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447792088, "post_id": 33766072, "comment_id": 55300449, "body": "@findwindow I am slowly figuring out how they are the same problem. Never would have figured that out alone."}, {"owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447792184, "post_id": 33766072, "comment_id": 55300492, "body": "@Scott Holtzman Initially I had them all in one sub. When it didnt work, I broke it into 4 as a shot in the dark to get it working. I&#39;m 3 months or so into using VBA. Most of what I do is based on if it was generated by &quot;record macro&quot;, what I found from google, or complete inelegant chaos."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447792238, "post_id": 33766072, "comment_id": 55300514, "body": "your doing great @user2989297 - we all learn as we go, continuously."}, {"owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1447794180, "post_id": 33766072, "comment_id": 55301621, "body": "@Scott Holtzman Not great enough... still not working. Same result. If I open the book using VBA, it skips over all the rest of the logic. If I open the workbook manually, the rest of the logic works perfectly."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447794663, "post_id": 33766072, "comment_id": 55301872, "body": "You didn&#39;t qualify <code>LastRow</code> and study the link above again. (Hint: you&#39;re missing some periods infront of <code>cells</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447797802, "post_id": 33767502, "comment_id": 55303538, "body": "Nice use of the array."}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 2, "last_activity_date": 1447796315, "creation_date": 1447796315, "answer_id": 33767502, "question_id": 33766072, "link": "https://stackoverflow.com/questions/33766072/vba-subs-do-nothing-unless-file-was-manually-opened/33767502#33767502", "title": "VBA: Subs do nothing unless file was manually opened", "body": "<p>I have done some changes to your code, the comments in the procedure intent to explain the changes. My advice is that besides what you are getting from sites like Stackoverflow you should also read the corresponding documentation to achieve a deeper understanding of the concepts and resources used. Nevertheless, do not hesitate to ask question as you go forward in developing your programing skills.</p>\n\n<p>The code below consolidates all what you are trying to do in one procedure, there you'll see how to run repetitive code for a series of values (i.e. worksheets in this case)</p>\n\n<p>Suggest to visit the following pages:</p>\n\n<p><a href=\"http://www.excelfunctions.net/VBA-Variables-And-Constants.html\" rel=\"nofollow\">Variables &amp; Constants</a>, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194565.aspx\" rel=\"nofollow\">Application Object (Excel)</a>, <a href=\"http://www.excelfunctions.net/Excel-Objects.html\" rel=\"nofollow\">Excel Objects</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264723.aspx\" rel=\"nofollow\">With Statement</a>, <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg251601.aspx\" rel=\"nofollow\">For...Next Statement</a>, <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264596.aspx\" rel=\"nofollow\">For Each...Next Statement</a>, \n<a href=\"https://msdn.microsoft.com/EN-US/library/office/gg251599.aspx\" rel=\"nofollow\">If...Then...Else Statement</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff821537.aspx\" rel=\"nofollow\">Worksheets Object (Excel)</a>, <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff194464.aspx\" rel=\"nofollow\">Worksheet Object (Excel)</a>, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range Object (Excel)</a></p>\n\n<pre><code>Sub Remove_Junk_Data()\nRem Use an Array Variable to List all the worksheets you want to work with\nDim aWsh As Variant, vItm As Variant\naWsh = Array(\"Master\", \"Change History\", \"Update\", \"ExistingOwnership\")\n\nRem Declare Object Variables\nDim Wbk As Workbook\nDim Wsh As Worksheet\n\nDim lRowLst As Long\nDim lRow As Long\n\n    Rem Open Workbook &amp; Set Workbook Object Variable\n    Set Wbk = Workbooks.Open(\"https://company.sharepoint.com/sites/project/subproject/subsubproject/subsubprojecttool/tooloutput/tooloutput.xlsx\")\n\n    Rem Loop throught the worksheet list and process each one\n    For Each vItm In aWsh\n\n        Rem Set Worksheet Object Variable\n        Set Wsh = Wbk.Worksheets(vItm)\n\n        With Wsh\n            lRowLst = Cells(Rows.Count, \"A\").End(xlUp).Row\n            For lRow = lRowLst To 1 Step -1\n                With .Cells(lRow, 1)\n                    If .Value2 = Empty And Not (.HasFormula) Then .EntireRow.Delete\n\n    End With: Next: End With: Next\n\n    Application.DisplayAlerts = False\n    Wbk.Save\n    Application.DisplayAlerts = True\n\n    Workbooks(\"Master_FM_Update.xlsx\").Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447796357, "creation_date": 1447791047, "last_edit_date": 1531164843, "question_id": 33766072, "link": "https://stackoverflow.com/questions/33766072/vba-subs-do-nothing-unless-file-was-manually-opened", "title": "VBA: Subs do nothing unless file was manually opened", "body": "<p>I have the following Macro:</p>\n\n<pre><code>Sub Remove_Junk_Data()\n\nCall Open_Workbook\nCall Scrub_Master\nCall Scrub_Change_History\nCall Scrub_Update\nCall Scrub_ExistingOwnership\nCall Save_Scrubbed\n\nEnd Sub\n\nSub Open_Workbook()\n\nWorkbooks.Open \"https://company.sharepoint.com/sites/project/subproject/subsubproject/subsubprojecttool/tooloutput/tooloutput.xlsx\"\n\nWorkbooks(\"tooloutput.xlsx\").Activate\n\nEnd Sub\n\nSub Scrub_Master()\n\nDim myValue As String\nDim LastRow As Long\nDim i As Long\nDim r As Range\n\nLastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\nmyValue = \"\"\n\nSheets(\"Master\").Select\n\nFor i = LastRow To 1 Step -1\nSet r = Cells(i, 1)\nIf r.Value = myValue Then r.EntireRow.Delete\nNext i\n\nEnd Sub\n\nSub Scrub_Change_History()\n\nDim myValue As String\nDim LastRow As Long\nDim i As Long\nDim r As Range\n\nLastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\nmyValue = \"\"\n\nSheets(\"Change History\").Select\n\nFor i = LastRow To 1 Step -1\nSet r = Cells(i, 1)\nIf r.Value = myValue Then r.EntireRow.Delete\nNext i\n\nEnd Sub\n\nSub Scrub_Update()\n\nDim myValue As String\nDim LastRow As Long\nDim i As Long\nDim r As Range\n\nLastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\nmyValue = \"\"\n\nSheets(\"Update\").Select\n\nFor i = LastRow To 1 Step -1\nSet r = Cells(i, 1)\nIf r.Value = myValue Then r.EntireRow.Delete\nNext i\n\nEnd Sub\n\nSub Scrub_ExistingOwnership()\n\nDim myValue As String\nDim LastRow As Long\nDim i As Long\nDim r As Range\n\nLastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\nmyValue = \"\"\n\nSheets(\"ExistingOwnership\").Select\n\nFor i = LastRow To 1 Step -1\nSet r = Cells(i, 1)\nIf r.Value = myValue Then r.EntireRow.Delete\nNext i\n\nEnd Sub\n\nSub Save_Scrubbed()\n\nApplication.DisplayAlerts = False\n    ActiveWorkbook.SaveAs Filename:= _\n    \"https://company.sharepoint.com/sites/project/subproject/subsubproject/subsubprojecttool/tooloutput/tooloutput.xlsx\", _\n    FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n    Application.DisplayAlerts = False\n\nWorkbooks(\"Master_FM_Update.xlsx\").Close\n\nEnd Sub\n</code></pre>\n\n<p>If I comment out the \"Open_Workbook\" sub and manually open the workbook then run the remainder of Remove_Junk_Data(), it works perfectly.</p>\n\n<p>If I try to run Remove_Junk_Data with Open_Workbook active, then no errors are thrown, but the 4 middle subs dont do anything...</p>\n\n<p>Has anyone ran into anything like this? Did you find a resolution? I want to click a button and have all 6 subs do their thing correctly...</p>\n\n<p>Edit: With input, new macro, and it works! Thanks guys!:</p>\n\n<pre><code>Sub Remove_Junk_Data()\n\nWorkbooks.Open \"https://company.sharepoint.com/sites/project/subproject/subsubproject/Subsubprojecttool/tooloutput/tooloutput.xlsx\"\n\nDim myValue As String\nDim LastRow As Long\nDim i As Long\nDim r As Range\n\n\n\nWith Workbooks(\"tooloutput.xlsx\").Sheets(\"Master\")\n    LastRow = .Cells(Rows.Count, \"A\").End(xlUp).Row\n    myValue = \"\"    \n    For i = LastRow To 1 Step -1\n    Set r = .Cells(i, 1)\n    If r.Value = myValue Then r.EntireRow.Delete\n    Next i\nEnd With\n\nWith Workbooks(\"tooloutput.xlsx\").Sheets(\"Change History\")\n    LastRow = .Cells(Rows.Count, \"A\").End(xlUp).Row\n    myValue = \"\"    \n    For i = LastRow To 1 Step -1\n    Set r = .Cells(i, 1)\n    If r.Value = myValue Then r.EntireRow.Delete\n    Next i\nEnd With\n\nWith Workbooks(\"tooloutput.xlsx\").Sheets(\"Update\")\n    LastRow = .Cells(Rows.Count, \"A\").End(xlUp).Row\n    myValue = \"\"    \n    For i = LastRow To 1 Step -1\n    Set r = .Cells(i, 1)\n    If r.Value = myValue Then r.EntireRow.Delete\n    Next i\nEnd With\n\nWith Workbooks(\"tooloutput.xlsx\").Sheets(\"ExistingOwnership\")\n    LastRow = .Cells(Rows.Count, \"A\").End(xlUp).Row\n    myValue = \"\"    \n    For i = LastRow To 1 Step -1\n    Set r = .Cells(i, 1)\n    If r.Value = myValue Then r.EntireRow.Delete\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "listbox", "vba", "copy"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447791889, "post_id": 33765833, "comment_id": 55300338, "body": "I think your clipboard should rather be a <b>textbox</b> than a listbox, if you want to put multi-line strings into it."}, {"owner": {"reputation": 1, "user_id": 5121345, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rLhgzhclLQ4/AAAAAAAAAAI/AAAAAAAABDo/oE1Ky4PFMOM/photo.jpg?sz=128", "display_name": "Kenneth J Johnson", "link": "https://stackoverflow.com/users/5121345/kenneth-j-johnson"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447873856, "post_id": 33765833, "comment_id": 55343602, "body": "My Clipboard is a Textbox"}], "owner": {"reputation": 1, "user_id": 5121345, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rLhgzhclLQ4/AAAAAAAAAAI/AAAAAAAABDo/oE1Ky4PFMOM/photo.jpg?sz=128", "display_name": "Kenneth J Johnson", "link": "https://stackoverflow.com/users/5121345/kenneth-j-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594643203, "creation_date": 1447790121, "last_edit_date": 1594643203, "question_id": 33765833, "link": "https://stackoverflow.com/questions/33765833/copying-a-listbox", "title": "Copying a Listbox", "body": "<p>I have a Form that has Listboxes that return values from different queries for agent. I have made a copy button to copy this information to a clipboard i have hide in the form. However the Copy button will not copy the listbox. </p>\n\n<pre><code>Private Sub cpyTLES_Click()\n\nMe.lstClipboard = \"Team Lead Error Scorecard\" &amp; Chr(13) &amp; Chr(10) &amp; Chr(13) &amp; Chr(10) &amp; Chr(13) &amp; Chr(10) &amp; \"Team Lead:\" &amp; Me.Team_Lead &amp; Chr(13) &amp; Chr(10) &amp; \"Total of Cases Created:\" &amp; Me.List14 &amp; Chr(13) &amp; Chr(10) &amp; \"Number Of Errors:\" &amp; Me.List18 &amp; Chr(13) &amp; Chr(10) &amp; \"Percent Of Errors:\" &amp; Me.List16 &amp; Chr(13) &amp; Chr(10) &amp; \"Error Types:\" &amp; Me.List56 &amp; Chr(13) &amp; Chr(10)\nMe.lstClipboard.Visible = True\nMe.lstClipboard.SetFocus\nDoCmd.RunCommand acCmdCopy\nMe.List56.SetFocus\nMe.lstClipboard.Visible = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447790942, "post_id": 33765405, "comment_id": 55299776, "body": "Please add the <code>Upisivanje_Click</code> sub."}, {"owner": {"reputation": 91, "user_id": 1878534, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/640e60ccf40ad4e19ee52286a9a650fb?s=128&d=identicon&r=PG", "display_name": "Marko Pantic", "link": "https://stackoverflow.com/users/1878534/marko-pantic"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1447791190, "post_id": 33765405, "comment_id": 55299915, "body": "its only DoCmd.RunCommand acCmdSaveRecord, the problem is because DoCmd.RunCommand acCmdUndo delete everything, i only need to use it when answer is no"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 1878534, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/640e60ccf40ad4e19ee52286a9a650fb?s=128&d=identicon&r=PG", "display_name": "Marko Pantic", "link": "https://stackoverflow.com/users/1878534/marko-pantic"}, "edited": false, "score": 0, "creation_date": 1447791725, "post_id": 33766165, "comment_id": 55300244, "body": "thanks, i tried something similar but it did not work"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 2, "last_activity_date": 1447791371, "creation_date": 1447791371, "answer_id": 33766165, "question_id": 33765405, "link": "https://stackoverflow.com/questions/33765405/msgbox-yes-or-no-always-delete-all-changes/33766165#33766165", "title": "Msgbox yes or no always delete all changes", "body": "<p>Doing <code>If ... Then ...</code> in a single line can be confusing, as you have just demonstrated. :)</p>\n\n<p>You code should be:</p>\n\n<pre><code>Private Sub Prekid_Click()\n\n    If Me.Dirty Then\n        If MsgBox(\"Da li \u017eelite da sa\u00e8uvate promene?\", vbYesNo) = vbYes Then\n            Call Upisivanje_Click\n        Else    ' No case\n            DoCmd.RunCommand acCmdUndo\n        End If\n    End If\n\n    Forms!Pregled!LicencaList.Form.Requery\n    DoCmd.Close acForm, Me.Name\n\nEnd Sub\n</code></pre>\n\n<p><code>acCmdUndo</code> should only run in the Else case (if <code>No</code> was clicked).</p>\n"}], "owner": {"reputation": 91, "user_id": 1878534, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/640e60ccf40ad4e19ee52286a9a650fb?s=128&d=identicon&r=PG", "display_name": "Marko Pantic", "link": "https://stackoverflow.com/users/1878534/marko-pantic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 1, "accepted_answer_id": 33766165, "answer_count": 1, "score": 0, "last_activity_date": 1447791406, "creation_date": 1447788481, "last_edit_date": 1447791406, "question_id": 33765405, "link": "https://stackoverflow.com/questions/33765405/msgbox-yes-or-no-always-delete-all-changes", "title": "Msgbox yes or no always delete all changes", "body": "<p>I have button on my form that should exit the form. When this button is clicked, a message box prompts you to \"save changes?\" with a yes or no. Unfortunately, regardless of whether 'yes' or 'no' is clicked the code below does not save changes:</p>\n\n<pre><code>Private Sub Prekid_Click()\n\n    If Me.Dirty Then If MsgBox(\"Da li \u017eelite da sa\u00e8uvate promene?\", vbYesNo) = vbYes Then Upisivanje_Click\n\n    DoCmd.RunCommand acCmdUndo\n\n    Forms!Pregled!LicencaList.Form.Requery\n    DoCmd.Close acForm, Me.Name\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 3, "creation_date": 1447787975, "post_id": 33765258, "comment_id": 55298114, "body": "Qualify the range with the desired sheet."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447788473, "post_id": 33765378, "comment_id": 55298379, "body": "Beat me by 20 seconds."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447788571, "post_id": 33765378, "comment_id": 55298439, "body": "@ScottCraner, and you two beat me by 1 minute. I need to get faster, hmph!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1447788582, "post_id": 33765378, "comment_id": 55298451, "body": "I didn&#39;t check syntax in the VBE :)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447788691, "post_id": 33765378, "comment_id": 55298514, "body": "I do have a quick question - what kind of range is going to be set? I was going to suggest to use two variables for his two <code>Find()</code> ranges, but ...what&#39;s he trying to use?  The column, row, address?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447788755, "post_id": 33765378, "comment_id": 55298544, "body": "Is <code>find</code> most efficient here or <a href=\"http://stackoverflow.com/questions/33725708/excel-vba-application-defined-or-object-defined-error#comment55260876_33725708\">match</a>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447788756, "post_id": 33765378, "comment_id": 55298546, "body": "@BruceWayne - This would be like going to the cell with <i>BMA Authorization ID</i> in row 2 and tapping Ctrl+Shift+\u25bc."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447788829, "post_id": 33765378, "comment_id": 55298580, "body": "I am assuming he is looking for a column header of sorts.  Its a good work around to the fact that excel does not name columns."}, {"owner": {"reputation": 173, "user_id": 4639124, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EXQEo.jpg?s=128&g=1", "display_name": "UnbrokenChain", "link": "https://stackoverflow.com/users/4639124/unbrokenchain"}, "edited": false, "score": 0, "creation_date": 1447789011, "post_id": 33765378, "comment_id": 55298694, "body": "Yes, I am searching for column headers in a different tab, selecting the column and copy and pasting values to remove formulas. This is the first macro i&#39;ve created by myself."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1447789049, "post_id": 33765378, "comment_id": 55298713, "body": "@findwindow - If there were thousands then <code>.Range(.Cells(2, app.Match(&quot;BMA Authorization ID&quot;, .Rows(2), 0)), .Cells(2, app.Match(&quot;BMA Authorization ID&quot;, .Rows(2), 0)).End(xlDown))</code> might be marginally quicker but for a single operation I think you would be hard-pressed to even measure the difference. At least it is not cell-by-cell."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447789181, "post_id": 33765378, "comment_id": 55298780, "body": "Makes sense that number of operations drives method. Thanks &lt;3"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447789796, "post_id": 33765378, "comment_id": 55299143, "body": "@Jeeped - Yeah, I know the <code>.xlDown</code>, but I didn&#39;t know you could use a range like this <code>Range(&quot;A1&quot;,&quot;A2&quot;)</code> which is essentially what the two <code>finds</code> would return, correct? (two addresses).  I asked that question because I was of the understanding that, unless specified, <code>Range</code> returns the <code>.Value</code> from a cell.  Does using <code>Find()</code> change the default from a <code>Value</code> to an <code>Address</code>? (Does my question make sense?)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1447790146, "post_id": 33765378, "comment_id": 55299359, "body": "@BruceWayne - <code>Range(&quot;A1, D4&quot;)</code> is the <b>union</b> of A1 and D4; i.e. two cells. <code>Range(&quot;A1&quot;, &quot;D4&quot;)</code> is the <b>range</b> with A1 in the top=left and D4 in the bottom-right; i.e. sixteen cells. The OP&#39;s method was the latter. Uh... yes the default is the value but not always; <code>Set rng = Range(&quot;A1&quot;)</code> does not set rng to be the value of A1."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447791339, "post_id": 33765378, "comment_id": 55300010, "body": "@Jeeped - last question (I&#39;ll Google if I have more ?s), when using <code>Set rng = Range( &quot;A1&quot;)</code> hold what value - the address?  If I hover over <code>rng</code> in VB, I&#39;m pretty sure that it&#39;ll show the <code>Value</code> that&#39;s in the cell.  Or is it going to hold &quot;everything&quot; (row, address, etc.) since later I can use <code>rng.Address</code>, <code>rng.Row</code>,etc.  (Surprisingly, I don&#39;t think I&#39;ve ever used Range like OP, which is why I have these pretty simplistic questions). I typically just do <code>Range(Cells(), Cells())</code> instead of using addresses."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1447792338, "post_id": 33765378, "comment_id": 55300561, "body": "@BruceWayne - <code>Set rng = Range( &quot;A1&quot;)</code> creates a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow noreferrer\">Range object</a>. If A1 held 16 as a value, you couldn&#39;t <code>16.Font.Color = vbRed</code> but you can <code>rng.Font.Color = vbRed</code> just like you can <code>Range( &quot;A1&quot;).Font.Color = vbRed</code>. For all intents and purposes, a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow noreferrer\">Range.Cells property</a> is a Range.Object."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1447792640, "post_id": 33765378, "comment_id": 55300729, "body": "Someone get @Jeeped a cookie~ Edit: there needs to be a SO meetup ^_^;"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447793993, "post_id": 33765378, "comment_id": 55301528, "body": "As always, many thanks @Jeeped! (I should actually read the technical info. on objects :P )"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 5, "last_activity_date": 1447788395, "creation_date": 1447788395, "answer_id": 33765378, "question_id": 33765258, "link": "https://stackoverflow.com/questions/33765258/how-to-find-a-specific-cell-value-in-separate-worksheet/33765378#33765378", "title": "How to find a specific cell value in separate worksheet?", "body": "<p>Use a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"noreferrer\">With ... End With statement</a> to set the range/cell parent worksheet.</p>\n\n<pre><code>with worksheets(\"Sheet1\")   '&lt;~~change to suit\n    with .Range(.Range(\"A2:AX2\").Find(\"BMA Authorization ID\"), _\n                .Range(\"A2:AX2\").Find(\"BMA Authorization ID\").End(xlDown))\n        .value = .value  'same as .Copy .PasteSpecial xlPasteValues\n    end with\nend with\n</code></pre>\n\n<p>Note that all of the <code>Range(...)</code> are now <code>.Range(...)</code>. The prefix period (aka <code>.</code> or <em>full stop</em>) makes all of the ranges' parent the worksheet referenced within the With .. End With.</p>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447788622, "post_id": 33765382, "comment_id": 55298478, "body": "Just a note that <code>Sheets(1)</code> isn&#39;t necessarily the same as <code>Sheets(&quot;Sheet1&quot;)</code>.  Generally, they will, but not always!  In this case, the format is <code>Sheets([sheet index no.])</code> vs. <code>Sheets(&quot;[sheet name]&quot;)</code>."}, {"owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447788697, "post_id": 33765382, "comment_id": 55298516, "body": "@BruceWayne Yep, good to clarify, that&#39;s the reason for the link"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447788751, "post_id": 33765382, "comment_id": 55298540, "body": "Ah, didn&#39;t check the link. Thanks for that!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447798174, "post_id": 33765382, "comment_id": 55303737, "body": "I don&#39;t necessarily disagree with you, but my rule of thumb is if it takes longer to type the with block than just putting the abject variable, I use the object variable.  But sometimes there is just so much retyping, and I don&#39;t find it especially hard to associate the correct object with the correct with statement, even in many lines of code.  For example when do charts or formatting cells, a with block is the only way to go.  I can see your point with Ranges and Cells.  But this is a &quot;Dealers Choice&quot; and should be agreed upon by the group that is writing and interpreting the code."}], "tags": [], "owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "is_accepted": false, "score": 1, "last_activity_date": 1447791993, "last_edit_date": 1495540324, "creation_date": 1447788410, "answer_id": 33765382, "question_id": 33765258, "link": "https://stackoverflow.com/questions/33765258/how-to-find-a-specific-cell-value-in-separate-worksheet/33765382#33765382", "title": "How to find a specific cell value in separate worksheet?", "body": "<p>You can just use <code>Sheets(1).Range...</code> or <code>Sheets(\"Sheet1\").Range...</code></p>\n\n<p>Take a look here for more details on referencing sheets in VBA...\n<a href=\"https://stackoverflow.com/questions/33479352/trying-to-reference-another-worksheet-in-active-workbook/33479626#33479626\">Trying to reference another worksheet in active workbook</a></p>\n\n<p><strong>EDIT</strong>: Please don't take this as an argument against the other answers here.  They are excellent answers for the OP (part of why I waited until one was accepted). I just think this is worth mentioning as a consideration.</p>\n\n<p>I have personally adapted, come to appreciate, and would recommend the convention of avoiding <code>with</code> statements whenever possible per the following sentiment... </p>\n\n<blockquote>\n  <p><strong>Why doesn't C# have VB.NET's 'with' operator?</strong></p>\n  \n  <p>Many people, including the C# language designers, believe that 'with' often harms readability, and is more of a curse than a blessing. It is clearer to declare a local variable with a meaningful  name, and use that variable to perform multiple operations on a single object, than it is to have a block with a sort of implicit context. </p>\n  \n  <p>by <a href=\"https://stackoverflow.com/users/22656/jon-skeet\">@Jon Skeet</a><br>\n  <a href=\"https://stackoverflow.com/a/4174826/3546415\">https://stackoverflow.com/a/4174826/3546415</a></p>\n</blockquote>\n\n<p>The use of variable declaration would look something like this...</p>\n\n<pre><code>Dim S1 As Worksheet\nSet S1 = Sheets(\"Sheet1\")\nS1.Range... blah blah\n</code></pre>\n\n<p>Of course, there are still situations where using <code>with</code> does still make sense. Such as when a variable can't be defined or when setting a large number of properties, but I do agree that readability is generally enhanced when you don't have to worry about nesting and checking the top of your <code>with</code> structure to see what <code>.Range</code> is actually referring to. For a simple program this is hardly an issue, but it's worth keeping in mind for something more complicated.</p>\n"}, {"comments": [{"owner": {"reputation": 173, "user_id": 4639124, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EXQEo.jpg?s=128&g=1", "display_name": "UnbrokenChain", "link": "https://stackoverflow.com/users/4639124/unbrokenchain"}, "edited": false, "score": 0, "creation_date": 1447788919, "post_id": 33765385, "comment_id": 55298639, "body": "Thank you. Exactly what I needed."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 5, "last_activity_date": 1447788416, "creation_date": 1447788416, "answer_id": 33765385, "question_id": 33765258, "link": "https://stackoverflow.com/questions/33765258/how-to-find-a-specific-cell-value-in-separate-worksheet/33765385#33765385", "title": "How to find a specific cell value in separate worksheet?", "body": "<p>As findwindow suggested; you need to qualify the sheet.  Normaly I would leave this in the comments but the line is too long not to use a with block.</p>\n\n<pre><code>Dim R1 As Range\nDim ws As Worksheet\n\nSet ws = Sheets(\"Sheet1\")'Change this name to the sheet desired.\n'Use a with block.\n'When using a with block .Range = ws.Range\nWith ws\n    Set R1 = .Range(.Range(\"A2:AX2\").Find(\"BMA Authorization ID\"), .Range(\"A2:AX2\").Find(\"BMA Authorization ID\").End(xlDown))\n    R1.Value = R1.Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 4639124, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EXQEo.jpg?s=128&g=1", "display_name": "UnbrokenChain", "link": "https://stackoverflow.com/users/4639124/unbrokenchain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 33765378, "answer_count": 3, "score": 1, "last_activity_date": 1447791993, "creation_date": 1447787909, "last_edit_date": 1447789589, "question_id": 33765258, "link": "https://stackoverflow.com/questions/33765258/how-to-find-a-specific-cell-value-in-separate-worksheet", "title": "How to find a specific cell value in separate worksheet?", "body": "<p>I have a piece of code that searches a range in the current worksheet for a specific cell value and then does an action on that column. The macro is launched by a form control button on the same page. I need to move the form control button to a different worksheet but I am not sure how to udpate my code to only search in sheet1 and not in the sheet where the button in.</p>\n\n<p>Below is my code that works when using the button on the same worksheet as the data. I just need it to look at sheet1 instead of the current sheet.</p>\n\n<pre><code>Dim R1 As Range\n    Set R1 = Range(Range(\"A2:AX2\").Find(\"BMA Authorization ID\"), Range(\"A2:AX2\").Find(\"BMA Authorization ID\").End(xlDown))\n    R1.Select\n    R1.Copy\n    R1.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n</code></pre>\n"}, {"tags": ["vba", "web-services"], "answers": [{"tags": [], "owner": {"reputation": 7, "user_id": 5573508, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KH_-HOKCI8k/AAAAAAAAAAI/AAAAAAAAAJE/vGsr05C_wwE/photo.jpg?sz=128", "display_name": "uae2ae", "link": "https://stackoverflow.com/users/5573508/uae2ae"}, "is_accepted": false, "score": -2, "last_activity_date": 1447787292, "creation_date": 1447787292, "answer_id": 33765085, "question_id": 33764647, "link": "https://stackoverflow.com/questions/33764647/error-calling-web-service-using-vba/33765085#33765085", "title": "Error calling web service using vba", "body": "<p>I remember having this problem, </p>\n\n<blockquote>\n  <p>Microsoft ended support for Windows Server 2003 on July 14, 2015.\n  This change has affected your software updates and security options.</p>\n</blockquote>\n\n<p>Have a look here <a href=\"https://support.microsoft.com/en-us/kb/938397\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/938397</a></p>\n"}], "owner": {"reputation": 605, "user_id": 1181910, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/584b1892288cfe306752e8fb6885337b?s=128&d=identicon&r=PG", "display_name": "stech", "link": "https://stackoverflow.com/users/1181910/stech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 757, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1447787292, "creation_date": 1447785802, "last_edit_date": 1447786134, "question_id": 33764647, "link": "https://stackoverflow.com/questions/33764647/error-calling-web-service-using-vba", "title": "Error calling web service using vba", "body": "<p>I have the following code to make web service calls using VBA (word 2013). It was working fine with http until recently when the url changed to https. </p>\n\n<pre><code>Dim myRequest As Object\nSet myRequest = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\nmyRequest.setTimeouts 50000, 50000, 50000, 50000\nmyRequest.Open \"GET\", myURL, False\nmyRequest.setRequestHeader \"Authorization\", \"Basic \" + EncodeToBase64(\"uid\"+\"pwd\")\nmyRequest.Send\nmyRequest.waitForResponse (500)    \n</code></pre>\n\n<p>When I changed the url from \"http\" to \"https\" it is giving this error. </p>\n\n<blockquote>\n  <p>\"Runtime error '-2147012739 (80072f7d)': An error occurred in the\n  secure channel support\"</p>\n</blockquote>\n\n<p>I have tried setting the client certificate (before Send method) but that didn't work. (I imported the certificate into my local computer and can see it in the certificate store)</p>\n\n<pre><code>myRequest.SetClientCertificate \"LOCAL_MACHINE\\Personal\\Certificates\\\"\n</code></pre>\n\n<p>I really need to get this fixed. Can anyone help? Thanks.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 5190122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-dDNgmDOe_RM/AAAAAAAAAAI/AAAAAAAAZHo/Ac0M16eVqio/photo.jpg?sz=128", "display_name": "Ugo Portela Pereira", "link": "https://stackoverflow.com/users/5190122/ugo-portela-pereira"}, "edited": false, "score": 0, "creation_date": 1447786205, "post_id": 33764589, "comment_id": 55297104, "body": "That makes sense, but I made some changes and now I&#39;m receiving the <code>Run-time error &#39;-2147352567 (800200009)&#39;: Property is read-only.</code> I will add the changes I made to the original post for further clarification."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1447785632, "creation_date": 1447785632, "answer_id": 33764589, "question_id": 33764419, "link": "https://stackoverflow.com/questions/33764419/refer-to-field-in-outlook-to-cell/33764589#33764589", "title": "Refer &#39;To&#39; field in Outlook to cell", "body": "<p>I think it's due to the fact that you're setting <code>myRecipients</code> and <code>myRecipient</code> as an Object but want to set it with what is essentially a <code>Range</code> type.  Try:</p>\n\n<pre><code>Dim myRecipients as Range, myRecipient as Range\nDim objMyRecipients as Object, objMyRecipient as Object 'create a variable that holds the object\n</code></pre>\n\n<p>Then, when you need to use them as an object, you have a separate variable to do so.</p>\n"}, {"comments": [{"owner": {"reputation": 109, "user_id": 5190122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-dDNgmDOe_RM/AAAAAAAAAAI/AAAAAAAAZHo/Ac0M16eVqio/photo.jpg?sz=128", "display_name": "Ugo Portela Pereira", "link": "https://stackoverflow.com/users/5190122/ugo-portela-pereira"}, "edited": false, "score": 0, "creation_date": 1447856666, "post_id": 33765788, "comment_id": 55331692, "body": "I&#39;m just having difficulty in doing the <code>If Not ResolveAll</code> part. It says that <code>myRecipients</code> don&#39;t support the property or method.   But I&#39;m thinking that what I&#39;m doing now isn&#39;t making much sense: <code>If Not myRecipients.ResolveAll Then    For Each myRecipient In myRecipients    If Not myRecipient.Resolved Then    MsgBox myRecipient.Name  </code> while myRecipients is a cell... I&#39;m updating that in the post so you can see it more clearly"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 109, "user_id": 5190122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-dDNgmDOe_RM/AAAAAAAAAAI/AAAAAAAAZHo/Ac0M16eVqio/photo.jpg?sz=128", "display_name": "Ugo Portela Pereira", "link": "https://stackoverflow.com/users/5190122/ugo-portela-pereira"}, "edited": false, "score": 0, "creation_date": 1447858557, "post_id": 33765788, "comment_id": 55333172, "body": "Because myRecipients variable in your code above points to a range from Excel, not to an instance of the Outlook.Recipients object retrieved from MailItem.Recipients"}, {"owner": {"reputation": 109, "user_id": 5190122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-dDNgmDOe_RM/AAAAAAAAAAI/AAAAAAAAZHo/Ac0M16eVqio/photo.jpg?sz=128", "display_name": "Ugo Portela Pereira", "link": "https://stackoverflow.com/users/5190122/ugo-portela-pereira"}, "edited": false, "score": 0, "creation_date": 1447858848, "post_id": 33765788, "comment_id": 55333377, "body": "But how can I make it consider that after retrieving the information from the Excel cell and inserting that in the To field it will test if the recipients are resolved?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 109, "user_id": 5190122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-dDNgmDOe_RM/AAAAAAAAAAI/AAAAAAAAZHo/Ac0M16eVqio/photo.jpg?sz=128", "display_name": "Ugo Portela Pereira", "link": "https://stackoverflow.com/users/5190122/ugo-portela-pereira"}, "edited": false, "score": 0, "creation_date": 1447859841, "post_id": 33765788, "comment_id": 55334151, "body": "You need to fix the error in your code. See my updated post."}, {"owner": {"reputation": 109, "user_id": 5190122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-dDNgmDOe_RM/AAAAAAAAAAI/AAAAAAAAZHo/Ac0M16eVqio/photo.jpg?sz=128", "display_name": "Ugo Portela Pereira", "link": "https://stackoverflow.com/users/5190122/ugo-portela-pereira"}, "edited": false, "score": 0, "creation_date": 1447860677, "post_id": 33765788, "comment_id": 55334795, "body": "Nice! It is working very well, but just for one email at a time. If my K6 cell is <code>name.surname@company.com</code> it will resolve. If it is <code>name.surname@company.com; name2.surname2@company.com</code> it won&#39;t resolve. I tried moving the <code>;</code> but still no results.   Since it&#39;s .Recipients, I imagined that it would take more than one, right?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 109, "user_id": 5190122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-dDNgmDOe_RM/AAAAAAAAAAI/AAAAAAAAZHo/Ac0M16eVqio/photo.jpg?sz=128", "display_name": "Ugo Portela Pereira", "link": "https://stackoverflow.com/users/5190122/ugo-portela-pereira"}, "edited": false, "score": 0, "creation_date": 1447861369, "post_id": 33765788, "comment_id": 55335333, "body": "Firstly, it would definitely be better to have multiple cells each containing just one value. That is the whole point of Excel, is it not? If you have multiple &quot;;&quot; separated values, just set the MailItem.To property and call MAilItem.Recipients.ResolveAll"}, {"owner": {"reputation": 109, "user_id": 5190122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-dDNgmDOe_RM/AAAAAAAAAAI/AAAAAAAAZHo/Ac0M16eVqio/photo.jpg?sz=128", "display_name": "Ugo Portela Pereira", "link": "https://stackoverflow.com/users/5190122/ugo-portela-pereira"}, "edited": false, "score": 0, "creation_date": 1447861504, "post_id": 33765788, "comment_id": 55335456, "body": "I understand that. The idea is that in the Emails sheet I have all the information needed to create the email. The To field shouldn&#39;t vary too much, but it&#39;s easier to edit the list like that.   I will test here, thanks"}, {"owner": {"reputation": 109, "user_id": 5190122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-dDNgmDOe_RM/AAAAAAAAAAI/AAAAAAAAZHo/Ac0M16eVqio/photo.jpg?sz=128", "display_name": "Ugo Portela Pereira", "link": "https://stackoverflow.com/users/5190122/ugo-portela-pereira"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1447861974, "post_id": 33765788, "comment_id": 55335840, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/95457/discussion-between-ugo-portela-pereira-and-dmitry-streblechenko\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1447860130, "last_edit_date": 1447860130, "creation_date": 1447789964, "answer_id": 33765788, "question_id": 33764419, "link": "https://stackoverflow.com/questions/33764419/refer-to-field-in-outlook-to-cell/33765788#33765788", "title": "Refer &#39;To&#39; field in Outlook to cell", "body": "<p>Recipients property is indeed read-only. You need to either call MailItem.Recipients.Add for each recipient or set the To / CC/ BCC properties to a \";\" separated list of names or addresses. </p>\n\n<p>UPDATE:</p>\n\n<pre><code>Set OutApp = CreateObject(\"Outlook.Application\")\nSet MItem = OutApp.CreateItem(0)\nSet recipName = ws1.Cells.Range(\"K6\").Value\nSet myRecipient = MItem.Recipients.Add(recipName)\nIf Not myRecipient.Resolve Then\n  MsgBox myRecipient.Name\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 5190122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-dDNgmDOe_RM/AAAAAAAAAAI/AAAAAAAAZHo/Ac0M16eVqio/photo.jpg?sz=128", "display_name": "Ugo Portela Pereira", "link": "https://stackoverflow.com/users/5190122/ugo-portela-pereira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 33765788, "answer_count": 2, "score": 0, "last_activity_date": 1447860130, "creation_date": 1447785050, "last_edit_date": 1447856872, "question_id": 33764419, "link": "https://stackoverflow.com/questions/33764419/refer-to-field-in-outlook-to-cell", "title": "Refer &#39;To&#39; field in Outlook to cell", "body": "<p>I'm trying to create a macro on Excel VBA that will create an email and will populate the <code>To</code> field from the Excel cell <code>K6</code>.</p>\n\n<p>When this code runs, I get the error message <code>Run-time error'5': Invalid procedure call or argument</code>.</p>\n\n<pre><code>Dim OutApp As Object\nDim MItem As Object\nDim cell As Range\nDim rng As Range\nDim Subj As String\nDim EmailAddr As String\nDim myRecipient As Object\nDim myRecipients As Object\nDim Recipient As String\nDim Msg As String\nDim ws1 As Worksheet\nDim DateNow As Date\n\nSet ws1 = Sheets(\"Email\")\n\n'Create Outlook object\n\nSet rng = ws1.Range(\"B6:F26\").SpecialCells(xlCellTypeVisible)\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet MItem = OutApp.CreateItem(0)\nSet myRecipients = MItem.Recipients\n\nmyRecipients = ws1.Cells.Range(\"K6\")\n\nIf Not myRecipients.ResolveAll Then\n\n For Each myRecipient In myRecipients\n\n If Not myRecipient.Resolved Then\n\n MsgBox myRecipient.Name\n\n End If\n\n Next\n\n End If\n\nDateNow = Format(Now, \"dd/MM/yyyy\")\nDateNow2 = Format(Now, \"h:mm\")\n\nMsg = \"This report was generated on \" &amp; DateNow &amp; \" at \" &amp; DateNow2 &amp; \".\"\n\nWith MItem\n    .CC = EmailAddr2\n    .Subject = Subj\n    .HTMLBody = RangetoHTML(rng) &amp; Msg\n    .Display\nEnd With\nOn Error GoTo 0\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = False\nEnd With\n\nSet MItem = Nothing\nSet OutApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>If I use <code>Set myRecipients = ws1.Cells.Range(\"K6\")</code> I get the error message <code>Run-time error '438': Object doesn't support this property or method</code>.</p>\n\n<p>If I set the <code>myRecipients As String</code>, it says <code>Object required</code>.</p>\n\n<p>I'm having lots of problems to understand late-binding Outlook in Excel VBA and I've read lots of things, but haven't found many sources on it that could explain this in a more didactic way.</p>\n\n<p>Besides that, I'm also trying to, after adding the content of the cell, to Resolve (the effect of using ctrl + K on Outlook to resolve the email to the display name) the emails added to the <code>To</code> field, but I can't test it without making the first part work.</p>\n\n<p>Thanks for the attention,</p>\n\n<p>Edit: after Bruce Wayne's suggestion, I put them as <code>Range</code>, but now I'm getting a different error: <code>Run-time error '-2147352567 (800200009)': Property is read-only.</code></p>\n\n<p><code>Dim myRecipient As Range\nDim myRecipients As Range</code></p>\n\n<p>In the middle of the code: </p>\n\n<pre><code>Set OutApp = CreateObject(\"Outlook.Application\")\nSet MItem = OutApp.CreateItem(0)\n\nSet myRecipients = ws1.Cells.Range(\"K6\")\nSet MItem.Recipients = myRecipients\n</code></pre>\n\n<p>After Dmitry's suggestion: </p>\n\n<pre><code>Set OutApp = CreateObject(\"Outlook.Application\")\nSet MItem = OutApp.CreateItem(0)\n\nSet myRecipients = ws1.Cells.Range(\"K6\")\nSet myRecipient = MItem.Recipients.Add(myRecipients)\n\nIf Not myRecipients.ResolveAll Then\n\n For Each myRecipient In myRecipients\n\n If Not myRecipient.Resolved Then\n\n MsgBox myRecipient.Name\n\n End If\n\n Next\n\n End If\n</code></pre>\n\n<p>But I get the error message: <code>Run-time error '438': Object doesn't support this property or method</code> marked on the <code>If Not myRecipients.ResolveAll Then</code>. If I delete all the If part, the code runs fine. But it's very important to me that I'm able to resolve the names and emails in the To/CC fields.</p>\n"}, {"tags": ["mysql", "vba", "excel"], "comments": [{"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1447784448, "post_id": 33764184, "comment_id": 55296074, "body": "Start by enumerating the steps. Then chip away at each of those steps one by one.  Try to google for each.  I think each step is its own question possibly... after you try to accomplish it yourself.  But I think you&#39;re misunderstanding a few things if you think you&#39;ll be doing SQL queries in VBA, unless there&#39;s database involved that you didn&#39;t mention."}, {"owner": {"reputation": 53, "user_id": 2825230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd595cec9ff632d758be27689fcbf789?s=128&d=identicon&r=PG", "display_name": "Haagimus", "link": "https://stackoverflow.com/users/2825230/haagimus"}, "reply_to_user": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1447784689, "post_id": 33764184, "comment_id": 55296219, "body": "No no database involved here. I think I may have found a way to do this with an excel formula actually that would calculate a running total until a specified criteria then would reset. If I can get that to work I can function out the remaining steps by just using a countif or something."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1447803262, "post_id": 33764184, "comment_id": 55305914, "body": "Your question would be much improved with the inclusion of sample data and expected results. As it stands seems pretty simple for a script to loop through a range and aggregating the relevant values. Then on each loop you can check if the total value exceeds your user defined amount. If it does you can output your results on the right line and reset your counters. Hope this points you in the right direction."}, {"owner": {"reputation": 53, "user_id": 2825230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd595cec9ff632d758be27689fcbf789?s=128&d=identicon&r=PG", "display_name": "Haagimus", "link": "https://stackoverflow.com/users/2825230/haagimus"}, "edited": false, "score": 0, "creation_date": 1447864322, "post_id": 33764184, "comment_id": 55337570, "body": "<a href=\"https://goo.gl/eDI1tH\" rel=\"nofollow noreferrer\">goo.gl/eDI1tH</a>  All this work is manually done in the example. Column A has the current velocity total, Column B is irrelevant for this, Column C has the estimated totals, Column D is hidden but just counts whether B is a number or not, Column E displays a count total where the included items get as close to the velocity without going over and Column F is that total."}], "owner": {"reputation": 53, "user_id": 2825230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd595cec9ff632d758be27689fcbf789?s=128&d=identicon&r=PG", "display_name": "Haagimus", "link": "https://stackoverflow.com/users/2825230/haagimus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1447784188, "creation_date": 1447784188, "question_id": 33764184, "link": "https://stackoverflow.com/questions/33764184/running-count-of-rows-that-have-a-sum-less-than-a-user-defined-amount", "title": "Running count of rows that have a sum less than a user defined amount", "body": "<p>I have an excel spreadsheet that uses a numbered scale to estimate a level of effort associated with that particular task. I need to be able to calculate a running sum of those items until I go beyond that number, and not include the one that goes beyond in the count. I then need to total up the number of rows included in the sum until that point. I then need to identify that last item, probably by highlighting that row, then start the operation again for the remaining items below. This should continue until I have gone through all items in the spreadsheet.</p>\n\n<p>I know the question is sort of confusing. The level of effort is used as a calculation to determine the amount of work that can be completed in a production cycle. that total number is used to estimate how many items can be completed in the upcoming production cycles, hence user defined amount as this number will change each cycle. The reason I need to be able to identify how many items are included and highlight the row is so we can determine \"Milestones\" so we can tell our customer, next milestone we can get you all the following items.</p>\n\n<p>I honestly have no idea where to even start with this issue, I know I will need to complete this task in VBA most likely which is fine I am very comfortable with VBA. I am supposing I need to use it like an on demand function through a button click or something that will first generate a database of the items that exist then run SQL queries to get me where i need to be. Any help anyone can provide would be vastly appreciated and thanks in advance to anyone that has ideas.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1447783364, "post_id": 33763870, "comment_id": 55295464, "body": "Look into the Worksheet_calculate event."}, {"owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447787000, "post_id": 33763870, "comment_id": 55297562, "body": "That helped but please see my edit.  I put in some MsgBox&#39;s so I know it&#39;s entering the proper condition but the shape color doesn&#39;t change."}, {"owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447787106, "post_id": 33763870, "comment_id": 55297617, "body": "Figured it out, it needs to be <code>Fill.ForeColor</code>.  Please post an answer and I will aCcept."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1447787164, "post_id": 33763870, "comment_id": 55297661, "body": "Glad I could help.  A formal answer is not needed. Enjoy."}], "answers": [{"tags": [], "owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "is_accepted": false, "score": 1, "last_activity_date": 1447787448, "last_edit_date": 1495539874, "creation_date": 1447787448, "answer_id": 33765129, "question_id": 33763870, "link": "https://stackoverflow.com/questions/33763870/update-color-of-shape-based-on-cell-with-calculated-value/33765129#33765129", "title": "Update color of shape based on cell with calculated value", "body": "<p>There were two problems.</p>\n\n<p>1) As pointed out by <a href=\"https://stackoverflow.com/users/4851590/scott-craner\">Scott Craner</a>, I needed to use the <code>Worksheet_Calculate</code> event.</p>\n\n<p>2) Due to the style of the shape, <code>Fill.BackColor</code> was not working.  I changed it to <code>Fill.ForeColor</code> and now it works.</p>\n\n<p>Here is the working code:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    If Sheets(\"Dashboard\").Range(\"Z11\").Value &gt; 0 Then\n        Sheets(\"Dashboard\").Shapes(\"tileOverdueTasks\").Fill.ForeColor.RGB = RGB(185, 0, 0)\n    Else\n        Sheets(\"Dashboard\").Shapes(\"tileOverdueTasks\").Fill.ForeColor.RGB = RGB(0, 185, 0)\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 589, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1447787448, "creation_date": 1447783157, "last_edit_date": 1531161705, "question_id": 33763870, "link": "https://stackoverflow.com/questions/33763870/update-color-of-shape-based-on-cell-with-calculated-value", "title": "Update color of shape based on cell with calculated value", "body": "<p>Scenario: I have a dashboard with tiles for things such as \"Overdue Tasks\".  I have a shape called <code>tileOverdueTasks</code>.  On top of it I have a wordart with a value of <code>=Z11</code>.  Cell Z11 is calculated based on values in a <em>separate</em> sheet (<code>Sheet5 (Tasks)</code>).  If <code>Tasks.Z11 = 0</code> I want <code>tileOverdueTasks</code> to be green.  If it's anything else, I want it to be red.  </p>\n\n<p>I found the code below but it does not seem to trigger, I'm assuming due to the fact that cell Z11 is not being changed manually and thus neither is the <code>ActiveWorkbook</code>.  So, how can I modify this to work given the scenario above?  </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not Intersect(Target, Range(\"Z11\")) Is Nothing Then\n        If IsNumeric(Target.Value) Then\n            If Target.Value &gt; 0 Then\n                ActiveSheet.Shapes(\"tileOverdueTasks\").Fill.BackColor.RGB = vbRed\n            Else\n                ActiveSheet.Shapes(\"tileOverdueTasks\").Fill.BackColor.RGB = vbGreen\n            End If\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>UPDATE: I have changed the event to <code>Worksheet.calculate</code> as suggested by @Scott Craner.  Now the event fires and it even enters the proper condition, however the color is not changing.</p>\n"}, {"tags": ["excel", "vba", "validation"], "comments": [{"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1447785427, "post_id": 33763813, "comment_id": 55296667, "body": "I would have to agree - a custom formula is probably required.  I am thinking something like the following:  <code>&quot;=OR(NOT(ISERROR(MATCH(&quot;&amp;Target.Address&amp;&quot;,&quot;&amp;strRange&amp;&quot;,0))),&zwnj;&#8203;IFERROR(AND(INT(&quot;&amp;Ta&zwnj;&#8203;rget.Address&amp;&quot;)=&quot;&amp;Ta&zwnj;&#8203;rget.Address&amp;&quot;,&quot;&amp;Tar&zwnj;&#8203;get.Address&amp;&quot;&gt;0,&quot;&amp;Ta&zwnj;&#8203;rget.Address&amp;&quot;&lt;257),&zwnj;&#8203;0))&quot;</code>  I have not tested it, but hopefully the idea is clear."}, {"owner": {"reputation": 602, "user_id": 4610896, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-Qrw6GiFiAkI/AAAAAAAAAAI/AAAAAAAACQU/xzC1jaiRrpw/photo.jpg?sz=128", "display_name": "Michaela Ervin", "link": "https://stackoverflow.com/users/4610896/michaela-ervin"}, "reply_to_user": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1447797435, "post_id": 33763813, "comment_id": 55303365, "body": "Thank you, the idea did help, I had to customize it a bit due to a couple details I left out.    <code>strValidation = &quot;=OR(NOT(ISERROR(MATCH(&quot; &amp; Target.Address &amp; &quot;, Lookups!&quot; &amp; strRange &amp; &quot;, 0))), IFERROR(ISNUMBER(INT(&quot; &amp; Cells(Target.row, Target.Column).Address &amp; &quot;)), FALSE))&quot; </code>"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1447803380, "post_id": 33763813, "comment_id": 55305961, "body": "@Demetri can you kindly add your suggestion as an answer so Michaela can mark this post as answered? Regards"}], "answers": [{"tags": [], "owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "is_accepted": true, "score": 0, "last_activity_date": 1447875411, "last_edit_date": 1447875411, "creation_date": 1447866585, "answer_id": 33786157, "question_id": 33763813, "link": "https://stackoverflow.com/questions/33763813/validation-based-on-multiple-criteria/33786157#33786157", "title": "Validation based on multiple criteria", "body": "<p>The original suggested solution, was the below custom formula:</p>\n\n<pre><code>\"=OR(NOT(ISERROR(MATCH(\"&amp;Target.Address&amp;\",\"&amp;strRange&amp;\",0))),IFERROR(AND(INT(\"&amp;T\u200c\u200barget.Address&amp;\")=\"&amp;Target.Address&amp;\",\"&amp;Target.Address&amp;\"&gt;0,\"&amp;Target.Address&amp;\"&lt;257),\u200c\u200b0))\"\n</code></pre>\n\n<p>which Michaela expanded on for her solution:</p>\n\n<pre><code>strValidation = \"=OR(NOT(ISERROR(MATCH(\" &amp; Target.Address &amp; \", Lookups!\" &amp; strRange &amp; \", 0))), IFERROR(ISNUMBER(INT(\" &amp; Cells(Target.row, Target.Column).Address &amp; \")), FALSE))\" \n</code></pre>\n\n<p>EDIT: I used to above first but then figured out how to edit your answer to completely fill my needs.  The problem was that Target.Address is two merged cells so the value was always blank.  The following fixed it while using (almost) your original solution.</p>\n\n<pre><code>strValidation = \"=OR(NOT(ISERROR(MATCH(\" &amp; Target.Address &amp; \", Lookups!\" &amp; strRange &amp; \", 0))), IFERROR(AND(INT(\" &amp; Cells(Target.row, Target.Column).Address &amp; \") &gt; 0, INT(\" &amp; Cells(Target.row, Target.Column).Address &amp; \") &lt; 257), FALSE))\"\n</code></pre>\n"}], "owner": {"reputation": 602, "user_id": 4610896, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-Qrw6GiFiAkI/AAAAAAAAAAI/AAAAAAAACQU/xzC1jaiRrpw/photo.jpg?sz=128", "display_name": "Michaela Ervin", "link": "https://stackoverflow.com/users/4610896/michaela-ervin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 33786157, "answer_count": 1, "score": 0, "last_activity_date": 1447875411, "creation_date": 1447782965, "last_edit_date": 1447789797, "question_id": 33763813, "link": "https://stackoverflow.com/questions/33763813/validation-based-on-multiple-criteria", "title": "Validation based on multiple criteria", "body": "<p>I am trying to use Excel .Validation to validate a field based on two criteria:  </p>\n\n<p>1) value is in a range  OR   2) value is whole number.  </p>\n\n<p>I am getting compile errors when I try to do 2 .Add calls\nI am starting to think I may have to use a custom formula.</p>\n\n<p>Can someone help me with a custom formula that will check to see if the value is in the range strRange OR a number between 1 and 256?</p>\n\n<pre><code>ElseIf Target.Column &gt;= BaseColIndex And Target.Column Mod 2 &gt; 0 And Cells(10, Target.Column).Value &lt;&gt; \"\" Then\n    strNormOper = Cells(10, Target.Column).Value\n    strRange = IIf(strNormOper = \"open\", \"$AC2:$AC5\", \"$AE2:$AE5\")\n    strValidation = \"=\" &amp; Worksheets(\"Lookups\").name &amp; \"!\" &amp; strRange\n    With Target.Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Formula1:=strValidation\n        .Add Type:=xlValidateWholeNumber, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=\"1\", Formula2:=\"256\"\n        .IgnoreBlank = True\n        .ErrorTitle = \"Validation Error\"\n        .ErrorMessage = \"Must be the opposite of 'Normal Operation' for this output Or a number in the range 1 To 256.\"\n        .ShowError = True\n    End With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1447781294, "post_id": 33763269, "comment_id": 55294245, "body": "A screenshot or depiction of your data would be helpful, as well as any attempt at the code you have tried to this point.  So is not a &quot;Code for Me site&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5357807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934e1248acccceba0931594d0386e293?s=128&d=identicon&r=PG&f=1", "display_name": "Nolage86", "link": "https://stackoverflow.com/users/5357807/nolage86"}, "edited": false, "score": 0, "creation_date": 1447869292, "post_id": 33771966, "comment_id": 55340864, "body": "tried running the code you graciously provided but I keep getting the error: Compile error: Method or data member not found. Any ideas as to why?"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 23, "user_id": 5357807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934e1248acccceba0931594d0386e293?s=128&d=identicon&r=PG&f=1", "display_name": "Nolage86", "link": "https://stackoverflow.com/users/5357807/nolage86"}, "edited": false, "score": 0, "creation_date": 1447869406, "post_id": 33771966, "comment_id": 55340924, "body": "does it highlights any line?"}, {"owner": {"reputation": 23, "user_id": 5357807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934e1248acccceba0931594d0386e293?s=128&d=identicon&r=PG&f=1", "display_name": "Nolage86", "link": "https://stackoverflow.com/users/5357807/nolage86"}, "edited": false, "score": 0, "creation_date": 1447869454, "post_id": 33771966, "comment_id": 55340954, "body": "sorry I forgot to mention that! Yes, the very first line."}, {"owner": {"reputation": 23, "user_id": 5357807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934e1248acccceba0931594d0386e293?s=128&d=identicon&r=PG&f=1", "display_name": "Nolage86", "link": "https://stackoverflow.com/users/5357807/nolage86"}, "edited": false, "score": 0, "creation_date": 1447869475, "post_id": 33771966, "comment_id": 55340969, "body": "Sub Rng_Charts_Add_Multiple()"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 23, "user_id": 5357807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934e1248acccceba0931594d0386e293?s=128&d=identicon&r=PG&f=1", "display_name": "Nolage86", "link": "https://stackoverflow.com/users/5357807/nolage86"}, "edited": false, "score": 0, "creation_date": 1447869641, "post_id": 33771966, "comment_id": 55341064, "body": "Ni idea... Did you copy the procedure in a new module?"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 23, "user_id": 5357807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934e1248acccceba0931594d0386e293?s=128&d=identicon&r=PG&f=1", "display_name": "Nolage86", "link": "https://stackoverflow.com/users/5357807/nolage86"}, "edited": false, "score": 0, "creation_date": 1447869966, "post_id": 33771966, "comment_id": 55341248, "body": "That&#39;s weird... let&#39;s try this select all (Ctrl+A) in the module and comment  (Comment block) then Compile VBA project. It should compile OK. After this Uncomment all then compile again...."}, {"owner": {"reputation": 23, "user_id": 5357807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934e1248acccceba0931594d0386e293?s=128&d=identicon&r=PG&f=1", "display_name": "Nolage86", "link": "https://stackoverflow.com/users/5357807/nolage86"}, "edited": false, "score": 0, "creation_date": 1447870644, "post_id": 33771966, "comment_id": 55341637, "body": "compiled well. after uncommenting and compiling, the error came on again."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 23, "user_id": 5357807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934e1248acccceba0931594d0386e293?s=128&d=identicon&r=PG&f=1", "display_name": "Nolage86", "link": "https://stackoverflow.com/users/5357807/nolage86"}, "edited": false, "score": 0, "creation_date": 1447870915, "post_id": 33771966, "comment_id": 55341798, "body": "have no idea. try changing the name of the procedure. If this does not work, could you share your file so I can look at it. The code has nothing out of the ordinary... and it seems like excel is expecting that procedure to be something else..."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 23, "user_id": 5357807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934e1248acccceba0931594d0386e293?s=128&d=identicon&r=PG&f=1", "display_name": "Nolage86", "link": "https://stackoverflow.com/users/5357807/nolage86"}, "edited": false, "score": 0, "creation_date": 1447872109, "post_id": 33771966, "comment_id": 55342510, "body": "I found this <a href=\"http://stackoverflow.com/questions/27411399/microsoft-excel-activex-controls-disabled\">VBA - Compile Error - Method or Data member not Found</a> Did you run any update lately?"}, {"owner": {"reputation": 23, "user_id": 5357807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934e1248acccceba0931594d0386e293?s=128&d=identicon&r=PG&f=1", "display_name": "Nolage86", "link": "https://stackoverflow.com/users/5357807/nolage86"}, "edited": false, "score": 0, "creation_date": 1447872270, "post_id": 33771966, "comment_id": 55342597, "body": "Changing name didn&#39;t fix it either. Unfortunately, my work computer restricts where and what I can do online so I can&#39;t use file sharing extensions or systems. However, the sample I posted in my initial post is exactly how my data is arranged. I just have many more columns. You know I was also thinking it is probably my version of excel (2007), but I am unsure. I updated Java yesterday and that&#39;s all. It probably would work on my personal computer with a newer version. I will try it when I get home. The info on the link might be helpful. I will go through that as well. I&#39;d give you a feedback"}, {"owner": {"reputation": 23, "user_id": 5357807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934e1248acccceba0931594d0386e293?s=128&d=identicon&r=PG&f=1", "display_name": "Nolage86", "link": "https://stackoverflow.com/users/5357807/nolage86"}, "edited": false, "score": 0, "creation_date": 1447872456, "post_id": 33771966, "comment_id": 55342719, "body": "I usually have issues with R on my work computer as well. I am somewhat certain it would run on my personal computer. Appreciate the code, I will get back to you on my findings"}, {"owner": {"reputation": 23, "user_id": 5357807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934e1248acccceba0931594d0386e293?s=128&d=identicon&r=PG&f=1", "display_name": "Nolage86", "link": "https://stackoverflow.com/users/5357807/nolage86"}, "edited": false, "score": 0, "creation_date": 1447882787, "post_id": 33771966, "comment_id": 55348930, "body": "Aren&#39;t you the best? It worked on my personal computer! I told ya! Thank you again, EEM!"}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 0, "last_activity_date": 1447821529, "creation_date": 1447821529, "answer_id": 33771966, "question_id": 33763269, "link": "https://stackoverflow.com/questions/33763269/excel-macro-to-get-separate-graphs-of-many-ys-with-the-same-xs/33771966#33771966", "title": "Excel macro to get SEPARATE graphs of many Ys with the same Xs", "body": "<p>The procedure below create a chart in a separated sheet for each of the columns from <code>B</code> to <code>L</code> using column <code>A</code> as a common horizontal axis.</p>\n\n<pre><code>Sub Rng_Charts_Add_Multiple()\nConst kChrTtl As String = \"Yield by group \"\nDim Wbk As Workbook, WshSrc As Worksheet\nDim rSrc As Range, Chrt As Chart\nDim sCol As String, bCol As Byte\n\n    Rem Application Settings\n    Application.EnableEvents = False\n    Application.DisplayAlerts = False\n    Application.ScreenUpdating = False\n\n    Set Wbk = ThisWorkbook\n    Set WshSrc = Wbk.Sheets(\"Sht(1)\")\n    Application.Goto WshSrc.Cells(1), 1\n    Set rSrc = WshSrc.Cells(1).CurrentRegion\n\n    For bCol = 2 To rSrc.Columns.Count\n\n        Rem Add Chart in a New Sheet\n        sCol = rSrc.Cells(1, bCol).Value2\n        With Wbk\n            On Error Resume Next\n            .Sheets(\"Chart \" &amp; sCol).Delete\n            On Error GoTo 0\n            Application.Goto WshSrc.UsedRange.SpecialCells(xlCellTypeLastCell).Offset(2, 2)\n            Set Chrt = .Charts.Add2(After:=.Sheets(.Sheets.Count), NewLayout:=1)\n        End With\n\n        Rem Chart Settings\n        With Chrt\n            .name = \"Chart \" &amp; sCol\n            .ApplyLayout (1)\n            .ChartTitle.Text = kChrTtl &amp; sCol\n            .ChartType = xlColumnClustered\n            .SetSourceData Source:=Union(rSrc.Columns(1), rSrc.Columns(bCol))\n\n    End With: Next\n\n    Rem Application Settings\n    Application.EnableEvents = True\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Suggest to visit the following pages:</p>\n\n<p><a href=\"http://www.excelfunctions.net/VBA-Variables-And-Constants.html\" rel=\"nofollow\">Variables &amp; Constants</a>, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194565.aspx\" rel=\"nofollow\">Application Object (Excel)</a>, <a href=\"http://www.excelfunctions.net/Excel-Objects.html\" rel=\"nofollow\">Excel Objects</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264723.aspx\" rel=\"nofollow\">With Statement</a>, <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg251601.aspx\" rel=\"nofollow\">For...Next Statement</a>, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range Object (Excel)</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/EN-US/library/office/ff194464.aspx\" rel=\"nofollow\">Worksheet Object (Excel)</a>, <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff836747.aspx\" rel=\"nofollow\">ChartObjects Members (Excel)</a></p>\n"}], "owner": {"reputation": 23, "user_id": 5357807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934e1248acccceba0931594d0386e293?s=128&d=identicon&r=PG&f=1", "display_name": "Nolage86", "link": "https://stackoverflow.com/users/5357807/nolage86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 33771966, "answer_count": 1, "score": 1, "last_activity_date": 1447821529, "creation_date": 1447781178, "last_edit_date": 1531164843, "question_id": 33763269, "link": "https://stackoverflow.com/questions/33763269/excel-macro-to-get-separate-graphs-of-many-ys-with-the-same-xs", "title": "Excel macro to get SEPARATE graphs of many Ys with the same Xs", "body": "<p>I have a data set in which the first column is the x but the other columns (> 50) are the Ys. There are 6 rows. I know I can plot all the Ys on the same axis in the same chart, but I need separate graphs of Y all with the same x. However, I am clueless if it is possible to have an excel macro that will allow me to plot DIFFERENT bar graphs  for as many Ys all at once. Doing it manually is a pain because I have many datasets with these dimensions. \nAny help would be greatly appreciated. Below is the code I used but it plotted all the bars in a single graph. Found this code online and tweaked it</p>\n\n<pre><code>Sheets(\"sheet1\").Select\n ActiveSheet.Shapes.AddChart.Select\n With ActiveChart\n .ChartType = xlColumnClustered\n.SetSourceData Source:=Sheets(\"sheet1\").Range(\"A1:D7\")  'sets source  data for graph including labels\n.SetElement (msoElementLegendRight)  'including legend\n.HasTitle = True\n'dimentions &amp; location:\n.Parent.Left = 47   'defines the coordinates for the left side of the chart\n.Parent.Height = 300\n.Parent.Width = 600\n.ChartTitle.Text = \"Yield by group \" &amp; intGraphStart\nEnd With\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/aPyxY.jpg\" rel=\"nofollow\">A sample</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1447781248, "post_id": 33763180, "comment_id": 55294214, "body": "<code>StrX = Range(Cells(NSLRow + 1, 1), Cells(NSLRow + 1, 6)).Address</code> You haven&#39;t determined what sheet"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1447781510, "post_id": 33763180, "comment_id": 55294375, "body": "he references the sheet in the next line, that was my 1st thought"}, {"owner": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1447781957, "post_id": 33763180, "comment_id": 55294656, "body": "@Nathan_Sav So? Doesn&#39;t mean Excel will treat everything around as that sheet. He still has several Range and Cell calls that do not explicitly name a sheet. Nobody knows what those are referencing. It might be useful if OP put a breakpoint on the <code>If Instr...</code> line to check values of <code>Cells(i,1)</code> and <code>NSLRow</code>."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1447782168, "post_id": 33763180, "comment_id": 55294769, "body": "<i>I am having trouble actually getting the results</i> - what results do you expect and what results do you get? A screen shot of expected versus actual results may help us help you better."}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "edited": false, "score": 0, "creation_date": 1447782709, "post_id": 33763180, "comment_id": 55295081, "body": "Hi the results I expect are  almost like a transpose:  A1, First name , A2 Last name, <b>Result:</b> A1 First Name, B1, Last Name.  However sometimes they may not be a last name. Thus it must be able to skip that and go to A2 and start with first name again. Is this clearer?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "edited": false, "score": 1, "creation_date": 1447782935, "post_id": 33763180, "comment_id": 55295224, "body": "To add to @MarkBalhoff&#39;s comment, specify the sheets each time you use <code>Range(Cells(),Cells())</code> to remove any ambiguity: <code>StrX = OSheet.Range(OSheet.Cells(NSLRow + 1, 7), OSheet.Cells(NSLRow + 1, 8)).Address</code>. (I&#39;m assuming you want to use <code>OSheet</code>&#39;s range...)"}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "edited": false, "score": 0, "creation_date": 1447783244, "post_id": 33763180, "comment_id": 55295399, "body": "Hi all, I added a picture of the expected result, except the result will occur on another page."}, {"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1447783550, "post_id": 33763180, "comment_id": 55295564, "body": "Does the picture represent your data? Why do you use a range of six columns then? (StrX = Range(Cells(NSLRow + 1, 1), Cells(NSLRow + 1, 6)).Address)"}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447783627, "post_id": 33763180, "comment_id": 55295619, "body": "@BruceWayne, I added OSheet infront of my range cells and get &#39;invalid qualifier&#39;"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1447783669, "post_id": 33763180, "comment_id": 55295650, "body": "You&#39;d have to add <code>Sheets(oSheet)</code>, since <code>oSheet</code> is a string, not an object."}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "reply_to_user": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1447783685, "post_id": 33763180, "comment_id": 55295659, "body": "@MoritzSchmitzv.H&#252;lst , no its just a sample. It should be Entire.Row actually :( . But usually I only need about 6 columns or less pasted."}, {"owner": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1447783695, "post_id": 33763180, "comment_id": 55295666, "body": "@BruceWayne was writing it as if OSheet is a Worksheet variable. Yours is a string so Sheets(oSheet)"}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1447783835, "post_id": 33763180, "comment_id": 55295740, "body": "@DavidZemens Hi David, I added sheets to every Osheet, still no results, ill post updated code."}, {"owner": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "edited": false, "score": 0, "creation_date": 1447784551, "post_id": 33763180, "comment_id": 55296130, "body": "Nothing? Are you sure you are looking in the right place? I copied your updated code into a VBA module and put three rows of names in column B and either &quot;first name&quot; or &quot;last name&quot; in column A. After running the macro both Column A and B were copied over to the other sheet. At least the copy appears to be happening on my end."}, {"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1447784882, "post_id": 33763180, "comment_id": 55296344, "body": "I still don&#39;t understand what your actual results look like at the moment."}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "reply_to_user": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1447787033, "post_id": 33763180, "comment_id": 55297579, "body": "@MoritzSchmitzv.H&#252;lst , my results arent the way i expected, it doesnt take all the data over. and they are still in the same format."}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "reply_to_user": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "edited": false, "score": 0, "creation_date": 1447787334, "post_id": 33763180, "comment_id": 55297759, "body": "@MarkBalhoff , It seems to work but its not in the format I would like from the picture I posted above"}, {"owner": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "edited": false, "score": 0, "creation_date": 1447790342, "post_id": 33763180, "comment_id": 55299465, "body": "I&#39;m confused as to what part of your code you thought would perform the transposition. Have you not yet tried to implement that part?"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "edited": false, "score": 0, "creation_date": 1447791089, "post_id": 33765971, "comment_id": 55299856, "body": "Awesome! Thank you. I am sorry for the confusion.  Where in this code can I change the columns to copy? Which parts in your explanation did you mean?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "edited": false, "score": 0, "creation_date": 1447791343, "post_id": 33765971, "comment_id": 55300012, "body": "@Ladiesman191 I changed it for you, the only thing you need to change is the number of columns you wish to copy.  Change the line<code>cpyClm = 1</code> to what ever number you want."}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "edited": false, "score": 0, "creation_date": 1447793187, "post_id": 33765971, "comment_id": 55301038, "body": "so 1=a, 2=b?  yes it did. What did you change from your original answer? I used the original answer and that worked."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "edited": false, "score": 0, "creation_date": 1447793310, "post_id": 33765971, "comment_id": 55301104, "body": "yes 1 = first column or column A, 2 = second column or column B"}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "edited": false, "score": 0, "creation_date": 1447860496, "post_id": 33765971, "comment_id": 55334664, "body": "does this number refer to the amount of columns being copied or the ones being pasted?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "edited": false, "score": 0, "creation_date": 1447860970, "post_id": 33765971, "comment_id": 55335014, "body": "the variable <code>cpyClm</code> refers to # of columns to be copied, and is also used to space the pasting.  so if cpyclm is 6 it will copy 6 columns and in the first if past it in the (1)st column, in the second if statement it will move over to the (1 + 6)th column to paste.  In the third it moves over to the (1 + (6 * 2))th column.  This way no mater what <code>cpyClm</code> equals it will paste it correctly.  If you want a forth if you will need to multiply cpyClm by 3 and add 1 to get it to go to the correct place."}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "edited": false, "score": 0, "creation_date": 1447870472, "post_id": 33765971, "comment_id": 55341546, "body": "So add 4th criteria would be the same just change cpyclm to * 3,  where do I add the 1?"}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "edited": false, "score": 0, "creation_date": 1447960126, "post_id": 33765971, "comment_id": 55390118, "body": "Sorry to bother you Scott, but how would you change the column extracting or copying the data from? instead of it being col A."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "edited": false, "score": 0, "creation_date": 1447960889, "post_id": 33765971, "comment_id": 55390611, "body": "@Ladiesman191 I modified the code slightly,  You can now see where it refers to column A,  Change the <code>&quot;A&quot;</code> to what ever column you want like <code>&quot;B&quot;</code>"}, {"owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "edited": false, "score": 0, "creation_date": 1448036628, "post_id": 33765971, "comment_id": 55427961, "body": "thanks Scott, also when it searches a name ex &#39;first name&#39;, does it search every column or just in column A?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "edited": false, "score": 0, "creation_date": 1448036757, "post_id": 33765971, "comment_id": 55428044, "body": "Column A only. that is what the 1 in <code>InStr(LCase(.Cells(i, 1))</code> dictates.  Row i column 1.  Since column A is the first column that is what is being searched."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1447960811, "last_edit_date": 1447960811, "creation_date": 1447790685, "answer_id": 33765971, "question_id": 33763180, "link": "https://stackoverflow.com/questions/33763180/copy-paste-results/33765971#33765971", "title": "Copy/Paste results", "body": "<p>This will work for your example:</p>\n\n<pre><code>    Sub stackv2()\n\n    Dim OSheet As Worksheet\n    Dim NSheet As Worksheet\n    Dim i As long\n    Dim LRow As long\n    Dim NSLRow As Long\n    Dim cpyClm As Long\n\n    Set OSheet = Sheets(\"Sheet1\") 'change to your Old Sheet Name\n    Set NSheet = Sheets(\"Sheet7\") 'change to your New Sheet Name\n    cpyClm = 1 'change this to the number columns desired\n\n    'Finds last row in the New Sheet\n    NSLRow = NSheet.Cells(NSheet.Rows.Count, 1).End(xlUp).Row\n\n    With OSheet\n        LRow = .Cells(.Rows.Count, 1).End(xlUp).Row 'Last Row in Old Sheet\n\n        For i = 2 To LRow\n\n            'If cell has \"First Name then...\"\n\n            If InStr(LCase(.Cells(i, 1)), LCase(\"first name\")) Then\n                NSLRow = NSLRow + 1 'moves to new row every time this is true.\n                NSheet.Cells(NSLRow, 1).Resize(, cpyClm).Value = .Cells(i, \"A\").Resize(, cpyClm).Value\n            ElseIf InStr(LCase(Cells(i, 1)), LCase(\"last name\")) Then\n                NSheet.Cells(NSLRow, 1 + cpyClm).Resize(, cpyClm).Value = .Cells(i, \"A\").Resize(, cpyClm).Value\n            ElseIf InStr(LCase(Cells(i, 1)), LCase(\"middle name\")) Then\n                NSheet.Cells(NSLRow, 1 + (cpyClm * 2)).Resize(, cpyClm).Value = .Cells(i, \"A\").Resize(, cpyClm).Value\n            End If\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>But because we don't know what your true data looks like I put the ability to change the number of columns to copy.  Also since your example does not include column A, and your explanation wants it you will need to change the column in the cells to 1 instead of 2</p>\n\n<p>If this does not work or help you figure out how to adjust it on your own, you will need to post an actual representation of your data and desired output.</p>\n"}], "owner": {"reputation": 63, "user_id": 5347590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a4f10551243350e0fb9d8c1df2a01aa?s=128&d=identicon&r=PG&f=1", "display_name": "Ladiesman191", "link": "https://stackoverflow.com/users/5347590/ladiesman191"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 33765971, "answer_count": 1, "score": 0, "last_activity_date": 1447960811, "creation_date": 1447780849, "last_edit_date": 1447783927, "question_id": 33763180, "link": "https://stackoverflow.com/questions/33763180/copy-paste-results", "title": "Copy/Paste results", "body": "<p>I got the following code, which is supposed to </p>\n\n<p>1) Search for my word, copy and paste the entire row that contains the word into new sheet</p>\n\n<p>2) Search for a word after the 1st, then copy and paste that entire row beside the contents of 1) in the new sheet.</p>\n\n<p>Could someone take a look, I am having trouble actually getting the results, there is no error I am getting. So I assume it is the whole copy and paste to my new sheet name. However i am not 100% sure.</p>\n\n<pre><code>Sub stack()\n\n    Dim OSheet As String\n    Dim NSheet As String\n    Dim i As Integer\n    Dim LRow As Integer\n    Dim NSLRow As Integer\n\n    OSheet = \"Sheet1\" 'Old Sheet Name\n    NSheet = \"Sheet7\" 'New Sheet Name\n\n    LRow = Sheets(OSheet).Cells(Rows.Count, 1).End(xlUp).Row 'Last Row in Old Sheet\n\n    Sheets(OSheet).Activate\n\n    For i = 2 To LRow\n         'Finds last row in the New Sheet\n        If Sheets(NSheet).Cells(2, 1) = \"\" Then\n            NSLRow = 1\n        Else\n            NSLRow = Sheets(NSheet).Cells(Rows.Count, 1).End(xlUp).Row\n        End If\n\n         'If cell has \"First Name then...\"\n      Dim StrX As String\n    If InStr(LCase(Cells(i, 1)), LCase(\"stack:\")) Then\n        StrX = Range(Cells(NSLRow + 1, 1), Cells(NSLRow + 1, 6)).Address\n        Sheets(NSheet).Range(StrX).Value = Range(StrX).Value\n    ElseIf InStr(LCase(Cells(i, 1)), LCase(\"overflow:\")) Then\n        StrX = Range(Cells(NSLRow + 1, 7), Cells(NSLRow + 1, 8)).Address\n        Sheets(NSheet).Range(StrX).Value = Range(StrX).Value\n    End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>EDIT, Expected result:</p>\n\n<p>!<a href=\"http://i.imgur.com/69elWuB.jpg\" rel=\"nofollow\">http://i.imgur.com/69elWuB.jpg</a></p>\n\n<p>EDIT, updated code with some fixes you guys mentioned.</p>\n\n<pre><code>Sub stackv2()\n     'added Sheets(OSheets)to Range Cells\n    Dim OSheet As String\n    Dim NSheet As String\n    Dim i As Integer\n    Dim LRow As Integer\n    Dim NSLRow As Integer\n\n    OSheet = \"Sheet1\" 'Old Sheet Name\n    NSheet = \"Sheet7\" 'New Sheet Name\n\n    LRow = Sheets(OSheet).Cells(Rows.Count, 1).End(xlUp).Row 'Last Row in Old Sheet\n\n    Sheets(OSheet).Activate\n\n    For i = 2 To LRow\n         'Finds last row in the New Sheet\n        If Sheets(NSheet).Cells(2, 1) = \"\" Then\n            NSLRow = 1\n        Else\n            NSLRow = Sheets(NSheet).Cells(Rows.Count, 1).End(xlUp).Row\n        End If\n\n         'If cell has \"First Name then...\"\n      Dim StrX As String\n    If InStr(LCase(Cells(i, 1)), LCase(\"first name\")) Then\n        StrX = Sheets(OSheet).Range(Sheets(OSheet).Cells(NSLRow + 1, 1), Sheets(OSheet).Cells(NSLRow + 1, 6)).Address\n        Sheets(NSheet).Range(StrX).Value = Range(StrX).Value\n    ElseIf InStr(LCase(Cells(i, 1)), LCase(\"last name\")) Then\n        StrX = Sheets(OSheet).Range(Sheets(OSheet).Cells(NSLRow + 1, 7), Sheets(OSheet).Cells(NSLRow + 1, 8)).Address\n        Sheets(NSheet).Range(StrX).Value = Range(StrX).Value\n    End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "gif", "ms-access-2013"], "answers": [{"comments": [{"owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "edited": false, "score": 0, "creation_date": 1447862552, "post_id": 33779665, "comment_id": 55336295, "body": "The users <b>shouldn&#39;t</b> care, but they are a sucker for &quot;pretty visuals&quot;. But thank you for your answer."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1447848490, "creation_date": 1447848490, "answer_id": 33779665, "question_id": 33763123, "link": "https://stackoverflow.com/questions/33763123/how-do-i-achieve-an-animated-gif-in-ms-access-while-queries-are-running/33779665#33779665", "title": "How do I achieve an animated gif in MS Access while queries are running?", "body": "<p>You are hosed. Access is single-threaded, so while it is busy doing something (running a query) it won't do something else (animating a GIF).</p>\n\n<p>Display a static picture. The users don't care anyway.</p>\n"}, {"tags": [], "owner": {"reputation": 439, "user_id": 6680522, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-hn8z_yBSg5s/AAAAAAAAAAI/AAAAAAAABUs/wLehDv9E_nk/photo.jpg?sz=128", "display_name": "Paulo Henrique", "link": "https://stackoverflow.com/users/6680522/paulo-henrique"}, "is_accepted": false, "score": 2, "last_activity_date": 1471460483, "creation_date": 1471460483, "answer_id": 39004378, "question_id": 33763123, "link": "https://stackoverflow.com/questions/33763123/how-do-i-achieve-an-animated-gif-in-ms-access-while-queries-are-running/39004378#39004378", "title": "How do I achieve an animated gif in MS Access while queries are running?", "body": "<p>I know this is old but, I'm working around on this with two databases. One does the major work and another is responsible for JUST showing a form with a loading image, percentage of progress and current action.</p>\n\n<p>The 2nd form is binded into a table, refreshed using the OnTimer event (I also use OnTimer to animate my picturebox).</p>\n\n<p>This table should be linked with my primary database, and it is updated with the query progress data.</p>\n\n<p>You can use some code for hiding the 2nd Access (just displaying the form).</p>\n\n<p>This way I can give a much better user experience.</p>\n\n<p>Best,</p>\n"}], "owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1665, "favorite_count": 0, "accepted_answer_id": 33779665, "answer_count": 2, "score": 1, "last_activity_date": 1471460483, "creation_date": 1447780685, "last_edit_date": 1447797386, "question_id": 33763123, "link": "https://stackoverflow.com/questions/33763123/how-do-i-achieve-an-animated-gif-in-ms-access-while-queries-are-running", "title": "How do I achieve an animated gif in MS Access while queries are running?", "body": "<p>This  the method I tried and it does not work:</p>\n\n<ol>\n<li>I have a LoadingPopup form that pops up right before the queries start</li>\n<li>The form contains a gif in an ActiveX control</li>\n<li>The form is closed after the queries are done running</li>\n</ol>\n\n<p>What actually happens is the LoadingPopup appears and then freezes while the queries are running, so there is no animation!</p>\n\n<p>I am at a loss of what to do. What is the next best option for me?</p>\n"}]