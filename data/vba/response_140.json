[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1505344284, "post_id": 46208120, "comment_id": 79379597, "body": "How isn&#39;t it working, do you get errors? If so, what errors, where? If it doesn&#39;t give any errors, what is it doing incorrectly?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1505357248, "post_id": 46208120, "comment_id": 79382573, "body": "<a href=\"https://stackoverflow.com/a/43928128/4539709\">stackoverflow.com/a/43928128/4539709</a>"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1505357293, "post_id": 46208120, "comment_id": 79382579, "body": "<a href=\"https://stackoverflow.com/a/36672957/4539709\">stackoverflow.com/a/36672957/4539709</a>"}, {"owner": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1505402358, "post_id": 46208120, "comment_id": 79408543, "body": "@0m3r your link solved the problem that i was having.. thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1505362063, "creation_date": 1505362063, "answer_id": 46210361, "question_id": 46208120, "link": "https://stackoverflow.com/questions/46208120/vba-copy-and-paste-rows-of-data-by-salesperson-into-new-workbooks-by-salesperson/46210361#46210361", "title": "vba copy and paste rows of data by salesperson into new workbooks by salesperson", "body": "<p>Since you use Excel for Windows, tap into the JET/ACE Engine and run SQL queries since you essentially are running <code>WHERE</code> clauses on master workbook. The only challenge is you have to open two recordsets: one for all distinct <em>Sales Per</em> ids to iterate through and each time building the second recordset (applying <code>WHERE</code> condition) that dumps data to worksheets. No copy/paste or running through cells with various <code>If</code> logic with this approach.</p>\n\n<p>Below is a version tested on both connection types. Be sure to actually change <em>SheetName</em> in SQL lines and adjust <em>Sales Per</em> to full column name. Even consider moving master data to start at <code>A1</code> for a true table. Also, below shows how to parameterize a prepared SQL statement in ADO, an industry best practice when running SQL at application layer like VBA!</p>\n\n<pre><code>Sub RunSQL()\n    Dim conn As Object, rsSales As Object, rsData As Object, cmd As Object\n    Dim strConnection As String, strSales As String, strSQL As String\n    Dim new_wb As Workbook\n    Dim i As Integer\n\n    Const adcmdText = 1, adInteger = 3, adParamInput = 1\n\n    Application.ScreenUpdating = False\n\n    Set conn = CreateObject(\"ADODB.Connection\")\n    Set rsSales = CreateObject(\"ADODB.Recordset\")\n    Set rsData = CreateObject(\"ADODB.Recordset\")\n\n    ' CONNECTION STRINGS (TWO VERSIONS)\n    strConnection = \"DRIVER={Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)};\" _\n                      &amp; \"DBQ=C:\\Path\\To\\Master\\Data\\Workbook.xlsx;\"\n'    strConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" _\n'                       &amp; \"Data Source=C:\\Path\\To\\Master\\Data\\Workbook.xlsx';\" _\n'                       &amp; \"Extended Properties=\"\"Excel 12.0 Xml;HDR=YES;\"\";\"\n\n    ' OPEN DB CONNECTION\n    conn.Open strConnection\n\n    strSQL = \"SELECT * FROM [SheetName$] WHERE [Sales Per] = ?;\"\n\n    strSales = \"SELECT DISTINCT [Sales Per] FROM [SheetName$]\"\n    rsSales.Open strSales, conn\n\n    Do While Not rsSales.EOF\n        ' SET CMD COMMAND AND SETTINGS\n         Set cmd = CreateObject(\"ADODB.Command\")    \n         With cmd\n            .ActiveConnection = conn\n            .CommandText = strSQL\n            .CommandType = adcmdText\n            .CommandTimeout = 15\n        End With\n\n        ' BINDING PARAMETER\n        cmd.Parameters.Append cmd.CreateParameter(\"salesParam\", adInteger, adParamInput, , rsSales![Sales Per])\n\n        ' EXECUTING TO RECORDSET\n        Set rsData = cmd.Execute\n\n        ' OPEN NEW WORKBOOK\n        Set new_wb = Workbooks.Add()\n        ' OUTPUT DATA TO SHEET\n        With new_wb.Worksheets(\"Sheet1\")\n              .Name = \"DATA\"\n              ' COLUMN HEADERS\n              For i = 1 To rsData.Fields.Count\n                  .Cells(1, i) = rsData.Fields(i - 1).Name\n              Next i    \n              ' DATA ROWS\n              .Range(\"A2\").CopyFromRecordset rsData\n        End With\n\n        ' SAVE WORKBOOK\n        new_wb.SaveAs \"C:\\Path\\To\\Output\\Workbooks\\SalesPer_\" &amp; rsSales![Sales Per] &amp; \".xlsx\", xlWorkbookDefault\n        new_wb.Close True\n\n        rsData.Close\n        rsSales.MoveNext\n    Loop\n\n    Application.ScreenUpdating = True\n    MsgBox \"Successfully completed!\", vbInformation\n\nExitHandle:\n    rsSales.Close: conn.Close\n    Set rsSales = Nothing: Set rsData = Nothing\n    Set cmd = Nothing: Set conn = Nothing\n    Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p><em>Needless to say, consider saving master workbook in a true database and run all the queries to slice and dice as you need.</em></p>\n"}, {"tags": [], "owner": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "is_accepted": true, "score": 1, "last_activity_date": 1505466061, "last_edit_date": 1505466061, "creation_date": 1505403095, "answer_id": 46223112, "question_id": 46208120, "link": "https://stackoverflow.com/questions/46208120/vba-copy-and-paste-rows-of-data-by-salesperson-into-new-workbooks-by-salesperson/46223112#46223112", "title": "vba copy and paste rows of data by salesperson into new workbooks by salesperson", "body": "<p>Here is an answer offered by @0m3r: </p>\n\n<pre><code>Option Explicit\nSub Move_Each_Agent_to_Sheet()\n'   // Declare your Variables\n    Dim Sht As Worksheet\n    Dim Rng As Range\n    Dim List As Collection\n    Dim varValue As Variant\n    Dim i As Long\n\n'      // Set your Sheet name\n   Set Sht = ActiveWorkbook.Sheets(\"Sheet1\")\n\n'      // set your auto-filter,  A6\n  With Sht.Range(\"A6\")\n    .AutoFilter\n  End With\n\n'   // Set your agent Column range # (2) that you want to filter it\n  Set Rng = Range(Sht.AutoFilter.Range.Columns(3).Address)\n\n'   // Create a new Collection Object\n  Set List = New Collection\n\n'   // Fill Collection with Unique Values\n   On Error Resume Next\n   For i = 2 To Rng.Rows.Count\n    List.Add Rng.Cells(i, 1), CStr(Rng.Cells(i, 1))\n   Next i\n\n'   // Start looping in through the collection Values\n  For Each varValue In List\n'       // Filter the Autofilter to macth the current Value\n    Rng.AutoFilter Field:=3, Criteria1:=varValue\n\n'       // Copy the AutoFiltered Range to new Workbook\n    Sht.AutoFilter.Range.Copy\n    Worksheets.Add.Paste\n    ActiveSheet.Name = Left(varValue, 30)\n    Cells.EntireColumn.AutoFit\n\n'   // Loop back to get the next collection Value\n   Next varValue\n\n'   // Go back to main Sheet and removed filters\n    Sht.AutoFilter.ShowAllData\n    Sht.Activate\nEnd Sub\n</code></pre>\n\n<p>This solves my biggest problem which was to extract the different salespersons sales...</p>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1505512206, "creation_date": 1505512206, "answer_id": 46247891, "question_id": 46208120, "link": "https://stackoverflow.com/questions/46208120/vba-copy-and-paste-rows-of-data-by-salesperson-into-new-workbooks-by-salesperson/46247891#46247891", "title": "vba copy and paste rows of data by salesperson into new workbooks by salesperson", "body": "<p><em>To move the sales to new workbook save it by their number and close, Change the following</em></p>\n\n<pre><code>Sht.AutoFilter.Range.Copy\nWorksheets.Add.Paste\nActiveSheet.Name = Left(varValue, 30)\nCells.EntireColumn.AutoFit\n</code></pre>\n\n<p><em>With</em></p>\n\n<pre><code>Sht.AutoFilter.Range.Copy\nWorkbooks.Add\nActiveSheet.Paste\n\nDim CurPath As String\nCurPath = ActiveWorkbook.Path &amp; \"\\\"\n\nActiveWorkbook.SaveAs Filename:=CurPath &amp; Left(ListValue, 30)\nCells.EntireColumn.AutoFit\nActiveWorkbook.Close savechanges:=True\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 46223112, "answer_count": 3, "score": 1, "last_activity_date": 1505512206, "creation_date": 1505344116, "last_edit_date": 1505466460, "question_id": 46208120, "link": "https://stackoverflow.com/questions/46208120/vba-copy-and-paste-rows-of-data-by-salesperson-into-new-workbooks-by-salesperson", "title": "vba copy and paste rows of data by salesperson into new workbooks by salesperson", "body": "<p>What I have here is a sales report that includes all the sales persons for a date range. </p>\n\n<p>What I need this macro to do is with each salesperson, move their sales to new workbook, save workbook by their number and close. </p>\n\n<p><a href=\"https://i.stack.imgur.com/fdVqa.png\" rel=\"nofollow noreferrer\">Here is what my data looks like and what i want the macro to do</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/2C3Ds.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2C3Ds.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am going to include some code that hasn't been working and that you may not find useful, but it will give you an idea of what im trying to accomplish</p>\n\n<pre><code>Public Function ReportSummaries()\n Dim row, col, origPersonsLastRow, origSalesLastRow, i As Integer\n Dim original As Workbook\n Dim cell As Range\n Dim vendorsSheet, RawDataSheet As Worksheet\n\nSet original = Application.Workbooks(\"SalesReportRpt (7).xlsm\")\nSet vendorsSheet = original.Worksheets(\"Sales person\")\nSet RawDataSheet = original.Worksheets(\"Sheet1\")\n\n'Optimize Macro Speed\n Application.ScreenUpdating = False\n Application.EnableEvents = False\n Application.Calculation = xlCalculationManual\n'Retrieve Target Folder Path From User\n Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\nWith FldrPicker\n  .Title = \"Select A Target Folder\"\n  .AllowMultiSelect = False\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    myPath = .SelectedItems(1) &amp; \"\\\"\nEnd With\n\n'In Case of Cancel\nNextCode:\nmyPath = myPath\n If myPath = \"\" Then GoTo ResetSettings\n\ni = 2\norigPersonsLastRow = vendorsSheet.UsedRange.Rows.Count\norigSalesLastRow = RawDataSheet.UsedRange.Rows.Count\n'MsgBox origVeodorsLastRow\nFor j = 2 To origPersonsLastRow ' cell In vendorsSheet.Columns(\"A\").Cells\n    Set cell = vendorsSheet.Cells(j, 1)\n    'Set y = Workbooks.Open(\" path to destination book \")\n    'If cell.Value = 108 Or cell.Value = 30 Then\n     '   GoTo NextWB\n    'End If\n    Set wb = Workbooks.Add\n    With wb\n        Application.DisplayAlerts = False\n        RawDataSheet.Range(\"A1:k1\").Copy wb.Sheets(\"Sheet1\").Cells(1, 1)\n        For k = 2 To origSalesLastRow ' Each rawCell In \nRawDataSheet.Columns(\"E\").Cells\n            Set rawCell = RawDataSheet.Cells(k, 4)\n            If cell.Value = rawCell.Value And rawCell.Value &lt;&gt; \"\" And \n rawCell.Value &lt;&gt; 108 Then\n                'MsgBox \"Matches\"\n                rawCell.EntireRow.Copy wb.Sheets(\"Sheet1\").Cells(i, 1)\n                i = i + 1\n            ElseIf i &gt; 6 And cell.Value = \"\" Then\n                'Call BIGreport\n                'GoTo Done\n            End If\n        Next k\n        If cell.Value &lt;&gt; \"\" Then\n            wb.CheckCompatibility = False\n            Do Until Application.CalculationState = xlDone: DoEvents: \n Loop\n            .SaveAs Filename:=myPath &amp; cell.Value, FileFormat:=xlNormal, \n CreateBackup:=False\n            '.Activate\n            'wb.Activate\n            '.Sheets(\"Sheet1\").Activate\n            'Call BIGreport(wb)\n            .Close SaveChanges:=True\n        ElseIf i &gt; 6 Then\n          GoTo Done\n        End If\n\n    End With\nNextWB:\n\n    i = 6\nNext j\nResetSettings:\n'Reset Macro Optimization Settings\n Application.EnableEvents = True\n Application.DisplayAlerts = True\n Application.Calculation = xlCalculationAutomatic\n Application.ScreenUpdating = True\nDone:\n 'Exit Sub\n 'Call LoopAllExcelFilesInFolder\n End Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "forms"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1505343747, "post_id": 46207829, "comment_id": 79379450, "body": "Are you getting an error? You need an <code>End If</code> line after <code>ws.Cells(i,1).Value</code>.  ...actually your If statement is written incorrectly."}, {"owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1505344837, "post_id": 46207829, "comment_id": 79379730, "body": "Im sorry, I did not add the issue (im still new). No error it actually works fine, just not what I want.  It feels my listbox with everything instead of matching the value in firmGroupID with gID and only showing those results."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "edited": false, "score": 0, "creation_date": 1505346970, "post_id": 46208334, "comment_id": 79380235, "body": "No nothing is showing in the list box. Do I need to indicate gID anywhere? That is the name of the column in Worksheet(RelatedFirms) that firmGroupID needs to compare too."}, {"owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "edited": false, "score": 0, "creation_date": 1505351249, "post_id": 46208334, "comment_id": 79381222, "body": "Thank you guys for all your help. I got it to work with this"}, {"owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "edited": false, "score": 0, "creation_date": 1505351443, "post_id": 46208334, "comment_id": 79381258, "body": "I defined firmGroupID,  Dim s As String, s = firmGroupID.Value. Just one last question though.  How do I stop the loop so when I choose the next item it clears the listbox?  Thanks"}], "tags": [], "owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "is_accepted": false, "score": 1, "last_activity_date": 1505345850, "creation_date": 1505345850, "answer_id": 46208334, "question_id": 46207829, "link": "https://stackoverflow.com/questions/46207829/seach-column-based-on-textbox-value-and-display-all-results-in-listbox/46208334#46208334", "title": "Seach Column based on textbox value and display all results in Listbox", "body": "<p>Please change this code:</p>\n\n<pre><code>If ws.Cells(i, 1).Value &lt;&gt; vbNullString Then Me.firmList.AddItem ws.Cells(i, 1).Value\n</code></pre>\n\n<p>To</p>\n\n<pre><code>If ws.Cells(i, 1).Value = firmGroupID.Value Then Me.firmList.AddItem ws.Cells(i, 2).Value   \n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 3806255, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b10f364cc68d76f3045a6f842e29dd0a?s=128&d=identicon&r=PG&f=1", "display_name": "user3806255", "link": "https://stackoverflow.com/users/3806255/user3806255"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505358608, "creation_date": 1505342201, "last_edit_date": 1505358608, "question_id": 46207829, "link": "https://stackoverflow.com/questions/46207829/seach-column-based-on-textbox-value-and-display-all-results-in-listbox", "title": "Seach Column based on textbox value and display all results in Listbox", "body": "<p>I have a </p>\n\n<pre><code>ListBox = firmList; \nTextBox = firmGroupID; \nWorksheet = RelatedFirms; \nColumnA = gID (ID numbers); \nColumnB = firmName \n</code></pre>\n\n<p>I am trying to populate my list box based on the value of firmGroupID.<br>\nCurrently I have a combobox that populates the gID number in firmGroupID depending on combobox selection. </p>\n\n<p>I would then like the firmList to populate with the list of firmNames based on the firmGroupID. </p>\n\n<p>Sheet RelatedFirms contains the assigned gID for each firmName.</p>\n\n<p>This seems simple but everything I try doesn't seem to work. </p>\n\n<p>Not sure how to only show items in list box that have the value that equals gID.</p>\n\n<pre><code>Private Sub firmGroupID_Change()\n    Dim rngName As Range\n    Dim ws As Worksheet\n    Dim i As Integer\n\n    Set ws = Worksheets(\"RelatedFirms\")\n    For i = 1 To ws.Cells(ws.Rows.Count, 1).End(xlUp).Row Step 1\n        If ws.Cells(i, 1).Value &lt;&gt; vbNullString Then Me.firmList.AddItem\n        ws.Cells(i, 1).Value   \n        Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "worksheet", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505341871, "post_id": 46207662, "comment_id": 79378889, "body": "Are the two lines of code used without any modification of the order of the sheet tabs occurring between when the two lines are executed, and without any addition or deletion of sheets between them?"}, {"owner": {"reputation": 13, "user_id": 5982407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8f653bc28625e3185aace403c5add2a?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck", "link": "https://stackoverflow.com/users/5982407/chuck"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505346301, "post_id": 46207662, "comment_id": 79380063, "body": "Both lines are together. One after another.  Sheet40 is TESTMakeRandomTeams  Application.Goto ActiveWorkbook.Worksheets(45).Cells(6, 5)  ActiveWorkbook.Worksheets(40).Select     ActiveWorkbook.Worksheets(&quot;TESTMakeRandomTeams&quot;).Select"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505350630, "post_id": 46207662, "comment_id": 79381109, "body": "Do you have an event in worksheets(45) that might be selecting worksheets(40) (e.g. in its <code>Worksheet_SelectionChange</code> event)?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1505350689, "post_id": 46207662, "comment_id": 79381116, "body": "In an Immediate Window, enter the command <code>?Worksheets(40).Name &amp; &quot;|&quot; &amp; Worksheets(45).Name</code> and see what is displayed."}, {"owner": {"reputation": 13, "user_id": 5982407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8f653bc28625e3185aace403c5add2a?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck", "link": "https://stackoverflow.com/users/5982407/chuck"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505391112, "post_id": 46207662, "comment_id": 79399992, "body": "WK #5C|TESTMakeRandomTeams Sheet property window shows the same. I will check on events in ws-45."}, {"owner": {"reputation": 13, "user_id": 5982407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8f653bc28625e3185aace403c5add2a?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck", "link": "https://stackoverflow.com/users/5982407/chuck"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505398809, "post_id": 46207662, "comment_id": 79405954, "body": "No Events that I can see. I did have a macro to load a visual index on workbook open. Is there a way to detect all events being executed? Would a screenshot of VBA window help?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505421964, "post_id": 46207662, "comment_id": 79419735, "body": "Based on what you see in the Immediate Window, <code>Worksheets(40)</code> is the one named &quot;WK #5C&quot;, so that is the one that might be somehow redirecting the selection to <code>Worksheets(45)</code> (which is the one you appear to want to use because it is named &quot;TESTMakeRandomTeams&quot; and appears to have a <code>CodeName</code> of <code>Sheet40</code>).  Remember that the <b>index of <code>Worksheets</code></b> simply refers to the tab order in which the sheets appear (left to right), the <b><code>CodeName</code></b> is a name assigned by the VBE (but can be modified using the VBE), and the <b><code>Name</code></b> is what appears on the tab (e.g. &quot;TestMakeRandomTeams&quot;)."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505422386, "post_id": 46207662, "comment_id": 79419931, "body": "A screenshot of the Project Explorer window within VBA might assist (especially if you can get it to show <b>all</b> the worksheets that you have) and the code from the code module of the &quot;WK #5C&quot; worksheet might also help."}, {"owner": {"reputation": 13, "user_id": 5982407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8f653bc28625e3185aace403c5add2a?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck", "link": "https://stackoverflow.com/users/5982407/chuck"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505602490, "post_id": 46207662, "comment_id": 79481868, "body": "Don&#39;t know how to add screenshots"}, {"owner": {"reputation": 13, "user_id": 5982407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8f653bc28625e3185aace403c5add2a?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck", "link": "https://stackoverflow.com/users/5982407/chuck"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1505665302, "post_id": 46207662, "comment_id": 79495039, "body": "My error is thinking that Sheet40 is the same as sheet index 40. Code has been corrected. I have so much to learn. Thanks for your help!, YowE3K"}], "owner": {"reputation": 13, "user_id": 5982407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8f653bc28625e3185aace403c5add2a?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck", "link": "https://stackoverflow.com/users/5982407/chuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505341564, "creation_date": 1505341235, "last_edit_date": 1531164843, "question_id": 46207662, "link": "https://stackoverflow.com/questions/46207662/two-way-to-address-an-excel-worksheet-but-index-numbers-are-different", "title": "Two way to address an excel worksheet but index numbers are different", "body": "<p>I'm using Excel 2016 VBA to get to a worksheet entitled Sheet40 (TestRandomTeams).\nBoth the following 2 lines of code point to the same worksheet, but I don't understand WHY?</p>\n\n<pre><code>Application.Goto ActiveWorkbook.Worksheets(45).Cells(6, 5)\n\nWorksheets(40).Activate\n</code></pre>\n\n<p>There is only one workbook open.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 315, "user_id": 5822096, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d5ab014cd7c3b58fa8eb2098837aa537?s=128&d=identicon&r=PG&f=1", "display_name": "Tianna Wrona", "link": "https://stackoverflow.com/users/5822096/tianna-wrona"}, "edited": false, "score": 0, "creation_date": 1505338279, "post_id": 46206904, "comment_id": 79377660, "body": "I suggested an alternative method as an answer, but if you HAVE to use VBA, what&#39;s the problem you&#39;re having exactly? What happens when you run this?"}], "answers": [{"tags": [], "owner": {"reputation": 315, "user_id": 5822096, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d5ab014cd7c3b58fa8eb2098837aa537?s=128&d=identicon&r=PG&f=1", "display_name": "Tianna Wrona", "link": "https://stackoverflow.com/users/5822096/tianna-wrona"}, "is_accepted": false, "score": 0, "last_activity_date": 1505338486, "last_edit_date": 1505338486, "creation_date": 1505338123, "answer_id": 46207102, "question_id": 46206904, "link": "https://stackoverflow.com/questions/46206904/excel-vba-compare-cell-value-to-list-and-overwrite-value-in-separate-sheet/46207102#46207102", "title": "Excel VBA Compare cell value to list and overwrite value in separate sheet", "body": "<p>You can always do this on the sheet. Consider the MATCH function. See <a href=\"https://support.office.com/en-us/article/MATCH-function-e8dffd45-c762-47d6-bf89-533f4a37673a\" rel=\"nofollow noreferrer\">here</a> for how to use MATCH.</p>\n\n<p>Or another great tool if you're searching for something in a table associated with a value in another column (not your case I don't think)--VLOOKUP formula. Place this formula in the D cell of the sheet you want to place the numbers in. VLOOKUP is in the following format:</p>\n\n<pre><code>=vlookup(lookup value,table_array,column index number, [range lookup])\n</code></pre>\n\n<ol>\n<li>The lookup value is the 6 digit code you're looking for (on the JE sheet)</li>\n<li>The table_array is simply selecting the values you want to search for (required_refs sheet)</li>\n<li>The column index number would be one, since the table only has 1 column. It's basically the column number of the value you're looking for.</li>\n<li>And range lookup is for if you think there might be more than one place where it matches.</li>\n</ol>\n\n<p>For your case I think it would look like this:</p>\n\n<pre><code>=vlookup('JE'!D1,'required_refs'!A1:A,1,FALSE)\n</code></pre>\n\n<p>Then just lock the values you want to keep and click and drag down.</p>\n\n<p>Explanation for VLOOKUP <a href=\"https://www.ablebits.com/office-addins-blog/2014/07/17/excel-vlookup-tutorial-beginner/\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "is_accepted": true, "score": 2, "last_activity_date": 1505352987, "creation_date": 1505352987, "answer_id": 46209163, "question_id": 46206904, "link": "https://stackoverflow.com/questions/46206904/excel-vba-compare-cell-value-to-list-and-overwrite-value-in-separate-sheet/46209163#46209163", "title": "Excel VBA Compare cell value to list and overwrite value in separate sheet", "body": "<p>This will do what you want:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n  If Intersect(Target, Range(\"F7:F446\")) Is Nothing Then Exit Sub\n\n  Dim varReference As Variant\n\n  varReference = Columns(\"D\").Cells(Target.Row).Value2\n  If Not IsError(Application.Match(varReference, Worksheets(\"required_refs\").Columns(\"A\"), 0)) Then\n    Worksheets(\"references\").Range(\"D1\").Value = varReference\n  End If\n\nEnd Sub\n</code></pre>\n\n<p><strong>Important Points:</strong></p>\n\n<p>Whenever working with event handlers, <em>always</em> limit the scope of the target range in the first line. Otherwise, it might not work correctly or it could slow done your spreadsheet.</p>\n\n<p>Make sure your <code>JE</code> sheet column <code>D</code> values and <code>required_refs</code> sheet column <code>A</code> values are <strong><em>all</em></strong> either text or numbers. Otherwise the values won't be compared correctly.</p>\n\n<p>Note the usage of <code>Application.Match()</code> instead of <code>WorksheetFunction.Match()</code> to access the worksheet function. This, coupled with the use of a Variant type variable, allows us to trap the error that occurs if the match fails.</p>\n"}], "owner": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1636, "favorite_count": 0, "accepted_answer_id": 46209163, "answer_count": 2, "score": 0, "last_activity_date": 1505352987, "creation_date": 1505337111, "question_id": 46206904, "link": "https://stackoverflow.com/questions/46206904/excel-vba-compare-cell-value-to-list-and-overwrite-value-in-separate-sheet", "title": "Excel VBA Compare cell value to list and overwrite value in separate sheet", "body": "<p>In a workbook I have, users either manually enter an account code or select one from a list and the account codes are placed in column C (C7:C446) in a sheet called \"JE\". The account codes look like this ####### - ### - ## - ######. In column D (D7:D446) in sheet \"JE\", there is a formula that captures the last 6 digits of the account code. In a sheet called \"required_refs\", there is a list of 6 digit codes in column A. If the value in the D column in sheet \"JE\" equals any of the values in column A of \"required_refs\" sheet, I would like the value in the D column cell to overwrite the cell value in cell D1 in a separate sheet called \"references\" (I know that may have been confusing, sorry) </p>\n\n<p><strong>Example</strong>: if the value of D25 matches any of the values listed in column A of sheet \"required_refs\", upon double clicking a red colored F25 cell, put the value of D25 (of sheet \"JE\"), and put it in cell D1 on sheet \"references\". </p>\n\n<p>I've taken a crack at it as best I know how. I've placed this code in sheet JE:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n    Dim project As Range: Set project = Range(\"D7:D446\")\n    Dim param As Range:    Set param = Worksheets(\"references\").Range(\"D1\").Value\n\n\n    For Each cell In project\n        If project.Value = Worksheets(\"required_refs\").Range(\"A:A\").Value Then\n        Call gotoRef_ 'macro that simply selects/navigates to the required_ref sheet\n        project.Value = param\n        End If\n\nEnd Sub\n</code></pre>\n\n<p>Thanks so much in advance for any suggestions on how to complete this. I can elaborate on this further if needed. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1505335850, "post_id": 46206512, "comment_id": 79376562, "body": "Why not add that in a <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbook-beforeprint-event-excel\" rel=\"nofollow noreferrer\"><code>BeforePrint</code></a> event that removes the cell color, and adds back in after printing? AFAIK you can&#39;t do what you&#39;re trying by editing that single line."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1505335901, "post_id": 46206512, "comment_id": 79376601, "body": "see here: <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/pagesetup-blackandwhite-property-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1505339131, "post_id": 46206678, "comment_id": 79377988, "body": "It&#39;s been awhile so I don&#39;t remember the color fill, but I remember using it and it printed in black and white"}, {"owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1505339374, "post_id": 46206678, "comment_id": 79378079, "body": "According to Microsoft, it will print in black or white. Here&#39;s the link to the site <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/pagesetup-blackandwhite-property-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/page&zwnj;&#8203;setup-blackandwhite-&zwnj;&#8203;property-excel</a>"}], "tags": [], "owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "is_accepted": true, "score": 3, "last_activity_date": 1505336052, "creation_date": 1505336052, "answer_id": 46206678, "question_id": 46206512, "link": "https://stackoverflow.com/questions/46206512/how-to-print-selection-without-the-cell-background-color-black-and-white-print/46206678#46206678", "title": "How to Print Selection without the cell background color ( black and white print ) VB", "body": "<p>This should do the trick.\n<code>Worksheets(\"Sheet1\").PageSetup.BlackAndWhite = True</code></p>\n"}], "owner": {"reputation": 1383, "user_id": 5015813, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7FvAJ.jpg?s=128&g=1", "display_name": "Georgi Antonov", "link": "https://stackoverflow.com/users/5015813/georgi-antonov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "accepted_answer_id": 46206678, "answer_count": 1, "score": 1, "last_activity_date": 1505336052, "creation_date": 1505335359, "question_id": 46206512, "link": "https://stackoverflow.com/questions/46206512/how-to-print-selection-without-the-cell-background-color-black-and-white-print", "title": "How to Print Selection without the cell background color ( black and white print ) VB", "body": "<p>How to change this line of code in order to not select the cell fill color or somehow PrintOut the selection in black and white, while keeping the fill color on the page.</p>\n\n<pre><code>Range(\"H8:K10\" &amp; \",\" &amp; \"A\" &amp; firstRow &amp; \":G\" &amp; lastRow).PrintOut\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 69, "user_id": 8168070, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1798836273761991/picture?type=large", "display_name": "Daniel Cl&#237;maco", "link": "https://stackoverflow.com/users/8168070/daniel-cl%c3%admaco"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505335581, "post_id": 46206173, "comment_id": 79376433, "body": "Ok, I added the last code I tried."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1505419595, "post_id": 46206173, "comment_id": 79418561, "body": "What does POINTAPI return? Shapes().top, .Width, etc returns a value in points."}, {"owner": {"reputation": 69, "user_id": 8168070, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1798836273761991/picture?type=large", "display_name": "Daniel Cl&#237;maco", "link": "https://stackoverflow.com/users/8168070/daniel-cl%c3%admaco"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1505421582, "post_id": 46206173, "comment_id": 79419544, "body": "I have a code in a Module that will return the cursor position. llCoord.Xcoord returns the X position and llCoord.Ycoord the Y position of the cursor."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1505743615, "post_id": 46206173, "comment_id": 79525584, "body": "Then you problem is that the x/y coordinates of the cursor are not what shapes().top, width, etc needs to be set to.  You are going to have to translates the coordinates to the values of the shape position/dimensions"}, {"owner": {"reputation": 69, "user_id": 8168070, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1798836273761991/picture?type=large", "display_name": "Daniel Cl&#237;maco", "link": "https://stackoverflow.com/users/8168070/daniel-cl%c3%admaco"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1506023034, "post_id": 46206173, "comment_id": 79664253, "body": "No, that&#39;s not the problem (I already solved that with the &quot;/ 1.417323&quot;)."}], "owner": {"reputation": 69, "user_id": 8168070, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1798836273761991/picture?type=large", "display_name": "Daniel Cl&#237;maco", "link": "https://stackoverflow.com/users/8168070/daniel-cl%c3%admaco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1367, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593770476, "creation_date": 1505333905, "last_edit_date": 1593770476, "question_id": 46206173, "link": "https://stackoverflow.com/questions/46206173/changing-the-size-of-a-shape-in-powerpoint-vba-macros", "title": "Changing the size of a shape in PowerPoint VBA Macros", "body": "<p>I'm trying to resize a shape (square) using VBA in PowerPoint when clicking on one of the 4 circles in each vertex of a square. But when I resize it to the position of the mouse it only works in the right bottom vertex of the square.</p>\n\n<p>I want it to size up in the upper vertexes and left in the left side vertexes.  Because it only sizes to the lower right. I tried messing with the Top property of the shape and many codes, but non of them worked.</p>\n\n<p><strong>EDIT:</strong> Can I use the ScaleHeight and ScaleWidth property for that? If yes, then can you help me with that, because that property is confusing, beacause I have to use factor...</p>\n\n<p>Here is the last code I tried:</p>\n\n<pre><code>Sub resizeshp_topright3()\nDim llCoord As POINTAPI\nGetCursorPos llCoord\nShapes(\"a\").TextFrame.TextRange.Text = Shapes(\"shp\").Height\n\nShapes(\"shp\").Width = (llCoord.Xcoord / 1.417323) - Val(Replace(Shapes(\"shp\").Left, \",\", \".\"))\nShapes(\"shp\").Top = (llCoord.Ycoord / 1.417323)\nShapes(\"shp\").Height = (llCoord.Ycoord / 1.417323) - Val(Replace(Shapes(\"shp\").Top, \",\", \".\"))\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 213, "user_id": 5428480, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2da2ebe5d418c95bddf9049fa848584f?s=128&d=identicon&r=PG&f=1", "display_name": "kschindl", "link": "https://stackoverflow.com/users/5428480/kschindl"}, "edited": false, "score": 0, "creation_date": 1505332550, "post_id": 46205757, "comment_id": 79374970, "body": "Are you trying to create a border up until the last column in the entire sheet? Or the last column in your data set?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1505336658, "post_id": 46205757, "comment_id": 79376980, "body": "Create a range object that includes the entire range for which you want to set the border (eg: the last row).  Then use the <code>BordersAround</code> property of that object."}], "answers": [{"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1505348437, "last_edit_date": 1505348437, "creation_date": 1505336817, "answer_id": 46206851, "question_id": 46205757, "link": "https://stackoverflow.com/questions/46205757/trying-to-border-the-last-row-in-vba/46206851#46206851", "title": "Trying to border the last row in VBA", "body": "<ul>\n<li>Find the table</li>\n<li>Find the last row</li>\n<li>Optionally clear any existing borders</li>\n<li>Create a range object encompassing the last row (or whatever part you want to border).</li>\n<li>Use the <code>BordersAround</code> property to draw the borders</li>\n</ul>\n\n<hr>\n\n<pre><code>Option Explicit\nSub BorderAroundBottom()\n    Dim WS As Worksheet\n    Dim rFirst As Range, rLast As Range, rTable As Range\n\n    'Need to know where table starts\n    Const ColHdr As String = \"ColA\"\n\nSet WS = Worksheets(\"sheet2\")\n\n'Find first cell of the table\n'Can hardcode this if known\nWith WS.Cells\n    Set rFirst = .Find(what:=ColHdr, after:=.Cells(.Rows.Count, 1), _\n                    LookIn:=xlValues, lookat:=xlWhole, searchorder:=xlByRows, _\n                    searchdirection:=xlNext, MatchCase:=False)\n    If rFirst Is Nothing Then\n        MsgBox \"First Column Header not found\"\n        Exit Sub\n    End If\n\n    Set rLast = .Cells(.Rows.Count, rFirst.Column).End(xlUp)\n    Set rLast = .Cells(rLast.Row, .Columns.Count).End(xlToLeft)\n\n    Set rTable = .Range(rFirst, rLast)\n\nEnd With\n\nWith rTable\n    .Borders.LineStyle = xlNone\n    .Rows(.Rows.Count).BorderAround LineStyle:=xlContinuous, Weight:=xlMedium\nEnd With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/j41BS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j41BS.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1505400784, "post_id": 46207051, "comment_id": 79407448, "body": "Thanks to all that answered. All your inputs worked but this one was the most comprehensive to me."}, {"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1505408828, "post_id": 46207051, "comment_id": 79412803, "body": "Sorry, one issue that this is having is that it borders the entire row of the spreadsheet and not just the table."}, {"owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "reply_to_user": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1505411188, "post_id": 46207051, "comment_id": 79414100, "body": "The code works for me.  Did you change the code at all?  If so, how?  Does your data start in cell A1 or did you change the code to reflect a different start location?  You will probably have to account for special circumstances like a table with only one row (excluding the header, so only two rows on the spreadsheet) or only one column.  I would need to see your data and any changes you made to the code to say for sure why it&#39;s not working for you.  You could post an edit to your original comment if you want me to take a look at what you&#39;re experiencing."}], "tags": [], "owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "is_accepted": true, "score": 0, "last_activity_date": 1505337889, "creation_date": 1505337889, "answer_id": 46207051, "question_id": 46205757, "link": "https://stackoverflow.com/questions/46205757/trying-to-border-the-last-row-in-vba/46207051#46207051", "title": "Trying to border the last row in VBA", "body": "<p>The problem is that in both of your code attempts, you are only selecting one cell.  Because you are using the <code>Cells</code> method, you are only selecting a single cell.  You need to use <code>Cells</code> in conjunction with the <code>Range</code> object to get a multicellular region.</p>\n\n<p>Assuming your data starts in cell A1 on Sheet1, here is working code:</p>\n\n<pre><code>Sub DrawBorder()\n\n    Dim rngBottomRowStart       As Range\n    Dim rngBottomRowEnd         As Range\n    Dim rngDataUpperLeftCell    As Range\n\n    Set rngDataUpperLeftCell = Sheet1.Range(\"A1\")\n    With rngDataUpperLeftCell\n        Set rngBottomRowStart = Sheet1.Cells(.End(xlDown).Row, .Column)\n        Set rngBottomRowEnd = Sheet1.Cells(rngBottomRowStart.Row, .End(xlToRight).Column)\n    End With\n    Sheet1.Range(rngBottomRowStart, rngBottomRowEnd).BorderAround Weight:=xlMedium\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2020, "favorite_count": 0, "accepted_answer_id": 46207051, "answer_count": 2, "score": 0, "last_activity_date": 1505348437, "creation_date": 1505332195, "question_id": 46205757, "link": "https://stackoverflow.com/questions/46205757/trying-to-border-the-last-row-in-vba", "title": "Trying to border the last row in VBA", "body": "<p>I am trying to select the last row of my table and use an outside border around the whole row up until the last column. Here is my Code</p>\n\n<pre><code>Cells(Application.Rows.Count, .Columns.Count).End(xlUp).BorderAround Weight:=xlMedium\n</code></pre>\n\n<p>Before I had </p>\n\n<pre><code>Cells(Application.Rows.Count, 1).End(xlUp).BorderAround Weight:=xlMedium\n</code></pre>\n\n<p>My second line of code only bordered the first cell. I need it to outside border all the cells in the row. I have tried different things like turning it into a \"range\" to only get an error. These are my closest attempts. I do not get an error but it does not do what I need it to do. </p>\n\n<p>Thanks,</p>\n\n<p>G</p>\n"}, {"tags": ["python", "vba", "powerpoint", "python-pptx"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1505355612, "post_id": 46205450, "comment_id": 79382218, "body": "&quot;I don&#39;t want to use VBA because (as far as I understand) I would have to open each presentation to run the script.&quot;  Each presentation would need to be opened in PPT in order for VBA to do any good, but the VBA in one presentation or add-in could automate the work of opening each presentation in a list or in a folder and doing whatever&#39;s needed, then saving and closing it before moving on to the next presentation."}, {"owner": {"reputation": 3, "user_id": 3520190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc26f49d98a5e342da31a7e3a2642ee?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Lide", "link": "https://stackoverflow.com/users/3520190/brad-lide"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1505450540, "post_id": 46205450, "comment_id": 79427034, "body": "That&#39;s a really interesting idea. I&#39;ll have to take a look into that. Any way you could point me in the direction of a good source for inexperienced-friendly documentation?  Thanks again!"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1505488191, "post_id": 46205450, "comment_id": 79449257, "body": "There&#39;s a section on PowerPoint programming in the PPT FAQ site that I maintain here:  <a href=\"http://www.pptfaq.com/index.html#name_PROGRAMMING_POWERPOINT\" rel=\"nofollow noreferrer\">pptfaq.com/index.html#name_PROGRAMMING_POWERPOINT</a>  Lots of examples and links to other sites on the subject.  This entry might be useful for your project:  <a href=\"http://www.pptfaq.com/FAQ00536_Batch-_Do_something_to_every_file_in_a_folder.htm\" rel=\"nofollow noreferrer\">pptfaq.com/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 3520190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc26f49d98a5e342da31a7e3a2642ee?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Lide", "link": "https://stackoverflow.com/users/3520190/brad-lide"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1507135661, "post_id": 46205450, "comment_id": 80093938, "body": "Better late than never, thanks so much for your guidance. We ended up grabbing a team to workhorse it manually, but I learned a lot using those resources and have them in my toolbelt for the future when a project may not be so time sensitive. Thanks again."}], "answers": [{"tags": [], "owner": {"reputation": 3334, "user_id": 5918696, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-t_Gmo6DSxrU/AAAAAAAAAAI/AAAAAAAAYqk/E-zNA4NlF4Y/photo.jpg?sz=128", "display_name": "Statham", "link": "https://stackoverflow.com/users/5918696/statham"}, "is_accepted": false, "score": -2, "last_activity_date": 1510146497, "creation_date": 1510146497, "answer_id": 47180580, "question_id": 46205450, "link": "https://stackoverflow.com/questions/46205450/how-can-i-combine-two-presentations-pptx-into-one-master-presentation/47180580#47180580", "title": "How can I combine two presentations (pptx) into one master presentation?", "body": "<p>A free tool called \"powerpoint join\" can help you.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 12028642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17b95c36ca55c381981ba2f59604b1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Zeynel", "link": "https://stackoverflow.com/users/12028642/zeynel"}, "is_accepted": false, "score": 0, "last_activity_date": 1616442750, "last_edit_date": 1616442750, "creation_date": 1616438309, "answer_id": 66752002, "question_id": 46205450, "link": "https://stackoverflow.com/questions/46205450/how-can-i-combine-two-presentations-pptx-into-one-master-presentation/66752002#66752002", "title": "How can I combine two presentations (pptx) into one master presentation?", "body": "<p>I was able to achieve this by using python and win32com.client. However, this doesn't work quietly. What I mean is that it launches Microsoft PowerPoint and opens input files one by one, then copies all slides from an input file and pastes them to an output file in a loop.</p>\n<pre><code>import win32com.client\nfrom os import walk\n\ndef mergePresentations(inputFileNames, outputFileName):\n\n    Application = win32com.client.Dispatch(&quot;PowerPoint.Application&quot;)\n    outputPresentation = Application.Presentations.Add() \n    outputPresentation.SaveAs(outputFileName)\n\n    for file in inputFileNames:    \n        currentPresentation = Application.Presentations.Open(file)\n        currentPresentation.Slides.Range(range(1, currentPresentation.Slides.Count+1)).copy()\n        Application.Presentations(outputFileName).Windows(1).Activate()    \n        outputPresentation.Application.CommandBars.ExecuteMso(&quot;PasteSourceFormatting&quot;)    \n        currentPresentation.Close()\n\n    outputPresentation.save()\n    outputPresentation.close()\n    Application.Quit()\n\n# Example; let's say you have a folder of presentations that need to be merged \n#           to new file named &quot;allSildesMerged.pptx&quot; in the same folder\n\npath,_,files = next(walk('C:\\\\Users\\\\..\\\\..\\\\myFolder'))\noutputFileName = path + '\\\\' + 'allSildesMerged.pptx'\n\ninputFiles = []\nfor file in files:\n    inputFiles.append(path + '\\\\' + file)\n\nmergePresentations(inputFiles, outputFileName)\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 788, "user_id": 1368028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e017baa4172d33fae9847507e5b7e96?s=128&d=identicon&r=PG", "display_name": "Tilal Ahmad", "link": "https://stackoverflow.com/users/1368028/tilal-ahmad"}, "is_accepted": false, "score": 0, "last_activity_date": 1618602510, "creation_date": 1618602510, "answer_id": 67131380, "question_id": 46205450, "link": "https://stackoverflow.com/questions/46205450/how-can-i-combine-two-presentations-pptx-into-one-master-presentation/67131380#67131380", "title": "How can I combine two presentations (pptx) into one master presentation?", "body": "<p>The <a href=\"https://products.groupdocs.cloud/merger\" rel=\"nofollow noreferrer\">GroupDocs.Merger REST API</a> is also another option to merge multiple PowerPoint presentations into a single document. It is paid API but provides 150 monthly free API calls.</p>\n<p>Currently, it supports working with cloud providers: Amazon S3, DropBox, Google Drive Storage, Google Cloud Storage, Windows Azure Storage, FTP Storage along with GroupDocs internal Cloud Storage. However, in near future, it has a plan to support merge files from the request body(stream).</p>\n<p>P.S: I'm developer evangelist at GroupDocs.</p>\n<pre><code># For complete examples and data files, please go to https://github.com/groupdocs-merger-cloud/groupdocs-merger-cloud-python-samples\n# Get Client ID and Client Secret from https://dashboard.groupdocs.cloud\nclient_id = &quot;XXXX-XXXX-XXXX-XXXX&quot; \nclient_secret = &quot;XXXXXXXXXXXXXXXX&quot;\n  \ndocumentApi = groupdocs_merger_cloud.DocumentApi.from_keys(client_id, client_secret)\n \nitem1 = groupdocs_merger_cloud.JoinItem()\nitem1.file_info = groupdocs_merger_cloud.FileInfo(&quot;four-slides.pptx&quot;)\nitem2 = groupdocs_merger_cloud.JoinItem()\nitem2.file_info = groupdocs_merger_cloud.FileInfo(&quot;one-slide.docx&quot;)\n \noptions = groupdocs_merger_cloud.JoinOptions()\noptions.join_items = [item1, item2]\noptions.output_path = &quot;Output/joined.pptx&quot;\n \nresult = documentApi.join(groupdocs_merger_cloud.JoinRequest(options))\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3520190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc26f49d98a5e342da31a7e3a2642ee?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Lide", "link": "https://stackoverflow.com/users/3520190/brad-lide"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2605, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1618602510, "creation_date": 1505330875, "question_id": 46205450, "link": "https://stackoverflow.com/questions/46205450/how-can-i-combine-two-presentations-pptx-into-one-master-presentation", "title": "How can I combine two presentations (pptx) into one master presentation?", "body": "<p>I'm part of a project team that created PPTX presentations to present to clients. After creating all of the files, we need to add additional slides to each presentation. All of the new slides will be the same across the each presentation.</p>\n\n<p>What is the best way to accomplish this programmatically?</p>\n\n<p>I don't want to use VBA because (as far as I understand) I would have to open each presentation to run the script.</p>\n\n<p>I've tried using the python-pptx library. But the documentation states: </p>\n\n<p>\"Copying a slide from one presentation to another turns out to be pretty hard to get right in the general case, so that probably won\u2019t come until more of the backlog is burned down.\"</p>\n\n<p>I was hoping something like the following would work -</p>\n\n<pre><code>from pptx import Presentation\n\nmain = Presentation('Universal.pptx')\nabc = Presentation('Test1.pptx')\n\nmain_slides = main.slides.get(1)\nabc_slides = abc.slides.get(1)\n\nfull = main.slides.add_slide(abc_slides[1])\n\nfull.save('Full.pptx')\n</code></pre>\n\n<p>Has anyone had success do anything like that?</p>\n"}, {"tags": ["json", "vba", "excel", "jira-rest-api"], "comments": [{"owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "edited": false, "score": 3, "creation_date": 1505332009, "post_id": 46205368, "comment_id": 79374699, "body": "can you give us a snippet of your Json file? It&#39;s difficult to tell if the nesting is done right without seeing the structure.  I&#39;ll admit upfront I&#39;ve done very little with VBA-Json but I believe you have to specify the complete path (tree) that are trying to get to have you missed out any steps?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1505332984, "post_id": 46205368, "comment_id": 79375185, "body": "Try to debug: <code>Debug.Print TypeName(Json(&quot;fields&quot;)(i)(&quot;summary&quot;))</code> and <code>Debug.Print TypeName(Json(&quot;fields&quot;)(i))</code> before assigning the value to the cell."}, {"owner": {"reputation": 79, "user_id": 5636629, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-QLZaNXvbACM/AAAAAAAAAAI/AAAAAAAAAH4/hI_uccYwSDk/photo.jpg?sz=128", "display_name": "Ben Dains", "link": "https://stackoverflow.com/users/5636629/ben-dains"}, "reply_to_user": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "edited": false, "score": 1, "creation_date": 1505333032, "post_id": 46205368, "comment_id": 79375208, "body": "I can&#39;t give you the exact snippet, but I can build one with fake data. I will update the post soon @perfo. :)"}, {"owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "edited": false, "score": 0, "creation_date": 1505333563, "post_id": 46205368, "comment_id": 79375456, "body": "Just to explain my comment a bit .... ActiveSheet.Cells(i + 1, 5) = Json(&quot;issues&quot;)(i)(&quot;key&quot;) works but  ActiveSheet.Cells(i + 1, 7) = Json(&quot;fields&quot;)(i)(&quot;summary&quot;) doesn&#39;t. IS this because it should be written as ActiveSheet.Cells(i + 1, 7) = Json(&quot;issues&quot;)(&quot;fields&quot;)(i)(&quot;summary&quot;) ?"}, {"owner": {"reputation": 79, "user_id": 5636629, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-QLZaNXvbACM/AAAAAAAAAAI/AAAAAAAAAH4/hI_uccYwSDk/photo.jpg?sz=128", "display_name": "Ben Dains", "link": "https://stackoverflow.com/users/5636629/ben-dains"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1505334131, "post_id": 46205368, "comment_id": 79375793, "body": "@omegastripes I will give that a shot and let you know what happens."}, {"owner": {"reputation": 79, "user_id": 5636629, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-QLZaNXvbACM/AAAAAAAAAAI/AAAAAAAAAH4/hI_uccYwSDk/photo.jpg?sz=128", "display_name": "Ben Dains", "link": "https://stackoverflow.com/users/5636629/ben-dains"}, "reply_to_user": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "edited": false, "score": 0, "creation_date": 1505334134, "post_id": 46205368, "comment_id": 79375796, "body": "@perfo I believe I tried that combination, but no luck. I&#39;ll give it a shot again and see."}, {"owner": {"reputation": 79, "user_id": 5636629, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-QLZaNXvbACM/AAAAAAAAAAI/AAAAAAAAAH4/hI_uccYwSDk/photo.jpg?sz=128", "display_name": "Ben Dains", "link": "https://stackoverflow.com/users/5636629/ben-dains"}, "reply_to_user": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "edited": false, "score": 0, "creation_date": 1505334276, "post_id": 46205368, "comment_id": 79375869, "body": "@perfo, I tried that combination again, and I got a <a href=\"https://msdn.microsoft.com/VBA/Language-Reference-VBA/articles/invalid-procedure-call-or-argument-error-5\" rel=\"nofollow noreferrer\">Run-time error &#39;5&#39;: Invalid procedure call or argument</a>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505334482, "post_id": 46205368, "comment_id": 79375954, "body": "You&#39;re cramming half-a-dozen member access calls into a single instruction - that makes it pretty much impossible to debug. Declare more variables, split up these crazy chained default member access calls into separate instructions, inspect locals, and you&#39;ll fix your bug."}, {"owner": {"reputation": 79, "user_id": 5636629, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-QLZaNXvbACM/AAAAAAAAAAI/AAAAAAAAAH4/hI_uccYwSDk/photo.jpg?sz=128", "display_name": "Ben Dains", "link": "https://stackoverflow.com/users/5636629/ben-dains"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505335002, "post_id": 46205368, "comment_id": 79376176, "body": "@Mat&#39;sMug I wish I knew more about this stuff so I could do that. :( Also, this is how the VBA-JSON documentation says to grab nested data, so I&#39;m stumped."}, {"owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "edited": false, "score": 0, "creation_date": 1505335215, "post_id": 46205368, "comment_id": 79376270, "body": "Did you try the line with and without the (I) in it?  I guess you have to have the windows run time scripting reference set or the first example wouldn&#39;t work. I can&#39;t really see why the line I gave you shouldn&#39;t work but I&#39;m not an expert on it. I have to go somewhere now but if you have found the answer by tomorrow I&#39;ll have another look..  Use the for each in construct instead of the for next if you want to retrieve all the cards I don&#39;t see why this would make a difference but maybe worth a try. Good luck"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505335380, "post_id": 46205368, "comment_id": 79376349, "body": "@BenDains simply assign <code>foo1 = Json(&quot;Fields&quot;)</code> then <code>foo2 = foo1(i)</code> then <code>foo3 = foo2(&quot;summary&quot;)</code> and so  on. Then you can inspect the values in the debugger"}, {"owner": {"reputation": 79, "user_id": 5636629, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-QLZaNXvbACM/AAAAAAAAAAI/AAAAAAAAAH4/hI_uccYwSDk/photo.jpg?sz=128", "display_name": "Ben Dains", "link": "https://stackoverflow.com/users/5636629/ben-dains"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505335782, "post_id": 46205368, "comment_id": 79376535, "body": "@Mat&#39;sMug will do, thanks a bunch! :)"}, {"owner": {"reputation": 79, "user_id": 5636629, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-QLZaNXvbACM/AAAAAAAAAAI/AAAAAAAAAH4/hI_uccYwSDk/photo.jpg?sz=128", "display_name": "Ben Dains", "link": "https://stackoverflow.com/users/5636629/ben-dains"}, "edited": false, "score": 0, "creation_date": 1505336407, "post_id": 46205368, "comment_id": 79376867, "body": "Thanks for the help everyone, I finally got it figured out! I&#39;ll post the answer!"}, {"owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "edited": false, "score": 0, "creation_date": 1505372295, "post_id": 46205368, "comment_id": 79387834, "body": "Great, Put it as an answer to your own question."}, {"owner": {"reputation": 79, "user_id": 5636629, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-QLZaNXvbACM/AAAAAAAAAAI/AAAAAAAAAH4/hI_uccYwSDk/photo.jpg?sz=128", "display_name": "Ben Dains", "link": "https://stackoverflow.com/users/5636629/ben-dains"}, "reply_to_user": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "edited": false, "score": 0, "creation_date": 1505398856, "post_id": 46205368, "comment_id": 79405987, "body": "@perfo just did, thanks for the help everyone!"}], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "edited": false, "score": 0, "creation_date": 1505432514, "post_id": 46220905, "comment_id": 79423282, "body": "I suspected it was something to do with the (I) but didn&#39;t know why.  A bit of the actual file may have cleared it up I suppose. Anyway glad you solved it..."}], "tags": [], "owner": {"reputation": 79, "user_id": 5636629, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-QLZaNXvbACM/AAAAAAAAAAI/AAAAAAAAAH4/hI_uccYwSDk/photo.jpg?sz=128", "display_name": "Ben Dains", "link": "https://stackoverflow.com/users/5636629/ben-dains"}, "is_accepted": false, "score": 0, "last_activity_date": 1505412168, "last_edit_date": 1505412168, "creation_date": 1505396829, "answer_id": 46220905, "question_id": 46205368, "link": "https://stackoverflow.com/questions/46205368/how-to-get-fields-to-work-in-vba-json/46220905#46220905", "title": "How to get, (&quot;fields&quot;) to Work in VBA-JSON", "body": "<h3>The Problem</h3>\n\n<p>Nested arrays were actually the problem. The 2'nd level of JSON items were not arrays, while, \"fields\" was.</p>\n\n<p>To solve the problem, we need to add a (i + 1) to the code.</p>\n\n<h3>Working Code Example</h3>\n\n<pre><code>''''''''\n' Loop '\n''''''''\n\nFor i = 1 To 20\n    ActiveSheet.Cells(i + 1, 5) = Json(\"issues\")(i)(\"key\")\n    ActiveSheet.Cells(i + 1, 6) = Json(\"issues\")(i)(\"id\")\n    ActiveSheet.Cells(i + 1, 7) = Json(\"issues\")(i + 1)(\"fields\")(\"summary\")\n    ActiveSheet.Cells(i + 1, 8) = Json(\"issues\")(i + 1)(\"fields\")(\"watches\")(\"watchCount\")\n    ActiveSheet.Cells(i + 1, 9) = Json(\"issues\")(i + 1)(\"fields\")(\"workratio\")\nNext\n</code></pre>\n\n<h3>Update :(</h3>\n\n<p>So, I got all of my code setup to run my report, and it was working, and then it randomly stops (<em>I watched it do this on line 16 or so</em>) and gives me another type mismatch error. </p>\n\n<p>How were the rows 1-15 working, and then suddenly there is a type mismatch error?</p>\n\n<p>lol...</p>\n\n<p>Debugging now...</p>\n\n<h3>Update 2 :)</h3>\n\n<p>Simple mix up with the code structure, there wasn't a problem and the solution that I posted below works correctly.</p>\n"}], "owner": {"reputation": 79, "user_id": 5636629, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-QLZaNXvbACM/AAAAAAAAAAI/AAAAAAAAAH4/hI_uccYwSDk/photo.jpg?sz=128", "display_name": "Ben Dains", "link": "https://stackoverflow.com/users/5636629/ben-dains"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 858, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1505412168, "creation_date": 1505330577, "last_edit_date": 1505333912, "question_id": 46205368, "link": "https://stackoverflow.com/questions/46205368/how-to-get-fields-to-work-in-vba-json", "title": "How to get, (&quot;fields&quot;) to Work in VBA-JSON", "body": "<h2>Summary</h2>\n\n<p>I am trying to access the deep levels of nested JSON that comes back from the API that I am working with at the moment. Using <em><a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">VBA-JSON</a></em> through this process has been pretty easy, but I've ran into a little road block. For the most part, I've got this library to work properly, but I get an error anytime I try to grab an item that is nested in the JSON response (<em>further than 2 JSON levels</em>). I am going to submit this post, and then I'll go and gather some of the error codes that I am getting. Off the top of my head, I know that I get a <a href=\"https://msdn.microsoft.com/en-us/library/aa264979(v=vs.60).aspx\" rel=\"nofollow noreferrer\">Run-time error '13'</a> when I try to use the code below that doesn't work. I think (<em>could be wrong</em>) that I am smart enough to understand the type mismatch error, but I don't know how to fix it.</p>\n\n<h2>This Works</h2>\n\n<pre><code>For i = 1 To 20\n    ActiveSheet.Cells(i + 1, 5) = Json(\"issues\")(i)(\"key\")\n    ActiveSheet.Cells(i + 1, 6) = Json(\"issues\")(i)(\"id\")\nNext\n</code></pre>\n\n<h3>Doesn't Work</h3>\n\n<pre><code>For i = 1 To 20\n    ActiveSheet.Cells(i + 1, 7) = Json(\"fields\")(i)(\"summary\")\nNext\n</code></pre>\n\n<h3>None of These Worked Either</h3>\n\n<pre><code>ActiveSheet.Cells(i + 1, 7) = Json(\"fields\")(i)(\"summary\")\nActiveSheet.Cells(i + 1, 7) = Json(\"fields\")(\"summary\")\nActiveSheet.Cells(i + 1, 7) = Json(\"issues\")(\"fields\")(\"summary\")\n\nActiveSheet.Cells(i + 1, 7) = Json(\"fields\")(\"assignee\")(i)(\"name\")\nActiveSheet.Cells(i + 1, 7) = Json(\"issues\")(\"fields\")(\"assignee\")(i)(\"name\")\n</code></pre>\n\n<h3>Updated with Some JSON</h3>\n\n<p>I edited the JSON that comes back for privacy reasons (<em>obviously</em>).</p>\n\n<pre><code>{\n  \"expand\": \"schema,names\",\n  \"startAt\": 0,\n  \"maxResults\": 50,\n  \"total\": 28,\n  \"issues\": [ {\n    \"expand\": \"\",\n    \"id\": \"94581\",\n    \"self\": \"\",\n    \"key\": \"\",\n    \"fields\": {\n      , \"assignee\": {}\n      , \"status\": {}\n      , \"votes\": {}\n      , \"summary\": \"\"\n      ,\n      , \"issuetype\": {}\n      , \"timespent\": null,\n    }\n  }\n  ,\n  {}\n  ,\n  {}\n  ,\n  {}\n  ]\n}\n</code></pre>\n\n<p>According to this data structure, my code should be looking at the right place, right?</p>\n\n<p>Thoughts? :)</p>\n\n<hr>\n\n<p><em>PS: Sorry if jargon is off, I'm a developer by hobby, not by job. :)</em></p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 531, "user_id": 6254149, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/1UvBh.jpg?s=128&g=1", "display_name": "Moreno", "link": "https://stackoverflow.com/users/6254149/moreno"}, "is_accepted": false, "score": 0, "last_activity_date": 1505332059, "last_edit_date": 1505332059, "creation_date": 1505331014, "answer_id": 46205488, "question_id": 46205226, "link": "https://stackoverflow.com/questions/46205226/vbahow-to-delete-all-useless-0-in-the-end-of-a-column/46205488#46205488", "title": "[VBA]How to delete all useless 0 in the end of a column", "body": "<p>I think It would be better to use a loop in here   </p>\n\n<pre><code> dim LR,i as double\n     LR=application.count(range(\"A:A\"))\n    for i=1 to lr step 1\n     cells(i,2).value=cells(i+1,1).value-cells(i,1).value\n    next i\n</code></pre>\n\n<p>and alternative to preserve you code would be:</p>\n\n<pre><code>Sub CalculateTimeGap()  \n\nColumns(\"B:B\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nRange(\"A1\").Value = \"Time\"\n dim LR as variant\n LR=application.count(range(\"A:A\"))\nColumns(\"A:A\").NumberFormat = \"hh:mm:ss\"\nColumns(\"B2:B\"&amp;LR).Formula = \"=A2-A1\"\nRange(\"B1\").Value = \"Time Difference(s)\"\nColumns(\"B:B\").NumberFormat = \"hh:mm:ss\"\n\nlRow = Cells(Rows.Count, 1).End(xlUp).Row\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1505752967, "creation_date": 1505752967, "answer_id": 46284366, "question_id": 46205226, "link": "https://stackoverflow.com/questions/46205226/vbahow-to-delete-all-useless-0-in-the-end-of-a-column/46284366#46284366", "title": "[VBA]How to delete all useless 0 in the end of a column", "body": "<p>you can use a formula in column B instead of using VBA</p>\n\n<p>assuming the table in your example to be at A1, put <code>=IF(ISBLANK(A3),\"\",A3-A2)</code> in B2 and copy down as far down as you like</p>\n"}], "owner": {"reputation": 7, "user_id": 8605006, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/66c3c64a3942a3d703985a3c3534427c?s=128&d=identicon&r=PG&f=1", "display_name": "Phoenix Ning", "link": "https://stackoverflow.com/users/8605006/phoenix-ning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505752967, "creation_date": 1505330019, "question_id": 46205226, "link": "https://stackoverflow.com/questions/46205226/vbahow-to-delete-all-useless-0-in-the-end-of-a-column", "title": "[VBA]How to delete all useless 0 in the end of a column", "body": "<p>My purpose needs to find out the time gap between every row.  It should go 1 second by 1 second, but you will see until 11:40, there is a large one. For example, the time A3-A2=B1. I solved this problem already, my code is the following. </p>\n\n<p>It runs OK, but in end of column B, there is a long list of 00:00:00. I want to match the last number of column B with column A, that means column B and A should have the same length. Thousands of 00:00:00 in the end.</p>\n\n<pre><code>Sub CalculateTimeGap()  \n\nColumns(\"B:B\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nRange(\"A1\").Value = \"Time\"\n\nColumns(\"A:A\").NumberFormat = \"hh:mm:ss\"\nColumns(\"B:B\").Formula = \"=A2-A1\"\nRange(\"B1\").Value = \"Time Difference(s)\"\nColumns(\"B:B\").NumberFormat = \"hh:mm:ss\"\n\nlRow = Cells(Rows.Count, 1).End(xlUp).Row\nEnd Sub\n\n\nTime      Time Difference(s)\n11:28:37    00:00:01\n11:28:38    00:00:01\n11:28:39    00:00:01\n11:28:40    00:11:35\n11:40:15    00:00:01\n11:40:16    00:00:01\n11:40:17    00:00:01\n11:40:18    00:00:01\n            00:00:00\n            00:00:00\n            00:00:00\n            00:00:00\n            00:00:00\n            00:00:00\n            00:00:00\n            00:00:00\n            00:00:00\n            00:00:00\n</code></pre>\n\n<p>I tried to add code inside to delete the 00:00:00 but it didn't work. </p>\n\n<pre><code>If Range(\"B\").Value = \"00:00:00\" Then\n    'Range(\"B\").Value.Delete\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1505329148, "post_id": 46204957, "comment_id": 79373189, "body": "And SUMIFS() is not sufficient?"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505329305, "post_id": 46204957, "comment_id": 79373268, "body": "Why are you splitting <code>fnd = &quot;1 Equipment&quot;</code> by the &quot;/&quot; element and creating an array? What you are searching for is <code>fnd</code>, so <code>.Find(what:=fnd, after:=LastCell)</code>"}, {"owner": {"reputation": 15, "user_id": 8571033, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZjpRDkTQ8PY/AAAAAAAAAAI/AAAAAAAAACY/vLtY_XOBIqM/photo.jpg?sz=128", "display_name": "Beatriz Gargaro", "link": "https://stackoverflow.com/users/8571033/beatriz-gargaro"}, "edited": false, "score": 0, "creation_date": 1505329751, "post_id": 46204957, "comment_id": 79373498, "body": "Got it done with SUMIFS. Thank you!"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505330667, "post_id": 46204957, "comment_id": 79373968, "body": "If you still want to use <code>.Find</code> i did something <a href=\"https://stackoverflow.com/questions/46196583/vba-find-a-range-of-same-values-in-a-column-and-calculate-average/46197830#46197830\">similar</a> today. Just instead of the Average, you would want to display <code>SumValues</code> on <code>Debug.Print</code>"}], "answers": [{"comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1505333990, "post_id": 46206187, "comment_id": 79375720, "body": "Though, I guess a SUMIFS() which is an Excel built-in function can do the trick too."}, {"owner": {"reputation": 15, "user_id": 8571033, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZjpRDkTQ8PY/AAAAAAAAAAI/AAAAAAAAACY/vLtY_XOBIqM/photo.jpg?sz=128", "display_name": "Beatriz Gargaro", "link": "https://stackoverflow.com/users/8571033/beatriz-gargaro"}, "edited": false, "score": 0, "creation_date": 1505345582, "post_id": 46206187, "comment_id": 79379904, "body": "Yeah, I got it done with SUMIFS(). But thank you so much for your answer!"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 0, "last_activity_date": 1505333960, "creation_date": 1505333960, "answer_id": 46206187, "question_id": 46204957, "link": "https://stackoverflow.com/questions/46204957/excel-vba-search-sum-engine/46206187#46206187", "title": "Excel VBA Search + Sum Engine", "body": "<p>I would do that more like a custom function to be added to the sheet where you find all the cells corresponding to a given value and you sum up the adjacent cell numbers: </p>\n\n<pre><code>Public Function SumInvestments(ByVal InvType As String) As Long\n\n    Dim allCells As Range\n    Dim singleCell As Range\n    Dim totalSum As Long\n\n    Set allCells = Range(\"A1:A\" &amp; Range(\"A1\").End(xlDown).Row).Find(InvType, lookAt:=xlWhole)\n    If Not allCells Is Nothing Then\n        For Each singleCell In allCells\n            totalSum = totalSum + singleCell.Offset(0,1).Value\n        Next singleCell  \n    End If\n    SumInvestments = totalSum\n\nEnd Function\n</code></pre>\n\n<p>To be used like this:</p>\n\n<pre><code>=SumInvestments(\"1 Equipment\")\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8571033, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZjpRDkTQ8PY/AAAAAAAAAAI/AAAAAAAAACY/vLtY_XOBIqM/photo.jpg?sz=128", "display_name": "Beatriz Gargaro", "link": "https://stackoverflow.com/users/8571033/beatriz-gargaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 46206187, "answer_count": 1, "score": 0, "last_activity_date": 1505333960, "creation_date": 1505328974, "question_id": 46204957, "link": "https://stackoverflow.com/questions/46204957/excel-vba-search-sum-engine", "title": "Excel VBA Search + Sum Engine", "body": "<p>I am trying to code a search + sum engine on Excel VBA. I have a list of entries, and what I need the code to do is search for a specific type of cost (for example \"1 Equipment\") and then it needs to sum all Equipment Costs and print it in a cell in another worksheet. Heres what I typed so far: </p>\n\n<pre><code>Sub Sample()\nDim fnd As String\nDim MyAr\nDim i As Long\nDim rng As Range, FoundCell As Range, LastCell As Range, myRange As Range\n\nSet myRange = ActiveSheet.UsedRange\nSet LastCell = myRange.Cells(myRange.Cells.Count)\n\nfnd = \"1 Equipment\"\n\nMyAr = Split(fnd, \"/\")\n\nFor i = LBound(MyAr) To UBound(MyAr)\n\n    Set FoundCell = myRange.Find(what:=MyAr(i), after:=LastCell)\n\n    If Not FoundCell Is Nothing Then\n        FirstFound = FoundCell.Address\n    End If\nSet rng = FoundCell\n        Do Until FoundCell Is Nothing\n            Set FoundCell = myRange.FindNext(after:=FoundCell)\n                Set rng = Union(rng, FoundCell)\n            If FoundCell.Address = FirstFound Then Exit Do\n        Loop\n\nIf Not rng Is Nothing Then\nrng.**(____in here it needs to sum the value of the cell in \nthe column to the right of where the word was found___)**\n\nEnd If\n\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>This is the picture of my list of values (I only have a few values typed, but the engine has to go all the way to the end of the worksheet): \n <a href=\"https://i.stack.imgur.com/ZPIc9.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/ZPIc9.png</a>\nIt needs to sum all the \"1 Equipment\" values and display the sum in another cell, so for this amount of entries, the answer would be 11750.</p>\n\n<p>I am a beginner with excel VBA so I really need help. Thank you! </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1505328732, "post_id": 46204879, "comment_id": 79372961, "body": "Totally aware this is a vague question. But this is all I have at the moment. I&#39;ll post code once I make a stronger attempt"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 1, "creation_date": 1505332861, "post_id": 46204879, "comment_id": 79375133, "body": "maybe <a href=\"https://stackoverflow.com/questions/14808104/sorting-a-dictionary-by-key-in-vba\">this</a> can help you."}], "answers": [{"comments": [{"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1505333002, "post_id": 46205941, "comment_id": 79375196, "body": "I did look at Chip&#39;s functions, but I was worried it was overkill. I actually got a quick sort method to work out! I&#39;ll post it soon. Thanks for the post, though! Chip is the man"}], "tags": [], "owner": {"reputation": 908, "user_id": 2322977, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/49c196ad6e4365c8f219c89030597728?s=128&d=identicon&r=PG", "display_name": "ainwood", "link": "https://stackoverflow.com/users/2322977/ainwood"}, "is_accepted": false, "score": 1, "last_activity_date": 1505332887, "last_edit_date": 1525816189, "creation_date": 1505332887, "answer_id": 46205941, "question_id": 46204879, "link": "https://stackoverflow.com/questions/46204879/custom-sorting-a-collection-of-class-by-class-property/46205941#46205941", "title": "Custom Sorting a Collection of Class by Class Property", "body": "<p>Chip Pearson has <a href=\"http://www.cpearson.com/excel/CollectionsAndDictionaries.htm\" rel=\"nofollow noreferrer\">This really good page on VBA Dictionaries</a>.  It includes how to convert collections, arrays and ranges to dictionaries (or to each other), and also how to sort dictionaries.</p>\n\n<p>The (quite long!) code for dictionary sorting is as follows:</p>\n\n<p>Use:</p>\n\n<pre><code>Public Sub SortDictionary(Dict As Scripting.Dictionary, _\nSortByKey As Boolean, _\nOptional Descending As Boolean = False, _\nOptional CompareMode As VbCompareMethod = vbTextCompare)\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n' SortDictionary\n' This sorts a Dictionary object. If SortByKey is False, the\n' the sort is done based on the Items of the Dictionary, and\n' these items must be simple data types. They may not be\n' Object, Arrays, or User-Defined Types. If SortByKey is True,\n' the Dictionary is sorted by Key value, and the Items in the\n' Dictionary may be Object as well as simple variables.\n'\n' If sort by key is True, all element of the Dictionary\n' must have a non-blank Key value. If Key is vbNullString\n' the procedure will terminate.\n'\n' By defualt, sorting is done in Ascending order. You can\n' sort by Descending order by setting the Descending parameter\n' to True.\n'\n' By default, text comparisons are done case-INSENSITIVE (e.g.,\n' \"a\" = \"A\"). To use case-SENSITIVE comparisons (e.g., \"a\" &lt;&gt; \"A\")\n' set CompareMode to vbBinaryCompare.\n'\n' Note: This procedure requires the\n' QSortInPlace function, which is described and available for\n' download at www.cpearson.com/excel/qsort.htm .\n'\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\nDim Ndx As Long\nDim KeyValue As String\nDim ItemValue As Variant\nDim Arr() As Variant\nDim KeyArr() As String\nDim VTypes() As VbVarType\n\n\nDim V As Variant\nDim SplitArr As Variant\n\nDim TempDict As Scripting.Dictionary\n'''''''''''''''''''''''''''''\n' Ensure Dict is not Nothing.\n'''''''''''''''''''''''''''''\nIf Dict Is Nothing Then\n    Exit Sub\nEnd If\n''''''''''''''''''''''''''''\n' If the number of elements\n' in Dict is 0 or 1, no\n' sorting is required.\n''''''''''''''''''''''''''''\nIf (Dict.Count = 0) Or (Dict.Count = 1) Then\n    Exit Sub\nEnd If\n\n''''''''''''''''''''''''''''\n' Create a new TempDict.\n''''''''''''''''''''''''''''\nSet TempDict = New Scripting.Dictionary\n\nIf SortByKey = True Then\n''''''''''''''''''''''''''''''''''''''''\n' We're sorting by key. Redim the Arr\n' to the number of elements in the\n' Dict object, and load that array\n' with the key names.\n''''''''''''''''''''''''''''''''''''''''\nReDim Arr(0 To Dict.Count - 1)\n\nFor Ndx = 0 To Dict.Count - 1\n    Arr(Ndx) = Dict.Keys(Ndx)\nNext Ndx\n\n''''''''''''''''''''''''''''''''''''''\n' Sort the key names.\n''''''''''''''''''''''''''''''''''''''\nQSortInPlace InputArray:=Arr, LB:=-1, UB:=-1, Descending:=Descending, CompareMode:=CompareMode\n''''''''''''''''''''''''''''''''''''''''''''\n' Load TempDict. The key value come from\n' our sorted array of keys Arr, and the\n' Item comes from the original Dict object.\n''''''''''''''''''''''''''''''''''''''''''''\nFor Ndx = 0 To Dict.Count - 1\n    KeyValue = Arr(Ndx)\n    TempDict.Add Key:=KeyValue, Item:=Dict.Item(KeyValue)\nNext Ndx\n'''''''''''''''''''''''''''''''''\n' Set the passed in Dict object\n' to our TempDict object.\n'''''''''''''''''''''''''''''''''\nSet Dict = TempDict\n''''''''''''''''''''''''''''''''\n' This is the end of processing.\n''''''''''''''''''''''''''''''''\nElse\n'''''''''''''''''''''''''''''''''''''''''''''''\n' Here, we're sorting by items. The Items must\n' be simple data types. They may NOT be Objects,\n' arrays, or UserDefineTypes.\n' First, ReDim Arr and VTypes to the number\n' of elements in the Dict object. Arr will\n' hold a string containing\n'   Item &amp; vbNullChar &amp; Key\n' This keeps the association between the\n' item and its key.\n'''''''''''''''''''''''''''''''''''''''''''''''\nReDim Arr(0 To Dict.Count - 1)\nReDim VTypes(0 To Dict.Count - 1)\n\nFor Ndx = 0 To Dict.Count - 1\n    If (IsObject(Dict.Items(Ndx)) = True) Or _\n        (IsArray(Dict.Items(Ndx)) = True) Or _\n        VarType(Dict.Items(Ndx)) = vbUserDefinedType Then\n        Debug.Print \"***** ITEM IN DICTIONARY WAS OBJECT OR ARRAY OR UDT\"\n        Exit Sub\n    End If\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    ' Here, we create a string containing\n    '       Item &amp; vbNullChar &amp; Key\n    ' This preserves the associate between an item and its\n    ' key. Store the VarType of the Item in the VTypes\n    ' array. We'll use these values later to convert\n    ' back to the proper data type for Item.\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        Arr(Ndx) = Dict.Items(Ndx) &amp; vbNullChar &amp; Dict.Keys(Ndx)\n        VTypes(Ndx) = VarType(Dict.Items(Ndx))\n\nNext Ndx\n''''''''''''''''''''''''''''''''''\n' Sort the array that contains the\n' items of the Dictionary along\n' with their associated keys\n''''''''''''''''''''''''''''''''''\nQSortInPlace InputArray:=Arr, LB:=-1, UB:=-1, Descending:=Descending, CompareMode:=vbTextCompare\n\nFor Ndx = LBound(Arr) To UBound(Arr)\n    '''''''''''''''''''''''''''''''''''''\n    ' Loop trhogh the array of sorted\n    ' Items, Split based on vbNullChar\n    ' to get the Key from the element\n    ' of the array Arr.\n    SplitArr = Split(Arr(Ndx), vbNullChar)\n    ''''''''''''''''''''''''''''''''''''''''''\n    ' It may have been possible that item in\n    ' the dictionary contains a vbNullChar.\n    ' Therefore, use UBound to get the\n    ' key value, which will necessarily\n    ' be the last item of SplitArr.\n    ' Then Redim Preserve SplitArr\n    ' to UBound - 1 to get rid of the\n    ' Key element, and use Join\n    ' to reassemble to original value\n    ' of the Item.\n    '''''''''''''''''''''''''''''''''''''''''\n    KeyValue = SplitArr(UBound(SplitArr))\n    ReDim Preserve SplitArr(LBound(SplitArr) To UBound(SplitArr) - 1)\n    ItemValue = Join(SplitArr, vbNullChar)\n    '''''''''''''''''''''''''''''''''''''''\n    ' Join will set ItemValue to a string\n    ' regardless of what the original\n    ' data type was. Test the VTypes(Ndx)\n    ' value to convert ItemValue back to\n    ' the proper data type.\n    '''''''''''''''''''''''''''''''''''''''\n    Select Case VTypes(Ndx)\n        Case vbBoolean\n            ItemValue = CBool(ItemValue)\n        Case vbByte\n            ItemValue = CByte(ItemValue)\n        Case vbCurrency\n            ItemValue = CCur(ItemValue)\n        Case vbDate\n            ItemValue = CDate(ItemValue)\n        Case vbDecimal\n            ItemValue = CDec(ItemValue)\n        Case vbDouble\n            ItemValue = CDbl(ItemValue)\n        Case vbInteger\n            ItemValue = CInt(ItemValue)\n        Case vbLong\n            ItemValue = CLng(ItemValue)\n        Case vbSingle\n            ItemValue = CSng(ItemValue)\n        Case vbString\n            ItemValue = CStr(ItemValue)\n        Case Else\n            ItemValue = ItemValue\n    End Select\n    ''''''''''''''''''''''''''''''''''''''\n    ' Finally, add the Item and Key to\n    ' our TempDict dictionary.\n\n    TempDict.Add Key:=KeyValue, Item:=ItemValue\nNext Ndx\nEnd If\n\n\n'''''''''''''''''''''''''''''''''\n' Set the passed in Dict object\n' to our TempDict object.\n'''''''''''''''''''''''''''''''''\nSet Dict = TempDict\nEnd Sub\n</code></pre>\n\n<p>Note the requirement for the <code>QSortInPlace</code> code.  I won't paste that here... you can get it from <a href=\"http://www.cpearson.com/excel/SortingArrays.aspx\" rel=\"nofollow noreferrer\">This Link</a></p>\n"}, {"tags": [], "owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "is_accepted": true, "score": 0, "last_activity_date": 1505334445, "last_edit_date": 1505334445, "creation_date": 1505333623, "answer_id": 46206111, "question_id": 46204879, "link": "https://stackoverflow.com/questions/46204879/custom-sorting-a-collection-of-class-by-class-property/46206111#46206111", "title": "Custom Sorting a Collection of Class by Class Property", "body": "<p>I figured it out! </p>\n\n<p>I can post the rest of the class, but basically it involves just finding the Minimum and Maximum value of the collection and then removing it once you've found it, and repeating the process until you reach a count of 0.</p>\n\n<p>Here is my code</p>\n\n<pre><code>Public Sub SortByVolume(Optional Descending As Boolean = True)\n\n    Dim TempDict As Dictionary\n    Dim benchMark As Double 'The benchmark to start with and go from there\n\n    Dim custCheck As Customer 'Customer to check during the loop\n\n    'Make sure the Dictionary isn't nothing\n    If sCustomers Is Nothing Then Exit Sub\n\n    'If the count is 0 or 1 we don't need a sort\n    If (sCustomers.Count = 0) Or (sCustomers.Count = 1) Then Exit Sub\n\n    'Create the temprary dictionary\n    Set TempDict = New Dictionary\n\n    'We need to loop through the Dictionary to get the highest Volume\n    'The Dictionary will load appending, so to descend we get the minimum value and build up, and vice versa for ascending\n    If Descending = False Then\n        benchMark = GetMaxVolume\n    Else\n        benchMark = GetMinVolume\n    End If\n\n    'Do everything until the benchmark is matched\n    'Load everything into the TempDict, removing it from the original\n    Do While sCustomers.Count &gt; 0\n\n        For Each pKey In sCustomers.Keys\n\n            Set custCheck = sCustomers(pKey)\n            If custCheck.SumPoundsSold = benchMark Then\n                'benchmark has been met. Load this customer into TempDict\n                TempDict.Add custCheck.Name, custCheck\n                sCustomers.Remove pKey 'Remove the customer\n                benchMark = IIf(Descending = True, GetMinVolume, GetMaxVolume)\n                Set custCheck = Nothing\n                Exit For\n            End If\n\n        Next pKey\n\n    Loop\n\n    'Set the Class' customer dictionary to the Temporary Dictionary\n    Set sCustomers = TempDict\n\n    'Set the TempDict to nothing\n    Set TempDict = Nothing\n\n\nEnd Sub\n\nPublic Function GetMaxVolume() As Double\n\n    Dim highVol As Double: highVol = 0\n    Dim checkCust As Customer\n\n    For Each pKey In sCustomers.Keys\n        Set checkCust = sCustomers(pKey)\n        If checkCust.SumPoundsSold &gt; highVol Then\n            highVol = checkCust.SumPoundsSold\n        End If\n    Next pKey\n\n    GetMaxVolume = highVol\n\nEnd Function\n\nPublic Function GetMinVolume() As Double\n\n    Dim lowVol As Double: lowVol = 1.79769313486232E+307\n    Dim checkCust As Customer\n\n    For Each pKey In sCustomers.Keys\n        Set checkCust = sCustomers(pKey)\n        If checkCust.SumPoundsSold &lt;= lowVol Then\n            lowVol = checkCust.SumPoundsSold\n        End If\n    Next pKey\n\n    GetMinVolume = lowVol\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 419, "user_id": 4352306, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Hh7mG.jpg?s=128&g=1", "display_name": "rellampec", "link": "https://stackoverflow.com/users/4352306/rellampec"}, "is_accepted": false, "score": 0, "last_activity_date": 1552704623, "creation_date": 1552704623, "answer_id": 55192997, "question_id": 46204879, "link": "https://stackoverflow.com/questions/46204879/custom-sorting-a-collection-of-class-by-class-property/55192997#55192997", "title": "Custom Sorting a Collection of Class by Class Property", "body": "<p>well, your solution works, but does extra unnecessary loops and it uses unnecessary helper functions...</p>\n\n<p>As sorting dictionaries (and collections) in VBA is a bit of a mess, it is better to use a temporary array that you use to sort.</p>\n\n<p>The full process would be:</p>\n\n<ol>\n<li>check input &amp; manage optional parameters</li>\n<li>init auxiliary array to sort the elements</li>\n<li>sort the elements in the array</li>\n<li>build a new dictionary using the already sorted array</li>\n</ol>\n\n<p>In the following example I just added one optional parameter to make your function reusable for customer dictionaries other than <code>sCusomters</code> variable:</p>\n\n<pre><code>Public Function SortByVolume(Optional Descending As Boolean = True, _\n    Optional dicCustomers As Object = Nothing) As Object\n\n Dim blnInputParam As Boolean\n Dim pKey As Variant, I As Integer, J As Integer\n Dim arrSort() As Customer, blnSwap as Boolean\n Dim cusPosI As Customer, cusCur As Customer\n Dim dicTemp As Object\n\n On Error Resume Next\n\n Set SortByVolume = Nothing\n\n ' allow to use the function with other customer dictionaries\n blnInputParam = True\n If dicCustomers Is Nothing Then\n    blnInputParam = False\n    Set dicCustomers = sCustomers\n End If\n\n ' validate\n If dicCustomers is Nothing Then Exit Function\n If dicCustomers.Count = 0 Then Exit Function\n\n ' populate array\n ReDim arrSort(dicCustomers.Count - 1)\n I = 0\n For Each pKey In dicCustomers.Keys\n    Set arrSort(I) = dicCustomers(pKey)\n    I = I + 1\n Next\n\n ' sort array\n For I = LBound(arrSort) To UBound(arrSort) - 1\n    Set cusPosI = arrSort(I)\n    For J = I + 1 To UBound(arrSort)\n        Set cusCur = arrSort(J)\n\n        blnSwap = _\n          (Descending AND (cusCur.SumPoundsSold &gt; cusPosI.SumPoundsSold)) OR _\n          ((Not Descending) AND (cusCur.SumPoundsSold &lt; cusPosI.SumPoundsSold)\n\n        If blnSwap Then\n            Set arrSort(J) = cusPosI\n            Set arrSort(I) = cusCur\n            Set cusPosI = cusCur\n        End If\n    Next\n Next\n\n ' prepare output dictionary\n Set dicTemp = CreateObject(\"Scripting.Dictionary\")\n dicTemp.CompareMode = BinaryCompare\n\n For I = LBound(arrSort) To UBound(arrSort)\n    Set cusPosI = arrSort(I)\n    dicTemp.Add cusPosI.pKey, cusPosI\n Next\n\n ' if input param wasn't used, set to default customers' dictionary\n If Not blnInputParam Then Set sCustomers = dicTemp\n Set SortByVolume = dicTemp\nEnd Function\n</code></pre>\n\n<p><strong>The usage</strong></p>\n\n<pre><code>set myDicOfCustomers = SortByVolume(dicCustomers:=myDicOfCustomers)\nset myDicOfCustomers = SortByVolume(Descending:=False, dicCustomers:=myDicOfCustomers)\n\n' and you can still launch it against your default dictionary of customers like this\nSortByVolume \nSortByVolume Descending:=False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 362, "user_id": 2752308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574f9f2cb6733e7ebcdd340d6ec14b25?s=128&d=identicon&r=PG&f=1", "display_name": "Marcelo Scofano Diniz", "link": "https://stackoverflow.com/users/2752308/marcelo-scofano-diniz"}, "is_accepted": false, "score": 0, "last_activity_date": 1585858290, "creation_date": 1585858290, "answer_id": 61000287, "question_id": 46204879, "link": "https://stackoverflow.com/questions/46204879/custom-sorting-a-collection-of-class-by-class-property/61000287#61000287", "title": "Custom Sorting a Collection of Class by Class Property", "body": "<p>It is an old thread, I know, but I too had this need, and mine added <strong>sort an Array property by some index</strong>. But this is the last optional arg, it functions too for the OP question.</p>\n\n<p>So, although I used things from this thread, very helpful, I preferred not use Dictionary - tons of legacy code already built in pure Collections...  - I mainly adapted code from <a href=\"https://stackoverflow.com/a/10273403/2752308\">here</a> and <a href=\"http://www.freevbcode.com/ShowCode.asp?ID=4522\" rel=\"nofollow noreferrer\">there</a>.</p>\n\n<pre><code>Public Function SortIt(ByVal col As Collection, ByVal SortPropertyName As String _\n            , ByVal AsAscending As Boolean, Optional ByVal KeyPropertyName As String _\n            , Optional ByVal CallByNameArg As Variant) As Collection\n\nDim this As Object\nDim i As Integer, j As Integer\nDim MinMaxIndex As Integer\nDim MinMax As Variant, thisValue As Variant\nDim SortCondition As Boolean\nDim UseKey As Boolean, thisKey As String\n\n    UseKey = (KeyPropertyName &lt;&gt; \"\")\n    For i = 1 To col.Count - 1\n        Set this = col(i)\n        If IsMissing(CallByNameArg0) Then\n            MinMax = CallByName(this, SortPropertyName, VbGet)\n        Else\n            MinMax = CallByName(this, SortPropertyName, VbGet, CallByNameArg)\n        End If\n        MinMaxIndex = i\n        For j = i + 1 To col.Count\n            Set this = col(j)\n            If IsMissing(CallByNameArg0) Then\n                thisValue = CallByName(this, SortPropertyName, VbGet)\n            Else\n                thisValue = CallByName(this, SortPropertyName, VbGet, CallByNameArg)\n            End If\n            If (AsAscending) Then\n                SortCondition = (thisValue &lt; MinMax)\n            Else\n                SortCondition = (thisValue &gt; MinMax)\n            End If\n            If (SortCondition) Then\n                MinMax = thisValue\n                MinMaxIndex = j\n            End If\n            Set this = Nothing\n        Next j\n        If (MinMaxIndex &lt;&gt; i) Then\n            Set this = col(MinMaxIndex)\n            col.Remove MinMaxIndex\n            If (UseKey) Then\n                If IsMissing(CallByNameArg0) Then\n                    thisKey = CallByName(this, KeyPropertyName, VbGet)\n                Else\n                    thisKey = CallByName(this, KeyPropertyName, VbGet, CallByNameArg)\n                End If\n                col.Add this, thisKey, i\n            Else\n                col.Add this, , i\n            End If\n            Set this = Nothing\n        End If\n        Set this = Nothing\n    Next i\n    Set SortIt = col\nEnd Function\n</code></pre>\n\n<p>Hope it helps someone.</p>\n"}], "owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 804, "favorite_count": 1, "accepted_answer_id": 46206111, "answer_count": 4, "score": 0, "last_activity_date": 1585858290, "creation_date": 1505328699, "last_edit_date": 1531164843, "question_id": 46204879, "link": "https://stackoverflow.com/questions/46204879/custom-sorting-a-collection-of-class-by-class-property", "title": "Custom Sorting a Collection of Class by Class Property", "body": "<p>I have a dilemma that I'm not sure how to approach head-on. I have three classes </p>\n\n<p>A <code>Segment</code> Class, that has a Dictionary of <code>Customer</code> Classes, which in turn have Dictionaries of <code>Product</code> classes. The Dictionary of <code>Customer</code> classes needs to be sorted by a property of <code>SumPoundsSold</code>. </p>\n\n<p>I honestly don't know where to start. Any hints?</p>\n\n<p>I've figured it out and answered below. Also thanks to ainwood for posting Chip Pearson's code for sorting Collections/Dictionaries!</p>\n"}, {"tags": ["arrays", "vba", "solidworks"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8412345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f7f41f56023053d19234a4f20acc8b?s=128&d=identicon&r=PG&f=1", "display_name": "bieringm", "link": "https://stackoverflow.com/users/8412345/bieringm"}, "edited": false, "score": 0, "creation_date": 1505387017, "post_id": 46209876, "comment_id": 79397222, "body": "This is exactly what I needed. Thank you. One more question, would it be possible to add a double of the selected item if it is not part of a consecutive sequence. i.e. if the listbox selection was: 1, 3, 4, 5. I need the array to show: 1, 1, 3, 5."}, {"owner": {"reputation": 33, "user_id": 8412345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f7f41f56023053d19234a4f20acc8b?s=128&d=identicon&r=PG&f=1", "display_name": "bieringm", "link": "https://stackoverflow.com/users/8412345/bieringm"}, "edited": false, "score": 0, "creation_date": 1505388139, "post_id": 46209876, "comment_id": 79397910, "body": "Seems I have solved my question. I just added If prev And nxt Then below the If Or line and all is good."}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 2, "last_activity_date": 1505409010, "last_edit_date": 1505409010, "creation_date": 1505358472, "answer_id": 46209876, "question_id": 46204857, "link": "https://stackoverflow.com/questions/46204857/check-if-array-is-consecutive-then-delete-values-in-between-vba/46209876#46209876", "title": "Check if array is consecutive then delete values in between vba", "body": "<p>With these values in the listbox (all selected), you get:</p>\n\n<pre><code>ListBox  Result -&gt; Array(1, 3, 5, 7, 9, 11)\n   1        1\n   3        3\n   4  \n   5        5\n   7        7\n   8  \n   9        9\n  11       11\n</code></pre>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub GetMinMaxOfConsecutives()\n    Dim sheets() As Long, i As Long, totalItms As Long\n    Dim prev As Boolean, nxt As Boolean, used As Long, this As Long\n\n    used = 1\n    With ListBox1    'Sheet1.ListBox1\n        totalItms = .ListCount - 1\n        ReDim sheets(1 To totalItms)\n        For i = 1 To totalItms - 1\n            If .Selected(i) Then\n                this = .List(i)\n                prev = IIf(.Selected(i - 1), this - 1 &lt;&gt; .List(i - 1), True)\n                nxt = IIf(.Selected(i + 1), this + 1 &lt;&gt; .List(i + 1), True)\n                If prev Or nxt Then\n                    sheets(used) = this\n                    used = used + 1\n                End If\n            End If\n        Next\n        If .Selected(i) Then sheets(used) = .List(i) Else used = used - 1\n        If used &gt; 0 Then ReDim Preserve sheets(1 To used) Else ReDim sheets(0)\n        'ShowArray sheets\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub ShowArray(ByRef arr() As Long)\n    Dim i As Long\n    For i = LBound(arr) To UBound(arr)\n        Debug.Print arr(i)\n    Next\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>To double the items not part of a sequence make sure to increase the initial array size to accommodate for this case:</p>\n\n<pre><code>ListBox  Result -&gt; Array(1, 1, 3, 3, 5, 5, 7, 7, 9, 9)\n   1\n   3\n   5\n   7\n   9\n</code></pre>\n\n<hr>\n\n<pre><code>Public Sub GetMinMaxOfConsecutives2()\n    Dim sheets() As Long, i As Long, totalItms As Long\n    Dim prev As Boolean, nxt As Boolean, used As Long, this As Long\n\n    used = 1\n    With ListBox1\n        totalItms = .ListCount - 1\n\n        ReDim sheets(1 To totalItms * 2 + 1)    '&lt;-- double upper bound\n\n        For i = 1 To totalItms - 1\n            If .Selected(i) Then\n                this = .List(i)\n\n                prev = IIf(.Selected(i - 1), this - 1 &lt;&gt; .List(i - 1), True)\n                nxt = IIf(.Selected(i + 1), this + 1 &lt;&gt; .List(i + 1), True)\n\n                If prev Or nxt Then\n                    If prev And nxt Then\n                        sheets(used) = this\n                        used = used + 1\n                    End If\n                    sheets(used) = this\n                    used = used + 1\n                End If\n\n            End If\n        Next\n\n        If .Selected(i) Then sheets(used) = .List(i) Else used = used - 1\n        If used &gt; 0 Then ReDim Preserve sheets(1 To used) Else ReDim sheets(0)\n        'ShowArray sheets\n\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Note:</strong></p>\n\n<p>If you use the <code>ListFillRange</code> property to fill in the items in the listbox make sure you don't use entire columns, for example don't use <code>\"A:A\"</code> because this will add 1+ M items to the list (even empty cells)</p>\n\n<p>If Microsoft decides to increase the grid size to a billion rows in a new Excel version, working with the listbox will take a long time</p>\n\n<p>Instead always populate it with the used range from the respective column:</p>\n\n<p><code>ListBox1.ListFillRange = Sheet1.UsedRange.Columns(1).Address</code></p>\n"}], "owner": {"reputation": 33, "user_id": 8412345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f7f41f56023053d19234a4f20acc8b?s=128&d=identicon&r=PG&f=1", "display_name": "bieringm", "link": "https://stackoverflow.com/users/8412345/bieringm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 2, "accepted_answer_id": 46209876, "answer_count": 1, "score": 1, "last_activity_date": 1505409010, "creation_date": 1505328591, "question_id": 46204857, "link": "https://stackoverflow.com/questions/46204857/check-if-array-is-consecutive-then-delete-values-in-between-vba", "title": "Check if array is consecutive then delete values in between vba", "body": "<p>I currently have an array that is being set by selected items from a listbox. I need to know how to check to see if there are consecutive values in the array then delete the values that are between the lowest and highest values of the consecutive numbers. </p>\n\n<p>Here is an example to show what I mean:</p>\n\n<pre><code>Dim sheets() As Long\nDim Selected As String\n\nReDim sheets(i)\nFor i = 1 To ListBox1.ListCount - 1\n    If ListBox1.Selected(i) = True Then\n        Selected = ListBox1.List(i)\n        ReDim Preserve sheets(i)\n        sheets(i) = Selected\n    End If\nNext i\n</code></pre>\n\n<p>The array is used for a Solidworks API function that sets the print sheet range. This is why I cant have more than 2 consecutive numbers. </p>\n\n<p>That being said if there is an easier way to do this based on deselecting the consecutive listbox items I am all ears for that too.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 384, "user_id": 4475468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d04747a9bf180c8fb9fc145ec5133d1?s=128&d=identicon&r=PG", "display_name": "Joffan", "link": "https://stackoverflow.com/users/4475468/joffan"}, "edited": false, "score": 2, "creation_date": 1505328408, "post_id": 46204782, "comment_id": 79372785, "body": "Do you have some code, and examples of when it does and doesn&#39;t happen?"}, {"owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "edited": false, "score": 0, "creation_date": 1505331413, "post_id": 46204782, "comment_id": 79374403, "body": "<code>Cell(x,y).NumberFormat = &quot;0.##########&quot;</code> with <code>#&#39;s</code> equal to the max number of digits past the decimal?"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 7643030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9e07083eb84b074caecdd24daef861f?s=128&d=identicon&r=PG&f=1", "display_name": "ADuff", "link": "https://stackoverflow.com/users/7643030/aduff"}, "is_accepted": false, "score": 0, "last_activity_date": 1505333079, "creation_date": 1505333079, "answer_id": 46205986, "question_id": 46204782, "link": "https://stackoverflow.com/questions/46204782/vba-how-to-stop-when-setting-cells-equal-to-each-other-automatically-changes-sma/46205986#46205986", "title": "VBA How to stop when setting cells equal to each other automatically changes small numbers to a percentage?", "body": "<p>I found a solution to my problem, I just selected the entire range of numbers once they had been pasted and selected them before doing:  </p>\n\n<p><code>Selection.NumberFormat = \"General\"</code></p>\n"}], "owner": {"reputation": 3, "user_id": 7643030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9e07083eb84b074caecdd24daef861f?s=128&d=identicon&r=PG&f=1", "display_name": "ADuff", "link": "https://stackoverflow.com/users/7643030/aduff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1505333079, "creation_date": 1505328302, "last_edit_date": 1531164843, "question_id": 46204782, "link": "https://stackoverflow.com/questions/46204782/vba-how-to-stop-when-setting-cells-equal-to-each-other-automatically-changes-sma", "title": "VBA How to stop when setting cells equal to each other automatically changes small numbers to a percentage?", "body": "<p>When I am setting two cells to each other, if the number is too small it automatically sets the receiving cell to a percentage and not the actual number, how do I avoid this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 2, "creation_date": 1505328590, "post_id": 46204512, "comment_id": 79372900, "body": "<a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>, to clean and optimize you could go to <a href=\"https://codereview.stackexchange.com/\">Code Review Community</a>"}, {"owner": {"reputation": 23, "user_id": 8604953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68dbff76e0c0df1be6ecbd6a9dfca3fe?s=128&d=identicon&r=PG&f=1", "display_name": "Tim G", "link": "https://stackoverflow.com/users/8604953/tim-g"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505330633, "post_id": 46204512, "comment_id": 79373952, "body": "Thanks Danieltakeshi and I will use that site.  And I will check out this other post as well.  Thank you for your insight."}, {"owner": {"reputation": 23, "user_id": 8604953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68dbff76e0c0df1be6ecbd6a9dfca3fe?s=128&d=identicon&r=PG&f=1", "display_name": "Tim G", "link": "https://stackoverflow.com/users/8604953/tim-g"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505332581, "post_id": 46204512, "comment_id": 79374987, "body": "Hi Danieltakeshi, the code you mentioned in the similar question works great for speed, and I will look into that, but the output only gives the list of unique values from A.  I need all the identical values set to a range (could be 1, or it could be 20 identical values), and then run code on all the identical values."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505333485, "post_id": 46204512, "comment_id": 79375423, "body": "You need to remove the conditional that gets unique values ` If x = 1 Then` to make a logic for your need. Like If the value is &lt; 4. And change the index of <code>.Cells</code> from column A (1) to C(3)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8604953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68dbff76e0c0df1be6ecbd6a9dfca3fe?s=128&d=identicon&r=PG&f=1", "display_name": "Tim G", "link": "https://stackoverflow.com/users/8604953/tim-g"}, "edited": false, "score": 1, "creation_date": 1505445779, "post_id": 46207885, "comment_id": 79425999, "body": "Wow, my friend, that is brilliant!  And it works!  I went over the code and it makes logical sense, and I will utilize arrays like this going forward.  Thank you again!"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 23, "user_id": 8604953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68dbff76e0c0df1be6ecbd6a9dfca3fe?s=128&d=identicon&r=PG&f=1", "display_name": "Tim G", "link": "https://stackoverflow.com/users/8604953/tim-g"}, "edited": false, "score": 0, "creation_date": 1505476714, "post_id": 46207885, "comment_id": 79441403, "body": "Glad it helped!"}, {"owner": {"reputation": 23, "user_id": 8604953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68dbff76e0c0df1be6ecbd6a9dfca3fe?s=128&d=identicon&r=PG&f=1", "display_name": "Tim G", "link": "https://stackoverflow.com/users/8604953/tim-g"}, "edited": false, "score": 0, "creation_date": 1505493893, "post_id": 46207885, "comment_id": 79452342, "body": "I actually do have a question about the code. My actual spreadsheet is much larger obviously, and when I update the variables and constants, I get the error &quot;Object variable or With block variable not set&quot;. When I change it all back to use Worksheet 2 and column C, it works again. I have figured out that is has something to do with declaring ws1 = sheet1  and ws2 = sheet2.  I had to change it to Sheets(1) and Sheets(x).  X is the sheet number in the workbook. So where is sheet1 and sheet2 in your code being pulled from?  I have the code now working but no data is being copied."}, {"owner": {"reputation": 23, "user_id": 8604953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68dbff76e0c0df1be6ecbd6a9dfca3fe?s=128&d=identicon&r=PG&f=1", "display_name": "Tim G", "link": "https://stackoverflow.com/users/8604953/tim-g"}, "edited": false, "score": 1, "creation_date": 1505495000, "post_id": 46207885, "comment_id": 79452862, "body": "I have it working now in terms of the data being copied.  I had the column wrong ;(.  I still am curious why it worked initially with the sheet1 and sheet2."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 23, "user_id": 8604953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68dbff76e0c0df1be6ecbd6a9dfca3fe?s=128&d=identicon&r=PG&f=1", "display_name": "Tim G", "link": "https://stackoverflow.com/users/8604953/tim-g"}, "edited": false, "score": 0, "creation_date": 1505522781, "post_id": 46207885, "comment_id": 79462359, "body": "I added more details about different ways to refer to sheets (see Edited part) - when you modify references to the sheets try to use the CodeName as it&#39;s much more reliable"}, {"owner": {"reputation": 23, "user_id": 8604953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68dbff76e0c0df1be6ecbd6a9dfca3fe?s=128&d=identicon&r=PG&f=1", "display_name": "Tim G", "link": "https://stackoverflow.com/users/8604953/tim-g"}, "edited": false, "score": 1, "creation_date": 1505626282, "post_id": 46207885, "comment_id": 79485425, "body": "I did not realize that!  Thank you very much!  I will use this and clean up almost all my code!  \ud83d\ude04"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 0, "last_activity_date": 1505522618, "last_edit_date": 1505522618, "creation_date": 1505342536, "answer_id": 46207885, "question_id": 46204512, "link": "https://stackoverflow.com/questions/46204512/find-identical-data-in-column-and-filter-it-to-another-sheet/46207885#46207885", "title": "Find identical data in Column and filter it to another sheet", "body": "<p>This will iterate through each unique value in column A, Sheet1 with these steps</p>\n\n<ol>\n<li>Filter col A</li>\n<li>Apply the second filter to column C (&lt; 4)\n\n<ul>\n<li>If any rows are visible copies them to the first empty cell in Col A of Sheet2</li>\n</ul></li>\n</ol>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub FindIdenticalInALessThan4InC()\n    Const COL_A = 1\n    Const COL_C = 3\n    Const LESS_THAN_4 = \"&lt;4\"\n    Dim ws1 As Worksheet, ws2 As Worksheet, lrWs1 As Long, lrWs2 As Long\n    Dim arrA As Variant, d As Object, i As Long, unique As Variant, maxRows As Long\n\n    Set ws1 = Sheet1:  Set ws2 = Sheet2                 'ws2 = CodeName for Sheets(\"mm\")\n    maxRows = Rows.Count\n    If ws1.AutoFilterMode Then ws1.UsedRange.AutoFilter 'clear filters\n    lrWs1 = ws1.Cells(maxRows, \"A\").End(xlUp).Row + 1\n    lrWs2 = ws2.Cells(maxRows, \"A\").End(xlUp).Row + 1\n    If lrWs1 &gt; 1 Then                                   'expects first row as headers\n        Set d = CreateObject(\"Scripting.Dictionary\")\n        arrA = ws1.Range(ws1.Cells(1, COL_A), ws1.Cells(lrWs1, COL_A))\n        For i = 2 To lrWs1\n            d(arrA(i, 1)) = vbNullString                'get uniques from col A\n        Next\n        Application.ScreenUpdating = False\n        For Each unique In d\n            With ws1.UsedRange\n                .AutoFilter Field:=COL_A, Criteria1:=unique\n                .AutoFilter Field:=COL_C, Criteria1:=LESS_THAN_4, Operator:=xlAnd\n                If .Columns(1).SpecialCells(xlCellTypeVisible).CountLarge &gt; 1 Then\n                    .Offset(1).Resize(lrWs1 - 2, .Columns.Count).Copy ws2.Cells(lrWs2, \"A\")\n                    lrWs2 = ws2.Cells(maxRows, \"A\").End(xlUp).Row + 1\n                End If\n                .AutoFilter\n            End With\n        Next\n        Application.ScreenUpdating = True\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Sheet1 and Sheet2</p>\n\n<p><a href=\"https://i.stack.imgur.com/AIVIA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AIVIA.png\" alt=\"Sheet1\"></a><a href=\"https://i.stack.imgur.com/wtJcX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wtJcX.png\" alt=\"Sheet2\"></a></p>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>There are 3 ways to refer to sheets:</p>\n\n<ul>\n<li>Sheet Name (or Tab Name) - The name visible by user in the tab (lower-left)</li>\n<li>Sheet Index (or Tab Index) - The order of the tab as it appears to the user (lower-left)</li>\n<li>CodeName - this is the name of the sheet only visible in the VBA editor (top-left)</li>\n</ul>\n\n<p>In the code bellow we are referring to the same sheet:</p>\n\n<pre><code>Public Sub SheetNames()\n    Dim ws2 As Worksheet\n\n    ws2 = Sheets(\"Sheet2\")    'Tab Name\n    ws2 = Sheets(2)           'Tab Index\n    ws2 = Sheet2              'CodeName (visible only in the VBA editor)\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>References to the sheet:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1xHNl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1xHNl.png\" alt=\"TabNames\"></a><a href=\"https://i.stack.imgur.com/QflCt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QflCt.png\" alt=\"VBANames\"></a></p>\n\n<p>The CodeName is more reliable in VBA because normal users will not edit it (unlikely to change)</p>\n\n<p>Another distinction to be made is between the <code>Sheets()</code> collection and the <code>Worksheets()</code> collection:</p>\n\n<blockquote>\n  <p>The Sheets collection consist of not only a collection of worksheets but also other types of sheets to include Chart sheets (...)</p>\n</blockquote>\n\n<p>(<a href=\"https://blogs.msdn.microsoft.com/frice/2007/12/05/excels-worksheets-and-sheets-collection-whats-the-difference/\" rel=\"nofollow noreferrer\">more details from Microsoft</a>)</p>\n"}], "owner": {"reputation": 23, "user_id": 8604953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68dbff76e0c0df1be6ecbd6a9dfca3fe?s=128&d=identicon&r=PG&f=1", "display_name": "Tim G", "link": "https://stackoverflow.com/users/8604953/tim-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 46207885, "answer_count": 1, "score": 2, "last_activity_date": 1505522618, "creation_date": 1505327305, "last_edit_date": 1531164843, "question_id": 46204512, "link": "https://stackoverflow.com/questions/46204512/find-identical-data-in-column-and-filter-it-to-another-sheet", "title": "Find identical data in Column and filter it to another sheet", "body": "<p>I have spent hours on this code, and truthfully need some better expert opinion.</p>\n\n<p>Column A on Sheet 1 has dynamic list of data, typically IP address, but for this it is simply a number.  There can be duplicates or not.</p>\n\n<p>I need to find all identical data in column A, select it, and run specific code for it, then run the same code for each sets of identical data in A.  My code is to find values in column C that matches the criteria of Less Than 4, or &lt;4.  Column C will only have values from 1 to 5.  <strong>Goal is for each set of identical data in A, to then look at C and select any value in C that is only 1, 2, or 3, and NOT 4 or 5, and copy the entire row to another sheet when that is true.</strong></p>\n\n<p>My code works, kinda, but is slow, and does not account for if there is no data to copy.</p>\n\n<p>Right now I use a sheet called Test to find unique data from A, then copy the identical data in A to a sheet called mm, filter the data, then copy only the filtered data to the sheet data.  Contents in M are deleted on each loop and Test is deleted at the end of the code.</p>\n\n<p>Please help me clean this up and make it faster.  An image link is below if you want to see example data.</p>\n\n<p>Credit goes to christodorov for getting me started as I used his base code.</p>\n\n<pre><code>Dim currentCell As Long\nDim numOfValues As Long\n\nSub filterNextResult()\n\n' copy and move the data from the data sheet, column A (can be changed if needed) to a new sheet called \"temp\"\n\n\n' check to make sure there is at least 1 data point in column A on the temp sheet\nIf currentCell = 0 Then\nApplication.ScreenUpdating = False\nCall createNewTemp\nApplication.ScreenUpdating = True\nEnd If\n\n' find the total number of unique data points we will be filtering by in column A of the temp sheet\nIf numOfAccounts = 0 Then\nApplication.ScreenUpdating = False\nCall findNumOfValues\nApplication.ScreenUpdating = True\nEnd If\n\nDim X As Integer\nDim lr As Long\nDim lrdata As Long\nDim Lastmm As Integer\nlr = Sheets(\"mm\").Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nlrdata = Sheets(\"data\").Cells(Rows.Count, \"A\").End(xlUp).Row + 1\ncurrentCell = 2\nnumOfValues = 21\n'MsgBox (currentCell)\n\nOn Error Resume Next\nFor X = 1 To numOfValues\n        With Sheet1.UsedRange\n            .AutoFilter 1, Worksheets(\"temp\").Range(\"A\" &amp; currentCell).Value\n            Set filRange = .Offset(1).Resize(.Rows.Count - 1, 1).SpecialCells(xlCellTypeVisible)\n                If Not IsEmpty(filRange) Then\n                filRange.EntireRow.Copy Destination:=Sheets(\"mm\").Range(\"A\" &amp; lr)\n                Worksheets(\"mm\").Activate\n                Range(\"A1\").Select\n'                Range(\"A1\" &amp; .Cells(Rows.Count, 1).End(xlUp).Row).Select\n                    With Range(\"A1\")\n'                        .AutoFilter\n                        .AutoFilter Field:=3, Criteria1:=\"&lt;4\"\n                            Lastmm = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n                            Range(\"A2:C\" &amp; Lastmm).Select\n                            Selection.Copy\n                            Worksheets(\"data\").Activate\n                            Range(\"A\" &amp; lrdata).PasteSpecial Paste:=xlPasteValues\n                            Application.CutCopyMode = False\n                            lrdata = Sheets(\"data\").Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n                            Worksheets(\"mm\").Activate\n                            Range(\"A1\").Select\n                            Worksheets(\"mm\").AutoFilterMode = False\n                            Lastmm = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n                            Range(\"A2:C\" &amp; Lastmm).Select\n                            Selection.Delete shift:=xlToLeft\n\n                    End With\n                'Range(\"A1\" &amp; .Cells(Rows.Count, 1).End(xlUp).Row).Select\n                'With Selection\n'                lr = Sheets(\"mm\").Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n                End If\n            currentCell = currentCell + 1\n        '    MsgBox (currentCell)\n        '    MsgBox (numOfValues)\n'            .AutoFilter\n        End With\n\nNext X\n\n\nApplication.DisplayAlerts = False\nWorksheets(\"temp\").Delete\nApplication.DisplayAlerts = True\n\nEnd Sub\n\n'sub that will look for the number of values on the temp sheet column a\nPrivate Sub findNumOfValues()\n' count the number of non empty cells and assign that value (less 1 for the title in our case) to the numOfValues\nnumOfValues = Worksheets(\"temp\").Range(\"A:A\").Cells.SpecialCells(xlCellTypeConstants).Count\n'    MsgBox (numOfValues)\nEnd Sub\n\nPrivate Sub createNewTemp()\n\nSheet1.Range(\"A:C\").Copy\n'ActiveWorkbook.Sheets.Add.Name = \"temp\"\nSheets.Add(After:=Sheets(Sheets.Count)).Name = \"temp\"\n\n' remove duplicates\nWorksheets(\"temp\").Range(\"A1\").Select\nWith ActiveWorkbook.ActiveSheet\n    .Paste\n    .Range(\"A:C\").RemoveDuplicates Columns:=Array(1), Header:=xlYes\nEnd With\n\n' check to make sure there are vlaues in the temp sheet\nIf Worksheets(\"temp\").Range(\"A2\").Value = \"\" Then\n    MsgBox \"There are no filter values\"\n    End\nElse\n    currentCell = 2\nEnd If\n\n'MsgBox (currentCell)\n\nSheet1.Activate\nSheet1.Range(\"A1\").Select\nSelection.AutoFilter\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/CZtZR.png\" rel=\"nofollow noreferrer\">Example spreadsheet looks like this</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 384, "user_id": 4475468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d04747a9bf180c8fb9fc145ec5133d1?s=128&d=identicon&r=PG", "display_name": "Joffan", "link": "https://stackoverflow.com/users/4475468/joffan"}, "edited": false, "score": 0, "creation_date": 1505327987, "post_id": 46204470, "comment_id": 79372532, "body": "It seems like you just want intInner to be bigger than intOuter..."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 5373664, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/034dba41b4d2c2e263ee6a13f3f9fd4a?s=128&d=identicon&r=PG&f=1", "display_name": "Rico ", "link": "https://stackoverflow.com/users/5373664/rico"}, "edited": false, "score": 0, "creation_date": 1505328434, "post_id": 46204715, "comment_id": 79372802, "body": "Thanks, @BrianMStafford I knew I was close I think I was looking at this to0 long and my brain over thought it. I really appreciate the help."}], "tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": true, "score": 1, "last_activity_date": 1505328029, "creation_date": 1505328029, "answer_id": 46204715, "question_id": 46204470, "link": "https://stackoverflow.com/questions/46204470/vba-matching-pairs-without-duplicates/46204715#46204715", "title": "VBA matching Pairs without Duplicates", "body": "<p>Looks like you were close!  Try this:</p>\n\n<pre><code>   Dim intInner As Integer\n   Dim intOuter As Integer\n\n   For intOuter = 1 To Options - 1\n       For intInner = intOuter + 1 To Options\n          Debug.Print intOuter &amp; \"vs\" &amp; intInner\n       Next\n   Next\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 5373664, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/034dba41b4d2c2e263ee6a13f3f9fd4a?s=128&d=identicon&r=PG&f=1", "display_name": "Rico ", "link": "https://stackoverflow.com/users/5373664/rico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 46204715, "answer_count": 1, "score": -1, "last_activity_date": 1505328029, "creation_date": 1505327078, "last_edit_date": 1531164843, "question_id": 46204470, "link": "https://stackoverflow.com/questions/46204470/vba-matching-pairs-without-duplicates", "title": "VBA matching Pairs without Duplicates", "body": "<p>What I have been asked to do is take a users input as an integer. For example, 6 is the input. 6 gets passed into an equation (6 - 1)*(6)/2 this equates to 15 pairs. I then call another sub that processes the input into a set of {for next} loops. I have an If statement that checks duplicates but it is limited. I have tried passing in the iterative variable into the if statement but this will not work properly. </p>\n\n<p>Here is the code:</p>\n\n<pre><code>For intOuter = 1 To options - 1\n\n    'The intInner loop cycles through and sets up the loop for the combination and determines if\n    'the combination has been made already\n\n        For intInner = 1 To options\n\n    'If statement tests if a combination has already been made if it has it will not be printed\n    'if it has not been combined then it will be printed to the immediate window\n\n\n                If intOuter &lt;&gt; intInner And intOuter &lt;&gt; value + 1 And intOuter &lt;&gt; value + 2 And intOuter &lt;&gt; value + 3 _\n                And intOuter &lt;&gt; value + 4 Then\n                       Debug.Print intOuter &amp; \" vs \" &amp; intInner &amp; \"  Actual\"\n                End If\n\n        Next intInner\n\n    Next intOuter\n</code></pre>\n\n<p>The output for this example correctly displayed would be (with a user input of 6) </p>\n\n<pre><code>1vs2\n1vs3\n1vs4\n1vs5\n1vs6\n2vs3\n2vs4\n2vs5\n2vs6\n3vs4\n3vs5\n3vs6\n4vs5\n4vs6\n5vs6\n</code></pre>\n\n<p>Thanks in advance I really Appreciate it. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 384, "user_id": 4475468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d04747a9bf180c8fb9fc145ec5133d1?s=128&d=identicon&r=PG", "display_name": "Joffan", "link": "https://stackoverflow.com/users/4475468/joffan"}, "edited": false, "score": 0, "creation_date": 1505327618, "post_id": 46204255, "comment_id": 79372327, "body": "Do you perhaps call a subroutine or function somewhere that re-protects the worksheet?"}, {"owner": {"reputation": 31, "user_id": 8173314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d454032464248a3f0345388a8b316a83?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas the plane ", "link": "https://stackoverflow.com/users/8173314/thomas-the-plane"}, "reply_to_user": {"reputation": 384, "user_id": 4475468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d04747a9bf180c8fb9fc145ec5133d1?s=128&d=identicon&r=PG", "display_name": "Joffan", "link": "https://stackoverflow.com/users/4475468/joffan"}, "edited": false, "score": 0, "creation_date": 1505330017, "post_id": 46204255, "comment_id": 79373640, "body": "Yes this was in fact the problem. The code changed a cell that activated the sheet code and protected the sheet. Thank you for your help."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8173314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d454032464248a3f0345388a8b316a83?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas the plane ", "link": "https://stackoverflow.com/users/8173314/thomas-the-plane"}, "edited": false, "score": 0, "creation_date": 1505327353, "post_id": 46204416, "comment_id": 79372180, "body": "This did not work. it gives the same error. I changed it to drill.range(&quot;48:48&quot;).Cut and it said that the sheet is protected."}, {"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "reply_to_user": {"reputation": 31, "user_id": 8173314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d454032464248a3f0345388a8b316a83?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas the plane ", "link": "https://stackoverflow.com/users/8173314/thomas-the-plane"}, "edited": false, "score": 0, "creation_date": 1505327500, "post_id": 46204416, "comment_id": 79372270, "body": "..wha? But you unprotect it at the start of the code.. The line that gets yellow is the <code>Range.Delete</code> one, right?"}, {"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "reply_to_user": {"reputation": 31, "user_id": 8173314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d454032464248a3f0345388a8b316a83?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas the plane ", "link": "https://stackoverflow.com/users/8173314/thomas-the-plane"}, "edited": false, "score": 0, "creation_date": 1505327706, "post_id": 46204416, "comment_id": 79372375, "body": "No.. wait.. Isnt the <code>Unprotect</code> portion also wrong? I am not familiar with protecting/unprotecting, but some research here has shown that you had to use it like <code>Worksheets(&quot;Drill Log&quot;).Unprotect Password:=&quot;Welcome1&quot;</code>"}, {"owner": {"reputation": 31, "user_id": 8173314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d454032464248a3f0345388a8b316a83?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas the plane ", "link": "https://stackoverflow.com/users/8173314/thomas-the-plane"}, "edited": false, "score": 1, "creation_date": 1505327719, "post_id": 46204416, "comment_id": 79372382, "body": "I feel extremely stupid. I ran through the code stopping it line by line to see where it became protected again, and found that the line &quot;drill.Range(&quot;K10&quot;).Value = pass_type.Value&quot; activated some sheet code that ended in the protection of the sheet. thank you for trying to help me with my own stupidity. lol I&#39;m going home."}, {"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "reply_to_user": {"reputation": 31, "user_id": 8173314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d454032464248a3f0345388a8b316a83?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas the plane ", "link": "https://stackoverflow.com/users/8173314/thomas-the-plane"}, "edited": false, "score": 0, "creation_date": 1505327793, "post_id": 46204416, "comment_id": 79372424, "body": "It happens, dont take it to harsly :)"}], "tags": [], "owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "is_accepted": false, "score": 0, "last_activity_date": 1505326848, "creation_date": 1505326848, "answer_id": 46204416, "question_id": 46204255, "link": "https://stackoverflow.com/questions/46204255/code-to-delete-a-row-in-one-sub-works-but-the-other-doesnt-delete-method-of-r/46204416#46204416", "title": "Code to delete a row in one Sub works but the other doesn&#39;t. &quot;Delete Method of Range class failed&quot;", "body": "<p>Replace <code>drill.Range(\"48:48\").Delete</code> with <code>drill.Rows(\"48\").EntireRow.Delete</code></p>\n"}], "owner": {"reputation": 31, "user_id": 8173314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d454032464248a3f0345388a8b316a83?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas the plane ", "link": "https://stackoverflow.com/users/8173314/thomas-the-plane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505327255, "creation_date": 1505326274, "last_edit_date": 1505327255, "question_id": 46204255, "link": "https://stackoverflow.com/questions/46204255/code-to-delete-a-row-in-one-sub-works-but-the-other-doesnt-delete-method-of-r", "title": "Code to delete a row in one Sub works but the other doesn&#39;t. &quot;Delete Method of Range class failed&quot;", "body": "<p>I have several sub's that use this exact same code, but this one returns </p>\n\n<p>Run-time error '1004':</p>\n\n<p>Delete method of Range class failed</p>\n\n<pre><code>drill.Range(\"48:48\").Delete\n</code></pre>\n\n<p>in the others it works just fine, but in this one it does not</p>\n\n<pre><code>Sub Drill_Log_Undo()\n'\n'takes the last submited drill log and places it back into the submission     line\n'\n\n'Unprotects Drill Log\n    Worksheets(\"Drill Log\").Unprotect \"Welcome1\"\n\n'Declares Variables\n    Dim drill As Worksheet: Set drill = Worksheets(\"Drill Log\")\n    Dim start_joint As Range: Set start_joint = drill.Range(\"C48\")\n\n    Dim start_time As Range: Set start_time = drill.Range(\"F48\")\n    Dim info As Range: Set info = drill.Range(\"G48:S48\")\n    Dim tool_used As Range: Set tool_used = drill.Range(\"E48\")\n    Dim pass_type As Range: Set pass_type = drill.Range(\"D48\")\n\n    Dim x As Integer\n        x = 0\n\n'coppies the data to the submission line\n        drill.Range(\"G37:S37\").Value = drill.Range(\"G48:S48\").Value 'to Multi\n        drill.Range(\"G35:S35\").Value = drill.Range(\"G48:S48\").Value 'to Single\n\n'changes the pass type to the previously entered pass type\n        drill.Range(\"K10\").Value = pass_type.Value\n\n'determins whether the pass was multiple or single\n    If drill.Range(\"F48\") = Null Or drill.Range(\"F48\") = \"\" Then\n\n    'adds the end joint to the end joint submission cell\n        drill.Range(\"C37\").Value = drill.Range(\"C48\")\n\n    'counts the number of joints and removes them as it goes\n        Do Until drill.Range(\"A59\").Value = Null\n\n            If start_time.Value = \"\" Or Null Then\n</code></pre>\n\n<p>Here is the line that throws the code</p>\n\n<pre><code>                drill.Range(\"48:48\").Delete\n</code></pre>\n\n<p>End line</p>\n\n<pre><code>                x = x + 1\n                Set start_time = drill.Range(\"F48\")\n\n            Else\n                drill.Range(\"F37\").Value = drill.Range(\"F48\").Value\n\n                Exit Do\n\n            End If\n\n        Loop\n\n    'adds the last joint to the joint count and removes the joint row\n        drill.Range(\"B37\") = drill.Range(\"C48\")\n        x = x + 1\n        drill.Range(\"48:48\").Delete\n\n\nElse\n\n\n\n\nEnd If\n\n'protects Drill Log\n    Worksheets(\"Drill Log\").Protect \"Welcome1\"\n\nEnd Sub\n</code></pre>\n\n<p>I have tried different ways of declaring the variables, I have even tried specifically calling the code by calling the workbook and worksheet in the line.</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1505327329, "post_id": 46204295, "comment_id": 79372166, "body": "Success.  Thank you for the prompt response."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 3, "last_activity_date": 1505326906, "last_edit_date": 1505326906, "creation_date": 1505326385, "answer_id": 46204295, "question_id": 46204229, "link": "https://stackoverflow.com/questions/46204229/access-vba-xls-late-binding-variable-not-found/46204295#46204295", "title": "Access VBA - XLS Late Binding, Variable not Found", "body": "<p>Yes, by removing the reference to the Excel object library, you lose these constants.</p>\n\n<p>Solution: Copy their definition from the Object browser into a standard module:</p>\n\n<pre><code>Const xlWhole = 1\nConst xlByColumns = 2\n</code></pre>\n\n<p>or (less readable) use the numbers directly when calling the Excel methods.</p>\n\n<pre><code>LookAt:=1, _       ' xlWhole\nSearchOrder:=2, _  ' xlByColumns\nMatchCase:=False, _\nSearchFormat:=False, _\nReplaceFormat:=False\n</code></pre>\n\n<p>might be acceptable for you.</p>\n\n<hr>\n\n<p>By the way and unrelated:</p>\n\n<pre><code>Dim wks1, wks2, wks3, wks4, wks5 As Object\n</code></pre>\n\n<p>declares wks1 ... wks4 as Variant (the default datatype), not as Object.</p>\n"}], "owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 46204295, "answer_count": 1, "score": 1, "last_activity_date": 1594654285, "creation_date": 1505326177, "last_edit_date": 1594654285, "question_id": 46204229, "link": "https://stackoverflow.com/questions/46204229/access-vba-xls-late-binding-variable-not-found", "title": "Access VBA - XLS Late Binding, Variable not Found", "body": "<p>I am trying to address some XLS reference mismatches for a few users by implementing Late Binding in my AccessDB application.  I have solved a few of the issues, but created a new one.</p>\n\n<p>With Late Binding and the XLS Reference removed, I am getting a \"Variable Not Defined\" at the term \"LookAt:=xlWhole\" (see snippet, below).  </p>\n\n<p>Question:  Do I lose access to these variables with Late Binding?  And then, how do I work around to retain the needed functionality in a Late Binding scenario?</p>\n\n<p>Snippet from the complaining module:</p>\n\n<pre><code>Dim appXLS As Object\nDim wbk As Object\nDim wks1, wks2, wks3, wks4, wks5 As Object\n'...other unrelated declarations\n\n'...unrelated code\n\n'Create the Excel Application, Workbook and Worksheet\n\nSet appXLS = CreateObject(\"Excel.Application\")\nSet wbk = appXLS.Workbooks.Add(1)\n\nappXLS.Visible = True\nwbk.Activate\n\n'...more unrelated code\n\n'...first offending line:\nwks1.Range(\"E1:E\" &amp; intRows).Replace What:=\"0\", Replacement:=\"\", \nLookAt:=xlWhole, _\n    SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n</code></pre>\n\n<p>Any suggestions to get me started, please?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1505326305, "post_id": 46204226, "comment_id": 79371529, "body": "You probably do not have permission to put files in that folder."}, {"owner": {"reputation": 35, "user_id": 4679489, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78480afdbae38a7f0c109b91dbc029b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rishabh Verma", "link": "https://stackoverflow.com/users/4679489/rishabh-verma"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1505327108, "post_id": 46204226, "comment_id": 79372028, "body": "@ScottCraner I need to others to use this file to export the results using the above Macro. If I provide this location: =&quot;C:\\Users\\username\\Desktop\\test.csv&quot; Then its restricting to my machine. But the other users will be running the Macro in their machine. Can I change the location in any way or can I/other users get permissions by making any change in the above code?"}], "answers": [{"tags": [], "owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "is_accepted": false, "score": 0, "last_activity_date": 1505329567, "creation_date": 1505329567, "answer_id": 46205108, "question_id": 46204226, "link": "https://stackoverflow.com/questions/46204226/error-while-exporting-the-worksheet-as-a-csv-file-getting-runtime-error-1004/46205108#46205108", "title": "Error while exporting the worksheet as a csv file - Getting Runtime error &#39;1004&#39;", "body": "<p>I'm thinking that there is no C:\\tmp location and a solution would be for you to create a network drive that all the users that need it have access too and save the CSV there.</p>\n"}], "owner": {"reputation": 35, "user_id": 4679489, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78480afdbae38a7f0c109b91dbc029b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rishabh Verma", "link": "https://stackoverflow.com/users/4679489/rishabh-verma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 437, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505329567, "creation_date": 1505326172, "last_edit_date": 1505326851, "question_id": 46204226, "link": "https://stackoverflow.com/questions/46204226/error-while-exporting-the-worksheet-as-a-csv-file-getting-runtime-error-1004", "title": "Error while exporting the worksheet as a csv file - Getting Runtime error &#39;1004&#39;", "body": "<p>I'm using this code to export the worksheet as a CSV:</p>\n\n<pre><code>Option Explicit\nPublic Sub ExportWorksheetAndSaveAsCSV()\nDim wbkExport As Workbook\nDim shtToExport As Worksheet\nSet shtToExport = ThisWorkbook.Worksheets(\"Sheet1\")  'Sheet to export as CSV\nSet wbkExport = Application.Workbooks.Add\nshtToExport.Copy Before:=wbkExport.Worksheets(wbkExport.Worksheets.Count)\nApplication.DisplayAlerts = False      'Possibly overwrite without asking\nwbkExport.SaveAs Filename:=\"C:\\tmp\\test.csv\", FileFormat:=xlCSV\nApplication.DisplayAlerts = True\nwbkExport.Close SaveChanges:=False\nEnd Sub\n</code></pre>\n\n<p>When I provide this location:</p>\n\n<pre><code>wbkExport.SaveAs Filename:=\"C:\\tmp\\test.csv\", FileFormat:=xlCSV\n</code></pre>\n\n<p>It gives me error: </p>\n\n<pre><code>Runtime 1004\n</code></pre>\n\n<p>But when I change the location to:</p>\n\n<pre><code>wbkExport.SaveAs Filename:=\"C:\\Users\\username\\Desktop\\test.csv\", FileFormat:=xlCSV\n</code></pre>\n\n<p>It works!</p>\n\n<p>Can anyone please tell me what to do in this case?</p>\n"}, {"tags": ["vba", "product", "cartesian"], "comments": [{"owner": {"reputation": 21, "user_id": 8604963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8894f2c4c354e24105de4d0161df9710?s=128&d=identicon&r=PG&f=1", "display_name": "JAGIMAC", "link": "https://stackoverflow.com/users/8604963/jagimac"}, "edited": false, "score": 0, "creation_date": 1505326830, "post_id": 46204187, "comment_id": 79371869, "body": "I need to add range3, range4 and array1, array2 and not sure what to do under startrange.select..."}], "answers": [{"comments": [{"owner": {"reputation": 3887, "user_id": 7914637, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x_BhuHcC8Ww/AAAAAAAAAAI/AAAAAAAAABg/hiPWIjRXbhI/photo.jpg?sz=128", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7914637/alexander"}, "edited": false, "score": 4, "creation_date": 1515674943, "post_id": 48198443, "comment_id": 83395805, "body": "While this code may answer the question, providing additional context regarding <b>how</b> and <b>why</b> it solves the problem would improve the answer&#39;s long-term value."}], "tags": [], "owner": {"reputation": 11, "user_id": 9201381, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/6cd5cf4090024196203c92fbd30f7e1f?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/9201381/rob"}, "is_accepted": false, "score": 1, "last_activity_date": 1515632612, "creation_date": 1515632612, "answer_id": 48198443, "question_id": 46204187, "link": "https://stackoverflow.com/questions/46204187/cartesian-product-with-vba/48198443#48198443", "title": "Cartesian Product with VBA", "body": "<pre><code>Sub cartesianproduct()\nDim startrange As Range\n\nrange1 = Application.InputBox(Prompt:=\"Please Select First Range\", Type:=8)\nrange2 = Application.InputBox(Prompt:=\"Please Select Second Range\", Type:=8)\nrange3 = Application.InputBox(Prompt:=\"Please Select Third Range\", Type:=8)\n\n\nSet startrange = Application.InputBox(Prompt:=\"Please select where you want to put it\", Type:=8)\narray1 = [range1]\narray2 = [range2]\narray3 = [range3]\n\n\nstartrange.Select\nFor i = 1 To UBound(array1)\n    For x = 1 To UBound(array2)\n    For y = 1 To UBound(array3)\n        Z = Z + 1\n        ActiveCell.Offset(Z, 0).Value = array1(i, 1)\n        ActiveCell.Offset(Z, 1).Value = array2(x, 1)\n        ActiveCell.Offset(Z, 2).Value = array3(y, 1)\n    Next\nNext\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8604963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8894f2c4c354e24105de4d0161df9710?s=128&d=identicon&r=PG&f=1", "display_name": "JAGIMAC", "link": "https://stackoverflow.com/users/8604963/jagimac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1068, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1515632612, "creation_date": 1505326034, "last_edit_date": 1505326057, "question_id": 46204187, "link": "https://stackoverflow.com/questions/46204187/cartesian-product-with-vba", "title": "Cartesian Product with VBA", "body": "<p>How do I add a third and fourth range/array to the following code?   </p>\n\n<pre><code>Sub cartesianproduct()\nDim startrange As Range\n\nrange1 = Application.InputBox(Prompt:=\"Please Select First Range\", Type:=8)\nrange2 = Application.InputBox(Prompt:=\"Please Select Second Range\", Type:=8)\n\n\nSet startrange = Application.InputBox(Prompt:=\"Please select where you want to put it\", Type:=8)\narray1 = [range1]\narray2 = [range2]\n\n\nstartrange.Select\nFor i = 1 To UBound(array1)\n    For x = 1 To UBound(array2)\n        z = z + 1\n        ActiveCell.Offset(z, 0).Value = array1(i, 1)\n        ActiveCell.Offset(z, 1).Value = array2(x, 1)\n    Next\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 225, "user_id": 8592765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfbc123f552b4961420b8690b0e70fac?s=128&d=identicon&r=PG&f=1", "display_name": "Pinlop", "link": "https://stackoverflow.com/users/8592765/pinlop"}, "edited": false, "score": 0, "creation_date": 1505325960, "post_id": 46204098, "comment_id": 79371372, "body": "Oh wow... I thought I tried that haha. So simple! Thank you very much!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 225, "user_id": 8592765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfbc123f552b4961420b8690b0e70fac?s=128&d=identicon&r=PG&f=1", "display_name": "Pinlop", "link": "https://stackoverflow.com/users/8592765/pinlop"}, "edited": false, "score": 0, "creation_date": 1505326046, "post_id": 46204098, "comment_id": 79371411, "body": "@Pinlop :) Welcome"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "reply_to_user": {"reputation": 225, "user_id": 8592765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfbc123f552b4961420b8690b0e70fac?s=128&d=identicon&r=PG&f=1", "display_name": "Pinlop", "link": "https://stackoverflow.com/users/8592765/pinlop"}, "edited": false, "score": 1, "creation_date": 1505326698, "post_id": 46204098, "comment_id": 79371767, "body": "@Pinlop You can <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">accept the answer</a> if your question is correctly answered."}, {"owner": {"reputation": 225, "user_id": 8592765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfbc123f552b4961420b8690b0e70fac?s=128&d=identicon&r=PG&f=1", "display_name": "Pinlop", "link": "https://stackoverflow.com/users/8592765/pinlop"}, "edited": false, "score": 0, "creation_date": 1505327117, "post_id": 46204098, "comment_id": 79372036, "body": "@Vityata Would you happen to know why whenever the tables are pasted onto the slides, only the slide I currently have selected will paste the table at the right coordinates. All others will only show as pasted in the right coordinates in the thumbnail but they are in-fact pasted in the middle of the slide like so: <a href=\"https://imgur.com/a/zVUc4\" rel=\"nofollow noreferrer\">imgur.com/a/zVUc4</a>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 225, "user_id": 8592765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfbc123f552b4961420b8690b0e70fac?s=128&d=identicon&r=PG&f=1", "display_name": "Pinlop", "link": "https://stackoverflow.com/users/8592765/pinlop"}, "edited": false, "score": 0, "creation_date": 1505327353, "post_id": 46204098, "comment_id": 79372179, "body": "@Pinlop - nope. But try selecting all slides and paste it, it may work."}, {"owner": {"reputation": 225, "user_id": 8592765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfbc123f552b4961420b8690b0e70fac?s=128&d=identicon&r=PG&f=1", "display_name": "Pinlop", "link": "https://stackoverflow.com/users/8592765/pinlop"}, "edited": false, "score": 0, "creation_date": 1505331211, "post_id": 46204098, "comment_id": 79374293, "body": "@Vityata That&#39;s it! thank you :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1505325649, "creation_date": 1505325649, "answer_id": 46204098, "question_id": 46204076, "link": "https://stackoverflow.com/questions/46204076/using-cells-inside-of-range-isnt-working/46204098#46204098", "title": "Using Cells inside of Range isn&#39;t working?", "body": "<p>It should be like this:</p>\n\n<pre><code>.Range(.Cells(1, 1), .Cells(lRows, lCols)).Copy\n</code></pre>\n\n<p>That's one of the errors everyone experiences with VBA, if he goes a bit deeper. The reason is that <code>Cells</code> and <code>Range</code> should both be referred to the worksheet, otherwise they would refer the <code>ActiveSheet</code>.</p>\n\n<hr>\n\n<p>And in general, consider using <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long\"><code>Long</code> instead of <code>Integer</code> in your code</a>. </p>\n"}], "owner": {"reputation": 225, "user_id": 8592765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfbc123f552b4961420b8690b0e70fac?s=128&d=identicon&r=PG&f=1", "display_name": "Pinlop", "link": "https://stackoverflow.com/users/8592765/pinlop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "closed_date": 1505329142, "accepted_answer_id": 46204098, "answer_count": 1, "score": 1, "last_activity_date": 1505325649, "creation_date": 1505325577, "last_edit_date": 1531164843, "question_id": 46204076, "link": "https://stackoverflow.com/questions/46204076/using-cells-inside-of-range-isnt-working", "closed_reason": "Duplicate", "title": "Using Cells inside of Range isn&#39;t working?", "body": "<p>For some reason this isn't working:</p>\n\n<pre><code>.Range(Cells(1, 1), Cells(lRows, lCols)).Copy\n</code></pre>\n\n<p>Any ideas? It's on line 78</p>\n\n<pre><code>Option Explicit\nPublic Sub averageScoreRelay()\n    ' 1. Run from PPT and open an Excel file\n    ' 2. Start at slide 1 and find a box that contains the words \"iq_\", if it has those words then it will have numbers after it like so \"iq_43\" or \"iq_43, iq_56, iq_72\".\n    ' 3. find those words and numbers in the opened Excel file. Needs to recognize that \", \" means there is another entry.\n    ' 3. Copy column containing words from ppt ie. \"iq_43\"\n    ' 4. Paste a Table into ppt with those values\n    ' 5. Do this for every slide\n\n    'Create variables\n    Dim xlApp As Excel.Application\n    Dim xlWB As Excel.Workbook\n    Dim pptSlide As Slide\n    Dim Shpe As Shape\n    Dim pptText As String\n    Dim pptPres As Object\n    Dim iq_Array As Variant\n    Dim arrayLoop As Integer\n    Dim i As Integer\n    Dim myShape As Object\n    Dim colNumb As Integer\n    Dim size As Integer\n    Dim k As Integer\n    Dim vsblSld As Object\n    Dim lRows As Long\n    Dim lCols As Long\n\n    colNumb = 5 'Set #of columns in the workbook\n\n    ' Create new excel instance and open relevant workbook\n    Set xlApp = New Excel.Application\n    'xlApp.Visible = True 'Make Excel visible\n    Set xlWB = xlApp.Workbooks.Open(\"C:\\Users\\pinlop\\Desktop\\Gate\\Macro\\averageScores\\pptxlpratice\\dummyavgscore.xlsx\", True, False)  'Open relevant workbook\n    If xlWB Is Nothing Then ' may not need this if statement. check later.\n        MsgBox (\"Error retrieving Average Score Report, Check file path\")\n        Exit Sub\n    End If\n\n    xlWB.Worksheets.Add After:=xlWB.ActiveSheet\n\n    'Make pptPres the ppt active\n    Set pptPres = PowerPoint.ActivePresentation\n\n    'Loop through each pptSlide and check for IQ text box, grab avgScore values and create pptTable\n    For Each pptSlide In pptPres.Slides\n        'searches through shapes in the slide\n        For Each Shpe In pptSlide.Shapes\n            'Identify if there is text frame\n            k = 1\n            If Shpe.HasTextFrame Then\n                'Identify if there's text in text frame\n                If Shpe.TextFrame.HasText Then\n                    pptText = Shpe.TextFrame.TextRange\n                    If InStr(1, pptText, \"iq_\") &gt; 0 Then 'Identify if within text there is \"iq_\" All IQ's have to be formatted like this \"iq_42, iq_43\" for now\n                        iq_Array = Split(pptText, \", \")               'set iq_Array as an array of the split iq's\n                        size = UBound(iq_Array) - LBound(iq_Array)\n                        For arrayLoop = 0 To size   'loop for each iq_array\n                            For i = 1 To colNumb    'loops for checking each column\n                                If i = 1 And arrayLoop = 0 Then  'Copies the first column for every slide\n                                    xlWB.Worksheets(\"Sheet1\").Columns(1).Copy   'copy column\n                                    xlWB.Worksheets(\"Sheet2\").Paste Destination:=xlWB.Worksheets(\"Sheet2\").Columns(1)\n                                ElseIf xlWB.Worksheets(\"Sheet1\").Cells(1, i) = iq_Array(arrayLoop) And i &lt;&gt; 1 Then 'if iq in ppt = iq in xl and if not the first cell then execute\n                                    k = k + 1\n                                    xlWB.Worksheets(\"Sheet1\").Columns(i).Copy\n                                    xlWB.Worksheets(\"Sheet2\").Paste Destination:=xlWB.Worksheets(\"Sheet2\").Columns(k)\n                                End If\n                            Next i\n                        Next arrayLoop\n                    End If\n                End If\n            End If\n        Next Shpe\n\n    'calculate last row and last column\n    With xlWB.Worksheets(\"Sheet2\")\n        lRows = .Cells(.Rows.Count, 1).End(xlUp).Row\n        lCols = .Cells(1, .Columns.Count).End(xlToLeft).Column\n        .Range(Cells(1, 1), Cells(lRows, lCols)).Copy\n    End With\n            pptSlide.Shapes.PasteSpecial DataType:=ppPasteHTML, Link:=msoFalse\n            Set myShape = pptSlide.Shapes(pptSlide.Shapes.Count)\n            'Set position:\n            myShape.Left = 66\n            myShape.Top = 152\n            xlWB.Worksheets(\"Sheet2\").Range(\"A1:P10\").Clear\n    Next pptSlide\n\n    xlWB.Worksheets(\"Sheet2\").Delete\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1505325885, "post_id": 46204028, "comment_id": 79371319, "body": "Try adding <code>Set WSD2 = Worksheets(&quot;POS Info&quot;)</code> before <code>StartPT = WSD2.Range(&quot;A1&quot;).Address(ReferenceStyle:=xlR1C1)</code>"}, {"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1505326588, "post_id": 46204028, "comment_id": 79371697, "body": "Worked. Thanks so much. My only real question is why did this work?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1505328563, "post_id": 46204028, "comment_id": 79372884, "body": "To be honest, I&#39;m not entirely sure... And I just tried your code above that you originally had, and it worked fine - which leads me to believe that you may not even need that extra line of code at all! I thought it was because of how you did <code>Set = WSD2</code> up top, but I think that actually worked fine."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1505753703, "post_id": 46204028, "comment_id": 79532072, "body": "makes no sense to me either .... you could have used <code>StartPT = WSD.Range(&quot;A1&quot;).Address(ReferenceStyle:=xlR1C1)</code> because all you are doing is converting <code>&quot;A1&quot;</code> to <code>&quot;R1C1&quot;</code> .... makes no difference which worksheet you are using"}], "owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 13, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505325440, "creation_date": 1505325440, "question_id": 46204028, "link": "https://stackoverflow.com/questions/46204028/trying-to-create-a-pivot-table-in-a-newly-created-worksheet", "title": "Trying to create a pivot table in a newly created worksheet", "body": "<p>So I am trying to create a pivot table. The code that I have now works fine. However, what I am trying to do now is create a new worksheet in my workbook and have the pivot table be made in the new worksheet. This code works fine when the worksheet is already there, however, once I add in the new line of code to create the new worksheet, it fails me.</p>\n\n<pre><code>Sub ISM_Pivot()\n'-------------------------------------------------\n\n'    Step 1: Create a new worksheet for pivot table\n\n'--------------------------------------------------\n\nDim WSD2 As Worksheet\n\n Set WSD2 = ActiveWorkbook.Sheets.Add(After:= _\n           Worksheets(Worksheets.Count))\n   WSD2.Name = \"POS Info\"\n\n\n'--------------------------------------------------\n\n'        Step 2: Create the pivot table\n\n'--------------------------------------------------\n\nDim WSD As Worksheet\nDim PTCache As PivotCache\nDim PT As PivotTable\nDim PRange As Range\nDim FinalRow As Long\nDim FinalCol As Long\nDim StartPT As String\nSet WSD = Worksheets(\"aggregateData\")\n\n\n' Select the data for pivot table\n\nFinalRow = WSD.Cells(Rows.Count, 2).End(xlUp).Row\nFinalCol = WSD.Cells(1, Columns.Count).End(xlToLeft).Column\nSet PRange = WSD.Cells(2, 1).Resize(FinalRow, FinalCol)\nSet PTCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=PRange, Version:=xlPivotTableVersion14)\n\n'Where do I want the pivot table to start\n\nStartPT = WSD2.Range(\"A1\").Address(ReferenceStyle:=xlR1C1)\n\n\n'Begin to Create the Pivot Table\n\nSet PT = PTCache.CreatePivotTable(TableDestination:=StartPT, TableName:=\"POS Data\")\n</code></pre>\n\n<p>The last line of code is where it fails me. I get an application defined or object-defined error.</p>\n\n<p>Any help would be great,</p>\n\n<p>Thanks,</p>\n\n<p>Griffin</p>\n"}, {"tags": ["excel", "vbscript", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1505324919, "post_id": 46203317, "comment_id": 79370780, "body": "<code>objSheet.Range(&quot;A1&quot;)...</code>"}, {"owner": {"reputation": 3, "user_id": 7769579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f44f43eb6bd94b08814257484af809d?s=128&d=identicon&r=PG&f=1", "display_name": "S.Deepak", "link": "https://stackoverflow.com/users/7769579/s-deepak"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1505325276, "post_id": 46203317, "comment_id": 79370990, "body": "No improvement Scott. objSheet.Range(&quot;A1&quot;) still throws the same unknown error"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1505325443, "post_id": 46203317, "comment_id": 79371085, "body": "This doesn&#39;t address your problem, but don&#39;t you want <code>.Offset(1,0).Value = &quot;14&quot;</code> (offset 0 columns)?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1505325570, "post_id": 46203317, "comment_id": 79371150, "body": "Does Column A have data in at least row 2?  If not you are going to the bottom of the page and trying to go one line more.  Try starting at the bottom and going up instead:  <code>objSheet.Range(&quot;A60000&quot;).End(xlUp).Offset(1,1).Value = &quot;14&quot;</code>"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1505326594, "post_id": 46203317, "comment_id": 79371704, "body": "vbscript has no idea what <code>xlDown</code> is. Put <code>Option Explicit</code> on top."}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 1, "creation_date": 1505326625, "post_id": 46203317, "comment_id": 79371725, "body": "<code>.End(xlDown)</code> -&gt; <code>.End(-4121)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 1, "creation_date": 1505340950, "post_id": 46207035, "comment_id": 79378610, "body": "That won&#39;t resolve the problem, but will raise different (additional) errors, because VBScript doesn&#39;t support typed variable definitions (<code>Dim variable As type</code>)."}], "tags": [], "owner": {"reputation": 1262, "user_id": 7416484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a4ded2dfe3912f01a9477f4518546ab?s=128&d=identicon&r=PG", "display_name": "GSD", "link": "https://stackoverflow.com/users/7416484/gsd"}, "is_accepted": false, "score": -3, "last_activity_date": 1505341029, "last_edit_date": 1505341029, "creation_date": 1505337750, "answer_id": 46207035, "question_id": 46203317, "link": "https://stackoverflow.com/questions/46203317/why-does-an-unknown-runtime-error-occur-while-executing-endxldown-in-vbscrip/46207035#46207035", "title": "Why does an &quot;unknown runtime error&quot; occur while executing End(xlDown) in VBScript?", "body": "<pre><code>    Dim objExcel As Object, objSheet As Worksheet, pbjPath As Object, objBook As Object\n    Dim rcount As Long\n\n    objPath = \"C:\\Users\\Documents\\automateexcel.xls\"\n\n    Set objExcel = CreateObject(\"Excel.Application\")\n    Set objBook = objExcel.Workbooks.Open(objPath)\n    Set objSheet = objExcel.ActiveWorkbook.Worksheets(1)\n\n    objSheet.Cells(1, 1).Value = \"Punter\"\n    rcount = objSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n    If rcount = 1 Then objSheet.Range(\"A1\").Offset(1, 0).Value = \"14\" Else _\n        objSheet.Range(\"A1\").End(xlDown).Offset(1, 0).Value = \"14\"\n\n    objExcel.ActiveWorkbook.Save\n    objExcel.ActiveWorkbook.Close\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7769579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f44f43eb6bd94b08814257484af809d?s=128&d=identicon&r=PG&f=1", "display_name": "S.Deepak", "link": "https://stackoverflow.com/users/7769579/s-deepak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 532, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505341029, "creation_date": 1505322709, "last_edit_date": 1531164843, "question_id": 46203317, "link": "https://stackoverflow.com/questions/46203317/why-does-an-unknown-runtime-error-occur-while-executing-endxldown-in-vbscrip", "title": "Why does an &quot;unknown runtime error&quot; occur while executing End(xlDown) in VBScript?", "body": "<p>Why does an \"unknown runtime error\" occur while executing <code>End(xlDown)</code> in VBScript?</p>\n\n<pre><code>Dim objExcel, objSheet, pbjPath, objBook\nobjPath=\"C:\\Users\\Documents\\automateexcel.xls\"\n\nSet objExcel = CreateObject(\"Excel.Application\")\nSet objBook = objExcel.Workbooks.Open(objPath)\nSet objSheet = objExcel.ActiveWorkbook.Worksheets(1)\n\nobjSheet.Cells(1,1).Value = \"Punter\"\nobjExcel.Range(\"A1\").End(xlDown).Offset(1,1).Value = \"14\"\n\nobjExcel.ActiveWorkbook.Save\nobjExcel.ActiveWorkbook.Close\n</code></pre>\n\n<p>The Line <code>objExcel.Range(\"A1\").End(xlDown).Offset(1,1).Value = \"14\"</code>  is written to fill first empty cell in the 1st column with value 14. I am able to hard code into any cells in the sheet. But this <code>xlDown</code> approach to fill empty cell is causing unknown runtime error.</p>\n\n<blockquote>\n  <p>C:\\Try\\automateexcel.vbs(9, 1)<br>\n  Microsoft VBScript runtime error: Unknown runtime error</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1505321285, "post_id": 46202787, "comment_id": 79368729, "body": "I can think of SelectionChange events, though this would be if, e.g., B1 was selected then you clicked on B2, but not B1 and reselect B1."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1505321478, "post_id": 46202787, "comment_id": 79368848, "body": "In thinking, you could have part of your code to reset the selection to, say, A1, then no matter the click it can copy, if in the range."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 1, "creation_date": 1505321645, "post_id": 46202787, "comment_id": 79368944, "body": "Not so many are willing to write a code for you from scratch. You should come here with a half full glass, instead of an empty one, so that we can explain you why your glass is empty and advise what to do next."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 1, "creation_date": 1505322169, "post_id": 46202787, "comment_id": 79369220, "body": "Try declaring <a href=\"https://msdn.microsoft.com/en-us/library/office/bb687915.aspx\" rel=\"nofollow noreferrer\">some windows DLL</a> and use it. e.g.: <code>Public Declare Function GetAsyncKeyState Lib &quot;user32&quot; (ByVal vKey As Long) As Integer </code> or <code>Public Declare Function GetKeyState Lib &quot;user32&quot; (ByVal nVirtKey As Long) As Integer </code>"}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 1, "last_activity_date": 1505321798, "creation_date": 1505321798, "answer_id": 46203082, "question_id": 46202787, "link": "https://stackoverflow.com/questions/46202787/capture-cell-value-on-left-mouse-single-click-in-excel-vba/46203082#46203082", "title": "Capture Cell Value on left mouse single click in Excel VBA", "body": "<p>If you would settle for a double mouse click, you could try something like</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    MsgBox Target.Value\n    Cancel = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 48, "user_id": 8583661, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/900f313bd3d184c555c6b45cd837f881?s=128&d=identicon&r=PG&f=1", "display_name": "ANAND AGRAWAL", "link": "https://stackoverflow.com/users/8583661/anand-agrawal"}, "edited": false, "score": 0, "creation_date": 1505412939, "post_id": 46203784, "comment_id": 79415110, "body": "Thanks Mr DaBeau96.With whatever limited knowledge of VBA I have your answer seems to me the nearest one."}, {"owner": {"reputation": 48, "user_id": 8583661, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/900f313bd3d184c555c6b45cd837f881?s=128&d=identicon&r=PG&f=1", "display_name": "ANAND AGRAWAL", "link": "https://stackoverflow.com/users/8583661/anand-agrawal"}, "edited": false, "score": 0, "creation_date": 1505413389, "post_id": 46203784, "comment_id": 79415345, "body": "Thanks Mr DaBeau96. With my limited knowledge of VBA, your answer seems to me the nearest one. Before asking the question in the forum I did extensive research on Google and understood that there is no left mouse click event capture in VBA, so any solution will be a workaround only. However VBA has double click mouse event capture functionality so the answer posted by Mr K Davis is also correct. So I did my homework and it was not that I came here with an empty glass as mentioned by Mr Tehscript. I hope this forum helps the amateur users like me as well. Thanks to all who provided the solution"}, {"owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "reply_to_user": {"reputation": 48, "user_id": 8583661, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/900f313bd3d184c555c6b45cd837f881?s=128&d=identicon&r=PG&f=1", "display_name": "ANAND AGRAWAL", "link": "https://stackoverflow.com/users/8583661/anand-agrawal"}, "edited": false, "score": 0, "creation_date": 1505417689, "post_id": 46203784, "comment_id": 79417592, "body": "I knew there wasn&#39;t a mouse click option and that the closest thing to it was SelectionChange in my experience. I wasn&#39;t sure how you wanted the values stored so I just put them in a cell so you could easily see which values you wanted stored"}], "tags": [], "owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "is_accepted": false, "score": 2, "last_activity_date": 1505324883, "last_edit_date": 1505324883, "creation_date": 1505324518, "answer_id": 46203784, "question_id": 46202787, "link": "https://stackoverflow.com/questions/46202787/capture-cell-value-on-left-mouse-single-click-in-excel-vba/46203784#46203784", "title": "Capture Cell Value on left mouse single click in Excel VBA", "body": "<p>This code will check to see if multiple cells are selected at once then it checks to see if the cell is empty. If it is empty then it exits otherwise it stores the value is cell N1. You can change which cell the value gets stores at. If N1 has a value it goes to the next empty cell in column N.</p>\n\n<pre><code>Dim oval\nDim N As Long\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Target.Cells.Count &lt; 2 Then\n    If Target = Empty Then\n      Exit Sub\n    End If\noval = Target.Value\nMsgBox \"The value saved is \" + oval + \".\"\nIf Range(\"N1\").Value = \"\" Then\n    N = 1\nElse\n    N = Cells(Rows.Count, \"N\").End(xlUp).Row + 1\nEnd If\nCells(N, \"N\").Value = oval\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12124751, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/58fb56486c2c862a206ded2062aa0835?s=128&d=identicon&r=PG", "display_name": "Etienne", "link": "https://stackoverflow.com/users/12124751/etienne"}, "is_accepted": false, "score": 0, "last_activity_date": 1569498004, "last_edit_date": 1569498004, "creation_date": 1569497674, "answer_id": 58115949, "question_id": 46202787, "link": "https://stackoverflow.com/questions/46202787/capture-cell-value-on-left-mouse-single-click-in-excel-vba/58115949#58115949", "title": "Capture Cell Value on left mouse single click in Excel VBA", "body": "<p>How about this? Just wrote it, it will not register a mouse click if you click where you could have reached with the keyboard</p>\n\n<p>Enter Under Worksheet Code:</p>\n\n<pre><code>XXXXXXX\nOption Explicit\nPrivate prevTarget As Range\nPrivate Sub Worksheet_Activate()\nSet prevTarget = Selection\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    Dim wasMouseClick As Boolean\n    Dim ch1, ch2, ch3, ch4, ch5, ch6, ch7, ch8, ch9 As String\n    On Error Resume Next\n    ch1 = prevTarget.Offset(1, 0).Address\n    ch2 = prevTarget.Offset(-1, 0).Address\n    ch3 = prevTarget.Offset(0, 1).Address\n    ch4 = prevTarget.Offset(0, -1).Address\n    ch5 = prevTarget.End(xlDown).Address\n    ch6 = prevTarget.End(xlToLeft).Address\n    ch7 = prevTarget.End(xlToRight).Address\n    ch8 = prevTarget.End(xlUp).Address\n    On Error GoTo error_noPreTarget\n\n    If Not (Target.Address = ch1 Or _\n       Target.Address = ch2 Or _\n       Target.Address = ch3 Or _\n       Target.Address = ch4 Or _\n       Target.Address = ch5 Or _\n       Target.Address = ch6 Or _\n       Target.Address = ch7 Or _\n       Target.Address = ch8) Then\n        wasMouseClick = True\n    End If\n    Set prevTarget = ActiveCell\n    If wasMouseClick Then\n        Debug.Print wasMouseClick ' replace with what you want when wasMouseClick = True\n    End If\n\nExit Sub\nerror_noPreTarget:\nSet prevTarget = Selection\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 48, "user_id": 8583661, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/900f313bd3d184c555c6b45cd837f881?s=128&d=identicon&r=PG&f=1", "display_name": "ANAND AGRAWAL", "link": "https://stackoverflow.com/users/8583661/anand-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2630, "favorite_count": 0, "answer_count": 3, "score": -5, "last_activity_date": 1569498004, "creation_date": 1505320728, "question_id": 46202787, "link": "https://stackoverflow.com/questions/46202787/capture-cell-value-on-left-mouse-single-click-in-excel-vba", "title": "Capture Cell Value on left mouse single click in Excel VBA", "body": "<p>I need help in capturing the cell value on left mouse click. So when a user has done a single left mouse click in a particular cell then I need to capture that particular cell value (Value written in that cell) in the VBA code.</p>\n\n<p>This value will then be passed on to the VBA code and the output will be different for click in different cells. I hope I was able to explain the purpose.</p>\n\n<p>I have total of 10 cells where the left mouse click value is to be captured.</p>\n"}, {"tags": ["vba", "excel", "runtime-error"], "comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1505319884, "post_id": 46202404, "comment_id": 79367898, "body": "VBA, particularly the VB project, is notorious for corrupting when the code is edited. The best solution to this would be to export all of your code modules, save the workbook as an <code>.xlsx</code> file, and re-open/re-import the code before saving it as an <code>.xlsm</code> again. Or, if you are lazy like I am, use Ribbon Commander. There&#39;s a free trial: <a href=\"http://www.ribboncommander.com/\" rel=\"nofollow noreferrer\">ribboncommander.com</a> ."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10584487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255f76cd172be1631a1648bfbaa7724b?s=128&d=identicon&r=PG", "display_name": "Beni", "link": "https://stackoverflow.com/users/10584487/beni"}, "is_accepted": false, "score": 0, "last_activity_date": 1540971107, "creation_date": 1540971107, "answer_id": 53078370, "question_id": 46202404, "link": "https://stackoverflow.com/questions/46202404/mystery-excel-worksheet-objects-added-by-vba/53078370#53078370", "title": "Mystery Excel Worksheet Objects added by VBA", "body": "<p>I just had the same issue with Office365, made a code review and found out that I was using the same name for a public constant and a parameter to a function. After renaming the parameter and rerunning the macro, it did not happen again.</p>\n"}], "owner": {"reputation": 31, "user_id": 6683307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EHugN.jpg?s=128&g=1", "display_name": "apb21", "link": "https://stackoverflow.com/users/6683307/apb21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1540971107, "creation_date": 1505319516, "last_edit_date": 1531164843, "question_id": 46202404, "link": "https://stackoverflow.com/questions/46202404/mystery-excel-worksheet-objects-added-by-vba", "title": "Mystery Excel Worksheet Objects added by VBA", "body": "<p><a href=\"https://i.stack.imgur.com/4IWeW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4IWeW.png\" alt=\"Mystery Worksheet Objects\"></a></p>\n\n<p>I have been creating a .xlsm Workbook that contains various bits of VBA. It simply copies data from two other workbooks into tables and then refreshes the PivotTables that are based on those tables to update the charts on the main workbook. All things I have done before in different workbooks without issue. Whilst working on the workbook I have naturally open, saved, and then closed the workbook several time over several different days.</p>\n\n<p>Typically, now that I believe the workbook to be finished, it has developed a glitch whilst opening. Initially I was unable to open the file at all, as it would immediately crash. Only by saving the file to onedrive and downloading it back again, have I been able to keep the file open to see what is going on (for some reason this worked, I don't know why!).</p>\n\n<p>I immediately suspected something in the VBA and so one press of Alt+F11 later I was confronted with this (image above).</p>\n\n<p><strong>All of the Blue Excel Objects in this picture were not created by me!</strong></p>\n\n<p>They contain no code and I do not seem to be able to open them as regular Excel Worksheets.</p>\n\n<p><strong>My Questions are,\ndoes anyone have any idea what may be causing this?\nHas anyone even seen this before?\nWhere do I start debugging this?</strong></p>\n\n<p>Attempting to run any of the VBA in the workbook causes it to instantly crash.</p>\n\n<p>The VBA i suspect the most for the crashing is in these sections;</p>\n\n<pre><code>Public Function ThisWorkbookPath()\n    ThisWorkbookPath = ThisWorkbook.Path &amp; Application.PathSeparator\nEnd Function\n</code></pre>\n\n<p>which is passed to;</p>\n\n<pre><code>Public Function CheckPath(ByVal PathString As String) As Boolean\n    Application.Volatile (True)\n\n    If Strings.Right(PathString, 1) = \"\\\" Then\n        CheckType = vbDirectory\n    Else\n        CheckType = vbNormal\n    End If\n\n    If Len(Dir(PathString, CheckType)) &gt; 0 Then\n        CheckPath = True    \n    Else\n        CheckPath = False\n    End If\n\nEnd Function\n</code></pre>\n\n<p>These are both used in the workbook as user defined functions to check if the folder that contains the other 2 workbooks exists on the computer before trying to open them.</p>\n\n<p>ThisWorkbook is now ThisWorkbook1 which might explain why, as the forumla in the workbook calculates, it can't find the correct path and just crashes.</p>\n\n<p>But this doesn't explain where these extra objects came from in the first place.</p>\n\n<p><strong>Any help would be gratefully appreciated</strong></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505319656, "post_id": 46202253, "comment_id": 79367773, "body": "You can&#39;t do that unless you&#39;re the one unwrapping the XML and processing the file - i.e. do Excel&#39;s job and you can have a % progress."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1505329133, "post_id": 46202253, "comment_id": 79373178, "body": "Not sure you can access Excel object model to get the progress until workbook is opened. Take a look at AutoIt for screenscraping."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505329711, "post_id": 46202253, "comment_id": 79373480, "body": "@Mat&#39;sMug What if I say, took the average time that it takes to open the file in seconds each time, stored that value somewhere, then did something like <code>currenttime&#47;averageopentime &amp; &quot;% of the way there...</code>. Too much work?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1505329756, "post_id": 46202253, "comment_id": 79373500, "body": "@omegastripes Not too familiar with screenscraping - I&#39;ll look into it - thanks."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1505329798, "post_id": 46202253, "comment_id": 79373518, "body": "@omegastripes that misses the point - OP <i>already has</i> Excel open and VBA code running. Trying to get a %progress to show up in progress bar when programmatically opening a large file. Right, dwirony?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505329911, "post_id": 46202253, "comment_id": 79373575, "body": "@Mat&#39;sMug Yes Mat that is correct."}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1505330583, "post_id": 46205252, "comment_id": 79373931, "body": "Ah that&#39;s such a pity, but it makes sense... Guess I&#39;ll just have to tell my users to be extra patient!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1505330691, "post_id": 46205252, "comment_id": 79373984, "body": "@dwirony you could always ask for the feature on Microsoft Connect :-)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1505330443, "last_edit_date": 1505330443, "creation_date": 1505330109, "answer_id": 46205252, "question_id": 46202253, "link": "https://stackoverflow.com/questions/46202253/how-to-pull-processing-from-opening-workbook-for-a-status-bar-update/46205252#46205252", "title": "How to pull processing % from opening workbook for a status bar update?", "body": "<p>You can't.</p>\n\n<p>This instruction runs synchronously:</p>\n\n<pre><code>Set wb = Workbooks.Open(path)\n</code></pre>\n\n<p>The instruction after that will only run <em>after</em> the file has finished loading and the <code>wb</code> object reference is set.</p>\n\n<p>And as far as I know there's no way to open a workbook asynchronously in Excel. If there was, then the API could have exposed events such as <code>OnOpenProgress</code> or similar, which you could have handled, say, like this:</p>\n\n<pre><code>Private WithEvents app As Excel.Application\n\n'...\n\nPrivate Sub app_OnOpenProgress(ByVal path As String, ByVal percentComplete As Double, ByRef Cancel As Boolean)\n    Application.StatusBar = \"Opening \" &amp; path &amp; \"... (\" &amp; Format(percentComplete, \"0.0%\") &amp; \")\"\nEnd Sub\n</code></pre>\n\n<p>But that's not something that's currently possible AFAIK.</p>\n\n<p>The only way I can see this done, is by implementing your own <code>Workbooks.Open</code> method that returns a <code>Excel.Workbook</code> object. Needless to say the cost/benefits ratio is astronomical (and not in favor of the benefits).</p>\n\n<p>The best solution is to suck it up and do everything possible to minimize workbook file size, mostly by storing data in a database, not in Excel workbooks.</p>\n"}], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 1, "accepted_answer_id": 46205252, "answer_count": 1, "score": 0, "last_activity_date": 1505330443, "creation_date": 1505318966, "question_id": 46202253, "link": "https://stackoverflow.com/questions/46202253/how-to-pull-processing-from-opening-workbook-for-a-status-bar-update", "title": "How to pull processing % from opening workbook for a status bar update?", "body": "<p>So I have a few large macros that open/close large workbooks, and unfortunately these workbooks take a little time to open/load/calculate. When I open them manually, I can see the opening percentage on the initial screen:</p>\n\n<p><a href=\"https://i.stack.imgur.com/p9pyd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p9pyd.png\" alt=\"enter image description here\"></a></p>\n\n<p>And the calculation % on the status bar of the file here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/uHgge.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uHgge.png\" alt=\"Processing picture\"></a></p>\n\n<p>What I'm wondering is how I can grab these percentages and relay it to my main workbook's status bar to something of the effect of:</p>\n\n<pre><code>Application.DisplayStatusBar = True\nApplication.StatusBar = \"Opening production file... \" &amp; Workbooks(\"Book1\").LoadingPercentage &amp; \" of the way complete...\"\n</code></pre>\n\n<p>I'm a big fan of updating my users through status bars, so when the status bar just says <code>Opening production file...</code> and hangs for 20 seconds, they might grow concerned that the program froze. I <em>could</em> just have a counter that increments every second, but that would be inconsistent and wouldn't necessarily prove that the program hasn't froze/crashed.</p>\n\n<p>Is there a way that I can grab this number from an opening workbook? Or is there any kind of clever workaround? I skimmed through the properties of <code>Workbooks(\"Book1\").</code> and didn't see anything I could use.</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 8604247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4247cbe8779b9e848c95f620af8a754d?s=128&d=identicon&r=PG&f=1", "display_name": "VST", "link": "https://stackoverflow.com/users/8604247/vst"}, "edited": false, "score": 0, "creation_date": 1505329063, "post_id": 46203998, "comment_id": 79373132, "body": "thank you, it solved my first problem!  I used the following:  <code>Dim ctrl As ContentControl     For Each ctrl In ActiveDocument.SelectContentControlsByTitle(&quot;LocationMenu&quot;)         If ctrl.ShowingPlaceholderText = False Then             objCCDList.DropdownListEntries.Add ctrl.Range.Text         End If     Next</code>  The issue I now have is that my dropdownlist is not in the same order as the content control (Location Menu).    Where I enter [item1],[item2],[item3],[item4],[item5]  I get as drop down menu [item3],[item1],[item4],[item2],[item5]... Any advice to keep them in the same order? thx"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 35, "user_id": 8604247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4247cbe8779b9e848c95f620af8a754d?s=128&d=identicon&r=PG&f=1", "display_name": "VST", "link": "https://stackoverflow.com/users/8604247/vst"}, "edited": false, "score": 0, "creation_date": 1505329410, "post_id": 46203998, "comment_id": 79373337, "body": "Collections normally iterate their items in the same order they were added in. A <a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/contentcontrollistentry-object-word\" rel=\"nofollow noreferrer\"><code>ContentControlListEntry</code></a> object has an <code>Index</code> property that should give you that order - per the <a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/contentcontrollistentry-index-property-word\" rel=\"nofollow noreferrer\">documentation</a> that property is read-write, so you can reorder them at will."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1505325330, "creation_date": 1505325330, "answer_id": 46203998, "question_id": 46202198, "link": "https://stackoverflow.com/questions/46202198/how-does-selectcontentcontrolsbytitle-and-item-work/46203998#46203998", "title": "How does SelectContentControlsByTitle and .item() work?", "body": "<h3>About the Item property, and iterating collection types</h3>\n\n<p>By convention, <code>Item</code> is a special <code>Property Get</code> member defined in collection object types that [can/should] contain object references.</p>\n\n<p>If you could view the definition of that property getter, you would see something like this:</p>\n\n<pre><code>Public Property Get Item(ByVal index As Variant) As Variant\nAttribute Item.VB_Description = \"Gets or sets the element at the specified index.\"\nAttribute Item.VB_UserMemId = 0\n    'implementation\nEnd Property\n</code></pre>\n\n<p>That <code>Attribute Item.VB_UserMemId = 0</code> hidden attribute sets the COM type member's <code>DispId</code> property to 0, making it the class' <em>default member</em>.</p>\n\n<p>In other words this:</p>\n\n<pre><code>Debug.Print myCollection.Item(1).Range.Text\n</code></pre>\n\n<p>Is exactly the same as this:</p>\n\n<pre><code>Debug.Print myCollection(1).Range.Text\n</code></pre>\n\n<p>The exact specifics of how an <code>Item</code> property works with a given index, is implementation-specific, i.e. depends on how the collection class is implemented.</p>\n\n<p>But one thing all collection classes have in common, is a hidden <code>[_NewEnum]</code> property with a <code>VB_UserMemId = -4</code> hidden attribute, which tells VB6/VBA to use that method to get an <em>enumerator</em> for iterating that collection.</p>\n\n<p>That's how collections can be iterated with a <code>For Each</code> loop.</p>\n\n<p>And it's VERY efficient. Like, ~27 times faster than iterating a collection by index with a <code>For</code> loop.</p>\n\n<p>Use it!</p>\n\n<pre><code>Dim ctrl As ContentControl\nFor Each ctrl In ActiveDocument.SelectContentControlsByTitle(\"LocationMenu\")\n    Debug.Print ctrl.Range.Text\nNext\n</code></pre>\n\n<hr>\n\n<h3>Your problem (and its solution)</h3>\n\n<p>Now, the problem is that you <em>think</em> you're iterating dropdown items, but you're really iterating <code>ContentControl</code> items, and what <code>.Range.Text</code> is returning is whatever the current value is in each of these controls (i.e. the <code>ActiveDocument</code> contains more than just one dropdown content control titled \"LocationMenu\").</p>\n\n<p>If you want to iterate the dropdown values, you need to look at the <code>ContentControl.DropdownListEntries</code> collection:</p>\n\n<pre><code>Dim ctrl As ContentControl\nFor Each ctrl In ActiveDocument.SelectContentControlsByTitle(\"LocationMenu\")\n    Dim ddItem As ContentControlListEntry\n    For Each ddItem In ctrl.DropdownListEntries\n        Debug.Print ddItem.Text, ddItem.Value\n    Next\nNext\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8604247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4247cbe8779b9e848c95f620af8a754d?s=128&d=identicon&r=PG&f=1", "display_name": "VST", "link": "https://stackoverflow.com/users/8604247/vst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3310, "favorite_count": 1, "accepted_answer_id": 46203998, "answer_count": 1, "score": 2, "last_activity_date": 1505325330, "creation_date": 1505318796, "last_edit_date": 1531164843, "question_id": 46202198, "link": "https://stackoverflow.com/questions/46202198/how-does-selectcontentcontrolsbytitle-and-item-work", "title": "How does SelectContentControlsByTitle and .item() work?", "body": "<p>[English is not my first language]</p>\n\n<p>I am developing a Word document where the user inputs information in content controls rich text boxes. These inputs are then displayed as choices in several drop down lists (combo boxes) further down. </p>\n\n<p>It looks as follow:</p>\n\n<hr>\n\n<p>Locations:<br/>\n[Insert location 1 here]<br/>\n[Insert location 2 here]<br/>\n[Insert location 3 here]<br/>\n[Insert location 4 here]<br/> \n[Insert location 5 here]<br/> \n<br/><br/>\n(The CC title for each one is \"LocationMenu\")<br/>\n(The CC tag for each one has to be \"Header\")<br/></p>\n\n<hr>\n\n<p>The user may use one or many locations.<br/> </p>\n\n<p>I am writing a loop that will check how many content controls have been filled, and then will use the filled one as list entries for the drop down list. My plan was to use the same TITLE for each content control in my initial menu, and loop through the .SelectContentControlsByTitle(\"LocationMenu\").Item(x).<br/> </p>\n\n<p>However... <br/> </p>\n\n<p>Why is it that when I try this: <br/> </p>\n\n<pre><code>MsgBox (ActiveDocument.SelectContentControlsByTitle(\"LocationMenu\").Item(2).Range.Text)\n</code></pre>\n\n<p>I get [Insert location 3 here] and not [Insert location 2 here]?<br/> </p>\n\n<p>When I try: </p>\n\n<pre><code>MsgBox (ActiveDocument.SelectContentControlsByTitle(\"LocationMenu\").Item(1).Range.Text)\n</code></pre>\n\n<p>I get [Insert location 2 here] and not [Insert location 1 here]?<br/> </p>\n\n<p>(It's not a array-starts-at-0 issue either)<br/> </p>\n\n<p><strong>Could someone give me more details on how to use the \"item()\" portion of the code?</strong> People seems to work around it by putting a unique title for each content control and leaving the .item(x) at .item(1)... but that won't work for what I am trying to do... How do we use .item(x)???<br/> </p>\n\n<p>thank you so much<br/> \n<br/> <br/> <br/> \nHere are the pages I consulted, but did not find an answer:<br/> \n<br/> \n<a href=\"http://www.vbaexpress.com/forum/archive/index.php/t-50894.html\" rel=\"nofollow noreferrer\">http://www.vbaexpress.com/forum/archive/index.php/t-50894.html</a><br/> \n<br/> \n<a href=\"http://gregmaxey.com/word_tip_pages/interactive_userforms.html\" rel=\"nofollow noreferrer\">http://gregmaxey.com/word_tip_pages/interactive_userforms.html</a></p>\n\n<p>The msdn.microsoft.com stuff did not help.\nCould not find the answer of Stack Overflow either...</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8604452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62c641ea4968db2d0c01e4e6e339f9d4?s=128&d=identicon&r=PG&f=1", "display_name": "Nash Pjevac", "link": "https://stackoverflow.com/users/8604452/nash-pjevac"}, "is_accepted": false, "score": 1, "last_activity_date": 1505320335, "creation_date": 1505320335, "answer_id": 46202664, "question_id": 46201942, "link": "https://stackoverflow.com/questions/46201942/copy-complete-row-from-one-sheet-into-another-using-total-rows-from-first-sheet/46202664#46202664", "title": "Copy complete row from one sheet into another using total rows from first sheet as variable", "body": "<p>Sounds like you have some empty rows that trip you up since .End(xlDown) will stop at the first empty row. It also sounds like you want to iterate until the last available record. In which case, change how you determine the last row by counting from the bottom</p>\n\n<p>sh.Range(\"A1048576\").End(xlUp).Rows.Count</p>\n"}, {"tags": [], "owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "is_accepted": false, "score": 1, "last_activity_date": 1505338507, "last_edit_date": 1505338507, "creation_date": 1505321050, "answer_id": 46202879, "question_id": 46201942, "link": "https://stackoverflow.com/questions/46201942/copy-complete-row-from-one-sheet-into-another-using-total-rows-from-first-sheet/46202879#46202879", "title": "Copy complete row from one sheet into another using total rows from first sheet as variable", "body": "<p>Just remove the <code>Exit For</code> and it should work.</p>\n\n<pre><code>Sub test()\nDim sh As Worksheet\nSet sh = ThisWorkbook.Sheets(\"Sheet1\")\n\nDim k As Long\n\nk = sh.Range(\"A1\", sh.Range(\"A1\").End(xlDown)).Rows.Count\nIf k = 1048576 Then\n    k = 1\nEnd If\nFor i = 1 To sh.Range(\"A1\", sh.Range(\"A1\").End(xlDown)).Rows.Count\n    Sheets(\"Sheet1\").Rows(i).Copy Destination:=Sheets(\"Sheet3\").Rows(i)\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8604382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a51dc529f0a4685f21f32c71857f350?s=128&d=identicon&r=PG&f=1", "display_name": "CMRVSUK", "link": "https://stackoverflow.com/users/8604382/cmrvsuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505338507, "creation_date": 1505317954, "last_edit_date": 1505321885, "question_id": 46201942, "link": "https://stackoverflow.com/questions/46201942/copy-complete-row-from-one-sheet-into-another-using-total-rows-from-first-sheet", "title": "Copy complete row from one sheet into another using total rows from first sheet as variable", "body": "<p>I want to copy rows from one sheet, then inside that logical loop, copy rows from another sheet that match values from the row copied from sheet 1. Then repeat this process for every line of the first sheet, using a boolean value to record whether any rows were not matched and copy those rows to a fourth sheet.</p>\n\n<p>However that is some way off.</p>\n\n<p>Initially I want to copy each row from one sheet into a second sheet. This is my code but it only copies the first row of the information and if the first row is empty it stops.</p>\n\n<p>This will definitely be something simple but I do not see it.</p>\n\n<pre><code>Sub test()\n    Dim sh As Worksheet\n    Set sh = ThisWorkbook.Sheets(\"Sheet1\")\n\n    Dim k As Long\n\n    k = sh.Range(\"A1\", sh.Range(\"A1\").End(xlDown)).Rows.Count\n    If k = 1048576 Then\n        k = 1\n    End If\n    For i = 1 To sh.Range(\"A1\", sh.Range(\"A1\").End(xlDown)).Rows.Count\n        Sheets(\"Sheet1\").Rows(i).Copy Destination:= Sheets(\"Sheet3\").Rows(i)\n    Exit For\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1638, "user_id": 8224694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cL5ki.jpg?s=128&g=1", "display_name": "Rob Anthony", "link": "https://stackoverflow.com/users/8224694/rob-anthony"}, "edited": false, "score": 0, "creation_date": 1505317315, "post_id": 46201612, "comment_id": 79366245, "body": "You can put in break points to see where the error happens or put in some msgbox statements to narrow it down a bit."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1638, "user_id": 8224694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cL5ki.jpg?s=128&g=1", "display_name": "Rob Anthony", "link": "https://stackoverflow.com/users/8224694/rob-anthony"}, "edited": false, "score": 0, "creation_date": 1505318232, "post_id": 46201612, "comment_id": 79366900, "body": "@RobAnthony that&#39;s a compile error"}], "answers": [{"comments": [{"owner": {"reputation": 280, "user_id": 3260114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe3577e2b0037362ccb927a3ec5be78?s=128&d=identicon&r=PG&f=1", "display_name": "acousticismX", "link": "https://stackoverflow.com/users/3260114/acousticismx"}, "edited": false, "score": 0, "creation_date": 1505318016, "post_id": 46201904, "comment_id": 79366748, "body": "As far as I&#39;m aware, neither is Cells without a Worksheet, aka the syntax needs to be Worksheets(&quot;worksheet_name&quot;).Cells(a, b) rather than just Cells(a,b)"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 280, "user_id": 3260114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe3577e2b0037362ccb927a3ec5be78?s=128&d=identicon&r=PG&f=1", "display_name": "acousticismX", "link": "https://stackoverflow.com/users/3260114/acousticismx"}, "edited": false, "score": 1, "creation_date": 1505318097, "post_id": 46201904, "comment_id": 79366806, "body": "@acousticismX That is correct. Pretty much any time you are missing a higher-level reference on the left hand side you will want to see if it is properly qualified. Preferably, everything should be qualified up to the Workbook level."}, {"owner": {"reputation": 280, "user_id": 3260114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe3577e2b0037362ccb927a3ec5be78?s=128&d=identicon&r=PG&f=1", "display_name": "acousticismX", "link": "https://stackoverflow.com/users/3260114/acousticismx"}, "edited": false, "score": 0, "creation_date": 1505318196, "post_id": 46201904, "comment_id": 79366872, "body": "thanks for confirming. it&#39;s been a while since I&#39;ve done VBA."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1505319739, "post_id": 46201904, "comment_id": 79367822, "body": "I&#39;m amazed that the single line of code that should be two compiles - doesn&#39;t run, but it compiles.  Being pedantic (what else would you expect from a coder) - you could have it as a single line if the commands are separated by a colon: <code>Rows(&quot;23:43&quot;).Select: Selection.EntireRow.Hidden = False</code>.  But that makes it hard to read and &#39;tis silly."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1505319939, "post_id": 46201904, "comment_id": 79367930, "body": "@DarrenBartrup-Cook Agreed. My initial reaction is <code>That shouldn&#39;t compiile</code> but sure enough it did. I thought of introducing the <code>:</code> line continuation token, but it causes far more grief than it is worth in the long run."}, {"owner": {"reputation": 13, "user_id": 7738796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0a55caedc6c602816a47a699a780be6?s=128&d=identicon&r=PG&f=1", "display_name": "K15", "link": "https://stackoverflow.com/users/7738796/k15"}, "edited": false, "score": 0, "creation_date": 1505720617, "post_id": 46201904, "comment_id": 79510547, "body": "Thanks Brandon, great help!"}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": false, "score": 5, "last_activity_date": 1505317813, "creation_date": 1505317813, "answer_id": 46201904, "question_id": 46201612, "link": "https://stackoverflow.com/questions/46201612/wrong-number-of-arguments-or-invalid-property-assignment-error-in-vba-code/46201904#46201904", "title": "Wrong Number of Arguments or Invalid Property Assignment error in VBA code", "body": "<p>This is not valid VBA code:</p>\n\n<pre><code>Rows(\"23:43\").Select Selection.EntireRow.Hidden = False\n</code></pre>\n\n<p>Remember, a single line in VBA is a single command. The above line is two separate commands. This is valid VBA code:</p>\n\n<pre><code>Rows(\"23:43\").Select \nSelection.EntireRow.Hidden = False\n</code></pre>\n\n<p>However now we deal with the inefficiency of the code itself. You are using <code>ActiveSheet</code> implicitly, and you are relying on <code>Select</code>. For avoiding <code>Select</code> and <code>Activate</code> I would recommend starting here: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> .</p>\n\n<p>How can we refactor this code? Simple:</p>\n\n<pre><code>' Near the beginning of the module....\nDim Target as Worksheet\n\n' Ideally, explicitly set this to the correct worksheet. \n' For now, this will still use the Activesheet, it will just\n' do it more explicitly and reliably since it won't potentially change as the code is running.\nSet Target = ActiveSheet\n\n\n' Later in the code....\n\n' Notice how clean this is. We rely on Target instead of an implicit ActiveSheet, and we\n' don't have to rely on the `EntireRow` property of `Selection` since we are explicitly accessing\n' the rows.\n\nTarget.Rows(\"23:24\").Hidden = False\n</code></pre>\n\n<p>This not only solves the error at hand, but it also helps you avoid many of the common errors that will cause countless hours of frustration and maintenance later.</p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 8579132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3319b05a655f645fd8e050c0e38efb70?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Asthana", "link": "https://stackoverflow.com/users/8579132/abhinav-asthana"}, "is_accepted": true, "score": 1, "last_activity_date": 1505319435, "creation_date": 1505319435, "answer_id": 46202381, "question_id": 46201612, "link": "https://stackoverflow.com/questions/46201612/wrong-number-of-arguments-or-invalid-property-assignment-error-in-vba-code/46202381#46202381", "title": "Wrong Number of Arguments or Invalid Property Assignment error in VBA code", "body": "<p>Below is the solution for the problem mentioned above.</p>\n\n<p>I have re-factored code.</p>\n\n<p>In below code replace SheetName \"Sample\" with the name of your sheet in workbook.</p>\n\n<pre><code> Sub hideSummaryDetailed()\n\n Application.ScreenUpdating = False\n Application.EnableEvents = False\n ActiveSheet.DisplayPageBreaks = False\n\n Dim ws As Worksheet\n Set ws = ThisWorkbook.Worksheets(\"Sample\")\n\n With ws\n\n     'Hide all the Rows based on the selection for Summary/Detailed data linked to cell A1\n     If .Cells(1, 1) = 0 Then\n        .Range(\"A23:A336\").EntireRow.Hidden = False\n\n     ElseIf .Cells(1, 1) = 1 And .Cells(10, 5) = \"All\" Then\n        .Range(\"A23:A336\").EntireRow.Hidden = False\n        .Range(\"A44:A336\").EntireRow.Hidden = True\n\n     ElseIf .Cells(1, 1) = 2 And .Cells(10, 5) = \"All\" Then\n        .Range(\"A23:A336\").EntireRow.Hidden = False\n        .Range(\"A127:3A36\").EntireRow.Hidden = True\n\n     ElseIf .Cells(1, 1) = 1 And .Cells(10, 5) = \"Cardiff\" Then\n        .Range(\"A23:A336\").EntireRow.Hidden = False\n        .Range(\"A23:A127, A149:A336\").EntireRow.Hidden = True\n\n     ElseIf .Cells(1, 1) = 2 And .Cells(10, 5) = \"Cardiff\" Then\n        .Range(\"A23:A336\").EntireRow.Hidden = False\n        .Range(\"A23:A127, A233:A336\").EntireRow.Hidden = True\n\n     ElseIf .Cells(1, 1) = 1 And .Cells(10, 5) = \"Swansea\" Then\n        .Range(\"A23:A336\").EntireRow.Hidden = False\n        .Range(\"A23:A232, A254:A336\").EntireRow.Hidden = True\n\n     ElseIf .Cells(1, 1) = 2 And .Cells(10, 5) = \"Swansea\" Then\n        .Range(\"A23:A336\").EntireRow.Hidden = False\n        .Range(\"A23:A232\").EntireRow.Hidden = True\n\n     ElseIf .Cells(1, 1) = 1 And .Cells(10, 5) = \"Both\" Then\n        .Range(\"A23:A336\").EntireRow.Hidden = False\n        .Range(\"A23:A127, A149:A232, A254:A336\").EntireRow.Hidden = True\n\n     ElseIf .Cells(1, 1) = 2 And .Cells(10, 5) = \"Both\" Then\n        .Range(\"A23:A336\").EntireRow.Hidden = False\n        .Range(\"A23:A127\").EntireRow.Hidden = True\n\n     End If\n\n End With\n\n ws.Range(\"E11\").Select\n\n Application.ScreenUpdating = True\n Application.EnableEvents = True\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7738796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0a55caedc6c602816a47a699a780be6?s=128&d=identicon&r=PG&f=1", "display_name": "K15", "link": "https://stackoverflow.com/users/7738796/k15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 981, "favorite_count": 0, "accepted_answer_id": 46202381, "answer_count": 2, "score": 1, "last_activity_date": 1505319435, "creation_date": 1505317017, "question_id": 46201612, "link": "https://stackoverflow.com/questions/46201612/wrong-number-of-arguments-or-invalid-property-assignment-error-in-vba-code", "title": "Wrong Number of Arguments or Invalid Property Assignment error in VBA code", "body": "<p>hoping someone can help me out here.</p>\n\n<p>I'm trying to put together some code that will hide rows based on the values of two cells.</p>\n\n<p>My code is below:</p>\n\n<pre><code> Sub hideSummaryDetailed()\n\n Application.ScreenUpdating = False\n Application.EnableEvents = False\n ActiveSheet.DisplayPageBreaks = False\n\n\n 'Hide all the Rows based on the selection for Summary/Detailed data linked to cell A1\n If Cells(1, 1) = 0 Then\n    Rows(\"23:336\").Select Selection.EntireRow.Hidden = True\n\n ElseIf Cells(1, 1) = 1 And Cells(10, 5) = \"All\" Then\n    Rows(\"23:43\").Select Selection.EntireRow.Hidden = False\n    Range(\"E11\").Select\n    Rows(\"44:336\").Select Selection.EntireRow.Hidden = True\n\n ElseIf Cells(1, 1) = 2 And Cells(10, 5) = \"All\" Then\n    Rows(\"23:126\").Select Selection.EntireRow.Hidden = False\n    Range(\"E11\").Select\n    Rows(\"127:336\").Select Selection.EntireRow.Hidden = True\n\n ElseIf Cells(1, 1) = 1 And Cells(10, 5) = \"Cardiff\" Then\n    Rows(\"128:148\").Select Selection.EntireRow.Hidden = False\n    Range(\"E11\").Select\n    Rows(\"23:127, 149:336\").Select Selection.EntireRow.Hidden = True\n\n ElseIf Cells(1, 1) = 2 And Cells(10, 5) = \"Cardiff\" Then\n    Rows(\"128:232\").Select Selection.EntireRow.Hidden = False\n    Range(\"E11\").Select\n    Rows(\"23:127, 233:336\").Select Selection.EntireRow.Hidden = True\n\n ElseIf Cells(1, 1) = 1 And Cells(10, 5) = \"Swansea\" Then\n    Rows(\"233:253\").Select Selection.EntireRow.Hidden = False\n    Range(\"E11\").Select\n    Rows(\"23:232, 254:336\").Select Selection.EntireRow.Hidden = True\n\n ElseIf Cells(1, 1) = 2 And Cells(10, 5) = \"Swansea\" Then\n    Rows(\"233:336\").Select Selection.EntireRow.Hidden = False\n    Range(\"E11\").Select\n    Rows(\"23:232\").Select Selection.EntireRow.Hidden = True\n\n ElseIf Cells(1, 1) = 1 And Cells(10, 5) = \"Both\" Then\n    Rows(\"128:148, 233:253\").Select Selection.EntireRow.Hidden = False\n    Range(\"E11\").Select\n    Rows(\"23:127, 149:232, 254:336\").Select Selection.EntireRow.Hidden = True\n\n ElseIf Cells(1, 1) = 2 And Cells(10, 5) = \"Both\" Then\n    Rows(\"128:336\").Select Selection.EntireRow.Hidden = False\n    Range(\"E11\").Select\n    Rows(\"23:127\").Select Selection.EntireRow.Hidden = True\n\n End If\n\n Application.ScreenUpdating = True\n Application.EnableEvents = True\n\n Range(\"E11\").Select\n\n End Sub\n</code></pre>\n\n<p>However when I run it I keep getting an error saying Wrong Number of Arguments or Invalid Property Assignments, when I click ok it doesn't highlight any specific part of the code to point me in the direction.</p>\n\n<p>I am pretty new to VBA and have searched a few forums for advice on this error but nothing I have tried has worked or I have not understood it.</p>\n\n<p>Any help would be very much appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1505317166, "post_id": 46201446, "comment_id": 79366138, "body": "I suggest coming up with a better naming convention because as written the code will copy each worksheet whose names begins with <code>Book</code>. So first time it will copy <code>Book 1</code> and create <code>Book 1 (2)</code>. Then second time it will copy <code>Book 1</code> as <code>Book 1 (3)</code> and <code>Book 1 (2)</code> as <code>Book 1 (2) (2)</code>. Is that what you want?"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1505317267, "post_id": 46201446, "comment_id": 79366212, "body": "I want Book 1 (2), Book 1(3), Book 1(4).......same worksheet, it&#39;s like adding worksheet with the same name but I need it to go after the one previous created because i have a few worksheets at the end of the workbook that i want to keep it there."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1505317630, "post_id": 46201446, "comment_id": 79366474, "body": "You&#39;re modifying the collection you&#39;re iterating. Make an array or collection with the sheet names you want to copy, and iterate that instead."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505318423, "post_id": 46201446, "comment_id": 79367025, "body": "@Mat&#39;sMug, can you put that in an answer? I&#39;m not entirely sure what you mean?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1505321921, "post_id": 46201446, "comment_id": 79369107, "body": "@CallumDA I would, but I&#39;m not sure what the loop actually intends to be doing, so I&#39;d rather not. Doesn&#39;t make sense to me that it&#39;s copying the same sheet over and over. Looks like that conditional is making an assumption that there&#39;s only 1 sheet whose name starts with &quot;Book&quot;? In that case I don&#39;t understand what the loop is needed for. Maybe I&#39;m dumb, but I don&#39;t think OP&#39;s code <i>does what it says</i> and <i>says what it does</i>."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1505323594, "post_id": 46201446, "comment_id": 79369995, "body": "@pokemon_Man - if you can clarify what Mat&#39;s Mug is referring too in above comment, we can probably help you get the exact code you need. As is, there are many uncertainties based on what you have provided."}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1505323980, "post_id": 46201446, "comment_id": 79370225, "body": "Basically, I need to copy &quot;Book 1&quot; and put it after the latest &quot;Book 1&quot; tab as in the picture it would be &quot;Book 1 (3)&quot;"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1505324371, "post_id": 46201446, "comment_id": 79370437, "body": "@pokemon_Man - so everytime you run the code you want to only copy <code>Book 1</code> behind the last copy of <code>Book 1</code>?"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1505324410, "post_id": 46201446, "comment_id": 79370451, "body": "yes. so if the last one is &quot;Book 1 (3)&quot; i want to copy &quot;Book 1&quot; to after that one."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1505325246, "post_id": 46201446, "comment_id": 79370972, "body": "@pokemon_Man - what if the sheets end up out of order? Like if Book 1 (4) is moved between Book 1 (2) and Book 1 (3)? Or that will never happen?"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1505325274, "post_id": 46201446, "comment_id": 79370988, "body": "it will never happen, it will always stay in order and i want it to stay in order."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1505325438, "post_id": 46201446, "comment_id": 79371082, "body": "@pokemon_Man - see answer below."}], "answers": [{"comments": [{"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1505323504, "post_id": 46201783, "comment_id": 79369939, "body": "can you modified answer to not use worksheet as a argument and take &quot;Book 1&quot; as the sheet?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1505375196, "post_id": 46201783, "comment_id": 79389454, "body": "Why do you want it without parameters? Let the sub do what it is supposed to do (copy a sheet) and the calling routine tell for what is should do the work. Just call it like <code>copyMe activeworkbook.sheets(&quot;Book 1&quot;)</code> or whatever sheet you want to copy."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1505317459, "creation_date": 1505317459, "answer_id": 46201783, "question_id": 46201446, "link": "https://stackoverflow.com/questions/46201446/copy-worksheet-to-last-sheet-with-same-name/46201783#46201783", "title": "Copy worksheet to last sheet with same name?", "body": "<p>Loop backwards thru all sheets and copy it after the last where the name matches.</p>\n\n<pre><code>Sub copyMe(ws As Worksheet)\n\n    Dim wb As Workbook\n    Dim i As Long\n\n    Set wb = ws.Parent\n    For i = wb.Sheets.Count To 1 Step -1\n        If ws.Name = Left(wb.Sheets(i).Name, Len(ws.Name)) Then\n            ws.Copy After:=wb.Sheets(i)\n            Exit For\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1505325832, "last_edit_date": 1505325832, "creation_date": 1505325416, "answer_id": 46204020, "question_id": 46201446, "link": "https://stackoverflow.com/questions/46201446/copy-worksheet-to-last-sheet-with-same-name/46204020#46204020", "title": "Copy worksheet to last sheet with same name?", "body": "<p>Try this tested code. Worked for me:</p>\n\n<pre><code>Option Explicit\n\nSub CopySheet()\n\n    'copy Book 1 sheet\n    ThisWorkbook.Worksheets(\"Book 1\").Copy After:=ThisWorkbook.Worksheets(ThisWorkbook.Worksheets.Count)\n\n    'assign to variable to move later\n    Dim wsPlacement As Worksheet\n    Set wsPlacement = ActiveSheet\n\n    'load all \"Book 1\" sheets\n    Dim ws As Worksheet\n    For Each ws In Worksheets\n\n        If Left(ws.Name, 6) = \"Book 1\" And ws.Name &lt;&gt; wsPlacement.Name Then\n\n            Dim sSheets As String\n            sSheets = sSheets &amp; \",\" &amp; ws.Name\n\n        End If\n\n    Next ws\n\n    'find last one (by index) and move copy after that one\n    'this works so long as sheets stay in numerical order of copy\n         'if not it will put sheet at last position (by index) of Book 1 sheets\n    sSheets = Mid(sSheets, 2) 'remove leading comma\n    Dim arrSheets() As String\n    arrSheets = Split(sSheets, \",\")\n\n    wsPlacement.Move After:=ThisWorkbook.Worksheets(arrSheets(UBound(arrSheets)))\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 46204020, "answer_count": 2, "score": 0, "last_activity_date": 1505325832, "creation_date": 1505316570, "last_edit_date": 1531164843, "question_id": 46201446, "link": "https://stackoverflow.com/questions/46201446/copy-worksheet-to-last-sheet-with-same-name", "title": "Copy worksheet to last sheet with same name?", "body": "<p>I have a worksheet named \"Book 1\". I have no problem copy to after that worksheet. My issue is the next copy, I will already have \"Book 1\" then \"Book 1 (2)\" I need to copy the \"Book 1\" but place it after \"Book 1(2)\" and so forth with the next copy. How can I keep track or know where to place the next copy? I Don't want to put it at the end either because there are other tabs at the end that needs to be there.</p>\n\n<pre><code>Sub CopySheet()\nDim ws As Worksheet\nFor Each ws In Worksheets\n    If Left(ws.Name, 4) = \"Book\" Then\n    Sheets(\"Book 1\").Copy After:=Sheets(ws.Name)\n    End If\nNext ws\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ypnxT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ypnxT.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2173, "user_id": 8259647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMyr5.jpg?s=128&g=1", "display_name": "Kresimir L.", "link": "https://stackoverflow.com/users/8259647/kresimir-l"}, "is_accepted": false, "score": 1, "last_activity_date": 1505317729, "creation_date": 1505317729, "answer_id": 46201872, "question_id": 46201362, "link": "https://stackoverflow.com/questions/46201362/deleting-rows-based-on-color-and-text-in-2-different-columns/46201872#46201872", "title": "Deleting rows based on color and text in 2 different columns", "body": "<p>There is no need for double loop. Set both conditionals in one statement like stated below. This should also be faster since it is doing only one loop.</p>\n\n<pre><code>Dim lngRow As Long\nDim lngRows As Long\n'Find the last row in Column A\nlngRows = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor lngRow = lngRows To 2 Step -1\n    If Not InStr(1, LCase(Range(\"N\" &amp; lngRow)), LCase(\"PO Box\")) &lt;&gt; 0 And Range(\"C\" &amp; lngRow).Interior.Color = 13551615 Then\n            Worksheets(\"Sheet1\").Rows(lngRow).EntireRow.Delete\n    End If\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "is_accepted": false, "score": 2, "last_activity_date": 1507374582, "last_edit_date": 1507374582, "creation_date": 1505350080, "answer_id": 46208856, "question_id": 46201362, "link": "https://stackoverflow.com/questions/46201362/deleting-rows-based-on-color-and-text-in-2-different-columns/46208856#46208856", "title": "Deleting rows based on color and text in 2 different columns", "body": "<p>The fastest way to do this is to <em>not</em> use a loop at all. Instead, use <code>AutoFilter</code>:</p>\n\n<pre><code>  Dim lngRow As Long\n  Dim lngRows As Long\n  'Find the last row in Column A\n  lngRows = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n  With Range(Worksheets(\"Sheet1\").Rows(1), Worksheets(\"Sheet1\").Rows(lngRows))\n    .AutoFilter Field:=Columns(\"C\").Column, Criteria1:=13551615, Operator:=xlFilterCellColor\n    .AutoFilter Field:=Columns(\"N\").Column, Criteria1:=\"&lt;&gt;*PO Box*\", Operator:=xlAnd\n    .Offset(1).SpecialCells(xlCellTypeVisible).Delete\n    .AutoFilter ' Turns off autofilter and shows all rows\n  End With\n</code></pre>\n\n<p>Note that you don't need to sort the colored rows to the top.</p>\n\n<p>Also note that this will work even if there are no matching rows.</p>\n\n<p><strong>Caveat:</strong>\n<br>Be aware that this will always delete the first row <em>after</em> the end of the data. (This <em>can</em> be fixed relatively easily if required.)</p>\n"}], "owner": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1507374582, "creation_date": 1505316375, "last_edit_date": 1505335727, "question_id": 46201362, "link": "https://stackoverflow.com/questions/46201362/deleting-rows-based-on-color-and-text-in-2-different-columns", "title": "Deleting rows based on color and text in 2 different columns", "body": "<p>I am trying to delete a row if it HAS a red color in Column C AND if it DOESN'T have the words PO box in Column N. I have gotten it to where it deletes the rows that DO have po box in N but I can't seem to get it to go the other way and KEEP the rows with po box. Here is my code. The 13551615 is the red background color. </p>\n\n<p>Also if there is a faster way to do this that would be great too. This takes about 13 seconds to run through my 3k rows. I only have like 20 rows with the color in them and I already sort those to the top. But I really just want this to work even if it takes a second.</p>\n\n<pre><code>Dim lngRow As Long\nDim lngRows As Long\n'Find the last row in Column A\nlngRows = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor lngRow = lngRows To 2 Step -1\n    If ActiveWorkbook.Worksheets(\"Sheet1\").Cells(lngRow, \"C\").FormatConditions(1).Interior.Color = 13551615 Then\n        If Not InStr(1, LCase(Range(\"N\" &amp; lngRow)), LCase(\"PO Box\")) &lt;&gt; 0 Then\n            ActiveWorkbook.Worksheets(\"Sheet1\").Rows(lngRow).EntireRow.Delete\n        End If\n    End If\n\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1505315069, "post_id": 46200883, "comment_id": 79364642, "body": "There is a <code>Workbook_Close</code> event, but unfortunately there isnt a Workbook_BeforeClose` event in VBA or a <code>Workbook.Closing</code> property. If I am not mistaken, the <code>BeforeClose</code> event is exposed in C#, so there may be a way to get at the event through VBA."}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1505315424, "post_id": 46200883, "comment_id": 79364860, "body": "@BrandonBarney are you sure? <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbook-beforeclose-event-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a> ... Maybe I&#39;m missing something"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 1, "creation_date": 1505316137, "post_id": 46200883, "comment_id": 79365348, "body": "@GibralterTop You are correct. There is an event. I could&#39;ve sworn it wasnt there when I last needed it. My bad!"}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1505316296, "post_id": 46200883, "comment_id": 79365466, "body": "@BrandonBarney It could very well be newer, which mean it may not work depending on the version of Excel OP is using. The author of the article doesn&#39;t specify release or compatibility."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 0, "creation_date": 1505317392, "post_id": 46200883, "comment_id": 79366301, "body": "@GibralterTop Just checked and it is in mine as well, I just must&#39;ve missed it the first time. So, it was likely just me being an idiot :p ."}, {"owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "edited": false, "score": 0, "creation_date": 1505368322, "post_id": 46200883, "comment_id": 79385840, "body": "well, there is a before_close event in excel, but i cannot use it. coz i want to catch the close event in deactivate so when i close the file only one event will be fired. otherwise both before_close and deactivate will fire. i only want to deactivate to fire, but in that i want to catch if the file is closing"}], "answers": [{"comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 1, "creation_date": 1505315329, "post_id": 46200927, "comment_id": 79364801, "body": "@brandon - Good catch. fixed it."}, {"owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "edited": false, "score": 0, "creation_date": 1505368331, "post_id": 46200927, "comment_id": 79385845, "body": "well, there is a before_close event in excel, but i cannot use it. coz i want to catch the close event in deactivate so when i close the file only one event will be fired. otherwise both before_close and deactivate will fire. i only want to deactivate to fire, but in that i want to catch if the file is closing"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1505387629, "post_id": 46200927, "comment_id": 79397582, "body": "That&#39;s not possible."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1505315297, "last_edit_date": 1505315297, "creation_date": 1505315073, "answer_id": 46200927, "question_id": 46200883, "link": "https://stackoverflow.com/questions/46200883/how-to-check-if-workbook-is-closing-in-deactivate-event/46200927#46200927", "title": "how to check if workbook is closing in deactivate event", "body": "<p>You can detect that using the <code>BeforeClose</code> Event</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n  ' set Cancel to true to prevent it from closing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505369461, "creation_date": 1505314926, "last_edit_date": 1505369461, "question_id": 46200883, "link": "https://stackoverflow.com/questions/46200883/how-to-check-if-workbook-is-closing-in-deactivate-event", "title": "how to check if workbook is closing in deactivate event", "body": "<p><strong>SOLVED</strong></p>\n\n<p>Is there any way to check if workbook is closing when the code is in workbook_deactivate procedure? so i can inform a different message to users depending on whether they are just leaving to another workbook or they are closing the file. like following</p>\n\n<pre><code>Private Sub Workbook_Deactivate()\n\nif thisworkbook.closing then\n   msgbox \"message1\"\nelse\n   msgbox \"message2\"\nend if\n\nEnd Sub\n</code></pre>\n\n<p>i've searched on the net but no solution at all.\nso any help would be appreciated</p>\n\n<p><strong>SOLUTION</strong></p>\n\n<p>i've thought of a trick. i'm putting the value 1 in Z1000(if it is available) in before_close event and in deactivate, i'm checking if Z1000's value. that's it.</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    Range(\"Z1000\").Value = 1 'wherever is avaliable\n    Me.Saved = True\nEnd Sub\n\nPrivate Sub Workbook_Deactivate()\n    If Range(\"Z1000\").Value = 1 Then\n        MsgBox \"quitting\"\n    Else\n        MsgBox \"deactivating\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "selenium", "screenshot"], "comments": [{"owner": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 0, "creation_date": 1505315647, "post_id": 46200850, "comment_id": 79365001, "body": "That is limitation of the driver and you can&#39;t do much about it"}, {"owner": {"reputation": 13, "user_id": 8603884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a28db8da2adc58d608f160d9849d795?s=128&d=identicon&r=PG&f=1", "display_name": "Rich21Kong", "link": "https://stackoverflow.com/users/8603884/rich21kong"}, "reply_to_user": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 0, "creation_date": 1505316265, "post_id": 46200850, "comment_id": 79365445, "body": "Thanks @TarunLalwani any resolution proposed for VBA? I&#39;v seen Java alternate options."}, {"owner": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 1, "creation_date": 1505316316, "post_id": 46200850, "comment_id": 79365487, "body": "Point me to the Java alternative ones"}, {"owner": {"reputation": 13, "user_id": 8603884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a28db8da2adc58d608f160d9849d795?s=128&d=identicon&r=PG&f=1", "display_name": "Rich21Kong", "link": "https://stackoverflow.com/users/8603884/rich21kong"}, "reply_to_user": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 0, "creation_date": 1505316791, "post_id": 46200850, "comment_id": 79365882, "body": "@TarunLalwani one of the chrome java but have no idea how to integrate ashot into VBA - <a href=\"https://www.quora.com/Can-we-take-full-page-screenshot-on-chrome-using-selenium\" rel=\"nofollow noreferrer\">quora.com/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": true, "score": 1, "last_activity_date": 1505756075, "creation_date": 1505756075, "answer_id": 46285174, "question_id": 46200850, "link": "https://stackoverflow.com/questions/46200850/selenium-vba-driver-captureentirepagescreenshot-copy/46285174#46285174", "title": "Selenium VBA : driver.captureEntirePageScreenshot.Copy", "body": "<p>use the headless browser</p>\n\n<p>this is taken from the example code that comes with selenium </p>\n\n<p>on win7 machine ... C:\\Users\\xxxx\\AppData\\Local\\SeleniumBasic\\Examples\\VBScript</p>\n\n<pre><code>Option Explicit\n\nSub demoPhantomJSDriver()\n\n    Dim aaa As Selenium.PhantomJSDriver\n    Set aaa = New Selenium.PhantomJSDriver\n    aaa.Get \"https://stackoverflow.com/questions/tagged/vba?sort=newest&amp;pageSize=50\"\n    aaa.Window.Maximize\n\n    Dim bbb As Object\n    Set bbb = aaa.TakeScreenshot\n    bbb.ToExcel Range(\"h3\")\n    Set bbb = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8603884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a28db8da2adc58d608f160d9849d795?s=128&d=identicon&r=PG&f=1", "display_name": "Rich21Kong", "link": "https://stackoverflow.com/users/8603884/rich21kong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1757, "favorite_count": 0, "accepted_answer_id": 46285174, "answer_count": 1, "score": 1, "last_activity_date": 1505756075, "creation_date": 1505314811, "last_edit_date": 1505319464, "question_id": 46200850, "link": "https://stackoverflow.com/questions/46200850/selenium-vba-driver-captureentirepagescreenshot-copy", "title": "Selenium VBA : driver.captureEntirePageScreenshot.Copy", "body": "<p>New to the forums, and new to Selenium VBA. Apologies in advance for my ignorance.\nHowever I have searched for any VBA version of this that captures the full page element without plug-ins or use of Java.</p>\n\n<p>I want to keep this as simple as possible to capture a full page screenshot then paste that from clipboard into sheets within excel.</p>\n\n<p>Code I have so far I understand it can be improved and some of it may be unnecessary but I can't tell why it won't work when <code>bot.TakeScreenshot.Copy</code> does work but only captures the visible screen. </p>\n\n<pre><code>Public Sub CommandButton1_Click()\n\nDim bot As New WebDriver, rng As Range\nSet rng = Range(Worksheets(\"sheet1\").Range(\"A2\"), \nWorksheets(\"sheet1\").Range(\"A2\").End(xlDown))\n\n'this loops through each href in cells navigating to the page unless the cell has end in it\n\nFor Each cell In rng\nTextBox2.Text = ActiveCell.Text\nTextBox3.Text = ActiveCell(1, 2).Text\nIf ActiveCell.Text = \"End\" Then\nbot.Quit\nElse\nbot.Start \"chrome\", TextBox2.Text\nbot.Window.Maximize\nbot.Get \"/\"\n\n'this takes a screenshot of each url in the loop and copys it\n\nbot.captureEntirePageScreenshot.Copy\n\n'bot.TakeScreenshot.Copy\n\n'this creates a new sheet names it according the relavent test related to the url and pastes it in that newlt created sheet\n\nActiveWorkbook.Sheets.Add.Name = ActiveCell(1, 2).Text\nActiveSheet.PasteSpecial\n\n'this goes back to the original sheet to continue with loop\n\nWorksheets(\"sheet1\").Select\nActiveCell.Offset(1, 0).Select\n\nbot.Quit\nEnd If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1505314674, "post_id": 46200690, "comment_id": 79364372, "body": "Use the text to columns feature within Excel? Why does this need VBA?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1505315215, "post_id": 46200690, "comment_id": 79364726, "body": "Please read <a href=\"https://meta.stackoverflow.com/q/284236/1188513\"><i>Why is \u201cCan someone help me?\u201d not an actual question?</i></a>. SO isn&#39;t a code-writing service."}, {"owner": {"reputation": 111, "user_id": 7053291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a52d9535d8c8fd9754186dc092b6d8ed?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/7053291/john-doe"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505315575, "post_id": 46200690, "comment_id": 79364946, "body": "@Mat&#39;sMug I was really asking if anyone knew of a script out there that completes this. But yes I agree with you, this does appear like a code-writing question. I will remember that for next time."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1505315698, "post_id": 46200690, "comment_id": 79365043, "body": "Learning to write your own code, stumbling and bumping, will teach you something and add to your arsenal of tools. Copy-pasting random code from random strangers on the Internet isn&#39;t going to teach you anything. Give a man a fish..."}, {"owner": {"reputation": 111, "user_id": 7053291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a52d9535d8c8fd9754186dc092b6d8ed?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/7053291/john-doe"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1505315788, "post_id": 46200690, "comment_id": 79365115, "body": "@tigeravatar that worked perfectly! I can&#39;t believe I didn&#39;t come across this while researching. Thanks!!"}, {"owner": {"reputation": 111, "user_id": 7053291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a52d9535d8c8fd9754186dc092b6d8ed?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/7053291/john-doe"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1505315870, "post_id": 46200690, "comment_id": 79365165, "body": "@Mat&#39;sMug You are 100% right. I will avoid these type of questions in the future."}], "answers": [{"tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": false, "score": 3, "last_activity_date": 1505315158, "creation_date": 1505315158, "answer_id": 46200966, "question_id": 46200690, "link": "https://stackoverflow.com/questions/46200690/split-varying-list-of-file-paths-into-all-folders-and-file-names/46200966#46200966", "title": "Split varying list of file paths into all folders and file names", "body": "<p>If you wanted a VBA approach, something like the following would work:</p>\n\n<pre><code>   Dim fso As FileSystemObject\n   Dim path As String\n   Dim folder As String\n   Dim file As String\n\n   path = \"C:/user/folder/subfolder/filename.docx\"\n   Set fso = New FileSystemObject\n   folder = fso.GetParentFolderName(path)\n   file = fso.GetFileName(path)\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 7053291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a52d9535d8c8fd9754186dc092b6d8ed?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/7053291/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1505315158, "creation_date": 1505314333, "question_id": 46200690, "link": "https://stackoverflow.com/questions/46200690/split-varying-list-of-file-paths-into-all-folders-and-file-names", "title": "Split varying list of file paths into all folders and file names", "body": "<p>I have a list of a few hundred text file paths varying in number of folders.</p>\n\n<p>e.g. C:/user/folder/subfolder/filename.docx</p>\n\n<p>I need to split these into the file name and folders. I used to do this by using excel functions \"FIND\", \"LEN\", \"RIGHT\" etc. but this only worked if all paths have the same number of folders which is currently not the case.</p>\n\n<p>How might I complete this in VBA? My VBA knowledge is minimal but with this being such a common task, there should be a script out there somewhere that completes this?</p>\n\n<p>I have searched the web, but it is hard to find a script that completes this.</p>\n\n<p>Any help whatsoever would be really appreciated.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 2, "creation_date": 1505314529, "post_id": 46200658, "comment_id": 79364249, "body": "This begs the question of &quot;Why?&quot;. Once you do this, the formulas will be static and will always equal the same value. The whole point of formulas is to allow dynamic recalculations. Also, do you just want the value of the evaluation? So for example <code>=AVERAGE(&quot;&quot;)</code> would be something like <code>12.345</code> where the former is the formula, and the latter is the value of the average? If so, just overwrite the cell value."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1505317015, "post_id": 46200658, "comment_id": 79366025, "body": "If you plan to pursue this, you will have to use <code>,</code> instead of <code>;</code> as a list separator or switch to .FormulaLocal."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1505317075, "post_id": 46200849, "comment_id": 79366067, "body": "See my comment to the OP."}, {"owner": {"reputation": 37, "user_id": 8603988, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/323387f5b2ac9dc38686b1e7117d5440?s=128&d=identicon&r=PG&f=1", "display_name": "Yoni W", "link": "https://stackoverflow.com/users/8603988/yoni-w"}, "edited": false, "score": 0, "creation_date": 1505721254, "post_id": 46200849, "comment_id": 79510958, "body": "Thank you Nathan. Thats what I was looking for. The reason to do so is for presentive aspects (to see the number arguments of the calculation in a register file)  BTW @Jeeped - What is the reason of using <code>,</code> instead of <code>;</code> ?"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 1, "last_activity_date": 1505314807, "creation_date": 1505314807, "answer_id": 46200849, "question_id": 46200658, "link": "https://stackoverflow.com/questions/46200658/vba-replace-range-inside-function-formula-with-its-calculated-values/46200849#46200849", "title": "VBA replace range inside function formula with its calculated values", "body": "<p>Cant think why, in accordance with @Brandon Barney, but here is what you need</p>\n\n<p><code>\"=AVERAGE({\" &amp;  join(application.transpose(range(\"i1:i4\").Value),\";\") &amp; \"})\"</code></p>\n\n<p>Which will return like so</p>\n\n<p><code>=AVERAGE({1;5;5;10})</code></p>\n"}], "owner": {"reputation": 37, "user_id": 8603988, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/323387f5b2ac9dc38686b1e7117d5440?s=128&d=identicon&r=PG&f=1", "display_name": "Yoni W", "link": "https://stackoverflow.com/users/8603988/yoni-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 46200849, "answer_count": 1, "score": 2, "last_activity_date": 1505315388, "creation_date": 1505314212, "last_edit_date": 1505315388, "question_id": 46200658, "link": "https://stackoverflow.com/questions/46200658/vba-replace-range-inside-function-formula-with-its-calculated-values", "title": "VBA replace range inside function formula with its calculated values", "body": "<p>This is my first post here. I tried to look for an answer but could not find one.</p>\n\n<p>My issue is to replace range in a formula to its specific values.\nTo illustrate the issue consider a cell:</p>\n\n<p><strong>=AVERAGE(A1:A10)</strong></p>\n\n<p>I want this cell to show the average arguments for the calculation:</p>\n\n<p><strong>=AVERAGE({1;2;3;4;5;6;7;8;9;10})</strong></p>\n\n<p>This thing is parallel to pressing F9 while the range A1:A10 is highlighted.\nI tried to build something from what I could find in the net but could not make it working:</p>\n\n<pre><code>Sub ChangeFormulas()\nConst CONST_FUNCTION As String = \"AVERAGE\"\nDim cell As Range\nDim tmp As String\nDim res As Variant\n\nFor Each cell In Selection\n\n  With cell\n\n    If InStr(.Formula, CONST_FUNCTION) &gt; 0 Then\n\n        tmp = Mid(.Formula, 10, InStr(.Formula, \")\") - (InStr(.Formula, CONST_FUNCTION) + 8))\n\n        cell.Formula = Replace(cell.Formula, tmp, Application.Evaluate(tmp))\n    End If\n  End With\nNext cell\nEnd Sub\n</code></pre>\n\n<p>Thank you for your help.</p>\n"}, {"tags": ["vb.net", "excel", "vba"], "comments": [{"owner": {"reputation": 11547, "user_id": 832052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/VA1xt.png?s=128&g=1", "display_name": "djv", "link": "https://stackoverflow.com/users/832052/djv"}, "edited": false, "score": 0, "creation_date": 1505316275, "post_id": 46200441, "comment_id": 79365453, "body": "Maybe that&#39;s not even the problem. It&#39;s almost always appropriate to store data in its true form. Having the currency stored as a number is correct. The currency sign is only applicable when displaying it. Depending on how the currency is displayed in your application (your question is <i>so</i> vague), there are different ways to format the data for display. You would need to provide some code. Also, is this vb.net or vba? They are not the same."}], "answers": [{"tags": [], "owner": {"reputation": 163, "user_id": 8297770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4299d4fae4afea7196a131e56ebfaf5e?s=128&d=identicon&r=PG&f=1", "display_name": "AustinS90", "link": "https://stackoverflow.com/users/8297770/austins90"}, "is_accepted": true, "score": 1, "last_activity_date": 1505316368, "creation_date": 1505316368, "answer_id": 46201358, "question_id": 46200441, "link": "https://stackoverflow.com/questions/46200441/importing-excel-data-to-datatable-with-format-currency/46201358#46201358", "title": "Importing Excel Data to datatable with format currency", "body": "<p>You can try setting the format of the data grids cell. </p>\n\n<p>Something such as this might work:</p>\n\n<pre><code>DataGridView.Columns(\"CurrencyColumn\").DefaultCellStyle.Format = \"C\"\n</code></pre>\n\n<p>And I believe if you want to set it to a desired amount as decimal places, you can do as such</p>\n\n<pre><code>DataGridView.Columns(\"CurrencyColumn\").DefaultCellStyle.Format = \"C2\"\n</code></pre>\n\n<p>The above should set it to 2 decimal places, which I believe can be switched with other numbers as well</p>\n"}], "owner": {"reputation": 33, "user_id": 7321991, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207085860484935/picture?type=large", "display_name": "Jake Pangan", "link": "https://stackoverflow.com/users/7321991/jake-pangan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 46201358, "answer_count": 1, "score": 1, "last_activity_date": 1505316368, "creation_date": 1505313639, "last_edit_date": 1531161705, "question_id": 46200441, "link": "https://stackoverflow.com/questions/46200441/importing-excel-data-to-datatable-with-format-currency", "title": "Importing Excel Data to datatable with format currency", "body": "<p>I am importing data from an excel file to a vb datatable with one column having a 'currency' format. However, upon retrieval, I noticed that the currency sign is no longer included in the datatable. How to include the currency sign? Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 243, "user_id": 6456800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c7d9c1c5f3fb0426747663d2c944482?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6456800/unknown"}, "edited": false, "score": 0, "creation_date": 1505313381, "post_id": 46200061, "comment_id": 79363363, "body": "<a href=\"https://stackoverflow.com/questions/9379673/excel-vba-delete-empty-rows\" title=\"excel vba delete empty rows\">stackoverflow.com/questions/9379673/excel-vba-delete-empty-r&zwnj;&#8203;ows</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8603792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6510e48ee5db1be73ce508af528eaf13?s=128&d=identicon&r=PG&f=1", "display_name": "WanjauSam", "link": "https://stackoverflow.com/users/8603792/wanjausam"}, "edited": false, "score": 0, "creation_date": 1505313787, "post_id": 46200325, "comment_id": 79363684, "body": "Works Perfectly!!"}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 1, "last_activity_date": 1505313297, "creation_date": 1505313297, "answer_id": 46200325, "question_id": 46200061, "link": "https://stackoverflow.com/questions/46200061/aligning-data-in-two-columns-in-excel-vba/46200325#46200325", "title": "Aligning data in two columns in excel VBA", "body": "<p>Assuming data is as follows</p>\n\n<p><a href=\"https://i.stack.imgur.com/lcV2d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lcV2d.png\" alt=\"enter image description here\"></a></p>\n\n<p>then try the following code</p>\n\n<pre><code>Sub Demo()\n    With ThisWorkbook.Worksheets(\"Sheet7\")  'change Sheet7 to your data sheet\n        .Range(\"A1:B23\").Cells.SpecialCells(xlCellTypeBlanks).Delete Shift:=xlUp\n    End With\nEnd Sub\n</code></pre>\n\n<p>Change range as per your data. This will give result as</p>\n\n<p><a href=\"https://i.stack.imgur.com/2VN33.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2VN33.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 15, "user_id": 8603792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6510e48ee5db1be73ce508af528eaf13?s=128&d=identicon&r=PG&f=1", "display_name": "WanjauSam", "link": "https://stackoverflow.com/users/8603792/wanjausam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "accepted_answer_id": 46200325, "answer_count": 1, "score": 0, "last_activity_date": 1505313297, "creation_date": 1505312585, "last_edit_date": 1531164843, "question_id": 46200061, "link": "https://stackoverflow.com/questions/46200061/aligning-data-in-two-columns-in-excel-vba", "title": "Aligning data in two columns in excel VBA", "body": "<p>I'm new to VBA Excel. I wanted to write a code that aligns data in Column A to that in Column B then deletes the empty rows left\nMy Data example is as follows:</p>\n\n<p><img src=\"https://i.stack.imgur.com/kLTvm.png\" alt=\"Unsorted Data\"></p>\n\n<p>Desired output looks like this. </p>\n\n<p><img src=\"https://i.stack.imgur.com/pg5mu.png\" alt=\"Sorted Data\"></p>\n"}, {"tags": ["vba", "excel", "listbox"], "comments": [{"owner": {"reputation": 3890, "user_id": 4335507, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b6736076623ffcb3cd5625dfb9719dd7?s=128&d=identicon&r=PG", "display_name": "Elmer Dantas", "link": "https://stackoverflow.com/users/4335507/elmer-dantas"}, "edited": false, "score": 0, "creation_date": 1505312323, "post_id": 46199937, "comment_id": 79362570, "body": "posting the code you&#39;re using helps us to helping you."}, {"owner": {"reputation": 11, "user_id": 8562507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb0b5fbac94bc1860604bac250cafa4?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8562507/sam"}, "reply_to_user": {"reputation": 3890, "user_id": 4335507, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b6736076623ffcb3cd5625dfb9719dd7?s=128&d=identicon&r=PG", "display_name": "Elmer Dantas", "link": "https://stackoverflow.com/users/4335507/elmer-dantas"}, "edited": false, "score": 1, "creation_date": 1505312813, "post_id": 46199937, "comment_id": 79362969, "body": "You are right @ElmerDantas , the code is now added."}, {"owner": {"reputation": 2173, "user_id": 8259647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMyr5.jpg?s=128&g=1", "display_name": "Kresimir L.", "link": "https://stackoverflow.com/users/8259647/kresimir-l"}, "edited": false, "score": 0, "creation_date": 1505313491, "post_id": 46199937, "comment_id": 79363444, "body": "It could be due to a bug in Excel associated with ActiveX controls which is preventing you from selecting values in Listbox. Try to enter any cell on Sheet1 (with a doubleclick or F2) and confirm it with enter. After that you should be able to click on ActiveX control... read more about this issue <a href=\"https://stackoverflow.com/questions/27411399/microsoft-excel-activex-controls-disabled\">here</a>"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1505316706, "post_id": 46199937, "comment_id": 79365812, "body": "Might be worth trying to select a cell in the sheet rather than attempting to activate the sheet and then see if you can still interact with your control"}], "owner": {"reputation": 11, "user_id": 8562507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb0b5fbac94bc1860604bac250cafa4?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8562507/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1505313334, "creation_date": 1505312210, "last_edit_date": 1505313334, "question_id": 46199937, "link": "https://stackoverflow.com/questions/46199937/inactive-listbox-after-worksheets-activate-command", "title": "Inactive ListBox after worksheets.activate command", "body": "<p>I have a problem with my ActiveX Control ListBox. It seems to be inactive after the worksheets.activate command.</p>\n\n<p>Here is what I'm doing:</p>\n\n<ol>\n<li><p>In the Sheet1 I have two buttons to trigger different vba codes and an ActiveX Control ListBox, used to generate a string needed for the second calculation. When I move the mouse over the ListBox the cursor turns from a cross to an arrow, so I can select the boxes.</p></li>\n<li><p>My first button triggers a vba-based import of data. The data is stored in a Sheet2. After that I activate again Sheet1 (Sheet1.Activate). After that it is no longer possible to select the boxes in the ListBox (the cursor no longer changes from a cross to an arrow when moved over the ListBox).</p></li>\n</ol>\n\n<p>If I get rid of the command Sheet1.Activate, after the data-import the ActiveSheet is obviously Sheet2. Strange thing is that after selecting Sheet1 in excel the ListBox is still working. \nSo it seems to me that the command worksheets.activate somehow deactivates the ListBox. Does anyone have an idea how to solve this problem?</p>\n\n<p>That would be the code of the import script:</p>\n\n<pre><code>Sub import_stuff()\n\u00a0\n''defining variables\nDim panel As Worksheet\n\u00a0\n''turn off screen updating and displaying alerts\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\u00a0\n''defining the used workbooks\nSet panel = ThisWorkbook.Worksheets(\"Controll Panel\")\nSet inputbook = Workbooks.Open(\"link to file\")\n\u00a0\n''delete the worksheet \"input data\" if it exists, if not it does nothing...\nOn Error Resume Next\n\u00a0\u00a0\u00a0 thisbook.Worksheets(\"Input data\").Delete\nOn Error GoTo 0\n\u00a0\n''copying the data from the source file to a new worksheet\ninputbook.Worksheets(\"Sheet1\").copy After:=panel\n''renaming the newly generated worksheet\nActiveSheet.name = \"Input data\"\n\u00a0\n''closing the source file without saving\ninputbook.Close False\n\u00a0\npanel.Activate\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 1, "creation_date": 1505312403, "post_id": 46199858, "comment_id": 79362636, "body": "I think you missed the &#39;context&#39;, &#39;question&#39;, and &#39;expected results&#39; part of your post."}, {"owner": {"reputation": 41, "user_id": 8603800, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Emma B", "link": "https://stackoverflow.com/users/8603800/emma-b"}, "reply_to_user": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1505312513, "post_id": 46199858, "comment_id": 79362716, "body": "I basically need to to make sure the data entered in the text box is not the same as the data in certain cells. I need it to show an error message. I am pretty new to this so I would really appreciate some help so I can learn :)"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1505313205, "post_id": 46199858, "comment_id": 79363233, "body": "<code>If WorksheetFunction.CountIf(Columns(&quot;A&quot;), EntityNameTextBox.Value) &gt; 0 Then MsgBox EntityNameTextBox.Value &amp; &quot; already exists.&quot; Else ...</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505315277, "post_id": 46199858, "comment_id": 79364764, "body": "Please read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. As it stands, this post isn&#39;t a question."}, {"owner": {"reputation": 41, "user_id": 8603800, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Emma B", "link": "https://stackoverflow.com/users/8603800/emma-b"}, "edited": false, "score": 0, "creation_date": 1505315668, "post_id": 46199858, "comment_id": 79365018, "body": "Can this be applies to strings?"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 8603800, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Emma B", "link": "https://stackoverflow.com/users/8603800/emma-b"}, "edited": false, "score": 0, "creation_date": 1505313644, "post_id": 46200242, "comment_id": 79363563, "body": "Thank you! Where can I put what cells and from which worksheet?"}, {"owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "reply_to_user": {"reputation": 41, "user_id": 8603800, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Emma B", "link": "https://stackoverflow.com/users/8603800/emma-b"}, "edited": false, "score": 0, "creation_date": 1505314091, "post_id": 46200242, "comment_id": 79363918, "body": "Your code is Cells(emptyRow, 1).Value. A is for column 1, B for column 2 and so on."}, {"owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "reply_to_user": {"reputation": 41, "user_id": 8603800, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Emma B", "link": "https://stackoverflow.com/users/8603800/emma-b"}, "edited": false, "score": 0, "creation_date": 1505314258, "post_id": 46200242, "comment_id": 79364054, "body": "Sorry, you can put it in MsgString."}, {"owner": {"reputation": 41, "user_id": 8603800, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Emma B", "link": "https://stackoverflow.com/users/8603800/emma-b"}, "edited": false, "score": 0, "creation_date": 1505315611, "post_id": 46200242, "comment_id": 79364971, "body": "I think I worded that wrong. I know what cells the data will be put into. I just need a msgbox to come up when someone enters any data from A2:A5 on worksheet 2"}, {"owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "reply_to_user": {"reputation": 41, "user_id": 8603800, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Emma B", "link": "https://stackoverflow.com/users/8603800/emma-b"}, "edited": false, "score": 0, "creation_date": 1505345087, "post_id": 46200242, "comment_id": 79379792, "body": "what are criteria which need a msgbox come up?"}], "tags": [], "owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "is_accepted": false, "score": 0, "last_activity_date": 1505313090, "creation_date": 1505313090, "answer_id": 46200242, "question_id": 46199858, "link": "https://stackoverflow.com/questions/46199858/excel-userform-how-to-check-certain-cells-before-accepting-data/46200242#46200242", "title": "Excel userform: how to check certain cells before accepting data?", "body": "<p>Please use this code:</p>\n\n<pre><code>Private Sub OkCommandButton_Click()\n    Dim emptyRow As Long\n    Dim MsgString as String\n\n    Sheet1.Activate\n\n    emptyRow = WorksheetFunction.CountA(Range(\"A:A\")) + 1\n\n    MsgString = \"Do you want to update data?\" &amp; vbNewLine &amp; \"A\" &amp; emptyRow &amp; \" = \" &amp; EntityNameTextBox.Value &amp; vbNewLine &amp; \"B\" &amp; emptyRow &amp; \" = \" &amp; JurComboBox.Value &amp; vbNewLine &amp; \"C\" &amp; emptyRow &amp; \" = \" &amp; MailTypeComboBox.Value\n    If MsgBox(MsgString, vbYesNo, \"Update confirmation...!!!\") = vbYes Then\n        Cells(emptyRow, 1).Value = EntityNameTextBox.Value\n        Cells(emptyRow, 2).Value = JurComboBox.Value\n        Cells(emptyRow, 3).Value = MailTypeComboBox.Value\n    Else\n        Msgbox \"Data Update failed.\", vbExclamation, \"Failed update data.\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Hope this help.</p>\n"}], "owner": {"reputation": 41, "user_id": 8603800, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Emma B", "link": "https://stackoverflow.com/users/8603800/emma-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1505313090, "creation_date": 1505311990, "last_edit_date": 1505312237, "question_id": 46199858, "link": "https://stackoverflow.com/questions/46199858/excel-userform-how-to-check-certain-cells-before-accepting-data", "title": "Excel userform: how to check certain cells before accepting data?", "body": "<pre><code>Private Sub CancelCommandButton_Click()\n    Unload Me\nEnd Sub\n\nPrivate Sub ClearCommandButton_Click()\n    Call UserForm_Initialize\nEnd Sub\n\nPrivate Sub OkCommandButton_Click()\n    Dim emptyRow As Long\n\n    Sheet1.Activate\n\n    emptyRow = WorksheetFunction.CountA(Range(\"A:A\")) + 1\n\n    Cells(emptyRow, 1).Value = EntityNameTextBox.Value\n    Cells(emptyRow, 2).Value = JurComboBox.Value\n    Cells(emptyRow, 3).Value = MailTypeComboBox.Value\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    EntityNameTextBox.Value = \"\"\n\n    JurComboBox.Clear\n\n    With JurComboBox\n        .AddItem \"AL\"\n        .AddItem \"AK\"\n        .AddItem \"AR\"\n        .AddItem \"AZ\"\n        .AddItem \"CA\"\n        .AddItem \"CO\"\n        .AddItem \"CT\"\n        .AddItem \"DE\"\n        .AddItem \"HI\"\n        .AddItem \"IA\"\n    End With\n\n    MailTypeComboBox.Clear\n\n    With MailTypeComboBox\n        .AddItem \"AR\"\n        .AddItem \"ARR\"\n        .AddItem \"DOR\"\n        .AddItem \"DTN\"\n        .AddItem \"FAR\"\n    End With\n\n    EntityNameTextBox.SetFocus\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 1, "creation_date": 1505311839, "post_id": 46199658, "comment_id": 79362185, "body": "Are you getting a Char value with <code>CellChars = CellChars + 1</code>? isn&#39;t it better to make: <code>CellChars = Chr(64 + i)</code> and <code>i = i +1</code>"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505312020, "post_id": 46199658, "comment_id": 79362319, "body": "Yeah, I caught that right after I posted my question.  I modified the script a bit.  It&#39;s close now, but still not working like I want it to."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1505312158, "creation_date": 1505312158, "answer_id": 46199917, "question_id": 46199658, "link": "https://stackoverflow.com/questions/46199658/trying-to-fill-blanks-with-alpha-characters-based-on-number-above/46199917#46199917", "title": "Trying to fill blanks with alpha characters based on number above", "body": "<p>Oh, I got it.  This works!!</p>\n\n<pre><code>Sub AlphaFill()\n    Dim Cell, CellChars\n    Dim Default, Prompt, Title\n    Dim rangeSelected As Range\n    Dim UpperCase As Boolean\n    On Error Resume Next\n    Set rangeSelected = Range(\"F1:F21400\")\n\n    For Each Cell In rangeSelected\n\n        If Cell.Value &lt;&gt; \"\" Then\n            KeepValue = Cell.Value\n            i = 1\n        End If\n\n        If Cell.Value = \"\" Then\n            CellChars = Chr(64 + i)\n            If Not UpperCase Then CellChars = UCase(CellChars)\n            Cell.Value = KeepValue &amp; CellChars\n            i = i + 1\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 0, "last_activity_date": 1505312805, "last_edit_date": 1505312805, "creation_date": 1505312423, "answer_id": 46200013, "question_id": 46199658, "link": "https://stackoverflow.com/questions/46199658/trying-to-fill-blanks-with-alpha-characters-based-on-number-above/46200013#46200013", "title": "Trying to fill blanks with alpha characters based on number above", "body": "<p>Assuming your data is as</p>\n\n<p><a href=\"https://i.stack.imgur.com/9Bjtj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9Bjtj.png\" alt=\"enter image description here\"></a></p>\n\n<p>Try this</p>\n\n<pre><code>Sub AlphaFill()\n    Dim Cell, CellChars\n    Dim Default, Prompt, Title\n    Dim rangeSelected As Range\n    Dim UpperCase As Boolean\n    Dim charIndex As Long\n    On Error Resume Next\n    Set rangeSelected = Range(\"F1:F21400\")\n\n    UpperCase = True\n    charIndex = 65\n    For Each Cell In rangeSelected\n        If Cell.Value = \"\" Then\n            If InStr(Cell.Offset(-1, 0), \".\") &gt; 0 Then  'check if value contains \".\"\n                Cell.Value = Left(Cell.Offset(-1, 0), WorksheetFunction.Find(\".\", Cell.Offset(-1, 0))) &amp; Chr(charIndex) 'extract the string till \".\"\n            Else\n                Cell.Value = Cell.Offset(-1, 0) &amp; \".\" &amp; Chr(charIndex)  'get the number and add \".\"\n            End If\n            charIndex = charIndex + 1\n        Else\n            If charIndex &lt;&gt; 65 Then charIndex = 65  'if cell is not blank set charIndex to 65\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>This will give result as</p>\n\n<p><a href=\"https://i.stack.imgur.com/YSBeb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YSBeb.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1505312521, "creation_date": 1505312521, "answer_id": 46200040, "question_id": 46199658, "link": "https://stackoverflow.com/questions/46199658/trying-to-fill-blanks-with-alpha-characters-based-on-number-above/46200040#46200040", "title": "Trying to fill blanks with alpha characters based on number above", "body": "<p>If I understand correctly then you need to store the last whole number you see  then use that on the next blank cell, resetting the counter between gaps:</p>\n\n<pre><code>Sub AlphaFill()\n    Dim Cell            As Range\n    Dim UpperCase       As Boolean\n    Dim LastWholeNumber As String\n    Dim LastLetter      As Long\n    Dim CurrentNumber   As String\n\n    UpperCase = True\n\n    For Each Cell In Range(\"F1:F21400\")\n        CurrentNumber = Cell.Value\n\n        If CurrentNumber = \"\" Then\n            LastLetter = LastLetter + 1\n            Cell.Value = LastWholeNumber &amp; \".\" &amp; ChrW$(LastLetter)\n        ElseIf InStr(CurrentNumber, \".\") = 0 Then\n            '// whole number - store it &amp; reset to A/a \n            LastLetter = IIf(UpperCase, 64, 97)\n            LastWholeNumber = CurrentNumber\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 46200040, "answer_count": 3, "score": 2, "last_activity_date": 1505312805, "creation_date": 1505311395, "last_edit_date": 1531164843, "question_id": 46199658, "link": "https://stackoverflow.com/questions/46199658/trying-to-fill-blanks-with-alpha-characters-based-on-number-above", "title": "Trying to fill blanks with alpha characters based on number above", "body": "<p>I have this.</p>\n\n<pre><code>3\n3.1\n3.2\n3.3\n3.4\n4\n4.1\nNULL\nNULL\nNULL\nNULL\n5\n</code></pre>\n\n<p>I would like this.</p>\n\n<pre><code>3\n3.1\n3.2\n3.3\n3.4\n4\n4.1\n4.A\n4.B\n4.C\n4.D\n5\n</code></pre>\n\n<p>I have about 22k rows to fill in.  How can I do it?  I put together the code below, bu tit doesn't do what I want.  I need to start over with prior number + 'A' whenever a new blank cell is found.</p>\n\n<p>This is what I have so far, but it doesn't work.</p>\n\n<pre><code>Sub AlphaFill()\n    Dim Cell, CellChars\n    Dim Default, Prompt, Title\n    Dim rangeSelected As Range\n    Dim UpperCase As Boolean\n    On Error Resume Next\n    Set rangeSelected = Range(\"F1:F21400\")\n\n    For Each Cell In rangeSelected\n\n        If Cell.Value &lt;&gt; \"\" Then\n            i = 1\n        End If\n\n        If Cell.Value = \"\" Then\n            CellChars = Chr(64 + i)\n            If Not UpperCase Then CellChars = UCase(CellChars)\n            Cell.Value = Cell.Value &amp; CellChars\n            i = i + 1\n        End If\n\n        Debug.Print Cell.Value\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>The problem is, I can't seem to preserve the prior cell, for instance, the 4.A, 4.B, 4.C, and 4.D</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1505311322, "post_id": 46199574, "comment_id": 79361851, "body": "Using <code>Range</code> as a variable is a bad idea since <code>Range</code> is the name of an important method and type. Also -- where are you trying to concatenate the values <i>to</i>? The first column, clearing the remaining columns?"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 1, "creation_date": 1505311451, "post_id": 46199574, "comment_id": 79361932, "body": "Using <code>Select</code> is not a good practice either."}, {"owner": {"reputation": 21, "user_id": 8581836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c0d0c20f6207d3409140cb3e0c98a0?s=128&d=identicon&r=PG&f=1", "display_name": "Pranjal Dixit", "link": "https://stackoverflow.com/users/8581836/pranjal-dixit"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1505311768, "post_id": 46199574, "comment_id": 79362123, "body": "@JohnColeman If I am concatenating C&amp;D then i am Concatenating to column C and then E and so on. What are the other alternatives to <code>.Select</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1505311983, "post_id": 46199574, "comment_id": 79362285, "body": "@JohnColeman true, except using unqualified/implicit <code>Range</code> calls is an <a href=\"https://stackoverflow.com/q/8047943/1188513\">extremely common source of errors</a>. At least by shadowing the global <code>Range</code> property with a local variable, OP is avoiding this common trap. OP should definitely learn to <a href=\"https://stackoverflow.com/q/10714251/1188513\">avoid Select and Activate</a> though."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1505314659, "post_id": 46199574, "comment_id": 79364358, "body": "Using an array always gives better performance than looping through a range, especially if you are working with many data. If you use the method shown in my answer, you can easily write the results back."}], "answers": [{"tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": false, "score": 0, "last_activity_date": 1505313340, "last_edit_date": 1505313340, "creation_date": 1505312412, "answer_id": 46200009, "question_id": 46199574, "link": "https://stackoverflow.com/questions/46199574/macro-to-concatenate-two-columns-at-a-time-in-a-range/46200009#46200009", "title": "Macro to Concatenate two columns at a time in a range", "body": "<p>Try this:</p>\n\n<pre><code>Sub Concat()\nDim i As Long, j As Long\nFor i = 1 To 100 'number of rows\n    j = 1 'reset column to 1\n    Do While j &lt; 25 'max number of columns (until Column Y-Z)\n        j = j + 2 'start from third column (Column C)\n        Cells(i, j) = Cells(i, j) &amp; \" \" &amp; Cells(i, j + 1) 'concat\n        Cells(i, j + 1).ClearContents 'clear\n    Loop\nNext i 'next row\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 0, "last_activity_date": 1505313560, "creation_date": 1505313560, "answer_id": 46200412, "question_id": 46199574, "link": "https://stackoverflow.com/questions/46199574/macro-to-concatenate-two-columns-at-a-time-in-a-range/46200412#46200412", "title": "Macro to Concatenate two columns at a time in a range", "body": "<p>Try this:</p>\n\n<pre><code>Sub ConcatAltCellsInAltCols()\n    Dim oW As Worksheet: Set oW = ThisWorkbook.Worksheets(\"Sheet11\")\n    Dim iLC As Long: iLC = oW.Cells(1, oW.Columns.Count).End(xlToLeft).Column\n    Dim iLR As Long: iLR = oW.Cells(oW.Rows.Count, 3).End(xlUp).Row\n    Dim iC As Long\n    Dim iR As Long\n\n    For iR = 1 To iLR\n        For iC = 3 To iLC Step 2\n            oW.Cells(iR, iC).Value = oW.Cells(iR, iC) &amp; oW.Cells(iR, iC + 1)\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 8581836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c0d0c20f6207d3409140cb3e0c98a0?s=128&d=identicon&r=PG&f=1", "display_name": "Pranjal Dixit", "link": "https://stackoverflow.com/users/8581836/pranjal-dixit"}, "edited": false, "score": 0, "creation_date": 1505314242, "post_id": 46200415, "comment_id": 79364042, "body": "<code>v(lng, j * 2 + 1) = v(lng, j * 2 + 1) &amp; v(lng, j * 2 + 2)</code> I received a runtime error &quot;Subscript out of range&quot;"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 21, "user_id": 8581836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c0d0c20f6207d3409140cb3e0c98a0?s=128&d=identicon&r=PG&f=1", "display_name": "Pranjal Dixit", "link": "https://stackoverflow.com/users/8581836/pranjal-dixit"}, "edited": false, "score": 0, "creation_date": 1505314829, "post_id": 46200415, "comment_id": 79364486, "body": "Did you Change your sheet Name to yours?"}, {"owner": {"reputation": 21, "user_id": 8581836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c0d0c20f6207d3409140cb3e0c98a0?s=128&d=identicon&r=PG&f=1", "display_name": "Pranjal Dixit", "link": "https://stackoverflow.com/users/8581836/pranjal-dixit"}, "edited": false, "score": 0, "creation_date": 1505315639, "post_id": 46200415, "comment_id": 79364992, "body": "Yes I did change"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 21, "user_id": 8581836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c0d0c20f6207d3409140cb3e0c98a0?s=128&d=identicon&r=PG&f=1", "display_name": "Pranjal Dixit", "link": "https://stackoverflow.com/users/8581836/pranjal-dixit"}, "edited": false, "score": 0, "creation_date": 1505315653, "post_id": 46200415, "comment_id": 79365006, "body": "@Pranjal Dixit, Did you change the proposed sheet name &quot;Concat&quot; to an existing work sheet you are using? Otherwise the name is missing in the worksheets collection and you receive the mentioned error."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 21, "user_id": 8581836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c0d0c20f6207d3409140cb3e0c98a0?s=128&d=identicon&r=PG&f=1", "display_name": "Pranjal Dixit", "link": "https://stackoverflow.com/users/8581836/pranjal-dixit"}, "edited": false, "score": 0, "creation_date": 1505316884, "post_id": 46200415, "comment_id": 79365944, "body": "You can check the limits of your (two dimensional) array if you insert the following code line bevor the For - Next Loop:  <b>MsgBox LBound(v, 1) &amp; &quot;:&quot; &amp; UBound(v, 1) &amp; vbNewLine &amp; _              LBound(v, 2) &amp; &quot;:&quot; &amp; UBound(v, 2)</b>   --- it should be 1:100 1:24, if you are using the range C1:Z100"}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1505316375, "last_edit_date": 1505316375, "creation_date": 1505313564, "answer_id": 46200415, "question_id": 46199574, "link": "https://stackoverflow.com/questions/46199574/macro-to-concatenate-two-columns-at-a-time-in-a-range/46200415#46200415", "title": "Macro to Concatenate two columns at a time in a range", "body": "<p>Try this using a one based array for better Performance:</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\nSub Conc()\nDim ws As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"Concat\")  ' &lt;== change \"Concat\" to your sheet name to avoid subscript error\nDim v       ' variant\nDim lng As Long\nDim j   As Integer          ' corr.\n' use one based array to get field data\n  v = ws.Range(\"C1:Z100\")   ' your OP range\n  For lng = 1 To UBound(v)\n  ' concatenate columns C&amp;D, E&amp;F, G&amp;H, ...\n    For j = 0 To 11\n       v(lng, j * 2 + 1) = v(lng, j * 2 + 1) &amp; v(lng, j * 2 + 2)\n    Next j\n\n  Next lng\n' write array values back (overwriting D, F, H,... with the same values)\n  ws.Range(\"C1:Z100\") = v     ' your OP range\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8581836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c0d0c20f6207d3409140cb3e0c98a0?s=128&d=identicon&r=PG&f=1", "display_name": "Pranjal Dixit", "link": "https://stackoverflow.com/users/8581836/pranjal-dixit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 533, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1505316375, "creation_date": 1505311174, "last_edit_date": 1505311619, "question_id": 46199574, "link": "https://stackoverflow.com/questions/46199574/macro-to-concatenate-two-columns-at-a-time-in-a-range", "title": "Macro to Concatenate two columns at a time in a range", "body": "<p>I have to create a Macro which lets me Concatenate two columns at a time in a given range. For example: In range C1:Z200, I want to concatenate Column C&amp;D, E&amp;F, G&amp;H and so on. How do I do it. This is my current code which only concatenate first two columns..rest remains the same.</p>\n\n<pre><code>Set Range = ActiveSheet.Range(\"C1:Z100\")\nFor Each c In Range\n    c.Select\n    ActiveCell.FormulaR1C1 = ActiveCell &amp; \" \" &amp; ActiveCell.Offset(0, 1)\n    ActiveCell.Offset(0, 1).Activate\n    Selection.Clear\n    ActiveCell.Offset(0, 2).Activate\nNext c\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "is_accepted": false, "score": 0, "last_activity_date": 1505311597, "creation_date": 1505311597, "answer_id": 46199719, "question_id": 46199529, "link": "https://stackoverflow.com/questions/46199529/excel-merge-similar-rows-into-one-row-based-on-3-columns/46199719#46199719", "title": "Excel Merge Similar Rows into one row based on 3 columns", "body": "<p>Please try to change the word:</p>\n\n<pre><code>Rng.Offset(, 1)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Rng.Offset(, 3)\n</code></pre>\n\n<p>Hope this help.</p>\n"}], "owner": {"reputation": 11, "user_id": 3722665, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153295683839948/picture?type=large", "display_name": "TomCusick", "link": "https://stackoverflow.com/users/3722665/tomcusick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505311597, "creation_date": 1505311060, "question_id": 46199529, "link": "https://stackoverflow.com/questions/46199529/excel-merge-similar-rows-into-one-row-based-on-3-columns", "title": "Excel Merge Similar Rows into one row based on 3 columns", "body": "<p>OK, So I have a spreadsheet that was made by combining two identically structured spreadsheets that merged all the data into one.  The problem is that both spreadsheets have \"similar\" data but one has more data than the other but both have data that is missing in each of the spreadsheets but all the data is required to be kept.  One suggestion I was given was to manually go through the spreadsheet row by row to combine the rows.  Given there are 5000 rows in this spreadsheet, this option is not desirable.  I did find a VB Script that allowed me to combine rows of similar information, the problem was it seems to only combine everything into on row based on one column of information.</p>\n\n<pre><code>    Sub MG30Nov12()\n    'Updateby20150519\n    Dim Rng As Range\n    Dim InputRng As Range\n    Dim nRng As Range\n    Set InputRng = Application.Selection\n    Set InputRng = Application.InputBox(\"Range :\", xTitleId, InputRng.Address, Type:=8)\n    Set InputRng = InputRng.Parent.Range(InputRng.Columns(1).Address)\n    With CreateObject(\"scripting.dictionary\")\n    .CompareMode = vbTextCompare\n    For Each Rng In InputRng\n        If Not .Exists(Rng.Value) Then\n            .Add Rng.Value, Rng.Offset(, 1)\n        Else\n            .Item(Rng.Value).Value = .Item(Rng.Value).Value + Rng.Offset(, 1)\n                If nRng Is Nothing Then\n                    Set nRng = Rng\n                Else\n                    Set nRng = Union(nRng, Rng)\n                End If\n        End If\n    Next\n    If Not nRng Is Nothing Then\n        nRng.EntireRow.Delete\n    End If\n    End With\n    End Sub\n</code></pre>\n\n<p>What i would like to do is do something like this but combine over multiple coulmn data.</p>\n\n<p>Any ideas or suggestions?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "edited": false, "score": 2, "creation_date": 1505310576, "post_id": 46199056, "comment_id": 79361301, "body": "Best strategy is to try something and, when it doesn&#39;t work, analyse why it doesn&#39;t. Then try something else. Once you have a pretty clear idea about what&#39;s not working, ask your peers to help you with that specific problem, describing your problem and what you&#39;ve done to solve it so far."}], "answers": [{"tags": [], "owner": {"reputation": 280, "user_id": 3260114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe3577e2b0037362ccb927a3ec5be78?s=128&d=identicon&r=PG&f=1", "display_name": "acousticismX", "link": "https://stackoverflow.com/users/3260114/acousticismx"}, "is_accepted": false, "score": 0, "last_activity_date": 1505319969, "creation_date": 1505319969, "answer_id": 46202550, "question_id": 46199056, "link": "https://stackoverflow.com/questions/46199056/merge-excel-rows-based-on-other-column-values/46202550#46202550", "title": "Merge excel rows based on other column values?", "body": "<p>I had to do something similar a while ago. Here are the steps:</p>\n\n<p>1) formula in column D:</p>\n\n<pre><code>= IF (A1=B1, CONCATENATE(C1, \",\", C2), \"\")\n</code></pre>\n\n<p>2) apply a filter on column D for blank cells</p>\n\n<p>3) delete all rows that have blank column D</p>\n\n<p>4) remove filter</p>\n\n<p>5) delete column C</p>\n\n<p>Note: This is only efficient for \"one time use\" situations. If you need to do this often, developing a macro may be more efficient. </p>\n"}], "owner": {"reputation": 2241, "user_id": 2622577, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8752808a672f43213e2975a2bb263bb3?s=128&d=identicon&r=PG", "display_name": "Vanquiza", "link": "https://stackoverflow.com/users/2622577/vanquiza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505319969, "creation_date": 1505309730, "question_id": 46199056, "link": "https://stackoverflow.com/questions/46199056/merge-excel-rows-based-on-other-column-values", "title": "Merge excel rows based on other column values?", "body": "<p>I'd like to do the following with VBA or just excels standard merge options if possible:</p>\n\n<p>I have the following 3 columns:\n<a href=\"https://i.imgur.com/TDdNxoq.png\" rel=\"nofollow noreferrer\">https://i.imgur.com/TDdNxoq.png</a></p>\n\n<p>I what I want to do is to check whether the content of column A and B is identical, then merge both rows into one and comma separate the values in column C:</p>\n\n<p><a href=\"https://i.imgur.com/eGm6Uj9.png\" rel=\"nofollow noreferrer\">https://i.imgur.com/eGm6Uj9.png</a></p>\n\n<p>How can I do this?</p>\n"}, {"tags": ["excel", "automation", "password-protection", "vba"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1505309421, "post_id": 46198737, "comment_id": 79360393, "body": "Not possible. The best you could do is probably sendkeys, but I&#39;d advise against it"}, {"owner": {"reputation": 432, "user_id": 3626597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/xju6d.jpg?s=128&g=1", "display_name": "Tima", "link": "https://stackoverflow.com/users/3626597/tima"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1505309764, "post_id": 46198737, "comment_id": 79360655, "body": "I know about sendkeys method to unprotect the VBA project and even more to protect it, but once it is unprotected you have to reopen the workbook so that the protection works again, unlike the protect/unprotect of sheets/workbooks."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1505310225, "post_id": 46198737, "comment_id": 79361015, "body": "<i>&quot;I know about sendkeys method&quot;</i>. Then <b>say so</b> in your question. Or are you expecting us to keep playing this game with you until we come up with something you don&#39;t know? That said, we&#39;re not going to come up with a magic solution to this one anyway. Excel/VBA has its limitations."}], "owner": {"reputation": 432, "user_id": 3626597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/xju6d.jpg?s=128&g=1", "display_name": "Tima", "link": "https://stackoverflow.com/users/3626597/tima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1505308810, "creation_date": 1505308810, "last_edit_date": 1531164843, "question_id": 46198737, "link": "https://stackoverflow.com/questions/46198737/get-codename-with-protected-vba-project-excel-vba", "title": "Get CodeName with Protected VBA project - Excel (VBA)", "body": "<p>I have a UDF:</p>\n\n<pre><code>Function SheetFromCodeName(aName As String, Optional WB As Workbook) As Worksheet\n    If WB Is Nothing Then Set WB = ThisWorkbook\n    With WB\n        Set SheetFromCodeName = .Sheets(.VBProject.VBComponents(aName).Properties(\"Index\"))\n    End With\nEnd Function\n</code></pre>\n\n<p>And is called via this code:</p>\n\n<p><code>Set TargetAnalysis = SheetFromCodeName(AnalysisSheetCodeName)</code></p>\n\n<p>My VBA project is password protected so this lines causes an error and I have to un-protect the VBA project which is not allowed for user.</p>\n\n<p>Is there a way (work-around) to:</p>\n\n<ul>\n<li><p>Unprotect VBA Project</p></li>\n<li><p>Do my Stuff</p></li>\n<li><p>Protect it again without closing and opening the Workbook</p></li>\n</ul>\n\n<p>Something similar to:</p>\n\n<pre><code>Sub Foo()\n  Dim passKey As String\n  passKey = \"123\"\n  ActiveSheet.Unprotect passKey\n\n  // Foo-Related stuff here\n\n  ActiveSheet.Protect passKey, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1\nEnd Sub\n</code></pre>\n\n<p>In case this can't be done, are there any protection method other than password ?</p>\n"}, {"tags": ["vba", "excel", "function"], "comments": [{"owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "edited": false, "score": 0, "creation_date": 1505308910, "post_id": 46198671, "comment_id": 79359977, "body": "i beliave you&#39;ve mistakenly put the set wb and for each linew twice. anyway, the problem might arise from the range(&quot;a:a&quot;). instead you should try it range(&quot;a6:a614&quot;)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1505308920, "post_id": 46198671, "comment_id": 79359983, "body": "You can&#39;t modify the reference ranges in the sumifs only the criteria by which it is checked."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1505309146, "post_id": 46198671, "comment_id": 79360150, "body": "Your best choice is going to be load both ranges into an array and cycle through the array that has H6:H414 doing your checks and if it matches sum the corresponding value from the other array."}, {"owner": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505309652, "post_id": 46198671, "comment_id": 79360577, "body": "Thank you for your replies,  Actually I put H6:H414 because I have cell of fills with text in H5 and H415 so I do not want &quot;confuse&quot; the function left with my conditions with that text. But not sure it really matter, simply  (H:H) might run. Scott Craner , you mean doing a loop within the new aray I would create..?"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505311422, "post_id": 46199481, "comment_id": 79361915, "body": "Thank you for your answer Cyril , indeed use the With is better , but I still get a mismatch error (error 13)..."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505312081, "post_id": 46199481, "comment_id": 79362372, "body": "@IlvarNourtan Did you try the recommendation to ensure that the Left(,) is picking up the assumed value?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505312140, "post_id": 46199481, "comment_id": 79362428, "body": "@IlvarNourtan also try using &quot;&gt;=3&quot;"}, {"owner": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505312617, "post_id": 46199481, "comment_id": 79362820, "body": "It seems to be picked up correctly since by doing step by step it crash at: SumResult2 = WorksheetFunction.SumIfs(.Range(&quot;A6:A414&quot;), rngH, &quot;&lt;1&quot;, rngH, &quot;=&gt;3&quot;)"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505316179, "post_id": 46199481, "comment_id": 79365380, "body": "@IlvarNourtan You never declared SumResult2; you have declared SumResult"}, {"owner": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505317416, "post_id": 46199481, "comment_id": 79366315, "body": "oh Yes I know this is because I have other column to sum and decide to only show one to explain better, and I did a typo in the code while I was pasting here, sorry,"}, {"owner": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505317590, "post_id": 46199481, "comment_id": 79366443, "body": "I restarted everything with your idea , I created 2 simples excel files with only column A and H , which I filled until row 10 with number. And the problem remains the same when I run .."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505319519, "post_id": 46199481, "comment_id": 79367687, "body": "@IlvarNourtan See edit.  Went a different route than correcting the sumifs().  A simple loop with if-criteria should provide the desired output."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505319898, "post_id": 46199481, "comment_id": 79367907, "body": "@IlvarNourtan In testing, I&#39;m curious about your criteria... is it supposed to be &gt;1 and &lt;=3 ?"}, {"owner": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505321278, "post_id": 46199481, "comment_id": 79368722, "body": "Thanks a lot for the idea of the loop,  No actually this is  1 &lt;rngH&lt;3  I know the critera I provided totally do not work, but as I was so &quot;upset&quot; I tried with every combination of critera and I left the wrong one ,  but Yes the correct i  &lt;3 and &gt;=1  of course ..."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505321385, "post_id": 46199481, "comment_id": 79368790, "body": "@IlvarNourtan lol, that is what I was asking; you confirmed my question.  Your code written shows less than 1 and greater than or equal to 3.  I gave both examples in the code I posted (commented out the &quot;correct&quot; version)."}, {"owner": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505321466, "post_id": 46199481, "comment_id": 79368837, "body": "This is not the source of the problem unfortunately.. And for the output of j , As I want it to shift below for every new sheet looped , can I do it something like:   Workbooks(&quot;Libro1&quot;).Sheets(&quot;Hoja1&quot;).Range(&quot;A1&quot;).Value = j.Offset(1, 0)  ?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505321591, "post_id": 46199481, "comment_id": 79368920, "body": "@IlvarNourtan  I understand this is not the problem source, but wanted to make sure the corrections I provided were correct.  I would recommend using the loop I provided as the simplest means to circumvent the issue in using SumIfs."}, {"owner": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505322049, "post_id": 46199481, "comment_id": 79369178, "body": "Yes is seems a very good idea,  it does not display error message when I run it , but nothing appears in my excel file I think is a problem of output , I don&#39;t know how to shift the j in the row below once it changes of file .."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505323919, "post_id": 46199481, "comment_id": 79370192, "body": "@IlvarNourtan See the edit I made, moving the j out of the if statement, but in doing so I also had to specify that k=0 after j has been updated.  Where there was no output from the previous code, it was because nothing met the criteria, so j and k were always 0.  I don&#39;t think I understand what you mean by <i>shift the j in the row below once it changes of file</i>.  Could you elaborate?"}, {"owner": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505327746, "post_id": 46199481, "comment_id": 79372398, "body": "I explained all I am trying to do below, hope I am not too long in my explanations. It has been several day I am working in it, not so easy as a VBA novice,  Your loop appears to be the most sensible solution"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505333417, "post_id": 46199481, "comment_id": 79375390, "body": "@IlvarNourtan Take a look at Edit2.  I have the loop occuring for hours 0 to 23 (b) and goign through your rows (6:414)."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505333595, "post_id": 46199481, "comment_id": 79375479, "body": "@IlvarNourtan The biggest assumptions are in that output, where b represents the column.  I assumed that row 1 is headers and column 1 was also headers.  You can utilize &quot;b+2&quot; to be columns(0+2)=columns(b), which iterates with each b from 0 to 24."}, {"owner": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505335862, "post_id": 46199481, "comment_id": 79376571, "body": "Cyril, Thank you very much, you just made my day, I have to commute from work to home (sorry to tell my life), Ill run everything when I reach my house , this triple loops seems very efficient"}, {"owner": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505487754, "post_id": 46199481, "comment_id": 79448992, "body": "But with this lasr code, I will be able to fill only one row, it does not change of row when it changes of file .."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505493462, "post_id": 46199481, "comment_id": 79452154, "body": "@IlvarNourtan You would need to tie this to the workbook, as you loop through those in your code.  Not to push you away, but I believe we&#39;ve moved far beyond the use of Left and SumIfs, which was what the post was about.  It might be worthwhile to post another question about tying your FileObj to a number (possibly counting each book used).  Give me a few to edit my response to include something about that."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505493881, "post_id": 46199481, "comment_id": 79452338, "body": "@IlvarNourtan  See my Edit3.  That should resolve that issue."}, {"owner": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1505587533, "post_id": 46199481, "comment_id": 79478051, "body": "Well, I did not understand everything I guess;  e=d right after For Each fileobj In FolderObj.Files     Set wB = Workbooks.Open(fileobj.Path)  But I will define 24 different variables it might works this way too ,   thanks for everything"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1506704712, "post_id": 46199481, "comment_id": 79941804, "body": "@IlvarNourtan I apologize for not responding to your comment; I appear to have missed it (13 days ago... bad on me).  The e=d is because you are adding and iterating at the end of each loop to get d.  You want d=e+f, and you want e to increase to the last total (d), so before you start iterating again, you make e = d, so that new total = old total + f."}, {"owner": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1506706009, "post_id": 46199481, "comment_id": 79942430, "body": "Absolutely no problem, thank you for your reply. Therefore, for each new files runned through the loop d has to increase by 1 this is the idea?  As well you put two times the &quot; ForEach ...&quot; it was&#39;nt done on purpose right?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1506706781, "post_id": 46199481, "comment_id": 79942829, "body": "@IlvarNourtan That is the idea, that you iterate by 1 for each loop.  I corrected the error in my post; you were correct that there should not be 2x For each."}, {"owner": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1506708947, "post_id": 46199481, "comment_id": 79943973, "body": "Oh I got it,  I am a very beginner with VBA and in this kind if programming of general , as one can imagine. Your anwers had been really useful for me. Thank you for all"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 1, "last_activity_date": 1506706648, "last_edit_date": 1506706648, "creation_date": 1505310904, "answer_id": 46199481, "question_id": 46198671, "link": "https://stackoverflow.com/questions/46198671/macro-vba-trying-to-combine-sumifs-and-left/46199481#46199481", "title": "Macro VBA, trying to combine SumIfs and Left", "body": "<p>The only glaring issue I see is an inconsistency in ranges; will also shorten up the text using a with statement:</p>\n\n<pre><code>With wB.Sheets(\"Schedule Daily Bank Structure R\")\n    SumResult2 = WorksheetFunction.SumIfs(.Range(\"A6:A414\"), Left(.Range(\"H6:H414\").Value, 2), \"&lt;1\", Left(.Range(\"H6:H414\").Value, 2), \"=&gt;3\")\nEnd With\n</code></pre>\n\n<p>A:A versus A4:A414, being the inconsistency.  You are evaluating from H6 down, which does not correlate directly to A6 down when using A:A.</p>\n\n<hr>\n\n<p>If you're still having issues and you think it's the Left(,) portion of your work, I would recommend setting a dimension, such as:</p>\n\n<pre><code>Dim rngH as Integer\n\n    With wB.Sheets(\"Schedule Daily Bank Structure R\")\n        rngH = Left(.Range(\"H6:H414\").Value, 2)\n        SumResult2 = WorksheetFunction.SumIfs(.Range(\"A6:A414\"), rngH, \"&lt;1\", rngH, \"=&gt;3\")\n    End With\n</code></pre>\n\n<p>When you step through the code, you will be able to see if rngH is being picked up correctly.  If it is picked up correctly, then you can check to make sure that your parameters for the range are as expected by VBA.</p>\n\n<hr>\n\n<p><em>Edit:</em>  Giving you a different approach:</p>\n\n<pre><code>    Dim rngH, i, j, k As Integer\n    With wB.Sheets(\"Schedule Daily Bank Structure R\")\n        For i = 6 To 414\n            rngH = Left(.Cells(i, \"H\").Value, 2)\n            If rngH &gt; 1 And rngH &lt;= 3 Then 'Value is between 1 and 3; corrected per comments\n                k = .Cells(i, \"A\").Value\n            End If\n            j = j + k\n            K=0\n        Next i\n        'Output j somewhere\n    End With\n</code></pre>\n\n<p>This will, rather than using sumifs function, uses just a loop.</p>\n\n<hr>\n\n<p><em>Edt2:</em></p>\n\n<p>Let's give you one more change to this, now that we've got a better understanding of where you want to be:</p>\n\n<pre><code>Dim rngH, i, j, k, b As Integer\nWith wB.Sheets(\"Schedule Daily Bank Structure R\")\n    For b = 0 to 23\n        For i = 6 To 414\n            rngH = Left(.Cells(i, \"H\").Value, 2)\n            If rngH = b Then\n                k = .Cells(i, \"A\").Value\n            End If\n            j = j + k\n            K=0\n        Next i\n        Sheets(\"Master\").Cells(2, b+2).Value = j 'Edit this where you want the output\n        j=0\n    Next b\nEnd With\n</code></pre>\n\n<p>This would be able to be run for each workbook, reporting data for each hour (no need for a range if you're looking to get operations in a single hour).  Where Sheets(\"Master\") is used, figure out where you want the reporting value to be.</p>\n\n<hr>\n\n<p><strong>Edit3:</strong></p>\n\n<p>We're outside of the scope of the question, but will try to give one last bit of help:</p>\n\n<pre><code>   For Each fileobj In FolderObj.Files\n       Set wB = Workbooks.Open(fileobj.Path)\n\n   e = d\n\n   'Other code to go through the hours\n   Sheets(\"Master\").Cells(d+2, b+2).Value = j 'Edit this where you want the output\n   'Hopefully that makes sense\n\n   f = 1\n   d = e + f\n\nNext fileobj\n</code></pre>\n\n<p>This would give a value that iterates with the fileobj change, which can be directly added to the output cell as the row.  Just make sure to Dim d as Long, e as Long, f as Long.</p>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "is_accepted": false, "score": 0, "last_activity_date": 1505326681, "last_edit_date": 1505326681, "creation_date": 1505318413, "answer_id": 46202099, "question_id": 46198671, "link": "https://stackoverflow.com/questions/46198671/macro-vba-trying-to-combine-sumifs-and-left/46202099#46202099", "title": "Macro VBA, trying to combine SumIfs and Left", "body": "<p>I am currently here:\nI tries it with a extreme simple excel file, and I  get a mismatch error in:\n SumResult2 = WorksheetFunction.SumIfs(.Range(\"A2:A11\"), rngH, \"=>0\", rngH, \"&lt;2\")</p>\n\n<pre><code>Sub refresh_OEdc3333_data_files()\nApplication.ScreenUpdating = False\n\nDim wB As Workbook\nDim SumResult As Double\nDim OutPutRange As Range\nSet FileSystemObj = CreateObject(\"Scripting.FileSystemObject\")\n'Fill it with your own adress\nSet FolderObj = FileSystemObj.GetFolder(\"C:...\\\")\nSet OutPutRange = Workbooks(\"Libro1\").Sheets(\"Hoja1\").Range(\"D4\")\n\n   For Each fileobj In FolderObj.Files\n       Set wB = Workbooks.Open(fileobj.Path)\n\n     Dim rngH As Integer\n\nWith wB.Sheets(\"Hoja1\")\n    rngH = Right(.Range(\"H2:H11\").Value, 2)\n    SumResult = WorksheetFunction.SumIfs(.Range(\"A2:A11\"), rngH, \"=&gt;0\", rngH, \"&lt;2\")\nEnd With\n\n\n\n       OutPutRange.Value = SumResult\n       Set OutPutRange = OutPutRange.Offset(1, 0)\n    wB.Save\nwB.Close\n\nNext fileobj\n</code></pre>\n\n<p>End Sub</p>\n\n<p>It do not look that difficult though ... but impossible to get a result</p>\n\n<p>Actually, I have a folder full of excel sheet with the same form and for each of those document I have in column A  certains number of operation, this number is associated with a certain hour, 12:03 appears 1203 in column H. </p>\n\n<p>For example one can have for sheet 1 of the folder:</p>\n\n<pre><code>A        H\n4242     0032\n2342     0034\n653      0043\n865      0057\n53       0154\n64       0159\n</code></pre>\n\n<p>And in sheet2 :</p>\n\n<pre><code>A       H\n54      0002\n76      0045\n54      0056\n43      0058\n56      0105\n765     0153\n43      0157\n .       .\n .       .\n .       .\n546     2334\n43      2359\n</code></pre>\n\n<p>What I am trying to do is to create a matrix in another worksheet which would be under the form:</p>\n\n<pre><code>    H1    H2    H3    H4    H5 ... H24 \n\n1\n2\n3\n4\n.\n.\n.\nTotal number of file in my folder\n</code></pre>\n\n<p>H1 ...H24 correspond at a time slot, for example H1 : 00:00 to 00:59, H2 01:00 to 01:59 ... etc </p>\n\n<p>1, 2, 3 ... is the number of sheets</p>\n\n<p>This matrix would sum the number of operation (contained in A) for each period of time (each hour) and for each files, hence the matrix ...</p>\n\n<pre><code>Sub refresh_OEdc33333_data_files()\n'Application.ScreenUpdating = False\n\nDim wB As Workbook\nDim SumResult As Double\nDim OutPut As Range\nSet FileSystemObj = CreateObject(\"Scripting.FileSystemObject\")\n'Fill it with your own adress\nSet FolderObj = FileSystemObj.GetFolder(\"C:...\\\")\nSet OutPut = Workbooks(\"Libro1\").Sheets(\"Hoja1\").Range(\"A1\")\n\n   For Each fileobj In FolderObj.Files\n       Set wB = Workbooks.Open(fileobj.Path)\n\n   Dim rngH, i, j, k As Integer\n\nWith wB.Sheets(\"Hoja1\")\n    For i = 2 To 11\n        rngH = Left(.Cells(i, \"H\").Value, 2)\n        If rngH &lt; 7 And rngH &gt;= 0 Then\n            k = .Cells(i, \"A\").Value\n\n        End If\n\n     k = 0\n   j = j + k\n\n    Next i\n\n      OutPut.Value = j\n Set OutPut = OutPut.Offset(1, 0)\n\n     End With\n\n\n    wB.Save\nwB.Close\n\nNext fileobj\n</code></pre>\n\n<p>End Sub</p>\n\n<p>And my idea is to repeat 24 times the loop you gave me. So far it gave me only 0 .. but I am sure your idea is the good one</p>\n"}], "owner": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "accepted_answer_id": 46199481, "answer_count": 2, "score": 0, "last_activity_date": 1506706648, "creation_date": 1505308627, "last_edit_date": 1531164843, "question_id": 46198671, "link": "https://stackoverflow.com/questions/46198671/macro-vba-trying-to-combine-sumifs-and-left", "title": "Macro VBA, trying to combine SumIfs and Left", "body": "<p>I am trying to run a <code>Sumifs</code> function in VBA with <code>Left</code> function inside: </p>\n\n<p>I have:</p>\n\n<pre><code>Sub refresh_OEdc_data_files()\n    Application.ScreenUpdating = False\n\n    Dim wB As Workbook\n    Dim SumResult As Double\n    Dim OutPutRange As Range\n    Set FileSystemObj = CreateObject(\"Scripting.FileSystemObject\")\n    'Fill it with your own adress\n    Set FolderObj = FileSystemObj.GetFolder(\"C:...\\\")\n    Set OutPutRange = Workbooks(\"Libro4\").Sheets(\"Hoja1\").Range(\"D4\")\n    For Each fileobj In FolderObj.Files\n        Set wB = Workbooks.Open(fileobj.Path)\n\n       For Each fileobj In FolderObj.Files\n           Set wB = Workbooks.Open(fileobj.Path)\n           'My Problem is here\n           SumResult = WorksheetFunction.SumIfs(wB.Sheets(\"Schedule Daily Bank Structure R\").Range(\"A:A\"), Left(wB.Sheets(\"Schedule Daily Bank Structure R\").Range(\"H6:H414\").Value, 2), \"&lt;1\", Left(wB.Sheets(\"Schedule Daily Bank Structure R\").Range(\"H6:H414\").Value, 2), \"=&gt;3\")\n\n           OutPutRange.Value = SumResult\n           Set OutPutRange = OutPutRange.Offset(1, 0)\n        wB.Save\n    wB.Close\n\n    Next fileobj\nEnd Sub\n\n'SumResult2 = WorksheetFunction.SumIfs(wB.Sheets(\"Schedule Daily Bank Structure R\").Range(\"A:A\"), Left(wB.Sheets(\"Schedule Daily Bank Structure R\").Range(\"H6:H414\").Value, 2), \"&lt;1\", Left(wB.Sheets(\"Schedule Daily Bank Structure R\").Range(\"H6:H\").Value, 2), \"=&gt;3\")\n'Does not seem to be well specified \n</code></pre>\n\n<p>I have constantly the message \"Error 13\" so , I guess my <code>SumIfs</code> is wrong, but I cannot figure out what is,  hope I can still loop different Excel files within it (my wb) I don't know where the problem is coming from. \nIt does not work with a simple <code>SumIf</code> either.</p>\n"}, {"tags": ["excel", "vba", "timer", "ontime"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1505308725, "post_id": 46198563, "comment_id": 79359830, "body": "You could add public intLastHrRun, intLastMinuteRun and intLastSecondRun and then compare the <code>time</code> values to this and if different hour, which I suppose is all you need really, then run, if the same hr, then dont.  Or set ` Now + TimeValue(&quot;01:00:00&quot;), ` to a var, and then cancel the on time after running for this time, then reset in PLTimer."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1505309941, "post_id": 46198563, "comment_id": 79360804, "body": "@Nathan_Sav It would be better to do <code>Dim TimeLastRun as Double</code> since this will be very precise compared to storing three <code>Integer</code>s and comparing them."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1505310026, "post_id": 46198563, "comment_id": 79360858, "body": "@mclapham If the issue is indeed that the code is running too quickly, just add <code>Application.Wait(TimeValue(&quot;00:01:00&quot;))</code> before calling <code>PLTimer</code>. This will add an explicit wait that is a minute long."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1505310190, "post_id": 46198563, "comment_id": 79360984, "body": "<a href=\"https://stackoverflow.com/questions/20002666/vba-how-do-i-really-stop-application-ontime\" title=\"vba how do i really stop application ontime\">stackoverflow.com/questions/20002666/&hellip;</a>   Use the cancelling of the timer in this post, by setting a public variable to hold the time last called."}, {"owner": {"reputation": 43, "user_id": 8587788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0004216e5d791aa9c426a87a3e35b73?s=128&d=identicon&r=PG&f=1", "display_name": "mclapham", "link": "https://stackoverflow.com/users/8587788/mclapham"}, "edited": false, "score": 0, "creation_date": 1505313903, "post_id": 46198563, "comment_id": 79363770, "body": "None of these seem to work, when I try the application.wait method my excel freezes.. Any ideas?"}, {"owner": {"reputation": 2173, "user_id": 8259647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMyr5.jpg?s=128&g=1", "display_name": "Kresimir L.", "link": "https://stackoverflow.com/users/8259647/kresimir-l"}, "edited": false, "score": 0, "creation_date": 1505319076, "post_id": 46198563, "comment_id": 79367420, "body": "Set Application.Wait to just one second, like <code>Application.Wait(TimeValue(&quot;00:00:01&quot;))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 9452051, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tofulicious", "link": "https://stackoverflow.com/users/9452051/tofulicious"}, "is_accepted": false, "score": 0, "last_activity_date": 1520350675, "creation_date": 1520350675, "answer_id": 49134614, "question_id": 46198563, "link": "https://stackoverflow.com/questions/46198563/excel-vba-ontime-macro-running-multiple-times/49134614#49134614", "title": "Excel VBA OnTime Macro running multiple times", "body": "<p>@mclapham I solved the freezing that you described in your comments by using <code>Application.Wait Now + TimeValue(\"00:00:01\")</code> before calling <code>Application.OnTime</code> again.</p>\n"}], "owner": {"reputation": 43, "user_id": 8587788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0004216e5d791aa9c426a87a3e35b73?s=128&d=identicon&r=PG&f=1", "display_name": "mclapham", "link": "https://stackoverflow.com/users/8587788/mclapham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1018, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1609984987, "creation_date": 1505308352, "last_edit_date": 1609984987, "question_id": 46198563, "link": "https://stackoverflow.com/questions/46198563/excel-vba-ontime-macro-running-multiple-times", "title": "Excel VBA OnTime Macro running multiple times", "body": "<p>I have a simple code that will copy the current value of my stock portfolio and paste it into a table. I recently tried to add in a timer so that it did this automatically every hour. It works, however, it pastes the value four or five times into the table. I searched around and I think this might be because it takes only a split second to run the macro and so it loops until a full second has passed.</p>\n<p>Here's the code:</p>\n<pre><code>Sub AutoPL()\n    Worksheets(&quot;Overview&quot;).Range(&quot;C15:D15&quot;).Copy\n    Worksheets(&quot;Data&quot;).Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).PasteSpecial                     xlPasteValues\n    Application.CutCopyMode = False\n    Call PLTimer\nEnd Sub\n\n\nSub PLTimer()\n    Application.OnTime Now + TimeValue(&quot;01:00:00&quot;), &quot;AutoPL&quot;\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505309225, "post_id": 46198525, "comment_id": 79360216, "body": "<i>Initially I had the &#39;Options Explicit&#39; on at the start of the code but I took it off</i> - very, very bad move."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505310742, "post_id": 46198525, "comment_id": 79361438, "body": "Consider using an <a href=\"http://rubberduckvba.com/indenter\" rel=\"nofollow noreferrer\">indenter</a> to better highlight what line of code belongs under which loop or conditional block."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505311639, "post_id": 46198525, "comment_id": 79362044, "body": "^^ disclaimer: I manage that OSS VBE add-in project. FWIW its code inspections will highlight a number of common beginner traps, like that <code>Dim file_path, list_file, final_message As String</code> declaration you have here, which declares <code>final_message</code> as a <code>String</code>, and the other two as implicit <code>Variant</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505314237, "post_id": 46198525, "comment_id": 79364040, "body": "I&#39;ve rolled back your answer-invalidating edit. Please don&#39;t do that."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "edited": false, "score": 0, "creation_date": 1505313350, "post_id": 46199390, "comment_id": 79363343, "body": "Thanks a lot for the help. Corrected most of my &#39;beginner&#39;s mistakes&#39; and edited the code. But you were right, it doesn&#39;t work as expected. Any help would be appreciated!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "edited": false, "score": 0, "creation_date": 1505314194, "post_id": 46199390, "comment_id": 79364002, "body": "Please don&#39;t change your question after you&#39;ve received an answer that solves the problem you asked about, and read <a href=\"https://meta.stackoverflow.com/q/284236/1188513\"><i>Why is \u201cCan someone help me?\u201d not an actual question?</i></a>. Stack Overflow is a Q&amp;A site that gives specific answers to specific questions useful to other people - it&#39;s not a &quot;please help me debug my code&quot; service. Learn to use your IDE&#39;s debugger. F9 to toggle breakpoints, F8 to step through; use the locals and immediate toolwindows."}, {"owner": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "edited": false, "score": 0, "creation_date": 1505315538, "post_id": 46199390, "comment_id": 79364924, "body": "I apologize. Was just desperate to figure it out. Thanks for the help though. Although I remember me not asking &quot;can someone help?&quot;, I get where your frustration is coming from. I am learning a lot from this site and will make sure not to take unfair advantage and/or just use it as a debugging site. As for the debugging tools, I am using them breakpoints and step thru&#39;s to see the flow of code and the values of variables, but I wasn&#39;t able to get thru in spite of that. Anyways,....thanks. Won&#39;t happen again"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1505310624, "creation_date": 1505310624, "answer_id": 46199390, "question_id": 46198525, "link": "https://stackoverflow.com/questions/46198525/runtime-error-424-object-required-vba/46199390#46199390", "title": "Runtime error 424 Object required VBA", "body": "<pre><code>binProbe = probeSh.Cells(i_probe, 3) 'set bin value of current wafer of probe sheet\n</code></pre>\n\n<p>Ignoring the fact that this (as well as <code>siteProbe</code> and <code>yieldProbe</code>) is getting overwritten at every new iteration of the loop it's in, I doubt any of these <code>Case</code> blocks works as you intend them to.</p>\n\n<p><code>binProbe</code> is declared as a <code>Variant</code>, but the way it's assigned, its content is going to be whatever the <em>value</em> of the cell is - that's a string, a date, a double, ...or an error.</p>\n\n<p>Here's a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that reproduces the exact error message and issue you're having:</p>\n\n<pre><code>Public Sub BlowUp()\n    Debug.Print Application.WorksheetFunction.CountIf(CVErr(xlErrValue), \"1\")\nEnd Sub\n</code></pre>\n\n<p>What does that mean? It means if you <em>probed</em> the value of <code>binProbe</code> in break/debug mode, you'd see that it contains an Excel cell error value, which can't be used with math: you're feeding your worksheet function with <code>#N/A</code> or <code>#VALUE!</code> or <code>#REF!</code> or whatever - it doesn't know what to do with it, and throws \"Object Required\" at you, because it's expecting to be given a <code>Range</code> (or an array), not an error value.</p>\n\n<p>To give it a <code>Range</code>, declare <code>binProbe As Range</code>, and <code>Set</code> its value when you assign it:</p>\n\n<pre><code>Set binProbe = probeSh.Cells(i_probe, 3) 'set bin value of current wafer of probe sheet\n</code></pre>\n\n<p>Then before you use its value for anything, validate that it's not a cell error:</p>\n\n<pre><code>If IsError(binProbe.Value) Then\n     ' can't use this value\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8401487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6122714768374678b7919872b521e6a1?s=128&d=identicon&r=PG&f=1", "display_name": "out1121", "link": "https://stackoverflow.com/users/8401487/out1121"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 610, "favorite_count": 0, "accepted_answer_id": 46199390, "answer_count": 1, "score": 0, "last_activity_date": 1505314210, "creation_date": 1505308258, "last_edit_date": 1531164843, "question_id": 46198525, "link": "https://stackoverflow.com/questions/46198525/runtime-error-424-object-required-vba", "title": "Runtime error 424 Object required VBA", "body": "<p>I have this piece of code to calculate the yield using a formula for each of four given cases. However, I am getting an <em>object required</em> error and have been trying to solve it but in vain.</p>\n\n<p>Initially I had the 'Options Explicit' on at the start of the code but I took it off, I tried changing the type of yieldProbe but it didn't help. I am relatively new to VBA, any help would be appreciated. </p>\n\n<pre><code>Sub getYield()\n\nDim siteProbe, binProbe As Variant\nDim yieldProbe As Variant\nDim SelectFolder As String\nDim MyObj As Object, MySource As Object, file As Variant\nDim file_path, list_file, final_message As String\nDim csvFiles As Variant\nDim probe As Workbook\nDim probeSh As Worksheet\nDim lastRowProbe As Long\n\nSelectFolder = GetFolder(\"c:\\\")\nApplication.ScreenUpdating = False\n 'Check user did not cancel folder selection\nIf SelectFolder = \"\" Then\n    MsgBox \"No Folder Selected - Cannot continue\", vbCritical\n    End\nEnd If\n\nSelectFolder = SelectFolder &amp; \"\\\"\ncsvFiles = Dir(SelectFolder &amp; \"*.csv\")\nDo While csvFiles &lt;&gt; \"\"\n\n\n\n    Set probe = Workbooks.Open(SelectFolder &amp; csvFiles) 'will auto open\n    Set probeSh = probe.ActiveSheet 'name of sheet ex probe sheet in probe workbook\n    lastRowProbe = probeSh.Range(\"D10000\").End(xlUp).Row 'gets last row of Probe Sheet\n    Columns(\"Z:Z\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"Z1\").Value = \"Yield\"\n\n    For i_probe = lastRowProbe To 7 Step -1 'to loop through all Probe rows to obtain the HBin and Site Values\n    siteProbe = probeSh.Cells(i_probe, 6).Value 'set site value of current wafer of probe sheet\n    binProbe = probeSh.Cells(i_probe, 3) 'set bin value of current wafer of probe sheet\n    yieldProbe = probeSh.Cells(i_probe, 26) 'set the yield value for the Z column\n\n\n     Next i_probe\n\n    Select Case siteProbe\n\n\n\n    Case \"1\"\n\n    yieldProbe = ((Application.WorksheetFunction.CountIf(binProbe, \"1\")) / Application.WorksheetFunction.Count(binProbe)) * 100\n\n    Case \"2\"\n\n   yieldProbe = ((Application.WorksheetFunction.CountIf(binProbe, \"1\")) / Application.WorksheetFunction.Count(binProbe)) * 100\n\n    Case \"3\"\n\n    ' error 424 here:\n    yieldProbe = ((Application.WorksheetFunction.CountIf(binProbe, \"1\")) / Application.WorksheetFunction.Count(binProbe)) * 100\n\n    Case \"4\"\n\n    yieldProbe = ((Application.WorksheetFunction.CountIf(binProbe, \"1\")) / Application.WorksheetFunction.Count(binProbe)) * 100\n\n    Case \"5\"\n\n    yieldProbe = ((Application.WorksheetFunction.CountIf(binProbe, \"1\")) / Application.WorksheetFunction.Count(binProbe)) * 100\n\n    End Select\n\n\n\n\n\n\n    x = x + 1\n    probe.Close True\n    csvFiles = Dir\n\nLoop\n\nApplication.ScreenUpdating = True\nMsgBox \"A total of \" &amp; CStr(x) &amp; \" files processed\", vbInformation\nOn Error GoTo 0\nExit Sub\n\n\n\nEnd Sub\n\nFunction GetFolder(strPath As String) As String\nDim fldr As FileDialog\nDim sItem As String\n\n\nSet fldr = Application.FileDialog(msoFileDialogFolderPicker)\nWith fldr\n    .Title = \"Select probe files\"\n    .AllowMultiSelect = False\n    .InitialFileName = strPath\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    sItem = .SelectedItems(1)\nEnd With\nNextCode:\nGetFolder = sItem\nSet fldr = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1505308336, "post_id": 46198205, "comment_id": 79359551, "body": "Apparently you forgot in your last piece of code to reference <b>ActivePresentation</b>"}, {"owner": {"reputation": 65, "user_id": 8550364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/876b695abd65e653700bfb158b5edbac?s=128&d=identicon&r=PG&f=1", "display_name": "dart852", "link": "https://stackoverflow.com/users/8550364/dart852"}, "reply_to_user": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1505309016, "post_id": 46198205, "comment_id": 79360053, "body": "@TSion.D.P thank you for commenting. How/where would I add code to reference <code>ActivePresentation</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 8550364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/876b695abd65e653700bfb158b5edbac?s=128&d=identicon&r=PG&f=1", "display_name": "dart852", "link": "https://stackoverflow.com/users/8550364/dart852"}, "edited": false, "score": 0, "creation_date": 1505310533, "post_id": 46198973, "comment_id": 79361256, "body": "I entered your code and tried running the macro. I did not receive any errors but...nothing happened. No files being saved, no opening and closing, nothing."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 65, "user_id": 8550364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/876b695abd65e653700bfb158b5edbac?s=128&d=identicon&r=PG&f=1", "display_name": "dart852", "link": "https://stackoverflow.com/users/8550364/dart852"}, "edited": false, "score": 1, "creation_date": 1505314664, "post_id": 46198973, "comment_id": 79364363, "body": "@dart852 That&#39;s because Filename is blank to start with and your loop only works while it&#39;s NON-blank. You need to use Dir(path,filespec) at least once before that to assign the first found file name to Filename.  Also, the code shown above doesn&#39;t open any files to process.  Have a look at some example code on my PPT FAQ site that should answer the need:  <a href=\"http://www.pptfaq.com/FAQ00536_Batch-_Do_something_to_every_file_in_a_folder.htm\" rel=\"nofollow noreferrer\">pptfaq.com/&hellip;</a>"}, {"owner": {"reputation": 65, "user_id": 8550364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/876b695abd65e653700bfb158b5edbac?s=128&d=identicon&r=PG&f=1", "display_name": "dart852", "link": "https://stackoverflow.com/users/8550364/dart852"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1505326303, "post_id": 46198973, "comment_id": 79371528, "body": "@SteveRindsberg I&#39;ve used your website for a few other macros! It&#39;s very helpful! Using your site I managed to get the macro working. Now I need to find code that also selects <code>Yes</code> on the pop-up that asks if I want to save the presentation as a macro-free presentation..."}, {"owner": {"reputation": 65, "user_id": 8550364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/876b695abd65e653700bfb158b5edbac?s=128&d=identicon&r=PG&f=1", "display_name": "dart852", "link": "https://stackoverflow.com/users/8550364/dart852"}, "edited": false, "score": 0, "creation_date": 1505333543, "post_id": 46198973, "comment_id": 79375445, "body": "Been trying for the last few hours. While the converting code works, no line of code I&#39;ve found seems to automatically stop the <code>To continue saving as a macro-free workbook, click Yes</code> pop up..."}, {"owner": {"reputation": 65, "user_id": 8550364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/876b695abd65e653700bfb158b5edbac?s=128&d=identicon&r=PG&f=1", "display_name": "dart852", "link": "https://stackoverflow.com/users/8550364/dart852"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1505334429, "post_id": 46198973, "comment_id": 79375935, "body": "Actually @SteveRindsberg , I need this conversion because I used the SplitFile code on your website <a href=\"http://www.pptfaq.com/FAQ01086_Break_a_presentation_up_into_several_smaller_presentations.htm\" rel=\"nofollow noreferrer\">pptfaq.com/&hellip;</a> . Is there a way to make it save the copies as PPTX instead of PPTM??"}, {"owner": {"reputation": 65, "user_id": 8550364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/876b695abd65e653700bfb158b5edbac?s=128&d=identicon&r=PG&f=1", "display_name": "dart852", "link": "https://stackoverflow.com/users/8550364/dart852"}, "edited": false, "score": 0, "creation_date": 1505334763, "post_id": 46198973, "comment_id": 79376069, "body": "Sorry for the continued comments. Solved it myself. The original file should be a <code>ppt</code> instead of <code>pptm</code> or <code>pptx</code> and then it all works out"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 65, "user_id": 8550364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/876b695abd65e653700bfb158b5edbac?s=128&d=identicon&r=PG&f=1", "display_name": "dart852", "link": "https://stackoverflow.com/users/8550364/dart852"}, "edited": false, "score": 0, "creation_date": 1505354760, "post_id": 46198973, "comment_id": 79382010, "body": "@dart852 It&#39;d work as well with a PPTX, I expect, and you could probably save PPTMs as PPT w/o it barking at you, though depending on what&#39;s in the file, you might lose some fidelity or find the files ballooning in size. Another approach might be to start a new file based on the same template then copy each slide from the original (PPTM) to the new file, which you save as PPTX. There&#39;s also a way of removing the macro code from the file under program control, I&#39;m pretty sure, but have never gone there."}], "tags": [], "owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "is_accepted": true, "score": 1, "last_activity_date": 1505309503, "creation_date": 1505309503, "answer_id": 46198973, "question_id": 46198205, "link": "https://stackoverflow.com/questions/46198205/saveas-pptm-to-pptx/46198973#46198973", "title": "SaveAs PPTM to PPTX", "body": "<p>Something like:</p>\n\n<pre><code>Sub ProcessFiles()\n    Dim Filename, FileFormat As String\n    Dim initialDisplayAlerts As Boolean\n    initialDisplayAlerts = Application.DisplayAlerts\n    Application.DisplayAlerts = False\n    With ActivePresentation\n        Do While Filename &lt;&gt; \"\"\n\n            .SaveCopyAs _\n              Filename:=.Path &amp; \"\\\" &amp; Left(.Name, InStrRev(.Name, \".\")) &amp; \"pptx\", _\n                                FileFormat:=ppSaveAsOpenXMLPresentation\n\n           Filename = Dir()\n       Loop\n   End With\n   Application.DisplayAlerts = initialDisplayAlerts\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 8550364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/876b695abd65e653700bfb158b5edbac?s=128&d=identicon&r=PG&f=1", "display_name": "dart852", "link": "https://stackoverflow.com/users/8550364/dart852"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 698, "favorite_count": 0, "accepted_answer_id": 46198973, "answer_count": 1, "score": 0, "last_activity_date": 1610885648, "creation_date": 1505307290, "last_edit_date": 1610885648, "question_id": 46198205, "link": "https://stackoverflow.com/questions/46198205/saveas-pptm-to-pptx", "title": "SaveAs PPTM to PPTX", "body": "<p>I need to turn a batch of pptm files into pptx. I tried to repurpose VBA code that turns xlsx files into xls files. The macro opens an xlsx file in a designated folder, saves it as an xls file, closes it, and moves on to the next file until all are converted. The original macro code was:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ProcessFiles()\n    Dim Filename, Pathname, saveFileName As String\n    Dim wb As Workbook\n    Dim initialDisplayAlerts As Boolean\n    Pathname = &quot;&lt;insert_path_here&gt;&quot;  ' Needs to have a trailing \\\n    Filename = Dir(Pathname &amp; &quot;*.xlsx&quot;)\n    initialDisplayAlerts = Application.DisplayAlerts\n    Application.DisplayAlerts = False\n    Do While Filename &lt;&gt; &quot;&quot;\n    Set wb = Workbooks.Open(Filename:=Pathname &amp; Filename, _\n                            UpdateLinks:=False)\n    wb.CheckCompatibility = False\n    saveFileName = Replace(Filename, &quot;.xlsx&quot;, &quot;.xls&quot;)\n    wb.SaveAs Filename:=Pathname &amp; saveFileName, _\n              FileFormat:=xlExcel8, Password:=&quot;&quot;, WriteResPassword:=&quot;&quot;, _\n              ReadOnlyRecommended:=False, CreateBackup:=False\n    wb.Close SaveChanges:=False\n    Filename = Dir()\n    Loop\n    Application.DisplayAlerts = initialDisplayAlerts\nEnd Sub\n</code></pre>\n<p>I modified it in the following way:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ProcessFiles()\n    Dim Filename, Pathname, saveFileName As String\n    Dim ppPres As Presentation\n    Dim initialDisplayAlerts As Boolean\n    Pathname = &quot;\\\\TRIFS03\\RoamingProfiles\\user\\Documents\\projectfolder\\testfolder\\&quot;  ' Needs to have a trailing \\\n    Filename = Dir(Pathname &amp; &quot;*.pptm&quot;)\n    initialDisplayAlerts = Application.DisplayAlerts\n    Application.DisplayAlerts = False\n    Do While Filename &lt;&gt; &quot;&quot;\n    Set ppPres = Presentations.Open(Filename:=Pathname &amp; Filename, _\n                            UpdateLinks:=False)\n    ppPres.CheckCompatibility = False\n    saveFileName = Replace(Filename, &quot;.pptm&quot;, &quot;.pptx&quot;)\n    ppPres.SaveAs Filename:=Pathname &amp; saveFileName, _\n              FileFormat:=ppSaveAsOpenXMLPresentation, Password:=&quot;&quot;, WriteResPassword:=&quot;&quot;, _\n              ReadOnlyRecommended:=False, CreateBackup:=False\n    ppPres.Close SaveChanges:=False\n    Filename = Dir()\n    Loop\n    Application.DisplayAlerts = initialDisplayAlerts\nEnd Sub\n</code></pre>\n<p>I get</p>\n<blockquote>\n<p>Compile Error Named Argument Not Found</p>\n</blockquote>\n<p>pointing to <code>UpdateLinks:=</code>.</p>\n<p>I did some research and found that I should delete this bit of code. I was left with the following:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ProcessFiles()\n    Dim Filename, Pathname, saveFileName As String\n    Dim ppPres As Presentation\n    Dim initialDisplayAlerts As Boolean\n    Pathname = &quot;\\\\TRIFS03\\RoamingProfiles\\user\\Documents\\projectfolder\\testfolder\\&quot;  ' Needs to have a trailing \\\n    Filename = Dir(Pathname &amp; &quot;*.pptm&quot;)\n    initialDisplayAlerts = Application.DisplayAlerts\n    Application.DisplayAlerts = False\n    Do While Filename &lt;&gt; &quot;&quot;\n        Set ppPres = Presentations.Open(Filename:=Pathname &amp; Filename)\n        ppPres.CheckCompatibility = False\n        saveFileName = Replace(Filename, &quot;.pptm&quot;, &quot;.pptx&quot;)\n        ppPres.SaveAs Filename:=Pathname &amp; saveFileName, _\n              FileFormat:=ppSaveAsOpenXMLPresentation, Password:=&quot;&quot;, WriteResPassword:=&quot;&quot;, _\n              ReadOnlyRecommended:=False, CreateBackup:=False\n        ppPres.Close SaveChanges:=False\n        Filename = Dir()\n    Loop\n    Application.DisplayAlerts = initialDisplayAlerts\nEnd Sub\n</code></pre>\n<p>I got</p>\n<blockquote>\n<p>Compile Error Method or Data Member not Found</p>\n</blockquote>\n<p>pointing to <code>.CheckCompatability =</code>.</p>\n<p>I tried deleting THAT one.</p>\n<blockquote>\n<p>Compile Error Named Argument Not Found</p>\n</blockquote>\n<p>pointing to <code>Password:=</code>.</p>\n<p>I decided to look for a new macro:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>With ActivePresentation\n    .SaveCopyAs _\n      FileName:=.Path &amp; &quot;\\&quot; &amp; Left(.Name, InStrRev(.Name, &quot;.&quot;)) &amp; &quot;pptx&quot;, _\n      FileFormat:=ppSaveAsOpenXMLPresentation\nEnd With\n</code></pre>\n<p>I added loop code and ended up with:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ProcessFiles()\n    Dim Filename, FileFormat As String\n    Dim initialDisplayAlerts As Boolean\n    initialDisplayAlerts = Application.DisplayAlerts\n    Application.DisplayAlerts = False\n    Do While Filename &lt;&gt; &quot;&quot;\n        .SaveCopyAs _\n          Filename:=.Path &amp; &quot;\\&quot; &amp; Left(.Name, InStrRev(.Name, &quot;.&quot;)) &amp; &quot;pptx&quot;, _\n          FileFormat:=ppSaveAsOpenXMLPresentation\n        ppPres.Close SaveChanges:=False\n        Filename = Dir()\n    Loop\n    Application.DisplayAlerts = initialDisplayAlerts\nEnd Sub\n</code></pre>\n<p>Which ended up with</p>\n<blockquote>\n<p>Compile Error Invalid or Unqualified Reference</p>\n</blockquote>\n<p>with <code>.Path</code> being pointed to as the culprit.<br />\nAccording to the <a href=\"https://stackoverflow.com/questions/18289234/save-powerpoint-pptm-to-pptx\">code\u2019s author</a> (see top voted answer), I shouldn\u2019t need to define <code>.Path</code> if I\u2019m using <code>\\</code>.</p>\n"}, {"tags": ["excel", "vba", "validation"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1505307295, "post_id": 46198161, "comment_id": 79358717, "body": "Get rid of the extra quotes, you are telling it to look for text that look like numbers not actual numbers: <code>&quot;=1&quot;</code>"}, {"owner": {"reputation": 95, "user_id": 8218639, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8766fe708ad55ba2d3c131116a40e58?s=128&d=identicon&r=PG&f=1", "display_name": "Antti", "link": "https://stackoverflow.com/users/8218639/antti"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1505307614, "post_id": 46198161, "comment_id": 79358954, "body": "Yes. that solved that! :-)"}], "owner": {"reputation": 95, "user_id": 8218639, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8766fe708ad55ba2d3c131116a40e58?s=128&d=identicon&r=PG&f=1", "display_name": "Antti", "link": "https://stackoverflow.com/users/8218639/antti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505307164, "creation_date": 1505307164, "question_id": 46198161, "link": "https://stackoverflow.com/questions/46198161/excel-vba-data-validation-does-change-color-when-numbers-are-place", "title": "Excel VBA Data validation does change color when numbers are place", "body": "<p>The following code works as expected if I have words besides of numbers etc...</p>\n\n<blockquote>\n  <p>optionList(0) = \"cat\" </p>\n  \n  <p>optionList(1) = \"dog\" </p>\n  \n  <p>optionList(2) = \"cow\"</p>\n</blockquote>\n\n<p>If I use numbers, the list generates as expected, <strong>but it does not change color.</strong> </p>\n\n<p>I don't get any error announcement. What I am missing here? </p>\n\n<pre><code>Public Function addDataValidation(row As Long, column As Long)\n\nDim optionList(3) As String\n\noptionList(0) = \"1\"\noptionList(1) = \"2\"\noptionList(2) = \"3\"\n\n    With mySheet.Cells(row, column).Validation\n\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n             Operator:=xlBetween, Formula1:=Join(optionList, \",\")\n\n    End With\n\n   With mySheet.Cells(row, column).FormatConditions.Add(xlCellValue, xlEqual, \"=\"\"1\"\"\")\n        .Font.Bold = True\n        .Interior.ColorIndex = 4\n        .StopIfTrue = False\n    End With\n\n    With mySheet.Cells(row, column).FormatConditions.Add(xlCellValue, xlEqual, \"=\"\"2\"\"\")\n        .Font.Bold = True\n        .Interior.ColorIndex = 6\n        .StopIfTrue = False\n    End With\n\n    With mySheet.Cells(row, column).FormatConditions.Add(xlCellValue, xlEqual, \"=\"\"3\"\"\")\n        .Font.Bold = True\n        .Interior.ColorIndex = 3\n        .StopIfTrue = False\n    End With\n\nmySheet.Cells(row, column).HorizontalAlignment = xlCenter\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "shell"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1505305865, "post_id": 46197633, "comment_id": 79357616, "body": "Please provide any code you have tried thusfar. We are on SO to collaborate and help with coding, not a code-for-you service."}, {"owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1505305958, "post_id": 46197633, "comment_id": 79357689, "body": "@Cyril Sir,I have updated the same in my query."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1505306579, "post_id": 46197633, "comment_id": 79358158, "body": "I don&#39;t get what you want to achieve with with the command window. If you are using VBA, why not read and write the textfiles withing VBA?"}, {"owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1505307464, "post_id": 46197633, "comment_id": 79358838, "body": "@FunThomas Dear Sir, VBA read and write will change the formatting and also as per my knowledge read data i can write in excel sheet only.i simply want to bifurcate data in txt file in same format same like main file."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1505307476, "post_id": 46197633, "comment_id": 79358850, "body": "If you know the file format, why not generate a <code>schema.ini</code> file for the file you want to read, and then query it with <code>sql</code> using an <code>adodb.connection</code> and an <code>adodb.recordset</code>?  Simplest option still to use a <code>FileSystemObject</code> and read/write from <code>VBA</code> itself though as @FunThomas suggests."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1505307532, "post_id": 46197633, "comment_id": 79358891, "body": "@sagar I&#39;m sorry, but that&#39;s nonsense...  <code>VBA</code> can read the file exactly as it is without making changes to it just by using a <code>FileSystemObject</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1505306318, "post_id": 46197776, "comment_id": 79357938, "body": "Note that the 1 in  (Loc,1) is equivalent to vbNormalFocus."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1505306186, "creation_date": 1505306186, "answer_id": 46197776, "question_id": 46197633, "link": "https://stackoverflow.com/questions/46197633/execute-cmd-command-via-vba-shell/46197776#46197776", "title": "execute CMD command via VBA -shell", "body": "<p>The Call Shell(,) command is what loads CMD.</p>\n\n<p>If you want to load a file from the CMD, through VBA, you would use something such as:</p>\n\n<pre><code>Sub Open_CPT()\n    Dim Loc As String\n    Loc = \"Z:/#CPT.bat\"\n    Call Shell(Loc, 1)\nEnd Sub\n</code></pre>\n\n<p>This will open the file or item at that location.</p>\n\n<p>Depending how you want to bifurcate/split your data, you might want to use the native function of Excel/VBA to open the file and delimit by spaces/tabs/etc.  You can then save as a .txt file, after modifications have been made how you want.</p>\n"}, {"tags": [], "owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "is_accepted": false, "score": 0, "last_activity_date": 1505396093, "creation_date": 1505396093, "answer_id": 46220611, "question_id": 46197633, "link": "https://stackoverflow.com/questions/46197633/execute-cmd-command-via-vba-shell/46220611#46220611", "title": "execute CMD command via VBA -shell", "body": "<p>Thanks for your guidance as per the instructions of <strong>Dave</strong> I have developed the below code with the help of <code>FileSystemObject</code> \nPlease find the below solution.</p>\n\n<pre><code>Sub VBA()\nDim fr, t As String\nDim s As String\n\nReDim arr(500) As String\nReDim arri(500) As String\n\nDim i As Long\ni = 0\nii = 0\nDim n As Integer\n\n\nDim fso\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\nfr = \"z:\\file3.txt\"\n\nSet oFS = fso.OpenTextFile(fr)\n\n\nDo While Not oFS.AtEndOfStream\n\narr(i) = oFS.ReadLine\nsls = InStr(1, arr(i), 1, vbTextCompare)\nIf sls &gt;= 1 Then\narri(ii) = arr(i)\nii = ii + 1\nEnd If\ni = i + 1\nLoop\n\noFS.Close\n\nn = FreeFile()\n\ns = arri(0)\nFor ix = LBound(arri) + 1 To UBound(arri)\ns = s &amp; vbCrLf &amp; arri(ix)\nNext\n\nOpen \"z:\\file2.txt\" For Output As #n\nPrint #n, s\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3851, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1505396093, "creation_date": 1505305765, "last_edit_date": 1531164843, "question_id": 46197633, "link": "https://stackoverflow.com/questions/46197633/execute-cmd-command-via-vba-shell", "title": "execute CMD command via VBA -shell", "body": "<p>Below is the example data availble in txt file</p>\n\n<p><a href=\"https://i.stack.imgur.com/suHzc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/suHzc.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to extract the data in another txt file which Sr no is 1.</p>\n\n<p>Please suggest me the VBA code which execute CMD command and bifurcate the data in another txt file.I have search the internet and got to know it is possible via use <strong>Shell(\"  \").</strong> help me to achieve my above object.</p>\n\n<p>My txt file(i.e. file3) is available in Z:\\ drive.</p>\n\n<p>via below code i can open the cmd command window</p>\n\n<pre><code>Sub macro()\nCall Shell(\"cmd.exe\", vbNormalFocus)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1505304407, "post_id": 46196714, "comment_id": 79356549, "body": "How are you populating the cell? Do you have a formula in the cell or are you typing the value straight into the cell?"}, {"owner": {"reputation": 299, "user_id": 4527488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wn23p.png?s=128&g=1", "display_name": "Vipul Karkar", "link": "https://stackoverflow.com/users/4527488/vipul-karkar"}, "edited": false, "score": 1, "creation_date": 1505304580, "post_id": 46196714, "comment_id": 79356669, "body": "Mark &quot;Stop if True&quot; for the first rule that will override all other settings."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1505304616, "post_id": 46196714, "comment_id": 79356688, "body": "Click on Manage Rules and with your second Conditional Formatting Rule which checks for Closed, check the Checkbox for Stop If True. See if that resolves your issue."}, {"owner": {"reputation": 119, "user_id": 1596425, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/152a1d7f19282c770b12a1a43c1739c5?s=128&d=identicon&r=PG", "display_name": "Omen", "link": "https://stackoverflow.com/users/1596425/omen"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1505309521, "post_id": 46196714, "comment_id": 79360484, "body": "@Zac I type there values by hand. No formulas."}, {"owner": {"reputation": 119, "user_id": 1596425, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/152a1d7f19282c770b12a1a43c1739c5?s=128&d=identicon&r=PG", "display_name": "Omen", "link": "https://stackoverflow.com/users/1596425/omen"}, "reply_to_user": {"reputation": 299, "user_id": 4527488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wn23p.png?s=128&g=1", "display_name": "Vipul Karkar", "link": "https://stackoverflow.com/users/4527488/vipul-karkar"}, "edited": false, "score": 0, "creation_date": 1505309583, "post_id": 46196714, "comment_id": 79360529, "body": "@Hellboy that&#39;s it! :D It is working now :D Thank you so much!"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 1596425, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/152a1d7f19282c770b12a1a43c1739c5?s=128&d=identicon&r=PG", "display_name": "Omen", "link": "https://stackoverflow.com/users/1596425/omen"}, "edited": false, "score": 0, "creation_date": 1505304330, "post_id": 46196874, "comment_id": 79356491, "body": "Tried just now, it has no effect"}, {"owner": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "reply_to_user": {"reputation": 119, "user_id": 1596425, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/152a1d7f19282c770b12a1a43c1739c5?s=128&d=identicon&r=PG", "display_name": "Omen", "link": "https://stackoverflow.com/users/1596425/omen"}, "edited": false, "score": 1, "creation_date": 1505306376, "post_id": 46196874, "comment_id": 79357985, "body": "Sorry, went back to read your question (it&#39;s so thorough and filled with images that it becomes quite difficult to read). Seems like you want to use &quot;Stop if true&quot; in conditional formatting manager, as other commenters have pointed out."}, {"owner": {"reputation": 119, "user_id": 1596425, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/152a1d7f19282c770b12a1a43c1739c5?s=128&d=identicon&r=PG", "display_name": "Omen", "link": "https://stackoverflow.com/users/1596425/omen"}, "edited": false, "score": 0, "creation_date": 1505311493, "post_id": 46196874, "comment_id": 79361959, "body": "is solved the problem. Stop if true worked like a charm. Thanks!"}], "tags": [], "owner": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "is_accepted": false, "score": 0, "last_activity_date": 1505303626, "creation_date": 1505303626, "answer_id": 46196874, "question_id": 46196714, "link": "https://stackoverflow.com/questions/46196714/hide-show-conditional-formatting-data-bar/46196874#46196874", "title": "Hide/Show Conditional Formatting Data Bar", "body": "<p>Have you tried checking this box? <a href=\"https://i.stack.imgur.com/JgaTv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JgaTv.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 119, "user_id": 1596425, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/152a1d7f19282c770b12a1a43c1739c5?s=128&d=identicon&r=PG", "display_name": "Omen", "link": "https://stackoverflow.com/users/1596425/omen"}, "is_accepted": true, "score": 0, "last_activity_date": 1505326625, "creation_date": 1505326625, "answer_id": 46204362, "question_id": 46196714, "link": "https://stackoverflow.com/questions/46196714/hide-show-conditional-formatting-data-bar/46204362#46204362", "title": "Hide/Show Conditional Formatting Data Bar", "body": "<p>\"Stop if true\" option on the first Conditional Formatting Rule stoped execution of below Data Bar rule.</p>\n"}], "owner": {"reputation": 119, "user_id": 1596425, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/152a1d7f19282c770b12a1a43c1739c5?s=128&d=identicon&r=PG", "display_name": "Omen", "link": "https://stackoverflow.com/users/1596425/omen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 639, "favorite_count": 0, "accepted_answer_id": 46204362, "answer_count": 2, "score": -1, "last_activity_date": 1505326625, "creation_date": 1505303191, "question_id": 46196714, "link": "https://stackoverflow.com/questions/46196714/hide-show-conditional-formatting-data-bar", "title": "Hide/Show Conditional Formatting Data Bar", "body": "<p>I have created a Conditional Formatting Data Bar showing % of task completion, however Excel seems to ignore this conditional formula position \non my Conditional Formatting layers, as Data Bar appears on top any other formatting I am trying to apply.</p>\n\n<p>What I would like to do is to hide/turn off Data Bar and cell text, if Status cell next to it contains text \u201cClosed\u201d. \nI managed to hide the text using Custom Format \u201c;;;\u201d in formatting, however Data Bar is on top of any other formatting I am trying to apply.</p>\n\n<p>Example below</p>\n\n<p><a href=\"https://i.stack.imgur.com/IIHzT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IIHzT.png\" alt=\"Show Bar\"></a>\n<a href=\"https://i.stack.imgur.com/u2dcN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u2dcN.png\" alt=\"Hide Bar\"></a></p>\n\n<p>Data Bar Conditional Formatting settings used</p>\n\n<p><a href=\"https://i.stack.imgur.com/M9Wns.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M9Wns.png\" alt=\"Data Bar Formatting\"></a>\n<a href=\"https://i.stack.imgur.com/K9ZcQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K9ZcQ.png\" alt=\"Conditional Formatting layers\"></a></p>\n\n<p>Status Column \"override\" formatting settings (hide text using ;;; and apply cell fill colour)</p>\n\n<p><a href=\"https://i.stack.imgur.com/vYaB4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vYaB4.png\" alt=\"Top formatting\"></a>\n<a href=\"https://i.stack.imgur.com/TpUtr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TpUtr.png\" alt=\"enter image description here\"></a></p>\n\n<p>Please help. Thanks</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1505306982, "post_id": 46196686, "comment_id": 79358483, "body": "This isn&#39;t a code writing service.  The post from Ashok, you could of added your comments yourself."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5856450, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VpV3WR-xGjE/AAAAAAAAAAI/AAAAAAAAABY/DV5tHC4ZdLE/photo.jpg?sz=128", "display_name": "Nicole Austin", "link": "https://stackoverflow.com/users/5856450/nicole-austin"}, "edited": false, "score": 0, "creation_date": 1505304669, "post_id": 46196753, "comment_id": 79356721, "body": "Need function like as:  Function RemoveExtraLines() - - - - - - - End Function"}], "tags": [], "owner": {"reputation": 424, "user_id": 3670056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c680e592b212a40f83d7de1143df0c8?s=128&d=identicon&r=PG&f=1", "display_name": "ashok19r91d", "link": "https://stackoverflow.com/users/3670056/ashok19r91d"}, "is_accepted": false, "score": 0, "last_activity_date": 1505303303, "creation_date": 1505303303, "answer_id": 46196753, "question_id": 46196686, "link": "https://stackoverflow.com/questions/46196686/need-the-visual-basic-function-that-remove-extra-lines/46196753#46196753", "title": "Need the visual basic function that remove extra lines", "body": "<pre><code>Dim s As String\ns = \"That long string...\"\nWhile (s &lt;&gt; s.Replace(VbNewLine + VbNewLine, VbNewLine)\ns = s.Replace(VbNewLine + VbNewLine, VbNewLine);\nLoop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 5856450, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VpV3WR-xGjE/AAAAAAAAAAI/AAAAAAAAABY/DV5tHC4ZdLE/photo.jpg?sz=128", "display_name": "Nicole Austin", "link": "https://stackoverflow.com/users/5856450/nicole-austin"}, "edited": false, "score": 0, "creation_date": 1505307301, "post_id": 46197637, "comment_id": 79358722, "body": "Yes, above function is working properly, but its removing all lines. Only single line should remain if more that two extra lines between two lines. Hope you are understanding. Thanks for your supports!"}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1505305769, "creation_date": 1505305769, "answer_id": 46197637, "question_id": 46196686, "link": "https://stackoverflow.com/questions/46196686/need-the-visual-basic-function-that-remove-extra-lines/46197637#46197637", "title": "Need the visual basic function that remove extra lines", "body": "<p>Not very clear what you're asking.</p>\n\n<pre><code>Public Function RemoveEmptyLines(ByVal Value As String) As String\n    RemoveEmptyLines = Replace(Value, vbLf &amp; vbCr, vbNullString)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5856450, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VpV3WR-xGjE/AAAAAAAAAAI/AAAAAAAAABY/DV5tHC4ZdLE/photo.jpg?sz=128", "display_name": "Nicole Austin", "link": "https://stackoverflow.com/users/5856450/nicole-austin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1505305769, "creation_date": 1505303093, "question_id": 46196686, "link": "https://stackoverflow.com/questions/46196686/need-the-visual-basic-function-that-remove-extra-lines", "title": "Need the visual basic function that remove extra lines", "body": "<p>I need the visual basic function that remove extra lines. As same as the screenshot. \n<a href=\"https://i.stack.imgur.com/bCcLB.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 2, "creation_date": 1505302900, "post_id": 46196583, "comment_id": 79355500, "body": "The average of any range of cells all with value X will be X. What exactly do you want to do?"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505303088, "post_id": 46196583, "comment_id": 79355636, "body": "There is this function <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheetfunction-average-method-excel\" rel=\"nofollow noreferrer\">WorksheetFunction.Average</a> and lots of ways to work with <code>.Find</code>. One is to get the <code>cell.Address</code> or if the value is in another row or column <code>Range.Row</code> and <code>Range.Column</code>, also <code>Offset</code>"}, {"owner": {"reputation": 1, "user_id": 6310444, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/261981d5ce527ee7a2850a3faf929890?s=128&d=identicon&r=PG&f=1", "display_name": "mitsuki", "link": "https://stackoverflow.com/users/6310444/mitsuki"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1505303589, "post_id": 46196583, "comment_id": 79355979, "body": "I want to calculate the average of the column B for the value 1 and 2 in column A @HarassedDad"}, {"owner": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "edited": false, "score": 0, "creation_date": 1505304099, "post_id": 46196583, "comment_id": 79356327, "body": "Are you sure you want to use VBA for this @mitsuki? This is easily done using sumif/countif..."}, {"owner": {"reputation": 1, "user_id": 6310444, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/261981d5ce527ee7a2850a3faf929890?s=128&d=identicon&r=PG&f=1", "display_name": "mitsuki", "link": "https://stackoverflow.com/users/6310444/mitsuki"}, "reply_to_user": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "edited": false, "score": 0, "creation_date": 1505304162, "post_id": 46196583, "comment_id": 79356375, "body": "@a-burge can you show me how ? i am a beginner :s"}, {"owner": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "edited": false, "score": 0, "creation_date": 1505304243, "post_id": 46196583, "comment_id": 79356430, "body": "It&#39;s covered quite well here: <a href=\"http://www.techrepublic.com/blog/windows-and-office/two-ways-to-find-a-conditional-average-in-excel/\" rel=\"nofollow noreferrer\">techrepublic.com/blog/windows-and-office/&hellip;</a> Good luck"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505304583, "post_id": 46196583, "comment_id": 79356671, "body": "There is also <a href=\"https://support.office.com/en-us/article/AVERAGEIFS-function-48910C45-1FC0-4389-A028-F7C5C3001690\" rel=\"nofollow noreferrer\">AVERAGEIFS function</a>"}, {"owner": {"reputation": 1, "user_id": 6310444, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/261981d5ce527ee7a2850a3faf929890?s=128&d=identicon&r=PG&f=1", "display_name": "mitsuki", "link": "https://stackoverflow.com/users/6310444/mitsuki"}, "edited": false, "score": 0, "creation_date": 1505304643, "post_id": 46196583, "comment_id": 79356702, "body": "The problem is that in column A , i have alot of values : 1200 value , that &#39;s how i want to do a macro"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1505306695, "post_id": 46196583, "comment_id": 79358253, "body": "Why not use a pivot table?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6310444, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/261981d5ce527ee7a2850a3faf929890?s=128&d=identicon&r=PG&f=1", "display_name": "mitsuki", "link": "https://stackoverflow.com/users/6310444/mitsuki"}, "edited": false, "score": 0, "creation_date": 1505305531, "post_id": 46197218, "comment_id": 79357355, "body": "But this one is just when you have 2 values in column A . In my case i have 1200 repeated value"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 1, "user_id": 6310444, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/261981d5ce527ee7a2850a3faf929890?s=128&d=identicon&r=PG&f=1", "display_name": "mitsuki", "link": "https://stackoverflow.com/users/6310444/mitsuki"}, "edited": false, "score": 0, "creation_date": 1505305625, "post_id": 46197218, "comment_id": 79357431, "body": "@mitsuki where in your post did you specify anything close to this number ? Anyway, you can have a <code>Dictionary</code> object, store unique values, and pass them to the <b>UDF</b>."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1505304644, "creation_date": 1505304644, "answer_id": 46197218, "question_id": 46196583, "link": "https://stackoverflow.com/questions/46196583/vba-find-a-range-of-same-values-in-a-column-and-calculate-average/46197218#46197218", "title": "VBA find a range of same values in a column and calculate average", "body": "<p>Use <code>WorksheetFunction.AverageIf</code> function, see code below :  </p>\n\n<pre><code>Sub test()\n\nDim sht As Worksheet\nDim LastRow As Long\nDim Rng As Range\nDim Avg1 As Double, Avg2 As Double\n\nSet sht = ThisWorkbook.Worksheets(\"Sheet1\")\nWith sht\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    Set Rng = .Range(\"A1:A\" &amp; LastRow)\n    ' average of values in column B of all cells in column A = 1\n    Avg1 = WorksheetFunction.AverageIf(Rng, \"1\", .Range(\"B1:B\" &amp; LastRow))\n\n    ' average of values in column B of all cells in column A = 2\n    Avg2 = WorksheetFunction.AverageIf(Rng, \"2\", .Range(\"B1:B\" &amp; LastRow))\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6310444, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/261981d5ce527ee7a2850a3faf929890?s=128&d=identicon&r=PG&f=1", "display_name": "mitsuki", "link": "https://stackoverflow.com/users/6310444/mitsuki"}, "edited": false, "score": 0, "creation_date": 1505306234, "post_id": 46197232, "comment_id": 79357886, "body": "And if i have more the 2 values to look for?"}, {"owner": {"reputation": 1, "user_id": 6310444, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/261981d5ce527ee7a2850a3faf929890?s=128&d=identicon&r=PG&f=1", "display_name": "mitsuki", "link": "https://stackoverflow.com/users/6310444/mitsuki"}, "edited": false, "score": 0, "creation_date": 1505316331, "post_id": 46197232, "comment_id": 79365501, "body": "Thank you so much for help ! i just have the last question , if i want to look for the minimum , i changed this : cel.Offset(0, 1) = Application.WorksheetFunction.min(aRng, cel, bRng)  but it didn&#39;t work. how can i do ?"}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 2, "last_activity_date": 1505319176, "last_edit_date": 1505319176, "creation_date": 1505304679, "answer_id": 46197232, "question_id": 46196583, "link": "https://stackoverflow.com/questions/46196583/vba-find-a-range-of-same-values-in-a-column-and-calculate-average/46197232#46197232", "title": "VBA find a range of same values in a column and calculate average", "body": "<h3>Solution 1</h3>\n\n<p>Try this</p>\n\n<pre><code>Sub test()\n    Dim sht As Worksheet\n    Dim inputLR As Long, outputLR As Long\n    Dim cel As Range, aRng As Range, bRng As Range\n\n    Set sht = ThisWorkbook.Worksheets(\"Sheet1\") 'your data sheet\n\n    With sht\n        inputLR = .Cells(.Rows.Count, \"A\").End(xlUp).Row    'last row in column A\n        outputLR = .Cells(.Rows.Count, \"D\").End(xlUp).Row   'last row in column D\n        Set aRng = .Range(.Cells(2, 1), .Cells(inputLR, 1)) 'data range in column A\n        Set bRng = .Range(.Cells(2, 2), .Cells(inputLR, 2)) 'data range in column B\n\n        For Each cel In .Range(.Cells(2, 4), .Cells(outputLR, 4))   'loop through each cell in Column D\n            cel.Offset(0, 1) = Application.WorksheetFunction.AverageIf(aRng, cel, bRng) 'calculate average\n        Next cel\n    End With\nEnd Sub\n</code></pre>\n\n<p>See image for reference.</p>\n\n<p><a href=\"https://i.stack.imgur.com/f5FRN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f5FRN.png\" alt=\"enter image description here\"></a></p>\n\n<h3>Solution 2</h3>\n\n<p>Another easier approach will be to use formula. Enter the following formula in <code>Cell E2</code></p>\n\n<pre><code>=AVERAGEIF($A$2:$A$11,D2,$B$2:$B$11)\n</code></pre>\n\n<p>Drag/Copy down as required. Change range as per your data.</p>\n\n<p>For details on <code>AVERAGEIF</code> see <a href=\"https://support.office.com/en-us/article/AVERAGEIF-function-faec8e2e-0dec-4308-af69-f5576d8ac642\" rel=\"nofollow noreferrer\">this</a>.</p>\n\n<hr>\n\n<p><strong><em>EDIT : 1</em></strong></p>\n\n<pre><code>Sub test()\n    Dim sht As Worksheet\n    Dim inputLR As Long, outputLR As Long\n    Dim cel As Range, aRng As Range, bRng As Range\n    Dim dict As Object, c As Variant, i As Long\n\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    Set sht = ThisWorkbook.Worksheets(\"Sheet1\") 'your data sheet\n\n    With sht\n        inputLR = .Cells(.Rows.Count, \"A\").End(xlUp).Row    'last row in column A\n        Set aRng = .Range(.Cells(2, 1), .Cells(inputLR, 1)) 'data range in column A\n        Set bRng = .Range(.Cells(2, 2), .Cells(inputLR, 2)) 'data range in column B\n\n        c = aRng\n        For i = 1 To UBound(c, 1)\n            dict(c(i, 1)) = 1\n        Next i\n        .Range(\"D2\").Resize(dict.Count) = Application.Transpose(dict.keys)  'display uniques from column A\n        outputLR = .Cells(.Rows.Count, \"D\").End(xlUp).Row   'last row in column D\n\n        For Each cel In .Range(.Cells(2, 4), .Cells(outputLR, 4))   'loop through each cell in Column D\n            cel.Offset(0, 1) = Application.WorksheetFunction.AverageIf(aRng, cel, bRng) 'calculate average\n        Next cel\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong><em>EDIT : 2</em></strong> To get <code>Min</code>, instead of </p>\n\n<pre><code>For Each cel In .Range(.Cells(2, 4), .Cells(outputLR, 4))   'loop through each cell in Column D\n    cel.Offset(0, 1) = Application.WorksheetFunction.AverageIf(aRng, cel, bRng) 'calculate average\nNext cel\n</code></pre>\n\n<p>use</p>\n\n<pre><code>For Each cel In .Range(.Cells(2, 4), .Cells(outputLR, 4))   'loop through each cell in Column D\n    cel.Offset(0, 1).FormulaArray = \"=MIN(IF(\" &amp; aRng.Address &amp; \"=\" &amp; cel.Value &amp; \",\" &amp; bRng.Address &amp; \"))\"\nNext cel\n.Range(.Cells(2, 4), .Cells(outputLR, 4)).Offset(0, 1).Value = .Range(.Cells(2, 4), .Cells(outputLR, 4)).Offset(0, 1).Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1505305025, "creation_date": 1505305025, "answer_id": 46197361, "question_id": 46196583, "link": "https://stackoverflow.com/questions/46196583/vba-find-a-range-of-same-values-in-a-column-and-calculate-average/46197361#46197361", "title": "VBA find a range of same values in a column and calculate average", "body": "<p>This is using a variant array method. Try this.</p>\n\n<pre><code>Sub test()\n    Dim sht As Worksheet\n    Dim LastRow As Long\n    Dim vDB, vR(), rngDB, vResult()\n    Dim r As Integer, n As Long, j As Long, i As Integer\n\n    Set sht = ThisWorkbook.Worksheets(\"Sheet1\")\n    With sht\n        LastRow = .Cells(Rows.Count, \"A\").End(xlUp).Row\n        rngDB = .Range(\"a1\", \"b\" &amp; LastRow)\n        vDB = .Range(\"d2\", .Range(\"d\" &amp; Rows.Count).End(xlUp))\n\n        r = UBound(vDB, 1)\n        ReDim vResult(1 To r)\n        For i = 1 To r\n            n = 0\n            For j = 1 To LastRow\n                If vDB(i, 1) = rngDB(j, 1) Then\n                    n = n + 1\n                    ReDim Preserve vR(1 To n)\n                    vR(n) = rngDB(j, 2)\n                End If\n            Next j\n            vResult(i) = WorksheetFunction.Average(vR)\n        Next i\n        .Range(\"e2\").Resize(r) = WorksheetFunction.Transpose(vResult)\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "is_accepted": false, "score": 0, "last_activity_date": 1505307011, "last_edit_date": 1505307011, "creation_date": 1505306348, "answer_id": 46197830, "question_id": 46196583, "link": "https://stackoverflow.com/questions/46196583/vba-find-a-range-of-same-values-in-a-column-and-calculate-average/46197830#46197830", "title": "VBA find a range of same values in a column and calculate average", "body": "<p>To use the <code>.Find</code> Function</p>\n\n<ol>\n<li>Find the values in column A excluding duplicates</li>\n<li>Use the unique values on the <code>Find</code> Function</li>\n<li>When the value is found, sum the value in column B and on a counter</li>\n<li><p>Divide the sum value by the counter to obtain the average value</p>\n\n<pre><code>Dim ws As Worksheet\nDim rng As Range, rngloop As Range, cellFound As Range, c As Range\n\nSet ws = ThisWorkbook.Sheets(1)\nlastrow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\nSet rng = ws.Range(ws.Cells(2, 1), ws.Cells(lastrow, 1))\n\nFor i = 2 To lastrow\n\n    Set c = ws.Cells(i, 1)\n    Set rngloop = ws.Range(ws.Cells(2, 1), ws.Cells(i, 1))\n\n    x = Application.WorksheetFunction.CountIf(rngloop, c)\n\n    If x = 1 Then\n    'Debug.Print c 'Values in column A without duplicates\n        'Work with the values found\n        With rng\n        Set cellFound = .Find(what:=c, LookIn:=xlValues, MatchCase:=False)\n            If Not cellFound Is Nothing Then\n                FirstAddress = cellFound.Address\n                Do\n                    SumValues = ws.Cells(cellFound.Row, 2) + SumValues\n                    k = k + 1\n                    Set cellFound = .FindNext(cellFound)\n                Loop While Not cellFound Is Nothing And cellFound.Address &lt;&gt; FirstAddress\n                AverageValues = SumValues / k\n                Debug.Print \"Value: \" &amp; c &amp; \" Average: \" &amp; AverageValues\n             End If\n        End With\n    End If\n    k = 0\n    SumValues = 0\nNext i\n</code></pre></li>\n</ol>\n\n<p>Note that the use of <code>.Find</code> is slower than <code>CreateObject(\"Scripting.Dictionary\")</code>, so for large Spreadsheets the code of @Mrig is optimized</p>\n"}, {"tags": [], "owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "is_accepted": false, "score": 0, "last_activity_date": 1505310969, "creation_date": 1505310969, "answer_id": 46199506, "question_id": 46196583, "link": "https://stackoverflow.com/questions/46196583/vba-find-a-range-of-same-values-in-a-column-and-calculate-average/46199506#46199506", "title": "VBA find a range of same values in a column and calculate average", "body": "<p>Please try this code:</p>\n\n<pre><code>Sub test()\n\n    Dim sht As Worksheet\n    Dim LastRow As Long\n    Set sht = ThisWorkbook.Worksheets(\"Sheet1\")\n    LastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 1 To LastRow        \n        If Application.WorksheetFunction.CountIf(sht.Range(\"A1:A\" &amp; LastRow), sht.Range(\"A\" &amp; i)) &gt; 1 Then\n            'if found more than one value\n            'do it another thing\n            sht.Range(\"B\" &amp; i) = Application.WorksheetFunction.SumIf(sht.Range(\"A1:A\" &amp; LastRow), _\n                            sht.Range(\"A\" &amp; i)) / Application.WorksheetFunction.CountIf(sht.Range(\"A1:A\" &amp; LastRow), sht.Range(\"A\" &amp; i))\n        Else\n           'do it another thing\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>Hope this help.</p>\n"}], "owner": {"reputation": 1, "user_id": 6310444, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/261981d5ce527ee7a2850a3faf929890?s=128&d=identicon&r=PG&f=1", "display_name": "mitsuki", "link": "https://stackoverflow.com/users/6310444/mitsuki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3572, "favorite_count": 0, "accepted_answer_id": 46197232, "answer_count": 5, "score": 0, "last_activity_date": 1505319176, "creation_date": 1505302751, "last_edit_date": 1505303092, "question_id": 46196583, "link": "https://stackoverflow.com/questions/46196583/vba-find-a-range-of-same-values-in-a-column-and-calculate-average", "title": "VBA find a range of same values in a column and calculate average", "body": "<p>I want to find a range of same values in <strong>column A</strong> , and then calculate it average , can anyone help me  ? below the code :</p>\n\n<p><a href=\"https://i.stack.imgur.com/bU1hW.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/bU1hW.png</a>    </p>\n\n<pre><code>Sub test()\n    Dim sht As Worksheet\n    Dim LastRow As Long\n    Set sht = ThisWorkbook.Worksheets(\"Sheet1\")\n    LastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n\nFor i = 1 To LastRow\nColumns(\"A:A\").Select\n    Set cell = sELECTION.Find(What:=\"i\", After:=ActiveCell, LookIn:=xlFormulas, _\n        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False)\n\nIf cell Is Nothing Then\n    'do it something\n\nElse\n    'do it another thing\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Thanks !</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1505303719, "post_id": 46196591, "comment_id": 79356077, "body": "Yes. Thank you!"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 1, "last_activity_date": 1505302780, "creation_date": 1505302780, "answer_id": 46196591, "question_id": 46196477, "link": "https://stackoverflow.com/questions/46196477/how-to-pass-reference-to-current-class-to-a-function-within-the-same-class/46196591#46196591", "title": "How to pass reference to current class to a function within the same class", "body": "<p>Within a running instance of a class you can refer to that instance as \"Me\"\n so </p>\n\n<pre><code>Outer(Me)\n</code></pre>\n\n<p>is valid. Is that what you wanted?</p>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 46196591, "answer_count": 1, "score": 0, "last_activity_date": 1505302780, "creation_date": 1505302425, "question_id": 46196477, "link": "https://stackoverflow.com/questions/46196477/how-to-pass-reference-to-current-class-to-a-function-within-the-same-class", "title": "How to pass reference to current class to a function within the same class", "body": "<p>Say if I have a class called <code>State</code> and there is a function <code>Function Outer(stateCopy As State)</code> and there is a function inside <code>State</code> class: <code>Function Inner()</code>. Function <code>Inner()</code> makes use of <code>Outer()</code>, it should pass it the reference on an object of this class, but how could one do that? </p>\n\n<p>In other programming languages there are links to the same class, like <code>this</code> in Java. Is there something like this in Excel vba?</p>\n"}, {"tags": ["javascript", "excel", "electron", "add-in", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2635, "user_id": 3131443, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/cAXBV.png?s=128&g=1", "display_name": "hhsadiq", "link": "https://stackoverflow.com/users/3131443/hhsadiq"}, "edited": false, "score": 0, "creation_date": 1505472629, "post_id": 46198129, "comment_id": 79438852, "body": "So an excel add-in can call rest-based node server and work fine. But is there any way for the add-in to communicate with locally install electron app? Can you provide some reference/article where this issue might be discussed?"}, {"owner": {"reputation": 7447, "user_id": 929187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/F5QPL.png?s=128&g=1", "display_name": "Nikolay", "link": "https://stackoverflow.com/users/929187/nikolay"}, "reply_to_user": {"reputation": 2635, "user_id": 3131443, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/cAXBV.png?s=128&g=1", "display_name": "hhsadiq", "link": "https://stackoverflow.com/users/3131443/hhsadiq"}, "edited": false, "score": 1, "creation_date": 1505476753, "post_id": 46198129, "comment_id": 79441429, "body": "Yes, it can communicate with local app using ipc, sockets, pipes, queues, database, files. You might be looking for &quot;how do I communicate from a node-based app with other local apps&quot;. The mentioned reset-based server is also valid choice (it is a part of &quot;sockets&quot; option) - you can expose a localhost server from your addin (for example -  an HttpListener based), and let the node app communicate with that."}, {"owner": {"reputation": 2635, "user_id": 3131443, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/cAXBV.png?s=128&g=1", "display_name": "hhsadiq", "link": "https://stackoverflow.com/users/3131443/hhsadiq"}, "edited": false, "score": 0, "creation_date": 1505485970, "post_id": 46198129, "comment_id": 79447940, "body": "Awesome. Can you provide some articles/reference where this thing can be found?"}], "tags": [], "owner": {"reputation": 7447, "user_id": 929187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/F5QPL.png?s=128&g=1", "display_name": "Nikolay", "link": "https://stackoverflow.com/users/929187/nikolay"}, "is_accepted": false, "score": 0, "last_activity_date": 1505307104, "creation_date": 1505307104, "answer_id": 46198129, "question_id": 46196448, "link": "https://stackoverflow.com/questions/46196448/communication-between-excel-addin-and-electron-based-desktop-application/46198129#46198129", "title": "Communication between excel addin and electron based desktop application", "body": "<p>Yes, this is possible. The question is however not specific to Excel; so you probably need to check out how to communication between an node based app, and other apps. Some options: ipc, sockets, pipes, queues, database, files. All of them kind of suck. So you better avoid using node.js for building Excel Addins.</p>\n"}], "owner": {"reputation": 2635, "user_id": 3131443, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/cAXBV.png?s=128&g=1", "display_name": "hhsadiq", "link": "https://stackoverflow.com/users/3131443/hhsadiq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 590, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1505307104, "creation_date": 1505302340, "last_edit_date": 1531161705, "question_id": 46196448, "link": "https://stackoverflow.com/questions/46196448/communication-between-excel-addin-and-electron-based-desktop-application", "title": "Communication between excel addin and electron based desktop application", "body": "<p><strong>Overview</strong></p>\n\n<p>Is it possible for an Excel Add-in (or VBA script etc) to communicate with Electron based desktop application? I have found <a href=\"https://stackoverflow.com/questions/9070531/interprocess-communication-between-excel-c-sharp-application\">an answer</a> related to communication between excel and C# application, <a href=\"https://stackoverflow.com/questions/7572466/communication-between-excel-and-silverlight\">another one</a> between Excel and Silverlight, but nothing related to excel and electron app.</p>\n\n<p><strong>Details</strong></p>\n\n<p>Is it possible for Excel add-in to launch Electron application and pass on all the workbook data, and current cell number? And can Eelectron application after performing complex analysis of data return results to Excel so that it can be updated there?</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1505302548, "post_id": 46196186, "comment_id": 79355246, "body": "The final line of code will be <code>ActiveSheet.Cells(1, 1).Value = Txt1 &amp; &quot; &quot; &amp; Txt2</code>. But everything you have before that point is very far from what you need. Start by deciding whether you want to run the code from the Excel worksheet or from the Word document. The google for something like, &quot;How to open a Word document in Excel&quot; (or the other way around. You will find basic code on which you can build."}, {"owner": {"reputation": 31, "user_id": 8527994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50c714464a946d6c0555c36c14029189?s=128&d=identicon&r=PG&f=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/8527994/markus"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1505302728, "post_id": 46196186, "comment_id": 79355386, "body": "No, no, no! I have a word file. I have a word macro. This macro copies the text between a heading and the first table after this heading. My problem is, that the text between these two is multine. My goal: To get this text into one excel cell. My current status. Each line in word, is in one cell in excel...."}, {"owner": {"reputation": 31, "user_id": 8527994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50c714464a946d6c0555c36c14029189?s=128&d=identicon&r=PG&f=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/8527994/markus"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1505302816, "post_id": 46196186, "comment_id": 79355433, "body": "@Variatus if you want I&#39;ll send you the code via message, it&#39;s pretty long..."}], "answers": [{"tags": [], "owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "is_accepted": true, "score": 1, "last_activity_date": 1505307458, "creation_date": 1505307458, "answer_id": 46198260, "question_id": 46196186, "link": "https://stackoverflow.com/questions/46196186/vba-copy-multiline-text-from-word-paste-into-excel-cell/46198260#46198260", "title": "VBA Copy multiline text from Word paste into Excel cell", "body": "<p>Instead of<br />\n<code>...</code><br />\n <code>Selection.Copy</code> <br />\n<code>.Cells(1, 1).PasteSpecial xlPasteValues</code><br />\n<code>...</code><br />\nCode <br />\n<code>.Cells(1, 1).Value=Selection.text</code></p>\n"}], "owner": {"reputation": 31, "user_id": 8527994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50c714464a946d6c0555c36c14029189?s=128&d=identicon&r=PG&f=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/8527994/markus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2021, "favorite_count": 0, "accepted_answer_id": 46198260, "answer_count": 1, "score": 0, "last_activity_date": 1505386938, "creation_date": 1505301669, "last_edit_date": 1505386938, "question_id": 46196186, "link": "https://stackoverflow.com/questions/46196186/vba-copy-multiline-text-from-word-paste-into-excel-cell", "title": "VBA Copy multiline text from Word paste into Excel cell", "body": "<p>My goal is to copy a multiline formatted text from Word to an Excel worksheet into one single cell using a VBA macro.</p>\n\n<p>Now I've got a multiline text which needs two cells.</p>\n\n<p>This is my current code:</p>\n\n<pre><code>With oWB.Worksheets(\"EPICS\")           \n    ' Insert DESCRIPTION - todo\n    '\n    ' HEADING xyz is selected, move one down and go to Pos1\n    Selection.MoveDown Unit:=wdLine, Count:=1\n    Selection.HomeKey Unit:=wdLine\n\n    ' Save current line number (BEGIN)\n    BeginText = Selection.Range.Information(wdFirstCharacterLineNumber)\n\n    ' Go to the first table and one move up\n    Selection.GoTo What:=wdGoToTable, Which:=wdGoToNext, Count:=1, Name:=\"\"\n    Selection.MoveUp Unit:=wdLine, Count:=1\n\n    ' Save current line number (END)\n    EndText = Selection.Range.Information(wdFirstCharacterLineNumber)\n    RangeToSelect = EndText - BeginText\n\n    Selection.MoveUp Unit:=wdLine, Count:=RangeToSelect, Extend:=wdExtend\n    Selection.Copy\n\n    .Cells(1, 1).PasteSpecial xlPasteValues\nEnd With\n</code></pre>\n\n<p>This creates the following:\n<a href=\"https://i.stack.imgur.com/ejdDL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ejdDL.png\" alt=\"enter image description here\"></a></p>\n\n<p>I would like to have the following:\n<a href=\"https://i.stack.imgur.com/R9cbL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R9cbL.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any ideas how I can handle this or any input?</p>\n"}, {"tags": ["vba", "excel", "file"], "comments": [{"owner": {"reputation": 2173, "user_id": 8259647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMyr5.jpg?s=128&g=1", "display_name": "Kresimir L.", "link": "https://stackoverflow.com/users/8259647/kresimir-l"}, "edited": false, "score": 0, "creation_date": 1505301669, "post_id": 46195800, "comment_id": 79354620, "body": "Try using Test12345.xlsb or simply Test12345.xls since they both can store VBA code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8528838"}, "reply_to_user": {"reputation": 2173, "user_id": 8259647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMyr5.jpg?s=128&g=1", "display_name": "Kresimir L.", "link": "https://stackoverflow.com/users/8259647/kresimir-l"}, "edited": false, "score": 0, "creation_date": 1505301893, "post_id": 46195800, "comment_id": 79354776, "body": "@KresimirL. Yeah I tried using those variations.  It tends to give same message."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 2, "creation_date": 1505303365, "post_id": 46195800, "comment_id": 79355828, "body": "This is never going to work. An excel file is a very complicated structure, not a simple text file. You can&#39;t use Open and write on anything except a simple text file. You need to use Workbooks.Add  and activeworkbook.saveas (filename) and go from there"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1505715427, "post_id": 46195800, "comment_id": 79507751, "body": "you have to open it for <code>binary</code> access"}], "owner": {"user_type": "does_not_exist", "display_name": "user8528838"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505307239, "creation_date": 1505300516, "last_edit_date": 1505305892, "question_id": 46195800, "link": "https://stackoverflow.com/questions/46195800/creating-new-excel-workbook-file-returns-invalid-corrupted-error", "title": "Creating new excel workbook file returns invalid/corrupted error", "body": "<p>I am trying to create a new excel workbook with VBA.  Unfortunately it keeps giving me this error message:</p>\n\n<p><a href=\"https://i.stack.imgur.com/OJZEq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OJZEq.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any ideas on how I can create a new workbook.  The code below works perfectly for a CSV file.</p>\n\n<p>I believe the line: <code>Open PathName &amp; \"\\Test12345.xlsm\" For Output Lock Write As #OutputFileNum</code> is causing the issue.  </p>\n\n<pre><code>Sub WriteFile()\n\n  Dim ColNum As Integer\n  Dim Line As String\n  Dim LineValues() As Variant\n  Dim OutputFileNum As Integer\n  Dim PathName As String\n  Dim RowNum As Integer\n  Dim SheetValues() As Variant\n\n  PathName = \"C:\\Wa Guide\\9 Projects\\1 Bet365\\Betting System Output\\Z\"\n  OutputFileNum = FreeFile\n\n  Open PathName &amp; \"\\Test123.xls\" For Output Lock Write As #OutputFileNum\n\n  Print #OutputFileNum, \"Field1\" &amp; \",\" &amp; \"Field2\"\n\n  SheetValues = Sheets(\"Sheet1\").Range(\"A1:H9\").Value\n  ReDim LineValues(1 To 8)\n\n  For RowNum = 1 To 9\n    For ColNum = 1 To 8\n      LineValues(ColNum) = SheetValues(RowNum, ColNum)\n    Next\n    Line = Join(LineValues, \",\")\n    Print #OutputFileNum, Line\n  Next\n\n  Close OutputFileNum\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "adodb", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1536790644, "post_id": 46196961, "comment_id": 91555959, "body": "This is the opposite of all other advice on the topic."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 1, "creation_date": 1537361608, "post_id": 46196961, "comment_id": 91756346, "body": "Parameters make sense if you are creating a public facing solution - but if you are creating an internal solution for selecting with a long (so no text symbols to mess up your sql) why bother doing the work?. Slavishly following &quot;best practice&quot; without understanding why it&#39;s best, just leads to unnecessary work."}, {"owner": {"reputation": 527, "user_id": 3013212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLdfL.jpg?s=128&g=1", "display_name": "Joe B", "link": "https://stackoverflow.com/users/3013212/joe-b"}, "edited": false, "score": 0, "creation_date": 1613879416, "post_id": 46196961, "comment_id": 117211024, "body": "... why bother doing the work?.... Because in today&#39;s world anything you think is not &#39;public facing&#39; can be reached by hackers.  Using Parameters is safer.  Old code, that should never have been &quot;outside&quot; the firewall is exploited by bad actors inside the firewall."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1505303926, "creation_date": 1505303926, "answer_id": 46196961, "question_id": 46195657, "link": "https://stackoverflow.com/questions/46195657/vba-using-adodb-parameter/46196961#46196961", "title": "VBA: Using ADODB Parameter", "body": "<p>Don't use a parameter, build your value into your string</p>\n\n<pre><code> Public Function IndataTest()\n\n\n Dim conn As ADODB.Connection\n Dim ConnString As String\n ConnString = \"Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=True;Data Source=DB;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=B5037093;Use Encryption for Data=False;Tag with column collation when possible=False;Initial Catalog=DB\"\n  Dim sqlstr As String \n  Dim rs As new adodb.recordset\n  Set conn = New ADODB.Connection \n  conn.Open ConnString\n\n  sqlstr = \"use DB \" \n  sqlstr = sqlstr &amp; \"Select * \" &amp; vbCrLf \n  sqlstr = sqlstr &amp; \"From tblA\" &amp; vbCrLf \n  sqlstr = sqlstr &amp; \"where fldA = \"  &amp; 1084924\n  set rs = conn.execute(sqlstr)\n</code></pre>\n\n<p>etc</p>\n"}], "owner": {"reputation": 11, "user_id": 8602670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66791a37e6755787ea8d114e0c0712b4?s=128&d=identicon&r=PG&f=1", "display_name": "JohanB", "link": "https://stackoverflow.com/users/8602670/johanb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 847, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1611720971, "creation_date": 1505300091, "last_edit_date": 1611720971, "question_id": 46195657, "link": "https://stackoverflow.com/questions/46195657/vba-using-adodb-parameter", "title": "VBA: Using ADODB Parameter", "body": "<p>I'm trying to run an parameterized SQL query with ADODB but i get the Error-message &quot;Must declade the scalar variable @Id&quot;.</p>\n<p>I'm a complete noob at VBA and i've tried reading up on how it's done as well as following an example but to no avail.</p>\n<p>Does anyone have an idea of what could be wrong with my code?</p>\n<pre><code>Public Function IndataTest()\n\n\nDim conn As ADODB.Connection\nDim ConnString As String\nConnString = &quot;Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=True;Data Source=DB;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=B5037093;Use Encryption for Data=False;Tag with column collation when possible=False;Initial Catalog=DB&quot;\n\n\n\nDim sqlstr As String Dim rs As Object Dim cmd As Object Dim ParamId As Object Dim Id As String\n\nId = 1084924\n\nsqlstr = sqlstr &amp; &quot;use DB &quot; \nsqlstr = sqlstr &amp; &quot;Select * &quot; &amp; vbCrLf\nsqlstr = sqlstr &amp; &quot;From tblA&quot; &amp; vbCrLf        \nsqlstr = sqlstr &amp; &quot;where fldA = @Id&quot;\n\n\nSet conn = New ADODB.Connection conn.Open ConnString\n\nSet cmd = CreateObject(&quot;ADODB.Command&quot;) cmd.ActiveConnection = conn cmd.CommandText = sqlstr\n\nSet ParamId = cmd.CreateParameter(&quot;@Id&quot;, 129, 1, 52, Id) cmd.Parameters.Append ParamId\n\nSet rs = CreateObject(&quot;ADODB.Recordset&quot;) rs.Open cmd\n\n\nIf Not rs.EOF Then\n    ' Transfer result.\n    Sheets(&quot;Valuta&quot;).Cells(5, 5).CopyFromRecordset rs ' Close the recordset\n    rs.Close Else\n    MsgBox &quot;Error: No records returned.&quot;, vbCritical End If\n\n' Clean up If CBool(conn.State And adStateOpen) Then conn.Close Set conn = Nothing Set rs = Nothing\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8602445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c0c75afbbec939e8921fbd9c9de7c0?s=128&d=identicon&r=PG&f=1", "display_name": "KLang", "link": "https://stackoverflow.com/users/8602445/klang"}, "edited": false, "score": 0, "creation_date": 1505300519, "post_id": 46195360, "comment_id": 79353880, "body": "This works nearly flawless, wow! Thank you! It pastes everything past the first column one row further down though. I fixed this with:       <code>If lnCol &gt; 1 Then Sheets(&quot;Database&quot;).Cells(lnRow, lnCol).Activate Else Sheets(&quot;Database&quot;).Cells(lnRow, lnCol).Offset(1, 0).Activate</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 13, "user_id": 8602445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c0c75afbbec939e8921fbd9c9de7c0?s=128&d=identicon&r=PG&f=1", "display_name": "KLang", "link": "https://stackoverflow.com/users/8602445/klang"}, "edited": false, "score": 0, "creation_date": 1505300617, "post_id": 46195360, "comment_id": 79353936, "body": "@KLang you&#39;re welcome,. now comes your part where you mark this as &quot;ANSWER&quot;, by clicking the gray check-mark on the left side of my answer (it will turn green)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1505299240, "creation_date": 1505299240, "answer_id": 46195360, "question_id": 46194650, "link": "https://stackoverflow.com/questions/46194650/copying-values-from-dynamic-cells-to-specifically-named-columns/46195360#46195360", "title": "Copying values from dynamic cells to specifically named columns", "body": "<p>Try the code below:</p>\n\n<pre><code>Option Explicit\n\nSub Copypasta()\n\nDim CopySht As Worksheet\nDim DBSht As Worksheet\nDim i As Long, lnCol As Long, lnRow As Long\nDim MyActiveCell As Range, FindRng As Range\nDim t1\n\n' set the Worksheet objects\nSet CopySht = ThisWorkbook.Sheets(\"copypasta\")\nSet DBSht = ThisWorkbook.Sheets(\"Database\")\n\n' set the anchor position on the loop\nSet MyActiveCell = CopySht.Range(\"A2\")\n\n' loop through columns at the first row (until you reach a column that is empty)\nWhile CopySht.Cells(1, MyActiveCell.Column) &lt;&gt; \"\"\n    t1 = CopySht.Cells(1, MyActiveCell.Column)\n    MyActiveCell.Copy\n\n    With DBSht\n        lnRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row ' find last row with data in Column \"A\"\n\n        Set FindRng = .Rows(1).Find(What:=t1, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False)\n        If Not FindRng Is Nothing Then ' check if Find was successful\n            lnCol = FindRng.Column\n        Else\n            lnCol = 1\n        End If\n\n         ' there's no need to use Select and Activate to Copy and/or Paste\n        .Cells(lnRow + 1, lnCol).PasteSpecial xlPasteValues\n    End With\n\n    Set MyActiveCell = MyActiveCell.Offset(0, 1) ' loop one column to the right\nWend\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8602445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c0c75afbbec939e8921fbd9c9de7c0?s=128&d=identicon&r=PG&f=1", "display_name": "KLang", "link": "https://stackoverflow.com/users/8602445/klang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 46195360, "answer_count": 1, "score": 1, "last_activity_date": 1505300693, "creation_date": 1505297181, "last_edit_date": 1505300693, "question_id": 46194650, "link": "https://stackoverflow.com/questions/46194650/copying-values-from-dynamic-cells-to-specifically-named-columns", "title": "Copying values from dynamic cells to specifically named columns", "body": "<p>I want to import values from a dynamic worksheet to our \"Database\" sorted by the title of the column. As you can see I have scraped together something that works, but it is very slow and doesn't copy just the values.\nThe first row of the sheet is the titles, the second and further down rows are the values I want to copy.</p>\n\n<pre><code>Sub Copypasta()\n\n    Sheets(\"copypasta\").Select\n    Sheets(\"copypasta\").Range(\"A2\").Activate\n    While Not ActiveSheet.Cells(1, ActiveCell.Column) = \"\"\n        t1 = ActiveSheet.Cells(1, ActiveCell.Column)\n        Selection.Copy\n        Set MyActiveCell = ActiveCell\n        Sheets(\"Database\").Activate\n        lnCol = Sheets(\"Database\").Cells(1, 1).EntireRow.Find(What:=t1, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False).Column\n        lnRow = Sheets(\"Database\").Range(\"a65536\").End(xlUp).Row\n        If lnCol &gt; 1 Then Sheets(\"Database\").Cells(lnRow, lnCol).Activate Else Sheets(\"Database\").Cells(lnRow, lnCol).Offset(1, 0).Activate\n        ActiveSheet.Paste 'xlPasteValues\n        Sheets(\"copypasta\").Activate\n        MyActiveCell.Offset(0, 1).Activate\n    Wend\n\nEnd Sub\n</code></pre>\n\n<p>I tried to use PasteSpecial xlPasteValues or setting the value of the cell directly, but I can't get it to work. I am googling every error it throws and then search the code for where the error occurs. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "edited": false, "score": 0, "creation_date": 1505296754, "post_id": 46194352, "comment_id": 79351148, "body": "instead of &quot;Found=True&quot;, put this code--&gt; &quot;cell.Select"}, {"owner": {"reputation": 3, "user_id": 8411066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f485e4f53655a2cf7925a8bd6da16b4?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot", "link": "https://stackoverflow.com/users/8411066/elliot"}, "reply_to_user": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "edited": false, "score": 0, "creation_date": 1505298145, "post_id": 46194352, "comment_id": 79352210, "body": "Just done that and it is not working :("}, {"owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "edited": false, "score": 0, "creation_date": 1505299034, "post_id": 46194352, "comment_id": 79352824, "body": "before that, put this code as well, coz i missed the point that the cell might be in another sheet--&gt;Sheets(cell.Parent.Name).Select, or in a one-liner--&gt;Application.Goto Sheets(cell.Parent.Name).range(cell.Address)"}, {"owner": {"reputation": 3, "user_id": 8411066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f485e4f53655a2cf7925a8bd6da16b4?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot", "link": "https://stackoverflow.com/users/8411066/elliot"}, "reply_to_user": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "edited": false, "score": 0, "creation_date": 1505300752, "post_id": 46194352, "comment_id": 79354005, "body": "You could add in another sheet at the start and enable hyperlinks to each Number. However, what I need is once the data is found it will filter the sheets."}, {"owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "edited": false, "score": 0, "creation_date": 1505301603, "post_id": 46194352, "comment_id": 79354579, "body": "what do you mean by filtering the sheet? i put the whole code as an answer, can you check that again please"}, {"owner": {"reputation": 3, "user_id": 8411066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f485e4f53655a2cf7925a8bd6da16b4?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot", "link": "https://stackoverflow.com/users/8411066/elliot"}, "reply_to_user": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "edited": false, "score": 0, "creation_date": 1505301770, "post_id": 46194352, "comment_id": 79354691, "body": "Currently It tells me where the data is the code above. I need it to Filter the tables its found."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8411066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f485e4f53655a2cf7925a8bd6da16b4?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot", "link": "https://stackoverflow.com/users/8411066/elliot"}, "edited": false, "score": 0, "creation_date": 1505297072, "post_id": 46194439, "comment_id": 79351400, "body": "The data isn&#39;t displaying it is just telling me directly where the word is located on the Sheets. I just need the search to then filter the information to show the data."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 3, "user_id": 8411066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f485e4f53655a2cf7925a8bd6da16b4?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot", "link": "https://stackoverflow.com/users/8411066/elliot"}, "edited": false, "score": 0, "creation_date": 1505299806, "post_id": 46194439, "comment_id": 79353361, "body": "You replaced your msgbox line with the one I suggested? This should tell you: <code>&quot;The Word XYZ is found in $A$14 on TABNAME sheet. The cell contains: 123XYZab&quot;</code>"}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1505296634, "creation_date": 1505296634, "answer_id": 46194439, "question_id": 46194352, "link": "https://stackoverflow.com/questions/46194352/advanced-searching-and-filtering-on-excel-with-vba/46194439#46194439", "title": "Advanced Searching and Filtering On Excel with VBA", "body": "<p>Currently you report the address with</p>\n\n<pre><code> MsgBox \"The Word \" &amp; strWhat &amp; \" is found in \" &amp; cell.Address(0, 0) &amp; \" on \" &amp; ws.Name &amp; \" sheet.\"\n</code></pre>\n\n<p>If you want to add the value stored in the cell, just add something to report the value:</p>\n\n<pre><code>MsgBox \"The Word \" &amp; strWhat &amp; \" is found in \" &amp; cell.Address(0, 0) &amp; \" on \" &amp; ws.Name &amp; \" sheet. The cell contains:\" &amp; Cell.Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8411066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f485e4f53655a2cf7925a8bd6da16b4?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot", "link": "https://stackoverflow.com/users/8411066/elliot"}, "edited": false, "score": 0, "creation_date": 1505303219, "post_id": 46196185, "comment_id": 79355721, "body": "This actually works. However, there needs to be a delay in between to allow yourself to stay on these pages. We&#39;re getting closer. We could filter out the data if that is possible"}, {"owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "reply_to_user": {"reputation": 3, "user_id": 8411066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f485e4f53655a2cf7925a8bd6da16b4?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot", "link": "https://stackoverflow.com/users/8411066/elliot"}, "edited": false, "score": 0, "creation_date": 1505306490, "post_id": 46196185, "comment_id": 79358079, "body": "why delay?can you be more precise about your request?"}, {"owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "reply_to_user": {"reputation": 3, "user_id": 8411066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f485e4f53655a2cf7925a8bd6da16b4?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot", "link": "https://stackoverflow.com/users/8411066/elliot"}, "edited": false, "score": 0, "creation_date": 1505306754, "post_id": 46196185, "comment_id": 79358302, "body": "how about this: after my added code, add this one too. ActiveCell.CurrentRegion.AutoFilter Field:=activecell.column, Criteria1:=activecell.value"}, {"owner": {"reputation": 3, "user_id": 8411066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f485e4f53655a2cf7925a8bd6da16b4?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot", "link": "https://stackoverflow.com/users/8411066/elliot"}, "edited": false, "score": 0, "creation_date": 1505307619, "post_id": 46196185, "comment_id": 79358958, "body": "Hi, Once the object is found. It then goes ahead and find the next object automatically. For example; if there are two results called &quot;AMAR02&quot; the first result will be displayed on table 1 and then it will go to the next table where it finds &quot;AMAR02&quot;. I was wondering if adding some sort of delay or word to go to the next result? Instead of automatically changing."}, {"owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "reply_to_user": {"reputation": 3, "user_id": 8411066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f485e4f53655a2cf7925a8bd6da16b4?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot", "link": "https://stackoverflow.com/users/8411066/elliot"}, "edited": false, "score": 0, "creation_date": 1505308172, "post_id": 46196185, "comment_id": 79359406, "body": "ah i see now. why don&#39;t you use Find tool of Excel. Click options, and then select &quot;Workbook&quot; in Within option, and finally click Find All? is there a special need for VBA?"}, {"owner": {"reputation": 3, "user_id": 8411066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f485e4f53655a2cf7925a8bd6da16b4?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot", "link": "https://stackoverflow.com/users/8411066/elliot"}, "edited": false, "score": 0, "creation_date": 1505309233, "post_id": 46196185, "comment_id": 79360225, "body": "Reason for this because, the data needs to be filtered out by table. Here is an example; &quot;AMAR02&quot; table  &quot;AMAR01&quot; table  &quot;AMAR03&quot; table  &quot;AMAR06&quot; table  Have the word bedfordshire in.  Now &quot;AMAR09&quot; table  &quot;AMAR04&quot; table  &quot;AMAR02&quot; table  &quot;AMAR07&quot; table  have the name Midlands in. So what this code needs to do is filter the tables out. Hope this makes sense now"}], "tags": [], "owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "is_accepted": true, "score": 0, "last_activity_date": 1505309236, "last_edit_date": 1505309236, "creation_date": 1505301667, "answer_id": 46196185, "question_id": 46194352, "link": "https://stackoverflow.com/questions/46194352/advanced-searching-and-filtering-on-excel-with-vba/46196185#46196185", "title": "Advanced Searching and Filtering On Excel with VBA", "body": "<p>as continuation of my comment </p>\n\n<pre><code>    Sub SearchWordInEntireWorkbook()\n    Dim ws As Worksheet\n    Dim strWhat As String\n    Dim cell As Range\n    Dim Found As Boolean\n    strWhat = Application.InputBox(\"What word do you want to search in this workbook?\", \"Search Word!\", Type:=2)\n    If strWhat = \"\" Then\n       MsgBox \"No search word entered.\", vbExclamation, \"Search Cancelled!\"\n       Exit Sub\n    End If\n\n    For Each ws In Worksheets\n       With ws.Cells\n          Set cell = .Find(what:=strWhat, lookat:=xlPart, MatchCase:=False)\n          If Not cell Is Nothing Then\n             Found = True\n             'MsgBox \"The Word \" &amp; strWhat &amp; \" is found in \" &amp; cell.Address(0, 0) &amp; \" on \" &amp; ws.Name &amp; \" sheet.\"\n             Application.Goto Sheets(cell.Parent.Name).range(cell.Address)\n'edit starts\n         ans = MsgBox(\"is this the one you r looking for. if so, say yes and quit, else say no and go to the next result\", vbYesNo)\n         If ans = vbYes Then\n            Exit For\n         End If\n'edit ends\n          End If\n       End With\n    Next ws\n    If Not Found Then\n       MsgBox \"The word \" &amp; strWhat &amp; \" is not found on any sheet in this workbook.\", vbExclamation, \"Word Not Found!\"\n    End If\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8411066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f485e4f53655a2cf7925a8bd6da16b4?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot", "link": "https://stackoverflow.com/users/8411066/elliot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 46196185, "answer_count": 2, "score": 0, "last_activity_date": 1505309236, "creation_date": 1505296391, "question_id": 46194352, "link": "https://stackoverflow.com/questions/46194352/advanced-searching-and-filtering-on-excel-with-vba", "title": "Advanced Searching and Filtering On Excel with VBA", "body": "<p>I have managed to make a code which searches through out all tabs within a Excel database using visual basic. However, the search only will tell me where the information is located and will not display the information. </p>\n\n<p>The following code is below: </p>\n\n<pre><code>Sub SearchWordInEntireWorkbook()\nDim ws As Worksheet\nDim strWhat As String\nDim cell As Range\nDim Found As Boolean\nstrWhat = Application.InputBox(\"What word do you want to search in this workbook?\", \"Search Word!\", Type:=2)\nIf strWhat = \"\" Then\n   MsgBox \"No search word entered.\", vbExclamation, \"Search Cancelled!\"\n   Exit Sub\nEnd If\n\nFor Each ws In Worksheets\n   With ws.Cells\n      Set cell = .Find(what:=strWhat, lookat:=xlPart, MatchCase:=False)\n      If Not cell Is Nothing Then\n         Found = True\n         MsgBox \"The Word \" &amp; strWhat &amp; \" is found in \" &amp; cell.Address(0, 0) &amp; \" on \" &amp; ws.Name &amp; \" sheet.\"\n      End If\n   End With\nNext ws\nIf Not Found Then\n   MsgBox \"The word \" &amp; strWhat &amp; \" is not found on any sheet in this workbook.\", vbExclamation, \"Word Not Found!\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>What I need is the data to be displayed when you run the search instead of telling me where the data is located.</p>\n\n<p>Please can anyone help me out with this? If you need any additional information let me know. \nI understand that there </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 8338776, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d7fde738b6c47ed4baf9e723747cd097?s=128&d=identicon&r=PG&f=1", "display_name": "spyr0", "link": "https://stackoverflow.com/users/8338776/spyr0"}, "edited": false, "score": 0, "creation_date": 1505299135, "post_id": 46195119, "comment_id": 79352899, "body": "Thanks for your response. Trying it now. However I&#39;m going to try to implement &quot;Test Table&quot; as the table I want to lookup the value"}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 2, "last_activity_date": 1505299166, "last_edit_date": 1592644375, "creation_date": 1505298568, "answer_id": 46195119, "question_id": 46194227, "link": "https://stackoverflow.com/questions/46194227/updated-further-downvba-replace-column-of-cells-and-their-adjacent-cells-with/46195119#46195119", "title": "*Updated further down*VBA: Replace column of cells and their adjacent cells with VLookup values", "body": "<p>Assuming sheet <code>Data</code> is as follows</p>\n<p><a href=\"https://i.stack.imgur.com/TXXiX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TXXiX.png\" alt=\"enter image description here\" /></a></p>\n<p>and sheet <code>Test Table</code> is</p>\n<p><a href=\"https://i.stack.imgur.com/fxtOX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fxtOX.png\" alt=\"enter image description here\" /></a></p>\n<p>Following might help</p>\n<pre><code>Sub Worksheet_Name_Change()\n    Dim dataWS As Worksheet, testWS As Worksheet\n    Dim srcRng As Range, cel As Range\n     \n    Set dataWS = ThisWorkbook.Sheets(&quot;Data&quot;)\n    Set testWS = ThisWorkbook.Sheets(&quot;Test Table&quot;)\n    \n    With dataWS\n        Set srcRng = .Range(.Cells(1, 1), .Cells(.Cells(.Rows.Count, &quot;A&quot;).End(xlUp).Row, 1))    'set range in column A\n    End With\n    \n    For Each cel In srcRng    'loop through each cell in Column A\n        If cel.Value = testWS.Range(&quot;A2&quot;).Value Then    'check is value is to be replaced\n            cel.Value = testWS.Range(&quot;B2&quot;).Value    'replace the value\n            cel.Offset(0, 1).Value = &quot;Goes here&quot;    'replace adjacent value\n        End If\n    Next cel\nEnd Sub\n</code></pre>\n<p>I am assuming you want to display <code>Goes here</code> beside the replaced value.</p>\n<p>Output will be</p>\n<p><a href=\"https://i.stack.imgur.com/3Iktb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3Iktb.png\" alt=\"enter image description here\" /></a></p>\n"}], "owner": {"reputation": 159, "user_id": 8338776, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d7fde738b6c47ed4baf9e723747cd097?s=128&d=identicon&r=PG&f=1", "display_name": "spyr0", "link": "https://stackoverflow.com/users/8338776/spyr0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 46195119, "answer_count": 1, "score": 0, "last_activity_date": 1505300865, "creation_date": 1505296071, "last_edit_date": 1505300865, "question_id": 46194227, "link": "https://stackoverflow.com/questions/46194227/updated-further-downvba-replace-column-of-cells-and-their-adjacent-cells-with", "title": "*Updated further down*VBA: Replace column of cells and their adjacent cells with VLookup values", "body": "<p>So below is my current code:</p>\n\n<pre><code>Sub Worksheet_Name_Change()\n\nDim ws As Worksheet\nDim FindWhat As String, ReplaceWith As String\nDim dataCells As Range\nDim regEx As New RegExp\nDim strPattern As String: strPattern = \"^[0-9]+[-A-Z]*[-0-9]+$\"\n\nWith regEx\n    .Global = True\n    .MultiLine = True\n    .IgnoreCase = False\n    .Pattern = strPattern\nEnd With\n\nFindWhat = Worksheets(\"Add\").Range(\"B4\")\nIf FindWhat = \"False\" Then Exit Sub  ' Replacing this with regex matching later\n\nReplaceWith = Worksheets(\"Add\").Range(\"D4\")\nIf ReplaceWith = \"False\" Then Exit Sub  ' Replacing this with regex matching later\n\nOn Error Resume Next\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Name = Worksheets(\"Add\").Name Then Exit For\n    ws.Cells.Replace What:=FindWhat, Replacement:=ReplaceWith, LookAt:= _\n    xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nNext ws\nOn Error GoTo 0\n\nMsgBox \"Done!\", vbInformation, \"Update\"\n\nEnd Sub\n\nSub VLTEST()\nWorksheets(\"Add\").Range(\"B6\") = Application.WorksheetFunction.VLookup(\"Tom\", Worksheets(\"Test Table\").Range(\"C4:D7\"), 2, True)\nEnd Sub\n</code></pre>\n\n<p>What I am looking to do is when I replace a value in a sheet I also replace the cell to it's right with a VLookup in another table.</p>\n\n<p>SO the sheet(called \"Data\") where I want to replace values is like this:</p>\n\n<pre><code>  A        B\n-------------------\nTimmy   Is cool \nAndy    Is ok   \nPaul    Is enemy No.1   \nTimmy   Is cool \nAndy    Is ok   \nPaul    Is enemy No.1   \nTimmy   Is cool \nAndy    Is ok   \nPaul    Is enemy No.1   \nTimmy   Is cool \nAndy    Is ok   \nPaul    Is enemy No.1   \n</code></pre>\n\n<p>And my second sheet(called \"Test Table\") has the following table</p>\n\n<pre><code>Name    Att.\n-------------------\nTimmy   Is cool\nAndy    Is ok\nPaul    Is enemy No.1 \nGreg    Goes here\n</code></pre>\n\n<p>And my other sheet(called \"Add\") has a form that looks like this:</p>\n\n<pre><code>Old Code        New Code\n------------------------\nTimmy           Greg         BUTTON\n</code></pre>\n\n<p>When user presses the button it replaces the value \"Timmy\" with \"Greg\" in the first sheet giving you:</p>\n\n<pre><code>  A        B\n-------------------\nGreg    Is cool\nAndy    Is ok\nPaul    Is enemy No.1 \nGreg    Is cool\nAndy    Is ok\nPaul    Is enemy No.1 \nGreg    Is cool\nAndy    Is ok\nPaul    Is enemy No.1 \nGreg    Is cool\nAndy    Is ok\nPaul    Is enemy No.1 \n</code></pre>\n\n<p>But what I would like to do is figure out how to reference the adjacent cell to those being replaced and implement my VLTest function to basically VLookup \"Greg\"s Att. in the table on the \"Test Table\" sheet and end up with:</p>\n\n<pre><code>  A        B\n-------------------\nGreg    Goes here\nAndy    Is ok\nPaul    Is enemy No.1 \nGreg    Goes here\nAndy    Is ok\nPaul    Is enemy No.1\nGreg    Goes here\nAndy    Is ok\nPaul    Is enemy No.1\nGreg    Goes here\nAndy    Is ok\nPaul    Is enemy No.1\n</code></pre>\n\n<p>I feel like I'm not getting anywhere with this. Can anyone help?</p>\n\n<blockquote>\n  <p>Update: Mrigs answer works</p>\n</blockquote>\n\n<p>Mrigs answer works for me and I'm glad to have it, but I have only one more problem now </p>\n\n<p>With Test Table as:</p>\n\n<p><a href=\"https://i.stack.imgur.com/OB5GT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OB5GT.png\" alt=\"enter image description here\"></a></p>\n\n<p>I've changed:</p>\n\n<pre><code>cel.Offset(0, 1).Value = \"Goes Here\"    'replace adjacent value\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>cel.Offset(0, 1).Value = Application.WorksheetFunction.VLookup(testWS.Range(\"B1\").Value, Worksheets(\"Test Table\").Range(\"A1:B5\"), 2, True)    'replace adjacent value\n</code></pre>\n\n<p>But it doesn't seem to look up the correct value</p>\n\n<p>e.g</p>\n\n<pre><code>Application.WorksheetFunction.VLookup(\"Timmy\", Worksheets(\"Test Table\").Range(\"A1:B5\"), 2, True)\n</code></pre>\n\n<p>Returns: \"Goes here\" -- should be \"is cool\"</p>\n\n<pre><code>Application.WorksheetFunction.VLookup(\"Greg\", Worksheets(\"Test Table\").Range(\"A1:B5\"), 2, True)\n</code></pre>\n\n<p>Returns: \"is hot\" -- should be \"Goes here\"</p>\n\n<pre><code>Application.WorksheetFunction.VLookup(\"Phil\", Worksheets(\"Test Table\").Range(\"A1:B5\"), 2, True)\n</code></pre>\n\n<p>Returns: \"is yes no\" -- correct</p>\n\n<pre><code>Application.WorksheetFunction.VLookup(\"Andy\", Worksheets(\"Test Table\").Range(\"A1:B5\"), 2, True)\n</code></pre>\n\n<p>Returns: \"is hot\" --correct</p>\n\n<p>Why are the first and last rows returning the wrong ones?</p>\n"}, {"tags": ["excel", "powershell", "vba"], "comments": [{"owner": {"reputation": 160, "user_id": 3544460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Yv96.png?s=128&g=1", "display_name": "Ali.Asadi", "link": "https://stackoverflow.com/users/3544460/ali-asadi"}, "edited": false, "score": 0, "creation_date": 1505304735, "post_id": 46193372, "comment_id": 79356773, "body": "VBA does not expose VBProject passwords in its object model."}, {"owner": {"reputation": 55, "user_id": 861046, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a1abd1c1a74830747d38c06770bb0ae7?s=128&d=identicon&r=PG", "display_name": "Henno van Rensburg", "link": "https://stackoverflow.com/users/861046/henno-van-rensburg"}, "reply_to_user": {"reputation": 160, "user_id": 3544460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Yv96.png?s=128&g=1", "display_name": "Ali.Asadi", "link": "https://stackoverflow.com/users/3544460/ali-asadi"}, "edited": false, "score": 0, "creation_date": 1505348094, "post_id": 46193372, "comment_id": 79380535, "body": "The way to access the VBProject is to open the workbook, e.g. $xl = New-Object -ComObject Excel.Application, followed by $xl.Workbooks.Open($filePath), and then $workbook.VBProject"}], "owner": {"reputation": 55, "user_id": 861046, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a1abd1c1a74830747d38c06770bb0ae7?s=128&d=identicon&r=PG", "display_name": "Henno van Rensburg", "link": "https://stackoverflow.com/users/861046/henno-van-rensburg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505293787, "creation_date": 1505293787, "last_edit_date": 1531161705, "question_id": 46193372, "link": "https://stackoverflow.com/questions/46193372/unprotecting-vba-in-xls-2010-via-powershell", "title": "Unprotecting VBA in XLS 2010 via Powershell", "body": "<p>I'm working on a solution that will inject VBA modules into an XLS document by using powershell. By using the ComObject Excel.Application I'm able to open a workbook, access the CodeModule, and call AddFromString. </p>\n\n<p>This is all good until I encounter an XLS document that is password protected. Not the sheet itself but the VBAProject. I've tried various approaches, opening the sheet by specifying the password --> $xl.Workbooks.Open($filePath, 1, $false, 5, \"123\", \"123\"),  and also calling $workbook.Unprotect(\"123\").</p>\n\n<p>Both of these dont seem to have any impact, and I'm not able to access the workbook component, $workbook.VBProject.VBComponents, like Im able to do for the non-protected documents. </p>\n\n<p>Assume in all instances I know the password in advance. </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "edited": false, "score": 0, "creation_date": 1505294572, "post_id": 46193339, "comment_id": 79349526, "body": "I would suggest open with command-line options in a shell script or search for &quot;access frontend updater&quot; to see how they do this ( I think one is called mdbloader)."}, {"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "edited": false, "score": 0, "creation_date": 1505295230, "post_id": 46193339, "comment_id": 79350012, "body": "Or try `acc.Application.Quit&#39;."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1505295866, "post_id": 46193339, "comment_id": 79350493, "body": "Note that access databases can be decompiled, so the string can be read (through some effort). As said in my previous comment, I have a database lying around that stores an encrypted db password with a user password, so only users that have a valid password can log in."}, {"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1505296695, "post_id": 46193339, "comment_id": 79351097, "body": "@ErikvonAsmuth: And the password is stored under the keyboard;-). Maybe better to check windows login to see if user can login?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "edited": false, "score": 0, "creation_date": 1505304827, "post_id": 46193339, "comment_id": 79356831, "body": "@BitAccesser that&#39;s pseudosecurity. You have to assume a hacker can read all unencrypted parts of your database. You can modify my implementation (found <a href=\"https://stackoverflow.com/questions/46179795/prevent-enabling-of-shift-bypass-access-2010\">here</a>) to check that also and use the Windows username by default, but that doesn&#39;t really strengthen it. Of course, proper password management is everything, but the Windows password might be taped under the keyboard also."}, {"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1505322144, "post_id": 46193339, "comment_id": 79369217, "body": "@ErikvonAsmuth Pwd&#39;s are just as save as the users care about, but many don&#39;t care and your whole protection measures are undermined. I thought there are secure ways to get windows auth by active directory (&#200;nviron(&quot;username&quot;)`is not). and authentice with a token or biometrics additionally. What do you think about a terminal server? Wouldn&#39;t that be the best option?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "edited": false, "score": 0, "creation_date": 1505322429, "post_id": 46193339, "comment_id": 79369373, "body": "@BitAccesser The entire problem is that users can edit your database. Users can open a database using the shift click or by disabling VBA, open the navigation pane, and mess around with it. Users can use VBA from a second database to export tables without opening your database or running any code in it. You can&#39;t work around this (short of some sort of remoteapp service where users actually aren&#39;t able to create files or move the database). The only two real modes of security are denying access to the file, and encryption."}, {"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1505323195, "post_id": 46193339, "comment_id": 79369787, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/154372/discussion-between-bitaccesser-and-erik-von-asmuth\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 604, "user_id": 3683930, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DPmwN.png?s=128&g=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/3683930/leroy"}, "edited": false, "score": 0, "creation_date": 1505296105, "post_id": 46193954, "comment_id": 79350658, "body": "Thank you. I hadn&#39;t heard of the UserControl method before. I had been stuck on this for ages. I am trying to avoid having to provide every user with a password which is why I couldn&#39;t go with your other method. Thanks again for your help"}, {"owner": {"reputation": 604, "user_id": 3683930, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DPmwN.png?s=128&g=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/3683930/leroy"}, "edited": false, "score": 1, "creation_date": 1505296559, "post_id": 46193954, "comment_id": 79350999, "body": "Incidentally, if you would like to add this as an answer to my first question, I&#39;d be happy to accept that also. If not, I&#39;ll just add it myself so the question isn&#39;t left open. Just thought you deserved the credit"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 4, "last_activity_date": 1506713932, "last_edit_date": 1506713932, "creation_date": 1505295381, "answer_id": 46193954, "question_id": 46193339, "link": "https://stackoverflow.com/questions/46193339/access-vba-launch-password-protected-database-and-close-existing-one/46193954#46193954", "title": "Access VBA - Launch password protected database and close existing one", "body": "<p>You can use the following:</p>\n\n<pre><code>Private Sub Form_Load()\n Dim acc As Access.Application\n Dim db As DAO.Database\n Dim strDbName As String\n\n strDbName = \"C:\\database Folder\\secureDB.accdb\"\n Set acc = New Access.Application\n acc.Visible = True\n acc.OpenCurrentDatabase strDbName, False, \"swordfish\"\n Set db = acc.CurrentDb() 'Don't know why you want a reference to the db\n acc.UserControl = True\n Application.Quit\nEnd Sub\n</code></pre>\n\n<p>The relevant part is <code>acc.UserControl = True</code>, that forces the DB to stay visible and stops it from closing as soon as the reference to the Application object gets destroyed.</p>\n\n<p>A sample database that stores the main database password encrypted with a salted user password can be found in <a href=\"https://stackoverflow.com/questions/46196870\">this answer</a></p>\n"}], "owner": {"reputation": 604, "user_id": 3683930, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DPmwN.png?s=128&g=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/3683930/leroy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5670, "favorite_count": 1, "accepted_answer_id": 46193954, "answer_count": 1, "score": 1, "last_activity_date": 1506713932, "creation_date": 1505293665, "last_edit_date": 1505385348, "question_id": 46193339, "link": "https://stackoverflow.com/questions/46193339/access-vba-launch-password-protected-database-and-close-existing-one", "title": "Access VBA - Launch password protected database and close existing one", "body": "<p>I am trying to set up a \"Launcher\" database which contains vba code that will open a second database which is password protected. (I can then convert the launcher db to accde so the VBA containing the password cannot be read)</p>\n\n<p>I have the following code so far...</p>\n\n<pre><code>Private Sub Form_Load()\n Dim acc As Access.Application\n Dim db As DAO.Database\n Dim strDbName As String\n\n strDbName = \"C:\\database Folder\\secureDB.accdb\"\n Set acc = New Access.Application\n acc.Visible = True\n Set db = acc.DBEngine.OpenDatabase(strDbName, False, False, \";PWD=swordfish\")\n\n acc.OpenCurrentDatabase (strDbName)\n\n Application.Quit\n\nEnd Sub\n</code></pre>\n\n<p>When the launcher db is opened a form loads which subsequently fires the above code. It works but the problem is the last line which is intended to close the launcher db only but actually closes both databases. I have also tried opening the main database using shell but am unable to pass the password this way.</p>\n\n<p>Does anyone know how I can just close the first database while keeping the second one open?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1505300185, "post_id": 46195569, "comment_id": 79353645, "body": "after you set <code>PTable</code> why not use it below when you modify the <code>PivotFields</code> ? why not use <code>With PTable</code>, and nest the other objects inside ?"}, {"owner": {"reputation": 158, "user_id": 2794327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36471432ab0c7779ea037601058ab197?s=128&d=identicon&r=PG&f=1", "display_name": "Arjeel", "link": "https://stackoverflow.com/users/2794327/arjeel"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1505306702, "post_id": 46195569, "comment_id": 79358260, "body": "Agreed, its not a beautifully written piece of code( Which all of us love to see). It&#39;s just that I had this piece of code to be shared with our team members so to make it easy to do further modifications I kept it that way."}], "tags": [], "owner": {"reputation": 158, "user_id": 2794327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36471432ab0c7779ea037601058ab197?s=128&d=identicon&r=PG&f=1", "display_name": "Arjeel", "link": "https://stackoverflow.com/users/2794327/arjeel"}, "is_accepted": true, "score": 0, "last_activity_date": 1505299831, "creation_date": 1505299831, "answer_id": 46195569, "question_id": 46193124, "link": "https://stackoverflow.com/questions/46193124/unable-to-create-pivot-ina-new-worksheet-in-vba/46195569#46195569", "title": "Unable to create pivot ina new worksheet in VBA", "body": "<p>The problem is because of sheet name and not deleting those sheets. I think the below code could be of your help</p>\n\n<pre><code>Sub Macro1()\n'\nDim PSheet As Worksheet\nDim DSheet As Worksheet\nDim PCache As PivotCache\nDim PTable As PivotTable\nDim PRange As Range\nDim LastRow As Long\nDim LastCol As Long\n\n'Delete Preivous Pivot Table Worksheet &amp; Insert a New Blank Worksheet With Same Name\nOn Error Resume Next\nApplication.DisplayAlerts = False\nWorksheets(\"PivotTable\").Delete\nSheets.Add Before:=ActiveSheet\nActiveSheet.Name = \"PivotTable\"\nApplication.DisplayAlerts = True\nSet PSheet = Worksheets(\"PivotTable\")\nSet DSheet = Worksheets(\"Raw Data\")\n\n'Define Data Range\nLastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\nLastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\nSet PRange = DSheet.Cells(1, 1).Resize(LastRow, LastCol)\n\n'Define Pivot Cache\nSet PCache = ActiveWorkbook.PivotCaches.Create _\n(SourceType:=xlDatabase, SourceData:=PRange). _\nCreatePivotTable(TableDestination:=PSheet.Cells(2, 2), _\nTableName:=\"PRIMEPivotTable\")\n\n'Insert Blank Pivot Table\nSet PTable = PCache.CreatePivotTable_(TableDestination:=PSheet.Cells(1, 1), TableName:=\"PRIMEPivotTable\")\n\n'Insert Column Fields\n'With ActiveSheet.PivotTables(\"PRIMEPivotTable\").PivotFields(\"ColumnName\")\n '.Orientation = xlColumnField\n '.Position = 1\n'End With\n\n'Insert Row Fields\nWith ActiveSheet.PivotTables(\"PRIMEPivotTable\").PivotFields(\"RowName\")\n .Orientation = xlRowField\n .Position = 1\nEnd With\n\n'Insert Data Field\nWith ActiveSheet.PivotTables(\"PRIMEPivotTable\").PivotFields(\"Field 1\")\n .Orientation = xlDataField\n .Position = 1\n .Function = xlCount\n .Name = \"Name of your choice\"\nEnd With\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1505300127, "creation_date": 1505300127, "answer_id": 46195666, "question_id": 46193124, "link": "https://stackoverflow.com/questions/46193124/unable-to-create-pivot-ina-new-worksheet-in-vba/46195666#46195666", "title": "Unable to create pivot ina new worksheet in VBA", "body": "<p>Try the code below, explanations inside the code's comments:</p>\n\n<pre><code>Option Explicit\n\nSub VBAPivot()\n\nDim Sht1 As Worksheet\nDim NewSht As Worksheet\nDim PvtCache As PivotCache\nDim PvtTbl As PivotTable\n\nDim PvtRange As Range\nDim LastRow As Long\n\nSet NewSht = ThisWorkbook.Sheets.Add ' add new sheet\n\nSet Sht1 = ThisWorkbook.Worksheets(\"Sheet1\")\nWith Sht1\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n    ' set the PivotCach DataSource Range\n    Set PvtRange = .Range(\"A1:X\" &amp; LastRow)\nEnd With\n\n' Set the Pivot Cache\nSet PvtCache = ActiveWorkbook.PivotCaches.Create(xlDatabase, PvtRange.Address(False, False, xlA1, xlExternal))\n\n' create a new Pivot Table in the new added sheet, in \"A3\"\nSet PvtTbl = NewSht.PivotTables.Add(PivotCache:=PvtCache, TableDestination:=NewSht.Range(\"A3\"), TableName:=\"PivotTable1\")\n\nWith PvtTbl ' modify Pivot-Table properties\n\n    With .PivotFields(\"Bnlunit\")\n        .Orientation = xlPageField\n        .Position = 1\n    End With\n    With .PivotFields(\"Period\")\n        .Orientation = xlColumnField\n        .Position = 1\n    End With\n\n    ' add Field as Sum of\n    .AddDataField .PivotFields(\"Amount\"), \"Sum of Amount\", xlSum\n\n    With .PivotFields(\"Hdaccount_agr_3(T)\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 8383886, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f339abbddc9bd907e7651825afdf6a48?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/8383886/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "accepted_answer_id": 46195569, "answer_count": 2, "score": 0, "last_activity_date": 1505300263, "creation_date": 1505293055, "last_edit_date": 1531164843, "question_id": 46193124, "link": "https://stackoverflow.com/questions/46193124/unable-to-create-pivot-ina-new-worksheet-in-vba", "title": "Unable to create pivot ina new worksheet in VBA", "body": "<p>I recorded a macro in which I want to create a pivot table into a new worksheet. I am using 2010 version. </p>\n\n<p>I have the \"Run time error 5\" Invalid procedure call or argument\" error when I want to run a macro. Please see the code. It creates the new sheet so is it not fine?</p>\n\n<pre><code>Range(\"A1\").Select\nSheets.Add\nActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n\"Sheet1!R1C1:R17445C24\", Version:=xlPivotTableVersion12).CreatePivotTable _\nTableDestination:=\"Sheet4!R3C1\", TableName:=\"PivotTable1\", DefaultVersion _\n:=xlPivotTableVersion12\n\nSheets(\"Sheet4\").Select\nCells(3, 1).Select\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Bnlunit\")\n    .Orientation = xlPageField\n    .Position = 1\nEnd With\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Period\")\n    .Orientation = xlColumnField\n    .Position = 1\nEnd With\nActiveWindow.SmallScroll Down:=12\nActiveSheet.PivotTables(\"PivotTable1\").AddDataField ActiveSheet.PivotTables( _\n\"PivotTable1\").PivotFields(\"Amount\"), \"Sum of Amount\", xlSum\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Hdaccount_agr_3(T)\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nActiveWindow.SmallScroll Down:=-33\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "listbox", "match"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1505293514, "post_id": 46193087, "comment_id": 79348694, "body": "Whats not working/what are the errors?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "edited": false, "score": 0, "creation_date": 1505294533, "post_id": 46193365, "comment_id": 79349495, "body": "thank you for your help, please see updated picture, but i can see that this is exactly what I need to be done!"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1505294568, "post_id": 46193365, "comment_id": 79349522, "body": "You can skip the last loop, by just saying <code>listbox3.list=obj.keys()</code>"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "edited": false, "score": 0, "creation_date": 1505295598, "post_id": 46193365, "comment_id": 79350295, "body": "@Ashley Davies Indeed, we filled the dictionary with Keys but no values. A simple <code>vbNullString</code> will do. See updated answer."}, {"owner": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "edited": false, "score": 0, "creation_date": 1505299264, "post_id": 46193365, "comment_id": 79352973, "body": "@Kostas K. Thanks both! amazing help and everything is now working! And nathan!"}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1505295529, "last_edit_date": 1505295529, "creation_date": 1505293760, "answer_id": 46193365, "question_id": 46193087, "link": "https://stackoverflow.com/questions/46193087/2-listboxes-into-1-and-then-delete-matching-values-vba/46193365#46193365", "title": "2 Listboxes into 1 and then delete matching values VBA", "body": "<p>You can use a Scripting.Dictionary object which allows unique Keys. You can check if an item exist using the .Exists method.</p>\n\n<pre><code>Sub Whatever()\n    Dim obj As Object\n    Set obj = CreateObject(\"Scripting.Dictionary\")\n\n    '1st ListBox\n    For i = 0 To ListBox1.ListCount - 1\n        If Not obj.Exists(CStr(ListBox1.List(i))) Then\n            obj.Add CStr(ListBox1.List(i)), vbNullString\n        End If\n    Next\n\n    '2nd ListBox\n    For i = 0 To ListBox2.ListCount - 1\n        If Not obj.Exists(CStr(ListBox2.List(i))) Then\n            obj.Add ListBox2.List(i), vbNullString\n        End If\n    Next\n\n    'add unique list to 3rd ListBox\n    Dim Key As Variant\n    For Each Key In obj.Keys\n        ListBox3.AddItem Key\n    Next Key\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>Credit to @Nathan_Sav for pointing this out. No need to loop to fill the 3rd ListBox.</p>\n\n<pre><code>ListBox3.List = obj.Keys()\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 46193365, "answer_count": 1, "score": 0, "last_activity_date": 1505295529, "creation_date": 1505292930, "last_edit_date": 1505294476, "question_id": 46193087, "link": "https://stackoverflow.com/questions/46193087/2-listboxes-into-1-and-then-delete-matching-values-vba", "title": "2 Listboxes into 1 and then delete matching values VBA", "body": "<p>I want to have 2 listboxes, 1 with a bunch of values and one with another bunch of values, I want to add them to a 3rd listbox and then delete all of the matching values, </p>\n\n<p>here is my code i have got so far, </p>\n\n<pre><code>   For i = 0 To (ListBox1.ListCount - 1)\nListBox3.AddItem (ListBox1.List(i))\nNext\n\nDim qstring As String\n\n\nFor i = 0 To (ListBox2.ListCount - 1)\n\nqstring = ListBox1.List(i)\n\nWith Me.ListBox3\n         'Loop through combobox\n        For b = 0 To .ListCount - 1\n            If .List(b) = qstring Then\n                strFound = True\n                Exit For\n            End If\n        Next b\n         'Check if we should add item\n        If Not strFound Then .AddItem (qstring)\n    End With\n\nNext\n</code></pre>\n\n<p>Revised, Thank you for your help sir, I am now wondering why I am receiving this error, Thank you! </p>\n\n<p><a href=\"https://i.stack.imgur.com/BOiNI.png\" rel=\"nofollow noreferrer\">Error</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "reply_to_user": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "edited": false, "score": 0, "creation_date": 1505328918, "post_id": 46192923, "comment_id": 79373048, "body": "I&#39;ve tried to use CurrentRegion as well as End(xlToRight), End(xlDown) but nothing works because there are empty columns between columns with data so the macro just copies the first column. UsedRange also doesn&#39;t apply in this case because I just need to copy data from first table that is between Language Pair (header) and Total (last) rows. The header is always placed in the same row- row number 9."}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "edited": false, "score": 0, "creation_date": 1505399368, "post_id": 46196070, "comment_id": 79406413, "body": "it works but not in the way I wish to. The problem is that Language is one of the header name. I forgot to mention that the last column is always AJ, the copy range always starts from A11 and the destination range starts from A10 cell. I tried to put  <code>sh.Range(&quot;A11:AJ&quot; &amp; LastRow)</code> but it still doesn&#39;t copy everything I want. I also know that the rows I am looking for contains FR* and EN*. I hope that it is clear."}], "tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 0, "last_activity_date": 1505301305, "creation_date": 1505301305, "answer_id": 46196070, "question_id": 46192923, "link": "https://stackoverflow.com/questions/46192923/copy-rows-between-header-and-the-last-row/46196070#46196070", "title": "copy rows between header and the last row", "body": "<p>Here is a function that will return you the range. Parameters explained:</p>\n\n<ul>\n<li><code>oW</code> = The worksheet you want to get the range from</li>\n<li><p><code>sStartColHeader</code> = Holds the name of the header column you want to start the range from (i.e. in your example this would be \"<strong>Language</strong>\")<br></p>\n\n<pre><code>Function GetRange(ByVal oW As Worksheet, ByVal sStartColHeader As String) As Range\n    Dim oTotRng As Range: Set oTotRng = oW.Cells.Find(\"total\", oW.Cells(1, 1), xlValues, xlPart, xlByRows, xlNext, False, , False)\n    Dim oLan As Range\n\n    Set oLan = oW.Cells.Find(sStartColHeader, oW.Cells(1, 1), xlValues, xlPart, xlByRows, xlNext, False, , False)\n    If oLan Is Nothing Then\n        Set GetRange = Nothing\n    Else\n        Set GetRange = Range(oLan.Offset(1, 0), oTotRng.Offset(0, 1))\n    End If\n\nEnd Function\n</code></pre></li>\n</ul>\n\n<p><strong>How to use this function</strong>:<br>\nIn <code>CopyRangeFromMultiWorksheets</code> function, change <code>Set CopyRng = sh.Range(\"A11:AI15\")</code> to <code>Set CopyRng = GetRange(sh, \"Language\")</code>. Then have an <code>If</code> condition to check if a range was returned. For example:<br></p>\n\n<pre><code>Set CopyRng = GetRange(sh, \"Language\")\nIf CopyRng Is Nothing Then\n    ' your exception code here as range was not returned\nElse\n    ' rest of your code here as a range was returned\nEnd If\n</code></pre>\n\n<p><strong>NOTE</strong>: Presumption is that the actual total amount in the sheet is in the cell to the right of the cell that contains the text <strong><code>Total</code></strong>. So if \"<strong><code>H10</code></strong>\" has text <strong><code>Total</code></strong>, actual total is held in cell \"<strong><code>I10</code></strong>\"</p>\n"}, {"tags": [], "owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "is_accepted": true, "score": 0, "last_activity_date": 1505486435, "creation_date": 1505486435, "answer_id": 46242185, "question_id": 46192923, "link": "https://stackoverflow.com/questions/46192923/copy-rows-between-header-and-the-last-row/46242185#46242185", "title": "copy rows between header and the last row", "body": "<p>I have found a solution that works great. See the code below:</p>\n\n<pre><code>Sub CopyRangeFromMultiWorksheets()\nDim sh As Worksheet\nDim DestSh As Worksheet\nDim Last As Long\nDim CopyRng As Range\nDim findrow As Long, findrow2 As Long\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\nSet DestSh = ThisWorkbook.Worksheets(\"Summary\")\n\n\nFor Each sh In ActiveWorkbook.Worksheets\n    If sh.Name &lt;&gt; DestSh.Name Then\n\n        Last = LastRow(DestSh)\n        'this method doesn't work with merged cells thhat is why I have to unmerge them first.\n        sh.Range(\"B10:B200\").UnMerge\n        findrow = sh.Range(\"B:B\").Find(\"Language Pair\", sh.Range(\"B1\")).Row\n        findrow2 = sh.Range(\"B:B\").Find(\"Total\", sh.Range(\"B\" &amp; findrow)).Row\n\n        Set CopyRng = sh.Range(\"A\" &amp; findrow + 1 &amp; \":AJ\" &amp; findrow2 - 1)\n\n        CopyRng.Copy\n        With DestSh.Cells(Last + 1, \"B\")\n            .PasteSpecial\n            Application.CutCopyMode = False\n        End With\n\n        DestSh.Cells(Last + 1, \"A\").Resize(CopyRng.Rows.Count).Value = sh.Range(\"F8\")\n        DestSh.Cells(Last + 1, \"AK\").Resize(CopyRng.Rows.Count).Formula = \"=AG10*3%\"\n        DestSh.Cells(Last + 1, \"AL\").Resize(CopyRng.Rows.Count).Formula = \"=AG10+AK10\"\n\n    End If\nNext\n\nExitTheSub:\n\nApplication.Goto DestSh.Cells(1)\n\nDestSh.Columns.AutoFit\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\nEnd Sub\n\nFunction LastRow(sh As Worksheet)\nOn Error Resume Next\nLastRow = sh.Cells.Find(What:=\"*\", _\n                        After:=sh.Range(\"A1\"), _\n                        Lookat:=xlPart, _\n                        LookIn:=xlFormulas, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlPrevious, _\n                        MatchCase:=False).Row\nOn Error GoTo 0\nEnd Function\n\nFunction LastCol(sh As Worksheet)\nOn Error Resume Next\nLastCol = sh.Cells.Find(What:=\"*\", _\n                        After:=sh.Range(\"A1\"), _\n                        Lookat:=xlPart, _\n                        LookIn:=xlFormulas, _\n                        SearchOrder:=xlByColumns, _\n                        SearchDirection:=xlPrevious, _\n                        MatchCase:=False).Column\nOn Error GoTo 0\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 46242185, "answer_count": 2, "score": 0, "last_activity_date": 1505486435, "creation_date": 1505292379, "last_edit_date": 1531161705, "question_id": 46192923, "link": "https://stackoverflow.com/questions/46192923/copy-rows-between-header-and-the-last-row", "title": "copy rows between header and the last row", "body": "<p>I found and modified a code that works pretty well but I am struggling with <code>Set CopyRng = sh.Range(\"A11:AI15\")</code> . What I want to do is to create a dynamic range that will copy values from <strong>first</strong> table from each worksheet between header called <em>Language</em> and last row in table called <em>Total</em>. Some cells are merged in the table (default template) and there are empty columns in the table (so .CurrentRegion doesn't work).</p>\n\n<pre><code>Function LastRow(sh As Worksheet)\nOn Error Resume Next\nLastRow = sh.Cells.Find(What:=\"*\", _\n                        After:=sh.Range(\"A1\"), _\n                        Lookat:=xlPart, _\n                        LookIn:=xlFormulas, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlPrevious, _\n                        MatchCase:=False).Row\nOn Error GoTo 0\nEnd Function\n\nFunction LastCol(sh As Worksheet)\nOn Error Resume Next\nLastCol = sh.Cells.Find(What:=\"*\", _\n                        After:=sh.Range(\"A1\"), _\n                        Lookat:=xlPart, _\n                        LookIn:=xlFormulas, _\n                        SearchOrder:=xlByColumns, _\n                        SearchDirection:=xlPrevious, _\n                        MatchCase:=False).Column\nOn Error GoTo 0\nEnd Function\nSub CopyRangeFromMultiWorksheets()\nDim sh As Worksheet\nDim DestSh As Worksheet\nDim Last As Long\nDim CopyRng As Range\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\nSet DestSh = ActiveWorkbook.Worksheets(\"test\")\n\n' Loop through all worksheets and copy the data to the\n' summary worksheet.\nFor Each sh In ActiveWorkbook.Worksheets\n    If sh.Name Like \"test*\" Then\n\n        Last = LastRow(DestSh)\n\n        ' Specify the range to place the data.\n        Set CopyRng = sh.Range(\"A11:AI15\")\n\n        CopyRng.Copy\n        With DestSh.Cells(Last + 1, \"A\")\n            .PasteSpecial\n            Application.CutCopyMode = False\n        End With\n\n        DestSh.Cells(Last + 1, \"A\").Resize(CopyRng.Rows.Count).Value = sh.Range(\"F8\")\n        DestSh.Cells(Last + 1, \"AK\").Resize(CopyRng.Rows.Count).Formula = \"=AG10*3%\"\n        DestSh.Cells(Last + 1, \"AL\").Resize(CopyRng.Rows.Count).Formula = \"=AG10+AK10\"\n\n    End If\nNext\n\nExitTheSub:\n\nApplication.Goto DestSh.Cells(1)\n\nDestSh.Columns.AutoFit\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Regards,</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1985, "user_id": 3160820, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9E28.jpg?s=128&g=1", "display_name": "Trimax", "link": "https://stackoverflow.com/users/3160820/trimax"}, "edited": false, "score": 1, "creation_date": 1505291889, "post_id": 46192656, "comment_id": 79347594, "body": "Have you debugged the value of <code>lCounter</code>?  Insert a line with <code>debug.print(lCounter)</code> before <code>End Function</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1985, "user_id": 3160820, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9E28.jpg?s=128&g=1", "display_name": "Trimax", "link": "https://stackoverflow.com/users/3160820/trimax"}, "edited": false, "score": 1, "creation_date": 1505292257, "post_id": 46192656, "comment_id": 79347841, "body": "@Trimax - this will not help at all. See what I learned literally yesterday - <a href=\"https://stackoverflow.com/questions/46171685/circular-error-in-vba-user-defined-function/46171873?noredirect=1#comment79338343_46171873\" title=\"circular error in vba user defined function\">stackoverflow.com/questions/46171685/&hellip;</a>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1505292659, "post_id": 46192656, "comment_id": 79348093, "body": "Your code works for me, so I suspect it is the parameters you are passing, or the data you are processing.  Can you update the question to show how you call the UDF."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1505292907, "post_id": 46192656, "comment_id": 79348244, "body": "if <code>rColNum</code> is a <code>Range</code>, then <code>lColNumOff = rColNum</code> should be either <code>Set lColNumOff = rColNum</code> , or <code>lColNumOff = rColNum.Column</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1505293018, "post_id": 46192656, "comment_id": 79348328, "body": "@ShaiRado Not if it is intended to be a cell that specifies a number indicating the number of columns to offset by.  (I originally tried passing <code>1</code> as that parameter until I realised it was a <code>Range</code>, and then had to pass a cell reference for a cell containing the number 1.)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1505295144, "post_id": 46192656, "comment_id": 79349937, "body": "Just to double check, the function is in a module, and not somewhere else, right?"}, {"owner": {"reputation": 31, "user_id": 8602077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db200a58f9a5adeede4b7ebbff221e66?s=128&d=identicon&r=PG&f=1", "display_name": "MistyBlue", "link": "https://stackoverflow.com/users/8602077/mistyblue"}, "edited": false, "score": 0, "creation_date": 1505295255, "post_id": 46192656, "comment_id": 79350039, "body": "Yes it is in a module. Thanks"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1505295489, "post_id": 46192656, "comment_id": 79350214, "body": "Then probably you are giving to <code>rKRM</code> or <code>rColNum</code> more than 1 cell in the range?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1505304088, "post_id": 46192656, "comment_id": 79356320, "body": "It would make it easier to help if you would upload a sample workbook that demonstrates the problem, including how you are calling the function, and post a link here."}, {"owner": {"reputation": 31, "user_id": 8602077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db200a58f9a5adeede4b7ebbff221e66?s=128&d=identicon&r=PG&f=1", "display_name": "MistyBlue", "link": "https://stackoverflow.com/users/8602077/mistyblue"}, "edited": false, "score": 2, "creation_date": 1505346894, "post_id": 46192656, "comment_id": 79380215, "body": "Ok So it was an error with the data I was referencing in the names of the people in question. There were a couple of cells that had #NA in the full data set. Thanks Everyone!!!"}], "owner": {"reputation": 31, "user_id": 8602077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db200a58f9a5adeede4b7ebbff221e66?s=128&d=identicon&r=PG&f=1", "display_name": "MistyBlue", "link": "https://stackoverflow.com/users/8602077/mistyblue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1387, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1505294288, "creation_date": 1505291546, "last_edit_date": 1505291610, "question_id": 46192656, "link": "https://stackoverflow.com/questions/46192656/vba-function-not-returning-a-value", "title": "VBA Function not returning a value", "body": "<p>I have an excel VBA Function that needs to count the cells that are coloured, match a specific string and have another cell blank.</p>\n\n<p>I created it in a test workbook using only a small sample of the data where it worked, but now, when I implement in the main workbook, it returns #Value! I suspect there could be an issue with the string being used, but putting a watch on all my variables shows the function is working as expected but it doesn't actually provide the return value.</p>\n\n<p>Here is the code. Any input will be very much appreciated</p>\n\n<pre><code>Function FundInStarted(rSample As Range, rKRM As Range, rColNum As Range, rArea As Range) As Long\n\n    Dim rAreaCell As Range\n    Dim lMatchColor As Long\n    Dim lCounter As Long\n    Dim sKRMMatch As String\n    Dim lColNumOff As Long\n\n    lMatchColor = rSample.Interior.Color\n    sKRMMatch = rKRM.Value2\n    lColNumOff = rColNum\n\n    For Each rAreaCell In rArea\n        If rAreaCell.Interior.Color = lMatchColor And rAreaCell.Offset(0, -lColNumOff) = sKRMMatch And rAreaCell.Value = \"\" Then\n            lCounter = lCounter + 1\n        End If\n    Next\n    FundInStarted = lCounter\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "date", "ms-word", "format"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505291418, "post_id": 46192378, "comment_id": 79347264, "body": "What date format do you normally use on your computer?"}, {"owner": {"reputation": 5, "user_id": 8400017, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-HYgmi91Xbzw/AAAAAAAAAAI/AAAAAAAAAG0/NsyGixjI2Gg/photo.jpg?sz=128", "display_name": "Ji\u0159&#237; Jezdinsk&#253;", "link": "https://stackoverflow.com/users/8400017/ji%c5%99%c3%ad-jezdinsk%c3%bd"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505291783, "post_id": 46192378, "comment_id": 79347530, "body": "I use dd/MM/yyyy"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505292245, "post_id": 46192378, "comment_id": 79347827, "body": "If you now change (temporarily) the three Excel cells to <code>General</code> format, do they all become 5 digit numbers, or do some still appear as dates?  (If they aren&#39;t really dates - just text that looks like a date - they will stay as they are.  But real dates will show the serial day number when changed to <code>General</code> format.  Knowing which are dates and which are text might give more information re what part of the process is causing the issue.)"}, {"owner": {"reputation": 5, "user_id": 8400017, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-HYgmi91Xbzw/AAAAAAAAAAI/AAAAAAAAAG0/NsyGixjI2Gg/photo.jpg?sz=128", "display_name": "Ji\u0159&#237; Jezdinsk&#253;", "link": "https://stackoverflow.com/users/8400017/ji%c5%99%c3%ad-jezdinsk%c3%bd"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505292557, "post_id": 46192378, "comment_id": 79348045, "body": "If I change all the cells to <code>general</code> only 1st one <code>05&#47;01&#47;2017</code> will be as 5digit number <code>42740</code>, other two stay as dates - <code>21&#47;12&#47;2017</code> and <code>13&#47;09&#47;2017</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8400017, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-HYgmi91Xbzw/AAAAAAAAAAI/AAAAAAAAAG0/NsyGixjI2Gg/photo.jpg?sz=128", "display_name": "Ji\u0159&#237; Jezdinsk&#253;", "link": "https://stackoverflow.com/users/8400017/ji%c5%99%c3%ad-jezdinsk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1505291568, "post_id": 46192600, "comment_id": 79347363, "body": "Hey, thanks for answer! However, if I change it to your proposal the result in excel is completely the same."}, {"owner": {"reputation": 1985, "user_id": 3160820, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9E28.jpg?s=128&g=1", "display_name": "Trimax", "link": "https://stackoverflow.com/users/3160820/trimax"}, "reply_to_user": {"reputation": 5, "user_id": 8400017, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-HYgmi91Xbzw/AAAAAAAAAAI/AAAAAAAAAG0/NsyGixjI2Gg/photo.jpg?sz=128", "display_name": "Ji\u0159&#237; Jezdinsk&#253;", "link": "https://stackoverflow.com/users/8400017/ji%c5%99%c3%ad-jezdinsk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1505292350, "post_id": 46192600, "comment_id": 79347903, "body": "Well, I added a line in order to set the format to the range of cells."}, {"owner": {"reputation": 5, "user_id": 8400017, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-HYgmi91Xbzw/AAAAAAAAAAI/AAAAAAAAAG0/NsyGixjI2Gg/photo.jpg?sz=128", "display_name": "Ji\u0159&#237; Jezdinsk&#253;", "link": "https://stackoverflow.com/users/8400017/ji%c5%99%c3%ad-jezdinsk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1505292801, "post_id": 46192600, "comment_id": 79348173, "body": "Yeah, changing the format to correct one does not solve the issue."}], "tags": [], "owner": {"reputation": 1985, "user_id": 3160820, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9E28.jpg?s=128&g=1", "display_name": "Trimax", "link": "https://stackoverflow.com/users/3160820/trimax"}, "is_accepted": false, "score": 0, "last_activity_date": 1505292261, "last_edit_date": 1505292261, "creation_date": 1505291372, "answer_id": 46192600, "question_id": 46192378, "link": "https://stackoverflow.com/questions/46192378/copying-date-word-to-excel-wrong-format/46192600#46192600", "title": "Copying date Word to Excel - wrong format", "body": "<p>If you want to use the continental date format <code>\"dd/mm/yyyy\"</code> in your sheet you must use <code>Format()</code> function.  So, try this:</p>\n\n<pre><code>Sheets(\"wImp\").Range(\"AA\" &amp; i) = Format(wdDoc.ContentControls(1).Range.Text, \"dd/mm/yyyy\")\nSheets(\"wImp\").Range(\"AA\" &amp; i).NumberFormat = \"dd/mm/yyyy\"\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/VBA/Language-Reference-VBA/articles/format-function-visual-basic-for-applications\" rel=\"nofollow noreferrer\">Oficial documentation of Format() function</a></p>\n"}, {"tags": [], "owner": {"reputation": 129, "user_id": 7190099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bdefefbd52d5b52b373816fa82b3952?s=128&d=identicon&r=PG&f=1", "display_name": "Chenhua", "link": "https://stackoverflow.com/users/7190099/chenhua"}, "is_accepted": false, "score": 0, "last_activity_date": 1505293366, "creation_date": 1505293366, "answer_id": 46193225, "question_id": 46192378, "link": "https://stackoverflow.com/questions/46192378/copying-date-word-to-excel-wrong-format/46193225#46193225", "title": "Copying date Word to Excel - wrong format", "body": "<pre><code>Sub test()\n\nActiveSheet.Range(\"A1\").NumberFormat = \"@\"\nActiveSheet.Range(\"A1\").Value = \"01/05/2017\"\n\nActiveSheet.Range(\"A2\").NumberFormat = \"m/d/yyyy\"\nActiveSheet.Range(\"A2\").Value = \"01/05/2017\"\n\nActiveSheet.Range(\"A3\").NumberFormat = \"yyyy/m/d;@\"\nActiveSheet.Range(\"A3\").Value = \"01/05/2017\"\n\nEnd Sub\n</code></pre>\n\n<p>Try something like this.\nExcel will convert the data during copy.\nSo, change \"NumberFormat\" before copy.</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 8400017, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-HYgmi91Xbzw/AAAAAAAAAAI/AAAAAAAAAG0/NsyGixjI2Gg/photo.jpg?sz=128", "display_name": "Ji\u0159&#237; Jezdinsk&#253;", "link": "https://stackoverflow.com/users/8400017/ji%c5%99%c3%ad-jezdinsk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1505294462, "post_id": 46193492, "comment_id": 79349448, "body": "I salute you! Works on a first try! I have to test it, in case there is some weird case. Anyhow, thank you very much for a help and your time!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 5, "user_id": 8400017, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-HYgmi91Xbzw/AAAAAAAAAAI/AAAAAAAAAG0/NsyGixjI2Gg/photo.jpg?sz=128", "display_name": "Ji\u0159&#237; Jezdinsk&#253;", "link": "https://stackoverflow.com/users/8400017/ji%c5%99%c3%ad-jezdinsk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1505294574, "post_id": 46193492, "comment_id": 79349529, "body": "@Ji\u0159&#237;Jezdinsk&#253; And I learnt something new - I hadn&#39;t realised that it was so USA-centric when assigning a date from a string like that.  It might explain a lot of the other date-related issues that I have come across."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1505294124, "creation_date": 1505294124, "answer_id": 46193492, "question_id": 46192378, "link": "https://stackoverflow.com/questions/46192378/copying-date-word-to-excel-wrong-format/46193492#46193492", "title": "Copying date Word to Excel - wrong format", "body": "<p>Assigning a string to the cell makes Excel think that the string should be interpreted in a <code>\"mm/dd/yyyy\"</code> format irrespective of your locale (and irrespective of the cell's date format).</p>\n\n<p>So convert the string to a <code>Date</code> using the <code>CDate</code> function (which will be done using your system date/time settings) before assigning the value to the cell.</p>\n\n<pre><code>Sheets(\"wImp\").Range(\"AA\" &amp; i) = CDate(wdDoc.ContentControls(1).Range.Text)\n</code></pre>\n\n<p>That date can then be displayed in whatever date format you want to use for the cell.</p>\n"}], "owner": {"reputation": 5, "user_id": 8400017, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-HYgmi91Xbzw/AAAAAAAAAAI/AAAAAAAAAG0/NsyGixjI2Gg/photo.jpg?sz=128", "display_name": "Ji\u0159&#237; Jezdinsk&#253;", "link": "https://stackoverflow.com/users/8400017/ji%c5%99%c3%ad-jezdinsk%c3%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1505294124, "creation_date": 1505290614, "last_edit_date": 1505291722, "question_id": 46192378, "link": "https://stackoverflow.com/questions/46192378/copying-date-word-to-excel-wrong-format", "title": "Copying date Word to Excel - wrong format", "body": "<p>I have been trying to solve an issue I have with copying dates from Word document to Excel using VBA.</p>\n\n<p>My issue is the format.  If I put <code>dd/MM/yyyy</code> it will change during the process to <code>MM/dd/yyyy</code> and I cannot solve the issue.</p>\n\n<p>Basically for copying I am using this line:</p>\n\n<pre><code>Sheets(\"wImp\").Range(\"AA\" &amp; i) = wdDoc.ContentControls(1).Range.Text\n</code></pre>\n\n<p>However during the process the data is modified.</p>\n\n<p>I originally used <strong>LegacyForms</strong> but it did work and I hoped <strong>Date Picker</strong> would help but it does not.  And in a case the date is impossible to switch like <code>21/12/2017</code> it will stay as it should.  But when it can be switched like <code>1/5/2017</code> it will be switched to <code>5/1/2017</code>.\n!!! Nevertheless the cell format stays <code>dd/MM/yyyy</code> for all the dates, but the months and days position is switched.</p>\n\n<p>See below for what I have as input in Word and the output in Excel.</p>\n\n<p>Word:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LWHPB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LWHPB.png\" alt=\"Word\"></a></p>\n\n<p>Excel:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xEQ2z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xEQ2z.png\" alt=\"Excel\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "edited": false, "score": 0, "creation_date": 1505290784, "post_id": 46192329, "comment_id": 79346844, "body": "That is deffinitelly not a macro. They seem to be reference formulas for a macro, have you found any code in the Visual Basic editor? try opening it with alt+f11"}], "answers": [{"comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1505291008, "post_id": 46192443, "comment_id": 79346991, "body": "That threw me.. it just looked like a normal sheet calling UDF&#39;s.. but you are absolutely right.. I had forgot about the old lotus format :). Good shout!"}, {"owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "edited": false, "score": 0, "creation_date": 1505296756, "post_id": 46192443, "comment_id": 79351152, "body": "The files are produced by Oracle BI Discoverer 11g. Hopefully the new versions of Oracle will be a bit more updated with the macros"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "edited": false, "score": 0, "creation_date": 1505296856, "post_id": 46192443, "comment_id": 79351227, "body": "@Selrac: Indeed. And note the other answer (that I&#39;ve upvoted) is more truthful than this one, even after my cheeky edit."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1505296828, "last_edit_date": 1505296828, "creation_date": 1505290821, "answer_id": 46192443, "question_id": 46192329, "link": "https://stackoverflow.com/questions/46192329/excel-macro-non-vba/46192443#46192443", "title": "Excel macro non VBA", "body": "<p>Wow. This takes me back. It's the pre-1997 way of coding macros, before Microsoft Excel 1997<sup>1</sup>.</p>\n\n<p>Lotus 1-2-3 pioneered it. Are you sure the workbook didn't begin life as a 1-2-3 spreadsheet?</p>\n\n<p>Naturally you ought to attempt to port such stuff to newer technologies despite Excel still supporting in-worksheet macros.</p>\n\n<p>There are a few conversion tools dotted around the internet. See <a href=\"http://www.xlhelp.com/Excel/Lotus.htm\" rel=\"nofollow noreferrer\">http://www.xlhelp.com/Excel/Lotus.htm</a> for example.</p>\n\n<hr>\n\n<p><sup>1</sup>Which, in my humble opinion, was at the time the best application ever written.</p>\n"}, {"tags": [], "owner": {"reputation": 908, "user_id": 2322977, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/49c196ad6e4365c8f219c89030597728?s=128&d=identicon&r=PG", "display_name": "ainwood", "link": "https://stackoverflow.com/users/2322977/ainwood"}, "is_accepted": true, "score": 4, "last_activity_date": 1505292325, "creation_date": 1505292325, "answer_id": 46192909, "question_id": 46192329, "link": "https://stackoverflow.com/questions/46192329/excel-macro-non-vba/46192909#46192909", "title": "Excel macro non VBA", "body": "<p>It's an old Excel 4 macro, from before there was a VBA editor.  It is still supported in the latest excel versions - right-click on the \"sheet tabs\" in an excel workbook, hit \"insert\", and one of the options in the dialog is to insert an <code>MS Excel 4.0 Macro</code>.  Select that, and it will insert a sheet that looks like a worksheet, but allows macros like this.</p>\n\n<p>Some useful links on migrating them:</p>\n\n<p><a href=\"https://support.office.com/en-us/article/Working-with-Excel-4-0-macros-ba8924d4-e157-4bb2-8d76-2c07ff02e0b8\" rel=\"nofollow noreferrer\">Working with Excel 4.0 Macros</a></p>\n\n<p>And:</p>\n\n<p><a href=\"https://blogs.office.com/en-us/2010/02/16/migrating-excel-4-macros-to-vba/\" rel=\"nofollow noreferrer\">Migrating Excel 4 Macros to VBA</a></p>\n\n<p>If you want to try to work with the Excel 4 macro, you can get a help file (from Microsoft) <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=1465\" rel=\"nofollow noreferrer\">Here</a>.</p>\n"}], "owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "accepted_answer_id": 46192909, "answer_count": 2, "score": 4, "last_activity_date": 1535474929, "creation_date": 1505290456, "last_edit_date": 1505291758, "question_id": 46192329, "link": "https://stackoverflow.com/questions/46192329/excel-macro-non-vba", "title": "Excel macro non VBA", "body": "<p>I have an Excel file that opens up with a Macro tab with a code that doesn't seem to be VBA. When enabling the macros warning in excel it formats the file as per the macro.</p>\n\n<p>What type of code is this? Does anyone know where I can get more information how how to code this type of macros?</p>\n\n<p>See below what this the code for this macro looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DAY9D.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DAY9D.jpg\" alt=\"ExcelNonVBAMacro\"></a></p>\n"}, {"tags": ["excel", "vba", "inputbox"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1505290523, "post_id": 46192057, "comment_id": 79346678, "body": "You can use the <code>Application.InputBox</code> version of <b>VBA</b>, see my answer below"}], "answers": [{"tags": [], "owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "is_accepted": false, "score": 1, "last_activity_date": 1505290015, "creation_date": 1505290015, "answer_id": 46192175, "question_id": 46192057, "link": "https://stackoverflow.com/questions/46192057/rerun-inputbox-when-there-is-a-wrong-variable-type-input-error/46192175#46192175", "title": "Rerun InputBox when there is a wrong variable type input error", "body": "<p>You can replace <code>If IsError(qm) Then GoTo Test1</code> with <code>On Error GoTo Test1</code>, and <code>On Error GoTo 0</code> to reset the error handler.</p>\n\n<p>Details can see <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/on-error-statement\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/on-error-statement</a></p>\n"}, {"comments": [{"owner": {"reputation": 982, "user_id": 4035306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XirX6.jpg?s=128&g=1", "display_name": "Lutscha", "link": "https://stackoverflow.com/users/4035306/lutscha"}, "edited": false, "score": 0, "creation_date": 1505298090, "post_id": 46192181, "comment_id": 79352155, "body": "Thank you. The IsNumeric() solution was gives for my task as a tip but I am glad you showed me how to use it correctly."}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 2, "last_activity_date": 1505290508, "last_edit_date": 1505290508, "creation_date": 1505290053, "answer_id": 46192181, "question_id": 46192057, "link": "https://stackoverflow.com/questions/46192057/rerun-inputbox-when-there-is-a-wrong-variable-type-input-error/46192181#46192181", "title": "Rerun InputBox when there is a wrong variable type input error", "body": "<p>Try something like below</p>\n\n<pre><code>Sub Demo()\n    Dim qm As String\n    qm = 0\nTest1:\n    qm = InputBox(\"Enter value\")\n    If Not IsNumeric(qm) Then GoTo Test1\nEnd Sub\n</code></pre>\n\n<p>Declare <code>qm</code> as <code>String</code> and check whether its numeric or not. Then you'll have to convert <code>String</code> into <code>Integer</code> using <code>CInt()</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 982, "user_id": 4035306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XirX6.jpg?s=128&g=1", "display_name": "Lutscha", "link": "https://stackoverflow.com/users/4035306/lutscha"}, "edited": false, "score": 0, "creation_date": 1505298146, "post_id": 46192205, "comment_id": 79352211, "body": "Man this is, for me, a smart solution. Thanks a lot."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1505290126, "creation_date": 1505290126, "answer_id": 46192205, "question_id": 46192057, "link": "https://stackoverflow.com/questions/46192057/rerun-inputbox-when-there-is-a-wrong-variable-type-input-error/46192205#46192205", "title": "Rerun InputBox when there is a wrong variable type input error", "body": "<p>There are various ways to solve this. I would suggest to define a variable as <code>variant</code> (can hold any datatype) and check if it is numeric:</p>\n\n<pre><code>dim answer as variant, qm as integer\ndo while true\n    answer = InputBox(...)\n    if isNumeric(answer) then\n        qm = cInt(answer)\n        exit do\n    endif\nloop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1985, "user_id": 3160820, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9E28.jpg?s=128&g=1", "display_name": "Trimax", "link": "https://stackoverflow.com/users/3160820/trimax"}, "is_accepted": false, "score": 1, "last_activity_date": 1505290279, "creation_date": 1505290279, "answer_id": 46192255, "question_id": 46192057, "link": "https://stackoverflow.com/questions/46192057/rerun-inputbox-when-there-is-a-wrong-variable-type-input-error/46192255#46192255", "title": "Rerun InputBox when there is a wrong variable type input error", "body": "<p>You can set an event to validate de content of the TextBox every time it changes.  I checked that is a number, but you can validate any other condition you need.</p>\n\n<pre><code>Private Sub TextBox1_Change()\n  validator = IsNumeric(TextBox1.Value)\n  If validator = False Then\n    MsgBox \"WARNING! You must enter a number!\"\n    TextBox1.BackColor = &amp;HFF8&amp;\n  End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 982, "user_id": 4035306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XirX6.jpg?s=128&g=1", "display_name": "Lutscha", "link": "https://stackoverflow.com/users/4035306/lutscha"}, "edited": false, "score": 0, "creation_date": 1505298018, "post_id": 46192291, "comment_id": 79352094, "body": "Thanks a lot for editing my question so that it is more readable. The Allpication.Inputbox worked great and I will try to take your editing as an example for future posts and answers."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1505290357, "creation_date": 1505290357, "answer_id": 46192291, "question_id": 46192057, "link": "https://stackoverflow.com/questions/46192057/rerun-inputbox-when-there-is-a-wrong-variable-type-input-error/46192291#46192291", "title": "Rerun InputBox when there is a wrong variable type input error", "body": "<p>That's why in VBA you can use the <code>Application.InputBox</code> with a 4th parameter <code>Type</code>. If you use <code>Type:=1</code> then only Numeric values are allowd.</p>\n\n<p><strong>Code</strong>:</p>\n\n<pre><code>Dim qm As Integer\n\nqm = Application.InputBox(\"Wie viele Quadrat Meter hat die Wohnung?\" _\n            &amp; vbLf &amp; \"Bitte geben sie die QM Zahl an.\", \"Angabe\", Type:=1)\n</code></pre>\n"}], "owner": {"reputation": 982, "user_id": 4035306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XirX6.jpg?s=128&g=1", "display_name": "Lutscha", "link": "https://stackoverflow.com/users/4035306/lutscha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1733, "favorite_count": 0, "accepted_answer_id": 46192291, "answer_count": 5, "score": 1, "last_activity_date": 1561986620, "creation_date": 1505289665, "last_edit_date": 1561986620, "question_id": 46192057, "link": "https://stackoverflow.com/questions/46192057/rerun-inputbox-when-there-is-a-wrong-variable-type-input-error", "title": "Rerun InputBox when there is a wrong variable type input error", "body": "<p>My goal is to rerun the InputBox when it crashes and give the user another chance to give the right type of input. (Like it crashes, you get a msgbox where it says \"sorry your entry is not available, please retry\", and it would jump back to the InputBox.)</p>\n\n<pre><code>Test1:\nqm = InputBox(\"Wie viele Quadrat Meter hat die Wohnung?\" &amp; vbLf &amp; \"Bitte geben sie die QM Zahl an.\", Angabe)\nIf IsError(qm) Then GoTo Test1\n</code></pre>\n\n<p><code>qm</code> is defined as an <code>Integer</code>, =0, and below there is a <code>Select Case</code> mutilple alternative which changes <code>qm</code> to a number from 1-600.</p>\n\n<p>When I type in text like \"Hey guys\", Excel gives me error 13 (Runtime error 13': type mismatch).</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 1, "last_activity_date": 1505289071, "last_edit_date": 1505289071, "creation_date": 1505288724, "answer_id": 46191745, "question_id": 46191510, "link": "https://stackoverflow.com/questions/46191510/find-cell-header-to-copy-to/46191745#46191745", "title": "Find cell header to copy to", "body": "<p>In <code>IF</code> condition instead of</p>\n\n<pre><code>cell_adr = arr(i)\n</code></pre>\n\n<p>use</p>\n\n<pre><code>Set cell_adr = cell\n</code></pre>\n\n<p><code>cell</code> is a range and will be assigned to <code>cell_adr</code> which again is a range. To get the address of the cell use <code>Debug.Print cell_adr.Address</code> for <code>Debug.Print cell_adr</code>.</p>\n\n<p>If you are not using <code>arr</code> anywhere else in your code you can remove it. In the code below I've commented lines that are not required if your don't have to use array.</p>\n\n<pre><code>Sub Demo()\n    'Dim i As Long\n    Dim cell As Range, cell_adr As Range 'declare cell as Range\n    'Dim arr() As String\n    Dim mth_exp_PM As String 'this value is taken from a different workbook and it matches one row header value\n\n    'i = 0\n    For Each cell In Range(Range(\"D1\"), Range(\"D1\").End(xlToRight).Offset(0, -1)).Cells\n        'ReDim Preserve arr(i)\n        'arr(i) = cell\n        'If arr(i) = mth_exp_PM Then\n        If cell = mth_exp_PM Then\n            Set cell_adr = cell\n            Debug.Print cell_adr.Address\n        End If\n        'i = i + 1\n    Next cell\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "is_accepted": false, "score": 0, "last_activity_date": 1505289370, "last_edit_date": 1505289370, "creation_date": 1505289064, "answer_id": 46191853, "question_id": 46191510, "link": "https://stackoverflow.com/questions/46191510/find-cell-header-to-copy-to/46191853#46191853", "title": "Find cell header to copy to", "body": "<p>One line correction needed, as below, majorly (<code>arr(i) = cell.value</code>)</p>\n\n<p>bellow presented your code revised correction. </p>\n\n<pre><code>dim i as long\ndim cell, cell_adr as range\ndim arr() as string\ndim mth_exp_PM as string 'this value is taken from a different workbook and it matches one row header value\n\ni = 0\nFor Each cell In Range(Range(\"D1\"), Range(\"D1\").End(xlToRight).Offset(0, -1)).Cells\n    ReDim Preserve arr(i)\n    arr(i) = cell.value 'Do correct here!\n    If arr(i) = mth_exp_PM Then\n        Set cell_adr = cell 'Correct here!\n        Debug.Print cell_adr.Address 'and Correct here\n    End If\n    i = i + 1\nNext cell\n</code></pre>\n"}], "owner": {"reputation": 128, "user_id": 8374642, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh4.googleusercontent.com/-TYw1s7XYRqw/AAAAAAAAAAI/AAAAAAAAAxo/IYfLOJbToU4/photo.jpg?sz=128", "display_name": "CCM", "link": "https://stackoverflow.com/users/8374642/ccm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505289370, "creation_date": 1505288011, "last_edit_date": 1531161705, "question_id": 46191510, "link": "https://stackoverflow.com/questions/46191510/find-cell-header-to-copy-to", "title": "Find cell header to copy to", "body": "<p>I have the following issue: I am trying to automate the copying of data to a certain column indicated by the header, but it errors out: \"Object variable or with block not set\". What I am trying to do is to add the row header to an one dimensional array, find the range that matches the searched mth_exp_PM and store it in another variable, preferably a set range (cell ?) to use further to copy.</p>\n\n<p>What am I doing wrong ? If this solution is not OK, what is the best/easier solution to copy to the column based on the row header ?</p>\n\n<p>Thank you!</p>\n\n<pre><code>dim i as long\ndim cell, cell_adr as range\ndim arr() as string\ndim mth_exp_PM as string 'this value is taken from a different workbook and it matches one row header value\n\ni = 0\nFor Each cell In Range(Range(\"D1\"), Range(\"D1\").End(xlToRight).Offset(0, -1)).Cells\n    ReDim Preserve arr(i)\n    arr(i) = cell\n    If arr(i) = mth_exp_PM Then\n        cell_adr = arr(i)\n        Debug.Print cell_adr\n    End If\n    i = i + 1\nNext cell\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/7JGe2.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7JGe2.jpg\" alt=\"Image\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1505286979, "post_id": 46191127, "comment_id": 79344435, "body": "<code>coll1(1)</code> is cat. <code>coll1(2)</code> is your <code>coll2</code>"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1505287592, "post_id": 46191127, "comment_id": 79344860, "body": "&quot;coll1(1) gets the second collection&quot;: No, there is not an <code>Item(0)</code> in a <code>Collection</code>. And your <code>Item(1)</code> is &quot;cat&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 1, "creation_date": 1505287353, "post_id": 46191162, "comment_id": 79344702, "body": "Up-voted for pointing out that a Collection should not be used like an Array, instead Item should be used."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 1, "creation_date": 1505310555, "post_id": 46191162, "comment_id": 79361277, "body": "@AxelRichter To be more precise, accessing a Collection by using indices is not accessing it like an array. It is still accessing it like a collection. <code>Debug.Print SomeColl(1)(1)</code> is perfectly valid since the <b>default-member</b> of a <code>Collection</code> is <code>Item</code>. So <code>SomeColl(1)(1)</code> and <code>SomeColl.Item(1).Item(1)</code> are identical in their function, the second one is just easier to read (and will throw an error specifically referencing the lack of the <code>.Item</code> method on a string)."}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 3, "last_activity_date": 1505287217, "last_edit_date": 1505287217, "creation_date": 1505286916, "answer_id": 46191162, "question_id": 46191127, "link": "https://stackoverflow.com/questions/46191127/nested-collections-access-elements-type-mismatch/46191162#46191162", "title": "Nested collections, access elements type mismatch", "body": "<p>Instead of</p>\n\n<pre><code>temp = coll1(1)(1)\n</code></pre>\n\n<p>use</p>\n\n<pre><code>temp = coll1(2)(1)\n</code></pre>\n\n<p>Using <code>coll1(2)(1)</code> will give <code>dog</code> and <code>coll1(1)</code> will give <code>cat</code>.</p>\n\n<p>To make it more readable you can use <code>coll1.Item(2).Item(1)</code> for <code>coll1(2)(1)</code> and likewise <code>coll1.Item(1)</code> for <code>coll1(1)</code></p>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1505287217, "creation_date": 1505286782, "last_edit_date": 1505286924, "question_id": 46191127, "link": "https://stackoverflow.com/questions/46191127/nested-collections-access-elements-type-mismatch", "title": "Nested collections, access elements type mismatch", "body": "<p>I have two collections, the second one is inside the first one. But when I try to access the element of the second collection I get a <code>Type mismatch</code> error.</p>\n\n<pre><code>Sub testColls()\nDim coll1 As Collection\nDim coll2 As Collection\n\nSet coll1 = New Collection\nSet coll2 = New Collection\n\ncoll2.Add (\"dog\")\ncoll1.Add (\"cat\")\n\ncoll1.Add coll2\n\nDim temp As String\ntemp = coll1(1)(1)\nMsgBox (temp)\n\nEnd Sub\n</code></pre>\n\n<p>Why is this error? <code>coll1(1)</code> gets the second collection, <code>coll</code>(1)(1)` should give first element of the second collection.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 0, "creation_date": 1505288325, "post_id": 46191028, "comment_id": 79345327, "body": "workbooks &quot; source&quot; and &quot;target&quot;  must be opened before you can copy the sheets."}, {"owner": {"reputation": 1, "user_id": 8601417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56779286af2972ed8ac0df11cde5bfae?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8601417/sam"}, "reply_to_user": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 0, "creation_date": 1505289128, "post_id": 46191028, "comment_id": 79345812, "body": "Thanks for reply , can you please suggest script or modify my code to open source and target before kicking of copy."}, {"owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 0, "creation_date": 1505301551, "post_id": 46191028, "comment_id": 79354543, "body": "@ sam, after have read your code more in detail, it looks like both workbooks are open."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8601417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56779286af2972ed8ac0df11cde5bfae?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8601417/sam"}, "edited": false, "score": 0, "creation_date": 1505308126, "post_id": 46196413, "comment_id": 79359373, "body": "Thanks a lot  for quick resolution .i am able to run and generate outptut as expected"}, {"owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "reply_to_user": {"reputation": 1, "user_id": 8601417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56779286af2972ed8ac0df11cde5bfae?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8601417/sam"}, "edited": false, "score": 0, "creation_date": 1505311230, "post_id": 46196413, "comment_id": 79361788, "body": "Could you validate the answer if this is an answer to your question ? thanks"}, {"owner": {"reputation": 1, "user_id": 8601417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56779286af2972ed8ac0df11cde5bfae?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8601417/sam"}, "edited": false, "score": 0, "creation_date": 1505355241, "post_id": 46196413, "comment_id": 79382131, "body": "Yes, suggested changes made each sh run sucessful ,which eventually generated output excel ."}], "tags": [], "owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "is_accepted": false, "score": 1, "last_activity_date": 1505302246, "creation_date": 1505302246, "answer_id": 46196413, "question_id": 46191028, "link": "https://stackoverflow.com/questions/46191028/when-relative-path-of-input-file-included-in-script-error-reported-vba/46196413#46196413", "title": "when Relative path of input file Included in script Error reported -VBA", "body": "<p>the problem is due to the fact that the source contains the fullname of the workbook (path included) and Excel expects only the shortname of the workbook (without the path)</p>\n\n<p>so adapt the call instruction like this</p>\n\n<pre><code>Call CopyWorkbook(ActiveWorkbook.Name, macroWb.Name)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8601417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56779286af2972ed8ac0df11cde5bfae?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8601417/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505302246, "creation_date": 1505286503, "last_edit_date": 1505287746, "question_id": 46191028, "link": "https://stackoverflow.com/questions/46191028/when-relative-path-of-input-file-included-in-script-error-reported-vba", "title": "when Relative path of input file Included in script Error reported -VBA", "body": "<p>I have this macro which is taking input excel, and generating excel report and copying it. Below code works fine when i am running manually from excel with msg dialog box, however when i tried to pass relative path of input file, i am getting  \"Runtime Error 9\"-Subscript out of range.  While debugger points to Each sh as error context. </p>\n\n<p>How do I fix this?</p>\n\n<pre><code> Sub buildSCTR()\n    '\n    ' Merge CSV and built pivot for SCTR\n    ' Ver 0.1\n    ' 5-July-2017    P. Coffey\n    '\n\nConst FILELIMIT = 0 'used to hardcode number of files will work with.  better ways exist but this will do for now\n\nDim firstFilename As String\nDim secondFilename As String\nDim outputFilename As String\nDim element As Variant\nDim dirLocation As String\nDim macroWb As Object\nDim lastrow As Integer\nDim samName As String\nDim RootFolder As String\n\n'code allows for multiple import, but using it for one one import here\nDim filenameArr(0 To FILELIMIT) As Variant 'so can push cells into it later\nDim inputSelected As Variant 'has to variant to iterate over via for each even though its a string\n\nSet macroWb = ThisWorkbook\n\nRootFolder = ActiveWorkbook.Path\n\n'get new csv to load\n    'Set fd = Application.FileDialog(msoFileDialogFilePicker)\n     ' With fd\n      '  .AllowMultiSelect = True\n       ' .Title = \"Pick SC file to load\"\n        '.Filters.Clear\n        '.Filters.Add \"csv\", \"*.csv*\"\n\n        'If .Show = True Then\n\n         '   i = 0\n          '  For Each inputSelected In .SelectedItems\n           '     filenameArr(i) = Dir(inputSelected)     'kludgy....\n            '    dirLocation = Split(inputSelected, filenameArr(i))(0)\n             '   i = i + 1\n            'Next inputSelected\n\n       ' Else\n        '  MsgBox (\"Nothing selected\")\n         ' Exit Sub\n       ' End If\n      'End With\n\n    Application.StatusBar = \"Starting to update\"\n\n    element = RootFolder + \"/Output/_SCT_Details_With_Comments.csv\"\n\n\n   ' For Each element In filenameArr()\n        If Not IsEmpty(element) Then    'as hardcoded length of array have to do this\n            Workbooks.Open (element)\n            Call CopyWorkbook(CStr(element), macroWb.Name)\n            'close csv as done with it\n           Workbooks(element).Close SaveChanges:=False\n       End If\n    'Next element\n\n'convert to table\n    samName = ActiveSheet.Range(\"A2\").Value\n    ActiveSheet.Name = samName &amp; \"_SCT_Data\"\n\n    'assumes col A is contiguous\n    lastrow = ActiveSheet.Range(\"A1\").End(xlDown).Row\n\n    ActiveSheet.ListObjects.Add(xlSrcRange, Range(\"$A1:$U\" &amp; lastrow), , xlYes).Name = \"SCT\"\n\n'build pivot\n    Dim objWs As Worksheet\n    Dim objPT As PivotTable\n    Dim objPC As PivotCache\n\n    Sheets.Add.Name = \"Summary\"\n    Set objWs = ActiveSheet\n\n    Set objPC = ActiveWorkbook.PivotCaches.Create(xlDatabase, \"SCT\")\n    Set objPT = objPC.CreatePivotTable(objWs.Range(\"A3\"), TableName:=\"SCTR\")\n\n    With ActiveSheet.PivotTables(\"SCTR\").PivotFields(\"Target_SC\")\n        .Orientation = xlColumnField\n        .Position = 1\n    End With\n    With ActiveSheet.PivotTables(\"SCTR\").PivotFields(\"Action\")\n        .Orientation = xlRowField\n    End With\n    ActiveSheet.PivotTables(\"SCTR\").AddDataField ActiveSheet.PivotTables( _\n        \"SCTR\").PivotFields(\"PNI_SC\"), \"Count of PNI_SC\", xlCount\n\n'have to do it in this order else vba was removing pni_sc from row field...who knows why\n    With ActiveSheet.PivotTables(\"SCTR\").PivotFields(\"PNI_SC\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n\n'--update sheet with last sync info\n    macroWb.Sheets(\"Summary\").Range(\"A1\").Value = samName\n    macroWb.Sheets(\"Summary\").Range(\"A3\").NumberFormat = \"h:mm dd/mm\"\n\n\n'save as new file\n    Dim timestamp As String\n    timestamp = Format(Now(), \"mmddhh\")\n\n    ActiveWorkbook.SaveAs Filename:= _\n        dirLocation &amp; samName &amp; \"_SCTR_\" &amp; timestamp &amp; \".xlsm\" _\n        , FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\n\n'exit msg\n    Application.StatusBar = False\n    Application.ScreenUpdating = True\n    MsgBox (\"Completed - saved file as \" &amp; dirLocation &amp; samName &amp; \"_SCTR_\" &amp; timestamp &amp; \".xlsm\")\n\n\nEnd Sub\n\nSub CopyWorkbook(source As String, target As String)\n\n\n'copy all sheets from one workbook to another\n\nDim sh As Worksheet, wb As Workbook\n\n   Set wb = Workbooks(target)\n   For Each sh In Workbooks(source).Worksheets\n      sh.Copy After:=wb.Sheets(wb.Sheets.Count)\n   Next sh\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "object"], "comments": [{"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1505287455, "post_id": 46190853, "comment_id": 79344781, "body": "No repro. Your code runs just fine at my end."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505289071, "post_id": 46190853, "comment_id": 79345780, "body": "Why is this tagged as [required]?  Tag description is &quot;Required is an HTML attribute of an input element that forces that the input be supplied.&quot; so do you believe that the error is related somehow to the use of that attribute???"}, {"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "edited": false, "score": 0, "creation_date": 1505291537, "post_id": 46190853, "comment_id": 79347340, "body": "<code>IE</code>has not finished loading I guess, check the value <code>IE.Document.Body</code>. Use <code>While </code>IE.busy OR IE.Readystate &lt;&gt; 4` after navigate. Skip the do loop, you already have the correct <code>IE</code>at beginning and this loop can get infinite if <code>Instr</code>condition don&#39;t get true."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1505299547, "post_id": 46190853, "comment_id": 79353166, "body": "Very simple: the div you select does not contain a <code>tbody</code>element, hence <code>.getElementsByTagName(&quot;tbody&quot;)</code> returns NULL."}, {"owner": {"reputation": 62, "user_id": 8599937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f42fcc5aeaa42de043320b7d61286824?s=128&d=identicon&r=PG&f=1", "display_name": "Samppa", "link": "https://stackoverflow.com/users/8599937/samppa"}, "edited": false, "score": 0, "creation_date": 1505373060, "post_id": 46190853, "comment_id": 79388284, "body": "The code worked once again for a while until it stopped. I did further research and the reason might be related to use of Internet Explorer. The code might try to open &quot;too many&quot; windows (or something like that) which causes the code to somehow stop. Currently I get an error on the 2nd line (Set IE = ...). Error msg: &quot;vba run time error&#39;-2147467259 (80004005)&#39;: automation error unspesified error&quot;. I switched to XML HttpRequest method and it seems to work. I only have problems with parsing the data. I added the code above as an edit."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1529851732, "creation_date": 1529851732, "answer_id": 51011005, "question_id": 46190853, "link": "https://stackoverflow.com/questions/46190853/vba-run-time-error-424-object-required-when-trying-to-web-scrape/51011005#51011005", "title": "VBA: Run-time error 424: Object required when trying to web scrape", "body": "<p>You can use a <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">css selector</a> of </p>\n\n<pre><code>#overviewQuickstatsDiv td.line.text\n</code></pre>\n\n<p>And then select the element at index 4</p>\n\n<p><code>#</code> means id. <code>.</code> = className.</p>\n\n<pre><code>Option Explicit\nPublic Sub XMLhttpRequestTest()\n    'Microsoft XML, v 6.0\n    'Microsoft HTML object library\n\n    Dim HTMLDoc As New HTMLDocument, ohttp As New MSXML2.XMLHTTP60\n\n    Const URL As String = \"http://www.morningstar.co.uk/uk/funds/snapshot/snapshot.aspx?id=F0GBR04BKW\"\n    Dim TRelements As Object, TRelement As Object\n\n    With ohttp\n        .Open \"GET\", URL, False\n        .send\n\n        HTMLDoc.body.innerHTML = .responseText\n        Debug.Print HTMLDoc.querySelectorAll(\"#overviewQuickstatsDiv td.line.text\")(4).innerText\n        'Your other stuff\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 62, "user_id": 8599937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f42fcc5aeaa42de043320b7d61286824?s=128&d=identicon&r=PG&f=1", "display_name": "Samppa", "link": "https://stackoverflow.com/users/8599937/samppa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 817, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529851732, "creation_date": 1505285901, "last_edit_date": 1505372952, "question_id": 46190853, "link": "https://stackoverflow.com/questions/46190853/vba-run-time-error-424-object-required-when-trying-to-web-scrape", "title": "VBA: Run-time error 424: Object required when trying to web scrape", "body": "<p>I'm trying to update various fund sizes using morgninstar.co.uk. The code worked fine until it suddenly stopped and gave an error:\n\"Run-time error 424: Object required\". \nThe exact line where the error occurs is:</p>\n\n<p><code>Set allData = IE.document.getElementById(\"overviewQuickstatsDiv\").getElementsByTagName(\"tbody\")(0)</code></p>\n\n<p>The idea is to ultimately scan the whole \"tbody\"-tag and look for the line \"Fund Size\" inside \"tr\" and \"td\"-tags. When \"Fund Size\" is found, the code would return the 3rd \"td\"-tag (actual fund size).\nAfter this I'd add a loop to loop through a list of funds that I've got.\nAs the code stopped working completely, I haven't got this far yet. Here I'm just trying to check if the code returns the actual fund size.\nSince there are not always 3 \"td\"-tags inside the \"tr\"-tags, I'll still have to construct some sort of IF-statement to fix that issue.</p>\n\n<p>But for now I'd just want to know how I could get the code running again? I've spent great deal of time searching for an answer but as it seems that this is a variable type problem the solution depends on the situation.</p>\n\n<p>I'm using Excel 2010 and Internet Explorer 11.</p>\n\n<p>URL in easy form to copy-paste:\n<a href=\"http://www.morningstar.co.uk/uk/funds/snapshot/snapshot.aspx?id=F0GBR04BKW\" rel=\"nofollow noreferrer\">http://www.morningstar.co.uk/uk/funds/snapshot/snapshot.aspx?id=F0GBR04BKW</a></p>\n\n<pre><code>Sub testToScrapeWholeTbodyTag()\n\n'Microsoft Internet Controls\n'Microsoft HTML Object Library\n'Microsoft Shell Controls and Automation\n\n\n'======Opens URL======\nDim IE As Object\nSet IE = CreateObject(\"internetexplorer.application\")\n\nWith IE\n    .navigate \"http://www.morningstar.co.uk/uk/funds/snapshot/snapshot.aspx?id=F0GBR04BKW\"\n    .Visible = False\nEnd With\n\nWhile IE.Busy\n    DoEvents\nWend\n\n\n'======Got from internet, fixed a previous error. However, I'm not 100% sure what this does======\nDim sh\nDim eachIE As Object\n\nDo\n    Set sh = New Shell32.Shell\n    For Each eachIE In sh.Windows\n        If InStr(1, eachIE.LocationURL, \"http://www.morningstar.co.uk/uk/funds/snapshot/snapshot.aspx?id=F0GBR04BKW\") Then\n            Set IE = eachIE\n            IE.Visible = False  '\"This is here because in some environments, the new process defaults to Visible.\"\n            Exit Do\n            End If\n        Next eachIE\n    Loop\nSet eachIE = Nothing\nSet sh = Nothing\n\n\n\n\n\n'======Looks for the \"Fund Size\"======\n'Trying to look for \"Fund Size\" inside \"tr\"-tag and if found, return the value in the 3rd \"tr\"-tag\nSet allData = IE.document.getElementById(\"overviewQuickstatsDiv\").getElementsByTagName(\"tbody\")(0) 'Run-time error 424: Object required\nrow1 = allData.getElementsByTagName(\"tr\")(5).Cells(0).innerHTML\nrow2 = allData.getElementsByTagName(\"tr\")(5).Cells(1).innerHTML\nrow3 = allData.getElementsByTagName(\"tr\")(5).Cells(2).innerHTML\n\n    If Left(row1, 9) = \"Fund Size\" Then\n        Worksheets(\"Sheet3\").Range(\"B3\") = Split(row3, \";\")(1)\n    End If\n\nDebug.Print allData.getElementsByTagName(\"tr\")(5).Cells(0).innerHTML '\"Fund Size\"\nDebug.Print allData.getElementsByTagName(\"tr\")(5).Cells(2).innerHTML 'Actual fund size\n\n\nIE.Quit\nSet IE = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT:</strong>\nSwitched method. Now the problem is to get the fund size extracted. So the below code works as it is but I'd need to add a couple of lines to get the fund size out of it. This is my first time using this method so it may well be that I've just not understood some really basic thing. Still, I wasn't able to find a solution to this on my own.</p>\n\n<pre><code>Sub XMLhttpRequestTest()\n\n'Microsoft XML, v 6.0\n'Microsoft HTML object library\n\nDim HTMLDoc As New HTMLDocument\nDim ohttp As New MSXML2.XMLHTTP60 \n\nDim myurl As String\nDim TRelements As Object\nDim TRelement As Object\n\nmyurl = \"http://www.morningstar.co.uk/uk/funds/snapshot/snapshot.aspx?id=F0GBR04BKW\"\nohttp.Open \"GET\", myurl, False\nohttp.send\n\n\nHTMLDoc.body.innerHTML = ohttp.responseText\n\nWith HTMLDoc.body\n    Set TRelements = .getElementsByTagName(\"tr\")\n\n    For Each TRelement In TRelements\n        Debug.Print TRelement.innerText\n    Next\n\nEnd With\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "cmd", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505289792, "post_id": 46190469, "comment_id": 79346201, "body": "We really won&#39;t be able to give much help if you don&#39;t include in the question the two procedures (<code>UpdateItem</code> and <code>DownloadFileAPI</code>) that you say you believe are the likely culprits causing the problem."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505289830, "post_id": 46190469, "comment_id": 79346226, "body": "And is the use of <code>DOWNLOAD_A</code> in the question, and <code>DOWLOAD_A</code> in the code a typo?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505290052, "post_id": 46190469, "comment_id": 79346378, "body": "DONWLOAD_A was a typo. I didn&#39;t want to use the actual names as they were to telling. I will add <code>UpdateItem</code> so you can see the code.  <code>DownloadFileAPI</code> though is simply the procedure that it needs to execute. I have checked that the procedure finishes the way it should, which is why I didn&#39;t include it here, so as not to cluter up the question."}, {"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 0, "creation_date": 1505299547, "post_id": 46190469, "comment_id": 79353169, "body": "Add a msgbox after <code>Call DownloadFileApi</code> and open the sheet. See if the msgbox pop&#39;s up"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 0, "creation_date": 1505308229, "post_id": 46190469, "comment_id": 79359460, "body": "@Moacir I have added a MsgBox. It poped up fine. I then tested adding two more MsgBox in the same workbook after each step and saw that in fact the called workbook closes! I then attempted adding one in the calling workbook directly after <code>UpdateItem</code> and that didn&#39;t show up."}], "answers": [{"tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": true, "score": 0, "last_activity_date": 1505735611, "creation_date": 1505735611, "answer_id": 46278636, "question_id": 46190469, "link": "https://stackoverflow.com/questions/46190469/workbook-opened-by-shell-wont-close-how-can-i-debugg-this-further/46278636#46278636", "title": "Workbook opened by shell won&#39;t close. How can I debugg this further?", "body": "<p>The problem was caused by an add-in (Thomson Reuters EIKON). It could only be resolved by completely removing the COM add-in from Excel.</p>\n\n<p>I was able to resolved the issue together with a colleague. The question of how I could have further debugged this is probably best answered remains. </p>\n\n<p>I'll take a stab at it though, and say, I should have continued to strip away other code that also ran ontop of excel, until reaching a completely prestine Excel Version.</p>\n"}], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 46278636, "answer_count": 1, "score": -1, "last_activity_date": 1618147650, "creation_date": 1505284662, "last_edit_date": 1618147650, "question_id": 46190469, "link": "https://stackoverflow.com/questions/46190469/workbook-opened-by-shell-wont-close-how-can-i-debugg-this-further", "title": "Workbook opened by shell won&#39;t close. How can I debugg this further?", "body": "<p>I have an application that is opened overnight by a batch job. The Workbook_Open event triggers a series of other workbooks to be updated using this code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>arrUpdateList = Array(DOWNLOAD_A, _\n                      TRDUPDATE, _\n                      CITUPDATE, _\n                      FVUPDATE, _\n                      FSUPDATE)\n\nThisWorkbook.Worksheets(&quot;Start&quot;).Activate\n\nFor i = LBound(arrUpdateList) To UBound(arrUpdateList)\n    Call UpdateItem(arrUpdateList(i))\n    Stop\nNext i\n</code></pre>\n<p>Note: the variables in the array are simply file paths to excel documents.</p>\n<p>Since approx. a week ago <strong>the process gets hung up because the first workbook that is opened doesn't close itself anymore</strong>. The first workbook (DOWNLOAD_A) contains the following code in its Workbook_Open event, which if i open the file manually, works perfectly.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Workbook_Open()\n\n    Call DownloadFileAPI\n    \n    DoEvents\n    \n    Application.DisplayAlerts = False\n    Application.Quit\n\nEnd Sub\n</code></pre>\n<p>How can I fix this problem? I have only been able to narrow the problem down to the fact that somehow excel doesn't close the workbook, because it either goes into an infinite loop, or the calling application somehow looses the reference. <strong>What can I do to further debug this?</strong></p>\n<p>For completeness's sake, here is the code in the calling workbook (the one being called up by the batchjob to kick off the process):</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Type STARTUPINFO\n    cb As Long\n    lpReserved As String\n    lpDesktop As String\n    lpTitle As String\n    dwX As Long\n    dwY As Long\n    dwXSize As Long\n    dwYSize As Long\n    dwXCountChars As Long\n    dwYCountChars As Long\n    dwFillAttribute As Long\n    dwFlags As Long\n    wShowWindow As Integer\n    cbReserved2 As Integer\n    lpReserved2 As Long\n    hStdInput As Long\n    hStdOutput As Long\n    hStdError As Long\nEnd Type\n\nPrivate Type PROCESS_INFORMATION\n   hProcess As Long\n   hThread As Long\n   dwProcessID As Long\n   dwThreadID As Long\nEnd Type\n\nPrivate Declare Function WaitForSingleObject Lib &quot;kernel32&quot; (ByVal _\n   hHandle As Long, ByVal dwMilliseconds As Long) As Long\n\nPrivate Declare Function CreateProcessA Lib &quot;kernel32&quot; (ByVal _\n   lpApplicationName As String, ByVal lpCommandLine As String, ByVal _\n   lpProcessAttributes As Long, ByVal lpThreadAttributes As Long, _\n   ByVal bInheritHandles As Long, ByVal dwCreationFlags As Long, _\n   ByVal lpEnvironment As Long, ByVal lpCurrentDirectory As String, _\n   lpStartupInfo As STARTUPINFO, lpProcessInformation As _\n   PROCESS_INFORMATION) As Long\n\nPrivate Declare Function CloseHandle Lib &quot;kernel32&quot; _\n   (ByVal hObject As Long) As Long\n\nPrivate Declare Function GetExitCodeProcess Lib &quot;kernel32&quot; _\n   (ByVal hProcess As Long, lpExitCode As Long) As Long\n\nPrivate Const NORMAL_PRIORITY_CLASS = &amp;H20&amp;\nPrivate Const INFINITE = -1&amp;\n\nPublic Function ExecCmd(cmdline$)\n\nDim proc As PROCESS_INFORMATION\nDim start As STARTUPINFO\nDim ret&amp;\n\n   ' Initialize the STARTUPINFO structure:\n   start.cb = Len(start)\n\n   ' Start the shelled application:\n   ret&amp; = CreateProcessA(vbNullString, cmdline$, 0&amp;, 0&amp;, 1&amp;, _\n      NORMAL_PRIORITY_CLASS, 0&amp;, vbNullString, start, proc)\n\n   'Shelled application needs to have an applicatin.quit command to close itself\n    \n   ' Wait for the shelled application to finish:\n      ret&amp; = WaitForSingleObject(proc.hProcess, INFINITE)\n      Call GetExitCodeProcess(proc.hProcess, ret&amp;)\n      Call CloseHandle(proc.hThread)\n      Call CloseHandle(proc.hProcess)\n      ExecCmd = ret&amp;\n      \nEnd Function\n</code></pre>\n<p>As requested the other relevant procedures:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub UpdateItem(ByVal sItem As String)\nDim arr         As Variant\nDim retval      As Long\nDim CurrentDay  As String\n\nCurrentDay = DateValue(Now()) &amp; &quot; &quot;\n\n'Arr is split to check if there is a time value transferred\narr = Split(sItem, &quot;|&quot;)\n\n    If UBound(arr) &gt; 0 Then\n        'CDate converts the date time into a date; then if the time of the same day has already\n        'expired, there will be no wait. If the date time is still to come, the process will wait\n        Application.Wait CDate(CurrentDay &amp; arr(1))\n    End If\n\n    'Log start\n    Call Writelog(&quot;Start: &quot; &amp; arr(0))\n\n        'Start process with shellwait (what if error occurs?)\n        retval = ExecCmd(&quot;excel.exe &quot; &amp; arr(0))\n        \n        DoEvents\n\n    'Log end\n    Call Writelog(&quot;End: &quot; &amp; arr(0))\n\nErase arr\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 1, "creation_date": 1505285318, "post_id": 46190222, "comment_id": 79343391, "body": "The problem is that you are not referencing the <code>Sheet</code> from which you want to copy. Try using <code>sht1.SpecialCells(xlCellTypeVisible).Copy</code> or  <code>wb1.Sheets(&quot;Sheet1&quot;).SpecialCells(xlCellTypeVisible).Copy</code>"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1505286380, "creation_date": 1505286380, "answer_id": 46190998, "question_id": 46190222, "link": "https://stackoverflow.com/questions/46190222/error-438-object-doesnt-support-this-property-filtered-table-copy-and-paste/46190998#46190998", "title": "error 438 Object doesn&#39;t support this property filtered table copy and paste", "body": "<p>You already <code>Set</code> all the <code>Worobook</code> and <code>Worksheet</code> object in the begining of your code, so you can just use these objects. Like, <code>Sht1</code> <code>Sht2</code> etc...</p>\n\n<p>You can use <code>ListObject</code> to set your Table.</p>\n\n<p><strong>Note</strong>: your error comes because you are missing the <code>Worksheet</code> object in your copy line:</p>\n\n<pre><code>wb1.Range(\"AA2:AI222\").SpecialCells(xlCellTypeVisible).Copy\n</code></pre>\n\n<p>(as mentioned by @Jean-Pierre Oosthuizen commnet above)</p>\n\n<p>See slightly modifed code below:</p>\n\n<pre><code>Dim LastRow As Long\nDim Tbl1 As ListObject\n\nSet Sht1 = wb1.Sheets(\"Sheet1\")\nSet Sht2 = wb2.Sheets(\"Ha\")\nWith Sht1\n    If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n        LastRow = .Cells.Find(What:=\"*\", _\n        After:=.Range(\"AA2\"), _\n        Lookat:=xlPart, _\n        LookIn:=xlFormulas, _\n        SearchOrder:=xlByRows, _\n        SearchDirection:=xlPrevious, _\n        MatchCase:=False).Row\n    Else\n        LastRow = 1\n    End If\nEnd With\n\nSht1.Range(\"AA2\").Select\nSet Tbl1 = Sht1.ListObjects.Add(xlSrcRange, , xlYes)  ' &lt;-- use ListObject to Set the Table\n\nWith Tbl1\n    .Name = \"Table1\"\n    .Range.AutoFilter Field:=9, Criteria1:= _\n            \"&gt;=-1000000000000\", Operator:=xlAnd, Criteria2:=\"&lt;=1000000000000000\"\nEnd With\n\nApplication.DisplayAlerts = True\n\n' Copy &gt;&gt; Paste in 1 line\nSht1.Range(\"AA2:AI222\").SpecialCells(xlCellTypeVisible).Copy Destination:=Sht2.Range(\"AA2\")\n\nwb2.SaveAs Filename:=\"C:\\Ha.csv\", FileFormat:=xlCSV, CreateBackup:=False\nwb2.Close SaveChanges:=False\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8528838"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "accepted_answer_id": 46190998, "answer_count": 1, "score": 0, "last_activity_date": 1505286380, "creation_date": 1505283854, "last_edit_date": 1505285723, "question_id": 46190222, "link": "https://stackoverflow.com/questions/46190222/error-438-object-doesnt-support-this-property-filtered-table-copy-and-paste", "title": "error 438 Object doesn&#39;t support this property filtered table copy and paste", "body": "<p>I keep getting error 438  Object doesn't support this property.</p>\n\n<p>For: <code>wb1.SpecialCells(xlCellTypeVisible).Copy</code></p>\n\n<p>I am trying to filter a table and copy paste it into a new CSV.  I have declared the workbook. I have also tried sht2.Specialcells as well as \n  <code>wb1.Range(\"AA2:AI222\").SpecialCells(xlCellTypeVisible).Copy</code>  </p>\n\n<p>My full code is below:</p>\n\n<pre><code>' Filtered Table\nSub Auto_close13()\n'\n' Macro2 Macro\n'\nDim wb1 As Excel.Workbook\nDim wb2 As Excel.Workbook\nSet wb2 = Workbooks.Open(\"C:\\Ha.csv\")\nSet wb1 = Workbooks.Open(\"C:\\1zzThe Betting System.xlsm\")\n\nDim sht1 As Worksheet\nDim sht2 As Worksheet\nDim copyRange As Range\n\nSet sht1 = wb1.Sheets(\"Sheet1\")\nSet sht2 = wb2.Sheets(\"Ha\")\n\nWith wb1.Sheets(\"Sheet1\")\n    Range(\"AA2\").Select\n    If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n        lastRow = .Cells.Find(What:=\"*\", _\n        After:=.Range(\"AA2\"), _\n        Lookat:=xlPart, _\n        LookIn:=xlFormulas, _\n        SearchOrder:=xlByRows, _\n        SearchDirection:=xlPrevious, _\n        MatchCase:=False).Row\n    Else\n        lastRow = 1\n    End If\nEnd With\n\n''Workbooks(\"1zzThe Betting System.xlsm\").Activate\n''sht1.Activate\nsht1.Range(\"AA2\").Select\nsht1.ListObjects.Add(xlSrcRange, , xlYes).Name = _\n\"Table1\"\nsht1.Range(\"Table1[#All]\").Select\nsht1.ListObjects(\"Table1\").Range.AutoFilter Field:=9, Criteria1:= _\n    \"&gt;=-1000000000000\", Operator:=xlAnd, Criteria2:=\"&lt;=1000000000000000\"\n\n''sht1.Activate\nApplication.DisplayAlerts = True\nwb1.Range(\"AA2:AI222\").SpecialCells(xlCellTypeVisible).Copy\nApplication.DisplayAlerts = True\nSet wb2 = Workbooks.Open(\"C:\\Ha.csv\")\nApplication.DisplayAlerts = True\nwb2.Sheets(\"Ha\").Paste\nwb2.SaveAs Filename:= _\n\"C:\\Ha.csv\", FileFormat:= _\nxlCSV, CreateBackup:=False\n\nWorkbooks(\"Ha.csv\").Close\n''wb1.Close\n\nEnd Sub  \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1505284988, "post_id": 46190220, "comment_id": 79343190, "body": "No, that&#39;s not possible unless you want to make use of a <a href=\"https://stackoverflow.com/a/16860597/1153513\">modeless</a> and possibly invisible <code>userform</code>. You can only store values in your sheets (and hide them if you want). Cells can be used as a named range and then you could refer to them using <code>=foo</code>. Yet, the value would have to be in a cell (again)."}, {"owner": {"reputation": 710, "user_id": 7636035, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QWgbB9_NIBc/AAAAAAAAAAI/AAAAAAAAZS4/HFMS7E9VfBw/photo.jpg?sz=128", "display_name": "Sergi Nadal", "link": "https://stackoverflow.com/users/7636035/sergi-nadal"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1505285478, "post_id": 46190220, "comment_id": 79343496, "body": "Ok. Thank you very much!"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1505287039, "post_id": 46190220, "comment_id": 79344483, "body": "Well you kinda can. If you create a <code>Public</code> UDF in a module, you can then call this UDF from your cell just like any other built in function call... i.e. lets say you have a UDF called <code>GetFoo</code> in your module. In your cell just type <code>=GetFoo()</code> and your cell will show the value returned by your UDF. Problem you have is that this is only triggered when you initially call the function. If you then go and change the returned value in <code>GetFoo</code>, cell doesn&#39;t get updated unless you trigger it again"}], "answers": [{"comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1505287188, "post_id": 46191187, "comment_id": 79344583, "body": ":) great minds and all that. Problem still is that these UDF&#39;s have to triggered to update values after the initial call"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1505290817, "post_id": 46191187, "comment_id": 79346865, "body": "You can set the function to be <code>Volatile</code> so that it is calculated every time calculations are performed.  (Or sometimes I pass a dummy variable of <code>Now()</code> to the function to achieve the same thing - so <code>=Foo(Now())</code> as the formula, and <code>Public Function Foo(d As Date) As Integer</code> as the procedure declaration.  [I usually only do this if I am too lazy to write proper code, e.g. a quick-and-nasty one-off task.])"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1505293038, "post_id": 46191187, "comment_id": 79348336, "body": "While this is certainly a feasible solution to the question I still feel compelled to point out that <a href=\"https://msdn.microsoft.com/en-us/library/office/bb687891.aspx#sectionSection2\" rel=\"nofollow noreferrer\">volatile UDFs</a> can severely reduce the performance of your Excel file. Furthermore, you might want to read through this post: <a href=\"https://stackoverflow.com/questions/24353506/non-volatile-udf-always-recalculating\" title=\"non volatile udf always recalculating\">stackoverflow.com/questions/24353506/&hellip;</a>"}], "tags": [], "owner": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "is_accepted": true, "score": 2, "last_activity_date": 1505287013, "creation_date": 1505287013, "answer_id": 46191187, "question_id": 46190220, "link": "https://stackoverflow.com/questions/46190220/declare-vba-variable-and-use-it-in-a-worksheet-in-excel/46191187#46191187", "title": "Declare VBA variable and use it in a worksheet in Excel", "body": "<p>You can declare public function in a code module</p>\n\n<pre><code>Public Function Foo() As Integer\n  Foo = 2\nEnd Function\n</code></pre>\n\n<p>and use it in a cell</p>\n\n<pre><code>=Foo()\n</code></pre>\n"}], "owner": {"reputation": 710, "user_id": 7636035, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QWgbB9_NIBc/AAAAAAAAAAI/AAAAAAAAZS4/HFMS7E9VfBw/photo.jpg?sz=128", "display_name": "Sergi Nadal", "link": "https://stackoverflow.com/users/7636035/sergi-nadal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 0, "accepted_answer_id": 46191187, "answer_count": 1, "score": 1, "last_activity_date": 1505287013, "creation_date": 1505283850, "last_edit_date": 1531161705, "question_id": 46190220, "link": "https://stackoverflow.com/questions/46190220/declare-vba-variable-and-use-it-in-a-worksheet-in-excel", "title": "Declare VBA variable and use it in a worksheet in Excel", "body": "<p>I want to declare a variable in vba code of an Excel document and use it in a cell.</p>\n\n<p>Something like this:</p>\n\n<p><strong>Vba Code:</strong></p>\n\n<pre><code>Dim foo as Integer\nfoo = 2\n</code></pre>\n\n<p><strong>Excel Cell (any)</strong></p>\n\n<pre><code>=foo\n</code></pre>\n\n<p>Is that possible?</p>\n"}, {"tags": ["vba", "excel", "date", "datetime"], "answers": [{"tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1505284425, "creation_date": 1505284425, "answer_id": 46190401, "question_id": 46189831, "link": "https://stackoverflow.com/questions/46189831/changing-column-of-date-values-from-yyyymmdd-to-mm-dd-yyyy-in-vba/46190401#46190401", "title": "Changing column of date values from YYYYMMDD to MM/DD/YYYY in VBA", "body": "<p>How about a custom function?</p>\n\n<pre><code>Public Function ToDate(ByVal s As String) As Date\n    ToDate = DateValue(Right(s, 2) &amp; \"/\" &amp; Mid(s, 5, 2) &amp; \"/\" &amp; Left(s, 4))\nEnd Function\n</code></pre>\n\n<p>To call it:</p>\n\n<pre><code>Dim d As Date\n    d = ToDate(\"20160812\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 8540592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-1xYxoC7KMW0/AAAAAAAAAAI/AAAAAAAAABg/pLIMFPu4TGU/photo.jpg?sz=128", "display_name": "Hermes Omar Gomez", "link": "https://stackoverflow.com/users/8540592/hermes-omar-gomez"}, "is_accepted": true, "score": 0, "last_activity_date": 1505285738, "last_edit_date": 1505285738, "creation_date": 1505285370, "answer_id": 46190680, "question_id": 46189831, "link": "https://stackoverflow.com/questions/46189831/changing-column-of-date-values-from-yyyymmdd-to-mm-dd-yyyy-in-vba/46190680#46190680", "title": "Changing column of date values from YYYYMMDD to MM/DD/YYYY in VBA", "body": "<p>I Figured it out guys! Decided to move the new values to a new Column \"Q\" since running the code multiple times would ruin the data:</p>\n\n<pre><code>With inputWS2\nFor i = 2 To LastRowGeovera\n    Y = Left(.Cells(i, \"G\").Value, 4)\n    M = Mid(.Cells(i, \"G\").Value, 5, 2)\n    D = Right(.Cells(i, \"G\").Value, 2)\n    .Cells(i, \"Q\") = M &amp; \"/\" &amp; D &amp; \"/\" &amp; Y\n\nNext i\nEnd With\n\ninputWS2.Columns(\"Q\").NumberFormat = \"mm/dd/yyyy\"\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 8540592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-1xYxoC7KMW0/AAAAAAAAAAI/AAAAAAAAABg/pLIMFPu4TGU/photo.jpg?sz=128", "display_name": "Hermes Omar Gomez", "link": "https://stackoverflow.com/users/8540592/hermes-omar-gomez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 46190680, "answer_count": 2, "score": 0, "last_activity_date": 1505285738, "creation_date": 1505282073, "question_id": 46189831, "link": "https://stackoverflow.com/questions/46189831/changing-column-of-date-values-from-yyyymmdd-to-mm-dd-yyyy-in-vba", "title": "Changing column of date values from YYYYMMDD to MM/DD/YYYY in VBA", "body": "<p>I have a range of date values for one sheet that show date values as 20160812. Im looking for the values to show as 08/12/2016 instead. </p>\n\n<p>This is the code i have currently:</p>\n\n<pre><code>Private Sub Update_Click()\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nDim path As String, fileName As String\nDim lastRowUniversal As Long, lastRowOutput As Long, rowCntr As Long, lastColumn As Long\nDim inputWS1 As Worksheet, inputWS2 As Worksheet, inputWS3 As Worksheet, outputWS As Worksheet\n\n\n\nConst dtFORM As String = \"=IF(ISNUMBER(J4:J&lt;r&gt;),DATE(YEAR(J4:J&lt;r&gt;)-1,\" &amp; \"MONTH(J4:J&lt;r&gt;),DAY(J4:J&lt;r&gt;)),J4:J&lt;r&gt;)\"\n\n\n\n'set your sheets here\nSet inputWS1 = ThisWorkbook.Sheets(\"Universal\")\nSet inputWS2 = ThisWorkbook.Sheets(\"Geovera\")\nSet inputWS3 = ThisWorkbook.Sheets(\"Citizens\")\nSet outputWS = ThisWorkbook.Sheets(\"Carriers\")\n\n\n    'get last rows from both sheets\nlastRowUniversal = inputWS1.Cells(Rows.Count, \"A\").End(xlUp).Row\nLastRowCitizens = inputWS3.Cells(Rows.Count, \"A\").End(xlUp).Row\nlastRowGeovera = inputWS2.Cells(Rows.Count, \"A\").End(xlUp).Row\nLastRowPolicy = outputWS.Cells(Rows.Count, \"B\").End(xlUp).Row\nlastRowOutput = outputWS.Cells(Rows.Count, \"A\").End(xlUp).Row\nlastColumn = inputWS1.Cells(1, Columns.Count).End(xlToLeft).Column\n\n\n    'get last rows from both sheets\nlastRowUniversal = inputWS1.Cells(Rows.Count, \"A\").End(xlUp).Row\nLastRowCitizens = inputWS3.Cells(Rows.Count, \"A\").End(xlUp).Row\nlastRowGeovera = inputWS2.Cells(Rows.Count, \"A\").End(xlUp).Row\nLastRowPolicy = outputWS.Cells(Rows.Count, \"B\").End(xlUp).Row\nlastRowOutput = outputWS.Cells(Rows.Count, \"A\").End(xlUp).Row\nlastColumn = inputWS1.Cells(1, Columns.Count).End(xlToLeft).Column\n\nrowCntr = 1\n\n'get last rows from both sheets\nlastRowUniversal = inputWS1.Cells(Rows.Count, \"A\").End(xlUp).Row\nLastRowCitizens = inputWS3.Cells(Rows.Count, \"A\").End(xlUp).Row\nlastRowGeovera = inputWS2.Cells(Rows.Count, \"A\").End(xlUp).Row\nLastRowPolicy = outputWS.Cells(Rows.Count, \"B\").End(xlUp).Row\nlastRowOutput = outputWS.Cells(Rows.Count, \"A\").End(xlUp).Row\nlastColumn = inputWS1.Cells(1, Columns.Count).End(xlToLeft).Column\n\n'Universal\ninputWS1.Range(\"A4:A\" &amp; lastRowUniversal).Copy outputWS.Range(\"B2\")\ninputWS1.Range(\"B4:B\" &amp; lastRowUniversal).Copy outputWS.Range(\"C2\")\ninputWS1.Range(\"N4:N\" &amp; lastRowUniversal).Value = inputWS1.Name\ninputWS1.Range(\"N4:N\" &amp; lastRowUniversal).Copy outputWS.Range(\"E2\")\ninputWS1.Range(\"L4:L\" &amp; lastRowUniversal).Value = inputWS1.Evaluate(Replace(dtFORM, \"&lt;r&gt;\", lastRowUniversal))\ninputWS1.Range(\"L4:L\" &amp; lastRowUniversal).Copy outputWS.Range(\"G2\")\ninputWS1.Range(\"G4:G\" &amp; lastRowUniversal).Copy outputWS.Range(\"H2\")\n\n'Geovera\n\ninputWS2.Range(\"F2:F\" &amp; lastRowGeovera).Copy outputWS.Range(\"B\" &amp; lastRowUniversal - 1)\ninputWS2.Range(\"I2:I\" &amp; lastRowGeovera).Copy outputWS.Range(\"C\" &amp; lastRowUniversal - 1)\ninputWS2.Range(\"P2:P\" &amp; lastRowGeovera).Value = inputWS2.Name\ninputWS2.Range(\"P2:P\" &amp; lastRowGeovera).Copy outputWS.Range(\"E\" &amp; lastRowUniversal - 1)\ninputWS2.Range(\"N2:N\" &amp; lastRowGeovera).Copy outputWS.Range(\"H\" &amp; lastRowUniversal - 1)\ninputWS2.Range(\"G2:G\" &amp; lastRowGeovera).Copy outputWS.Range(\"G\" &amp; lastRowUniversal - 1)\n\n'Citizens\ninputWS3.Range(\"D2:D\" &amp; LastRowCitizens).Copy inputWS3.Range(\"N2:N\" &amp; LastRowCitizens)\ninputWS3.Range(\"B2:B\" &amp; LastRowCitizens).Copy outputWS.Range(\"C\" &amp; lastRowGeovera + (lastRowUniversal - 2))\ninputWS3.Range(\"M2:M\" &amp; LastRowCitizens).Value = inputWS3.Name\ninputWS3.Range(\"M2:M\" &amp; LastRowCitizens).Copy outputWS.Range(\"E\" &amp; lastRowGeovera + (lastRowUniversal - 2))\ninputWS3.Range(\"E2:E\" &amp; LastRowCitizens).Copy outputWS.Range(\"G\" &amp; lastRowGeovera + (lastRowUniversal - 2))\ninputWS3.Range(\"J2:J\" &amp; LastRowCitizens).Copy outputWS.Range(\"H\" &amp; lastRowGeovera + (lastRowUniversal - 2))\n\ninputWS3.Columns(\"N\").NumberFormat = \"@\"\n\nWith inputWS3\nFor i = 2 To LastRowCitizens\n    .Cells(i, \"N\") = Left(.Cells(i, \"N\").Value, 8)\nNext i\n\n\nEnd With\n\ninputWS3.Range(\"N2:N\" &amp; LastRowCitizens).Copy outputWS.Range(\"B\" &amp; lastRowGeovera + (lastRowUniversal - 2))\n\n'Formatting\n\n\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>The line im looking to fix is :\n    inputWS2.Range(\"G2:G\" &amp; lastRowGeovera).Copy outputWS.Range(\"G\" &amp; lastRowUniversal - 1)</p>\n\n<p>The range G2:G has the date values that i need to change to MM/DD/YYYY date format.</p>\n\n<p>How can i achive this before copying to outputWS ?</p>\n"}, {"tags": ["vba", "excel", "autofilter"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1505282942, "post_id": 46189347, "comment_id": 79342106, "body": "Your code is (sorry, but that I have to tell you that) almost unreadable and I highly recommend you to avoid <code>.Select</code>, <code>.Activate</code>, <code>ActiveSheet</code> and <code>.Selection</code>. If you google how to avoid them you will find many tutorials. <b>Avoiding them all should be your very first task to get a code that is maintainable, so issues can be avoided and it is much easier to find errors in your code.</b> This will probably reduce your code to the half or less."}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1505291384, "creation_date": 1505291384, "answer_id": 46192606, "question_id": 46189347, "link": "https://stackoverflow.com/questions/46189347/vba-autofilter-with-criteria-as-a-cell-in-a-differant-worksheet-getting-runtim/46192606#46192606", "title": "VBA Autofilter with criteria as a cell in a differant worksheet. Getting &quot;runtime error 9&quot;", "body": "<p>As Peh says, this is pretty much unreadable. From your question though, I think your problem refers to setting the criteria to <code>i</code>? If so, try changing</p>\n\n<pre><code>i = Sheets(\"Summary\").Range(\"i2\")\n</code></pre>\n\n<p>to</p>\n\n<pre><code>i = Sheets(\"Summary\").Range(\"i2\").Value\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8601165, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212544599622794/picture?type=large", "display_name": "Jason Nayman", "link": "https://stackoverflow.com/users/8601165/jason-nayman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505291384, "creation_date": 1505279774, "last_edit_date": 1505282761, "question_id": 46189347, "link": "https://stackoverflow.com/questions/46189347/vba-autofilter-with-criteria-as-a-cell-in-a-differant-worksheet-getting-runtim", "title": "VBA Autofilter with criteria as a cell in a differant worksheet. Getting &quot;runtime error 9&quot;", "body": "<p>I'm work on this project where I have a summary sheet and a data sheet where I want to drop in raw data from a separate report weekly into the data sheet and filter through what I need and copies to the summary sheet.</p>\n\n<p>The start of the code is simply clearing out the cells for a new run each time. The problem I'm having is the one autofilter criteria that is a cell value from the summary sheet. It is a drop down box with that will when changed, copy different data to the summary sheet. Here is my code. Thanks for any advice in advance!</p>\n\n<pre><code>Sub Macro3()\n    Sheets(\"Summary\").Select\n    Range(\"C5\").Select\n    Selection.ClearContents\n    Range(\"C6\").Select\n    Selection.ClearContents\n    Range(\"C10\").Select\n    Selection.ClearContents\n    Range(\"C11\").Select\n    Selection.ClearContents\n    Range(\"C16\").Select\n    Selection.ClearContents\n    Range(\"C17\").Select\n    Selection.ClearContents\n    Range(\"C21\").Select\n    Selection.ClearContents\n    Range(\"C22\").Select\n    Selection.ClearContents\n    Range(\"F11\").Select\n    Selection.ClearContents\n    Range(\"F10\").Select\n    Selection.ClearContents\n    Range(\"F6\").Select\n    Selection.ClearContents\n    Range(\"F5\").Select\n    Selection.ClearContents\n\n    Sheets(\"Data\").Select\n\n    Range(\"K200000\").Select\n    Selection.ClearContents\n    Range(\"J200000\").Select\n    Selection.ClearContents\n\n    i = Sheets(\"Summary\").Range(\"i2\")\n\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=13, Criteria1:=i\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=7, Criteria1:=\"&lt;&gt;\"\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=11, Criteria1:=\"&lt;&gt;0\"\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=15, Criteria1:=i\n    Range(\"K200000\").Select\n    ActiveCell.FormulaR1C1 = \"=SUBTOTAL(9,R[-199996]C:R[-1]C)\"\n    Range(\"J200000\").Select\n    ActiveCell.FormulaR1C1 = \"=SUBTOTAL(2,R[-199996]C:R[-1]C)\"\n    Selection.NumberFormat = \"#,##0.0\"\n    Selection.NumberFormat = \"#,##0\"\n    Selection.Copy\n    Sheets(\"Summary\").Select\n    Range(\"C5\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Sheets(\"Data\").Select\n    Range(\"k200000\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Summary\").Select\n    Range(\"C10\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Sheets(\"Data\").Select\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=15, Criteria1:=\"&lt;&gt;\" &amp; i\n    Range(\"j200000\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Summary\").Select\n    Range(\"C6\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Sheets(\"Data\").Select\n    Range(\"k200000\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Summary\").Select\n    Range(\"C11\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Sheets(\"Data\").Select\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=7\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=11\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=15\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=12, Criteria1:= _\n        \"&lt;&gt;\"\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=15, Criteria1:=i\n    Range(\"j200000\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Summary\").Select\n    Range(\"C16\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Sheets(\"Data\").Select\n    Range(\"k200000\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Summary\").Select\n    Range(\"C21\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Sheets(\"Data\").Select\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=15, Criteria1:=\"&lt;&gt;\" &amp; i\n    Range(\"j200000\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Summary\").Select\n    Range(\"C17\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Sheets(\"Data\").Select\n    Range(\"k200000\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Summary\").Select\n    Range(\"C22\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Sheets(\"Data\").Select\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=12\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=15\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=4, Criteria1:=\"&lt;&gt;0\"\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=15, Criteria1:=i\n    Range(\"j200000\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Summary\").Select\n    Range(\"F5\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Sheets(\"Data\").Select\n    Range(\"k200000\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Summary\").Select\n    Range(\"F10\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Sheets(\"Data\").Select\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=15, Criteria1:=\"&lt;&gt;\" &amp; i\n\n    Range(\"j200000\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Summary\").Select\n    Range(\"F6\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Sheets(\"Data\").Select\n    Range(\"k200000\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Summary\").Select\n    Range(\"F11\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Sheets(\"Data\").Select\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=13\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=4\n    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=15\n    Sheets(\"Summary\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 118, "user_id": 6582616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e2e82179df344624bc3c7ee7484de1?s=128&d=identicon&r=PG&f=1", "display_name": "Busy", "link": "https://stackoverflow.com/users/6582616/busy"}, "edited": false, "score": 0, "creation_date": 1505280705, "post_id": 46189083, "comment_id": 79341225, "body": "Might this, in any way, be useful?:: <a href=\"https://stackoverflow.com/questions/3166265/open-an-html-page-in-default-browser-with-vba\" title=\"open an html page in default browser with vba\">stackoverflow.com/questions/3166265/&hellip;</a>"}, {"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "edited": false, "score": 0, "creation_date": 1505283078, "post_id": 46189083, "comment_id": 79342165, "body": "Try <code>Selection.Hyperlinks(1).Follow</code>. Use the marco recorder to get hints for coding."}, {"owner": {"reputation": 335, "user_id": 3034646, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/24a37750f80276c8f292af0555cec9f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy T", "link": "https://stackoverflow.com/users/3034646/jimmy-t"}, "edited": false, "score": 0, "creation_date": 1505284407, "post_id": 46189083, "comment_id": 79342835, "body": "Both of the above comments are strictly only for hyperlinks. I&#39;m more interested in bookmarks (but since Ctrl+click by default works for both, I mentioned both)."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1505284481, "post_id": 46189083, "comment_id": 79342875, "body": "What, exactly, do you wish to accomplish? Select a hyperlink, run the macro, and then what? Logically, the selection should change to the destination of the hyperlink. So, you want another action (how to trigger?) to return the selection to where you came from? Is that your intention?"}, {"owner": {"reputation": 335, "user_id": 3034646, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/24a37750f80276c8f292af0555cec9f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy T", "link": "https://stackoverflow.com/users/3034646/jimmy-t"}, "edited": false, "score": 0, "creation_date": 1505287604, "post_id": 46189083, "comment_id": 79344866, "body": "I want to follow a bookmark link and be able to use Ctrl+&lt; to navigate back to where I was before. Really I just want to bind Ctrl+click to a different button on the keyboard, but since that seems impossible, I want to try and replicate the Ctrl+click behaviour. Following a bookmark link as I mentioned in my post was not enough because I couldnt Ctrl+&lt; back to the previous spot, so I&#39;m obviously missing something."}, {"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "edited": false, "score": 0, "creation_date": 1505289833, "post_id": 46189083, "comment_id": 79346228, "body": "Seems like you can create <a href=\"https://support.office.com/en-us/article/Customize-keyboard-shortcuts-9a92343e-a781-4d5a-92f1-0f32e3ba5b4d\" rel=\"nofollow noreferrer\">shortcuts</a>. If you create one for follow bookmark and one for back you should be able to store position on follow and restore it on back."}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1505294817, "creation_date": 1505294817, "answer_id": 46193722, "question_id": 46189083, "link": "https://stackoverflow.com/questions/46189083/vba-macro-for-simulating-ctrlclick-on-a-bookmark-hyperlink/46193722#46193722", "title": "VBA macro for simulating Ctrl+click on a bookmark/hyperlink", "body": "<p>The following code should do what you want. Install it on a standard code module.</p>\n\n<pre><code>Option Explicit\n\n    Dim ReturnRange As Range\n\nSub GotoBookmark()\n    ' 13 Sep 2017\n\n    With Selection\n        If .Hyperlinks.Count Then\n            Set ReturnRange = .Range\n            .Hyperlinks(1).Follow\n        End If\n    End With\nEnd Sub\n\nSub ReturnToLink()\n    ' 13 Sep 2017\n\n    If Not ReturnRange Is Nothing Then ReturnRange.Select\nEnd Sub\n</code></pre>\n\n<p>For testing purposes, create a bookmark in your document and a hyperlink to it. Select the hyperlink and run Sub <code>GotoBookmark</code>. Then run procedure <code>ReturnToLink</code> to go back to where you came from. Note that you can return from anywhere as well as multiple times.</p>\n\n<p>You may wish to create keyboard shortcuts to call the two subs.</p>\n"}], "owner": {"reputation": 335, "user_id": 3034646, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/24a37750f80276c8f292af0555cec9f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy T", "link": "https://stackoverflow.com/users/3034646/jimmy-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 643, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1505294817, "creation_date": 1505278323, "last_edit_date": 1505282735, "question_id": 46189083, "link": "https://stackoverflow.com/questions/46189083/vba-macro-for-simulating-ctrlclick-on-a-bookmark-hyperlink", "title": "VBA macro for simulating Ctrl+click on a bookmark/hyperlink", "body": "<p>I'm trying to write a VBA macro in Microsoft Word to do the same thing as Ctrl+click does (follow a link or go to the bookmark).</p>\n\n<p>I've tried SendKeys but I don't think that works for left mouse click.</p>\n\n<p>I've actually came up with a partially working solution involving the use of\n<code>Selection.GoTo What:=wdGoToBookmark, Name:=BLA</code>but this unfortunately means I can't use ctrl+&lt; because it seems that the history of where the cursor previously was is not saved.</p>\n\n<p>So instead of coming up with my own solution, is there actually a way to just bind the action of Ctrl+click to another button? Or is there a way to write a macro that'll do the same action including keeping track of the history of the cursor?</p>\n"}, {"tags": ["sql-server", "string", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8601016, "user_type": "registered", "profile_image": "https://graph.facebook.com/1840002712678169/picture?type=large", "display_name": "Susie Hurtz", "link": "https://stackoverflow.com/users/8601016/susie-hurtz"}, "edited": false, "score": 0, "creation_date": 1505961994, "post_id": 46231647, "comment_id": 79629626, "body": "Thank you for your input and time. @ryguy72"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1505449191, "creation_date": 1505449191, "answer_id": 46231647, "question_id": 46188714, "link": "https://stackoverflow.com/questions/46188714/importing-more-1000-rows-from-excel-to-sql-server-pt-2/46231647#46231647", "title": "Importing more 1000+ rows from Excel to SQL Server pt.2", "body": "<p>You should be able to find a solution here.</p>\n\n<p><a href=\"https://www.excel-sql-server.com/excel-sql-server-import-export-using-vba.htm#Introduction\" rel=\"nofollow noreferrer\">https://www.excel-sql-server.com/excel-sql-server-import-export-using-vba.htm#Introduction</a></p>\n\n<p>Or, consider this.</p>\n\n<pre><code>Sub Rectangle1_Click()\n'TRUSTED CONNECTION\n    On Error GoTo errH\n\n    Dim con As New ADODB.Connection\n    Dim rs As New ADODB.Recordset\n    Dim strPath As String\n    Dim intImportRow As Integer\n    Dim strFirstName, strLastName As String\n\n    Dim server, username, password, table, database As String\n\n\n    With Sheets(\"Sheet1\")\n\n            server = .TextBox1.Text\n            table = .TextBox4.Text\n            database = .TextBox5.Text\n\n\n            If con.State &lt;&gt; 1 Then\n\n                con.Open \"Provider=SQLOLEDB;Data Source=\" &amp; server &amp; \";Initial Catalog=\" &amp; database &amp; \";Integrated Security=SSPI;\"\n                'con.Open\n\n            End If\n            'this is the TRUSTED connection string\n\n            Set rs.ActiveConnection = con\n\n            'delete all records first if checkbox checked\n            If .CheckBox1 Then\n                con.Execute \"delete from tbl_demo\"\n            End If\n\n            'set first row with records to import\n            'you could also just loop thru a range if you want.\n            intImportRow = 10\n\n            Do Until .Cells(intImportRow, 1) = \"\"\n                strFirstName = .Cells(intImportRow, 1)\n                strLastName = .Cells(intImportRow, 2)\n\n                'insert row into database\n                con.Execute \"insert into tbl_demo (firstname, lastname) values ('\" &amp; strFirstName &amp; \"', '\" &amp; strLastName &amp; \"')\"\n\n                intImportRow = intImportRow + 1\n            Loop\n\n            MsgBox \"Done importing\", vbInformation\n\n            con.Close\n            Set con = Nothing\n\n    End With\n\nExit Sub\n\nerrH:\n    MsgBox Err.Description\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/OCSBy.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OCSBy.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Or........from Excel to SQL Server using a WHERE clause.</p>\n\n<pre><code>Sub InsertInto()\n\n'Declare some variables\nDim cnn As adodb.Connection\nDim cmd As adodb.Command\nDim strSQL As String\n\n'Create a new Connection object\nSet cnn = New adodb.Connection\n\n'Set the connection string\ncnn.ConnectionString = \"Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=True;Initial Catalog=Northwind;Data Source=Excel-PC\\SQLEXPRESS\"\n'cnn.ConnectionString = \"DRIVER=SQL Server;SERVER=Excel-PC\\SQLEXPRESS;DATABASE=Northwind;Trusted_Connection=Yes\"\n\n\n'Create a new Command object\nSet cmd = New adodb.Command\n\n'Open the Connection to the database\ncnn.Open\n\n'Associate the command with the connection\ncmd.ActiveConnection = cnn\n\n'Tell the Command we are giving it a bit of SQL to run, not a stored procedure\ncmd.CommandType = adCmdText\n\n'Create the SQL\nstrSQL = \"UPDATE TBL SET JOIN_DT = '2013-01-22' WHERE EMPID = 2\"\n\n'Pass the SQL to the Command object\ncmd.CommandText = strSQL\n\n\n'Execute the bit of SQL to update the database\ncmd.Execute\n\n'Close the connection again\ncnn.Close\n\n'Remove the objects\nSet cmd = Nothing\nSet cnn = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8601016, "user_type": "registered", "profile_image": "https://graph.facebook.com/1840002712678169/picture?type=large", "display_name": "Susie Hurtz", "link": "https://stackoverflow.com/users/8601016/susie-hurtz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1505449191, "creation_date": 1505275755, "last_edit_date": 1531161705, "question_id": 46188714, "link": "https://stackoverflow.com/questions/46188714/importing-more-1000-rows-from-excel-to-sql-server-pt-2", "title": "Importing more 1000+ rows from Excel to SQL Server pt.2", "body": "<p>The original question was presented in 2015. I was wanting to know if any one here is aware if a new vba code has been generated since then to string 1000+ rows?  </p>\n\n<p>I don't want to get into server and more complex issues if I don't have to.  </p>\n\n<p>See original post:\n<a href=\"https://stackoverflow.com/questions/34204813/importing-more-than-1000-rows-from-excel-to-sql-server\">Importing more than 1000 rows from Excel to SQL-server</a></p>\n\n<p>Your assistance is appreciated. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1505274723, "post_id": 46188383, "comment_id": 79339499, "body": "Change your <code>MsgBox</code> temporarily to <code>MsgBox &quot;Not Equal zero!!!! Is &quot; &amp; Range(&quot;H60&quot;)</code>.  I&#39;m guessing that it isn&#39;t exactly zero."}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1505279934, "post_id": 46188383, "comment_id": 79340960, "body": "If it&#39;s based on the difference of two cells, then why are you checking only one cell? Somehting like <code>If Range(&quot;A1&quot;).Value - Range(&quot;B1&quot;).Value = 0 Then ...</code> should be applied."}], "answers": [{"comments": [{"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 1, "creation_date": 1505275045, "post_id": 46188563, "comment_id": 79339572, "body": "I think <code>Worksheet_SelectionChange</code> is fired on every change in the sheet irrespective of what you write inside the <code>Sub</code>. The condition you put however runs a certain code inside the condition. Nevertheless the control will has to go till <code>End Sub</code> in all cases."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 0, "creation_date": 1505275088, "post_id": 46188563, "comment_id": 79339581, "body": "Yes the event is fired but the check and resulting msgbox will be omitted if it is not those cells that fired it."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 0, "creation_date": 1505275150, "post_id": 46188563, "comment_id": 79339597, "body": "And TBH I would probably use the worksheet_change event, not the worksheet_selectionchange event"}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 1, "creation_date": 1505275295, "post_id": 46188563, "comment_id": 79339627, "body": "Agree with you on function choice. On the other part I mis-took your answer, my bad."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1505275318, "post_id": 46188563, "comment_id": 79339628, "body": "The <code>Target</code> for <code>SelectionChange</code> will be the cell you are selecting, so using a <code>Target</code> of the cells that might be changed to ultimately change H60 won&#39;t work (because the change to H60 will occur after the selection)."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1505275366, "post_id": 46188563, "comment_id": 79339638, "body": "All good, it is an interesting point you raise though, I mean we could use <code>If not blah blah then exit sub</code> which would probably be technically better but for the purpose of this exercise either works :)"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1505275472, "post_id": 46188563, "comment_id": 79339659, "body": "Good Point YowE3K, I have changed my answer to use <code>Worksheet_change</code> and I can&#39;t think of any scenario where the OP would want the other event, I believe it must have been used by the OP in error."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1505275573, "post_id": 46188563, "comment_id": 79339680, "body": "There is one scenario - the two cells that are being subtracted could themselves be calculated by a formula.  (But I don&#39;t think this resolves the issue - I can&#39;t think of a situation where <code>Value2</code> will be 0 when <code>Value</code> isn&#39;t, unless H60 is a date.)"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1505275635, "post_id": 46188563, "comment_id": 79339697, "body": "In which case you would change your test but you would still use the worksheet_change event, not the Worksheet_SelectionChange event."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1505275818, "post_id": 46188563, "comment_id": 79339738, "body": ":D A lot depends on what those other formulas are - imagine if one of those formulas was a <code>SUM</code> of several cells in an external workbook.  Or it could be an <code>INDIRECT</code> referencing cells anywhere on the current worksheet.  It starts getting hard to work out which cell needs to have the <code>Change</code> event on it.  (But it is definitely better to use <code>Change</code> if the root cells that cause the calculation can be determined.)"}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1505275996, "post_id": 46188563, "comment_id": 79339792, "body": "I just found an elegant solution to use Worksheet_Change... <a href=\"https://stackoverflow.com/questions/4388279/how-can-i-run-a-vba-code-each-time-a-cell-get-is-value-changed-by-a-formula\" title=\"how can i run a vba code each time a cell get is value changed by a formula\">stackoverflow.com/questions/4388279/&hellip;</a> @YowE3K"}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1505276299, "post_id": 46188563, "comment_id": 79339880, "body": "Not foolproof for <code>INDIRECT</code> but at least you can determine if our earmarked range is in the immediate dependency tree of <code>Target</code> range passed in through <code>Worksheet_Change</code>. @YowE3K"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1505276455, "post_id": 46188563, "comment_id": 79339919, "body": "That&#39;s a really nice solution :). Will add to my little bag of tricks for future use ;)"}, {"owner": {"reputation": 31, "user_id": 2223311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/34996044d7a928055e5e85d37ed8ee05?s=128&d=identicon&r=PG", "display_name": "koky", "link": "https://stackoverflow.com/users/2223311/koky"}, "edited": false, "score": 0, "creation_date": 1505278584, "post_id": 46188563, "comment_id": 79340519, "body": "@DanDonoghue Hi Dan, I tried your recommendations but it could not work for &quot;Range(&quot;H60&quot;).Value2&quot;. This is because cell H60 formula is cell H58 minus cell F58. Cell H58 formula is summation of cell H7 to H57. Cell F58 formula is summation of cell F7 to F57. Any other recommendations? :)"}, {"owner": {"reputation": 31, "user_id": 2223311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/34996044d7a928055e5e85d37ed8ee05?s=128&d=identicon&r=PG", "display_name": "koky", "link": "https://stackoverflow.com/users/2223311/koky"}, "edited": false, "score": 0, "creation_date": 1505283495, "post_id": 46188563, "comment_id": 79342372, "body": "Hi all users, I have managed to find out the solution. After i round cell H58 and cell F58to 2 decimal places, my original solution works. Thank you for all the comments. :)"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1505275412, "last_edit_date": 1505275412, "creation_date": 1505274740, "answer_id": 46188563, "question_id": 46188383, "link": "https://stackoverflow.com/questions/46188383/if-cell-value-is-not-equal-to-zero-then-message-box/46188563#46188563", "title": "If cell value is not equal to zero then message box", "body": "<p>use <code>.Value2</code></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Range(\"H60\").Value2 &lt;&gt; 0 Then\n    MsgBox \"Not Equal zero!!!!\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I would however recommend you put some sort of test in there to only fire on certain cell changes, you don't want it firing every time anything is changed on the sheet.</p>\n\n<p>You mentioned the cell relies on 2 other cells, you could have your test on those with something like this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf target.address = \"$I$60\" or target.address = \"$J$60\" then\n    If Range(\"H60\").Value2 &lt;&gt; 0 Then\n        MsgBox \"Not Equal zero!!!!\"\n    End If\nend if\nEnd Sub\n</code></pre>\n\n<p>This will make it only fire if I60 or J60 are what was changed on the sheet, you can obviously change these to other cell references if you need, I assumed your formula is using I60 and J60</p>\n"}], "owner": {"reputation": 31, "user_id": 2223311, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/34996044d7a928055e5e85d37ed8ee05?s=128&d=identicon&r=PG", "display_name": "koky", "link": "https://stackoverflow.com/users/2223311/koky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 7751, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1617847375, "creation_date": 1505273279, "last_edit_date": 1594030532, "question_id": 46188383, "link": "https://stackoverflow.com/questions/46188383/if-cell-value-is-not-equal-to-zero-then-message-box", "title": "If cell value is not equal to zero then message box", "body": "<p>I have written this code to automatically pop up a message box when the value of a cell is not equal to zero. This cell depends on the value of cell A minus the value of cell B.</p>\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Range(&quot;H60&quot;) &lt;&gt; 0 Then\nMsgBox &quot;Not Equal zero!!!!&quot;\nEnd If\nEnd Sub\n</code></pre>\n<p>However, when the cell H60 is zero, the message box still continues to pop up. Why?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505268066, "post_id": 46187639, "comment_id": 79338077, "body": "(a) I just did a very simplified test using <code>Target.Offset(0, 1).FormulaR1C1 = &quot;=5&quot;</code> and it worked.  So I think it is going to be something to do with the formula itself. (b) What do you mean by &quot;However it doesn&#39;t seem to work.&quot; - just that it gives the wrong values?  (I notice your original formula matches data in column B, but your revised code tries to match based on column A - was that intentional?)"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1505268294, "post_id": 46187639, "comment_id": 79338136, "body": "Add one line to your code: <code>MsgBox &quot;Target = &quot; &amp; target.Address</code>. You might place it before the <code>If</code> or before the <code>With</code>. In the former case you will know if your event fires, in the latter where the formula is being inserted."}, {"owner": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505269255, "post_id": 46187639, "comment_id": 79338361, "body": "@YowE3K  when I said it doesn&#39;t work it means that no data appear in B5 when I keyed in data in A5.Also when I typed in value in B5 and then key in data in A5, B5 becomes blank again. I don&#39;t think it&#39;s due to the formula coz the original works. All I did was modify from the original the Offset function, change to FormulaR1C1 and change the formula to read rc1 instead of reading the cell."}, {"owner": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1505269760, "post_id": 46187639, "comment_id": 79338494, "body": "@Variatus I used your msgbox trick on before with statement and found that value was inserted straight into A5... a quick change from rc1 into rc2 fixes that problem. :p thanks."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505269925, "post_id": 46187639, "comment_id": 79338529, "body": "@hjh93 But you also changed your formula to use <code>MATCH(rc1</code> (i.e. <code>MATCH(A4</code> if the row was row 4) instead of <code>MATCH(B4</code> - are you sure that isn&#39;t causing an error?  Oops - I see you noticed that when you replied to Variatus."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1505270555, "post_id": 46187639, "comment_id": 79338670, "body": "@hjh93 I think you might be misunderstanding R1C1 notation - <code>RC1</code> is the equivalent of <code>$A4</code> in A1 notation.  <code>R</code> means current row, <code>R[-3]</code> means 3 rows before the current row, <code>R6</code> means the 6th row (i.e. <code>$6</code> in A1 notation), and similarly <code>C</code> means current column, <code>C[4]</code> means the 4th column to the right of the current column, and <code>C7</code> means column 7 (i.e. <code>$G</code> in A1 notation).  And &quot;current&quot; in those examples refers to the cell <b>in which the formula exists</b>, not the <code>ActiveCell</code>, or <code>Target</code> or <code>Selection</code>."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505334103, "post_id": 46202500, "comment_id": 79375778, "body": "For using <code>&#196;</code> as a variable name .. +1.  Have you tried use <code>\u201cA\u201d</code> - that&#39;s a lot of fun too.  (Actually, the +1 was mainly for the recommendation to use <code>RC[-1]</code>.)"}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505345186, "post_id": 46202500, "comment_id": 79379816, "body": "@YowE3K Hey, I remember now! I <i>did</i> try that a long time ago :)"}], "tags": [], "owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "is_accepted": false, "score": 0, "last_activity_date": 1509437340, "last_edit_date": 1509437340, "creation_date": 1505319815, "answer_id": 46202500, "question_id": 46187639, "link": "https://stackoverflow.com/questions/46187639/does-offset-work-in-tables-excel-vba/46202500#46202500", "title": "Does Offset work in tables? (Excel-VBA)", "body": "<p>Whilst using <code>RC2</code> fixes your problem, you are <em>far</em> better off using <code>RC[-1]</code>. If you move the table or insert a column to to the left of it, the code will break using absolute references, but not using relative ones.</p>\n\n<p>You are also better off using the <code>IFERROR()</code> function rather than <code>IF(ISNA())</code> as it results in a formula that avoids repetition, and is half the length:</p>\n\n<pre><code>With Target.Offset(0, 1)\n  .FormulaR1C1 = \"=IFERROR(INDEX(DieMaster,MATCH(RC[-1],DieMaster[Asset No],0),2),\"\"\"\")\"\n  .Value = .Value\nEnd With\n</code></pre>\n\n<p>However, the best way to refresh the edited row only, is to do the calculations in VBA and write the results to the sheet.</p>\n\n<p>The following code does this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n  If Intersect(Target, Me.Range(\"ProjectEntry[Asset No]\")) Is Nothing Then Exit Sub\n\n  Dim \u00c4 As Excel.Application: Set \u00c4 = Excel.Application\n  Dim varValue As Variant\n\n  With \u00c4.Range(\"DieMaster\").ListObject.ListColumns\n    varValue = \u00c4.Index(.Item(2).DataBodyRange, \u00c4.Match(Target.Value2, \u00c4.Range(\"DieMaster[Asset No]\"), 0))\n  End With\n  Target.Offset(0, 1).Value = IIf(IsError(varValue), vbNullString, varValue)\n\nEnd Sub\n</code></pre>\n\n<p>Note the usage of <code>Application.</code> instead of <code>WorksheetFunction.</code> to access the worksheet functions. This, coupled with the use of a Variant type variable, allows us to trap the error that occurs when the match fails.</p>\n"}], "owner": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1082, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509437340, "creation_date": 1505267360, "question_id": 46187639, "link": "https://stackoverflow.com/questions/46187639/does-offset-work-in-tables-excel-vba", "title": "Does Offset work in tables? (Excel-VBA)", "body": "<p>I'm have an Excel sheet with a table that performs Index/Match formula in VBA and copy the values into the table. The code is as below:</p>\n\n<pre><code>Private Sub worksheet_change(ByVal target As Range)\n\n  If Not Intersect(target, Me.ListObjects(\"ProjectEntry\").ListColumns(\"Asset No\").DataBodyRange) Is Nothing Then\n\n   With Me.Range(\"ProjectEntry[Description]\")\n    .Formula = \"=IF(ISNA(INDEX(DieMaster,MATCH(B4,DieMaster[Asset No],FALSE),2)),\"\"\"\",INDEX(DieMaster,MATCH(B4,DieMaster[Asset No],FALSE),2))\"\n    .Value = .Value\n   End With\n\n  End If\n\nEnd Sub\n</code></pre>\n\n<p>I found that this code although works, will execute on all cells in the table. Now I want it to only execute in my selected row. Example, if I perform a change in A5, I want the code to execute in row 5 only.</p>\n\n<p>I have tried using Offset as it worked for me in Excel when data is not in a table. Using the code below:</p>\n\n<pre><code>Private Sub worksheet_change(ByVal target As Range)\n\n If Not Intersect(target, Me.ListObjects(\"ProjectEntry\").ListColumns(\"Asset No\").DataBodyRange) Is Nothing Then\n\n  With target.Offset(0, 1)\n    .FormulaR1C1 = \"=IF(ISNA(INDEX(DieMaster,MATCH(rc1,DieMaster[Asset No],FALSE),2)),\"\"\"\",INDEX(DieMaster,MATCH(rc1,DieMaster[Asset No],FALSE),2))\"\n    .Value = .Value\n  End With\n\n End If\n\nEnd Sub\n</code></pre>\n\n<p>However it doesn't seem to work. Does this mean that Offset does not work in table? If not, is there another way?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1505263888, "post_id": 46187146, "comment_id": 79337167, "body": "Only the file <b>name</b> should be enclosed in brackets - e.g. <code>=&#39;C:\\Temp\\Data\\[Book1.xlsx]Sheet2&#39;!R5C10</code>.  (See <a href=\"https://stackoverflow.com/q/46162966/6535336\">this question</a> for a possible way of setting it up.)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8600391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d3ec9b4d873548a41c9bf89666df1f0?s=128&d=identicon&r=PG&f=1", "display_name": "Sukhbir Gill", "link": "https://stackoverflow.com/users/8600391/sukhbir-gill"}, "edited": false, "score": 0, "creation_date": 1505314112, "post_id": 46187402, "comment_id": 79363927, "body": "Thank you so much, this worked perfectly!  I spent 3+ hours yesterday trying to figure this out, I am glad I asked for help.  :)  Thank you again for your help."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 3, "last_activity_date": 1505330976, "last_edit_date": 1505330976, "creation_date": 1505265298, "answer_id": 46187402, "question_id": 46187146, "link": "https://stackoverflow.com/questions/46187146/vba-formula-variable-file-name-and-variable-sheet-name/46187402#46187402", "title": "VBA Formula: Variable File Name and Variable Sheet Name", "body": "<p>The format to access a cell in a sheet in an external workbook is</p>\n\n<p><code>'path\\[filename]sheetname'!cell_reference</code></p>\n\n<p>so if you have a variable called <code>SourceFileNamePath</code> containing the path <strong>and</strong> filename (e.g. <code>\"C:\\Temp\\Data\\Book1.xlsx\"</code>) then you need to separate the filename from the path.</p>\n\n<p>You could use something like:</p>\n\n<pre><code>SourceFileNamePath = \"C:\\Temp\\Data\\Book1.xlsx\"   ' or however you set that variable\nSourceTab = \"Sheet1\"                             ' or however you set that variable\n\nDim SourceFilePath As String\nDim SourceFileName As String\nSourceFilePath = Left(SourceFileNamePath, InStrRev(SourceFileNamePath, Application.PathSeparator))\nSourceFileName = Mid(SourceFileNamePath, InStrRev(SourceFileNamePath, Application.PathSeparator) + 1)\nCells(destStartRow, destStartCol).FormulaR1C1 = \"='\" &amp; SourceFilePath &amp; \"[\" &amp; SourceFileName &amp; \"]\" &amp; SourceTab &amp; \"'!R\" &amp; sourceStartRow &amp; \"C\" &amp; sourceStartCol\n</code></pre>\n\n<hr>\n\n<p>Note: If either the path or the filename contains any single-quotation marks (e.g. if the filename was <code>Sukhbir's test file.xlsx</code>) then it will need to be escaped (i.e. each single-quotation mark needs to be replaced by two single-quotation marks).  This can be achieved by using the <code>Replace</code> function, e.g.:</p>\n\n<pre><code>Cells(destStartRow, destStartCol).FormulaR1C1 = _\n                                 \"='\" &amp; Replace(SourceFilePath, \"'\", \"''\") &amp; _\n                                 \"[\" &amp; Replace(SourceFileName, \"'\", \"''\") &amp; \"]\" &amp; _\n                                 SourceTab &amp; \"'!R\" &amp; sourceStartRow &amp; \"C\" &amp; sourceStartCol\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8600391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d3ec9b4d873548a41c9bf89666df1f0?s=128&d=identicon&r=PG&f=1", "display_name": "Sukhbir Gill", "link": "https://stackoverflow.com/users/8600391/sukhbir-gill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1875, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1505330976, "creation_date": 1505262999, "last_edit_date": 1505263754, "question_id": 46187146, "link": "https://stackoverflow.com/questions/46187146/vba-formula-variable-file-name-and-variable-sheet-name", "title": "VBA Formula: Variable File Name and Variable Sheet Name", "body": "<p>I am trying to create a cell reference to a cell in another workbook.  In my code below, I am using a variable for workbook name and sheet name.</p>\n\n<ul>\n<li><code>SourceFileNamePath</code> = Path and name of workbook I am linking to</li>\n<li><code>SourceTab</code> = Tab in the workbook I want to link to</li>\n</ul>\n\n<p>Though the code runs fine, the formula generated is not working.  Does anyone have any thoughts on whether I am referencing <code>SourceFileNamePath</code> and <code>SourceTab</code> correctly?</p>\n\n<p>Code is below:</p>\n\n<pre><code>Cells(destStartRow, destStartCol).FormulaR1C1 = \"='[\" &amp; SourceFileNamePath &amp; \"]\" &amp; SourceTab &amp; \"'!R\" &amp; sourceStartRow &amp; \"C\" &amp; sourceStartCol\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505263102, "post_id": 46186811, "comment_id": 79337008, "body": "Try <code>Worksheets(&quot;Sheet3&quot;).Range(&quot;B2:E19&quot;).Copy Destination:=Worksheets(&quot;Sheet7&quot;).Range(&quot;A&quot; &amp; Worksheets(&quot;Sheet7&quot;).Rows.Count).End(xlUp).Offset(1, 0)</code>  (that&#39;s all one line).  You may have to adjust the <code>Offset</code> if you don&#39;t have data in every row of the first column."}], "answers": [{"tags": [], "owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "is_accepted": false, "score": 2, "last_activity_date": 1505334466, "last_edit_date": 1505334466, "creation_date": 1505267019, "answer_id": 46187600, "question_id": 46186811, "link": "https://stackoverflow.com/questions/46186811/excel-cp-macro/46187600#46187600", "title": "Excel C&amp;P Macro", "body": "<p>The code below finds the lowest populated row in <code>sheet7</code> no matter what column it is in and then goes one row lower.  It starts the paste in the A column of the row below the lowest row with contents.</p>\n\n<pre><code>Sub test()\ndim lastrow as integer  \n\n\nlastrow = Sheets(\"sheet7\").UsedRange.Rows(Sheets(\"sheet7\").UsedRange.Rows.Count).Row + 1\nSheets(\"sheet3\").Select\nRange(\"B2:E19\").Select\nSelection.Copy\nSheets(\"sheet7\").Select\nCells(lastrow, 1).Activate\nActiveSheet.Paste\nColumns(\"A:A\").EntireColumn.AutoFit\n\n\nEnd Sub\n</code></pre>\n\n<p>A cleaner and more efficient way to accomplish the same goal is the use this code:</p>\n\n<pre><code>Sub test()\ndim lastrow as integer  \n\n\nlastrow = Sheets(\"sheet7\").UsedRange.Rows(Sheets(\"sheet7\").UsedRange.Rows.Count).Row + 1  \n\nWorksheets(\"Sheet3\").Range(\"B2:E19\").Copy Destination:=Worksheets(\"Sheet7\").Cells(lastrow, \"A\")\n\nend sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8600365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457af4dc0ee4aefb0402dc3673f7a415?s=128&d=identicon&r=PG&f=1", "display_name": "N Dz", "link": "https://stackoverflow.com/users/8600365/n-dz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1505334466, "creation_date": 1505260109, "last_edit_date": 1505262978, "question_id": 46186811, "link": "https://stackoverflow.com/questions/46186811/excel-cp-macro", "title": "Excel C&amp;P Macro", "body": "<p>I have an order form I have created. The details of the form are inputted manually. I would like to create a macro that takes the cells/data and copies them in to another worksheet to keep a record of the information and freeing up the order form to be used again.</p>\n\n<p>I have recorded a macro that will do this, however each time I run the macro it will overwrite the last copied form. How can I get Excel to paste the data in to free cells below rather than overwrite the previously copied data?</p>\n\n<pre><code> ' CP Macro\n'\n\n'\nSheets(\"Sheet3\").Select\nRange(\"B2:E19\").Select\nSelection.Copy\nSheets(\"Sheet7\").Select\nActiveSheet.Paste\nColumns(\"A:A\").EntireColumn.AutoFit\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 384, "user_id": 4475468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d04747a9bf180c8fb9fc145ec5133d1?s=128&d=identicon&r=PG", "display_name": "Joffan", "link": "https://stackoverflow.com/users/4475468/joffan"}, "is_accepted": true, "score": 3, "last_activity_date": 1505309696, "last_edit_date": 1505309696, "creation_date": 1505257510, "answer_id": 46186521, "question_id": 46186443, "link": "https://stackoverflow.com/questions/46186443/excel-vba-remove-content-from-cells-then-delete-total-rows/46186521#46186521", "title": "Excel VBA Remove content from cells then delete total rows", "body": "<p>In your final For loop, you have</p>\n\n<pre><code>Rows.EntireRow.Delete\n</code></pre>\n\n<p>where you should have </p>\n\n<pre><code>VarCase.EntireRow.Delete\n</code></pre>\n\n<p>which probably accounts for the general deletion.</p>\n\n<p>The For Each construct doesn't always work happily with a range that is being changed (here by row deletion), so beware that. You could potentially accumulate a Range of deletion targets via Union and delete in one statement at the end for DRYness, without any clearing of contents.</p>\n\n<p>Also, indentation is your friend.</p>\n\n<hr>\n\n<p>Edit to add illustration of Union approach:</p>\n\n<pre><code>Sub TestRowDelete()\nDim ARange As Range\nDim DRange As Range\n\nSet DRange = Nothing\n\nFor Each ARange In ActiveSheet.UsedRange.Rows\n    If ARange(1).Value = \"d\" Then ' testing first cell on each row\n        If DRange Is Nothing Then\n            Set DRange = ARange\n        Else\n            Set DRange = Union(DRange, ARange)\n        End If\n    End If\nNext ARange\n\nIf Not DRange Is Nothing Then DRange.EntireRow.Delete\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "is_accepted": false, "score": 0, "last_activity_date": 1505259896, "last_edit_date": 1505259896, "creation_date": 1505259584, "answer_id": 46186758, "question_id": 46186443, "link": "https://stackoverflow.com/questions/46186443/excel-vba-remove-content-from-cells-then-delete-total-rows/46186758#46186758", "title": "Excel VBA Remove content from cells then delete total rows", "body": "<p>Just put this code under this code under the data worksheet in VBA</p>\n\n<pre><code>Sub Alfredo()\n\nDim msg As String\nDim VarCase As Range\n\nFor Each VarCase In ActiveSheet.Range(\"D:D\")\n  If VarCase.Value2 = \"John\" Or VarCase.Value2 = \"Thompson\" Or VarCase.Value2 = \"Mattson\" Then\n   VarCase.ClearContents\n  End If\nNext VarCase\n\n For Each VarCase In ActiveSheet.Range(\"D:D\")\n   If VarCase.Value = \"\" Then\n    VarCase.EntireRow.Delete\n   End If\n Next VarCase\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 8309220, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1b7a01f0f31b26a557fb22bdc9d89adc?s=128&d=identicon&r=PG&f=1", "display_name": "JS Bach", "link": "https://stackoverflow.com/users/8309220/js-bach"}, "edited": false, "score": 0, "creation_date": 1505317171, "post_id": 46192359, "comment_id": 79366144, "body": "Hi Tony, I can&#39;t the code to execute, the excel wheel just spins for over 10 minutes"}], "tags": [], "owner": {"reputation": 79, "user_id": 7203587, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17a63caa52c59fc54896b9d73ca85b33?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/7203587/tony"}, "is_accepted": false, "score": 0, "last_activity_date": 1505355380, "last_edit_date": 1505355380, "creation_date": 1505290553, "answer_id": 46192359, "question_id": 46186443, "link": "https://stackoverflow.com/questions/46186443/excel-vba-remove-content-from-cells-then-delete-total-rows/46192359#46192359", "title": "Excel VBA Remove content from cells then delete total rows", "body": "<p>Why loop twice?</p>\n\n<pre><code>Application.ScreenUpdating = False\nDim VarCase As Range\nDim ws As Worksheet\nSet ws = Sheets(\"Data\")\nFor Each VarCase In ws.Range(\"D1:D11000\")\n\n    If VarCase.Value2 = \"John\" Or VarCase.Value2 = \"Thompson\" Or VarCase.Value2 = \"Mattson\" Then\n       VarCase.ClearContents\n       VarCase.EntireRow.Delete\n    End If\n\nNext VarCase\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 8309220, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1b7a01f0f31b26a557fb22bdc9d89adc?s=128&d=identicon&r=PG&f=1", "display_name": "JS Bach", "link": "https://stackoverflow.com/users/8309220/js-bach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 46186521, "answer_count": 3, "score": 2, "last_activity_date": 1505355380, "creation_date": 1505256871, "question_id": 46186443, "link": "https://stackoverflow.com/questions/46186443/excel-vba-remove-content-from-cells-then-delete-total-rows", "title": "Excel VBA Remove content from cells then delete total rows", "body": "<p>I am programming to review a range, remove content from the range of cells, then delete the entire row of cells that have been cleared of content. Currently, I run the code and all the rows are getting deleted. Also, I appreciate suggestions to make the code DRY.</p>\n\n<pre><code>Option Explicit\n\nSub Alfredo()\n\nDim msg As String\nDim VarCase As Range\nDim ws As Worksheets\n\nSet ws = Sheets(\"Data\")\n\nFor Each VarCase In ws.Range(\"D1:D11000\")\nIf VarCase.Value2 = \"John\" Or VarCase.Value2 = \"Thompson\" Or VarCase.Value2 = \n\"Mattson\" Then\nVarCase.ClearContents\nEnd If\nNext VarCase\n\nFor Each VarCase In ws.Range(\"D1:D11000\")\nIf VarCase.Value = \"\" Then\nRows.EntireRow.Delete\nEnd If\nNext VarCase\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "forms", "image", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1505286391, "post_id": 46186332, "comment_id": 79344068, "body": "If you have you have ControlSource dynamically displaying employee photo from external folder, why are you using Picture property?"}, {"owner": {"reputation": 75, "user_id": 3019338, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7a30c385af9c9f66f63ffdb53d9e8b0b?s=128&d=identicon&r=PG&f=1", "display_name": "user3019338", "link": "https://stackoverflow.com/users/3019338/user3019338"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1505378798, "post_id": 46186332, "comment_id": 79391576, "body": "Thank you for your reply June7. All pictures are in .png format (except the BlankImage.bmp). I found a piece of code to load .png images in my custom ribbon and it works well. Pictures are stored in a subfolder of temp folder. I think this piece of code uses API and it is too complex for me to understand. I tried to use the same function to load images into the form without success."}, {"owner": {"reputation": 75, "user_id": 3019338, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7a30c385af9c9f66f63ffdb53d9e8b0b?s=128&d=identicon&r=PG&f=1", "display_name": "user3019338", "link": "https://stackoverflow.com/users/3019338/user3019338"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1505379379, "post_id": 46186332, "comment_id": 79391983, "body": "@June7: I added information in my initial post because of character limitation. Could you please check and help me?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1505411580, "post_id": 46186332, "comment_id": 79414337, "body": "I have never used Picture property for dynamically loading images to form or report. I have never used VBA to dynamically load images. This was necessary up to Access 2003 but then MS added the ControlSource property to Image control. I have only used ControlSource property. The ControlSource can be bound to Attachment field (drag from the design Field List onto form or report) or can reference external image file path concatenated to a field with file name - which you appear to be doing."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1505411918, "post_id": 46186332, "comment_id": 79414526, "body": "However, complication seems to be you need to load alternate file with different image extension. Can you convert the bmp to a png?"}, {"owner": {"reputation": 75, "user_id": 3019338, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7a30c385af9c9f66f63ffdb53d9e8b0b?s=128&d=identicon&r=PG&f=1", "display_name": "user3019338", "link": "https://stackoverflow.com/users/3019338/user3019338"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1505511412, "post_id": 46186332, "comment_id": 79459811, "body": "It works well now, with png directly from tblEmployee, not the one copied to temp foler: I just had to insert an attachment control in the form and bind it to tblEmployee attachment. It is possible to display a picture in an attachment control, but all the time I thought I had to use the picture control."}], "owner": {"reputation": 75, "user_id": 3019338, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7a30c385af9c9f66f63ffdb53d9e8b0b?s=128&d=identicon&r=PG&f=1", "display_name": "user3019338", "link": "https://stackoverflow.com/users/3019338/user3019338"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505390399, "creation_date": 1505256134, "last_edit_date": 1505390399, "question_id": 46186332, "link": "https://stackoverflow.com/questions/46186332/access-2016-linked-picture-path-lost-after-closing-and-reopening-the-database", "title": "Access 2016 linked picture path lost after closing and reopening the database", "body": "<p>1 main form, containing 2 subforms:\nfirst subform, datasheet view: list of employees; second subform, single form view: contact details and photo.</p>\n\n<p>frmContactDetails has a image (inserted using design>controls>image), which contolsource is linked to the employee photo path.</p>\n\n<p>frmEmployee, On Current event: requery frmContactDetails. </p>\n\n<p>I linked a blank photo in image.picture property.</p>\n\n<p>Everything works well, I can select any employee and see all d\u00e9tails and photo updating according to the current record. I can do a compact and repair, reopen the main form, and it is still working.</p>\n\n<p><strong>Problem: When I close and reopen the database, photos are not updating anymore.</strong> In design view, image.picture property still shows the complete blank photo path in the field, but when I clic to the 3 dots button, it does not reach the folder conatining this photo. I need to set again the correct path, save and reopen the form to make it work again. </p>\n\n<p>I've been trying to find a solution for hours without success. </p>\n\n<p>frmEmployee record source: </p>\n\n<pre><code>SELECT tblEmployee.Email, tblEmployee.EmployeeName FROM tblEmployee;\n</code></pre>\n\n<p>frmEmployee OnCurrent event:</p>\n\n<pre><code>Private Sub Form_Current()\nMe.Parent.txtEmployeeEmail.Value = Me.Email\nMe.Parent.frmContactDetail.Requery\nEnd Sub\n</code></pre>\n\n<p>frmContactDetails record source:</p>\n\n<pre><code>SELECT tblPhotos.Email, tblPhotos.PhotoName\nFROM tblPhotos\nWHERE (((tblPhotos.Email)=[Forms]![frmMain]![txtEmployeeEmail]));\n</code></pre>\n\n<p>frmContactDetails image:   control source: PhotoName, picture type: Linked, Size Mode: clip, Picture property: </p>\n\n<pre><code>C:\\Users\\UserName\\Desktop\\test\\BlankImage.bmp\n</code></pre>\n\n<p>Do you have an idea on what could be wrong?</p>\n\n<p>Additional information:</p>\n\n<p>All pictures are in .png format (except the BlankImage.bmp). I found a piece of code to load .png images in my custom ribbon and it works well. Pictures are stored in a subfolder of temp folder. I think this piece of code uses API and it is too complex for me to understand: I tried to use the same function to load images into the form without success. In tblEmployee, there is an attachment with .png photo. At first, I tried to link the Image control to this attachment, but it does not display photos. Then I copied images Inside a folder of the temp folder, and used the .Picture property to display photo Inside the image control. I added a Field to tbl Employee with PhotoName. A textbox in the form is linked to this field, and then I recreate the full path using Environ(\"temp\")\\photofolder[PhotoName].png. If there is no path in .Picture (in design view) it is set to (none) and image control do not refresh. I give the path to BlankPhoto in design view, and then all updates correctly when I use the form. The problem is if I close Access and re-open it, BlankPhoto path is still visible in .Picture but when I click on the three dots button the file picker starts in Document folder (the path is lost), and photos do not update correctly. </p>\n\n<p>What would be the correct way to go?</p>\n"}, {"tags": ["python", "excel", "vba", "user-defined-functions", "xlwings"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505267073, "post_id": 46186084, "comment_id": 79337869, "body": "If the UDF is entered as an array formula (e.g. select cells A1:D5, then type <code>=ret_data_frame()</code> into cell A1 and press Ctrl-Shift-Enter rather than just Enter) then the UDF can return an array (in this case a 5x4 two-dimensional array).  That is how it works with VBA anyway - it may or may not work with xlwings."}, {"owner": {"reputation": 303, "user_id": 6700311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VAIJZ.jpg?s=128&g=1", "display_name": "Thales Marques", "link": "https://stackoverflow.com/users/6700311/thales-marques"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505308471, "post_id": 46186084, "comment_id": 79359663, "body": "The dimensions of this data frame are dynamic. I though about using an array formula but how can I create a UDF that pastes the entire Data Frame? Using the array idea I don&#39;t know what is the dimensions of data frame."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505332982, "post_id": 46186084, "comment_id": 79375182, "body": "Without using an array formula, a UDF is theoretically only able to return a single value to the cell containing the function call.  It theoretically can&#39;t modify the Excel environment in any other way.  (&quot;Theoretically&quot; - because there are some [fairly dangerous] ways to get around it.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505332986, "post_id": 46186084, "comment_id": 79375188, "body": "Could you add one of the worksheet events (maybe <code>Worksheet_SelectionChange</code> or <code>Worksheet_Calculate</code> or <code>Worksheet_BeforeDoubleClick</code>) to invoke your function.  The limitations to only updating a single cell apply only to UDFs (i.e. Functions called from an Excel Cell), not to exactly the same code called from an Event."}, {"owner": {"reputation": 303, "user_id": 6700311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VAIJZ.jpg?s=128&g=1", "display_name": "Thales Marques", "link": "https://stackoverflow.com/users/6700311/thales-marques"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505338313, "post_id": 46186084, "comment_id": 79377670, "body": "Understood. I think that my idea can&#39;t be done. You answered my question. If you like, post this solution and I&#39;ll accept the answer."}, {"owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "edited": false, "score": 0, "creation_date": 1505420213, "post_id": 46186084, "comment_id": 79418867, "body": "reading the docs helps: <a href=\"http://docs.xlwings.org/en/stable/udfs.html#dynamic-array-formulas\" rel=\"nofollow noreferrer\">docs.xlwings.org/en/stable/udfs.html#dynamic-array-formulas</a>"}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 5138496, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-tQCm5-14sgE/AAAAAAAAAAI/AAAAAAAAAC0/SdzQKzTsA18/photo.jpg?sz=128", "display_name": "Alex Walton", "link": "https://stackoverflow.com/users/5138496/alex-walton"}, "edited": false, "score": 0, "creation_date": 1563367827, "post_id": 49537408, "comment_id": 100675663, "body": "Hi, i know this is an old thread...in this case, the &quot;data&quot; is the name of the dataFrame?"}, {"owner": {"reputation": 627, "user_id": 2638609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VTbGV.jpg?s=128&g=1", "display_name": "ajaali", "link": "https://stackoverflow.com/users/2638609/ajaali"}, "reply_to_user": {"reputation": 155, "user_id": 5138496, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-tQCm5-14sgE/AAAAAAAAAAI/AAAAAAAAAC0/SdzQKzTsA18/photo.jpg?sz=128", "display_name": "Alex Walton", "link": "https://stackoverflow.com/users/5138496/alex-walton"}, "edited": false, "score": 0, "creation_date": 1565188570, "post_id": 49537408, "comment_id": 101275428, "body": "Hi, data is just and example argument, it can be anything. you can even remove it.  The example is very abstract.  The main point is that you need to have @xw.ret tag"}], "tags": [], "owner": {"reputation": 627, "user_id": 2638609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VTbGV.jpg?s=128&g=1", "display_name": "ajaali", "link": "https://stackoverflow.com/users/2638609/ajaali"}, "is_accepted": false, "score": 1, "last_activity_date": 1522247834, "creation_date": 1522247834, "answer_id": 49537408, "question_id": 46186084, "link": "https://stackoverflow.com/questions/46186084/returning-data-frame-to-excel-through-xlwings-udf/49537408#49537408", "title": "Returning Data Frame to excel through xlwings UDF", "body": "<p>You need to have the correct xlwings reutrn </p>\n\n<blockquote>\n  <p>@xw.ret(index=False, header=True, expand='table')</p>\n</blockquote>\n\n<p>decorator at the top of your function</p>\n\n<pre><code>@xw.func\n@xw.ret(index=False, header=True, expand='table')\ndef ret_data_frame(data):\n    return get_data_frame(data)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 367, "user_id": 5025254, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x8pDIEkRT8M/AAAAAAAAAAI/AAAAAAAAABY/YD-dC7q-5Es/photo.jpg?sz=128", "display_name": "Alexander Shubert", "link": "https://stackoverflow.com/users/5025254/alexander-shubert"}, "is_accepted": false, "score": 2, "last_activity_date": 1537637109, "creation_date": 1537637109, "answer_id": 52459098, "question_id": 46186084, "link": "https://stackoverflow.com/questions/46186084/returning-data-frame-to-excel-through-xlwings-udf/52459098#52459098", "title": "Returning Data Frame to excel through xlwings UDF", "body": "<p>This what worked for me:</p>\n\n<pre><code>@xw.func\n@xw.arg('x', pd.DataFrame, index=False, header=True)\n@xw.ret(header=True)\ndef get_my_df(x):\n    return x\n</code></pre>\n\n<p>And there are various ways you can return dataFrame, with this</p>\n\n<p><code>@xw.ret(header=True, index=True, expand='table')</code></p>\n\n<p>you can return dataFrame immediately into Excel, without a necessity to wrap it into Excel array formulas. </p>\n"}], "owner": {"reputation": 303, "user_id": 6700311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VAIJZ.jpg?s=128&g=1", "display_name": "Thales Marques", "link": "https://stackoverflow.com/users/6700311/thales-marques"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1673, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1537637109, "creation_date": 1505254444, "last_edit_date": 1505255360, "question_id": 46186084, "link": "https://stackoverflow.com/questions/46186084/returning-data-frame-to-excel-through-xlwings-udf", "title": "Returning Data Frame to excel through xlwings UDF", "body": "<p>I'm trying to create a User-Defined Function using Python, Xlwings library and Excel.</p>\n\n<p>The objective is to use a function, let's call ret_data_frames to fill not only the the A1 cell, but all the need cells to return the entire data frame.</p>\n\n<p>Like the images above:</p>\n\n<p><a href=\"https://i.stack.imgur.com/R988w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R988w.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/vaymo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vaymo.png\" alt=\"enter image description here\"></a></p>\n\n<p>The data frame that I used is obtained through web-scraping and have large dimensions, so I let's use a simple data frame and, if this works, I replace the idea to my original code</p>\n\n<pre><code>import numpy as np\nimport pandas as pd\n\ndef get_data_frame(data):\n    dates = pd.date_range(data,periods=6)\n    df = pd.DataFrame(np.random.randn(6,4),index=dates,columns=list('ABCD'))\n</code></pre>\n\n<p>After that, it's necessary to create the UDF function</p>\n\n<pre><code>import xlwings as xw\nfrom test import get_data_frame\n\n@xw.func\ndef ret_data_frame(data):\n    return get_data_frame(data)\n</code></pre>\n\n<p>This idea isn't working, so, the question is:</p>\n\n<p>It's possible to use UDF's to reproduce dataframes?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1505253362, "post_id": 46185881, "comment_id": 79334673, "body": "You are not returning the value.  <code>LastRowInOneColumn = .Cells(.Rows.Count, &quot;A&quot;).End(xlUp).Row</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1505253431, "post_id": 46185881, "comment_id": 79334694, "body": "I would also suggest you use <code>Long</code> instead of <code>Integer</code>"}, {"owner": {"reputation": 1925, "user_id": 3718225, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Vw3EC.png?s=128&g=1", "display_name": "HDCerberus", "link": "https://stackoverflow.com/users/3718225/hdcerberus"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1505253602, "post_id": 46185881, "comment_id": 79334756, "body": "I&#39;m not sure I understand why this works, bit I now understand the return value needs to have the same name as the function for some reason? I don&#39;t understand why placing &quot;Return LastRow&quot; wasn&#39;t working. If you add your answer with a short explanation on why the name of the return value needs to be the same as the function, I&#39;ll happily mark it as accepted."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1505253628, "post_id": 46185881, "comment_id": 79334770, "body": "<code>Return LastRow</code> is VB.Net syntax, not VBA.  The VBA <code>Return</code> statement is used in conjunction with the VBA <code>GoSub</code> statement (see <a href=\"https://msdn.microsoft.com/VBA/Language-Reference-VBA/articles/gosubreturn-statement\" rel=\"nofollow noreferrer\">msdn.microsoft.com/VBA/Language-Reference-VBA/articles/&hellip;</a>), and I strongly recommend that you don&#39;t use the <code>GoSub</code> statement!!"}], "owner": {"reputation": 1925, "user_id": 3718225, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Vw3EC.png?s=128&g=1", "display_name": "HDCerberus", "link": "https://stackoverflow.com/users/3718225/hdcerberus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "closed_date": 1505253762, "answer_count": 0, "score": 0, "last_activity_date": 1505253268, "creation_date": 1505253268, "last_edit_date": 1531164843, "question_id": 46185881, "link": "https://stackoverflow.com/questions/46185881/vba-function-returns-no-value", "closed_reason": "Duplicate", "title": "VBA Function Returns No Value", "body": "<p>When I use pre-configured good code, functions in VBA return values. For example, this: </p>\n\n<pre><code>Sub TestFunction() 'Test Function\n  MsgBox CheckCell(1)\nEnd Sub\n\nFunction CheckCell(CellValue) As Boolean\n  If IsNumeric(CellValue) Then\n    CheckCell = True\n  Else\n    CheckCell = False\n  End If\nEnd Function\n</code></pre>\n\n<p>Correctly returns a value of 'True' when run (or, depending on the input 'False', or if modified to be integers, then integers etc). </p>\n\n<p>However, to me, identical looking code that I have written myself: </p>\n\n<pre><code>Sub TestFunction() 'Test Function\nMsgBox LastRowInOneColumn()\nEnd Sub\n\nFunction LastRowInOneColumn() As Integer\n'Find the last used row in Column A\n    Dim LastRow As Integer\n    With ActiveSheet\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        MsgBox LastRow\n        Exit Function\n    End With\nEnd Function\n</code></pre>\n\n<p>Does not work, no matter how I configure it (Adding a return statement, modifying the inputs etc). Why? What is the difference in how I'm performing these two functions?</p>\n\n<p>To answer some obvious things I've checked: </p>\n\n<ol>\n<li><p>There are a number of values in the A1 column (14 in my sample). </p></li>\n<li><p>The first message box in the function itself prompts with the\ncorrect number, but the value is not returned (Second message box\nhas a value of 0).</p></li>\n<li>This seems to happen to all functions I write\nmyself, even though they appear identical to numerous samples I've\ntried, so I understand I must be the one causing the error. </li>\n<li>I'm using VBA in Excel 2016.</li>\n</ol>\n"}, {"tags": ["vba", "excel", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 225, "user_id": 8592765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfbc123f552b4961420b8690b0e70fac?s=128&d=identicon&r=PG&f=1", "display_name": "Pinlop", "link": "https://stackoverflow.com/users/8592765/pinlop"}, "is_accepted": true, "score": 0, "last_activity_date": 1505505201, "creation_date": 1505505201, "answer_id": 46246652, "question_id": 46185573, "link": "https://stackoverflow.com/questions/46185573/paste-position-over-several-slides-doesnt-carry-through-will-only-paste-in-the/46246652#46246652", "title": "Paste position over several slides doesn&#39;t carry through, will only paste in the middle of slide", "body": "<p>I was able to aggregate everything by creating a new sheet and pasting each column individually onto that sheet then copying that into PowerPoint. </p>\n\n<p>Also, to make it paste where i want it to on the slide, I made sure to make VBA <code>.Select</code> everything.</p>\n\n<pre><code>With xlWB.Worksheets(\"Sheet1\")\n    colNumb = .Cells(1, .Columns.Count).End(xlToLeft).Column\nEnd With\n\nxlWB.Worksheets.Add After:=xlWB.ActiveSheet\n\n'Make pptPres the ppt active\nSet pptPres = PowerPoint.ActivePresentation\n\n'Loop through each pptSlide and check for IQ text box, grab avgScore values and create pptTable\nFor Each pptSlide In pptPres.Slides\n    'searches through shapes in the slide\n    pptSlide.Select\n    For Each Shpe In pptSlide.Shapes\n        'Identify if there is text frame\n        k = 1\n        If Shpe.HasTextFrame Then\n            'Identify if there's text in text frame\n            If Shpe.TextFrame.HasText Then\n                pptText = Shpe.TextFrame.TextRange\n                If InStr(1, pptText, \"iq_\") &gt; 0 Then 'Identify if within text there is \"iq_\" All IQ's have to be formatted like this \"iq_42, iq_43\" for now\n                    iq_Array = Split(pptText, \", \")               'set iq_Array as an array of the split iq's\n                    size = UBound(iq_Array) - LBound(iq_Array)\n                    For arrayLoop = 0 To size   'loop for each iq_array\n                        For i = 1 To colNumb    'loops for checking each column\n                            If i = 1 And arrayLoop = 0 Then  'Copies the first column for every slide\n                                If Len(iq_Array(arrayLoop)) &lt; 4 Then GoTo Line2\n                                xlWB.Worksheets(\"Sheet1\").Columns(1).Copy   'copy column\n                                xlWB.Worksheets(\"Sheet2\").Paste Destination:=xlWB.Worksheets(\"Sheet2\").Columns(1)\n                            ElseIf xlWB.Worksheets(\"Sheet1\").Cells(1, i) = iq_Array(arrayLoop) And i &lt;&gt; 1 Then 'if iq in ppt = iq in xl and if not the first cell then execute\n                                k = k + 1\n                                xlWB.Worksheets(\"Sheet1\").Columns(i).Copy\n                                xlWB.Worksheets(\"Sheet2\").Paste Destination:=xlWB.Worksheets(\"Sheet2\").Columns(k)\n                            End If\n                        Next i\nLine2:\n                    Next arrayLoop\n                End If\n            End If\n        End If\n    Next Shpe\n'calculate last row and last column\nWith xlWB.Worksheets(\"Sheet2\")\n    lRows = .Cells(.Rows.Count, 1).End(xlUp).Row\n    lCols = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    If lRows = .Cells(1, 1).End(xlUp).Row And lCols = .Cells(1, 1).End(xlToLeft).Column Then\n        GoTo Line1\n    End If\n        .Range(.Cells(1, 1), .Cells(lRows, lCols)).Copy\nEnd With\n        pptSlide.Shapes.PasteSpecial DataType:=ppPasteHTML, Link:=msoFalse\n        Set myShape = pptSlide.Shapes(pptSlide.Shapes.Count)\n        'Set position:\n        myShape.Left = -200\n        myShape.Top = 200\n        xlWB.Worksheets(\"Sheet2\").Range(\"A1:P10\").Clear\nLine1:\nNext pptSlide\n\nxlWB.Worksheets(\"Sheet2\").Delete\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 8592765, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfbc123f552b4961420b8690b0e70fac?s=128&d=identicon&r=PG&f=1", "display_name": "Pinlop", "link": "https://stackoverflow.com/users/8592765/pinlop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 46246652, "answer_count": 1, "score": 0, "last_activity_date": 1505505201, "creation_date": 1505251650, "last_edit_date": 1531164843, "question_id": 46185573, "link": "https://stackoverflow.com/questions/46185573/paste-position-over-several-slides-doesnt-carry-through-will-only-paste-in-the", "title": "Paste position over several slides doesn&#39;t carry through, will only paste in the middle of slide", "body": "<p>I'm having a bit of trouble getting the tables that are copied from Excel to be pasted anywhere else other than the middle of the PowerPoint slide. </p>\n\n<p>I need to make the columns looks a uniform table in the end. I haven't been able to figure out how to aggregate all non-contiguous columns into one table, so I will paste each column one by one and move each entry by a couple of digits. </p>\n\n<p>Right now I have it where the columns on the first slide are pasted at <code>myShape.Left = 66</code> and <code>myShape.Top = 152</code>, but after the first slide they just go back to pasting in the middle of the slide.</p>\n\n<p>Any ideas? </p>\n\n<pre><code>Public Sub averageScoreRelay()\n    ' 1. Run from PPT and open an Excel file\n    ' 2. Start at slide 1 and find a box that contains the words \"iq_\", if it has those words then it will have numbers after it like so \"iq_43\" or \"iq_43, iq_56, iq_72\".\n    ' 3. find those words and numbers in the opened Excel file. Needs to recognize that \", \" means there is another entry.\n    ' 3. Copy column containing words from ppt ie. \"iq_43\"\n    ' 4. Paste a Table into ppt with those values\n    ' 5. Do this for every slide\n\n    'Create variables\n    Dim xlApp As Excel.Application\n    Dim xlWB As Excel.Workbook\n    Dim pptSlide As Slide\n    Dim fileName As String\n    Dim Shpe As Shape\n    Dim pptText As String\n    Dim strArray As String\n    Dim pptPres As Object\n    Dim PowerPointApp As Object\n    Dim iq_Array\n    Dim arrayLoop As Integer\n    Dim i As Integer\n    Dim myShape As Object\n\n    ' Create new excel instance and open relevant workbook\n    Set xlApp = New Excel.Application\n    Set xlWB = xlApp.Workbooks.Open(\"C:\\Users\\pinlop\\Desktop\\Gate\\Macro\\averageScores\\pptxlpratice\\dummyavgscore.xlsx\", True, False)  'Open relevant workbook\n    If xlWB Is Nothing Then ' may not need this if statement. check later.\n        MsgBox (\"Error retrieving Average Score Report, Check file path\")\n        Exit Sub\n    End If\n\n    'Is PowerPoint already opened?\n    'Set PowerPointApp = GetObject(class:=\"PowerPoint.Application\")\n\n    'Make PPT visible\n    Set pptPres = PowerPoint.ActivePresentation\n\n    'Loop through each pptSlide and check for IQ text box, grab avgScore values and create pptTable\n    For Each pptSlide In pptPres.Slides\n        'searches through shapes in the slide\n        For Each Shpe In pptSlide.Shapes\n            'Identify if there is text frame\n            If Shpe.HasTextFrame Then\n                'Identify if there's text in text frame\n                If Shpe.TextFrame.HasText Then\n                    pptText = Shpe.TextFrame.TextRange\n                    If InStr(1, pptText, \"iq_\") &gt; 0 Then 'Identify if within text there is \"iq_\" All IQ's have to be formatted like this \"iq_42, iq_43\" for now\n                        iq_Array = Split(pptText, \", \")               'Use function below to Set iq_Array to an array of all iq_'s in the text box\n                        size = UBound(iq_Array) - LBound(iq_Array)\n                        For arrayLoop = 0 To size\n                            For i = 1 To 5\n                                If i = 1 And arrayLoop = 0 Then\n                                    xlWB.Worksheets(\"Sheet1\").Columns(1).Copy\n                                    pptSlide.Shapes.PasteSpecial DataType:=ppPasteHTML, Link:=msoFalse\n                                    Set myShape = pptSlide.Shapes(pptSlide.Shapes.Count)\n                                    'Set position:\n                                    myShape.Left = 66\n                                    myShape.Top = 152\n                                ElseIf xlWB.Worksheets(\"Sheet1\").Cells(1, i) = iq_Array(arrayLoop) And i &lt;&gt; 1 Then\n                                    xlWB.Worksheets(\"Sheet1\").Columns(i).Copy\n                                    pptSlide.Shapes.PasteSpecial DataType:=ppPasteHTML, Link:=msoFalse\n                                    Set myShape = pptSlide.Shapes(pptSlide.Shapes.Count)\n                                    'Set position:\n                                    myShape.Left = 66\n                                    myShape.Top = 152\n                                End If\n                            Next i\n                        Next arrayLoop\n                    End If\n                End If\n            End If\n        Next Shpe\n    Next pptSlide\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1505251526, "post_id": 46185455, "comment_id": 79333914, "body": "1. You can&#39;t equate a full column to a single value, you will need to loop or use find() or some other method to check the value.  2. It should just be <code>Case  &quot;Zamora&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "is_accepted": true, "score": 0, "last_activity_date": 1505252234, "creation_date": 1505252234, "answer_id": 46185694, "question_id": 46185455, "link": "https://stackoverflow.com/questions/46185455/excel-vba-using-select-case-to-delete-cells-in-a-range/46185694#46185694", "title": "Excel VBA Using Select Case to delete cells in a Range", "body": "<p>Here you go! You might want to add it so it checks to see if John and Zamora aren't all lower case if that is needed.</p>\n\n<pre><code>Sub SelectCase()\n\nDim msg As String\nDim VarCase As Range\n\nFor Each VarCase In ActiveSheet.Range(\"D:D\")\n  If VarCase.Value2 = \"John\" Or VarCase.Value2 = \"Zamora\" Then\n  VarCase.ClearContents\n  End If\nNext VarCase\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 8309220, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1b7a01f0f31b26a557fb22bdc9d89adc?s=128&d=identicon&r=PG&f=1", "display_name": "JS Bach", "link": "https://stackoverflow.com/users/8309220/js-bach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "accepted_answer_id": 46185694, "answer_count": 1, "score": 0, "last_activity_date": 1505252234, "creation_date": 1505251053, "question_id": 46185455, "link": "https://stackoverflow.com/questions/46185455/excel-vba-using-select-case-to-delete-cells-in-a-range", "title": "Excel VBA Using Select Case to delete cells in a Range", "body": "<p>I have a range of data, and I am programming to remove a names from a range. Here is my code.</p>\n\n<pre><code>Option Explicit\n\nSub SelectCase()\n\nDim msg As String\nDim VarCase As Range\n\nSet VarCase = Worksheets(\"Data\").Range(\"D:D\")\n\nSelect Case VarCase\n\n    Case VarCase = \"Zamora\"\n    VarCase.Delete\n\n    Case VarCase = \"John\"\n    VarCase.Delete\n\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p>I am getting an error message Run-time error '13' Type mismatch, is this due to trying to use a string (\"Zamora/John\") with a range?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1505251337, "post_id": 46185415, "comment_id": 79333834, "body": "<code>Selection.Columns(&quot;A:D&quot;).Offset(0,10).Value = Selection.Columns(&quot;A:D&quot;).Value</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "is_accepted": false, "score": 0, "last_activity_date": 1505289348, "creation_date": 1505289348, "answer_id": 46191954, "question_id": 46185415, "link": "https://stackoverflow.com/questions/46185415/vba-to-return-range-based-on-a-selection/46191954#46191954", "title": "VBA to return range based on a selection", "body": "<p>This will get only the rows that you selected instead of the whole column.</p>\n\n<pre><code>ActiveCell.Offset(, 10).Resize(Selection.Rows.Count, 4).Value = Selection.Resize(Selection.Rows.Count, 4).Value\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8599982, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-E1giHZN7qRc/AAAAAAAAAAI/AAAAAAAAANk/Thi5tkRAKXY/photo.jpg?sz=128", "display_name": "JordanB", "link": "https://stackoverflow.com/users/8599982/jordanb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 350, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1505289348, "creation_date": 1505250877, "question_id": 46185415, "link": "https://stackoverflow.com/questions/46185415/vba-to-return-range-based-on-a-selection", "title": "VBA to return range based on a selection", "body": "<p>I have what I think is a fairly simple VBA task I want to execute. It should, based on a column of cells I select, output the contents of those cells plus cells in next three columns to another place on my spreadsheet.</p>\n\n<p>The code is:</p>\n\n<pre><code>ActiveCell.Offset(0, 10) = Selection.Columns(\"a:d\")\n</code></pre>\n\n<p>So, I would select say G2:G10, then it will return what is in G2:J10 in a range beginning with the cell 10 columns over from G2. It should accomplish the same thing as the following code, but without copy-paste.</p>\n\n<pre><code>Selection.Columns(\"a:d\").Copy\nActiveCell.Offset(0, 10).PasteSpecial\n</code></pre>\n\n<p>Thanks for any help!\nJordan</p>\n"}, {"tags": ["arrays", "vba", "excel", "loops", "if-statement"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1505250500, "post_id": 46185272, "comment_id": 79333519, "body": "have you stepped through the code line-by-line and tested the result of each line to see what the expected behavior is not happening?"}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1505251124, "post_id": 46185272, "comment_id": 79333769, "body": "I have stepped through - it simply goes through each line, and doesn&#39;t move over when I&#39;d expect it to. Should try it with a debug.print statement at each line... Headers are moving over correctly, should put that in."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1505251592, "post_id": 46185272, "comment_id": 79333942, "body": "<code>For i = 2 To i = LastRowMSC</code> should be <code>For i = 2 To LastRowMSC</code>"}, {"owner": {"reputation": 43748, "user_id": 1967396, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qBbwd.png?s=128&g=1", "display_name": "Floris", "link": "https://stackoverflow.com/users/1967396/floris"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1505252043, "post_id": 46185272, "comment_id": 79334133, "body": "@ScottCraner that certainly looks like a problem."}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1505252732, "post_id": 46185272, "comment_id": 79334417, "body": "Fixed that, fixed a 1004 that generated after, updated code to reflect the changes - still no data is being moved over"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1505252950, "post_id": 46185272, "comment_id": 79334491, "body": "this <code>&quot;E&quot; &amp; i</code> inside the match, I assume should be <code>mstab.Range(&quot;E&quot; &amp; i)</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1505252999, "post_id": 46185272, "comment_id": 79334517, "body": "Unless you are searching for the string <code>&quot;E2&quot;</code>,<code>&quot;E3&quot;</code>,... instead of the value in those cells."}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1505254469, "post_id": 46185272, "comment_id": 79335019, "body": "Yup, just worked that out, was coming here to update that it now all works! Thank you @ScottCraner"}], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505254898, "creation_date": 1505250181, "last_edit_date": 1505254898, "question_id": 46185272, "link": "https://stackoverflow.com/questions/46185272/conditionally-moving-data-over-based-off-of-a-named-range", "title": "Conditionally moving data over based off of a named range", "body": "<p>This has been driving me nuts for awhile. What I'm trying to do is, in theory, fairly simple. </p>\n\n<p>I have a list of names I care about. This list of names is in a named range. I'd like to open a report, see if the name in a particular column is on the list, and if it is, move it over. Otherwise, don't move it over. I've tried putting the list in a range, in a variant, just referencing it directly. I've tried loops, conditionals, loops within loops, worksheet functions, no worksheet functions, ubound and lbound, isnumeric, deleting the rows and moving everything over, and more. I just can't get it to work. Current set of code:</p>\n\n<pre><code>Dim i As Long\nDim j As Long\nDim MSCFundList As Range\n\nCABReconFilePath = Range(\"CABReconFilePath\")\nSet MSCFundList = Range(\"MSCFundList\")\n\nWorkbooks.Open Filename:=CABReconFilePath       \nSet CabReport = ActiveWorkbook\n\nWorkbooks.Open Filename:=MSCReportPath\nSet MSCReport = ActiveWorkbook\n\nSet MSTab = MSCReport.Sheets(1)\n\nLastRowMSC = MSTab.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nj = 2 ' count the row offset in the destination range\n\n'Getting in the headers\nSet RngMSC = MSTab.Range(\"A1:AZ1\")\nCabReport.Sheets(\"MS\").Range(\"A1:AZ1\").Value = RngMSC.Value\n\nFor i = 2 To LastRowMSC\n    Debug.Print LastRowMSC\n    If IsNumeric(Application.Match(range(\"E\" &amp; I), MSCFundList, 0)) Then\n        Set RngMSC = MSTab.Range(\"A\" &amp; i &amp; \":AZ\" &amp; i)\n        CabReport.Sheets(\"MS\").Range(\"A\" &amp; j &amp; \":AZ\" &amp; j).Value = RngMSC.Value\n        j = j + 1\n   End If\n</code></pre>\n\n<p>Next </p>\n\n<p>I'm at my wits' end. I've gone over a few different stack overflow posts - the most promising one was <a href=\"https://stackoverflow.com/questions/38267950/check-if-a-value-is-in-an-array-or-not-with-excel-vba\">Check if a value is in an array or not with Excel VBA</a></p>\n\n<p>Edit: Expected behavior: Only some rows move over. Actual behavior: No rows move over. Headers are moving over correctly. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "edited": false, "score": 0, "creation_date": 1505251623, "post_id": 46185332, "comment_id": 79333962, "body": "You&#39;re right about the cutting and pasting messing with the nRowMax... However, when i try to change it to a do loop instead of a for loop, I&#39;m getting a &quot;Loop without Do&quot; error. Can you show me what part of my code needs to be left out and where i should put that &quot;Do&quot; part?"}, {"owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "reply_to_user": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "edited": false, "score": 0, "creation_date": 1505282489, "post_id": 46185332, "comment_id": 79341918, "body": "i&#39;ve just edited my answer to include the whole code"}, {"owner": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "edited": false, "score": 0, "creation_date": 1505320825, "post_id": 46185332, "comment_id": 79368428, "body": "Thanks for including the whole code.. Your code makes the most sense given the fact that I am having problems with the data set shifting. The code seems to ignore the selection cut-&gt; copy part... so it just continues checking column D all the way without doing anything"}, {"owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "reply_to_user": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "edited": false, "score": 0, "creation_date": 1505324249, "post_id": 46185332, "comment_id": 79370363, "body": "could u put your source data or its image on github or onedrive?"}, {"owner": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "edited": false, "score": 0, "creation_date": 1505327430, "post_id": 46185332, "comment_id": 79372215, "body": "i added a picture to my original post.. if you need me to put the source data to Onedrive i can go ahead and do that"}, {"owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "reply_to_user": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "edited": false, "score": 0, "creation_date": 1505330801, "post_id": 46185332, "comment_id": 79374053, "body": "now i&#39;ve changed my code again and tried accordin to your pic, it works fine."}], "tags": [], "owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "is_accepted": false, "score": 0, "last_activity_date": 1505330762, "last_edit_date": 1505330762, "creation_date": 1505250487, "answer_id": 46185332, "question_id": 46185007, "link": "https://stackoverflow.com/questions/46185007/macro-cuts-and-paste-whole-row-below-data-loop/46185332#46185332", "title": "Macro cuts and paste whole row below data loop", "body": "<p>Since you cut rows your nRowMax gets meaningless. Say, you have 1000 rows, but you cut 100 of them, so eventually you'll have 900 rows but you still try to loop through between 901st and 1000nd rows as well.</p>\n\n<p>as a solution, you could create your loop as a do loop instead of for loop, like below.</p>\n\n<pre><code>Sub MoveOPENS()\n\n    Dim sItem As String\n\n    Cells(2, 1).Select\n    r = 1\n    Do\n        sItem = ActiveCell.Offset(0, 3).Value\n\n        If Left(sItem, 1) = \"O\" Then\n            r = ActiveCell.Row\n            ActiveCell.EntireRow.Select\n            Selection.Cut\n            'moves the cursor to below the data set\n            Cells(1000000, 1).End(xlUp).Offset(1, 0).Select\n            Selection.Insert\n            Cells(r, 1).Select\n        Else\n            ActiveCell.Offset(1, 0).Select\n        End If\n\nLoop Until IsEmpty(ActiveCell)\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "edited": false, "score": 0, "creation_date": 1505251867, "post_id": 46185350, "comment_id": 79334067, "body": "This still produced the same issue i was having before. @ExcelinEfendisi was right that the cut and paste is making the lRowMax ineffective"}], "tags": [], "owner": {"reputation": 81, "user_id": 7376089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56befb81b26f1ee2c1e12b2e533088e8?s=128&d=identicon&r=PG&f=1", "display_name": "HappyVba", "link": "https://stackoverflow.com/users/7376089/happyvba"}, "is_accepted": false, "score": 0, "last_activity_date": 1505250550, "creation_date": 1505250550, "answer_id": 46185350, "question_id": 46185007, "link": "https://stackoverflow.com/questions/46185007/macro-cuts-and-paste-whole-row-below-data-loop/46185350#46185350", "title": "Macro cuts and paste whole row below data loop", "body": "<p>How about:</p>\n\n<pre><code>Sub MoveOPENS()\n\n    Dim lRowMax As Long\n    Dim sItem As String\n\n\n'this is what im using to establish the last row in the data set\n    Cells(1, 1).Select\n    Selection.End(xlDown).Select\n    lRowMax = Selection.Row\n\n    For i = 2 To lRowMax\n        sItem = Cells(i, 4).Value\n\n        If Left(sItem, 1) = \"O\" Then\n            Rows(i).Select\n            Selection.Cut\n            'moves the cursor to below the data set\n            Selection.End(xlToLeft).Select\n            Selection.End(xlDown).Select\n            Selection.Offset(4, 0).Select\n            'this part works well but it thinks the loop doesn't stop\n            'and will start copy and pasting below the new data section\n            Selection.Insert\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "edited": false, "score": 0, "creation_date": 1505253840, "post_id": 46185591, "comment_id": 79334837, "body": "I think my issue with what i was doing was trying to have the code cut copy and insert paste which was shifting the data. I am going to forgo that method and go with yours while sticking an If statement that will delete the rows we just pasted. Thanks!"}, {"owner": {"reputation": 183, "user_id": 5573687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41f5bf563be73c33e4352abcc722dc91?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5573687/fred"}, "reply_to_user": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "edited": false, "score": 0, "creation_date": 1505257748, "post_id": 46185591, "comment_id": 79335852, "body": "No problem.  If my answer worked for you, I would appreciate it if you would accept my answer.  This also helps the community so that everyone can focus on questions that are not already answered.  Thanks."}, {"owner": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "edited": false, "score": 0, "creation_date": 1505321087, "post_id": 46185591, "comment_id": 79368595, "body": "so my plan to use an if statement to delete the rows we just copied didn&#39;t work.. So since your code doesn&#39;t <i>cut</i> and copy, its not going to work for this scenario. if your code is able to <i>cut</i> and paste below data while dealing with the resulting shifting of the data, than that would be more what I&#39;m looking for!"}, {"owner": {"reputation": 183, "user_id": 5573687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41f5bf563be73c33e4352abcc722dc91?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5573687/fred"}, "reply_to_user": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "edited": false, "score": 0, "creation_date": 1505323962, "post_id": 46185591, "comment_id": 79370218, "body": "I revised my answer to include cutting and deleting of the data, while accounting for the shift."}, {"owner": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "edited": false, "score": 0, "creation_date": 1505326778, "post_id": 46185591, "comment_id": 79371839, "body": "ok that worked but when it gets to the last row, the macro doesn&#39;t want to end (Not Responding) unless i end it. Not sure if it is continuing to check the data and isn&#39;t sure when to stop the if?"}, {"owner": {"reputation": 183, "user_id": 5573687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41f5bf563be73c33e4352abcc722dc91?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5573687/fred"}, "reply_to_user": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "edited": false, "score": 0, "creation_date": 1505329624, "post_id": 46185591, "comment_id": 79373437, "body": "You are correct.  I had the check for hitting the last line within the original if statement, so it only worked when the last row was a row that qualified to be moved.  I happened to have it that way in my test data, so it worked.  I edited the code again and you should be good now."}], "tags": [], "owner": {"reputation": 183, "user_id": 5573687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41f5bf563be73c33e4352abcc722dc91?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5573687/fred"}, "is_accepted": true, "score": 1, "last_activity_date": 1505329514, "last_edit_date": 1505329514, "creation_date": 1505251734, "answer_id": 46185591, "question_id": 46185007, "link": "https://stackoverflow.com/questions/46185007/macro-cuts-and-paste-whole-row-below-data-loop/46185591#46185591", "title": "Macro cuts and paste whole row below data loop", "body": "<p>I hope you don't mind that I re-wrote the code from scratch.  It looks like you might have recorded a macro to do this, which is a good place to start when you are not sure how to approach it, but it also produces some very inefficient and confusing code sometimes.  </p>\n\n<p>Anyway, this should work for you:</p>\n\n<pre><code>Sub MoveOPENS()\n\nDim LastRow, NewLast, MovedCount As Integer\n\nLastRow = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"A\").End(xlUp).Row 'Find last Row\nNewLast = LastRow + 1 'NewLast tracks the new last row as rows are copied and pasted at the end\nMovedCount = 0\n    For i = 2 To LastRow\n        If Left(Cells(i, 4), 1) = \"O\" Then    'Copy the row, increment NewLast and paste at the bottom.\n            Rows(i).Cut\n            'LastRow = LastRow - 1\n            Cells(NewLast, 1).Select\n            ActiveSheet.Paste\n            Rows(i).Delete\n            i = i - 1  'Since we deleted the row, we must decrement i\n            MovedCount = MovedCount + 1  'Keeps track of number of rows moved so as not to overshoot the original last line\n\n        End If\n        If i + MovedCount = LastRow Then Exit For 'Exit For loop if we reached the original last line of the file\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 8539483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-n2QbBnq1Qg8/AAAAAAAAAAI/AAAAAAAAAf8/-JzZSfFL9wQ/photo.jpg?sz=128", "display_name": "Gabe Carvajal", "link": "https://stackoverflow.com/users/8539483/gabe-carvajal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1041, "favorite_count": 0, "accepted_answer_id": 46185591, "answer_count": 3, "score": 0, "last_activity_date": 1505330762, "creation_date": 1505248941, "last_edit_date": 1505327374, "question_id": 46185007, "link": "https://stackoverflow.com/questions/46185007/macro-cuts-and-paste-whole-row-below-data-loop", "title": "Macro cuts and paste whole row below data loop", "body": "<p>I have a report that lists the sales for a salesperson for the month. When the type of sale is \"Open\", the cell in column D will start with O (Open order, open layaway, etc). I can't include the open orders in the subtotal for their monthly sales, but instead have the opens orders in a separate section below their sales in a section called \"Open Orders\".</p>\n\n<p>So what I need the macro to do is whenever a cell in column D starts with an O, <em>cut</em> whole row and <em>insert</em> (needs to be insert so their isn't blanks when pasting) paste below the data. This will shift the data since we are inserting. The problem that I'm having is that the macro will continue to cut and paste even though we have gone through all the rows in the data set. </p>\n\n<pre><code>Sub MoveOPENS()\n\n'this is what im using to establish the last row in the data set\n  Cells(1, 1).Select\n  Selection.End(xlDown).Select\n  nRowMax = Selection.Row\n\nFor i = 2 To nRowMax\n    sItem = Cells(i, 4)\n\n    Do While Left(sItem, 1) = \"O\"\n        Rows(i).Select\n        Selection.Cut\n    'moves the cursor to below the data set\n        Selection.End(xlToLeft).Select\n        Selection.End(xlDown).Select\n        Selection.Offset(4, 0).Select\n    'this part works well but it thinks the loop doesn't stop \n    'and will start copy and pasting below the new data section\n    Selection.Insert\n        sItem = Cells(i, 4)\n    Loop\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>How can i get the macro to know when we have reached the last row so it doesn't continue cutting and paste the rows we just copied and pasted? let me know if you need more details</p>\n\n<p><a href=\"https://i.stack.imgur.com/Tc3mt.png\" rel=\"nofollow noreferrer\">Here is what the excel sheet looks like</a></p>\n"}, {"tags": ["excel", "vlookup", "vba"], "comments": [{"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1505248844, "post_id": 46184915, "comment_id": 79332723, "body": "It sounds like you have a &quot;master&quot; (and presumably correct) set of reliable data and then 12 separate spreadsheets that have <i>delimited</i> partial data. But the ID is the key.  So why even bother searching for &quot;unknown&quot;?  Just write a macro that fetches your master data based on the IDs in the &quot;unknown&quot; sheets. Excel might not even be best for this; a bash <code>join</code> could probably do what you want. Have you attempted anything? If so, can you show your attempt?"}, {"owner": {"reputation": 11, "user_id": 8599830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ced7e59e943a9814cba7c8bb19a7a26?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/8599830/gary"}, "edited": false, "score": 0, "creation_date": 1505251378, "post_id": 46184915, "comment_id": 79333845, "body": "Hi Marc, you are pretty much on the mark with the master spreadsheet assumption. Its actually closer to 50 with delimited partial data. My only issue with a macro is my limited understanding of VBA and how a macro will deal with a scenario where the ID copied from spreadsheet A does not match any of the master spreadsheets IDs. This can happen from time to time and requires a request to be sent for additional information. Will the macro ignore all unmatched records in this case. This is an issue when there&#39;s so many spreasdsheets- rework, etc"}, {"owner": {"reputation": 11, "user_id": 8599830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ced7e59e943a9814cba7c8bb19a7a26?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/8599830/gary"}, "edited": false, "score": 0, "creation_date": 1505251431, "post_id": 46184915, "comment_id": 79333871, "body": "Apologies for the confusion Yow, I meant to write &#39;SOF&#39; as in; Stackoverflow. Hope I put your mind at rest atleast."}, {"owner": {"reputation": 384, "user_id": 4475468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d04747a9bf180c8fb9fc145ec5133d1?s=128&d=identicon&r=PG", "display_name": "Joffan", "link": "https://stackoverflow.com/users/4475468/joffan"}, "edited": false, "score": 0, "creation_date": 1505282331, "post_id": 46184915, "comment_id": 79341850, "body": "How accurate is your format there?  Is it literally &quot;SomeString;NamePart;IDPart&quot;? Do you get other separators? I mean I might suggest that you break the string &quot;TextToColumns&quot;, then filter and paste in some kind of lookup formula as required. But a macro is possible and it does sound like some kind of automation is needed."}], "owner": {"reputation": 11, "user_id": 8599830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ced7e59e943a9814cba7c8bb19a7a26?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/8599830/gary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1505266418, "creation_date": 1505248480, "last_edit_date": 1531161705, "question_id": 46184915, "link": "https://stackoverflow.com/questions/46184915/ms-excel-optimising-my-process", "title": "MS Excel- Optimising my process", "body": "<p>I'm looking for SO's finest MS Excel savants who could potentially crack a painfully annoying issue I have been facing on a daily basis. To put it briefly; I work with sets of data on MS Excel on a daily basis and I frequently have to use the CTRL+F solution to find the criteria I am looking for so I can subsequently replace it with another value. Take the following example:</p>\n\n<p>I have two spreadsheets open- A and B. In spreadsheet A I will have to CTRL+F the word 'unknown'. This will give a result which will contain the word unknown (of course) among other information which I require i.e. 'ABCCorpeation;Unknown;ID1234'. I then manually CTRL+C the ID value at the end of this string of information and open up spreadsheet B. I again CTRL+F and instead of searching for 'uknown' in spreadsheet B, I paste my copied ID. Spreadsheet B is a very simple spreadsheet which just contains IDs and names, so when I paste this ID it gives me a single result and in the column beside it, I can copy down the name associated with the ID. I then go back to spreadsheet A and replace the word 'unknown' with this copied name. Then I would move on.</p>\n\n<p>I assume you struggled to read through that cripplingly long-winded description of my task, but that is an issue which I have to laboriously tackle every day. To add to my woes; the spreadsheet 'A' I describe is actually dozens of spreadsheets which I look for the word unknown in and replace with an actual name after matching it with its corresponding ID.</p>\n\n<p>So my big question is; is there any way that this could be conceivably simplified using a several nested functions or perhaps by the creation of a macro, because to date I have been struggling to do this or even fathom how to tackle it or what to use. Please Stack Overflow, help this MS Excel goblin ease the pain in his fingers. Any advice would be truly appreciated</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 2, "creation_date": 1505249108, "post_id": 46184593, "comment_id": 79332856, "body": "Probably not related to issue but should set warnings back to True at end of procedure. Or use CurrentDb.Execute and won&#39;t have to bother with SetWarnings. Is radio button part of an option group that is bound to field? Is user entering data into record and then you are trying to run UPDATE on that same record? Commit user edits to table first."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1505249981, "post_id": 46184593, "comment_id": 79333289, "body": "I agree with June7, it&#39;s probably a problem with uncommited changes. It&#39;s likely the answer in the duplicate just works because a requery also commits changes, but there are more explicit ways of commiting changes (such as <code>DoCmd.RunCommand acCmdSaveRecord</code>)"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1505252582, "post_id": 46184593, "comment_id": 79334359, "body": "There is no user input; once the user clicks the radio button the query will run either one of those situations once depending on the status of the radio button (on or off). I will turn the warning messages back on, I just forgot to put that line in, thanks for the reminder! No it&#39;s not bound to any field either, it&#39;s just a button on it&#39;s own with a label beside it"}], "answers": [{"tags": [], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "is_accepted": true, "score": 0, "last_activity_date": 1505253162, "creation_date": 1505253162, "answer_id": 46185866, "question_id": 46184593, "link": "https://stackoverflow.com/questions/46184593/access-db-vba-data-conflict/46185866#46185866", "title": "Access DB VBA Data conflict", "body": "<p>Thanks to Ken White from an earlier post they found</p>\n\n<blockquote>\n  <p>Possible duplicate of <a href=\"https://stackoverflow.com/questions/16217844/the-data-has-been-changed-error-when-stepping-from-main-form-into-sub-form\">\"The data has been changed\" error when stepping from main form into sub form</a></p>\n</blockquote>\n\n<p>I tried adding the below code into the <strong>After Update</strong> field</p>\n\n<pre><code>Private Sub radioNECC10000_AfterUpdate()\n    Me.Form.Requery\nEnd Sub\n</code></pre>\n\n<p>Worked and is no longer providing me with that message</p>\n"}], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "closed_date": 1505331649, "accepted_answer_id": 46185866, "answer_count": 1, "score": 0, "last_activity_date": 1505253162, "creation_date": 1505246922, "question_id": 46184593, "link": "https://stackoverflow.com/questions/46184593/access-db-vba-data-conflict", "closed_reason": "Duplicate", "title": "Access DB VBA Data conflict", "body": "<p>I'm running a database at work with only one user, and every time I run the below code when clicking an individual radio button it's giving me the message</p>\n\n<blockquote>\n  <p>The Data has been changed Another user has edited this record and\n  saved the changes before you attempted to save your changes.\n       Re-edit the record.</p>\n</blockquote>\n\n<p>This message only comes up after click the button a second time; once clicking it a third time the value is changed.</p>\n\n<pre><code>Private Sub radioNECC10000_Click()\n\nDim SQL As String\n\nDoCmd.SetWarnings False\nIf (IsNull(Me.VendorNum.Value)) Then\n    MsgBox (\"Please select a vendor!\")\nElse\n    If (Me.radioNECC10000 = True) Then\n        SQL = \"UPDATE tbleVendorRecord \" &amp; _\n                 \"SET NECC_10000 = 10000 \" &amp; _\n               \"WHERE Vendor_ID = \" &amp; VendorNum &amp; \" \"\n        DoCmd.RunSQL SQL\n    Else\n        SQL = \"UPDATE tbleVendorRecord \" &amp; _\n                 \"SET NECC_10000 = 0 \" &amp; _\n               \"WHERE Vendor_ID = \" &amp; VendorNum &amp; \" \"\n        DoCmd.RunSQL SQL\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505247387, "post_id": 46184581, "comment_id": 79332108, "body": "Have you tried recording a macro while you add a filter manually to see what code gets generated?"}, {"owner": {"reputation": 41, "user_id": 7921970, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/702dfbe621a709580bf0fba9193f6698?s=128&d=identicon&r=PG&f=1", "display_name": "ofir ", "link": "https://stackoverflow.com/users/7921970/ofir"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505251899, "post_id": 46184581, "comment_id": 79334076, "body": "i need a second filter and looping:pvt.PivotFields(&quot;de_em&quot;).Orientation = xlPageField .    the variable de_em  has to values(0 and 1)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505251961, "post_id": 46184581, "comment_id": 79334099, "body": "Then why don&#39;t you do that?"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7921970, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/702dfbe621a709580bf0fba9193f6698?s=128&d=identicon&r=PG&f=1", "display_name": "ofir ", "link": "https://stackoverflow.com/users/7921970/ofir"}, "edited": false, "score": 0, "creation_date": 1505253204, "post_id": 46185345, "comment_id": 79334600, "body": "i think i need to use something like that:  For Each cell In                  pvt.PivotFields(&quot;de_em&quot;)        Next cell                            but i dont know how"}], "tags": [], "owner": {"reputation": 486, "user_id": 8549087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q5GXn.png?s=128&g=1", "display_name": "DaBeau96", "link": "https://stackoverflow.com/users/8549087/dabeau96"}, "is_accepted": false, "score": 0, "last_activity_date": 1505253321, "last_edit_date": 1505253321, "creation_date": 1505250530, "answer_id": 46185345, "question_id": 46184581, "link": "https://stackoverflow.com/questions/46184581/how-can-i-add-filter-to-my-pivot-table-with-vba/46185345#46185345", "title": "how can i add filter to my pivot table with vba", "body": "<p>Here's how to add filter to a pivot table that I know of.</p>\n\n<pre><code>Dim pvt As PivotTable\n\nSet pvt = ActiveSheet.PivotTables(\"PivotTable1\") \n\n'Adds to the Report Filter\npvt.PivotFields(\"DB\").Orientation = xlPageField\n\n'Adds to the Column Labels\npvt.PivotFields(\"DB\").Orientation = xlColumnField\n\n'Adds to the Row Labels\npvt.PivotFields(\"DB\").Orientation = xlRowField\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7921970, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/702dfbe621a709580bf0fba9193f6698?s=128&d=identicon&r=PG&f=1", "display_name": "ofir ", "link": "https://stackoverflow.com/users/7921970/ofir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1624, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505253321, "creation_date": 1505246870, "last_edit_date": 1531164843, "question_id": 46184581, "link": "https://stackoverflow.com/questions/46184581/how-can-i-add-filter-to-my-pivot-table-with-vba", "title": "how can i add filter to my pivot table with vba", "body": "<p>Using VBA code, I have created a Pivot table and then added row, columns and values.Now I need to add  filters.\nCan you please let me know how can I add filters?</p>\n\n<p>I have a VBA code that need to loop over Pivot Table with filters.\nso far:</p>\n\n<pre><code>     'Add item to the Report Filter- chose the filter that you want\n     pvt.PivotFields(\"DB\").Orientation = xlPageField\n     'Position Item in list\n     pvt.PivotFields(\"DB\").Position = 1\n</code></pre>\n\n<p>Any help will be much appreciated!</p>\n"}, {"tags": ["vba", "excel", "email"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1505246737, "post_id": 46184424, "comment_id": 79331813, "body": "Have you tried <code>.Text</code>?"}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 1, "creation_date": 1505247152, "post_id": 46184424, "comment_id": 79331986, "body": "The statement <code>For Each cell In Columns(&quot;N&quot;).Cells.SpecialCells(xlCellTypeConstants)</code> only iterates <code>cell</code> that have constants that is not formula. Thus this would never return a <code>cell</code> that has formula that creates the email address."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505247349, "post_id": 46184424, "comment_id": 79332084, "body": "Are you sure there is a formula in column N?  I.e. when you look at the cell does it show an actual email address, and you only see the formula when you edit the cell?  Or are you seeing the &quot;formula&quot; even when just looking at the cell on the screen.  (I am suspecting that someone had formatted the cell as &quot;Text&quot; and then typed a formula in, which will therefore just be interpreted as text and not a formula.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505253203, "post_id": 46184424, "comment_id": 79334599, "body": "FWIW - the correct way of getting the value of a cell (i.e. what has been calculated by the formula in the cell) is to use the <b><code>.Value</code></b> property, or to use the <code>.Value2</code> property (if you don&#39;t want the value returned as a <code>Date</code> or <code>Currency</code> type), or to use the <code>.Text</code> property (if you want the value as a string after applying any cell formatting).  So, in your situation, the use of <code>.Value</code> is the correct method."}, {"owner": {"reputation": 23, "user_id": 8599511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08413611710ce87591f7332f8d8fbe20?s=128&d=identicon&r=PG&f=1", "display_name": "dkramer", "link": "https://stackoverflow.com/users/8599511/dkramer"}, "edited": false, "score": 0, "creation_date": 1505255175, "post_id": 46184424, "comment_id": 79335224, "body": ".value is what I&#39;m using, and none of the fields are formatted to text, they&#39;re all formatted to general, except for two: dates and number"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 0, "creation_date": 1505256728, "post_id": 46184424, "comment_id": 79335613, "body": "(a) A field can contain text and still be formatted as <code>General</code> (e.g. type <code>&#39;=A1+1</code> into a cell and see what happens, or format a cell as <code>Text</code> and then enter <code>=A1+1</code> and then change it back to <code>General</code>) (b) However, if your cell is displaying the email address and not the formula, then (as @bulbus mentioned) your code won&#39;t be reaching the statement containing <code>Cells(cell.Row, &quot;N&quot;).Value</code> because it isn&#39;t a constant.  (c) Perhaps it would help if you included in the question a screenshot of your &quot;DisclosuresCancel&quot; sheet."}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 0, "creation_date": 1505261456, "post_id": 46184424, "comment_id": 79336684, "body": "Right after the <code>for</code> statement  try putting <code>MsgBox(cell.address() &amp; cell.value())</code>. This should resolve your issue. Keep the code as is as your original post."}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 0, "creation_date": 1505261749, "post_id": 46184424, "comment_id": 79336746, "body": "Also remove temporarily <code>On Error Resume Next</code> &amp; <code>On Error GoTo 0</code> till you resolve the issue."}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 0, "creation_date": 1505262408, "post_id": 46184424, "comment_id": 79336880, "body": "Also just a note that your <code>simple solution</code> mentioned in your post is working because you converted the column N to constant cells. Refer my original comment."}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 0, "creation_date": 1505262552, "post_id": 46184424, "comment_id": 79336911, "body": "Simple solution is change <code>For Each cell In Columns(&quot;N&quot;).Cells.SpecialCells(xlCellTypeConstants)</code> to <code>For Each cell In Columns(&quot;N&quot;).Cells</code> and everything should work fine. But I would like you to resolve this by trying my earlier <code>MsgBox</code> comments."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1505333789, "post_id": 46184424, "comment_id": 79375604, "body": "Re your last edit - you can&#39;t use <code>cell.Row</code> until you have created <code>cell</code> (in your <code>For Each cell In Columns(&quot;N&quot;).Cells.SpecialCells(xlCellTypeConstants)</code> block)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8599511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08413611710ce87591f7332f8d8fbe20?s=128&d=identicon&r=PG&f=1", "display_name": "dkramer", "link": "https://stackoverflow.com/users/8599511/dkramer"}, "edited": false, "score": 0, "creation_date": 1505255387, "post_id": 46184628, "comment_id": 79335279, "body": "I did all that, and changed all the references, but now I&#39;m getting an Error 91, since I didn&#39;t &quot;Set&quot; something.. but I don&#39;t know what I&#39;d need to Set. Another question: If I set those variants up like <code>ato = Cells(cell.Row, &quot;N&quot;).Value</code> will that work across multiple sheets? Like, as long as the code selects a new worksheet, will it work and reference the cell from that sheet?"}, {"owner": {"reputation": 2173, "user_id": 8259647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMyr5.jpg?s=128&g=1", "display_name": "Kresimir L.", "link": "https://stackoverflow.com/users/8259647/kresimir-l"}, "reply_to_user": {"reputation": 23, "user_id": 8599511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08413611710ce87591f7332f8d8fbe20?s=128&d=identicon&r=PG&f=1", "display_name": "dkramer", "link": "https://stackoverflow.com/users/8599511/dkramer"}, "edited": false, "score": 0, "creation_date": 1505286635, "post_id": 46184628, "comment_id": 79344201, "body": "As long as the code select new Worksheet before adding new value to variable, it will work."}, {"owner": {"reputation": 23, "user_id": 8599511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08413611710ce87591f7332f8d8fbe20?s=128&d=identicon&r=PG&f=1", "display_name": "dkramer", "link": "https://stackoverflow.com/users/8599511/dkramer"}, "edited": false, "score": 0, "creation_date": 1505313596, "post_id": 46184628, "comment_id": 79363530, "body": "I updated my original question to show how I initialize my VBA, can you tell me why I&#39;m getting an error 91 when I&#39;m trying to set my first variable? (BTW, thanks for all your help so far!)"}], "tags": [], "owner": {"reputation": 2173, "user_id": 8259647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMyr5.jpg?s=128&g=1", "display_name": "Kresimir L.", "link": "https://stackoverflow.com/users/8259647/kresimir-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1505247203, "last_edit_date": 1505247203, "creation_date": 1505247092, "answer_id": 46184628, "question_id": 46184424, "link": "https://stackoverflow.com/questions/46184424/in-vba-how-do-i-call-the-value-of-a-cell-thats-populated-by-a-reference-formul/46184628#46184628", "title": "In VBA, how do I call the value of a cell that&#39;s populated by a reference formula", "body": "<p>Try assigning cell values to variables before using them in <code>With OutMmail</code>. </p>\n\n<pre><code>Dim ato as Variant, acc as Variant, Subja as Variant, Subjb as Variant\nato = Cells(cell.Row, \"N\").Value\nacc = Cells(cell.Row, \"O\").Value\nSubja = Cells(cell.Row, \"D\").Value\nSubjb = Cells(cell.Row, \"C\").Value\n</code></pre>\n\n<p>then later on use them as follows:</p>\n\n<pre><code>With OutMail\n    .To = ato\n    .Cc = acc\n    .Subject = Subja &amp; \", \" &amp; Subjb &amp; \", Expiring Locks - \" &amp; Date\n    .Body = \"Sample Email\"\n    .Send\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8599511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08413611710ce87591f7332f8d8fbe20?s=128&d=identicon&r=PG&f=1", "display_name": "dkramer", "link": "https://stackoverflow.com/users/8599511/dkramer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 705, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1505313371, "creation_date": 1505246260, "last_edit_date": 1505313371, "question_id": 46184424, "link": "https://stackoverflow.com/questions/46184424/in-vba-how-do-i-call-the-value-of-a-cell-thats-populated-by-a-reference-formul", "title": "In VBA, how do I call the value of a cell that&#39;s populated by a reference formula", "body": "<p>Every day, I get a list of files that I have to email different people customized emails depending on different parameters (e.g., if a file hasn't moved in X days they'll get one email, if a file is at a certain milestone they'll get a different email, etc)</p>\n\n<p>This is how I approached it, which may not have been the best way, but I wanted to avoid doing all the sorting logic in VBA because I'm not as familiar with it.</p>\n\n<p>First, I paste the list and parameters into a worksheet, and then I have a separate worksheet for each custom email, using some nested IF statements to show each file on the correct worksheet, like this:</p>\n\n<pre><code>=IF(AND(Broker!$Q3=\"N\",PasteExpiringLocks!$D3&lt;&gt;\"\",PasteExpiringLocks!$B3=TODAY(),VALUE(PasteExpiringLocks!$J3)&gt;29),PasteExpiringLocks!B3,\"\")\n</code></pre>\n\n<p>All of this works how I want it, each file gets grouped together how I want it.</p>\n\n<p>Next, I want to use VBA to then send out emails for each file on each worksheet, and every file on a single worksheet will get the same general email, except with cell references for specific parameters like name and file number.</p>\n\n<pre><code> Worksheets(\"DisclosuresCancel\").Select\n    For Each cell In Columns(\"N\").Cells.SpecialCells(xlCellTypeConstants)\n       If cell.Value Like \"?*@?*.?*\" And _\n           LCase(Cells(cell.Row, \"P\").Value) = \"y\" Then\n\n            Set OutMail = OutApp.CreateItem(0)\n            On Error Resume Next\n            With OutMail\n                .To = Cells(cell.Row, \"N\").Value\n                .Cc = Cells(cell.Row, \"O\").Value\n                .Subject = Cells(cell.Row, \"D\").Value &amp; \", \" &amp; Cells(cell.Row, \"C\").Value &amp; \", Expiring Locks - \" &amp; Date\n                .Body = \"Sample Email\"\n            .Send\n            End With\n            On Error GoTo 0\n            Set OutMail = Nothing\n        End If\n    Next cell\n</code></pre>\n\n<p>This code is also working fine with multiple worksheets in a test file I was running, however, the next step is giving me trouble, because in the test file I was using actual values to test the email VBA code, but the actual file uses formulas. So, for example when it's looking for the <code>.To = Cells(cell.Row, \"N\").Value</code> it just sees the formula that references the email address on a different sheet, and not the result of that formula.</p>\n\n<p>I have a \"simple\" solution, which is to run a macro that does a copy>special paste on each sheet before running the email script... but that clears out all the formulas, and I'd have to keep a backup file in case it gets saved or something, and that just seems like a workaround for not knowing how to code it correctly.</p>\n\n<p>Is there a simple way that when referencing a cell value like <code>Cells(cell.Row, \"P\").Value</code> that it will just evaluate the formula in the cell and use the result? I tried using the Evaluate function in VBA, but that didn't seem to be working right either for doing multiple rows.</p>\n\n<p>Any ideas?</p>\n\n<p>UPDATE:</p>\n\n<p>I've made some changes that MIGHT work, but I'm currently getting an Error 91 when I try to set the cells I'm referencing as variants. Here's how I've got my VBA setup at the beginning:</p>\n\n<p>`Option Explicit</p>\n\n<p>Sub Email()</p>\n\n<pre><code>Dim OutApp As Object\nDim OutMail As Object\nDim cell As Range\nDim ato As Variant, acc As Variant, LoanNum As Variant, ExpDate As Variant, _\n    Milestone As Variant, BorrName As Variant, YNmail As Variant, Lofficer As Variant, LOA As Variant\n\n\nato = Cells(cell.Row, \"N\").Value\nacc = Cells(cell.Row, \"O\").Value\nLoanNum = Cells(cell.Row, \"D\").Value\nExpDate = Cells(cell.Row, \"B\").Value\nMilestone = Cells(cell.Row, \"G\").Value\nBorrName = Cells(cell.Row, \"C\").Value\nYNmail = Cells(cell.Row, \"P\").Value\nLofficer = Cells(cell.Row, \"E\").Value\nLOA = Cells(cell.Row, \"F\").Value\n\nApplication.ScreenUpdating = False\nSet OutApp = CreateObject(\"Outlook.Application\")\n\n\nOn Error GoTo cleanup`\n</code></pre>\n\n<p>After that, it goes into the email code (see further above) but replacing the cell references with their new variables like: <code>.Subject = LoanNum &amp; \", \" &amp; BorrName &amp; \", Expiring Locks - \" &amp; Date</code>, but when I debug the code it stops at the <code>ato = Cells(cell.Row, \"N\").Value</code> line and gives an error 91. Thoughts?</p>\n"}, {"tags": ["vba", "ms-access", "combobox", "autocomplete", "cascadingdropdown"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1505246351, "post_id": 46184225, "comment_id": 79331653, "body": "&quot;isn&#39;t working&quot; isn&#39;t a question. What is the <i>specific</i> problem? Did you try debugging? Breakpoints? Inspecting locals?"}, {"owner": {"reputation": 1, "user_id": 8539873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48114ba31dcae64828e4bb42b8311381?s=128&d=identicon&r=PG&f=1", "display_name": "CBeachBum", "link": "https://stackoverflow.com/users/8539873/cbeachbum"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1505248298, "post_id": 46184225, "comment_id": 79332491, "body": "Please excuse me, I am an absolute beginner with VBA and did not word that correctly. The second combobox will autofill with the last available option. The rest of the comboboxes that I entered the same code for are not autofilling. I still have to use the drop down menu to make my selection. I have not tried and of the troubleshooting steps you listed above because I have no clue what they mean. I will try to figure those out though and get back to you."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1505248331, "post_id": 46184225, "comment_id": 79332502, "body": "Please <a href=\"https://stackoverflow.com/posts/46184225/edit\">edit</a> your question to include this (and any other relevant) information."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1505276398, "post_id": 46184225, "comment_id": 79339898, "body": "@CBeachBum You are not required to be an expert coder, but if someone asks for more information, the best thing to do is actually edit the question and add more detail in a timely manner.  Stack Overflow is a great resource if you are willing to take time to improve your own posts.  The pace is also usually faster pace... most question answered within the same day if not the same hour.  If you take too long to &quot;get back&quot;, the question is likely to become stagnant."}, {"owner": {"reputation": 1, "user_id": 8539873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48114ba31dcae64828e4bb42b8311381?s=128&d=identicon&r=PG&f=1", "display_name": "CBeachBum", "link": "https://stackoverflow.com/users/8539873/cbeachbum"}, "reply_to_user": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1505313180, "post_id": 46184225, "comment_id": 79363217, "body": "@CPerkins Thank you for the advice. I am using this at work and had other tasks to be completed. Therefore, I couldn&#39;t respond instantly. I appreciate everyone&#39;s assistance though."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1505323390, "post_id": 46184225, "comment_id": 79369884, "body": "@CBeachBum  I understand and there must be no rush.  It is just that I see many first-time posters who do not properly respond to feedback, so I fear they never get a good answer.  We&#39;re still ready to help.  Did you try adding explicit calls to the <code>????_AfterUpdate()</code> subprocedures?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8539873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48114ba31dcae64828e4bb42b8311381?s=128&d=identicon&r=PG&f=1", "display_name": "CBeachBum", "link": "https://stackoverflow.com/users/8539873/cbeachbum"}, "edited": false, "score": 0, "creation_date": 1505416069, "post_id": 46203542, "comment_id": 79416777, "body": "The suggested code did not work for me. I really just don&#39;t understand VBA coding at all. I&#39;ve just been using macros for everything until now. I&#39;m so sorry to have wasted your time. I&#39;m just getting frustrated with it and need to think of an alternative method."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "reply_to_user": {"reputation": 1, "user_id": 8539873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48114ba31dcae64828e4bb42b8311381?s=128&d=identicon&r=PG&f=1", "display_name": "CBeachBum", "link": "https://stackoverflow.com/users/8539873/cbeachbum"}, "edited": false, "score": 0, "creation_date": 1505417507, "post_id": 46203542, "comment_id": 79417490, "body": "The ComboBox.RowSource queries are probably not sufficient, but you have not shared any details about those.  I could only assume that calling Requery on each ComboBox would work.  Please edit your question (not in the comments) with the RowSource query for a couple of the comboboxes.  Your concerns are likely not just with VBA coding, but I guess probably with the Access event model.  It is not always intuitive or like other system, that&#39;s why I preceded my code answer with a brief comment about that."}], "tags": [], "owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "is_accepted": false, "score": 0, "last_activity_date": 1505323578, "creation_date": 1505323578, "answer_id": 46203542, "question_id": 46184225, "link": "https://stackoverflow.com/questions/46184225/access-cascading-combobox-autofill-when-left-with-one-option/46203542#46203542", "title": "Access cascading combobox autofill When left with one option", "body": "<p>The problem may be with misunderstanding Access control events. Unlike in many other languages, control events are rarely triggered by changes made in VBA code. In other words, the event handler <code>cboTwo_AfterUpdate()</code> is not automatically called when <code>cboTwo.Value = cboTwo.ItemData(0)</code> is executed in code, so there will not be any automatic event cascade.  Try the following pattern: </p>\n\n<pre><code>Private Sub cboOne_AfterUpdate()\n  Me.cboTwo.Requery\n  If Me.cboTwo.ListCount = 1 Then\n    With Me.cboTwo\n      cboTwo.SetFocus\n      cboTwo.Value = cboTwo.ItemData(0)\n      cboTwo_AfterUpdate\n    End With\n  End If\nEnd Sub\n\nPrivate Sub cboTwo_AfterUpdate()\n  Me.cboThree.Requery\n  If Me.cboThree.ListCount = 1 Then\n    With Me.cboThree\n      cboThree.SetFocus\n      cboThree.Value = cboThree.ItemData(0)\n      cboThree_AfterUpdate\n    End With\n  End If    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8539873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48114ba31dcae64828e4bb42b8311381?s=128&d=identicon&r=PG&f=1", "display_name": "CBeachBum", "link": "https://stackoverflow.com/users/8539873/cbeachbum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 276, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1505323578, "creation_date": 1505245435, "last_edit_date": 1505312650, "question_id": 46184225, "link": "https://stackoverflow.com/questions/46184225/access-cascading-combobox-autofill-when-left-with-one-option", "title": "Access cascading combobox autofill When left with one option", "body": "<p>I have ~50 cascading comboboxes on a form that I want to autofill if only one option is left. I found some code that worked for cboTwo (second combobox), but the other comboboxes aren't filling in automatically. I still have to use the drop down menu to make a selection. Is there any way that I can make all of my comboboxes autofill if there is only one option left in the drop down? I'd prefer some sort of macro help because that's what I've been using until now, but I'll use VBA if necessary. Thank you for all of your help!</p>\n\n<pre><code>Private Sub cboOne_AfterUpdate()\n\nMe.cboTwo.Requery\nIf Me.cboTwo.ListCount = 1 Then\nWith Me.cboTwo\ncboTwo.SetFocus\ncboTwo.Value = cboTwo.ItemData(0)\nEnd With\nEnd If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub cboTwo_AfterUpdate()\n\nMe.cboThree.Requery\nIf Me.cboThree.ListCount = 1 Then\nWith Me.cboThree\ncboThree.SetFocus\ncboThree.Value = cboThree.ItemData(0)\nEnd With\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "row"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1505243263, "post_id": 46183714, "comment_id": 79330238, "body": "What is the code of <code>LastRow2End</code>?"}, {"owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "edited": false, "score": 2, "creation_date": 1505243394, "post_id": 46183714, "comment_id": 79330296, "body": "put the whole code please"}, {"owner": {"reputation": 174, "user_id": 8372054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a83e65aa223aa48753cc871c5e798a8?s=128&d=identicon&r=PG&f=1", "display_name": "BobtimusPrime", "link": "https://stackoverflow.com/users/8372054/bobtimusprime"}, "edited": false, "score": 1, "creation_date": 1505244788, "post_id": 46183714, "comment_id": 79330916, "body": "This is my favorite blog post about finding the last row or the last column: (<a href=\"https://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba\" rel=\"nofollow noreferrer\">thespreadsheetguru.com/blog/2014/7/7/&hellip;</a>)"}], "owner": {"reputation": 11, "user_id": 8411863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a76d96762bdc739925aca86f5415243?s=128&d=identicon&r=PG&f=1", "display_name": "I E", "link": "https://stackoverflow.com/users/8411863/i-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "closed_date": 1505244863, "answer_count": 0, "score": 1, "last_activity_date": 1505246825, "creation_date": 1505243152, "last_edit_date": 1505246825, "question_id": 46183714, "link": "https://stackoverflow.com/questions/46183714/find-last-populated-column-in-each-row", "closed_reason": "Duplicate", "title": "Find last populated column in each row", "body": "<p>I am trying to dynamically populate a worksheet with data from a different sheet. I am trying to find the last populated column of every row and then add the data to the right of the last populated column. Each row may have multiple entries on the other sheet and so I have a For loop to add data to the right. But my code is taking the last column from the previous loop run, increments it, populating the sheet in a ladder fashion.\n XXXX\n      YYYYY\n            ZZZZZZ\nI want the code to populate as such:\n    XXXX\n    YYYY ZZZZ\n    WWWW</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Set wsLD = Worksheets(\"ListDir\")\nSet wsTO = Worksheets(\"Requirements To Be Certified\")\nintLastLDRow = wsLD.Cells(Rows.count, 1).End(xlUp).Row\n\n For intLooper = 2 To intLastLDRow\n    intReqRowNum = wsLD.Cells(intLooper, 1).Value\n    wsTO.Cells(1, 1).Activate\n    intLastTOCol = wsTO.Cells(intReqRowNum, wsTO.Columns.count).End(xlToLeft).Column\n\n    wsTO.Cells(intReqRowNum, intLastTOCol + 1).Value = wsLD.Cells(intLooper, 5).Value\n    wsTO.Hyperlinks.Add Anchor:=wsTO.Cells(intReqRowNum, intLastTOCol + 1), _\n            Address:=wsLD.Cells(intLooper, 4).Value, TextToDisplay:=wsLD.Cells(intLooper, 5).Value\n\nNext intLooper\n</code></pre>\n\n<p>I am not trying to select a range or activate any other cell - and that is how it makes it different.</p>\n"}]