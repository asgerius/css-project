[{"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1555545566, "creation_date": 1555545566, "answer_id": 55737452, "question_id": 55737208, "link": "https://stackoverflow.com/questions/55737208/how-to-alter-case-of-filenames-generated-from-first-paragraph-of-document-using/55737452#55737452", "title": "How to alter case of filenames generated from first paragraph of document using Word VBA", "body": "<p>You can use:</p>\n\n<pre><code>StrConv(StrTxt,vbProperCase)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1555602363, "last_edit_date": 1555602363, "creation_date": 1555571932, "answer_id": 55740965, "question_id": 55737208, "link": "https://stackoverflow.com/questions/55737208/how-to-alter-case-of-filenames-generated-from-first-paragraph-of-document-using/55740965#55740965", "title": "How to alter case of filenames generated from first paragraph of document using Word VBA", "body": "<p>After:</p>\n\n<pre><code>    For k = 1 To Len(StrNoChr)\n      StrTxt = Replace(StrTxt, Mid(StrNoChr, k, 1), \"_\")\n    Next\n</code></pre>\n\n<p>Insert:</p>\n\n<pre><code>StrTxt = StrConv(StrTxt, vbProperCase)\n</code></pre>\n\n<p>PS: The code you posted is code I wrote...</p>\n"}], "owner": {"reputation": 1, "user_id": 11376240, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tT_1yB0QzB8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVOW-ZaeRFyQ7I3Ey4E51ZyKqpZg/mo/photo.jpg?sz=128", "display_name": "Michael H", "link": "https://stackoverflow.com/users/11376240/michael-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1555602363, "creation_date": 1555543037, "last_edit_date": 1555602337, "question_id": 55737208, "link": "https://stackoverflow.com/questions/55737208/how-to-alter-case-of-filenames-generated-from-first-paragraph-of-document-using", "title": "How to alter case of filenames generated from first paragraph of document using Word VBA", "body": "<p>I am working with the following VBA code for Word which extracts each section of the document as a separate document.</p>\n\n<p>It is sourced from: <a href=\"http://www.msofficeforums.com/mail-merge/21803-mailmerge-tips-tricks.html\" rel=\"nofollow noreferrer\">http://www.msofficeforums.com/mail-merge/21803-mailmerge-tips-tricks.html</a></p>\n\n<p>In the code the filename for each extracted document is based on the first paragraph of the respective section. In the documents our employees are wanting to run this code in the first paragraph of each of the sections is the document title which is all well and good but those titles are in uppercase.</p>\n\n<p>My problem is that when the VBA runs the filenames generated are in uppercase. I need only the first letter of each word to be capitalized in the filenames.</p>\n\n<p>The document titles being in uppercase is an accepted form at my employer so I can't change those. I have been able to alter the original VBA code to make the filenames all lowercase by changing the definition of <code>StrTxt to LCase(.Text): StrTxt= LCase(.Text)</code>. This is better because then the employee only needs to retype the first letter of each word in the file name as uppercase. But it would be ideal to have it automatically output in proper case.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    Sub SplitMergedDocument()\n      Application.ScreenUpdating = False\n      Dim i As Long, j As Long, k As Long, StrTxt As String\n      Dim Rng As Range, Doc As Document, HdFt As HeaderFooter\n      Const StrNoChr As String = \"\"\"*./\\:?|\"\n      j = InputBox(\"How many Section breaks are there per record?\", \"Split By Sections\", 1)\n      With ActiveDocument\n        **'Process each Section**\n        For i = 1 To .Sections.Count - 1 Step j\n        With .Sections(i)\n          **'Get the 1st paragraph**\n          Set Rng = .Range.Paragraphs(1).Range\n          With Rng\n             **'Contract the range to exclude the final paragraph break**\n            .MoveEnd wdCharacter, -1\n            StrTxt = .Text\n            For k = 1 To Len(StrNoChr)\n              StrTxt = Replace(StrTxt, Mid(StrNoChr, k, 1), \"_\")\n            Next\n          End With\n          **'Construct the destination file path &amp; name**\n          StrTxt = ActiveDocument.Path &amp; Application.PathSeparator &amp; StrTxt\n          **'Get the whole Section**\n          Set Rng = .Range\n          With Rng\n            If j &gt; 1 Then .MoveEnd wdSection, j - 1\n            **'Contract the range to exclude the Section break**\n            .MoveEnd wdCharacter, -1\n            **'Copy the range**\n            .Copy\n          End With\n        End With\n        **'Create the output document**\n        Set Doc = Documents.Add(Template:=ActiveDocument.AttachedTemplate.FullName, Visible:=False)\n      With Doc\n        ' Paste contents into the output document, preserving the formatting\n        .Range.PasteAndFormat (wdFormatOriginalFormatting)\n        ' Delete trailing paragraph breaks &amp; page breaks at the end\n        While .Characters.Last.Previous = vbCr Or .Characters.Last.Previous = Chr(12)\n          .Characters.Last.Previous = vbNullString\n        Wend\n        ' Replicate the headers &amp; footers\n        For Each HdFt In Rng.Sections(j).Headers\n          .Sections(j).Headers(HdFt.Index).Range.FormattedText = HdFt.Range.FormattedText\n        Next\n        For Each HdFt In Rng.Sections(j).Footers\n          .Sections(j).Footers(HdFt.Index).Range.FormattedText = HdFt.Range.FormattedText\n        Next\n        ' Save &amp; close the output document\n        .SaveAs FileName:=StrTxt &amp; \".docx\", FileFormat:=wdFormatXMLDocument, AddToRecentFiles:=False\n        ' and/or:\n        .SaveAs FileName:=StrTxt &amp; \".pdf\", FileFormat:=wdFormatPDF, AddToRecentFiles:=False\n        .Close SaveChanges:=False\n      End With\n    Next\n    End With\n    Set Rng = Nothing: Set Doc = Nothing\n    Application.ScreenUpdating = True\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1555602489, "post_id": 55736872, "comment_id": 98175972, "body": "Please take a moment to review the site guidelines for asking questions on Stack Overflow. This quesiton is too broad as well as unclear. At the very least, the code causing the problem should be included."}], "answers": [{"tags": [], "owner": {"reputation": 106, "user_id": 2909179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/158fd4698414a80cd645f67f07f8a9cc?s=128&d=identicon&r=PG", "display_name": "K7AAY", "link": "https://stackoverflow.com/users/2909179/k7aay"}, "is_accepted": false, "score": -1, "last_activity_date": 1555541185, "creation_date": 1555541185, "answer_id": 55736946, "question_id": 55736872, "link": "https://stackoverflow.com/questions/55736872/how-to-change-the-color-of-a-bullet-in-a-bullet-list/55736946#55736946", "title": "How to change the color of a bullet in a bullet list?", "body": "<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/powerpoint.paragraphformat.bullet\" rel=\"nofollow noreferrer\">Microsoft</a> explains you alter its <a href=\"https://docs.microsoft.com/en-us/office/vba/api/powerpoint.paragraphformat\" rel=\"nofollow noreferrer\">ParagraphFormat</a>, using code similar to:</p>\n\n<pre><code>With Application.ActivePresentation.Slides(1).Shapes(2).TextFrame\n\n    With .TextRange.ParagraphFormat.Bullet\n\n        .Visible = True\n\n        .RelativeSize = 1.25\n\n        .Font.Color = RGB(255, 0, 255)\n\n    End With\n\nEnd With \n</code></pre>\n\n<p>And, here's a <a href=\"https://www.rapidtables.com/web/color/RGB_Color.html\" rel=\"nofollow noreferrer\">color picker</a> so you may get just the precise shade desired, translated into the <a href=\"https://www.rapidtables.com/web/color/RGB_Color.html#rgb-format\" rel=\"nofollow noreferrer\">RGB format</a> (xxx,yyy,zzz) required.</p>\n"}, {"tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": false, "score": 0, "last_activity_date": 1555568744, "creation_date": 1555568744, "answer_id": 55740215, "question_id": 55736872, "link": "https://stackoverflow.com/questions/55736872/how-to-change-the-color-of-a-bullet-in-a-bullet-list/55740215#55740215", "title": "How to change the color of a bullet in a bullet list?", "body": "<p>In Word you can not simply set the <code>ParagraphFormat.Bullet.Font.Color</code> (as in PowerPoint), but assign another style, e. g.</p>\n\n<pre><code>Selection.ParagraphFormat.Style = \"List with red buttons\"\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10655187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb966a5bc358d04587018cbefd02a75?s=128&d=identicon&r=PG&f=1", "display_name": "TheUnicornMango", "link": "https://stackoverflow.com/users/10655187/theunicornmango"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1555602413, "creation_date": 1555540657, "last_edit_date": 1555602413, "question_id": 55736872, "link": "https://stackoverflow.com/questions/55736872/how-to-change-the-color-of-a-bullet-in-a-bullet-list", "title": "How to change the color of a bullet in a bullet list?", "body": "<p>I am trying to change the colour of a bullet point using VBA, but keep getting stuck. I want to make all the bullet points in a bullet list blue instead of black.</p>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 23, "user_id": 6307769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1d5a8e54ffe11f95db24f57866a4962?s=128&d=identicon&r=PG&f=1", "display_name": "rb86", "link": "https://stackoverflow.com/users/6307769/rb86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1555537188, "creation_date": 1555537188, "question_id": 55736361, "link": "https://stackoverflow.com/questions/55736361/how-to-return-activeworkbook-path-on-excel-for-mac", "title": "How to return activeworkbook path on Excel for Mac?", "body": "<p>I am trying to get the file path of the active workbook using \"application.activeworkbook.path\".  </p>\n\n<p>This code works on PC, however, when I run it on Mac, the path returned is \"/Users/(username)/Library/Containers/com.microsoft.Excel/Data/Library/Application Support/Microsoft/\", which seems to be a temp file directory of some kind and not the actual local file location.  How can I get the real file path?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1555537731, "post_id": 55736228, "comment_id": 98150928, "body": "Can delete value from array element but element is still there, doesn&#39;t resize. Might want to use Collection instead of array. <a href=\"https://analystcave.com/vba-collection/\" rel=\"nofollow noreferrer\">analystcave.com/vba-collection</a>"}, {"owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "edited": false, "score": 0, "creation_date": 1555547909, "post_id": 55736228, "comment_id": 98153092, "body": "I tried using collection but I did not find anything online that shows a way to delete collection item without knowing it&#39;s key. I made a different thread for it here:  <a href=\"https://stackoverflow.com/questions/55737679/how-to-delete-a-value-from-a-collection-without-using-its-key\" title=\"how to delete a value from a collection without using its key\">stackoverflow.com/questions/55737679/&hellip;</a>"}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 1, "creation_date": 1555551743, "post_id": 55736228, "comment_id": 98153706, "body": "I posted a working example for your collection question - I suggest you use that, but I also posted a working solution for a array(), but I would try and avoid the array if possible."}, {"owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "reply_to_user": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 0, "creation_date": 1555554248, "post_id": 55736228, "comment_id": 98154094, "body": "Thanks @AlbertD.Kallal. I decided to use collection"}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 0, "creation_date": 1555567401, "post_id": 55736228, "comment_id": 98157146, "body": "Arrays still of course are of use. One advantage of a array, is that you can fill the array directly from a recordset. So, you can pull a whole table right into a array, and without loops (and you get rows with columns (a matrix). So, array&#39;s are not dead, and it really depends on the particular use case. Depends ultimately what one is attempting to accomplish. So, while arrays are often hard to work with, some of this may well do to us developers becoming ever more lazy. A good number of systems dating all the way back to FORTAN faired well for years without collections."}], "answers": [{"tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": true, "score": 1, "last_activity_date": 1555554305, "last_edit_date": 1555554305, "creation_date": 1555551696, "answer_id": 55738040, "question_id": 55736228, "link": "https://stackoverflow.com/questions/55736228/how-to-delete-a-value-from-a-dynamic-array-from-any-position-in-vba/55738040#55738040", "title": "How to delete a value from a dynamic array from any position in VBA?", "body": "<p>There is no built in function to delete from a array. So, the only way is to \"pull\" each value down by one, and then re-dim to lop off the last value.</p>\n\n<p>Arrays hark back to old days of FORTAN and early GWBASIC languages that were popular on personal computers in the late 1970's, and early 80's. Most new languages (including VBA)) have a lot better choices. Because this is a \"painful\" approach, then I would build a function that deletes the row for you.</p>\n\n<p>This code will show how deleting works:</p>\n\n<pre><code>Private Sub Command104_Click()\n\n  Dim MyData()     As Integer\n\n  Dim i       As Integer\n\n  ReDim MyData(1 To 5)\n\n  For i = 1 To 5\n     MyData(i) = i * 100\n  Next i\n\n  Call MyDisplay(MyData)\n\n  ' delete 3rd row\n  Call MyDelete(MyData, 3)\n\n  Call MyDisplay(MyData)\n\nEnd Sub\n\nPublic Sub MyDelete(v() As Integer, intPos As Integer)\n\n  Dim numRows    As Integer\n  Dim i          As Integer\n\n  numRows = UBound(v)\n  ' move every row down one\n\n  For i = intPos To numRows - 1\n     v(i) = v(i + 1)\n  Next i\n\n  ' get rid of last row   \n  ReDim Preserve v(1 To numRows - 1)\n\nEnd Sub\n\n\nPublic Sub MyDisplay(v() As Integer)\n\n  Dim i       As Integer\n\n  For i = 1 To UBound(v)\n     Debug.Print i, \"---&gt;\", v(i)\n  Next i\n\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>  1            ---&gt;           100 \n  2            ---&gt;           200 \n  3            ---&gt;           300 \n  4            ---&gt;           400 \n  5            ---&gt;           500 \n\n  1            ---&gt;           100 \n  2            ---&gt;           200 \n  3            ---&gt;           400 \n  4            ---&gt;           500 \n</code></pre>\n"}], "owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 55738040, "answer_count": 1, "score": 0, "last_activity_date": 1555554305, "creation_date": 1555536515, "question_id": 55736228, "link": "https://stackoverflow.com/questions/55736228/how-to-delete-a-value-from-a-dynamic-array-from-any-position-in-vba", "title": "How to delete a value from a dynamic array from any position in VBA?", "body": "<p>I have a dynamic array that I want to delete an item from. I know we can delete an item from the end of an array by decreasing its size by 1 and redimming it. But is there a way to delete an item from an array no matter what position the item is on the array?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 11376037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8c6POVlVmzE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcVThl6aRLihUDsQgnBaKrcgAsVFg/mo/photo.jpg?sz=128", "display_name": "BigN&#39;Husky", "link": "https://stackoverflow.com/users/11376037/bignhusky"}, "edited": false, "score": 0, "creation_date": 1555964672, "post_id": 55736151, "comment_id": 98270119, "body": "Thank you so much for the response @JaraExcel I appreciate it!! I am still running into some issues, specifically &quot;Run-time error &#39;9&#39;: Subscript out of range&quot; I am running the following: [link] <i>italic</i> <b>bold</b> `Sub Pasteinfo()  Dim WS As Worksheet Set WS = ThisWorkbook.Worksheets(&quot;Job Cost Summary&quot;) WS.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Transpose:=True  End Sub&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11375154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58f3d53b6fbe3cdbfad7bb36324b91e6?s=128&d=identicon&r=PG&f=1", "display_name": "JaraExcel", "link": "https://stackoverflow.com/users/11375154/jaraexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1555536651, "creation_date": 1555536651, "answer_id": 55736251, "question_id": 55736151, "link": "https://stackoverflow.com/questions/55736151/vba-to-paste-values-transpose-multiple-workbooks/55736251#55736251", "title": "VBA to Paste / Values / Transpose Multiple Workbooks", "body": "<p>Hi Basicaly I understood that you want to manually copy, but you want to paste the info with a macro.</p>\n\n<p>If that\u00b4s the case, I would suggest to do the following:</p>\n\n<ol>\n<li><p>in job cost summary project.xlsm write the following code:</p>\n\n<p>Sub Pasteinfo\ndim WS as worksheet\nset WS = thisworkbook.worksheets(\"Sheet\")\nws.cells(rows.count,1).end(xlup).offset(1,0).PasteSpecial Paste:=xlPasteValuesAndNumberFormats , Transpose:=True\nEnd sub</p></li>\n<li><p>Assign a short cut to your macro by going> Developer > Macros > Select your macro > Options (and assign a shortcut)</p></li>\n</ol>\n\n<p>With these steps you will be able to paste the info in your workbook after you manually copied the info. </p>\n"}], "owner": {"reputation": 1, "user_id": 11376037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8c6POVlVmzE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcVThl6aRLihUDsQgnBaKrcgAsVFg/mo/photo.jpg?sz=128", "display_name": "BigN&#39;Husky", "link": "https://stackoverflow.com/users/11376037/bignhusky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555541718, "creation_date": 1555536096, "last_edit_date": 1555541718, "question_id": 55736151, "link": "https://stackoverflow.com/questions/55736151/vba-to-paste-values-transpose-multiple-workbooks", "title": "VBA to Paste / Values / Transpose Multiple Workbooks", "body": "<p>My apologies, I am new to VBA as I am sure you have guessed. No previous answers to similar questions have been able to fix my problem. </p>\n\n<p>I have a large number of Excel workbooks, each workbook has multiple worksheets in them all with different names and desired information in different ranges. </p>\n\n<p>In an effort to consolidate and essentially make a manually updated dashboard type spreadsheet containing all the latest information I have been copying and pasting data into a \"master sheet.\" Different workbooks (jobs) have different ranges on this one as well. I have been using the paste special, values, transpose function. </p>\n\n<p>I am trying to come up with a macro paste/ values/ transpose AFTER I select and copied the desired information. </p>\n\n<p>I have tried multiple suggestions from previous questions but none of them seem to work for me.</p>\n\n<pre><code>Sub paste_values()\n\n    wbkCurrent.Activate\n    Range(\"Selection\").Select\n    Selection.Copy\n    Windows(\"job cost summary project.xlsm\").Activate\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=True\nEnd Sub\n</code></pre>\n\n<p>&amp; </p>\n\n<pre><code>Sub TransposePaste()\nWith ActiveCell\nSelection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _\nFalse, Transpose:=True\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I hoping for a macro that will be a one click solution to paste/transpose the data I have copied in another workbook.</p>\n"}, {"tags": ["vba", "loops", "formatting", "worksheet"], "comments": [{"owner": {"reputation": 47, "user_id": 9947192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbjbZ.jpg?s=128&g=1", "display_name": "RebaS", "link": "https://stackoverflow.com/users/9947192/rebas"}, "edited": false, "score": 0, "creation_date": 1555535058, "post_id": 55735929, "comment_id": 98150012, "body": "Sorry I posted the code incorrectly. I hit submit before I corrected it."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1555535783, "post_id": 55735929, "comment_id": 98150253, "body": "What are <code>Text</code> and <code>Value</code>? As your code stands, those are just undeclared variables. That should be <code>If cell.Value = &quot;&quot; Then</code> and <code>cell.Value = &quot;T&quot;</code>, etc."}, {"owner": {"reputation": 47, "user_id": 9947192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbjbZ.jpg?s=128&g=1", "display_name": "RebaS", "link": "https://stackoverflow.com/users/9947192/rebas"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1555536492, "post_id": 55735929, "comment_id": 98150541, "body": "Thank you. I changed &quot;Text&quot; and &quot;Value&quot; to &quot;cell.Value&quot;, but the when I run the code, the empty cells on the sheets are not filled and it takes a crazy long time."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 9947192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbjbZ.jpg?s=128&g=1", "display_name": "RebaS", "link": "https://stackoverflow.com/users/9947192/rebas"}, "edited": false, "score": 0, "creation_date": 1555537037, "post_id": 55736117, "comment_id": 98150714, "body": "I replaced what I had with the above, but still nothing happens."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 47, "user_id": 9947192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbjbZ.jpg?s=128&g=1", "display_name": "RebaS", "link": "https://stackoverflow.com/users/9947192/rebas"}, "edited": false, "score": 0, "creation_date": 1555538669, "post_id": 55736117, "comment_id": 98151198, "body": "<code>ws.Range(&quot;A6&quot;).SpecialCells(xlLastCell)).Cells</code> is most likely the culprit - what range are you expecting this to return?"}, {"owner": {"reputation": 47, "user_id": 9947192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbjbZ.jpg?s=128&g=1", "display_name": "RebaS", "link": "https://stackoverflow.com/users/9947192/rebas"}, "edited": false, "score": 0, "creation_date": 1555542680, "post_id": 55736117, "comment_id": 98152143, "body": "The range on each ws is different. The number of columns/ws will not change, but the rows may based on the number of days in the month. All ws have a header, so I set up all to start formatting at A6. I originally set this up to select each page, the range, then format, but I hoped for a cleaner, quicker way. Also the only column that is guaranteed not to have empty cells is the date column &quot;A&quot;."}, {"owner": {"reputation": 47, "user_id": 9947192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbjbZ.jpg?s=128&g=1", "display_name": "RebaS", "link": "https://stackoverflow.com/users/9947192/rebas"}, "edited": false, "score": 0, "creation_date": 1555557783, "post_id": 55736117, "comment_id": 98154792, "body": "I used the macro recorder and Ctl + End to  get ws.Range(ws.Range(&quot;A6&quot;), ws.Range(&quot;A6&quot;).SpecialCells(xlLastCell)).Cells."}, {"owner": {"reputation": 47, "user_id": 9947192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbjbZ.jpg?s=128&g=1", "display_name": "RebaS", "link": "https://stackoverflow.com/users/9947192/rebas"}, "edited": false, "score": 0, "creation_date": 1555558833, "post_id": 55736117, "comment_id": 98154954, "body": "I noticed that when I hover over &quot;cell&quot; the pop-up states &quot;cell =&quot; the value in A6 on Sheet 1! I don&#39;t want to format Sheet 1 and Next is not progressing to another Sheet."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 1, "last_activity_date": 1555535915, "creation_date": 1555535915, "answer_id": 55736117, "question_id": 55735929, "link": "https://stackoverflow.com/questions/55735929/how-to-run-3-loops-for-conditional-formatting-over-multiple-worksheets/55736117#55736117", "title": "How to run 3 loops for conditional formatting over multiple worksheets", "body": "<p>Replace your loops with this instead - a loop does not act the same as a <code>With</code> statement - you still have to explicitly refer to <code>cell.Text/cell.Value</code> - UNLESS you want to embed a <code>With</code> statement <strong>inside</strong> your loop - which you absolutely could - but even then, that would need to be <code>.Text</code> and <code>.Value</code>.</p>\n\n<pre><code>For i = 2 To 3\n        With Sheets(i)\n            For Each cell In ws.Range(ws.Range(\"A6\"), ws.Range(\"A6\").SpecialCells(xlLastCell)).Cells\n                   If cell.Text = \"\" Then\n                   cell.Value = \"T\"\n                End If\n            Next\n         End With\n      Next\n\n    For i = 4 To 5\n        With Sheets(i)\n            For Each cell In ws.Range(ws.Range(\"A6\"), ws.Range(\"A6\").SpecialCells(xlLastCell)).Cells\n                 If cell.Text = \"Not Recorded\" Then\n                    cell.Value = \"p\"\n                End If\n            Next\n        End With\n    Next\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 9947192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbjbZ.jpg?s=128&g=1", "display_name": "RebaS", "link": "https://stackoverflow.com/users/9947192/rebas"}, "is_accepted": false, "score": 0, "last_activity_date": 1555561498, "creation_date": 1555561498, "answer_id": 55739126, "question_id": 55735929, "link": "https://stackoverflow.com/questions/55735929/how-to-run-3-loops-for-conditional-formatting-over-multiple-worksheets/55739126#55739126", "title": "How to run 3 loops for conditional formatting over multiple worksheets", "body": "<p>I discovered that if I used Select Case and the ws Name instead of i and adding \"For Each ws.. before each Select Case, it works and runs very quickly. Maybe not the most elegant, but effective.</p>\n\n<pre><code>Sub comfor()\n\nDim daily As Worksheet, mon As Worksheet, per As Worksheet, surf As Worksheet\nDim ws As Worksheet, cell As Range\n\n\nSet daily = Sheets(\"Daily\")\nSet per = Sheets(\"Personnel\")\nSet surf = Sheets(\"Testing\")\nSet mon = Sheets(\"Monthly\")\n\nFor Each ws In ActiveWorkbook.Sheets\n Select Case ws.Name\n    Case \"Daily\", \"Monthly\"\n        For Each cell In ws.Range((\"A6\"),_ \nws.Range(\"A6\").SpecialCells(xlLastCell)).Cells\n                If cell.Text = \"\" Then\n                   cell.Value = \"T\"\n                    cell.Font.Color = vbRed\n                   cell.Value = \"T\"\n                   cell.Font.Name = \"Wingdings 2\"\n                   End If\n            Next\n    End Select\n Next\n\nFor Each ws In ActiveWorkbook.Sheets\n Select Case ws.Name\n    Case \"Personnel\", \"Testing\"\n    For Each cell In ws.Range((\"A6\"), ws.Range(\"A6\").SpecialCells(xlLastCell)).Cells\n             If cell.Text = \"\" Then\n                cell.Value = \"p\"\n                    cell.Font.Color = RGB(255, 192, 0)\n                    cell.Value = \"p\"\n                    cell.Font.Name = \"Wingdings 3\"\n                    End If\n        Next\n\n    End Select\nNext\n\nFor Each ws In ActiveWorkbook.Sheets\n Select Case ws.Name\n    Case \"Daily\", \"Monthly\", \"Personnel\", \"Testing\"\n        For Each cell In ws.Range(ws.Range(\"A6\"),_ \nws.Range(\"A6\").SpecialCells(xlLastCell)).Cells\n           With cell\n                .HorizontalAlignment = xlCenter\n           End With\n\n            With cell\n             .Borders(xlInsideVertical).Weight = xlThin\n             .Borders(xlInsideHorizontal).Weight = xlThin\n             .Borders(xlEdgeLeft).Weight = xlMedium\n             .Borders(xlEdgeTop).Weight = xlMedium\n             .Borders(xlEdgeBottom).Weight = xlMedium\n             .Borders(xlEdgeRight).Weight = xlMedium\n             End With\n\n                If cell.Text = \"Incomplete\" Then\n                   cell.Font.Color = vbRed\n                   cell.Value = \"T\"\n                   cell.Font.Name = \"Wingdings 2\"\n\n                ElseIf cell.Text = \"Not Applicable\" Then\n                    cell.Name = \"Webdings\"\n                    cell.Value = \"x\"\n                    cell.Font.Color = RGB(255, 192, 0)\n\n                ElseIf cell.Text = \"Complete\" Then\n                     cell.Font.Color = 5287936\n                     cell.Value = \"R\"\n                     cell.Font.Name = \"Wingdings 2\"\n\n                End If\n\n            Next\n    End Select\n Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 9947192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbjbZ.jpg?s=128&g=1", "display_name": "RebaS", "link": "https://stackoverflow.com/users/9947192/rebas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 55736117, "answer_count": 2, "score": 0, "last_activity_date": 1555561498, "creation_date": 1555535005, "last_edit_date": 1555535848, "question_id": 55735929, "link": "https://stackoverflow.com/questions/55735929/how-to-run-3-loops-for-conditional-formatting-over-multiple-worksheets", "title": "How to run 3 loops for conditional formatting over multiple worksheets", "body": "<p>I'm trying to conditionally format 4 worksheets with varying ranges without using Select</p>\n\n<p>I'm trying to clean up my very crazy beginner code and speed up the process, but the loops are not working. All of the empty cells in the ranges on Worksheets 2 &amp; 3 should be filled with \"T\". The empty cells in ranges on Sheets 4 &amp; 5 should be \"p\".\nAll of the cells with data on sheets 2-4 are formatted the same: bold font, center alignment, frame, conditionally replace text and font &amp; font color depending on cell text.</p>\n\n<pre><code>Sub comfor()\n\nDim ws As Worksheet, cell As Range\n\nFor Each ws In ActiveWorkbook.Sheets\n    For i = 2 To 3\n        With Sheets(i)\n            For Each cell In ws.Range(ws.Range(\"A6\"),_ ws.Range(\"A6\").SpecialCells(xlLastCell)).Cells\n                   If Text = \"\" Then\n                   Value = \"T\"\n                End If\n            Next\n         End With\n      Next\n\n    For i = 4 To 5\n        With Sheets(i)\n            For Each cell In ws.Range(ws.Range(\"A6\"),_ ws.Range(\"A6\").SpecialCells(xlLastCell)).Cells\n                 If Text = \"Not Recorded\" Then\n                    Value = \"p\"\n                End If\n            Next\n        End With\n    Next\n    For i = 2 To 5\n        With Sheets(i)\n            For Each cell In ws.Range(ws.Range(\"A6\"),_ ws.Range(\"A6\").SpecialCells(xlLastCell)).Cells\n               With cell\n                    .HorizontalAlignment = xlCenter\n                   .Font.Bold = True\n               End With\n\n               With cell\n                   .Borders(xlEdgeLeft).Weight = xlMedium\n                   .Borders(xlEdgeTop).Weight = xlMedium\n                   .Borders(xlEdgeBottom).Weight = xlMedium\n                   .Borders(xlEdgeRight).Weight = xlMedium\n               End With\n\n               With cell\n                    If .Text = \"Incomplete\" Then\n                       .Font.Color = vbRed\n                       .Value = \"T\"\n                       .Font.Name = \"Wingdings 2\"\n\n                    ElseIf .Text = \"Not Applicable\" Then\n                        .Name = \"Webdings\"\n                        .Value = \"x\"\n                        .Font.Color = RGB(255, 192, 0)\n\n                    ElseIf .Text = \"Complete\" Then\n                        .Font.Color = 5287936\n                        .Value = \"R\"\n                        .Font.Name = \"Wingdings 2\"\n\n                    ElseIf .Text = \"Not Recorded\" Then\n                        .Font.Color = RGB(129, 222, 225)\n                        .Value = \"p\"\n                        .Font.Name = \"Wingdings\"\n\n                    End If\n                End With\n            Next\n        End With\n    Next\n Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1555542639, "post_id": 55735718, "comment_id": 98152134, "body": "Here&#39;s a question with an answer which includes VBA code to implement a timer in Outlook:  <a href=\"https://stackoverflow.com/questions/12257985/outlook-vba-run-a-code-every-half-an-hour/15207463\" title=\"outlook vba run a code every half an hour\">stackoverflow.com/questions/12257985/&hellip;</a>  You&#39;d need to pass your message id and destination folder to a couple of globals so when the timer fires it can locate the message and its intended destination."}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1555536361, "creation_date": 1555536361, "answer_id": 55736200, "question_id": 55735718, "link": "https://stackoverflow.com/questions/55735718/when-i-have-just-read-an-email-select-a-folder-to-store-it/55736200#55736200", "title": "When I have just read an email, select a folder to store it", "body": "<p>Correct, you cannot move / delete an item while you are in an event raised by that items. Astandard solution is to use a timer - enable it in the event handler, then in the timer event handler, disable the timer and run your code - since you are now out of the original item event handler, there are no limitations. </p>\n\n<p>Unfortunately, there are no timer obj3ects in VBA. Excel exposes Applicationm.OnTime method, but there is nothing like that in the Outlook Object Model unfortunately. </p>\n"}], "owner": {"reputation": 1, "user_id": 11375923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91a7c9647cdd9dba78c7dbd2cca07e5?s=128&d=identicon&r=PG&f=1", "display_name": "EugeI", "link": "https://stackoverflow.com/users/11375923/eugei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571085924, "creation_date": 1555533924, "last_edit_date": 1571085924, "question_id": 55735718, "link": "https://stackoverflow.com/questions/55735718/when-i-have-just-read-an-email-select-a-folder-to-store-it", "title": "When I have just read an email, select a folder to store it", "body": "<p>I would like to store an email that I have just read (so, when I'm closing it) in a folder I select. </p>\n\n<p>I have found and written something like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub myItem_close(Cancel As Boolean)\n\nDim F As Outlook.MAPIFolder\n\nEventsDisable = True\n\nIf TypeOf myItem Is Outlook.mailitem Then\n\n    Set F = myItem.Parent \n\n    If F = Session.GetDefaultFolder(olFolderInbox) Then \n\n        Set F = Application.Session.PickFolder\n\n        myItem.Move F\n\n    End If\n\n    EventsDisable = False\n\n\n\nEnd Sub\n</code></pre>\n\n<p>With this code, when I close an email, I'm asked to select a folder to store it, but code crashes at line <code>myItem.Move F</code> saying that I can't use properties and methods in this event.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 1, "creation_date": 1555531731, "post_id": 55735117, "comment_id": 98148797, "body": "Look into <code>DoEvents</code>. Not sure if it will work for you but worth a try as alternatives will probably be difficult. For example one alternative is to run the subroutine on a separate Access file with the relevant tables linked."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11121780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1fd89c1c1aeb1240203af503b2292dc?s=128&d=identicon&r=PG&f=1", "display_name": "F.Lost", "link": "https://stackoverflow.com/users/11121780/f-lost"}, "edited": false, "score": 0, "creation_date": 1555947966, "post_id": 55735809, "comment_id": 98263071, "body": "Thanks so much! This answer is probably way more involved than I need for my situation BUT it&#39;s always good to learn from answers like these!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 15, "user_id": 11121780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1fd89c1c1aeb1240203af503b2292dc?s=128&d=identicon&r=PG&f=1", "display_name": "F.Lost", "link": "https://stackoverflow.com/users/11121780/f-lost"}, "edited": false, "score": 0, "creation_date": 1555948504, "post_id": 55735809, "comment_id": 98263310, "body": "@F.Lost what <i>this</i> progress indicator does differently than everybody else&#39;s, is total and complete decoupling from the worker logic; as a result the <code>ProgressIndicator</code> can be reused everywhere it&#39;s needed, without needing to change a single line of code (be it in the form&#39;s code-behind or the class module): you simply register a worker method for it. All you need to do then, is to write your progress-updating worker logic in a method that takes a <code>ProgressIndicator</code> parameter, <code>Update</code> it as needed, and periodically check whether <code>IsCancelRequested</code> to cleanly handle cancellation."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1555534863, "last_edit_date": 1555534863, "creation_date": 1555534411, "answer_id": 55735809, "question_id": 55735117, "link": "https://stackoverflow.com/questions/55735117/can-i-click-on-a-button-on-a-ms-access-form-while-a-subroutine-is-running/55735809#55735809", "title": "Can I click on a button on a MS Access form while a subroutine is running?", "body": "<p>Yes, it's possible. Use <code>DoEvents</code> to tell VBA to keep pumping/processing Windows Messages; the result might not be as responsive as truly asynchronous code could be, but should be enough to enable clicking a [Cancel] button and process cancellation.</p>\n\n<hr>\n\n<p>The code in <a href=\"https://rubberduckvba.wordpress.com/2018/01/12/progress-indicator/\" rel=\"nofollow noreferrer\">this article</a> (disclaimer: I wrote it) was originally written for Excel and uses a <code>UserForm</code> (which is hidden in the VBE when the host is Access, but Access VBA projects can absolutely contain and consume <code>UserForm</code> modules).</p>\n\n<p>You'll want to remove the Excel-specific bits, like <code>QualifyMacroName</code> here:</p>\n\n<pre><code>Private Function QualifyMacroName(ByVal book As Workbook, ByVal procedure As String) As String\n    QualifyMacroName = \"'\" &amp; book.FullName &amp; \"'!\" &amp; procedure\nEnd Function\n</code></pre>\n\n<p>And then modify the <code>Create</code> factory method to <em>require</em> the <code>instance</code> parameter, like this:</p>\n\n<pre><code>Public Function Create(ByVal procedure As String, ByVal instance As Object, Optional ByVal initialLabelValue As String, Optional ByVal initialCaptionValue As String, Optional ByVal completedSleepMilliseconds As Long = 1000, Optional canCancel As Boolean = False) As ProgressIndicator\n\n    Dim result As ProgressIndicator\n    Set result = New ProgressIndicator\n\n    result.Cancellable = canCancel\n    result.SleepMilliseconds = completedSleepMilliseconds\n\n    If Not instance Is Nothing Then\n        Set result.OwnerInstance = instance\n    Else\n        Err.Raise 5, TypeName(Me), \"Invalid argument: 'instance' must be a valid object reference.\"\n    End If\n\n    result.ProcedureName = procedure\n\n    If initialLabelValue &lt;&gt; vbNullString Then result.ProgressView.ProgressLabel = initialLabelValue\n    If initialCaptionValue &lt;&gt; vbNullString Then result.ProgressView.Caption = initialCaptionValue\n\n    Set Create = result\n\nEnd Function\n</code></pre>\n\n<p>Once it compiles, you can use the <code>ProgressIndicator</code> by registering a worker method that does the actual work, like this:</p>\n\n<pre><code>With ProgressIndicator.Create(\"Run\", New MyLongRunningMacro, canCancel:=True)\n    .Execute\nEnd With\n</code></pre>\n\n<p>Where <code>MyLongRunningMacro</code> is a class module with a <code>Run</code> method that might look something like this:</p>\n\n<pre><code>Public Sub Run(ByVal progress As ProgressIndicator)\n    Dim thingsDone As Long\n    For Each thing In ThingsToDo\n        Application.Run thing\n        thingsDone = thingsDone + 1\n        progress.UpdatePercent thingsDone / ThingsToDo.Count\n        If ShouldCancel(progress) Then\n            ' user confirmed they want to cancel the whole thing.\n            ' perform any clean-up or rollback here\n            Exit Sub\n        End If\n    Next\nEnd Sub\n\nPrivate Function ShouldCancel(ByVal progress As ProgressIndicator) As Boolean\n    If progress.IsCancelRequested Then\n        If MsgBox(\"Cancel this operation?\", vbYesNo) = vbYes Then\n            ShouldCancel = True\n        Else\n            progress.AbortCancellation\n        End If\n    End If\nEnd Function\n</code></pre>\n\n<p>Where <code>ThingsToDo</code> might be a collection of macros to execute, for example. Reporting progress percent is easier with a loop, but while it can also work with a sequence of operations, cleanly handling cancellation is a bit harder:</p>\n\n<pre><code>Public Sub Run(ByVal progress As ProgressIndicator)\n    Dim thingsDone As Long\n    DoThingOne\n    If Not UpdateAndContinue(progress, 0.33) Then Exit Sub\n    DoThingTwo\n    If Not UpdateAndContinue(progress, 0.66) Then Exit Sub\n    DoThingThree\n    If Not UpdateAndContinue(progress, 1) Then Exit Sub\nEnd Sub\n\nPrivate Function UpdateAndContinue(ByVal progress As ProgressIndicator, ByVal percentCompleted As Double) As Boolean\n    progress.UpdatePercent percentCompleted\n    If ShouldCancel(progress) Then \n        ' user confirmed they want to cancel the whole thing.\n        ' perform any clean-up or rollback here\n        Exit Function\n    Else \n        UpdateAndContinue = True\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11121780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1fd89c1c1aeb1240203af503b2292dc?s=128&d=identicon&r=PG&f=1", "display_name": "F.Lost", "link": "https://stackoverflow.com/users/11121780/f-lost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 55735809, "answer_count": 1, "score": 0, "last_activity_date": 1561972265, "creation_date": 1555531076, "last_edit_date": 1561972265, "question_id": 55735117, "link": "https://stackoverflow.com/questions/55735117/can-i-click-on-a-button-on-a-ms-access-form-while-a-subroutine-is-running", "title": "Can I click on a button on a MS Access form while a subroutine is running?", "body": "<p>I have a progress bar, a tiny pop up form, linked to the progress of a time consuming subroutine.</p>\n\n<p>I'm trying to put a cancel button on the progress bar. When the subroutine is running in the background, I can't click on anything in the progress bar form.</p>\n\n<p>Is there a way to click a button on a different form while a subroutine is ongoing?</p>\n"}, {"tags": ["ms-access", "vba", "dao"], "comments": [{"owner": {"reputation": 326, "user_id": 7061680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22002c39dcc7e46b3beab7af3d0d2c80?s=128&d=identicon&r=PG&f=1", "display_name": "BankBuilder", "link": "https://stackoverflow.com/users/7061680/bankbuilder"}, "edited": false, "score": 0, "creation_date": 1555540215, "post_id": 55735070, "comment_id": 98151559, "body": "If you use a bound attachment control, it will automatically display image attachments. Otherwise, I highly recommend storing file paths in DB and loading images with VBA in image control"}, {"owner": {"reputation": 326, "user_id": 7061680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22002c39dcc7e46b3beab7af3d0d2c80?s=128&d=identicon&r=PG&f=1", "display_name": "BankBuilder", "link": "https://stackoverflow.com/users/7061680/bankbuilder"}, "edited": false, "score": 0, "creation_date": 1555540540, "post_id": 55735070, "comment_id": 98151625, "body": "A bound image control will also automatically display image attachments. Unfortunately, you must save the file in order to display it in the image control in your function, it doesn&#39;t accept raw image data."}], "answers": [{"tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": false, "score": 0, "last_activity_date": 1558016225, "creation_date": 1558016225, "answer_id": 56170697, "question_id": 55735070, "link": "https://stackoverflow.com/questions/55735070/load-image-from-attatchment-field-to-image-control-in-a-form/56170697#56170697", "title": "Load image from attatchment field to image control in a form", "body": "<p>the property <code>Picture</code> takes a <code>string</code> value. The path of the picture to show.</p>\n\n<p>Use the property <code>PictureData</code> which takes <code>Byte Array</code> of a picture. Make sure your DB field [P_IMAGE] has valid byte array.</p>\n"}], "owner": {"reputation": 15, "user_id": 10760667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a875e7fa5268ddb1674c885f0a7d0083?s=128&d=identicon&r=PG&f=1", "display_name": "Juan Perez", "link": "https://stackoverflow.com/users/10760667/juan-perez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594570288, "creation_date": 1555530886, "last_edit_date": 1594570288, "question_id": 55735070, "link": "https://stackoverflow.com/questions/55735070/load-image-from-attatchment-field-to-image-control-in-a-form", "title": "Load image from attatchment field to image control in a form", "body": "<p>I have a table [tb_projects] with lots of fields including an attachment field [P_IMAGE]</p>\n\n<p>I also have a form with an Image control [img_project] onto which i want to display an image from the tb_projects table of a specific record.</p>\n\n<p>GlobalData.getProjectSelected this is a function that returns the current project</p>\n\n<p>My code so far:</p>\n\n<pre><code>Dim dbs As DAO.Database\nDim rst As DAO.Recordset\nDim rstAtt As Recordset\nDim sqlSelect As String\n\nsqlSelect = \"SELECT * FROM [tb_projects] WHERE [PROJECT_ID] = '\" &amp; GlobalData.getProjectSelected &amp; \"'\"\n\nSet dbs = CurrentDb\nSet rst = dbs.OpenRecordset(sqlSelect, dbOpenSnapshot)\nSet rstAtt = rst.Fields(\"P_IMAGE\").Value\n\nMe.img_project.Picture = rstAtt.Fields(\"FileData\").Value\n\nrst.Close\nrstAtt.Close\n\nSet dbs = Nothing\nSet rst = Nothing\n</code></pre>\n\n<p>This throws me an error saying: The setting for this property is too long</p>\n\n<p>How can i accomplish this without saving the file to %TEMP% and loading the path to the image control? Is this even possible with DAO?</p>\n"}, {"tags": ["vba", "sendkeys"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 2, "creation_date": 1555530294, "post_id": 55734848, "comment_id": 98148200, "body": "There isn&#39;t any &quot;Easy&quot; way to simulate key-presses in VBA. There are methods that might &quot;usually&quot; work, but probably not as simple as you&#39;d like. Why do you need it simulated? Maybe we can help identify an alternative way of accomplishing <i>what the arrow key is being simulated for</i>"}, {"owner": {"reputation": 1, "user_id": 11375724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/870a4f7e77fcf5991c441afb4f318bff?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/11375724/dave"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1555536936, "post_id": 55734848, "comment_id": 98150677, "body": "is there no way to do a send key with a hold or press and release?"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1555537461, "post_id": 55734848, "comment_id": 98150856, "body": "If you are desperate, you can try looking into <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.sendkeys\" rel=\"nofollow noreferrer\">SendKeys</a>; however, it&#39;s not known for being reliable, so you shouldn&#39;t expect it to work-as-expected all of the time."}], "owner": {"reputation": 1, "user_id": 11375724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/870a4f7e77fcf5991c441afb4f318bff?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/11375724/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555529866, "creation_date": 1555529866, "question_id": 55734848, "link": "https://stackoverflow.com/questions/55734848/how-do-i-simulate-an-arrow-key-being-pressed-and-held-down-then-released-vba", "title": "How do i simulate an arrow key being pressed and held down then released? VBA", "body": "<p>Coding in VBA</p>\n\n<p>I havent done much coding and im looking for a simple yet effective way to simulate an arrow key being pressed, held and released. Can you help?</p>\n\n<p>The time the key is held for needs to be a random.next(x, y)</p>\n\n<p>I want to stress by simple, i mean as simple as it can be please!</p>\n"}, {"tags": ["excel", "vba", "internet-explorer", "dom", "web-scraping"], "comments": [{"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1555569613, "post_id": 55734610, "comment_id": 98157947, "body": "You can try to find the HTML table by its ID and than try to loop through its rows to fetch the data may help you to fetch correct data. Ref: <a href=\"https://www.vba-market.com/vba-pull-html-table-to-excel-tool/\" rel=\"nofollow noreferrer\">vba-market.com/vba-pull-html-table-to-excel-tool</a>"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9155283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5f75470ba83f4ac8379b47957988b8?s=128&d=identicon&r=PG&f=1", "display_name": "Kali ", "link": "https://stackoverflow.com/users/9155283/kali"}, "edited": false, "score": 0, "creation_date": 1555571459, "post_id": 55734945, "comment_id": 98158820, "body": "Thanks again QHarr! It&#39;s working perfect. Great help!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1555534753, "last_edit_date": 1555534753, "creation_date": 1555530314, "answer_id": 55734945, "question_id": 55734610, "link": "https://stackoverflow.com/questions/55734610/copying-a-target-table-from-html-into-excel-is-not-showing-up/55734945#55734945", "title": "Copying a target table from HTML into Excel is not showing up", "body": "<p>I would use clipboard and timed loops. There is scope for re-factoring which I will do later. </p>\n\n<p>The page does an xhr POST request for the results so use dev tools which you may be able to replicate. It uses this url: <a href=\"http://hydro.imd.gov.in/hydrometweb/(S(yir33wzdcp5kls450czjmh45))/DistrictRaifall.aspx\" rel=\"nofollow noreferrer\">http://hydro.imd.gov.in/hydrometweb/(S(yir33wzdcp5kls450czjmh45))/DistrictRaifall.aspx</a>. See comment at end.</p>\n\n<pre><code>Option Explicit    \n'VBE &gt; Tools &gt; References:\n' Microsoft Internet Controls\nPublic Sub MakeSelections()\n    Dim ie As InternetExplorer, commodity As String, iDate As String, clipboard As Object, arr()\n\n    Set clipboard = GetObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n    Set ie = New InternetExplorer\n    commodity = \"MADHYA PRADESH\"\n    iDate = \"REWA\"\n\n    With ie\n        .Visible = True\n        .Navigate2 \"http://hydro.imd.gov.in/hydrometweb/(S(3qitcijd521egpzhwqq3jk55))/DistrictRaifall.aspx\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        .document.querySelector(\"[value='\" &amp; commodity &amp; \"']\").Selected = True\n        .document.querySelector(\"[name=listItems]\").FireEvent \"onchange\"\n\n        arr = ElementFound(.document, \"[value='\" &amp; iDate &amp; \"']\")\n\n        If Not arr(0) Then Exit Sub\n\n        arr(1).Selected = True\n        .document.querySelector(\"#GoBtn\").Click\n\n        arr = ElementFound(.document, \"#GridId\")\n\n        If Not arr(0) Then Exit Sub\n\n        clipboard.SetText arr(1).outerHTML\n        clipboard.PutInClipboard\n        ThisWorkbook.Worksheets(\"Sheet1\").Cells(1, 1).PasteSpecial\n        .Quit\n    End With\nEnd Sub\n\nPublic Function ElementFound(ByRef document As Object, ByVal selector As String) As Variant\n    Dim ele As Object, t As Date, arr(0 To 1)\n    Const MAX_WAIT_SEC As Long = 5\n    t = Timer\n    Do\n        On Error Resume Next\n        Set ele = document.querySelector(selector)\n        On Error GoTo 0\n        If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n    Loop While ele Is Nothing\n    If Not ele Is Nothing Then\n        arr(0) = True\n    Else\n        arr(0) = False\n    End If\n    Set arr(1) = ele\n    ElementFound = arr\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>XHR:</p>\n\n<p>The POST body includes parameters of</p>\n\n<p>__EVENTTARGET: vbNullString</p>\n\n<p>__EVENTARGUMENT: vbNullString</p>\n\n<p>__LASTFOCUS: vbNullString</p>\n\n<p>__VIEWSTATE: to be obtained. In my case at least obtaining this from a prior GET did not work</p>\n\n<p>__VIEWSTATEGENERATOR: 6C290774 '&lt; static but can be obtained from prior GET</p>\n\n<p>listItems: MADHYA PRADESH 'replace spaces with +</p>\n\n<p>DistrictDropDownList: REWA</p>\n\n<p>GoBtn: GO</p>\n"}], "owner": {"reputation": 17, "user_id": 9155283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5f75470ba83f4ac8379b47957988b8?s=128&d=identicon&r=PG&f=1", "display_name": "Kali ", "link": "https://stackoverflow.com/users/9155283/kali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 55734945, "answer_count": 1, "score": 0, "last_activity_date": 1555534753, "creation_date": 1555528837, "last_edit_date": 1555529914, "question_id": 55734610, "link": "https://stackoverflow.com/questions/55734610/copying-a-target-table-from-html-into-excel-is-not-showing-up", "title": "Copying a target table from HTML into Excel is not showing up", "body": "<p>Tried selecting the dropdowns from HTML file and tried copying the result table into Excel. But the below code coping some other text from HTML rather the table (which I want to populate to Excel).</p>\n\n<pre><code>Option Explicit\n\n'VBE &gt; Tools &gt; References:\n' Microsoft Internet Controls\nPublic Sub MakeSelections()\n    Dim ie As InternetExplorer, ele As Object, t As Date\n    Const MAX_WAIT_SEC As Long = 5\n    Dim commodity As String, iDate As String\n\n\n    commodity = \"MADHYA PRADESH\"\n    iDate = \"REWA\"\n\n    Set ie = New InternetExplorer\n\n    With ie\n        .Visible = True\n        .Navigate2 \"http://hydro.imd.gov.in/hydrometweb/(S(3qitcijd521egpzhwqq3jk55))/DistrictRaifall.aspx\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        .document.querySelector(\"[value='\" &amp; commodity &amp; \"']\").Selected = True\n        .document.querySelector(\"[name=listItems]\").FireEvent \"onchange\"\n        t = Timer\n        Do\n            On Error Resume Next\n            Set ele = .document.querySelector(\"[value='\" &amp; iDate &amp; \"']\")\n            On Error GoTo 0\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While ele Is Nothing\n\n        If Not ele Is Nothing Then\n            ele.Selected = True\n            .document.querySelector(\"#GoBtn\").Click\n        Else\n            Exit Sub\n        End If\n        'Stop\n        '.Quit\n\n\n   Dim doc As Object, hTable As Object, hBody As Object, hTR As Object, hTD As Object\n   Dim tb As Object, bb As Object, tr As Object, td As Object\n\n   Dim y As Long, z As Long, wb As Excel.Workbook, ws As Excel.Worksheet\n\n     Set wb = Excel.ActiveWorkbook\n     Set ws = wb.ActiveSheet\n\n      y = 1   'Column A in Excel\n      z = 1   'Row 1 in Excel\n\n     Set doc = ie.document\n     Set hTable = doc.getElementsByTagName(\"table\")\n     For Each tb In hTable\n\n        Set hBody = tb.getElementsByTagName(\"tbody\")\n        For Each bb In hBody\n\n            Set hTR = bb.getElementsByTagName(\"tr\")\n            For Each tr In hTR\n\n\n                 Set hTD = tr.getElementsByTagName(\"td\")\n                 y = 1 ' Resets back to column A\n                 For Each td In hTD\n                   ws.Cells(z, y).Value = td.innerText\n                   y = y + 1\n                 Next td\n                 DoEvents\n                 z = z + 1\n            Next tr\n            Exit For\n        Next bb\n    Exit For\n  Next tb\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1555532049, "post_id": 55734532, "comment_id": 98148916, "body": "You can use VBA to combine the form&#39;s <code>RecordSource</code> and <code>Filter</code> properties, turn it into the new <code>RecordSource</code>, requery your form, export it, then restore the original <code>RecordSource</code> and <code>Filter</code>. There is probably an easier way, especially if you are willing to forego the formatting and export just data."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1555532114, "post_id": 55734532, "comment_id": 98148955, "body": "A simple report will export nicely."}, {"owner": {"reputation": 1, "user_id": 7535899, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101193039241971/picture?type=large", "display_name": "Philo ", "link": "https://stackoverflow.com/users/7535899/philo"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1555589760, "post_id": 55734532, "comment_id": 98168401, "body": "@June7 it has to be able to export to an excel sheet...."}, {"owner": {"reputation": 1, "user_id": 7535899, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101193039241971/picture?type=large", "display_name": "Philo ", "link": "https://stackoverflow.com/users/7535899/philo"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1555589836, "post_id": 55734532, "comment_id": 98168442, "body": "@SunKnight0, I am a novice when it comes to vba, how would i go about that?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1555591825, "post_id": 55734532, "comment_id": 98169651, "body": "A report can export to Excel with VBA OutputTo method or right click menu or ribbon ExternalData/Export wizard. A simple report can look as nice as a table or query export. Complex reports using grouping and/or subreports don&#39;t do so well."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7535899, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101193039241971/picture?type=large", "display_name": "Philo ", "link": "https://stackoverflow.com/users/7535899/philo"}, "edited": false, "score": 0, "creation_date": 1555604881, "post_id": 55747542, "comment_id": 98177139, "body": "Hi the reason I left it to yes, is so that when the continuous form of 1000+ records opens, nothing it pulled up, up until a search criteria has been input, then you call the records needed"}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "reply_to_user": {"reputation": 1, "user_id": 7535899, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101193039241971/picture?type=large", "display_name": "Philo ", "link": "https://stackoverflow.com/users/7535899/philo"}, "edited": false, "score": 0, "creation_date": 1555614486, "post_id": 55747542, "comment_id": 98181228, "body": "Ok, at least you have a reason for your choice (and that is a good answer). If you never use this form or data entry? If the form is only for selecting records? You  could use the openform with a where clause of id = 0.  Anyway, this issue seems to be fine for you anyway. And the above  Anyway, the above should create a working sql statement that is exportable to Excel."}], "tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": false, "score": 1, "last_activity_date": 1555595636, "creation_date": 1555595636, "answer_id": 55747542, "question_id": 55734532, "link": "https://stackoverflow.com/questions/55734532/is-there-a-way-to-export-a-filtered-form-to-excel-in-ms-access/55747542#55747542", "title": "Is there a way to export a filtered form to Excel in MS Access?", "body": "<p>It not clear why you using data enter = yes, as that means the form will ONLY  show new records you are entering. So, that idea is likely a bad idea. </p>\n\n<p>However, assuming the form displays what you want after filtering?</p>\n\n<p>Then something like this should work.</p>\n\n<p>Place a button on the form (say up in the heading).</p>\n\n<pre><code>Private Sub Command47_Click()\n\n  Dim strSQL     As String\n\n  strSQL = Me.RecordSource\n\n  strSQL = strSQL &amp; \" WHERE \" &amp; Me.Filter\n\n  With CurrentDb.QueryDefs(\"qryExport\")\n     .SQL = strSQL\n  End With\n\n  ' now export the query  with critera to excel\n\n  Dim strOutFile    As String\n\n  strOutFile = \"c:\\ExcelData\\Test.xlsx\"\n\n  DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, _\n        \"qryExport\", strOutFile, True\nend Sub\n</code></pre>\n\n<p>The query used in above is assumed to be a query on the table, and can be quite much any legal sql query - since our code OVERWRITES the query and sql each time, and then we export that query.</p>\n"}], "owner": {"reputation": 1, "user_id": 7535899, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101193039241971/picture?type=large", "display_name": "Philo ", "link": "https://stackoverflow.com/users/7535899/philo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1514, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555595636, "creation_date": 1555528542, "last_edit_date": 1555537871, "question_id": 55734532, "link": "https://stackoverflow.com/questions/55734532/is-there-a-way-to-export-a-filtered-form-to-excel-in-ms-access", "title": "Is there a way to export a filtered form to Excel in MS Access?", "body": "<p>I have a Continuous form within a Navigation Form in access. I have set the form to allow \"data entry\" in the property sheet settings under the Data tab. With this setting the form loads to a new data entry record. The problem is with the \"Allow to Data entry\" set to yes, when I try export to Excel, it always exports a sheet with empty cells, it only shows the fields for the search criteria but no data.</p>\n\n<p>I set the \"Allow data entry to no\" and when I did that the export to Excel button worked and exported data to an Excel sheet.</p>\n\n<p>ExportWithFormatting<br>\nObject Type: Form<br>\nOutputFormat: Excel Workbook xlsx<br>\nOUtputFile: Blank<br>\nAuto Start: Yes<br>\nTemplate File:<br>\nEncoding: OUtput<br>\nQuality: Print</p>\n\n<p>I would like for the export to Excel button to export data to Excel based on the search criteria I have in my form.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1555528290, "post_id": 55734323, "comment_id": 98147357, "body": "See <a href=\"https://www.mrexcel.com/forum/excel-questions/979449-adding-axis-titles-using-vba.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a> or <a href=\"https://stackoverflow.com/questions/52645054/making-axis-title-in-excel-chart-with-vba\" title=\"making axis title in excel chart with vba\">stackoverflow.com/questions/52645054/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 11375559, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z6wnK.jpg?s=128&g=1", "display_name": "n0t_n3rdy_en0ugh", "link": "https://stackoverflow.com/users/11375559/n0t-n3rdy-en0ugh"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1555531863, "post_id": 55734323, "comment_id": 98148851, "body": "Thanks for your suggestions TIm,  I gave both a try and for the first one i got another run-time error, this time 438, object does not support this property or method.  The second suggestion gives me the same 424."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1555532357, "post_id": 55734323, "comment_id": 98149042, "body": "Well those codes do work, so there seems to be something else that&#39;s the problem."}], "owner": {"reputation": 1, "user_id": 11375559, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z6wnK.jpg?s=128&g=1", "display_name": "n0t_n3rdy_en0ugh", "link": "https://stackoverflow.com/users/11375559/n0t-n3rdy-en0ugh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555527572, "creation_date": 1555527572, "question_id": 55734323, "link": "https://stackoverflow.com/questions/55734323/how-to-generate-a-graph-with-axis-titles-without-getting-a-runtime-424-error", "title": "How to generate a graph with axis titles without getting a runtime 424 error", "body": "<p>I am writing a macro to generate graphs and used the macro recorder to do it.  When it gets to the part where I put the axis titales in it runs a \"runtime error 424 object required\" error.  What am i missing?</p>\n\n<p>I wrote this macro once and it only put in one of the axis titles.  When i tried to add the second one in i kept getting errors and gave up and decided to re-record it.  Now i can't get either one on my graph.</p>\n\n<pre><code>    ActiveChart.SetElement (msoElementPrimaryCategoryAxisTitleAdjacentToAxis)\n    ActiveChart.SetElement (msoElementPrimaryValueAxisTitleAdjacentToAxis)\n    ActiveChart.Axes(xlValue, xlPrimary).AxisTitle.Text = \"# Samples\"\n    Selection.Format.TextFrame2.TextRange.Characters.Text = \"# Samples\"\n    With Selection.Format.TextFrame2.TextRange.Characters(1, \n    9).ParagraphFormat\n        .TextDirection = msoTextDirectionLeftToRight\n        .Alignment = msoAlignCenter\n    End With\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "vba", "vb.net"], "comments": [{"owner": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "edited": false, "score": 4, "creation_date": 1555528456, "post_id": 55734319, "comment_id": 98147430, "body": "You can&#39;t &quot;set&quot; a <i>universal</i> path - these differences in server names are exactly the reason why you put these kinds of information into an editable <code>.config</code> file - so you can adapt it to your environment, without having to recompile the code."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9914333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ITCb6-I0BnI/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2zXsqil2FFCguzQqI0P6eI4p5qlg/mo/photo.jpg?sz=128", "display_name": "Khohula Rhaj", "link": "https://stackoverflow.com/users/9914333/khohula-rhaj"}, "edited": false, "score": 0, "creation_date": 1555531396, "post_id": 55734755, "comment_id": 98148657, "body": "Thank you so much, let me try and will get back to u\ud83d\ude46\u200d\u2640\ufe0f"}], "tags": [], "owner": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "is_accepted": false, "score": 2, "last_activity_date": 1555529406, "creation_date": 1555529406, "answer_id": 55734755, "question_id": 55734319, "link": "https://stackoverflow.com/questions/55734319/connecting-a-sql-server-bak-backup-file-to-visual-studio/55734755#55734755", "title": "Connecting a SQL Server .bak backup file to Visual Studio", "body": "<p>There is no such thing as an \"universal\" path or anything.</p>\n\n<p>Such differences in server (and possibly database) name are the main reason the generally accepted <strong>Best Practice</strong> is to put these kinds of things into <strong>editable</strong> <code>.config</code> files - so you can adapt those connection strings (and other items) to varying environments and setups, without having to recompile your code to pick up the change.</p>\n\n<p>So in your case, use an <code>app.config</code> or <code>web.config</code> file in your project, and then add your connection string to that config file:</p>\n\n<pre><code>&lt;configuration&gt;\n    &lt;connectionStrings&gt;\n        &lt;add name=\"YourDatabase\" \n             connectionString=\"server=servernamePC1;database=SDP;integrated security=SSPI\"\n             providerName=\"System.Data.SqlClient\"/&gt;  \n    &lt;/connectionStrings&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>Now, on your second PC, you just need to adapt this config file.</p>\n\n<p>You read out this config file using the <code>ConfigurationManager</code> class in .NET:</p>\n\n<pre><code>using System.Configuration;\n\npublic void YourMethod() \n{\n    string connectionString = ConfigurationManager.ConnectionStrings[\"YourDatabase\"].ConnectionString;\n\n    using (SqlConnection conn = new SqlConnection(connectionString))\n    {\n        // do your stuff here\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9914333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ITCb6-I0BnI/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2zXsqil2FFCguzQqI0P6eI4p5qlg/mo/photo.jpg?sz=128", "display_name": "Khohula Rhaj", "link": "https://stackoverflow.com/users/9914333/khohula-rhaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556286489, "creation_date": 1555527565, "last_edit_date": 1556286489, "question_id": 55734319, "link": "https://stackoverflow.com/questions/55734319/connecting-a-sql-server-bak-backup-file-to-visual-studio", "title": "Connecting a SQL Server .bak backup file to Visual Studio", "body": "<p>My problem over here is that I have backed up my SQL Server database <code>SDP</code>, then I restored the backup file on another PC. </p>\n\n<p>Now I would like to execute my vb.net program from the new PC. The problem I am facing is that the server name I have written in my code is the server name of my previous PC (\"servernamePC1\"). On the new PC, the server name is different. Hence, how to set a universal connection path in vb.net to connect to my database?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim con As New SqlConnection(\"server = servernamePC1; database=SDP; integrated security=SSPI\")\n</code></pre>\n\n<p>The server name I have specified above is a sample server name - not the actual server name. Assume that the server name (\"servernamePC1\") is the first PC's server name. Now I have to connect to the database on a new PC with a different server name. Is that possible? Or do I have to set a universal path?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1555571689, "creation_date": 1555571689, "answer_id": 55740906, "question_id": 55734230, "link": "https://stackoverflow.com/questions/55734230/need-to-loop-a-code-to-grab-text-from-a-document-and-paste-it-into-another-docum/55740906#55740906", "title": "Need to loop a code to grab text from a document and paste it into another document", "body": "<p>Try, for example:</p>\n\n<pre><code>Sub Demo()\nApplication.ScreenUpdating = False\nDim StrOut As String, wdDoc As Document\nWith ActiveDocument.Range\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = \"Subject:*^13\"\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindStop\n    .Format = False\n    .MatchWildcards = True\n    .Execute\n  End With\n  Do While .Find.Found\n    StrOut = StrOut &amp; .Text\n    .Collapse wdCollapseEnd\n    .Find.Execute\n  Loop\nEnd With\nSet wdDoc = Documents.Add\nwdDoc.Range.Text = StrOut\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11375522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/011a9cb5cb2016cbdd4f0580cd461797?s=128&d=identicon&r=PG&f=1", "display_name": "Pascual Tavarez", "link": "https://stackoverflow.com/users/11375522/pascual-tavarez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 14, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555602642, "creation_date": 1555527157, "last_edit_date": 1555602642, "question_id": 55734230, "link": "https://stackoverflow.com/questions/55734230/need-to-loop-a-code-to-grab-text-from-a-document-and-paste-it-into-another-docum", "title": "Need to loop a code to grab text from a document and paste it into another document", "body": "<p>I have a document that has multiple subject lines - I think someone copied and pasted 100 emails into one Word document. I want to grab all the subject lines and paste them into a new document for further modification.</p>\n\n<p>I've used a mix of code I've found on here to get close. So far I'm able to grab the first iteration of the subject and paste it into the new document, but I'm having trouble figuring out how to loop it so it keeps running down the document, i.e. to capture the other \"99\" instances of subjects. This is what I was trying</p>\n\n<pre><code>Sub SubjectFind()\n\nApplication.ScreenUpdating = False\n\nApplication.Browser.Target = wdBrowseSeciton\n\n    For I = 1 To ActiveDocument.Sections.Count\n    Dim rng1 As Range\n    Dim rng2 As Range\n    Dim strTheText As String\n    Dim DestFileNum As Long\n    Dim sDestFile As String\n\n    sDestFile = \u201cC:\\Users\\pascualt\\Documents\\Doc1.txt\u201d \u2018Location of External File\n    DestFileNum = FreeFile()\n\n    Open sDestFile For Output As DestFileNum \u2018This opens new file with name DestFileNum\n    Set rng1 = ActiveDocument.Range\n    If rng1.Fine.Execute(Findtext:=\u201dSubject:\u201d) Then\n        Set rng2 = ActiveDocument.Range(rng1.End, ActiveDocument.Range.End)\n        If rng2.Fine.Execute(Findtext:=\u201dRef:\u201d) Then\n            strTheText = ActiveDocument.Range (rng1.End, rng2.Start).Text\n            Print #DestFileNum, strTheText \u2018Print # will write to external file\n        End If\n    End If\n    Application.Browser.Next\n        Next I\n    Close #DestFileNum\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1555526946, "post_id": 55734007, "comment_id": 98146794, "body": "I don&#39;t know but your problem may arise from your use of <code>ActiveCell</code>. This is dicey as can end up being something unexpected, particularly when you are using multiple workbooks. Set a reference to O14 at the beginning fully qualifying with workbook and sheet and refer to that rather than <code>ActiveCell</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1555527050, "post_id": 55734007, "comment_id": 98146837, "body": "(1) you should try to modify your code so it doesn&#39;t rely on <code>ActiveCell</code>  (2) Use <code>Like</code> if you want to use wildcards  (3) <code>SourceWS.Range(SourceWS.Range                (&quot;A&quot; &amp; SCount).Address).Offset(3, 2).Text</code> is the same as <code>SourceWS.Cells(SCount+3, 3).Text</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1555530692, "post_id": 55734007, "comment_id": 98148362, "body": "<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select/Activate</a>"}], "owner": {"reputation": 1, "user_id": 11375416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8b949d96339bb203014495e6f9fba8?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/11375416/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1555526267, "creation_date": 1555526165, "last_edit_date": 1555526267, "question_id": 55734007, "link": "https://stackoverflow.com/questions/55734007/in-vba-for-excel-trying-to-copy-data-from-one-wb-to-another-based-on-variable", "title": "In VBA for Excel trying to copy data from one WB to another based on Variable", "body": "<p>I am trying to compile data from one large workbook (that will be downloaded once a month) to one that is more concise. I will be pulling in new data every month.  I will know the name of the source file and it's location.</p>\n\n<p>Below is the code I am trying to run.  It appears to run without errors (going thru all the FOR's and Do Until's) but is just not moving the data from the source file to the destination file.  The variable information I am using is column O starting on line 14 of the destination WB.  I am trying to sort thru column A of the source WB for some text and the variable from the destination WB.  If I have a match I am trying to offset from the matching cell (down 3 rows and right 2 columns) and copy that information to an offset cell on the destination WB (left 4 columns on the same row).  Also copying from down 10 rows and right 2 columns on the source to down row 1 and left 4 columns on the destination.</p>\n\n<pre><code>Sub Get_Scorecard()\n\n    Dim SourceFile As String\n    Dim DestFile As String\n    Dim SourceWB As Workbook\n    Dim SourceWS As Worksheet\n    Dim DestWB As Workbook\n    Dim DestWS As Worksheet\n    Dim path As String\n    Dim Msg As String\n    Dim SCount As Long\n    Dim sourcestart As Range\n    Dim TechName As String\n\n    'Set starting cell on Dest WS\n    Range(\"O14\").Activate\n\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n\n    'Set all the WB's and WS's\n    path = Application.ThisWorkbook.path &amp; \"\\\"\n    SourceFile = path &amp; \"March Test.xlsx\"\n    DestFile = path &amp; \"JobSteps 2019 Test.xlsm\"\n    Set SourceWB = Application.Workbooks.Open(SourceFile)\n    Set SourceWS = SourceWB.Sheets(1)\n    Set DestWB = Application.Workbooks.Open(DestFile)\n    Set DestWS = DestWB.Sheets(1)\n\n\n    'Start in O14 on the Dest WS and loop down till column O is empty\n    Do Until IsEmpty(ActiveCell.Value)\n\n\n        TechName = ActiveCell.Value\n\n        DestStart = ActiveCell.Address\n\n            'Start in Cell A2 on the soure WS and search for tech from Dest WS\n            For SCount = 2 To 700\n\n                If SourceWS.Range(\"A\" &amp; SCount).Text = \"Provisioning*\" &amp; _\n                TechName &amp; \"*\" Then\n                'copy info from 2 offset cells from SourceWS to 2 offset cells on DestWS\n                'I am offseting 4 columns to left on the DestWS just to see if they appear\n                DestWS.Range(DestStart).Offset(0, -4).Value = SourceWS.Range(SourceWS.Range _\n                (\"A\" &amp; SCount).Address).Offset(3, 2).Text\n                DestWS.Range(DestStart).Offset(-1, -4).Value = SourceWS.Range(SourceWS.Range _\n                (\"A\" &amp; SCount).Address).Offset(10, 2).Text\n\n                End If\n\n            Next SCount\n\n        'Offset active cell on DestWS by 4 rows\n        ActiveCell.Offset(4, 0).Activate\n    Loop\n\n    'Close SourceWB\n    SourceWB.Close\n\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    Application.EnableEvents = True\n\n\n    Range(\"A1\").Activate\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1555525264, "post_id": 55733589, "comment_id": 98146069, "body": "Can you check the <code>Shape.Type</code> on that specific shape using <code>Debug.Print Shape.Type</code> and let me know if it actually is <code>msoSlicer</code>?"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 1, "creation_date": 1555526006, "post_id": 55733589, "comment_id": 98146402, "body": "as per my understanding, the timeline is of type msoShapeTypeMixed"}, {"owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1555526236, "post_id": 55733589, "comment_id": 98146502, "body": "@JvdV it returns -2 as the shape.type"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1555528977, "post_id": 55733589, "comment_id": 98147671, "body": "Well there you go, that value means it&#39;s indeed a msoShapeTypeMixed type, hence why it won&#39;t delete. See <a href=\"https://docs.microsoft.com/en-us/office/vba/api/office.msoshapetype\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "edited": false, "score": 0, "creation_date": 1555529331, "post_id": 55733589, "comment_id": 98147836, "body": "Thank you both for your help! That worked!"}, {"owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1555530889, "post_id": 55733589, "comment_id": 98148436, "body": "@JvdV  Do you think you might be able to help with this problem? <a href=\"https://stackoverflow.com/questions/55735045/adding-pivot-tables-to-slicer\">Link</a>"}, {"owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1555530979, "post_id": 55733589, "comment_id": 98148482, "body": "@RicardoDiaz See comment above ^"}], "owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555526474, "creation_date": 1555524367, "last_edit_date": 1555526474, "question_id": 55733589, "link": "https://stackoverflow.com/questions/55733589/delete-excel-pivot-table-timeline-slicer", "title": "Delete Excel Pivot Table Timeline Slicer", "body": "<p>I have the following code that works to delete all pivot table slicers off a particular sheet. When it comes to a timeline slicer (xltimeline) though, it doesn't delete it.</p>\n\n<pre><code>For Each Shape In Worksheets(SheetName).Shapes\n    If Shape.Type = msoSlicer Then Shape.Delete\nNext Shape\n</code></pre>\n\n<p>Any thoughts on why it won't recognize the timeline slicer as a msoSlicer and delete it? I am not sure what to classify the timeline as if it isn't msoSlicer.</p>\n"}, {"tags": ["excel", "vba", "activex", "msscriptcontrol"], "comments": [{"owner": {"reputation": 167, "user_id": 9639219, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGPTz.jpg?s=128&g=1", "display_name": "SpaghettiCode", "link": "https://stackoverflow.com/users/9639219/spaghetticode"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1555525572, "post_id": 55733454, "comment_id": 98146213, "body": "@Tim Williams, thank you for pointing me at the right link. I will try omegastripes workaround later as it looks promising, as always.."}], "owner": {"reputation": 167, "user_id": 9639219, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGPTz.jpg?s=128&g=1", "display_name": "SpaghettiCode", "link": "https://stackoverflow.com/users/9639219/spaghetticode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1320, "favorite_count": 0, "closed_date": 1555524149, "answer_count": 0, "score": 0, "last_activity_date": 1555523769, "creation_date": 1555523769, "question_id": 55733454, "link": "https://stackoverflow.com/questions/55733454/why-does-creating-scriptcontrol-object-fail-run-time-error-429-activex-compo", "closed_reason": "Duplicate", "title": "Why does creating ScriptControl object fail?\u2014Run-time error &#39;429&#39;: ActiveX component can&#39;t create object", "body": "<blockquote>\n  <p>OS: <em>Microsoft Windows 10 Pro (64-bit); Version: 1809; Build: 17763</em></p>\n  \n  <p>Application: <em>Microsoft Excel for Office 365 (64-bit); Version: 16.0</em></p>\n  \n  <p>VBE: <em>Microsoft Visual Basic for Applications 7.1</em></p>\n</blockquote>\n\n<hr>\n\n<p>I was trying to code JavaScript in VBA but encountered a problem before I even started writing it. I've been getting a \"Run-time error '429': ActiveX component can't create object\" message on the line where I assign an object reference to ScriptControl. </p>\n\n<p>I hope you can spare a little of your time on this. Thank you all very much. I'd appreciate all your help.</p>\n\n<p>Here's my code that's giving me errors:</p>\n\n<pre><code>Option Explicit\n\nSub createJSObject_Early()\n\n    Dim js As MSScriptControl.ScriptControl\n    Set js = New MSScriptControl.ScriptControl 'This is the line that gives error\n    js.Language = \"JScript\"\n\nEnd Sub\n</code></pre>\n\n<p>I also tried, late binding:</p>\n\n<pre><code>Option Explicit\n\nSub createJSObject_Late()\n\n    Dim js As Object\n    Set js = CreateObject(\"ScriptControl\") 'This is the line that gives error\n    js.Language = \"JScript\"\n\nEnd Sub\n</code></pre>\n\n<p>I even copy sample codes that use ScriptControl from these websites and run it but those, too, gave me \"Run-time error '429'\":</p>\n\n<p><a href=\"http://ramblings.mcpher.com/Home/excelquirks/snippets/scriptcontrol\" rel=\"nofollow noreferrer\">How to use javaScript from VBA</a></p>\n\n<p><a href=\"https://officetricks.com/how-to-run-javascript-with-in-vba/\" rel=\"nofollow noreferrer\">Learn How To Code JavaScript in VBA</a></p>\n"}, {"tags": ["excel", "vba", "scripting", "sap-gui"], "comments": [{"owner": {"reputation": 8896, "user_id": 9150270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e89ef7ec2f93f949e76081bd9d1749?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra Rossi", "link": "https://stackoverflow.com/users/9150270/sandra-rossi"}, "edited": false, "score": 0, "creation_date": 1579628307, "post_id": 55733193, "comment_id": 105826856, "body": "There is the following answer to loop through all open sessions: <a href=\"https://stackoverflow.com/a/59841341/9150270\">stackoverflow.com/a/59841341/9150270</a>"}], "answers": [{"tags": [], "owner": {"reputation": 201, "user_id": 10549172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fbcf6cc4175d7adcafb460a9791a0c9?s=128&d=identicon&r=PG&f=1", "display_name": "S. MacKenzie", "link": "https://stackoverflow.com/users/10549172/s-mackenzie"}, "is_accepted": false, "score": 1, "last_activity_date": 1555549706, "creation_date": 1555549706, "answer_id": 55737848, "question_id": 55733193, "link": "https://stackoverflow.com/questions/55733193/vba-sap-scripting-to-open-or-connect-remain-in-already-open-session-window/55737848#55737848", "title": "VBA Sap Scripting to open or connect/remain in already open session window", "body": "<p>If you use the SAP BAPI functions in your local client installation, you can bypass the need to execute shell commands etc.</p>\n\n<p>One method in VBA is to create a global variable of type Object in a module for SAP functions.  </p>\n\n<ol>\n<li>In one subroutine in the same module, create the object and login to SAP.</li>\n<li>In other subs/functions do some actions.</li>\n<li>Use a final subroutine to logoff and dispose of the object.</li>\n</ol>\n\n<p>The global variable holds your session open for the duration of your processing.</p>\n\n<p>For example, in your global variables at the top of your module, you could put:</p>\n\n<pre><code>Dim objR3 As Object  'SAP functions / connection\n</code></pre>\n\n<p>Say you make an Access form with some text fields for the logon attributes (you could also use Excel for this and just reference cells).  Then, in your logon subroutine, use something like:</p>\n\n<pre><code>strUser = frm!txtSAPUser\nstrPwd = frm!txtPassword\nstrClient = frm!txtClient\nstrSystem = frm!txtSystem\nstrServer = frm!txtServer\nSet objR3 = CreateObject(\"SAP.Functions\")\nWith objR3.Connection\n    .System = strSystem\n    .client = strClient\n    .User = strUser\n    .Password = strPwd\n    .language = \"EN\"\n    .ApplicationServer = strServer\n    .SystemNumber = strSystem\n    '--if no logon then exit\nIf .logon(0, True) &lt;&gt; True Then\n    MsgBox \"Login failed.\", vbExclamation, \"Login\"\nEnd If\nEnd With\n</code></pre>\n\n<p>Then after doing some actions in other subroutines, you can use a logoff command in your logoff subroutine:</p>\n\n<pre><code>    objR3.Connection.LOGOFF\n</code></pre>\n\n<p>This method will hold your connection open while you perform some scripting against the SAP interface.</p>\n"}, {"tags": [], "owner": {"reputation": 261, "user_id": 11278584, "user_type": "registered", "profile_image": "https://graph.facebook.com/2311394102518777/picture?type=large", "display_name": "reFractil", "link": "https://stackoverflow.com/users/11278584/refractil"}, "is_accepted": false, "score": 1, "last_activity_date": 1555621789, "creation_date": 1555621789, "answer_id": 55753755, "question_id": 55733193, "link": "https://stackoverflow.com/questions/55733193/vba-sap-scripting-to-open-or-connect-remain-in-already-open-session-window/55753755#55753755", "title": "VBA Sap Scripting to open or connect/remain in already open session window", "body": "<p>You could use a function to test if the connection is already open, using something like this...</p>\n\n<pre><code>Sub sap()\n\nIf SAP_Connection Then\nMsgBox (\"Sap is Open so just attached to session(0)\")\nElse\nMsgBox (\"Sap is NOT open so open Logon Window\")\nEnd If\n\nEnd Sub\n\n</code></pre>\n\n<p>The function would look like this... </p>\n\n<pre><code>Function SAP_Connection() As Boolean\n\nOn Error GoTo ErrSap\n\nIf Not IsObject(SapApplication) Then\n   Set SapGuiAuto = GetObject(\"SAPGUI\")\n   Set SapApplication = SapGuiAuto.GetScriptingEngine\nEnd If\nIf Not IsObject(Connection) Then\n   Set Connection = SapApplication.Children(0)\nEnd If\nIf Not IsObject(Session) Then\n   Set Session = Connection.Children(0)\nEnd If\nIf IsObject(WScript) Then\n   WScript.ConnectObject Session, \"on\"\n   WScript.ConnectObject SapApplication, \"on\"\nEnd If\n\nSAP_Connection = True\nExit Function\n\nErrSap:\nSAP_Connection = False\n\nEnd Function\n\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 3412266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8172b8fec0a0cddfecf4d7ef128c1e7?s=128&d=identicon&r=PG&f=1", "display_name": "user3412266", "link": "https://stackoverflow.com/users/3412266/user3412266"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6699, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1610053246, "creation_date": 1555522658, "last_edit_date": 1610053246, "question_id": 55733193, "link": "https://stackoverflow.com/questions/55733193/vba-sap-scripting-to-open-or-connect-remain-in-already-open-session-window", "title": "VBA Sap Scripting to open or connect/remain in already open session window", "body": "<p>I made it ok to automate a SAP transaction data retrieval by using VBA and SAP record and play .vbs script, now I am facing an issue I did not see in the same program in Visual Basic Studio .NET, if SAP Easy Access for my connection of name: LA-6-Prod is already open then Multilogon window appears and breaks my code thus failing the whole thing.</p>\n\n<p>How can I get my code to use the already existing and open connection or open it if it is not open?</p>\n\n<p>It works perfect if LA-6-Prod is not open, but can not tell the end user to make sure no connection windows are open before executing the macro.</p>\n\n<p>Thank you very much</p>\n\n<p>This is my code:</p>\n\n<pre><code>Sub my_sap\n  Dim SapGui, Applic, connection, session, WSHShell\n\n  strconnection = Worksheets(\"sap_info\").Range(\"A2\").Value\n  Shell \"C:\\Program Files (x86)\\SAP\\FrontEnd\\SAPgui\\saplogon.exe\", vbNormalFocus\n  Set WSHShell = CreateObject(\"WScript.Shell\")\n\n  Do Until WSHShell.AppActivate(\"SAP Logon \")\n    application.Wait Now + TimeValue(\"0:00:01\")\n  Loop\n\n  Set WSHShell = Nothing\n  Set SapGui = GetObject(\"SAPGUI\")\n  Set Applic = SapGui.GetScriptingEngine\n\n  Set connection = Applic.OpenConnection('LA-6-Prod', True)\n  Set session = connection.Children(0)\n\n'===============SAP SCRIPTING===========\n\n'Execute SAP stuffs, I put in here what I recorded from sap record and it works OK\n\n'=======================================\n\n  Set session = Nothing\n  connection.CloseSession (\"ses[0]\")\n  Set connection = Nothing\n  Set sap = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "date"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 2, "creation_date": 1555522856, "post_id": 55733181, "comment_id": 98145007, "body": "You have to create a loop and check each row."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "edited": false, "score": 0, "creation_date": 1555526158, "post_id": 55733441, "comment_id": 98146472, "body": "no that didn&#39;t help. not doing anything. i may have another option, just adding to a different code. i modified a different code i had and this one works."}], "tags": [], "owner": {"reputation": 28, "user_id": 11374363, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-p9S0VOkaDTU/AAAAAAAAAAI/AAAAAAAAXqA/I0uCi_3HDjk/photo.jpg?sz=128", "display_name": "Pedro Nunes", "link": "https://stackoverflow.com/users/11374363/pedro-nunes"}, "is_accepted": false, "score": 0, "last_activity_date": 1555523746, "last_edit_date": 1555523746, "creation_date": 1555523703, "answer_id": 55733441, "question_id": 55733181, "link": "https://stackoverflow.com/questions/55733181/how-to-copy-an-entire-row-to-sheet-2-if-column-h-has-a-date-in-cell/55733441#55733441", "title": "how to copy an entire row to sheet 2 if column H has a date in cell.?", "body": "<p>If you use <code>For each myDate in range(\"H2:H6000\")</code> instead of set range?</p>\n\n<pre><code>Sub CopyRowWithDates()\n   Application.EnableEvents = False\n   Application.ScreenUpdating = False\n\n   Dim lrowcompleted As String\n   Dim myDate as String\n\n  For each myDate in range(\"H2:H6000\")\n\n   On Error Resume Next\n   Application.EnableEvents = False\n\n        If myDate = \"mm/dd/yyy\" Then\n\n            lrowcompleted = Sheets(\"OFF RENT\").Cells(Rows.Count, \"A\").End(xlUp).ROW\n\n            Range(\"A\" &amp; myDate.ROW &amp; \":N\" &amp; myDate.ROW).Copy Sheets(\"OFF RENT\").Range(\"A\" &amp; lrowcompleted + 1)\n            Else\n        End If\n\n    Application.EnableEvents = True\n    Application.Screenupdating = True\nEnd Sub\n</code></pre>\n\n<p>I prefer to use <code>Range(\"A1048576\").End(xlUp).Row</code>instead of <code>Cells(Rows.Count,\"A\").End(xlUp).ROW</code></p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "is_accepted": true, "score": 0, "last_activity_date": 1555526260, "creation_date": 1555526260, "answer_id": 55734025, "question_id": 55733181, "link": "https://stackoverflow.com/questions/55733181/how-to-copy-an-entire-row-to-sheet-2-if-column-h-has-a-date-in-cell/55734025#55734025", "title": "how to copy an entire row to sheet 2 if column H has a date in cell.?", "body": "<p>i modified a different code i had and this one works the way i need it to. thanks for help.</p>\n\n<pre><code>   Private Sub CommandButton5_Click()\nDim id As String\nDim PO As String\nDim finalrow As Integer\nDim i As Integer\nDim lrowcompleted As String\n\nid = TextBox19.Value\nfinalrow = Sheets(\"ALL P.O. INFO\").Range(\"D6000\").End(xlUp).row\n\nFor i = 2 To finalrow\n    If Sheets(\"ALL P.O. INFO\").Cells(i, 4) = id Then\n        Sheets(\"ALL P.O. INFO\").Cells(i, 8).Value = TextBox17.Value\n    End If\n\n    If Sheets(\"MECHANICAL EQUIP.\").Cells(i, 4) = id Then\n            Sheets(\"MECHANICAL EQUIP.\").Cells(i, 8).Value = TextBox17.Value\n            lrowcompleted = Sheets(\"OFF RENT\").Range(\"A6000\").End(xlUp).row\n            Sheets(\"MECHANICAL EQUIP.\").Range(\"A\" &amp; i &amp; \":N\" &amp; i).Copy Sheets(\"OFF RENT\").Range(\"A\" &amp; lrowcompleted + 1)\n\n\n    End If\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 55734025, "answer_count": 2, "score": 0, "last_activity_date": 1555526260, "creation_date": 1555522613, "last_edit_date": 1555523970, "question_id": 55733181, "link": "https://stackoverflow.com/questions/55733181/how-to-copy-an-entire-row-to-sheet-2-if-column-h-has-a-date-in-cell", "title": "how to copy an entire row to sheet 2 if column H has a date in cell.?", "body": "<p>I am trying to search (if column <code>H</code> in sheet <code>mechanical Equip.</code> has any date then copy entire row to sheet <code>off rent</code> next available row. It is coping the first row from <code>mechanical equip.</code> whether it has a date or not.</p>\n\n<pre><code>Sub CopyRowWithDates()\n   Dim lrowcompleted As String\n   Dim Rrange As Range\n\n   Set Rrange = Sheets(\"MECHANICAL EQUIP.\").Range(\"H2:H6000\")\n\n   On Error Resume Next\n   Application.EnableEvents = False\n\n\n        If Rrange = \"mm/dd/yyy\" Then\n\n            lrowcompleted = Sheets(\"OFF RENT\").Cells(Rows.Count, \"A\").End(xlUp).ROW\n\n            Range(\"A\" &amp; Rrange.ROW &amp; \":N\" &amp; Rrange.ROW).Copy Sheets(\"OFF RENT\").Range(\"A\" &amp; lrowcompleted + 1)\n            Else\n        End If\n\n    Application.EnableEvents = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1555523395, "post_id": 55733131, "comment_id": 98145262, "body": "What is your overall goal, and what is the source of the data?  If your goal is to create a table, then <code>Power Query</code> can do this fairly easily.  If you need the items separated for some other reason, Regular Expressions is one way to approach."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1555523731, "post_id": 55733131, "comment_id": 98145420, "body": "If your data is in JSON format then there are better ways to approach this."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1555523798, "post_id": 55733131, "comment_id": 98145445, "body": "Are these strings in a cell? And are the entries all of the form &quot;Name&quot;:&quot;Ram&quot;,&quot;Phone&quot;:&quot;9898989898&quot;,&quot;Email&quot;:&quot;abcd@gmail.com&quot;"}, {"owner": {"reputation": 39, "user_id": 10130636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TytZk.jpg?s=128&g=1", "display_name": "sunil", "link": "https://stackoverflow.com/users/10130636/sunil"}, "edited": false, "score": 0, "creation_date": 1555570143, "post_id": 55733131, "comment_id": 98158169, "body": "Yes it&#39;s JSON format and its in one cell from where I&#39;m trying to extract"}], "answers": [{"tags": [], "owner": {"reputation": 327, "user_id": 10397847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b35fc42f3907aeeb72103e228c86cdf?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesPL", "link": "https://stackoverflow.com/users/10397847/charlespl"}, "is_accepted": false, "score": 2, "last_activity_date": 1555524312, "creation_date": 1555524312, "answer_id": 55733574, "question_id": 55733131, "link": "https://stackoverflow.com/questions/55733131/udf-to-extract-specific-data-from-a-generic-string/55733574#55733574", "title": "UDF to extract specific data from a generic string", "body": "<p>Your RAW data seems to match the JSON format. One thing that can be done is to use a module (like <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">this one</a> that worked very well for me) to parse it (i.e. put some order in it, so you can easily get the result you are looking for). </p>\n\n<p>Follow the <a href=\"https://github.com/VBA-tools/VBA-JSON#installation\" rel=\"nofollow noreferrer\">simple instructions</a> to add this module to your VBA project (remember to add the Microsoft.Scripting Reference!). Then your function would look like this :</p>\n\n<pre><code>Public Function Extractinfo(byval CompleteString as String, byval FieldName as String) as String\n\n    Dim JSON as Object\n    Set JSON = JsonConverter.ParseJson(CompleteString)\n\n    ExtractInfo = JSON(FieldName)\n\nEnd Function\n</code></pre>\n\n<p>This code sample is overly simplified (does not have any error handling), but this should get you started.</p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 10130636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TytZk.jpg?s=128&g=1", "display_name": "sunil", "link": "https://stackoverflow.com/users/10130636/sunil"}, "edited": false, "score": 0, "creation_date": 1555576176, "post_id": 55733635, "comment_id": 98161038, "body": "it&#39;s working perfectly, this is what i was looking than you so much"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1555525234, "last_edit_date": 1555525234, "creation_date": 1555524565, "answer_id": 55733635, "question_id": 55733131, "link": "https://stackoverflow.com/questions/55733131/udf-to-extract-specific-data-from-a-generic-string/55733635#55733635", "title": "UDF to extract specific data from a generic string", "body": "<p>How about:</p>\n\n<pre><code>Public Function ExtractInfo(s As String, choice As String) As String\n\n    dq = Chr(34)\n    arr = Split(s, dq)\n\n    If choice = \"Name\" Then\n        ExtractInfo = arr(3)\n        Exit Function\n    End If\n\n    If choice = \"Phone\" Then\n        ExtractInfo = arr(7)\n        Exit Function\n    End If\n\n    If choice = \"Email\" Then\n        ExtractInfo = arr(11)\n        Exit Function\n    End If\n\n    ExtractInfo = \"bad data\"\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/jQqRP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jQqRP.png\" alt=\"enter image description here\"></a></p>\n\n<p>This assumes that all your data follows the same schema.  Options would be:</p>\n\n<pre><code>=extractinfo(A1,\"Name\")\n=extractinfo(A1,\"Phone\")\n=extractinfo(A1,\"Email\")\n</code></pre>\n\n<p>You could also use <code>Case</code> for this.</p>\n"}], "owner": {"reputation": 39, "user_id": 10130636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TytZk.jpg?s=128&g=1", "display_name": "sunil", "link": "https://stackoverflow.com/users/10130636/sunil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "accepted_answer_id": 55733635, "answer_count": 2, "score": 1, "last_activity_date": 1555536613, "creation_date": 1555522384, "last_edit_date": 1555536613, "question_id": 55733131, "link": "https://stackoverflow.com/questions/55733131/udf-to-extract-specific-data-from-a-generic-string", "title": "UDF to extract specific data from a generic string", "body": "<p>I'm trying to create a function like =Extractinfo(\"A2\",\"Name\"), which can extract name, phone and email id from raw data, one function for all 3 extractions, I already have a function to extract email id</p>\n\n<pre><code> Raw Data\n\n\"Name\":\"Ram\",\"Phone\":\"9898989898\",\"Email\":\"abcd@gmail.com\"\n\"Name\":\"Raju\",\"Phone\":\"2323232323\",\"Email\":\"xyz123@gmail.com\"\n\"Name\":\"Rameshsing\",\"Phone\":\"555999999\",\"Email\":\"rameshsing@gmail.com\"\n\n(Function to extract)          (Expected Result)\n=Extractinfo(\"A2\",\"Name\")      Ram\n=Extractinfo(\"A2\",\"Name\")      Raju\n=Extractinfo(\"A4\",\"Name\")      Rameshsing\n\n\nFunction ExtractEmailFun(extractStr As String) As String\n\n Dim CharList As String\n On Error Resume Next\nCheckStr = \"[A-Za-z0-9._-]\"\nOutStr = \"\"\nIndex = 1\nDo While True\nIndex1 = VBA.InStr(Index, extractStr, \"@\")\ngetStr = \"\"\nIf Index1 &gt; 0 Then\n    For p = Index1 - 1 To 1 Step -1\n        If Mid(extractStr, p, 1) Like CheckStr Then\n            getStr = Mid(extractStr, p, 1) &amp; getStr\n        Else\n            Exit For\n        End If\n    Next\n    getStr = getStr &amp; \"@\"\n    For p = Index1 + 1 To Len(extractStr)\n        If Mid(extractStr, p, 1) Like CheckStr Then\n            getStr = getStr &amp; Mid(extractStr, p, 1)\n        Else\n            Exit For\n        End If\n    Next\n    Index = Index1 + 1\n    If OutStr = \"\" Then\n        OutStr = getStr\n    Else\n        OutStr = OutStr &amp; Chr(10) &amp; getStr\n    End If\nElse\n      Exit Do\nEnd If\nLoop\nExtractEmailFun = OutStr\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1555522306, "post_id": 55732977, "comment_id": 98144717, "body": "Do you have one table on each worksheet?"}, {"owner": {"reputation": 3, "user_id": 11375170, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oVor1cfATIY/AAAAAAAAAAI/AAAAAAAAAJo/O1QkrIjuvAU/photo.jpg?sz=128", "display_name": "Sean", "link": "https://stackoverflow.com/users/11375170/sean"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1555523881, "post_id": 55732977, "comment_id": 98145483, "body": "Yes, each worksheet is the exact same format"}], "answers": [{"comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 1, "creation_date": 1555525047, "post_id": 55733650, "comment_id": 98145969, "body": "I&#39;d just add: If ws.ListObjects.Count &gt;= 1 Then to check if the sheet has tables (listobjects)"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1555524643, "creation_date": 1555524643, "answer_id": 55733650, "question_id": 55732977, "link": "https://stackoverflow.com/questions/55732977/filter-out-blanks-from-tables-in-all-worksheets/55733650#55733650", "title": "Filter out blanks from tables in all worksheets", "body": "<p>I suggest you read up on loops.</p>\n\n<pre><code>Private Sub FilterBlanks_Click()\n\nDim ws As Worksheet\n\nFor Each ws In Worksheets\n    ws.ListObjects(1).Range.AutoFilter _\n                                Field:=4, _\n                                Criteria1:=\"&lt;&gt;\", _\n                                Operator:=xlFilterValues\n\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11375170, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oVor1cfATIY/AAAAAAAAAAI/AAAAAAAAAJo/O1QkrIjuvAU/photo.jpg?sz=128", "display_name": "Sean", "link": "https://stackoverflow.com/users/11375170/sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14, "favorite_count": 0, "accepted_answer_id": 55733650, "answer_count": 1, "score": 0, "last_activity_date": 1555526752, "creation_date": 1555521654, "last_edit_date": 1555526752, "question_id": 55732977, "link": "https://stackoverflow.com/questions/55732977/filter-out-blanks-from-tables-in-all-worksheets", "title": "Filter out blanks from tables in all worksheets", "body": "<p>I am running a report that has Dollar amounts attached to Cost codes. I have a list of 300+ cost codes in a table. I have 84 worksheets with the exact same table. I am wanting to use an activex button to filter out all of the blanks from the same column in each worksheet. </p>\n\n<pre><code>Private Sub FilterBlanks_Click()\n\nWorksheets(\"825209000\").ListObjects(\"Table1\").Range.AutoFilter _\n Field:=4, _\n Criteria1:=\"&lt;&gt;\", _\n Operator:=xlFilterValues\n\nWorksheets(\"825109202\").ListObjects(\"Table2\").Range.AutoFilter _\n Field:=4, _\n Criteria1:=\"&lt;&gt;\", _\n Operator:=xlFilterValues\n\nWorksheets(\"825109200\").ListObjects(\"Table3\").Range.AutoFilter _\n Field:=4, _\n Criteria1:=\"&lt;&gt;\", _\n Operator:=xlFilterValues\n\nEnd Sub\n</code></pre>\n\n<p>The code attached is what I am using for this. It seems to be working fine, but I am wondering how I would go about making a loop of some kind so I dont have to add each worksheet &amp; table into the code.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 543, "user_id": 7420518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DweYi.png?s=128&g=1", "display_name": "IvenBach", "link": "https://stackoverflow.com/users/7420518/ivenbach"}, "edited": false, "score": 1, "creation_date": 1555526620, "post_id": 55732875, "comment_id": 98146669, "body": "<code>Application.DisplayAlerts</code> is turned off then never turned back on. Don&#39;t forget about restoring the setting once you&#39;ve completed the Sub."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11215399, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-142ueqwZN3g/AAAAAAAAAAI/AAAAAAAAADI/KRMen-DUYJE/photo.jpg?sz=128", "display_name": "RISHABH SINGH", "link": "https://stackoverflow.com/users/11215399/rishabh-singh"}, "edited": false, "score": 0, "creation_date": 1555522648, "post_id": 55733079, "comment_id": 98144895, "body": "I want to save my file in PRN and my code is working awesome but the problem is once you convert the output prn then convert into notepad  all the data i have put in my excel came into some other language it like ----  (\u0192&#209;}q\u2019ne\u201d:&#189;\u0152A&#175;[&#247; &amp;Q&#226;&#208;&#196;6\u2013&#246;&#39;o?\u201cC&#186;@&#201;.&#161;............"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11, "user_id": 11215399, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-142ueqwZN3g/AAAAAAAAAAI/AAAAAAAAADI/KRMen-DUYJE/photo.jpg?sz=128", "display_name": "RISHABH SINGH", "link": "https://stackoverflow.com/users/11215399/rishabh-singh"}, "edited": false, "score": 1, "creation_date": 1555522723, "post_id": 55733079, "comment_id": 98144943, "body": "All your code is doing is sticking a .prn extension to a file that contains .xlsx data. Whatever is reading .xlsx data while expecting .prn data, is reading gibberish because of that. You need to specify the <code>FileFormat</code> argument in the <code>SaveAs</code> method call. It&#39;s not &quot;some other language&quot;, it&#39;s literal gibberish, a byte soup."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11, "user_id": 11215399, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-142ueqwZN3g/AAAAAAAAAAI/AAAAAAAAADI/KRMen-DUYJE/photo.jpg?sz=128", "display_name": "RISHABH SINGH", "link": "https://stackoverflow.com/users/11215399/rishabh-singh"}, "edited": false, "score": 0, "creation_date": 1555523345, "post_id": 55733079, "comment_id": 98145242, "body": "@RISHABHSINGH What you&#39;re reading in Notepad is .xlsx content, i.e. a zip-compressed file. Specify the <code>FileFormat:=xlTextPrinter</code> when you <code>SaveAs</code>, and then the data should be as expected."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 11, "user_id": 11215399, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-142ueqwZN3g/AAAAAAAAAAI/AAAAAAAAADI/KRMen-DUYJE/photo.jpg?sz=128", "display_name": "RISHABH SINGH", "link": "https://stackoverflow.com/users/11215399/rishabh-singh"}, "edited": false, "score": 1, "creation_date": 1555524029, "post_id": 55733079, "comment_id": 98145543, "body": "@RISHABHSINGH Your code is the equivalent of <code>copy MyWorkbook.xlsx MyDatabase.accdb</code>. Just because you changed the extension from <code>.xlsx</code> to <code>.accdb</code> does NOT mean that Access will now be able to open it as an Access Database file. You&#39;ve simply done <code>copy MyWorksheet.xlsx MyWorksheet.prn</code> - it&#39;s still an Excel file, not a text file. By setting the <code>FileFormat:=xlTextPrinter</code> as recommended in this answer, you&#39;re telling Excel to save plain text instead of Open Workbook XML."}, {"owner": {"reputation": 11, "user_id": 11215399, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-142ueqwZN3g/AAAAAAAAAAI/AAAAAAAAADI/KRMen-DUYJE/photo.jpg?sz=128", "display_name": "RISHABH SINGH", "link": "https://stackoverflow.com/users/11215399/rishabh-singh"}, "edited": false, "score": 0, "creation_date": 1555524306, "post_id": 55733079, "comment_id": 98145662, "body": "One last thing i have used your code it is working a fine(ws.SaveAs Filename:=&quot;D:\\birla soft\\&quot; &amp; ws.Name &amp; &quot;.prn&quot;, FileFormat:=xlTextPrinter) but it gives output like this (...sheet1,...sheet2) I do not want (...) these dots in the starting i just want and keep it simple like (sheet1) (sheet2) &amp; so on."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11, "user_id": 11215399, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-142ueqwZN3g/AAAAAAAAAAI/AAAAAAAAADI/KRMen-DUYJE/photo.jpg?sz=128", "display_name": "RISHABH SINGH", "link": "https://stackoverflow.com/users/11215399/rishabh-singh"}, "edited": false, "score": 0, "creation_date": 1555524593, "post_id": 55733079, "comment_id": 98145804, "body": "@RISHABHSINGH the code in this answer was never meant to be copy-pasted directly. I didn&#39;t feel like spelling out the whole file names, you can do that and fill in the blanks."}, {"owner": {"reputation": 11, "user_id": 11215399, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-142ueqwZN3g/AAAAAAAAAAI/AAAAAAAAADI/KRMen-DUYJE/photo.jpg?sz=128", "display_name": "RISHABH SINGH", "link": "https://stackoverflow.com/users/11215399/rishabh-singh"}, "edited": false, "score": 0, "creation_date": 1555525020, "post_id": 55733079, "comment_id": 98145961, "body": "Ooops sorry i became so lazy or you an say clumsy. by the way thanks a lot"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1555522495, "last_edit_date": 1555522495, "creation_date": 1555522174, "answer_id": 55733079, "question_id": 55732875, "link": "https://stackoverflow.com/questions/55732875/convert-excel-file-into-prn-gives-different-language-data/55733079#55733079", "title": "convert excel file into prn gives different language data", "body": "<p>You're saving a .xlsm/.xlsx file with a .prn extension; that doesn't make it a .prn file, it's still a .xlsm/.xlsx file - the extension isn't what determines the file's format, it's just a convenient indicator for us puny humans to recognize what we're looking at when we browse through files. You want to supply a <code>xlTextPrinter</code> <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.xlfileformat\" rel=\"nofollow noreferrer\">XlFileFormat</a> argument to the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.saveas\" rel=\"nofollow noreferrer\"><code>SaveAs</code> method</a>:</p>\n\n<pre><code>ActiveSheet.SaveAs Filename:=\"D:\\birla soft\\\" &amp; ActiveSheet.Name &amp; \".prn\", xlTextPrinter\n</code></pre>\n\n<hr>\n\n<p>A note about this:</p>\n\n<pre><code>ws.Activate\n</code></pre>\n\n<p>You don't need it. Instead, qualify these <code>Range</code> calls with the <code>ws</code> object - and you want to iterate the <code>Worksheets</code> collection (<code>Sheets</code> may contain all kinds of non-worksheet sheet types):</p>\n\n<pre><code>For Each ws In ActiveWorkbook.Worksheets ' or did you mean to iterate sheets in ThisWorkbook?\n    Do While ws.Range(...)\n        ws.Range(...) = ws.Range(...) + 1\n        vcounter = vcounter + 1\n    Loop\n    Application.DisplayAlerts = False\n    ws.SaveAs FileName:=\"...\" &amp; ws.Name &amp; \".prn\", FileFormat:=xlTextPrinter\nNext\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11215399, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-142ueqwZN3g/AAAAAAAAAAI/AAAAAAAAADI/KRMen-DUYJE/photo.jpg?sz=128", "display_name": "RISHABH SINGH", "link": "https://stackoverflow.com/users/11215399/rishabh-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1555522495, "creation_date": 1555521223, "last_edit_date": 1555521896, "question_id": 55732875, "link": "https://stackoverflow.com/questions/55732875/convert-excel-file-into-prn-gives-different-language-data", "title": "convert excel file into prn gives different language data", "body": "<p>after converting my sheet into prn it gives error during upload on my erp ,when i convert prn into txt format i saw some kind of chinese written how to fix this problem.   below code add value +1 in row \"A\" and convert into prn</p>\n\n<pre><code>Sub CONVERT()\n\nDim vcounter As Long\nDim ws As Worksheet\n\nFor Each ws In Sheets\n  ws.Activate\n  vcounter = 2\n  While Range(\"A\" &amp; vcounter).Value &lt;&gt; \"\"\n    Range(\"a\" &amp; vcounter).Value = Range(\"a\" &amp; vcounter).Value + 1   \n    vcounter = vcounter + 1\n  Wend\n  Application.DisplayAlerts = False\n  ActiveSheet.SaveAs Filename:=\"D:\\birla soft\\\" &amp; ActiveSheet.Name &amp; \".prn\"\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1555521454, "post_id": 55732850, "comment_id": 98144362, "body": "You only need one form with space for 12 firms - just hide or disable the controls for the unused slots"}, {"owner": {"reputation": 21, "user_id": 10751921, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0YIJ3ctNkLE/AAAAAAAAAAI/AAAAAAAAz9M/YhbZJS1VhJQ/photo.jpg?sz=128", "display_name": "K Alexander", "link": "https://stackoverflow.com/users/10751921/k-alexander"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1555521623, "post_id": 55732850, "comment_id": 98144434, "body": "Thanks. I hadn&#39;t considered that. 12 is fairly typical for a high volume proposal, I&#39;ve seen as many as 30 on occasion. I hadn&#39;t thought about setting up a larger form and hiding controls though, so thanks for that. I&#39;ll look into it. Like I said, I&#39;m not super experienced with UserForms."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1555521813, "post_id": 55732850, "comment_id": 98144510, "body": "This is a very, very broad subject, I could write an entire chapter of a book to cover everything about this... and this site won&#39;t let me post an answer with more than a mere 30K characters... can you narrow the scope down a bit, to a more <i>specific</i> problem? Do you have any code written at al?"}, {"owner": {"reputation": 21, "user_id": 10751921, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0YIJ3ctNkLE/AAAAAAAAAAI/AAAAAAAAz9M/YhbZJS1VhJQ/photo.jpg?sz=128", "display_name": "K Alexander", "link": "https://stackoverflow.com/users/10751921/k-alexander"}, "edited": false, "score": 0, "creation_date": 1555522643, "post_id": 55732850, "comment_id": 98144889, "body": "Ah well, no worries. If it&#39;s too difficult, I&#39;ll be able to bodge out something workable along the lines of Tim&#39;s idea. Might not look pretty, but I reckon it&#39;ll work in most cases. The headache is all my own fault for speaking up with a &quot;bright idea&quot; without thinking in front of mgmt anyways! Thanks all the same."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1555523661, "post_id": 55732850, "comment_id": 98145376, "body": "If you have trouble making this work on a UserForm, you might consider implementing it on a worksheet - maybe more configured/locked down than your current one."}, {"owner": {"reputation": 21, "user_id": 10751921, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0YIJ3ctNkLE/AAAAAAAAAAI/AAAAAAAAz9M/YhbZJS1VhJQ/photo.jpg?sz=128", "display_name": "K Alexander", "link": "https://stackoverflow.com/users/10751921/k-alexander"}, "edited": false, "score": 0, "creation_date": 1555524201, "post_id": 55732850, "comment_id": 98145624, "body": "I&#39;d actually been working on a new version of the workbook to make it easier in any case, but had made the mistake of offhandedly saying to a manager than a UserForm might be am more elegant solution and ever since then he&#39;s been pushing hard for that so I&#39;m going to have to deliver something workable and then make the case that the spreadsheet is better! Thanks for the pointers."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1555525823, "post_id": 55732850, "comment_id": 98146328, "body": "I built a dynamic userform based on the <a href=\"https://codereview.stackexchange.com/q/205263/106798\">example code on Code Review</a> by @Tinman and it worked very well. I think this type of form, where you can add as many rows as needed, would be an easy to use front end for your users."}], "owner": {"reputation": 21, "user_id": 10751921, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0YIJ3ctNkLE/AAAAAAAAAAI/AAAAAAAAz9M/YhbZJS1VhJQ/photo.jpg?sz=128", "display_name": "K Alexander", "link": "https://stackoverflow.com/users/10751921/k-alexander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555521155, "creation_date": 1555521155, "question_id": 55732850, "link": "https://stackoverflow.com/questions/55732850/creating-a-userform-with-variable-number-of-inputs", "title": "Creating a UserForm with Variable Number of Inputs", "body": "<p>I am looking to create a new UserForm to make it easier for the evaluation team here. Essentially, they must evaluate proposals from a number of firms (anywhere from 2 to 12 or so) against certain factors by ranking the firms in order or preference/suitability. We've had complaints about user errors and confusion when they're just putting the numbers straight onto the spreadsheet itself, so it's been left to me to clean it up and make it more \"user-friendly\" for them. </p>\n\n<p>I have the set-up part done, where users are asked to input the number of firms to be evaluated, the type of evaluation to carry out (this changes the metrics, but there are always 6 of them), and the names of the firms. The firm names are all put into a Named Range (\"evalFirms\") on a hidden sheet.</p>\n\n<p>What I'd like is for a new UserForm to then be set up with two columns, the left hand being populated by TextBoxes with the evalFirms the user entered at set up and the right hand being an input to Rank the firms such that each rank is unique (i.e. not having two firms ranking 1st). </p>\n\n<pre><code>Evaluation Metric 1\n\nFirm A   |   2\nFirm B   |   1\n  :      |   :\nFirm n   |   n\n</code></pre>\n\n<p>These ranks will then be passed to a hidden sheet where the relevant calculations are done. That part is also all set up and ready to go, it is just this middle part that's given me headaches. The text box at the top should cycle through each of the 6 evaluation metrics (also a dynamic named range called \"evalMetrics\") until all firms have been fully evaluated.</p>\n\n<p>I'm not super experienced with UserForms, so I'm having trouble with the varying amount of inputs. I can set up a static form, but rather than set up 12 different forms and have each called depending on the number of firms being evaluated, I'd prefer to have a single dynamic form.</p>\n\n<p>Any help or pointers would be appreciated, thanks.</p>\n"}, {"tags": ["excel", "vba", "internet-explorer", "autoit"], "comments": [{"owner": {"reputation": 19, "user_id": 11366136, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mnmDzXe8Q78/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rczJtaTn6izP9JnKhAoN6jqwfZLsQ/mo/photo.jpg?sz=128", "display_name": "&#201;rick Brice&#241;o", "link": "https://stackoverflow.com/users/11366136/%c3%89rick-brice%c3%b1o"}, "edited": false, "score": 1, "creation_date": 1555521414, "post_id": 55732842, "comment_id": 98144346, "body": "I&#39;ve already solved it, the problem was the (). Thank you anyway."}, {"owner": {"reputation": 5002, "user_id": 9012170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3225450779d6822dd7e376c02764b058?s=128&d=identicon&r=PG&f=1", "display_name": "michael_heath", "link": "https://stackoverflow.com/users/9012170/michael-heath"}, "edited": false, "score": 0, "creation_date": 1555575853, "post_id": 55732842, "comment_id": 98160873, "body": "The examples in <i>AutoItX.chm</i> in the <i>COM interface</i> section shows some VBScript code. Those examples should be rather close, if not the same to the syntax needed for VBA."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556035744, "post_id": 55732842, "comment_id": 98297344, "body": "should this not be a sub as it doesn&#39;t return anything?"}], "owner": {"reputation": 19, "user_id": 11366136, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mnmDzXe8Q78/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rczJtaTn6izP9JnKhAoN6jqwfZLsQ/mo/photo.jpg?sz=128", "display_name": "&#201;rick Brice&#241;o", "link": "https://stackoverflow.com/users/11366136/%c3%89rick-brice%c3%b1o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556022978, "creation_date": 1555521112, "last_edit_date": 1556022978, "question_id": 55732842, "link": "https://stackoverflow.com/questions/55732842/i-want-to-run-a-autoit-script-in-vba-but-it-returns-an-compile-error-expected", "title": "I want to run a AutoIt script in VBA but it returns an Compile error expected = in many lines", "body": "<p>When I'm writing the script it returns a Compile error expected = when it doesn't need it. What can I do to fix it?</p>\n\n<p>It's a function included in another code. The windows do exist and I follow all the instructions to convert Autoit Code to VBA.</p>\n\n<pre><code>Public Function GenerateDocument()\n\n\nDim AutoIt As Object\nSet AutoIt = Wscript.CreateObject(\"AutoITX3.Control\")\n\nWith AutoIt\n    .WinExists(\"PRGX SIM - Payments - Internet Explorer\", \"Address Combo Contro\") 'It generates a problem\n    .WinWaitActivate(\"PRGX SIM - Payments - Internet Explorer\", \"Address Combo Contro\") 'Also it\n    .MouseClick(\"left\",1311,277,1) 'And this one\n    .MouseUp (\"left\") \n    .MouseClick(\"left\",1214,380,1) 'This other one to\n    .MouseUp (\"left\")\n\nEnd With\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 2, "creation_date": 1555520748, "post_id": 55732670, "comment_id": 98144049, "body": "Have you tried <code>Match()</code>?  Looks like that is right up your alley, and doesn&#39;t require VBA.  If you go the VBA route, you would loop and use <code>InStr()</code> for partial matches."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 2, "creation_date": 1555520998, "post_id": 55732670, "comment_id": 98144167, "body": "I&#39;m with @Cyril here, this looks like a job for <code>Match</code>, albeit with a bit of concatenating. Or perhaps <code>Find</code>. Like, <code>=FIND(&quot;12401&quot;,A1)&gt;0</code>"}], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 2, "last_activity_date": 1555523897, "creation_date": 1555523897, "answer_id": 55733480, "question_id": 55732670, "link": "https://stackoverflow.com/questions/55732670/compare-all-column-values-against-individual-cells-in-excel/55733480#55733480", "title": "Compare all column values against individual cells in Excel", "body": "<p>Here is some UDF you could use.</p>\n\n<p><a href=\"https://i.stack.imgur.com/hyuYZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hyuYZ.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Dim MyArr As Variant, X As Double, LR As Double\n\nOption Explicit\n\nPublic Function MatchID(RNG As Range) As String\n\nWith ActiveWorkbook.Sheets(RNG.Parent.Name)\n    LR = .Cells(Rows.Count, 1).End(xlUp).Row\n    MyArr = Application.Transpose(.Range(.Cells(2, 1), .Cells(LR, 1)))\n    For X = LBound(MyArr) To UBound(MyArr)\n        If InStr(1, RNG.Value, MyArr(X), vbTextCompare) &gt; 0 Then\n            If MatchID = \"\" Then\n                MatchID = MyArr(X)\n            Else\n                MatchID = MatchID &amp; \", \" &amp; MyArr(X)\n            End If\n        End If\n    Next X\nEnd With\n\nEnd Function\n\nPublic Function MatchCFNAME(RNG As Range) As String\n\nWith ActiveWorkbook.Sheets(RNG.Parent.Name)\n    LR = .Cells(Rows.Count, 1).End(xlUp).Row\n    MyArr = Application.Transpose(.Range(.Cells(2, 2), .Cells(LR, 2)))\n    For X = LBound(MyArr) To UBound(MyArr)\n        If InStr(1, RNG.Value, MyArr(X), vbTextCompare) &gt; 0 Then\n            If MatchCFNAME = \"\" Then\n                MatchCFNAME = MyArr(X)\n            Else\n                MatchCFNAME = MatchCFNAME &amp; \", \" &amp; MyArr(X)\n            End If\n        End If\n    Next X\nEnd With\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/mCvT4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mCvT4.png\" alt=\"enter image description here\"></a></p>\n\n<p>In <code>D2</code> Ijust used <code>=IF(F2&lt;&gt;\"\",\"YES\",\"\")</code> and dragged it sideways and down.</p>\n"}], "owner": {"reputation": 79, "user_id": 6495500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E43Tf.gif?s=128&g=1", "display_name": "vpm", "link": "https://stackoverflow.com/users/6495500/vpm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 1, "accepted_answer_id": 55733480, "answer_count": 1, "score": 0, "last_activity_date": 1555523897, "creation_date": 1555520385, "last_edit_date": 1555521608, "question_id": 55732670, "link": "https://stackoverflow.com/questions/55732670/compare-all-column-values-against-individual-cells-in-excel", "title": "Compare all column values against individual cells in Excel", "body": "<p>I'd like to find if any row in Column C matches any cells in Column A or B and print out 'yes' or 'no' in an adjacent cell if it does match.  The match might not be exact, because an ID may be written as '12401' but the match in the column may be like 'cf[12401]', with the ID enclosed in brackets. </p>\n\n<p>This is an example of what I might find in the table.  The values in A and B columns originally came from another table but I'm trying to find all instances of where they might exist in the third column.</p>\n\n<p>Excel Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1VyQi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1VyQi.png\" alt=\"enter image description here\"></a></p>\n\n<p>If possible, I'd like to list the values themselves that matched in the column.  But that part would be a nice extra while the other part is more important because there are around 6000 values in the middle column so it would take days by hand.</p>\n\n<p>I've tried different things like this:</p>\n\n<pre><code>=IF(COUNTIF(C2,\"*\" &amp; A6 &amp; \"*\" ), \"Yes\", \"No\") \n</code></pre>\n\n<p>or </p>\n\n<pre><code>=IF(COUNTIF(C2,\"*\" &amp; Length &amp; \"*\" ), \"Yes\", \"No\")\n</code></pre>\n\n<p>these work for individual words or cells, but trying to check all the values in that column against the cell will return no.  I've tried variations of SUMPRODUCT and others that I've found, but haven't been able to get something that works for multiple values.</p>\n\n<p>Is there some function in Excel that will allow me to do this?  Or maybe a way in VBA?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7710797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e9c689311e1325e2c4b7c57139ff7e?s=128&d=identicon&r=PG&f=1", "display_name": "DHPA", "link": "https://stackoverflow.com/users/7710797/dhpa"}, "edited": false, "score": 0, "creation_date": 1555522575, "post_id": 55732592, "comment_id": 98144856, "body": "Great, I was hoping to keep this to one line.   If you have time I&#39;m not sure what you mean by  &#39;Your formula refers to cells above its location but there are no cells above A1&#39; Does this mean the way things are currently written the paste would go above A1? I thought default with past is always down the spreadsheet."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 45, "user_id": 7710797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e9c689311e1325e2c4b7c57139ff7e?s=128&d=identicon&r=PG&f=1", "display_name": "DHPA", "link": "https://stackoverflow.com/users/7710797/dhpa"}, "edited": false, "score": 0, "creation_date": 1555522839, "post_id": 55732592, "comment_id": 98144998, "body": "Your original formula was in A5 but referenced cells above it (A1:A3). When you move to another location, the relative references will be maintained, but there are no cells above A1. You can test this yourself manually on a worksheet formula."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1555520503, "last_edit_date": 1555520503, "creation_date": 1555520093, "answer_id": 55732592, "question_id": 55732434, "link": "https://stackoverflow.com/questions/55732434/how-to-transfer-sum-value-to-another-page-getting-error-sumref/55732592#55732592", "title": "How to transfer SUM value to another page (getting error =SUM(#REF!) )", "body": "<p>Your formula refers to cells above its location but there are no cells above A1, hence the error. Plus, your syntax was off.</p>\n\n<p>If you just want to transfer the value ...</p>\n\n<pre><code>Sub TransferSum()\n\n    Dim Rng As Range\n\n    Set Rng = Worksheets(\"Sheet1\").Range(\"a5\")\n\n    Rng.Copy\n    Worksheets(\"Sheet2\").Range(\"a1\").pastespecial xlvalues\n    'OR IN ONE LINE\n    Worksheets(\"Sheet2\").Range(\"a1\").value=rng.value 'or Value2\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 7710797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e9c689311e1325e2c4b7c57139ff7e?s=128&d=identicon&r=PG&f=1", "display_name": "DHPA", "link": "https://stackoverflow.com/users/7710797/dhpa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16, "favorite_count": 0, "accepted_answer_id": 55732592, "answer_count": 1, "score": 0, "last_activity_date": 1555522941, "creation_date": 1555519421, "last_edit_date": 1555522941, "question_id": 55732434, "link": "https://stackoverflow.com/questions/55732434/how-to-transfer-sum-value-to-another-page-getting-error-sumref", "title": "How to transfer SUM value to another page (getting error =SUM(#REF!) )", "body": "<p>In this instance I'm using <code>Range(\"a5\")</code> to <code>SUM</code> cells a1:a3. Once the SUM is completed I want to run the VBA and then paste the <code>SUM</code> result from  <code>sheet1</code>  onto <code>sheet2</code>  </p>\n\n<p>If a number is typed directly in <code>Range(\"a5\")</code> things work fine. </p>\n\n<p>I've been working with <code>PasteSpecial</code>, to date I have had no success with this. </p>\n\n<p>I would have thought that <code>value</code> or <code>value2</code> would have accomplished this goal, but that has not been the case so far. I have a feeling I am missing something fairly simply with this. </p>\n\n<pre><code>Sub TransferSum()\n\n    Dim Rng As Range\n\n    Set Rng = Worksheets(\"Sheet1\").Range(\"a5\")\n\n    Rng.Copy\n\n    Worksheets(\"Sheet1\").Paste Destination:=Worksheets(\"Sheet2\").Range(\"a1\")\n\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1555520227, "post_id": 55732386, "comment_id": 98143808, "body": "Where does 5674 come from? Have you tried any code?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1555520561, "post_id": 55732386, "comment_id": 98143969, "body": "Looks like you want a loop to cycle through your array plus a nested loop inside an if statement where <code>if cell &lt;&gt; cells.offset(,1) then</code> loop between from start to finish; append to the last row in the column+1.  Include <code>IsNumber()</code>.  Take a stab with that and update your post with your new info."}, {"owner": {"reputation": 13, "user_id": 11003940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/154a6906e91f10957ac95493f4d3cfa4?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/11003940/dave"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1555525712, "post_id": 55732386, "comment_id": 98146279, "body": "@SJR I just updated my post to hopefully add some clarification. I want each value between the numbers in adjacent columns."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11375154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58f3d53b6fbe3cdbfad7bb36324b91e6?s=128&d=identicon&r=PG&f=1", "display_name": "JaraExcel", "link": "https://stackoverflow.com/users/11375154/jaraexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1555521948, "creation_date": 1555521948, "answer_id": 55733042, "question_id": 55732386, "link": "https://stackoverflow.com/questions/55732386/how-to-list-every-value-between-cells-throughout-entire-columns/55733042#55733042", "title": "How to list every value between cells throughout entire columns?", "body": "<p>If you will always have these 2 columns, then you may use this code</p>\n\n<pre><code>for j = 1 to 2:for i = 1 to cells(rows.count,j).end(xlup).row\nif isnumeric(cells(i,j)) then cells(rows.count,4).end(xlup).offset(1,0) = cells(i,j)\nnext:next\n</code></pre>\n\n<p>bear in mind that it will post everysingle number, if you need to delete duplicates, you may do it using range.removeduplicate</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11003940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/154a6906e91f10957ac95493f4d3cfa4?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/11003940/dave"}, "edited": false, "score": 0, "creation_date": 1555528904, "post_id": 55734388, "comment_id": 98147643, "body": "This worked perfectly, thank you. I will be honest that I don&#39;t understand how the inner loop is working but I will try to dissect and understand. Thanks again."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 13, "user_id": 11003940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/154a6906e91f10957ac95493f4d3cfa4?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/11003940/dave"}, "edited": false, "score": 0, "creation_date": 1555529439, "post_id": 55734388, "comment_id": 98147871, "body": "My pleasure. The first area covers all the contiguous numbers in column A, i.e. A1:A2 so you then need to loop through each of them."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1555527866, "creation_date": 1555527866, "answer_id": 55734388, "question_id": 55732386, "link": "https://stackoverflow.com/questions/55732386/how-to-list-every-value-between-cells-throughout-entire-columns/55734388#55734388", "title": "How to list every value between cells throughout entire columns?", "body": "<p>Try this. You can use <code>SpecialCells</code> to pick out the numerical cells, and <code>Fill</code> to produce the intervening sequences.</p>\n\n<pre><code>Sub x()\n\nDim rA As Range, rCell As Range\n\nFor Each rA In Columns(1).SpecialCells(xlCellTypeConstants, xlNumbers).Areas\n    For Each rCell In rA\n        Range(\"D\" &amp; Rows.Count).End(xlUp)(2).Value = rCell.Value\n        Range(\"D\" &amp; Rows.Count).End(xlUp).DataSeries Rowcol:=xlColumns, Step:=1, Stop:=rCell.Offset(, 1), Trend:=False\n    Next rCell\nNext rA\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1555688264, "last_edit_date": 1555688264, "creation_date": 1555534633, "answer_id": 55735849, "question_id": 55732386, "link": "https://stackoverflow.com/questions/55732386/how-to-list-every-value-between-cells-throughout-entire-columns/55735849#55735849", "title": "How to list every value between cells throughout entire columns?", "body": "<p>Loop through the range cell by cell; test for <code>IsNumeric</code> and <code>Duplicate values</code>. Note: this is just a test code, you should always add workbook and worksheet references </p>\n\n<pre><code>For i = 1 To Cells(Rows.Count, 1).End(xlUp).Row\n\n    For j = 1 To 2\n        If IsNumeric(Cells(i, j)) And Cells(i, j).Offset(, 1).Value &lt;&gt; Cells(i, j).Value Then\n            If IsEmpty(Cells(1, 4).Value) Then\n                Cells(1, 4) = Cells(i, j)\n            Else: Cells(Rows.Count, 4).End(xlUp).Offset(1) = Cells(i, j)\n            End If\n        End If\n    Next j\nNext i\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11003940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/154a6906e91f10957ac95493f4d3cfa4?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/11003940/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 55734388, "answer_count": 3, "score": 0, "last_activity_date": 1555688264, "creation_date": 1555519177, "last_edit_date": 1555525651, "question_id": 55732386, "link": "https://stackoverflow.com/questions/55732386/how-to-list-every-value-between-cells-throughout-entire-columns", "title": "How to list every value between cells throughout entire columns?", "body": "<p>I am trying to make a loop that prints every value between two cells in a row into a single column. I would also like it to skip/ignore non integer values.</p>\n\n<p>For example: Cell A5 contains 5673 and Cell B5 contains 5677. Therefore the macro would output 5673, 5674, 5675, 5676, and 5677.</p>\n\n<p>I have found some useful examples for looping through each row and printing each value, but have not been able to combine the two.</p>\n\n<p>To print each value between the two numbers:</p>\n\n<pre><code>[D1] = [A1].Value\nato = [B1].Value\n[D1].DataSeries Rowcol:=xlColumns, Type:=xlLinear, Step:=1, Stop:=ato\n</code></pre>\n\n<p>To loop through every row:</p>\n\n<pre><code>LR = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor j = 1 To LR\n   Cells(j, 1).Offset(0, 2).Value = ***Every cell value between Cells(j, 1) and Cells(j, 2)***\nNext j\n</code></pre>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0Z0bg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0Z0bg.png\" alt=\"https://i.imgur.com/Hn4aS2h.png\"></a></p>\n\n<p>Desired after:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zbUeA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zbUeA.png\" alt=\"https://i.imgur.com/LYgmuZz.png\"></a></p>\n"}, {"tags": ["excel", "vba", "csv"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1555518449, "post_id": 55732100, "comment_id": 98142965, "body": "you have the rows locked. <code>B$1=B$2</code>. make them relative and it should work. you may want to review this link to help you writer more efficient code that will cause less problems in the future: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid select</a>"}, {"owner": {"reputation": 1, "user_id": 611729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/400dcfab7da4c05804c8201dfbf2c79a?s=128&d=identicon&r=PG", "display_name": "Nicholas Kuhlenbeck", "link": "https://stackoverflow.com/users/611729/nicholas-kuhlenbeck"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1555520888, "post_id": 55732100, "comment_id": 98144114, "body": "I took the project over to make improvements to the code. When I was working on the code improvements that is when I noticed the expected count vs the actual count. Which starts in column B row 1 and row 2. It validates those two cells and does an auto fill. But when I change field lengths in the file that I&#39;m testing the result row that puts &quot;Pass&quot; or &quot;Fail&quot; in does not actually work even unlocking the rows."}], "owner": {"reputation": 1, "user_id": 611729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/400dcfab7da4c05804c8201dfbf2c79a?s=128&d=identicon&r=PG", "display_name": "Nicholas Kuhlenbeck", "link": "https://stackoverflow.com/users/611729/nicholas-kuhlenbeck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555520549, "creation_date": 1555518035, "last_edit_date": 1555520549, "question_id": 55732100, "link": "https://stackoverflow.com/questions/55732100/is-there-a-way-to-truly-validate-two-different-cell-values-in-vba-dynamically", "title": "Is there a way to &quot;truly&quot; validate two different cell values in VBA dynamically?", "body": "<p>I'm working on a fixed width to CSV macro. The macro works as expected, the macro validates the field lengths vs the secondary file that houses the lengths to check. It is supposed to put the word \"Pass\" or \"Fail\" under the field lengths in the Excel row for each field. The problem is it only validates the first cell against the second cell and Auto Fills the rest based on the number of fields in a given file. </p>\n\n<p>It needs to be able to validate each cell value against the field length vs validating the secondary file called \"input_layout\"</p>\n\n<pre><code>Range(\"B2\").Select\nSelection.AutoFill Destination:=Range(Cells(2, 2), Cells(2, col_count)), Type:=xlFillDefault\nRange(Cells(2, 1), Cells(2, col_count)).Interior.ColorIndex = 6\nActiveSheet.Cells(3, 2).Formula = \"=IF(B$1=B$2,\"\"Pass\"\",\"\"Fail\"\")\"\nRange(\"B3\").Select\nSelection.AutoFill Destination:=Range(Cells(3, 2), Cells(3, col_count)), Type:=xlFillDefault\nRange(Cells(3, 1), Cells(3, col_count)).Interior.ColorIndex = 28\nRange(Cells(1, 1), Cells(1, col_count)).Interior.ColorIndex = 39\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1556023292, "creation_date": 1556023292, "answer_id": 55811470, "question_id": 55731991, "link": "https://stackoverflow.com/questions/55731991/macro-to-pick-excel-save-as-location-based-on-cell-value-is-giving-runtime-error/55811470#55811470", "title": "Macro to pick Excel Save As location based on cell value is giving runtime error 1004", "body": "<p>You've got two possible issues that I can see:</p>\n\n<ol>\n<li>You're getting a file name with the <code>FileDialog</code> method, but then\nusing whatever is in the cell as your <code>SaveAs</code> name, regardless of\nwhat the user just picked.</li>\n<li>You might be double-appending the file-name based on what is already in the cell.</li>\n</ol>\n\n<p>Here's a suggested fix to your code to set the cell contents of <code>\"R1\"</code> to the value the user chose before saving the file:</p>\n\n<pre><code>Public Sub SaveAsA1()\n\nWith Application.FileDialog(msoFileDialogSaveAs)\n    .InitialFileName = ActiveWorkbook.Sheets(\"Sheet1\").Range(\"R1\").Value\n    .Show\n    ActiveWorkbook.Sheets(\"Sheet1\").Range(\"R1\").Value = Trim(.SelectedItems(1))\n    ActiveWorkbook.SaveAs Filename:=ActiveWorkbook.Sheets(\"Sheet1\").Range(\"R1\").Value, FileFormat:=52\nEnd With\n\nMsgBox \"File Saved!\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11374926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eedb2ecb29820d6f8578f0fc8676943?s=128&d=identicon&r=PG&f=1", "display_name": "AndreyZ", "link": "https://stackoverflow.com/users/11374926/andreyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556036496, "creation_date": 1555517679, "last_edit_date": 1556036496, "question_id": 55731991, "link": "https://stackoverflow.com/questions/55731991/macro-to-pick-excel-save-as-location-based-on-cell-value-is-giving-runtime-error", "title": "Macro to pick Excel Save As location based on cell value is giving runtime error 1004", "body": "<p>Here is my code</p>\n\n<pre><code>Public Sub SaveAsA1()\n\nWith Application.FileDialog(msoFileDialogSaveAs)\n.InitialFileName = ActiveWorkbook.Sheets(\"Sheet1\").Range(\"R1\").Value\n.Show\nActiveWorkbook.SaveAs filename:=Range(\"R1\") &amp; \".xlsm\", FileFormat:=52\n\nEnd With\n MsgBox \"File Saved!\"\nEnd Sub\n</code></pre>\n\n<p>but when I choose a location it does not over-write the cell value and it give a runtime error #1004.</p>\n\n<p>Please can anybody help?</p>\n"}, {"tags": ["excel", "vba", "parallel-processing", "sap", "execute"], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1555517988, "creation_date": 1555517988, "answer_id": 55732084, "question_id": 55731409, "link": "https://stackoverflow.com/questions/55731409/how-can-i-execute-3-lines-at-the-same-time-or-move-on-to-the-next-one-without-wa/55732084#55732084", "title": "How can I execute 3 lines at the same time or move on to the next one without waiting for the previous one to finish?", "body": "<p>You can't do this in VBA as it runs on a single thread. Every command is executed sequentially and has to wait for the previous one to finish.</p>\n\n<p>You could write a macro to create three separate VBScripts and then run those three scripts simultaneously in order to \"mimic\" three threads.</p>\n"}], "owner": {"reputation": 1, "user_id": 11374750, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SO8lToNbMjY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfQzQnN1k5OqsMQ5KPRudIcEI6Yuw/mo/photo.jpg?sz=128", "display_name": "Victor Manuel Cortez", "link": "https://stackoverflow.com/users/11374750/victor-manuel-cortez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1555517988, "creation_date": 1555515737, "last_edit_date": 1555517095, "question_id": 55731409, "link": "https://stackoverflow.com/questions/55731409/how-can-i-execute-3-lines-at-the-same-time-or-move-on-to-the-next-one-without-wa", "title": "How can I execute 3 lines at the same time or move on to the next one without waiting for the previous one to finish?", "body": "<p>I have this code that connects to SAP. These three lines are connected to the buttons to run in 3 different windows of SAP. But each window takes about 15 minutes to load. I need the three buttons to run at the same time or not to wait for the previous one to finish so that the 3 windows can be executed at the same time and instead of taking 45 minutes, it takes 15 minutes.</p>\n\n<p>Now try putting the three commands on the same line separating them by \",\" \"&amp;\" \";\" \":\"\nAlso try to call the 3 macros at the same time</p>\n\n<p>Button 1 of windows 1</p>\n\n<pre><code>session1.findById(\"wnd[0]\").sendVKey 8\n</code></pre>\n\n<p>Button 2 of windows 2</p>\n\n<pre><code>session2.findById(\"wnd[0]\").sendVKey 8\n</code></pre>\n\n<p>Button 3 of windows 3</p>\n\n<pre><code>session3.findById(\"wnd[0]\").sendVKey 8\n</code></pre>\n\n<p>First try of execute three lines at same time, but do not execute the code</p>\n\n<pre><code>session1.findById(\"wnd[0]\").sendVKey 8, session2.findById(\"wnd[0]\").sendVKey 8, session3.findById(\"wnd[0]\").sendVKey 8\n</code></pre>\n"}, {"tags": ["arrays", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1555515315, "post_id": 55731176, "comment_id": 98141276, "body": "What is <code>Record</code>?"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 1, "creation_date": 1555515647, "post_id": 55731176, "comment_id": 98141475, "body": "If Instr(LTrim$(Record,&quot;M&quot;))=1 then. Also the default seperator for split is a space. If record is comma seperated values you&#39;&#39;l need to specify this in the split statement."}, {"owner": {"reputation": 43, "user_id": 9531529, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jeremy Wik", "link": "https://stackoverflow.com/users/9531529/jeremy-wik"}, "edited": false, "score": 0, "creation_date": 1555515668, "post_id": 55731176, "comment_id": 98141488, "body": "Record is a line in the file"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1555515689, "post_id": 55731176, "comment_id": 98141501, "body": "Upon which line do you get a <code>Subscript out of range</code> error? Also it seems like you should increment <code>iRow</code> inside your <code>If</code> not inside your <code>else</code> but maybe I&#39;m just misunderstanding."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1555515994, "post_id": 55731176, "comment_id": 98141679, "body": "I realise that, what&#39;s its value?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1555519414, "post_id": 55731176, "comment_id": 98143402, "body": "Put a breakpoint (F9) on <code>If P(0) = ...</code>, run the code, and when the breakpoint is hit bring up the <i>Locals</i> toolwindow (from the <i>View</i> menu) and in there you will be able to see the current value of <code>Record</code> and each element of <code>P</code>; hit F8 to step through, shift+F8 to step over, and F5 to resume."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1555520874, "creation_date": 1555520874, "answer_id": 55732780, "question_id": 55731176, "link": "https://stackoverflow.com/questions/55731176/comparing-first-element-of-array/55732780#55732780", "title": "Comparing First Element of Array", "body": "<p>A few changes:</p>\n\n<pre><code>Open Fname For Input As #1\niRow = 1\n\nDo While Not EOF(1)\n    Line Input #1, Record\n    If Record Like \"MONITORED*\" Then\n        p = Split(Record, \",\")\n        Cells(iRow, 1).Resize(1, UBound(p) + 1) = p\n        iRow = iRow + 1\n    End If\nLoop\nClose 1\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 9531529, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jeremy Wik", "link": "https://stackoverflow.com/users/9531529/jeremy-wik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1555520874, "creation_date": 1555514924, "last_edit_date": 1555516061, "question_id": 55731176, "link": "https://stackoverflow.com/questions/55731176/comparing-first-element-of-array", "title": "Comparing First Element of Array", "body": "<p>I am reading in a csv file line by line and splitting them using the Split() function. This portion works fine, however, I am only really searching for lines that begin with \"MONITORED\". When I try to compare the first element of the array, I get a subscript out of range error.</p>\n\n<pre><code>Open Fname For Input As #1\n  iRow = 1\n  Line Input #1, Record\n  Do Until EOF(1)\n     P = Split(Record)\n\n    If P(0) = \"MONITORED\" Then\n        For i = LBound(P) To UBound(P)\n            Cells(iRow, i + 1) = P(i)\n        Next i\n     Else\n        iRow = iRow - 1\n     End If\n\n     iRow = iRow + 1\n     Line Input #1, Record\n  Loop\n  Close 1\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1555514943, "post_id": 55730875, "comment_id": 98141080, "body": "<i>I have read that the userform cannot be unloaded</i> - huh? UserForm default instances are pretty much the only thing <code>Unload</code> can work with. If you can read from the textbox by accessing <code>UserForm1.baseflowtextbox.Value</code> on the right-hand side of an assignment expression, have you tried putting <code>UserForm1.baseflowtextbox.Value</code> on the left-hand side of an assignment?"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1555514988, "post_id": 55730875, "comment_id": 98141100, "body": "I&#39;m not sure from your question if the issue is that the textbox still contains the value, or if the issue is that the worksheet isn&#39;t getting it...."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1555515255, "post_id": 55730875, "comment_id": 98141251, "body": "<i>when i open the userform back up the values that i have inputted remain.</i> - is that expected? You&#39;re working off the form&#39;s default instance, so its state is essentially global, and if you aren&#39;t unloading the form then its state is preserved between <code>Show</code> member calls (unless the form is destroyed when the user clicks the X button in the form&#39;s control box).. In any case, I&#39;d recommend reading <a href=\"https://stackoverflow.com/q/10714251/1188513\">this post about <code>Select</code> &amp; <code>Activate</code></a>."}, {"owner": {"reputation": 1, "user_id": 11365105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7b8297f780cd8da02c5a2ceb13ad332?s=128&d=identicon&r=PG&f=1", "display_name": "dingle ben", "link": "https://stackoverflow.com/users/11365105/dingle-ben"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1555515381, "post_id": 55730875, "comment_id": 98141308, "body": "@mathieu Im sure i tried that yesterday however, when i tried it again it worked! haha. Thanks for your time its appreciated. In reference to your first comment."}], "owner": {"reputation": 1, "user_id": 11365105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7b8297f780cd8da02c5a2ceb13ad332?s=128&d=identicon&r=PG&f=1", "display_name": "dingle ben", "link": "https://stackoverflow.com/users/11365105/dingle-ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555513926, "creation_date": 1555513926, "question_id": 55730875, "link": "https://stackoverflow.com/questions/55730875/is-it-possible-to-paste-a-value-from-a-userform-textbox-to-a-cell-from-a-button", "title": "Is it possible to paste a value from a userform textbox to a cell from a button outside the userform?", "body": "<p>I have got a userform which provides data for a macro. Once this macro is complete i would like to paste the values which were inputted in the userform to cells, with the use of a button. I have read that the userform cannot be unloaded which i dont think mine is as to close the userform i use the code: </p>\n\n<pre><code>userform1.hide\nuserform2.show\n</code></pre>\n\n<p>and then to close userform two i use the code:</p>\n\n<pre><code>userform2.hide\n</code></pre>\n\n<p>Also, when i open the userform back up the values that i have inputted remain.</p>\n\n<p>The code i am using to try and print values from the text box is:</p>\n\n<pre><code>Sub copypaste2()\n\n'code to copy and paste a graph and some text, using the macro recorder\n ActiveSheet.ChartObjects(\"Chart 1\").Activate\nActiveSheet.ChartObjects(\"Chart 1\").Activate\nActiveChart.ChartArea.Copy\nSheets(\"Sheet1\").Select\nActiveSheet.Pictures.Paste.Select\nSheets(\"sheet2\").Select\nRange(\"B7:G9\").Select\nSelection.Copy\nSheets(\"Sheet1\").Select\nRange(\"M5\").Select\nActiveSheet.Paste\nRange(\"K6\").Select\n\n'code to paste value from userform textbox to cell\nWorksheets(\"sheet1\").Range(\"M8\").Value = UserForm1.baseflowtextbox.Value\n\nend sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10648362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed5814ab784ca1bc41ca63ea642666b?s=128&d=identicon&r=PG&f=1", "display_name": "Wonderboff", "link": "https://stackoverflow.com/users/10648362/wonderboff"}, "edited": false, "score": 0, "creation_date": 1555526726, "post_id": 55731940, "comment_id": 98146708, "body": "Very fast response. This didn&#39;t work. There is a window that pops up and immediately goes away &amp; the data doesn&#39;t get written to the excel sheet."}, {"owner": {"reputation": 1, "user_id": 10648362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed5814ab784ca1bc41ca63ea642666b?s=128&d=identicon&r=PG&f=1", "display_name": "Wonderboff", "link": "https://stackoverflow.com/users/10648362/wonderboff"}, "edited": false, "score": 0, "creation_date": 1555526963, "post_id": 55731940, "comment_id": 98146802, "body": "I will post the whole script today, this might give more of an insight."}, {"owner": {"reputation": 1, "user_id": 10648362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed5814ab784ca1bc41ca63ea642666b?s=128&d=identicon&r=PG&f=1", "display_name": "Wonderboff", "link": "https://stackoverflow.com/users/10648362/wonderboff"}, "edited": false, "score": 0, "creation_date": 1555929444, "post_id": 55731940, "comment_id": 98255080, "body": "Ok sorry for the confusion. I&#39;m no expert on scripting by any means. So if I was working with an already opened excel sheet, I do not need to create an object. Could I leave this out &amp; change open to Set objXLWb = objXLApp.Workbooks(&quot;File.xlsm&quot;)  &amp; try the script?"}, {"owner": {"reputation": 341, "user_id": 8826022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb38589eec35643089af93724c1d9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Murphy", "link": "https://stackoverflow.com/users/8826022/michael-murphy"}, "reply_to_user": {"reputation": 1, "user_id": 10648362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed5814ab784ca1bc41ca63ea642666b?s=128&d=identicon&r=PG&f=1", "display_name": "Wonderboff", "link": "https://stackoverflow.com/users/10648362/wonderboff"}, "edited": false, "score": 0, "creation_date": 1555937263, "post_id": 55731940, "comment_id": 98258153, "body": "I don&#39;t have any experience with PLC Applications. In Excel VBA, as long as the workbook is already open in the same application-instance, <code>Set objXLWb = Workbooks(&quot;File.xlsm&quot;)</code> will get you a variable representing the workbook. Your <code>objXLApp</code> is referencing a brand-new instance of Excel though (since you use <code>CreateObject</code>), so it won&#39;t have your workbook in its <code>Workbooks</code> collection."}], "tags": [], "owner": {"reputation": 341, "user_id": 8826022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb38589eec35643089af93724c1d9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Murphy", "link": "https://stackoverflow.com/users/8826022/michael-murphy"}, "is_accepted": false, "score": 0, "last_activity_date": 1555534587, "last_edit_date": 1555534587, "creation_date": 1555517500, "answer_id": 55731940, "question_id": 55730824, "link": "https://stackoverflow.com/questions/55730824/read-live-values-from-one-excel-workbook-to-another-workbook-while-opened/55731940#55731940", "title": "Read live Values from one Excel Workbook to another Workbook while opened", "body": "<p>If the workbook is already open you can just refer to it by name as part of the <code>Workbooks</code> collection.\n<code>Set objXLWb = objXLApp.Workbooks(\"File.xlsm\")</code></p>\n\n<p>Edit: Since you have changed your question I'm no longer certain what you're asking. My guess is that your 'already open' workbook isn't open in the same Excel instance you're creating with <code>Set objXLApp = CreateObject(\"Excel.Application\")</code>, so you'll need a reference to the <em>existing</em> Excel application, then the open workbook within that application.</p>\n"}], "owner": {"reputation": 1, "user_id": 10648362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed5814ab784ca1bc41ca63ea642666b?s=128&d=identicon&r=PG&f=1", "display_name": "Wonderboff", "link": "https://stackoverflow.com/users/10648362/wonderboff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1555534587, "creation_date": 1555513759, "last_edit_date": 1555527245, "question_id": 55730824, "link": "https://stackoverflow.com/questions/55730824/read-live-values-from-one-excel-workbook-to-another-workbook-while-opened", "title": "Read live Values from one Excel Workbook to another Workbook while opened", "body": "<p>I would like to be able to read and write values using VBA from one OPEN Excel workbook to another application without using the \"as worksheet\" function due to this being a non-windows application. Is this possible?</p>\n\n<p>The code I've posted is from a PLC application using scripting. </p>\n\n<p>I just need to know what function to use besides <code>.open</code> since the file is already opened.</p>\n\n<pre><code>Dim objXLApp, objXLWb, objXLWs1, objXLWs2, objXLWs5\n\nSet objXLApp = CreateObject(\"Excel.Application\")\n\nobjXLApp.Visible = True\n\nSet objXLWb = objXLApp.Workbooks.Open(\"File.xlsm\")\n'~~&gt; Working with Sheet1\nSet objXLWs1 = objXLWb.Sheets(1)\nSet objXLWs2 = objXLWb.Sheets(2)\nSet objXLWs5 = objXLWb.Sheets(5)\n\n'~~&gt;Write SetPoints to Sheet1\nWith objXLWs1\n\n '~~&gt;Write \n\n .Cells(6,23).value = SmartTags(\"Job Time Sec to OEE\")\n .Cells(6,23).value = SmartTags(\"Run Time Sec to OEE\")\n\n\nEnd With\n\n''~~&gt;Write Setup Values to Sheet2\n\n'~~&gt; Save as Excel File (xls) to retain format\nobjXLWb.Save\n\nobjXLWb.Close (False)\n\nSet objXLWs1 = Nothing\nSet objXLWs2 = Nothing\nSet objXLWs5 = Nothing\nSet objXLWb = Nothing\n\nobjXLApp.Quit\nSet objXLApp = Nothing\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 167, "user_id": 9630197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d5cd6a208cf541aea4da0c87ac2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "SB999", "link": "https://stackoverflow.com/users/9630197/sb999"}, "is_accepted": true, "score": 0, "last_activity_date": 1555513639, "creation_date": 1555513639, "answer_id": 55730780, "question_id": 55730641, "link": "https://stackoverflow.com/questions/55730641/range-to-html-removing-part-of-the-string/55730780#55730780", "title": "Range To HTML removing part of the string", "body": "<p>All, this is a duplicate question the answer I was looking for can be found here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/15201709/how-to-keep-formats-when-i-copy-a-range-from-excel-to-outlook\">How to keep formats when I copy a range from Excel to outlook</a></p>\n\n<p>Specific Code: </p>\n\n<pre><code>   TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    '.Cells(1).PasteSpecial xlPasteValues, , False, False\n    '.Cells(1).PasteSpecial xlPasteFormats, , False, False\n    .Cells(1).PasteSpecial xlPasteAllUsingSourceTheme, , False, False\n    .Cells(1).Select\n    Application.CutCopyMode = False\n    On Error Resume Next\n    .DrawingObjects.Visible = True\n    .DrawingObjects.Delete\n    On Error GoTo 0\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 9630197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d5cd6a208cf541aea4da0c87ac2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "SB999", "link": "https://stackoverflow.com/users/9630197/sb999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1555519481, "accepted_answer_id": 55730780, "answer_count": 1, "score": 0, "last_activity_date": 1555519460, "creation_date": 1555513223, "last_edit_date": 1555519460, "question_id": 55730641, "link": "https://stackoverflow.com/questions/55730641/range-to-html-removing-part-of-the-string", "closed_reason": "Duplicate", "title": "Range To HTML removing part of the string", "body": "<p>All, </p>\n\n<p>I have been using the below code to generate an email which compiles a range into an HTML body of an email. </p>\n\n<pre><code>Sub Mail_Selection_Range_Outlook_Body()\n\nDim rng As Range\nDim OutApp As Object\nDim OutMail As Object\nDim lastrow As Long\nDim sht As Worksheet\nDim StrBody As String\nSet rng = Nothing\n\nSheets(\"HTML Loop\").Activate 'Change\nSet sht = ActiveSheet\nlastrow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\nRange\n\nOn Error Resume Next\nSet rng = sht.Range(\"A1:A\" &amp; lastrow).SpecialCells(xlCellTypeVisible)\nOn Error GoTo 0\n\nIf sht.Range(\"A1\").Value = \"\" Then\n    Exit Sub\nEnd If\n\nStrBody = \"All,\" &amp; \"&lt;br&gt;\" &amp; \"&lt;br&gt;\" &amp; _\n          \"The Robot has completed its daily check of the FX3 Site and has created \" &amp; lastrow &amp; \" new folder location(s).\" &amp; \"&lt;br&gt;\" &amp; \"&lt;br&gt;\" &amp; _\n          \"*Please review the files located here:\"\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nOn Error Resume Next\nWith OutMail\n    .To = \"Sean.B@xxx.co.uk\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"Daily FX3 Notification Email \" &amp; Now()\n    .HTMLBody = StrBody &amp; RangetoHTML(rng) &amp; \"&lt;br&gt;\" &amp; \"&lt;br&gt;\" &amp; \"&lt;br&gt;\" &amp; \"Thanks\" &amp; \"&lt;br&gt;\" &amp; \"&lt;br&gt;\" &amp; \"Gary\"\n    .Display\n    .Send   'or use .Display\nEnd With\nOn Error GoTo 0\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\n\nSet OutMail = Nothing\nSet OutA\n\n End sub\n\n Function RangetoHTML(rng As Range)\n  Dim fso As Object\n  Dim ts As Object\n  Dim TempFile As String\n  Dim TempWB As Workbook\n\n TempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n'Copy the range and create a new workbook to past the data in\nrng.Copy\nSet TempWB = Workbooks.Add(1)\nWith TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    .Cells(1).PasteSpecial xlPasteValues, , False, False\n    .Cells(1).PasteSpecial xlPasteFormats, , False, False\n    .Cells(1).Select\n    Application.CutCopyMode = False\n    On Error Resume Next\n    .DrawingObjects.Visible = True\n    .DrawingObjects.Delete\n    On Error GoTo 0\nEnd With\n\n'Publish the sheet to a htm file\nWith TempWB.PublishObjects.Add( _\n     SourceType:=xlSourceRange, _\n     Filename:=TempFile, _\n     Sheet:=TempWB.Sheets(1).Name, _\n     Source:=TempWB.Sheets(1).UsedRange.Address, _\n     HtmlType:=xlHtmlStatic)\n    .Publish (True)\nEnd With\n\n'Read all data from the htm file into RangetoHTML\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\nRangetoHTML = ts.readall\nts.Close\nRangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                      \"align=left x:publishsource=\")\n\n'Close TempWB\nTempWB.Close savechanges:=False\n\n'Delete the htm file we used in this function\nKill TempFile\n\nSet ts = Nothing\nSet fso = Nothing\nSet TempWB = Nothing\nEnd Function\n</code></pre>\n\n<p>The issue I am having is when the email is generated, the strings within the range is cut at 9 Characters long. </p>\n\n<p>The range consists of file paths like the below:</p>\n\n<p>\\csdatg09\\financial systems\\Automation\\Pega Projects\\Tax\\FIN_TAX_GARY\\Bristol\\TEST TEST 108 EastCott Hill</p>\n\n<p>\\csdatg09\\financial systems\\Automation\\Pega Projects\\Tax\\FIN_TAX_GARY\\Exeter\\TEST TEST 108 EastCott Hill</p>\n\n<p>I would like to understand why the output is like the screenshot attached. </p>\n\n<p><a href=\"https://i.stack.imgur.com/zVzpV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zVzpV.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1555517705, "last_edit_date": 1555517705, "creation_date": 1555516348, "answer_id": 55731587, "question_id": 55730455, "link": "https://stackoverflow.com/questions/55730455/activex-combobox-dynamic-range-for-listfillrange/55731587#55731587", "title": "ActiveX ComboBox dynamic range for ListFillRange", "body": "<p>There are a few ways to do this. You can loop all rows, find the values higher than 3200, copy them to a Hidden sheet, when done with the loop, get the Range from this Hidden Sheet and Assign it to the ListFillRange. Example:</p>\n\n<pre><code>Function updateCombo1()\n    Dim lastRow As Long, i As Long, x As Long, wk As Workbook\n    Set wk = ThisWorkbook\n    With wk.Sheets(\"Sheet1\")\n        lastRow = .Cells(Rows.Count, 1).End(xlUp).Row\n        wk.Sheets(\"HiddenSheet\").Cells.ClearContents\n        For i = 1 To lastRow\n            If .Cells(i, 3).Value &gt;= .Range(\"G10\").Value Then\n                x = x + 1\n                wk.Sheets(\"HiddenSheet\").Cells(x, 1).Value = .Cells(i, 2).Value\n            End If\n        Next i\n        lastRow = wk.Sheets(\"HiddenSheet\").Cells(Rows.Count, 1).End(xlUp).Row\n        'If Form DropDown, Set Range\n        .DropDowns(\"Drop Down 2\").ListFillRange = \"HiddenSheet!A1:A\" &amp; lastRow\n        'If ActiveX DropDown, Set Range\n        .ComboBox11.ListFillRange = \"HiddenSheet!A1:A\" &amp; lastRow\n    End With\nEnd Function\n</code></pre>\n\n<p>You can also loop all rows and add one by one on the drop down. Example:</p>\n\n<pre><code>Function updateCombo2()\n    Dim lastRow As Long, i As Long, wk As Workbook\n    Set wk = ThisWorkbook\n    With wk.Sheets(\"Sheet1\")\n        lastRow = .Cells(Rows.Count, 1).End(xlUp).Row\n        'If Form Drop Down, Clear All Items\n        .DropDowns(\"Drop Down 2\").RemoveAllItems\n        'If ActiveX Drop Down, Clear All Items\n        .ComboBox11.Clear\n        For i = 1 To lastRow\n            If .Cells(i, 3).Value &gt;= .Range(\"Q10\").Value Then\n                'If Form DropDown, Add Item\n                .DropDowns(\"Drop Down 2\").AddItem .Cells(i, 2).Value\n                'If ActiveX DropDown, Add Item\n                .ComboBox11.AddItem .Cells(i, 2).Value\n            End If\n        Next i\n    End With\nEnd Function\n</code></pre>\n\n<p>Just call the Function on Worksheet_Change</p>\n\n<p>Edit: It is much simpler to work with an ActiveX Drop Down, but for compatibility I would try to use the Form Drop Down instead.</p>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "accepted_answer_id": 55731587, "answer_count": 1, "score": 0, "last_activity_date": 1555521027, "creation_date": 1555512681, "last_edit_date": 1555521027, "question_id": 55730455, "link": "https://stackoverflow.com/questions/55730455/activex-combobox-dynamic-range-for-listfillrange", "title": "ActiveX ComboBox dynamic range for ListFillRange", "body": "<p>I have <code>ThisWorkbook.Sheets(\"MAIN\")</code> and ActiveX <code>ComboBox11</code> on it. I also have table: </p>\n\n<pre><code>         A                    B \n1      John 1               10000\n2      John 2               20000\n3      John 3               20000\n4      John 4               10000\n5      John 5               50000\n6      John 6               50000\n7      John 7               50000\n8      John 8               10000\n9      John 9               20000\n10     John 10              50000\n</code></pre>\n\n<p>Then in cell Q10 I have value, let's say 32000</p>\n\n<p>I would like to display column A range dynamically in ActiveX <code>ComboBox11</code> with condition:</p>\n\n<pre><code>=IF(B1&lt;Q10;\"not in list\";A1))\n</code></pre>\n\n<p>so that I would not have values less than 32000 in ActiveX <code>ComboBox11</code> drop down. </p>\n\n<p>In this case ActiveX <code>ComboBox11</code> would look like:</p>\n\n<pre><code>John 5\nJohn 6\nJohn 7\nJohn 10\n</code></pre>\n\n<p>It is easy to have named range in ListFillRange. However I would like to have a dynamic range. Any ideas how to achieve that? </p>\n\n<p>I need to use filter somehow?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n   'If Target.Address = Range(\"Q10\").Address Then\n       'Range(\"A1:B10\").CurrentRegion.AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:=Range(\"B1:B10\")\n   'End If\n\nEnd Sub\n</code></pre>\n\n<p>And after that use filtered range in ActiveX <code>ComboBox11</code> ListFillRange?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "edited": false, "score": 0, "creation_date": 1555535529, "post_id": 55730448, "comment_id": 98150165, "body": "Can you share an example file?"}, {"owner": {"reputation": 958, "user_id": 5958359, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5f4e6659350e20a27d19b0fb4e110bc9?s=128&d=identicon&r=PG", "display_name": "mibm", "link": "https://stackoverflow.com/users/5958359/mibm"}, "reply_to_user": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "edited": false, "score": 0, "creation_date": 1555587377, "post_id": 55730448, "comment_id": 98167099, "body": "I cannot see an option to add a file. I added an example snippet to the question."}], "owner": {"reputation": 958, "user_id": 5958359, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5f4e6659350e20a27d19b0fb4e110bc9?s=128&d=identicon&r=PG", "display_name": "mibm", "link": "https://stackoverflow.com/users/5958359/mibm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556022962, "creation_date": 1555512656, "last_edit_date": 1556022962, "question_id": 55730448, "link": "https://stackoverflow.com/questions/55730448/multiple-excel-tabs-worksheets-to-charts-dynamically", "title": "Multiple Excel tabs/worksheets to charts (dynamically)", "body": "<p>I have an Excel file in the following format:</p>\n\n<ul>\n<li>Each tab/sheet contains data from a specific date (the sheet name)</li>\n<li>Column A contains various items\n\n<ul>\n<li>For each item I would like to create a line graph</li>\n<li>Not all sheets contain all items</li>\n<li>Items are not necessarily in the same order</li>\n</ul></li>\n<li>Column C contains the value (a float)</li>\n<li>Column B is the units of C (never saw this change)</li>\n<li>Columns D and E contain upper/lower expected range for C (range occasionally changes)</li>\n</ul>\n\n<p>I would like to have a sheet with charts for all values, updated dynamically whenever a new data sheet is added.</p>\n\n<p>Bonus if I could set a few items as \"pinned\" while the rest I could choose from a drop-down. Would also be nice to be able to display range lines.</p>\n\n<p>I am able to create a pivot table and chart from multiple sheets (Alt+D, P) but that doesn't contain the date (sheet name). I also seem unable control the axis too much (but my Excel knowledge is poor at best).</p>\n\n<p>I assume I would need some VBA function for that. Any pointers?</p>\n\n<p><strong>EDIT (example)</strong></p>\n\n<p>Below is a tiny example of how the data looks like. Hope it helps.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Yq4vZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Yq4vZ.png\" alt=\"A tiny example of how the data looks like\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11374399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/539d738d4f23dfb4ff09d7dfd379d0ee?s=128&d=identicon&r=PG&f=1", "display_name": "elisar", "link": "https://stackoverflow.com/users/11374399/elisar"}, "edited": false, "score": 0, "creation_date": 1555516409, "post_id": 55730625, "comment_id": 98141903, "body": "Hi Luis, thank you for your help. Unfortunately this didn&#39;t work\u2014that or I didn&#39;t apply it correclty."}], "tags": [], "owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "is_accepted": false, "score": 0, "last_activity_date": 1555513175, "creation_date": 1555513175, "answer_id": 55730625, "question_id": 55730431, "link": "https://stackoverflow.com/questions/55730431/how-to-prevent-a-macro-from-executing-in-hidden-cells/55730625#55730625", "title": "How to prevent a macro from executing in hidden cells?", "body": "<p>u can try</p>\n\n<pre><code>For Each cells In Selection.SpecialCells(xlCellTypeVisible)\n   Cells.Replace What:=\"\u2013\", Replacement:=\"&amp;ndash;\", LookAt:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=True, SearchFormat:=False, _\n    ReplaceFormat:=False\nNext cells\n</code></pre>\n\n<p>it checks each cell if visible or not. it could take some time to run...</p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 11374399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/539d738d4f23dfb4ff09d7dfd379d0ee?s=128&d=identicon&r=PG&f=1", "display_name": "elisar", "link": "https://stackoverflow.com/users/11374399/elisar"}, "edited": false, "score": 0, "creation_date": 1555516349, "post_id": 55730784, "comment_id": 98141868, "body": "This worked perfectly! Thank you very much. That will definitely be useful in many occasions!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1555513648, "creation_date": 1555513648, "answer_id": 55730784, "question_id": 55730431, "link": "https://stackoverflow.com/questions/55730431/how-to-prevent-a-macro-from-executing-in-hidden-cells/55730784#55730784", "title": "How to prevent a macro from executing in hidden cells?", "body": "<p>A cell is hidden if its column or row is hidden:</p>\n\n<pre><code>Sub hgfds()\n    Dim cell As Range\n    For Each cell In ActiveSheet.UsedRange\n        If cell.EntireRow.Hidden = False And cell.EntireColumn.Hidden = False Then\n            cell.Replace what:=\"-\", replacement:=\"&amp;ndash\"\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11374399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/539d738d4f23dfb4ff09d7dfd379d0ee?s=128&d=identicon&r=PG&f=1", "display_name": "elisar", "link": "https://stackoverflow.com/users/11374399/elisar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 1, "accepted_answer_id": 55730784, "answer_count": 2, "score": 0, "last_activity_date": 1555514585, "creation_date": 1555512593, "last_edit_date": 1555514585, "question_id": 55730431, "link": "https://stackoverflow.com/questions/55730431/how-to-prevent-a-macro-from-executing-in-hidden-cells", "title": "How to prevent a macro from executing in hidden cells?", "body": "<p>I am creating a macro to replace special characters with HTML entities, and I would like this macro to apply only to unhidden cells.</p>\n\n<p>I have tried the <code>Hidden</code> property, but I am just too new to VBA and don't know how to use it for this.</p>\n\n<p>So far my code is:</p>\n\n<pre><code>Sub replaceTextWithHTML()\n\nCells.Replace What:=\"\u2013\", Replacement:=\"&amp;ndash;\", LookAt:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=True, SearchFormat:=False, _\n    ReplaceFormat:=False\n\n[other similar replacements]\n\nEnd Sub\n</code></pre>\n\n<p>When run in a workbook which contains hidden rows, columns or sheets, the macro modifies their contents, too. I would like the macro to only edit visible contents.</p>\n"}, {"tags": ["vba", "match", "vlookup", "offset"], "comments": [{"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1555512736, "post_id": 55730394, "comment_id": 98139642, "body": "hi. whats Call Send_Email(myvalue) ? shouldnt be Call Send_Email(myVLookupResult) ?"}, {"owner": {"reputation": 1, "user_id": 11374452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ae14c62dfa3057729bcd5809193769f?s=128&d=identicon&r=PG&f=1", "display_name": "ckp0019", "link": "https://stackoverflow.com/users/11374452/ckp0019"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1555606710, "post_id": 55730394, "comment_id": 98177957, "body": "I tried call send email (mylookupresult) and it produces the same result"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1559650236, "creation_date": 1559650236, "answer_id": 56443621, "question_id": 55730394, "link": "https://stackoverflow.com/questions/55730394/send-email-using-vlookup-to-match-email-address/56443621#56443621", "title": "Send email using Vlookup to match email address", "body": "<p>You have this:</p>\n\n<pre><code>nameList = Join(Application.WorksheetFunction.Transpose(Sheets(\"EVC_Contact_List\").Range(\"D2:D29\")))\n</code></pre>\n\n<p>Should that not be the Vlookup function?</p>\n"}], "owner": {"reputation": 1, "user_id": 11374452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ae14c62dfa3057729bcd5809193769f?s=128&d=identicon&r=PG&f=1", "display_name": "ckp0019", "link": "https://stackoverflow.com/users/11374452/ckp0019"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1607686921, "creation_date": 1555512500, "last_edit_date": 1607686921, "question_id": 55730394, "link": "https://stackoverflow.com/questions/55730394/send-email-using-vlookup-to-match-email-address", "title": "Send email using Vlookup to match email address", "body": "<p>I am trying to Vlookup a cell to return a match in a contact list.</p>\n<p>When it finds that match it should send an email to the person associated with that location.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub vLookupAnotherWorksheet()\n    Dim myLookupValue As String\n    Dim myFirstColumn As Long\n    Dim myLastColumn As Long\n    Dim myColumnIndex As Long\n    Dim myFirstRow As Long\n    Dim myLastRow As Long\n    Dim myVLookupResult As Long\n    Dim myTableArray As Range\n    \n    myLookupValue = &quot;H3:H13&quot;\n    myFirstColumn = 1\n    myLastColumn = 8\n    myColumnIndex = 8\n    myFirstRow = 3\n    myLastRow = 13\n    \n    With Worksheets(&quot;EVC_Contact_List&quot;)\n        Set myTableArray = .Range(.Cells(myFirstRow, myFirstColumn), .Cells(myLastRow, myLastColumn))\n    End With\n    \n    On Error Resume Next\n    myVLookupResult = WorksheetFunction.VLookup(myLookupValue, myTableArray, myColumnIndex, False)\n    \n    If IsError(myVLookupResult) = False Then\n        Call Send_Email(myvalue)\n    End If\n    \nEnd Sub\n    \nSub Send_Email(myvalue As Variant)\n        \n    Dim Email_Subject As String, Email_Send_From  As String, Email_Body As String, i As Integer\n    Dim Mail_Object As Object, nameList As String, namelist2 As String, o As Variant\n    \n    Email_Send_From = &quot;&quot;\n        \n    If Sheets(&quot;EVC_Contact_List&quot;).Cells(2, 4).Value &lt;&gt; &quot;&quot; Then\n        nameList = Join(Application.WorksheetFunction.Transpose(Sheets(&quot;EVC_Contact_List&quot;).Range(&quot;D2:D29&quot;)))\n        namelist2 = Join(Application.WorksheetFunction.Transpose(Sheets(&quot;EVC_Contact_List&quot;).Range(&quot;F2:F29&quot;)))\n    End If\n  \n    Set Mail_Object = CreateObject(&quot;Outlook.Application&quot;)\n    With Mail_Object.CreateItem(o)\n        .Subject = &quot;Unit(s) Excceding Days as Loaner&quot;\n        .To = nameList\n        .Cc = namelist2\n        .display\n    End With\n    Application.DisplayAlerts = False\n    \nEnd Sub\n</code></pre>\n<p>If location XXXX is found on the contact list and Johnsmith@gmail.com is associated with that location it should send an email only to John Smith.</p>\n<p>My code is sending an email to everyone on the contact list.</p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 1, "creation_date": 1555512336, "post_id": 55730277, "comment_id": 98139383, "body": "In your second IF-STATEMENT, <code>Cells(i,1)</code> isn&#39;t fully qualified; which means that the code is using an implicit <code>ActiveSheet</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1555512429, "post_id": 55730277, "comment_id": 98139440, "body": "See here - <a href=\"https://stackoverflow.com/questions/28439376/what-is-the-default-scope-of-worksheets-and-cells-and-range/28439984#28439984\" title=\"what is the default scope of worksheets and cells and range\">stackoverflow.com/questions/28439376/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1555512688, "post_id": 55730277, "comment_id": 98139611, "body": "@TimWilliams wow, how the heck was that closed as &quot;opinion-based&quot;?! voted to reopen..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1555513081, "post_id": 55730277, "comment_id": 98139865, "body": "@MathieuGuindon - I had no idea it was closed.  The reason for closing seems odd though - there&#39;s only one way to answer (and thanks for the edit)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1555513680, "post_id": 55730277, "comment_id": 98140257, "body": "@TimWilliams indeed... and that&#39;s a great answer you got there! Would <a href=\"https://i.stack.imgur.com/EFtjA.png\" rel=\"nofollow noreferrer\">this</a> be too much of an edit though? I don&#39;t want to abuse my edit privs or deface your post in any way - not going to hit that button if you would prefer to keep it as it is."}, {"owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "edited": false, "score": 0, "creation_date": 1555514454, "post_id": 55730277, "comment_id": 98140767, "body": "ok thanks that was it, simple error, simple fix."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1555519266, "post_id": 55730277, "comment_id": 98143332, "body": "@MathieuGuindon - that edit is OK with me"}], "owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555512151, "creation_date": 1555512151, "question_id": 55730277, "link": "https://stackoverflow.com/questions/55730277/why-does-userform-search-code-only-work-when-sheet2-is-active", "title": "Why does userform search code only work when sheet2 is active?", "body": "<p>userform1. code works perfect when sheet \"All p.o. info\" is active, but issues when sheet is not active. textbox value not showing or showing wrong information when sheet with range containing the value is inactive. Any help will be greatly appreciated. </p>\n\n<pre><code>`Private Sub CommandButton4_Click()\nDim id As String\nDim PO As String\nDim finalrow As Integer\nDim i As Integer\n\nid = TextBox16.Value\nfinalrow = Sheets(\"ALL P.O. INFO\").Range(\"D6000\").End(xlUp).ROW\n\nFor i = 2 To finalrow\n    If Sheets(\"ALL P.O. INFO\").Cells(i, 4) = id Then\n        Me.TextBox23 = Sheets(\"ALL P.O. INFO\").Cells(i, 7).Value\n        Me.TextBox19 = Sheets(\"ALL P.O. INFO\").Cells(i, 4).Value\n        Me.TextBox20 = Sheets(\"ALL P.O. INFO\").Cells(i, 1).Value\n        Me.TextBox21 = Sheets(\"ALL P.O. INFO\").Cells(i, 6).Value\n        Me.TextBox22 = Sheets(\"ALL P.O. INFO\").Cells(i, 14).Value\n\n    End If\n\nPO = TextBox18.Value\nfinalrow = Sheets(\"ALL P.O. INFO\").Range(\"A6000\").End(xlUp).ROW\n        If Cells(i, 1) = PO Then\n            Me.TextBox23 = Sheets(\"ALL P.O. INFO\").Cells(i, 7).Value\n            Me.TextBox19 = Sheets(\"ALL P.O. INFO\").Cells(i, 4).Value\n            Me.TextBox20 = Sheets(\"ALL P.O. INFO\").Cells(i, 1).Value\n            Me.TextBox21 = Sheets(\"ALL P.O. INFO\").Cells(i, 6).Value\n            Me.TextBox22 = Sheets(\"ALL P.O. INFO\").Cells(i, 14).Value\n        End If\n\nNext i`\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10167297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zKP6vp1SfOI/AAAAAAAAAAI/AAAAAAAAAFQ/7HrKOqiPNgY/photo.jpg?sz=128", "display_name": "BoatHouse", "link": "https://stackoverflow.com/users/10167297/boathouse"}, "edited": false, "score": 0, "creation_date": 1555595671, "post_id": 55730773, "comment_id": 98172006, "body": "It&#39;s still giving me the same errors. When I roll over the line of code you recommended, it said: <code>DDown.Range.End  = &lt;The remote server machine does not exsist or is unavailable&gt;</code>. is that a problem?"}], "tags": [], "owner": {"reputation": 326, "user_id": 7061680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22002c39dcc7e46b3beab7af3d0d2c80?s=128&d=identicon&r=PG&f=1", "display_name": "BankBuilder", "link": "https://stackoverflow.com/users/7061680/bankbuilder"}, "is_accepted": false, "score": 0, "last_activity_date": 1555513619, "creation_date": 1555513619, "answer_id": 55730773, "question_id": 55730200, "link": "https://stackoverflow.com/questions/55730200/some-controls-could-not-be-added-to-this-location-when-adding-more-than-one-dr/55730773#55730773", "title": "&quot;Some Controls Could Not Be Added to This Location&quot; When Adding More Than One Dropdown to a Cell in a Table", "body": "<p>You need to move the current selection cursor position to a spot after the end of the control you just added. This is the solution offered in the SO question you reference in your question <a href=\"https://stackoverflow.com/questions/11024481/adding-content-control-throws-an-exception-dynamically\">Adding content control throws an exception dynamically</a></p>\n\n<p>The code in that question isn't VBA, but the underlying libraries are the same, hence the similarities.</p>\n\n<p>Change your loop as follows:</p>\n\n<pre><code>    Do While Not rst.EOF ' rst is a DAO.Recordset of shipping dates ordered chronologicly. multiple items can ship the same day\n        If rst![Ship] &lt;&gt; currDay Then ' if nothing left to ship this day, move to next cell/row\n            Exit Do\n        End If\n\n        Set DDown = doc.Tables(1).Cell(i, j).Range.ContentControls.Add(wdContentControlDropdownList) 'This line fails upon adding a second dropdown to a cell\n\n        ' move current selection to after the end of the newly added control\n        doc.Application.Selection.Start = DDown.Range.End+1\n\n        'Add items to dropdown\n        DDown.DropdownListEntries.Add \"Shipping within 7 days\"\n        DDown.DropdownListEntries.Add \"On schedule\"\n        DDown.DropdownListEntries.Add \"On Hold\"\n\n    Loop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1555607396, "creation_date": 1555607396, "answer_id": 55750814, "question_id": 55730200, "link": "https://stackoverflow.com/questions/55730200/some-controls-could-not-be-added-to-this-location-when-adding-more-than-one-dr/55750814#55750814", "title": "&quot;Some Controls Could Not Be Added to This Location&quot; When Adding More Than One Dropdown to a Cell in a Table", "body": "<p>The tricky part about putting things in a table is making sure the target position is in the cell and not in the table structures or, in the case of content controls, within the content control. Working with <code>Range</code> objects makes this easier to control.</p>\n\n<p>Note that it's not clear from the code in the question when <code>i</code> and <code>j</code> are being incremented, so the approach may need to be adjusted for the actual loops being performed. Since I don't have your database, my testing was done out-of-context, but something like this, building it into the code in the question. </p>\n\n<p>First, declare objects for working with the target table, cell and range. The key is to collapse the target Range before inserting new content.</p>\n\n<p>There's also an \"oddity\" when inserting numerous content controls in a loop that Word will suddenly mix up the actual target <code>Range</code> with that of the last content control inserted. For this reason, the code selects the target <code>Range</code> in each loop, which seems to help Word keep things straight...</p>\n\n<pre><code>Dim tbl As Word.Table, cel As Word.Cell\nDim celRange As Word.Range\nDim DDown As Word.ContentControl\n\nSet tbl = doc.Tables(1) 'one table, so do it before the loop\n\nDo While Not rst.EOF ' rst is a DAO.Recordset of shipping dates ordered chronologicly. multiple items can ship the same day\n    If rst![Ship] &lt;&gt; currDay Then ' if nothing left to ship this day, move to next cell/row\n        Exit Do\n    End If\n\n    Set cel =  tbl.Cell(i, j)\n    Set celRange = cel.Range\n    'Move the target focus to the end of the cell\n    celRange.Collapse wdCollapseEnd\n    celRange.MoveEnd wdCharacter, -1\n\n    Set DDown = celRange.ContentControls.Add(wdContentControlDropdownList) \n\n    'Add items to dropdown\n    DDown.DropdownListEntries.Add \"Shipping within 7 days\"\n    DDown.DropdownListEntries.Add \"On schedule\"\n    DDown.DropdownListEntries.Add \"On Hold\"\n\n    'The target range will still be ahead of the content control, so\n    'Prepare for the next content control by adding a new paragraph\n    ' and putting the target area at the end of the cell\n    Set celRange = cel.Range\n    celRange.Collapse wdCollapseEnd\n    celRange.MoveEnd wdCharacter, -1\n    celRange.Text = vbCrLf  'add a new line between dropdown lists\n    celRange.Collapse wdCollapseEnd\n\n    'After some iterations, celRange remains attached to the inserted content control\n    'causing an error about the target overlapping a plain text content control.\n    'Selecting the range puts the focus for insertion in the right place\n    celRange.Select\n    Set DDown = Nothing\n\nLoop\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10167297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zKP6vp1SfOI/AAAAAAAAAAI/AAAAAAAAAFQ/7HrKOqiPNgY/photo.jpg?sz=128", "display_name": "BoatHouse", "link": "https://stackoverflow.com/users/10167297/boathouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 55750814, "answer_count": 2, "score": 0, "last_activity_date": 1555607396, "creation_date": 1555511947, "last_edit_date": 1555604971, "question_id": 55730200, "link": "https://stackoverflow.com/questions/55730200/some-controls-could-not-be-added-to-this-location-when-adding-more-than-one-dr", "title": "&quot;Some Controls Could Not Be Added to This Location&quot; When Adding More Than One Dropdown to a Cell in a Table", "body": "<p>I am making a function in my access database that creates a calendar using a template with a pre-made table in it. It'll have a \"status\" dropdown for each shipment taking place on a given day. I was able to create a dropdown for each cell in the table, but as soon as I move the set statement inside of this do-while loop, I get the following message in word:</p>\n\n<blockquote>\n  <p>Some controls could not be added to this location</p>\n</blockquote>\n\n<p>followed by:</p>\n\n<blockquote>\n  <p>Run-time error '4198': Command Failed</p>\n</blockquote>\n\n<p>In access</p>\n\n<p>I found this question mentioning problems with content controls:\n<a href=\"https://stackoverflow.com/questions/11024481/adding-content-control-throws-an-exception-dynamically\">Adding content control throws an exception dynamically</a></p>\n\n<p>But it's not in VBA. Is it possible that there is some kind of equivalent issue here or is this a dead end?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>\nFor i = 1 + 1 To NUMBER_OF_WEEKS + 1 '16 + 1\n\n        For j = 1 To NUMBER_OF_DAYS_IN_THE_WEEK ' 7\n\n             Do While Not rst.EOF ' rst is a DAO.Recordset of shipping dates ordered chronologicly. multiple items can ship the same day\n                If rst![Ship] &lt;&gt; currDay Then ' if nothing left to ship this day, move to next cell/row\n                    Exit Do\n                End If\n\n                doc.Tables(1).Cell(i, j).Range.InsertAfter vbCrLf 'supposed to add a new line between dropdown lists\n\n                Set DDown = doc.Tables(1).Cell(i, j).Range.ContentControls.Add(wdContentControlDropdownList) 'This line fails upon adding a second dropdown to a cell\n\n                'Add items to dropdown\n                DDown.DropdownListEntries.Add \"Shipping within 7 days\"\n                DDown.DropdownListEntries.Add \"On schedule\"\n                DDown.DropdownListEntries.Add \"On Hold\"\n\n            Loop\n\n        'move to the next day\n        currDay = currDay + 1\n    Next j\nNext i\n\n</code></pre>\n\n<p>I was expecting to result in multiple dropdown lists for each day, but it results in a single dropdown in the 2nd cell of the first row (can't ship on sundays so it skips the first cell of each row) before saying that the Content control cannot be added</p>\n"}, {"tags": ["vba", "userform"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 1, "creation_date": 1555511151, "post_id": 55729813, "comment_id": 98138602, "body": "Double click on the form in the project explorer.?"}, {"owner": {"reputation": 1, "user_id": 8565390, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-92jBtg42iUI/AAAAAAAAAAI/AAAAAAAAMxI/UeVaI11GlNc/photo.jpg?sz=128", "display_name": "SanLucos", "link": "https://stackoverflow.com/users/8565390/sanlucos"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1555511732, "post_id": 55729813, "comment_id": 98138969, "body": "Doesn&#39;t work, it only open the code editor view"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1555512156, "post_id": 55729813, "comment_id": 98139247, "body": "right click in the userform (in the project explorer) and view object ?"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1555512530, "post_id": 55729813, "comment_id": 98139509, "body": "Double click works for me."}, {"owner": {"reputation": 1, "user_id": 8565390, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-92jBtg42iUI/AAAAAAAAAAI/AAAAAAAAMxI/UeVaI11GlNc/photo.jpg?sz=128", "display_name": "SanLucos", "link": "https://stackoverflow.com/users/8565390/sanlucos"}, "edited": false, "score": 0, "creation_date": 1555512606, "post_id": 55729813, "comment_id": 98139561, "body": "These is no &quot;view object&quot; option displayed in the right click menu"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1555512753, "post_id": 55729813, "comment_id": 98139648, "body": "Are you in the form folder of your template project."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1555512833, "post_id": 55729813, "comment_id": 98139710, "body": "Also try a window.cascade as occasionally your firm can be off the visible screen when displayed."}, {"owner": {"reputation": 1, "user_id": 8565390, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-92jBtg42iUI/AAAAAAAAAAI/AAAAAAAAMxI/UeVaI11GlNc/photo.jpg?sz=128", "display_name": "SanLucos", "link": "https://stackoverflow.com/users/8565390/sanlucos"}, "edited": false, "score": 0, "creation_date": 1555513041, "post_id": 55729813, "comment_id": 98139838, "body": "Yes FreeFlow, I&#39;m in this folder. I also checked the cascade display. I&#39;ve even closed et re opened the file and I still can&#39;t get this $*\u20ac%&#249; Userform editor.  I&#39;m sure it&#39;s an obscure parameter to activate somewhere..."}], "owner": {"reputation": 1, "user_id": 8565390, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-92jBtg42iUI/AAAAAAAAAAI/AAAAAAAAMxI/UeVaI11GlNc/photo.jpg?sz=128", "display_name": "SanLucos", "link": "https://stackoverflow.com/users/8565390/sanlucos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555512805, "creation_date": 1555511008, "last_edit_date": 1555512805, "question_id": 55729813, "link": "https://stackoverflow.com/questions/55729813/how-to-display-the-graphic-editor-view-of-a-userform-after-having-closed-it-in", "title": "How to display the graphic editor view of a Userform (after having closed it) in VBA?", "body": "<p>I'm already sorry for the stupidity of my question.</p>\n\n<p>Here is y problem :</p>\n\n<ol>\n<li>I have created a macro in VBA for Word. </li>\n<li>I have created a UserForm\nfor display needs. </li>\n<li>I have closed the graphic editor windows of the\nUserForm to open the code editor view.</li>\n</ol>\n\n<p>Now I want want to add some commands to the UserForm so I'm looking for the button / shortcut to re-open the graphic editor\n--> Can't find it (I've lost one hour of my poor life)</p>\n\n<p>I've look in all the menu, I've looked for all the existing shortcuts, ... I've just found the shortcut \"F7\" to switch from the graphic edition to the code. I want the other way around. But hitting F7 again doesn't work.\nI'm sure it's a stupid things my even stupider brain cannot figure it out.</p>\n\n<p>There no code to show.\nAnd I'm on Mac... with a French MS Word edition... sorry ...</p>\n\n<p>Double click on the UserForm in the Project Explorer doesn't work\nThere's nothing in the right click menu\n<a href=\"https://i.stack.imgur.com/JZwhM.png\" rel=\"nofollow noreferrer\">screen shot of the right click menu</a></p>\n"}, {"tags": ["excel", "ms-access", "insert", "vba"], "comments": [{"owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1555512742, "post_id": 55729752, "comment_id": 98139643, "body": "@HansUp Not sure if it matters but I did Msgbox instead of Debug and its returning Null"}, {"owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1555513645, "post_id": 55729752, "comment_id": 98140231, "body": "@hansup the only column i have displayed for the user to choose from. The bound column is at &quot;1&quot;"}, {"owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1555515643, "post_id": 55729752, "comment_id": 98141473, "body": "@HansUP It&#39;s Simple"}], "answers": [{"comments": [{"owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "edited": false, "score": 0, "creation_date": 1555512776, "post_id": 55730306, "comment_id": 98139665, "body": "Is there any other way to do this so I can access the values from a simple query instead of writing out some VBA code?"}, {"owner": {"reputation": 36, "user_id": 11183818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef30ac9e58e4a91401e51e83123929fc?s=128&d=identicon&r=PG&f=1", "display_name": "xfh2002", "link": "https://stackoverflow.com/users/11183818/xfh2002"}, "reply_to_user": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "edited": false, "score": 0, "creation_date": 1555513661, "post_id": 55730306, "comment_id": 98140246, "body": "May be it&#39;s worth trying because Debug.Print Forms![Activities]![List80] does not work."}], "tags": [], "owner": {"reputation": 36, "user_id": 11183818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef30ac9e58e4a91401e51e83123929fc?s=128&d=identicon&r=PG&f=1", "display_name": "xfh2002", "link": "https://stackoverflow.com/users/11183818/xfh2002"}, "is_accepted": true, "score": 1, "last_activity_date": 1555512240, "creation_date": 1555512240, "answer_id": 55730306, "question_id": 55729752, "link": "https://stackoverflow.com/questions/55729752/access-getting-value-from-list-box/55730306#55730306", "title": "Access: Getting Value From List Box", "body": "<p>To access a value of a combo box or list box please use SelectedValue in VBA, i.e. Forms(\"Activities\").Controls(\"List80\").SelectedValue or you can access the value by first determining the SelectedIndex and then pick the value. Then you can use this value in a query. </p>\n"}], "owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2004, "favorite_count": 0, "accepted_answer_id": 55730306, "answer_count": 1, "score": 0, "last_activity_date": 1556022957, "creation_date": 1555510823, "last_edit_date": 1556022957, "question_id": 55729752, "link": "https://stackoverflow.com/questions/55729752/access-getting-value-from-list-box", "title": "Access: Getting Value From List Box", "body": "<p>I'm trying to get a value from a ListBox, <code>List80</code>. I'm trying to grab the options chosen, say <code>Red</code>, <code>Blue</code>, <code>Yellow</code>, and have it inserted into a table using a query. I have written the following query: </p>\n\n<pre><code>INSERT INTO Test_User_Activity\nVALUES (5554, 4, \"Something\", Forms![Activities]![List80]);\n</code></pre>\n\n<p>It runs, but doesn't return any items that were selected in the List. I did something similar to this with a multi-select dropdown list and am wondering where i'm going wrong.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1555511500, "post_id": 55729672, "comment_id": 98138824, "body": "If you need two directories open at the same time you need to investigate the much more flexible scripting.filesystemobject."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1555512199, "post_id": 55729672, "comment_id": 98139288, "body": "More explicitly - you cannot nest Dir loops - you can only have one &quot;context&quot; at any given time.  Likely someone here will help you out if you can explain exactly what changes you&#39;re trying to make."}], "answers": [{"comments": [{"owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "reply_to_user": {"reputation": 229, "user_id": 11277108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3343b06b3a374699e66f7eb9da348790?s=128&d=identicon&r=PG&f=1", "display_name": "Jossy", "link": "https://stackoverflow.com/users/11277108/jossy"}, "edited": false, "score": 0, "creation_date": 1555527793, "post_id": 55730690, "comment_id": 98147145, "body": "@Jossy You&#39;re welcome. If you&#39;ll find this answer helpful, please consider accepting it, so others can benefit from it. :)"}], "tags": [], "owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "is_accepted": true, "score": 2, "last_activity_date": 1555516118, "last_edit_date": 1555516118, "creation_date": 1555513358, "answer_id": 55730690, "question_id": 55729672, "link": "https://stackoverflow.com/questions/55729672/why-am-i-getting-an-error-with-dir-in-a-vba-loop/55730690#55730690", "title": "Why am I getting an error with Dir in a VBA loop?", "body": "<p>You cannot achieve that with the <code>Dir()</code> <code>Function</code>. To do that you can use <code>Scripting.FileSystemObject</code>. <br>\nThis is a sample I wrote that you can easily adapt to your code:</p>\n\n<pre><code>Dim oFile       As Object\nDim oFSO        As Object\nDim oFolder     As Object\nDim oFiles      As Object\n\nSet oFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet oFolder = oFSO.GetFolder(myPath) 'You must initialize this before\nSet oFiles = oFolder.Files\n\n'For all files in the folder\nFor Each oFile In oFiles\n    If (oFile Like \"*.xls*\") Then\n        'Set variable equal to opened workbook\n        Set wb = Workbooks.Open(Filename:=oFile)\n\n        'Ensure Workbook has opened before moving on to next line of code\n         DoEvents\n\n        'Change First Worksheet's Background Fill Blue\n        wb.Worksheets(1).Range(\"A1:Z1\").Interior.Color = RGB(51, 98, 174)\n\n        'Save and Close Workbook\n        wb.Close SaveChanges:=True\n\n        'Ensure Workbook has closed before moving on to next line of code\n        DoEvents\n    End If\nNext\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 229, "user_id": 11277108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3343b06b3a374699e66f7eb9da348790?s=128&d=identicon&r=PG&f=1", "display_name": "Jossy", "link": "https://stackoverflow.com/users/11277108/jossy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "accepted_answer_id": 55730690, "answer_count": 1, "score": 2, "last_activity_date": 1555516118, "creation_date": 1555510548, "question_id": 55729672, "link": "https://stackoverflow.com/questions/55729672/why-am-i-getting-an-error-with-dir-in-a-vba-loop", "title": "Why am I getting an error with Dir in a VBA loop?", "body": "<p>I have been building a macro to loop through a series of files in a folder and with each one copy and paste data into a series of other sheets in another folder. I started with this code below which worked fine doing the copy and pasting:</p>\n\n<pre><code>'PURPOSE: To loop through all Excel files in a user specified folder and perform a set task on them\n'SOURCE: www.TheSpreadsheetGuru.com\n\nDim wb As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\n\n'Optimize Macro Speed\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n'Retrieve Target Folder Path From User\n  Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With FldrPicker\n      .Title = \"Select A Target Folder\"\n      .AllowMultiSelect = False\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        myPath = .SelectedItems(1) &amp; \"\\\"\n    End With\n\n'In Case of Cancel\nNextCode:\n  myPath = myPath\n  If myPath = \"\" Then GoTo ResetSettings\n\n'Target File Extension (must include wildcard \"*\")\n  myExtension = \"*.xls*\"\n\n'Target Path with Ending Extention\n  myFile = Dir(myPath &amp; myExtension)\n\n'Loop through each Excel file in folder\n  Do While myFile &lt;&gt; \"\"\n    'Set variable equal to opened workbook\n      Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n    'Ensure Workbook has opened before moving on to next line of code\n      DoEvents\n\n    'Change First Worksheet's Background Fill Blue\n      wb.Worksheets(1).Range(\"A1:Z1\").Interior.Color = RGB(51, 98, 174)\n\n    'Save and Close Workbook\n      wb.Close SaveChanges:=True\n\n    'Ensure Workbook has closed before moving on to next line of code\n      DoEvents\n\n    'Get next file name\n      myFile = Dir\n  Loop\n\n'Message Box when tasks are completed\n  MsgBox \"Task Complete!\"\n\nResetSettings:\n  'Reset Macro Optimization Settings\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>However I've now added a second loop to deal with the multiple to multiple files and I'm getting a run time error 5 on the second version of:</p>\n\n<p><code>myFile = Dir</code></p>\n\n<p>I've renamed myFile to another name so it doesn't conflict with the first.</p>\n\n<p>I've not posted all my code here as it's much longer and more complicated. Hope this is enough for you guys to go on?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1555507761, "post_id": 55728618, "comment_id": 98136309, "body": "this can be done with a formula, is vba necessary?"}, {"owner": {"reputation": 77, "user_id": 11261525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4399dbe11fd429286575b23ed44bd82?s=128&d=identicon&r=PG&f=1", "display_name": "Jade", "link": "https://stackoverflow.com/users/11261525/jade"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1555508089, "post_id": 55728618, "comment_id": 98136542, "body": "@ScottCraner yes because it&#39;s for other users that may not be familiar with excel"}], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1555513184, "last_edit_date": 1555513184, "creation_date": 1555511582, "answer_id": 55730052, "question_id": 55728618, "link": "https://stackoverflow.com/questions/55728618/find-the-cell-that-matches-with-text-x-then-look-for-the-most-recent-date-in/55730052#55730052", "title": "Find the cell that matches with text &quot;X&quot;, then look for the most recent date in VBA Excel", "body": "<p>You could think about something along these line:</p>\n\n<pre><code>Public Function GetDollar(NOM) As Double\n\nDim RNG1 As String, RNG2 As String, RNG3 As String, LR As Double\nWith ActiveWorkbook.Sheets(1)\n    LR = .Cells(Rows.Count, 2).End(xlUp).Row\n    RNG1 = .Range(.Cells(1, 2), .Cells(LR, 2)).Address\n    RNG2 = .Range(.Cells(1, 3), .Cells(LR, 3)).Address\n    RNG3 = .Range(.Cells(1, 4), .Cells(LR, 4)).Address\n    GetDollar = .Evaluate(\"=INDEX(\" &amp; RNG3 &amp; \",MATCH(\"\"\" &amp; NOM &amp; \"\"\"&amp;MAX((\" &amp; RNG1 &amp; \"=\"\"\" &amp; NOM &amp; \"\"\")*\" &amp; RNG2 &amp; \"),\" &amp; RNG1 &amp; \"&amp;\" &amp; RNG2 &amp; \",0))\")\nEnd With\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/rXfFZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rXfFZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>If, in your case, you want to have both column E and G populated, you are going to need two UDF's still as you can't alter other cell's values through UDF.</p>\n"}], "owner": {"reputation": 77, "user_id": 11261525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4399dbe11fd429286575b23ed44bd82?s=128&d=identicon&r=PG&f=1", "display_name": "Jade", "link": "https://stackoverflow.com/users/11261525/jade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 55730052, "answer_count": 1, "score": 0, "last_activity_date": 1555513184, "creation_date": 1555507532, "question_id": 55728618, "link": "https://stackoverflow.com/questions/55728618/find-the-cell-that-matches-with-text-x-then-look-for-the-most-recent-date-in", "title": "Find the cell that matches with text &quot;X&quot;, then look for the most recent date in VBA Excel", "body": "<p>I have 3 columns:</p>\n\n<p>Col B: Range of names</p>\n\n<p>Col E: Range of dates</p>\n\n<p>Col G: Dollar values</p>\n\n<p>I want the code to Go in column B, match with whatever name I put cell P5, then see in column E what is the latest date for that name and return the G dollar value. Right now, I have the codes separately but I don't know how to put them together:</p>\n\n<pre><code> Function Max_Date()\n   Max_Date = Application.WorksheetFunction.Max(Columns(\"Y\"))\n   MsgBox CDate(Max_Date)\n End Function\n\nFunction FindText()\n Dim rngX As Range \n  Set rngX = ActiveSheet.Range(\"B:B\").Find(Range(\"P5\"), lookat:=xlPart)\n   If Not rngX Is Nothing Then\n    MsgBox \"Found at \" &amp; rngX.Address\n   End If \nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1555519229, "post_id": 55728330, "comment_id": 98143315, "body": "So what is the problem? Application_ItemSend never gets called?Or that Read() function does not work? In the latter case you really need to post its source."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1556136591, "post_id": 55728330, "comment_id": 98339710, "body": "See my answer below, is that what you ware trying to do?"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 0, "last_activity_date": 1555535498, "creation_date": 1555535498, "answer_id": 55736027, "question_id": 55728330, "link": "https://stackoverflow.com/questions/55728330/what-is-the-syntax-for-application-itemsend/55736027#55736027", "title": "What is the syntax for Application_ItemSend()?", "body": "<p><em>Should be</em></p>\n\n<pre><code>Option Explicit\nPrivate Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n    Call Read\nEnd Sub\n\nPublic Sub Read()\n        Debug.Print \"success\"\nEnd Sub\n</code></pre>\n\n<p><strong><em><a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/calling-sub-and-function-procedures\" rel=\"nofollow noreferrer\">Calling Sub and Function procedures</a></em></strong></p>\n"}], "owner": {"reputation": 31, "user_id": 11064007, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PQdPdszkhPQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPza3KHbCucvaZ3svCRXGDHoBYkaw/mo/photo.jpg?sz=128", "display_name": "Sorin Ionescu", "link": "https://stackoverflow.com/users/11064007/sorin-ionescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 55736027, "answer_count": 1, "score": 1, "last_activity_date": 1592554955, "creation_date": 1555506625, "last_edit_date": 1592554955, "question_id": 55728330, "link": "https://stackoverflow.com/questions/55728330/what-is-the-syntax-for-application-itemsend", "title": "What is the syntax for Application_ItemSend()?", "body": "<p>I have a subroutine called Read in Outlook. I want to execute it every time I send an email.</p>\n\n<p>I tried to call it as part of <code>Application_ItemSend()</code>, but it does nothing.</p>\n\n<pre><code>Private Sub Application_ItemSend() 'calls the first function when you send a mail\nRead\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "vb.net", "userform"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 1, "creation_date": 1555507459, "post_id": 55728191, "comment_id": 98136111, "body": "Have you seen this <a href=\"https://stackoverflow.com/questions/33823450/call-from-one-file-a-userform-in-another\">QA</a>? I believe it may be a similar problem."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 1, "creation_date": 1555507482, "post_id": 55728191, "comment_id": 98136123, "body": "What&#39;s <code>getworkbook()</code>? Why aren&#39;t you doing it the straight forward way: <code>dim wb as Workbook</code> and then <code>set wb=Workbooks.open(&quot;File path&quot;)</code>"}, {"owner": {"reputation": 406, "user_id": 4026969, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dexter Whelan", "link": "https://stackoverflow.com/users/4026969/dexter-whelan"}, "edited": false, "score": 0, "creation_date": 1555508002, "post_id": 55728191, "comment_id": 98136497, "body": "sorry its a method of code in the library im using, getworkbook() must look strange but in fact it is opening a workbook in handle and workbookname is actually filepath &amp; name concat&#39;d together. sorry for confusion"}, {"owner": {"reputation": 406, "user_id": 4026969, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dexter Whelan", "link": "https://stackoverflow.com/users/4026969/dexter-whelan"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1555508201, "post_id": 55728191, "comment_id": 98136605, "body": "@Mistella this is pretty good i might consider this a workaround but i am not operating from another workbook i have an instance of running VB code connected to the singgular open workbook that contains the userform and i would like the vb code to interact with the userform. I will explore the workbook to workbook option and see how it works but first im going to explore passing values from VB to workbook form"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1555508588, "post_id": 55728191, "comment_id": 98136841, "body": "@DexterWhelan, I misunderstood your question. Userforms are objects, and ideally you don&#39;t want to be dealing with a default instance. (I&#39;ve seen some good examples, but I don&#39;t remember where right now.) To be able to interact with a control, a instance of the userform needs to be initialized. Usually, <code>.Show</code> on a default instance will also cause the initialization before showing the userform. However, since it&#39;s sounding like you want to interact with it before it&#39;s shown; it would probably be helpful to interact with a declared instance instead of the default."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1555508799, "post_id": 55728191, "comment_id": 98136989, "body": "Found a couple of links that might be helpful: <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">RubberDuck blog</a> and <a href=\"https://yoursumbuddy.com/a-flexible-vba-chooser-form/\" rel=\"nofollow noreferrer\">yoursumbuddy.com</a>"}], "answers": [{"comments": [{"owner": {"reputation": 406, "user_id": 4026969, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dexter Whelan", "link": "https://stackoverflow.com/users/4026969/dexter-whelan"}, "edited": false, "score": 0, "creation_date": 1555508525, "post_id": 55728773, "comment_id": 98136796, "body": "I&#39;ve plugged this into my vb code but it&#39;s telling me UserForm1 is not declared. It may be inaccessible due to its protection level. I guess this is saying at compile time the UserForm1 needs to be made visible somehow."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 406, "user_id": 4026969, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dexter Whelan", "link": "https://stackoverflow.com/users/4026969/dexter-whelan"}, "edited": false, "score": 0, "creation_date": 1555508803, "post_id": 55728773, "comment_id": 98136994, "body": "this would need to be in the <code>UserForm_Initialize</code> event."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1556100951, "post_id": 55728773, "comment_id": 98320001, "body": "Within a form&#39;s code module you should always loop via the <code>Me</code> particle referring to the current instance thus using <code>For each ctrl in Me.Controls</code> instead of referring to the Userform&#39;s default instance only  :-) @ZackE"}], "tags": [], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "is_accepted": false, "score": 0, "last_activity_date": 1555537440, "last_edit_date": 1555537440, "creation_date": 1555507950, "answer_id": 55728773, "question_id": 55728191, "link": "https://stackoverflow.com/questions/55728191/reference-userform-textvalue1-from-vb-code-query/55728773#55728773", "title": "Reference UserForm.TextValue1 from VB code query", "body": "<p>There is no need to use <code>wb.UserForm1.TextBox1</code>.  Instead use this:</p>\n\n<pre><code>UserForm1.TextBox1.Value = \"abcd\"\n</code></pre>\n\n<p>To make all controls on a UserForm Visible use this in the <code>UserForm_Initialize</code> Event:</p>\n\n<pre><code>Sub UserForm_Initialize()\nDim ctrl as Control\n\nFor each ctrl in UserForm1.Controls\n     If Typename(ctrl) = \"TextBox\" then\n         ctrl.Visible = True\n     End If\nNext ctrl\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 406, "user_id": 4026969, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dexter Whelan", "link": "https://stackoverflow.com/users/4026969/dexter-whelan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555537440, "creation_date": 1555506179, "last_edit_date": 1555508264, "question_id": 55728191, "link": "https://stackoverflow.com/questions/55728191/reference-userform-textvalue1-from-vb-code-query", "title": "Reference UserForm.TextValue1 from VB code query", "body": "<p>i have a pre-created xlsm workbook that has inside of it some userforms that i'd like to set with values from some VB code. So I can access, open and show the workbook everything is going fine there but I'm having an issue in getting the syntax/terminology correct for interactibg with userforms.</p>\n\n<p>my code looks something like this:</p>\n\n<pre><code>Dim wb as Object = getworkbook(handle, workbookname)\n'i now have a workbook i can manipulate\n'here i've left out a series of worksheet calls that happen and some other macro calls which I dont believe are relevant\n'now i would like to reference the form that was named 'UserForm1' and in that form there are multiple text boxes with various titles so we'll just go with the first one 'TextBox1'.\n' so i am trying to reference UserForm1.TextBox1 and set it to 'abcd'\n\n'try 1 \nwb.UserForm1.TextBox1 = \"abcd\"\n'gives public member userform1 on type workbook not found\n\n'try 2\nwb.UserForm1.TextBox1.Value = \"abcd\"\n'gives public member userform1 on type workbook not found\n\n'try 3\n'saw this on windows site but i dont get the syntax of calling them controls                     \n'so im not confident in exactly how this was supposed to work\nFor Each Control in UserForm1.Controls\n    Control.Visible = True\nNext Control\n'this was just to make it visible but it didnt work, i get compile errors of \n'UserForm1 not accessible maybe due to its protectionlevel.\n</code></pre>\n\n<p>now ive spent a while looking for solutions and i can find multiple references to VBA to VBA calls and hundreds of articles on calling other elements of a VBA project from VB but i can't seem to find anything particular on referencing userforms from a VB project.</p>\n\n<p>Im guessing on my work so far that userforms 'dont exist' at run time and i need to create an object of it to manipulate from the VB code but i can't find the syntax of how to reference userforms correctly.</p>\n\n<p>anyone got any ideas?</p>\n\n<p>EDIT: small clarification GEtWorkbook() is a predefined task sorry for not provising clarity on that basically it opens a target workbook at instance handle and workbook name includes filepath as well as name together to point to a workbook.</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1555507758, "post_id": 55728392, "comment_id": 98136306, "body": "You impressed me once more mister! Hopefully I can implement this in the future :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1555507865, "post_id": 55728392, "comment_id": 98136398, "body": "@JvdV <a href=\"https://flukeout.github.io/\" rel=\"nofollow noreferrer\">flukeout.github.io</a>  and <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors</a>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1555508340, "post_id": 55728392, "comment_id": 98136684, "body": "One day I&#39;ll understand all of that ;)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1555508745, "post_id": 55728392, "comment_id": 98136957, "body": "@JvdV If you have questions (that aren&#39;t requiring a full mcve - in which case post on SO) you can always ask them in the <a href=\"https://chat.stackoverflow.com/rooms/169987/dawgs-waffle-haus\">dawghaus</a>"}, {"owner": {"reputation": 159, "user_id": 9167093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yumMXrR-vps/AAAAAAAAAAI/AAAAAAAAAAA/TIEk7zjfLXg/photo.jpg?sz=128", "display_name": "kiran mamalwad", "link": "https://stackoverflow.com/users/9167093/kiran-mamalwad"}, "edited": false, "score": 0, "creation_date": 1555576678, "post_id": 55728392, "comment_id": 98161294, "body": "Thanks man.. you are really genies.. how quick you solve this time as well. Thank you for your time and affords."}, {"owner": {"reputation": 159, "user_id": 9167093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yumMXrR-vps/AAAAAAAAAAI/AAAAAAAAAAA/TIEk7zjfLXg/photo.jpg?sz=128", "display_name": "kiran mamalwad", "link": "https://stackoverflow.com/users/9167093/kiran-mamalwad"}, "edited": false, "score": 0, "creation_date": 1555577109, "post_id": 55728392, "comment_id": 98161510, "body": "just a small question .. if I want to string url from a cell value then how can I frame the code provided by you?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1555577256, "post_id": 55728392, "comment_id": 98161608, "body": "Open &quot;GET&quot;,  ThisWorkbook.Worksheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;).value , False"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1555507625, "last_edit_date": 1555507625, "creation_date": 1555506876, "answer_id": 55728392, "question_id": 55728149, "link": "https://stackoverflow.com/questions/55728149/web-scraping-by-span-tag/55728392#55728392", "title": "Web Scraping by Span tag", "body": "<p>You can use the following. You want the child <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/li\" rel=\"nofollow noreferrer\">li</a> elements within the parent <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/ul\" rel=\"nofollow noreferrer\">ul</a> (unordered list) elements with class <code>innerList</code></p>\n\n<hr>\n\n<p><strong>Internet Explorer:</strong></p>\n\n<pre><code>Option Explicit\n'VBE &gt; Tools &gt; References:\n' Microsoft Internet Controls\nPublic Sub RetrieveInfo()\n    Dim IE As InternetExplorer, i As Long, items As Object\n    Set IE = New InternetExplorer\n\n    With IE\n        .Visible = True\n        .Navigate2 \"https://www.leetstorage.com/sizes-and-pricing\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Set items = .document.querySelectorAll(\".innerList li\")\n\n        For i = 0 To items.Length - 1\n            With ThisWorkbook.Worksheets(\"Sheet1\")\n                .Cells(i + 1, 1) = Trim$(items.item(i).innerText)\n            End With\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>XHR:</strong></p>\n\n<p>You can do this faster with XHR so long as you provide the User-Agent header</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim html As HTMLDocument, items As Object, i As Long '&lt;  VBE &gt; Tools &gt; References &gt; Microsoft HTML Object Library\n    Set html = New HTMLDocument\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://www.leetstorage.com/sizes-and-pricing\", False\n        .setRequestHeader \"User-Agent\", \"Mozilla/5.0\"\n        .send\n        html.body.innerHTML = .responseText\n    End With\n    Set items = html.querySelectorAll(\".innerList li\")\n\n    For i = 0 To items.Length - 1\n        With ThisWorkbook.Worksheets(\"Sheet1\")\n            .Cells(i + 1, 1) = Trim$(items.item(i).innerText)\n        End With\n    Next\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>ul blocks:</strong></p>\n\n<p>If you look at what is returned by just the class name of the <code>ul</code> then you get the 3 blocks on the page that have the lists:</p>\n\n<p><a href=\"https://i.stack.imgur.com/A4MWh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A4MWh.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong>ul with li:</strong></p>\n\n<p>Taking just one of those blocks to exemplify the effect of adding in the child <code>li</code> elements with <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Descendant_combinator\" rel=\"nofollow noreferrer\">descendant combinator</a>:</p>\n\n<p><img src=\"https://i.stack.imgur.com/TFl36.png\" width=\"300\"></p>\n"}], "owner": {"reputation": 159, "user_id": 9167093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yumMXrR-vps/AAAAAAAAAAI/AAAAAAAAAAA/TIEk7zjfLXg/photo.jpg?sz=128", "display_name": "kiran mamalwad", "link": "https://stackoverflow.com/users/9167093/kiran-mamalwad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 2, "accepted_answer_id": 55728392, "answer_count": 1, "score": 1, "last_activity_date": 1556022942, "creation_date": 1555506051, "last_edit_date": 1556022942, "question_id": 55728149, "link": "https://stackoverflow.com/questions/55728149/web-scraping-by-span-tag", "title": "Web Scraping by Span tag", "body": "<p>I'm trying to copy data from below mentioned web-site, all the range of sizes and cost which is mentioned on the web-page I need that all data. I frame below code but I'm able to copy only three element. Can anybody please look into this?</p>\n\n<p>Url- <a href=\"https://www.leetstorage.com/sizes-and-pricing\" rel=\"nofollow noreferrer\">https://www.leetstorage.com/sizes-and-pricing</a></p>\n\n<pre><code>Sub TagClassName()\n\nDim ie As New InternetExplorer, ws As Worksheet\n\nSet ws = ThisWorkbook.Worksheets(\"Unit Data\")\nWith ie\n    .Visible = True\n    .Navigate2 \"https://www.leetstorage.com/sizes-and-pricing\"\n\n    While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n    Dim listings As Object, listing As Object, headers(), results(), r As Long, c As Long, item As Object\n    headers = Array(\"size\")\n    Set listings = .document.getElementById(\"site_content\").getElementsByTagName(\"ul\")\n\n    ReDim results(1 To listings.Length, 1 To UBound(headers) + 1)\n    For Each listing In listings\n\n        r = r + 1\n        On Error Resume Next\n        results(r, 1) = listing.getElementsByClassName(\"font-size-NaN m-font-size-NaN\")(0).innerText\n\n        On Error GoTo 0\n  Next\n    Next\n    ws.Cells(1, 1).Resize(1, UBound(headers) + 1) = headers\n    ws.Cells(2, 1).Resize(UBound(results, 1), UBound(results, 2)) = results\n    .Quit\n\n    End With\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1555506244, "post_id": 55728032, "comment_id": 98135291, "body": "You might find some inspiration here : <a href=\"https://stackoverflow.com/questions/2852892/is-there-a-group-concat-function-in-ms-access\" title=\"is there a group concat function in ms access\">stackoverflow.com/questions/2852892/&hellip;</a>"}, {"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1555508667, "post_id": 55728032, "comment_id": 98136894, "body": "Hallo and Welcom to StackOverflow. How big is your table? For normal size tables you can basically inline the concat in a join query, somthing like <code>T1.field1 &amp; &quot;&#47;&quot; &amp; T2.Field2</code>"}, {"owner": {"reputation": 1, "user_id": 11373770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62349e7cf87a163d74df0d42e4bf3bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Microsofter3000", "link": "https://stackoverflow.com/users/11373770/microsofter3000"}, "reply_to_user": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1555509432, "post_id": 55728032, "comment_id": 98137439, "body": "@ThomasG Thank you! I found some codes [link](<a href=\"http://www.rogersaccesslibrary.com/forum/generic-function-to-concatenate-child-records_topic16&amp;SID=453fabc6-b3z9-34z6zb14-a78f832z-19z89a2c.html_italic_\" rel=\"nofollow noreferrer\">rogersaccesslibrary.com/forum/&hellip;</a> that are similar to mine. I tried it, it still takes very Long..but maybe still faster, we will see."}, {"owner": {"reputation": 1, "user_id": 11373770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62349e7cf87a163d74df0d42e4bf3bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Microsofter3000", "link": "https://stackoverflow.com/users/11373770/microsofter3000"}, "reply_to_user": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1555509662, "post_id": 55728032, "comment_id": 98137599, "body": "@SiyonDP Tanks! But The table has about 300.000 rows..."}, {"owner": {"reputation": 1, "user_id": 11373770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62349e7cf87a163d74df0d42e4bf3bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Microsofter3000", "link": "https://stackoverflow.com/users/11373770/microsofter3000"}, "edited": false, "score": 0, "creation_date": 1555509913, "post_id": 55728032, "comment_id": 98137771, "body": "Interesting fact: If I choose the datasheet view of the query, it goes super fast. But I have to add the recors to another table, and in this case it takes really Long."}, {"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1555511517, "post_id": 55728032, "comment_id": 98138834, "body": "How do you add add them to the other table?"}, {"owner": {"reputation": 1, "user_id": 11373770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62349e7cf87a163d74df0d42e4bf3bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Microsofter3000", "link": "https://stackoverflow.com/users/11373770/microsofter3000"}, "reply_to_user": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1556147500, "post_id": 55728032, "comment_id": 98343151, "body": "@SiyonDP with sql \u201eInsert into\u201c"}], "owner": {"reputation": 1, "user_id": 11373770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62349e7cf87a163d74df0d42e4bf3bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Microsofter3000", "link": "https://stackoverflow.com/users/11373770/microsofter3000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594621390, "creation_date": 1555505706, "last_edit_date": 1594621390, "question_id": 55728032, "link": "https://stackoverflow.com/questions/55728032/how-to-combine-a-number-of-rows-in-microsoft-access-separated-by-slash", "title": "How to combine a number of Rows in Microsoft Access separated by slash", "body": "<p>I've got a table in Microsoft Access with two columns. I wish to Group the list by one of them and the Information of the other column should be written separated by a slash. My code works, but it takes very long (more than two hours). Does anybody has an idea, how to handle this Problem in another way?</p>\n\n<p>I declared a function (see below the big code). In a Query I open this function with SQL</p>\n\n<p>Select SQLListe(\"SELECT [column2] FROM [table_name] WHERE [column1] = '\" &amp; [column1] &amp; \"'\";\"/\";\"/\") AS Result \nFROM [table_name]</p>\n\n<p>As I said, it takes really long, amongst others a lot of rows in the table. But maybe someone has an idea.</p>\n\n<p>Thanks!</p>\n\n<pre><code>Option Compare Database\nPublic Function SQLListe(ByVal SQL As String, _\n                         Optional ByVal SepR As String = \";\", _\n                         Optional ByVal SepF As String = \";\", _\n                         Optional ByVal NoNullFields As Boolean = True) _\n                         As String\n\n\n Dim rs As DAO.Recordset\n Dim i As Long\n Dim Res As String\n Dim Tmp As String\n\n Set rs = CurrentDb.OpenRecordset(SQL, dbOpenDynaset)\n\n On Error Resume Next\n\n If Err.Number &lt;&gt; 0 Then\n   Res = \"#Fehler\"\n   Err.Clear\n Else\n   On Error GoTo 0\n   Res = \"\"\n\n   Do While Not rs.EOF\n     Tmp = \"\"\n\n     For i = 0 To rs.Fields.Count - 1\n       If Not (NoNullFields And IsNull(rs(i))) Then\n         Tmp = Tmp &amp; SepF &amp; rs(i)\n       End If\n     Next\n\n     If Tmp &lt;&gt; \"\" Then\n       Res = Res &amp; SepR &amp; Mid(Tmp, Len(SepF) + 1)\n     End If\n     rs.MoveNext\n   Loop\n\n   If Res &lt;&gt; \"\" Then\n     Res = Mid(Res, Len(SepR) + 1)\n   End If\n End If\n\n If Not rs Is Nothing Then rs.Close: Set rs = Nothing\n\n SQLListe = Res\n\nEnd Function\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1555506134, "post_id": 55727994, "comment_id": 98135199, "body": "Please post the code you have tried."}, {"owner": {"reputation": 1434, "user_id": 5799673, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f1eb668cc8e910aba87ad3d0502d7da0?s=128&d=identicon&r=PG&f=1", "display_name": "ebbishop", "link": "https://stackoverflow.com/users/5799673/ebbishop"}, "edited": false, "score": 0, "creation_date": 1555506188, "post_id": 55727994, "comment_id": 98135242, "body": "What have you tried so far? You say your code doesn&#39;t work, but what exactly happens? Please share your code so we can better understand what&#39;s going on."}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1555507663, "creation_date": 1555507663, "answer_id": 55728675, "question_id": 55727994, "link": "https://stackoverflow.com/questions/55727994/search-worksheet-with-command-button-and-textboxes/55728675#55728675", "title": "Search worksheet with command button and textboxes", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim strSearchValue As String\n    Dim rngPosition As Range\n\n    With ThisWorkbook.Worksheets(\"Sheet1\").UsedRange '&lt;- Change sheet name\n\n        strSearchValue = \"Test\" '&lt;- Change search text\n\n        Set rngPosition = .Find(strSearchValue, LookIn:=xlValues, LookAt:=xlWhole)\n\n        If Not rngPosition Is Nothing Then '&lt;- If search text found\n\n            MsgBox rngPosition.Address '&lt;- Messagew box with the address\n\n        End If\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11373890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6e4b2b353a2b7b9556451b4b2fa024?s=128&d=identicon&r=PG&f=1", "display_name": "Pendramix", "link": "https://stackoverflow.com/users/11373890/pendramix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1555513197, "creation_date": 1555505559, "question_id": 55727994, "link": "https://stackoverflow.com/questions/55727994/search-worksheet-with-command-button-and-textboxes", "title": "Search worksheet with command button and textboxes", "body": "<p>I hope you guys can help me.</p>\n\n<p>my Manager asked me to create in excel a workbook whit a functionality to search on the click of a button. nothing I do works for some reason and would like to see if what she has asked is actually possible?</p>\n\n<p>the idea is that I have 1 textbox where a text is entered, for example 11012587 then the search button is hit and it will search a hidden sheet for this reference. then another textbox will show instructions relating to this reference from that same hidden sheet.</p>\n\n<p>nothing I do works and I have to admit I'm a bit of a noob at this so my codes that I've tried might be completely wrong.</p>\n\n<p>looking forward to your replies :)</p>\n\n<p>thanks a bunch!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 1, "creation_date": 1555531038, "post_id": 55727952, "comment_id": 98148514, "body": "Are you looking for <code>subFold(1).Path</code>? The <code>.Subfolders</code> property returns an array containing all the subfolders in that folder; you&#39;re setting your <code>subFold</code> variable equal to that array."}, {"owner": {"reputation": 161, "user_id": 7416111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/867203559b28816f0a7a5ff95adf2f6c?s=128&d=identicon&r=PG&f=1", "display_name": "mkinson", "link": "https://stackoverflow.com/users/7416111/mkinson"}, "reply_to_user": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1556129207, "post_id": 55727952, "comment_id": 98336552, "body": "@JoshEller I want the variable fzp to be equal to the file path as shown for subfolder.item(1)."}], "owner": {"reputation": 161, "user_id": 7416111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/867203559b28816f0a7a5ff95adf2f6c?s=128&d=identicon&r=PG&f=1", "display_name": "mkinson", "link": "https://stackoverflow.com/users/7416111/mkinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555522808, "creation_date": 1555505427, "last_edit_date": 1555522808, "question_id": 55727952, "link": "https://stackoverflow.com/questions/55727952/excel-vba-assign-folder-path-to-variable", "title": "Excel VBA - Assign Folder Path to Variable", "body": "<p>I am trying to assign a folder path as a string so that I can reference that path later. Below is some of the code that leads up to that folder path.</p>\n\n<pre><code>Dim fzp as String\nDim fPath As String\nDim fso As Object\nDim subFold\n\nfPath = \"I:\\PROJECTS\\\" &amp; ProjNam &amp; \"\\\" &amp; ProjNum\nfso.createfolder (fPath &amp; \"copy\")\nfso.CopyFolder \"S:\\Global\\Specifications\\Proposal Packages\\\" &amp; ProjNum &amp; \"*\", fPath &amp; \"copy\\\"\nWith fso\nSet subFold = .getfolder(fPath &amp; \"copy\")\nSet subFold = subFold.Subfolders\n</code></pre>\n\n<p>Now when I look in the local window I see <code>subFold</code> with <code>Item(1)</code> with a Path of \"I:\\PROJECTS\\Foo\\bar\\Subfoldername\"</p>\n\n<p>I want that entire pathway and so I've tried:</p>\n\n<pre><code>fzp = subFold.Path\nfzp = subFold.Item(1).Path\nfzp = .Item(1).Path\nfzp = .Path\n</code></pre>\n\n<p>and probably 20 different iterations without success.</p>\n\n<p>Any idea how I can assign that folder path to a string value or reference it correctly?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 9499028, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iNi2f0ZmlPE/AAAAAAAAAAI/AAAAAAAAABw/RN90EIHUZfU/photo.jpg?sz=128", "display_name": "BeardedSith", "link": "https://stackoverflow.com/users/9499028/beardedsith"}, "edited": false, "score": 0, "creation_date": 1555597528, "post_id": 55727545, "comment_id": 98173122, "body": "How would I add Reports in that, too?  I tried <code>if Forms.Count = 1 And Reports.Count = 1</code> but nothing happened.  Should it be <code>Or</code>?  I assume <code>Or</code> would cause issues because if there&#39;s a form open but you&#39;re closing a report, then things would go weird."}, {"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "reply_to_user": {"reputation": 121, "user_id": 9499028, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iNi2f0ZmlPE/AAAAAAAAAAI/AAAAAAAAABw/RN90EIHUZfU/photo.jpg?sz=128", "display_name": "BeardedSith", "link": "https://stackoverflow.com/users/9499028/beardedsith"}, "edited": false, "score": 0, "creation_date": 1555597669, "post_id": 55727545, "comment_id": 98173218, "body": "Try <code>If (Forms.Count + Reports.Count) = 1 Then DoCmd.OpenForm &quot;YourMainForm&quot;</code>."}, {"owner": {"reputation": 121, "user_id": 9499028, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iNi2f0ZmlPE/AAAAAAAAAAI/AAAAAAAAABw/RN90EIHUZfU/photo.jpg?sz=128", "display_name": "BeardedSith", "link": "https://stackoverflow.com/users/9499028/beardedsith"}, "edited": false, "score": 0, "creation_date": 1555597969, "post_id": 55727545, "comment_id": 98173411, "body": "Once again you are amazingly fast and dead on.  Thanks a million!"}], "tags": [], "owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "is_accepted": true, "score": 2, "last_activity_date": 1555504051, "last_edit_date": 1555504051, "creation_date": 1555504002, "answer_id": 55727545, "question_id": 55727264, "link": "https://stackoverflow.com/questions/55727264/if-no-forms-are-open-upon-closing-a-form-open-a-specific-form/55727545#55727545", "title": "If no forms are open upon closing a form, open a specific form", "body": "<p>An easy way would be this:</p>\n\n<p>Add this procedure in a standard module and edit the main forms name in there:</p>\n\n<pre><code>Public Function OpenMainFormIfThisIsTheLastForm()\n    If Forms.Count = 1 Then DoCmd.OpenForm \"YourMainForm\"\nEnd Function\n</code></pre>\n\n<p>In each form you want to open the main form before itself closes place this in the <code>On Close</code>-event:</p>\n\n<pre><code>=OpenMainFormIfThisIsTheLastForm()\n</code></pre>\n\n<p>That should be all.</p>\n"}], "owner": {"reputation": 121, "user_id": 9499028, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iNi2f0ZmlPE/AAAAAAAAAAI/AAAAAAAAABw/RN90EIHUZfU/photo.jpg?sz=128", "display_name": "BeardedSith", "link": "https://stackoverflow.com/users/9499028/beardedsith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 55727545, "answer_count": 1, "score": 0, "last_activity_date": 1555504051, "creation_date": 1555502984, "last_edit_date": 1555503729, "question_id": 55727264, "link": "https://stackoverflow.com/questions/55727264/if-no-forms-are-open-upon-closing-a-form-open-a-specific-form", "title": "If no forms are open upon closing a form, open a specific form", "body": "<p>I have a database with multiple little forms spread out across the database (as most are I'd assume, lol).  There are multiple ways to get to multiple different forms, however I ran into a bit of a naviational issue that in certain circumstances, when a user closes a form, nothing else opens or is open.  So I'd ideally like Access to check if any forms are open at any given moment, and if not, then to open a specific form (the databases \"main\" form).  I googled this and couldn't find what I was looking for (possible I google the wrong thing?), so I honestly don't really know where to even start.<br>\n<br>\nI would like to create a function that I execute on Form_Close in order to check if any forms are currently open, and if not, to open a specific form.  Again, I'm not even remotely sure of where to even start looking for this answer, so I don't really have anything to start off my journey.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1555502855, "post_id": 55727124, "comment_id": 98133102, "body": "There might be several reason of such behaviour, for example: another macro which is used to calculate some values. I&#39;d check if <code>Data</code> sheet is active then change the order of sheets. BTW: can you elaborate why <code>Data</code> sheet should be inactive?"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1555504586, "post_id": 55727124, "comment_id": 98134193, "body": "Or why you need Sh to be Active? If you have other code using <code>ActiveSheet</code>, you can replace that in a variety of ways..."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1555504867, "post_id": 55727124, "comment_id": 98134393, "body": "Your code will enter an endless loop - more than 2-3 seconds I&#39;d have thought. You need to disable events before running it."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1555504980, "post_id": 55727124, "comment_id": 98134481, "body": "Btw <code>Worksheets(Sh.Name)</code> is equivalent to <code>sh</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "is_accepted": false, "score": 0, "last_activity_date": 1555505443, "last_edit_date": 1555505443, "creation_date": 1555504620, "answer_id": 55727736, "question_id": 55727124, "link": "https://stackoverflow.com/questions/55727124/vba-moving-specific-worksheet-before-after-selected-worksheet-takes-too-long/55727736#55727736", "title": "VBA moving specific worksheet before/ after selected worksheet takes too long - why?", "body": "<p>This happens because of recursive calling: when you use <code>.Activate</code>, then your <code>Sub</code> <code>Workbook_SheetActivate</code> is called again and you're stuck in an endless loop. </p>\n\n<p>If you simply want to <strong>deselect</strong> the data range, you can use <code>Cells(1,1).Select</code> and you can directly use <code>Sh</code> instead of using <code>Worksheets(Sh.Name)</code>, since they're equivalent.</p>\n\n<p>So your final code would be:</p>\n\n<pre><code>Sub Workbook_SheetActivate(ByVal Sh As Object)\n   Worksheets(\"Data\").Move After:=Sh\n   Cells(1,1).Select\nEnd Sub\n</code></pre>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1555507721, "creation_date": 1555507721, "answer_id": 55728689, "question_id": 55727124, "link": "https://stackoverflow.com/questions/55727124/vba-moving-specific-worksheet-before-after-selected-worksheet-takes-too-long/55728689#55728689", "title": "VBA moving specific worksheet before/ after selected worksheet takes too long - why?", "body": "<p>This should be quicker:</p>\n\n<pre><code>Sub Workbook_SheetActivate(ByVal Sh As Object)\n    Dim nam As String\n\n    nam = Sh.Name\n    Application.EnableEvents = False\n        Worksheets(\"Data\").Move After:=Worksheets(nam)\n        Worksheets(nam).Activate\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 8920780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4121284e1fc40aea4e4d2fb61fb924bf?s=128&d=identicon&r=PG&f=1", "display_name": "Damian Costello", "link": "https://stackoverflow.com/users/8920780/damian-costello"}, "is_accepted": false, "score": 0, "last_activity_date": 1556103778, "creation_date": 1556103778, "answer_id": 55828560, "question_id": 55727124, "link": "https://stackoverflow.com/questions/55727124/vba-moving-specific-worksheet-before-after-selected-worksheet-takes-too-long/55828560#55828560", "title": "VBA moving specific worksheet before/ after selected worksheet takes too long - why?", "body": "<p>Thanks for your input guys. Turning off/on events helped to get out of the loop.</p>\n\n<pre><code>    Application.EnableEvents = False\n    Worksheets(\"Data\").Move After:=Sh\n    sh.Activate\n    Application.EnableEvents = True\n</code></pre>\n\n<p>I should have probably explained what the code was being used for in my question.</p>\n\n<p>The user had 50+ Worksheets in the Workbook (please don't ask me why :)). They had one in particular (\"Data\") they wanted to be able to click in and out whilst working with other worksheets. So this code was simply causing the Worksheet \"Data\" to \"follow them\" </p>\n\n<p>The line:</p>\n\n<pre><code>sh.Activate\n</code></pre>\n\n<p>Was used to get back to the Worksheet they have just clicked on as otherwise they were getting stuck on \"Data\" Worksheet. </p>\n"}], "owner": {"reputation": 3, "user_id": 8920780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4121284e1fc40aea4e4d2fb61fb924bf?s=128&d=identicon&r=PG&f=1", "display_name": "Damian Costello", "link": "https://stackoverflow.com/users/8920780/damian-costello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 1, "accepted_answer_id": 55728689, "answer_count": 3, "score": 0, "last_activity_date": 1556103778, "creation_date": 1555502447, "question_id": 55727124, "link": "https://stackoverflow.com/questions/55727124/vba-moving-specific-worksheet-before-after-selected-worksheet-takes-too-long", "title": "VBA moving specific worksheet before/ after selected worksheet takes too long - why?", "body": "<p>I have simple code which is moving worksheet \"Data\" to after activated worksheet.</p>\n\n<pre><code>Sub Workbook_SheetActivate(ByVal Sh As Object)\n  Worksheets(\"Data\").Move After:=Worksheets(Sh.Name)\n  Worksheets(Sh.Name).Activate\nEnd Sub\n</code></pre>\n\n<p>I am using</p>\n\n<pre><code>Worksheets(Sh.Name).Activate\n</code></pre>\n\n<p>because without this line worksheet \"Data\" remains selected after the move which is not the intention. </p>\n\n<p>The problem I have is when this code is run it takes about 2-3 seconds for excel to think about it before seeing result. </p>\n\n<p>I don't understand why. Without chaining these 2 operations together it takes milliseconds. Could someone please explain how to improve this and why is this happening?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1555504434, "post_id": 55727001, "comment_id": 98134082, "body": "Wouldn&#39;t a nested IF-statement work for that?"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1555504823, "post_id": 55727001, "comment_id": 98134370, "body": "Welcome to Stack Overflow! It is not clear (to me?) what you are asking. Can you make a shorter example to let us understand what you need?"}, {"owner": {"reputation": 167, "user_id": 9639219, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGPTz.jpg?s=128&g=1", "display_name": "SpaghettiCode", "link": "https://stackoverflow.com/users/9639219/spaghetticode"}, "edited": false, "score": 0, "creation_date": 1555506755, "post_id": 55727001, "comment_id": 98135628, "body": "It is possible with nested <code>IF</code> but we are so confused with your formula because there&#39;s only one statement as opposed to two, which you were saying. Also, there&#39;s a flaw with your formula that you didn&#39;t close the <code>IF</code> statement with <code>)</code>."}, {"owner": {"reputation": 1, "user_id": 9271391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70548925f386dabdc3c74c70948ad65?s=128&d=identicon&r=PG&f=1", "display_name": "domaska", "link": "https://stackoverflow.com/users/9271391/domaska"}, "edited": false, "score": 0, "creation_date": 1555508120, "post_id": 55727001, "comment_id": 98136563, "body": "Ha, will try to simplify it. <code>IF(</code>A1=1<code>;</code>(<code>A3+A4</code>)<code>+</code>(<code>A5+A6</code>)``;<code>&quot;&quot;</code>). Imagine only value for A3 is missing, despite that, I&#39;m fine with seeing result from (A4)+(A5+A6). With current setup, if (A3 is missign) it returns NA"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1555508405, "post_id": 55727001, "comment_id": 98136725, "body": "<i>if (A3 is missign) it returns NA</i> what do you mean with <i>missing</i>? If <code>A3</code> is empty, it will return 0, so the calculation would be <code>0+A4+A5+A6</code>"}, {"owner": {"reputation": 1, "user_id": 9271391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70548925f386dabdc3c74c70948ad65?s=128&d=identicon&r=PG&f=1", "display_name": "domaska", "link": "https://stackoverflow.com/users/9271391/domaska"}, "edited": false, "score": 0, "creation_date": 1555509238, "post_id": 55727001, "comment_id": 98137298, "body": "As you can see, actual formula is more complex. In my case A3 is returned as N/A. Which leads to the additon of N/A + (A5+A6). tThat&#39;s my question, is it possible to exclude (A3+A4) in case it is beeing returned as N/A"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1555510756, "post_id": 55727001, "comment_id": 98138352, "body": "<a href=\"https://support.office.com/en-us/article/IFERROR-function-C526FD07-CAEB-47B8-8BB6-63F3E417F611\" rel=\"nofollow noreferrer\"><code>IFERROR</code></a>? BTW, it is usually better to <a href=\"https://stackoverflow.com/posts/55727001/edit\">edit your question</a> instead of adding a lot of hard to parse information in comments"}], "owner": {"reputation": 1, "user_id": 9271391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70548925f386dabdc3c74c70948ad65?s=128&d=identicon&r=PG&f=1", "display_name": "domaska", "link": "https://stackoverflow.com/users/9271391/domaska"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556022916, "creation_date": 1555502027, "last_edit_date": 1556022916, "question_id": 55727001, "link": "https://stackoverflow.com/questions/55727001/how-to-show-only-one-of-two-conditions-in-if-statement-conditions-separated-by", "title": "How to show only one of two conditions in IF statement (conditions separated by + )", "body": "<p>I have two conditions under <code>True</code> statement in <code>IF</code>. It only works if both conditions are met. Is it possible to dismiss one of the conditions (the one not being procced) and show only good one if other doesn't return a value. </p>\n\n<pre><code>IF($C$12=\"BB\";\n(INDEX(PARMSETS!$AF$3:$AF$1796;MATCH(1;INDEX(($M11=PARMSETS!$AD$3:$AD$3333)*\n(N$9=PARMSETS!$AE$3:$AE$3333););0))+\n(INDEX(PARMSETS!$AF$3:$AF$1796;MATCH(1;INDEX(($M11=PARMSETS!$AD$3:$AD$3333)*\n(\"M_F_S\"=PARMSETS!$AB$3:$AB$3333););0))))\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 2, "creation_date": 1555499711, "post_id": 55726272, "comment_id": 98131236, "body": "What have you already tried?  You need to show what efforts you have made to solve the problem, and why it&#39;s not working - have a read of <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 188, "user_id": 6214125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e372417cca8523e3075b543095e0cc9a?s=128&d=identicon&r=PG", "display_name": "MauroAlmeida", "link": "https://stackoverflow.com/users/6214125/mauroalmeida"}, "is_accepted": false, "score": -1, "last_activity_date": 1555500694, "creation_date": 1555500694, "answer_id": 55726586, "question_id": 55726272, "link": "https://stackoverflow.com/questions/55726272/checking-if-a-column-exists-in-a-sheet-and-if-exists-copies-data-to-another-shee/55726586#55726586", "title": "Checking if a column exists in a sheet and if exists copies data to another sheet", "body": "<p>I searched and found this link <a href=\"https://www.excel-easy.com/vba/workbook-worksheet-object.html\" rel=\"nofollow noreferrer\">https://www.excel-easy.com/vba/workbook-worksheet-object.html</a></p>\n\n<p>You can refer to a member of the collection, for example, a single Worksheet object, in three ways.</p>\n\n<blockquote>\n  <ol>\n  <li>Using the worksheet name.</li>\n  </ol>\n  \n  <p>Worksheets(\"Sales\").Range(\"A1\").Value = \"Hello\"</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>Using the index number (1 is the first worksheet starting from the left).</li>\n  </ol>\n  \n  <p>Worksheets(1).Range(\"A1\").Value = \"Hello\"</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>Using the CodeName.</li>\n  </ol>\n  \n  <p>Sheet1.Range(\"A1\").Value = \"Hello\"</p>\n</blockquote>\n\n<p>For counting empty columns I found <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.counta\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.counta</a></p>\n\n<blockquote>\n  <p>Example to check if column D is empty</p>\n  \n  <p>IIf(WorksheetFunction.CountA(Columns(\"D\")) = 0</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>To copy data I found\n  <a href=\"https://analysistabs.com/excel-vba/copy-data-from-one-worksheet-to-another/\" rel=\"nofollow noreferrer\">https://analysistabs.com/excel-vba/copy-data-from-one-worksheet-to-another/</a></p>\n</blockquote>\n\n<p>Try something and then update your question if you have doubts.</p>\n"}], "owner": {"reputation": 1, "user_id": 11373453, "user_type": "registered", "profile_image": "https://graph.facebook.com/2861850260522142/picture?type=large", "display_name": "Aashlesha Potdukhe", "link": "https://stackoverflow.com/users/11373453/aashlesha-potdukhe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1556022912, "creation_date": 1555499645, "last_edit_date": 1556022912, "question_id": 55726272, "link": "https://stackoverflow.com/questions/55726272/checking-if-a-column-exists-in-a-sheet-and-if-exists-copies-data-to-another-shee", "title": "Checking if a column exists in a sheet and if exists copies data to another sheet", "body": "<p>I need help with the vba code to check if a column exists in a particular sheet, and if it exists paste the column contents to another sheet, if it doesn't exist print 0 in another sheet</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 1, "creation_date": 1555499590, "post_id": 55726149, "comment_id": 98131165, "body": "A screenshot would be beneficial."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1555499730, "post_id": 55726149, "comment_id": 98131250, "body": "What have you tried so far?  This looks very much like you just need a loop running down, check the start of each Value, and save some text to variables?"}, {"owner": {"reputation": 1, "user_id": 11373279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b94340341f82ebcee8511e69af53b37?s=128&d=identicon&r=PG&f=1", "display_name": "meredianblues", "link": "https://stackoverflow.com/users/11373279/meredianblues"}, "edited": false, "score": 0, "creation_date": 1555500021, "post_id": 55726149, "comment_id": 98131428, "body": "Thanks for the update Chronocidal !! I am new to excel vba and macros. It would be great can you provide a macro code."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1555501011, "post_id": 55726149, "comment_id": 98132039, "body": "It looks like your want the <code>State</code> information ignored in the output.  <b>Is this correct ??</b>"}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1555503181, "creation_date": 1555503181, "answer_id": 55727321, "question_id": 55726149, "link": "https://stackoverflow.com/questions/55726149/data-separation-from-single-column-multiple-columns/55727321#55727321", "title": "Data separation from single column multiple columns", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastRowA As Long, LastRowC As Long, i As Long, y As Long\n    Dim strCountry As String\n\n    With ThisWorkbook.Worksheets(\"Sheet2\")\n\n        LastRowA = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        For i = 1 To LastRowA Step 10\n\n            strCountry = Mid(.Range(\"A\" &amp; i).Value, InStr(1, .Range(\"A\" &amp; i).Value, \":\") + 2, Len(.Range(\"A\" &amp; i).Value) - (InStr(1, .Range(\"A\" &amp; i).Value, \":\") + 1))\n\n            For y = 2 To LastRowA Step 2\n\n                LastRowC = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n\n                If .Range(\"A\" &amp; y).Value &lt;&gt; \"\" Then\n                    .Range(\"C\" &amp; LastRowC + 1).Value = strCountry\n                    .Range(\"D\" &amp; LastRowC + 1).Value = \"Object\" &amp; Mid(.Range(\"A\" &amp; y).Value, InStr(1, .Range(\"A\" &amp; y).Value, \"te\") + 2, Len(.Range(\"A\" &amp; y).Value) - (InStr(1, .Range(\"A\" &amp; y).Value, \"te\") + 1))\n                    .Range(\"E\" &amp; LastRowC + 1).Value = Mid(.Range(\"A\" &amp; y + 1).Value, InStr(1, .Range(\"A\" &amp; y + 1).Value, \":\") + 2, Len(.Range(\"A\" &amp; y + 1).Value) - (InStr(1, .Range(\"A\" &amp; y + 1).Value, \":\") + 1))\n                Else\n                    Exit For\n                End If\n\n            Next y\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Image:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/nW8BA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nW8BA.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 11373279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b94340341f82ebcee8511e69af53b37?s=128&d=identicon&r=PG&f=1", "display_name": "meredianblues", "link": "https://stackoverflow.com/users/11373279/meredianblues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1555521951, "creation_date": 1555499260, "last_edit_date": 1555521951, "question_id": 55726149, "link": "https://stackoverflow.com/questions/55726149/data-separation-from-single-column-multiple-columns", "title": "Data separation from single column multiple columns", "body": "<p>I have data in single column like different sets:</p>\n\n<p><strong>Original data</strong></p>\n\n<pre><code>Class: Country1\nObject: State1\nDescription: DEsc1\nObject: State2\nDescription: DEsc2\nObject: State3\nDescription: DEsc3\nObject: State4\nDescription: DEsc4\n\nClass: Country2\nObject: State1\nDescription: DEsc1\nObject: State2\nDescription: DEsc2\nObject: State3\nDescription: DEsc3\nObject: State4\nDescription: DEsc4\n\nClass: Country3\nObject: State1\nDescription: DEsc1\nObject: State2\nDescription: DEsc2\nObject: State3\nDescription: DEsc3\nObject: State4\nDescription: DEsc4\n\nClass: Country4\nObject: State1\nDescription: DEsc1\nObject: State2\nDescription: DEsc2\nObject: State3\nDescription: DEsc3\nObject: State4\nDescription: DEsc4\n</code></pre>\n\n<pre><code>\n\n\nI am looking for Excel VBA macro code , which will clean and organize my data.\n\n**Expected Data**\n</code></pre>\n\n<pre><code>Class       Object    Description &lt;br/&gt;\n----------------------------------\nCountry1    State1    DEsc1\nCountry1    State2    DEsc2\nCountry1    State3    DEsc3\nCountry1    State4    DEsc4\nCountry2    State1    DEsc1\nCountry2    State2    DEsc2\nCountry2    State3    DEsc3\nCountry2    State4    DEsc4\nCountry3    State1    DEsc1\nCountry3    State2    DEsc2\nCountry3    State3    DEsc3\nCountry3    State4    DEsc4\nCountry4    State1    DEsc1\nCountry4    State2    DEsc2\nCountry4    State3    DEsc3\nCountry4    State4    DEsc4\n</code></pre>\n\n<pre><code>\nThanks In Advance!!\nKP\n\n[Please find the attached image]\n\n[1]: https://i.stack.imgur.com/otSV1.jpg\n\n\n</code></pre>\n"}, {"tags": ["vba", "hyperlink", "powerpoint"], "comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1555663889, "post_id": 55724877, "comment_id": 98193354, "body": "You mix two different things: a) Hyperlinks to other slides or URLs (=ActionSetting) and b) images which are not embedded but linked (=linked object). As you mentioned links to slides, I wrote a long answer for that."}], "answers": [{"tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": true, "score": 1, "last_activity_date": 1555680825, "last_edit_date": 1592644375, "creation_date": 1555591867, "answer_id": 55746456, "question_id": 55724877, "link": "https://stackoverflow.com/questions/55724877/how-to-obtain-shapes-to-hyperlinks-in-powerpoint-vba/55746456#55746456", "title": "How to obtain shapes to hyperlinks in PowerPoint VBA", "body": "<h2>Hyperlink Locations and Types</h2>\n<p>Hyperlinks can be assigned</p>\n<ul>\n<li>to the shape itself</li>\n<li>to the shape's textframe</li>\n<li>to individual characters (even multiple within one text)</li>\n</ul>\n<p>They can be assigned either as <code>ActionSettings(ppMouseClick).Hyperlink</code> or <code>ActionSettings(ppMouseOver).Hyperlink</code>.</p>\n<p>Their <code>Hyperlink.Type</code> is either <code>msoHyperlinkShape</code> (on shape) or <code>msoHyperlinkRange</code> (on textframe or character).</p>\n<hr />\n<h2>Loop over all Hyperlinks and get corresponding Shape</h2>\n<p>You can loop over all hyperlinks of a slide and get their shape within the parent structure, depending on the hyperlink type:</p>\n<pre><code>Private Sub GetShapeOfEachHyperLink()\n    Dim pptSlide As Slide\n    Dim pptHyperlink As Hyperlink\n    Dim pptShape As Shape\n    \n    For Each pptSlide In ActivePresentation.Slides\n        For Each pptHyperlink In pptSlide.Hyperlinks\n            Select Case pptHyperlink.Type\n            Case msoHyperlinkShape\n                Set pptShape = pptHyperlink.Parent.Parent\n            Case msoHyperlinkRange\n                Set pptShape = pptHyperlink.Parent.Parent.Parent.Parent\n            End Select\n        Next pptHyperlink\n    Next pptSlide\nEnd Sub\n</code></pre>\n<hr />\n<h2>Loop over all Shapes and get correspondig Hyperlink(s)</h2>\n<p>The other way round is a bit more complicated:</p>\n<pre><code>Private Sub GetHyperlinkOfEachShape()\n    Dim pptSlide As Slide\n    Dim pptShape As Shape\n    Dim pptActionSetting As ActionSetting\n    Dim pptHyperlink As Hyperlink\n    Dim pptMouseActivation As Variant\n    Dim strURL As String\n    Dim i As Integer\n        \n    For Each pptSlide In ActivePresentation.Slides\n        For Each pptShape In pptSlide.Shapes\n            \n            ' Hyperlink assigned to shape:\n            For Each pptActionSetting In pptShape.ActionSettings\n                If pptActionSetting.Action = ppActionHyperlink Then\n                    Set pptHyperlink = pptActionSetting.Hyperlink\n                    strURL = pptHyperlink.Address: Debug.Print strURL\n                End If\n            Next pptActionSetting\n\n            ' Hyperlinks assigned to text or text parts:\n            If pptShape.TextFrame.HasText Then\n                For Each pptMouseActivation In Array(ppMouseClick, ppMouseOver)\n                    Set pptActionSetting = pptShape.TextFrame.TextRange.ActionSettings(pptMouseActivation)\n                    If pptActionSetting.Action = ppActionHyperlink Then\n                        Set pptHyperlink = pptActionSetting.Hyperlink\n                        strURL = pptHyperlink.Address: Debug.Print strURL\n                    Else\n                        strURL = &quot;&quot;\n                        For i = 1 To pptShape.TextFrame.TextRange.Characters.Count\n                            Set pptActionSetting = pptShape.TextFrame.TextRange.Characters(i).ActionSettings(pptMouseActivation)\n                            If pptActionSetting.Action = ppActionHyperlink Then\n                                If strURL &lt;&gt; pptActionSetting.Hyperlink.Address Then\n                                    Set pptHyperlink = pptActionSetting.Hyperlink\n                                    strURL = pptHyperlink.Address: Debug.Print strURL\n                                End If\n                            End If\n                        Next i\n                    End If\n                Next pptMouseActivation\n            End If\n        \n        Next pptShape\n    Next pptSlide\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11372714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dab543967880bb9232eea1b1c400c41?s=128&d=identicon&r=PG&f=1", "display_name": "lennytubby", "link": "https://stackoverflow.com/users/11372714/lennytubby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 558, "favorite_count": 0, "accepted_answer_id": 55746456, "answer_count": 1, "score": 2, "last_activity_date": 1555680825, "creation_date": 1555495010, "last_edit_date": 1555663384, "question_id": 55724877, "link": "https://stackoverflow.com/questions/55724877/how-to-obtain-shapes-to-hyperlinks-in-powerpoint-vba", "title": "How to obtain shapes to hyperlinks in PowerPoint VBA", "body": "<p>I want to obtain the shapes carring a hyperlink in PowerPoint.</p>\n\n<p>I will display the powerpoint as pdf with pdf.js and need an overlay html with the right sized shapes over the rendered pdf to attach the hyperlinks to. </p>\n\n<p>But if I try to use the <code>LinkFormat.SourceFullName</code> method, it throws the error</p>\n\n<blockquote>\n  <p>Invalid Request</p>\n</blockquote>\n\n<p>I have tested it with definitely linked images and shapes. Also somehow the Type of my linked shapes are autoShapeTypes.</p>\n\n<p>I use Office 356. I am mainly interested in links to slides inside the presentation. I can access them by pptSlide.Hyperlinks(i) and its SubAddress, but how would I get the referring shape to that link?</p>\n\n<p>Any Ideas why the shapes would not show up as Linked Object and how I would be able to get the links from the shapes?</p>\n\n<pre><code>Dim pptPresentation As Presentation\nDim pptSlide As Slide\nDim pptShape As Shape\nDim i As Integer\ndim linkstring as String\n\nDim hl As Hyperlink\n\n'Set the variable to the PowerPoint Presentation\nSet pptPresentation = ActivePresentation\n\n'Loop through each slide in the presentation\nFor Each pptSlide In pptPresentation.Slides\n\n    'Loop through each shape in each slide\n\n    For Each pptShape In pptSlide.Shapes\n        'Find out if the shape is a linked object or a linked picture\n        If pptShape.Type = msoLinkedPicture Or pptShape.Type _\n        = msoLinkedOLEObject Or pptShape.Type = msoLinked3DModel Then\n        'won't make it into the loop, ad Or 1 for AutoShapeTyps\n            linkstring = pptShape.LinkFormat.SourceFullName\n\n            oFile.WriteLine \"link:\" &amp; linkstring &amp; vbNewLine &amp; _\n                                \"height:\" &amp; pptShape.Height &amp; vbNewLine &amp; _\n                                \"width:\" &amp; pptShape.Width &amp; vbNewLine &amp; _\n                                \"pos-left\" &amp; pptShape.Left &amp; vbNewLine &amp; _\n                                \"pos-top \" &amp; pptShape.Top &amp; vbNewLine &amp; _\n                                vbNewLine\n\n        End If\n    Next\n Next\n\n'test to see if vba finds any links at all\nFor Each hl In ActivePresentation.Slides(1).Hyperlinks\n   linkstring = hl.Address\n   linkstring = hl.SubAddress\n   linkstring = hl.Application\n   linkstring = hl.Type\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba", "listbox"], "comments": [{"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1555496071, "post_id": 55724693, "comment_id": 98129169, "body": "hi. whats the value of X and lbx_Filters.List(X) when it throws the error ?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1555504562, "post_id": 55724693, "comment_id": 98134169, "body": "Take a look at the <a href=\"https://stackoverflow.com/questions/39129572/vba-removing-listbox-duplicates\">SO Question</a>"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1555508275, "post_id": 55724693, "comment_id": 98136639, "body": "@LuisCurado thank you for the reply. I am only now getting back to this problem. <code>x=1</code>at the time of execution and I cannot get a value for <code>lbx_Filters.List(X)</code>as that is throwing the error."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1555508515, "post_id": 55724693, "comment_id": 98136788, "body": "@GMalc Thank you for the reply and the link. I had come across this post, but the problem is that with this, the &quot;list&quot; needs to be completed already. What is going to happen is that the user will add the items from the first list box to the second and then might decide to remove one again. So as far as I can tell, the solution provided relies on a completed list/collection/array rather than dynamically updating as we go along."}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1555510287, "post_id": 55724693, "comment_id": 98138009, "body": "can u check the length of  lbx_Filters  before the error. u can create a var with the value of lbx_Filters.ListCount"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1555510524, "post_id": 55724693, "comment_id": 98138164, "body": "the problem is here For X = 0 To lbx_Filters.ListCount. supose that u have 2 itens. listcount will show 2, but when u try to get lbx_Filters.List(2) it breaks... because the array starts at position 0 and stops at position 1... just replace   For X = 0 To lbx_Filters.ListCount to  For X = 0 To lbx_Filters.ListCount - 1. Good luck"}], "answers": [{"tags": [], "owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "is_accepted": false, "score": 0, "last_activity_date": 1556553188, "creation_date": 1556553188, "answer_id": 55906861, "question_id": 55724693, "link": "https://stackoverflow.com/questions/55724693/vba-excel-listbox-look-for-duplicates-when-adding-items-to-second-listbox/55906861#55906861", "title": "VBA - Excel Listbox - Look for Duplicates when Adding Items to Second Listbox", "body": "<p>I eventually (with the help of the comments above) solved the issue. Thank you to all who assisted.</p>\n\n<pre><code>Private Sub btn_Add_Filter_Click()\n\n    Dim Size As Integer\n    Size = lbx_Filters.ListCount\n    Dim ListBoxContents() As String\n    Dim ListBoxC() As Variant\n\n    Dim i As Integer, y As Integer, X As Integer, myVal As Integer, lItem As Integer\n\n    myVal = 0\n\n    For i = 0 To lbx_Filters_List.ListCount - 1\n\n        If lbx_Filters_List.Selected(i) = True Then\n\n            If Size &gt; 0 Then\n\n                For lItem = 0 To lbx_Filters.ListCount - 1\n\n                    For X = 0 To lbx_Filters_List.ListCount - 1\n\n                        If Not IsError(lbx_Filters_List.List(X)) And lbx_Filters.List(lItem) = lbx_Filters_List.List(i) Then\n\n                            myVal = 1\n\n                        End If\n\n                    Next X\n\n                Next lItem\n\n            End If\n\n            If myVal = 0 Then\n\n                lbx_Filters.AddItem _\n                lbx_Filters_List.List(i)\n\n            End If\n\n        End If\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556553188, "creation_date": 1555494438, "last_edit_date": 1555522086, "question_id": 55724693, "link": "https://stackoverflow.com/questions/55724693/vba-excel-listbox-look-for-duplicates-when-adding-items-to-second-listbox", "title": "VBA - Excel Listbox - Look for Duplicates when Adding Items to Second Listbox", "body": "<p>So I am new to the forms side of the VBA coding and I seem to be struggling a bit with this one.</p>\n\n<p>What I have did was follow this tutorial: </p>\n\n<p><a href=\"https://www.excel-easy.com/vba/examples/multiple-list-box-selections.html\" rel=\"nofollow noreferrer\">https://www.excel-easy.com/vba/examples/multiple-list-box-selections.html</a></p>\n\n<p>And I have adapted it in a way that suits my needs, but now I am having an issue or two that I do not understand how I can resolve.</p>\n\n<p>The code in the tutorial adds two list boxes to a form and then the add button copy items from the first listbox to the second and the remove button removes items from the second listbox.</p>\n\n<p>The problem is that you can add a specific item more than once, and considering I would like to use the values in the second listbox, this is a problem as I need only unique values.</p>\n\n<p>The code below is what I have come up with so far, but I am getting an error:</p>\n\n<pre><code>Private Sub btn_Add_Filter_Click()\n\n    For i = 0 To lbx_Filters_List.ListCount - 1\n\n        If lbx_Filters_List.Selected(i) = True Then\n\n            For X = 0 To lbx_Filters.ListCount\n\n                If Not IsError(lbx_Filters.List(X)) Then\n\n                    mVal = 0\n\n                    If lbx_Filters.List(X) &lt;&gt; \"\" And lbx_Filters.List(X) = lbx_Filters_List.List(i) Then\n\n                        myVal = 1\n\n                    End If\n\n                End If\n\n                 If myVal = 0 Then\n\n                    lbx_Filters.AddItem _\n                    lbx_Filters_List.List(i)\n\n                 End If\n\n            Next X\n\n        End If\n\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>The error occurs the second time I try and add the same item from the first listbox and what happens is that the second for loop will loop once and on the second loop it throws an error on this line:</p>\n\n<pre><code>If Not IsError(lbx_Filters.List(X)) Then\n</code></pre>\n\n<p>Error being:</p>\n\n<blockquote>\n  <p>Could not get the list property. Invalid property array index</p>\n</blockquote>\n"}, {"tags": ["excel", "vba", "sap"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1555494196, "post_id": 55724488, "comment_id": 98127996, "body": "I think we need a bit more information to be able to help with this"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1555494252, "post_id": 55724488, "comment_id": 98128039, "body": "Is this the Excel that\u2019s embedded in an ALV list or some other connected SAP source? You\u2019re showing SAPGui but but how is that interacting with Excel?"}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 11344673, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216261593190240/picture?type=large", "display_name": "Sergey Belousov", "link": "https://stackoverflow.com/users/11344673/sergey-belousov"}, "is_accepted": false, "score": 0, "last_activity_date": 1555494584, "creation_date": 1555494584, "answer_id": 55724746, "question_id": 55724488, "link": "https://stackoverflow.com/questions/55724488/how-to-get-user-id-from-an-open-sap-session/55724746#55724746", "title": "How to get user ID from an open SAP session?", "body": "<p>This proved to be easy:</p>\n\n<pre><code>Sub Getuser()\n\n\n\nDim SapGuiAuto\nDim SetApp\nDim Connection\nDim Session\n\n\n\nSet SapGuiAuto = GetObject(\"SAPGUI\")\nSet SetApp = SapGuiAuto.GetScriptingEngine\nSet Connection = SetApp.Children(0)\nSet Session = Connection.Children(0)\n\nSession.FindById(\"wnd[0]\").Maximize\nSession.FindById(\"wnd[0]/mbar/menu[4]/menu[11]\").Select\n\nMsgBox Session.FindById(\"wnd[1]/usr/txtSYST-UNAME\").Text\nSession.FindById(\"wnd[1]/tbar[0]/btn[0]\").Press\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 14243880, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZkbTOUIIQkE/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmOQazVlfNVMtw1vq8DSy0wPHkb5g/photo.jpg?sz=128", "display_name": "Jesus Perez", "link": "https://stackoverflow.com/users/14243880/jesus-perez"}, "is_accepted": true, "score": 0, "last_activity_date": 1599595363, "creation_date": 1599595363, "answer_id": 63800829, "question_id": 55724488, "link": "https://stackoverflow.com/questions/55724488/how-to-get-user-id-from-an-open-sap-session/63800829#63800829", "title": "How to get user ID from an open SAP session?", "body": "<p>Even easier would be:</p>\n<pre><code>UserId = Session.Info.User\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 11344673, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216261593190240/picture?type=large", "display_name": "Sergey Belousov", "link": "https://stackoverflow.com/users/11344673/sergey-belousov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 502, "favorite_count": 0, "accepted_answer_id": 63800829, "answer_count": 2, "score": 0, "last_activity_date": 1599595363, "creation_date": 1555493878, "last_edit_date": 1555495962, "question_id": 55724488, "link": "https://stackoverflow.com/questions/55724488/how-to-get-user-id-from-an-open-sap-session", "title": "How to get user ID from an open SAP session?", "body": "<p>I need to get the user ID into VBA code.</p>\n\n<p>Like on the picture:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8L7Nl.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8L7Nl.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I tried  </p>\n\n<pre><code>UserId = Session.FindById(\"wnd[0]\").User\n</code></pre>\n\n<p>But it failed. What's the right way?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1555493880, "post_id": 55724377, "comment_id": 98127804, "body": "What kind of error?"}, {"owner": {"reputation": 23, "user_id": 11154724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc8a3e899477ea732fd793c04a9c2e4?s=128&d=identicon&r=PG&f=1", "display_name": "timp95", "link": "https://stackoverflow.com/users/11154724/timp95"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1555494363, "post_id": 55724377, "comment_id": 98128122, "body": "Oh right my bad, &quot;Run-time error 438: Object doesn&#39;t support this property or method&quot;"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1555494457, "post_id": 55724377, "comment_id": 98128191, "body": "and line that causes the error is <code>dia.Shapes.SelectAll</code>?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1555495359, "post_id": 55724377, "comment_id": 98128762, "body": "@timp95 Which line gives the error?  I <i>assume</i> that <code>dia</code> is a Worksheet - but you might want to include slightly more of the <code>CreateDiagram</code> code, so that this becomes a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 23, "user_id": 11154724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc8a3e899477ea732fd793c04a9c2e4?s=128&d=identicon&r=PG&f=1", "display_name": "timp95", "link": "https://stackoverflow.com/users/11154724/timp95"}, "edited": false, "score": 0, "creation_date": 1555499545, "post_id": 55724377, "comment_id": 98131141, "body": "the lines causing an error are  <code>Selection.ShapeRange.TextFrame2.TextRange.ParagraphFormat.Al&zwnj;&#8203;ignment = msoAlignCenter</code> <code>Selection.ShapeRange.TextFrame2.VerticalAnchor = msoAnchorMiddle</code>   Dia is indeed a worksheet. I edited my original post accordingly"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1555506957, "post_id": 55724377, "comment_id": 98135752, "body": "Is <code>Sheets(&quot;Diagram&quot;)</code> the ActiveSheet when the error <b>does not</b> raise? <code>Selection</code> returns the ActiveObject selected (cell, shape, etc.), <b>on the active sheet</b> <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.selection\" rel=\"nofollow noreferrer\">Application.Selection property (Excel)</a> so I think you need to activate <code>ThisWorkbook.Sheets(&quot;Diagram&quot;)</code> before line <code>dia.Shapes.SelectAll</code>"}, {"owner": {"reputation": 23, "user_id": 11154724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc8a3e899477ea732fd793c04a9c2e4?s=128&d=identicon&r=PG&f=1", "display_name": "timp95", "link": "https://stackoverflow.com/users/11154724/timp95"}, "edited": false, "score": 0, "creation_date": 1555511175, "post_id": 55724377, "comment_id": 98138616, "body": "Yep, activating the worksheet did the trick. Thank you so much! :)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11154724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc8a3e899477ea732fd793c04a9c2e4?s=128&d=identicon&r=PG&f=1", "display_name": "timp95", "link": "https://stackoverflow.com/users/11154724/timp95"}, "edited": false, "score": 0, "creation_date": 1555499303, "post_id": 55724891, "comment_id": 98130996, "body": "They aren&#39;t previously grouped and if try to ungroup them it produces an error on it&#39;s own. As I said, running the code on it&#39;s own works just fine, it only produces an error if I try to run it from another module"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 23, "user_id": 11154724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc8a3e899477ea732fd793c04a9c2e4?s=128&d=identicon&r=PG&f=1", "display_name": "timp95", "link": "https://stackoverflow.com/users/11154724/timp95"}, "edited": false, "score": 0, "creation_date": 1555500862, "post_id": 55724891, "comment_id": 98131943, "body": "@timp95 Well that&#39;s odd.. It works fine for me regardless where I&#39;m calling it from. Are you sure there are more than one shapes in your worksheet? When you say &quot;from another module&quot; you mean from another <code>sub</code> or an actual <code>module</code>? Because when you&#39;re calling subs across modules you should call them like : <code>call module1.CreateDiagram</code>"}, {"owner": {"reputation": 23, "user_id": 11154724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc8a3e899477ea732fd793c04a9c2e4?s=128&d=identicon&r=PG&f=1", "display_name": "timp95", "link": "https://stackoverflow.com/users/11154724/timp95"}, "edited": false, "score": 0, "creation_date": 1555501240, "post_id": 55724891, "comment_id": 98132156, "body": "Yep, there are more than one shape and I think the alignment lines are the problem rather than the grouping. I&#39;m calling it from a sub in another model another module."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 23, "user_id": 11154724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc8a3e899477ea732fd793c04a9c2e4?s=128&d=identicon&r=PG&f=1", "display_name": "timp95", "link": "https://stackoverflow.com/users/11154724/timp95"}, "edited": false, "score": 0, "creation_date": 1555503337, "post_id": 55724891, "comment_id": 98133405, "body": "@timp95 So, to test the sub, you first run it and then, if you want to run it for a second time, you first ungroup the shapes manually and then run it again? I suggest you post the rest of the code, because other than what I said in my answer, I don&#39;t see anything wrong with it. As I said, I am currently running this very code from wherever I want to, without any problems."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 23, "user_id": 11154724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc8a3e899477ea732fd793c04a9c2e4?s=128&d=identicon&r=PG&f=1", "display_name": "timp95", "link": "https://stackoverflow.com/users/11154724/timp95"}, "edited": false, "score": 0, "creation_date": 1555504756, "post_id": 55724891, "comment_id": 98134315, "body": "@timp95 I also suggest you use the <code>.Worksheets</code> collection instead of <code>.Sheets</code> when you want to refer to a worksheet."}, {"owner": {"reputation": 23, "user_id": 11154724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc8a3e899477ea732fd793c04a9c2e4?s=128&d=identicon&r=PG&f=1", "display_name": "timp95", "link": "https://stackoverflow.com/users/11154724/timp95"}, "edited": false, "score": 0, "creation_date": 1555513190, "post_id": 55724891, "comment_id": 98139931, "body": "As @FoxfireAndBurnAndBurns pointed out, the error was resolved by activating the sheet before using the selection. Thank you very much for your help regardless :)"}], "tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": false, "score": 1, "last_activity_date": 1555496079, "last_edit_date": 1592644375, "creation_date": 1555495057, "answer_id": 55724891, "question_id": 55724377, "link": "https://stackoverflow.com/questions/55724377/vba-problems-with-selection-if-called-from-another-module/55724891#55724891", "title": "VBA - Problems with selection if called from another module", "body": "<p>I run this</p>\n<pre><code>dia.Shapes.SelectAll\nSelection.ShapeRange.TextFrame2.TextRange.ParagraphFormat.Alignment = msoAlignCenter\nSelection.ShapeRange.TextFrame2.VerticalAnchor = msoAnchorMiddle\nSelection.Group\ndia.Range(&quot;A1&quot;).Select\n</code></pre>\n<p>...and it's not causing an error.</p>\n<p><strong>Unless</strong>, the shapes have already been grouped in a previous execution. In that case, <code>Selection.Group</code> will give you:</p>\n<p><code>Run-time error 438: Object doesn't support this property or method</code></p>\n<p>So, making sure that your shapes are first un-grouped and then selected and grouped, should fix your issue.</p>\n<pre><code>Dim dia As Worksheet\nSet dia = ThisWorkbook.Worksheets(&quot;Your worksheet's name&quot;)\ndia.Shapes.SelectAll\nSelection.Ungroup\ndia.Shapes.SelectAll\nSelection.ShapeRange.TextFrame2.TextRange.ParagraphFormat.Alignment = msoAlignCenter\nSelection.ShapeRange.TextFrame2.VerticalAnchor = msoAnchorMiddle\nSelection.Group\ndia.Range(&quot;A1&quot;).Select\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11154724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc8a3e899477ea732fd793c04a9c2e4?s=128&d=identicon&r=PG&f=1", "display_name": "timp95", "link": "https://stackoverflow.com/users/11154724/timp95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555499489, "creation_date": 1555493542, "last_edit_date": 1555499489, "question_id": 55724377, "link": "https://stackoverflow.com/questions/55724377/vba-problems-with-selection-if-called-from-another-module", "title": "VBA - Problems with selection if called from another module", "body": "<p>I've ran into an issue when trying to call a module from within another one. The code that I'm executing is the following</p>\n\n<pre><code>Sub deleteLine()\nDim list As Worksheet\nDim counter As Long\nSet list = ThisWorkbook.Sheets(\"List\")\ncounter = list.Cells(list.Rows.Count, \"E\").End(xlUp).Row - 1\nIf counter = 0 Then\nMsgBox (\"Why?\")\nElse:\nlist.Range(\"A\" + CStr(counter + 1)).EntireRow.Delete\nEnd If\nCreateDiagram\nlist.Select\nEnd Sub\n</code></pre>\n\n<p>Now the lines in \"CreateDiagram\" that cause the error look like this</p>\n\n<pre><code>Dim dia As Worksheet\nSet dia = ThisWorkbook.Sheets(\"Diagram\")\n    dia.Shapes.SelectAll\n    Selection.ShapeRange.TextFrame2.TextRange.ParagraphFormat.Alignment = msoAlignCenter\n    Selection.ShapeRange.TextFrame2.VerticalAnchor = msoAnchorMiddle\n    Selection.Group\n    dia.Range(\"A1\").Select\n</code></pre>\n\n<p>Now what I don't understand is that when I try to execute CreateDiagram directly it works just fine. Any idea where the error might come from?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1555490957, "post_id": 55723362, "comment_id": 98126161, "body": "Upload photo with your data please."}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1555499209, "creation_date": 1555499209, "answer_id": 55726132, "question_id": 55723362, "link": "https://stackoverflow.com/questions/55723362/macro-to-insert-auto-numbering/55726132#55726132", "title": "Macro to Insert Auto Numbering", "body": "<pre><code> Sub AddText\n Dim r as range\n Set r = range(\"a2\") 'set pointer\n Do 'begin loop \n    r.formula = \"Result \" &amp; r.row + 1 &amp; \": \" &amp; r.text  'adjust contects\n    set r = r.offset(1,0) 'move pointer\n Loop until r =\"\" 'keep going until blank cell\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 1045369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ceb6ab30767cba0673aae1400616922?s=128&d=identicon&r=PG", "display_name": "user1045369", "link": "https://stackoverflow.com/users/1045369/user1045369"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 55726132, "answer_count": 1, "score": -1, "last_activity_date": 1556021688, "creation_date": 1555490383, "last_edit_date": 1556021688, "question_id": 55723362, "link": "https://stackoverflow.com/questions/55723362/macro-to-insert-auto-numbering", "title": "Macro to Insert Auto Numbering", "body": "<p>I need you help for marco.</p>\n\n<p>In my excel first column I would like to adding auto numbering with text in front of the text until last row. </p>\n\n<p>For example:\nIn cell A2 (till last row) i have text \"This is text\", then macro should add (Result 1: This is text).</p>\n\n<p>similarly in next cell</p>\n\n<p>In cell A3, i have text \"This is another text\", then macro should add \n(Result 2: This is another text).</p>\n\n<p>looking forward to your support. </p>\n\n<p>thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1555490224, "post_id": 55723199, "comment_id": 98125770, "body": "You don&#39;t have an <code>end with</code> for your <code>with sheets(&quot;steps&quot;)</code> block"}, {"owner": {"reputation": 25, "user_id": 11258056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/378c8f08d9614cdc95681bf521c90e6d?s=128&d=identicon&r=PG&f=1", "display_name": "John Pattrick", "link": "https://stackoverflow.com/users/11258056/john-pattrick"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1555490950, "post_id": 55723199, "comment_id": 98126153, "body": "I am still getting the error . I am not a expert in VBA . Could you explain them"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1555492410, "post_id": 55723199, "comment_id": 98126972, "body": "Works for me (doesn&#39;t error at least)."}, {"owner": {"reputation": 25, "user_id": 11258056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/378c8f08d9614cdc95681bf521c90e6d?s=128&d=identicon&r=PG&f=1", "display_name": "John Pattrick", "link": "https://stackoverflow.com/users/11258056/john-pattrick"}, "edited": false, "score": 0, "creation_date": 1555492577, "post_id": 55723199, "comment_id": 98127067, "body": "When the worksheet is empty . I get that error."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11258056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/378c8f08d9614cdc95681bf521c90e6d?s=128&d=identicon&r=PG&f=1", "display_name": "John Pattrick", "link": "https://stackoverflow.com/users/11258056/john-pattrick"}, "edited": false, "score": 0, "creation_date": 1555491386, "post_id": 55723520, "comment_id": 98126388, "body": "I have tried that one , But I get application error on the line &quot;.Resize(n, 15).Value = results&quot;"}], "tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": false, "score": 0, "last_activity_date": 1555490906, "creation_date": 1555490906, "answer_id": 55723520, "question_id": 55723199, "link": "https://stackoverflow.com/questions/55723199/while-executing-the-code-i-got-compile-error-expect-end-with/55723520#55723520", "title": "While executing the code I got compile error: Expect End With", "body": "<pre><code>    With Sheets(\"Steps\")\n      With .Cells(.Rows.Count, 1).End(xlUp).Offset(1)\n            .Resize(n, 15).Value = results\n      End With\n\n      UpdateNEW2 = n\n    End with &lt;-- you've forgotten this one.\n</code></pre>\n\n<p>As you can see, proper indentation makes it easier to read and correct where needed.</p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 11258056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/378c8f08d9614cdc95681bf521c90e6d?s=128&d=identicon&r=PG&f=1", "display_name": "John Pattrick", "link": "https://stackoverflow.com/users/11258056/john-pattrick"}, "edited": false, "score": 1, "creation_date": 1555492479, "post_id": 55723663, "comment_id": 98127006, "body": "Thanks . It worked . If I have any doubts . I get back on this ."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 1, "last_activity_date": 1555491425, "creation_date": 1555491425, "answer_id": 55723663, "question_id": 55723199, "link": "https://stackoverflow.com/questions/55723199/while-executing-the-code-i-got-compile-error-expect-end-with/55723663#55723663", "title": "While executing the code I got compile error: Expect End With", "body": "<pre><code>Option Explicit '&lt;- Always use Option Explicit \n\nFunction UpdateNEW2() As Long\n\n    Const Delimiter As String = \"|\"\n\n    Dim dic As Object\n    Dim newRows As Range\n    Dim vSteps, key, vInterface, results '&lt;- You could declare variables\n    Dim r As Long, c As Long, n As Long\n\n    Set dic = CreateObject(\"Scripting.Dictionary\")\n\n    With ThisWorkbook '&lt;- To avoid issues if two workbooks are open create a \"With Statement\" for this workbook\n\n        With .Sheets(\"Steps\") '&lt;- Use \".\" before Sheets to show that you will the work in the workbook of the \"With Statement\"\n\n            vSteps = .Range(\"A2:C2\", .Cells(.Rows.Count, 1).End(xlUp)).Value\n\n        End With\n\n        For r = 1 To UBound(vSteps)\n\n            key = vSteps(r, 2) &amp; Delimiter &amp; vSteps(r, 2)\n\n            If Not dic.Exists(key) Then dic.Add key, 0\n\n        Next\n\n        With .Sheets(\"Interface\") '&lt;- Use \".\" before Sheets to show that you will the work in the workbook of the \"With Statement\"\n\n            vInterface = .Range(\"A2:O2\", .Cells(.Rows.Count, \"C\").End(xlUp)).Value\n\n        End With\n\n        ReDim results(1 To UBound(vInterface), 1 To 15)\n\n        For r = 1 To UBound(vInterface)\n\n            key = vInterface(r, 5) &amp; Delimiter &amp; vInterface(r, 5)\n\n            If Not dic.Exists(key) Then\n\n                n = n + 1\n\n                For c = 3 To 15\n                    results(n, c - 2) = vInterface(r, c)\n                Next\n\n            End If\n\n        Next\n\n        With .Sheets(\"Steps\") '&lt;- Use \".\" before Sheets to show that you will the work in the workbook of the \"With Statement\"\n\n            With .Cells(.Rows.Count, 1).End(xlUp).Offset(1)\n\n                    .Resize(n, 15).Value = results\n\n            End With\n\n              UpdateNEW2 = n\n\n        End With\n\n    End With\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11258056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/378c8f08d9614cdc95681bf521c90e6d?s=128&d=identicon&r=PG&f=1", "display_name": "John Pattrick", "link": "https://stackoverflow.com/users/11258056/john-pattrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 55723663, "answer_count": 2, "score": 1, "last_activity_date": 1556024678, "creation_date": 1555489828, "last_edit_date": 1556024678, "question_id": 55723199, "link": "https://stackoverflow.com/questions/55723199/while-executing-the-code-i-got-compile-error-expect-end-with", "title": "While executing the code I got compile error: Expect End With", "body": "<p>While executing the code I got the following error , \"Expect End With \" . It could be great , if help is provided .</p>\n\n<p>I have created the code below that compare two spreadsheets . It initially compares the range of value from sheet1 (\"Status\") to sheet2 (\"Interface\") . Whenever a range matches with the ranges present in other sheet , it does nothing .When the range does not any matches in the other sheet , then the entire record is copied from sheet2 to sheet1 . I have around 1500 rows of data in both sheets with 15 columns .</p>\n\n<pre><code>Function UpdateNEW2() As Long\n    Const Delimiter As String = \"|\"\n    Dim dic As Object\n    Set dic = CreateObject(\"Scripting.Dictionary\")\n    Dim newRows As Range\n    Dim vSteps, key\n    With Sheets(\"Steps\")\n        vSteps = .Range(\"A2:C2\", .Cells(.Rows.Count, 1).End(xlUp)).Value\n    End With\n\n        Dim r As Long, c As Long, n As Long\n        For r = 1 To UBound(vSteps)\n            key = vSteps(r, 2) &amp; Delimiter &amp; vSteps(r, 2)\n            If Not dic.Exists(key) Then dic.Add key, 0\n        Next\n\n        Dim vInterface, results\n        With Sheets(\"Interface\")\n            vInterface = .Range(\"A2:O2\", .Cells(.Rows.Count, \"C\").End(xlUp)).Value\n        End With\n\n        ReDim results(1 To UBound(vInterface), 1 To 15)\n        For r = 1 To UBound(vInterface)\n            key = vInterface(r, 5) &amp; Delimiter &amp; vInterface(r, 5)\n            If Not dic.Exists(key) Then\n                n = n + 1\n                For c = 3 To 15\n                    results(n, c - 2) = vInterface(r, c)\n                Next\n            End If\n        Next\n        With Sheets(\"Steps\")\n        With .Cells(.Rows.Count, 1).End(xlUp).Offset(1)\n                .Resize(n, 15).Value = results\n                  End With\n\n              UpdateNEW2 = n\n\n    End Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1555490976, "post_id": 55723272, "comment_id": 98126169, "body": "This would work if there was only one data value placed in the pivot table. would like to know what if I had two data values each having their own separate grand total column. How would I get the two different grand total values respectively?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1555491619, "post_id": 55723272, "comment_id": 98126520, "body": "Do you mean you would like to get the total of of East and West for example? If not, best to show an example in your question (edit it)"}, {"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1555492402, "post_id": 55723272, "comment_id": 98126965, "body": "I could just continue using your example and just take the second last cell in the data range I guess, if there is no specific way in distinguishing those grand total cells."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1555492880, "post_id": 55723272, "comment_id": 98127226, "body": "<code>pt.DataBodyRange.Cells(pt.DataBodyRange.Cells.Count -1).Value</code> would give you that value :)"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1555490103, "creation_date": 1555490103, "answer_id": 55723272, "question_id": 55723128, "link": "https://stackoverflow.com/questions/55723128/grand-total-pivot-table-range-reference-for-excel-vba/55723272#55723272", "title": "Grand total pivot table range reference for excel VBA", "body": "<p>Well, since it would be the most bottom right cell in your pivot table:</p>\n\n<pre><code>Set pt = Activesheet.PivotTables(1)\ngrandTotal = pt.DataBodyRange.Cells(pt.DataBodyRange.Cells.Count).Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 13558611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0982199a98bd907f9b9d9f4dd2829d06?s=128&d=identicon&r=PG&f=1", "display_name": "Rodlima", "link": "https://stackoverflow.com/users/13558611/rodlima"}, "is_accepted": false, "score": 0, "last_activity_date": 1601068059, "creation_date": 1601068059, "answer_id": 64071339, "question_id": 55723128, "link": "https://stackoverflow.com/questions/55723128/grand-total-pivot-table-range-reference-for-excel-vba/64071339#64071339", "title": "Grand total pivot table range reference for excel VBA", "body": "<p>If you need to reference different Rows or Columns Totals, this way should work well for you.</p>\n<pre><code>Sub SelectGrandTotal()\n  Dim pt As PivotTable\n  Dim rGrandTotal As Range\n  \n  Set pt = ActiveSheet.PivotTables(1)\n  \n  With pt\n  \n    'This condition checks if the GrandTotals are activated. Not really necessary in some cases.\n    If .ColumnGrand And .RowGrand Then\n      With .DataBodyRange\n      \n        'Add &quot;- 1&quot; after &quot;.Count&quot; if you want to move between different Totals.\n        Set rGrandTotal = .Cells(.Rows.Count, .Columns.Count)\n        rGrandTotal.Select\n        'Print\n        MsgBox (rGrandTotal)\n\n      End With\n\n    End If\n\n  End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3061, "favorite_count": 0, "accepted_answer_id": 55723272, "answer_count": 2, "score": 0, "last_activity_date": 1601068059, "creation_date": 1555489622, "last_edit_date": 1555492158, "question_id": 55723128, "link": "https://stackoverflow.com/questions/55723128/grand-total-pivot-table-range-reference-for-excel-vba", "title": "Grand total pivot table range reference for excel VBA", "body": "<p>I would like to simply get the value of the grand total of a pivot table. However I need this to be more dynamic than the solution found online.</p>\n\n<p><a href=\"https://i.stack.imgur.com/wHJhj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wHJhj.png\" alt=\"enter image description here\"></a></p>\n\n<p>A simple solution that I have seen online was to get the last cell found in the range of the grand total column. In this case, resulting to something like the code mentioned below.</p>\n\n<pre><code>Dim grandTotal As Range\ngrandTotal = Range(\"E65536\").End(xlUp)\nMsgBox grandTotal.Value\n</code></pre>\n\n<p>However, this would simply fail if I had some data filled in below the pivot table, in the same column. Is there a way to precisely reference the grand total value? Maybe like referencing the data range of the two grand total column and row, and find an intersect between the two to get the cell highlighted in yellow?</p>\n\n<p>Edit: </p>\n\n<p>What about getting the grand total for the two different data value columns</p>\n\n<p><a href=\"https://i.stack.imgur.com/b7Agy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/b7Agy.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 11372323, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OOSpp.jpg?s=128&g=1", "display_name": "mnystrktr", "link": "https://stackoverflow.com/users/11372323/mnystrktr"}, "edited": false, "score": 0, "creation_date": 1555489525, "post_id": 55722992, "comment_id": 98125342, "body": "Sorry, I&#39;m new here, maybe that&#39;s why I cannot find the following additional information I needed to specify during the process of creating a post: I already tried to use xlsm format instead of xlsb, but it did not lead to any success."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11372323, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OOSpp.jpg?s=128&g=1", "display_name": "mnystrktr", "link": "https://stackoverflow.com/users/11372323/mnystrktr"}, "edited": false, "score": 0, "creation_date": 1555664435, "post_id": 55727546, "comment_id": 98193582, "body": "I did and I appreciate the links you sent. They are very useful. However I could not figure out yet, what the problem could be. I keep examining and investigating."}], "tags": [], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1555504005, "creation_date": 1555504005, "answer_id": 55727546, "question_id": 55722992, "link": "https://stackoverflow.com/questions/55722992/excel-sheet-related-code-added-from-another-workbook-disappears-after-closing-an/55727546#55727546", "title": "Excel sheet-related code added from another workbook disappears after closing and reopening the file", "body": "<p>Maybe problems with txt file</p>\n\n<p>Try read <a href=\"https://www.bettersolutions.com/vba/visual-basic-editor/extensibility-object-model.htm\" rel=\"nofollow noreferrer\">this first</a> and run <a href=\"https://www.bettersolutions.com/vba/visual-basic-editor/extensibility-sample-code.htm\" rel=\"nofollow noreferrer\">CreateEventProcedure</a></p>\n\n<p><a href=\"https://www.bettersolutions.com/vba/enumerations/vba-editor-constants.htm\" rel=\"nofollow noreferrer\">VBA Editor Constants</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11372323, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OOSpp.jpg?s=128&g=1", "display_name": "mnystrktr", "link": "https://stackoverflow.com/users/11372323/mnystrktr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555504005, "creation_date": 1555489185, "last_edit_date": 1555489484, "question_id": 55722992, "link": "https://stackoverflow.com/questions/55722992/excel-sheet-related-code-added-from-another-workbook-disappears-after-closing-an", "title": "Excel sheet-related code added from another workbook disappears after closing and reopening the file", "body": "<p>I have an excel workbook of xlsb format (let's call it \"Child-workbook\") automatically generated by another excel workbook (\"Parent-workbook\").\nThis so called \"Child Workbook\" has some sheets, containing graphs. I want these sheets to have a code that runs each time the user selects the sheet, and I want the \"Parent Workbook\" to transfer that code to \"Child-workbook\". The transfer has been done succesfully, the module does appear in the Child workbook's project until I close it (of course I save it before that...).</p>\n\n<p><a href=\"https://i.stack.imgur.com/rNl3d.jpg\" rel=\"nofollow noreferrer\">Here is an image of how it looks like after saving but before closing \"Child.xlsb\".</a></p>\n\n<p>My problem is that when I reopen the Child workbook, the module is still there though, but its content is completely gone, it's empty.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ArYae.jpg\" rel=\"nofollow noreferrer\">Here is an image of how it looks like after saving, closing and reopening it.</a></p>\n\n<p>Any advice?</p>\n\n<pre><code>Sub TransferModule()\n\n    Const MODULE_NAME    As String = \"DiagramMakro\"      \n    Dim MODULEFILE       As String\n    MODULEFILE = \"C:\\Modul.txt\"\n\n   Workbooks(\"Parent.xlsm\").VBProject.VBComponents(MODULE_NAME).Export MODULEFILE\n\n    For i = 1 To Workbooks(\"CHILD.xlsb\").Sheets.Count\n        If Workbooks(\"CHILD.xlsb\").Worksheets(i).Name Like \"Diagram*\" Then\n            Workbooks(\"CHILD.xlsb\").Worksheets(i).Activate            \n            Workbooks(\"CHILD.xlsb\").VBProject.VBComponents(ActiveSheet.CodeName).Name = MODULE_NAME\n            Workbooks(\"CHILD.xlsb\").VBProject.VBComponents.Item(\"CHILD.xlsb\").CodeModule.AddFromFile (MODULEFILE)\n        End If\n    Next i\n   Kill MODULEFILE\n\nEnd Sub\n</code></pre>\n\n<p>And here is the Module to transfer:</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    Dim myChart As Chart\n    Dim mySeries As SeriesCollection\n    Set myChart = ActiveSheet.ChartObjects(1).Chart\n    Set mySeries = myChart.SeriesCollection\n    For i = 3 To mySeries.Count\n        mySeries.Item(i).Format.Line.Visible = msoFalse\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1555493276, "post_id": 55722961, "comment_id": 98127454, "body": "You could get a list of unique week numbers, loop through, extract the 2 columns using autofilter, copy across etc."}, {"owner": {"reputation": 1, "user_id": 11372483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f2bbaf77677ebe0521ac1f2f29eafb2?s=128&d=identicon&r=PG&f=1", "display_name": "Eleutery", "link": "https://stackoverflow.com/users/11372483/eleutery"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1556028921, "post_id": 55722961, "comment_id": 98293260, "body": "Ok, but how can i apply an autofilter for each value ok week number? and how i can take the &quot;week number&quot; and then create 2 columns ( and copy the filtered values ) for each week? thanks!"}], "owner": {"reputation": 1, "user_id": 11372483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f2bbaf77677ebe0521ac1f2f29eafb2?s=128&d=identicon&r=PG&f=1", "display_name": "Eleutery", "link": "https://stackoverflow.com/users/11372483/eleutery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555493129, "creation_date": 1555489086, "last_edit_date": 1555493129, "question_id": 55722961, "link": "https://stackoverflow.com/questions/55722961/how-to-copy-row-based-on-cell-value-to-another-sheet", "title": "How to copy row based on cell value to another sheet", "body": "<p>I'm trying to copy 2 columns( A and B ) from sheetA to sheetB, based on each different value of column D from sheetA.\nI get the week number from \"release date\" but now i need to create into sheetB 2 columns for each different \"week number\" and copy the 2 first columns on each week.</p>\n\n<p>I'm getting week numbers using:</p>\n\n<pre><code>If IsDate(c.Value) Then c.Offset(, 1).Value = Format(c.Value, \"ww\")\n</code></pre>\n\n<p>But i don't know how to store each different value on \"WEEK_NUM\" to create the column on sheetB and then copy the row...</p>\n\n<p>That's what i'm trying to obtain:\n<img src=\"https://i.stack.imgur.com/UxGRb.png\" alt=\"copy_weeks\"></p>\n"}, {"tags": ["excel", "vba", "visual-studio"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1555487767, "post_id": 55722581, "comment_id": 98124351, "body": "You could do it in the VB6 IDE by exporting the modules to <code>.bas</code> files and opening them there. You cannot do it in VS.NET."}, {"owner": {"reputation": 1, "user_id": 10932417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd512f391ff6d3a3d621b68ba295fd4?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac", "link": "https://stackoverflow.com/users/10932417/isaac"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1555488001, "post_id": 55722581, "comment_id": 98124517, "body": "Thanks Hadn&#39;t thought about that!"}, {"owner": {"reputation": 1, "user_id": 10932417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd512f391ff6d3a3d621b68ba295fd4?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac", "link": "https://stackoverflow.com/users/10932417/isaac"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1555488738, "post_id": 55722581, "comment_id": 98124912, "body": "The only thing is that it is a longer work around. was wondering of there was any way of changing the default program."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1555490985, "post_id": 55722581, "comment_id": 98126177, "body": "If it is just editing, then you can right click the on the bas file and open it in VB.Net or even Notepad++. Obviously you will not have access to Intellisense but the greatest advantage of right-clicking and opening it in VB.Net is that your code get auto indented and not to mention the Autocomplete of If-Endifs etc..."}], "answers": [{"tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 0, "last_activity_date": 1555541567, "last_edit_date": 1555541567, "creation_date": 1555539715, "answer_id": 55736734, "question_id": 55722581, "link": "https://stackoverflow.com/questions/55722581/is-there-a-way-to-edit-an-excel-vba-macro-in-visual-basic/55736734#55736734", "title": "Is there a way to edit an excel VBA macro in Visual Basic", "body": "<p>Find a tool called <a href=\"https://www.codeproject.com/Articles/18029/SourceTools-xla\" rel=\"nofollow noreferrer\"><code>SourceTools.xla</code></a> that allows quick export of all source code into appropriate files (.bas, .frm, .cls,..) and then you can edit the files with your favorite editor. </p>\n\n<p>You can then update the VBA project from the edited files, and most importantly keep track of the source file in your favorite source control system (SVN, Git).</p>\n\n<p>Example .xls file with exported source code in a similarly named sub folder</p>\n\n<p><a href=\"https://i.stack.imgur.com/SMXM4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SMXM4.png\" alt=\"scr1\"></a></p>\n\n<p>Export code from VBA</p>\n\n<p><a href=\"https://i.stack.imgur.com/igzkj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/igzkj.png\" alt=\"scr2\"></a></p>\n\n<p>and the files it created</p>\n\n<p><a href=\"https://i.stack.imgur.com/yzDRw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yzDRw.png\" alt=\"scr3\"></a></p>\n\n<p>and changing the text with an outside editor.</p>\n\n<p><a href=\"https://i.stack.imgur.com/casRa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/casRa.png\" alt=\"scr4\"></a></p>\n\n<p>Unfortunately, the automated import back into VBA is buggy, and I have to resort to manually copy and pasting code with <code>Ctrl-A</code>, <code>Ctrl-C</code> in the editor and <code>Ctrl-A</code>, <code>Ctrl-V</code> in VBA.</p>\n\n<p>But the import into SVN works well with TortoiseSVN to keep track of changes in code.</p>\n\n<hr>\n\n<p><sub>You will have to go in the code and change <code>C:\\Programme\\TortoiseSVN\\bin\\</code> into <code>C:\\Program Files\\TortoiseSVN\\bin\\</code>.</sub></p>\n"}], "owner": {"reputation": 1, "user_id": 10932417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd512f391ff6d3a3d621b68ba295fd4?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac", "link": "https://stackoverflow.com/users/10932417/isaac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 850, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555541567, "creation_date": 1555487627, "last_edit_date": 1555528189, "question_id": 55722581, "link": "https://stackoverflow.com/questions/55722581/is-there-a-way-to-edit-an-excel-vba-macro-in-visual-basic", "title": "Is there a way to edit an excel VBA macro in Visual Basic", "body": "<p>I would like to edit my Excel macro in Visual studio as it is easier to read and stuff, is there a way that i can change the default editor to visual basic.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1555487620, "post_id": 55722392, "comment_id": 98124267, "body": "I cant read anything from your screenshot. The resolution is too low."}, {"owner": {"reputation": 7, "user_id": 11129166, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y_Hb_icHD7w/AAAAAAAAAAI/AAAAAAAAAM8/d32fttps238/photo.jpg?sz=128", "display_name": "Gaurav K.M.", "link": "https://stackoverflow.com/users/11129166/gaurav-k-m"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1555489204, "post_id": 55722392, "comment_id": 98125177, "body": "its resolution is 1,280px &#215; 670px. Its just i inspected YouTube video title using firefox and its show the id and class. This is the code from where I want to fetch the data.     &lt;a id=&quot;video-title&quot; class=&quot;yt-simple-endpoint style-scope ytd-video-renderer&quot; aria-label=&quot;VIDEO TITLE &amp; DETAILS&quot; title=&quot;VIDEO TITLE&quot; href=&quot;/watch?v=J2UuYHahPMI&quot;&gt;VIDEO TITLE&lt;/a&gt; \u2013"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1555494306, "post_id": 55722392, "comment_id": 98128075, "body": "Looking at your image, I can read <code>class=&quot;yt-simple-endpoint style-scope ytd-video-renderer&quot;</code> not only <code>&quot;yt-simple-endpoint&quot;</code>. Am I wrong?"}, {"owner": {"reputation": 7, "user_id": 11129166, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y_Hb_icHD7w/AAAAAAAAAAI/AAAAAAAAAM8/d32fttps238/photo.jpg?sz=128", "display_name": "Gaurav K.M.", "link": "https://stackoverflow.com/users/11129166/gaurav-k-m"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1555496644, "post_id": 55722392, "comment_id": 98129482, "body": "@FoxfireAndBurnsAndBurns on the there website they are using 3 class. I am just using one of them to fetch the data. On other pages of youtube was always able to fetch data with one. I even tried with all the three class to fetch the data. Yet its not working."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1555503839, "post_id": 55722392, "comment_id": 98133700, "body": "Now that the picture is in the question the quality is okay. The previous link wasn&#39;t zoomable on mobile."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1555503859, "post_id": 55722392, "comment_id": 98133717, "body": "Are there more subs in your code?"}, {"owner": {"reputation": 7, "user_id": 11129166, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y_Hb_icHD7w/AAAAAAAAAAI/AAAAAAAAAM8/d32fttps238/photo.jpg?sz=128", "display_name": "Gaurav K.M.", "link": "https://stackoverflow.com/users/11129166/gaurav-k-m"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1555507215, "post_id": 55722392, "comment_id": 98135956, "body": "@Luuklag No, there no other subs. This is all of it. it used to work before. When i try fetching with getElementbyId(&quot;video-title&quot;) it shows error - &quot;object required&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 11129166, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y_Hb_icHD7w/AAAAAAAAAAI/AAAAAAAAAM8/d32fttps238/photo.jpg?sz=128", "display_name": "Gaurav K.M.", "link": "https://stackoverflow.com/users/11129166/gaurav-k-m"}, "edited": false, "score": 0, "creation_date": 1555496728, "post_id": 55724596, "comment_id": 98129536, "body": "No thr is no error handler. This is whole code which one using. I used same very code to fetch data from other youtube pages and website. But some how its not working on Youtube Trends. I don&#39;t know why. I picked this code from &quot;<a href=\"http://automateexcel.com/\" rel=\"nofollow noreferrer\">automateexcel.com</a>&quot;."}, {"owner": {"reputation": 7, "user_id": 11129166, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y_Hb_icHD7w/AAAAAAAAAAI/AAAAAAAAAM8/d32fttps238/photo.jpg?sz=128", "display_name": "Gaurav K.M.", "link": "https://stackoverflow.com/users/11129166/gaurav-k-m"}, "edited": false, "score": 0, "creation_date": 1555577690, "post_id": 55724596, "comment_id": 98161852, "body": "I do not much about coding.But tthanks anyway for helping."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 0, "last_activity_date": 1555494154, "creation_date": 1555494154, "answer_id": 55724596, "question_id": 55722392, "link": "https://stackoverflow.com/questions/55722392/trying-to-fetch-youtube-trending-videos-name-and-links-using-excel-vba/55724596#55724596", "title": "Trying to fetch Youtube Trending videos name and links using Excel VBA", "body": "<p>If you're not getting any errors then you must be using some error handling that's masking the error?</p>\n\n<p><code>result</code> has been dimensioned as a <code>String</code> type - but you're doing:</p>\n\n<pre><code>'...get the href link and print it to the sheet in col C, row y\nresult = aEle\nSheets(\"Sheet1\").Range(\"C\" &amp; y).Value = result\n</code></pre>\n\n<p>here, <code>aEle</code> is an object from a <code>HTMLCollection</code>, because you used <code>getElementsByClassName()</code></p>\n\n<p>You can't assign an object to a string, this should be throwing a Type Mismatch error.</p>\n"}], "owner": {"reputation": 7, "user_id": 11129166, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y_Hb_icHD7w/AAAAAAAAAAI/AAAAAAAAAM8/d32fttps238/photo.jpg?sz=128", "display_name": "Gaurav K.M.", "link": "https://stackoverflow.com/users/11129166/gaurav-k-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 55724596, "answer_count": 1, "score": 0, "last_activity_date": 1556024664, "creation_date": 1555487043, "last_edit_date": 1556024664, "question_id": 55722392, "link": "https://stackoverflow.com/questions/55722392/trying-to-fetch-youtube-trending-videos-name-and-links-using-excel-vba", "title": "Trying to fetch Youtube Trending videos name and links using Excel VBA", "body": "<p>I'm trying to fetch Youtube Trending videos into excel sheet with Title and video links. But my code is not working. I do not know whether there is something wrong with my code or the trending page.\nThis is code from where i am trying to video the data</p>\n\n<pre><code>    &lt;a id=\"video-title\" class=\"yt-simple-endpoint style-scope ytd-video-renderer\" aria-label=\"VIDEO TITLE &amp; DETAILS\" title=\"VIDEO TITLE\" href=\"/watch?v=J2UuYHahPMI\"&gt;VIDEO TITLE&lt;/a&gt;\n</code></pre>\n\n<p>When i run the code. It just load the page and does nothing. It does not even show any error. I tried fetching data <code>\"getElementbyID\"</code> as well as with <code>\"getElementsByClassName\"</code></p>\n\n<p>Here is the screenshot from where i am trying to fetch the data.\n<a href=\"https://i.stack.imgur.com/8cpgg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8cpgg.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub YOUTUBETREND()\n\nDim objIE As SHDocVw.InternetExplorer 'special object variable representing the IE browser\nDim aEle As HTMLLinkElement 'special object variable for an &lt;a&gt; (link) element\nDim y As Integer 'integer variable we'll use as a counter\nDim result As String 'string variable that will hold our result link\n\n'initiating a new instance of Internet Explorer and asigning it to objIE\nSet objIE = New InternetExplorer\n\n'make IE browser visible (False would allow IE to run in the background)\nobjIE.Visible = True\n\n'navigate IE to this web page (a pretty neat search engine really)\nobjIE.navigate \"https://www.youtube.com/feed/trending/\"\n\n'wait here a few seconds while the browser is busy\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n'the first search result will go in row 2\ny = 2\n\n'for each &lt;a&gt; element in the collection of objects with class of 'result__a'...\nFor Each aEle In objIE.document.getElementsByClassName(\"yt-simple-endpoint\")\n\n    '...get the href link and print it to the sheet in col C, row y\n    result = aEle\n    Sheets(\"Sheet1\").Range(\"C\" &amp; y).Value = result\n\n    '...get the text within the element and print it to the sheet in col D\n    Sheets(\"Sheet1\").Range(\"D\" &amp; y).Value = aEle.innerText\n    Debug.Print aEle.innerText\n\n    'increment our row counter, so the next result goes below\n    y = y + 1\n\n'repeat times the # of ele's we have in the collection\nNext\nobjIE.Quit\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1555489739, "post_id": 55722280, "comment_id": 98125471, "body": "<code>FormatConditions</code> collection can contain different type of objects: <code>FormatCondition</code>,<code>Databar</code>, <code>ColorScale</code>, <code>IconSetCondition</code>, .... Those are different classes with different properties, so I am afraid you cannot get <code>FormatCondition</code> object when the rule is color scale."}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 1, "creation_date": 1555490434, "post_id": 55722280, "comment_id": 98125890, "body": "But if you only want to get color set by conditional formatting you may want to have a look at <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.displayformat\" rel=\"nofollow noreferrer\">Range.DisplayFormat</a>"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1555504915, "post_id": 55722280, "comment_id": 98134430, "body": "Range.DisplayFormat will get what I need. Interestingly, it can not be used froma UDF called from the worksheet. So I&#39;ll next need to find a workaround for that. Please put your comment as the answer so I can market it. Thank you!"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1555505594, "post_id": 55722280, "comment_id": 98134857, "body": "If you want to have an UDF returning values depending on cell color - it is likely to cause many problems - for example refreshing UDF value on color change. A better approach would be to have the same logic in the UDF as in conditional formatting."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1555505806, "post_id": 55722280, "comment_id": 98134989, "body": "Wouldn&#39;t that essentially require reinventing the wheel (conditional formatting)? I was trying to avoid that by just getting the color from CF"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1555506114, "post_id": 55722280, "comment_id": 98135188, "body": "It looks like circular reference - you want to have some rules based on values to change colors and then use those colors to calculate values. From my experience the best way is to make it one way road - colors depend on values, the other way is always causing problems."}], "answers": [{"comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1555505047, "post_id": 55727206, "comment_id": 98134511, "body": "Your answer would set the object. I&#39;m trying to read it out. Also, when i do run it in my code, i get a run time error 438"}], "tags": [], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1555502768, "creation_date": 1555502768, "answer_id": 55727206, "question_id": 55722280, "link": "https://stackoverflow.com/questions/55722280/how-to-get-the-formatcondition-object/55727206#55727206", "title": "How to get the FormatCondition Object", "body": "<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.formatconditions\" rel=\"nofollow noreferrer\">FormatConditions object</a></p>\n\n<pre><code>With myRng.FormatConditions(1)\n    .Interior.PatternColorIndex = xlAutomatic\n    .Interior.ColorIndex = 19\n    .Font.ColorIndex = 26\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": true, "score": 1, "last_activity_date": 1555505401, "creation_date": 1555505401, "answer_id": 55727944, "question_id": 55722280, "link": "https://stackoverflow.com/questions/55722280/how-to-get-the-formatcondition-object/55727944#55727944", "title": "How to get the FormatCondition Object", "body": "<p><code>FormatConditions</code> collection can contain different type of objects: <code>FormatCondition</code>,<code>Databar</code>, <code>ColorScale</code>, <code>IconSetCondition</code>, .... </p>\n\n<p>Those are different classes with different properties - the type of object depends on conditional formatting rule kind.</p>\n\n<p>It means that it is not possible to get <code>FormatCondition</code> object when there is different (for example color scale) rule applied. \nTo read color of the cell (no matter if it is normal or conditional formatting) <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.displayformat\" rel=\"nofollow noreferrer\">Range.DisplayFormat</a> can be used. </p>\n"}], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 0, "accepted_answer_id": 55727944, "answer_count": 2, "score": 0, "last_activity_date": 1555505401, "creation_date": 1555486552, "last_edit_date": 1555487093, "question_id": 55722280, "link": "https://stackoverflow.com/questions/55722280/how-to-get-the-formatcondition-object", "title": "How to get the FormatCondition Object", "body": "<p>I want to read out the color that the conditional format sets for a particular cell. </p>\n\n<p>Example,commentary, and code of what I've tried below. Note: Selection is simply a cell that contains a conditional format. </p>\n\n<p>How can I get a refrence to a <code>FormatCondition</code> Object? What am I missing/ not seeing? Error on last line...</p>\n\n<pre><code>Sub FC_Test()\nDim fc As FormatConditions\nDim fco As Object\nDim c As Object\nDim myRng As Range\nSet myRng = Selection 'Any cell with a conditional format\n\nDebug.Print \"FC Count: \" &amp; myRng.Resize(1, 1).FormatConditions.Count\n\n'Finds all FC on the sheet\nSet fc = Cells.FormatConditions\nDebug.Print TypeName(fc) 'Returns: FormatConditions\n\n'Finds first applied format condition...\n'...oddly this is not a FormatCondition (member of hte FC collection),\n' but the name of the type of format condition applied.. i.e. \"ColorScale\", etc.\nSet c = Cells.FormatConditions(1)\nDebug.Print TypeName(c) 'Returns: ColorScale\n\n'Finds FC in selected range.\nSet fc = myRng.Resize(1, 1).FormatConditions\nDebug.Print TypeName(fc) 'Returns: FormatConditions\nDebug.Print TypeName(fc.Item(1)) 'Returns: ColorScale\nSet fco = fc(1)\nDebug.Print TypeName(fco) 'Returns: ColorScale\n\nSet fco = Nothing\nFor Each fco In fc\n    Debug.Print TypeName(fco) 'Returns: ColorScale\nNext fco\n\nDim fcs As FormatCondition\nSet fcs = myRng.Resize(1, 1).FormatConditions(1) 'Type Mismatch:13\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 3, "creation_date": 1555496420, "post_id": 55722270, "comment_id": 98129363, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/37049626/vba-run-time-error-3271-using-dao-object\">VBA - Run Time Error 3271 using DAO object</a>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1555496431, "post_id": 55722270, "comment_id": 98129369, "body": "You can&#39;t with DAO."}], "owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559131624, "creation_date": 1555486528, "last_edit_date": 1559131624, "question_id": 55722270, "link": "https://stackoverflow.com/questions/55722270/how-can-i-pass-a-longtext-parameter-using-dao", "title": "How can I pass a LONGTEXT Parameter using DAO?", "body": "<p>I am tying to pass a userform textbox of more than 255 characters to a MS Access field through a parameter. I am unable to do so given the length of characters in my textbox, which generates a runtime error. I would like to avoid writing an SQL Statement directly in my macro. Is there any way around this restriction without using ADO?</p>\n\n<p><strong>CODE</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub updateRecord()\n\nDim db As Database\nDim qdf As QueryDef\n\n\nApplication.StatusBar = \"Connecting to PBS Database......\"\nSet db = OpenDatabase(\"Z:\\UBPB CRM Project\\pbsbackup.mdb\")\nSet qdf = db.QueryDefs(\"addclient\")\n\n\nApplication.CalculateUntilAsyncQueriesDone\n\nApplication.StatusBar = \"Uploading Client Data to PBS server....\"\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n\n    qdf!pbsbranch = Sheet4.Range(\"A2\")\n    qdf!pbsclient = addnewClient.client\n    qdf!pbspriority = addnewClient.priority_\n    qdf!pbssource = addnewClient.priority\n    qdf!pbscontact = addnewClient.contact\n    qdf!pbsresult = addnewClient.result\n    qdf!pbsnextsteps = addnewClient.segmentType\n    qdf!pbsattempts = addnewClient.Label11\n    qdf!pbsnotes = addnewClient.notes\n\n\nqdf.Execute dbFailOnError\n\n\nqdf.Close\ndb.Close\nApplication.StatusBar = \"Upload Successful!\"\n\nSet qdf = Nothing\nSet db = Nothing\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1555487509, "post_id": 55721661, "comment_id": 98124214, "body": "I only see one sub"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1555487532, "post_id": 55721661, "comment_id": 98124226, "body": "Sorry, but you just posted a wall of code with a lot of IF statements. What is to merge? Where are the two procedures?"}, {"owner": {"reputation": 13, "user_id": 11372185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ySGY4rIDuZk/AAAAAAAAAAI/AAAAAAAAATI/UOPzDRORTpY/photo.jpg?sz=128", "display_name": "yiannis", "link": "https://stackoverflow.com/users/11372185/yiannis"}, "edited": false, "score": 0, "creation_date": 1555490242, "post_id": 55721661, "comment_id": 98125786, "body": "Sorry for my mistake, I made the correction to my initial appointment. Thanks"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1555493109, "post_id": 55721661, "comment_id": 98127354, "body": "Have you tried anything?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11372185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ySGY4rIDuZk/AAAAAAAAAAI/AAAAAAAAATI/UOPzDRORTpY/photo.jpg?sz=128", "display_name": "yiannis", "link": "https://stackoverflow.com/users/11372185/yiannis"}, "edited": false, "score": 1, "creation_date": 1555588041, "post_id": 55742646, "comment_id": 98167453, "body": "Hello, Thanks for the answer, she worked very well ... be good"}], "tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": true, "score": 0, "last_activity_date": 1555578180, "creation_date": 1555578180, "answer_id": 55742646, "question_id": 55721661, "link": "https://stackoverflow.com/questions/55721661/how-to-merge-two-subs-with-private-sub-worksheet-change-on-sheet/55742646#55742646", "title": "How to merge two subs with Private Sub Worksheet_Change on sheet", "body": "<p>Try:</p>\n\n<pre><code>Option Explicit\nConst strAFM As String = \"D3:D1000\"\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim Rng As Range, AFM As String, rngTomi As Range\n\n    If Not Target.Count &gt; 1 Then\n        Set Rng = Me.Range(\"ColTarget\")\n        If Not Intersect(Target, Rng) Is Nothing Then ResizeTbl\n    End If\n\n    Set Rng = Range(strAFM)\n    Set rngTomi = Intersect(Target, Rng)\n    If Not rngTomi Is Nothing Then\n        If rngTomi.Count &lt;&gt; 1 Then\n            Application.EnableEvents = False\n                rngTomi.ClearContents\n            Application.EnableEvents = False\n            Exit Sub\n        End If\n\n    If Trim(Target.Value) = \"\" Then Exit Sub\n\n    AFM = Right(\"000000000\" &amp; Target.Value, 9)\n\n    If isAFM(AFM) = False Then\n        MsgBox \"no afm\"\n        Target.Activate\n        Exit Sub\n    End If\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11372185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ySGY4rIDuZk/AAAAAAAAAAI/AAAAAAAAATI/UOPzDRORTpY/photo.jpg?sz=128", "display_name": "yiannis", "link": "https://stackoverflow.com/users/11372185/yiannis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 55742646, "answer_count": 1, "score": 1, "last_activity_date": 1589890741, "creation_date": 1555484322, "last_edit_date": 1556024647, "question_id": 55721661, "link": "https://stackoverflow.com/questions/55721661/how-to-merge-two-subs-with-private-sub-worksheet-change-on-sheet", "title": "How to merge two subs with Private Sub Worksheet_Change on sheet", "body": "<p>good morning\nI need to combine two Private Sub Worksheet_Change(ByVal Target As Range) I'm new to Excel VBA code, how can I do this? Code below.</p>\n\n<p>1)</p>\n\n<pre><code>Option Explicit\nConst strAFM As String = \"D3:D1000\"\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim Rng As Range, AFM As String, rngTomi As Range\n    Set Rng = Range(strAFM)\n    Set rngTomi = Intersect(Target, Rng)\n    If rngTomi Is Nothing Then Exit Sub\n\n    If rngTomi.Count &lt;&gt; 1 Then\n        rngTomi.ClearContents\n        Exit Sub\n    End If\n    If Trim(Target.Value) = \"\" Then Exit Sub\n\n    AFM = Right(\"000000000\" &amp; Target.Value, 9)\n\n    If isAFM(AFM) = False Then\n        MsgBox \"no afm\"\n        Target.Activate\n        Exit Sub\n    End If\nEnd Sub\n</code></pre>\n\n<p>2)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Count &gt; 1 Then Exit Sub\n\n    Dim Rng As Range\n    Set Rng = Me.Range(\"ColTarget\")\n\n    If Intersect(Target, Rng) Is Nothing Then Exit Sub\n\n    ResizeTbl\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 1, "creation_date": 1555531373, "post_id": 55721476, "comment_id": 98148646, "body": "For reasons unknown, OnSlideShowPageChange doesn&#39;t work for some people unless they add an ActiveX control to one of the slides in the presentation. Doesn&#39;t have to be on the slide (ie, it can be sitting off the slide) or even visible, as I recall.  Give that a try."}], "owner": {"reputation": 31, "user_id": 4444893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d938430144b1028b4fd64197f5b91b0?s=128&d=identicon&r=PG&f=1", "display_name": "Michael23", "link": "https://stackoverflow.com/users/4444893/michael23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1555487032, "creation_date": 1555483606, "last_edit_date": 1555487032, "question_id": 55721476, "link": "https://stackoverflow.com/questions/55721476/how-to-run-a-powerpoint-slideshow-with-onslideshowpagechange-from-command-line", "title": "How to run a PowerPoint slideshow with OnSlideShowPageChange from command line", "body": "<p>I have a PowerPoint 2016 pptm / ppsm where I want to run some code on OnSlideShowPageChange. When I start the slideshow from within PowerPoint with the VBA Editor open, the event gets fired.\nWhen I start the slideshow from command line with \"...\\Powerpnt.exe\" /S \"...\\MySlideShow.pptm\", the event is not fired.</p>\n\n<p>Also when I open the slideshow in PowerPoint and do NOT open the VBA editor once, the event is not fired on F5.</p>\n\n<p>What could be the problem?</p>\n\n<p>I tried setting the macro security to lowest, no effect.</p>\n\n<p>This is my code:</p>\n\n<pre><code>Sub OnSlideShowPageChange(ByVal objWindow As SlideShowWindow)\n\nMsgBox \"Hello\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 10969038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c239e8f5d55119ec56aff4f424065e1d?s=128&d=identicon&r=PG&f=1", "display_name": "Eedz", "link": "https://stackoverflow.com/users/10969038/eedz"}, "is_accepted": false, "score": 0, "last_activity_date": 1555615738, "creation_date": 1555615738, "answer_id": 55752599, "question_id": 55721448, "link": "https://stackoverflow.com/questions/55721448/how-to-update-a-table-with-a-random-record-from-another-table/55752599#55752599", "title": "how to update a table with a random record from another table", "body": "<p>You could open your first table as a recordset, generate a <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/rnd-function\" rel=\"nofollow noreferrer\">random integer</a>, then move the AbsolutePosition of the recordset to that random integer. That should get you to a random spot in the recordset. Then add that record to your second table.</p>\n"}], "owner": {"reputation": 45, "user_id": 5403867, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3ZBMH.jpg?s=128&g=1", "display_name": "drs", "link": "https://stackoverflow.com/users/5403867/drs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594621424, "creation_date": 1555483508, "last_edit_date": 1594621424, "question_id": 55721448, "link": "https://stackoverflow.com/questions/55721448/how-to-update-a-table-with-a-random-record-from-another-table", "title": "how to update a table with a random record from another table", "body": "<p>I'm trying to retrieve a random record from a Query(trackList) and update a table (setList) with that record using VBA in MS Access. I've assigned integer values from my recordset and when I run the debug everything runs correctly. when I call this up from a batch file it continues to retrieve the records in alphanumeric order. Is there a better way to achieve this?</p>\n\n<pre><code>Set dbs = CurrentDb\nSet rst = dbs.OpenRecordset(\"_Sun00Q\")\n\nstrName = rst.Fields(\"PLNames\")\nstrSetName = rst.Fields(\"SetName\")\n\nSet rst2 = dbs.OpenRecordset(strName &amp; \"_trackList_RndOrd\")\nintPLNid = rst2.Fields(\"PLNid\")\nintId = rst2.Fields(\"id\")\n\nSQL = \"UPDATE \" &amp; strSetName &amp; \" SET id=\" &amp; intId &amp; \" WHERE PLNid=\" &amp; intPLNid\n\nDoCmd.RunSQL SQL\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 722, "user_id": 11064295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ThXjNr5h95g/AAAAAAAAAAI/AAAAAAAAXCo/UHDaY7gb3P4/photo.jpg?sz=128", "display_name": "Yane", "link": "https://stackoverflow.com/users/11064295/yane"}, "edited": false, "score": 0, "creation_date": 1555481850, "post_id": 55720593, "comment_id": 98121691, "body": "you can find two solutions for downloading here <a href=\"https://stackoverflow.com/questions/17877389/how-do-i-download-a-file-using-vba-without-internet-explorer\">how-do-i-download-a-file-using-vba-without-internet-explorer</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1555480042, "creation_date": 1555480042, "answer_id": 55720681, "question_id": 55720593, "link": "https://stackoverflow.com/questions/55720593/is-there-a-way-to-download-multiple-pdf-files-from-web-pages-in-excel-using-vba/55720681#55720681", "title": "Is there a way to download multiple pdf files from web pages in excel using VBA", "body": "<p>Read first <a href=\"https://analystcave.com/excel-vba-multithreading-tool/\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://analystcave.com/excel-multithreading-vba-vs-vbscript-vs-c-net/\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p><strong>Multithreading a For Loop</strong></p>\n\n<pre><code>Sub RunForVBA(workbookName As String, seqFrom As Long, seqTo As Long)\n    For i = seqFrom To seqTo\n        x = seqFrom / seqTo\n    Next i\nEnd Sub\n\nSub RunForVBAMultiThread()\n    Dim parallelClass As Parallel \n\n    Set parallelClass = New Parallel \n\n    parallelClass.SetThreads 4 \n\n    Call parallelClass.ParallelFor(\"RunForVBA\", 1, 1000) \nEnd Sub\n</code></pre>\n\n<p><strong>Run an Excel macro asynchronously</strong></p>\n\n<pre><code>Sub RunAsyncVBA(workbookName As String, seqFrom As Long, seqTo As Long)\n    For i = seqFrom To seqTo\n        x = seqFrom / seqTo\n    Next i\nEnd Sub\n\nSub RunForVBAAndWait()\n    Dim parallelClass As Parallel\n\n    Set parallelClass  = New Parallel\n\n    Call parallelClass.ParallelAsyncInvoke(\"RunAsyncVBA\", ActiveWorkbook.Name, 1, 1000) \n    'Do other operations here\n    '....\n\n    parallelClass.AsyncThreadJoin \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9487884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fae46b6dbe3a3e212a8fd55a09f8d8b9?s=128&d=identicon&r=PG&f=1", "display_name": "Marius.A", "link": "https://stackoverflow.com/users/9487884/marius-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 356, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1555480042, "creation_date": 1555479580, "question_id": 55720593, "link": "https://stackoverflow.com/questions/55720593/is-there-a-way-to-download-multiple-pdf-files-from-web-pages-in-excel-using-vba", "title": "Is there a way to download multiple pdf files from web pages in excel using VBA", "body": "<p>I am creating a function in excel, which is supposed to save multiple PDF files into a folder, but the PDF files must be downloaded from hyperlinks. </p>\n\n<p>Is it possible to select multiple shells that have hyperlinks attached, and to create a function that will recognize the selection and download the PDFs from the web pages? </p>\n\n<p>What I did so far is, a sub routine which creates a folder on my desktop. I struggle with downloading the PDF files in the folder.</p>\n\n<p>Dim fdObj As Object</p>\n\n<pre><code>Application.ScreenUpdating = False\n\nSet fdObj = CreateObject(\"Scripting.FileSystemObject\")\n\nIf fdObj.FolderExists(\"C:\\Users\\\" &amp; Environ(\"UserName\") &amp; \"\\Desktop\\Temp folder\") \n</code></pre>\n\n<p>Then</p>\n\n<pre><code>    MsgBox \"Found it.\", vbInformation, \"Excel\"\n\nElse\n\n    fdObj.CreateFolder (\"C:\\Users\\\" &amp; Environ(\"UserName\") &amp; \"\\Desktop\\Temp folder\")\n\n    MsgBox \"It has been created.\", vbInformation, \"Excel\"\n\nEnd If\n\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": ["vba", "powershell", "ms-word", "com", "com-interop"], "comments": [{"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1555480596, "post_id": 55719926, "comment_id": 98121197, "body": "What version and deployment method of Office is this? For me, both times the normal template is located in the expected standard location (AppData\\Roaming\\Microsoft\\Templates) using a Click-to-run Office 365 Version 1903; also I do not have the Microsoft.Office.Desktop folder in my Packages folder."}, {"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1555480932, "post_id": 55719926, "comment_id": 98121331, "body": "P.S.: Looks like your Office is deployed via the Microsoft Store (or that you have two different deployments of Office on your machine, one via the Store, the other one via the regular Click-to-run deployment). I assume the behavior you observe can by explained by that."}, {"owner": {"reputation": 35370, "user_id": 180275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/4GALY.jpg?s=128&g=1", "display_name": "Ren&#233; Nyffenegger", "link": "https://stackoverflow.com/users/180275/ren%c3%a9-nyffenegger"}, "reply_to_user": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1555481276, "post_id": 55719926, "comment_id": 98121467, "body": "I installed it from a <code>.iso</code> file. I admit I have no idea what <i>Click-to-run</i> is nor did I realise there was a <i>Microsoft Store</i>."}, {"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1555481667, "post_id": 55719926, "comment_id": 98121597, "body": "Could be that the Store version was preinstalled on your system? Try running <code>&quot;C:\\Program Files (x86)\\Microsoft Office\\Office 16\\winword.exe&quot; &#47;r</code> to re-register all Word components (change the path to where your winword.exe actually is installed to) and see whether this gives you a different result."}, {"owner": {"reputation": 35370, "user_id": 180275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/4GALY.jpg?s=128&g=1", "display_name": "Ren&#233; Nyffenegger", "link": "https://stackoverflow.com/users/180275/ren%c3%a9-nyffenegger"}, "reply_to_user": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1555483431, "post_id": 55719926, "comment_id": 98122283, "body": "@dirk I tried that and it didn&#39;t change antyhing that would have been noticeable to me."}], "owner": {"reputation": 35370, "user_id": 180275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/4GALY.jpg?s=128&g=1", "display_name": "Ren&#233; Nyffenegger", "link": "https://stackoverflow.com/users/180275/ren%c3%a9-nyffenegger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1555478971, "creation_date": 1555475474, "last_edit_date": 1555478971, "question_id": 55719926, "link": "https://stackoverflow.com/questions/55719926/why-does-word-open-with-a-different-normal-dot-if-started-via-com-rather-than-vi", "title": "Why does Word open with a different normal.dot if started via COM rather than via Start Menu?", "body": "<p>When I start Microsoft Word on the Start Menu and then query <code>Application.NormalTemplate.Path</code> for the location of the <code>normal.dotm</code> file, I get, as expected, <code>C:\\Users\\USERNAME\\AppData\\Roaming\\Microsoft\\Templates</code>.</p>\n\n<p>However, when I start Word using COM automation in PowerShell:</p>\n\n<pre><code>$wrd = new-object -com word.application\n$wrd.visible = $true\n</code></pre>\n\n<p>I get a different path when querying the same expression:<code>C:\\Users\\USERNAME\\AppData\\Local\\Packages\\Microsoft.Office.Desktop_8wekyb3d8bbwe\\LocalCache\\Roaming\\Microsoft\\Templates</code>.</p>\n\n<p>Why is that and what can I do in order for the COM invocation to open the same normal.dotm file?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1555473795, "post_id": 55719581, "comment_id": 98119260, "body": "<code>RANDBETWEEN</code> returns an integer number. 24 hours is equivalent to 1, so by definition there&#39;s no random integer between your start time and end time - both are between 0 and 1. You could multiply each by 86400 to get the corresponding time in seconds, use the seconds in <code>RANDBETWEEN</code>, and then divide the result by 86400 to get a time."}, {"owner": {"reputation": 7, "user_id": 11371306, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tD2mN8vFShQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc63TLMUNIivoxfvFBasorOU2Oixw/mo/photo.jpg?sz=128", "display_name": "ARCHER1919", "link": "https://stackoverflow.com/users/11371306/archer1919"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1555477705, "post_id": 55719581, "comment_id": 98120279, "body": "Awesome! Thank you so much for replying.  That makes sense.  I am still getting hung up on how it is generating a random time but not inside the range I provided.  For example if I input 08:00 as the start time and 10:00 as the end time, it will output everything from 02:30 up to 23:59."}], "answers": [{"tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1555480142, "last_edit_date": 1555480142, "creation_date": 1555478804, "answer_id": 55720452, "question_id": 55719581, "link": "https://stackoverflow.com/questions/55719581/is-there-a-way-to-get-worksheetfunction-randbetween-to-work-for-a-time-range/55720452#55720452", "title": "Is there a way to get worksheetfunction.randbetween to work for a time range?", "body": "<p>You can do this as a UDF. The idea is to generate a random minute to offset from Time1.</p>\n\n<p>First convert the hours and minutes of both times into minutes as the unit.<br>\nThen base on the minutes difference, generate a random minutes using the <code>RandBetween</code>, deduct the base time, then add this random minutes to the base time (in terms of minutes).</p>\n\n<pre><code>Function RandomTimeBetween(FromTime As Range, ToTime As Range) As Date\n    Dim Time1 As Date, Time2 As Date, Minutes As Integer\n    Time1 = CDate(FromTime.Value)\n    Time2 = CDate(ToTime.Value)\n    Minutes = Hour(Time1) * 60 + Minute(Time1) ' Base time in minutes\n    ' Find the random offset time between them, deduct the base time\n    Minutes = WorksheetFunction.RandBetween(Minutes, Hour(Time2) * 60 + Minute(Time2)) - Minutes\n    RandomTimeBetween = Time1 + TimeSerial(0, Minutes, 0)\nEnd Function\n</code></pre>\n\n<p>If you desire to randomise to the seconds, you need to change to below as overflow can occur at TimeSerial:</p>\n\n<pre><code>Function RandomTimeBetween(FromTime As Range, ToTime As Range) As Date\n    Dim Time1 As Date, Time2 As Date, Seconds As Long\n    Time1 = CDate(FromTime.Value)\n    Time2 = CDate(ToTime.Value)\n    Seconds = Hour(Time1) * 3600 + Minute(Time1) * 60 + Second(Time1) ' Base time in seconds\n    ' Find the random offset time between them, deduct the base time\n    Seconds = WorksheetFunction.RandBetween(Seconds, Hour(Time2) * 3600 + Minute(Time2) * 60 + Second(Time2)) - Seconds\n    RandomTimeBetween = Time1 + TimeSerial(Seconds \\ 3600, Seconds \\ 60, Seconds Mod 60)\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 11371306, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tD2mN8vFShQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc63TLMUNIivoxfvFBasorOU2Oixw/mo/photo.jpg?sz=128", "display_name": "ARCHER1919", "link": "https://stackoverflow.com/users/11371306/archer1919"}, "edited": false, "score": 0, "creation_date": 1555491180, "post_id": 55720972, "comment_id": 98126289, "body": "Thank you again to everyone who helped solve this problem for me.  I&#39;ve been at this for less than a week so it was definitely a huge help!  Cheers!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11370591"}, "is_accepted": true, "score": 2, "last_activity_date": 1555481423, "creation_date": 1555481423, "answer_id": 55720972, "question_id": 55719581, "link": "https://stackoverflow.com/questions/55719581/is-there-a-way-to-get-worksheetfunction-randbetween-to-work-for-a-time-range/55720972#55720972", "title": "Is there a way to get worksheetfunction.randbetween to work for a time range?", "body": "<p><strong>Randomize/Rnd method</strong></p>\n\n<p>After <code>Randomize</code>, <code>Rnd</code> generates a pseudo-random decimal number between zero and one each time it is called. If your times are full time values (e.g. 23:59:45) then convert the strings returned by the input boxes using the TimeValue string-to-double conversion and use some math to force the Rnd value(s) inside the start and stop times.</p>\n\n<pre><code>Private Sub Generate_Data_Button_Click()\n\n    Dim emptyRow As Long, tstart As Double, tend As Double\n\n    'convert string times from input to true time as double\n    tstart = TimeValue(start_time_textbox.Value)\n    tend = TimeValue(end_time_textbox.Value)\n\n    Randomize\n\n    'Make Data Active\n    With Worksheets(\"Data\")\n\n        'Determine emptyRow in COLUMN D\n        emptyRow = .Cells(.Rows.Count, \"D\").End(xlUp).Row + 1\n\n        'Transfer information to template\n        .Cells(emptyRow, \"D\").Value = (tend - tstart) * Rnd() + tstart\n\n        'Format cell on template\n        .Cells(emptyRow, \"D\").NumberFormat = \"hh:mm:ss\"\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>RandBetween method</strong></p>\n\n<p>To use the worksheet's Randbetween function you need to convert the start time and end times to long integers representing the number of seconds since midnight then randomize between them. Take the result and convert it back to a time value by diving by the number of seconds in a day.</p>\n\n<pre><code>Private Sub Generate_Data_Button_Click2()\n\n    Dim emptyRow As Long, tstart As Long, tend As Long, siad As Long\n\n    siad = 86400 'seconds in a day\n\n    'convert string times from input to seconds in a day as Long Integer\n    tstart = TimeValue(start_time_textbox.Value)  * siad\n    tend = TimeValue(end_time_textbox.Value)  * siad\n\n\n    'Make Data Active\n    With Worksheets(\"Data\")\n\n        'Determine emptyRow in COLUMN D\n        emptyRow = .Cells(.Rows.Count, \"D\").End(xlUp).Row + 1\n\n        'Transfer information to template\n        .Cells(emptyRow, \"D\").Value = Application.RandBetween(tstart, tend) / siad\n\n        'Format cell on template\n        .Cells(emptyRow, \"D\").NumberFormat = \"hh:mm:ss\"\n\n    End With\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11371306, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tD2mN8vFShQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc63TLMUNIivoxfvFBasorOU2Oixw/mo/photo.jpg?sz=128", "display_name": "ARCHER1919", "link": "https://stackoverflow.com/users/11371306/archer1919"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 1, "accepted_answer_id": 55720972, "answer_count": 2, "score": 0, "last_activity_date": 1555481423, "creation_date": 1555472873, "last_edit_date": 1555478789, "question_id": 55719581, "link": "https://stackoverflow.com/questions/55719581/is-there-a-way-to-get-worksheetfunction-randbetween-to-work-for-a-time-range", "title": "Is there a way to get worksheetfunction.randbetween to work for a time range?", "body": "<p>I'm very new to coding and just want to thank everyone on this site who has already helped me so much.  </p>\n\n<p>I'm trying to build a random time generator that will generate a random time within a range specified by the user.  I am currently using the WorksheetFunction.Randbetween command which effectively generates a random time, however it is not within the specified range.  This code is part of a larger userform which does similar functions.  The rest of the code works fine(ish).</p>\n\n<p>My question:  What do I need to add to my line of code to get it to effectively generate time within the specified range?  I also need to make sure it works off of 24h \"HH:MM:SS\" or \"HH:MM\" format.  </p>\n\n<p>I've tried using Round and WorksheetFunction.Randbetween</p>\n\n<pre><code>Private Sub Generate_Data_Button_Click()\n\nDim emptyRow As Long\n\nRandomize \n\n'Make Data Active\nSheet1.Activate\n\n'Determine emptyRow\nemptyRow = WorksheetFunction.CountA(Range(\"A:A\"))+1\n\n'Transfer information to template\nCells(emptyRow, 4).Value = WorksheetFunction.Randbetween (start_time_textbox.value, end_time_textbox.value) + Rnd()\n\n'Format cell on template\nCells(emptyRow, 4).NumberFormat = \"hh:mm:ss\"\n\nEnd Sub \n\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 2892, "user_id": 1935222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gx2zd.png?s=128&g=1", "display_name": "4dmonster", "link": "https://stackoverflow.com/users/1935222/4dmonster"}, "edited": false, "score": 0, "creation_date": 1555478580, "post_id": 55719269, "comment_id": 98120552, "body": "Simultaneous writing by 32bit and 64bit versions of any library will corrupt the database. But usually <code>compact and repair</code> menu fixes it."}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 2892, "user_id": 1935222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gx2zd.png?s=128&g=1", "display_name": "4dmonster", "link": "https://stackoverflow.com/users/1935222/4dmonster"}, "edited": false, "score": 0, "creation_date": 1555480897, "post_id": 55719269, "comment_id": 98121314, "body": "@4dmonster unfortunately <code>compact and repair</code> could not save and restore my database. Kept getting <code>Run-time error 3343 Unrecognized Database Format</code> error"}, {"owner": {"reputation": 2892, "user_id": 1935222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gx2zd.png?s=128&g=1", "display_name": "4dmonster", "link": "https://stackoverflow.com/users/1935222/4dmonster"}, "edited": false, "score": 0, "creation_date": 1555481729, "post_id": 55719269, "comment_id": 98121627, "body": "try <code>JetComp</code> utility from Microsoft, or try to <code>Compat and repair</code> by different versions of Access. And may be source of corruption is network failure (as I understand <code>Z:</code> is mapped network share)"}], "owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1556299321, "creation_date": 1555470218, "last_edit_date": 1556299321, "question_id": 55719269, "link": "https://stackoverflow.com/questions/55719269/is-it-ideal-to-use-a-mdb-file-type-over-accdb-file-type", "title": "Is it ideal to use a .MDB file type over .ACCDB file type?", "body": "<p>I am running several macros that perform read and write commands to MS Access using <code>DAO</code> in Excel. My current file type is <code>.MDB</code> I encountered database corruption after 2 weeks of running back and forth read and writes to MS Access. I was previously referencing <code>Microsoft DAO 3.6 Object Library</code> but switched over to <code>Microsoft Office 16.0 Access database engine Object Library</code>. Could my database corruption be due to file type and connection type, or just referencing the wrong library? I am providing the code is use to upload and retrieve data from MS Access.</p>\n\n<p><strong>Load Table from MS Access to Excel</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub loadData()\nDim db As DAO.Database\nDim rst As DAO.Recordset\nDim qdf As DAO.QueryDef\n\nSet db = OpenDatabase(\"Z:\\UBPB CRM Project\\pbsbackup.mdb\")\nSet qdf = db.QueryDefs(\"pbsload\")\nqdf!pbsbranch = initialLogin.ComboBox1\n\nSet rst = qdf.OpenRecordset\n\nIf rst.EOF Then\n    rst.Close\n\nEnd If\n\n    Do\n\nSheet3.Range(\"A8\").CopyFromRecordset rst\n    Loop Until rst.EOF\n\nrst.Close\n\nSet rst = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><strong>Add record from Excel userform to MS Access</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub AddnewRecord()\n\nDim db As Database\nDim qdf As QueryDef\n\nApplication.StatusBar = \"Connecting to PBS Database......\"\nSet db = OpenDatabase(\"Z:\\UBPB CRM Project\\pbsbackup.mdb\")\nSet qdf = db.QueryDefs(\"addclient\")\n\n\nApplication.CalculateUntilAsyncQueriesDone\n\nApplication.StatusBar = \"Uploading Client Data to PBS server....\"\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n\n    qdf!pbsbranch = Sheet4.Range(\"A2\")\n    qdf!pbsclient = addnewClient.client\n    qdf!pbspriority = addnewClient.priority_\n    qdf!pbscontact = addnewClient.contact\n    qdf!pbsresult = addnewClient.result\n    qdf!pbsnextsteps = addnewClient.segmentType\n    qdf!pbsattempts = addnewClient.Label11\n    qdf!pbsnotes = addnewClient.notes\n\n\nqdf.Execute dbFailOnError\n\n\nqdf.Close\n\nApplication.StatusBar = \"Upload Successful!\"\n\nSet qdf = Nothing\nSet cdb = Nothing\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p><strong>Update record from Excel userform to MS Access</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub pbsupdate()\nDim db As Database\nDim qdf As QueryDef\n\nApplication.StatusBar = \"Connecting to PBS Database......\"\nSet db = OpenDatabase(\"Z:\\UBPB CRM Project\\pbsbackup.mdb\")\nSet qdf = db.QueryDefs(\"pbsupdate\")\n\nApplication.StatusBar = \"Uploading Client Data to PBS server....\"\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n\n    qdf!pbskey = dialer.key\n    qdf!pbsclient = dialer.client\n    qdf!pbspriority = dialer.priority_\n    qdf!pbssource = dialer.priority\n    qdf!pbslastcontact = dialer.contact\n    qdf!pbsresult = dialer.result\n    qdf!pbsnextsteps = dialer.segmentType\n    qdf!pbsattempts = dialer.Label11 + dialer.Label11 + 1\n    qdf!pbsnotes = dialer.notes\n\n\nApplication.CalculateUntilAsyncQueriesDone\n\n    qdf.Execute dbFailOnError\n\nqdf.Close\ndb.Close\nApplication.StatusBar = \"Upload Successful!\"\n\nSet qdf = Nothing\nSet cdb = Nothing\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1555469377, "post_id": 55719163, "comment_id": 98118389, "body": "Where and when is this code being called? Do you have any worksheets in the workbook? Is one of those sheets named <i>Sheet1</i>? Do you have anything in cell A1?"}, {"owner": {"reputation": 3, "user_id": 11371514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HcHVklzvW_s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfg5f-Faqk6xbA-iIwBV-EpeW-Edg/mo/photo.jpg?sz=128", "display_name": "Joseph Park", "link": "https://stackoverflow.com/users/11371514/joseph-park"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1555469592, "post_id": 55719163, "comment_id": 98118426, "body": "It&#39;s in &#39;Excel VBA Programming for Dummies&#39; 3rd Edition, page 60.  Yes the only sheet I have in my workbook is Sheet1, and my cell A1 contains random digits that I just put to test the code."}, {"owner": {"reputation": 3, "user_id": 11371514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HcHVklzvW_s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfg5f-Faqk6xbA-iIwBV-EpeW-Edg/mo/photo.jpg?sz=128", "display_name": "Joseph Park", "link": "https://stackoverflow.com/users/11371514/joseph-park"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1555469859, "post_id": 55719163, "comment_id": 98118486, "body": "What do you mean by &quot;Where and when is this code being called?&quot; then?  I have re-read the section again, that&#39;s the beginning of the section."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1555469975, "post_id": 55719163, "comment_id": 98118506, "body": "I mean <i>Where exactly did you type that code (in what module)? And where are you calling (invoking) that macro from exactly?</i>"}, {"owner": {"reputation": 3, "user_id": 11371514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HcHVklzvW_s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfg5f-Faqk6xbA-iIwBV-EpeW-Edg/mo/photo.jpg?sz=128", "display_name": "Joseph Park", "link": "https://stackoverflow.com/users/11371514/joseph-park"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1555470939, "post_id": 55719163, "comment_id": 98118681, "body": "I typed the code in module 1, calling from VBE"}], "answers": [{"comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1555470048, "post_id": 55719243, "comment_id": 98118525, "body": "Good catch. I didn&#39;t notice the smart quotes."}, {"owner": {"reputation": 3, "user_id": 11371514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HcHVklzvW_s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfg5f-Faqk6xbA-iIwBV-EpeW-Edg/mo/photo.jpg?sz=128", "display_name": "Joseph Park", "link": "https://stackoverflow.com/users/11371514/joseph-park"}, "edited": false, "score": 0, "creation_date": 1555470862, "post_id": 55719243, "comment_id": 98118663, "body": "Thank you, would there be no situation the original code above would work?  I have a suspicion that the book may be outdated."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 11371514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HcHVklzvW_s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfg5f-Faqk6xbA-iIwBV-EpeW-Edg/mo/photo.jpg?sz=128", "display_name": "Joseph Park", "link": "https://stackoverflow.com/users/11371514/joseph-park"}, "edited": false, "score": 0, "creation_date": 1555471122, "post_id": 55719243, "comment_id": 98118717, "body": "@JosephPark the code will work, that&#39;s not the issue. It&#39;s the technical quotes you used, see how what I posted are &quot;normal&quot; double quotes and yours are a little more &quot;stylized&quot;? (Sorry, I don&#39;t know what the term is for the ones you used ...smart quotes I guess, per Ken)"}, {"owner": {"reputation": 3, "user_id": 11371514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HcHVklzvW_s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfg5f-Faqk6xbA-iIwBV-EpeW-Edg/mo/photo.jpg?sz=128", "display_name": "Joseph Park", "link": "https://stackoverflow.com/users/11371514/joseph-park"}, "edited": false, "score": 0, "creation_date": 1555471348, "post_id": 55719243, "comment_id": 98118767, "body": "I see now, now it&#39;s working.  Thanks a lot to both of you."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 11371514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HcHVklzvW_s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfg5f-Faqk6xbA-iIwBV-EpeW-Edg/mo/photo.jpg?sz=128", "display_name": "Joseph Park", "link": "https://stackoverflow.com/users/11371514/joseph-park"}, "edited": false, "score": 0, "creation_date": 1555474502, "post_id": 55719243, "comment_id": 98119412, "body": "(@JosephPark - If this worked, you can flag it as the answer by clicking the check mark left of the post)"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1555503181, "post_id": 55719243, "comment_id": 98133299, "body": "They&#39;re called <a href=\"https://www.fonts.com/content/learning/fyti/typographic-tips/smart-quotes\" rel=\"nofollow noreferrer\">smart quotes</a>"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1555470155, "last_edit_date": 1555470155, "creation_date": 1555469879, "answer_id": 55719243, "question_id": 55719163, "link": "https://stackoverflow.com/questions/55719163/how-to-fix-subscript-out-of-range-error-in-a-simple-code/55719243#55719243", "title": "How to fix &quot;subscript out of range&quot; error in a simple code", "body": "<p>Guessing, since it's a simple macro, but the quotes you used (assuming what we see here is exactly what's in your Module/Sheet code) may not work with VBA.</p>\n\n<pre><code>Sub ShowValue()\nDim contents As String\n    contents = Worksheets(\"Sheet1\").Range(\"A1\").Value\n    MsgBox (contents)\nEnd Sub\n</code></pre>\n\n<p>As far as @KenWhite asking <em>where</em> your code is, it's either in a Worksheet, or Module.  I put the above in a Worksheet which you can see in the VBEditor window.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LTne1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LTne1.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 11371514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HcHVklzvW_s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfg5f-Faqk6xbA-iIwBV-EpeW-Edg/mo/photo.jpg?sz=128", "display_name": "Joseph Park", "link": "https://stackoverflow.com/users/11371514/joseph-park"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 55719243, "answer_count": 1, "score": 0, "last_activity_date": 1555470155, "creation_date": 1555469191, "last_edit_date": 1555469273, "question_id": 55719163, "link": "https://stackoverflow.com/questions/55719163/how-to-fix-subscript-out-of-range-error-in-a-simple-code", "title": "How to fix &quot;subscript out of range&quot; error in a simple code", "body": "<p>I'm starting to learn how to write VBA codes with the VBA for Dummies book.\nThere is this code that I literally copy and paste from the book but it gives me an error.</p>\n\n<p>Can you please help?</p>\n\n<pre><code>Sub ShowValue()\n\n    Contents = Worksheets(\u201cSheet1\u201d).Range(\u201cA1\u201d).Value\n    MsgBox Contents\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1555465069, "post_id": 55718646, "comment_id": 98117533, "body": "If you are willing to accept <i>any</i> string input, then why bother using a regex at all?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1555466070, "post_id": 55718646, "comment_id": 98117759, "body": "Do you need to also match <code>newline</code>?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1555474179, "post_id": 55718646, "comment_id": 98119342, "body": "[/S/s]* matches everything"}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1600819943, "post_id": 55718646, "comment_id": 113206909, "body": "Fly by downvoter a year later with no comments? Please tell me what to improve in this question."}], "answers": [{"tags": [], "owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "is_accepted": true, "score": 3, "last_activity_date": 1559186366, "last_edit_date": 1559186366, "creation_date": 1555464807, "answer_id": 55718671, "question_id": 55718646, "link": "https://stackoverflow.com/questions/55718646/use-wildcard-with-regex-in-vba-to-match-anything/55718671#55718671", "title": "Use Wildcard (*) with RegEx in VBA to match anything", "body": "<pre><code>. \"Wildcard.\" The unescaped period matches any character, except a new line. \n\nstrPattern = \".\"\n</code></pre>\n\n<p>Or as @RonRosenfeld pointed out, if you need to match everything INCLUDING a \"new line\" then this would work.</p>\n\n<pre><code>strPattern = \"[/S/s]*\" \n</code></pre>\n\n<p><a href=\"https://wellsr.com/vba/2018/excel/vba-regex-regular-expressions-guide/\" rel=\"nofollow noreferrer\">https://wellsr.com/vba/2018/excel/vba-regex-regular-expressions-guide/</a>  </p>\n"}], "owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 55718671, "answer_count": 1, "score": -1, "last_activity_date": 1559187963, "creation_date": 1555464538, "last_edit_date": 1559187963, "question_id": 55718646, "link": "https://stackoverflow.com/questions/55718646/use-wildcard-with-regex-in-vba-to-match-anything", "title": "Use Wildcard (*) with RegEx in VBA to match anything", "body": "<p>I'm trying to use Regex to match any character (This is just a piece of code from a larger project). I got the below to work, but seems like it is wrong, is there a proper way to search for any character via RegEx?</p>\n\n<pre><code>strPattern = \"([!@#$%^&amp;*()]?[a-z]?[0-9]?)\"\n</code></pre>\n\n<p>Eg: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">MCVE</a></p>\n\n<pre><code>Public Sub RegExSearch()\n    Dim regexp As Object\n    Dim rng As Range, rcell As Range\n    Dim strInput As String, strPattern As String\n\n    Set regexp = CreateObject(\"vbscript.regexp\")\n    Set rng = ActiveSheet.Range(\"A1:A1\")\n\n    With regexp \n    .Global = False \n    .MultiLine = False \n    .ignoreCase = True \n    .Pattern = strPattern \n    End With\n\n    For Each rcell In rng.Cells\n\n        strPattern = \"([!@#$%^&amp;*()]?[a-z]?[0-9]?)\" ' This matches everything, but seems improper\n\n        If strPattern &lt;&gt; \"\" Then\n            strInput = rcell.Value\n\n            If regexp.test(strInput) Then\n                MsgBox rcell &amp; \" Matched in Cell\" &amp; rcell.Address\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 1, "creation_date": 1555586809, "post_id": 55718249, "comment_id": 98166790, "body": "What do you have the .preferredwidth property set as.  <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.table.preferredwidth\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a>"}], "owner": {"reputation": 1969, "user_id": 10438814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ENK8.jpg?s=128&g=1", "display_name": "morgan121", "link": "https://stackoverflow.com/users/10438814/morgan121"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3151, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1555463089, "creation_date": 1555460617, "last_edit_date": 1555463089, "question_id": 55718249, "link": "https://stackoverflow.com/questions/55718249/autofit-to-content-then-to-window-issues", "title": "Autofit to content then to window issues", "body": "<p>I am trying to write a script to autofit tables first to content, then to window n Word 2010, as long as they are at least a certain width. </p>\n\n<p>When I manually autofit to content then to window, the tables look nice and evenly spaced, however if I ONLY autofit to window they tend to have really wide first columns and squished up other columns.</p>\n\n<p><strong>code:</strong></p>\n\n<pre><code>Sub AutoFitTables()\n\n  If ActiveDocument.Tables.Count &gt; 0 Then\n    Dim objTable As Object\n\n    Application.Browser.Target = wdBrowseTable\n    For Each objTable In ActiveDocument.Tables\n      ' Check the table width \n      If objTable.Columns.Width &gt; 11520 Then\n        objTable.AutoFitBehavior (wdAutoFitContent)\n        ' Again only fit tables above a certain width\n        If objTable.Columns.Width &gt; 11520 Then\n           objTable.AutoFitBehavior (wdAutoFitWindow)\n        End If\n      End If\n    Next\n  End If\n\nEnd Sub\n</code></pre>\n\n<p><strong>issue:</strong></p>\n\n<p>The result is the same as when I manually ONLY auto fit to window. It's like it ignores the autofit to contents first</p>\n\n<p>Is there something that I'm missing here? Or does anyone have suggestion of how to achieve the same effect as manually fitting to content, then to window?</p>\n\n<p><strong>edit:</strong></p>\n\n<p>It also seems to be ignoring the width constraint. I believe the table with is returned in Twips, so there should be only 11907 along the short edge and 16840 along the long edge, but not matter how large I set the cutoff (eg <code>objTable.Columns.Width &gt; 20000</code>) it still autofits all tables. So if anyone knows why that is happening that would be helpful too</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1555466567, "post_id": 55718205, "comment_id": 98117859, "body": "I am surprised you can even run the code. I get syntax error on the Dim line. Array() is an intrinsic function. Use something else for your array name, like: aryInt. You ReDim the array but I don&#39;t see any code to populate the array."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 2, "creation_date": 1555467528, "post_id": 55718205, "comment_id": 98118068, "body": "UBound has no value so of course get out of bound error. Certainly can be done but not clear what you are trying to do. Where do the values come from? What is <code>bulkjob</code>?"}, {"owner": {"reputation": 326, "user_id": 7061680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22002c39dcc7e46b3beab7af3d0d2c80?s=128&d=identicon&r=PG&f=1", "display_name": "BankBuilder", "link": "https://stackoverflow.com/users/7061680/bankbuilder"}, "edited": false, "score": 0, "creation_date": 1555467804, "post_id": 55718205, "comment_id": 98118118, "body": "You could also use a Collection if you want a dynamic array-like structure"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1555494928, "creation_date": 1555494928, "answer_id": 55724853, "question_id": 55718205, "link": "https://stackoverflow.com/questions/55718205/how-to-populate-a-dynamic-array-in-ms-access/55724853#55724853", "title": "How to populate a dynamic array in MS Access?", "body": "<p>Not quite clear what you are trying to do, but this could get you some ideas:</p>\n\n<pre><code>Public Function BuildJobs(Id As Integer)\n\n    Static bulkJob()    As Integer\n    Dim Upper           As Integer\n\n    On Error Resume Next\n    Upper = UBound(bulkJob) + 1\n    On Error GoTo 0\n\n    ReDim Preserve bulkJob(Upper)\n    ' Fill in value.\n    bulkJob(Upper) = Id\n\n    ' Do something.\n    Debug.Print UBound(bulkJob), bulkJob(Upper)\n\nEnd Function\n</code></pre>\n\n<p>\"Restart\" the array like this:</p>\n\n<pre><code>ReDim bulkJob(0)\nbulkJob(0) = 0\n</code></pre>\n"}], "owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 55724853, "answer_count": 1, "score": 0, "last_activity_date": 1555494928, "creation_date": 1555460146, "question_id": 55718205, "link": "https://stackoverflow.com/questions/55718205/how-to-populate-a-dynamic-array-in-ms-access", "title": "How to populate a dynamic array in MS Access?", "body": "<p>I have a dynamic array that I want to append values to. The number of values to be appended is not fixed</p>\n\n<p>I was trying to do something like this:</p>\n\n<pre><code>Dim array() As Integer\nReDim Preserve array(UBound(array)+1)\nbulkJob(UBound(array) + 1) = Me.ID\n</code></pre>\n\n<p>I get subscript out of range error at <code>ReDim Preserve array(UBound(array)+1)</code>. Is there a way to do this?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1555463514, "post_id": 55718166, "comment_id": 98117259, "body": "A wildcard before a backslash followed by a filename isn&#39;t valid. You can see this for yourself by opening a command window and typing <code>dir s*\\nope.txt</code> and hitting enter; you&#39;ll see <i>The filename, directory name, or volume label syntax is incorrect.</i>. If the pathname isn&#39;t valid at the command prompt, it&#39;s not going to be valid in <code>Dir()</code> either."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11371154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87f3942e7f6a35a3942ebc1fe3e23d6?s=128&d=identicon&r=PG&f=1", "display_name": "JulioG", "link": "https://stackoverflow.com/users/11371154/juliog"}, "edited": false, "score": 0, "creation_date": 1555466426, "post_id": 55718788, "comment_id": 98117829, "body": "Thanks for the reply. I have found a solution that works, similar to yours. Basically I just needed to know if the file existed in a sub-folder, and if not, file it. If it already exists in a sub-folder,t hen it has already been filed, so I can discard it."}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 0, "last_activity_date": 1555465659, "creation_date": 1555465659, "answer_id": 55718788, "question_id": 55718166, "link": "https://stackoverflow.com/questions/55718166/dir-does-not-recognize-wildcard/55718788#55718788", "title": "DIR does not recognize wildcard &quot;*&quot;", "body": "<p>Wildcards are used to return all file or folder names in a directory. Using the Dir() function with parameters changes the path in which the function will search for files.  Subsequent calls to the Dir() function will return the next file or folder after the previous call. The Dir() will not search subdirectories for a file.</p>\n\n<p>You will need to do a recursive set the Dir() Attributes parameter to vbDirectory to return the subfolder names then search each subfolder.</p>\n\n<p>You can find plenty of examples that use the FileSystemObject to recursively search subfolder for a file.  I thought that it would be interesting to write one that uses the Dir() function. </p>\n\n<pre><code>Function FindFile(ByVal folderName As String, ByVal FileName As String, Optional ByRef FoundFile As String) As String\n    Dim search As String\n    Dim dirList As New Collection\n\n    If Not Right(folderName, 1) = \"\\\" Then folderName = folderName &amp; \"\\\"\n    search = Dir(folderName &amp; \"\\*\", vbDirectory)\n    While Len(search) &gt; 0\n        If Not search = \".\" And Not search = \"..\" Then\n            If GetAttr(folderName &amp; search) = 16 Then\n                dirList.Add folderName &amp; search\n            Else                 \n                If LCase(search) = LCase(FileName) Then\n                    FoundFile = folderName &amp; FileName\n                    FindFile = FoundFile\n                    Exit Function\n                End If\n            End If\n\n        End If\n        search = Dir()\n    Wend\n\n    Dim fld\n    For Each fld In dirList\n        If Len(FoundFile) &gt; 0 Then\n            FindFile = FoundFile\n            Exit Function\n        Else\n            FindFile = FindFile(CStr(fld), FileName, FoundFile)\n        End If\n    Next\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11371154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87f3942e7f6a35a3942ebc1fe3e23d6?s=128&d=identicon&r=PG&f=1", "display_name": "JulioG", "link": "https://stackoverflow.com/users/11371154/juliog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3271, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1555465659, "creation_date": 1555459816, "last_edit_date": 1555461867, "question_id": 55718166, "link": "https://stackoverflow.com/questions/55718166/dir-does-not-recognize-wildcard", "title": "DIR does not recognize wildcard &quot;*&quot;", "body": "<p>The following code does not find the file:\nxTempTmtl = \"Z:\\20.0 Global storage\\20.1 Design Packages*\" &amp; xNewName</p>\n\n<p>where xNewName = \"SLR-D&amp;C-MI0-000-TRS-007199.Pdf\"</p>\n\n<p>but</p>\n\n<p>xTempFol = Dir(\"Z:\\20.0 Global storage\\20.1 Design Packages\\DP01.1 Stops - Zone C (North)\\02. Transmittals\\\" &amp; xNewName) \nfinds the file.</p>\n\n<p>Problem is that the file xNewName could be in any one of 80 folders(Dp01.1..., DP01.2....) etc, then in \\02. Transmittals\\</p>\n\n<p>If I put a \\ after the *, I get Bad file name error.</p>\n\n<p>Why is the wildcard \"*\" not recognized?</p>\n\n<p>This happens on two separate machines, one running EXCEL2010 on a Windows&amp; PC and the other running EXCEL365 on a Windows10 laptop.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 475, "user_id": 464206, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/P5kGQ.jpg?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/464206/antonio"}, "is_accepted": false, "score": 0, "last_activity_date": 1555463411, "creation_date": 1555463411, "answer_id": 55718541, "question_id": 55718142, "link": "https://stackoverflow.com/questions/55718142/copy-entire-table-column-with-formulas/55718541#55718541", "title": "Copy entire table column with formulas", "body": "<p>I think I managed to solve it using:</p>\n\n<pre><code>Tbl.ListColumns(Position - 1).Range.Copy Tbl.ListColumns(Position).Range\n</code></pre>\n\n<p>after adding the column with <strong>Set NewCol = Tbl.ListColumns.Add(Position)</strong> like in my first example</p>\n"}], "owner": {"reputation": 475, "user_id": 464206, "user_type": "registered", "accept_rate": 23, "profile_image": "https://i.stack.imgur.com/P5kGQ.jpg?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/464206/antonio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1556024585, "creation_date": 1555459602, "last_edit_date": 1556024585, "question_id": 55718142, "link": "https://stackoverflow.com/questions/55718142/copy-entire-table-column-with-formulas", "title": "Copy entire table column with formulas", "body": "<p>I have an Excel Table and I am scrolling its columns to add new columns in the right position (sorted alphabetically)\nI would then like to copy all formulas from the previous (or following) column in the table. \nI have tried:</p>\n\n<pre><code>Columns(x).Copy\nActiveSheet.Paste\n</code></pre>\n\n<p>But I can't get it to work.\nBasically I have a userForm used to input the name of the new column (Cost Centre) and then scroll some columns to insert it in the right position, as follows:</p>\n\n<pre><code>Dim CDCName As String\nCDCName = txtCDC.Text\n\nDim Tbl As ListObject\nDim Col As ListColumn\nDim Position As Integer\n\nFor Each Col In Tbl.ListColumns\n    If Col.Index &gt; 5 And Col.Index &lt; Tbl.ListColumns.Count - 3 Then\n        If Col.Range(1, 0).Value &gt; CDCName Then\n            Position = Col.Index - 1\n            Set NewCol = Tbl.ListColumns.Add(Position)\n            Col.Range(1, -1).Value = CDCName\n            Unload Me\n            MsgBox \"Cost Centre \" &amp; CDCName &amp; \" added to table\"\n            Exit For\n        End If                \n    End If\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba", "colors", "sum", "series"], "comments": [{"owner": {"reputation": 2388, "user_id": 6481438, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gfYh4.png?s=128&g=1", "display_name": "GCSDC", "link": "https://stackoverflow.com/users/6481438/gcsdc"}, "edited": false, "score": 0, "creation_date": 1555458479, "post_id": 55717777, "comment_id": 98116278, "body": "Welcome to SO. You should be more specific on your question and post what you&#39;ve done so far to try to solve your issue. Also, unless you have a very specific reason to rely on conditional formatting and then macro, I would suggest you to include the logic for selecting the cells directly on the macro."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1555579010, "post_id": 55717777, "comment_id": 98162617, "body": "Welcome. If you haven&#39;t written VBA before, you should start by understanding the &quot;building blocks&quot; of the code that will help you perform the calculation you described. For example, you&#39;ll definitely need some kind of a loop. It could be either <code>Do-While</code>, <code>For i=... to ...</code> , <code>For-each</code> etc. Depending on which approach you&#39;ll use, you&#39;ll probably need an <code>If ...then...else</code> statement. I suggest you start by calculating a simple non conditional sum and gradually add parameters to your logic. You&#39;ll find plenty of references in here. I could post the code, but the point is for you to learn."}], "owner": {"reputation": 9, "user_id": 11371038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cefaf689de9b4b0d2372ddc41db0bf38?s=128&d=identicon&r=PG&f=1", "display_name": "kennedy", "link": "https://stackoverflow.com/users/11371038/kennedy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555456444, "creation_date": 1555456444, "question_id": 55717777, "link": "https://stackoverflow.com/questions/55717777/how-to-sum-a-series-of-cells-until-cell-color-then-continue-after-cell-color-for", "title": "How to sum a series of cells until cell color then continue after cell color for rest of range in VBA?", "body": "<p>I am trying to determine the sum of the data points between cells that have been conditionally formatted (GREEN) based on their values. </p>\n\n<p>I'm not sure where to start my VBA code to sum all of the WHITE cells before a GREEN cell and place that sum in another location (ex. \"A66\") then sum the WHITE cells between the first GREEN cell and the second GREEN cell and place that in \"A67\". </p>\n\n<p>I would like the code to continue summing the white cells until it gets to a green cell and then stop, place that summed value in a cell, then start a new sum for the white cells after the green cell that just caused the code to stop until it gets to the next green cell and place that value in a cell below, repeat. </p>\n\n<p>I am NOT trying to sum all of the white cells in the range as a total.\n<a href=\"https://i.stack.imgur.com/GMbwP.png\" rel=\"nofollow noreferrer\">Data Sheet</a></p>\n"}, {"tags": ["vba", "loops", "conditional-formatting"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 9947192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbjbZ.jpg?s=128&g=1", "display_name": "RebaS", "link": "https://stackoverflow.com/users/9947192/rebas"}, "edited": false, "score": 0, "creation_date": 1555452378, "post_id": 55717134, "comment_id": 98114894, "body": "It worked! Thank you! I&#39;m curious why &quot;With cell&quot; instead of &quot;For each&quot;?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 47, "user_id": 9947192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbjbZ.jpg?s=128&g=1", "display_name": "RebaS", "link": "https://stackoverflow.com/users/9947192/rebas"}, "edited": false, "score": 0, "creation_date": 1555452906, "post_id": 55717134, "comment_id": 98115010, "body": "There are both &quot;For Each&quot; and &quot;With&quot;.  <code>With</code> is a little bit more efficient than repeating <code>cell</code> on each of those lines."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1555451694, "creation_date": 1555451694, "answer_id": 55717134, "question_id": 55716944, "link": "https://stackoverflow.com/questions/55716944/loop-to-conditionally-format-cells-in-ranges-over-multiple-worksheets/55717134#55717134", "title": "Loop to conditionally format cells in ranges over multiple worksheets", "body": "<p>Something like this (untested)</p>\n\n<pre><code>Sub comfor()\n    Dim ws As Worksheet, cell As Range\n\n    For Each ws In ActiveWorkbook.Sheets\n\n       For Each cell In ws.range(ws.range(\"A6\"), _\n                                 ws.Range(\"A6\").SpecialCells(xlLastCell)).cells\n           With cell  \n               If .Text = \"Complete\" Then\n                   .Font.Color = 5287936\n                   .Value =\"R\"\n                   .Font.Name = \"Wingdings 2\"\n               End If\n           End with\n\n        Next cell\n    Next ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 9947192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbjbZ.jpg?s=128&g=1", "display_name": "RebaS", "link": "https://stackoverflow.com/users/9947192/rebas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18, "favorite_count": 1, "accepted_answer_id": 55717134, "answer_count": 1, "score": 0, "last_activity_date": 1555451694, "creation_date": 1555450618, "question_id": 55716944, "link": "https://stackoverflow.com/questions/55716944/loop-to-conditionally-format-cells-in-ranges-over-multiple-worksheets", "title": "Loop to conditionally format cells in ranges over multiple worksheets", "body": "<p>I'm trying to conditionally format cells across multiple worksheets. The size of range varies per sheet (and possibly month-to-month). Each sheet will have a header and the number of columns will be different, but the data to be formatted will always start at A6.</p>\n\n<p>I successfully selected the last cell on each sheet and I successfully formatted a few cells on each worksheet. However, when I try to combine the steps I am unsuccessful.</p>\n\n<pre><code>Sub comfor()\nDim ws As Worksheet, LstR As Range\nFor Each ws In ActiveWorkbook.Sheets\n  Set LstR = ws.Range(\"A6\").SpecialCells(xlLastCell)\n       For Each cell In LstR\n         If cell.Text = \"Complete\" Then\n            cell.Font.Color = 5287936\n            cell.Replace What:=\"Complete\", Replacement:=\"R\"\n            cell.Font.Name = \"Wingdings 2\"\n        End If\n        Next cell\n  Next ws\nEnd Sub\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba", "web", "copy"], "comments": [{"owner": {"reputation": 167, "user_id": 9639219, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGPTz.jpg?s=128&g=1", "display_name": "SpaghettiCode", "link": "https://stackoverflow.com/users/9639219/spaghetticode"}, "edited": false, "score": 1, "creation_date": 1555468462, "post_id": 55716685, "comment_id": 98118221, "body": "Can you post the complete HTML code for that table? If not, you need to loop through the table. In that case, you also need to declare a variable that can hold multiple elements. Also, make sure that the text is generated before you retrieve it. You can test it using <code>Do Until trim(var)&lt;&gt;vbNullString</code>. Also, <code>Set</code> statement is used for objects not strings. So you may want to remove that <code>Set</code> statement before <code>elem</code> variable in your code."}, {"owner": {"reputation": 35, "user_id": 11370463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b29f6e25b83077538140e9f97af1f73e?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/11370463/david"}, "reply_to_user": {"reputation": 167, "user_id": 9639219, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGPTz.jpg?s=128&g=1", "display_name": "SpaghettiCode", "link": "https://stackoverflow.com/users/9639219/spaghetticode"}, "edited": false, "score": 0, "creation_date": 1555617977, "post_id": 55716685, "comment_id": 98182533, "body": "Hi SpaghettiCode, many thanks for your advice! I have managed to get the table with Qharr&#39;s code below."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11370463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b29f6e25b83077538140e9f97af1f73e?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/11370463/david"}, "edited": false, "score": 0, "creation_date": 1555619467, "post_id": 55723850, "comment_id": 98183056, "body": "Hi QHarr, thanks very much for correcting my code!! I tried to run your code but encountered &quot;run time error 424&quot; initially. So I removed the part of your code between &quot;With&quot; and &quot;End With&quot; and entered login details manually then your code worked as I could see the table being copied to the sheet! Thanks a lot!"}, {"owner": {"reputation": 35, "user_id": 11370463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b29f6e25b83077538140e9f97af1f73e?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/11370463/david"}, "edited": false, "score": 0, "creation_date": 1555623515, "post_id": 55723850, "comment_id": 98184397, "body": "Hi QHarr, I have modified your code to try to get a sequence of similar tables - please see my updated code above. However, these tables copied into respective sheets are exactly the same, that is, the table for the first variable/sheet has been replicated to the other sheets which are created for different variables - the tables should be different on different sheets. What&#39;s wrong with my new code? Your advice again would be very appreciated!"}, {"owner": {"reputation": 35, "user_id": 11370463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b29f6e25b83077538140e9f97af1f73e?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/11370463/david"}, "edited": false, "score": 0, "creation_date": 1555653659, "post_id": 55723850, "comment_id": 98190072, "body": "Hi QHarr, thanks for your advice and sorry for the confusion - I am still new to this web. Following your advice, I have restored the original question and posted a new question at: <a href=\"https://stackoverflow.com/questions/55757268/vba-code-to-copy-table-from-webpage-into-excel\" title=\"vba code to copy table from webpage into excel\">stackoverflow.com/questions/55757268/&hellip;</a>    Again, your help would be very appreciated!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 35, "user_id": 11370463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b29f6e25b83077538140e9f97af1f73e?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/11370463/david"}, "edited": false, "score": 0, "creation_date": 1555653794, "post_id": 55723850, "comment_id": 98190098, "body": "@David If only everyone responded so positively :-) I will have a look. As before, it is likely I won&#39;t be able to test the code fully."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1555492013, "creation_date": 1555492013, "answer_id": 55723850, "question_id": 55716685, "link": "https://stackoverflow.com/questions/55716685/vba-code-to-copy-table-data-from-webpage-into-excel/55723850#55723850", "title": "VBA code to copy table data from webpage into Excel", "body": "<p>If after the earnings detail table you need a different selector. I am showing a css selector for that table. Your current selector (class), and index 0, is matching on a breadcrumb (nav tree). That class is also not correct for selecting the table on the page.</p>\n\n<pre><code>.earningsHistoryTable-Cont table\n</code></pre>\n\n<p>I cannot test this but you may also want a timed loop for table to be present</p>\n\n<pre><code>Option Explicit\n\n'VBE &gt; Tools &gt; References:\n' Microsoft Internet Controls\nPublic Sub RetrieveInfo()\n    Dim IE As InternetExplorer, hTable As Object, clipboard As Object, t As Date\n    Const MAX_WAIT_SEC As Long = 5\n\n    Set clipboard = GetObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n    Set IE = New InternetExplorer\n\n    With IE\n        .Visible = True\n        .Navigate2 \"https://eresearch.fidelity.com/eresearch/evaluate/fundamentals/earnings.jhtml?tab=details&amp;symbols=GOOG\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document\n            .querySelector(\"#userId\").Value = \"xyz\"\n            .querySelector(\"#password\").Value = \"123456\"\n            .querySelector(\"form\").submit\n        End With\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        t = Timer                                'timed loop for details table to be present\n        Do\n            On Error Resume Next\n            Set hTable = IE.document.querySelector(\".earningsHistoryTable-Cont table\")\n            On Error GoTo 0\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While hTable Is Nothing\n        If Not hTable Is Nothing Then  'use clipboard to copy paste\n            clipboard.SetText hTable.outerHTML\n            clipboard.PutInClipboard\n            ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").PasteSpecial\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11370463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b29f6e25b83077538140e9f97af1f73e?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/11370463/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1002, "favorite_count": 0, "accepted_answer_id": 55723850, "answer_count": 1, "score": 2, "last_activity_date": 1555653115, "creation_date": 1555449185, "last_edit_date": 1555653115, "question_id": 55716685, "link": "https://stackoverflow.com/questions/55716685/vba-code-to-copy-table-data-from-webpage-into-excel", "title": "VBA code to copy table data from webpage into Excel", "body": "<p>I wish to copy data from a table on a webpage into Excel using VBA code but didn't get anything on the Excel sheet :(.</p>\n\n<p>I have tried to put together some VBA code from different sources. Here is my code:</p>\n\n<pre><code>Sub CopyWebData()\n\nDim IE As Object\n\nOn Error Resume Next\nApplication.DisplayAlerts = False\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\n    With IE\n        .Visible = True\n        .navigate \"https://eresearch.fidelity.com/eresearch/evaluate/fundamentals/earnings.jhtml?tab=details&amp;symbols=GOOG\"\n        Do Until .readyState = 4: DoEvents: Loop\n    End With\n\nDim idoc As MSHTML.HTMLDocument\nDim elem As MSHTML.IHTMLElement\n\nSet idoc = IE.document\nSet elem = idoc.getElementsByClassName(\"layout-outer-table-width\")(0).innerText\n\nSheets(\"Sheet1\").Activate\nRange(\"A1:A1000\") = \"\" ' erase previous data\nRange(\"A1\").Select\nRange(\"A1\").Value = elem\n\nEnd Sub\n</code></pre>\n\n<p>This is a password-protected webpage and I have logged in so I can see the webpage has been successfully pulled out by the VBA code. However, the data in the table on this webpage failed to be copied into excel - I saw nothing on the destination worksheet. </p>\n\n<p>As you can see, I used code .getElementsByClassName(\"layout-outer-table-width\") since I used Chrome's \"Inspect\" function to check the webpage and found that when the mouse was hovering over the statements:</p>\n\n<pre><code>...&lt;table cellspacing=\"0\" cellpadding=\"0\" border=\"0\" class=\"layout-outer-table-width\"&gt; == $0\n\n &lt;tbody&gt;...&lt;/tbody&gt;\n\n &lt;/table&gt;\n</code></pre>\n\n<p>part of the webpage covering the table I need was shaded. I then coded in the class name \"layout-outer-table-width\". However, as I said, I didn't see anything appearing on the Excel sheet.</p>\n\n<p>Any instruction would be much appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1555451846, "post_id": 55716605, "comment_id": 98114773, "body": "Loop over array1, and check if each element is in array2: if not then add to array3."}, {"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1555452428, "post_id": 55716605, "comment_id": 98114905, "body": "Are the arrays guaranteed to be in order?"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1555454218, "creation_date": 1555454218, "answer_id": 55717502, "question_id": 55716605, "link": "https://stackoverflow.com/questions/55716605/remove-one-array-from-a-bigger-one/55717502#55717502", "title": "Remove one array from a bigger one?", "body": "<p>loop the first array and use <code>Application.Match</code> to search the second array.</p>\n\n<p>Load a 3rd array with those items that throw an error from the match:</p>\n\n<pre><code>Sub try()\n    Dim array1()\n    array1 = Array(\"A\", \"B\", \"C\", \"D\")\n\n    Dim array2()\n    array2 = Array(\"B\", \"C\")\n\n    Dim array3()\n    ReDim array3(0)\n\n    Dim i As Long\n    For i = LBound(array1) To UBound(array1)            \n        If IsError(Application.Match(array1(i), array2, 0)) Then\n            array3(UBound(array3)) = array1(i)\n            ReDim Preserve array3(UBound(array3) + 1)\n        End If\n    Next i\n\n    ReDim Preserve array3(UBound(array3) - 1)\n\n    Debug.Print Join(array3, \",\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11370591"}, "is_accepted": false, "score": 0, "last_activity_date": 1555455662, "last_edit_date": 1555455662, "creation_date": 1555455013, "answer_id": 55717622, "question_id": 55716605, "link": "https://stackoverflow.com/questions/55716605/remove-one-array-from-a-bigger-one/55717622#55717622", "title": "Remove one array from a bigger one?", "body": "<p>TBH, I normally find <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/filter-function\" rel=\"nofollow noreferrer\">VBA's Filter function</a> next to useless for day-to-day programming requirements and rarely use it but in this case it does seem ideally suited to your purpose if you set the optional third <em>[include/exclude]</em> argument to False.</p>\n\n<p>The following assumes that you want to retain the original values in <code>array1</code> so a copy of the originals is made in <code>array3</code> where only exclusion values are retained. I've also used <code>vbTextCompare</code> instead of <code>vbBinaryCompare</code> for a case insensitive filtering operation. Change to <code>vbBinaryCompare</code> for a case sensitive operation.</p>\n\n<pre><code>Option Explicit\n\nSub arrayDiff()\n\n    Dim i As Long\n    Dim array1 As Variant, array2 As Variant, array3 As Variant\n\n    'populate array1 and array2\n    array1 = Array(\"A\", \"B\", \"C\", \"D\")\n    array2 = Array(\"B\", \"C\")\n\n    'make a working copy of array1 to process\n    array3 = array1\n\n    'loop through the elements in array2 and remove them from array3\n    For i = LBound(array2) To UBound(array2)\n        array3 = Filter(array3, array2(i), False, vbTextCompare)\n    Next i\n\n    'display results in Immediate window\n    Debug.Print \"array3 = Array(\"\"\" &amp; Join(array3, \"\"\",\"\"\") &amp; \"\"\")\"\n\n    'alternate result display\n    For i = LBound(array3) To UBound(array3)\n        Debug.Print array3(i)\n    Next i\n\nEnd Sub\n\n'results from Immediate window\narray3 = Array(\"A\",\"D\")\nA\nD\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1555463616, "creation_date": 1555463616, "answer_id": 55718557, "question_id": 55716605, "link": "https://stackoverflow.com/questions/55716605/remove-one-array-from-a-bigger-one/55718557#55718557", "title": "Remove one array from a bigger one?", "body": "<p>You can use a dictionary to create a function that will return an array consisting of array1 - the elements of array2:</p>\n\n<pre><code>Option Explicit\nFunction arrSubtr(arr1, arr2)\n    Dim D As Dictionary\n    Dim V\n\nSet D = New Dictionary\n    D.CompareMode = TextCompare\n\nFor Each V In arr1\n    D.Add V, V\nNext V\n\nFor Each V In arr2\n    If D.Exists(V) Then\n        D.Remove (V)\n\n'    Uncomment below if you want to add in items in\n'    array2 that don't exist in array1\n'    Else\n'        D.Add V, V\n    End If\nNext V\n\narrSubtr = D.Keys\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 5504855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c33dc7a21eeea5fcec7015421eec7aa?s=128&d=identicon&r=PG&f=1", "display_name": "MasterC", "link": "https://stackoverflow.com/users/5504855/masterc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1555477055, "creation_date": 1555448754, "last_edit_date": 1555477055, "question_id": 55716605, "link": "https://stackoverflow.com/questions/55716605/remove-one-array-from-a-bigger-one", "title": "Remove one array from a bigger one?", "body": "<p>I have two arrays in VBA and i'm trying to obtain a third subarray substracting those arrays, something like this:</p>\n\n<p>Original arrays:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>array1=(\"A\",\"B\",\"C\",\"D\")\narray2=(\"B\",\"C\")\n</code></pre>\n\n<p>Expected result:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>\narray1-array2=(\"A\",\"D\")\n\n</code></pre>\n\n<p>Is there a way to achieve this?</p>\n"}, {"tags": ["excel", "vba", "adobe"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1555453137, "post_id": 55716473, "comment_id": 98115071, "body": "&quot;Just saving it as SaveAS &quot; - what is the &quot;it&quot; in this sentence?  Are you working with a PDF, or an Excel worksheet/workbook ?"}, {"owner": {"reputation": 1, "user_id": 11313543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502293d1a97a8dcab8fc1dca003d801d?s=128&d=identicon&r=PG&f=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/11313543/todd"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1555453674, "post_id": 55716473, "comment_id": 98115213, "body": "I&#39;m working with both. I want excel to export a pdf to an xmlspreadsheet with worksheet for each page as you would  if you wanted to do that through just Adobe. I can do this just through Adobe Pro, I want to be able to have a excel macro complete this."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1555454145, "post_id": 55716473, "comment_id": 98115352, "body": "What&#39;s the source of the PDF?"}, {"owner": {"reputation": 1, "user_id": 11313543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502293d1a97a8dcab8fc1dca003d801d?s=128&d=identicon&r=PG&f=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/11313543/todd"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1555454793, "post_id": 55716473, "comment_id": 98115487, "body": "It&#39;s Adobe Pro is the source. So there any coding I can use in excel that can mimick Adobe Pro? For example in Adobe Pro, I can export an PDF as an xml spreadsheet 2003 and create worksheet for each page, can excel do that as a macro?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1555455285, "post_id": 55716473, "comment_id": 98115606, "body": "I&#39;d guess that&#39;s something specific to Acrobat.  As far as I know Excel doesn&#39;t have PDF conversion capabilities."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11313543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502293d1a97a8dcab8fc1dca003d801d?s=128&d=identicon&r=PG&f=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/11313543/todd"}, "edited": false, "score": 0, "creation_date": 1555600479, "post_id": 55730344, "comment_id": 98174823, "body": "Thanks for your response. I will give it a try."}], "tags": [], "owner": {"reputation": 261, "user_id": 11278584, "user_type": "registered", "profile_image": "https://graph.facebook.com/2311394102518777/picture?type=large", "display_name": "reFractil", "link": "https://stackoverflow.com/users/11278584/refractil"}, "is_accepted": false, "score": 0, "last_activity_date": 1555512338, "creation_date": 1555512338, "answer_id": 55730344, "question_id": 55716473, "link": "https://stackoverflow.com/questions/55716473/exporting-pdf-to-excel/55730344#55730344", "title": "Exporting pdf to excel", "body": "<p>You can do it using the <strong>Adobe Acrobat 10.0 Type Library</strong> reference, that comes with Adobe Acrobat Pro.</p>\n\n<p><strong>Here is an example:</strong></p>\n\n<p>This code will open a PDF file and assign each PDF page to individual worksheets.</p>\n\n<pre><code>\nOption Explicit\nSub PDF_To_Excel()\n\nDim PDF_ As Acrobat.AcroPDDoc\nDim Hilight_Text As Acrobat.AcroHiliteList\nDim PDF_Page As Acrobat.AcroPDPage\nDim Page_Text As Acrobat.AcroPDTextSelect\nDim ws As Worksheet\nDim Count_Page As Long\nDim i As Long, j As Long, k As Long\nDim PDF_Text_Str As String\nDim Hold_Txt As Variant\n\nSet PDF_ = New Acrobat.AcroPDDoc\nSet Hilight_Text = New Acrobat.AcroHiliteList\n\nHilight_Text.Add 0, 32767\n\nWith PDF_\n\n.Open \"C:\\ED5049PX2.pdf\"\nCount_Page = .GetNumPages\n\nFor i = 1 To Count_Page\n\nPDF_Text_Str = \"\"\n\nSet PDF_Page = .AcquirePage(i - 1)\nSet Page_Text = PDF_Page.CreateWordHilite(Hilight_Text)\n\nIf Not Page_Text Is Nothing Then\n\nWith Page_Text\n\nFor j = 0 To .GetNumText - 1\nPDF_Text_Str = PDF_Text_Str &amp; .GetText(j)\nNext j\n\nEnd With\n\nEnd If\n\nSet ws = Worksheets.Add(, Worksheets(Sheets.Count))\n\nWith ws\n.Name = \"Page-\" &amp; i\n\nIf PDF_Text_Str &lt;&gt; \"\" Then\n\nHold_Txt = Split(PDF_Text_Str, vbCrLf)\n\nFor k = 0 To UBound(Hold_Txt)\n\nPDF_Text_Str = CStr(Hold_Txt(k))\nIf Left(PDF_Text_Str, 1) = \"=\" Then PDF_Text_Str = \"'\" &amp; PDF_Text_Str\n.Cells(k + 1, 1).Value = PDF_Text_Str\n\nNext k\n\nElse\n.Cells(1, 1).Value = \"No text found in page \" &amp; i\nEnd If\n\n.Cells.Select\n.Cells.EntireColumn.AutoFit\n\nEnd With\n\nNext\n\n.Close\n\nEnd With\n\nMsgBox (\"Done\")\n\nEnd Sub\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11313543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502293d1a97a8dcab8fc1dca003d801d?s=128&d=identicon&r=PG&f=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/11313543/todd"}, "is_accepted": false, "score": 0, "last_activity_date": 1556662101, "last_edit_date": 1556662101, "creation_date": 1556661635, "answer_id": 55929182, "question_id": 55716473, "link": "https://stackoverflow.com/questions/55716473/exporting-pdf-to-excel/55929182#55929182", "title": "Exporting pdf to excel", "body": "<p>I'm still have a problem with Page_Text is Nothing. Even though I have a pdf open, it seems like it doesn't read the Page_Text. Here is the code:</p>\n\n<pre><code>.Open \"C:\\User\\test.pdf\"\nCount_Page=.GetNumPages\n\nFor I=1 to Count_Page\nPDF_Text_Str=\"\"\nSet PDF_Page=.AcquirePage(i-1)\nSet Page_Text=PDF_Page.CreateWordHilite(Hilight_Text)\nIf Not Page_Text is Nothing then\nWith Page_Text\nFor j=0 to .GetNumText  -1\nPDF_Text_Str=PDF_Text_Str &amp; .GetText(j)\nNext j\nEnd With\nEnd if\n</code></pre>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 1, "user_id": 11313543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502293d1a97a8dcab8fc1dca003d801d?s=128&d=identicon&r=PG&f=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/11313543/todd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 644, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1556662101, "creation_date": 1555448151, "question_id": 55716473, "link": "https://stackoverflow.com/questions/55716473/exporting-pdf-to-excel", "title": "Exporting pdf to excel", "body": "<p>In Adobe DC Pro, you have the option to export your pdf to excel 2003 spreadsheet by first going to \"Export PDF\", next by choosing \"XML Spreadsheet 2003\" and last by choosing the setting \"Create Worksheet for each page.\" </p>\n\n<p>I can't find any code that does this in excel vba.</p>\n\n<p>My question is, how do I make excel complete this option through VBA? Just saving it as SaveAS FileFormat:=XlFileFormat.xlXMLSpreadsheet only makes it a xml spreadsheet, not \"creating the worksheet for each page\" that Adobe Pro makes.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "loops", "copy", "userform"], "comments": [{"owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "edited": false, "score": 0, "creation_date": 1555448198, "post_id": 55716451, "comment_id": 98113431, "body": "States:  &quot;Method &#39;range&#39; of object&#39;_global&#39;failed&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "is_accepted": true, "score": 0, "last_activity_date": 1555451551, "creation_date": 1555451551, "answer_id": 55717105, "question_id": 55716451, "link": "https://stackoverflow.com/questions/55716451/how-to-find-id-in-column-d-when-found-paste-date-from-column-g-into-textbox17/55717105#55717105", "title": "how to find id in column D, when found paste date from column g into textbox17", "body": "<pre><code>  {Private Sub CommandButton4_Click()\nDim id As String\nDim finalrow As Integer\nDim i As Integer\n\nid = TextBox16.Value\nfinalrow = Sheets(\"ALL P.O. INFO\").Range(\"D1000\").End(xlUp).ROW\n\nFor i = 2 To finalrow\n    If Cells(i, 4) = id Then\n      Me.TextBox17 = Cells(i, 7).Value\n    End If\nNext i\n\nEnd Sub}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15, "favorite_count": 0, "accepted_answer_id": 55717105, "answer_count": 1, "score": 0, "last_activity_date": 1555451551, "creation_date": 1555448016, "question_id": 55716451, "link": "https://stackoverflow.com/questions/55716451/how-to-find-id-in-column-d-when-found-paste-date-from-column-g-into-textbox17", "title": "how to find id in column D, when found paste date from column g into textbox17", "body": "<p>Using userform1 to search column d for an ID, when found get ID date from column g and paste date in textbox17.... something like this but this code isn't working. </p>\n\n<pre><code> Private Sub CommandButton4_Click()\nDim id As String\nDim finalrow As Integer\nDim i As Integer\n\nid = TextBox16.Value\nfinalrow = Sheets(\"ALL P.O. INFO\").Range(\"D1000\").End(xlUp).ROW\n\nFor i = 2 To finalrow\n    If Cells(i, 4) = id Then\n       Range(Cells(i, 7)).Copy\n      TextBox17.Paste\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 11353578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H8Xa2.png?s=128&g=1", "display_name": "MAMPRO", "link": "https://stackoverflow.com/users/11353578/mampro"}, "is_accepted": false, "score": 0, "last_activity_date": 1555453488, "creation_date": 1555453488, "answer_id": 55717414, "question_id": 55716324, "link": "https://stackoverflow.com/questions/55716324/vba-to-retrieve-href-inside-a-div/55717414#55717414", "title": "vba to Retrieve href inside a div", "body": "<p>I did test your code associated with your html div string with many emails as in the attached image to ensure you.</p>\n\n<p>Just remember if that html div string is constants string, this solution will work just like you want:</p>\n\n<pre><code>Private Sub CmdRetrieveHrefInsideDiv_Click()\nDim test As String\nDim frstWrd As String\ntest = Text1.Value\nfrstWrd = Split(test, \":\")(4)\nDim X As Integer\nX = InStr(frstWrd, \"?\")\nDim MyEmail As String\nMyEmail = Split(frstWrd, \"?\")(0)\nMsgBox MyEmail\nEnd Sub\n</code></pre>\n\n<p>I hope this can help you ^_^</p>\n\n<p><a href=\"https://i.stack.imgur.com/1wbkf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1wbkf.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 21, "user_id": 4355901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba0699b49fbf508cf1cbcd259fb09dc1?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos", "link": "https://stackoverflow.com/users/4355901/carlos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1617217278, "creation_date": 1555447352, "last_edit_date": 1617217278, "question_id": 55716324, "link": "https://stackoverflow.com/questions/55716324/vba-to-retrieve-href-inside-a-div", "title": "vba to Retrieve href inside a div", "body": "<p>I would like to retrieve the email address in a webpage, which has this html:</p>\n<pre class=\"lang-html prettyprint-override\"><code> &lt;div id=&quot;responseDiv&quot; style=&quot;background-color:#EBECED;width: 450px;&quot;&gt;\n    &lt;font style=&quot;letter-spacing: 0pt&quot; size=&quot;3&quot; face=&quot;Arial&quot; \n    color=&quot;#336699&quot;&gt;\n    &amp;nbsp;&amp;nbsp;&amp;nbsp;  \n    &lt;a href=&quot;mailto:recrutamento@sgp.pt?subject=Resposta Anuncio Net-                                   Empregos: TI SQL e VB.net&quot; target=&quot;_blank&quot;&gt;**recrutamento@sgp.pt**\n    &lt;div&gt;&lt;/div&gt;\n    &lt;div&gt;&lt;/div&gt;\n    &lt;/a&gt;\n    &lt;/font&gt;&lt;/div&gt;\n</code></pre>\n<p>so far I have tried the following that passes everything in that page except for the email address that I wanted:</p>\n<pre><code>Dim dataEle As Object, vElemento As String, tit as string\nSet dataEle =Doc.getElementsByTagName(&quot;p&quot;) ' also tried with element &quot;a&quot;\n\nFor Each element In dataEle\n  tit = element.getAttribute(&quot;href&quot;) \n  MsgBox (tit)\nNext\n</code></pre>\n<p>Could it be, because element &quot;a&quot; is part of a Div? (responseDiv)</p>\n"}, {"tags": ["excel", "vba", "google-chrome"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1555447474, "post_id": 55716308, "comment_id": 98113107, "body": "Look into <a href=\"https://stackoverflow.com/questions/tagged/selenium\">selenium</a>"}, {"owner": {"reputation": 85, "user_id": 9049645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ad355ee09213e1ffad1d0406f730ed?s=128&d=identicon&r=PG&f=1", "display_name": "M_Delineshev", "link": "https://stackoverflow.com/users/9049645/m-delineshev"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1555447880, "post_id": 55716308, "comment_id": 98113295, "body": "I was hoping to find a way to do it with just vba macro"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1555449703, "post_id": 55716308, "comment_id": 98114062, "body": "IE solutions use an API that can talk to IE. Chrome solutions use an API that can talk to Chrome. See <a href=\"https://codereview.stackexchange.com/questions/tagged/vba+selenium\">VBA+Selenium posts on Code Review</a> for a bunch of working examples."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1558513480, "post_id": 55720834, "comment_id": 99122082, "body": "Did you try this?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1555483901, "last_edit_date": 1555483901, "creation_date": 1555480778, "answer_id": 55720834, "question_id": 55716308, "link": "https://stackoverflow.com/questions/55716308/vba-script-to-automatically-open-results-from-google-search-in-chrome/55720834#55720834", "title": "VBA script to automatically open results from google search in chrome", "body": "<p>In case you try the selenium vba route; which is still written using vba. The following excludes the \"People also ask\" section (as well as anything not starting with \"http\")</p>\n\n<pre><code>Option Explicit\n'Download selenium https://github.com/florentbr/SeleniumBasic/releases/tag/v2.0.9.0\n'Ensure latest applicable driver e.g. ChromeDriver.exe in Selenium folder\n'VBE &gt; Tools &gt; References &gt; Add reference to selenium type library\nPublic Sub Example()\n    Dim d As WebDriver, ws As Worksheet, search_string As String, query As String\n    Dim resultToOpen As Long, results As Object, final()\n    Set d = New ChromeDriver\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    query = ws.Range(\"A2\").Value\n    search_string = query\n    search_string = Replace$(search_string, \" \", \"+\")\n    resultToOpen = ws.Range(\"A3\").Value\n\n    With d\n        .Start \"Chrome\"\n        .get \"http://google.com/#q=\" &amp; search_string\n\n        Set results = .FindElementsByCss(\"cite\")\n\n        final = GetUsuableLinks(results)\n        If UBound(final) &gt;= resultToOpen Then\n            .get final(resultToOpen)\n        Else\n            'do something else\n        End If\n\n        Stop   'delete me later\n\n        .Quit\n    End With\nEnd Sub\n\nPublic Function GetUsuableLinks(ByVal results As Object) As Variant\n    Dim arr(), i As Long, j As Long, test As String\n    ReDim arr(1 To results.Count)\n    For i = 1 To results.Count\n        test = results(i).Text\n        If InStr(test, \"http\") &gt; 0 Then\n            j = j + 1\n            arr(j) = test\n        End If\n    Next\n    ReDim Preserve arr(1 To j)\n    GetUsuableLinks = arr\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 9049645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ad355ee09213e1ffad1d0406f730ed?s=128&d=identicon&r=PG&f=1", "display_name": "M_Delineshev", "link": "https://stackoverflow.com/users/9049645/m-delineshev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 715, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557047906, "creation_date": 1555447290, "last_edit_date": 1557047906, "question_id": 55716308, "link": "https://stackoverflow.com/questions/55716308/vba-script-to-automatically-open-results-from-google-search-in-chrome", "title": "VBA script to automatically open results from google search in chrome", "body": "<p>I have found the following code which works for me:</p>\n\n<pre><code>Sub SearchWindow64()\nDim chromePath As String\nDim search_string As String\nDim query As String\nquery = Range(\"A2\").Value\nsearch_string = query\nsearch_string = Replace(search_string, \" \", \"+\")\n\nchromePath = \"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\"\n\nShell (chromePath &amp; \" -url http://google.com/#q=\" &amp; search_string)\nEnd Sub\n</code></pre>\n\n<p>It opens my Google Chrome and navigates to google and does a search based on the value of cell A2.<br>\nSo far so good, but I would also like my script to open the first or the second result(this to also be specified by the user) - for example if the value in cell A3 is 1 to open the first result, if its 2 - the second result and so on..</p>\n\n<p>I have found solutions for similar problems for Internet Explorer, but I want to do this in Google Chrome, can anyone help on this?</p>\n\n<p>Regards,\nMihail</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 2, "creation_date": 1555446250, "post_id": 55716018, "comment_id": 98112606, "body": "As a new user, please take the <a href=\"https://stackoverflow.com/tour\">tour</a>, then edit your question and provide more detail, or simply search the site. because that thing has been asked before."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1555446270, "post_id": 55716018, "comment_id": 98112615, "body": "And please don&#39;t add clarification in comments. Edit your question."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1555446323, "post_id": 55716018, "comment_id": 98112648, "body": "<code>Range(&quot;A1&quot;).Resize(Range(&quot;J1&quot;).Value,1).Value = 3745785</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7380633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f17e18953f69dd0ccf8265691afd9f4f?s=128&d=identicon&r=PG&f=1", "display_name": "RReneau", "link": "https://stackoverflow.com/users/7380633/rreneau"}, "is_accepted": false, "score": 0, "last_activity_date": 1555523054, "creation_date": 1555523054, "answer_id": 55733296, "question_id": 55716018, "link": "https://stackoverflow.com/questions/55716018/copy-and-paste-down-a-column-based-on-the-value-of-another-cell/55733296#55733296", "title": "Copy and paste down a column based on the value of another cell", "body": "<blockquote>\n  <p>I don't completely understand where you will get the value you want\n  repeated but you could build a function like</p>\n</blockquote>\n\n<pre><code>Public Function Copy2()\nDim r1, r2, r3 As Range\nDim ct\n\n\nSet r1 = Range(\"a1\") 'set pointer\nSet r2 = Range(\"b1\") 'set pointer\nSet r3 = Range(\"c1\") 'set pointer\n\nDo ' outer loop going through each number in column A until it comes up to a blank cell\nct = 0\n\n  Do ' Inner loop printing the # of times a number is requested from coresponding colum B data\n   ct = ct + 1\n\n' prints column 3 info\n    r3.Value = r1.Value\n    Set r3 = r3.Offset(1, 0)\n\n  Loop Until ct = r2.Value\n\nSet r2 = r2.Offset(1, 0)\nSet r1 = r1.Offset(1, 0)\n\nLoop Until r1.Value = \"\"\n\nEnd Function\n</code></pre>\n\n<p>Then you can call it from a button  where you would assign its code like </p>\n\n<pre><code>Private Sub CommandButton2_Click()\nCopy2\nEnd Sub\n</code></pre>\n\n<p>this will go down column A and starting populating a new column C with the number of occurrences found in its respective column B</p>\n\n<p><a href=\"https://i.stack.imgur.com/5lmIG.png\" rel=\"nofollow noreferrer\">example result</a></p>\n"}], "owner": {"reputation": 3, "user_id": 11370100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55d152acf3c5491894d90cd6fe3a4b82?s=128&d=identicon&r=PG&f=1", "display_name": "Blaker1ISU", "link": "https://stackoverflow.com/users/11370100/blaker1isu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556213566, "creation_date": 1555445929, "last_edit_date": 1556213566, "question_id": 55716018, "link": "https://stackoverflow.com/questions/55716018/copy-and-paste-down-a-column-based-on-the-value-of-another-cell", "title": "Copy and paste down a column based on the value of another cell", "body": "<p>I am trying to copy and paste a number down a column ( that number will vary throughout column \"A\") and I need the number of Instances that a cell is filled down the column to equal the value of another cell in the data set. That value will vary throughout as well. Any help would be appreciated. if the value was 3751022 and the value in the other column was 11</p>\n\n<pre><code>    The image shows the set Im working on. It need to copy down 3751022 down column A 1-11 times because the first entry will already be done. once the 10 are pasted then it needs to wait for the next entry to past another value down x amount of time                                                \n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "rows"], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1555447107, "last_edit_date": 1555447107, "creation_date": 1555446793, "answer_id": 55716202, "question_id": 55715978, "link": "https://stackoverflow.com/questions/55715978/vba-highlight-delete-row-if-range-is-empty/55716202#55716202", "title": "VBA - Highlight/Delete row if Range is Empty", "body": "<blockquote>\n  <p>Once run, it highlights several rows that are not entirely blank in the target range.</p>\n</blockquote>\n\n<p>This is because you are selecting <em>all</em> blanks, instead of only rows where the entire row is blank.</p>\n\n<p>See the code below</p>\n\n<pre><code>Public Sub EmptyRows()\n\nWith Sheets(\"Issues\")\n\n    lastrow = .Cells(Rows.Count, \"A\").End(xlUp).row    \n\n    Dim rng as Range\n    For Each rng In .Range(\"B2:B\" &amp; lastrow)\n\n          Dim blankCount as Integer\n          blankCount = Application.WorksheetFunction.CountA(rng.Resize(1,.Range(\"B:P\").Columns.Count)) \n\n          If blankCount = .Range(\"B\" &amp; lastRow &amp; \":P\" &amp; lastRow).Columns.Count Then\n\n              Dim store as Range\n              If store Is Nothing Then Set store = rng Else: Set store = Union(rng, store)\n\n          End If\n\n    Next rng\n\nEnd With\n\nstore.EntireRow.Interior.ColorIndex = 11\n'store.EntireRow.Delete\n\nEnd Sub\n</code></pre>\n\n<p>Gathering the ranges first and then modified them (changing color or deleting) will help to execute the code faster.</p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "edited": false, "score": 0, "creation_date": 1555447253, "post_id": 55716223, "comment_id": 98112993, "body": "i kept it as P as a contingency if the data set increases. I should add in a method like lastcol (similar to lastrow) and will change that moving fwd. thanks for the catch."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1555447297, "last_edit_date": 1555447297, "creation_date": 1555446892, "answer_id": 55716223, "question_id": 55715978, "link": "https://stackoverflow.com/questions/55715978/vba-highlight-delete-row-if-range-is-empty/55716223#55716223", "title": "VBA - Highlight/Delete row if Range is Empty", "body": "<p>Your description says Columns B through K, but your code has B through P...</p>\n\n<p>You can do it like this (adjust resize for actual columns involved):</p>\n\n<pre><code>Public Sub EmptyRows()\n    Dim lastRow As Long, sht As Worksheet, c As Range, rngDel As Range\n\n    Set sht = Sheets(\"Issues\")\n\n    For Each c In sht.Range(sht.Range(\"A2\"), sht.Cells(Rows.Count, 1).End(xlUp)).Cells\n        If Application.CountA(c.Offset(0, 1).Resize(1, 10)) = 0 Then\n\n            'build range to delete\n            If rngDel Is Nothing Then\n                Set rngDel = c\n            Else\n                Set rngDel = Application.Union(rngDel, c)\n            End If\n\n        End If\n    Next c\n\n    'anything to flag/delete ?\n    If Not rngDel Is Nothing Then\n        rngDel.EntireRow.Interior.ColorIndex = 11\n        'rngDel.EntireRow.Delete '&lt;&lt; uncomment after testing\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1555450660, "creation_date": 1555450660, "answer_id": 55716954, "question_id": 55715978, "link": "https://stackoverflow.com/questions/55715978/vba-highlight-delete-row-if-range-is-empty/55716954#55716954", "title": "VBA - Highlight/Delete row if Range is Empty", "body": "<p>Here is another approach, using <code>CountA</code></p>\n\n<pre><code>For Each cell In Range(\"A2:A\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row)\n    Dim rng As Range\n    Set rng = Range(\"A\" &amp; cell.Row &amp; \":\" &amp; \"P\" &amp; cell.Row)\n\n    If Application.WorksheetFunction.CountA(rng) = 1 Then\n        rng.EntireRow.Interior.ColorIndex = 11\n    End If\nNext cell\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 10629458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef58ac8fdfb2ad38f5369668eaf1205?s=128&d=identicon&r=PG&f=1", "display_name": "VBAWARD", "link": "https://stackoverflow.com/users/10629458/vbaward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 55716223, "answer_count": 3, "score": 0, "last_activity_date": 1555450660, "creation_date": 1555445733, "question_id": 55715978, "link": "https://stackoverflow.com/questions/55715978/vba-highlight-delete-row-if-range-is-empty", "title": "VBA - Highlight/Delete row if Range is Empty", "body": "<p>I have a range of data, with CASE ID's in Column A, and Issues (1 through 10, or Columns B through K) in Columns B onwards.</p>\n\n<p>Once certain issues are ruled out as 'normal', they would be removed from the Issues sheet based on their respective column. For ex: CASE ID #25, Issue 4 is ruled OK, then it would be deleted from Row 25, Column 5 (or Column E) but the CASE ID would remain. </p>\n\n<p>The goal is that by doing this check after the fact, it may leave certain rows entirely blank, from Column B onwards (since the CASE ID would already be there.)</p>\n\n<p>My code doesn't function successfully. Once run, it highlights several rows that are not entirely blank in the target range. </p>\n\n<p>I'm trying to pinpoint rows in the range <code>B2:P &amp; lastrow</code> where the entire row is blank, and then highlight these rows and subsequently delete them.</p>\n\n<p>Code:</p>\n\n<pre><code>Public Sub EmptyRows()\n\n\nlastrow = Sheets(\"Issues\").Cells(Rows.Count, \"A\").End(xlUp).row\nOn Error Resume Next\nSheets(\"Issues\").Activate\nFor Each rng In Range(\"B2:P\" &amp; lastrow).Columns\n    rng.SpecialCells(xlCellTypeBlanks).EntireRow.Interior.ColorIndex = 11\n    'rng.SpecialCells(xlCellTypeBlanks).EntireRow.Delete\nNext rng\n\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n\n<p>The purpose of first highlighting is to test the code works. If successful, they would be deleted entirely. </p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 11, "user_id": 11232648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/896c886db34dea82762819d656c03279?s=128&d=identicon&r=PG&f=1", "display_name": "mike00lex", "link": "https://stackoverflow.com/users/11232648/mike00lex"}, "edited": false, "score": 0, "creation_date": 1555505951, "post_id": 55715839, "comment_id": 98135078, "body": "Hello, thank your for the response. This example wouldn&#39;t work for me. The example below is in reference to cell A1 (with A1 being the hyperlink). In my worksheet I have a entire column with different hyper links. I will need  the email to grab the row of the hyperlink. If I&#39;m not mistaken... I will have to have this line: &#39;Cells(FormulaCell.Row, &quot;AB&quot;).Value&#39;    ...... as the hyperlink.  Sorry if this is confusing."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1555549094, "post_id": 55715839, "comment_id": 98153313, "body": "<code>FormulaCell</code> will throw error, can you post an example of your spreadsheet?"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1555450929, "last_edit_date": 1592644375, "creation_date": 1555450929, "answer_id": 55716991, "question_id": 55715839, "link": "https://stackoverflow.com/questions/55715839/how-insert-hyperlink-from-a-column-into-outlook-email-body/55716991#55716991", "title": "How insert hyperlink from a column into Outlook email body", "body": "<p><em>Work with <a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2003/aa171418(v=office.11)\" rel=\"nofollow noreferrer\">HTMLBody Property</a></em></p>\n<hr />\n<p><em>Example will show Hyperlink <a href=\"https://stackoverflow.com/questions/55715839/vba-insert-hyperlink-from-a-column-into-outlook-email\">Click Here</a></em></p>\n<blockquote>\n<pre><code>.HTMLBody = &quot;&lt;A href=&quot; &amp; Sht.Range(&quot;A1&quot;) &amp; &quot;&gt; Click Here &lt;/A&gt;&quot;\n</code></pre>\n</blockquote>\n<p><em>Or This will show the value A1 as link</em></p>\n<blockquote>\n<pre><code>&quot;&lt;A href=&quot; &amp; Sht.Range(&quot;A1&quot;) &amp; &quot;&gt;&quot; &amp; Sht.Range(&quot;A1&quot;) &amp; &quot;&lt;/A&gt;&quot; &amp;\n</code></pre>\n</blockquote>\n<hr />\n<p><em>Full Code</em></p>\n<pre><code>Option Explicit\nPublic Sub Example()\n    \n    Dim Sht As Excel.Worksheet\n    Set Sht = ThisWorkbook.Worksheets(&quot;Sheet1&quot;)\n    \n    Dim OutApp As Object\n    Set OutApp = CreateObject(&quot;Outlook.Application&quot;)\n    \n    Dim OutMail As Object\n    Set OutMail = OutApp.CreateItem(0)\n\n    With OutMail\n        .To = &quot;&quot;\n        .CC = &quot;&quot;\n        .BCC = &quot;&quot;\n        .Subject = &quot;&quot;\n        \n        .HTMLBody = &quot;Hi &quot; &amp; vbNewLine &amp; vbNewLine &amp; _\n                    &quot;You have a open MCR that needs attention. &quot; &amp; _\n                     vbNewLine &amp; vbNewLine &amp; _\n                     &quot;&lt;A href=&quot; &amp; Sht.Range(&quot;A1&quot;) &amp; &quot;&gt; Click Here &lt;/A&gt;&quot; &amp; _\n                     vbNewLine &amp; vbNewLine &amp; _\n                    &quot;Thank you!&quot;\n                    \n        'You can add a file to the mail like this\n        .Display    ' or use .Send\n    End With\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n<p><em><a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/option-explicit-statement\" rel=\"nofollow noreferrer\">Option Explicit Statement (Visual Basic)</a></em></p>\n<p><em>Forces explicit declaration of all variables in a file, or allows implicit declarations of variables.</em></p>\n"}], "owner": {"reputation": 11, "user_id": 11232648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/896c886db34dea82762819d656c03279?s=128&d=identicon&r=PG&f=1", "display_name": "mike00lex", "link": "https://stackoverflow.com/users/11232648/mike00lex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1592554988, "creation_date": 1555445038, "last_edit_date": 1592554988, "question_id": 55715839, "link": "https://stackoverflow.com/questions/55715839/how-insert-hyperlink-from-a-column-into-outlook-email-body", "title": "How insert hyperlink from a column into Outlook email body", "body": "<p>I have column \"AB\" that has a hyperlink in which I will like to include in a email through VBA. </p>\n\n<p>The hyperlink changes per line. I am able to pull the column through text however the email is not showing the hyper link. </p>\n\n<p>How can I get it to show as a hyperlink?</p>\n\n<pre><code>Dim OutApp As Object\n    Dim OutMail As Object\n    Dim strto As String, strcc As String, strbcc As String\n    Dim strsub As String, strbody As String\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    strto = Cells(FormulaCell.Row, \"Y\").Value\n    strcc = \"\"\n    strbcc = \"\"\n    strsub = \"MCR FORM\"\n    strbody = \"Hi \" &amp; Cells(FormulaCell.Row, \"O\").Value &amp; vbNewLine &amp; vbNewLine &amp; _\n              \"You have a open MCR that needs attention. Please Find the attachted MCR Form for material : \" &amp; Cells(FormulaCell.Row, \"E\").Value &amp; _\n              vbNewLine &amp; vbNewLine &amp; Cells(FormulaCell.Row, \"AB\").Value &amp; vbNewLine &amp; vbNewLine &amp; \"Thank you!\"\n\n\n    With OutMail\n        .To = strto\n        .CC = strcc\n        .BCC = strbcc\n        .Subject = strsub\n        .Body = strbody\n        'You can add a file to the mail like this\n        .Attachments.Add (\"P:\\Inventory Control\\Public\\MCR Form Master.xlsm\")\n        .Display    ' or use .Send\n    End With\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>vbNewLine &amp; vbNewLine &amp; Cells(FormulaCell.Row, \"AB\").Value &amp;\n</code></pre>\n\n<p>I believe the code above needs to be reference a HREF link??</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1555464272, "post_id": 55715804, "comment_id": 98117392, "body": "You can use <code>PowerQuery</code> aka <code>Get&amp;Transform</code> to access that table easily."}, {"owner": {"reputation": 11, "user_id": 10100696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16b153a0ef6a9540295856f487a86b31?s=128&d=identicon&r=PG&f=1", "display_name": "Kalitotito", "link": "https://stackoverflow.com/users/10100696/kalitotito"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1555539606, "post_id": 55715804, "comment_id": 98151413, "body": "Thank you for your suggestion..."}], "answers": [{"tags": [], "owner": {"reputation": 157, "user_id": 1606139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236a51b5c9cec80b172cfab92117a89?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/1606139/jack"}, "is_accepted": false, "score": 0, "last_activity_date": 1555445414, "last_edit_date": 1592644375, "creation_date": 1555445414, "answer_id": 55715915, "question_id": 55715804, "link": "https://stackoverflow.com/questions/55715804/how-to-import-playoff-data/55715915#55715915", "title": "How to import playoff data", "body": "<p>You can use scraping tools to achieve your goal which like <a href=\"https://data-miner.io/\" rel=\"nofollow noreferrer\">dataminer</a>, <a href=\"https://www.webscraper.io/\" rel=\"nofollow noreferrer\">grepsr</a> etc.</p>\n<p>Best Wishes</p>\n"}], "owner": {"reputation": 11, "user_id": 10100696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16b153a0ef6a9540295856f487a86b31?s=128&d=identicon&r=PG&f=1", "display_name": "Kalitotito", "link": "https://stackoverflow.com/users/10100696/kalitotito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1555448409, "creation_date": 1555444874, "last_edit_date": 1555448409, "question_id": 55715804, "link": "https://stackoverflow.com/questions/55715804/how-to-import-playoff-data", "title": "How to import playoff data", "body": "<p>I'm trying to import playoff data from this page \n<a href=\"https://www.basketball-reference.com/players/t/thompkl01/gamelog/2019/\" rel=\"nofollow noreferrer\">https://www.basketball-reference.com/players/t/thompkl01/gamelog/2019/</a></p>\n\n<p>I've tried to replicate the same macro I'm using to get season data but changing the number of .webtables from 8 to 9 doesn't return any data. </p>\n\n<pre><code>With ActiveSheet.QueryTables.Add(Connection:= _\n    \"URL;https://www.basketball-reference.com/players/ _ \n     t/thompkl01/gamelog/2019/\", _\n     Destination:=Range(\"$C$11\"))\n    .Name = \"2019\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = True\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertEntireRows\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .WebSelectionType = xlSpecifiedTables\n    .WebFormatting = xlWebFormattingNone\n    .WebTables = \"8\"\n    .WebPreFormattedTextToColumns = True\n    .WebConsecutiveDelimitersAsOne = True\n    .WebSingleBlockTextImport = False\n    .WebDisableDateRecognition = False\n    .WebDisableRedirections = False\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n\n<p>What's the best solution to get the playoff data?</p>\n"}, {"tags": ["vba", "ms-access", "runtime-error"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1555466700, "post_id": 55715786, "comment_id": 98117892, "body": "Does frmEvents code module include <code>Option Explicit</code> in its Declarations section?  If not, add it.  Then does the code compile without error?  (from the VB editor&#39;s main menu, Debug -&gt; Compile)"}, {"owner": {"reputation": 1, "user_id": 11098239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bbed96511b00f780b6982163404e90e?s=128&d=identicon&r=PG&f=1", "display_name": "SWalton", "link": "https://stackoverflow.com/users/11098239/swalton"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1555591090, "post_id": 55715786, "comment_id": 98169168, "body": "@HansUp Yes, Option Explicit is included in the module. The code was not compiling without error and then miraculously yesterday everything worked fine with no errors occurring."}], "owner": {"reputation": 1, "user_id": 11098239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bbed96511b00f780b6982163404e90e?s=128&d=identicon&r=PG&f=1", "display_name": "SWalton", "link": "https://stackoverflow.com/users/11098239/swalton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594621359, "creation_date": 1555444817, "last_edit_date": 1594621359, "question_id": 55715786, "link": "https://stackoverflow.com/questions/55715786/is-there-code-that-i-can-use-to-eliminate-a-runtime-error", "title": "Is there code that i can use to eliminate a runtime error?", "body": "<p>In my database (access 2010) there is a \"Main menu\" form that opens up an event form sourced by the event table after a search from an unbound textbox. Up until the most recent Windows update on 4/10/19 the code was working perfectly to create a new record in the event form. Now I get run-time error 2427 (You entered an expression that has no value). What change in code should be implemented to remove the error?</p>\n\n<p>The debugger breaks in Private Sub Form Load() of the event form in the first If statement which is referencing a true/false control.</p>\n\n<p>I have tried with no luck 1. changing the values to (True/False), 2. adding Me. to the beginning of the if statement, 3. removing the if statements from the form load altogether and setting focus to another control on the form and 4. adding a form current event with the code that was previously in the form load event.</p>\n\n<p>This code closes the \"Main Menu\" form and opens the events form in add mode.</p>\n\n<pre><code>Private Sub cmdAddEvent_Click()\n    cmdAddEvent.SetFocus\n    cboEvent.Value = \"\"\n    blnAddEvent = True\nOn Error GoTo Err_cmdAddEvent_Click\n    DoCmd.Close\n\n    ' wipe out event variables when finding or adding another event\n    strSaveYearCode = \"\": strSaveProjectCode = \"\": strSaveActivityCode = \"\":strSaveProposalCode = \"\"\n    g_strEventYear = \"\": g_strEventProject = \"\": g_strEventActivity = \"\": g_strEventProposal = \"\"\n    ' end of wipe-out\n\n    DoCmd.OpenForm \"frmEvents\", , , , acFormAdd\n    'DoCmd.GoToRecord , , acNewRec\n\nExit_cmdAddEvent_Click:\n    Exit Sub\n\nErr_cmdAddEvent_Click:\n    MsgBox Err.Description\n    blnAddEvent = False\n    Resume Exit_cmdAddEvent_Click\nEnd Sub\n</code></pre>\n\n<p>This is the code in from the events form that the debugger breaks at before the run-time error appears.</p>\n\n<pre><code>Private Sub Form_Load()\n    If proContentApprove = -1 Then ---This line\n        proDescription.Locked = True\n        proAudience1.Locked = True\n    Else\n        If proContentApprove = 0 Then\n            proDescription.Locked = False\n            proAudience1.Locked = False\n        End If\n    End If\n</code></pre>\n\n<p>When an record is already in the source table the event form opens without incident. I expect the events form to open as it normally does when trying to add a new record as well.</p>\n"}, {"tags": ["excel", "vba", "ms-access", "sharepoint", "ado"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11342476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa74ed1e2e43e51ca3efbc7a9a4fb734?s=128&d=identicon&r=PG&f=1", "display_name": "Yia War", "link": "https://stackoverflow.com/users/11342476/yia-war"}, "is_accepted": true, "score": 0, "last_activity_date": 1575753703, "creation_date": 1575753703, "answer_id": 59230328, "question_id": 55715676, "link": "https://stackoverflow.com/questions/55715676/concurrency-and-connection-issues-to-access-db-stored-in-sharepoint-library/59230328#59230328", "title": "Concurrency and connection issues to Access DB stored in SharePoint Library", "body": "<p>I found the solution to my problem: </p>\n\n<blockquote>\n  <p>Although you can save an Access database file to OneDrive or a SharePoint document library, we recommend that you avoid opening an Access database from these locations. The file may be downloaded locally for editing and then uploaded again once you save your changes to SharePoint. If more than one person opens the Access database from SharePoint, multiple copies of the database may get created and some unexpected behaviors may occur. This recommendation applies to all types of Access files including a single database, a split database, and the .accdb, .accdc, .accde, and .accdr file formats. For more information on deploying Access, see Deploy an Access application.</p>\n</blockquote>\n\n<p>Source: <a href=\"https://support.office.com/en-us/article/ways-to-share-an-access-desktop-database-03822632-da43-4d8f-ba2a-68da245a0446\" rel=\"nofollow noreferrer\">Ways to share an Access desktop database</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11342476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa74ed1e2e43e51ca3efbc7a9a4fb734?s=128&d=identicon&r=PG&f=1", "display_name": "Yia War", "link": "https://stackoverflow.com/users/11342476/yia-war"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 59230328, "answer_count": 1, "score": 0, "last_activity_date": 1575754649, "creation_date": 1555444304, "last_edit_date": 1575754649, "question_id": 55715676, "link": "https://stackoverflow.com/questions/55715676/concurrency-and-connection-issues-to-access-db-stored-in-sharepoint-library", "title": "Concurrency and connection issues to Access DB stored in SharePoint Library", "body": "<p><strong>Short version:</strong> (after finding out the answer)</p>\n\n<p>I have an Excel VBA application with an MS Access database (.accdb) on a SharePoint library.\nThe behavior that was examined (and apparently documented - see answer):</p>\n\n<ol>\n<li>It takes a long time to perform the ADODB Open and Close methods (~15 seconds).</li>\n<li>If multiple users are connected at the same time to the database, only the changes made by the user which closed the database connection <strong>LAST</strong> are saved. Changing cursor types, cursor locations or lock types didn't help. No error shown.</li>\n</ol>\n\n<p>Why does this happen?</p>\n\n<p><strong>Original Question:</strong></p>\n\n<p>First question here. Hope this isn't too wordy:</p>\n\n<p>I've built an Excel application using VBA to communicate with an MS Access database (.accdb) that should have support for concurrent users accessing it. It is meant to be placed on a Sharepoint site as an accessible file (not integrated into it in any other way). When I was testing the Excel file and the database on my home network it worked like a charm, transactions and all. However, once I migrated it to Sharepoint, I've noticed some extreme differences from the way it acted on my personal network:</p>\n\n<ol>\n<li><p>The ADODB {.open} and {.close} methods take at least 15 seconds each (making Excel freeze until done). Due to this, I've decided to open and close connections only once throughout the lifetime of the application, and restore the connection if it is broken along the way. I'm aware of the fact that this is highly not recommended, but can't afford having my users wait so long. This hasn't caused any problems that I'm aware of, perhaps apart from the one I'm about to explain. </p></li>\n<li><p>The problem: Changes aren't saved to the actual database unless all active user connections to the database are closed, even if the only active thing is the connection. Everything passes without errors for each user when attempting to update, and each user can access his/her changes, I suppose until all connections are terminated. I tried all possible cursor types and lock types, nothing seemed to work. It is as if a local copy of the database is stored on the user's computer (hence the long wait while opening and closing the connection), and updates are stored on the temporary version, not the actual one.</p></li>\n</ol>\n\n<p>I tried all possible combinations for cursor types, cursor locations, lock types and what not (found out along the way that dynamic cursors aren't supported in my case - I wonder if that's the answer).</p>\n\n<p>Due to this I have no other choice but to make the program accessible to only one user at a time, or changes seem to get lost along the way, making the program highly unreliable.</p>\n\n<p>I read something about having to \"flush the buffer\" or \"refresh the cursor\". Is this even possible/necessary? Or the case? If I'm using a keyset cursor, shouldn't my edited records be shown to all other users? (not talking about new ones)</p>\n\n<p>For what it's worth, I map the path to the sharepoint folder before accessing it.</p>\n\n<p>Have any of you experienced something like this? Or have any suggestions? </p>\n\n<p>If you need samples of my code I'll post it soon. Thanks so much! </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1555444116, "post_id": 55715551, "comment_id": 98111696, "body": "I&#39;m not sure the legend text can be edited - see the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.legend%28object%29\" rel=\"nofollow noreferrer\"><code>Legend</code> documentation</a> for more detail"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1555444819, "post_id": 55715551, "comment_id": 98112001, "body": "You can change the text that appears in the legend by changing the name of the data series though."}, {"owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1555444961, "post_id": 55715551, "comment_id": 98112067, "body": "Hmm I see, it is because there are only 1 data set for it. So the legend just say Total"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1555445141, "post_id": 55715551, "comment_id": 98112144, "body": "Try <code>ActiveSheet.ChartObjects(&quot;Chart 1&quot;).Chart.FullSeriesCollection(1).Name  = &quot;=&quot;&quot;2019 Revenue&quot;&quot;&quot;</code>"}, {"owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1555445731, "post_id": 55715551, "comment_id": 98112383, "body": "nope, it is still the same. The legend did not change."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1555445798, "post_id": 55715551, "comment_id": 98112416, "body": "Then maybe change it manually using one of the suggestions <a href=\"https://support.office.com/en-us/article/modify-chart-legend-entries-d822dd57-af28-4c3e-93d1-d320e6239843\" rel=\"nofollow noreferrer\">here</a> and use the macro recorder to get the code."}, {"owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1555445990, "post_id": 55715551, "comment_id": 98112496, "body": "That a good idea. Thank you."}], "owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555449963, "creation_date": 1555443730, "last_edit_date": 1555449963, "question_id": 55715551, "link": "https://stackoverflow.com/questions/55715551/creating-a-legend-for-graph-with-vba", "title": "Creating a legend for graph with VBA", "body": "<p>I am wondering what is wrong with this code. \nThe code for the chart title is right but for the legend, it is saying that the Object doesn't support. </p>\n\n<pre><code>ActiveSheet.ChartObjects(\"Chart 1\").Chart.ChartTitle.Text = \"2019 Revenue\"\nActiveSheet.ChartObjects(\"Chart 1\").Chart.Legend.Text = \"2019 Revenue\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1555443440, "post_id": 55715304, "comment_id": 98111426, "body": "So, just checking: you have workbook One, with ribbon commands to open a userform. Userform_Initialize opens workbook Two. Correct?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1555444123, "post_id": 55715304, "comment_id": 98111702, "body": "You are asking how to open a userform from a custom ribbon or how to set he activeworkbook?  Regarding opening a userform, you want to reference the code that opens the userform (e.g., <code>application.run &quot;module1.callUF&quot;</code>), since that is tried and true (you may want some error handling to verify the appropriate workbook is open).  You can just <code>set wb = activeworkbook</code> as this will overwrite the last declaration, no issues."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1555444446, "post_id": 55715304, "comment_id": 98111838, "body": "Putting that code in the form&#39;s <code>Initialize</code> handler will make the handler run <i>before</i> the form is shown. That said, if you want to make that form appear when the user clicks your custom Ribbon command, you&#39;re going to need code associated with that Ribbon command, that invokes the <code>Show</code> method against an instance of the form."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1555445066, "post_id": 55715304, "comment_id": 98112113, "body": "I&#39;ve re-read this post several times, and still can&#39;t figure out what the question is and how the code block shown relates to &quot;opening a userform through a custom excel ribbon&quot; in any way, nor why a form needs to get involved, or whether &quot;it sends the code to the queryclose sub&quot; is a problem or if it&#39;s expected. Please <a href=\"https://stackoverflow.com/posts/55715304/edit\">edit</a> to clarify."}, {"owner": {"reputation": 11, "user_id": 11370345, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n4onlOLIyec/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfFzY5B2AdvCoLF5vBzelJj_kdnEA/mo/photo.jpg?sz=128", "display_name": "LearningVBA", "link": "https://stackoverflow.com/users/11370345/learningvba"}, "edited": false, "score": 0, "creation_date": 1555445744, "post_id": 55715304, "comment_id": 98112393, "body": "Matthieu, I just added some additional information to the post.  The problem is when I open the userform, it sends me to the queryclose sub during the initialize code.  The only time the queryclose sub should run is when the X button is pressed on the userform.  Please ask for any more information and code that could help diagnose this."}, {"owner": {"reputation": 11, "user_id": 11370345, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n4onlOLIyec/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfFzY5B2AdvCoLF5vBzelJj_kdnEA/mo/photo.jpg?sz=128", "display_name": "LearningVBA", "link": "https://stackoverflow.com/users/11370345/learningvba"}, "edited": false, "score": 0, "creation_date": 1555446132, "post_id": 55715304, "comment_id": 98112558, "body": "Mistella, the ribbon is actually an add-in that is always loaded into my excel.  there is only one workbook that is opened and it is opened when the button is clicked in the ribbon, then as the userform initializes, it should open the workbook."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1555446408, "post_id": 55715304, "comment_id": 98112676, "body": "Thanks for editing, I hope below answer helps!"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11370345, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n4onlOLIyec/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfFzY5B2AdvCoLF5vBzelJj_kdnEA/mo/photo.jpg?sz=128", "display_name": "LearningVBA", "link": "https://stackoverflow.com/users/11370345/learningvba"}, "edited": false, "score": 0, "creation_date": 1555447488, "post_id": 55716080, "comment_id": 98113115, "body": "I changed the with statement to open the userform as well as the queryclose to involve the closemode verification.  It seemed to help until I get an automation error: The callee (server [not server application]) is not available and disappeared; all connections are invalid. The call may have executed.  The interesting part about this is if I debug and step through it will work, but if I close excel and reopen it I get the same error."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11, "user_id": 11370345, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n4onlOLIyec/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfFzY5B2AdvCoLF5vBzelJj_kdnEA/mo/photo.jpg?sz=128", "display_name": "LearningVBA", "link": "https://stackoverflow.com/users/11370345/learningvba"}, "edited": false, "score": 0, "creation_date": 1555447601, "post_id": 55716080, "comment_id": 98113169, "body": "@LearningVBA I really don&#39;t recommend putting that kind of code in the <code>Initialize</code> handler. What&#39;s throwing the automation error, and where? Before or after the form is closed? &quot;if I step through it works&quot; is typically a sign of implicit <code>ActiveSheet</code> and/or <code>ActiveWorkbook</code> references, see if <a href=\"http://www.github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> inspections can find any."}, {"owner": {"reputation": 11, "user_id": 11370345, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n4onlOLIyec/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfFzY5B2AdvCoLF5vBzelJj_kdnEA/mo/photo.jpg?sz=128", "display_name": "LearningVBA", "link": "https://stackoverflow.com/users/11370345/learningvba"}, "edited": false, "score": 0, "creation_date": 1555448006, "post_id": 55716080, "comment_id": 98113349, "body": "Mathieu, I updated the initialize code in the prompt, near the bottom is where it throws the automation error, I am going to try placing in a separate module now."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11, "user_id": 11370345, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n4onlOLIyec/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfFzY5B2AdvCoLF5vBzelJj_kdnEA/mo/photo.jpg?sz=128", "display_name": "LearningVBA", "link": "https://stackoverflow.com/users/11370345/learningvba"}, "edited": false, "score": 0, "creation_date": 1555448330, "post_id": 55716080, "comment_id": 98113479, "body": "@LearningVBA the <code>Initialize</code> handler is meant to set default control properties before the form is displayed, not to open a workbook and run 50 lines of automation logic against it. Sure move that code to another module, but more importantly don&#39;t invoke it from <code>UserForm_Initialize</code>. This is growing into something well beyond the original question though."}, {"owner": {"reputation": 11, "user_id": 11370345, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n4onlOLIyec/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfFzY5B2AdvCoLF5vBzelJj_kdnEA/mo/photo.jpg?sz=128", "display_name": "LearningVBA", "link": "https://stackoverflow.com/users/11370345/learningvba"}, "edited": false, "score": 0, "creation_date": 1555448395, "post_id": 55716080, "comment_id": 98113516, "body": "After moving my initialize into a &#39;DoInitializationStuff&#39; sub and calling out that sub in the Initialize sub it still has the automation error at the same spot."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11, "user_id": 11370345, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n4onlOLIyec/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfFzY5B2AdvCoLF5vBzelJj_kdnEA/mo/photo.jpg?sz=128", "display_name": "LearningVBA", "link": "https://stackoverflow.com/users/11370345/learningvba"}, "edited": false, "score": 0, "creation_date": 1555448492, "post_id": 55716080, "comment_id": 98113551, "body": "Once more: <b><i>don&#39;t</b> invoke it from <code>UserForm_Initialize</code></i>"}, {"owner": {"reputation": 11, "user_id": 11370345, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n4onlOLIyec/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfFzY5B2AdvCoLF5vBzelJj_kdnEA/mo/photo.jpg?sz=128", "display_name": "LearningVBA", "link": "https://stackoverflow.com/users/11370345/learningvba"}, "edited": false, "score": 0, "creation_date": 1555448527, "post_id": 55716080, "comment_id": 98113574, "body": "Okay, I think I understand; the initialize function should only be setting up the userform on a basic level and the rest of the code, such as opening workbooks, creating collections and dictionaries, etc should occur after the userform has been initialized."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11, "user_id": 11370345, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n4onlOLIyec/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfFzY5B2AdvCoLF5vBzelJj_kdnEA/mo/photo.jpg?sz=128", "display_name": "LearningVBA", "link": "https://stackoverflow.com/users/11370345/learningvba"}, "edited": false, "score": 0, "creation_date": 1555448612, "post_id": 55716080, "comment_id": 98113608, "body": "Yes. That said the automation error might be elsewhere. But the <code>Initialize</code> handler should be simple, trivial code that assigns form and control properties and configures the form just before it&#39;s displayed."}, {"owner": {"reputation": 11, "user_id": 11370345, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n4onlOLIyec/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfFzY5B2AdvCoLF5vBzelJj_kdnEA/mo/photo.jpg?sz=128", "display_name": "LearningVBA", "link": "https://stackoverflow.com/users/11370345/learningvba"}, "edited": false, "score": 0, "creation_date": 1555448685, "post_id": 55716080, "comment_id": 98113635, "body": "Okay, I will continue to work on it. Thank you Matthieu for all your help!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1555446236, "creation_date": 1555446236, "answer_id": 55716080, "question_id": 55715304, "link": "https://stackoverflow.com/questions/55715304/how-to-open-a-userform-through-a-custom-excel-ribbon/55716080#55716080", "title": "How to open a userform through a custom excel ribbon", "body": "<blockquote>\n  <p><em>The only time the queryclose sub should run is when the X button is pressed on the userform.</em></p>\n</blockquote>\n\n<p>But that's not how <code>QueryClose</code> works. The <code>UserForm.QueryClose</code> event is fired whenever the form is about to be closed, and its parameters give you means to cancel it, depending on what prompted it to close.</p>\n\n<p>What you want is to run <code>wb.Close False</code> conditionally, when the <code>CloseMode</code> parameter value is <code>vbFormControlMenu</code> (the X button - see <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/queryclose-constants\" rel=\"nofollow noreferrer\">QueryClose constants</a>):</p>\n\n<pre><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    If CloseMode = vbFormControlMenu Then\n        wb.Close False\n    End If\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p><em>I tried to return to the initialize sub when the code [...]</em></p>\n</blockquote>\n\n<p>Don't do this. Event handlers are meant to be invoked by VBA itself, not user code. If you need to invoke logic that you've implemented in an event handler, refactor the code out of the handler and into its own procedure instead:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    DoInitializationStuff\nEnd Sub\n\nPrivate Sub DoInitializationStuff()\n    '...\nEnd Sub\n</code></pre>\n\n<p>Lastly, the <code>UserForm.Initialize</code> event is fired well before the form is shown.</p>\n\n<pre><code>Set EditComp = New ufUpdateComp ' &lt;~ initialize handler runs before this instruction returns\nWith EditComp\n    .Top = Application.Top + 125\n    .Left = Application.Left + 25\n    .Show\nEnd With\n</code></pre>\n\n<p>Note that you don't need to declare the local variable if you're only using it in a <code>With</code> block - have the block hold the object reference instead:</p>\n\n<pre><code>With New ufUpdateComp ' &lt;~ initialize handler runs before this instruction returns\n    .Top = Application.Top + 125\n    .Left = Application.Left + 25\n    .Show\nEnd With\n</code></pre>\n\n<p>If you want <code>DoInitializationStuff</code> to run <em>after</em> the form is shown, invoke it in the <code>Activate</code> event.</p>\n"}], "owner": {"reputation": 11, "user_id": 11370345, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n4onlOLIyec/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfFzY5B2AdvCoLF5vBzelJj_kdnEA/mo/photo.jpg?sz=128", "display_name": "LearningVBA", "link": "https://stackoverflow.com/users/11370345/learningvba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1555447909, "creation_date": 1555442612, "last_edit_date": 1555447909, "question_id": 55715304, "link": "https://stackoverflow.com/questions/55715304/how-to-open-a-userform-through-a-custom-excel-ribbon", "title": "How to open a userform through a custom excel ribbon", "body": "<p>I am trying to open a userform through a custom excel ribbon.  When I click the button in the ribbon it begins initializing and on the workbooks.open function it sends the code to the queryclose sub. The show userform code is below:</p>\n\n<pre><code>Sub RemoveFixture_onAction(control As IRibbonControl)\n    SelectedCompType = Fixture\n    Set EditComp = New ufUpdateComp\n        With EditComp\n            .Top = Application.Top + 125\n            .Left = Application.Left + 25\n            .Show\n        End With\nEnd Sub\n</code></pre>\n\n<p>When the code begins the userform_Initialize code it ends up moving to the query_close sub.  The code for that is below:</p>\n\n<pre><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    'If wb Is Nothing Then UserForm_Initialize\n    wb.Close False\nEnd Sub\n</code></pre>\n\n<p>As seen above, in the commented out section, I tried to return to the initialize sub when the code moved to the queryclose function. It moves to the queryclose sub when it runs the workbooks.open code and it says that the wb is nothing. I have tried opening the workbook separately and then setting the workbook as ActiveWorkbook.  I also tried:\ndo while wb is nothing\nset wb = ActiveWorkbook\nloop\nThis loop ran endlessly until I had to manually cancel it.\nIt was originally set wb = workbooks.open(Test)</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Workbooks.Open Test, , , , , DynoCompPassword, True\n    Set wb = ActiveWorkbook\n    Set ws = wb.Worksheets(\"Info\")\n    Set ws = wb.Worksheets(\"Info\")\n    Set wsC = wb.Worksheets(\"Calipers\")\n    Set wsF = wb.Worksheets(\"Fixtures\")\n    Set wsW = wb.Worksheets(\"Wheel Sims\")\n    ws.Visible = True\n    wsC.Visible = True\n    wsF.Visible = True\n\nbtnCreate.Enabled = False\nDim rng As Range\n\nlblLocation.Visible = False\ntbLocation.Visible = False\nMe.cbOut.AddItem \"Sent To\"\nMe.cbOut.AddItem \"Scrapped\"\nMe.cbOut.AddItem \"Returned\"\nMe.btnCreate.Enabled = True\n\nFor Each rngprojectcode In ws.Range(\"ProjectCode\")\n    Me.cbProjectCode.AddItem rngprojectcode.Value\nNext rngprojectcode\n\nSet ProjCodeDictionary = New Dictionary 'Create the dictionary\nDim i As Integer\nDim j As Integer\nDim ProjCodeString As String\nDim AssociatedCodes As ProjectCodeList\n\nIf ws Is Nothing Then Exit Sub\n\n    ProjCodeDictionary.CompareMode = vbTextCompare 'Make the .exists method case insensitive in an attempt to avoid duplicate values\n\n    Set AssociatedCodes = New ProjectCodeList 'create the class module which will split up the associated codes into individual values\n    i = 1\n    While ws.Range(\"F1\").Offset(i, 0) &lt;&gt; \"\"\n        With AssociatedCodes\n            .SetCodes = CStr(ws.Range(\"F1\").Offset(i, 0).Value)\n            For j = 1 To .NumCodes\n                ProjCodeDictionary.Add .ProjCode(j), i 'key, item\n            Next j\n        End With\n        i = i + 1\n     Wend\n\nIf SelectedCompType = Fixture Then\n    Me.lblCompNum.Caption = \"Fixture ID\"\n    Me.btnCreate.Caption = \"Update Fixture\"\n        'Automation Error occurs here\n    Me.Caption = \"Edit Fixture\"\n    Me.frChangeFrame.Height = 65\n    Me.frChangeFrame.Caption = \"Bolt Circle\"\n    Me.cbPartNum.Text = \"FIX\"\n        For Each rng In wsF.Range(\"FixtureNum\")\n        Me.cbPartNum.AddItem rng.Value\n        Next rng\n    Set tbNumStuds = frChangeFrame.Controls.Add(\"Forms.TextBox.1\", , \"True\")\n</code></pre>\n\n<p>To clarify, the queryclose sub should only be activated when the red box with the X is pressed in the userform.  It is a built in function of the userform.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1555442816, "creation_date": 1555442816, "answer_id": 55715370, "question_id": 55715249, "link": "https://stackoverflow.com/questions/55715249/how-do-i-sort-the-amounts-in-this-excel-column-in-ascending-order-once-the-macro/55715370#55715370", "title": "How do I sort the amounts in this excel column in Ascending order once the macro is run?", "body": "<p>Perhaps like this?</p>\n\n<pre><code>Sub tgr()\n\n    Dim wb As Workbook\n    Dim wsTemplate As Worksheet\n    Dim wsOutput As Worksheet\n    Dim rCopy As Range\n\n    Set wb = ActiveWorkbook\n    Set wsTemplate = wb.Worksheets(\"Template\")\n    Set wsOutput = wb.Worksheets(\"OutPut\")\n\n    Set rCopy = wsTemplate.Range(\"A2\", wsTemplate.Cells.SpecialCells(xlCellTypeLastCell))\n    With wsOutput.Range(\"A1\").Resize(rCopy.Rows.Count, rCopy.Columns.Count)\n        .Value = rCopy.Value\n        .Sort Intersect(.Cells, .Parent.Columns(\"D\")), xlAscending, Header:=xlYes, OrderCustom:=1, DataOption1:=xlSortTextAsNumbers\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8498214, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a3374aedf71f3210e1addc629aca40b5?s=128&d=identicon&r=PG&f=1", "display_name": "suzyc", "link": "https://stackoverflow.com/users/8498214/suzyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 13, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555442816, "creation_date": 1555442395, "question_id": 55715249, "link": "https://stackoverflow.com/questions/55715249/how-do-i-sort-the-amounts-in-this-excel-column-in-ascending-order-once-the-macro", "title": "How do I sort the amounts in this excel column in Ascending order once the macro is run?", "body": "<p>I can't get the values I enter into column D to be sorted by ascending order. </p>\n\n<pre><code> Sheets(\"Template\").Select\n    Range(\"A2\").Select\n    Range(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\n    Selection.Copy\n    Sheets(\"OutPut\").Select\n    Range(\"A1\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Application.CutCopyMode = False\n    Selection.Sort Key1:=Range(\"D1\"), Order1:=xlAscending, Header:=xlYes, _\n        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\n        DataOption1:=xlSortTextAsNumbers```\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 1, "creation_date": 1555443661, "post_id": 55715015, "comment_id": 98111522, "body": "Well, I started by looking at Q&amp;A on here and cobbling together bits, so have a look and see if you can use this : <a href=\"https://stackoverflow.com/a/40768023/4961700\">stackoverflow.com/a/40768023/4961700</a>"}, {"owner": {"reputation": 1, "user_id": 10450878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/439392d435e771585a8c4dab667a7cee?s=128&d=identicon&r=PG&f=1", "display_name": "Mich", "link": "https://stackoverflow.com/users/10450878/mich"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1555445743, "post_id": 55715015, "comment_id": 98112389, "body": "Thanks, I did see that post but it does nothing like I need it to do."}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 5535343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac5beca5b86579dd3f90a5e5f07f6c77?s=128&d=identicon&r=PG&f=1", "display_name": "K&#252;rsat Aydinli", "link": "https://stackoverflow.com/users/5535343/k%c3%bcrsat-aydinli"}, "is_accepted": false, "score": 1, "last_activity_date": 1555486010, "creation_date": 1555486010, "answer_id": 55722123, "question_id": 55715015, "link": "https://stackoverflow.com/questions/55715015/macro-to-loop-through-the-values-of-a-list-in-a-column-and-paste-one-by-one-into/55722123#55722123", "title": "Macro to loop through the values of a list in a column and paste one by one into another cell", "body": "<p>Not sure if I get your point, but you could try something similar to this (not tested):</p>\n\n<pre><code>Dim wb as Workbook\nDim ws_1 as Worksheet\nDim ws_2 as Worksheet\n\nDim ticker_coll as Collection\nDim ticker as Variant\n\nSet ticker_coll = New Collection\nSet wb = ActiveWorkbook\nSet ws_1 = wb.Sheets(1)\nSet ws_2 = wb.Sheets(2)\n\n'Add all tickers from sheet 2 to the collection\nDim counter as Long\nFor counter = 1 To 40\n    ticker_coll.Add ws_2.Range(\"A\" &amp; counter)\nNext counter\n\n'Paste each ticker into sheet 1\nFor counter = 1 To 40\n    ws_1.Range(\"B\" &amp; counter) = ticker_coll(counter)\n    Application.Wait (Now + TimeValue(\"0:00:10\")) 'Wait 10 seconds\nNext counter\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10450878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/439392d435e771585a8c4dab667a7cee?s=128&d=identicon&r=PG&f=1", "display_name": "Mich", "link": "https://stackoverflow.com/users/10450878/mich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1555486010, "creation_date": 1555441336, "question_id": 55715015, "link": "https://stackoverflow.com/questions/55715015/macro-to-loop-through-the-values-of-a-list-in-a-column-and-paste-one-by-one-into", "title": "Macro to loop through the values of a list in a column and paste one by one into another cell", "body": "<p>I have a sheet that pulls some data from yahoo finance. Another sheet contains a list of tickers. I need to copy and paste each of those tickers sequentially, waiting 10 seconds in between each subsequent ticker.</p>\n\n<p>Sheet1 one (cell b1) contains the symbol used to download, while sheet2 (rance A1:A40) contains all the tickers. I am new to Excel and VBA, any help would be much appreciated. </p>\n\n<p>Thank you!</p>\n"}]