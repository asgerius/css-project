[{"tags": ["vba", "pdf"], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 9329588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cfe78216271e99596a97840ac42e891?s=128&d=identicon&r=PG&f=1", "display_name": "Cody Alan", "link": "https://stackoverflow.com/users/9329588/cody-alan"}, "is_accepted": false, "score": 0, "last_activity_date": 1518057238, "creation_date": 1518057238, "answer_id": 48676590, "question_id": 48675269, "link": "https://stackoverflow.com/questions/48675269/print-screen-pdf-file-with-vba/48676590#48676590", "title": "Print Screen PDF file with vba", "body": "<p>Try using the following code in order to open the PDF, <code>FollowHyperlink</code> won't keep it open long enough to print screen.</p>\n\n<pre><code>Dim shell As Object\nSet shell = CreateObject(\"WScript.Shell\")\nshell.Run Chr(34) &amp; strFile &amp; Chr(34), 1, False\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8933510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8abbea4d0cd1f91bd152050021241cb?s=128&d=identicon&r=PG&f=1", "display_name": "Thiago Queiroz", "link": "https://stackoverflow.com/users/8933510/thiago-queiroz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1518057238, "creation_date": 1518047597, "question_id": 48675269, "link": "https://stackoverflow.com/questions/48675269/print-screen-pdf-file-with-vba", "title": "Print Screen PDF file with vba", "body": "<p>I want to open a PDF file and print the subaddress that i specified, but when i use Application.SendKeys \"(%{1068})\" just print screen Userform. My issue is how print screen just subaddress Rating Changes.</p>\n\n<pre><code>enter code here\nPrivate Sub AlteraRating_Click()\nDim strFolde As String, Month As String, Year As String, strFile As String\n\nMonth = Format(SalvaData, \"mm\")\nYear = Format(SalvaData, \"yyyy\")\npdfData = Format(SalvaData, \"yyyymmdd\")\nstrFolder = \"C:\\Report\\Report of Investments\\\" &amp; Year &amp; \"\\\" &amp; Month &amp; \"\\\"\n\n\nstrFile = strFolder &amp; \"RAI_INFRAPREV PLANO CV_F03148_\" &amp; pdfData &amp; \".pdf\"\nThisWorkbook.FollowHyperlink strFile, \"Rating Changes\"\n\nApplication.SendKeys \"(%{1068})\"\nDoEvents\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518102110, "post_id": 48675064, "comment_id": 84374881, "body": "Can you include an example of expected output for the given input?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1518102132, "post_id": 48675064, "comment_id": 84374900, "body": "What&#39;s the question? Have you tried stepping through the code? Set a breakpoint (F9), run the code, and when the breakpoint is hit use F8 to run instructions one by one; use the <i>immediate pane</i> (Ctrl+G) and the <code>?</code>/<code>Print</code> instruction to evaluate expressions in break mode, and use the <i>Locals</i> toolwindow to inspect everything in scope. If the question is about conditionally deleting rows, that&#39;s been answered a hundred times over already."}, {"owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1518103778, "post_id": 48675064, "comment_id": 84376097, "body": "Its not deleting only rows, its deleting rows if the number is bigger and matching with column C"}, {"owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1518104031, "post_id": 48675064, "comment_id": 84376304, "body": "@Mat&#39;sMug I worked on it and i did this part but not working giving me an error invalid qualifer----                   If rev &gt; rev2 Then                     rev2.EntireRow.Delete                 Else                    rev.EntireRow.Delete                  End If"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1518104079, "post_id": 48675064, "comment_id": 84376329, "body": "<i>If the question is about <b>conditionally deleting rows</b>, that&#39;s been answered a hundred times over already.</i> - if your question is about a specific error (as it <i>should be</i>), then <a href=\"https://stackoverflow.com/posts/48675064/edit\">edit</a> your post to include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and tell us about it."}, {"owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1518104208, "post_id": 48675064, "comment_id": 84376425, "body": "@Mat&#39;sMug I didn&#39;t find anything regarding this question ... I am trying to find the bigger number then match column c and then delete smaller number"}], "owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518105506, "creation_date": 1518046283, "last_edit_date": 1531164843, "question_id": 48675064, "link": "https://stackoverflow.com/questions/48675064/finding-largest-number-and-deleting-remaining-smallest-number", "title": "Finding largest number and deleting remaining smallest number", "body": "<p>I am trying to Delete cell by comparing Names within the same column, If I find the same name, Then make sure name is containing bigger number after forward\nslash, If I find the bigger number then make sure my C column matching my criteria (NOT Playing). If it is matching then delete all cell which is a smaller number with column c saying Still Playing and keep only bigger number which is saying Not Playing. Any Ideas, I have posted my code but when I am finding a bigger number, it's going back and comparing with another cell so it's coming back to the same number. Here is my code..</p>\n\n<pre><code>Sub xm()\n    Dim lastrow As Long\n    Dim i As Long, firstD As Integer, secondD As Integer\n    Dim firstForward As Integer\n    Dim secondForward As Integer, score1 As String, score2 As String\n    Dim fName As String, sName As String\n    lastrow = ActiveSheet.UsedRange.Rows.Count\n\n      For i = 2 To lastrow\n\n          firstD = InStr(1, ActiveSheet.Cells(i, 1), \"/\")\n          fName = Left(ActiveSheet.Cells(i, 1), firstD - 1)\n          secondD = InStr(1, ActiveSheet.Cells(i + 1, 1), \"/\")\n          sName = Left(ActiveSheet.Cells(i + 1, 1), secondD - 1)\n\n              If fName = sName Then\n                 firstForward = InStr(1, ActiveSheet.Cells(i, 1), \"/\")\n                 score1 = Mid(ActiveSheet.Cells(i, 4), firstForward + 1)\n                 secondForward = InStr(1, ActiveSheet.Cells(i + 1, 4), \"/\")\n                 score2 = Mid(ActiveSheet.Cells(i + 1, 4), firstForward + 1)\n\n                   If score1 &gt; score2 Then\n                      If ActiveSheet.Cells(i, 3) = \"Not Playing\" Then\n                      'Delete entire cell\n                      End If\n\n                   End If\n              End If\n       i = i + 1\n      Next i\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/RF71M.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RF71M.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Output:---</p>\n\n<p><a href=\"https://i.stack.imgur.com/1rJIK.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1rJIK.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "outlook", "email-attachments", "onedrive"], "comments": [{"owner": {"reputation": 566, "user_id": 2806502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b32865a2b16e1ef490eb1ea9338bee?s=128&d=identicon&r=PG&f=1", "display_name": "garbb", "link": "https://stackoverflow.com/users/2806502/garbb"}, "edited": false, "score": 0, "creation_date": 1518045908, "post_id": 48674710, "comment_id": 84348502, "body": "I tried the code you posted and it worked OK for me. Can you post the exact error message you are getting?"}, {"owner": {"reputation": 11, "user_id": 7781662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81324f380ec29ab0e9835806bb056934?s=128&d=identicon&r=PG&f=1", "display_name": "bird72486", "link": "https://stackoverflow.com/users/7781662/bird72486"}, "reply_to_user": {"reputation": 566, "user_id": 2806502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b32865a2b16e1ef490eb1ea9338bee?s=128&d=identicon&r=PG&f=1", "display_name": "garbb", "link": "https://stackoverflow.com/users/2806502/garbb"}, "edited": false, "score": 0, "creation_date": 1518048270, "post_id": 48674710, "comment_id": 84349208, "body": "Run-Time error &#39;-2147024864 (80070020&#39;:"}, {"owner": {"reputation": 11, "user_id": 7781662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81324f380ec29ab0e9835806bb056934?s=128&d=identicon&r=PG&f=1", "display_name": "bird72486", "link": "https://stackoverflow.com/users/7781662/bird72486"}, "reply_to_user": {"reputation": 566, "user_id": 2806502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b32865a2b16e1ef490eb1ea9338bee?s=128&d=identicon&r=PG&f=1", "display_name": "garbb", "link": "https://stackoverflow.com/users/2806502/garbb"}, "edited": false, "score": 0, "creation_date": 1518048301, "post_id": 48674710, "comment_id": 84349225, "body": "Can&#39;t open file. It&#39;s possible the file is already open, or you don&#39;t have permission to open it."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1518054391, "post_id": 48674710, "comment_id": 84350798, "body": "Where is the code located?"}, {"owner": {"reputation": 11, "user_id": 7781662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81324f380ec29ab0e9835806bb056934?s=128&d=identicon&r=PG&f=1", "display_name": "bird72486", "link": "https://stackoverflow.com/users/7781662/bird72486"}, "edited": false, "score": 0, "creation_date": 1518054622, "post_id": 48674710, "comment_id": 84350845, "body": "In a module, activated by a button on the file I&#39;m trying to attach. The code will do a few minor changes to the file, resave it, then email it. I tried skipping all the code but what I posted and the issue remains. Also tried adding a brand new button with just the code above same result."}, {"owner": {"reputation": 566, "user_id": 2806502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b32865a2b16e1ef490eb1ea9338bee?s=128&d=identicon&r=PG&f=1", "display_name": "garbb", "link": "https://stackoverflow.com/users/2806502/garbb"}, "edited": false, "score": 0, "creation_date": 1518057997, "post_id": 48674710, "comment_id": 84351631, "body": "Maybe save a copy of the file and attach the copy?"}, {"owner": {"reputation": 11, "user_id": 7781662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81324f380ec29ab0e9835806bb056934?s=128&d=identicon&r=PG&f=1", "display_name": "bird72486", "link": "https://stackoverflow.com/users/7781662/bird72486"}, "edited": false, "score": 0, "creation_date": 1518058296, "post_id": 48674710, "comment_id": 84351719, "body": "Good thought. I bet that would work and I&#39;ll probably start writing the code tomorrow to do just that. Only issue with that fix is I have over 150 files in the system that will take months to flush through with this faulty code (or a lot of time updating each one individually. I have multiple modules that use a variation of this function as well that aren&#39;t working either.) On top of that, for prides sake (8 hours working on this already) I want a fix! haha"}], "owner": {"reputation": 11, "user_id": 7781662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81324f380ec29ab0e9835806bb056934?s=128&d=identicon&r=PG&f=1", "display_name": "bird72486", "link": "https://stackoverflow.com/users/7781662/bird72486"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1599, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1518072639, "creation_date": 1518044237, "last_edit_date": 1518072639, "question_id": 48674710, "link": "https://stackoverflow.com/questions/48674710/attachments-add-wont-work-on-the-file-that-is-open-and-running-the-code", "title": ".Attachments.Add won&#39;t work on the file that is open and running the code", "body": "<p>I've have some simple code that has been working for over a year and it all of a sudden stopped working. When I try to add the current file as an attachment to an outlook email it throws an error saying that the file is already open or I don't have permission to access it. </p>\n\n<blockquote>\n  <p>Run-Time error '-2147024864 (80070020')</p>\n</blockquote>\n\n<p>-If I attach the same file (so the file being attached is closed) from a different macro it works fine showing that it isn't a permission issue (I believe at least).</p>\n\n<p>-The file is located in my One Drive folder. If I pull it out on the desktop it works fine. Points to One Drive being the issue somehow.</p>\n\n<p>-If I create a new file, save it in the One Drive folder and paste the below code into a module it works fine. If I then close the file and reopen it, issue returns.</p>\n\n<p>-I have over 10 computers that have this issue that are on Excel Build 9001.2144.\nI have one computer (same exact model computer as some that aren't working) that is on Build 8730.2127 that doesn't have the issue. All computers have the same One Drive build, 17.3.7294.0108. </p>\n\n<p>-I took one computer that wasn't working and reverted to Build 8730.2127 and it worked fine. Seems to me something changed in the update related to how one drive and excel are interacting that is causing my issue.</p>\n\n<p>For clarity, the problem line is:</p>\n\n<pre><code>.Attachments.Add ThisWorkbook.FullName\n</code></pre>\n\n<p>In my research it seems that attaching the active file/active workbook is a common thing. I'm at a complete loss. Any ideas? (Sorry if this is beyond the scope of this message board.) Here's the relevant code:</p>\n\n<pre><code>Dim OutApp As Object, OutMail As Object\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\nWith OutMail\n.To = \"\"\n.CC = \"\"\n.BCC = \"\"\n.Subject = \"\"\n.Body = \"\"\n.Attachments.Add ThisWorkbook.FullName\n.Display\nEnd With\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1518044252, "post_id": 48674649, "comment_id": 84347872, "body": "Try <code>Application.CalculateFullRebuild</code> if you want to be sure everything is fully calculated.  Are you using any custom UDF&#39;s in your workbook?  If Yes do they all have the required parameters to capture all dependencies?"}, {"owner": {"reputation": 7, "user_id": 9330005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6897368874cfcca9e6b5e9159f546f42?s=128&d=identicon&r=PG&f=1", "display_name": "Vib_Eng", "link": "https://stackoverflow.com/users/9330005/vib-eng"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1518100609, "post_id": 48674649, "comment_id": 84373768, "body": "Thanks Tim, I will try that and, no, this workbook does not have any UDFs."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 9330005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6897368874cfcca9e6b5e9159f546f42?s=128&d=identicon&r=PG&f=1", "display_name": "Vib_Eng", "link": "https://stackoverflow.com/users/9330005/vib-eng"}, "edited": false, "score": 0, "creation_date": 1518100099, "post_id": 48676251, "comment_id": 84373415, "body": "Jeffrey, thanks. I agree with you that it is better to remove the need for manual calculation. I already tried to optimize the sheet. I have removed all the volatile formulas and do not have any SUMPRODUCTs. I will have to investigate the double-VLOOKUP trick."}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 0, "last_activity_date": 1518054960, "creation_date": 1518054960, "answer_id": 48676251, "question_id": 48674649, "link": "https://stackoverflow.com/questions/48674649/sheet-enablecalculation-working-intermitently/48676251#48676251", "title": "Sheet EnableCalculation Working Intermitently", "body": "<p>Yes there is a way to ensure sheets calculate when they should do: Refactor the workbook so that you avoid the bottlenecks that forced you to put it into manual calc mode in the first place. Then switch calc mode back to Automatic and leave it there! Manual calc mode is just too dangerous, and almost always completely avoidable. </p>\n\n<p>Common reasons why spreadsheets get so slow that users have to switch to manual calc mode include:</p>\n\n<ul>\n<li>Volatile formulas (OFFSET, INDIRECT, TODAY etc) with large\ncalculation chains hanging off them. See <a href=\"https://chandoo.org/wp/2014/03/03/handle-volatile-functions-like-they-are-dynamite/\" rel=\"nofollow noreferrer\">my blog post here</a>. I've slashed recalc time from minutes to seconds just by addressing this in isolation.</li>\n<li>Overuse of SUMPRODUCT for cases that can be handled by SUMIFS\nor PivotTables. <a href=\"https://stackoverflow.com/questions/28745964/optimizing-excel-formulas-sumproduct-vs-sumifs-countifs/32488911#32488911\">See my answer here</a>.  </li>\n<li>Resource-intensive lookups done on unsorted data. <a href=\"http://dailydoseofexcel.com/archives/2015/04/23/how-much-faster-is-the-double-vlookup-trick\" rel=\"nofollow noreferrer\">See my post\nhere.</a> Using a binary match on sorted data can reduce recalc time\nby minutes.</li>\n</ul>\n\n<p>Charles Williams has a great article on <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/excel-tips-for-optimizing-performance-obstructions\" rel=\"nofollow noreferrer\">finding and optimizing bottle necks here</a>.</p>\n"}], "owner": {"reputation": 7, "user_id": 9330005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6897368874cfcca9e6b5e9159f546f42?s=128&d=identicon&r=PG&f=1", "display_name": "Vib_Eng", "link": "https://stackoverflow.com/users/9330005/vib-eng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 340, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1518060475, "creation_date": 1518043885, "last_edit_date": 1518060475, "question_id": 48674649, "link": "https://stackoverflow.com/questions/48674649/sheet-enablecalculation-working-intermitently", "title": "Sheet EnableCalculation Working Intermitently", "body": "<p>I am working on a spreadsheet for my company and I am having trouble with the EnableCalculation function. We copy large chunks of data and paste them into a workbook. To expedite this process, I 'freeze' sheets by turning the EnableCalculation to False as shown in the example. </p>\n\n<p><em>Disabled</em></p>\n\n<p><img src=\"https://i.stack.imgur.com/uvV2d.png\" alt=\"image description\"></p>\n\n<p>Without  this, Excel slows to a crawl while background calculations are done as the data is being pasted.</p>\n\n<p>In the macro that does the calculation for this workbook once all the data has been pasted, I re-enable the calculation by setting EnableCalculation to True.</p>\n\n<p><em>Re-Enabled</em></p>\n\n<p><img src=\"https://i.stack.imgur.com/hJ22l.png\" alt=\"image description\"></p>\n\n<p>The issue that I have found, however, is that sometimes the sheets calculate properly but other times they do not with seemingly no rhyme or reason. It is extremely frustrating for it to be so unpredictable. Is there a way to ensure that the sheets calculate when they are supposed to? Thanks, </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 2, "creation_date": 1518051691, "post_id": 48674262, "comment_id": 84350155, "body": "The SQL IN expression expects a list of values either 1) explicitly listed or 2) returned by another SQL subquery.  The SQL engine will interpret a string returned from a VBA function as a single value even if the string itself is formatted as a list.  There is no dynamic interpretation of the string value returned by the function.  The SQL query will therefore only match a if a <b>single</b> [Manager UID] column value contains (i.e. is equal to) a list of values - not likely. It is tempting to answer the question with alternatives, but you can search for those separately."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1518059351, "post_id": 48674262, "comment_id": 84352001, "body": "Instead of dynamic parameter in query, set the filter property of form or use WHERE CONDITION argument of OpenForm/OpenReport. Why do you need to build a set and not just use <code>username</code> criteria used for the RecordSet object?"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1518060607, "post_id": 48674262, "comment_id": 84352298, "body": "FYI: I would avoid recursion with SQL queries even for hierarchical data. Instead, it should be much faster to open a single recordset into memory then use the Recordset.FindFirst() method (or other find methods) to search for related row.  The Recordset.Bookmark property can also be useful in this case--for resetting the position as you iterate.  (Pure SQL coupled with appropriately indexed tables is usually the most efficient query path, but the overhead of executing separate queries and retrieving a new recordset has a lot of overhead even within VBA in Access.)"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1518060613, "post_id": 48674262, "comment_id": 84352300, "body": "P.S. The commaDelimitArray() function leaves a dangling apostrophe on the list.  So even if the original query would have worked, the list was not being formatted properly."}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 3418243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c8b01fc92f6e00025fa370b413c95a?s=128&d=identicon&r=PG&f=1", "display_name": "fclinton", "link": "https://stackoverflow.com/users/3418243/fclinton"}, "is_accepted": true, "score": 0, "last_activity_date": 1518134227, "creation_date": 1518134227, "answer_id": 48696731, "question_id": 48674262, "link": "https://stackoverflow.com/questions/48674262/access-select-in-using-vba-function/48696731#48696731", "title": "Access Select IN using VBA function", "body": "<p>So a C Perkins specifically pointed out this would never work so I have rebuilt the query with some other queries.</p>\n"}], "owner": {"reputation": 35, "user_id": 3418243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c8b01fc92f6e00025fa370b413c95a?s=128&d=identicon&r=PG&f=1", "display_name": "fclinton", "link": "https://stackoverflow.com/users/3418243/fclinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 48696731, "answer_count": 1, "score": -1, "last_activity_date": 1518134227, "creation_date": 1518042177, "question_id": 48674262, "link": "https://stackoverflow.com/questions/48674262/access-select-in-using-vba-function", "title": "Access Select IN using VBA function", "body": "<p>So I have this SQL Query</p>\n\n<pre><code>SELECT *\nFROM [Employee To Manager]\nWHERE [Employee To Manager].[Manager UID] In(getMyTeamUserNames());\n</code></pre>\n\n<p>Which has a VBA function getMyTeamUserNames()</p>\n\n<pre><code>Public Function getMyTeamUserNames() As String\nDim rs As DAO.Recordset\nDim dbs As DAO.Database\nSet dbs = CurrentDb\ngetMyTeamUserNames = commaDelimitArray(getTeamUserNames(getUserName, dbs))\nEnd Function\n\nPublic Function commaDelimitArray(arrayStr) As String\nDim sepStr As String\nsepStr = \"','\"\ncommaDelimitArray = \"'\" &amp; Join(arrayStr, sepStr)\n\nEnd Function\nPublic Function getTeamUserNames(username, dbs) As String()\n\nDim sqlstatement As String\nsqlstatement = \"SELECT * FROM [Employee to Manager] WHERE [Employee to \nManager].[Manager UID] = '\" &amp; username &amp; \"'\"\nSet rs = dbs.OpenRecordset(sqlstatement, dbOpenSnapshot)\nDim ComputerUsernames() As String\nDim FindRecordCount As Integer\n   If rs.EOF Then\n  FindRecordCount = 0\n  Exit Function\n  Else\n  rs.MoveLast\n  FindRecordCount = rs.RecordCount\n  End If\n   ReDim ComputerUsernames(FindRecordCount) As String\n   Dim i As Integer\n   i = 0\n   rs.MoveFirst\n    Do Until rs.EOF = True\n      ComputerUsernames(i) = rs(\"Computer Username\")\n        If (ComputerUsernames(i) &lt;&gt; \"\") Then\n                i = i + 1\n        End If\n    If (ComputerUsernames(i - 1) &lt;&gt; username) Then\n      Dim recurResult() As String\n      recurResult = getTeamUserNames(ComputerUsernames(i - 1), dbs)\n\n      Dim resultSize As Integer\n      If Len(Join(recurResult)) &gt; 0 Then\n      resultSize = UBound(recurResult) - LBound(recurResult) + 1\n      ReDim Preserve ComputerUsernames(UBound(ComputerUsernames) + resultSize)\n      For Each resultStr In recurResult\n      ComputerUsernames(i) = resultStr\n        If (ComputerUsernames(i) &lt;&gt; \"\") Then\n                i = i + 1\n        End If\n      Next resultStr\n      End If\n    End If\n      rs.MoveNext\nLoop\nReDim Preserve ComputerUsernames(i - 1)\ngetTeamUserNames = ComputerUsernames\nEnd Function\n</code></pre>\n\n<p>Query runs and I get no data.\nHowever if I take the result from getMyTeamUserNames() and put it in the query by hand it works. getMyTeamUserNames() result varies from possibly 2 results to 40 (recursively gets subordinates all the way down the tree).</p>\n"}, {"tags": ["excel", "dll", "vba"], "comments": [{"owner": {"reputation": 2038, "user_id": 7129076, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a190b1b49a5ce2f6d1ead8ccbb11dc35?s=128&d=identicon&r=PG&f=1", "display_name": "gilliduck", "link": "https://stackoverflow.com/users/7129076/gilliduck"}, "edited": false, "score": 0, "creation_date": 1518041528, "post_id": 48674115, "comment_id": 84346706, "body": "Did you have to register the 32 bit version to get it to work?"}, {"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "reply_to_user": {"reputation": 2038, "user_id": 7129076, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a190b1b49a5ce2f6d1ead8ccbb11dc35?s=128&d=identicon&r=PG&f=1", "display_name": "gilliduck", "link": "https://stackoverflow.com/users/7129076/gilliduck"}, "edited": false, "score": 0, "creation_date": 1518054893, "post_id": 48674115, "comment_id": 84350911, "body": "I don&#39;t know, it is installed by a 3rd party app. I&#39;ll look in the reg, but I&#39;m not sure that will prove anything."}, {"owner": {"reputation": 2038, "user_id": 7129076, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a190b1b49a5ce2f6d1ead8ccbb11dc35?s=128&d=identicon&r=PG&f=1", "display_name": "gilliduck", "link": "https://stackoverflow.com/users/7129076/gilliduck"}, "edited": false, "score": 0, "creation_date": 1518100506, "post_id": 48674115, "comment_id": 84373697, "body": "If it&#39;s installed by another app, odds are good it registers it."}, {"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "reply_to_user": {"reputation": 2038, "user_id": 7129076, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a190b1b49a5ce2f6d1ead8ccbb11dc35?s=128&d=identicon&r=PG&f=1", "display_name": "gilliduck", "link": "https://stackoverflow.com/users/7129076/gilliduck"}, "edited": false, "score": 0, "creation_date": 1518101559, "post_id": 48674115, "comment_id": 84374435, "body": "I guess my real question is how does Lib &quot;CompPl32.dll&quot; work? Does it go to the registry, or does it look for that file?"}, {"owner": {"reputation": 7055, "user_id": 1374704, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/VNVyl.png?s=128&g=1", "display_name": "manuell", "link": "https://stackoverflow.com/users/1374704/manuell"}, "edited": false, "score": 0, "creation_date": 1518108398, "post_id": 48674115, "comment_id": 84379328, "body": "Have you found the string <code>CompPl32.dll</code> in the Registry?"}], "owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 312, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1518043161, "creation_date": 1518041385, "last_edit_date": 1531164843, "question_id": 48674115, "link": "https://stackoverflow.com/questions/48674115/do-i-have-to-register-a-dll-to-use-it-in-excel", "title": "Do i have to register a DLL to use it in Excel?", "body": "<p>An older product we use has a 32-bit DLL that does Deflate compress/decompress. We import it in VBA thus:</p>\n\n<pre><code>Declare PtrSafe Function EtUnCompress Lib \"CompPl32.dll\" (ByVal SrcSt$, \n                                                          ByVal SrcLen As Long, \n                                                          Dest As Any, \n                                                          ByVal DestLen As Long) As Long\n</code></pre>\n\n<p>Some of our customers have 64-bit Office, so that's a problem. I was able to write my own 64-bit version using <code>System.IO.Compression</code>, with surprising ease. </p>\n\n<p><em>Now the question</em></p>\n\n<p>If I were to name my version CompPl32.dll and put it in System32, is that enough?</p>\n\n<p>Or does my version <em>have</em> to be registered to work in Excel VBA?</p>\n\n<p>I have 32-bit Office so I can't test this.</p>\n"}, {"tags": ["vba", "excel", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1518117669, "post_id": 48673639, "comment_id": 84384828, "body": "There are nested tables in the sample, what is expected output on the worksheet?"}, {"owner": {"reputation": 127, "user_id": 9114996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1f2083850b19fc75ed421920fc644b79?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/9114996/francis"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1518118252, "post_id": 48673639, "comment_id": 84385146, "body": "@omegastripes I have uploaded an image of how it should look like in the worksheet. <a href=\"https://imgur.com/28ktFON\" rel=\"nofollow noreferrer\">link</a>. I came across one way to handle this, but it&#39;s not ideal and only grabs the content from one table. The reports on the website sometimes displays two below each other, seen here <a href=\"https://imgur.com/CuI5LcA\" rel=\"nofollow noreferrer\">link</a>"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 9114996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1f2083850b19fc75ed421920fc644b79?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/9114996/francis"}, "edited": false, "score": 0, "creation_date": 1518040621, "post_id": 48673758, "comment_id": 84346296, "body": "Thanks for your help, Nicholas! Unfortunately, the table has neither an ID nor a class assigned to it. I will try out what you suggested and will return with hopefully some good news."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 127, "user_id": 9114996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1f2083850b19fc75ed421920fc644b79?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/9114996/francis"}, "edited": false, "score": 0, "creation_date": 1518041050, "post_id": 48673758, "comment_id": 84346499, "body": "@Francis - Can you include some sample HTML in your OP?"}, {"owner": {"reputation": 127, "user_id": 9114996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1f2083850b19fc75ed421920fc644b79?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/9114996/francis"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1518041384, "post_id": 48673758, "comment_id": 84346645, "body": "@BruceWayne I went ahead and added the HTML. Hope this helps"}, {"owner": {"reputation": 127, "user_id": 9114996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1f2083850b19fc75ed421920fc644b79?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/9114996/francis"}, "edited": false, "score": 0, "creation_date": 1518047257, "post_id": 48673758, "comment_id": 84348969, "body": "Sadly, so far no luck getting this to run. Getting a Type Mismatch error on <code>Cells(i, j) = td.innerText</code>."}, {"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "edited": false, "score": 0, "creation_date": 1518102575, "post_id": 48673758, "comment_id": 84375181, "body": "I edited the code, try if it works now. The previous code was something like a pseudocode, but this one should work properly, aside from the number of the <code>&lt;table&gt;</code> tag."}, {"owner": {"reputation": 127, "user_id": 9114996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1f2083850b19fc75ed421920fc644b79?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/9114996/francis"}, "edited": false, "score": 0, "creation_date": 1518122105, "post_id": 48673758, "comment_id": 84387168, "body": "@NicholasKemp Hey thanks! I tried it out again, but get the message that the variable <code>tr</code> isn&#39;t defined. Again, I am new to this, so I apologize for the question. Is this a matter of getting the correct reference ?"}, {"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "edited": false, "score": 0, "creation_date": 1518123967, "post_id": 48673758, "comment_id": 84388092, "body": "Mmm the <code>For each</code> loop should implicitly define the iterator, but you could always try explicitly defining it with <code>Dim tr as object</code> or  <code>Dim tr as HTMLTableRow</code>."}, {"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "edited": false, "score": 0, "creation_date": 1518127482, "post_id": 48673758, "comment_id": 84389782, "body": "Check the edit, found a piece of code that uses a regular <code>For</code> loop instead of a <code>For each</code> loop"}, {"owner": {"reputation": 127, "user_id": 9114996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1f2083850b19fc75ed421920fc644b79?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/9114996/francis"}, "edited": false, "score": 0, "creation_date": 1518133159, "post_id": 48673758, "comment_id": 84391869, "body": "@NicholasKemp Thanks again for taking the time to go through this in detail. I went ahead and tried out the code, with some minor changes, and get a <code>Type Mismatch</code> error on this line <code>Dim table As HTMLTable: Set table = objIE.document.getElementsByTagName(&quot;Table&quot;)</code>. Since the table doesn&#39;t have an ID associated with it, I assumed this would be the correct approach."}], "tags": [], "owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "is_accepted": false, "score": 0, "last_activity_date": 1518127390, "last_edit_date": 1518127390, "creation_date": 1518039842, "answer_id": 48673758, "question_id": 48673639, "link": "https://stackoverflow.com/questions/48673639/assigning-every-td-to-every-cell-in-excel/48673758#48673758", "title": "Assigning every &lt;td&gt; to every cell in Excel", "body": "<p>You should not work with the <code>div</code>, but with the <code>table</code>, and then loop for each <code>tr</code> and for each <code>td</code>. You can try something like:</p>\n\n<pre><code>    Dim table as HTMLTable : Set table = .document.getElementsByTagName(\"table\")(Number of the table tag, counting from 0)\n\n    dim i as integer: i = 1 'Starting from row 1\n    dim j as integer: j = 1 'Starting from column 1 (\"A\")\n    For each tr in table.Children(0).Children 'Children(0) of table is ussualy a tbody, use Children(1) if the table also contains a thead tag\n        For each td in tr.children\n            Cells(i,j) = td.innertext\n            j=j+1\n        next td\n        i=i+1\n    next tr\n</code></pre>\n\n<p>If you can't access the table by <code>id</code>, try accessing to it by <code>class</code> or by <code>tagName</code>, or by using <code>.Children(i)</code> on the <code>div</code> and subsequent children elements.</p>\n\n<p>Edit: I edited the code so it should work without further editing, aside from the number of the table tag. Just paste this below <code>Range(\"A1:K500\").ClearContents</code> and comment if it works. The number of the table tag should be the one you get by manually counting each <code>&lt;table&gt;</code> tag that appears in the HTML in order, starting from 0.</p>\n\n<p>Edit2: Just saw the HTML. Instead of using <code>.document.getElementsByTagName(\"table\")(Number of the table tag, counting from 0)</code> you can directly use <code>.document.getElementByID(\"printOut\").children(0)</code> to initialize the <code>table</code> variable. The <code>.Children(i)</code> method returns the 'i'th children element of a tag, that is, the 'i'th tag nested in that specific tag. In this case, the div first (0) children would be the first table tag inside that div. If that is the table you are looking to get, leave it as <code>.Children(0)</code>. If not, try <code>.Children(1)</code> or <code>.Children(2)</code> for the other tables in the div.</p>\n\n<p>Edit3: I just found I have some piece of code that does almost exactly what you want, except it copies the HTML table to a 2D array instead to the excel worksheet. You can then copy the array to the worksheet, or modify the code to copy the table directly to the worksheet.</p>\n\n<pre><code>Dim MatrizCO() as variant\nReDim MatrizCO(0 To 60, 0 To 1)\nDim table As HTMLTable: Set table = \nobjIE.document.getElementById(\"DetalleContainerTbl\")\nOn Error GoTo SalirFor:\nFor i = 0 To 60\n    MatrizCO(i, 0) = table.Children(1).Children(i).Children(1).innerText\n    MatrizCO(i, 1) = table.Children(1).Children(i).Children(8).innerText\nNext\nSalirFor:\n</code></pre>\n\n<p>Code explained: First, define the 2D array as a variant without dimensions and then <code>ReDim</code> it to have the dimensions (Rows,Columns) you need to copy the table (You can also hard-code the dimension on array definition but in my case I need the array to be dynamic). Then, you tell the program to exit the for loop on an error, in case the table dimension in each different case varies a bit. Then you loop through all rows i (and, in your case, you should also loop through all columns j). Finally you just asign every i,j position in the array to the i,j position in the table (Here, j's place would be where 1 and 8 are as arguments of .<code>Children</code>). Again, the first <code>.Children</code>'s of <code>table</code> argument is 1, because, in my case, the  has a  aside from the  tag. If there\u00b4s no , then the argument for it would be 0.</p>\n"}], "owner": {"reputation": 127, "user_id": 9114996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1f2083850b19fc75ed421920fc644b79?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/9114996/francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1518212471, "creation_date": 1518039353, "last_edit_date": 1518212471, "question_id": 48673639, "link": "https://stackoverflow.com/questions/48673639/assigning-every-td-to-every-cell-in-excel", "title": "Assigning every &lt;td&gt; to every cell in Excel", "body": "<p>I am trying to extract the content from a table, which is within a <code>&lt;div&gt;</code> element, from a website. Currently, I can successfully login, navigate to the specific page and load the report, however, I am having difficulty pulling the data from that table.\nI have looked up several sources, but sadly, haven't been able to implement this into the script.</p>\n\n<p>This is what I currently have:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nConst MyUserID As String = \"test123\"\nConst MyPassword As String = \"test123\"\nConst READYSTATE_COMPLETE As Integer = 4\nDim objIE As Object\nDim sPageHTML  As String\n\nPublic Sub LoginScript()\n\n    Set objIE = CreateObject(\"InternetExplorer.Application\")\n    With objIE\n        .Visible = True\n        .Silent = True\n        .Navigate \"https://www.mywebsite.com\"\n        Do Until .ReadyState = READYSTATE_COMPLETE\n            DoEvents\n        Loop\n        Application.Wait Now() + TimeValue(\"00:00:02\")\n        .Document.all.txtuserid.Value = MyUserID\n        .Document.all.txtPassword.Value = MyPassword\n        .Document.getElementsByName(\"btnSubmit\")(0).Click\n        Do Until .ReadyState = READYSTATE_COMPLETE\n            DoEvents\n        Loop\n        Application.Wait Now() + TimeValue(\"00:00:02\")\n        .Navigate \"https://www.mywebsite.com/sample.html\"\n        Do Until .ReadyState = READYSTATE_COMPLETE\n            DoEvents\n        Loop\n        .Document.getElementsByName(\"LocationID\")(0).Value = \"7\"\n        .Document.getElementsByName(\"endDay\")(0).Value = \"31\"\n        .Document.getElementsByName(\"endMonth\")(0).Value = \"12\"\n        .Document.getElementsByName(\"endYear\")(0).Value = \"2018\"\n        .Document.getElementsByName(\"view\")(0).Click\n        Do Until .ReadyState = READYSTATE_COMPLETE\n            DoEvents\n        Loop\n        Application.Wait Now() + TimeValue(\"00:00:02\")\n        ThisWorkbook.Sheets(\"Sheet2\").Activate\n        Range(\"A1:K500\").ClearContents\n        sPageHTML = .Document.getElementByID(\"printOut\").innerText\n        ThisWorkbook.Sheets(2).Range(\"A1\") = sPageHTML\n        .Navigate \"https://www.mywebsite.com/logout\"\n        Do Until .ReadyState = READYSTATE_COMPLETE\n            DoEvents\n        Loop\n        .Quit\n        Shell \"RunDll32.exe InetCpl.Cpl, ClearMyTracksByProcess 11\"\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I understand that the following line</p>\n\n<pre><code>ThisWorkbook.Sheets(2).Range(\"A1\") = sPageHTML\n</code></pre>\n\n<p>places the entire content into that single cell. Unfortunately, while trying out several options, I have had no luck trying to assign every TD to a cell.</p>\n\n<p>The ID \"printOut\" is of the <code>&lt;div&gt;</code> element.</p>\n\n<p>Below is the HTML content within the <code>&lt;div&gt;</code> element:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div id=\"printOut\"&gt;\r\n    &lt;table&gt;\r\n        &lt;tbody&gt;\r\n            &lt;tr&gt;\r\n                &lt;td&gt;\r\n                    &lt;table&gt;\r\n                        &lt;tbody&gt;\r\n                            &lt;tr&gt;\r\n                                &lt;td&gt;&lt;/td&gt;\r\n                            &lt;/tr&gt;\r\n                        &lt;/tbody&gt;\r\n                    &lt;/table&gt;\r\n                &lt;/td&gt;\r\n            &lt;/tr&gt;\r\n        &lt;/tbody&gt;\r\n    &lt;/table&gt;&lt;br&gt;\r\n    &lt;table align=\"center\" border=\"1\" cellpadding=\"1\" cellspacing=\"0\"&gt;\r\n        &lt;tbody&gt;\r\n            &lt;tr&gt;\r\n                &lt;td&gt;\r\n                    &lt;table align=\"center\" bgcolor=\"#0080C0\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"&gt;\r\n                        &lt;tbody&gt;\r\n                            &lt;tr&gt;\r\n                                &lt;td&gt;\r\n                                    &lt;table cellpadding=\"0\" cellspacing=\"0\"&gt;\r\n                                        &lt;tbody&gt;\r\n                                            &lt;tr&gt;\r\n                                                &lt;td align=\"center\" bgcolor=\"#0080C0\" class=\"white\" nowrap width=\"150\"&gt;\r\n                                                    Ventura&lt;br&gt;\r\n                                                    &lt;a class=\"red\" href=\"javascript:WinOpenPopup('s_ReservationBufferAdd.asp?dir=add1&amp;amp;goto=Unallocating&amp;amp;CarSizeID=&amp;amp;PickupLocationID=')\" title=\"Book\"&gt;&lt;img border=\"0\" src=\"images/b_Unallocat.jpg\"&gt;&lt;/a&gt;\r\n                                                &lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                            &lt;tr bgcolor=\"#FFFFFF\"&gt;\r\n                                                &lt;td class=\"texunderline\"&gt;&lt;b&gt;Available&lt;/b&gt;&lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                            &lt;tr bgcolor=\"#FFFFFF\"&gt;\r\n                                                &lt;td class=\"texunderline\"&gt;&lt;b&gt;PickUp&lt;/b&gt;&lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                            &lt;tr bgcolor=\"#FFFFFF\"&gt;\r\n                                                &lt;td class=\"texunderline\"&gt;&lt;b&gt;Dropoff&lt;/b&gt;&lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                        &lt;/tbody&gt;\r\n                                    &lt;/table&gt;\r\n                                &lt;/td&gt;\r\n                                &lt;td&gt;\r\n                                    &lt;table border=\"0\" cellpadding=\"0\" cellspacing=\"0\"&gt;\r\n                                        &lt;tbody&gt;\r\n                                            &lt;tr&gt;\r\n                                                &lt;td align=\"right\" bgcolor=\"#0080C0\" class=\"white\" nowrap&gt;\r\n                                                    &lt;a class=\"sheetwhite\" href=\"javascript:WinOpenPopup('s_bookingListDaily.asp?date=2018-02-07&amp;amp;LocationID=7&amp;amp;CategoryID=3')\" title=\"Wednesday\"&gt;&lt;small&gt;&lt;font color=\"#E6E600\"&gt;&lt;/font&gt;&lt;/small&gt;&lt;br&gt;\r\n                                                    7 Feb&amp;nbsp;&lt;/a&gt;\r\n                                                &lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                            &lt;tr bgcolor=\"#FFFFFF\"&gt;\r\n                                                &lt;td align=\"right\" bgcolor=\"#FF6262\" class=\"white\" width=\"50\"&gt;0&lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                            &lt;tr bgcolor=\"#FFFFFF\"&gt;\r\n                                                &lt;td align=\"right\" class=\"texunderline\" width=\"50\"&gt;0&lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                            &lt;tr bgcolor=\"#FFFFFF\"&gt;\r\n                                                &lt;td align=\"right\" class=\"texunderline\" width=\"50\"&gt;0&lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                        &lt;/tbody&gt;\r\n                                    &lt;/table&gt;\r\n                                &lt;/td&gt;\r\n                                &lt;td&gt;\r\n                                    &lt;table border=\"0\" cellpadding=\"0\" cellspacing=\"0\"&gt;\r\n                                        &lt;tbody&gt;\r\n                                            &lt;tr&gt;\r\n                                                &lt;td align=\"right\" bgcolor=\"#0080C0\" class=\"white\" nowrap&gt;\r\n                                                    &lt;a class=\"sheetwhite\" href=\"javascript:WinOpenPopup('s_bookingListDaily.asp?date=2018-02-08&amp;amp;LocationID=7&amp;amp;CategoryID=3')\" title=\"Thursday\"&gt;&lt;small&gt;&lt;font color=\"#E6E600\"&gt;&lt;/font&gt;&lt;/small&gt;&lt;br&gt;\r\n                                                    8 Feb&amp;nbsp;&lt;/a&gt;\r\n                                                &lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                            &lt;tr bgcolor=\"#FFFFFF\"&gt;\r\n                                                &lt;td align=\"right\" bgcolor=\"#FF6262\" class=\"white\" width=\"50\"&gt;0&lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                            &lt;tr bgcolor=\"#FFFFFF\"&gt;\r\n                                                &lt;td align=\"right\" class=\"texunderline\" width=\"50\"&gt;0&lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                            &lt;tr bgcolor=\"#FFFFFF\"&gt;\r\n                                                &lt;td align=\"right\" class=\"texunderline\" width=\"50\"&gt;0&lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                        &lt;/tbody&gt;\r\n                                    &lt;/table&gt;\r\n                                &lt;/td&gt;\r\n                            &lt;/tr&gt;\r\n                        &lt;/tbody&gt;\r\n                    &lt;/table&gt;\r\n                &lt;/td&gt;\r\n            &lt;/tr&gt;\r\n        &lt;/tbody&gt;\r\n    &lt;/table&gt;&lt;br&gt;\r\n    &lt;table align=\"center\" border=\"1\" cellpadding=\"1\" cellspacing=\"0\"&gt;\r\n        &lt;tbody&gt;\r\n            &lt;tr&gt;\r\n                &lt;td&gt;\r\n                    &lt;table align=\"center\" bgcolor=\"#0080C0\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"&gt;\r\n                        &lt;tbody&gt;\r\n                            &lt;tr&gt;\r\n                                &lt;td&gt;\r\n                                    &lt;table cellpadding=\"0\" cellspacing=\"0\"&gt;\r\n                                        &lt;tbody&gt;\r\n                                            &lt;tr&gt;\r\n                                                &lt;td align=\"center\" bgcolor=\"#0080C0\" class=\"white\" nowrap width=\"150\"&gt;\r\n                                                    Mavericks&lt;br&gt;\r\n                                                    &lt;a class=\"red\" href=\"javascript:WinOpenPopup('s_ReservationBufferAdd.asp?dir=add1&amp;amp;goto=Unallocating&amp;amp;CarSizeID=&amp;amp;PickupLocationID=')\" title=\"Book\"&gt;&lt;img border=\"0\" src=\"images/b_Unallocat.jpg\"&gt;&lt;/a&gt;\r\n                                                &lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                            &lt;tr bgcolor=\"#FFFFFF\"&gt;\r\n                                                &lt;td class=\"texunderline\"&gt;&lt;b&gt;Available&lt;/b&gt;&lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                            &lt;tr bgcolor=\"#FFFFFF\"&gt;\r\n                                                &lt;td class=\"texunderline\"&gt;&lt;b&gt;PickUp&lt;/b&gt;&lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                            &lt;tr bgcolor=\"#FFFFFF\"&gt;\r\n                                                &lt;td class=\"texunderline\"&gt;&lt;b&gt;Dropoff&lt;/b&gt;&lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                        &lt;/tbody&gt;\r\n                                    &lt;/table&gt;\r\n                                &lt;/td&gt;\r\n                                &lt;td&gt;\r\n                                    &lt;table border=\"0\" cellpadding=\"0\" cellspacing=\"0\"&gt;\r\n                                        &lt;tbody&gt;\r\n                                            &lt;tr&gt;\r\n                                                &lt;td align=\"right\" bgcolor=\"#0080C0\" class=\"white\" nowrap&gt;\r\n                                                    &lt;a class=\"sheetwhite\" href=\"javascript:WinOpenPopup('s_bookingListDaily.asp?date=2018-02-07&amp;amp;LocationID=7&amp;amp;CategoryID=2')\" title=\"Wednesday\"&gt;&lt;small&gt;&lt;font color=\"#E6E600\"&gt;&lt;/font&gt;&lt;/small&gt;&lt;br&gt;\r\n                                                    7 Feb&amp;nbsp;&lt;/a&gt;\r\n                                                &lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                            &lt;tr bgcolor=\"#FFFFFF\"&gt;\r\n                                                &lt;td align=\"right\" class=\"texunderline\" width=\"50\"&gt;9&lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                            &lt;tr bgcolor=\"#FFFFFF\"&gt;\r\n                                                &lt;td align=\"right\" class=\"texunderline\" width=\"50\"&gt;0&lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                            &lt;tr bgcolor=\"#FFFFFF\"&gt;\r\n                                                &lt;td align=\"right\" class=\"texunderline\" width=\"50\"&gt;1&lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                        &lt;/tbody&gt;\r\n                                    &lt;/table&gt;\r\n                                &lt;/td&gt;\r\n                                &lt;td&gt;\r\n                                    &lt;table border=\"0\" cellpadding=\"0\" cellspacing=\"0\"&gt;\r\n                                        &lt;tbody&gt;\r\n                                            &lt;tr&gt;\r\n                                                &lt;td align=\"right\" bgcolor=\"#0080C0\" class=\"white\" nowrap&gt;\r\n                                                    &lt;a class=\"sheetwhite\" href=\"javascript:WinOpenPopup('s_bookingListDaily.asp?date=2018-02-08&amp;amp;LocationID=7&amp;amp;CategoryID=2')\" title=\"Thursday\"&gt;&lt;small&gt;&lt;font color=\"#E6E600\"&gt;&lt;/font&gt;&lt;/small&gt;&lt;br&gt;\r\n                                                    8 Feb&amp;nbsp;&lt;/a&gt;\r\n                                                &lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                            &lt;tr bgcolor=\"#FFFFFF\"&gt;\r\n                                                &lt;td align=\"right\" class=\"texunderline\" width=\"50\"&gt;10&lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                            &lt;tr bgcolor=\"#FFFFFF\"&gt;\r\n                                                &lt;td align=\"right\" class=\"texunderline\" width=\"50\"&gt;0&lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                            &lt;tr bgcolor=\"#FFFFFF\"&gt;\r\n                                                &lt;td align=\"right\" class=\"texunderline\" width=\"50\"&gt;2&lt;/td&gt;\r\n                                            &lt;/tr&gt;\r\n                                        &lt;/tbody&gt;\r\n                                    &lt;/table&gt;\r\n                                &lt;/td&gt;\r\n                            &lt;/tr&gt;\r\n                        &lt;/tbody&gt;\r\n                    &lt;/table&gt;\r\n                    &lt;form action=\"s_printToExcel.aspx\" id=\"expExcel\" method=\"post\" name=\"expExcel\" target=\"_blank\"&gt;\r\n                        &lt;input id=\"htmlOut\" name=\"htmlOut\" type=\"hidden\" value=\"\"&gt;\r\n                    &lt;/form&gt;\r\n                &lt;/td&gt;\r\n            &lt;/tr&gt;\r\n        &lt;/tbody&gt;\r\n    &lt;/table&gt;\r\n    &lt;table align=\"center\"&gt;\r\n        &lt;tbody&gt;\r\n            &lt;tr&gt;\r\n                &lt;td class=\"notetext\"&gt;Note:&lt;/td&gt;\r\n                &lt;td class=\"notetext\"&gt;&lt;/td&gt;\r\n            &lt;/tr&gt;\r\n            &lt;tr&gt;\r\n                &lt;td class=\"notetext\"&gt;1.&lt;/td&gt;\r\n                &lt;td class=\"notetext\"&gt;Today's Available = Yesterday's Available + Yesterday's dropoff (does not include same day drop offs) - Today's Pickup + NewFleetNo - OffFleetNo .&lt;/td&gt;\r\n            &lt;/tr&gt;\r\n            &lt;tr&gt;\r\n                &lt;td class=\"notetext\"&gt;2.&lt;/td&gt;\r\n                &lt;td align=\"left\" class=\"notetext\"&gt;The report includes unallocated bookings&lt;/td&gt;\r\n            &lt;/tr&gt;\r\n            &lt;tr&gt;\r\n                &lt;td class=\"notetext\"&gt;3.&lt;/td&gt;\r\n                &lt;td class=\"notetext\"&gt;If you click on the date, you can see a listing of the pickups and drop offs for this day and location.&lt;/td&gt;\r\n            &lt;/tr&gt;\r\n            &lt;tr&gt;\r\n                &lt;td class=\"notetext\"&gt;4.&lt;/td&gt;\r\n                &lt;td class=\"notetext\"&gt;Please make sure all bookings have correct status, i.e., hired, returned, and cancelled if not hired. Incorrect status may cause incorrect vehicle current location.&lt;/td&gt;\r\n            &lt;/tr&gt;\r\n        &lt;/tbody&gt;\r\n    &lt;/table&gt;&lt;br&gt;\r\n    &lt;p&gt;&lt;/p&gt;\r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I thought I'd share a \"solution\" to my issue, which partially works. Just not quite perfect.</p>\n\n<pre><code>Set elemCollection = objIE.document.getElementByID(\"printOut\").getElementsByTagName(\"TABLE\")\n\n    For t = 0 To (elemCollection.Length - 1)\n\n        For r = 0 To (elemCollection(t).Rows.Length - 1)\n            For c = 0 To (elemCollection(t).Rows(r).Cells.Length - 1)\n                ThisWorkbook.Worksheets(2).Cells(r + 1, c + 1) = elemCollection(t).Rows(r).Cells(c).innerText\n            Next c\n        Next r\n    Next t\n</code></pre>\n\n<p>This extracts one of the tables within the <code>&lt;div&gt;</code> element, oddly enough not both, in case the reports provides two. The content, with multi-lines gets placed in a single cell row, which I then need to split, as seen below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0BrnN.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0BrnN.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Here's a sample image of what the report looks like on the website.</p>\n\n<p><a href=\"https://i.stack.imgur.com/69nup.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/69nup.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 442, "user_id": 6255370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db779426ce3f9e2cff2281558ddbcc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Kim Raaness", "link": "https://stackoverflow.com/users/6255370/kim-raaness"}, "edited": false, "score": 0, "creation_date": 1518038417, "post_id": 48673321, "comment_id": 84345265, "body": "myDocument.Shapes(1) will always return the same shape. You should pass index as a parameter to your sub and do myDocument.Shapes(index)"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 2, "last_activity_date": 1518038907, "creation_date": 1518038907, "answer_id": 48673549, "question_id": 48673321, "link": "https://stackoverflow.com/questions/48673321/ms-word-macro-vba-help-selected-image/48673549#48673549", "title": "MS Word Macro VBA Help, Selected image", "body": "<p>If you want this to work with the selected image, and only the selected image, then more like this, where you get the Shape from the current selection.</p>\n\n<p>Note how you should first check to make sure a Shape is selected...</p>\n\n<pre><code>Sub PositionSelectedShape()\n    Dim sel As word.Selection\n    Dim shp As word.Shape\n\n    Set sel = Selection\n    If sel.Type = wdSelectionShape Then\n        Set shp = sel.ShapeRange(1)\n        With shp\n            .WrapFormat.Type = wdWrapSquare\n            .RelativeHorizontalPosition = wdRelativeHorizontalPositionPage\n            .Left = wdShapeCenter\n            .RelativeVerticalPosition = wdRelativeVerticalPositionPage\n            .Top = InchesToPoints(1)\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 179, "user_id": 7684046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/527159e9ffe0426a59486efdebaa278b?s=128&d=identicon&r=PG&f=1", "display_name": "Lincoln", "link": "https://stackoverflow.com/users/7684046/lincoln"}, "is_accepted": true, "score": 0, "last_activity_date": 1518039112, "creation_date": 1518039112, "answer_id": 48673595, "question_id": 48673321, "link": "https://stackoverflow.com/questions/48673321/ms-word-macro-vba-help-selected-image/48673595#48673595", "title": "MS Word Macro VBA Help, Selected image", "body": "<p>Exactly like <a href=\"https://stackoverflow.com/users/6255370/kim-raaness\">Kim Raaness</a> has suggested, you need to loop through all shapes of you would like to centre them all.</p>\n\n<p>Try something like this:</p>\n\n<pre><code>Sub AlignToCentre()\n'\n' AlignToCentre\n\n    Dim shp As Shape\nSet myDocument = ActiveDocument\nFor Each shp in myDocument.Shapes\n  With shp\n        .WrapFormat.Type = wdWrapSquare\n        .RelativeHorizontalPosition = wdRelativeHorizontalPositionPage\n        .Left = wdShapeCenter\n        .RelativeVerticalPosition = wdRelativeVerticalPositionPage\n        .Top = InchesToPoints(1)\n  End With\nNext shp\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9329864, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qDxD53fXyCk/AAAAAAAAAAI/AAAAAAAABf0/93rf436CUyk/photo.jpg?sz=128", "display_name": "Dan Laine", "link": "https://stackoverflow.com/users/9329864/dan-laine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 838, "favorite_count": 0, "accepted_answer_id": 48673595, "answer_count": 2, "score": 0, "last_activity_date": 1518053445, "creation_date": 1518037917, "last_edit_date": 1518053445, "question_id": 48673321, "link": "https://stackoverflow.com/questions/48673321/ms-word-macro-vba-help-selected-image", "title": "MS Word Macro VBA Help, Selected image", "body": "<p>I have basic Macro and VBA knowledge yet cannot get my head around where I am going wrong here. (Code inserted at the bottom) I want my macro to move a selected image into the top centre of the page. The issue I am facing is that it will not work for each image in the document, it works for the first one then no longer performs the task. I am using Microsoft Word 2016.</p>\n\n<p>The main command does what I want it to, I feel my error is within these two lines </p>\n\n<pre><code>Set myDocument = ActiveDocument\nWith myDocument.Shapes(1)\n</code></pre>\n\n<hr>\n\n<p>Whole code;</p>\n\n<pre><code>Sub AlignToCentre()\n'\n' AlignToCentre\n\n    Dim shp As Shape\nSet myDocument = ActiveDocument\nWith myDocument.Shapes(1)\n        .WrapFormat.Type = wdWrapSquare\n        .RelativeHorizontalPosition = wdRelativeHorizontalPositionPage\n        .Left = wdShapeCenter\n        .RelativeVerticalPosition = wdRelativeVerticalPositionPage\n        .Top = InchesToPoints(1)\n\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["database", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "edited": false, "score": 0, "creation_date": 1518038286, "post_id": 48673322, "comment_id": 84345185, "body": "I entered that in and it says &quot;Compile Error, Method or Data Member not Found&quot;"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "edited": false, "score": 0, "creation_date": 1518038373, "post_id": 48673322, "comment_id": 84345244, "body": "ah, sorry, fixed it now"}, {"owner": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "edited": false, "score": 0, "creation_date": 1518038650, "post_id": 48673322, "comment_id": 84345371, "body": "<a href=\"https://gyazo.com/954b87cfc5c17267077bb512ccb0484f\" rel=\"nofollow noreferrer\">gyazo.com/954b87cfc5c17267077bb512ccb0484f</a> Couldnt post code here as it was too long but I have added this in but the TimeInterval doesnt seem to execute, the code executes instantly without waiting 5 seconds"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "edited": false, "score": 0, "creation_date": 1518038711, "post_id": 48673322, "comment_id": 84345402, "body": "Have you added it in the form_timer section, and not form_load?"}, {"owner": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "edited": false, "score": 0, "creation_date": 1518038822, "post_id": 48673322, "comment_id": 84345458, "body": "I have figured it out, i needed to put <code>Me.TimerInterval =5000</code> at the beginning at the <code>Me.TimerInterval=0</code> in the Form_Timer() along with the rest of my code for the msgbox. thanks for your help!"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1518038322, "last_edit_date": 1518038322, "creation_date": 1518037920, "answer_id": 48673322, "question_id": 48673262, "link": "https://stackoverflow.com/questions/48673262/ms-access-time-delay-for-form-vba/48673322#48673322", "title": "MS Access Time Delay for Form VBA", "body": "<p>You can use the Form.Timer property to set a timer, and execute the code after that timer.</p>\n\n<pre><code>Private Sub Form_Load()\n    Me.TimerInterval = 5000 '5000 milliseconds\n    'Do other stuff\nEnd Sub\n\nPrivate Sub Form_Timer()\n    Me.TimerInterval = 0 'Disable timer from running again\n    'Do stuff\nEnd Sub\n</code></pre>\n\n<p>Also, if you're going to delay using a while loop, fill it with <code>DoEvents</code> + a sleep function (like <a href=\"https://stackoverflow.com/a/469358/7296893\">this one</a>) to prevent it from locking down your program.</p>\n"}], "owner": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1892, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518038322, "creation_date": 1518037650, "question_id": 48673262, "link": "https://stackoverflow.com/questions/48673262/ms-access-time-delay-for-form-vba", "title": "MS Access Time Delay for Form VBA", "body": "<p>I have created a message box that is a like a reminder and pops up when my switchboard opens on my database. </p>\n\n<p>the message box tells me how many customers havent paid for their order in 25 days. I have put the code into the On Load Section of the switchboard.</p>\n\n<p>However, when i click into my switchboard the code runs instantly which is expected and the message box appears saying \"There are x uncompleted payments that have not been paid in 25 days, would you like to see these now\" and there is a yes or no button.</p>\n\n<p>But when this box loads and i click yes my switchboard and query opens at the same time and it automatically directs me to the switchboard and not the query that i want to see on my screen. I am aiming to have the main menu open, delay the code for a certain amount of seconds then opens the query if i select yes.</p>\n\n<p>This is the code i have produced.</p>\n\n<pre><code>Public Sub Form_Load()\n\nDim time1, time2\n\ntime1 = Now\ntime2 = Now + TimeValue(\"0:00:05\")\n    Do Until time1 &gt;= time2\n        time1 = Now()\n    Loop\n\n\n\n\n\nDim OS As Integer\nOS = DCount(\"[Paid]\", \"[OutstandingPayments]\", \"DateDiff('d', DateOrder, \nNow()) &gt; 25\")\n\n\n\n\nIf OS = 0 Then\n\n        Exit Sub\n            Else\n\n\n                If MsgBox(\"There are \" &amp; OS &amp; \" uncompleted Payments that have not been paid in 25 days\" &amp; _\n                vbCrLf &amp; vbCrLf &amp; \"Would you like to see these now?\", _\n                vbYesNo, \"You Have Uncomplete Payments...\") = vbYes Then\n                DoCmd.Minimize\n                DoCmd.OpenQuery \"OutstandingPayments\", acNormal\n\n            Else\n        Exit Sub\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Basically what this code does is just delay the code being produced but i thought the switchboard could open showing the screen then the code would run and then display my message box. </p>\n\n<p>is there a way i can be able to open switchboard on load, have it loaded then for my code to run to display my message box.</p>\n\n<p>Gif attached to illustrate problem\n<a href=\"https://gyazo.com/94f7e56cbe9220673d10a810e5282dda\" rel=\"nofollow noreferrer\">https://gyazo.com/94f7e56cbe9220673d10a810e5282dda</a></p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9329818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16a19b3560c2185753908359edd8c0a?s=128&d=identicon&r=PG&f=1", "display_name": "kbdwar", "link": "https://stackoverflow.com/users/9329818/kbdwar"}, "edited": false, "score": 0, "creation_date": 1518041633, "post_id": 48673297, "comment_id": 84346757, "body": "Excellent, thanks for the help! I can&#39;t believe I forgot to define criteriaLength..."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 9329818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16a19b3560c2185753908359edd8c0a?s=128&d=identicon&r=PG&f=1", "display_name": "kbdwar", "link": "https://stackoverflow.com/users/9329818/kbdwar"}, "edited": false, "score": 0, "creation_date": 1518041813, "post_id": 48673297, "comment_id": 84346851, "body": "If it worked for you please mark as correct by clicking the check mark by the answer"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1518037822, "creation_date": 1518037822, "answer_id": 48673297, "question_id": 48673152, "link": "https://stackoverflow.com/questions/48673152/vba-countif-for-font-color/48673297#48673297", "title": "VBA COUNTIF for font color", "body": "<p>You never assign a value to <code>criteriaLength</code></p>\n\n<p>You need to add:</p>\n\n<pre><code>criteriaLength = Len(criteria)\n</code></pre>\n\n<p>before the loop.    </p>\n\n<p>And the If will try both sides of the And in the if and if the criteria is not in the string the second part will error.  You need to nest the if so the second only fires if the first returns True.</p>\n\n<pre><code>Function test(range As range, criteria As range) As Double\n\nDim cell As range\nDim criteriaLength As Integer\nDim counter As Integer\n\ncounter = 0\ncriteriaLength = Len(criteria)\nFor Each cell In range\n    If InStr(cell.Value, criteria.Value) &gt; 0 Then\n        If cell.Characters(InStr(cell.Value, criteria.Value), criteriaLength).Font.color = criteria.Font.color Then\n            counter = counter + 1\n        End If\n    End If\nNext cell\ntest = counter\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9329818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16a19b3560c2185753908359edd8c0a?s=128&d=identicon&r=PG&f=1", "display_name": "kbdwar", "link": "https://stackoverflow.com/users/9329818/kbdwar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 0, "accepted_answer_id": 48673297, "answer_count": 1, "score": 1, "last_activity_date": 1518037822, "creation_date": 1518037254, "question_id": 48673152, "link": "https://stackoverflow.com/questions/48673152/vba-countif-for-font-color", "title": "VBA COUNTIF for font color", "body": "<p>I'm looking to create a COUNTIF which takes into account the text value and font color of a criteria string. This is what I've come up with so far. It's currently returning a #VALUE! error.</p>\n\n<pre><code>Function test(range As range, criteria As range) As Double\n\nDim cell As range\nDim criteriaLength As Integer\nDim counter As Integer\n\ncounter = 0\n\nFor Each cell In range\n    If InStr(cell.value, criteria.value) &gt; 0 And \n    cell.Characters(InStr(cell.value, criteria.value), \n    criteriaLength).Font.Color = criteria.Font.Color Then\n         counter = counter + 1\n    End If\nNext cell\ntest = counter\n\nEnd Function\n</code></pre>\n\n<p>The cells in the search range each contain characters of different font colors--that's why I'm using InStr and Characters. Any ideas what the issue might be?</p>\n"}, {"tags": ["jquery", "vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 181, "user_id": 6850280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e4db5ded7a05307f423fd469f935e?s=128&d=identicon&r=PG&f=1", "display_name": "matt2103", "link": "https://stackoverflow.com/users/6850280/matt2103"}, "edited": false, "score": 0, "creation_date": 1518037378, "post_id": 48672959, "comment_id": 84344710, "body": "Have you tried sending a <code>POST</code> or other web query through vba, then programming the website to respond to that specific <code>POST</code> as well?"}, {"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "reply_to_user": {"reputation": 181, "user_id": 6850280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e4db5ded7a05307f423fd469f935e?s=128&d=identicon&r=PG&f=1", "display_name": "matt2103", "link": "https://stackoverflow.com/users/6850280/matt2103"}, "edited": false, "score": 0, "creation_date": 1518037511, "post_id": 48672959, "comment_id": 84344787, "body": "I haven&#39;t, and also I have no idea how to do that, never heard of something like that. Can you illustrate me please? Maybe that could work."}, {"owner": {"reputation": 181, "user_id": 6850280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e4db5ded7a05307f423fd469f935e?s=128&d=identicon&r=PG&f=1", "display_name": "matt2103", "link": "https://stackoverflow.com/users/6850280/matt2103"}, "edited": false, "score": 0, "creation_date": 1518038503, "post_id": 48672959, "comment_id": 84345298, "body": "Ah, the website is not under your control is it?  It may be very difficult to get the website to do what you need it to if you don&#39;t know the underlying code of the website itself.  Also, I can tell you how to send a POST request from vba, but once it comes to jquery, I&#39;m unfortunately out of my depth (hence the comment instead of an answer)."}, {"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "reply_to_user": {"reputation": 181, "user_id": 6850280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e4db5ded7a05307f423fd469f935e?s=128&d=identicon&r=PG&f=1", "display_name": "matt2103", "link": "https://stackoverflow.com/users/6850280/matt2103"}, "edited": false, "score": 0, "creation_date": 1518038664, "post_id": 48672959, "comment_id": 84345382, "body": "No, unfortunately I don&#39;t know the code of the website. Thanks for the idea anyways!"}], "answers": [{"comments": [{"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1518043101, "post_id": 48674212, "comment_id": 84347435, "body": "It actually does not work properly, sometimes when ie is still open, it works but if it is closed is does not work. The website is pretty confusing, its hard to identify which event actually loads the data."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1518054918, "post_id": 48674212, "comment_id": 84350917, "body": "You may need to establish a new reference to the IE object, then fire the event again."}, {"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "edited": false, "score": 0, "creation_date": 1518103695, "post_id": 48674212, "comment_id": 84376035, "body": "Thanks for the answer! But it still doesn&#39;t work for me. Isn&#39;t there a way to simulate the press of a key or something like that aside from <code>SendKeys</code>? Maybe something simple like that could work."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1518111103, "post_id": 48674212, "comment_id": 84381132, "body": "What isn&#39;t working? The above code should work. Are you saying it doesn&#39;t work when the visibility is set to False? More detail on what isn&#39;t working would be helpful. You can always try Selenium, or use a webrequest."}, {"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1518116727, "post_id": 48674212, "comment_id": 84384294, "body": "Visibility is set to True, and when I add <code>.document.getElementById(&quot;vVNCMFIN&quot;).FireEvent (&quot;onChange&quot;)</code> still nothing happens, the event is not fired. I have been trying other ways to fire events, and firing different events like &quot;keyPress&quot; or &quot;keyDown&quot;, but with no success. Maybe as @UGP mentioned, there is another event that loads the data that I am missing."}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1518117095, "post_id": 48674212, "comment_id": 84384501, "body": "The events fire, but those events dont actually update the data in the table. i tried to find the event, that actually does it without success. This website is very strangely coded."}, {"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1518117409, "post_id": 48674212, "comment_id": 84384671, "body": "@UGP thanks for the help, it seems I should find another way to get the data I need, or maybe just stick with <code>Application.SendKeys</code>. Thanks everyone for helping!"}, {"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "edited": false, "score": 0, "creation_date": 1518123276, "post_id": 48674212, "comment_id": 84387717, "body": "Worked to perfection. You deserve a piece of heaven."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 2, "last_activity_date": 1518120811, "last_edit_date": 1518120811, "creation_date": 1518041910, "answer_id": 48674212, "question_id": 48672959, "link": "https://stackoverflow.com/questions/48672959/how-to-fire-an-event-to-update-a-web-page-with-vba/48674212#48674212", "title": "How to fire an event to update a web page with VBA?", "body": "<p>Try the following example. This is working on my end with IE11 by firing the event manually. I cleaned up the code somewhat, and I hard coded the values as I wasn't sure where the variable <code>partida</code> is coming from.</p>\n\n<hr>\n\n<p><strong>Edit</strong></p>\n\n<p>If the onChange event isn't working for some reason, try the code below. It will submit the form data instead. That should trigger a new page load.</p>\n\n<hr>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Private Sub SOExample()\n    Dim IE As InternetExplorer\n    Set IE = New InternetExplorer\n\n    With IE\n        .Visible = True\n        .navigate \"https://www.hacienda.go.cr/tica/web/hdbaranc.aspx\"\n\n        Do Until .Busy = False And .readyState = 4\n            DoEvents\n        Loop\n\n        .Document.getElementById(\"vVNCMINI\").Value = \"1002\"\n        .Document.getElementById(\"vVNCMFIN\").Value = \"12400\"\n\n        'Submit the form\n        .Document.getElementsByTagName(\"form\")(0).submit\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1724, "favorite_count": 0, "accepted_answer_id": 48674212, "answer_count": 1, "score": 2, "last_activity_date": 1518120811, "creation_date": 1518036422, "last_edit_date": 1531164843, "question_id": 48672959, "link": "https://stackoverflow.com/questions/48672959/how-to-fire-an-event-to-update-a-web-page-with-vba", "title": "How to fire an event to update a web page with VBA?", "body": "<p>I have been working in a web automation project, and the current web page I'm working with updates itself when entering a value in one of the searchboxes. However, when I enter values in the searchboxes using VBA code, the event that updates the page does not fire. Here is the code so far:</p>\n\n<pre><code>Set objIE = New InternetExplorer\nobjIE.Visible = True\nobjIE.navigate \"https://www.hacienda.go.cr/tica/web/hdbaranc.aspx\"\n\nDo Until objIE.Busy = False And objIE.readyState = 4\n    DoEvents\nLoop\n\nobjIE.document.getElementById(\"vVNCMINI\").Value = partida &amp; \"00\"\nobjIE.document.getElementById(\"vVNCMFIN\").Value = partida &amp; \"00\"\n'Fire the event here\n</code></pre>\n\n<p>What I have tried so far is using <code>.Click</code> on a searchbox, and firing an <code>onChange</code> event like it was suggested here: <a href=\"https://stackoverflow.com/questions/39827461/excel-vba-ie-11-unable-to-refresh-page-after-selecting-value-in-a-dropdown\">Excel VBA &amp; IE 11 - Unable to refresh page after selecting value in a dropdown</a>, but neither worked. So, any ideas what could I do?</p>\n\n<p>Edit: What I did try that worked was using <code>Application.SendKeys</code> and sending enter on a searchbox. However, that only works when <code>objIE.visible = True</code>, and I set that to <code>True</code> only when debugging. I want it to be set to <code>False</code> but then the enter key is sent to the excel workbook, not to IE.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1518035429, "post_id": 48672680, "comment_id": 84343695, "body": "Did you try doing what you need while recording a macro and checking generated code?"}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 0, "creation_date": 1518035780, "post_id": 48672680, "comment_id": 84343880, "body": "Are you just trying to get those 3 columns to move down? So you want to enter the data then have everything move down one row so that row <code>A1:E1</code> is empty again?"}, {"owner": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1518035950, "post_id": 48672680, "comment_id": 84343964, "body": "@EganWolf I did but how do i keep pushing down instead of rewriting the data on the cells below?"}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1518036092, "post_id": 48672680, "comment_id": 84344048, "body": "From the image you provided it&#39;s impossible to realise which one is the first row. Also the code you provided doesn&#39;t put values into first row. Please be more specific."}, {"owner": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "reply_to_user": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 0, "creation_date": 1518036092, "post_id": 48672680, "comment_id": 84344049, "body": "@Mike I just want to cut the values that are inserted and move them down 1 row without overwriting them because in the end I want to make a sum of the values that have been added that day. ( Have the rest figured out i just cant see out do I keep listing the values from top to bottom without overwriting)."}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 0, "creation_date": 1518036412, "post_id": 48672680, "comment_id": 84344200, "body": "Check my answer below. It will push all values down on a row in columns <code>C:E</code>. You may need to adjust which columns are being pushed down and from which row it starts."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1518036901, "post_id": 48672680, "comment_id": 84344444, "body": "This looks like a job for a table/<code>ListObject</code>..."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "edited": false, "score": 0, "creation_date": 1518036462, "post_id": 48672827, "comment_id": 84344222, "body": "But how do I make the new data appear from NewData(C1) to OldData(C2)?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "edited": false, "score": 0, "creation_date": 1518036763, "post_id": 48672827, "comment_id": 84344366, "body": "@JonhDoe  Not sure I understand.... <b>first</b> enter a value in <code>C1</code> <b>second</b> enter a value in <code>D1</code>  <b>third</b> enter a value in <code>E1</code> <b>fourth</b> run the macro"}, {"owner": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "edited": false, "score": 0, "creation_date": 1518037728, "post_id": 48672827, "comment_id": 84344926, "body": "I just want to make sure that the cells being updated are then moved down automatically with the new values allways staying on top!"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "edited": false, "score": 0, "creation_date": 1518038433, "post_id": 48672827, "comment_id": 84345272, "body": "@JonhDoe  See my <b>EDIT#1</b>"}, {"owner": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "edited": false, "score": 0, "creation_date": 1518039603, "post_id": 48672827, "comment_id": 84345827, "body": "The values are entered in C2:E2, C1:E1 is the &quot;last logs&quot; header. The code you wrote pushes C2:E2 down to C3:E3 and then it keeps replacing C3:E3 with the new values, also it takes the fomat(fill color, etc.) from C1:E1 and sets them on C2:E2."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "edited": false, "score": 0, "creation_date": 1518041148, "post_id": 48672827, "comment_id": 84346543, "body": "@JonhDoe  In your post, you said: <i>&quot;make the data on 3 cells (Ex:C1,D1,E1) go down 1 Row</i>&quot;  so that is what my cde does!"}, {"owner": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "edited": false, "score": 0, "creation_date": 1518042484, "post_id": 48672827, "comment_id": 84347129, "body": "Yes but it glitches out with the fomat and it skips some value inserts. <a href=\"https://imgur.com/ucTRrnO\" rel=\"nofollow noreferrer\">imgur.com/ucTRrnO</a>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1518038410, "last_edit_date": 1518038410, "creation_date": 1518035865, "answer_id": 48672827, "question_id": 48672680, "link": "https://stackoverflow.com/questions/48672680/push-down-values-without-shifting-the-row/48672827#48672827", "title": "Push down values without shifting the row", "body": "<p>With data in <strong>C1</strong>, <strong>D1</strong> and <strong>E1</strong> just:</p>\n\n<pre><code>Range(\"C1:E1\").Insert Shift:=xlDown\n</code></pre>\n\n<p>This pushes down the three cells rather than the entire row.</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>Put this event macro in the worksheet code area:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim c As Long\n    c = Target.Column\n    If c = 3 Or c = 4 Or c = 5 Then\n        If Application.WorksheetFunction.CountA(Range(\"C1:E1\")) = 3 Then\n            Application.EnableEvents = False\n                Range(\"C1:E1\").Insert shift:=xlDown\n            Application.EnableEvents = True\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>Once you have entered all 3 values in <strong>C1</strong> through <strong>E1</strong>, the values will get pushed down automatically.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "edited": false, "score": 0, "creation_date": 1518037103, "post_id": 48672928, "comment_id": 84344556, "body": "&quot;Looks like you want to make sure that the cells being updated are then moved down automatically.&quot; Exacly! But im not sure where do you want me to add this code..."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1518038444, "post_id": 48672928, "comment_id": 84345277, "body": "Right click on the tab of the Sheet you are using and select View Code, then paste the code there..."}], "tags": [], "owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "is_accepted": false, "score": 1, "last_activity_date": 1518038966, "last_edit_date": 1518038966, "creation_date": 1518036261, "answer_id": 48672928, "question_id": 48672680, "link": "https://stackoverflow.com/questions/48672680/push-down-values-without-shifting-the-row/48672928#48672928", "title": "Push down values without shifting the row", "body": "<p>Looks like you want to make sure that the cells being updated are then moved down automatically. You can do that with a change event on the sheet code behind like this:</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n    'Checks if the column being changed is C - E\n    If Target.Column = 3 Or Target.Column = 4 Or Target.Column = 5 Then\n        'Checks if the row being changed is row 2\n        If Target.Row = 2 Then\n            'Inserts a new row and pushes what is in C2:E2 down one row\n            Range(\"C2:E2\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>This code will go in the sheets code behind. So, you will have to right-click on the sheet that you have this data on and then click on view code (or just double-click the sheet)</p>\n\n<p>Putting the code there will tell Excel to watch that sheet for changes and then the code checks if it is happening to one of those 3 cells (<code>C2:E2</code>)</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "edited": false, "score": 0, "creation_date": 1518038545, "post_id": 48673333, "comment_id": 84345319, "body": "Im getting a &quot;list separator error&quot; after <code>With .Range(\u201cC3:D\u201d)</code>"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "edited": false, "score": 0, "creation_date": 1518038974, "post_id": 48673333, "comment_id": 84345543, "body": "Try using proper quotation marks. I\u2019m writing from a mobile phone so maybe mine are not the right ones"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "edited": false, "score": 0, "creation_date": 1518040586, "post_id": 48673333, "comment_id": 84346289, "body": "@JohnDoe, did you get it working with edited quotation marks?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "edited": false, "score": 0, "creation_date": 1518043902, "post_id": 48673333, "comment_id": 84347753, "body": "@JohnDoe, any chance for my attempt at helping you to to get a feedback ?"}, {"owner": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "edited": false, "score": 0, "creation_date": 1518044605, "post_id": 48673333, "comment_id": 84348014, "body": "Yes @DisplayName sorry about that I trying some other lines, its has this weird behavior where its duplicating the &quot;Des&quot;  and &quot;ComboBox.Value&quot; but on the dupe theres not value on &quot;TextBox1.Value&quot;. I almost got it with &quot; Range(&quot;C2:E2&quot;).Insert Shift:=xlDown &quot; but it has the bug I stated on the comment of Garys Student awnser!"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "edited": false, "score": 0, "creation_date": 1518069169, "post_id": 48673333, "comment_id": 84354403, "body": "I don\u2019t understand what\u2019s the weird behaviour: is it some duplication or the absence of value on textbox1.value? And what\u2019s this latter? Maybe you can add some example of a desired behaviour with some \u201cbefore\u201d and \u201cafter\u201d scenarios"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "edited": false, "score": 0, "creation_date": 1518076172, "post_id": 48673333, "comment_id": 84357411, "body": "@JohnDoe, now I could test it and found out what you were referring: see edited code and let me know"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1518076136, "last_edit_date": 1518076136, "creation_date": 1518037960, "answer_id": 48673333, "question_id": 48672680, "link": "https://stackoverflow.com/questions/48672680/push-down-values-without-shifting-the-row/48673333#48673333", "title": "Push down values without shifting the row", "body": "<p><strong>Edited</strong>: changed lat column index from \"D\" to \"E\" and starting row index from \"3\" to \"2\" </p>\n\n<p>Maybe you\u2019re after this</p>\n\n<pre><code>Private Sub CommandButtonAddDes_Click()\n    With Sheet1\n        With .Range(\"C2:E\" &amp; .Cells(.Rows.Count, \"C\").End(xlUp).Row)\n            .Offset(1).Value = .Value\n            .Resize(1) = Array(Des, ComboBox.Value, TextBox1.Value)\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>Should different rows need to be \"inserted\" you just change the row index.</p>\n"}, {"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1518067406, "creation_date": 1518067406, "answer_id": 48678159, "question_id": 48672680, "link": "https://stackoverflow.com/questions/48672680/push-down-values-without-shifting-the-row/48678159#48678159", "title": "Push down values without shifting the row", "body": "<p>Replace you code on your userform. Ensure your input box names are correct, i.e. ComboBox1, TextBox1, etc. I don't understand what \"Des\" is. If you need it in row 2 then just change the 1s to 2s.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nWith Sheets(\"Sheet1\")\n    .Range(\"C1:E1\").Insert Shift:=xlDown\n    .Range(\"C1\").Value = Des.Value\n    .Range(\"D1\").Value = ComboBox.Value\n    .Range(\"E1\").Value = TextBox1.Value\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 33, "user_id": 9329583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c1914a9b33bcfb043a08ce45a36b63?s=128&d=identicon&r=PG&f=1", "display_name": "JonhDoe", "link": "https://stackoverflow.com/users/9329583/jonhdoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1518076136, "creation_date": 1518035232, "last_edit_date": 1518035830, "question_id": 48672680, "link": "https://stackoverflow.com/questions/48672680/push-down-values-without-shifting-the-row", "title": "Push down values without shifting the row", "body": "<p>So have this button on a form and I cant make the data on 3 cells (Ex:C1,D1,E1) go down 1 Row without shifting the whole sheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/k9Dla.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k9Dla.jpg\" alt=\"Table Example\"></a></p>\n\n<p>How do i make the values go down after being inserted so that i can leave Row1 allways open for new values?</p>\n\n<p>This is the code on the command button, can i embed the solution on it or do I have to do it somewhere else?</p>\n\n<pre><code> Private Sub CommandButtonAddDes_Click()\n\nDim emptyRow As Long\n\n'Activate sheet\nSheet1.Activate\n\n'Determine emptyRow\nemptyRow = WorksheetFunction.CountA(Range(\"C:C\")) + 1\n\n'Transfer info\nCells(emptyRow, 3).Value = Des\nCells(emptyRow, 4).Value = ComboBox.Value\nCells(emptyRow, 5).Value = TextBox1.Value\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1518035623, "post_id": 48672662, "comment_id": 84343801, "body": "What&#39;s <code>wsPivot</code>?"}, {"owner": {"reputation": 23, "user_id": 9329588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cfe78216271e99596a97840ac42e891?s=128&d=identicon&r=PG&f=1", "display_name": "Cody Alan", "link": "https://stackoverflow.com/users/9329588/cody-alan"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1518037705, "post_id": 48672662, "comment_id": 84344914, "body": "Its a worksheet object, equal to something like &#39;[Worksheet.xlsm]Sheets(&quot;Pivot&quot;)&#39;"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1518037910, "post_id": 48672662, "comment_id": 84345016, "body": "<code>TableDestination</code> argument requires a specified range. See <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/pivottables-add-method-excel?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">PivotTables.Add Method</a>"}, {"owner": {"reputation": 23, "user_id": 9329588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cfe78216271e99596a97840ac42e891?s=128&d=identicon&r=PG&f=1", "display_name": "Cody Alan", "link": "https://stackoverflow.com/users/9329588/cody-alan"}, "edited": false, "score": 0, "creation_date": 1518039144, "post_id": 48672662, "comment_id": 84345628, "body": "Thanks.  Based off that information I tweaked that section to be:          Set PT = wsPivot.PivotTables.Add( _             PivotCache:=PTCache, _             TableDestination:=wsPivot.Range(&quot;A3&quot;), _             TableName:=&quot;Pivot Table&quot;)  I still got the same error : &quot;Run-time error &#39;5&#39;: Invalid procedure call or argument&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 9329588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cfe78216271e99596a97840ac42e891?s=128&d=identicon&r=PG&f=1", "display_name": "Cody Alan", "link": "https://stackoverflow.com/users/9329588/cody-alan"}, "is_accepted": false, "score": 1, "last_activity_date": 1518044406, "creation_date": 1518044406, "answer_id": 48674737, "question_id": 48672662, "link": "https://stackoverflow.com/questions/48672662/procedure-error-when-creating-a-pivot-table-using-vba/48674737#48674737", "title": "Procedure Error when creating a pivot table using VBA", "body": "<p>I found the issue, rather than building the pivot cache from the <code>ActiveWorkbook</code> I used <code>ThisWorkbook</code> instead.</p>\n\n<p>The following code ran without error:</p>\n\n<pre><code>With wsData\nDim PTCache As PivotCache\nDim PT As PivotTable\n\n'Creates the Cache\nSet PTCache = ThisWorkbook.PivotCaches.Create( _\n    SourceType:=xlDatabase, _\n    SourceData:=.Range(\"A1\").CurrentRegion)\n\n'Creates pivot table\nSet PT = wsPivot.PivotTables.Add( _\n    PivotCache:=PTCache, _\n    TableDestination:=wsPivot)\n\n'Defines fields\nWith PT\n    .PivotFields(\"Field 1\").Orientation = xlRowField\n    .PivotFields(\"Field 2\").Orientation = xlRowField\n    .PivotFields(\"Field 3\").Orientation = xlRowField\n    .AddDataField .PivotFields(\"Field 4\"), \"Field 4\", xlCount\n    .TableStyle2 = \"PivotStyleMedium2\"\nEnd With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9329588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cfe78216271e99596a97840ac42e891?s=128&d=identicon&r=PG&f=1", "display_name": "Cody Alan", "link": "https://stackoverflow.com/users/9329588/cody-alan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518044406, "creation_date": 1518035127, "question_id": 48672662, "link": "https://stackoverflow.com/questions/48672662/procedure-error-when-creating-a-pivot-table-using-vba", "title": "Procedure Error when creating a pivot table using VBA", "body": "<p>When I run the below VBA code to create a pivot table, I get an \"Invalid procedure or call argument error\" when running the macro.  The error is on the \"Set PT\" area.  </p>\n\n<p>I've defined worksheet objects but I also tried adjusting the \"Table Destination\" to directly reference the worksheet and I still get the same error.</p>\n\n<p>Any idea what might be causing the error?</p>\n\n<pre><code>With wsData\n    Dim PTCache As PivotCache\n    Dim PT As PivotTable\n\n    'Creates the Cache\n    Set PTCache = ActiveWorkbook.PivotCaches.Create( _\n        SourceType:=xlDatabase, _\n        SourceData:=.Range(\"A1\").CurrentRegion)\n\n    'Creates pivot table\n    Set PT = wsPivot.PivotTables.Add( _\n        PivotCache:=PTCache, _\n        TableDestination:=wsPivot)\n\n    'Defines fields\n    With PT\n        .PivotFields(\"Field 1\").Orientation = xlRowField\n        .PivotFields(\"Field 2\").Orientation = xlRowField\n        .PivotFields(\"Field 3\").Orientation = xlRowField\n        .AddDataField .PivotFields(\"Field 4\"), \"Field 4\", xlCount\n        .TableStyle2 = \"PivotStyleMedium2\"\n    End With\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1518036718, "post_id": 48672638, "comment_id": 84344348, "body": "I&#39;d warmly recommend you look at what an <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indenter</a> can do for your code&#39;s readability."}, {"owner": {"reputation": 11, "user_id": 6423424, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c5d4317cc5015987a3fe5b75c3266ed6?s=128&d=identicon&r=PG&f=1", "display_name": "Gilmer", "link": "https://stackoverflow.com/users/6423424/gilmer"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1518037316, "post_id": 48672638, "comment_id": 84344678, "body": "That&#39;s pretty neat, Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 444, "user_id": 621509, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1607af3054178e3084657ddbe4456208?s=128&d=identicon&r=PG", "display_name": "bbcompent1", "link": "https://stackoverflow.com/users/621509/bbcompent1"}, "edited": false, "score": 0, "creation_date": 1542802728, "post_id": 48672824, "comment_id": 93698457, "body": "@Gilmer, can you please come back and update this question? If my answer helped, please mark it so it might help others in a similar situation. Thank you!"}], "tags": [], "owner": {"reputation": 444, "user_id": 621509, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1607af3054178e3084657ddbe4456208?s=128&d=identicon&r=PG", "display_name": "bbcompent1", "link": "https://stackoverflow.com/users/621509/bbcompent1"}, "is_accepted": false, "score": 0, "last_activity_date": 1518035845, "creation_date": 1518035845, "answer_id": 48672824, "question_id": 48672638, "link": "https://stackoverflow.com/questions/48672638/add-a-date-picker-to-my-text-box/48672824#48672824", "title": "add a date picker to my text box", "body": "<p>it is entirely possible the date picker control may not be installed. I did find a related post that explains how to ensure it is installed (\"Monthview\"). You have to install it. </p>\n\n<ol>\n<li>First close Excel.</li>\n<li>download MSCOMCT2.cab from <a href=\"http://support.microsoft.com/kb/297381\" rel=\"nofollow noreferrer\">http://support.microsoft.com/kb/297381</a> and extract the two files inside the zip file.</li>\n<li>Right click the .inf file and click \"Install\".</li>\n<li>Next, open Windows Explorer and find the directory C:\\Windows\\System32.</li>\n<li>Locate the extracted .ocx file in C:\\Windows\\System32 and move it to C:\\Windows\\sysWOW64.</li>\n<li>Click Start > Search > \"cmd.exe\", right-click the found item and click \"Run as Administrator\"</li>\n<li>At the command prompt type \"regsvr32 C:\\Windows\\sysWOW64\\MSCOMCT2.ocx\" and hit enter</li>\n<li>Open Excel and fire up the VB Editor</li>\n<li>Click Tools > References and choose \"Microsoft Windows Common Controls 2-6.0 (sp6)</li>\n<li>Select any userform in the VB project, click Tools > Additional Controls</li>\n<li>Select \"Microsoft MOnthview Control 6.0 (SP6)</li>\n<li>Use 'DatePicker' control in the VBA user form.</li>\n</ol>\n\n<p>From <a href=\"https://stackoverflow.com/questions/13409653/how-to-add-date-picker-to-vba-userform\">How to Add Date Picker To VBA UserForm</a></p>\n"}], "owner": {"reputation": 11, "user_id": 6423424, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c5d4317cc5015987a3fe5b75c3266ed6?s=128&d=identicon&r=PG&f=1", "display_name": "Gilmer", "link": "https://stackoverflow.com/users/6423424/gilmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5277, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518035845, "creation_date": 1518035047, "last_edit_date": 1518035642, "question_id": 48672638, "link": "https://stackoverflow.com/questions/48672638/add-a-date-picker-to-my-text-box", "title": "add a date picker to my text box", "body": "<p>ive looked through other posts and I can't quite figure out the day picker for my user form. Any ideas or help would be appreciated.  The input date box is currently just a text box to write in the date in the format dd-mmm-yy.  As ive been testing the form it's pretty hard to type the date in like this.  Since I built the form for someone else I would like it to be a little easier. Thanks </p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n'Empty TextBox\nDateTextBox.Value = \"\"\nCmbBox_ACFT.Value = \"\"\nJCNTextBox.Value = \"\"\nTEMSTextBox.Value = \"\"\nDMGTextBox.Value = \"\"\nMXNTextBox.Value = \"\"\nCmbBox_POS.Clear\nCmbBox_Shift.Clear\n\nWith CmbBox_Shift\nCmbBox_Shift.AddItem \"DAYS\"\nCmbBox_Shift.AddItem \"SWINGS\"\nCmbBox_Shift.AddItem \"MIDS\"\nEnd With\n\nWith CmbBox_POS\nCmbBox_POS.AddItem \"1\"\nCmbBox_POS.AddItem \"2\"\nCmbBox_POS.AddItem \"APU\"\nEnd With\n\nWith CmbBox_ACFT\nCmbBox_ACFT.AddItem \"123\"\nCmbBox_ACFT.AddItem \"456\"\nCmbBox_ACFT.AddItem \"789\"\nCmbBox_ACFT.AddItem \"012\"\nCmbBox_ACFT.AddItem \"782\"\nEnd With\n\nOption_Yes.Value = False\nDateTextBox.SetFocus\n\nEnd Sub\nSub OKButton_Click()\n\nDim emptyRow As Long\n\n'Make Sheet1 active\nSheet1.Activate\n\n'Determine emptyRow\nemptyRow = WorksheetFunction.CountA(Range(\"A:A\")) + 1\n\n'Transfer information\nCells(emptyRow, 1).Value = DateTextBox.Value 'need a date picker to help minimize errors. In dd-mmm-yy format.  \nCells(emptyRow, 2).Value = CmbBox_ACFT.Value\nCells(emptyRow, 3).Value = CmbBox_Shift.Value\nCells(emptyRow, 4).Value = CmbBox_POS.Value\nCells(emptyRow, 5).Value = MXNTextBox.Value\nCells(emptyRow, 6).Value = JCNTextBox.Value\nCells(emptyRow, 7).Value = TEMSTextBox.Value\n'Cells(emptyRow, 8).Value = DinnerComboBox.Value\nCells(emptyRow, 9).Value = DMGTextBox.Value\n\nIf Option_Yes.Value = True Then\nCells(emptyRow, 8).Value = \"Yes\"\nElse\nCells(emptyRow, 8).Value = \"No\"\nEnd If\n\n With ActiveSheet.UsedRange.Borders\n    .LineStyle = xlContinuous\n    .Weight = xlThin\n    .ColorIndex = xlAutomatic\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1518035010, "post_id": 48672582, "comment_id": 84343467, "body": "Well, for some reason I don&#39;t believe the code you provided is a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> considering your 100 <code>ScrollRow</code> lines are still in there. <b>Edit:</b> Your title is A+ as well."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518035115, "post_id": 48672582, "comment_id": 84343523, "body": "As per ^^. Please edit out all the lines starting  ActiveWindow.ScrollColumn. This is a classic case of the macro recorder capturing everything and in this case the instructions are irrelevant. We don&#39;t need to know you were scrolling to select a cell."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518035238, "post_id": 48672582, "comment_id": 84343587, "body": "And please put some spacing, paragraphing etc for your question text. I&#39;m getting old and trying to decipher a wall of text hurts my eyes and, as it stands, it may discourage attempts at answering your question."}, {"owner": {"reputation": 13, "user_id": 8255568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34afa351eaab7c4af0cd7ee4422086c?s=128&d=identicon&r=PG&f=1", "display_name": "mariaah", "link": "https://stackoverflow.com/users/8255568/mariaah"}, "edited": false, "score": 0, "creation_date": 1518035431, "post_id": 48672582, "comment_id": 84343697, "body": "I copy and pasted the code form visual basic. I created the code half by writing it and half by using the recorder. The graph is enlarged and I have to scroll to highlight certain things to edit the line graph. My worry right now isnt the amount of scrollrow issues but that if I use the code on a different file that has a different amount of rows my graph will be off and im getting an error line as well:"}, {"owner": {"reputation": 13, "user_id": 8255568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34afa351eaab7c4af0cd7ee4422086c?s=128&d=identicon&r=PG&f=1", "display_name": "mariaah", "link": "https://stackoverflow.com/users/8255568/mariaah"}, "edited": false, "score": 0, "creation_date": 1518035468, "post_id": 48672582, "comment_id": 84343718, "body": "I will try to add spacing for next time. Thank you"}, {"owner": {"reputation": 13, "user_id": 8255568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34afa351eaab7c4af0cd7ee4422086c?s=128&d=identicon&r=PG&f=1", "display_name": "mariaah", "link": "https://stackoverflow.com/users/8255568/mariaah"}, "edited": false, "score": 0, "creation_date": 1518035489, "post_id": 48672582, "comment_id": 84343732, "body": "the error I get it this: Run time error &quot;1004&quot; .  method &quot;range&#39; of object &#39;_global failed"}, {"owner": {"reputation": 13, "user_id": 8255568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34afa351eaab7c4af0cd7ee4422086c?s=128&d=identicon&r=PG&f=1", "display_name": "mariaah", "link": "https://stackoverflow.com/users/8255568/mariaah"}, "edited": false, "score": 1, "creation_date": 1518035571, "post_id": 48672582, "comment_id": 84343768, "body": "and this is the line it highlights which is the section of data use to make the graph:  ActiveChart.SetSourceData Source:=Range(&quot;&#39;Raw Data&#39;!$G$1:$L$1083&quot;)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518038235, "post_id": 48672582, "comment_id": 84345162, "body": "Good on you for perservering. Part of the problem with your stated objectives is that is requires a degree of abstraction and some understanding of object oriented programming . You want generic functions/subs that accept parameters and for these to be single responsibility, as much as is possible. That, as well as understanding the variability of the data and edge cases, is what will be needed to account for different file specifications and makes this quite complex for a starter project. Decomposing it into smaller chunks might be a way to progress this."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8255568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34afa351eaab7c4af0cd7ee4422086c?s=128&d=identicon&r=PG&f=1", "display_name": "mariaah", "link": "https://stackoverflow.com/users/8255568/mariaah"}, "edited": false, "score": 0, "creation_date": 1518037502, "post_id": 48673064, "comment_id": 84344782, "body": "I didnt really pick this project. I work for a small company and must of us are biologists and most have no idea how to manage simple excel task. One of the senior scientist (he doesn&#39;t like excel either) used a macro once at another job and decided maybe someone should do it. Since I do most of the data analysis and wrote the go by to make the line graph the normal way they decided to ask me to figure it out."}, {"owner": {"reputation": 13, "user_id": 8255568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34afa351eaab7c4af0cd7ee4422086c?s=128&d=identicon&r=PG&f=1", "display_name": "mariaah", "link": "https://stackoverflow.com/users/8255568/mariaah"}, "edited": false, "score": 0, "creation_date": 1518037508, "post_id": 48673064, "comment_id": 84344783, "body": "This wasn&#39;t my idea but nobody and I mean nobody wants to take this on. It will be a long term project since no-one wants to help. I have every intention to dig deep. I already know I had to make a bunch of if/then statements, I do simple R code for side jobs in population analysis but the output is always the same. So this variability was bound to come into my world eventually. Thank you"}, {"owner": {"reputation": 13, "user_id": 8255568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34afa351eaab7c4af0cd7ee4422086c?s=128&d=identicon&r=PG&f=1", "display_name": "mariaah", "link": "https://stackoverflow.com/users/8255568/mariaah"}, "edited": false, "score": 0, "creation_date": 1518037568, "post_id": 48673064, "comment_id": 84344835, "body": "Also that error only occurs when I use the sheet I didn&#39;t use to make the macro in the first place."}, {"owner": {"reputation": 13, "user_id": 8255568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34afa351eaab7c4af0cd7ee4422086c?s=128&d=identicon&r=PG&f=1", "display_name": "mariaah", "link": "https://stackoverflow.com/users/8255568/mariaah"}, "edited": false, "score": 0, "creation_date": 1518037630, "post_id": 48673064, "comment_id": 84344867, "body": "Im pretty annoyed and plan on figuring this out even if I go a different way. Doing the editing is to tedious for the tech and takes away valuable lab time."}, {"owner": {"reputation": 181, "user_id": 6850280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e4db5ded7a05307f423fd469f935e?s=128&d=identicon&r=PG&f=1", "display_name": "matt2103", "link": "https://stackoverflow.com/users/6850280/matt2103"}, "reply_to_user": {"reputation": 13, "user_id": 8255568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34afa351eaab7c4af0cd7ee4422086c?s=128&d=identicon&r=PG&f=1", "display_name": "mariaah", "link": "https://stackoverflow.com/users/8255568/mariaah"}, "edited": false, "score": 0, "creation_date": 1518038826, "post_id": 48673064, "comment_id": 84345462, "body": "I work in a lab as well, so I feel your pain.  Wish I could help more, but all we can really do here is help you solve small problems as they come along.  The <code>Range</code> error is likely happening because the reference simply doesn&#39;t exist in the workbook you are using.  Check and double check--every character matters."}, {"owner": {"reputation": 13, "user_id": 8255568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34afa351eaab7c4af0cd7ee4422086c?s=128&d=identicon&r=PG&f=1", "display_name": "mariaah", "link": "https://stackoverflow.com/users/8255568/mariaah"}, "edited": false, "score": 0, "creation_date": 1518043994, "post_id": 48673064, "comment_id": 84347777, "body": "I will. I have the code not to edit the graph so now I have to stair at multiple csv files and find the commonality and got form their and build the if/then statements. Its going to be a struggle but Im the only one willing to take this on. Im the only one trying to manage the data collection and Im the only one apart form an older guy that uses abnova to make my statistical relevance decisions. I wonder every day why I work here... but Ill figure this out eventually or get a new job. either way Ill  have a side project"}], "tags": [], "owner": {"reputation": 181, "user_id": 6850280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e4db5ded7a05307f423fd469f935e?s=128&d=identicon&r=PG&f=1", "display_name": "matt2103", "link": "https://stackoverflow.com/users/6850280/matt2103"}, "is_accepted": false, "score": 1, "last_activity_date": 1518036926, "creation_date": 1518036926, "answer_id": 48673064, "question_id": 48672582, "link": "https://stackoverflow.com/questions/48672582/to-make-macro-that-takes-into-account-the-variability-of-the-files-to-be-using-i/48673064#48673064", "title": "To make macro that takes into account the variability of the files to be using it on. Where should i look to find options of codes?", "body": "<p>First, consider attempting a simpler project for your first foray into VBA.  Adapting this code to dynamically fit to multiple workbooks will be very intensive, using a lot of <code>Find</code> and <code>If/Then</code> recursives.</p>\n\n<p>Second, any line recorded by the macro recorder that deals with scrolling, selecting, or activating, is functionally useless.  Try setting breakpoints at each line of your code and step through it slowly to see what is actually happening, and whether that step is necessary.  Duplications of <code>cutcopymode=False</code> are also useless.</p>\n\n<p>Third, as to the actual error you mentioned in your comments:</p>\n\n<pre><code>ActiveChart.SetSourceData Source:=Range(\"'Raw Data'!$G$1:$L$1083\") \n</code></pre>\n\n<p>VBA identifies ranges differently from Excel.  You have to use a separate function to call the sheet, such as:</p>\n\n<pre><code>Worksheets(\"Raw Data\").Range(\"G1:L1083\")\n</code></pre>\n\n<p>See <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-object-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-object-excel</a>\nThe macro recorder can only get you so far, you're going to have to dig in a lot more in order to get where you're going.  Good luck!</p>\n"}], "owner": {"reputation": 13, "user_id": 8255568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34afa351eaab7c4af0cd7ee4422086c?s=128&d=identicon&r=PG&f=1", "display_name": "mariaah", "link": "https://stackoverflow.com/users/8255568/mariaah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518073943, "creation_date": 1518034833, "last_edit_date": 1518073943, "question_id": 48672582, "link": "https://stackoverflow.com/questions/48672582/to-make-macro-that-takes-into-account-the-variability-of-the-files-to-be-using-i", "title": "To make macro that takes into account the variability of the files to be using it on. Where should i look to find options of codes?", "body": "<p>I made this macro. It works perfectly with the file I used to create it. This file is a csv ouput form a machine. The macro will make a standard line graph with specific settings.I have to filter some data out and then clear some data and highlight another set of data to create the graph. The number of rows to be filtered will be variable and the number of cells to be cleared will also be variable. The columns and rows to be highlighted to create the graph may also vary between machine run.\nIm thinking I may not be able to adapt the macro to execute when the files will have such a high degree of variability. Im considering maybe finding a different solution. Does anyone have any suggestions on how to best approach this problem. As background this is my first foray into Macros. I have beginner to moderate python knowledge  and Im very good as most excel task. </p>\n\n<p>Also note: all the scroll code is because its a long data file, approximate 1200 rows and 9 to 10 columns of data. </p>\n\n<pre><code>    Sub All()\n'\n' AllSteps Macro\n' step1\n'\n\n'\n    Selection.AutoFilter\n    ActiveSheet.Range(\"$A$1:$W$1086\").AutoFilter Field:=9, Criteria1:=\"&lt;700000\"\n    Range(\"G99:I165\").Select\n    Selection.ClearContents\n    Range(\"G1:L1083\").Select\n    ActiveSheet.Shapes.AddChart2(227, xlLine).Select\n    ActiveChart.SetSourceData Source:=Range(\"'Raw Data'!$G$1:$L$1083\")\n   ActiveSheet.Shapes(\"Chart 1\").ScaleWidth 1.9680555556, msoFalse, _\n        msoScaleFromTopLeft\n    ActiveSheet.Shapes(\"Chart 1\").ScaleHeight 1.3912037037, msoFalse, _\n        msoScaleFromBottomRight\n    ActiveSheet.Shapes(\"Chart 1\").ScaleWidth 1.0529287227, msoFalse, _\n        msoScaleFromBottomRight\n    ActiveSheet.Shapes(\"Chart 1\").ScaleHeight 1.6805324459, msoFalse, _\n        msoScaleFromTopLeft\n    ActiveChart.Axes(xlCategory).Select\n    Selection.TickLabelPosition = xlLow\n    Application.CutCopyMode = False\n    Application.CutCopyMode = False\n    ActiveWindow.ScrollRow = 855\n    ActiveWindow.ScrollRow = 833\n    ActiveWindow.ScrollRow = 774\n    ActiveWindow.ScrollRow = 711\n    ActiveWindow.ScrollRow = 541\n    ActiveWindow.ScrollRow = 497\n    ActiveWindow.ScrollRow = 480\n    ActiveWindow.ScrollRow = 463\n    ActiveWindow.ScrollRow = 458\n    ActiveWindow.ScrollRow = 360\n    ActiveWindow.ScrollRow = 282\n    ActiveWindow.ScrollRow = 254\n    ActiveWindow.ScrollRow = 230\n    ActiveWindow.ScrollRow = 217\n    ActiveWindow.ScrollRow = 215\n    ActiveWindow.ScrollRow = 213\n    ActiveWindow.ScrollRow = 206\n    ActiveWindow.ScrollRow = 179\n    ActiveWindow.ScrollRow = 112\n    ActiveWindow.ScrollRow = 92\n    ActiveWindow.ScrollColumn = 2\n    ActiveWindow.ScrollColumn = 4\n    ActiveWindow.ScrollColumn = 5\n    ActiveChart.Axes(xlCategory).TickLabelSpacing = 1\n    ActiveChart.Axes(xlCategory).TickLabelSpacing = 100\n    ActiveChart.Axes(xlValue).Select\n    ActiveChart.Axes(xlValue).MinimumScale = -90\n    ActiveChart.Axes(xlValue).MaximumScale = 30\n    ActiveChart.FullSeriesCollection(6).Select\n    ActiveChart.FullSeriesCollection(5).Select\n    ActiveChart.FullSeriesCollection(4).Select\n    ActiveChart.FullSeriesCollection(3).Select\n    ActiveChart.FullSeriesCollection(3).AxisGroup = 2\n    ActiveSheet.ChartObjects(\"Chart 1\").Activate\n    ActiveChart.FullSeriesCollection(3).Select\n    ActiveChart.FullSeriesCollection(2).Select\n    ActiveChart.FullSeriesCollection(2).AxisGroup = 2\n    ActiveSheet.ChartObjects(\"Chart 1\").Activate\n    ActiveChart.FullSeriesCollection(2).Select\n    ActiveChart.FullSeriesCollection(1).Select\n    ActiveChart.FullSeriesCollection(1).AxisGroup = 2\n    ActiveSheet.ChartObjects(\"Chart 1\").Activate\n    ActiveChart.FullSeriesCollection(1).Select\n    ActiveChart.Axes(xlValue, xlSecondary).Select\n    ActiveChart.Axes(xlValue, xlSecondary).MinimumScale = 100\n    ActiveWindow.ScrollColumn = 4\n    ActiveWindow.ScrollColumn = 1\n    Range(\"A108\").Select\n    Selection.Copy\n    ActiveSheet.ChartObjects(\"Chart 1\").Activate\n    ActiveChart.ChartTitle.Select\n    ActiveChart.Paste\n    ActiveChart.ChartTitle.Text = \"017306T11FluCandida            \"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1518034499, "post_id": 48672408, "comment_id": 84343218, "body": "FWIW line breaks in Windows are <code>vbCrLf</code>, and <code>vbNewLine</code> would be clearer."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1518034684, "post_id": 48672408, "comment_id": 84343299, "body": "Seems <code>WScript</code> would be better suited for this, given its <code>RegRead</code> and <code>RegWrite</code> methods. See <a href=\"https://stackoverflow.com/q/32345238/1188513\">stackoverflow.com/q/32345238/1188513</a>"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1518037553, "post_id": 48672408, "comment_id": 84344817, "body": "Your key is probably in <code>HKCU\\SOFTWARE\\Wow6432Node\\...</code>. You could also write the key with <code>Shell &quot;reg add &quot;&quot;HKCU\\Software\\Microsoft\\Office\\Common\\Security&quot;&quot; &#47;f &#47;v &quot;&quot;UFIControls&quot;&quot; &#47;t REG_DWORD &#47;d 4 &#47;reg:32&quot;</code>"}, {"owner": {"reputation": 665, "user_id": 1500456, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/oo4Qp.jpg?s=128&g=1", "display_name": "Luiz Vaughan", "link": "https://stackoverflow.com/users/1500456/luiz-vaughan"}, "edited": false, "score": 0, "creation_date": 1518039284, "post_id": 48672408, "comment_id": 84345699, "body": "I followed Mat&#39;s suggestions and replaced with: <code>CreateObject(&quot;WScript.Shell&quot;).RegWrite &quot;HKLM\\Software\\Microsoft\\Office\\Common\\Security\\UFIControls&quot;&zwnj;&#8203;, 2, &quot;REG_DWORD&quot;</code> but got &quot;Time Execution Error n.70: Permission denied&quot;. However, I am the windows administrator. I verified the regedit.exe properties and  confirmed that read/write are allowed to me. Strange...."}, {"owner": {"reputation": 665, "user_id": 1500456, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/oo4Qp.jpg?s=128&g=1", "display_name": "Luiz Vaughan", "link": "https://stackoverflow.com/users/1500456/luiz-vaughan"}, "reply_to_user": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1518040085, "post_id": 48672408, "comment_id": 84346029, "body": "@FlorentB. Thank you very much Florent for your time. It was tested, checked and works fine now. Correction was made and final post was rewritten. Best regards!"}], "owner": {"reputation": 665, "user_id": 1500456, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/oo4Qp.jpg?s=128&g=1", "display_name": "Luiz Vaughan", "link": "https://stackoverflow.com/users/1500456/luiz-vaughan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 602, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1518042823, "creation_date": 1518034080, "last_edit_date": 1518042823, "question_id": 48672408, "link": "https://stackoverflow.com/questions/48672408/vba-shell-regedit-attempt-to-suppress-excel-activex-prompts", "title": "VBA shell regedit attempt to suppress Excel activex prompts", "body": "<p>I am trying to remove UserForms activex prompts when opening Excel and I am having problems to access Shell command. Consider the code below. I have made tests with two computers (A and B). </p>\n\n<p><strong>Computer A:</strong> from year 2014, had Windows 8, 64bit Home single language installed and then uptaded to Windows 10, 64bit Home single language with latest updates; Office Professional 2016 Plus, Microsoft Excel 2016 32bits, Version 1801 (built 9001.2138)</p>\n\n<p><strong>Computer B:</strong> from year 2017, had Windows 10, 64bit home single language installed with latest updates; Office Professional 2016 Plus, Microsoft Excel 2016 32bits, Version 1801 (built 9001.2138)</p>\n\n<pre><code>Private Sub RemoveActiveXPrompts() \n\nApplication.ScreenUpdating = False\n\nDim Import As String\n\nImport = \"Windows Registry Editor Version 5.00\" &amp; vbCr &amp; vbCr &amp; _\n\"[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\Common\\Security]\" &amp; vbCr &amp; _\n\"\"\"UFIControls\"\"=dword:00000004\" &amp; vbCr &amp; _\n\"[HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Security]\" &amp; vbCr &amp; _\n\"\"\"LoadControlsInForms\"\"=dword:00000004\"\n\nDim FileNum As Integer\nFileNum = FreeFile\nOpen ThisWorkbook.Path &amp; \"\\tempRegFile.reg\" For Output As #FileNum\nPrint #FileNum, Import\nClose #FileNum\n\nShell \"Regedit.exe /s \" &amp; Chr(34) &amp; ThisWorkbook.Path &amp; \"\\tempRegFile.reg\" &amp; Chr(34)\nKill ThisWorkbook.Path &amp; \"\\tempRegFile.reg\"\nEnd Sub\n</code></pre>\n\n<p>[Problem 01:]\nThe above works in <strong>Computer A</strong> with no VBA errors, but if you open the regedit.exe in order to check what had been written, you notice that no modifications were made. The DWord value of \"UFIControls\" is still 00000002 from factory, so does the value of \"LoadControlsInForms\" equals to 00000002.</p>\n\n<p>[Problem 02:]\nThe above generates a VBA error in <strong>Computer B</strong> \"Time execution error n.5. Invalid procedure call or argument\". I had then altered the next-to-last line of code: <code>Shell \"Regedit.exe /s \" &amp; Chr(34) &amp; ThisWorkbook.Path &amp; \"\\tempRegFile.reg\" &amp; Chr(34)</code> to: <code>Shell (Environ(\"Windir\") &amp; \"\\Sysnative\\reg.exe \" &amp; Chr(34) &amp; ThisWorkbook.Path &amp; \"\\tempRegFile.reg\" &amp; Chr(34))</code>. It did not generate VBA errors this time, but as above, no changes were made in the registry.</p>\n\n<p><strong><em>Question:1</em></strong>\n<strong>How to make this code effective by altering the registry in both computers A and B without issuing errors?</strong></p>\n\n<p><strong><em>Question:2</em></strong>\n<strong>Why doesn\u00b4t the original code work in computer B?</strong></p>\n\n<p><strong>---------------------------[CORRECTION MADE: now working]------------------------</strong></p>\n\n<pre><code>Private Sub RemoveActiveXPrompts() '&lt;------- Call RemoveActiveXPrompts in Private Sub Workbook_Open()\n\nApplication.ScreenUpdating = False\n\nShell \"reg add \"\"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\Common\\Security\"\" /f /v \"\"UFIControls\"\" /t REG_DWORD /d 3 /reg:32\"\n\nShell \"reg add \"\"HKEY_CURRENT_USER\\Software\\Microsoft\\VBA\\Security\"\" /f /v \"\"LoadControlsInForms\"\" /t REG_DWORD /d 3 /reg:32\"\n\nEnd Sub\n</code></pre>\n\n<p>It never hurts stating that both \"UFIControls\" and \"LoadControlsInForms\" entries were active. In case your specific entry simply does not exist, you should manually create it BEFORE running this code snippet, as in the step-by-step example below. Otherwise, no errors will appear and nothing will be written either.</p>\n\n<p><strong><em>1)</strong> Hold \"WINDOWS\" and \"X\" keys at the same time, select execute, type regedit, and then click OK.<br>\n<strong>2)</strong> Expand the following registry subkey: HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Office\\Common<br>\n<strong>3)</strong> Right-click Common, point to New, and then click Key.<br>\n<strong>4)</strong> Type \"Security\", and then press ENTER to name the newly created subkey.<br>\n<strong>5)</strong> Right-click Security, point to New, and then click DWORD Value.<br>\n<strong>6)</strong> Type \"UFIControls\", and then press ENTER to name the newly created value.</em>  </p>\n\n<p>One should bear in mind that once the Excel is closed, these DWord values will be there forever. One MUST change the registry keys back to Excel's default, otherwise, anyone who uses this machine may have some installed products ruined or future products that they acquire may not work at all. To reverse that, another Sub is created and placed as below. The procedure is the same. Just change the DWord: \"4\" to the original value which is DWord: \"2\"</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\nRestoreActiveXPrompts\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 1, "creation_date": 1518036772, "post_id": 48671977, "comment_id": 84344374, "body": "Try: <code>And Cells(Rng2.Row, Rng3.Column) &lt;&gt; 0</code> instead of <code>And Rng3.Value &lt;&gt; 0</code>"}, {"owner": {"reputation": 348, "user_id": 9105621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/880c2cac0853ab50edc75f8b70802a20?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mann", "link": "https://stackoverflow.com/users/9105621/mike-mann"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1518039489, "post_id": 48671977, "comment_id": 84345772, "body": "@PortlandRunner worked beautifully, thank you very much"}], "answers": [{"tags": [], "owner": {"reputation": 348, "user_id": 9105621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/880c2cac0853ab50edc75f8b70802a20?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mann", "link": "https://stackoverflow.com/users/9105621/mike-mann"}, "is_accepted": true, "score": 0, "last_activity_date": 1518655814, "creation_date": 1518655814, "answer_id": 48798590, "question_id": 48671977, "link": "https://stackoverflow.com/questions/48671977/if-and-statement-comparing-values-of-same-row/48798590#48798590", "title": "If And statement comparing values of same row", "body": "<p>As Portland Runner answered:</p>\n\n<blockquote>\n  <p>Try: And <code>Cells(Rng2.Row, Rng3.Column) &lt;&gt; 0</code> instead of And\n  <code>Rng3.Value &lt;&gt; 0</code></p>\n</blockquote>\n"}], "owner": {"reputation": 348, "user_id": 9105621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/880c2cac0853ab50edc75f8b70802a20?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mann", "link": "https://stackoverflow.com/users/9105621/mike-mann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 48798590, "answer_count": 1, "score": 0, "last_activity_date": 1518655814, "creation_date": 1518032414, "last_edit_date": 1518035153, "question_id": 48671977, "link": "https://stackoverflow.com/questions/48671977/if-and-statement-comparing-values-of-same-row", "title": "If And statement comparing values of same row", "body": "<p>I have written the below code to isolate unique values when comparing range 1 and range 2. I want it to also evaluate the cell in the same row in range 3 to make sure it is not equal to zero. Any tips on how to accomplish that?</p>\n\n<pre><code>Sub CompareRanges()\n\nDim WorkRng1 As Range, WorkRng2 As Range, WorkRng3 As Range, Rng1 As Range, Rng2 As Range, Rng3 As Range\nxTitleId = \"Compare Ranges\"\nSet WorkRng1 = Application.InputBox(\"Please Select Task ID Range in Invoice Review File\", xTitleId, Type:=8)\nSet WorkRng2 = Application.InputBox(\"Please Select Task ID Range in Budget Grid\", xTitleId, Type:=8)\nSet WorkRng3 = Application.InputBox(\"Please Select\", xTitleId, Type:=8)\nFor Each Rng1 In WorkRng1\n    For Each Rng2 In WorkRng2\n        If Rng1.Value = Rng2.Value Then\n            Rng2.Interior.Color = VBA.RGB(254, 255, 255)\n            Exit For\n        End If\n    Next\nNext\nFor Each Rng2 In WorkRng2\n    For Each Rng3 In WorkRng3\n        If Rng2.Value &gt; 0 And Rng3.Value &lt;&gt; 0 And Rng2.Interior.Color &lt;&gt; VBA.RGB(254, 255, 255) Then\n            Rng2.Interior.Color = VBA.RGB(255, 0, 0)\n            Exit For\n        End If\n    Next\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1518033342, "post_id": 48671968, "comment_id": 84342615, "body": "Mmmm, tried with cells with more than 300 characters and Instr worked perfect for me.  The only diference is that i typed a Start number, and also typed a compare option (in my case it was <code>vbTextCompare</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1518033054, "creation_date": 1518033054, "answer_id": 48672150, "question_id": 48671968, "link": "https://stackoverflow.com/questions/48671968/instr-skipping-cells-with-large-character-count-255/48672150#48672150", "title": "InStr skipping cells with large character count (255+)", "body": "<p>You can use the Find function.</p>\n\n<pre><code>If Not Sheet2.Cells(i,18).Find(Cstr(IssueComboBoxStr),lookat:=xlPart) is Nothing\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22993, "user_id": 1394393, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mSjIL.jpg?s=128&g=1", "display_name": "jpmc26", "link": "https://stackoverflow.com/users/1394393/jpmc26"}, "edited": false, "score": 0, "creation_date": 1518085205, "post_id": 48672494, "comment_id": 84363078, "body": "...As a 61k user, why would you post an answer that essentially says the problem can&#39;t be reproduced, <i>which is a close reason</i>?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1518034471, "creation_date": 1518034471, "answer_id": 48672494, "question_id": 48671968, "link": "https://stackoverflow.com/questions/48671968/instr-skipping-cells-with-large-character-count-255/48672494#48672494", "title": "InStr skipping cells with large character count (255+)", "body": "<p>You may need to examine the strings very closely.</p>\n\n<p>In this demo, <code>sBig</code> contains 5000 characters and <code>sNotSoBig</code> contains 4996 characters.  <code>InStr()</code> has no problem finding the \"little\" string within the \"big\" string:</p>\n\n<pre><code>Sub TestInStr()\n    Dim sBig As String, sNotSoBig As String\n    Dim i As Long\n\n    sBig = \"\"\n    For i = 1 To 500\n        sBig = sBig &amp; \"1234567890\"\n    Next i\n\n    sNotSoBig = Mid(sBig, 5)\n\n    MsgBox Len(sBig) &amp; vbCrLf &amp; Len(sNotSoBig) &amp; vbCrLf &amp; InStr(1, sBig, sNotSoBig)\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/X3pva.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X3pva.png\" alt=\"enter image description here\"></a></p>\n\n<p>We will need more details to help you debug the issue.</p>\n"}], "owner": {"reputation": 1, "user_id": 9329515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86ba855c9632567ea9380299eb520985?s=128&d=identicon&r=PG&f=1", "display_name": "A. Sheridan", "link": "https://stackoverflow.com/users/9329515/a-sheridan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "closed_date": 1518723539, "answer_count": 2, "score": 0, "last_activity_date": 1518034471, "creation_date": 1518032387, "last_edit_date": 1531164843, "question_id": 48671968, "link": "https://stackoverflow.com/questions/48671968/instr-skipping-cells-with-large-character-count-255", "closed_reason": "Not suitable for this site", "title": "InStr skipping cells with large character count (255+)", "body": "<p>Having some issues with <code>InStr</code> skipping cells with large character counts (255+). \nIt is skipping over these cells for SubString comparison. </p>\n\n<p>The same <code>InStr</code> function is working for cells with lower character counts within the same FOR LOOP. So I know that it not a coding issue, but rather a limitation of the max String size for the <code>InStr</code> function. </p>\n\n<p>Is there a way to get InStr to work with large character count cells? (255+) </p>\n\n<p>Example Code: </p>\n\n<pre><code>If InStr(CStr(Sheet2.Cells(i, 18)), CStr(IssueComboBoxStr)) &gt; 0 Then\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518031444, "post_id": 48671694, "comment_id": 84341492, "body": "So, e.g. G1=5*B1 + 4*C1 + 3*D1 + 2*E1 + 1*F1 ? If so, what exactly is the problem? Have you tried writing the formula in Excel and recording a macro? You might want to consider SUMPRODUCT."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1518031541, "post_id": 48671694, "comment_id": 84341563, "body": "this will give you the result of how many rows you have filled<code>lstrw = Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row</code> This will count all the rows in the sheet <code>rws = Rows.Count</code>, they probably will never match"}, {"owner": {"reputation": 1, "user_id": 9329416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b3ae913503716fd9b3ade31a63e288?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/9329416/aaron"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518032229, "post_id": 48671694, "comment_id": 84341965, "body": "Yes @SJR that is what i want but then for row 2 and 3 and so on for every row that is on the sheet (&quot;i&quot;).  In just unsure how to do it in a loop using i."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9329416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b3ae913503716fd9b3ade31a63e288?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/9329416/aaron"}, "edited": false, "score": 0, "creation_date": 1518032868, "post_id": 48671986, "comment_id": 84342347, "body": "Im getting a type mismatch for <code>.Cells(i, &quot;G&quot;) = 5 * .Cells(i, &quot;B&quot;) + 4 * .Cells(i, &quot;C&quot;) + 3 * .Cells(i, &quot;D&quot;) + _                       2 * .Cells(i, &quot;E&quot;) + .Cells(i, &quot;F&quot;)</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1, "user_id": 9329416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b3ae913503716fd9b3ade31a63e288?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/9329416/aaron"}, "edited": false, "score": 0, "creation_date": 1518032898, "post_id": 48671986, "comment_id": 84342374, "body": "OK so one or more are not numbers. Probably should build in a check for that."}, {"owner": {"reputation": 1, "user_id": 9329416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b3ae913503716fd9b3ade31a63e288?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/9329416/aaron"}, "edited": false, "score": 0, "creation_date": 1518033088, "post_id": 48671986, "comment_id": 84342482, "body": "I have column and row titles &quot;requirement 1, 2, 3 etc.&quot; for columns in row 1 and project A B C etc. for Rows in column A. Maybe that is why?"}, {"owner": {"reputation": 1, "user_id": 9329416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b3ae913503716fd9b3ade31a63e288?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/9329416/aaron"}, "edited": false, "score": 0, "creation_date": 1518033190, "post_id": 48671986, "comment_id": 84342544, "body": "Ya it worked when i took out the column headers in row 1! But how do i get it to start with Column B and Row 2 rather than (1,1)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1, "user_id": 9329416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b3ae913503716fd9b3ade31a63e288?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/9329416/aaron"}, "edited": false, "score": 0, "creation_date": 1518033211, "post_id": 48671986, "comment_id": 84342556, "body": "Start your loop from 2 then."}, {"owner": {"reputation": 1, "user_id": 9329416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b3ae913503716fd9b3ade31a63e288?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/9329416/aaron"}, "edited": false, "score": 1, "creation_date": 1518033345, "post_id": 48671986, "comment_id": 84342616, "body": "Awesome thank you so much that worked perfectly! Really appreciate it"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1518033225, "last_edit_date": 1518033225, "creation_date": 1518032442, "answer_id": 48671986, "question_id": 48671694, "link": "https://stackoverflow.com/questions/48671694/looping-calculations-in-vba/48671986#48671986", "title": "Looping calculations in VBA", "body": "<p>Try this. You can use Range or Cells notation, but in this case the latter seems more intuitive. That said, you would be better off using worksheet formulae for this.</p>\n\n<pre><code>Sub x()\n\nDim wbk1 As Workbook\nDim lr As Long, i As Long\n\nSet wbk1 = Application.ActiveWorkbook\n\nWith wbk1.Sheets(\"Sheet3\")\n    lr = .Cells(Rows.Count, 1).End(xlUp).Row\n    For i = 2 To lr\n        .Cells(i, \"G\") = 5 * .Cells(i, \"B\") + 4 * .Cells(i, \"C\") + 3 * .Cells(i, \"D\") + _\n                      2 * .Cells(i, \"E\") + .Cells(i, \"F\")\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9329416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b3ae913503716fd9b3ade31a63e288?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/9329416/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1291, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518033225, "creation_date": 1518031117, "last_edit_date": 1531164843, "question_id": 48671694, "link": "https://stackoverflow.com/questions/48671694/looping-calculations-in-vba", "title": "Looping calculations in VBA", "body": "<p>I have created a loop to iterate through each row and I want it to add up the values for each column in each row and sum them at the end.  I know how to do it as a formula but I am new to VBA.  I want it to sum the values multiply by a weight factor for columns B-F then output the values in column G.  I know I need to use a for loop to iterate through every row that is not blank as that amount will be changing as the sheet is updated. The formula version would be:</p>\n\n<pre><code>`=((5*(i,1))+(4*(i,2))+(3*(i,3))+(2*(i,4))+(1*(i,5))` \n</code></pre>\n\n<p>and I want this value output into cells(i,6)</p>\n\n<p>So far I have:</p>\n\n<pre><code>`set wbk1 = Application.ActiveWorkbook\nlr = wbk1.Sheets(\"sheet3\").Cells(Rows.Count, 1).End(xlUp).Row\nFor i = 1 to Rows.Count\nIf i &lt; lr Then\nEnd If\nNext i`\n</code></pre>\n\n<p>The formula part in the middle of the loop is where I am stuck at I believe.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "stream", "adodb", "vba"], "comments": [{"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1518032690, "post_id": 48671673, "comment_id": 84342230, "body": "When I create <code>fileCurrent</code> with <code>Set fileCurrent = fs.GetFile(&quot;C:\\Users\\(puzzlepiece87)\\Desktop\\Text.txt&quot;)</code> your code runs without error. The MsgBox displays <code>???????</code> (not sure what that&#39;s about)."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1518036976, "post_id": 48671673, "comment_id": 84344485, "body": "@xidgel Sadly I got the same error this time. I added the following: `    Dim FSO As Scripting.FileSystemObject`     <code>Set FSO = New Scripting.FileSystemObject</code>      <code>Dim fileCurrent2 As Scripting.File</code>     <code>Set fileCurrent2 = FSO.GetFile(&quot;C:\\Users\\(puzzlepiece87)\\Desktop\\Test.txt&quot;)</code> and changed it to <code>.LoadFromFile fileCurrent2.path</code>. I&#39;ll try restarting my computer again."}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1518037761, "post_id": 48671673, "comment_id": 84344942, "body": "A brief search for the 3002 error suggests the file may be corrupted. Did you try deleting and re-creating Text.txt?"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1518039660, "post_id": 48671673, "comment_id": 84345861, "body": "@xidgel It was another dumb thing instead. I MCVE&#39;d too hard and left out the part where I was opening the file as Binary, then trying ADODB.Stream when the file was too big to save the contents to a string, but I forgot to close the Binary attempt first. If you post an answer along the lines of &quot;This error will show up if it is already open elsewhere. Make sure you&#39;re not pre-opening it via another method.&quot; I&#39;ll accept the answer."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1518040248, "post_id": 48671673, "comment_id": 84346118, "body": "@xidgel Also, for the record, now that it&#39;s working for me, I&#39;m getting the same <code>???????</code> in the Msgbox also. If I find out what that&#39;s about I&#39;ll let you know."}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1518040257, "post_id": 48671673, "comment_id": 84346126, "body": "Sounds like you deserve the credit for solving the problem."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1518040347, "post_id": 48671673, "comment_id": 84346169, "body": "@xidgel Having someone else say &quot;it works for me&quot; was valuable to me. It helped broaden the search. Thanks regardless of what you decide."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1518041929, "post_id": 48671673, "comment_id": 84346897, "body": "@xidgel I needed a <code>.CharSet = &quot;UTF-8&quot;</code>. So ?????? appears when the encoding isn&#39;t right."}], "answers": [{"tags": [], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "is_accepted": true, "score": 0, "last_activity_date": 1518041978, "creation_date": 1518041978, "answer_id": 48674226, "question_id": 48671673, "link": "https://stackoverflow.com/questions/48671673/adodb-stream-3002-file-could-not-be-opened/48674226#48674226", "title": "ADODB.Stream 3002 File Could Not Be Opened", "body": "<p>I MCVE'd too hard and left out the part where I was opening the file as Binary, then trying ADODB.Stream when the file was too big to save the entire file contents to a string by that method, but I had forgotten to close the Binary attempt first.</p>\n"}], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2711, "favorite_count": 0, "accepted_answer_id": 48674226, "answer_count": 1, "score": 1, "last_activity_date": 1518041978, "creation_date": 1518031047, "last_edit_date": 1531164843, "question_id": 48671673, "link": "https://stackoverflow.com/questions/48671673/adodb-stream-3002-file-could-not-be-opened", "title": "ADODB.Stream 3002 File Could Not Be Opened", "body": "<p><strong>Why am I getting 'File could not be opened?' error in ADODB.Stream</strong></p>\n\n<p><em>Problem</em></p>\n\n<p>I'm currently getting <code>Run-time error '3002': File could not be opened</code> on the below line <code>FileStream.LoadFromFile fileCurrent.Path</code>.</p>\n\n<p><em>What I've Tried</em></p>\n\n<ul>\n<li>Making sure the path is valid\n\n<ul>\n<li>Using the immediate window, I can see that <code>?fileCurrent.Path</code> =\n<code>C:\\Users\\(puzzlepiece87)\\Desktop\\Test.txt</code></li>\n</ul></li>\n<li>Using a fresh text file\n\n<ul>\n<li>I created Test.txt as a blank file in which I typed \"Hello\", pushed Enter, typed \"Goodbye\", and then saved as the ANSI default.</li>\n</ul></li>\n<li>Making sure the procedure being in a class module didn't hurt anything\n\n<ul>\n<li>I tried it in a standard module as well</li>\n</ul></li>\n<li>I tried moving it out of Personal.xlsb to a standard workbook\n\n<ul>\n<li>Using a standard workbook had the same issue</li>\n</ul></li>\n</ul>\n\n<p><em>Remaining Questions</em></p>\n\n<ul>\n<li>What am I doing wrong that is causing the 3002 error?</li>\n<li>Am I misunderstanding <code>.LoadFromFile</code>'s <code>FileName</code> parameter? It says <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/loadfromfile-method-ado\" rel=\"nofollow noreferrer\">here</a> that it will accept any valid path and name in UNC format.</li>\n</ul>\n\n<p><strong>Class Module classReallyBigFiles</strong></p>\n\n<pre><code>Option Explicit\n\n\nPublic Sub ReadLargeFile(ByVal fileCurrent As Scripting.File)\n\n    Dim FileStream As ADODB.Stream\n    Set FileStream = New ADODB.Stream\n    FileStream.Type = adTypeText\n    FileStream.LineSeparator = adCRLF\n    FileStream.Mode = adModeReadWrite\n    FileStream.Open\n    FileStream.LoadFromFile fileCurrent.Path\n    MsgBox FileStream.ReadText(-2)\n    FileStream.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "dynamic-programming"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1518033833, "post_id": 48671515, "comment_id": 84342848, "body": "Are you doing this for a SQL query?"}, {"owner": {"reputation": 15, "user_id": 9317918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a94a47d6c4254bb1934e899b363a04?s=128&d=identicon&r=PG&f=1", "display_name": "wendy liu", "link": "https://stackoverflow.com/users/9317918/wendy-liu"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1518034176, "post_id": 48671515, "comment_id": 84343016, "body": "@TimWilliams yes i am"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1518035329, "post_id": 48671515, "comment_id": 84343644, "body": "Is the plan to submit all the values in a single query with each block of 4000 values separated by OR e.g. &quot; where t in(...) or t in(...)&quot;  ?"}, {"owner": {"reputation": 15, "user_id": 9317918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a94a47d6c4254bb1934e899b363a04?s=128&d=identicon&r=PG&f=1", "display_name": "wendy liu", "link": "https://stackoverflow.com/users/9317918/wendy-liu"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1518035850, "post_id": 48671515, "comment_id": 84343910, "body": "@TimWilliams i&#39;m union-ing the full select statements, is this a wrong approach? Should i be using OR ? I&#39;m new to vba and sql so this is quite a difficult concept."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1518036315, "post_id": 48671515, "comment_id": 84344155, "body": "You can just OR the &quot;in&quot; clauses - I find that easier and I think it&#39;s more efficient execution-wise."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9317918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a94a47d6c4254bb1934e899b363a04?s=128&d=identicon&r=PG&f=1", "display_name": "wendy liu", "link": "https://stackoverflow.com/users/9317918/wendy-liu"}, "edited": false, "score": 0, "creation_date": 1518036828, "post_id": 48672922, "comment_id": 84344405, "body": "Thank you for the quick reply! I&#39;m really sorry but i do not understand this code, as i am really bad at vba. Would you mind explaining the for loop?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 15, "user_id": 9317918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a94a47d6c4254bb1934e899b363a04?s=128&d=identicon&r=PG&f=1", "display_name": "wendy liu", "link": "https://stackoverflow.com/users/9317918/wendy-liu"}, "edited": false, "score": 1, "creation_date": 1518037422, "post_id": 48672922, "comment_id": 84344735, "body": "It&#39;s looping over the values in the input range (extracted to a 2D array) and adding them to a 1D array: when that 1D array reaches a max size (controlled via <code>MAX_PER_BLOCK</code>) or the end of the input is reached, the 1D array is converted to a string using <code>Join()</code> and added to the final SQL output string."}, {"owner": {"reputation": 15, "user_id": 9317918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a94a47d6c4254bb1934e899b363a04?s=128&d=identicon&r=PG&f=1", "display_name": "wendy liu", "link": "https://stackoverflow.com/users/9317918/wendy-liu"}, "edited": false, "score": 0, "creation_date": 1518037889, "post_id": 48672922, "comment_id": 84345009, "body": "Thank you. Is there a limit on the amount of OR you can have in one statement? I have upwards of 10,000 rows or maybe more, and i&#39;m doing this to speed up the code so queries wont take ages."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 15, "user_id": 9317918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a94a47d6c4254bb1934e899b363a04?s=128&d=identicon&r=PG&f=1", "display_name": "wendy liu", "link": "https://stackoverflow.com/users/9317918/wendy-liu"}, "edited": false, "score": 1, "creation_date": 1518042818, "post_id": 48672922, "comment_id": 84347298, "body": "I don&#39;t know what database you&#39;re using but i think the limit may be on the total size of the SQL statement itself rather than the number of OR&#39;d lists."}, {"owner": {"reputation": 15, "user_id": 9317918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a94a47d6c4254bb1934e899b363a04?s=128&d=identicon&r=PG&f=1", "display_name": "wendy liu", "link": "https://stackoverflow.com/users/9317918/wendy-liu"}, "edited": false, "score": 0, "creation_date": 1518112450, "post_id": 48672922, "comment_id": 84381865, "body": "I did not realize this but in your code the range is continuous. For the list im combining, the tags are from selective rows, which would not work here. I have already extracted the desired list into a separate 2d array. How can i do this without using the range parameter?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 15, "user_id": 9317918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a94a47d6c4254bb1934e899b363a04?s=128&d=identicon&r=PG&f=1", "display_name": "wendy liu", "link": "https://stackoverflow.com/users/9317918/wendy-liu"}, "edited": false, "score": 0, "creation_date": 1518112982, "post_id": 48672922, "comment_id": 84382182, "body": "Change the <code>rng</code> parameter to a Variant and pass the 2D array directly (assuming it&#39;s a 1-based 2D array 1 to n, 1 to 1)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1518073132, "last_edit_date": 1518073132, "creation_date": 1518036239, "answer_id": 48672922, "question_id": 48671515, "link": "https://stackoverflow.com/questions/48671515/sectioning-a-dynamic-list-vba/48672922#48672922", "title": "sectioning a dynamic list vba", "body": "<p>This is not the exact question you asked, but I think it meets your final goal:</p>\n\n<pre><code>Sub Tester()\n    Debug.Print SQLInClause(Range(\"B3:B29\"), \"myFieldName\", False)\nEnd Sub\n\n'Given a single-column range \"rng\", convert the content to a SQL \"in\" clause,\n'  with a maximum number of items per \"in\" block, with blocks joined by \"or\"\n'  Use the SQL field name supplied in \"fName\"\n'  \"isChar\" determines whether to quote the values\nFunction SQLInClause(rng As Range, fName As String, isChar As Boolean) As String\n\n    Const MAX_PER_BLOCK As Long = 10 '&lt;&lt;10 for testing: set to 4000 for production use...\n\n    Dim sql As String, arr(), i As Long, n As Long\n    Dim d, sep, qt, tot As Long\n\n\n    d = rng.Value\n    tot = UBound(d, 1)\n    i = 0      'counter for each block\n    qt = IIf(isChar, \"'\", \"\") '&lt;&lt; set quote character (or none)\n    sep = \"\"\n    ReDim arr(1 To MAX_PER_BLOCK)\n\n    For n = 1 To tot\n        'any value to add?\n        If Len(d(n, 1)) &gt; 0 Then\n            i = i + 1 \n            arr(i) = d(n, 1)\n\n            'are we at the end of a block, or at the end of the list?\n            If i = MAX_PER_BLOCK Or n = tot Then\n\n                'if at the end of the list, resize array to trim off empty elements\n                If n = tot Then ReDim Preserve arr(1 To i)\n\n                sql = sql &amp; sep &amp; fName &amp; \" in(\" &amp; qt &amp; Join(arr, qt &amp; \",\" &amp; qt) &amp; qt &amp; \")\"\n                sep = vbCrLf &amp; \" or \" '&lt;&lt; \"or\" is set after first block\n                i = 0\n            End If\n        End If\n    Next n\n    SQLInClause = sql\nEnd Function\n</code></pre>\n\n<p>Sample output (formatted a little):</p>\n\n<pre><code>myFieldName in('Val0001','Val0002','Val0003','Val0004','Val0005','Val0006',\n               'Val0007','Val0008','Val0009', 'Val0010') \nor myFieldName in('Val0011','Val0012','Val0013','Val0014','Val0015','Val0016',\n      'Val0017','Val0018','Val0019', 'Val0020') \nor myFieldName in('Val0021','Val0022','Val0023','Val0024','Val0025','Val0027')\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9317918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a94a47d6c4254bb1934e899b363a04?s=128&d=identicon&r=PG&f=1", "display_name": "wendy liu", "link": "https://stackoverflow.com/users/9317918/wendy-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 48672922, "answer_count": 1, "score": 1, "last_activity_date": 1521646238, "creation_date": 1518030495, "last_edit_date": 1521646238, "question_id": 48671515, "link": "https://stackoverflow.com/questions/48671515/sectioning-a-dynamic-list-vba", "title": "sectioning a dynamic list vba", "body": "<p>Edit: The solution below helped in a way that combined all my select statements into one string, but I ended up using unions because I had too many tags and SQL would not take the amount of OR clauses. The exact solution below might help someone who has less elements. </p>\n\n<p>I have a dynamic string list that i want to section off into batches of 4000 so i can combine those 4000 into one string. Currently i have a program that assumes there is at most 8000 items, which is giving me errors since the list extended beyond that. I was thinking of using a dynamic variable in VBA (which i learned in C++) but it does not apply in VBA sadly... \nThe tagcapture() is used to grab the item name from a worksheet column. \nMaxTagPull is 3999 to account for the 0th item being counted. </p>\n\n<pre><code>    For CurrentIndex = 2 To LastTagIndex\n        If RegTagCount = 0 Then                                     ' If first regular tag in string\n            String2 = \"'\" &amp; tagcapture(1, CurrentIndex) &amp; \"'\"\n            String3 = String3 &amp; String2\n        End If\n        If RegTagCount &gt; 0 And RegTagCount &lt; MaxTagPull Then        ' If second tag and up until max number of tags allowed in one query string\n            String2 = \", '\" &amp; tagcapture(1, CurrentIndex) &amp; \"'\"\n            String3 = String3 &amp; String2\n        End If\n        If RegTagCounter = MaxTagPull Then                          ' Put the rest of the regular tags in a separate string\n            String4 = \"'\" &amp; tagcapture(1, CurrentIndex) &amp; \"'\"\n            String5 = String5 &amp; String4\n        End If\n        If RegTagCounter &gt; MaxTagPull Then                          ' Put the rest of the regular tags in a separate string\n            String4 = \", '\" &amp; tagcapture(1, CurrentIndex) &amp; \"'\"\n            String5 = String5 &amp; String4\n        End If\n        RegTagCount = RegTagCount + 1                               ' Counts the amount of regular tags encountered\n\n\n    Next\n</code></pre>\n\n<p>How do i modify this so it can accommodate the dynamic list? Maybe using a function or another sub? \nNote that the total number of items is known, so maybe something could be done with that?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel", "match"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518034479, "post_id": 48671514, "comment_id": 84343205, "body": "Can&#39;t you just make disk_name a Variant?"}, {"owner": {"reputation": 242, "user_id": 2095777, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4373a11d6c454a9845ec5028a03eb9df?s=128&d=identicon&r=PG", "display_name": "tabs_over_spaces", "link": "https://stackoverflow.com/users/2095777/tabs-over-spaces"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518038862, "post_id": 48671514, "comment_id": 84345491, "body": "Nope, still gives error."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518040108, "post_id": 48671514, "comment_id": 84346044, "body": "Post more of your code, one line is not enough."}, {"owner": {"reputation": 242, "user_id": 2095777, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4373a11d6c454a9845ec5028a03eb9df?s=128&d=identicon&r=PG", "display_name": "tabs_over_spaces", "link": "https://stackoverflow.com/users/2095777/tabs-over-spaces"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518198087, "post_id": 48671514, "comment_id": 84421631, "body": "Sorry for the delay."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1518198719, "post_id": 48671514, "comment_id": 84421936, "body": "If the data contained in your row contains mixed text/numeric, you&#39;re always going to get an error on matching <code>1</code> against <code>&quot;1&quot;</code> because they are not the same. Typecasting your arguments won&#39;t help, you need to convert the data in the row so that it is all string values."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1518199073, "post_id": 48671514, "comment_id": 84422116, "body": "You&#39;re going to want to use <code>Long</code> data type instead of integer, also."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1518200388, "last_edit_date": 1518200388, "creation_date": 1518199391, "answer_id": 48711676, "question_id": 48671514, "link": "https://stackoverflow.com/questions/48671514/excel-vba-datatype-agnostic-match/48711676#48711676", "title": "Excel VBA datatype agnostic match", "body": "<p>If the data contained in your row contains mixed text/numeric, you're always going to get an error on matching <code>1</code> against <code>\"1\"</code> because they are not the same. You can test this using the <code>Match</code> function on a worksheet. If your data is string, and you enter <code>=Match(1,...</code> you'll get an error, and vice-versa if your data is numeric and you enter <code>=Match(\"1\", ...</code> you'll get an error.</p>\n\n<p>Typecasting your arguments won't help, because it's the values within the range -- not the <code>lookup_value</code> argument -- which is causing this, you need to convert the data in the row so that it is all string values. You've done this by coercing to an array, and matching against the array.</p>\n\n<p>Alternatively, you can just do some boolean check.</p>\n\n<p>First: <code>WorksheetFunction.Match</code> will fail if the match is not found and your function will not return properly. So you need to be using <code>Application.Match</code>.</p>\n\n<p>Then, you'll need to declare <code>disk_col</code> and <code>property_row</code> as <code>Variant</code>, since <code>Match</code> can return an error value, which will raise a mismatch if you try to put that result into a <code>Long/Integer</code> variable.</p>\n\n<p>This should get you started:</p>\n\n<pre><code>Function get_property_value(disk_name As Variant, property_name As String, Optional counter_info As Variant) As Variant\n    Dim disk_col As Variant ' in case the value isn't found, you need to be able to contain the error.\n    Dim property_row As Variant ' same as above ^^\n    Dim last_row As Long\n    Dim last_col As Long\n    Dim device_iter As Long\n    Dim all_devices As Range\n    Set all_devices = Rows(1)\n    disk_col = -1\n    property_row = -1\n\n    If IsNumeric(disk_name) Then\n        disk_col = Application.Match(CLng(disk_name), all_devices, 0) + 1\n    Else\n        disk_col = Application.Match(CStr(disk_name), all_devices, 0) + 1\n    End If\n\n    With ActiveSheet\n        last_row = .Cells(.Rows.Count, 1).End(xlUp).Row\n        last_col = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    End With\n\n    ... \n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 242, "user_id": 2095777, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4373a11d6c454a9845ec5028a03eb9df?s=128&d=identicon&r=PG", "display_name": "tabs_over_spaces", "link": "https://stackoverflow.com/users/2095777/tabs-over-spaces"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 48711676, "answer_count": 1, "score": 0, "last_activity_date": 1518200388, "creation_date": 1518030492, "last_edit_date": 1518198071, "question_id": 48671514, "link": "https://stackoverflow.com/questions/48671514/excel-vba-datatype-agnostic-match", "title": "Excel VBA datatype agnostic match", "body": "<p>I have an Excel sheet with a row as:</p>\n\n<p><code>1      |   _Total      |   0 C:</code></p>\n\n<p>I have formatted the cells as text (can be re-formatted to anything). Even then, if I have to use the Match function to match <code>1</code> in that row (doesn't matter if it is application.match or application.worksheetfunction.match) I get an error (Type Mismatch error)</p>\n\n<pre><code>disk_col = Application.WorksheetFunction.Match(disk_name, my_range, 0)\n\n#   disk_name : has to be a string, since I might need to match \"_Total\"\n\n#   my_range : it is the row\n</code></pre>\n\n<p>If I do <code>match(CLng(disk_name), ....)</code> it'll work, but I do not want to use CLng as I'll have to match <code>\"_Total\"</code> at some point.</p>\n\n<p>Is there a type ignorant Match function? or a way around this?</p>\n\n<p>Edit: For now, I've created a temporary array with all the cells in the row formatted as string with CStr() and using the match function on the array. Will keep the question around for a better answer.</p>\n\n<p>Edit2: Added code-</p>\n\n<pre><code>Function get_property_value(disk_name As String, property_name As String, Optional counter_info As Variant) As Variant\n    Dim disk_col As Integer, property_row As Integer, last_row As Integer, last_col As Integer, all_devices As Variant, device_iter As Integer\n\n    disk_col = -1\n    property_row = -1\n\n    last_row = ActiveSheet.Cells(ActiveSheet.Rows.count, 1).End(xlUp).Row\n    last_col = ActiveSheet.Cells(1, ActiveSheet.Columns.count).End(xlToLeft).Column\n\n    ' create array of all the cells in the row\n    ReDim all_devices(1 To last_col - 1)\n    For device_iter = 2 To last_col\n        all_devices(device_iter - 1) = CStr(Cells(1, device_iter).Text)\n    Next device_iter\n\n    ' match the row and column \n    disk_col = Application.WorksheetFunction.Match(disk_name, all_devices, 0) + 1\n    property_row = Application.WorksheetFunction.Match(property_name, Range(Cells(2, 1), Cells(last_row, 1)), 0) + 1\n\n    If disk_col &lt;&gt; -1 And property_row &lt;&gt; -1 Then\n        get_property_value = Cells(property_row, disk_col).Value\n    Else\n        get_property_value = \"Value not found.\"\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6277077, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/83019faa7394b5e68cdacbcb76e158e9?s=128&d=identicon&r=PG&f=1", "display_name": "Jaka E Sembodo", "link": "https://stackoverflow.com/users/6277077/jaka-e-sembodo"}, "edited": false, "score": 0, "creation_date": 1518031442, "post_id": 48671685, "comment_id": 84341491, "body": "Thanks sir for repairing my typo. How about code for save/get the value from thoese dynamic textboxes? still didn&#39;t work"}, {"owner": {"reputation": 31, "user_id": 6277077, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/83019faa7394b5e68cdacbcb76e158e9?s=128&d=identicon&r=PG&f=1", "display_name": "Jaka E Sembodo", "link": "https://stackoverflow.com/users/6277077/jaka-e-sembodo"}, "edited": false, "score": 0, "creation_date": 1518031834, "post_id": 48671685, "comment_id": 84341752, "body": "@FreeManI I got error when I used Option Explicit. It said: &#39;Invalid Inside Procedure&#39;  What&#39;s wrong?"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1518032664, "post_id": 48671685, "comment_id": 84342209, "body": "Put it at the top of your code module because, as the error says, it&#39;s invalid to put that inside a procedure (<code>Sub</code> or <code>Function</code>). In the VBE (code editor) go to <code>Tools | Options</code>, then the <code>Editor</code> tab, and check &quot;Require Variable Declaration&quot; to put it at the top of <i>every</i> code module for you."}, {"owner": {"reputation": 31, "user_id": 6277077, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/83019faa7394b5e68cdacbcb76e158e9?s=128&d=identicon&r=PG&f=1", "display_name": "Jaka E Sembodo", "link": "https://stackoverflow.com/users/6277077/jaka-e-sembodo"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1518033229, "post_id": 48671685, "comment_id": 84342566, "body": "@FreeMan Thanks sir. I&#39;ve check &#39;require variable declaration&#39; in my editor tab. May I know, where I must put Option Explicit? Cause when I put it above Public Sub buttonAdd_Click(). It&#39;s still error. Actually, I don&#39;t get what is the function of Option Explicit. Could you mind to explain to me sir?"}, {"owner": {"reputation": 31, "user_id": 6277077, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/83019faa7394b5e68cdacbcb76e158e9?s=128&d=identicon&r=PG&f=1", "display_name": "Jaka E Sembodo", "link": "https://stackoverflow.com/users/6277077/jaka-e-sembodo"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1518034153, "post_id": 48671685, "comment_id": 84343003, "body": "@FreeMan Thaaanks a looot Siir!"}], "tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": false, "score": 0, "last_activity_date": 1518031095, "creation_date": 1518031095, "answer_id": 48671685, "question_id": 48671469, "link": "https://stackoverflow.com/questions/48671469/reading-value-from-dynamic-textbox/48671685#48671685", "title": "Reading value from dynamic textbox", "body": "<p>Looks like your problem is a simple typo. You have used <code>d</code> instead of <code>i</code> (<code>d</code> is undefined in your code). I recommend always using <code>Option Explicit</code>.</p>\n\n<pre><code>Public Sub buttonAdd_Click()\nDim a As Long ' Minor, but Integer I sjust too short these days for a lot of things.\nDim i as Long\n\na = TextBox1.Value\nDim cCntrl As Control\n\nFor i = 1 To a\n    Set cCntrl = Me.Controls.Add(\"Forms.TextBox.1\", \"quarter\", True)\n    With cCntrl\n        .Name = \"quarter\" &amp; CStr(i)  ' explicit rather than implicit conversion\n        .Width = 150\n        .Height = 25\n        .Top = 100 + (i * 25)\n        .Left = 220\n        .ZOrder (0)\n    End With\n Next I\n</code></pre>\n\n<p>Edit: Might be a couple more typos in the <code>.Add</code> command (e.g. you might have wanted \"quarter\" &amp; \"1\" instead of just \"quarter\"?) but I don't have the VBA reference up at the moment to check.</p>\n"}], "owner": {"reputation": 31, "user_id": 6277077, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/83019faa7394b5e68cdacbcb76e158e9?s=128&d=identicon&r=PG&f=1", "display_name": "Jaka E Sembodo", "link": "https://stackoverflow.com/users/6277077/jaka-e-sembodo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 523, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518031095, "creation_date": 1518030317, "last_edit_date": 1518031063, "question_id": 48671469, "link": "https://stackoverflow.com/questions/48671469/reading-value-from-dynamic-textbox", "title": "Reading value from dynamic textbox", "body": "<p>I've an excel vba form named as 'UserForm'. Overall, there's a button (name as 'buttonAdd') that the function could create/add textbox based on inputed (from 'a' variabel) value dynamically. Here's the code. </p>\n\n<pre><code>Public Sub buttonAdd_Click()\nDim a As Integer\na = TextBox1.Value\nDim cCntrl As Control\n\nFor i = 1 To a\n    Set cCntrl = Me.Controls.Add(\"Forms.TextBox.1\", \"quarter\", True)\n    With cCntrl\n        .Name = \"quarter\" &amp; d\n        .Width = 150\n        .Height = 25\n        .Top = 100 + (d * 25)\n        .Left = 220\n        .ZOrder (0)\n    End With\n Next i\n</code></pre>\n\n<p>Now, I've a problem. I can't take/get the value from those dynamic textbox. I tried using this code for saving the value into 'A1' cell, but it's doesnt work. </p>\n\n<pre><code>Private Sub SaveButton_Click()\nDim a As Integer\nDim Ws As Worksheet\nDim cCntrl As Control\n    Set Ws = Worksheets(\"Sheet1\")\n    Ws.Range(\"A1\").Value = quarter1.Value\nEnd Sub\n</code></pre>\n\n<p>I thought the name of first dynamic textbox is quarter1, but when I tried to get the value, it didn't work. Is there anyway or hint for solving this issue. Just saying: just take the value of the first text box, write it there, then take another one and so on.</p>\n\n<p>Thanks a lot.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518028789, "post_id": 48670987, "comment_id": 84339972, "body": "is &quot;HRQ&quot; always in the same row?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1518028885, "post_id": 48670987, "comment_id": 84340026, "body": "So, in your data set, you want to <b>replace</b> <code>2</code> with <code>Under</code>?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518029284, "post_id": 48670987, "comment_id": 84340284, "body": "if HRQ is always in the same row, then a simple HLOOKUP will work, no need for vba."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518029386, "post_id": 48670987, "comment_id": 84340349, "body": "take a look here for possible formula answers: <a href=\"https://stackoverflow.com/questions/39794205/three-dimensional-lookup-using-index-match\" title=\"three dimensional lookup using index match\">stackoverflow.com/questions/39794205/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1518030726, "creation_date": 1518030726, "answer_id": 48671574, "question_id": 48670987, "link": "https://stackoverflow.com/questions/48670987/searching-for-text-in-excel-use-an-offset-and-then-a-logical-test-to-output-a/48671574#48671574", "title": "Searching for text in excel, use an offset, and then a logical test, to output a string of text", "body": "<p>What you need to do is to put your <code>If</code> block before your <code>Do Until</code> loop but after the selection of the cell you are wanting to check. Something like this:</p>\n\n<pre><code>Sub FindMRQ()\n    Dim Sh As Worksheet\n    Dim MRQ As Range\n    Dim Product As Range\n    Dim Benchmark As Range\n\n    For Each Sh In ThisWorkbook.Worksheets\n        With Sh.UsedRange\n\n            Set MRQ = .Cells.Find(What:=\"MRQ\")\n            If Not MRQ Is Nothing Then\n                MRQ.Offset(rowOffset:=1, columnOffset:=0).Select\n                If MRQ.Value &gt; Benchmark.Value Then\n                    MsgBox \"Outperformed\"\n                ElseIf MRQ.Value &lt; Benchmark.Value Then\n                    MsgBox \"Underperformed\"\n                End If\n                Do Until MRQ Is Nothing\n                        ActiveCell.Value = \"YAY!\"\n                    Set MRQ = .FindNext(MRQ)\n                Loop\n            End If\n        End With\n        Set MRQ = Nothing\n    Next Sh\nEnd Sub\n</code></pre>\n\n<p>You will probably still need to tweak this to get it exactly right.</p>\n"}, {"tags": [], "owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "is_accepted": false, "score": 0, "last_activity_date": 1518030888, "creation_date": 1518030888, "answer_id": 48671626, "question_id": 48670987, "link": "https://stackoverflow.com/questions/48670987/searching-for-text-in-excel-use-an-offset-and-then-a-logical-test-to-output-a/48671626#48671626", "title": "Searching for text in excel, use an offset, and then a logical test, to output a string of text", "body": "<p>You can use a formula instead of VBA:</p>\n\n<pre><code>=IF(HLOOKUP(\"MQR\",$A$1:$D$4,MATCH(\"Product\",$A$1:$A$4,0),0)&gt;HLOOKUP(\"MQR\",$A$1:$D$4,MATCH(\"Benchmark\",$A$1:$A$4,0),0),\"Outperformed\",\"Underperformed\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/aaPlc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aaPlc.png\" alt=\"\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 9329259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/646d1a07cf7c9f36872329ee53fe1da3?s=128&d=identicon&r=PG&f=1", "display_name": "BRolf", "link": "https://stackoverflow.com/users/9329259/brolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518030888, "creation_date": 1518028482, "last_edit_date": 1518028789, "question_id": 48670987, "link": "https://stackoverflow.com/questions/48670987/searching-for-text-in-excel-use-an-offset-and-then-a-logical-test-to-output-a", "title": "Searching for text in excel, use an offset, and then a logical test, to output a string of text", "body": "<p>The main goal of this is too search for \"MRQ\", once \"MRQ\" is found have the code do an offset down one row where it then tests if the product is > benchmark then output \"over\" Else output \"Under\"</p>\n\n<p>Here is the code that I have so far but I am having trouble inputting the second if clause. </p>\n\n<pre><code>Sub FindMRQ()\n\nDim Sh As Worksheet\nDim MRQ As Range\nDim Product As Range\nDim Benchmark As Range\n\nFor Each Sh In ThisWorkbook.Worksheets\n    With Sh.UsedRange\n\n        Set MRQ = .Cells.Find(What:=\"MRQ\")\n        If Not MRQ Is Nothing Then\n            MRQ.Offset(rowOffset:=1, columnOffset:=0).Activate\n            Do Until MRQ Is Nothing\n                    ActiveCell.Value = \"YAY!\"\n                Set MRQ = .FindNext(MRQ)\n            Loop\n        End If\n\n        'If Product.Range &gt; Benchmark.Range Then\n        '\"Outperformed\" Else\n        'If Product.Range &lt; Benchmark.Range Then\n        '\"Underperformed\"\n        ' End If\n\n\n    End With\n    Set MRQ = Nothing\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Example of the Data Set<br>\n<img src=\"https://i.stack.imgur.com/W832l.png\" alt=\"\"></p>\n"}, {"tags": ["excel", "vba", "function"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518028484, "post_id": 48670952, "comment_id": 84339810, "body": "And.....What is your question/problem?"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1518029502, "post_id": 48670952, "comment_id": 84340406, "body": "I think I see the issue: On the first <code>ElseIf</code>, the text string doesn&#39;t match the comment. Don&#39;t use obvious comments - they quickly become out of date. Oh, and there&#39;s an extra <code>Else</code> right before the <code>End If</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1518029511, "post_id": 48670952, "comment_id": 84340411, "body": "This can be done with a simple formula, is vba really needed?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518029613, "post_id": 48670952, "comment_id": 84340470, "body": "The issue is that you are trying to test and assign single values to a multi-cell range.  you will need to loop and test each individual cell in the range and put the value in each individual cell.  It will not do it automatically."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1518029967, "post_id": 48670952, "comment_id": 84340677, "body": "How does the function know what row to look at? Also, this looks like a table/<code>ListObject</code> - naming and then dereferencing the column ranges seems rather wasteful. Just use a table formula, e.g. <code>=IF([Due Date] &lt; TODAY(), &quot;Overdue&quot;, IF([Due Date] &lt; TODAY()+7, &quot;Due Soon&quot;, IF([Due Date] &gt;= TODAY()+7, &quot;Due Later&quot;, &quot;&quot;)))</code> ...no need for any code here."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1518030332, "post_id": 48670952, "comment_id": 84340899, "body": "Or better, have a column that counts the number of days until the due date; <code>=IF([Due Date]-TODAY()&lt;0,-1,[Due Date]-TODAY())</code>, and then have a simple vlookup (with the last parameter being <code>True</code>) over another table, sorted, that gives you the &quot;status&quot; for a given number of days. That way you can add more statuses and change any of them on a whim, without needing to change any code or the lookup formula."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518030681, "post_id": 48670952, "comment_id": 84341061, "body": "or <code>=IFERROR(INDEX({Due Soon&quot;,&quot;Due Later&quot;},MIN(INT(([@Due Date]-Today())&#47;7)+1,2)),&quot;OVERDUE&quot;)</code>"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1518030798, "post_id": 48670952, "comment_id": 84341122, "body": "Or a simple cell formula of <code>=[Due Date] - [Opened Date]</code> in the <code>[Date Status]</code> column, then use conditional highlighting to make &gt;7 = Green, &gt;0 AND &lt;8 Yellow, &lt;=0 Red"}, {"owner": {"reputation": 15, "user_id": 9285071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ed952b4eeb89252f42a8d8a32b5f12?s=128&d=identicon&r=PG&f=1", "display_name": "Oilprogramming", "link": "https://stackoverflow.com/users/9285071/oilprogramming"}, "edited": false, "score": 0, "creation_date": 1518035062, "post_id": 48670952, "comment_id": 84343496, "body": "Thanks everyone for your suggestions! I&#39;m actually a petroleum engineer who isn&#39;t the best at VBA/formulas etc...."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1518031643, "post_id": 48671735, "comment_id": 84341632, "body": "You could also put <code>-1E+99</code> in for the <code>-1</code> in the lookup table and just do the VLOOKUP: <code>=VLOOKUP([@[Due Date]]-TODAY(),tblStatusLookup,2,TRUE)</code> and not add the days column."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518032036, "post_id": 48671735, "comment_id": 84341854, "body": "@ScottCraner good point... I guess I just like having the working/intermediate values in sight =)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518032203, "post_id": 48671735, "comment_id": 84341954, "body": "To each his/her own.  I like clean lines.  Either way is good."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1518031845, "last_edit_date": 1518031845, "creation_date": 1518031327, "answer_id": 48671735, "question_id": 48670952, "link": "https://stackoverflow.com/questions/48670952/date-status-function-to-displays-overdue-due-later-and-due-soon/48671735#48671735", "title": "Date status function to displays Overdue, Due Later and Due Soon", "body": "<h3>Codeless Solution</h3>\n\n<p>Add a column to your table, to count the days left - since anything negative is overdue anyway, make all negatives <code>-1</code>:</p>\n\n<p><img src=\"https://i.stack.imgur.com/dBm86.png\" alt=\"enter image description here\"></p>\n\n<p>Use a table formula to calculate it:</p>\n\n<pre><code>=IF([@[Due Date]]-TODAY()&lt;0,-1,[@[Due Date]]-TODAY())\n</code></pre>\n\n<p>Next, have another table to hold the status given a number of days:</p>\n\n<p><img src=\"https://i.stack.imgur.com/a6xLV.png\" alt=\"enter image description here\"></p>\n\n<p>Since you have 3 statuses, and they're really <em>ranges</em> of values, to achieve the values you're after you'll need:</p>\n\n<ul>\n<li>A row with <code>-1</code> for everything <code>Overdue</code></li>\n<li>A row with <code>0</code> for everything due <code>Soon</code></li>\n<li>A row with <code>7</code> for everything due <code>Later</code></li>\n</ul>\n\n<p>Now your \"Date Status\" column can be a simple <code>VLOOKUP</code> formula:</p>\n\n<p><img src=\"https://i.stack.imgur.com/CWnEU.png\" alt=\"enter image description here\"></p>\n\n<p>Again, a table formula is used; note the \"approximate match\" last parameter:</p>\n\n<pre><code>=VLOOKUP([@Days],tblStatusLookup,2,TRUE)\n</code></pre>\n\n<p>Adjust <code>tblStatusLookup</code> to whatever you've named your lookup table.</p>\n\n<p><em>Look 'ma, not a single line of code!</em></p>\n\n<p>Then you can hide the [Days] column if you don't need it shown, and the lookup table can be anywhere you want - and if the thresholds need to change, or if new statuses need to be added, you just tweak the lookup table (important: keep the [Days] sorted ascending, that's how <em>approximate match</em> VLOOKUP works!)</p>\n\n<hr>\n\n<h3>Bugs in OP</h3>\n\n<p>Your function needs to know what row to work with. That should be a parameter; change the <em>signature</em> to accept one - or even better, change it to accept a <code>DueDate</code> parameter - then you simply don't need to care about anything other than the date you're given:</p>\n\n<pre><code>Public Function GetDateStatus(ByVal dueDate As Date) As String\n    If dueDate - Date &lt; 0 Then\n        GetDateStatus = \"Overdue\"\n    ElseIf dueDate - Date &lt; 7 Then\n        GetDateStatus = \"Due Soon\"\n    Else\n        GetDateStatus = \"Due Later\"\n    End If\nEnd function\n</code></pre>\n\n<p>And then in your table the formula would be:</p>\n\n<pre><code>=GetDateStatus(@[Due Date])\n</code></pre>\n\n<p>No need to be bothered with ranges and the nitty-gritty details of how and where every value is coming from - code gets much, much simpler when you work at the right abstraction level!</p>\n\n<p>Note that a worksheet function is not allowed to change other cells' values: it <em>calculates</em> a value.</p>\n"}], "owner": {"reputation": 15, "user_id": 9285071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ed952b4eeb89252f42a8d8a32b5f12?s=128&d=identicon&r=PG&f=1", "display_name": "Oilprogramming", "link": "https://stackoverflow.com/users/9285071/oilprogramming"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 599, "favorite_count": 0, "accepted_answer_id": 48671735, "answer_count": 1, "score": 1, "last_activity_date": 1518031845, "creation_date": 1518028296, "last_edit_date": 1518029691, "question_id": 48670952, "link": "https://stackoverflow.com/questions/48670952/date-status-function-to-displays-overdue-due-later-and-due-soon", "title": "Date status function to displays Overdue, Due Later and Due Soon", "body": "<p>I am currently working on function in Excel that will display the status of an activity based on the due date provided.</p>\n\n<p>This function would display:\n\"Overdue\" if Today()> Due Date;\n\"Due Soon\" If the Due date was within one week\n\"Due Later\" if Today() &lt; Due Date +7</p>\n\n<p><img src=\"https://i.stack.imgur.com/V4Ago.jpg\" alt=\"Image of the table for reference\"></p>\n\n<p>Below is an example of what I was able to muster up:</p>\n\n<pre><code>Function Status_of_Date()\n\nIf Sheets(\"Issue_Log\").Range(\"Due_Date\").Value &lt; Date Then\n    Sheets(\"Issue_Log\").Range(\"Date_Status\").Value = \"Overdue\" 'overdue\n\nElseIf Sheets(\"Issue_Log\").Range(\"Due_Date\").Value &lt; 7 + Date Then\n    Sheets(\"Issue_Log\").Range(\"Date_Status\").Value = \"Due Later\" ' Due Soon\n\nElseIf Sheets(\"Issue_Log\").Range(\"Due_Date\").Value &gt; 7 + Date Then\n    Sheets(\"Issue_Log\").Range(\"Date_Status\").Value = \"Due Later\" ' Due Later\n\nElse\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "sockets", "tcp", "header", "client"], "comments": [{"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1518025531, "post_id": 48669558, "comment_id": 84338108, "body": "Can you provide the headers as reported in the scanner manual?"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1518034341, "post_id": 48669558, "comment_id": 84343114, "body": "Some of the types don&#39;t match the spec: <code>uint32&#47;int32</code> should be <code>As Long</code>, <code>ntp64</code> should be <code>As Currency</code> and <code>uint8[]</code> should be <code>As Long</code>."}, {"owner": {"reputation": 11, "user_id": 9328794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be157e0f873a3a48d7c947010205e2ef?s=128&d=identicon&r=PG&f=1", "display_name": "Leandro Rodrigo de Oliveira", "link": "https://stackoverflow.com/users/9328794/leandro-rodrigo-de-oliveira"}, "reply_to_user": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1518095735, "post_id": 48669558, "comment_id": 84370190, "body": "I&#39;ve made the changes but I&#39;m still getting random data. If you help, there is this code in [GitHub]. The link is this: : <a href=\"https://github.com/StaudtEngineering/LidaRx\" rel=\"nofollow noreferrer\">github.com/StaudtEngineering/LidaRx</a> I looked but could not figure out how to decode the packages to work the data the way I need it, Thanks for the help."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1518096634, "post_id": 48669558, "comment_id": 84370888, "body": "do you at least read <code>41564</code> in <code>magic</code>. It shouldn&#39;t be too hard given that the API seems well documented and you also have access at the .Net implementation. Try to read the bytes first in a byte array and then copy it to the defined type."}, {"owner": {"reputation": 11, "user_id": 9328794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be157e0f873a3a48d7c947010205e2ef?s=128&d=identicon&r=PG&f=1", "display_name": "Leandro Rodrigo de Oliveira", "link": "https://stackoverflow.com/users/9328794/leandro-rodrigo-de-oliveira"}, "reply_to_user": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1518105492, "post_id": 48669558, "comment_id": 84377344, "body": "was correct. the magic is -23972. I created a loop to find it and then I distribute the others.Thanks a lot for the help."}], "owner": {"reputation": 11, "user_id": 9328794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be157e0f873a3a48d7c947010205e2ef?s=128&d=identicon&r=PG&f=1", "display_name": "Leandro Rodrigo de Oliveira", "link": "https://stackoverflow.com/users/9328794/leandro-rodrigo-de-oliveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 388, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518031095, "creation_date": 1518023448, "last_edit_date": 1518031095, "question_id": 48669558, "link": "https://stackoverflow.com/questions/48669558/receiving-data-header-over-tcp-ip", "title": "Receiving Data Header over TCP IP", "body": "<p>I made a program to receive data from a 2D scanner, but when I use the <code>GetData</code> method, it returns me a data that I do not know what part of the header is. So I created a User Define Type according to the header reported in the scanner manual but I can not get the packages according to each type. Below is the code I made in <code>VBA</code> with the <code>Winsock</code> control. Also a header printout reported in the scanner manual.</p>\n\n<pre><code> Private WithEvents tcpClient As Winsock\n    Public Event DataArrival(ByVal bytesTotal As Long)\n    Private Type packet_Header   \n        magic As Integer\n        packet_type As Integer\n        packet_size As Integer\n        header_size As Integer\n        scan_number As Integer\n        packet_number As Integer\n        timestamp_raw As Date\n        timestamp_sync As Date\n        status_flags As Integer\n        scan_frequency As Integer\n        num_points_scan As Integer\n        num_points_packet As Integer\n        first_index As Integer\n        first_angle As Integer\n        iq_input As Integer\n        angular_increment As Integer\n        iq_overload As Integer\n        header_padding As Integer\n    End Type\n    Private Type scan_point_data\n        distance As Integer\n    End Type\n\nPublic Sub CommandButton1_Click()\nSet tcpClient = New MSWinsockLib.Winsock\ntcpClient.Protocol = sckTCPProtocol\ntcpClient.Connect \"169.254.218.229\", \"59164\"\nMsgBox tcpClient.State\n'MsgBox tcpClient.SocketHandle\nMsgBox tcpClient.BytesReceived\nEnd Sub\n\nPublic Sub tcpClient_DataArrival(ByVal bytesTotal As Long)\nDim teste As packet_Header\ntcpClient.GetData teste.magic\nMsgBox teste.magic\nEnd Sub\n</code></pre>\n\n<p>Scanner:</p>\n\n<p><a href=\"https://i.stack.imgur.com/QpAUr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QpAUr.png\" alt=\"enter image description here\"></a> </p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 87, "user_id": 7380227, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/96ba7fb215ca8d5acfe30bd60f74da41?s=128&d=identicon&r=PG&f=1", "display_name": "emma12345", "link": "https://stackoverflow.com/users/7380227/emma12345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 358, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1518025088, "creation_date": 1518023222, "last_edit_date": 1518025088, "question_id": 48669490, "link": "https://stackoverflow.com/questions/48669490/how-to-calculate-price-given-payback-period", "title": "How to calculate price given payback period?", "body": "<p>I have a capex table to calculate investment of a new product. </p>\n\n<p>As shown in pic<a href=\"https://i.stack.imgur.com/NAQyk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NAQyk.png\" alt=\"enter image description here\"></a>  all numbers are not real numbers</p>\n\n<p><strong>D83</strong> is the initial investment, meaning we invest $15,800 to buy machine and space</p>\n\n<p><strong>E85</strong> to <strong>I85</strong> are the variable cost each year.</p>\n\n<p><strong>E86</strong> to <strong>I86</strong> are the revenue each year, <code>revenue = price * est.sold quantity</code></p>\n\n<p><code>E87=E85+E86</code>, <code>F87=F85+F86</code>, etc.</p>\n\n<p><code>D91 = {INDEX($E$87:$I$87,MATCH(TRUE,$E$89:$I$89&gt;0,0))}</code>  This is an array to find the first positive cash flow of Row 89 and return the value in row 87</p>\n\n<p><code>D92 = {INDEX($E$83:$I$83,MATCH(TRUE,$E$89:$I$89&gt;0,0))}</code>  This is an array to find the first positive cash flow of Row 89 and return the value in row 83</p>\n\n<pre><code>D93 = COUNTIF(E89:I89,\"&lt;0\")+((-D92)/D91)\n</code></pre>\n\n<p>In this way, I calculated the payback years of a project.</p>\n\n<p>In cell <strong>D98</strong> I need to calculate that given a certain payback year number, other things hold still, what the price needs to be. Since <strong>D91</strong> and <strong>D92</strong> are arrays to lookup for the first positive cash flow and each year cash flow is not even, I can't think of a formula to put in <strong>D98</strong> so <strong>D98</strong> changes with <strong>C98</strong>, for example, if I put <code>2</code> in <strong>C98</strong> meaning I need the payback period to be 2 years, and <strong>D98</strong> will automatically give me a number to show what price it should be.</p>\n\n<p>Is there any formula or VBA to do it?</p>\n"}, {"tags": ["database", "vba", "ms-access"], "comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518023055, "post_id": 48669184, "comment_id": 84336649, "body": "Isn&#39;t <code>qryOutstandingPayments</code> representing everything that you want to know already? Why are you filtering further with <code>[ExpectedPaymentDate] &lt;=Now() AND [Complete] =0</code>? If you execute your <code>**</code> line in the immediate window do you get the results you want? What about if you convert to a query?"}, {"owner": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518023255, "post_id": 48669184, "comment_id": 84336780, "body": "qryOutstandingPayments is where i keep all the customers that have yet to pay, so i need some line of code to be able to get the dates in the query, see if any dates are greater than 25 days. i&#39;m not too sure how that line of code works, i&#39;ve tried research but haven&#39;t figured out how to work with it"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518023608, "post_id": 48669184, "comment_id": 84336994, "body": "Something like <code>Select OrderNumber from qryOutstandingPayments  where DateDiff(&quot;d&quot;, OrderDate, now) &gt; 25</code> ?"}, {"owner": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518023846, "post_id": 48669184, "comment_id": 84337131, "body": "I tried that and I am getting a compile error and it highlights Select"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518023950, "post_id": 48669184, "comment_id": 84337188, "body": "&quot;highlists&quot; sounds like you tried to execute that as VBA. That&#39;s SQL to be entered in a Query window. If that get&#39;s the results you are expecting I can write an answer which executes that as VBA."}, {"owner": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518024022, "post_id": 48669184, "comment_id": 84337228, "body": "Yeah I&#39;m currently working in code builder on Acecss which is in VBA"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518025172, "post_id": 48669184, "comment_id": 84337883, "body": "VBA is not the place to directly execute SQL. How does it look from the query editor window?"}, {"owner": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518025268, "post_id": 48669184, "comment_id": 84337940, "body": "On Access I went to my main menu &gt; Design view &gt; properties &gt; Click on Load &gt; Code Builder and here you can write in VBA. I&#39;m not working with a query editor."}, {"owner": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518025567, "post_id": 48669184, "comment_id": 84338132, "body": "Hello, ive currently got the pop up working, it tells me how many unpaid customers there are with this code : OS = DCount(&quot;[Paid]&quot;, &quot;[OutstandingPayments]&quot;, DateDiff(&quot;d&quot;, OrderDate, Now) &gt; 25) but it is not giving me the customers that havent paid in 25 days. It was only giving me how many customers havent paid in total."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518026107, "post_id": 48669184, "comment_id": 84338465, "body": "Please try in a query window (Create &gt; Query Design &gt; SQL View) to try out the query before turning it into a <code>DCount</code>. There is not diagnosing what&#39;s the matter when you use a <code>DCount</code> straight away."}, {"owner": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518026676, "post_id": 48669184, "comment_id": 84338799, "body": "<a href=\"https://gyazo.com/c70891668e70ecef14587a1045485bc2\" rel=\"nofollow noreferrer\">gyazo.com/c70891668e70ecef14587a1045485bc2</a> i am getting this now so i think there is something wrong witth the calculation, its showing me all the unpaid customers but instead of saying 3 it should say 1"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518026825, "post_id": 48669184, "comment_id": 84338883, "body": "What happens when you step through your code? Notice how in <code>DCount(&quot;[Paid]&quot;, &quot;[OutstandingPayments]&quot;, DateDiff(&quot;d&quot;, OrderDate, Now) &gt; 25)</code> the where part <code>DateDiff(&quot;d&quot;, OrderDate, Now) &gt; 25</code> is not in quotes? it probably evaluates to <code>true</code> and you get everything."}, {"owner": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518026961, "post_id": 48669184, "comment_id": 84338956, "body": "So should it be in quotes?"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518027073, "post_id": 48669184, "comment_id": 84339018, "body": "If it&#39;s not in quotes think about the execution order and what <code>DCount</code> will receive and what it can do with that value."}, {"owner": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518027508, "post_id": 48669184, "comment_id": 84339287, "body": "does dcount not need to be like this DCount ( expr , domain [, criteria] )"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518027658, "post_id": 48669184, "comment_id": 84339360, "body": "That&#39;s correct."}, {"owner": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518028020, "post_id": 48669184, "comment_id": 84339572, "body": "OS = DCount(&quot;[Paid]&quot;, &quot;[OutstandingPayments]&quot;, DateDiff(&quot;d&quot;, OrderDate, Now) &gt; 25) i dont get why this line wont get this line wont calculate 25 days after orderdate"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518028473, "post_id": 48669184, "comment_id": 84339807, "body": "when you break on that line when you&#39;re debugging execute each one of the parameters in the immediate window to see what is actually being passed to <code>DCount</code>. You&#39;ll see the first parameter (in the immediate window) will evaluate like this <code>?&quot;[Paid]&quot; --&gt; </code>[Paid], then <code>?&quot;[OutstandingPayments]&quot;</code> --&gt; <code>[OutstandingPayments]</code>, then <code>?DateDiff(&quot;d&quot;, OrderDate, Now) &gt; 25</code> --&gt; &#39;TRUE&#39;. DO DCount sees <code>DCount(&quot;[Paid]&quot;,&quot;[OutstandingPayments]&quot;,true)</code> which will filter nothing out. ..."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518028503, "post_id": 48669184, "comment_id": 84339817, "body": "...This probably is not throwing an error because you have a control named <code>OrderDate</code> on your form and that value you is what&#39;s being used. When you are debugging and you mouse over <code>OrderDate</code> you&#39;ll probably see that value for the current record on your form."}, {"owner": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518029005, "post_id": 48669184, "comment_id": 84340099, "body": "So basically with DCount i cannot filter the customers that have not paid in 25 days?"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 1, "creation_date": 1518029125, "post_id": 48669184, "comment_id": 84340178, "body": "You just need to add your filter inside quotes like this: <code>DCount(&quot;[Paid]&quot;, &quot;[OutstandingPayments]&quot;, &quot;DateDiff(&#39;d&#39;,[OrderDate], Now()) &gt; 25&quot;)</code> (also note the single quotes used around d). Assuming <code>Paid</code> and <code>OrderDate</code> are valid fields in <code>OutstandingPayments</code>, it should work."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1518029515, "post_id": 48669184, "comment_id": 84340413, "body": "Also need to fix the <code>&amp;_</code> following <code>jobs</code> in the MsgBox expression. The compiler should error. I am surprised it even shows in the pasted code. Need spaces: <code>jobs&quot; &amp; _</code>."}, {"owner": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "edited": false, "score": 0, "creation_date": 1518029544, "post_id": 48669184, "comment_id": 84340428, "body": "That has worked perfectly, thank you very much for your help Brad and Sunknight0!! Sorry for being quite amateur! However, now ive ran into one last thing and i thought this would work but apparently <code>DoCmd.OpenQuery &quot;OutstandingPayments&quot;, acNormal</code> wont bring it to the query when i click yes on the on the pop up"}, {"owner": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1518029844, "post_id": 48669184, "comment_id": 84340612, "body": "@June7 oh i realised that earlier and adjusted it so it wasnt showing an erorr"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1518030035, "post_id": 48669184, "comment_id": 84340722, "body": "Is it open already? Did you minimize it by accident? If it&#39;s in design mode I don&#39;t thing DoCmd.Open will flip it out of design mode."}, {"owner": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "edited": false, "score": 0, "creation_date": 1518030146, "post_id": 48669184, "comment_id": 84340797, "body": "I see, it does open but i thought it would have brought you to the Query but i&#39;ll have a look into it to see if it can do that for me"}, {"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1518036779, "post_id": 48669184, "comment_id": 84344378, "body": "On a side note, you should you Date(), not Now()"}], "owner": {"reputation": 63, "user_id": 9318804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2857f4d742fa55980abe8ebb451a3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Cbrady", "link": "https://stackoverflow.com/users/9318804/cbrady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 498, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1518030047, "creation_date": 1518022376, "last_edit_date": 1518030047, "question_id": 48669184, "link": "https://stackoverflow.com/questions/48669184/ms-access-pop-up-reminder", "title": "MS Access Pop-Up Reminder", "body": "<p>I am currently working on a school project which is making a Database in Access.</p>\n\n<p>Currently, I am attempting to create a pop-up reminder. </p>\n\n<pre><code>Private Sub Form_Load()\n\nDim OS As Integer\n\n**OS= DCount(\"[OrderNo]\", \"[qryOutstandingPayments]\",\n\"[ExpectedPaymentDate] &lt;=Now() AND [Complete] =0\")**\n\n    If OS= 0 Then\n            Exit Sub\n                Else\n                    If MsgBox(\"There are \" &amp; OS &amp; \" uncompleted jobs\" &amp; _\n                        vbCrLf &amp; vbCrLf &amp; \"Would you like to see these now?\", _\n                        vbYesNo, \"You Have Uncomplete Payments...\") = vbYes Then\n                        DoCmd.Minimize\n                        DoCmd.OpenForm \"OutstandingPayments\", acNormal\n                Else\n            Exit Sub\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>So within my Database i have an Order Table which has the Order Details, OrderNo and Paid(Yes or No field). In the Paid field customers have up until 30 days to pay for their order meaning they can place an order and not pay for 30 days.</p>\n\n<p>Therefore, i have created a query in my Database (OutstandingPayments) that lists all of the customers that have not paid within 30 days. </p>\n\n<p>The code above is to try and create a pop up reminder to display how many customers have not paid within 25 days and if the user wants to see what payments these are.</p>\n\n<p>The Line of code with the ** around it is the problem that i have faced. I have tried to do a couple of other methods but i just do not understand how it works.</p>\n\n<p>I know that the entire two lines with the ** around them are more than likely wrong but i can't find anywhere that is helping me. I think if i find a way to make that line right i can fix the rest of the code.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel", "soap", "sharepoint", "runtime-error"], "comments": [{"owner": {"reputation": 262, "user_id": 3328306, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1fe873222a1b9c191f02b7c4e6f2349c?s=128&d=identicon&r=PG&f=1", "display_name": "M.P.", "link": "https://stackoverflow.com/users/3328306/m-p"}, "edited": false, "score": 0, "creation_date": 1518101737, "post_id": 48669008, "comment_id": 84374593, "body": "same problem, something with authentication on SPO is different.."}], "owner": {"reputation": 21, "user_id": 9328034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b13672ba1faae7b53031a1a4bb82bcd?s=128&d=identicon&r=PG&f=1", "display_name": "Victor Brant", "link": "https://stackoverflow.com/users/9328034/victor-brant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 436, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1518031155, "creation_date": 1518021825, "last_edit_date": 1518031155, "question_id": 48669008, "link": "https://stackoverflow.com/questions/48669008/access-denied-query-xml-soap-sharepoint", "title": "Access Denied Query XML SOAP Sharepoint", "body": "<p>The code worked very well, but these last days just stopped to work.\nThe .responseText is now: </p>\n\n<blockquote>\n  <p>Access is denied. (Exception from HRESULT: 0x80070005\n  (E_ACCESSDENIED))\"</p>\n</blockquote>\n\n<p>I tried with and without the line: <code>objXMLHTTP.setRequestHeader \"Authorization\"</code>  And got the same Error.\nWith and without User and Password at line <code>objXMLHTTP.Open</code>, and still the same problem, Access Denied.</p>\n\n<p>Can you guys help me please? </p>\n\n<pre><code>Sub selectSharepoint()\nDim objXMLHTTP As MSXML2.XMLHTTP\nDim strBatchXml As String\nDim strSoapBody As String\n\nUserName = \"john@email.com\"\nPassword = \"123456\"\n\nSet objXMLHTTP = New MSXML2.XMLHTTP\nobjXMLHTTP.Open \"POST\", \"https://ts.sharepoint.com/sites/2018_teste/_vti_bin/lists.asmx\", False, UserName, Password\n'objXMLHTTP.Open \"POST\", \"https://ts.sharepoint.com/sites/2018_teste/_vti_bin/lists.asmx\", False 'This way worked the same, and got the same error.\nobjXMLHTTP.setRequestHeader \"Content-Type\", \"text/xml; charset=UTF-8\"\nobjXMLHTTP.setRequestHeader \"Content-Length\", \"length\"\n'objXMLHTTP.setRequestHeader \"Authorization\", \"Basic \" + Base64Encode(UserName &amp; \":\" &amp; Password) 'makes no effect, with or without Base64Encode\nobjXMLHTTP.setRequestHeader \"SOAPAction\", \"http://schemas.microsoft.com/sharepoint/soap/GetListItems\"\n\nstrSoapBody = \"&lt;?xml version='1.0' encoding='utf-8'?&gt;\" &amp; _\n              \"  &lt;soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'&gt;\" &amp; _\n              \"     &lt;soap:Body&gt;\" &amp; _\n              \"         &lt;GetListItems xmlns='http://schemas.microsoft.com/sharepoint/soap/'&gt;\" &amp; _\n              \"             &lt;listName&gt;AllNames&lt;/listName&gt;\" &amp; _\n              \"             &lt;query&gt;\" &amp; _\n              \"                 &lt;Query xmlns=''&gt;\" &amp; _\n              \"                     &lt;Where&gt;\" &amp; _\n              \"                          &lt;Eq&gt;\" &amp; _\n              \"                              &lt;FieldRef Name='Name' /&gt;\" &amp; _\n              \"                              &lt;Value Type='Text'&gt;Cloe&lt;/Value&gt;\" &amp; _\n              \"                          &lt;/Eq&gt;\" &amp; _\n              \"                     &lt;/Where&gt;\" &amp; _\n              \"                     &lt;OrderBy&gt;\" &amp; _\n              \"                         &lt;FieldRef Name='ID' /&gt;\" &amp; _\n              \"                     &lt;/OrderBy&gt;\" &amp; _\n              \"                 &lt;/Query&gt;\" &amp; _\n              \"             &lt;/query&gt;\"\nstrSoapBody = strSoapBody &amp; _\n              \"             &lt;rowLimit&gt;1&lt;/rowLimit&gt;\" &amp; _\n              \"             &lt;viewFields&gt;&lt;ViewFields&gt;\" &amp; _\n              \"                 &lt;FieldRef xsi:type='s:string' Name='Name'&gt;&lt;/FieldRef&gt;\" &amp; _\n              \"             &lt;/ViewFields&gt;&lt;/viewFields&gt;\" &amp; _\n              \"         &lt;/GetListItems&gt;\" &amp; _\n              \"     &lt;/soap:Body&gt;\" &amp; _\n              \"  &lt;/soap:Envelope&gt;\"\n\nobjXMLHTTP.send strSoapBody\n\nIf objXMLHTTP.Status &lt;&gt; 200 Then\n    MsgBox (\"Error! \" &amp; Chr(10) &amp; objXMLHTTP.responseText)\n    End\nElse\n    tudo = objXMLHTTP.responseText\nEnd If\nEnd Sub\n</code></pre>\n\n<p>MsgBox Error:\n<a href=\"https://i.stack.imgur.com/h1srK.png\" rel=\"nofollow noreferrer\">MsgBox Error</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1518021949, "post_id": 48669007, "comment_id": 84335905, "body": "This needs to be in a worksheet_change event"}], "answers": [{"comments": [{"owner": {"reputation": 729, "user_id": 7673876, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c7e90895b2f01c5cb8df8e49a32ead2?s=128&d=identicon&r=PG&f=1", "display_name": "David Kris", "link": "https://stackoverflow.com/users/7673876/david-kris"}, "edited": false, "score": 0, "creation_date": 1518023402, "post_id": 48669150, "comment_id": 84336879, "body": "Sorry but what do you mean by &quot;that has these ranges on&quot;?"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 729, "user_id": 7673876, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c7e90895b2f01c5cb8df8e49a32ead2?s=128&d=identicon&r=PG&f=1", "display_name": "David Kris", "link": "https://stackoverflow.com/users/7673876/david-kris"}, "edited": false, "score": 1, "creation_date": 1518023519, "post_id": 48669150, "comment_id": 84336946, "body": "D19 and F2:F3 are on a worksheet. Find that worksheet, right click on the tab name and select \u201cview code\u201d. Paste this code in that window and it should work!"}, {"owner": {"reputation": 729, "user_id": 7673876, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c7e90895b2f01c5cb8df8e49a32ead2?s=128&d=identicon&r=PG&f=1", "display_name": "David Kris", "link": "https://stackoverflow.com/users/7673876/david-kris"}, "edited": false, "score": 1, "creation_date": 1518023580, "post_id": 48669150, "comment_id": 84336977, "body": "Ahh, was putting it in the wrong sheet, thanks a ton!"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 3, "last_activity_date": 1518022912, "last_edit_date": 1518022912, "creation_date": 1518022286, "answer_id": 48669150, "question_id": 48669007, "link": "https://stackoverflow.com/questions/48669007/change-range-color-depending-on-cell-value-vba/48669150#48669150", "title": "Change range color depending on cell value VBA", "body": "<p>I would also recommend using conditional formatting. However, to answer the question as asked: put this into the worksheet module of the worksheet that has these ranges on.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"D19\")) Is Nothing Then\n        Select Case Range(\"D19\").Value\n            Case 1\n                Range(\"F2:F3\").Interior.Color = vbRed\n            Case 2\n                Range(\"F2:F3\").Interior.Color = vbYellow\n        End Select\n    End If\nEnd Sub\n</code></pre>\n\n<p>I've tested this code and it's working well. If you would like to remove the colouring if the value of <code>D19</code> is neither 1 or 2 then you can include a <code>Case Else</code> statement too.</p>\n"}, {"tags": [], "owner": {"reputation": 1131, "user_id": 5793276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13c6f48c0b69a432e49bbfc7e944ec6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Yunke", "link": "https://stackoverflow.com/users/5793276/dr-yunke"}, "is_accepted": false, "score": 2, "last_activity_date": 1518023161, "last_edit_date": 1518023161, "creation_date": 1518022735, "answer_id": 48669310, "question_id": 48669007, "link": "https://stackoverflow.com/questions/48669007/change-range-color-depending-on-cell-value-vba/48669310#48669310", "title": "Change range color depending on cell value VBA", "body": "<p>Conditional formating will be better, this way Excel will modify F2:F3 background colors each time the user types in D19 cell</p>\n\n<pre><code>Sub ColorColumns()\n    Dim r As Range\n\n    Set r = Range(\"F2:F3\")\n\n    r.FormatConditions.Delete\n\n    r.FormatConditions.Add Type:=xlExpression, Formula1:=\"=$D$19=1\"\n    r.FormatConditions(r.FormatConditions.Count).SetFirstPriority\n    With r.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 244\n        .TintAndShade = 0\n    End With\n    r.FormatConditions(1).StopIfTrue = False\n\n    r.FormatConditions.Add Type:=xlExpression, Formula1:=\"=$D$19=2\"\n    r.FormatConditions(r.FormatConditions.Count).SetFirstPriority\n    With r.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 65535\n        .TintAndShade = 0\n    End With\n    r.FormatConditions(1).StopIfTrue = False\nEnd Sub\n</code></pre>\n\n<p>Notice the condition <code>\"=$D$19=2\"</code> in <code>r.FormatConditions.Add Type:=xlExpression, Formula1:=\"=$D$19=2\"</code></p>\n"}], "owner": {"reputation": 729, "user_id": 7673876, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c7e90895b2f01c5cb8df8e49a32ead2?s=128&d=identicon&r=PG&f=1", "display_name": "David Kris", "link": "https://stackoverflow.com/users/7673876/david-kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2557, "favorite_count": 0, "accepted_answer_id": 48669150, "answer_count": 2, "score": 1, "last_activity_date": 1518023161, "creation_date": 1518021823, "question_id": 48669007, "link": "https://stackoverflow.com/questions/48669007/change-range-color-depending-on-cell-value-vba", "title": "Change range color depending on cell value VBA", "body": "<p>I'm trying to have my code work so if the user types a \"1\" inside cell D19 then the background colors of cells F2 and F3 change to red and if they type a \"2\" the color changes to yellow. I can't see why my code isn't working, anything helps. Thanks.</p>\n\n<pre><code>Sub ColorColumns()\n   Dim r1 As Range, r2 As Range\n      Set r1 = Range(\"D19\")\n      Set r2 = Range(\"F2:F3\")\n      If r1.Value = 1 Then r2.Interior.Color = vbRed\n      If r1.Value = 2 Then r2.Interior.Color = vbYellow\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 1, "creation_date": 1518022026, "post_id": 48668992, "comment_id": 84335950, "body": "Can you give us an example of your data? The <code>If</code> statement holds little to no meaning for us."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 1, "creation_date": 1518022213, "post_id": 48668992, "comment_id": 84336081, "body": "Your IF statements with OR mean that if any of them is TRUE it will format everything in the given range to %, if you show us what your data looks like, you will get a better answer..."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 4, "creation_date": 1518022715, "post_id": 48668992, "comment_id": 84336391, "body": "Also where do you get the values for C4, V2, X2, etc.. as the way they are in your IF statement, VBA will think that they are variables and not Cells or Ranges..."}, {"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 1, "creation_date": 1518025202, "post_id": 48668992, "comment_id": 84337899, "body": "@Henry That image doesn&#39;t help at all. We&#39;re missing cell references and it has a lot of distracting information that we don&#39;t need. Please include an <a href=\"https://stackoverflow.com/help/mcve\">MVCE</a>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1518025582, "post_id": 48668992, "comment_id": 84338139, "body": "Hopefully you are using <code>Option Explicit</code> and have defined <code>C4</code> etc. elsewhere in your code. Otherwise you are just testing that the default values of implicitly declared empty variables are the same -- which they will be. Also -- qualifying <code>Range</code> by <code>ActiveCell</code> is weird and probably not what you intend (unless you know that <code>ActiveCell</code> is <code>A1</code> on the desired sheet)."}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 1, "last_activity_date": 1518026875, "last_edit_date": 1518026875, "creation_date": 1518026417, "answer_id": 48670470, "question_id": 48668992, "link": "https://stackoverflow.com/questions/48668992/vba-code-number-formatting/48670470#48670470", "title": "VBA code number formatting", "body": "<p>In context, you intend <code>C4, V2</code> etc. to be a cell references but VBA is interpreting them as variables. The fact that your code runs at all in that case implies that you are not using <code>Option Explicit</code>, which you really should use in VBA. What seems to be happening is that you are implicitly creating empty variables in the process of testing them for equality. Any two empty variables are equal, hence the first clause of the <code>If</code> statement is always run. Corrected, but not tested, your code should (I think) look like this:</p>\n\n<pre><code>Option Explicit\n\nSub LetsMakeThisWork()\n    Dim C4 As Range\n    With Worksheets(\"Geo\")\n        Set C4 = .Range(\"C4\")\n        If C4.Value = .Range(\"RV2\").Value Or C4.Value = .Range(\"X2\").Value Or _\n            C4.Value = .Range(\"AB2\").Value Or C4.Value = .Range(\"AD2\").Value Or _\n            C4.Value = .Range(\"AG2\").Value Or C4.Value = .Range(\"AM2\").Value Or _\n            C4.Value = .Range(\"AO2\").Value Or C4.Value = .Range(\"AQ2\").Value Or _\n            C4.Value = .Range(\"AU2\").Value Or C4.Value = .Range(\"AW2\").Value Then\n            .Range(\"G9:N9\").NumberFormat = \"0.0%\"\n        Else\n            .Range(\"G9:N9\").NumberFormat = \"General\"\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9328634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YSSGm.jpg?s=128&g=1", "display_name": "John_Public", "link": "https://stackoverflow.com/users/9328634/john-public"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518026875, "creation_date": 1518021761, "last_edit_date": 1518026354, "question_id": 48668992, "link": "https://stackoverflow.com/questions/48668992/vba-code-number-formatting", "title": "VBA code number formatting", "body": "<p><a href=\"https://i.stack.imgur.com/JQZYG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JQZYG.png\" alt=\"Worksheet image\"></a></p>\n\n<p>With the below code I am trying to format cells when certain names appear in a drop down list(cell C4) and format these specific cells in Range G9:N9. But when I run the code it converts all numbers into percents appose to differentiating between the two formatting styles (Percent and General). Can anyone help?</p>\n\n<pre><code>Sub LetsMakeThisWork()\n    With Worksheets(\"Geo\")\n        If C4 = V2 Or C4 = x2 Or C4 = AB2 Or C4 = AD2 Or C4 = AG2 Or C4 = AM2 Or C4 = AO2 Or C4 = AQ2 Or C4 = AU2 Or C4 = AW2 Then\n            ActiveCell.Range(\"G9:N9\").NumberFormat = \"0.0%\"\n        Else\n            ActiveCell.Range(\"G9:N9\").NumberFormat = \"General\"    \n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ie-automation"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1518021630, "post_id": 48668786, "comment_id": 84335676, "body": "What error message are you getting and where?"}, {"owner": {"reputation": 127, "user_id": 9114996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1f2083850b19fc75ed421920fc644b79?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/9114996/francis"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1518021708, "post_id": 48668786, "comment_id": 84335732, "body": "With the given example above I receive the following message:     Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method.  In debug it highlights this line: .document.getElementByName(&quot;LocationID&quot;).Value = &quot;7&quot;"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1518021930, "post_id": 48668786, "comment_id": 84335889, "body": "It should be <code>getElementsByName</code> (plural) - You have it correct on the other lines, but not that one."}, {"owner": {"reputation": 127, "user_id": 9114996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1f2083850b19fc75ed421920fc644b79?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/9114996/francis"}, "edited": false, "score": 0, "creation_date": 1518022062, "post_id": 48668786, "comment_id": 84335976, "body": "I corrected it, thanks. But still get the same error."}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 9114996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1f2083850b19fc75ed421920fc644b79?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/9114996/francis"}, "edited": false, "score": 0, "creation_date": 1518022184, "post_id": 48669069, "comment_id": 84336062, "body": "Amazing. This did the job! Thanks heaps, K.Davis :)  I assume for the other drop-downs, I just add the additional lines as reflect in your post, correct?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 127, "user_id": 9114996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1f2083850b19fc75ed421920fc644b79?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/9114996/francis"}, "edited": false, "score": 0, "creation_date": 1518022515, "post_id": 48669069, "comment_id": 84336273, "body": "@Francis Sorry I don&#39;t follow. If you are using anything other than <code>getElementByID()</code>, make sure that <b>elements</b> is plural and that you append the collection item (ex: <code>(0)</code>) to the end of the element unless you want to loop through them."}, {"owner": {"reputation": 127, "user_id": 9114996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1f2083850b19fc75ed421920fc644b79?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/9114996/francis"}, "edited": false, "score": 0, "creation_date": 1518022654, "post_id": 48669069, "comment_id": 84336346, "body": "@K.Davis It&#39;s all good. It works. Sorry, if I wasn&#39;t clear. I just quickly asked whether .document.getElementsByName(&quot;LocationID&quot;)(0).Value = &quot;7&quot; can be then applied for the additional drop-downs, of course with the correct names, and yes, it works. Again, thanks for taking the time looking into this."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 127, "user_id": 9114996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1f2083850b19fc75ed421920fc644b79?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/9114996/francis"}, "edited": false, "score": 0, "creation_date": 1518022847, "post_id": 48669069, "comment_id": 84336490, "body": "@Francis It&#39;s difficult to say with 100% confidence without seeing the HTML code, but it should work if the element has a <code>Name</code> property. Not all elements have this property, just as not all elements have an ID. But if it has the name property then you shouldn&#39;t have any issues."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 0, "last_activity_date": 1518022236, "last_edit_date": 1518022236, "creation_date": 1518022008, "answer_id": 48669069, "question_id": 48668786, "link": "https://stackoverflow.com/questions/48668786/using-vba-to-select-drop-down-values-on-a-website/48669069#48669069", "title": "Using VBA to select drop-down values on a website", "body": "<p>I assume you are getting your error message on this line?..</p>\n\n<pre><code>.document.getElementByName(\"LocationID\").Value = \"7\"\n</code></pre>\n\n<p>That would be because the <code>Name</code> is an element collection. Unlike ID (<code>getElementByID</code>), element is plural on <em>collections</em>.</p>\n\n<p>The proper syntax in this case would be:</p>\n\n<pre><code>.document.getElementsByName(\"LocationID\")(0).Value = \"7\"\n</code></pre>\n\n<p>Notice the appended <code>(0)</code> as well? This is because again it's a collection, so you will also need to select the collection item as well. (may not necessarily be <code>(0)</code>, but I cannot tell you for sure without looking at the entire HTML code.)</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1518276230, "creation_date": 1518276230, "answer_id": 48722318, "question_id": 48668786, "link": "https://stackoverflow.com/questions/48668786/using-vba-to-select-drop-down-values-on-a-website/48722318#48722318", "title": "Using VBA to select drop-down values on a website", "body": "<p>It should be something like this...</p>\n\n<pre><code>Sub passValueToComboBox1()\n   Dim ie  As Object\n   Dim oHTML_Element As IHTMLElement\n\n   Set ie = CreateObject(\"InternetExplorer.Application\")\n   ie.Visible = True\n   ie.navigate \"http://www.your_web_site.com\"\n   While ie.Busy Or ie.readyState &lt;&gt; 4: DoEvents: Wend\n\n   Set oHTML_Element = ie.document.getElementsByName(\"selectedReportClass\")(0)\n   If Not oHTML_Element Is Nothing Then oHTML_Element.Value = \"com.db.moap.report.FUBU\"\n\n   For Each oHTML_Element In ie.document.getElementsByTagName(\"input\")\n      If oHTML_Element.Type = \"submit\" Then oHTML_Element.Click: Exit For\n   Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 9114996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1f2083850b19fc75ed421920fc644b79?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/9114996/francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2729, "favorite_count": 0, "accepted_answer_id": 48669069, "answer_count": 2, "score": 3, "last_activity_date": 1518276230, "creation_date": 1518021092, "last_edit_date": 1518022267, "question_id": 48668786, "link": "https://stackoverflow.com/questions/48668786/using-vba-to-select-drop-down-values-on-a-website", "title": "Using VBA to select drop-down values on a website", "body": "<p>I am trying to create a macro which pulls a report from a website and this has four drop-down lists to select values.\nI am able to login to the page and direct myself to the report page, but for some reason am having trouble with the drop-down lists. I have tried several 'solutions' which were provided online, but I keep getting an error message:</p>\n\n<blockquote>\n  <p>Run-time error '438': Object doesn't support this property or method.</p>\n</blockquote>\n\n<p>Here is one of the drop-downs to select from:</p>\n\n<pre><code>&lt;select name=\"LocationID\"&gt;\n&lt;option value=\"0\" selected=\"\"&gt;All Location&lt;/option&gt;\n&lt;option value=\"9\"&gt;Atlanta&lt;/option&gt;\n&lt;option value=\"7\"&gt;Denver&lt;/option&gt;\n&lt;option value=\"3\"&gt;Las Vegas&lt;/option&gt;\n&lt;option value=\"1\"&gt;Los Angeles&lt;/option&gt;\n&lt;option value=\"4\"&gt;Miami&lt;/option&gt;\n&lt;option value=\"6\"&gt;New Jersey&lt;/option&gt;\n&lt;option value=\"10\"&gt;Phoenix&lt;/option&gt;\n&lt;option value=\"2\"&gt;San Francisco&lt;/option&gt;\n&lt;option value=\"8\"&gt;Seattle&lt;/option&gt;\n&lt;option value=\"11\"&gt;Vancouver&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>And here is what I currently have in VBA:</p>\n\n<pre><code>Option Explicit\nConst MyUserID As String = \"test123\"\nConst MyPassword As String = \"test123\"\nConst READYSTATE_COMPLETE As Integer = 4\nDim objIE As Object\n\n\nPublic Sub LoginScript()\n\nSet objIE = CreateObject(\"InternetExplorer.Application\")\n\nWith objIE\n.Visible = True\n.Silent = True\n.navigate (\"https://wwww.mywebsite.com\")\nDo Until .readyState = READYSTATE_COMPLETE\nDoEvents\nLoop\nApplication.Wait Now() + TimeValue(\"00:00:02\")\n.document.all.txtuserid.Value = MyUserID\n.document.all.txtPassword.Value = MyPassword\nobjIE.document.getElementsByName(\"btnSubmit\")(0).Click\nDo Until .readyState = READYSTATE_COMPLETE\nDoEvents\nLoop\nApplication.Wait Now() + TimeValue(\"00:00:02\")\n.navigate(\"https://www.mywebsite.com/sample.html\")\nDo Until .readyState = READYSTATE_COMPLETE\nDoEvents\nLoop\n.document.getElementByName(\"LocationID\").Value = \"7\"\nobjIE.document.getElementsByName(\"view\")(0).Click\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 403, "user_id": 7692763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p00vG.jpg?s=128&g=1", "display_name": "shmicah", "link": "https://stackoverflow.com/users/7692763/shmicah"}, "edited": false, "score": 0, "creation_date": 1518021197, "post_id": 48668723, "comment_id": 84335394, "body": "Are the cells with &quot;dates&quot; formatted as a date type? String type? General Type?  Also, what is not working specifically? Is it failing to find dates, finding fake dates?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518021208, "post_id": 48668723, "comment_id": 84335400, "body": "Why is it not <code>If IsDate(cell)...</code>? Though you may have to nest the two conditions."}, {"owner": {"reputation": 23, "user_id": 8598582, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/da69e5dba39f2e564a46c7d07acda4a0?s=128&d=identicon&r=PG&f=1", "display_name": "J Dodge", "link": "https://stackoverflow.com/users/8598582/j-dodge"}, "edited": false, "score": 0, "creation_date": 1518021374, "post_id": 48668723, "comment_id": 84335506, "body": "the dates are all MM/DD/YYYY - when I run it nothing happens even though I&#39;ve intentionally put in past dates to test."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1518021448, "post_id": 48668723, "comment_id": 84335556, "body": "If IsDate(Range(&quot;c1&quot;)) should be  If IsDate(cell), no?"}, {"owner": {"reputation": 23, "user_id": 8598582, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/da69e5dba39f2e564a46c7d07acda4a0?s=128&d=identicon&r=PG&f=1", "display_name": "J Dodge", "link": "https://stackoverflow.com/users/8598582/j-dodge"}, "edited": false, "score": 0, "creation_date": 1518021621, "post_id": 48668723, "comment_id": 84335668, "body": "Replacing &quot;c1&quot; with cell creates an error: &quot;object required&quot;, however highlights the msgbox line"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8598582, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/da69e5dba39f2e564a46c7d07acda4a0?s=128&d=identicon&r=PG&f=1", "display_name": "J Dodge", "link": "https://stackoverflow.com/users/8598582/j-dodge"}, "edited": false, "score": 0, "creation_date": 1518021762, "post_id": 48668928, "comment_id": 84335775, "body": "Just tried this and it returns an error &quot;object required&quot;"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 23, "user_id": 8598582, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/da69e5dba39f2e564a46c7d07acda4a0?s=128&d=identicon&r=PG&f=1", "display_name": "J Dodge", "link": "https://stackoverflow.com/users/8598582/j-dodge"}, "edited": false, "score": 0, "creation_date": 1518021855, "post_id": 48668928, "comment_id": 84335839, "body": "I made a few changes, does it still throw an error -- and where?"}, {"owner": {"reputation": 23, "user_id": 8598582, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/da69e5dba39f2e564a46c7d07acda4a0?s=128&d=identicon&r=PG&f=1", "display_name": "J Dodge", "link": "https://stackoverflow.com/users/8598582/j-dodge"}, "edited": false, "score": 0, "creation_date": 1518022138, "post_id": 48668928, "comment_id": 84336028, "body": "That worked, the pop up is now working but only for one cell - I put in multiple expired dates but it only pops up the first one..."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 23, "user_id": 8598582, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/da69e5dba39f2e564a46c7d07acda4a0?s=128&d=identicon&r=PG&f=1", "display_name": "J Dodge", "link": "https://stackoverflow.com/users/8598582/j-dodge"}, "edited": false, "score": 0, "creation_date": 1518022399, "post_id": 48668928, "comment_id": 84336196, "body": "Hmm.. should work fine. If it&#39;s getting to the first one I can&#39;t see any reason why it wouldn&#39;t get the others. Check your data?"}, {"owner": {"reputation": 23, "user_id": 8598582, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/da69e5dba39f2e564a46c7d07acda4a0?s=128&d=identicon&r=PG&f=1", "display_name": "J Dodge", "link": "https://stackoverflow.com/users/8598582/j-dodge"}, "edited": false, "score": 0, "creation_date": 1518022596, "post_id": 48668928, "comment_id": 84336321, "body": "Ah you&#39;re totally right - the test date I put in was in the wrong format. Thanks so much for your help - you&#39;re a life saver!"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 0, "last_activity_date": 1518022313, "last_edit_date": 1518022313, "creation_date": 1518021532, "answer_id": 48668928, "question_id": 48668723, "link": "https://stackoverflow.com/questions/48668723/if-cell-is-date-and-today-return-offset-cell-msgbox/48668928#48668928", "title": "If cell is date and &lt; today, return offset cell MsgBox?", "body": "<p>Try this. As per the comments</p>\n\n<ul>\n<li>You should have <code>IsDate(cell.Value)..</code></li>\n<li>IsDate() needs to be in a separate If statement so that you dont compare Cell.Value &lt; Now() if it's not a date</li>\n<li><code>Cell.Value.Offset(0,-1)</code> should be <code>Cell.Offset(0,-1).Value</code></li>\n</ul>\n\n<hr>\n\n<pre><code>Sub Pop_Up()\n    Dim cell As Range\n    For Each cell In Range(\"c1:U439\")\n        If IsDate(cell.Value) Then\n            If cell.Value &lt; Now() Then\n                MsgBox \"Holdback Expired:\" &amp; vbCrLf &amp; cell.Value &amp; \" \" &amp; cell.Offset(0, -1).Value\n            End If\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8598582, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/da69e5dba39f2e564a46c7d07acda4a0?s=128&d=identicon&r=PG&f=1", "display_name": "J Dodge", "link": "https://stackoverflow.com/users/8598582/j-dodge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1009, "favorite_count": 0, "accepted_answer_id": 48668928, "answer_count": 1, "score": 1, "last_activity_date": 1518022313, "creation_date": 1518020938, "last_edit_date": 1518021416, "question_id": 48668723, "link": "https://stackoverflow.com/questions/48668723/if-cell-is-date-and-today-return-offset-cell-msgbox", "title": "If cell is date and &lt; today, return offset cell MsgBox?", "body": "<p>I'm trying to create a macro which searches my sheet and creates a message box if a cell's date has passed, with the text of the message box as the cell adjacent. I would think to forget the first IsDate part, however the range also contains cells with text which muddles things a bit. </p>\n\n<p>I'm pretty new to VBA and this is what I've come up with (which is not working). </p>\n\n<pre><code>Sub Pop_Up()\n    Dim cell As Range\n    For Each cell In Range(\"c1:U439\")\n        If IsDate(Range(\"c1\")) And cell.Value &lt; Now() Then\n            MsgBox \"Holdback Expired:\" &amp; vbCrLf &amp; cell.Value &amp; \" \" &amp; cell.Value.Offset(0, -1)\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Any help would be appreciated, thanks in advance!</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 1, "creation_date": 1518029859, "post_id": 48668916, "comment_id": 84340620, "body": "He is also missing the part where he actually defines and opens his recordset (and closes it when done)."}, {"owner": {"reputation": 183, "user_id": 1478116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/938043a831744700a0742b53971e8730?s=128&d=identicon&r=PG", "display_name": "WKI", "link": "https://stackoverflow.com/users/1478116/wki"}, "edited": false, "score": 0, "creation_date": 1518039754, "post_id": 48668916, "comment_id": 84345896, "body": "@Brad many thanks. I think it would be better if I use a DatePicker to set the YearBegins variable. Once the user picks the date, a code can then loop through and update record. I&#39;ll update my code soon and post."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 183, "user_id": 1478116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/938043a831744700a0742b53971e8730?s=128&d=identicon&r=PG", "display_name": "WKI", "link": "https://stackoverflow.com/users/1478116/wki"}, "edited": false, "score": 0, "creation_date": 1518101268, "post_id": 48668916, "comment_id": 84374255, "body": "@WKI I agree, a dedicated pop-up form with a date picker would be much smoother."}], "tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": true, "score": 2, "last_activity_date": 1518021505, "creation_date": 1518021505, "answer_id": 48668916, "question_id": 48668698, "link": "https://stackoverflow.com/questions/48668698/looping-through-the-entire-record-every-time-a-form-loads/48668916#48668916", "title": "Looping through the entire record every time a form loads", "body": "<p>You're missing the part where you actually update the recordset.</p>\n\n<pre><code>Private Sub Form_Load()\n    Me.Caption = Date\n    YearBegins_AfterUpdate\nEnd Sub\n\nPrivate Sub YearBegins_AfterUpdate()\n\n    Dim rst As Recordset\n    Do While Not rst.EOF\n        If IsNull(rst.Fields(\"YearBegins\").Value) Then\n            YearBegins = InputBox(\"Please Enter the Beginning of counter Year  Date as: dd/mm/yyyy\")\n            rst.Edit  '&lt;---\n            rst(\"YearBegins\") = cdate(YearBegins) '&lt;---\n            rst.Update '&lt;---\n        Else\n            YearBegins = YearBegins.Value\n        End If\n        rst.MoveNext\n        If (DateTime.Now - YearBegins.Value) &lt; 365 Then\n            counter.Value = 0\n        End If\n\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>With that said there are better ways to do this. You could open another form with only the data you want to update which will allow you to give your users some context. Just having a popup dialog with no data validation doesn't let them even really see what record they're updating. How do they know what value to put in?</p>\n\n<p>It would be better if you could refactor your code in <code>YearBegins_AfterUpdate</code> to a new function and call that from <code>Form_Load</code> instead of calling an event handler like <code>YearBegins_AfterUpdate</code>.</p>\n\n<p>I don't see where you're setting <code>rst</code>. You go from <code>Dim rst As Recordset</code> to using it but given the code you provided <code>rst</code> will always be null.</p>\n"}], "owner": {"reputation": 183, "user_id": 1478116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/938043a831744700a0742b53971e8730?s=128&d=identicon&r=PG", "display_name": "WKI", "link": "https://stackoverflow.com/users/1478116/wki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 48668916, "answer_count": 1, "score": 0, "last_activity_date": 1518021505, "creation_date": 1518020875, "last_edit_date": 1518020997, "question_id": 48668698, "link": "https://stackoverflow.com/questions/48668698/looping-through-the-entire-record-every-time-a-form-loads", "title": "Looping through the entire record every time a form loads", "body": "<p>The code is supposed to check if a filed \"YearBigins\" is empty and request an input then checks if the date value in \"YearBigins\" filed in older than one year and sets the value in the \"counter\" filed to 0. I have the following codes but does not work:</p>\n\n<pre><code>Private Sub Form_Load()\nMe.Caption = Date\nYearBegins_AfterUpdate\nEnd Sub\n\nPrivate Sub YearBegins_AfterUpdate()\n\nDim rst As Recordset\nDo While Not rst.EOF\nIf IsNull(rst.Fields(\"YearBegins\").Value) Then\nYearBegins = InputBox(\"Please Enter the Beginning of counter Year  Date as: \ndd/mm/yyyy\")\nElse: YearBegins = YearBegins.Value\nEnd If\nrst.MoveNext\nIf (DateTime.Now - YearBegins.Value) &lt; 365 Then\ncounter.Value = 0\nEnd If\n\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "sorting"], "comments": [{"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1518021272, "post_id": 48668665, "comment_id": 84335442, "body": "You have to provide a key (key :=) for the sort in this case Column A values."}], "answers": [{"comments": [{"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1518021534, "post_id": 48668867, "comment_id": 84335611, "body": "there you go he provided the key, don&#39;t forget to find the last row of data based on the column of your choice so you can dynamically define the range."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1518021688, "post_id": 48668867, "comment_id": 84335721, "body": "@Wookies-Will-Code you don&#39;t need to define a range to sort, unless there is other data in the same sheet that you would like to exclude from the Sort..."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1518021958, "post_id": 48668867, "comment_id": 84335913, "body": "I see now how he defined the range.  Thank you @Xabier.  Good tip."}, {"owner": {"reputation": 151, "user_id": 4459307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d24b1cb69ddebc08bc048633ad5dccbe?s=128&d=identicon&r=PG&f=1", "display_name": "Ravarro", "link": "https://stackoverflow.com/users/4459307/ravarro"}, "edited": false, "score": 0, "creation_date": 1518022665, "post_id": 48668867, "comment_id": 84336352, "body": "Thanks Xabier, however when I tried that (with the worksheet amended) I get the error &quot;1004 AutoFilter method of Range class failed&quot;? It points the error at ws.Cells.AutoFilter"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1518022901, "post_id": 48668867, "comment_id": 84336529, "body": "Updated my answer to check whether the Autofilter is on or off before running the rest of the code.."}, {"owner": {"reputation": 151, "user_id": 4459307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d24b1cb69ddebc08bc048633ad5dccbe?s=128&d=identicon&r=PG&f=1", "display_name": "Ravarro", "link": "https://stackoverflow.com/users/4459307/ravarro"}, "edited": false, "score": 0, "creation_date": 1518177943, "post_id": 48668867, "comment_id": 84409204, "body": "Hmm, seem to get the error again but this time on the new line of code: If ws.AutoFilterMode = False Then ws.Cells.AutoFilter"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 151, "user_id": 4459307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d24b1cb69ddebc08bc048633ad5dccbe?s=128&d=identicon&r=PG&f=1", "display_name": "Ravarro", "link": "https://stackoverflow.com/users/4459307/ravarro"}, "edited": false, "score": 0, "creation_date": 1518178219, "post_id": 48668867, "comment_id": 84409377, "body": "@Rath I get no such error when testing, are you trying to sort the full sheet or a specific range only?"}, {"owner": {"reputation": 151, "user_id": 4459307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d24b1cb69ddebc08bc048633ad5dccbe?s=128&d=identicon&r=PG&f=1", "display_name": "Ravarro", "link": "https://stackoverflow.com/users/4459307/ravarro"}, "edited": false, "score": 0, "creation_date": 1518453343, "post_id": 48668867, "comment_id": 84502863, "body": "@Xabier the full sheet, however my worksheet only has data in columns A - N. Strangely enough, I modified the code so instead of where it says &quot;A1:Z1&quot; I changed it to &quot;A1:N1&quot; for both instances in the code, and it got as far the &#39;.Apply&#39; row before giving the error message &quot;Method &#39;Apply&#39; of objet &#39;Sort&#39; failed&quot;...so it got further ahead, but not sure what the issue is now"}, {"owner": {"reputation": 151, "user_id": 4459307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d24b1cb69ddebc08bc048633ad5dccbe?s=128&d=identicon&r=PG&f=1", "display_name": "Ravarro", "link": "https://stackoverflow.com/users/4459307/ravarro"}, "edited": false, "score": 0, "creation_date": 1518453360, "post_id": 48668867, "comment_id": 84502876, "body": "Updated code: Sub sortColumnA() Dim ws As Worksheet: Set ws = Sheets(&quot;Catalogue&quot;) &#39;declare and set your worksheet, amend as required     If ws.AutoFilterMode = False Then ws.Range(&quot;A1:N1&quot;).AutoFilter     ws.AutoFilter.Sort.SortFields.Clear     ws.AutoFilter.Sort.SortFields.Add Key:=Range(&quot;A1&quot;), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal     With ws.AutoFilter.Sort         .Header = xlYes         .MatchCase = False         .Orientation = xlTopToBottom         .SortMethod = xlPinYin         .Apply     End With     ws.Range(&quot;A1:N1&quot;).AutoFilter End Sub"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1518178408, "last_edit_date": 1518178408, "creation_date": 1518021351, "answer_id": 48668867, "question_id": 48668665, "link": "https://stackoverflow.com/questions/48668665/vba-sorting-not-working-properly/48668867#48668867", "title": "VBA sorting not working properly", "body": "<p>If you want to sort by values on Column A, in ascending order, then the following will do that taking the full sheet into consideration:</p>\n\n<pre><code>Sub sortColumnA()\nDim ws As Worksheet: Set ws = Sheets(\"Sheet1\")\n'declare and set your worksheet, amend as required\n    If ws.AutoFilterMode = False Then ws.Cells.AutoFilter\n    ws.AutoFilter.Sort.SortFields.Clear\n    ws.AutoFilter.Sort.SortFields.Add Key:=Range(\"A1\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    With ws.AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    ws.Cells.AutoFilter\nEnd Sub\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>If you only want to sort a specific range then something like below should work too:</p>\n\n<pre><code>Sub sortColumnA()\nDim ws As Worksheet: Set ws = Sheets(\"Sheet1\")\n'declare and set your worksheet, amend as required\n    If ws.AutoFilterMode = False Then ws.Range(\"A1:Z1\").AutoFilter\n    ws.AutoFilter.Sort.SortFields.Clear\n    ws.AutoFilter.Sort.SortFields.Add Key:=Range(\"A1\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    With ws.AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    ws.Range(\"A1:Z1\").AutoFilter\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "is_accepted": false, "score": 0, "last_activity_date": 1518022192, "last_edit_date": 1518022192, "creation_date": 1518021841, "answer_id": 48669016, "question_id": 48668665, "link": "https://stackoverflow.com/questions/48668665/vba-sorting-not-working-properly/48669016#48669016", "title": "VBA sorting not working properly", "body": "<p>@Xabier has you taken care of but a few other considerations, sorry this code is from another similar answer but it defines the worksheet, and the column names for easier reading code.  I will skip the Dims and go to the meat of it, this was for a 3 column sort of unknown or changing row quantity.  The example simply shows setting up for the range definition using the rows and columns and Cells to define the range.  I stopped the code at the sort, the rest of the code generates a single email for each person with the dept names listed in the body of the email, not relevant to this question.  Maybe another way to think about it.  You can see the use of the sort key.</p>\n\n<pre><code>'set worksheet to work on as active (selected sheet)\nSet emailWS = ThisWorkbook.ActiveSheet\nstartRow = 2 ' starting row\nnameCol = 1 'col of names, can also do nameCol = emailWS.Range(\"A1\").Column\ndeptCol = 3 'col of depts, can also do deptCol = emailWS.Range(\"A3\").Column\n'** Advantage of the optional way is if you have many columns and you don't want to count them\n\n'find the last row with a name in it from the name column\nlastRow = emailWS.Cells(emailWS.Rows.Count, nameCol).End(xlUp).Row\n\n'sort the data first before going through the email process using Range sort and a key\n'assumes these are the only columns 1 (nameCol) thru 3 (deptCol) to sort\n'assumes you are sorting based on col 1 (nameCol)\nemailWS.Range(Cells(startRow, nameCol), Cells(lastRow, deptCol)).Sort _\nkey1:=emailWS.Range(Cells(startRow, nameCol), Cells(lastRow, nameCol))\n</code></pre>\n\n<p>Cheers,\nWWC</p>\n"}, {"tags": [], "owner": {"reputation": 1131, "user_id": 5793276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13c6f48c0b69a432e49bbfc7e944ec6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Yunke", "link": "https://stackoverflow.com/users/5793276/dr-yunke"}, "is_accepted": false, "score": 0, "last_activity_date": 1518021844, "creation_date": 1518021844, "answer_id": 48669017, "question_id": 48668665, "link": "https://stackoverflow.com/questions/48668665/vba-sorting-not-working-properly/48669017#48669017", "title": "VBA sorting not working properly", "body": "<p>If you want column A to be sorted, you need to include it on myRange. Currently you have</p>\n\n<pre><code>ws_catalogue.Sort.SetRange = myRange\n</code></pre>\n\n<p>Where <code>myRange</code> is from B1 to the bottom of the data (it does not include column A).</p>\n\n<p>Additionally, if you want to order column A, you need to add something like this</p>\n\n<pre><code>    .SortFields.Add _\n        Key:=myRange.Offset(0,0) _\n        SortOn:=0, _\n        Order:=1, _\n        DataOption:=0\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 4459307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d24b1cb69ddebc08bc048633ad5dccbe?s=128&d=identicon&r=PG&f=1", "display_name": "Ravarro", "link": "https://stackoverflow.com/users/4459307/ravarro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 697, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1518178408, "creation_date": 1518020792, "question_id": 48668665, "link": "https://stackoverflow.com/questions/48668665/vba-sorting-not-working-properly", "title": "VBA sorting not working properly", "body": "<p>This challenge came about following an answer to this question:\n<a href=\"https://stackoverflow.com/questions/22073642/excel-vba-sorting\">Excel VBA Sorting</a></p>\n\n<p>I used the code provided as one of the answers there and attempted to edit it to my situation</p>\n\n<p>I need to sort on column A, header in A1, A to Z - whilst maintaining row integrity, i.e. the row values follow the sorted cells</p>\n\n<p>Here is my attempted code edit, but I've clearly not edited it properly because the column A values are not sorted alphabetically as I'd hoped - can someone please assist?</p>\n\n<pre><code>With ws_catalogue\n\n    '''''''''''''''''''''''''''''''''''''''''''\n    'Get range from B1 to last cell on sheet. '\n    '''''''''''''''''''''''''''''''''''''''''''\n    Set myRange = .Range(.Cells(1, 1), .Cells(.Cells.Find(\"*\", , , , 1, 2).Row, .Cells.Find(\"*\", , , , 2, 2).Column))\n\n    myRange.Select\n\n   With .Sort\n        .SortFields.Clear\n\n        '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        'As using late binding Access won't understand Excel values so: '\n        'xlSortOnValues = 0     xlYes           = 1                     '\n        'xlAscending    = 1     xlTopToBottom   = 1                     '\n        'xlSortNormal   = 0     xlPinYin        = 1                     '\n        '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        .SortFields.Add _\n            Key:=myRange.Offset(, 6).Resize(, 1), _\n            SortOn:=0, _\n            Order:=1, _\n            DataOption:=0\n\n        .SetRange myRange\n        .Header = 1\n        .MatchCase = False\n        .Orientation = 1\n        .SortMethod = 1\n        .Apply\n\n    End With\n\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1518020370, "post_id": 48668421, "comment_id": 84334807, "body": "Please show the code you&#39;ve tried thusfar.  StackOverflow is a collaborative site dedicated to helping with <i>specific</i> coding issues; it is not a code-for-you site.  If you need help getting started, use the Macro Recorder under the Developer tab in Excel.  For specific things to google, try .ClearContents and .Sort"}, {"owner": {"reputation": 13, "user_id": 9317994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f6d91aa8bb0676aef1a88d34b2a9043?s=128&d=identicon&r=PG", "display_name": "jwats", "link": "https://stackoverflow.com/users/9317994/jwats"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1518560511, "post_id": 48668421, "comment_id": 84555010, "body": "Shown below as user9335726. Somehow accidentally created a second profile. Awaiting feedback from site to merge."}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 1, "last_activity_date": 1518020813, "creation_date": 1518020813, "answer_id": 48668674, "question_id": 48668421, "link": "https://stackoverflow.com/questions/48668421/eliminate-duplicates-within-a-range-then-move-the-non-blank-cells-to-top-of-same/48668674#48668674", "title": "Eliminate duplicates within a range then move the non-blank cells to top of same range, without shifting cells outside the range", "body": "<p>How about something like below, it will remove duplicates and loop through F3 to F18 and if it finds a blank row, it will delete and shift up, but then it will insert a blank row at the bottom, thus leaving your data below the range intact.</p>\n\n<p>Simply adjust the code below with your value from edVal:</p>\n\n<pre><code>Sub foo()\nDim ws As Worksheet: Set ws = Worksheets(\"Sheet1\")\n\nws.Range(\"$F$3:$H$18\").RemoveDuplicates Columns:=Array(1, 2, 3), Header:=xlNo\n\nFor i = 3 To 18\nIf ws.Cells(i, \"F\").Value = \"\" Then\n    ws.Range(\"F\" &amp; i &amp; \":H\" &amp; i).Delete Shift:=xlUp\n    ws.Range(\"F18:H18\").Insert Shift:=xlDown\nEnd If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 9317994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f6d91aa8bb0676aef1a88d34b2a9043?s=128&d=identicon&r=PG", "display_name": "jwats", "link": "https://stackoverflow.com/users/9317994/jwats"}, "is_accepted": false, "score": 0, "last_activity_date": 1518129298, "creation_date": 1518129298, "answer_id": 48695895, "question_id": 48668421, "link": "https://stackoverflow.com/questions/48668421/eliminate-duplicates-within-a-range-then-move-the-non-blank-cells-to-top-of-same/48695895#48695895", "title": "Eliminate duplicates within a range then move the non-blank cells to top of same range, without shifting cells outside the range", "body": "<p>Adjusting the values for edVal worked as suggested. That code is between the \"With edVal / End With\" lines. Also shown, as requested by the moderator, is the code I already had.</p>\n\n<pre><code>Sub foo()\nDim empRange as Range, edVal as Range\nDim f as Integer, l as Integer\n\nSet empRange = Range(\"A3:Z18\")   'rows 1 and 2 are headers\n  With empRange\n    f = empRange.Row\n    l = empRange.Rows.Count\n    Set edVal = Range(.Cells(, 6), .Cells(l, 8))  'edVal is columns F-H of the larger empRange\n    With edVal\n      .RemoveDuplicates Columns:=Array(1, 2, 3), HEADER:=xlNo\n      For i = f To l + 2     'adding 2 to account for two header rows\n        If Range(\"F\" &amp; i).Value = \"\" Then\n          Range(\"F\" &amp; i &amp; \":\" &amp; \"H\" &amp; i).Delete Shift:=xlUp\n          Range(\"F\" &amp; l + 2 &amp; \":\" &amp; \"H\" &amp; l + 2).Insert Shift:=xlDown\n        End If\n      Next I\n    End With\n  End With                    \nEnd Sub  \n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9317994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f6d91aa8bb0676aef1a88d34b2a9043?s=128&d=identicon&r=PG", "display_name": "jwats", "link": "https://stackoverflow.com/users/9317994/jwats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518129298, "creation_date": 1518020080, "last_edit_date": 1531164843, "question_id": 48668421, "link": "https://stackoverflow.com/questions/48668421/eliminate-duplicates-within-a-range-then-move-the-non-blank-cells-to-top-of-same", "title": "Eliminate duplicates within a range then move the non-blank cells to top of same range, without shifting cells outside the range", "body": "<p>The <a href=\"https://i.stack.imgur.com/GxFNr.png\" rel=\"nofollow noreferrer\">Before</a> image represents educational background that an employee has reported. As you can see, the report that produces the info creates unwanted duplicates and spaces. Can't do anything about that. The <a href=\"https://i.stack.imgur.com/py3tr.png\" rel=\"nofollow noreferrer\">After</a> image shows my desired end result. To get there, I manually:</p>\n\n<ol>\n<li>Deleted the duplicates</li>\n<li>Copy/pasted the remaining occupied cells to the top of the range <strong>without shifting</strong> any cells below the range. (Yes, there is data below the range).</li>\n</ol>\n\n<p>How do I automate this with VBA? The <a href=\"https://i.stack.imgur.com/GxFNr.png\" rel=\"nofollow noreferrer\">Before</a> image represents the range F3:H18 and I've named the range <strong>edVal</strong>.</p>\n\n<p>This range will always be 3 columns (F-H). The number of rows will vary but I already have code that selects edVal, no matter how many rows it may be.</p>\n\n<p>I have other code doing other stuff elsewhere in the sheet but then I come to this education portion. Assume I've dim'd edVal as Range and edVal is selected. Seems the additional code I need will fit between \"With edVal\" and End With.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "function", "datetime", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518020413, "post_id": 48668331, "comment_id": 84334834, "body": "Please give an example of how you are calling the function. You are trying to do a numerical comparison on a string."}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518020727, "post_id": 48668331, "comment_id": 84335050, "body": "the lookup value is in serial form, and the dates should be serial too. They are just formatted to the M/DD/YYYY"}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518020811, "post_id": 48668331, "comment_id": 84335110, "body": "Are you saying the the serial numbers are strings, so you cant use a &gt; or &lt; on them?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518020896, "post_id": 48668331, "comment_id": 84335162, "body": "A date is just a number in Excel. How can it interpret <code>If rng &lt;= eventdate</code>?"}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518021378, "post_id": 48668331, "comment_id": 84335508, "body": "Eventdate is a serial number of a date, so it should just be a number too"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518021596, "post_id": 48668331, "comment_id": 84335655, "body": "<code>eventdate As String</code>"}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518021755, "post_id": 48668331, "comment_id": 84335768, "body": "Oh wow.... so long?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518022537, "post_id": 48668331, "comment_id": 84336284, "body": "Or Date? Also you don&#39;t want a nested loop. You want to cycle through the start date only and check the corresponding cell to the right."}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518022725, "post_id": 48668331, "comment_id": 84336398, "body": "Got it.  So I can get rid of endrng as an input and then for the second criteria just use rnge.Offset(0, 1)?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518022845, "post_id": 48668331, "comment_id": 84336486, "body": "Yes, I have suggested an answer below which also avoids duplicates."}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518020949, "post_id": 48668568, "comment_id": 84335194, "body": "I don&#39;t think it will because value is the default property of the range object so that you don&#39;t need to specify it (here at least), although it is good practice to do so."}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "edited": false, "score": 0, "creation_date": 1518021559, "post_id": 48668568, "comment_id": 84335629, "body": "Yea I keep getting an na with this. Not sure if i have the Next End If Next     wrong at the end or something"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1518022125, "post_id": 48668568, "comment_id": 84336021, "body": "SRJ, you&#39;re right, I had a bit more time to look into it, the problem is eventdate being a string."}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 0, "last_activity_date": 1518020547, "creation_date": 1518020547, "answer_id": 48668568, "question_id": 48668331, "link": "https://stackoverflow.com/questions/48668331/function-to-return-all-events-in-a-certain-date/48668568#48668568", "title": "Function to return all events in a certain date", "body": "<p>You need to use the Range.Value, not the range itself.</p>\n\n<p>(This is untested, but I thnk the change will make it work)</p>\n\n<pre><code>For Each rng In startrng\n    If rng.value &lt;= eventdate Then\n        For Each rng2 In endrng\n          If rng2.value &gt;= eventdate Then\n        xResult = xResult &amp; \",\" &amp; rng2.Offset(0, pIndex - 1)\n        End If\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "edited": false, "score": 0, "creation_date": 1518023695, "post_id": 48669294, "comment_id": 84337037, "body": "thanks, can you walk me through the use of the create object line and this line   d.Item(rng.Offset(0, pIndex - 1)) = 1?  I am assuming it stores values in the created &quot;scripting.dictionary&quot; object and then you join them all at the end?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "edited": false, "score": 0, "creation_date": 1518023861, "post_id": 48669294, "comment_id": 84337145, "body": "Read eg <a href=\"https://excelmacromastery.com/vba-dictionary/\" rel=\"nofollow noreferrer\">excelmacromastery.com/vba-dictionary</a> for a guide to dictionaries. They&#39;re a bit like arrays or collections in that you can store data (as key/item pairs), and you can if values already exist. Here the event is added as a key when the requirements are met and the result outputs the keys as a string separated by commas."}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "edited": false, "score": 0, "creation_date": 1518024425, "post_id": 48669294, "comment_id": 84337457, "body": "and you can if values already exist----   is this supposed to be can&#39;t*?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "edited": false, "score": 0, "creation_date": 1518024775, "post_id": 48669294, "comment_id": 84337665, "body": "Should have read &quot;can check if values already exist&quot;, although in the way I have used it above it will automatically overwrite. Without this you could end up with e.g. &quot;Event1, Event2, Event1&quot;"}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "edited": false, "score": 0, "creation_date": 1518027741, "post_id": 48669294, "comment_id": 84339413, "body": "whats does the = 1 at the end do, remove the dupes?"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1518022692, "creation_date": 1518022692, "answer_id": 48669294, "question_id": 48668331, "link": "https://stackoverflow.com/questions/48668331/function-to-return-all-events-in-a-certain-date/48669294#48669294", "title": "Function to return all events in a certain date", "body": "<p>Here's a suggestion, called, e.g. =DateEventLookup(DATE(2018,1,5),A2:A4,B2:B4,3) You'll have to fiddle with the arguments as don't know how your data are laid out.</p>\n\n<pre><code>Function DateEventLookup(eventdate As Date, startrng As Range, endrng As Range, pIndex As Long)\n\n' eventdate is the lookup , startrng is the first array, endrng is the second array, pindex is the column to return\n\nDim rng As Range\nDim d As Object\n\nSet d = CreateObject(\"Scripting.Dictionary\")\n\nFor Each rng In startrng\n    If rng &lt;= eventdate Then\n        If rng.Offset(, 1) &gt;= eventdate Then\n            d.Item(rng.Offset(0, pIndex - 1)) = 1\n        End If\n    End If\nNext\n\nDateEventLookup = Join(d.keys, \",\")\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "edited": false, "score": 0, "creation_date": 1518051270, "post_id": 48669298, "comment_id": 84350041, "body": "is there a way to remove dupes?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "edited": false, "score": 0, "creation_date": 1518052253, "post_id": 48669298, "comment_id": 84350314, "body": "@RPr  I don&#39;t see any dups?"}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "edited": false, "score": 0, "creation_date": 1518097592, "post_id": 48669298, "comment_id": 84371587, "body": "sorry in the data I have there are a few that over lap date wise and have the same name I am trying the scriping.dictionary, but it doesnt seem to be working"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1518022699, "creation_date": 1518022699, "answer_id": 48669298, "question_id": 48668331, "link": "https://stackoverflow.com/questions/48668331/function-to-return-all-events-in-a-certain-date/48669298#48669298", "title": "Function to return all events in a certain date", "body": "<p>Here is a very simple alternative:</p>\n\n<pre><code>Public Function EventList(starts As Range, ends As Range, events As Range, d As Date) As String\n    Dim N As Long, i As Long\n    N = Cells(Rows.Count, starts.Column).End(xlUp).Row\n\n    For i = 1 To N\n        If CDate(starts(i)) &lt;= d And CDate(ends(i)) &gt;= d Then EventList = EventList &amp; \"; \" &amp; events(i)\n    Next i\n    EventList = Mid(EventList, 2)\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/m1Ft1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m1Ft1.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 48669298, "answer_count": 3, "score": 1, "last_activity_date": 1518028782, "creation_date": 1518019748, "last_edit_date": 1531161705, "question_id": 48668331, "link": "https://stackoverflow.com/questions/48668331/function-to-return-all-events-in-a-certain-date", "title": "Function to return all events in a certain date", "body": "<p>I have a table that has a start date, end date, and then event name</p>\n\n<p>I would like to be able to look up a date and see if it falls between the start and end date and then pull in all the event names that meet those criteria</p>\n\n<p>For example</p>\n\n<pre><code>start   end    name\n1/1     1/7    Event1\n1/5     1/8    Event2\n1/6     1/6    Event3\n</code></pre>\n\n<p>If i wanted a date of 1/5,  the return value would be <strong>Event1; Event2</strong></p>\n\n<pre><code>Function DateEventLookup(eventdate As Long, startrng As Range, endrng As Range, pIndex As Long)\n\n' eventdate is the lookup , startrng is the first array, endrng is the second array, pindex is the column to return\n\nDim rng As Range\nDim rng2 As Range\nDim xResult As String\n\n\nxResult = \"\"\nFor Each rng In startrng\n    If rng.Value &lt;= eventdate Then\n        For Each rng2 In endrng\n          If rng2.Value &gt;= eventdate Then\n        xResult = xResult &amp; \",\" &amp; rng2.Offset(0, pIndex - 1)\n        End If\nNext\nEnd If\nNext\n\n\nDateEventLookup = xResult\nEnd Function\n</code></pre>\n\n<p>I keep getting N/A# so i am not sure how to correct this with the second criteria</p>\n\n<p>EDIT #1</p>\n\n<p>I took a combo of two answers. However I am still getting dupes</p>\n\n<pre><code>Public Function EventList(starts As Range, ends As Range, events As Range, d As Date) As String\n    Dim N As Long\n    Dim i As Long\n    Dim P As Object\n    Set P = CreateObject(\"Scripting.Dictionary\")\n\n\n    N = Cells(Rows.Count, starts.Column).End(xlUp).Row\n\n    For i = 1 To N\n        If CDate(starts(i)) &lt;= d And CDate(ends(i)) &gt;= d Then P.Item(events(i)) = 1\n\n\n        'EventList = EventList &amp; \"; \" &amp; events(i)\n    Next i\n    EventList = Join(P.keys, \", \")\n\nEnd Function\n</code></pre>\n\n<p>Not sure how to fix this I tried adding in a</p>\n\n<p>If NOT p.exists(events(i)) then ADD</p>\n\n<p>but I am getting an N/A# now</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 4, "creation_date": 1518019564, "post_id": 48668170, "comment_id": 84334244, "body": "You really need to learn how to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using <code>.Select</code></a>."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1518019594, "post_id": 48668170, "comment_id": 84334269, "body": "What @K.D\u1d00\u1d20\u026as says, plus <code>End(xlup)</code> and &#39;End(xldown)`."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518020270, "post_id": 48668356, "comment_id": 84334746, "body": "IMO there&#39;s no reason not to use Copy. it only &quot;clashes&quot; with a function of a Range object so the syntax for calling either are completely different. I never get why people are unsure about using variable names like <code>row</code> when it&#39;s often the best description of what the variable actually represents! I would add that names of subs should be capitalised though. Not least because otherwise, in this example, you end up with intellisense making <code>Range.Copy</code> =&gt; <code>Range.copy</code> (note the lowercase c)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1669649"}, "edited": false, "score": 0, "creation_date": 1518020435, "post_id": 48668356, "comment_id": 84334853, "body": "I&#39;m getting a compilation issue on the while statement. This is definitely the way forward though. Thank you very much"}], "tags": [], "owner": {"reputation": 363, "user_id": 9328115, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213268517001319/picture?type=large", "display_name": "Yuri Molodyko", "link": "https://stackoverflow.com/users/9328115/yuri-molodyko"}, "is_accepted": false, "score": 2, "last_activity_date": 1518020651, "last_edit_date": 1518020651, "creation_date": 1518019864, "answer_id": 48668356, "question_id": 48668170, "link": "https://stackoverflow.com/questions/48668170/selecting-rows-until-empty-cell/48668356#48668356", "title": "Selecting rows until empty cell", "body": "<pre><code>sub copy_to_overview()\n\n    currentRow = 1\n\n    while (notempty(cell(currentrow))\n\n      currentrow.copy\n\n      sheet(\"overwiev\").currentrow.paste\n      currentrow = currentrow + 1\n\n    wend\n\nend sub\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1669649"}, "edited": false, "score": 0, "creation_date": 1518020774, "post_id": 48668436, "comment_id": 84335081, "body": "Thank you very much! This does exactly what I needed it to do"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1669649"}, "edited": false, "score": 0, "creation_date": 1518020928, "post_id": 48668436, "comment_id": 84335183, "body": "Edited the Range to <code>&quot;A2:G&quot;</code> as the first row of each sheet already contains the headers, and it is doing exactly what I had hoped for."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 2, "last_activity_date": 1518020117, "creation_date": 1518020117, "answer_id": 48668436, "question_id": 48668170, "link": "https://stackoverflow.com/questions/48668170/selecting-rows-until-empty-cell/48668436#48668436", "title": "Selecting rows until empty cell", "body": "<p>You can loop through the sheets, and it will skip over \"OVERVIEW\"</p>\n\n<pre><code>Sub Button1_Click()\n    Dim ws As Worksheet, sh As Worksheet, LstRw As Long\n    Set ws = Sheets(\"OVERVIEW\")\n    For Each sh In Sheets\n        If sh.Name &lt;&gt; ws.Name Then\n            With sh\n            LstRw = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n                .Range(\"A1:G\" &amp; LstRw).Copy\n                ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Offset(1).PasteSpecial xlPasteValues\n            End With\n        End If\n    Next sh\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1669649"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 48668436, "answer_count": 2, "score": 2, "last_activity_date": 1518110817, "creation_date": 1518019280, "last_edit_date": 1518110817, "question_id": 48668170, "link": "https://stackoverflow.com/questions/48668170/selecting-rows-until-empty-cell", "title": "Selecting rows until empty cell", "body": "<p>I am attempting to create a macro that will pull data from several sheets and display them in an 'OVERVIEW' sheet.</p>\n\n<p>At the moment I have the following:</p>\n\n<pre><code>Sheets(\"Sheet1).Select\nActiveCell.Range(\"A1:G7\").Select\nSELECTION.Copy\nSheets(\"OVERVIEW\").Select\nActiveCell.Select\nActiveSheet.Paste\nSheets(\"Sheet2\").Select\nActiveCell.Range(\"A1:G7\").Select\nApplication.CutCopyMode = False\nSELECTION.Copy\nSheets(\"OVERVIEW\").Select\nActiveCell.Offset(7, 0).Range(\"A1\").Select\nActiveSheet.Paste\nSheets(\"Sheet3\").Select\nActiveCell.Range(\"A1:G2\").Select\nApplication.CutCopyMode = False\nSELECTION.Copy\nSheets(\"OVERVIEW\").Select\nActiveCell.Offset(7, 0).Range(\"A1\").Select\nActiveSheet.Paste\nActiveWindow.SmallScroll Down:=-12\nActiveCell.Columns(\"A:A\").EntireColumn.EntireColumn.AutoFit\nActiveCell.Offset(0, 1).Columns(\"A:A\").EntireColumn.Select\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>Unfortunately, this currently only copies the data from the first sheet. I would much rather have something along the lines of the following pseudo code</p>\n\n<pre><code>sub COPY1()\nSelection = []\ncurentRow = 1\nwhile(notEmpty(cell(AcurentRow)))\n    Selection.add(curentRow)\n    curentRow++\nreturn Selection\nEnd Sub\n\nsub PASTE1(selection)\ncurentRow=1\nwhile(notEmpty(cell(AcurentRow)))\n    curentRow++\n\npaste(selection)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "email", "merge"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1518026838, "post_id": 48668119, "comment_id": 84338894, "body": "What&#39;s the text of the error? Please show us how you declare and instantiate wdocSource. Why have you dropped parameters from the original code? Why have you changed the Connection string?"}, {"owner": {"reputation": 1, "user_id": 6562607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025f9bf82486123fd6d98291c02e1a8d?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisV", "link": "https://stackoverflow.com/users/6562607/chrisv"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1518062360, "post_id": 48668119, "comment_id": 84352680, "body": "Thanks for replying Cindy. I&#39;ve edited the original post to show the entire code. The text of the error is &quot;Command Failed&quot;. I am not strong with code editing, I am trying to adapt a sample I found online to fit my application. Any suggestions you can provide are appreciated!"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1518072728, "post_id": 48668119, "comment_id": 84355765, "body": "Mmm... too much, now :-) Please take the time to trim this down to the minimal code it takes to reproduce the problem, with a full description of how to set things up, so that we can test efficiently. And also include which line of code is causing the error. Glancing through I can see a number of potential problems... We&#39;re happy to help, but our time isn&#39;t unlimited :-)"}, {"owner": {"reputation": 1, "user_id": 6562607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025f9bf82486123fd6d98291c02e1a8d?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisV", "link": "https://stackoverflow.com/users/6562607/chrisv"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1518191314, "post_id": 48668119, "comment_id": 84417725, "body": "My apologies - I am not a scripting expert, I am mostly taking existing script and trying to revise it to meet our requirements. The line of script that is causing the issue is this one - &quot;wdocSource.MailMerge.CreateDataSource&quot;. It is producing a &quot;Run-time error &#39;448&#39;: Named argument not found&quot; error."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6562607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025f9bf82486123fd6d98291c02e1a8d?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisV", "link": "https://stackoverflow.com/users/6562607/chrisv"}, "edited": false, "score": 0, "creation_date": 1518190917, "post_id": 48679940, "comment_id": 84417470, "body": "I tried updating the script as you suggested and running it again. It is producing a &quot;Run-time error &#39;448&#39;: Named argument not found&quot;. The revised script is posted above in my original post above. i appreciate the help!"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 1, "user_id": 6562607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025f9bf82486123fd6d98291c02e1a8d?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisV", "link": "https://stackoverflow.com/users/6562607/chrisv"}, "edited": false, "score": 0, "creation_date": 1518191247, "post_id": 48679940, "comment_id": 84417685, "body": "<code>For i = 1 To ThisDocument.MailMerge.DataSource.RecordCount</code> change <code>ThisDocument</code> to <code>wdocSource</code>. Add <code>Option Explicit</code> on the very top of the module and compile. It will highlight such errors."}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1518075210, "creation_date": 1518075210, "answer_id": 48679940, "question_id": 48668119, "link": "https://stackoverflow.com/questions/48668119/converting-wordexcel-mail-merge-to-an-excelword-merge/48679940#48679940", "title": "Converting Word&gt;Excel mail merge to an Excel&gt;Word merge", "body": "<p>When you open a Word document or attach a Template through VBA, the mail merge data source (if any) is not attached to the document for security reasons. </p>\n\n<p>Try replacing:</p>\n\n<pre><code>wdocSource.MailMerge.OpenDataSource(...)\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>wdocSource.MailMerge.CreateDataSource(...)\n</code></pre>\n\n<p>using the same method parameters but do not set the <code>Connection</code> parameter as it will be created for you.</p>\n\n<pre><code>wdocSource.MailMerge.CreateDataSource _\n                     Name:=strWorkbookName, _\n                     SQLStatement:=\"SELECT * FROM `REF_LTR$`\", _ \n                     SubType:= wdMergeSubTypeAccess\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6562607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025f9bf82486123fd6d98291c02e1a8d?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisV", "link": "https://stackoverflow.com/users/6562607/chrisv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 404, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518190861, "creation_date": 1518019129, "last_edit_date": 1518190861, "question_id": 48668119, "link": "https://stackoverflow.com/questions/48668119/converting-wordexcel-mail-merge-to-an-excelword-merge", "title": "Converting Word&gt;Excel mail merge to an Excel&gt;Word merge", "body": "<p>Good morning,</p>\n\n<p>I have an Excel document that is set up to complete a mail merge. Previously, a ran a script from within the MS Word mail merge template to call the Excel file, connect to it, and pull in the data. I recently found a code example that suggested embedding the code within the Excel document and pointing it to the Word template. This seems to make a lot more sense given my workflow.</p>\n\n<p>This snippet worked within MS Word to reach out and connect to the Excel workbook:</p>\n\n<pre><code>ThisDocument.MailMerge.OpenDataSource Name:= _\n    ThisDocument.Path &amp; \"\\\" &amp; \"REF 1.23.18.xlsm\", ConfirmConversions:=False, _\n    ReadOnly:=False, LinkToSource:=True, AddToRecentFiles:=False, _\n    PasswordDocument:=\"\", PasswordTemplate:=\"\", WritePasswordDocument:=\"\", _\n    WritePasswordTemplate:=\"\", Revert:=False, Format:=wdOpenFormatAuto, _\n    Connection:= _\n    \"Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;Data Source=reflist.xlsm;Mode=Read;Extended Properties=\"\"HDR=YES;IMEX=1;\"\";Jet OLEDB:System database=\"\"\"\";Jet OLEDB:Registry Path=\"\"\"\";Jet OLEDB:Engine Type=37;Jet OLEDB:Database Locking \" _\n    , SQLStatement:=\"SELECT * FROM `REF_LTR$`\", SQLStatement1:=\"\", SubType:= _\n    wdMergeSubTypeAccess\n</code></pre>\n\n<p>However, when I move the script over into MS Excel to try and connect to the Word template from Excel, this script is failing with a \"run time error 4198 - Command Failed\":</p>\n\n<pre><code>    wdocSource.MailMerge.OpenDataSource _\n        Name:=strWorkbookName, _\n        ConfirmConversions:=False, _\n        AddToRecentFiles:=False, _\n        Revert:=False, _\n        Format:=wdOpenFormatAuto, _\n        Connection:=\"Data Source=\" &amp; strWorkbookName &amp; \";Mode=Read\", _\n        SQLStatement:=\"SELECT * FROM `REF_LTR$`\", SQLStatement1:=\"\", SubType:= _\n    wdMergeSubTypeAccess\n</code></pre>\n\n<p>Any suggestions on what my second block of code is missing?</p>\n\n<p>Here is the entire script for reference:</p>\n\n<pre><code>Sub test()\n\n' Delete the first 8 rows which contain the header data\n    On Error Resume Next\n    Rows(\"1:8\").Select\n    Selection.Delete Shift:=xlUp\n\n' Delete the empty spaces in column A, Name\n    Columns(\"A:A\").Select\n    Selection.Replace What:=\"                    \", Replacement:=\"\", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\n\n' Delete the empty spaces in column B, MRN\n    Columns(\"B:B\").Select\n    Selection.Replace What:=\" \", Replacement:=\"\", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\n\n' Delete the empty spaces in columns D and E, format them as dates\n    Columns(\"D:E\").Select\n    Selection.Replace What:=\" \", Replacement:=\"\", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\n    Selection.NumberFormat = \"m/d/yyyy\"\n\n' Delete the empty spaces in columns F and G\n    Columns(\"F:G\").Select\n    Selection.Replace What:=\" \", Replacement:=\"\", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\n\n' Format AdmitTime as military time\n    Columns(\"F:F\").Select\n    Application.CutCopyMode = False\n    Selection.NumberFormat = \"h:mm;@\"\n    Selection.NumberFormat = \"hhmm\"\n\n' Delete any rows that don't have a name in column A\n    Columns(\"A\").SpecialCells(xlBlanks).EntireRow.Delete\n\n' Add the column titles\n    Rows(\"1:1\").Select\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Rows(\"1:1\").Select\n    Selection.Font.Bold = True\n    Selection.Font.Underline = xlUnderlineStyleSingle\n    Range(\"A1\").Select\n    ActiveCell.FormulaR1C1 = \"Name\"\n    Range(\"B1\").Select\n    ActiveCell.FormulaR1C1 = \"MRN\"\n    Range(\"C1\").Select\n    ActiveCell.FormulaR1C1 = \"Sex\"\n    Range(\"D1\").Select\n    ActiveCell.FormulaR1C1 = \"DOB\"\n    Range(\"E1\").Select\n    ActiveCell.FormulaR1C1 = \"AdmitDate\"\n    Range(\"F1\").Select\n    ActiveCell.FormulaR1C1 = \"AdmitTime\"\n    Range(\"G1\").Select\n    ActiveCell.FormulaR1C1 = \"Category\"\n    Range(\"H1\").Select\n    ActiveCell.FormulaR1C1 = \"ReferHospital\"\n    Range(\"I1\").Select\n    ActiveCell.FormulaR1C1 = \"Complaint\"\n    Range(\"J1\").Select\n    ActiveCell.FormulaR1C1 = \"Description\"\n    Range(\"K1\").Select\n    ActiveCell.FormulaR1C1 = \"Unit\"\n    Range(\"L1\").Select\n    ActiveCell.FormulaR1C1 = \"Disposition\"\n    Range(\"M1\").Select\n    ActiveCell.FormulaR1C1 = \"LOS\"\n    Range(\"N1\").Select\n    ActiveCell.FormulaR1C1 = \"ICD10\"\n    Range(\"O1\").Select\n    ActiveCell.FormulaR1C1 = \"AdmitYear\"\n    Range(\"P1\").Select\n    ActiveCell.FormulaR1C1 = \"AdmitMonth\"\n    Range(\"Q1\").Select\n    ActiveCell.FormulaR1C1 = \"AdmitDay\"\n    Range(\"R1\").Select\n    ActiveCell.FormulaR1C1 = \"GenderPronoun\"\n    Range(\"A2\").Select\n\n' Add the helper columns to pull in the admityear, admitmonth, admitday, and genderpronoun\n    Range(\"O2\").Select\n    ActiveCell.FormulaR1C1 = \"=IF(RC[-14]=\"\"\"\",\"\"\"\",TEXT(RC[-10],\"\"yyyy\"\"))\"\n    Range(\"O2\").Select\n    ActiveCell.FormulaR1C1 = \"=IF(RC[-14]=\"\"\"\",\"\"\"\",TEXT(RC[-10],\"\"yyyy\"\"))\"\n    Range(\"P2\").Select\n    ActiveCell.FormulaR1C1 = \"=IF(RC[-15]=\"\"\"\",\"\"\"\",TEXT(RC[-11],\"\"mm\"\"))\"\n    Range(\"Q2\").Select\n    ActiveCell.FormulaR1C1 = \"=IF(RC[-16]=\"\"\"\",\"\"\"\",TEXT(RC[-12],\"\"dd\"\"))\"\n    Range(\"R2\").Select\n    ActiveCell.FormulaR1C1 = \"=IF(RC[-17]=\"\"\"\",\"\"\"\",IF(RC[-15]=\"\"M\"\",\"\"his\"\",\"\"her\"\"))\"\n    Range(\"O2:R2\").Select\n    Selection.Copy\n    Range(\"O3:R50\").Select\n    ActiveSheet.Paste\n\n\n' Find and replace hospital names\n    Columns(\"H:H\").Select\n    Selection.Replace What:=\" \", Replacement:=\"\", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\n\n' Fort Hamilton Hospital\n    Columns(\"H:H\").Select\n        Cells.Replace What:=\"FortHamilton-HughesMemorialHospital(\", Replacement _\n        :=\"Fort Hamilton Hospital\", LookAt:=xlPart, SearchOrder:=xlByRows _\n        , MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n' Grandview\n    Columns(\"H:H\").Select\n        Cells.Replace What:=\"GrandviewHospital(OHMontgomery)\", Replacement _\n        :=\"Grandview Medical Center\", LookAt:=xlPart, SearchOrder:=xlByRows _\n        , MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n' Greene Memorial Hospital\n    Columns(\"H:H\").Select\n        Cells.Replace What:=\"GreeneMemorialHospital(OHGreene)\", Replacement _\n        :=\"Greene Memorial Hospital\", LookAt:=xlPart, SearchOrder:=xlByRows _\n        , MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n' Kettering Health Network - Franklin\n    Columns(\"H:H\").Select\n        Cells.Replace What:=\"FRANKLINSPRINGBOROED\", Replacement _\n        :=\"Kettering Health Network - Franklin\", LookAt:=xlPart, SearchOrder:=xlByRows _\n        , MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n' Kettering Health Network - Huber\n    Columns(\"H:H\").Select\n        Cells.Replace What:=\"HuberHeightsED\", Replacement _\n        :=\"Kettering Health Network - Huber\", LookAt:=xlPart, SearchOrder:=xlByRows _\n        , MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n' Kettering Health Netowrk - Preble\n    Columns(\"H:H\").Select\n        Cells.Replace What:=\"PrebleCoED\", Replacement _\n        :=\"Kettering Health Network - Preble\", LookAt:=xlPart, SearchOrder:=xlByRows _\n        , MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n' McCullough-Hyde Memorial Hospital\n    Columns(\"H:H\").Select\n        Cells.Replace What:=\"McCullough-HydeMemorialHospital(OH\", Replacement _\n        :=\"McCullough-Hyde Memorial Hospital\", LookAt:=xlPart, SearchOrder:=xlByRows _\n        , MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n' Mercer County Community Hospital\n    Columns(\"H:H\").Select\n        Cells.Replace What:=\"MercerCountyJointTwp.CommunityHospi\", Replacement _\n        :=\"Mercer County Community Hospital\", LookAt:=xlPart, SearchOrder:=xlByRows _\n        , MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n' Soin Medical Center\n    Columns(\"H:H\").Select\n        Cells.Replace What:=\"SoinMedicalCenter\", Replacement _\n        :=\"Soin Medical Center\", LookAt:=xlPart, SearchOrder:=xlByRows _\n        , MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n' Southview Medical Center\n    Columns(\"H:H\").Select\n        Cells.Replace What:=\"SouthviewHospital&amp;FamilyHealthCente\", Replacement _\n        :=\"Southview Medical Center\", LookAt:=xlPart, SearchOrder:=xlByRows _\n        , MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n' Springfield Regional Medical Center\n    Columns(\"H:H\").Select\n        Cells.Replace What:=\"CommunityHospitalofSpringfield(OHCl\", Replacement _\n        :=\"Springfield Regional Medical Center\", LookAt:=xlPart, SearchOrder:=xlByRows _\n        , MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n    Columns(\"H:H\").Select\n        Cells.Replace What:=\"SpringfieldRegionalHosptial\", Replacement _\n        :=\"Springfield Regional Medical Center\", LookAt:=xlPart, SearchOrder:=xlByRows _\n        , MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n' Sycamore Medical Center\n    Columns(\"H:H\").Select\n        Cells.Replace What:=\"SycamoreHospital(OHMontgomery)\", Replacement _\n        :=\"Sycamore Medical Center\", LookAt:=xlPart, SearchOrder:=xlByRows _\n        , MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n' Upper Valley Medical Center\n    Columns(\"H:H\").Select\n        Cells.Replace What:=\"UpperValleyMedicalCenter\", Replacement _\n        :=\"Upper Valley Medical Center\", LookAt:=xlPart, SearchOrder:=xlByRows _\n        , MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n' Wilson Memorial Hospital\n    Columns(\"H:H\").Select\n        Cells.Replace What:=\"WilsonHospital(OHShelby)\", Replacement _\n        :=\"Wilson Memorial Hospital\", LookAt:=xlPart, SearchOrder:=xlByRows _\n        , MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n' Select A1 cell\n    Range(\"A1\").Select\n\n' This macro does the following:\n' Runs a mail merge and pulls fields to create follow-up letter drafts\n' Creates individual Word documents and then saves them in the appropriate folder for the hospital name\n'\n    Dim Name  As String\n    Dim MRN  As String\n    Dim Sex  As String\n    Dim DOB  As String\n    Dim AdmitDate  As String\n    Dim AdmitTime  As String\n    Dim Category  As String\n    Dim ReferHospital  As String\n    Dim Complaint  As String\n    Dim Description  As String\n    Dim Unit  As String\n    Dim Disposition  As String\n    Dim LOS  As String\n    Dim ICD10  As String\n    Dim AdmitYear  As String\n    Dim AdmitMonth  As String\n    Dim AdmitDay  As String\n    Dim GenderPronoun  As String\n    Dim wd As Object\n    Dim wdocSource As Object\n    Dim strWorkbookName As String\n\n'Check to see if the folder exists, and if not, create it\n    Dim fdObj As Object\n    Set fdObj = CreateObject(\"Scripting.FileSystemObject\")\n    If fdObj.FolderExists(ThisDocument.Path &amp; ReferHospital) Then\n    Else\n        fdObj.CreateFolder (ThisDocument.Path &amp; ReferHospital)\n    End If\n\n' NEW!!!!\n' Connect to the sign-in spreadsheet which is the data source\n    On Error Resume Next\n    Set wd = GetObject(, \"Word.Application\")\n    If wd Is Nothing Then\n        Set wd = CreateObject(\"Word.Application\")\n    End If\n    On Error GoTo 0\n\n    Set wdocSource = wd.Documents.Open(\"C:\\Users\\k113997\\Desktop\\1macrotest\\Trauma Referral Template.docm\")\n\n    strWorkbookName = ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name\n\n    wdocSource.MailMerge.MainDocumentType = wdFormLetters\n\n    wdocSource.MailMerge.CreateDataSource _\n             Name:=strWorkbookName, _\n             SQLStatement:=\"SELECT * FROM `REF_LTR$`\", _\n             SubType:=wdMergeSubTypeAccess\n\n\n' Obtaines the number of records from the mail merge\n    For i = 1 To ThisDocument.MailMerge.DataSource.RecordCount\n\n' Counts the lines in the excel file\n    With wdocSource.MailMerge\n            .Destination = wdSendToNewDocument\n            .SuppressBlankLines = True\n            With .DataSource\n                .FirstRecord = i\n                .LastRecord = i\n                .ActiveRecord = i\n\n' Ignore any records where Name is blank, as in empty data fields\n    If Trim(.DataFields(\"Name\")) = \"\" Then Exit For\n\n' Pull in the datafields from the sign-in spreadsheet\n        Name = .DataFields(\"Name\").Value\n        MRN = .DataFields(\"MRN\").Value\n        Sex = .DataFields(\"Sex\").Value\n        DOB = .DataFields(\"DOB\").Value\n        AdmitDate = .DataFields(\"AdmitDate\").Value\n        AdmitTime = .DataFields(\"AdmitTime\").Value\n        Category = .DataFields(\"Category\").Value\n        ReferHospital = .DataFields(\"ReferHospital\").Value\n        Complaint = .DataFields(\"Complaint\").Value\n        Description = .DataFields(\"Description\").Value\n        Unit = .DataFields(\"Unit\").Value\n        Disposition = .DataFields(\"Disposition\").Value\n        LOS = .DataFields(\"LOS\").Value\n        ICD10 = .DataFields(\"ICD10\").Value\n        AdmitYear = .DataFields(\"AdmitYear\").Value\n        AdmitMonth = .DataFields(\"AdmitMonth\").Value\n        AdmitDay = .DataFields(\"AdmitDay\").Value\n        GenderPronoun = .DataFields(\"GenderPronoun\").Value\n        End With\n\n' Execute the mail merge\n    .Execute Pause:=False\n    End With\n\n\n' Set the directory path for the output files to be the same as the directory for this document\ndocpath = ThisDocument.Path &amp; \"\\\" &amp; ReferHospital\n\n' Set the document naming convention with the course year, course month, course day, department, and course name\ndocname = AdmitYear + \"-\" + AdmitMonth + \"-\" + AdmitDay + \" \" + MRN\n\n' Check and make sure that docname does not have any special characters that will mess up the filename, and if found, remove them\ndocnameclean = Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(docname, \"&lt;\", \"\"), \"&gt;\", \"\"), \":\", \"\"), \"/\", \"\"), \"\\\", \"\"), \"?\", \"\"), \"&amp;\", \"\"), \"*\", \"\"), \",\", \"\"), \".\", \"\")\n\n' Change the focus to the active directory where the files are stored\n    ChDrive ActiveDocument.Path\n'    ChangeFileOpenDirectory _\n'        \".\\\"\n\n    ActiveDocument.SaveAs2 Filename:=docpath &amp; \"\\\" &amp; docnameclean + \".docx\", _\n        FileFormat:=wdFormatXMLDocument, LockComments:=False, Password:=\"\", _\n        AddToRecentFiles:=True, WritePassword:=\"\", ReadOnlyRecommended:=False, _\n        EmbedTrueTypeFonts:=False, SaveNativePictureFormat:=False, SaveFormsData _\n        :=False, SaveAsAOCELetter:=False, CompatibilityMode:=15\n\n' Close the active document\nActiveDocument.Close SaveChanges:=wdDoNotSaveChanges\n\n' Switch to the next document in the mail merge\nNext i\n\n    wd.Visible = True\n    wdocSource.Close SaveChanges:=False\n\n    Set wdocSource = Nothing\n    Set wd = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>Thanks,\nChris</p>\n"}, {"tags": ["ms-access", "vba", "duplicates"], "answers": [{"comments": [{"owner": {"reputation": 112, "user_id": 6850229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bb5a860c7cb69c0a1ebe5511772d6f0a?s=128&d=identicon&r=PG&f=1", "display_name": "Komakino_1251", "link": "https://stackoverflow.com/users/6850229/komakino-1251"}, "edited": false, "score": 0, "creation_date": 1518020563, "post_id": 48668211, "comment_id": 84334931, "body": "I cannot make the UserID column unique in the table because the default value is a blank entry, access is reading these as duplicate values."}, {"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "reply_to_user": {"reputation": 112, "user_id": 6850229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bb5a860c7cb69c0a1ebe5511772d6f0a?s=128&d=identicon&r=PG&f=1", "display_name": "Komakino_1251", "link": "https://stackoverflow.com/users/6850229/komakino-1251"}, "edited": false, "score": 1, "creation_date": 1518021790, "post_id": 48668211, "comment_id": 84335793, "body": "You can check <code>Ignore Nulls</code> in the index properties."}, {"owner": {"reputation": 112, "user_id": 6850229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bb5a860c7cb69c0a1ebe5511772d6f0a?s=128&d=identicon&r=PG&f=1", "display_name": "Komakino_1251", "link": "https://stackoverflow.com/users/6850229/komakino-1251"}, "edited": false, "score": 0, "creation_date": 1518022652, "post_id": 48668211, "comment_id": 84336345, "body": "I tried that and it still wont ignore the blank cells."}, {"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "reply_to_user": {"reputation": 112, "user_id": 6850229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bb5a860c7cb69c0a1ebe5511772d6f0a?s=128&d=identicon&r=PG&f=1", "display_name": "Komakino_1251", "link": "https://stackoverflow.com/users/6850229/komakino-1251"}, "edited": false, "score": 0, "creation_date": 1518023371, "post_id": 48668211, "comment_id": 84336867, "body": "The cells must contain <code>Null</code>, not an empty string <code>&quot;&quot;</code>. Set <code>Allow Zero Length</code> to <code>No</code> for this text field. This will automatically turn empty strings into <code>Nulls</code>. This is tricky, since there is no visible difference between an empty string an <code>Null</code>.."}], "tags": [], "owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "is_accepted": false, "score": 1, "last_activity_date": 1518023188, "last_edit_date": 1518023188, "creation_date": 1518019406, "answer_id": 48668211, "question_id": 48667877, "link": "https://stackoverflow.com/questions/48667877/how-to-allow-multiple-blank-records-in-access-table-but-no-duplicates/48668211#48668211", "title": "How to allow multiple blank records in access table, but no duplicates?", "body": "<p>Normalize the User Id by using a VBA function</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function NormalizeUserID(ByVal uid As Variant)\n    uid = Replace(Nz(uid), \" \", \"\")\n    NormalizeUserId = LCase$(uid) 'Optional\nEnd Function\n</code></pre>\n\n<p>This removes all the spaces and makes the user id lower case. If you only want to remove leading and trailing spaces, use <code>Trim</code> instead. This is up to you.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function NormalizeUserId(ByVal uid As Variant)\n    uid = Trim(uid)\n    NormalizeUserId = LCase(uid)\nEnd Function\n</code></pre>\n\n<p>Apply it when the user entered a username in the AfterUpdate event of the textbox</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub txtUserId_AfterUpdate()\n    me!txtUserId = NormalizeUserID(me!txtUserId)\nEnd Sub\n</code></pre>\n\n<p>Additionally, make sure that the UserId column in the table has a unique index.</p>\n\n<hr>\n\n<p>If you prefer to keep the user name as the user entered it, use 2 columns in the table: Maybe on called <code>UserIdDisplay</code> and one <code>UserIdNormalized</code>. In the Form you would bind the textbox to <code>UserIdDisplay</code> and change the <code>AfterUpdate</code> to</p>\n\n<pre><code>Private Sub txtUserIdDisplay_AfterUpdate()\n    me!UserIdNormalized = NormalizeUserID(me!txtUserIdDisplay)\nEnd Sub\n</code></pre>\n\n<p>And in the table, add a unique index to <code>UserIdNormalized</code>.</p>\n\n<hr>\n\n<p>Note: </p>\n\n<p>It is better to store the user information in a separate user table. You would create a user table with an <code>AutoNumber</code> as primary key and these 2 user id columns as text columns with a unique index as described above.</p>\n\n<p>In the checkout table you would link a user through this <code>AutoNumber</code> (the checkout table will need a <code>Number Long</code> field to store the user number.</p>\n\n<pre><code> tblUser                                 tblCheckout\n+---------------------------------+     +==-----------------------+\n| PK  UserID           AutoNumber |&lt;-+  | PK  Id      AutoNumber  |\n+---------------------------------+  |  +-------------------------+\n|     UserIdDisplay    Text(20)   |  +--o FK  UserId  Number Long |\n| UX  UserIdNormalized Text(20)   |     |     other columns ...   |\n|     optional: username etc. ... |     +=========================+\n+---------------------------------+\n</code></pre>\n\n<p>The advantages are that you have exactly one user record per user, even if this user makes several checkouts. The user can change his visible user id without affecting the internal <code>UserID</code>. You can store additional user information (name, address, e-mail etc.).</p>\n"}, {"tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": false, "score": 1, "last_activity_date": 1518020216, "creation_date": 1518020216, "answer_id": 48668470, "question_id": 48667877, "link": "https://stackoverflow.com/questions/48667877/how-to-allow-multiple-blank-records-in-access-table-but-no-duplicates/48668470#48668470", "title": "How to allow multiple blank records in access table, but no duplicates?", "body": "<p>Don't store the checkout status in the same table as the item. These are conceptually different things anyway. Create a second table, <code>UnitCheckout</code>, that has a PK of <code>UnitId</code> (or whatever your Primary key is on your Unit table). This will be a 1:1 relationship. If something is checked out it will have a record in this table with a <code>UnitId</code> and a <code>UserId</code>. If it is not checked out then there will be no record at all. This will allow you to put a unique constraint on the <code>UnitCheckout</code> table that is enforceable.</p>\n"}], "owner": {"reputation": 112, "user_id": 6850229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bb5a860c7cb69c0a1ebe5511772d6f0a?s=128&d=identicon&r=PG&f=1", "display_name": "Komakino_1251", "link": "https://stackoverflow.com/users/6850229/komakino-1251"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518023188, "creation_date": 1518018439, "last_edit_date": 1518020378, "question_id": 48667877, "link": "https://stackoverflow.com/questions/48667877/how-to-allow-multiple-blank-records-in-access-table-but-no-duplicates", "title": "How to allow multiple blank records in access table, but no duplicates?", "body": "<p>I have an access check in and check out form. When a unit is checked out, a <code>UserID</code> is required. When that unit is checked back in, the <code>UserID</code> is updated to <code>\"\"</code>. I want to prevent a <code>UserID</code> from checking out two units at once, however If I try to make the <code>UserID</code> field a unique field, it will count the blanks as duplicates and not allow it. </p>\n\n<p>How can I prevent duplicated <code>UserID</code> entries ?  </p>\n"}, {"tags": ["vba", "excel", "ie-automation"], "comments": [{"owner": {"reputation": 1, "user_id": 9328017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jud1o.jpg?s=128&g=1", "display_name": "C LeRoy", "link": "https://stackoverflow.com/users/9328017/c-leroy"}, "edited": false, "score": 0, "creation_date": 1518022985, "post_id": 48667790, "comment_id": 84336593, "body": "I have resolved how to identify and grab the specific instances out of the search result table, however I am still having trouble getting the macro to skip a search that results in the error page."}, {"owner": {"reputation": 1, "user_id": 9328017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jud1o.jpg?s=128&g=1", "display_name": "C LeRoy", "link": "https://stackoverflow.com/users/9328017/c-leroy"}, "edited": false, "score": 0, "creation_date": 1518189646, "post_id": 48667790, "comment_id": 84416666, "body": "I am not sure why this got a down vote. I did research, included code, and tried my best to give a concise description of the goal. If people are going to discredit my question it would be nice to have some feedback as to why. Especially since your scores affect your ability to ask questions."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9328017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jud1o.jpg?s=128&g=1", "display_name": "C LeRoy", "link": "https://stackoverflow.com/users/9328017/c-leroy"}, "is_accepted": false, "score": 0, "last_activity_date": 1518189721, "creation_date": 1518189721, "answer_id": 48708964, "question_id": 48667790, "link": "https://stackoverflow.com/questions/48667790/automated-internet-explorer-in-excel-to-search-multiple-items-on-a-site/48708964#48708964", "title": "Automated internet explorer in Excel to search multiple items on a site", "body": "<pre><code>Sub SearchPage()\n\nDim IE As Object\nDim search As Variant\nDim button As Variant\nDim LR As Integer\nDim var As String\nDim var1 As Object\nDim var2 As Object\nDim var3 As Object\nDim var4 As Object\nDim var5 As Object\nDim var6 As Object\n\nDim CurrentWindow As HTMLWindowProxy\n On Error Resume Next\nLR = Cells(Rows.Count, 1).End(xlUp).Row\nFor x = 2 To LR\nvar = Cells(x, 1).Value\n\nSet IE = CreateObject(\"internetexplorer.application\")\nIE.Visible = False\n\nWith IE\n.Visible = False\n\n.navigate \"https://aca3.accela.com/MILARA/GeneralProperty/PropertyLookUp.aspx?isLicensee=Y&amp;TabName=APO\"\n\nWhile Not .readyState = READYSTATE_COMPLETE\nWend\nEnd With\n\n        'Wait some to time for loading the page\n\nWhile IE.Busy\nDoEvents\nWend\n\nApplication.Wait (Now + TimeValue(\"0:00:02\"))\n        'this is where it puts the number from the cell into the search box\nIE.document.getElementById(\"ctl00_PlaceHolderMain_refLicenseeSearchForm_txtLicenseNumber\").Value = var\n        'Here we are clicking on search Button\nIE.document.getElementById(\"ctl00_PlaceHolderMain_btnNewSearch\").Click\n\n        'wait for page to load\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\nWhile IE.Busy\nDoEvents\nWend\n\n\n\n\n                'grabs table\n'Set var1 = IE.document.getElementById(\"ctl00_PlaceHolderMain_upGeneralInfo\")\n'Cells(x, 2).Value = var1.innerText\n\n                'grabs name\n              Application.Wait (Now + TimeValue(\"0:00:01\"))\n\nSet var2 = IE.document.getElementById(\"ctl00_PlaceHolderMain_licenseeGeneralInfo_lblContactName_value\")\nCells(x, 3).Value = var2.innerText\n\n        Application.Wait (Now + TimeValue(\"0:00:01\"))\n\n                'grabs Issue date\nSet var3 = IE.document.getElementById(\"ctl00_PlaceHolderMain_licenseeGeneralInfo_lblLicenseIssueDate_value\")\nCells(x, 4).Value = var3.innerText\n\n        Application.Wait (Now + TimeValue(\"0:00:01\"))\n\n                'grabs expiration date\nSet var4 = IE.document.getElementById(\"ctl00_PlaceHolderMain_licenseeGeneralInfo_lblExpirationDate_value\")\nCells(x, 5).Value = var4.innerText\n\n        Application.Wait (Now + TimeValue(\"0:00:01\"))\n\n                'license status\nSet var5 = IE.document.getElementById(\"ctl00_PlaceHolderMain_licenseeGeneralInfo_lblBusinessName2_value\")\nCells(x, 6).Value = var5.innerText\n\n Application.Wait (Now + TimeValue(\"0:00:01\"))\n\n                'grab url\n'Set var6 = IE.LocationURL\n'Cells(x, 7).Value = var6.innerText\n\n\nIE.Quit\nSet IE = Nothing\nNext x\n\n'Application.Wait (Now + TimeValue(\"0:00:02\"))\n\nMsgBox (\"Verification Import Complete\")\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9328017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jud1o.jpg?s=128&g=1", "display_name": "C LeRoy", "link": "https://stackoverflow.com/users/9328017/c-leroy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 354, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1518189721, "creation_date": 1518018154, "last_edit_date": 1518018534, "question_id": 48667790, "link": "https://stackoverflow.com/questions/48667790/automated-internet-explorer-in-excel-to-search-multiple-items-on-a-site", "title": "Automated internet explorer in Excel to search multiple items on a site", "body": "<p>I am using excel 2013 with a worksheet containing a column of license numbers. </p>\n\n<p>The macro needs to cycle through each cell to be searched on the webpage. \nOnce searched it grabs some details from the search result page and puts it in the cell next to the license number. </p>\n\n<p>The problem I am encountering is that not all the license numbers are going to be found which results in the web site throwing an error and not going to the results page which results in code failure. </p>\n\n<p>I need a way to skip the license number that throws the webpage error and the continue on to the next entry.</p>\n\n<p>The other problem that is really more of a headache is that the results that are inserted into the cells comes from a table format, so it makes the cells massive and throws off the workbook formatting. Is there a way to either grab only specific details from the search result or to make sure it puts it in an \"unwrapped\" format? </p>\n\n<p><strong>Details for recreating the macro.</strong></p>\n\n<p>The website needs you to create a free username and password but once created should have a cookie saved, so the code does not include a login portion.</p>\n\n<p>Webpage search location (after login): <a href=\"https://aca3.accela.com/MILARA/GeneralProperty/PropertyLookUp.aspx?isLicensee=Y&amp;TabName=APO\" rel=\"nofollow noreferrer\">https://aca3.accela.com/MILARA/GeneralProperty/PropertyLookUp.aspx?isLicensee=Y&amp;TabName=APO</a></p>\n\n<p>The error page: <a href=\"https://aca3.accela.com/MILARA/Error.aspx?ErrorId=2d09a60802d2455b8fbf1b86e45033d2\" rel=\"nofollow noreferrer\">https://aca3.accela.com/MILARA/Error.aspx?ErrorId=2d09a60802d2455b8fbf1b86e45033d2</a></p>\n\n<pre><code>    Sub SearchPage()\n\n    Dim IE As Object\n    Dim search As Variant\n    Dim button As Variant\n    Dim LR As Integer\n    Dim var As String\n    Dim var1 As Object\n    Dim CurrentWindow As HTMLWindowProxy\n\n    LR = Cells(Rows.Count, 1).End(xlUp).Row\n    For x = 2 To LR\n    var = Cells(x, 1).Value\n\n    Set IE = CreateObject(\"internetexplorer.application\")\n    IE.Visible = True\n\n    With IE\n    .Visible = True\n    .navigate \"https://aca3.accela.com/MILARA/GeneralProperty/PropertyLookUp.aspx?isLicensee=Y&amp;TabName=APO\"\n\n    While Not .readyState = READYSTATE_COMPLETE\n    Wend\n    End With\n\n            'Wait some to time for loading the page\n\n    While IE.Busy\n    DoEvents\n    Wend\n\n    Application.Wait (Now + TimeValue(\"0:00:02\"))\n            'this is where it puts the number from the cell into the search box\n'below is the text search box and the cell containing the ID    IE.document.getElementById(\"ctl00_PlaceHolderMain_refLicenseeSearchForm_txtLicenseNumber\").Value = var\n            'Here we are clicking on search Button\n    IE.document.getElementById(\"ctl00_PlaceHolderMain_btnNewSearch\").Click\n\n            'wait for page to load\n    Application.Wait (Now + TimeValue(\"0:00:02\"))\n    While IE.Busy\n    DoEvents\n    Wend\n\n\n            'grabs results from search and places it in cell next to searched id\n\n    Set var1 = IE.document.getElementById(\"ctl00_PlaceHolderMain_upGeneralInfo\")\n    Cells(x, 2).Value = var1.innerText\n\n    IE.Quit\n    Set IE = Nothing\n\n    Next x\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "validation", "textbox", "vba"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1518088065, "post_id": 48668741, "comment_id": 84365147, "body": "Hi Mike still on the same code. I have tried to introduce it in a worksheet with another macros and I don&#39;t know why it doesn&#39;t make the magic there. Do you know what can be the cause. Your help is really appreciated. Thanks again for the genius code you provide me"}, {"owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "edited": false, "score": 0, "creation_date": 1518106491, "post_id": 48668741, "comment_id": 84378035, "body": "That was a problem with my laptop. Now it works fine. Thanks again Mike"}], "tags": [], "owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "is_accepted": true, "score": 1, "last_activity_date": 1518021386, "last_edit_date": 1518021386, "creation_date": 1518021003, "answer_id": 48668741, "question_id": 48667722, "link": "https://stackoverflow.com/questions/48667722/how-to-replace-the-data-validation-input-message-with-a-textbox/48668741#48668741", "title": "How to replace the data validation input message with a textbox", "body": "<p>You can mimic the behaviour by making various text boxes visible like so:</p>\n\n<p>first create a number or ordinary text boxes - using multiple fonts, font sizes, colors, bells &amp; whistles</p>\n\n<p><a href=\"https://i.stack.imgur.com/2hLQx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2hLQx.png\" alt=\"create textboxes\"></a></p>\n\n<p>then write a <code>Selection_Change</code> trigger ... very similar to what you did (noting that text boxes from the Insert menu are <code>Shapes()</code> )</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nDim MyTB As Shape\n    ' hide all boxes\n    ActiveSheet.Shapes(\"TextBox 1\").Visible = msoFalse\n    ActiveSheet.Shapes(\"TextBox 2\").Visible = msoFalse\n    ActiveSheet.Shapes(\"TextBox 3\").Visible = msoFalse\n\n    ' working on B1:B10 in order not to disturb data validation in A1:A10\n    If Not Intersect(Target, [B1:B10]) Is Nothing Then\n\n        ' assign correct TextBox to MyTB\n        Select Case Target.Value\n            Case \"A\", \"a\"\n                Set MyTB = ActiveSheet.Shapes(\"TextBox 1\")\n            Case \"B\", \"b\"\n                Set MyTB = ActiveSheet.Shapes(\"TextBox 2\")\n            Case Else\n                Set MyTB = ActiveSheet.Shapes(\"TextBox 3\")\n        End Select\n\n        ' position MyTB one cell right/down from Cursor (Target) and make visible\n        MyTB.Left = Target(1, 2).Left\n        MyTB.Top = Target(2, 2).Top\n        MyTB.Visible = msoTrue\n\n    End If\nEnd Sub\n</code></pre>\n\n<p>and you should be done ?!?</p>\n\n<p><a href=\"https://i.stack.imgur.com/bJmez.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bJmez.png\" alt=\"enter image description here\"></a></p>\n\n<p>(TextBox content thankfully stolen from <a href=\"https://www.lipsum.com/\" rel=\"nofollow noreferrer\">https://www.lipsum.com/</a>)</p>\n"}], "owner": {"reputation": 65, "user_id": 7484678, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/514ea941d0d958782ea10e33f03f0a86?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7484678/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 940, "favorite_count": 1, "accepted_answer_id": 48668741, "answer_count": 1, "score": 0, "last_activity_date": 1518021386, "creation_date": 1518017965, "last_edit_date": 1531164843, "question_id": 48667722, "link": "https://stackoverflow.com/questions/48667722/how-to-replace-the-data-validation-input-message-with-a-textbox", "title": "How to replace the data validation input message with a textbox", "body": "<p>Input message data validation is limited to 255 characters and 9 lines. How would like to replace it with a textbox. Would it be possible? \nHere you go my code: </p>\n\n<pre>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rng As Range\n    Dim arr, cellVal As Variant\n    Set rng = Range(\"A1:A10\")\n    arr = rng.Value\n    If Not Intersect(Target, rng) Is Nothing Then\n\n    For i = 1 To rng.Rows.Count\n        For j = 1 To rng.Columns.Count\n            cellVal = arr(i, j)\n            Select Case cellVal\n              Case Is = \"A\"\n                  rng(i, j).Validation.InputMessage = \"Presentation and history:\" & vbTab & vbCrLf & _\n                \"One eye or both eyes\" & vbTab & vbCrLf & _\n                \"Gritty sensation/itch versus pain\" & vbTab & vbCrLf & _\n                \"Photophobia\" & vbTab & vbCrLf & _\n                \"Visual change\" & vbTab & vbCrLf & _\n                \"Discharge present\" & vbTab & vbCrLf & _\n                \"Injury\" & vbTab & vbCrLf & _\n                \"Foreign body\" & vbTab & vbCrLf & _\n                \"History of allergy or hay fever\" & vbTab\n              Case Is = \"B\"\n                  rng(i, j).Validation.InputMessage = TextBox1.Text\n              Case Is = \"C\"\n                  rng(i, j).Validation.InputMessage = \"Carrot\"\n              Case Else\n                  rng(i, j).Validation.InputMessage = \"Something   else\"\n            End Select\n        Next j\n    Next i\n    End If\nEnd Sub\n\n</pre>\n\n<p>Case \"A\" shows the limit of the data validation message. I would like to replace it with TextBox1 as shown in case \"B\". Please let me know if it is possible. \nRegards \nTommaso </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1518017726, "post_id": 48667454, "comment_id": 84332888, "body": "Why not just end the <code>End If</code> before the <code>Application.ScreenUpdating</code> &amp; <code>DisplayAlerts</code> so you don&#39;t have to type it twice? Short code <i>generally</i> (not always - in your case however) leads to improved readability. This doesn&#39;t answer your question which is why it&#39;s in the comment section instead as an answer."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1518018809, "post_id": 48667454, "comment_id": 84333731, "body": "<code>ActiveDocument.SaveAs FileName:=savePath &amp; strDocName</code> is simply &quot;saving as&quot; which will cause Word to save in its default <code>docx</code> format. Where&#39;s the code that does the <code>.ExportAsFixedFormat</code> and what kind of errors does it throw?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5645116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd31d94ace2f486e6998ca31fe7c389?s=128&d=identicon&r=PG&f=1", "display_name": "Azhar Iqbal", "link": "https://stackoverflow.com/users/5645116/azhar-iqbal"}, "edited": false, "score": 0, "creation_date": 1518023880, "post_id": 48667687, "comment_id": 84337151, "body": "Hi Apologies I now have an additional problem. the file name is set by the mailmerge source but it can only find one of them. I get a runtime 5941 when selecting a mailmerge source field as the name for the file but this doesnt happen to every mail merger source"}, {"owner": {"reputation": 439, "user_id": 2867756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000550821342/picture?type=large", "display_name": "M&#225;tray M&#225;rk", "link": "https://stackoverflow.com/users/2867756/m%c3%a1tray-m%c3%a1rk"}, "reply_to_user": {"reputation": 13, "user_id": 5645116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd31d94ace2f486e6998ca31fe7c389?s=128&d=identicon&r=PG&f=1", "display_name": "Azhar Iqbal", "link": "https://stackoverflow.com/users/5645116/azhar-iqbal"}, "edited": false, "score": 0, "creation_date": 1518024073, "post_id": 48667687, "comment_id": 84337266, "body": "How your datasource look like? When you che k in the Word document can you see more records in the Mailing ribbon?"}, {"owner": {"reputation": 13, "user_id": 5645116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd31d94ace2f486e6998ca31fe7c389?s=128&d=identicon&r=PG&f=1", "display_name": "Azhar Iqbal", "link": "https://stackoverflow.com/users/5645116/azhar-iqbal"}, "edited": false, "score": 0, "creation_date": 1518024192, "post_id": 48667687, "comment_id": 84337336, "body": "Hi yes i can see more than one records within the mailing ribbon. Its strange the program runs correctly with a specific mail merge source header but not the rest. I tested with a test document and data source and a similar issue happened"}, {"owner": {"reputation": 439, "user_id": 2867756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000550821342/picture?type=large", "display_name": "M&#225;tray M&#225;rk", "link": "https://stackoverflow.com/users/2867756/m%c3%a1tray-m%c3%a1rk"}, "reply_to_user": {"reputation": 13, "user_id": 5645116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd31d94ace2f486e6998ca31fe7c389?s=128&d=identicon&r=PG&f=1", "display_name": "Azhar Iqbal", "link": "https://stackoverflow.com/users/5645116/azhar-iqbal"}, "edited": false, "score": 0, "creation_date": 1518024586, "post_id": 48667687, "comment_id": 84337556, "body": "Do you input a valid fieldname when the msgbox appears? Like [fileName]? It should be a column name in square brackets, if it contains space swap it with an underscore _ eg.: Document File Name becomes [Document_File_Name]."}, {"owner": {"reputation": 439, "user_id": 2867756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000550821342/picture?type=large", "display_name": "M&#225;tray M&#225;rk", "link": "https://stackoverflow.com/users/2867756/m%c3%a1tray-m%c3%a1rk"}, "reply_to_user": {"reputation": 13, "user_id": 5645116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd31d94ace2f486e6998ca31fe7c389?s=128&d=identicon&r=PG&f=1", "display_name": "Azhar Iqbal", "link": "https://stackoverflow.com/users/5645116/azhar-iqbal"}, "edited": false, "score": 0, "creation_date": 1518024645, "post_id": 48667687, "comment_id": 84337584, "body": "And Delete the .docx append too pretty useless"}, {"owner": {"reputation": 13, "user_id": 5645116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd31d94ace2f486e6998ca31fe7c389?s=128&d=identicon&r=PG&f=1", "display_name": "Azhar Iqbal", "link": "https://stackoverflow.com/users/5645116/azhar-iqbal"}, "edited": false, "score": 0, "creation_date": 1518081124, "post_id": 48667687, "comment_id": 84360236, "body": "Thanks Matray. unfortunatley the isse still persists. My mailmerge source data looks like the following; and i have used square brackets with non of my headers including a space"}, {"owner": {"reputation": 13, "user_id": 5645116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd31d94ace2f486e6998ca31fe7c389?s=128&d=identicon&r=PG&f=1", "display_name": "Azhar Iqbal", "link": "https://stackoverflow.com/users/5645116/azhar-iqbal"}, "edited": false, "score": 0, "creation_date": 1518081164, "post_id": 48667687, "comment_id": 84360268, "body": "name\taddress\tDOB ( with data underneath each header of course)."}, {"owner": {"reputation": 13, "user_id": 5645116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd31d94ace2f486e6998ca31fe7c389?s=128&d=identicon&r=PG&f=1", "display_name": "Azhar Iqbal", "link": "https://stackoverflow.com/users/5645116/azhar-iqbal"}, "edited": false, "score": 0, "creation_date": 1518081285, "post_id": 48667687, "comment_id": 84360352, "body": "the debug points me to the following line of code;                                                                             strDocName=ActiveDocument.MailMerge.DataSource.DataFields(do&zwnj;&#8203;cNameField).Value &amp; &quot;.docx&quot;"}, {"owner": {"reputation": 439, "user_id": 2867756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000550821342/picture?type=large", "display_name": "M&#225;tray M&#225;rk", "link": "https://stackoverflow.com/users/2867756/m%c3%a1tray-m%c3%a1rk"}, "reply_to_user": {"reputation": 13, "user_id": 5645116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd31d94ace2f486e6998ca31fe7c389?s=128&d=identicon&r=PG&f=1", "display_name": "Azhar Iqbal", "link": "https://stackoverflow.com/users/5645116/azhar-iqbal"}, "edited": false, "score": 0, "creation_date": 1518081408, "post_id": 48667687, "comment_id": 84360438, "body": "I would need the datasource and word doc to find anything else, try debugging it step by step, add a watch to strDocName and  ActiveDocument.MailMerge.DataSource.DataFields(docNameField)&zwnj;&#8203;.Value. try using differend datafieldnames etc"}, {"owner": {"reputation": 13, "user_id": 5645116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd31d94ace2f486e6998ca31fe7c389?s=128&d=identicon&r=PG&f=1", "display_name": "Azhar Iqbal", "link": "https://stackoverflow.com/users/5645116/azhar-iqbal"}, "edited": false, "score": 0, "creation_date": 1518083541, "post_id": 48667687, "comment_id": 84361894, "body": "Thank you. Rookie error the mailmerge data source contained invalid characters! Thanks for your guidance. I will probaly remove the message dialog box and select a static naming value"}, {"owner": {"reputation": 439, "user_id": 2867756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000550821342/picture?type=large", "display_name": "M&#225;tray M&#225;rk", "link": "https://stackoverflow.com/users/2867756/m%c3%a1tray-m%c3%a1rk"}, "reply_to_user": {"reputation": 13, "user_id": 5645116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd31d94ace2f486e6998ca31fe7c389?s=128&d=identicon&r=PG&f=1", "display_name": "Azhar Iqbal", "link": "https://stackoverflow.com/users/5645116/azhar-iqbal"}, "edited": false, "score": 0, "creation_date": 1518083590, "post_id": 48667687, "comment_id": 84361938, "body": "Probably for the best :D or let them choose from a list that contains the datasource&#39;s fieldnames."}], "tags": [], "owner": {"reputation": 439, "user_id": 2867756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000550821342/picture?type=large", "display_name": "M&#225;tray M&#225;rk", "link": "https://stackoverflow.com/users/2867756/m%c3%a1tray-m%c3%a1rk"}, "is_accepted": true, "score": 2, "last_activity_date": 1518017860, "creation_date": 1518017860, "answer_id": 48667687, "question_id": 48667454, "link": "https://stackoverflow.com/questions/48667454/exporting-as-pdf-vba/48667687#48667687", "title": "Exporting as PDF VBA", "body": "<p>As you said you should use ExportAsFixedFormat, something like this.</p>\n\n<pre><code>ActiveDocument.ExportAsFixedFormat _\n OutputFileName:=savePath &amp; strDocName &amp; \".pdf\", _\n ExportFormat:=wdExportFormatPDF\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5645116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd31d94ace2f486e6998ca31fe7c389?s=128&d=identicon&r=PG&f=1", "display_name": "Azhar Iqbal", "link": "https://stackoverflow.com/users/5645116/azhar-iqbal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 0, "accepted_answer_id": 48667687, "answer_count": 1, "score": 0, "last_activity_date": 1518017860, "creation_date": 1518017222, "last_edit_date": 1531164843, "question_id": 48667454, "link": "https://stackoverflow.com/questions/48667454/exporting-as-pdf-vba", "title": "Exporting as PDF VBA", "body": "<p>I am having an issue trying to adjust a macro to export as pdf rather than a .dox</p>\n\n<pre><code>    ' Find the last record of the Mail Merge data\n    ActiveDocument.MailMerge.DataSource.ActiveRecord = wdLastRecord\n    lastRecord = ActiveDocument.MailMerge.DataSource.ActiveRecord\n\n    ' Ask for user confirmation to start creating the documents\n    If MsgBox(lastRecord &amp; \" documents will be created based on your Mail Merge template.\", vbOKCancel) = vbOK Then\n        ' Ask for the name of the Merge Field name to use for the document names\n        docNameField = InputBox(\"Which Mergefield [name] should be used for document name?\")\n\n        ' Create document for each Mail Merge record (loop)\n        For rec = ActiveDocument.MailMerge.DataSource.FirstRecord To lastRecord\n            ActiveDocument.MailMerge.DataSource.ActiveRecord = rec\n\n            ' Set document name for current record\n            If Trim(docNameField) = \"\" Then\n                strDocName = \"document\" &amp; rec &amp; \".docx\"\n            Else\n                strDocName = ActiveDocument.MailMerge.DataSource.DataFields(docNameField).Value &amp; \".docx\"\n            End If\n\n            ' Execute Mail Merge action\n            With ActiveDocument.MailMerge\n                .Destination = wdSendToNewDocument\n                .Execute\n            End With\n\n            ' Save generated document and close it after saving\n            ActiveDocument.SaveAs FileName:=savePath &amp; strDocName\n            ActiveDocument.Close False\n\n            ActiveDocument.MailMerge.DataSource.ActiveRecord = wdNextRecord\n        Next rec\n\n        ' Re-enable screen visuals\n        Application.ScreenUpdating = True\n        Application.DisplayAlerts = True\n\n    Else 'if no destination folder was selected\n        'Re-enable screen visuals\n        Application.ScreenUpdating = True\n        Application.DisplayAlerts = True\n        Exit Sub\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I have tried to utilise activedocument.exportasfixedformat but cannot get this to work. Id appreciate any guidance.</p>\n\n<p>Regards</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 3, "creation_date": 1518018103, "post_id": 48667411, "comment_id": 84333164, "body": "You can avoid <b>converting</b> the text to <code>LCase</code> by using the <code>vbTextCompare</code> argument within <code>InStr()</code>. Any time you convert anything within VBA you are providing yourself with processor penalties - hence longer run times. May not be noticeable depending on how large your range is, but I would try to avoid unnecessary conversions. <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/instr-function\" rel=\"nofollow noreferrer\">More Info on InStr()</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1518020849, "post_id": 48667411, "comment_id": 84335134, "body": "Consider <code>Union</code>-ing the rows you want to hide, and then <i>after the loop has completed</i> you can hide all of them in a single, much more efficient instruction, e.g. <code>rowsToHide.EntireRow.Hidden = True</code>."}, {"owner": {"reputation": 53, "user_id": 8730951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ikf8O.png?s=128&g=1", "display_name": "P.Schlegel", "link": "https://stackoverflow.com/users/8730951/p-schlegel"}, "edited": false, "score": 0, "creation_date": 1518080361, "post_id": 48667411, "comment_id": 84359707, "body": "Thanks for the tips! I&#39;ll try to union the ranges after the looping"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518018117, "post_id": 48667615, "comment_id": 84333179, "body": "There is a small amount of irony to writing `ActiveSheet.Range()&quot;... we qualify ranges to avoid VBA assuming we want to reference the ActiveSheet."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518018321, "post_id": 48667615, "comment_id": 84333364, "body": "Sure, but the OP didn&#39;t give any information about his sheets - I just wanted to answer the question."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518018339, "post_id": 48667615, "comment_id": 84333379, "body": "Completely agree - not a criticism!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1518020669, "post_id": 48667615, "comment_id": 84335008, "body": "@CallumDA I&#39;ll take <i>explicit</i> <code>ActiveSheet</code> references over implicit ones any day - the unqualified ones (e.g. <code>Range(&quot;foo&quot;)</code>) behave differently depending on whether the code is written in a worksheet&#39;s code-behind (where they&#39;re implicit references to <code>Me</code>) or in a standard code module (where they&#39;re implicit references to <code>ActiveSheet</code>). Code with explicit references to <code>ActiveSheet</code> works identically regardless of where it&#39;s written."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1518020977, "post_id": 48667615, "comment_id": 84335220, "body": "@Mat&#39;sMug, I&#39;d say that&#39;s a tiny win in the grand scheme of things ;)"}, {"owner": {"reputation": 53, "user_id": 8730951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ikf8O.png?s=128&g=1", "display_name": "P.Schlegel", "link": "https://stackoverflow.com/users/8730951/p-schlegel"}, "edited": false, "score": 0, "creation_date": 1518081418, "post_id": 48667615, "comment_id": 84360448, "body": "As a newbie, it&#39;s very interesting for me to read your discussion."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 2, "last_activity_date": 1518017685, "creation_date": 1518017685, "answer_id": 48667615, "question_id": 48667411, "link": "https://stackoverflow.com/questions/48667411/using-instr-function-in-named-range-to-filter-certain-string/48667615#48667615", "title": "Using instr-function in named range to filter certain string", "body": "<p>A <code>workbook</code> doesn't have a <code>Range</code>-method. You can access ranges only with a <code>worksheet</code> object. Assuming the named ranges are within the active sheet, you can use</p>\n\n<pre><code>Set rng1 = ActiveSheet.Range(\"suppliers\")\nSet rng2 = ActiveSheet.Range(\"tohide\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 2, "last_activity_date": 1518018305, "creation_date": 1518018305, "answer_id": 48667832, "question_id": 48667411, "link": "https://stackoverflow.com/questions/48667411/using-instr-function-in-named-range-to-filter-certain-string/48667832#48667832", "title": "Using instr-function in named range to filter certain string", "body": "<p>Try this. You weren't using <code>c</code> in your <code>For</code> loop. Also your use of <code>Names</code> was fine so I've reinstated that.  </p>\n\n<pre><code>Option Explicit\n\nSub HideRows()\n    Dim rng1 As Range, rng2 As Range, c As Range\n\n    Set rng1 = ThisWorkbook.Names(\"suppliers\").RefersToRange\n    Set rng2 = ThisWorkbook.Names(\"tohide\").RefersToRange\n\n    For Each c In rng1\n        If InStr(1, c.Value, \"x\", vbTextCompare) &gt; 0 Then\n            rng2.EntireRow.Hidden = True\n        End If\n    Next c\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1518042250, "creation_date": 1518042250, "answer_id": 48674276, "question_id": 48667411, "link": "https://stackoverflow.com/questions/48667411/using-instr-function-in-named-range-to-filter-certain-string/48674276#48674276", "title": "Using instr-function in named range to filter certain string", "body": "<p>It sounds odd you have to hide the same range everytime a cell of another range meets some criteria</p>\n\n<p>I mean I\u2019d say you want to hide rows of to-hide range accordingly to the to-check range matching cells ones</p>\n\n<p>Like follows</p>\n\n<pre><code>Option Explicit\n\nSub HideRows()\n    Dim rng1 As Range, rng2 As Range\n    Dim iRow As Long\n\n    Set rng1 = ThisWorkbook.Names(\"suppliers\").RefersToRange\n    Set rng2 = ThisWorkbook.Names(\"tohide\").RefersToRange\n\n    For iRow = 1 to rng1.Rows.Count\n        rng2.Rows(iRow).EntireRow.Hidden = InStr(1, rng1.Rows(iRow).Value, \"x\", vbTextCompare) &gt; 0 \n    Next\nEnd Sub\n</code></pre>\n\n<p>Of course, this assumes the two ranges have the same rows number</p>\n"}], "owner": {"reputation": 53, "user_id": 8730951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ikf8O.png?s=128&g=1", "display_name": "P.Schlegel", "link": "https://stackoverflow.com/users/8730951/p-schlegel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1445, "favorite_count": 0, "accepted_answer_id": 48667832, "answer_count": 3, "score": 2, "last_activity_date": 1518042250, "creation_date": 1518017128, "last_edit_date": 1518021633, "question_id": 48667411, "link": "https://stackoverflow.com/questions/48667411/using-instr-function-in-named-range-to-filter-certain-string", "title": "Using instr-function in named range to filter certain string", "body": "<p>My intention is to use the <code>Instr</code> function to check if there is an \"x\" in a named range, if yes then it triggers an event to hide another named range. </p>\n\n<p>My code doesn't work, it shows </p>\n\n<blockquote>\n  <p>Error 438 \"object doesn't support this property or method\"</p>\n</blockquote>\n\n<p>I tried to change the code to </p>\n\n<p><code>Set rng = Workbooks(\"Book1.xls\").Names(\"suppliers\").RefersToRange</code></p>\n\n<p>but that doesn't work either. </p>\n\n<p>What is the reason? </p>\n\n<p>My code:</p>\n\n<pre><code>Sub HideRows()\n\nDim rng1 As Range, rng2 As Range, c As Range\nenter code here\nSet rng1 = ActiveWorkbook.Range(\"suppliers\")\nSet rng2 = ActiveWorkbook.Range(\"tohide\")\nFor Each c In rng1\n    If InStr(1, LCase(rng1), \"x\") &lt;&gt; 0 Then\n    rng2.EntireRow.Hidden = True\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1518017107, "post_id": 48667284, "comment_id": 84332441, "body": "Can you put some screenshots as well? The code looks pretty ok actually."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1518017623, "post_id": 48667284, "comment_id": 84332821, "body": "I suspect it&#39;s your <code>ActiveSheet</code> that&#39;s the problem. If your <code>ActiveSheet</code> is the Newly added &#39;Master` sheet, you will always add the value to column B in the first instance because when you get the count of the column, its prior to you adding any data on the sheet so at this stage your count will be 1. Once you start adding the data, you will get the correct count of the column. Try getting the column and row count after you&#39;ve added the values in the sheet. Also, as per @Vityata suggestion, I&#39;d strongly suggest not to use <code>ActiveSheet</code>. Always qualify your sheets"}, {"owner": {"reputation": 21, "user_id": 9289906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1804e41209656d6ca6e95ec7ddda48fa?s=128&d=identicon&r=PG&f=1", "display_name": "hithenameisbj", "link": "https://stackoverflow.com/users/9289906/hithenameisbj"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1518018122, "post_id": 48667284, "comment_id": 84333184, "body": "@Zac I have attempted Vityata &#39;s suggestion, but I am getting the same result."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1518018313, "post_id": 48667284, "comment_id": 84333354, "body": "My suggestion is different from Vityata&#39;s. I&#39;m suggesting that you get your column count after you&#39;ve added the values in the row. Only reason I quoted Vityata&#39;s answer was because I don&#39;t like using <code>ActiveSheet</code>. It can get you in trouble"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1518018984, "post_id": 48667284, "comment_id": 84333850, "body": "The problem is that you are not looking for last column, but for last column in last row. This is pretty different."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9289906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1804e41209656d6ca6e95ec7ddda48fa?s=128&d=identicon&r=PG&f=1", "display_name": "hithenameisbj", "link": "https://stackoverflow.com/users/9289906/hithenameisbj"}, "edited": false, "score": 0, "creation_date": 1518017678, "post_id": 48667446, "comment_id": 84332853, "body": "Thank you, but it&#39;s still overwriting. I am adding a screen shot to the op now"}, {"owner": {"reputation": 21, "user_id": 9289906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1804e41209656d6ca6e95ec7ddda48fa?s=128&d=identicon&r=PG&f=1", "display_name": "hithenameisbj", "link": "https://stackoverflow.com/users/9289906/hithenameisbj"}, "edited": false, "score": 1, "creation_date": 1518019371, "post_id": 48667446, "comment_id": 84334097, "body": "I have replaced that &quot;With statement&quot; containing the definition for last c, with the code that you just posted and I&#39;m getting &quot;error 424 object required&quot; debugging points to that block. Thank you for the help btw."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 21, "user_id": 9289906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1804e41209656d6ca6e95ec7ddda48fa?s=128&d=identicon&r=PG&f=1", "display_name": "hithenameisbj", "link": "https://stackoverflow.com/users/9289906/hithenameisbj"}, "edited": false, "score": 0, "creation_date": 1518019442, "post_id": 48667446, "comment_id": 84334146, "body": "@hithenameisbj - take a better look at the code, there is some <code>.rng</code>, which is non defined. In general, see the edit."}, {"owner": {"reputation": 21, "user_id": 9289906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1804e41209656d6ca6e95ec7ddda48fa?s=128&d=identicon&r=PG&f=1", "display_name": "hithenameisbj", "link": "https://stackoverflow.com/users/9289906/hithenameisbj"}, "edited": false, "score": 0, "creation_date": 1518020776, "post_id": 48667446, "comment_id": 84335082, "body": "That gives me  an &quot;expected end sub&quot; under the definition for lastc. If I attempt to run again without altering the code I get &quot;for control variable already in use&quot; pointing to &quot;For Each sh In&quot;.  At this point, I am thinking of just setting a fixed paste location, and having it assign &quot;0&quot; values to the cells with an if statement, and deleting 0&#39;s with a separate code."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 21, "user_id": 9289906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1804e41209656d6ca6e95ec7ddda48fa?s=128&d=identicon&r=PG&f=1", "display_name": "hithenameisbj", "link": "https://stackoverflow.com/users/9289906/hithenameisbj"}, "edited": false, "score": 0, "creation_date": 1518021092, "post_id": 48667446, "comment_id": 84335310, "body": "@hithenameisbj - the <code>LastC=LastRow(DestSh)</code> should be put on the place of <code>LastC = .Cells(LastR, .Columns.Count).End(xlToLeft).Column</code> in your code. Then, after the last <code>End Sub</code> of your code, write <code>Function LastRow(sh As Worksheet)     On Error Resume Next     LastRow = sh.Cells.Find(What:=&quot;*&quot;, _ ... etc</code>"}, {"owner": {"reputation": 21, "user_id": 9289906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1804e41209656d6ca6e95ec7ddda48fa?s=128&d=identicon&r=PG&f=1", "display_name": "hithenameisbj", "link": "https://stackoverflow.com/users/9289906/hithenameisbj"}, "edited": false, "score": 0, "creation_date": 1518021903, "post_id": 48667446, "comment_id": 84335876, "body": "No longer getting errors, but it is causing another odd shift in data. I&#39;ve added a screenshot to the bottom of the original post to show what it is doing now."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1518019481, "last_edit_date": 1518019481, "creation_date": 1518017195, "answer_id": 48667446, "question_id": 48667284, "link": "https://stackoverflow.com/questions/48667284/last-column-command-overwriting-existing-cell-intermittently-vba/48667446#48667446", "title": "Last Column command overwriting existing cell intermittently vba", "body": "<p>Try to replace <code>ActiveSheet</code> with <code>DestSh</code>, probably this is the reason for the problem:</p>\n\n<pre><code>'Find the last row with data on the DestSh\nWith DestSh\n    LastR = .Cells(.Rows.Count, \"a\").End(xlUp).Row\nEnd With\n\nWith DestSh\n    LastC = .Cells(LastR, .Columns.Count).End(xlToLeft).Column\nEnd With\n</code></pre>\n\n<hr>\n\n<p>In your case, <code>LastC = .Cells(LastR, .Columns.Count).End(xlToLeft).Column</code> does not return the last column in the parent worksheet, but the last column in row <code>LastR</code>. Try this for the real last column:</p>\n\n<pre><code>LastC = LastRow(DestSh)\n\nFunction LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>And this is worth reading - <a href=\"https://www.rondebruin.nl/win/s9/win005.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s9/win005.htm</a></p>\n"}], "owner": {"reputation": 21, "user_id": 9289906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1804e41209656d6ca6e95ec7ddda48fa?s=128&d=identicon&r=PG&f=1", "display_name": "hithenameisbj", "link": "https://stackoverflow.com/users/9289906/hithenameisbj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1518021813, "creation_date": 1518016775, "last_edit_date": 1518021813, "question_id": 48667284, "link": "https://stackoverflow.com/questions/48667284/last-column-command-overwriting-existing-cell-intermittently-vba", "title": "Last Column command overwriting existing cell intermittently vba", "body": "<p><a href=\"https://i.stack.imgur.com/KiGcA.png\" rel=\"nofollow noreferrer\">Screenshot of what is happening here, for simplicity sake, I have changed the values to represent the columns that they rightfully belong in</a></p>\n\n<p>I am working on a program where I need to copy and reorganize data from multiple worksheets into one master. One row per sheet. From columns G to R I will need to set up an if statement, so that if a value on the sheet is greater than 0  it will be copy/pasted to the next available column in it's row. For testing I have eliminated the if statement, so that I always get a result. The problem I am having is that on the first row of data the \"B\" column is being overwritten, subsequent rows work as expected. Any ideas as to why this could be happening?</p>\n\n<pre><code>    Sub CopyRangeFromMultiWorksheets()\n    Dim sh As Worksheet\n    Dim DestSh As Worksheet\n    Dim LastR As Long\n    Dim LastC As Long\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    'Delete the sheet \"Master\" if it exist\n    Application.DisplayAlerts = False\n    On Error Resume Next\n    ActiveWorkbook.Worksheets(\"Master\").Delete\n    On Error GoTo 0\n    Application.DisplayAlerts = True\n\n    'Add a worksheet with the name \"Master\"\n    Set DestSh = ActiveWorkbook.Worksheets.Add\n    DestSh.Name = \"Master\"\n\n    'loop through all worksheets and copy the data to the DestSh\n    For Each sh In ActiveWorkbook.Worksheets\n        If sh.Name &lt;&gt; DestSh.Name Then\n\n            'Find the last row with data on the DestSh\n            With ActiveSheet\n            LastR = .Cells(.Rows.Count, \"a\").End(xlUp).Row\n            End With\n\n            With ActiveSheet\n            LastC = .Cells(LastR, .Columns.Count).End(xlToLeft).Column\n            End With                \n\n            sh.Range(\"B2\").Copy\n            DestSh.Cells(LastR + 1, \"A\").PasteSpecial xlPasteValues   'customer'\n            DestSh.Cells(LastR + 1, \"B\").Value = (\"Glass\")            'Product\"\n            DestSh.Cells(LastR + 1, \"C\").Value = sh.Name              'Color Name\n            sh.Range(\"H32\").Copy\n            DestSh.Cells(LastR + 1, \"D\").PasteSpecial xlPasteValues   'based on QTY'\n            DestSh.Cells(LastR + 1, \"E\").Value = (\"Liters\")           'based on Units'\n            DestSh.Cells(LastR + 1, \"F\").Value = (\"Clear\")           'Base'\n\n            sh.Range(\"F13\").Copy\n            DestSh.Cells(LastR + 1, LastC + 1).PasteSpecial xlPasteValues   'THIS IS THE LINE GIVING ME TROUBLE'\n\n        End If\n    Next\n\nExitTheSub:\n\n    Application.Goto DestSh.Cells(1)\n\n    'AutoFit the column width in the DestSh sheet\n    DestSh.Columns.AutoFit\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/wvSs0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wvSs0.png\" alt=\"This is after adding the function below end sub\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518015424, "post_id": 48666778, "comment_id": 84331234, "body": "You will want to put vba code in a worksheet_change event."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1518015589, "post_id": 48666778, "comment_id": 84331352, "body": "Did you try to change A2 to 20? B2 changes accordingly. That&#39;s the idea with Excel."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518016202, "post_id": 48666778, "comment_id": 84331770, "body": "@peakpeak but the OP wants to accrue the value not replace.  So each time A2 changes the OP wants B2&#39;s current value not a set value, to increas by that amount in A2 and keep that amount then add to it again when A2 changes.  That is why when A2 changes for the second time in the OP&#39;s example they want 330 not 320."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1518016821, "post_id": 48666778, "comment_id": 84332229, "body": "Aishwarya Harne: Nice. You edited the question. Now you tell what you want to accomplish.  Because what&#39;s in your brain and totally evident for you is not in other peoples such."}], "answers": [{"comments": [{"owner": {"reputation": 3021, "user_id": 9208197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e545ac8c6a4f6c5cad3832d7463c15?s=128&d=identicon&r=PG&f=1", "display_name": "L&#233;o R.", "link": "https://stackoverflow.com/users/9208197/l%c3%a9o-r"}, "edited": false, "score": 0, "creation_date": 1518015728, "post_id": 48666900, "comment_id": 84331455, "body": "Explain downvote ? this work.. and it&#39;s a good solution to answer his problem"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518015951, "post_id": 48666900, "comment_id": 84331599, "body": "Did not downvote but two things, one your math is wrong.  The OP wants to add the new value each time.  You do not need the x variable and just add A2&#39;s value to B2 each time A2 changes. Second item, we should not encourage people who do not show any signs of research or attempts by giving the answer, that is not what this site is for.  So it was one or both those that resulted in the downvote."}, {"owner": {"reputation": 3021, "user_id": 9208197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e545ac8c6a4f6c5cad3832d7463c15?s=128&d=identicon&r=PG&f=1", "display_name": "L&#233;o R.", "link": "https://stackoverflow.com/users/9208197/l%c3%a9o-r"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518016257, "post_id": 48666900, "comment_id": 84331818, "body": "ok, i updated my answer, i did useless step you&#39;re right."}, {"owner": {"reputation": 3021, "user_id": 9208197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e545ac8c6a4f6c5cad3832d7463c15?s=128&d=identicon&r=PG&f=1", "display_name": "L&#233;o R.", "link": "https://stackoverflow.com/users/9208197/l%c3%a9o-r"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518016344, "post_id": 48666900, "comment_id": 84331889, "body": "However it&#39;s better to downvote the question instead of a correct answer no ?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518017591, "post_id": 48666900, "comment_id": 84332793, "body": "Yes I agree, hence why I did not downvote, but it is my policy not to upvote answers to &quot;give me the code&quot; questions either."}], "tags": [], "owner": {"reputation": 3021, "user_id": 9208197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e545ac8c6a4f6c5cad3832d7463c15?s=128&d=identicon&r=PG&f=1", "display_name": "L&#233;o R.", "link": "https://stackoverflow.com/users/9208197/l%c3%a9o-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1518016227, "last_edit_date": 1518016227, "creation_date": 1518015629, "answer_id": 48666900, "question_id": 48666778, "link": "https://stackoverflow.com/questions/48666778/how-to-store-a-cell-value-in-excel-and-increment-it-with-adjacent-changing-value/48666900#48666900", "title": "How to store a cell value in excel and increment it with adjacent changing value?", "body": "<p>Copy this code in a macro :</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Intersect(Target, Range(\"A2\")) Is Nothing Then Exit Sub\nDim y As Integer\ny = Range(\"A2\").Value \nRange(\"B2\").Value = Range(\"B2\").Value + y\nEnd Sub\n</code></pre>\n\n<p>This sub will detect change value on A2 cell and increment B2 with A2 Cell value.\nYou can also define a value in B2 Cell, this will increment this value with all A2 Values</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9328151"}, "edited": false, "score": 0, "creation_date": 1518016416, "post_id": 48667017, "comment_id": 84331943, "body": "This worked. Thanks!"}, {"owner": {"reputation": 3021, "user_id": 9208197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e545ac8c6a4f6c5cad3832d7463c15?s=128&d=identicon&r=PG&f=1", "display_name": "L&#233;o R.", "link": "https://stackoverflow.com/users/9208197/l%c3%a9o-r"}, "edited": false, "score": 0, "creation_date": 1518017768, "post_id": 48667017, "comment_id": 84332923, "body": "This don&#39;t work at all for me.."}], "tags": [], "owner": {"reputation": 363, "user_id": 9328115, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213268517001319/picture?type=large", "display_name": "Yuri Molodyko", "link": "https://stackoverflow.com/users/9328115/yuri-molodyko"}, "is_accepted": true, "score": 0, "last_activity_date": 1518016092, "last_edit_date": 1518016092, "creation_date": 1518015998, "answer_id": 48667017, "question_id": 48666778, "link": "https://stackoverflow.com/questions/48666778/how-to-store-a-cell-value-in-excel-and-increment-it-with-adjacent-changing-value/48667017#48667017", "title": "How to store a cell value in excel and increment it with adjacent changing value?", "body": "<p>I think you need create a macros, and when you do something change, use hotkey (calling this macros). </p>\n\n<pre><code>Sub Change()\n\nRange(\"B2\").Value = Range(\"B2\").Value + Range(\"A2\").Value\n\nEnd sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1518017426, "creation_date": 1518017426, "answer_id": 48667516, "question_id": 48666778, "link": "https://stackoverflow.com/questions/48666778/how-to-store-a-cell-value-in-excel-and-increment-it-with-adjacent-changing-value/48667516#48667516", "title": "How to store a cell value in excel and increment it with adjacent changing value?", "body": "<p>Why not place the following codes on <code>Sheet Module</code> to utilize the <code>Sheet Change Event</code>?</p>\n\n<p><code>Right click</code> on <code>Sheet Tab</code> -- > <code>View Code</code> --> And paste the codes given below into the opened code window --> Close the VB Editor --> Save your workbook as Macro-Enabled Workbook.</p>\n\n<p>The constant variable <code>initVal</code> contains the initial constant value in the formula in <code>B2</code> (<code>=300 + A2</code>). You may change it as per your requirement.</p>\n\n<pre><code>Dim oVal\nConst initVal As Long = 300\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nIf Target.CountLarge &gt; 1 Then Exit Sub\nIf Target.Address(0, 0) = \"A2\" Then\n    Application.EnableEvents = False\n    If Target &lt;&gt; \"\" Then\n        If oVal = \"\" Then\n            Range(\"B2\").Formula = \"=A2+\" &amp; initVal\n        Else\n            Range(\"B2\").Formula = \"=\" &amp; oVal &amp; \"+\" &amp; Target.Value\n        End If\n    Else\n        Range(\"B2\").Formula = \"=A2+\" &amp; initVal\n    End If\n    Application.EnableEvents = True\nEnd If\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Target.Address(0, 0) = \"A2\" Then\n    oVal = Range(\"B2\").Value\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9328151"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "closed_date": 1518043093, "accepted_answer_id": 48667017, "answer_count": 3, "score": -2, "last_activity_date": 1518017426, "creation_date": 1518015246, "question_id": 48666778, "link": "https://stackoverflow.com/questions/48666778/how-to-store-a-cell-value-in-excel-and-increment-it-with-adjacent-changing-value", "closed_reason": "Needs more focus", "title": "How to store a cell value in excel and increment it with adjacent changing value?", "body": "<p>Example - I have cell A2 = 10 and B2= 300+A2. The value in B2 will be 310. Now, if I change the value in A2 to 20, I want the value in B2 to automatically change to 330 (and not 300+20). Is there any VBA code or Excel formula which can make this happen?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518014115, "post_id": 48666219, "comment_id": 84330263, "body": "Your second formula seems incomplete.  Match takes at least two arguments and it only has one."}, {"owner": {"reputation": 19, "user_id": 6401570, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3889182f9ed1fd5cdab8885a18e13fe7?s=128&d=identicon&r=PG&f=1", "display_name": "Matt McDermott", "link": "https://stackoverflow.com/users/6401570/matt-mcdermott"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518014297, "post_id": 48666219, "comment_id": 84330405, "body": "Revised* Thanks"}, {"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1518014689, "post_id": 48666219, "comment_id": 84330689, "body": "Countif is notoriusly slow on big data sets. Try to optimaze that part some exaples here: <a href=\"https://superuser.com/questions/748509/excel-countif-slow\">superuser.com/questions/748509/excel-countif-slow</a>"}, {"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1518016499, "post_id": 48666219, "comment_id": 84332009, "body": "Btw. Why use <code>=Countif($G$1:G1,&quot;=&quot;&amp;[@[Store1]])</code> instead of <code>=Countif($G$1:G1,[@Store1])</code> - probably does not change much however is cleaner."}, {"owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "edited": false, "score": 0, "creation_date": 1518030914, "post_id": 48666219, "comment_id": 84341196, "body": "Is the G column your Map_Store column? If so, how are these formulas not circularly dependant?"}, {"owner": {"reputation": 19, "user_id": 6401570, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3889182f9ed1fd5cdab8885a18e13fe7?s=128&d=identicon&r=PG&f=1", "display_name": "Matt McDermott", "link": "https://stackoverflow.com/users/6401570/matt-mcdermott"}, "edited": false, "score": 0, "creation_date": 1518031109, "post_id": 48666219, "comment_id": 84341307, "body": "The G column is, The count begins on the header row, row 1. The formula is always looking to the above selection.  I&#39;m open to a new formula idea, or VBA options. I wanted to share what is working for me now. Its just very time consuming and process intensive."}, {"owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "edited": false, "score": 0, "creation_date": 1518044520, "post_id": 48666219, "comment_id": 84347975, "body": "Your index formula is broken (missing some square brackets) and I&#39;m unable to reproduce your top table using any corrected versions I can think of (D4 and E4, in particular, aren&#39;t matching."}], "owner": {"reputation": 19, "user_id": 6401570, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3889182f9ed1fd5cdab8885a18e13fe7?s=128&d=identicon&r=PG&f=1", "display_name": "Matt McDermott", "link": "https://stackoverflow.com/users/6401570/matt-mcdermott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518014283, "creation_date": 1518013555, "last_edit_date": 1531161705, "question_id": 48666219, "link": "https://stackoverflow.com/questions/48666219/selecting-value-from-3-columns-based-on-count-with-large-data-set-optimization", "title": "Selecting value from 3 columns based on count with large data set optimization", "body": "<p>I have a list of addresses anywhere from 50k to 300k or greater. I have 3 columns that include closest store 1, closest store 2, and closest store 3 for each row of addresses.  The formula i use is giving me the output I want, however, it take hours to calculate and occasionally errors out. I am looking for a better way to analyze the data set. The example data set is below.</p>\n\n<pre><code>| Store1 | Store2 | Store3 | CS1   | CS2    | CS3   | Map_store |\n|--------|--------|--------|-------|--------|-------|-----------|\n| 1111   | 2222   | 3333   | 0     | 0      | 0     | 1111      |\n| 1111   | 2222   | 4444   | 1     | 0      | 0     | 2222      |\n| 2222   | 5555   | 6666   | 1     | 1      | 0     | 6666      |\n| 3333   | 7777   | 8888   | 0     | 0      | 0     | 3333      |  \n</code></pre>\n\n<p>There is more columns referring to the address data but this is the core of the data set.  Store 1, 2, and 3 are aligned from closest to the address. This is why i default to store1.  </p>\n\n<p>The formula in \"CS1\" is...</p>\n\n<pre><code>=Countif($G$1:G1,\"=\"&amp;[@[Store1]])\n</code></pre>\n\n<p>The same formula is for CS2 and CS3 but with [@[Store2]] and [@[Store3]]</p>\n\n<p>The Map_Store formula is...</p>\n\n<pre><code>=index(Table1[@Store1]:[Store3],1,MATCH(MIN(Table1[@[CS1]:[CS3]),Table1[@[CS1]:[CS3],0)*2-1)\n</code></pre>\n\n<p>This chooses the minimum value of the count columns to make sure the stores are evenly distributed. The output is correct, just process intensive.</p>\n\n<p>I am hoping to optimize this process because it take anywhere from 3 to 6 hours for a list of 80k to 200k addresses to map.  Any direction of assistance is greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1518013555, "post_id": 48665891, "comment_id": 84329838, "body": "You will need to loop through each of the cells and put them individually into the array.  you can not mass assign value to an array from a disjointed range."}], "answers": [{"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1518025962, "post_id": 48666547, "comment_id": 84338375, "body": "Appreciate your helpful and straightforward approach including some workbook error handling +"}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 2, "last_activity_date": 1518014588, "creation_date": 1518014588, "answer_id": 48666547, "question_id": 48665891, "link": "https://stackoverflow.com/questions/48665891/copy-paste-multiple-ranges-vba/48666547#48666547", "title": "Copy paste multiple ranges VBA", "body": "<p>You don't need to use any variables at all other than to hold your source workbook reference:</p>\n\n<pre><code>Sub Gather()\n\n  Dim y As Workbook\n  Set y = Workbooks.Open(\"Y\")\n\n  ThisWorkbook.Sheets(\"Denominator\").Range(\"D48:F49\").Value2 = y.Sheets(\"66\").Range(\"P56:R57\").Value2\n  ThisWorkbook.Sheets(\"Denominator\").Range(\"D51:F57\").Value2 = y.Sheets(\"66\").Range(\"P62:R68\").Value2\n  ThisWorkbook.Sheets(\"Denominator\").Range(\"D59:F61\").Value2 = y.Sheets(\"66\").Range(\"P72:R74\").Value2\n\n  y.Close\n\nEnd Sub\n</code></pre>\n\n<p>Now, you can use variables, and you should, for your worksheet references. <code>ThisWorkbook</code> can change on you, especially when opening new workbooks:</p>\n\n<pre><code>Sub Gather2()\n\n  On Error GoTo ErrorHandler\n  Dim destSheet As Worksheet\n  Set destSheet = ThisWorkbook.Sheets(\"Denominator\")\n\n  Dim sourceBook As Workbook\n  Set sourceBook = Workbooks.Open(\"Y\")\n  Dim sourceSheet As Worksheet\n  Set sourceSheet = sourceBook.Sheets(\"66\")\n\n  destSheet.Range(\"D48:F49\").Value2 = sourceSheet.Range(\"P56:R57\").Value2\n  destSheet.Range(\"D51:F57\").Value2 = sourceSheet.Range(\"P62:R68\").Value2\n  destSheet.Range(\"D59:F61\").Value2 = sourceSheet.Range(\"P72:R74\").Value2\n\nCleanExit:\n  If Not sourceBook Is Nothing Then\n    sourceBook.Close\n  End If\n\n  Exit Sub\n\nErrorHandler:\n  MsgBox (\"Failed to open workbook 'y'\")\n  Resume CleanExit\n\nEnd Sub\n</code></pre>\n\n<p>I added a bit of error handling in there for you, just in case 'Y' doesn't exist.</p>\n\n<p>The next step is to add some variables for your actual range addresses so you can loop through them in case you ever need to copy more ranges, or if the ranges ever change (either source or destination).</p>\n"}, {"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1518017453, "post_id": 48666819, "comment_id": 84332702, "body": "#TIL an interesting approach! The nested loops, while not an issue on this small case, will grow exponentially in execution time as more ranges are added."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1518017754, "post_id": 48666819, "comment_id": 84332914, "body": "@FreeMan - Thanks. If there is really a possible solution where the execution time is a problem, one can define the ranges as 2 arrays like this  = <code>Array(&quot;D48:F49&quot;, &quot;D51:F57&quot;, &quot;D59:F61&quot;)</code> then the loop would not be nested and the complexity would be linear."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1518019119, "post_id": 48666819, "comment_id": 84333944, "body": "@FreeMan - actually a linear complexity is also possible, see the edit :)"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1518025412, "post_id": 48666819, "comment_id": 84338030, "body": "@Vityata - an impressive introduction to handle disjointed ranges, enjoyed it :-)"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1518029648, "post_id": 48666819, "comment_id": 84340486, "body": "@Vityata - not likely in this case, but mentioning it just to keep people thinking about it. Simple algorithms can be a real trap if you&#39;re not paying attention. I know, I&#39;ve walked into a few myself!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1518018650, "last_edit_date": 1518018650, "creation_date": 1518015370, "answer_id": 48666819, "question_id": 48665891, "link": "https://stackoverflow.com/questions/48665891/copy-paste-multiple-ranges-vba/48666819#48666819", "title": "Copy paste multiple ranges VBA", "body": "<p>In general, your code should work one step further, if you declare the ranges like this:</p>\n\n<pre><code>With Worksheets(1)\n    Set someSource = .Range(\"P56:R57, P62:R68, P72:R74\")\nEnd With\n\nWith Worksheets(2)\n    Set someTarget = .Range(\"D48:F49, D51:F57, D59:F61\")\nEnd With\n</code></pre>\n\n<p>Thus, you need one less <code>\"</code> per range. If you want to do it your way, the tricky part is to use the <code>.Areas</code> property of a Union of ranges and to loop through it. Thus, try like this:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim someSource      As Range\n    Dim someTarget      As Range\n    Dim rng1            As Range\n    Dim rng2            As Range\n\n    With Worksheets(1)\n        Set someSource = Union(.Range(\"P56:R57\"), .Range(\"P62:R68\"), .Range(\"P62:R68\"))\n    End With\n\n    With Worksheets(2)\n        'Without a Union(), but the same:\n        Set someTarget = .Range(\"D48:F49, D51:F57, D59:F61\")\n    End With\n\n    Dim cnt1 As Long\n    Dim cnt2 As Long\n\n    For Each rng1 In someSource.Areas\n        cnt1 = cnt1 + 1\n        For Each rng2 In someTarget.Areas\n            cnt2 = cnt2 + 1\n            If cnt1 = cnt2 Then\n                rng2.Value = rng1.Value\n            End If\n        Next rng2\n        cnt2 = 0\n    Next rng1\n\nEnd Sub\n</code></pre>\n\n<p>I have simplified the task, asking it to copy ranges from the first worksheet to the second one. In general it is quite the same. </p>\n\n<p>In the nested loop, the idea is that we have two collections with which we should make sure, that:</p>\n\n<ul>\n<li>Area 1 from the worksheet(2).Values = Area 1 from worksheet(1).Values</li>\n<li>Area 2 from the worksheet(2).Values = Area 2 from worksheet(1).Values</li>\n<li>Area 3 from the worksheet(2).Values = Area 3 from worksheet(1).Values</li>\n</ul>\n\n<p><strong>Edit:</strong>\nAnd if you dislike the nested loops for their O(n^2) complexity, you may use the <code>.Item(value)</code> of the Areas for a linear one:</p>\n\n<pre><code>Dim cnt     As Long\nFor cnt = 1 To someSource.Areas.Count\n    Debug.Print someSource.Areas.Item(cnt).Address\n    Debug.Print someTarget.Areas.Item(cnt).Address\n    someTarget.Areas.Item(cnt).Value = someSource.Areas.Item(cnt).Value\nNext cnt\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 3934760, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/22c945cc1ea8932cec389b3a4dd672e2?s=128&d=identicon&r=PG&f=1", "display_name": "user3934760", "link": "https://stackoverflow.com/users/3934760/user3934760"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2444, "favorite_count": 0, "accepted_answer_id": 48666547, "answer_count": 2, "score": 2, "last_activity_date": 1521478014, "creation_date": 1518012472, "last_edit_date": 1521478014, "question_id": 48665891, "link": "https://stackoverflow.com/questions/48665891/copy-paste-multiple-ranges-vba", "title": "Copy paste multiple ranges VBA", "body": "<p>I'm trying to copy paste values from one workbook to another. I would like to specify multiple ranges so I can avoid using one variable for each range. I use the below simplified code that doesn't work for me:</p>\n\n<pre><code>Sub Gather()\n\nDim y As Workbook\n\n'## Setting variables ##\n Dim Contractual_flow_mat_C66_r460_470_c120_130_140 As Variant\n\n\n'## Open Workbooks ##\n\n  Set y = Workbooks.Open(\"Y\")\n\n'## Store values ##\n\n    Contractual_flow_mat_C66_r460_470_c120_130_140 = y.Sheets(\"66\").Range(\"P56:R57\", \"P62:R68\", \"P72:R74\")\n\n'## Input the values ##\n\n    ThisWorkbook.Sheets(\"Denominator\").Range(\"D48:F49\", \"D51:F57\", \"D59:F61\") = Contractual_flow_mat_C66_r460_470_c120_130_140\n\n'## Other ##\n\ny.Close\n\nEnd Sub\n</code></pre>\n\n<p>I get the error \"Wrong number of arguments or invalid property assignment\" on this row: </p>\n\n<pre><code>Contractual_flow_mat_C66_r460_470_c120_130_140 = y.Sheets(\"66\").Range(\"P56:R57\", \"P62:R68\", \"P72:R74\")\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1518014607, "post_id": 48665887, "comment_id": 84330630, "body": "Make <code>QrySchedComp</code> a saved query. Don&#39;t create it on the fly and do not delete it. You can still use VBA to edit it&#39;s SQL before displaying it, if necessary."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1518014774, "post_id": 48665887, "comment_id": 84330742, "body": "Also, subject to SQL injection as written. Obligatory <a href=\"https://xkcd.com/327/\" rel=\"nofollow noreferrer\">XKCD</a>. Get your immediate problem solved, then take a look at that."}], "answers": [{"tags": [], "owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "is_accepted": false, "score": 0, "last_activity_date": 1518015207, "creation_date": 1518015207, "answer_id": 48666768, "question_id": 48665887, "link": "https://stackoverflow.com/questions/48665887/displaying-vba-sql-string-query-as-a-datasheet-on-a-form-in-msaccess/48666768#48666768", "title": "Displaying VBA SQL String Query as a datasheet on a form in MSAccess", "body": "<p>The line:</p>\n\n<pre><code>Set qdf = db.CreateQueryDef(\"QrySchedComp\")\n</code></pre>\n\n<p>Creates a query in access called QrySchedComp, unless you are deleting that at some other point in your code you will start generating errors after the first time you run this method because it will try to create another instance of the query with the same name.</p>\n\n<p>You can either modify its SQL statement using VBA as SunKnight0 suggested or if this is only meant to be run once, or you are deleting it somewhere else, then you can just link the query to the datasheet.</p>\n\n<p>If you don't want to do that, you can instead set a temporary query to the datasheet's recordset using:</p>\n\n<pre><code>NameOfYourForm.recordset = db.CreateQueryDef(\"\")\n</code></pre>\n\n<p>I think you will also need to enable the VBA code for the form to make this work.  I can't remember if this was dependent on that or not.  Just change the Has Module option to Yes to do that.</p>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 0, "last_activity_date": 1518029118, "last_edit_date": 1525816189, "creation_date": 1518029118, "answer_id": 48671148, "question_id": 48665887, "link": "https://stackoverflow.com/questions/48665887/displaying-vba-sql-string-query-as-a-datasheet-on-a-form-in-msaccess/48671148#48671148", "title": "Displaying VBA SQL String Query as a datasheet on a form in MSAccess", "body": "<p>A few main issues are present with your current setup: </p>\n\n<ol>\n<li><p>The reason you do not see any errors is <code>On Error Resume Next</code> which tells compiler to continue to next line on any runtime error and does not inform user of any issue. You should be raising errors in an error handling process with <code>MsgBox</code>. See this <a href=\"http://www.cpearson.com/excel/errorhandling.htm\" rel=\"nofollow noreferrer\">note</a>.</p></li>\n<li><p>You cannot use an SQL <code>SELECT</code> string in <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/docmd-openquery-method-access\" rel=\"nofollow noreferrer\">DoCmd.OpenQuery</a> as you are attempting with:</p>\n\n<pre><code>DoCmd.OpenQuery qdf.SQL, acViewNormal, acEdit\n</code></pre>\n\n<p>You must use a saved query and reference its name in the command:</p>\n\n<pre><code>DoCmd.OpenQuery \"mySavedQuery\", acViewNormal, acEdit\n</code></pre></li>\n<li><p>Continue to use QueryDef's <code>.SQL</code> property for dynamic SQL but be sure to release querydef to save changes prior to opening the datasheet view: </p>\n\n <pre class=\"lang-vb prettyprint-override\"><code>sSQL = \"...\"\n\nSet db = CurrentDb\nSet qdf = db.CreateQueryDef(\"QrySchedComp\")\n\nApplication.RefreshDatabaseWindow\nqdf.SQL = sSQL\n\n' RELEASE QUERYDEF TO SAVE CHANGES\nSet qdf = Nothing\nSet db = Nothing\n\nDoCmd.OpenQuery \"QrySchedComp\", acViewNormal, acEdit\n</code></pre></li>\n</ol>\n\n<hr>\n\n<p>With that said, consider parameterized queries using <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193967.aspx\" rel=\"nofollow noreferrer\">QueryDef parameters</a> that avoids quote/pound sign enclosures and string concatenation, and abstracts data from code, not to mention it safely avoids SQL injection, a potential issue of user input.</p>\n\n<p>And since you are iterating across a multiple select listbox, consider using a temp table that replicates structure of current query. This might even yield better performance for your users as you avoid the <code>JOIN</code> on a <code>UNION</code> query in datasheet for any filtering and searching needs.</p>\n\n<p><strong>SQL</strong> </p>\n\n<p>Make-table action query to create temp table to be run only <strong>once</strong> to replicate structure:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT TOP 1 * INTO tmpSchedComp FROM QrySchedComp\n</code></pre>\n\n<p>Save action query only <strong>once</strong> as a stored, parameterized query <em>(no data)</em>:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>PARAMETERS SiteParam Text(255), ScheduleParam Text(255), \n           DateStartParam Datetime, DateEndParam Datetime;\nINSERT INTO tmpSchedComp ([Task No], [Task Detail], [USVF Compliance], \n                          [DIO Contract Compliance],  [Other Compliance])\nSELECT BFMA_TaskList.Task AS [Task No], [Task Group] &amp; '' &amp; [Task Details] AS [Task Detail], \n       '' AS [USVF Compliance], '' AS [DIO Contract Compliance], '' AS [Other Compliance]\nFROM [BFMA_TaskList] \nINNER JOIN [Qry_Union] ON [BFMA_TaskList].[Task] = [Qry_Union].[Task] \nWHERE [Qry_Union].[Site] = [SiteParam] AND [BFMA_TaskList].[Schedule] = [ScheduleParam]\n  AND [Qry_Union].[Planned Date] BETWEEN [DateStartParam] AND [DateEndParam]\n</code></pre>\n\n<p><strong>VBA</strong> <em>(run loop without <code>OR</code> concatenation to append records per site, then open temp table)</em></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>...\nSet db = CurrentDb\n' CLEAN OUT TEMP TABLE\ndb.Execute \"DELETE FROM tmpSchedComp\", dbFailOnError\n\n' INITIALIZE QUERYDEF (ACTION QUERY)\nSet qdf = db.CreateQueryDef(\"AppnSchedComp\")\n\n' POPULATE TEMP TABLE\nFor Each varItem In Me.lstsite.ItemsSelected      \n   ' BIND VALUES TO PARAMETERS\n    qdf!SiteParam = Me.lstsite.ItemData(varItem)\n    qdf!ScheduleParam = Me![TxtSchLetter]\n    qdf!DateStartParam = Me![txtschfrom]\n    qdf!DateEndParam = Me![txtschto]\n\n    ' EXECUTE ACTION\n    qdf.Execute dbFailOnError\nNext varItem\n\nSet qdf = Nothing\nSet db = Nothing\n\nDoCmd.OpenTable \"tmpSchedComp\", acViewNormal\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9288091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd9c877d39d20c61d465ea6485636668?s=128&d=identicon&r=PG&f=1", "display_name": "ASyr", "link": "https://stackoverflow.com/users/9288091/asyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 646, "favorite_count": 0, "accepted_answer_id": 48671148, "answer_count": 2, "score": 1, "last_activity_date": 1518029118, "creation_date": 1518012451, "last_edit_date": 1518025373, "question_id": 48665887, "link": "https://stackoverflow.com/questions/48665887/displaying-vba-sql-string-query-as-a-datasheet-on-a-form-in-msaccess", "title": "Displaying VBA SQL String Query as a datasheet on a form in MSAccess", "body": "<p>I am having trouble trying to execute a SQL string within VBA to display a datasheet with criteria from a form. At the moment once the command button is pressed it doesn't seem to do anything because it returns no errors. My idea is to replicate an in built query that access creates as it returns the results in a datasheet. </p>\n\n<p>My Code is below:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cmdschcompliance_Click()\nDim sSQL As String\nDim db As DAO.Database\nDim strCriteria As String\nDim varItem As Variant\nDim strSql As String\nDim qdf As DAO.QueryDef\n\nIf Me.lstsite.ItemsSelected.Count = 0 Then\n    MsgBox \"Please Select a Site:\"\n    Exit Sub\nElseIf IsNull(Me.txtschfrom.Value) Then\n    MsgBox \"Please Enter Date From:\"\n    Exit Sub\nElseIf IsNull(Me.txtschto.Value) Then\n    MsgBox \"Please Enter Date To:\"\n    Exit Sub\nElseIf IsNull(Me.TxtSchLetter.Value) Then\n    MsgBox \"Please Enter Schedule Letter:\"\n    Exit Sub\nEnd If\n\nFor Each varItem In Me.lstsite.ItemsSelected\n    strCriteria = strCriteria &amp; \"[Qry_Union].[Site]='\" &amp; Me.lstsite.ItemData(varItem) &amp; \"' Or \"\nNext\nIf Right(strCriteria, 4) = \" Or \" Then strCriteria = \"(\" &amp; Left(strCriteria, Len(strCriteria) - 4) &amp; \")\"\n\n\nsSQL = \"SELECT BFMA_TaskList.Task AS [Task No], [Task Group] &amp; \"\" \"\" &amp; [Task Details] AS [Task Detail], \"\"\"\" AS [USVF Compliance], \"\"\"\" AS [DIO Contract Compliance], \"\"\"\" AS [Other Compliance]\" &amp; _\n\"FROM [BFMA_TaskList] INNER JOIN [Qry_Union] ON [BFMA_TaskList].[Task] = [Qry_Union].[Task] \" &amp; _\n\"WHERE \" &amp; strCriteria &amp; \" AND [BFMA_TaskList].[Schedule]='\" &amp; Me![TxtSchLetter] &amp; \"' AND [Qry_Union].[Planned Date] Between #\" &amp; Format(Me![txtschfrom], \"mm\\/dd\\/yy\") &amp; \"# And #\" &amp; Format(Me![txtschto], \"mm\\/dd\\/yy\") &amp; \"#;\"\n\nSet db = CurrentDb\nSet qdf = db.CreateQueryDef(\"QrySchedComp\")\nApplication.RefreshDatabaseWindow\nqdf.SQL = sSQL\n\n\nOn Error Resume Next\n'Delete the query if it already exists\nDoCmd.DeleteObject acQuery, \"QrySchedComp\"\n\nDoCmd.OpenQuery qdf.SQL, acViewNormal, acEdit\n\n'release memory\nqdf.Close\nSet qdf = Nothing\nSet db = Nothing\nEnd Sub\n</code></pre>\n\n<p>I am new to VBA and SQL so any information will be greatly appreciated. Thank you.</p>\n"}, {"tags": ["vba", "forms", "web", "dropdown"], "comments": [{"owner": {"reputation": 1131, "user_id": 5793276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13c6f48c0b69a432e49bbfc7e944ec6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Yunke", "link": "https://stackoverflow.com/users/5793276/dr-yunke"}, "edited": false, "score": 0, "creation_date": 1518014055, "post_id": 48665697, "comment_id": 84330212, "body": "There is no question, so there cant be an answer. So you say, the code works... apparently it fills in <code>Agent_Name_txtText</code>. Now what do you want to do with the dropdown list? Select a value from dropdown list?"}, {"owner": {"reputation": 1131, "user_id": 5793276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13c6f48c0b69a432e49bbfc7e944ec6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Yunke", "link": "https://stackoverflow.com/users/5793276/dr-yunke"}, "edited": false, "score": 0, "creation_date": 1518014288, "post_id": 48665697, "comment_id": 84330399, "body": "If so try <code>IE.document.getElementbyid(&quot;p_lt_ctl03_pageplaceholder_p_lt_&zwnj;&#8203;ctl00_On_lineForm_vi&zwnj;&#8203;ewBiz_Shop_dropDownL&zwnj;&#8203;ist&quot;).value = [somevalue]</code>  or  <code>IE.document.getElementbyid(&quot;p_lt_ctl03_pageplaceholder_p_lt_&zwnj;&#8203;ctl00_On_lineForm_vi&zwnj;&#8203;ewBiz_Shop_dropDownL&zwnj;&#8203;ist&quot;).selectedIndex = 0</code> (or any number between 0 and the number of items -1)"}, {"owner": {"reputation": 11, "user_id": 9326048, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9EZZPdO3WoA/AAAAAAAAAAI/AAAAAAAAAD8/539XVsMqucI/photo.jpg?sz=128", "display_name": "Trainferry", "link": "https://stackoverflow.com/users/9326048/trainferry"}, "reply_to_user": {"reputation": 1131, "user_id": 5793276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13c6f48c0b69a432e49bbfc7e944ec6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Yunke", "link": "https://stackoverflow.com/users/5793276/dr-yunke"}, "edited": false, "score": 0, "creation_date": 1518015076, "post_id": 48665697, "comment_id": 84330978, "body": "Thank you, the first code works fine!"}], "answers": [{"tags": [], "owner": {"reputation": 1131, "user_id": 5793276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13c6f48c0b69a432e49bbfc7e944ec6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Yunke", "link": "https://stackoverflow.com/users/5793276/dr-yunke"}, "is_accepted": false, "score": 0, "last_activity_date": 1518054098, "last_edit_date": 1518054098, "creation_date": 1518015756, "answer_id": 48666938, "question_id": 48665697, "link": "https://stackoverflow.com/questions/48665697/dropdown-in-webform/48666938#48666938", "title": "Dropdown in webform", "body": "<p>To select an element from that dropdown list, you should do</p>\n\n<p><code>IE.document.getElementbyid(\"p_lt_ctl03_pageplaceholder_p_lt_ctl00_On_lineForm_viewBiz_Shop_dropDownList\").value = [somevalue]</code></p>\n\n<p>where [somevalue] is the value you want to set for that dropdown list.</p>\n\n<p>Alternatively (and I haven't tried), you can try selectedIndex property as follows</p>\n\n<p><code>IE.document.getElementbyid(\"p_lt_ctl03_pageplaceholder_p_lt_ctl00_On_lineForm_viewBiz_Shop_dropDownList\").selectedIndex = [Index]</code></p>\n\n<p>where [Index] is a number between 0 and the (number of items - 1).</p>\n"}], "owner": {"reputation": 11, "user_id": 9326048, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9EZZPdO3WoA/AAAAAAAAAAI/AAAAAAAAAD8/539XVsMqucI/photo.jpg?sz=128", "display_name": "Trainferry", "link": "https://stackoverflow.com/users/9326048/trainferry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518054098, "creation_date": 1518011924, "last_edit_date": 1518014167, "question_id": 48665697, "link": "https://stackoverflow.com/questions/48665697/dropdown-in-webform", "title": "Dropdown in webform", "body": "<p>Thank you for the answer on my previous answer. I\u2019m relative new to VBScript, so I need once more a bit of help. So far I\u2019ve this code, and it works</p>\n\n<pre><code>Private Sub CommandButton3_Click()\n\n  Set IE = CreateObject(\"InternetExplorer.Application\")\nWith IE\n.Visible = True\n.navigate \"http://rapido.connect.local/Forms/Refund-Request.aspx\"\nEnd With\n\nDo Until IE.readyState = 4\nDoEvents\nLoop\n\n\n   'Find &amp; Fill Out Input Box\n   IE.document.getElementbyid(\"p_lt_ctl03_pageplaceholder_p_lt_ctl00_On_lineForm_viewBiz_Agent_Name_txtText\").Value = ThisWorkbook.Sheets(\"Berekeningsblad\").Range(\"j8\")\n   'Unload IE\nendmacro:\n   Set IE = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>However, the form starts with a dropdown list. I tried several things, but I\u2019m afraid that I\u2019m a bit stuck. I would like to select 1 of the values in the dropdown list.  This is the source code of the dropdown list:</p>\n\n<pre><code>&lt;div id=\"p_lt_ctl03_pageplaceholder_p_lt_ctl00_On_lineForm_viewBiz_pnlForm\" class=\"FormPanel\" onkeypress=\"javascript:return WebForm_FireDefaultButton(event, &amp;#39;p_lt_ctl03_pageplaceholder_p_lt_ctl00_On_lineForm_viewBiz_btnOK&amp;#39;)\"&gt;\n        &lt;table class=\"EditingFormTable\"&gt;&lt;tr id=\"Shop\"&gt;&lt;td class=\"FieldLabel\"&gt;&lt;label id=\"p_lt_ctl03_pageplaceholder_p_lt_ctl00_On_lineForm_viewBiz_Shop_lb\" class=\"EditingFormLabel\" for=\"p_lt_ctl03_pageplaceholder_p_lt_ctl00_On_lineForm_viewBiz_Shop_dropDownList\"&gt;Shop:&lt;/label&gt;&lt;/td&gt;&lt;td class=\"EditingFormValueCell\"&gt;&lt;div id=\"p_lt_ctl03_pageplaceholder_p_lt_ctl00_On_lineForm_viewBiz_ncpshop\" class=\"EditingFormControlNestedControl editing-form-control-nested-control\"&gt;\n            &lt;select name=\"p$lt$ctl03$pageplaceholder$p$lt$ctl00$On_lineForm$viewBiz$Shop$dropDownList\" id=\"p_lt_ctl03_pageplaceholder_p_lt_ctl00_On_lineForm_viewBiz_Shop_dropDownList\" class=\"DropDownField form-control\"&gt;\n                &lt;option selected=\"selected\" value=\"aal@XX.be\"&gt;AAL&lt;/option&gt;\n                &lt;option value=\"accounts@XX.be\"&gt;ACC&lt;/option&gt;\n                &lt;option value=\"apt@xx.be\"&gt;APT&lt;/option&gt;\n                &lt;option value=\"contactcenter@xx.be\"&gt;AST CC &lt;/option&gt;\n                &lt;option value=\"gent@airstop.be\"&gt;ASTGNT&lt;/option&gt;\n                &lt;option value=\"ATS@xx.be\"&gt;ATS&lt;/option&gt;\n                &lt;option value=\"b2b@xx.be\"&gt;B2B&lt;/option&gt;\n                &lt;option value=\"bra@xx.be\"&gt;BRA&lt;/option&gt;\n                &lt;option value=\"brg@xx.be\"&gt;BRG&lt;/option&gt;\n                &lt;option value=\"bto@xx.be\"&gt;BTO&lt;/option&gt;\n                &lt;option value=\"bts@xx.be\"&gt;BTS&lt;/option&gt;\n                &lt;option value=\"resa@xx.be\"&gt;ECOM&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 181, "user_id": 6850280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e4db5ded7a05307f423fd469f935e?s=128&d=identicon&r=PG&f=1", "display_name": "matt2103", "link": "https://stackoverflow.com/users/6850280/matt2103"}, "edited": false, "score": 0, "creation_date": 1518012195, "post_id": 48665680, "comment_id": 84328897, "body": "I think you&#39;ve narrowed the info too much - I&#39;m not clear on what your question is.  What about the above code isn&#39;t working?"}, {"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1518013549, "post_id": 48665680, "comment_id": 84329832, "body": "Have you tried using <code>find</code> or <code>match</code> using <code>CountIf</code> with a loop ?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1518018932, "post_id": 48665680, "comment_id": 84333808, "body": "You are using <code>ThisWorkbook.Sheets(&quot;Dashboard&quot;)</code> and <code>ThisWorkbook.Sheets(&quot;Overview and Filters&quot;)</code> repeatedly. I would suggest to qualify these sheets and use the qualified object. This will make your code a lot more readable and smaller. At the moment I&#39;m struggling to understand your code. Just a suggestion"}, {"owner": {"reputation": 138, "user_id": 9327782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad5ef446b497016fd4b0cfb24e1a064?s=128&d=identicon&r=PG&f=1", "display_name": "Yellow", "link": "https://stackoverflow.com/users/9327782/yellow"}, "edited": false, "score": 0, "creation_date": 1518099589, "post_id": 48665680, "comment_id": 84373096, "body": "@ matt The problem is when I filter the data in the Overview Tab, both the cell coloring code, the yes or no data entrie code and the lines of code that count the completion status options do not work ovet the filtered selection.  Instead they start at the second row of cells and then check down the amount of cells that has been filtered. I want them to only work on the filtered options instead of what they do now.  @ mitch, no I havent. Could you explain a bit further what you mean?  @ Zac i will adjust the code tomorrow afternoon and upload a more comprehensible version."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518176220, "post_id": 48665680, "comment_id": 84408179, "body": "You don&#39;t use _ after the key word &quot;Then&quot; as it is a natural line break and does not need a line continuation i.e. Then _ should be just Then as you will then be onto the next statement."}, {"owner": {"reputation": 138, "user_id": 9327782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad5ef446b497016fd4b0cfb24e1a064?s=128&d=identicon&r=PG&f=1", "display_name": "Yellow", "link": "https://stackoverflow.com/users/9327782/yellow"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518176507, "post_id": 48665680, "comment_id": 84408329, "body": "@QHarr thanks for the feedback, adjusted it. However that was not the one causing me most headache ;) Any ideas how to get the main problem solved?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518176550, "post_id": 48665680, "comment_id": 84408359, "body": "What do you mean by filter? Is there a filter already applied that is not visible in the above code?"}, {"owner": {"reputation": 138, "user_id": 9327782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad5ef446b497016fd4b0cfb24e1a064?s=128&d=identicon&r=PG&f=1", "display_name": "Yellow", "link": "https://stackoverflow.com/users/9327782/yellow"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518176853, "post_id": 48665680, "comment_id": 84408544, "body": "@QHarr Yeah, like I mentioned, the data sets in Sheet &quot;Two&quot; can be filtered using a drop down menu in the first row of that sheet. If no filter is applied (e.g filter is on &quot;Select All&quot;) then the code works. However when I select a filter to apply from the drop down menu the code doesn&#39;t adjust accordingly, it keeps working over all present data sets instead of working only over the filtered selection."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518177189, "post_id": 48665680, "comment_id": 84408739, "body": "Also can you not  start DataGetCompletion = 3 and get rid of  DataGetCompletion + 2 ?"}, {"owner": {"reputation": 138, "user_id": 9327782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad5ef446b497016fd4b0cfb24e1a064?s=128&d=identicon&r=PG&f=1", "display_name": "Yellow", "link": "https://stackoverflow.com/users/9327782/yellow"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518177339, "post_id": 48665680, "comment_id": 84408828, "body": "@QHarr Yes that would be possible, I may not be the neatest writer when it comes to code. Elegance is not my strong point. However, that&#39;s not really the point why I posted this topic."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518177385, "post_id": 48665680, "comment_id": 84408854, "body": "I am working my way through your code but wanted to check my understanding."}], "answers": [{"comments": [{"owner": {"reputation": 138, "user_id": 9327782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad5ef446b497016fd4b0cfb24e1a064?s=128&d=identicon&r=PG&f=1", "display_name": "Yellow", "link": "https://stackoverflow.com/users/9327782/yellow"}, "edited": false, "score": 0, "creation_date": 1518419054, "post_id": 48707368, "comment_id": 84481483, "body": "Damn, thanks man, that really helped a lot, was able to get the sequencing fine tuned thanks to you. I&#39;ve got it set up an running over small data sets, getting ready to test it out on the big batches later this week. It works so far and does exactly what I want it to."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1518184142, "creation_date": 1518184142, "answer_id": 48707368, "question_id": 48665680, "link": "https://stackoverflow.com/questions/48665680/moving-data-entry-with-filter-options/48707368#48707368", "title": "Moving data entry with filter options", "body": "<p>Maybe try doing a check on whether the row is visible within the loop range. The principle being, whatever you are looping over, see if the <code>.EntireRow.Hidden</code> status of <code>CompletionStatus</code> is <code>False</code>. If <code>False</code> it means it is visible and you want to do your check.</p>\n\n<pre><code> For Each CompletionStatus In loopRange\n\n        If CompletionStatus.EntireRow.Hidden = False Then\n\n            Select Case h8Range\n\n            Case 1 'this was 1 in yours\n\n                CompletionStatus.Interior.ColorIndex = 4\n                CompletionStatus.Value = \"Both data sets complete\"\n\n            Case 2 'this was 0 in yours\n\n                CompletionStatus.Interior.ColorIndex = 3\n                CompletionStatus.Value = \"Both data sets missing\"\n\n            End Select\n\n        End If\n\n    Next CompletionStatus\n</code></pre>\n\n<p>I re-wrote the entire code, without knowing what your data looks like to something like as follows. I don't expect it to work off the bat for you but shows you a structure. I don't think a lot of the elements were actually doing anything which is why I have removed them. Let's hope not in error. However, the principle at the start for how to solve your problem remains the same.</p>\n\n<pre><code>Option Explicit\n\nSub CompletionStatusUpdate()\n\n    Dim CompletionStatus As Range\n    Dim wb As Workbook\n    Set wb = ThisWorkbook\n    Dim ws1 As Worksheet\n    Set ws1 = wb.Sheets(\"One\")\n    Dim ws2 As Worksheet\n    Set ws2 = wb.Sheets(\"Two\")\n\n    Dim h9Range As Range\n    Set h9Range = ws1.Range(\"H9\")\n\n    'Test for h9Range being not empty and that is greater than 2?\n    ws2.Range(\"H2:H\" &amp; h9Range.Value + 1).Interior.ColorIndex = 0 'if this is intended to clear prior runs it needs + 1\n    ws2.Range(\"H2:H\" &amp; h9Range.Value + 1).ClearContents 'This seems to be the same as loopRange?\n\n    Dim completeRange As Range\n    Set completeRange = ws1.Range(\"H11\")\n\n    Dim missingRange As Range\n    Set missingRange = ws1.Range(\"H13\")\n\n    missingRange.ClearContents\n    completeRange.ClearContents\n\n    Dim h8Range As Range\n    Set h8Range = ws1.Range(\"H8\")\n\n    Dim dRange As Range\n    Set dRange = ws2.Range(\"D\" &amp; h9Range.Value)\n\n    Dim fRange As Range\n    Set fRange = ws2.Range(\"F\" &amp; h9Range.Value)\n\n    Dim countRange As Range\n    Set countRange = ws2.Range(\"H2:H\" &amp; h9Range.Value + 1)\n\n    Dim h6Range As Range\n    Set h6Range = ws1.Range(\"H6\")\n\n    Dim loopRange As Range\n\n    Set loopRange = ws2.Range(\"H2:H\" &amp; h9Range.Value + 1).SpecialCells(xlCellTypeVisible)\n\n    DataGetCompletion = 3\n\n\n    If dRange = \"Yes\" And fRange = \"Yes\" Then\n\n        h8Range = 1\n\n    ElseIf dRange = \"No\" And fRange = \"No\" Then\n\n        h8Range = 2\n\n    Else\n\n        h8Range = 3\n\n    End If\n\n\n    For Each CompletionStatus In loopRange\n\n        If CompletionStatus.EntireRow.Hidden = False Then\n\n            Select Case h8Range\n\n            Case 1\n\n                CompletionStatus.Interior.ColorIndex = 4\n                CompletionStatus.Value = \"Both data sets complete\"\n\n            Case 2\n\n                CompletionStatus.Interior.ColorIndex = 3\n                CompletionStatus.Value = \"Both data sets missing\"\n\n            End Select\n\n        End If\n\n    Next CompletionStatus\n\n\n    completeRange = Application.WorksheetFunction.CountIf _\n                    (countRange, \"Both data sets complete\")\n\n    missingRange = Application.WorksheetFunction.CountIf _\n                   (countRange, \"Both data sets missing\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 138, "user_id": 9327782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad5ef446b497016fd4b0cfb24e1a064?s=128&d=identicon&r=PG&f=1", "display_name": "Yellow", "link": "https://stackoverflow.com/users/9327782/yellow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 48707368, "answer_count": 1, "score": 3, "last_activity_date": 1518184142, "creation_date": 1518011853, "last_edit_date": 1518176444, "question_id": 48665680, "link": "https://stackoverflow.com/questions/48665680/moving-data-entry-with-filter-options", "title": "Moving data entry with filter options", "body": "<p>First off prepare for a long read, I've narrowed down the info as much as I could.</p>\n\n<p>So I am using VBA since a little while now and I've encountered a problem which I can not seem to solve. I'm using a code in VBA to do the following:\nSheet \"Two\" contains multiple rows of data sets. These data sets can be filtered using dropdown menus in the first row of the sheet. I've set up a macro to check if the necessary data sets are present, which can be checked for by seeing if there is text present in certain rows. If there is text then a corresponding box is filled and colored accordingly, the same applies if data is missing. After the loop is completed it counts a summary of the cells with all data and with missing data an fills this in an overview on Sheet \"One\".</p>\n\n<p>When the code needs to run for the entire column to check data in, it will do so without problems. However when a filter is selected the code does no start at the filtered selection, instead it starts at the second cell in the column. It does because I defined the second cell as the starting point. I cannot figure out however how to define the starting point in such a dynamic way that it will follow with the filter settings. Furthermore the code does not compensate for \"gaps\" (e.g. when the filter settings make the row jump from row 5 to row 30, the code will keep counting on from 5, it does not jump along so to speak). As the data sets can number up to around 150.000 a lot of gaps can be present, so this cripples the code heavily.\nSee my code below.</p>\n\n<pre><code>    Sub CompletionStatusUpdate()\n\n    Dim CompletionStatus As Range 'Creates list to check for Completion Status\n    Dim DataGetCompletion As Long 'Defines counter to determine maximum list limit to check\n\n    ThisWorkbook.Sheets(\"Two\").Range(\"H2:H\" &amp; ThisWorkbook.Sheets(\"One\").Range(\"H9\").Value).Interior.ColorIndex = 0 'Reset Colors in 2nd Tab for Completion Status\n    ThisWorkbook.Sheets(\"Two\").Range(\"H2:H\" &amp; ThisWorkbook.Sheets(\"One\").Range(\"H9\")).Value = \"\" 'Reset Values in 2nd Tab for Completion Status  \n    'Cell H9 in Sheet One contains a CountA function which checks the amount of data present in Sheet Two. Right now it counts the entire amount of data in row C, \n    'however this needs to be adjusted to only count the cells of data which are filtered in row C\n\n    For Each CompletionStatus In ThisWorkbook.Sheets(\"Two\").Range(\"H2:H\" &amp; ThisWorkbook.Sheets(\"One\").Range(\"H9\").Value + 1) \n    'Creates loop for cells that need to be filled/colored\n    'This needs to run over only the filtered cells in the selection\n    'Instead of over the H column untill H9 value is reached regardles of filters\n\n    DataGetCompletion = (DataGetCompletion + 1) 'DataGetCompletion Counter for Range, used to move the position of cells to fill in\n\n    ThisWorkbook.Sheets(\"One\").Range(\"H6\").Value = DataGetCompletion + 2 'Ticks up for each loop run through, corrected for the starting cell\n    'Again this needs adjust dependant on the filter settings\n\n    If ThisWorkbook.Sheets(\"Two\").Range(\"D\" &amp; ThisWorkbook.Sheets(\"One\").Range(\"H9\")).Value = \"Yes\" And _\n       ThisWorkbook.Sheets(\"Two\").Range(\"F\" &amp; ThisWorkbook.Sheets(\"One\").Range(\"H9\")).Value = \"Yes\" Then \n       ThisWorkbook.Sheets(\"One\").Range(\"H8\").Value = 1 'Both Data sets are present,used in separate logic\n    End If 'This needs to check only filtered cells as well, instead of all cells\n\n    If ThisWorkbook.Sheets(\"Two\").Range(\"D\" &amp; ThisWorkbook.Sheets(\"One\").Range(\"H9\")).Value = \"No\" And _\n       ThisWorkbook.Sheets(\"Two\").Range(\"F\" &amp; ThisWorkbook.Sheets(\"One\").Range(\"H9\")).Value = \"No\" Then \n       ThisWorkbook.Sheets(\"One\").Range(\"H8\").Value = 0 'Both data sets missing, used in separate logic\n    End If 'This needs to check only filtered cells as well, instead of all cells\n\n    If ThisWorkbook.Sheets(\"One\").Range(\"H8\") = 0 Then 'Both data sets missing, so problem\n       CompletionStatus.Interior.ColorIndex = 3 'Colors cell red\n       CompletionStatus.Value = \"Both data sets missing\" 'Displays missing information\n    End If\n\n    If ThisWorkbook.Sheets(\"One\").Range(\"H8\") = 1 Then 'Data sets complete\n       CompletionStatus.Interior.ColorIndex = 4 'Colors cell green\n       CompletionStatus.Value = \"Both data sets complete\" 'Displays completion\n    End If\n\n    Next CompletionStatus 'Reruns loop till completion\n\n    ThisWorkbook.Sheets(\"One\").Range(\"H11\").Value = Application.WorksheetFunction.CountIf _\n    (ThisWorkbook.Sheets(\"Two\").Range(\"H2:H\" &amp; ThisWorkbook.Sheets(\"One\").Range(\"H9\").Value + 1), \"Both data sets complete\")\n\n    'Displays amount of complete data sets \n    'This part of the code also needs to run over the filtered selection in the H column, instead of starting from H2 and running till value Sheet One, H9 is reached\n\n    ThisWorkbook.Sheets(\"One\").Range(\"H13\").Value = Application.WorksheetFunction.CountIf _\n    (ThisWorkbook.Sheets(\"Two\").Range(\"H2:H\" &amp; ThisWorkbook.Sheets(\"One\").Range(\"H9\").Value + 1), \"Both data sets missing\")\n\n    'Displays amount of missing data sets\n    'This part of the code also needs to run over the filtered selection in the H column, instead of starting from H2 and running till value Sheet One, H9 is reached\n\n     End Sub\n</code></pre>\n\n<p>I just cant seem to get it to work with the filters, I've tried different applications of the <code>.SpecialCells(xlCellTypeVisible)</code> code but it didn't help me.</p>\n\n<p>Any Help would be greatly appreciated, if something is not clear please let me know.</p>\n"}, {"tags": ["excel", "vba", "userform"], "answers": [{"tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": false, "score": 0, "last_activity_date": 1518013177, "creation_date": 1518013177, "answer_id": 48666114, "question_id": 48665590, "link": "https://stackoverflow.com/questions/48665590/programmatically-filling-a-multi-column-listbox/48666114#48666114", "title": "Programmatically Filling a Multi-Column ListBox", "body": "<p>Try the below simple code first. If it works fine, then check your arrays and other references</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    ListBox1.ColumnCount = 5\n    ListBox1.ColumnWidths = \"20;20;20;20;20;\"\n\n    Dim i As Integer\n    With ListBox1\n        For i = 0 To 5\n            .AddItem\n            .List(i, 0) = i\n            .List(i, 1) = i\n            .List(i, 2) = i\n            .List(i, 3) = i\n            .List(i, 4) = i\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 0, "last_activity_date": 1518013473, "creation_date": 1518013473, "answer_id": 48666193, "question_id": 48665590, "link": "https://stackoverflow.com/questions/48665590/programmatically-filling-a-multi-column-listbox/48666193#48666193", "title": "Programmatically Filling a Multi-Column ListBox", "body": "<p>Your code looks correct. </p>\n\n<p>For debugging: the debugger is apt to return to the caller modul in case of an error within an object modul, that may be the reason for stopping on line <code>UserForm.Show</code>. You could try to set something like <code>On Error Resume Next</code> to override the default errorhandler within the modul (just for testing) to catch the bug. </p>\n\n<p>For managing multiple selection: </p>\n\n<pre><code>For i = 0 To ListBox1.ListCount - 1\n    If ListBox1.Selected(i) Then\n        ' do something\n    End If\nNext\n</code></pre>\n\n<p>N.b.: for deleting selected items you need to reverse the loop because .ListCount is changing, so</p>\n\n<pre><code>For i = ListBox1.ListCount - 1 to Step -1\n    If ListBox1.Selected(i) Then\n        Listbox1.RemoveItem(i)\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9173575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f3cf780b0dc18e222b118f9e341c34?s=128&d=identicon&r=PG&f=1", "display_name": "HerbalTea", "link": "https://stackoverflow.com/users/9173575/herbaltea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1008, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518013473, "creation_date": 1518011605, "last_edit_date": 1518011637, "question_id": 48665590, "link": "https://stackoverflow.com/questions/48665590/programmatically-filling-a-multi-column-listbox", "title": "Programmatically Filling a Multi-Column ListBox", "body": "<p>I'm looking to fill a UserForm with a multi-column ListBox to choose from. The ListBox columns are filled with data stored in custom class modules objects (Work Requests &amp; Component). I've made my logic as clear as I can, looking for help on the correct way to implement this.</p>\n\n<p>I get the error</p>\n\n<blockquote>\n  <p>Run-time error '381': Could not set the List property. Invalid\n  Property array index.</p>\n</blockquote>\n\n<p>, with the debugger highlighting the line <code>UserForm.Show</code>.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    ListBox1.ColumnCount = 5\n    ListBox1.ColumnWidth = \u201c100;100;100;100;100;\u201d\n\n    Dim i as Integer\n    With ListBox1\n        For i = 0 to (wrArraySize - 1)\n            .AddItem\n            .List(i, 0) = WorkRequests(i + 1).WorkRequestNumber\n            .List(i, 1) = WorkRequests(i + 1).Product\n            .List(i, 2) = WorkRequests(i + 1).ComponentName\n            .List(i, 3) = WorkRequests(i + 1).NumberPiecesCompleted\n            .List(i, 4) = WorkRequests(i + 1).NumberPiecesTotal\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Furthermore, if you have an extra moment to spare, I then need to know how to references all the selected ListBox entries (i.e. using CTRL + Click to select non-adjacent items). Thank you.</p>\n"}, {"tags": ["json", "vba"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518011295, "post_id": 48665322, "comment_id": 84328282, "body": "Which line is throwing the error?"}, {"owner": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1518011336, "post_id": 48665322, "comment_id": 84328316, "body": "@CallumDA it seems in the IF statement"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518011653, "post_id": 48665322, "comment_id": 84328558, "body": "What is the value of rowNote? (also, why is it declared as a <code>String</code>? it would make more sense for it to be a <code>Long</code>)"}, {"owner": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518011831, "post_id": 48665322, "comment_id": 84328664, "body": "@CallumDA i have many other modules through my project working normally with rownote. This is the first time i have nested loops and i usually use rownote just to iterate through the rows of the spreadsheet. why are you implying the problem would be from rownote?"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518011943, "post_id": 48665322, "comment_id": 84328744, "body": "only because there&#39;s practically nothing else in your IF statement - which is where you&#39;re getting the error. The line above could well throw an index out of range error: <code>ParseJson(http.responseText)(&quot;results&quot;)(1)(&quot;CustomerStatus&quot;) </code> if there are no results"}, {"owner": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518012280, "post_id": 48665322, "comment_id": 84328943, "body": "@CallumDA what if some users dont have active account yet? maybe this is not explained well within the loops."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518012453, "post_id": 48665322, "comment_id": 84329059, "body": "I don&#39;t know but is there any way you can check for this instance if (&quot;results&quot;)(1)(&quot;CustomerStatus&quot;) exists? All I can say is that the error message suggests that you&#39;re trying to access an index in an array that doesn&#39;t exist - this could be a &quot;results&quot; array as per above"}, {"owner": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518013431, "post_id": 48665322, "comment_id": 84329746, "body": "@CallumDA the code is working fine if it finds this condition and it is showing \u201c1\u201d. I\u2019ll check maybe in other accounts if the key exists and will update you"}, {"owner": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1518014431, "post_id": 48665322, "comment_id": 84330506, "body": "@CallumDA yes i checked and there is the same key in all kinds of accounts. so the problem isnt here."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1518016723, "post_id": 48665322, "comment_id": 84332164, "body": "Is the code failing at the end, or somewhere in the middle? In my experience something like count = count + 1 could be causing the very last loop to fail because that last value is one more than items in the array. Try a <code>debug.Print count, totalCount</code> just before the <code>Next</code>."}, {"owner": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1518017366, "post_id": 48665322, "comment_id": 84332631, "body": "@CindyMeister weird, it is like that: count -&gt; totalCount, 6 -&gt; 5, 2 -&gt; 5, 4 -&gt; 5, again repeating, 6 -&gt; 5, 2 -&gt; 5, 4 -&gt; 5, this pattern is repeated 17 times"}, {"owner": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1518017489, "post_id": 48665322, "comment_id": 84332727, "body": "@CindyMeister so yes the counter is bigger than the max counts and is causing the error"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1518021367, "post_id": 48665322, "comment_id": 84335498, "body": "Then you need to do something like <code>If count &gt;= totalCount Then Exit For</code>"}, {"owner": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1518022372, "post_id": 48665322, "comment_id": 84336180, "body": "@CindyMeister i added sample json that are used above if that does help. with the condition you proposed now the error disappeared but the primary loop isnt looping"}], "answers": [{"comments": [{"owner": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "edited": false, "score": 0, "creation_date": 1518033150, "post_id": 48670898, "comment_id": 84342518, "body": "Thank you Tim for your answer, regarding count = count + 1 it is still inside the for loop although you notified me I shouldn\u2019t modify it. Or am I misunderstanding something."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "edited": false, "score": 0, "creation_date": 1518033580, "post_id": 48670898, "comment_id": 84342728, "body": "I did not try to figure out why that was there; just pointing out it&#39;s typically not something you&#39;d do with a For loop variable.  If it works then fine, but it&#39;s  not a good practise..."}, {"owner": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "edited": false, "score": 0, "creation_date": 1518035707, "post_id": 48670898, "comment_id": 84343842, "body": "Tim would I have an iteration problem if sometimes totalcount happens to be 1? Also, once the condition is true, shouldn\u2019t I add: exit for , in order to go and look for other users in the first for loop?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "edited": false, "score": 0, "creation_date": 1518043541, "post_id": 48670898, "comment_id": 84347614, "body": "Yes sounds like <code>Exit For</code> is what you need there"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1518043519, "last_edit_date": 1518043519, "creation_date": 1518028097, "answer_id": 48670898, "question_id": 48665322, "link": "https://stackoverflow.com/questions/48665322/nested-for-loops-with-json-vba/48670898#48670898", "title": "Nested For loops with JSON-VBA", "body": "<p>You're re-using your <code>http</code> variable inside the loop, so you unload the original response on the first pass through. Just parse the original response and keep that in a variable, then loop over the items, and fetch details for each one.</p>\n\n<p>Untested but something like this should work:</p>\n\n<pre><code>Sub Tester()\n\n    Dim theListing As Object, theDetails As Object\n    Dim totalCount As Integer, count As Integer\n    Dim userID As String\n    Dim status As String, jsonDate As Integer\n\n    For x = 1 To NumRows\n\n        Set theListing = JSONObject(\"http://controlpanel.zoho/rest/Accounts/\" &amp; _\n                                    \"criteria/idlist?AccountPhone=\" &amp; var)\n\n        totalCount = theListing(\"totalCount\")\n\n        For count = 1 To totalCount 'totalCount can be 1 sometimes\n\n            userID = theListing(\"results\")(count)(\"AccountId\")\n\n\n            Set theDetails = JSONObject(\"http://controlpanel.zoho/rest/\" &amp; _\n                                        \"AccountDetails/\" &amp; userID)\n\n            status = theDetails(\"results\")(1)(\"CustomerStatus\")\n            If status = \"LIVE_ACTIVE\" Then 'can introduce Date condition to see if peolpe activated after a certain date\n                Sheet3.Cells(RowNote, 3).Value = 1\n                Exit For\n            End If\n        Next count\n    Next x\n\nEnd Sub\n\n'fetch a response as parsed JSON object\nFunction JSONObject(url As String)\n    Dim http As Object\n    Set http = CreateObject(\"MSXML2.XMLHTTP\")\n    http.Open \"GET\", url, False\n    http.send\n    Set JSONObject = parsejson(http.responseText)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 961, "user_id": 3340234, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/127103057/picture?type=large", "display_name": "Leb_Broth", "link": "https://stackoverflow.com/users/3340234/leb-broth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 48670898, "answer_count": 1, "score": 0, "last_activity_date": 1518043519, "creation_date": 1518010826, "last_edit_date": 1518027316, "question_id": 48665322, "link": "https://stackoverflow.com/questions/48665322/nested-for-loops-with-json-vba", "title": "Nested For loops with JSON-VBA", "body": "<p>So basically what I am doing here is a double search for some info about a customer. I can do it in a single search, however it will take 5 times the duration of what is supposed to happen here.</p>\n\n<p>First I search by the customer phone number and see the <code>IDs</code> of each of his accounts that are linked to his phone number. Then I initiate another <code>For</code> loop to search each account through another <code>xmlhttprequest</code> to see if he has an active account. The <code>totalCount</code> is used to see how many accounts the user has (how many nested arrays are in the first <code>for</code> loop request). Then the process should keep looping through the accounts of each user and once it finds the first active account then the whole process should return \"<code>1</code>\" in the corresponding excel adjacent cell.</p>\n\n<p>But I am receiving: </p>\n\n<blockquote>\n  <p>error 9, subscript out of range</p>\n</blockquote>\n\n<p>.</p>\n\n<p><strong>What should I correct in the For loops architecture?</strong></p>\n\n<pre><code>For x = 1 To NumRows\n    Dim var As String: var = Cells(ActiveCell.Row, 2)\n    Dim RowNote As String: RowNote = ActiveCell.Row\n    Dim http As Object, html As New HTMLDocument, document As Object\n\n    Set http = CreateObject(\"MSXML2.XMLHTTP\")\n\n    http.Open \"GET\", \"http://controlpanel.zoho/rest/Accounts/criteria/idlist?AccountPhone=\" &amp; var, False\n    http.send\n\n    Dim totalCount As Integer, count As Integer\n    totalCount = ParseJson(http.responseText)(\"totalCount\")\n\n    For count = 1 To totalCount 'totalCount can be 1 sometimes\n        Dim userID As String\n        userID = ParseJson(http.responseText)(\"results\")(count)(\"AccountId\")\n\n        Set http = CreateObject(\"MSXML2.XMLHTTP\")\n        http.Open \"GET\", \"http://controlpanel.zoho/rest/AccountDetails/\" &amp; userID, False\n        http.send\n\n        Dim status As String, jsonDate As Integer\n        status = ParseJson(http.responseText)(\"results\")(1)(\"CustomerStatus\")\n        If status = \"LIVE_ACTIVE\" Then 'can introduce Date condition to see if peolpe activated after a certain date\n            Sheet3.Cells(RowNote, 3).Value = 1\n            Else\n            count = count + 1\n        End If\n    Next count\nNext x\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong>: This is a sample of the first JSON array for the first For loop:</p>\n\n<p>URL e.g. <code>http://controlpanel.zoho/rest/Accounts/criteria/idlist?AccountPhone=67545678</code></p>\n\n<p>and the JSON:</p>\n\n<pre><code> {\"totalCount\":4,\n  \"messages\":[],\n   \"results\":[\n        {\"Type\":\"FX\",\"AccountId\":14237},\n        {\"Type\":\"FX\",\"AccountId\":17152},\n        {\"Type\":\"FX\",\"AccountId\":17553},\n        {\"Type\":\"FX\",\"AccountId\":17553}\n    ],\n   \"resultClass\":\"com.zoho.dao.dto.zohoAccountMarketTypeDTO\"}\n</code></pre>\n\n<p>and this is a sample of the individual second JSON in the second For loop:</p>\n\n<p>URL 2 e.g. <a href=\"http://controlpanel.zoho/rest/AccountDetails/17152\" rel=\"nofollow noreferrer\">http://controlpanel.zoho/rest/AccountDetails/17152</a></p>\n\n<pre><code>{\"totalCount\":1,\n \"messages\":[],\n  \"results\":[\n      {\"AccountAgrt\":false, \n       \"accountType\":\"FOLLOWER\",\n       \"CustomerId\":9069,\n       \"logins\":81,\n       \"CustomerStatus\":\"LIVE_ACTIVE\",\n       \"dateLastLogin\":1510153414000,\n       \"state\":null}\n    ],\n   \"resultClass\":\"com.zoho.dao.dto.zohoAccountInfoDTO\"}\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1518010395, "post_id": 48664848, "comment_id": 84327633, "body": "You need to use the Convert Text to Columns wizard and/or the find/left/right functions. Use the macro recorder. You can enter the commands manually in to Excel and then look at the VB code generated for you."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1518010541, "post_id": 48664848, "comment_id": 84327744, "body": "What have you done so far?"}, {"owner": {"reputation": 21, "user_id": 9327670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32d5739e694b098ac6961c133b99b430?s=128&d=identicon&r=PG&f=1", "display_name": "nishu", "link": "https://stackoverflow.com/users/9327670/nishu"}, "edited": false, "score": 0, "creation_date": 1518146940, "post_id": 48664848, "comment_id": 84395331, "body": "Have used Text 2 Column also used Split but everything got jumbled."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8872307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7907a5ee4465fc3351c53b5d1e090eee?s=128&d=identicon&r=PG&f=1", "display_name": "Sahana Anand", "link": "https://stackoverflow.com/users/8872307/sahana-anand"}, "is_accepted": false, "score": 0, "last_activity_date": 1518169707, "creation_date": 1518169707, "answer_id": 48702977, "question_id": 48664848, "link": "https://stackoverflow.com/questions/48664848/creating-multiple-rows-in-vba-if-multiples-values-are-in-single-cells/48702977#48702977", "title": "Creating multiple rows in vba if multiples values are in single cells", "body": "<p>Check with this, this may not be the optimal solution. I have used 3 procedures.</p>\n\n<ol>\n<li>Cell3_Count(): To know the number of rows to be inserted from the combination of strings in both the cell1 and cell3.</li>\n<li>split_cell3() : To split the cell values based on the delimiter.</li>\n<li>ArrangeBasedOnValues(): Has both 1. and 2. functionalities for cell1 and the output.</li>\n</ol>\n\n<p>Please check for different cases, and make necessary changes if needed.</p>\n\n<p>Option Explicit\nOption Compare Text</p>\n\n<p>Public sht1 As Worksheet, i As Long, j As Long, lastrow1 As Long, k As Long, l As Long\nPublic str1 As String, str2() As String, str3() As String, str4 As String, s1 As String, s2 As String, s3 As String, s4 As String\nPublic cnt1 As String, cnt2 As Integer, ncells As Integer</p>\n\n<p>Sub ArrangeBasedOnValues()</p>\n\n<pre><code>Set sht1 = ThisWorkbook.Worksheets(1)\n\n'Starting row\ni = 6\n</code></pre>\n\n<p>next_cell:</p>\n\n<pre><code>lastrow1 = sht1.Cells(sht1.Rows.Count, \"A\").End(xlUp).Row\n\nDo While (i &lt;= lastrow1)\n\n    str1 = sht1.Cells(i, 1).Value\n\n    str4 = sht1.Cells(i, 3).Value\n\n    s1 = \"/\"\n\n    s2 = \",\"\n\n    cnt1 = 0\n\n    'Check number of strings in cell1\n    If InStr(1, str1, s1, vbTextCompare) &gt; 0 Then\n\n        s4 = s1\n\n        'count of special characters in cell1\n        cnt1 = Len(str1) - Len(Replace(str1, s1, \"\"))\n\n        Call Cell3_Count\n\n    ElseIf InStr(1, str1, s2, vbTextCompare) &gt; 0 Then\n\n        s4 = s2\n\n        cnt1 = Len(str1) - Len(Replace(str1, s2, \"\"))\n\n        Call Cell3_Count\n\n    Else\n\n        Call Cell3_Count\n\n    End If\n\n    'combination of elements in cell1 and cell3\n    'cnt1+1 : Total numbers of strings = total number of spl chars + 1\n    ncells = ((cnt1 + 1) * (cnt2 + 1)) - 1\n\n    'Only one string in cell1\n    If ncells = 1 Then\n\n        'Add extra rows based on the combination\n        sht1.Rows(i + 1 &amp; \":\" &amp; i + ncells).Insert Shift:=xlDown, _\n        CopyOrigin:=xlFormatFromLeftOrAbove\n\n        sht1.Cells(i + 1, 1).Value = sht1.Cells(i, 1).Value\n\n        sht1.Range(\"B\" &amp; i + 1).Value = Trim(sht1.Range(\"B\" &amp; i).Value)\n\n        sht1.Range(\"D\" &amp; i &amp; \":\" &amp; \"G\" &amp; i).Copy sht1.Range(\"D\" &amp; i + 1 &amp; \":\" &amp; \"G\" &amp; i + 1)\n\n        Call split_cell3\n\n    'more than one string\n    ElseIf ncells &gt; 1 Then\n\n        sht1.Rows(i + 1 &amp; \":\" &amp; i + ncells).Insert Shift:=xlDown, _\n        CopyOrigin:=xlFormatFromLeftOrAbove\n\n        Dim q As Integer\n\n        q = i\n\n        str2 = Split(str1, s4)\n\n        For k = LBound(str2) To UBound(str2)\n\n            'UBound(str2) + 1 : number of times each string in cell4 needs to be printed\n\n            For l = q To i + ncells Step UBound(str2) + 1\n\n                sht1.Cells(l, 1).Value = Trim(str2(k))\n\n                sht1.Range(\"B\" &amp; l).Value = Trim(sht1.Range(\"B\" &amp; i).Value)\n\n                'cnt2=0 : only one string in cell3\n                If cnt2 = 0 Then\n\n                    sht1.Range(\"C\" &amp; i &amp; \":\" &amp; \"G\" &amp; i).Copy sht1.Range(\"C\" &amp; l &amp; \":\" &amp; \"G\" &amp; l)\n\n                'More than one string in cell3\n                Else\n\n                    sht1.Range(\"D\" &amp; i &amp; \":\" &amp; \"G\" &amp; i).Copy sht1.Range(\"D\" &amp; l &amp; \":\" &amp; \"G\" &amp; l)\n\n                End If\n\n            Next l\n\n            q = q + 1\n\n        Next k\n\n        'cnt2&gt;0 : need to split strings in cell3\n        If cnt2 &gt; 0 Then\n\n            Call split_cell3\n\n        End If\n\n        i = i + ncells + 1\n\n        GoTo next_cell\n\n    'Only one string in both cell1 and cell3\n    Else\n\n        i = i + 1\n\n        GoTo next_cell\n\n    End If\n\n    i = i + ncells + 1\n\n    lastrow1 = sht1.Cells(sht1.Rows.Count, \"A\").End(xlUp).Row\n\nLoop\n</code></pre>\n\n<p>End Sub\n'Number of strings in cell3\nSub Cell3_Count()</p>\n\n<pre><code>cnt2 = 0\n\n'Check number of values\nIf InStr(1, str4, s1, vbTextCompare) &gt; 0 Then\n\n    s3 = s1\n\n    'count of special characters in cell3\n    cnt2 = Len(str4) - Len(Replace(str4, s1, \"\"))\n\nElseIf InStr(1, str4, s2, vbTextCompare) &gt; 0 Then\n\n    s3 = s2\n\n    cnt2 = Len(str4) - Len(Replace(str4, s2, \"\"))\n\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n\n<p>'Split the string in cell3 based on the delimter obtained in cell3_count\nSub split_cell3()</p>\n\n<pre><code>str3() = Split(str4, s3)\n\nDim m As Integer, n As Integer\n\nm = i\n\n'Debug.Print cnt1 + 1\n\nFor n = LBound(str3) To UBound(str3)\n\n    For l = m To m + cnt1\n\n        sht1.Range(\"C\" &amp; l).Value = Trim(str3(n))\n\n    Next l\n\n    m = m + cnt1 + 1\n\nNext n\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 21, "user_id": 9327670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32d5739e694b098ac6961c133b99b430?s=128&d=identicon&r=PG&f=1", "display_name": "nishu", "link": "https://stackoverflow.com/users/9327670/nishu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1518169707, "creation_date": 1518009448, "last_edit_date": 1531164843, "question_id": 48664848, "link": "https://stackoverflow.com/questions/48664848/creating-multiple-rows-in-vba-if-multiples-values-are-in-single-cells", "title": "Creating multiple rows in vba if multiples values are in single cells", "body": "<p>I have a data where multiples values are in single cell, i have to arrange all values separately. could you please help me out. Your suggestion is highly appreciated. </p>\n\n<p>i am not able to attach FILE..<img src=\"https://i.stack.imgur.com/QxRbs.png\" alt=\"enter image description here\"></p>\n\n<pre><code>Countries   Cobination  Products    Q1 QUANTITY Q2 QUANTITY Q3 QUANTITY Q4 QUANTITY\nUSA First   Machine 90  340 600 900\nCanada / USA / CHINA    First   Computer , Vehicles , Households    80  112 112 34\nBRAZIL , CHINA , SA     BOOKS   10  600 0   698\nCANADA  Second  BOTTLES / CARPET    4000    3243        4449\n</code></pre>\n\n<p>Result is like below                        </p>\n\n<pre><code>Countries       Products    Q1 QUANTITY Q2 QUANTITY Q3 QUANTITY Q4 QUANTITY\nUSA First   Machine 90  340 600 900\nCanada  First   Computer    80  112 112 34\nUSA First   Computer    80  112 112 34\nCHINA   First   Computer    80  112 112 34\nCanada  First   Vehicles    80  112 112 34\nUSA First   Vehicles    80  112 112 34\nCHINA   First   Vehicles    80  112 112 34\nCanada  First   Households  80  112 112 34\nUSA First   Households  80  112 112 34\nCHINA   First   Households  80  112 112 34\nBRAZIL      BOOKS   10  600 0   698\nCHINA       BOOKS   10  600 0   698\nSA      BOOKS   10  600 0   698\nCANADA  Second  BOTTLES 4000    3243        4449\nCANADA  Second  CARPET  4000    3243        4449\n</code></pre>\n"}, {"tags": ["excel", "multiple-columns", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518012416, "post_id": 48664841, "comment_id": 84329030, "body": "I&#39;m failing to spot a question in there."}, {"owner": {"reputation": 13, "user_id": 9197229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1496d79a1b38ee7a1ef9a424a507a958?s=128&d=identicon&r=PG&f=1", "display_name": "Remips", "link": "https://stackoverflow.com/users/9197229/remips"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1518095345, "post_id": 48664841, "comment_id": 84369944, "body": "The question, to be more precise, is that the code does not work. I am not allowed to write: .ColumnWidths = &#171;x1;x2&#187; So how can I write the code so that is it possible to control these variables from a textbox?"}], "answers": [{"tags": [], "owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "is_accepted": true, "score": 1, "last_activity_date": 1518012923, "creation_date": 1518012923, "answer_id": 48666042, "question_id": 48664841, "link": "https://stackoverflow.com/questions/48664841/assigning-columnwidths-with-textbox-data/48666042#48666042", "title": "Assigning ColumnWidths with textbox data", "body": "<pre><code>aListBox.ColumnWidths = newStringValue\n</code></pre>\n\n<p>or</p>\n\n<pre><code>StringValue = aListBox.ColumnWidths\n</code></pre>\n\n<p>A list of comma-separated values, with each value controlling the width of the associated column. A value can be an absolute value (in pixels), a percentage, a relative length expressed as i* where i is an integer, or an \"*\" that indicates \"fill in the remaining width.\" If you use percentages, you can use non-integer values to specify fractions of a percent, e.g., 43.52%. The percentage value can be greater than 100%.</p>\n\n<p>Notes</p>\n\n<p>If you use pixels, the last column doesn't grow to the size of the rest of the ListBox. You should set the width of the last column to \"<em>\" and it will automatically take up the remaining width of the ListBox.\nWithout any column width specifications, the headers will be divided evenly. If there are fewer column widths specified than the total number of columns, the remaining columns will divide up the remaining width equally.\nAn element with a length of \"3</em>\" will be allotted three times the space of an element with length \"1*\". The value \"<em>\" is equivalent to \"1</em>\" and can be used to mean \"fill the remaining space.\"</p>\n"}], "owner": {"reputation": 13, "user_id": 9197229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1496d79a1b38ee7a1ef9a424a507a958?s=128&d=identicon&r=PG&f=1", "display_name": "Remips", "link": "https://stackoverflow.com/users/9197229/remips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 48666042, "answer_count": 1, "score": 1, "last_activity_date": 1518095547, "creation_date": 1518009428, "last_edit_date": 1531164843, "question_id": 48664841, "link": "https://stackoverflow.com/questions/48664841/assigning-columnwidths-with-textbox-data", "title": "Assigning ColumnWidths with textbox data", "body": "<p>I want to control the different column widths of a listbox with the use of textbox input. This is my code:</p>\n\n<pre><code>Sub code()\n\n    Dim x1 as integer\n    Dim x2 as integer\n\n    x1 = Me.TB1.value \u2018x1 is assigned the number 40\n    x2 = Me.TB2.value \u2018x2 is assigned the number 40\n\n    With Me.listbox1\n           .Clear\n           .ColumnCount = 2\n           .ColumnWidths = \u2018\u2019x1;x2\u2019\u2019\n           .list = getArray(SQLinput)\n    End with\n\nEnd sub\n</code></pre>\n\n<p>Thanks for any help!</p>\n\n<p>Edit:\nThe question, to be more precise, is that the code does not work. I am not allowed to write: .ColumnWidths = \u00abx1;x2\u00bb So how can I write the code so that is it possible to control these variables from a textbox?</p>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 2, "creation_date": 1518008878, "post_id": 48664337, "comment_id": 84326511, "body": "Note that <code>Exit For</code> (available in vba, aka <code>Break</code> in some languages) and <code>Continue</code> (not available in vba, but in some other languages) do not have the same behavior in general. With <code>Exit For</code> you exit the inner loop totally, whereas with <code>Continue</code> you jump to the next iteration of the loop."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1518008215, "creation_date": 1518008215, "answer_id": 48664413, "question_id": 48664337, "link": "https://stackoverflow.com/questions/48664337/exit-for-statement-once-condition-is-reached/48664413#48664413", "title": "Exit for-statement once condition is reached", "body": "<p>Yes, there is an <code>Exit For</code> statement.</p>\n\n<pre><code>            If c_new &lt;&gt; c_old Then\n                Debug.Print c_new.Address\n                Exit For    'exits the inner loop\n            End If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1518008453, "post_id": 48664437, "comment_id": 84326170, "body": "The link points to the VB.Net docs.  Here&#39;s the VBA page: <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/fornext-statement?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/language-reference-vba/articles&zwnj;&#8203;/&hellip;</a>."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1518008560, "post_id": 48664437, "comment_id": 84326239, "body": "Ugh - I should have recalled that was the syntax in VBA - especially, when writing the title for the question, as you mention :) Thanks for reminding me!"}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 1, "last_activity_date": 1518008276, "creation_date": 1518008276, "answer_id": 48664437, "question_id": 48664337, "link": "https://stackoverflow.com/questions/48664337/exit-for-statement-once-condition-is-reached/48664437#48664437", "title": "Exit for-statement once condition is reached", "body": "<p>You seem to have already answered your own question in your title - simply use <code>Exit For</code>.</p>\n\n<p>Here is a reference:\n<a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/exit-statement\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/exit-statement</a></p>\n"}], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 48664437, "answer_count": 2, "score": 0, "last_activity_date": 1518008276, "creation_date": 1518008023, "question_id": 48664337, "link": "https://stackoverflow.com/questions/48664337/exit-for-statement-once-condition-is-reached", "title": "Exit for-statement once condition is reached", "body": "<p>I am trying to compare two workbooks to pick out any rows that are dissimilar between them. I have created the code below to do this, but I was hoping there was something similar to a <code>continue</code> which I could use inside of the if-statement to exit the innermost <code>for each</code>-loop once a difference is found. Is there any obvious way to do this? I guess I could use a <code>goto</code>-statement, but I'd prefer to avoid this.</p>\n\n<pre><code>Sub test()\n    Dim wb_new As Workbook, wb_old As Workbook\n    Dim ws As Worksheet\n    Dim r As Range, c_old As Range, c_new As Range\n    Dim i As Long\n\n    Set wb_new = Application.Workbooks(\"Book1.xlsx\")\n    Set wb_old = Application.Workbooks(\"Book2.xlsx\")\n\n    For Each ws In wb_old.Worksheets\n        For i = 0 To 275\n            Set r = ws.Range(\"A1:Q1\").Offset(i, 0)\n            For Each c_old In r\n                Set c_new = wb_new.Worksheets(ws.Name).Range(\"A1\").Offset(i, c_old.Column - 1)\n                If c_new &lt;&gt; c_old Then\n                    Debug.Print c_new.Address\n                End If\n            Next c_old\n        Next i\n    Next ws\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2016"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518007964, "post_id": 48664272, "comment_id": 84325780, "body": "Is a duplicate any repeat of a given name in column A?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1518008133, "post_id": 48664272, "comment_id": 84325920, "body": "Sounds like a job for a pivottable and filter out count &lt;2. Assume this as an allocation of over 1 in a month?"}, {"owner": {"reputation": 31, "user_id": 7174138, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad5f6534fb2fc56fccb48c6087debc78?s=128&d=identicon&r=PG&f=1", "display_name": "TheDave", "link": "https://stackoverflow.com/users/7174138/thedave"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518008141, "post_id": 48664272, "comment_id": 84325924, "body": "Yes. a duplicate is a name appearing more than once in column A."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7174138, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad5f6534fb2fc56fccb48c6087debc78?s=128&d=identicon&r=PG&f=1", "display_name": "TheDave", "link": "https://stackoverflow.com/users/7174138/thedave"}, "edited": false, "score": 0, "creation_date": 1518112125, "post_id": 48664771, "comment_id": 84381670, "body": "Hmm. I could not get it to work on my Mac with the formular. Stupid mac :D"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "reply_to_user": {"reputation": 31, "user_id": 7174138, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad5f6534fb2fc56fccb48c6087debc78?s=128&d=identicon&r=PG&f=1", "display_name": "TheDave", "link": "https://stackoverflow.com/users/7174138/thedave"}, "edited": false, "score": 0, "creation_date": 1518178448, "post_id": 48664771, "comment_id": 84409523, "body": "@TheDave For future reference, array formulas can be enetered for Mac following <a href=\"https://stackoverflow.com/a/26605282/6387479\">this method</a>"}], "tags": [], "owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "is_accepted": false, "score": 2, "last_activity_date": 1518178568, "last_edit_date": 1518178568, "creation_date": 1518009213, "answer_id": 48664771, "question_id": 48664272, "link": "https://stackoverflow.com/questions/48664272/excel-sum-check-on-duplicates/48664771#48664771", "title": "Excel SUM check on duplicates", "body": "<p>In your example David is over allocated by 0.1 for January... </p>\n\n<p>You could have 2 formulas to get your desired result, this is an example of just 1 month, drag the second formula across for the remainder:</p>\n\n<p><code>=IFERROR(INDEX(A:A,SMALL(IF(COUNTIF(A:A,$A2)&gt;1,ROW(A:A)),ROW(1:1))),\"\")</code> - First column (this is an array formula, while still in the formula bar hit <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd>)</p>\n\n<p>This will return the smallest row number for index, where the count of the result in column A is more than 1...</p>\n\n<p><code>=IF($P2&lt;&gt;\"\",SUMIF($A:$A,$P2,B:B)-1,\"\")</code> - Assuming P is the column with the first formula.</p>\n\n<hr>\n\n<p>Edit:\nFor Apple Mac an array formula is entered like so:</p>\n\n<p>(taken from <a href=\"https://stackoverflow.com/a/26605282/6387479\">this Stack Overflow answer</a>)</p>\n\n<blockquote>\n  <p>Select the range, press <kbd>CONTROL</kbd>+<kbd>U</kbd> and then press <kbd>\u2318</kbd>+<kbd>RETURN</kbd>.</p>\n</blockquote>\n\n<hr>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1518010792, "last_edit_date": 1518010792, "creation_date": 1518010305, "answer_id": 48665140, "question_id": 48664272, "link": "https://stackoverflow.com/questions/48664272/excel-sum-check-on-duplicates/48665140#48665140", "title": "Excel SUM check on duplicates", "body": "<p>Pivottable method (Note I used some dummy actual values):</p>\n\n<p>Set your data up as a table and add an end column called <code>NameCount</code>. Assuming your first column you put a header name in cell <code>A1</code> then you can put the following formula in the new column top cell e.g. 02 and it will autofill down.</p>\n\n<pre><code> =COUNTIF([Name],[@Name])\n</code></pre>\n\n<p>Dummy data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cZOzw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cZOzw.png\" alt=\"Data view\"></a></p>\n\n<p>Create a pivot off the data and arrange like so:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qK82V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qK82V.png\" alt=\"Pivot\"></a></p>\n\n<p>Filter out anything &lt;= 1 from the NameCount.</p>\n\n<p>Apply conditional formatting to the column ranges in your pivottable containing the month data:</p>\n\n<p>Formula:</p>\n\n<pre><code>=AND(ISNUMBER(C14),C14&gt;1)\n</code></pre>\n\n<p>Make sure $ is not present as you want the formula to be applied to all cells in range.</p>\n\n<p>An example range (I have kept this short) for the formula to apply to:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1IDRc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1IDRc.png\" alt=\"Example conditional formatting range: You would set this for all your months\"></a></p>\n"}], "owner": {"reputation": 31, "user_id": 7174138, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad5f6534fb2fc56fccb48c6087debc78?s=128&d=identicon&r=PG&f=1", "display_name": "TheDave", "link": "https://stackoverflow.com/users/7174138/thedave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 48665140, "answer_count": 2, "score": 0, "last_activity_date": 1518178568, "creation_date": 1518007751, "question_id": 48664272, "link": "https://stackoverflow.com/questions/48664272/excel-sum-check-on-duplicates", "title": "Excel SUM check on duplicates", "body": "<p>I am working on a data sheet where I have a list containing team members and their allocated tasks each month in percent.</p>\n\n<p>I want to do a check where I see if there are any duplicates and if this is true I want to check if work allocation is above 1.</p>\n\n<p>If this happens I would like to somehow indicate those team members are over-allocated. I thought this could be done with color marking on the name or a cell showing names that are over-allocated.</p>\n\n<p>I attached this example with 11 names where David and Martin are overallocated.</p>\n\n<p>Can I do this with basic Excel statement or VBA code?</p>\n\n<p>Thanks for your help.</p>\n\n<p>//David\n<a href=\"https://i.stack.imgur.com/h3d22.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h3d22.png\" alt=\"Data List\"></a></p>\n"}, {"tags": ["arrays", "vba", "excel", "dynamic"], "answers": [{"tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": true, "score": 0, "last_activity_date": 1518007632, "creation_date": 1518007632, "answer_id": 48664223, "question_id": 48664112, "link": "https://stackoverflow.com/questions/48664112/vba-run-code-until-the-last-row-of-a-column-range/48664223#48664223", "title": "VBA run code until the last row of a column range", "body": "<p>misstype here:</p>\n\n<pre><code>Set DataRange = Sheets(\"Result\").Range(\"D:I\" &amp; lastrow)\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>Set DataRange = Sheets(\"Result\").Range(\"D1:I\" &amp; lastrow)\n</code></pre>\n\n<p>or Dx where x is your first line.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9103716"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1735, "favorite_count": 0, "accepted_answer_id": 48664223, "answer_count": 1, "score": 0, "last_activity_date": 1518007632, "creation_date": 1518007302, "question_id": 48664112, "link": "https://stackoverflow.com/questions/48664112/vba-run-code-until-the-last-row-of-a-column-range", "title": "VBA run code until the last row of a column range", "body": "<p>My code successfully works out where my last row of code is however gives a run-time error 1004 when it reaches setting the data range, but i want the code to run until the last row in my range. Does anyone know how to fix my code?</p>\n\n<pre><code>Sub PopulatingArrayVariable()\n\nDim myArray() As Variant\nDim DataRange As Range\nDim cell As Range\nDim x As Long\nDim TotalTargets As Double\nDim lastrow As Long\n\nlastrow = Cells(Rows.Count, \"D\").End(xlUp).Row\n\nTotalTargets = WorksheetFunction.Max(Columns(\"D\"))\n\nSet DataRange = Sheets(\"Result\").Range(\"D:I\" &amp; lastrow)\n\nFor Each cell In DataRange.Cells\n    ReDim Preserve myArray(x)\n    myArray(x) = cell.Value\n    x = x + 1\nNext cell\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1518007097, "post_id": 48663960, "comment_id": 84325197, "body": "disable events and switch calculation to manual."}, {"owner": {"reputation": 25, "user_id": 8048613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5506717a9395b495afa7bf06351aa6f2?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Mangelsdorf", "link": "https://stackoverflow.com/users/8048613/ian-mangelsdorf"}, "edited": false, "score": 0, "creation_date": 1518007346, "post_id": 48663960, "comment_id": 84325347, "body": "Spot on!  thanks Jeeped"}], "owner": {"reputation": 25, "user_id": 8048613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5506717a9395b495afa7bf06351aa6f2?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Mangelsdorf", "link": "https://stackoverflow.com/users/8048613/ian-mangelsdorf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518006892, "creation_date": 1518006892, "last_edit_date": 1531164843, "question_id": 48663960, "link": "https://stackoverflow.com/questions/48663960/pasting-array-to-worksheet-taking-a-long-time", "title": "Pasting array to worksheet taking a long time", "body": "<p>I have this code </p>\n\n<pre><code>Set Destination = ThisWorkbook.Sheets(\"Catalogue\").Range(\"a4\")\nApplication.StatusBar = \"Please be patient we are pasting the data into the  list\"\nWith Destination\n    .Resize(UBound(default_layout, 1), UBound(default_layout, 2)).Value = default_layout\nEnd With\n</code></pre>\n\n<p>default_layout is a 2D array approx 65000 x 29 </p>\n\n<p>I can churn and manipulate the data in several ways in about 5 seconds but getting it back into a work book takes approx 90 seconds??</p>\n\n<p>Screen Updating and calculations are both set to off </p>\n\n<p>Any idea how to speed this one up</p>\n"}, {"tags": ["vba", "wcf", "vsto"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1518006256, "post_id": 48663447, "comment_id": 84324692, "body": "<a href=\"https://blogs.msdn.microsoft.com/bethmassi/2009/11/05/interop-between-vba-and-visual-studio-office-solutions-vsto/\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/bethmassi/2009/11/05/&hellip;</a>"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1518006884, "post_id": 48663447, "comment_id": 84325081, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/bb386306.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/bb386306.aspx</a>"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1518007065, "post_id": 48663447, "comment_id": 84325183, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/3hekt07s.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/3hekt07s.aspx</a>"}, {"owner": {"reputation": 25, "user_id": 7371081, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EP4DIUtuhbY/AAAAAAAAAAI/AAAAAAAAB0E/64UAUTalnTs/photo.jpg?sz=128", "display_name": "Patrick Weiss", "link": "https://stackoverflow.com/users/7371081/patrick-weiss"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1518010405, "post_id": 48663447, "comment_id": 84327642, "body": "I found the <a href=\"https://msdn.microsoft.com/en-us/library/bb608614.aspx\" rel=\"nofollow noreferrer\">answer</a> in the comments of the first article.  Many many thanks!"}], "owner": {"reputation": 25, "user_id": 7371081, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EP4DIUtuhbY/AAAAAAAAAAI/AAAAAAAAB0E/64UAUTalnTs/photo.jpg?sz=128", "display_name": "Patrick Weiss", "link": "https://stackoverflow.com/users/7371081/patrick-weiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 288, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1518005296, "creation_date": 1518005296, "question_id": 48663447, "link": "https://stackoverflow.com/questions/48663447/how-to-call-vsto-code-from-vba", "title": "How to call VSTO-code from VBA", "body": "<p>Given is the following scenario: A .net-class-library with business logic and Excel 2010 Add-In (VSTO) to make it available for users. All is working fine. Now, we need to call some of the logic from VBA. Just something like addLog(\"no issue\") or getString(\"for ID\").</p>\n\n<p>(I know, standard solution is: creating a COM-visible dll and reference it within the VBA-project. However this wouldn't work in the current environment because of missing admin-credentials.)</p>\n\n<p>Now, I am searching a way to make this happen. What I found is:</p>\n\n<ul>\n<li><p><strong>DDE</strong> - but everyone is screaming that it is really outdated</p></li>\n<li><p><strong>WCF-Service hosted within the VSTO Add-In</strong> - but I couldn't find any example that fits vaguely</p></li>\n</ul>\n\n<p>So, do you have any suggestion?</p>\n\n<p>Thanks a lot in advance</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9322719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/992c7d5c34d50692034767cd8edd9c0a?s=128&d=identicon&r=PG&f=1", "display_name": "ARSHITKUMAR H. DOBARIYA", "link": "https://stackoverflow.com/users/9322719/arshitkumar-h-dobariya"}, "edited": false, "score": 0, "creation_date": 1518013823, "post_id": 48664432, "comment_id": 84330035, "body": "thank you friend, but there will be lots of sheets so,i guess vba is must. but still appreciating for putting efforts.thank you"}, {"owner": {"reputation": 4326, "user_id": 8370633, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gxmCt.png?s=128&g=1", "display_name": "ImaginaryHuman072889", "link": "https://stackoverflow.com/users/8370633/imaginaryhuman072889"}, "reply_to_user": {"reputation": 13, "user_id": 9322719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/992c7d5c34d50692034767cd8edd9c0a?s=128&d=identicon&r=PG&f=1", "display_name": "ARSHITKUMAR H. DOBARIYA", "link": "https://stackoverflow.com/users/9322719/arshitkumar-h-dobariya"}, "edited": false, "score": 0, "creation_date": 1518013899, "post_id": 48664432, "comment_id": 84330096, "body": "@ARSHITKUMARH.DOBARIYA Sorry that it won&#39;t work. I&#39;ll leave the answer in case it is useful to someone else who researches this question."}, {"owner": {"reputation": 13, "user_id": 9322719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/992c7d5c34d50692034767cd8edd9c0a?s=128&d=identicon&r=PG&f=1", "display_name": "ARSHITKUMAR H. DOBARIYA", "link": "https://stackoverflow.com/users/9322719/arshitkumar-h-dobariya"}, "edited": false, "score": 0, "creation_date": 1518014629, "post_id": 48664432, "comment_id": 84330640, "body": "for detail study and understanding problem better , link is given below to view excel sheet  (<a href=\"https://drive.google.com/open?id=1k4ZKvnHwR_1yp2BHuB0yWMF4ewgLljZJ\" rel=\"nofollow noreferrer\">drive.google.com/open?id=1k4ZKvnHwR_1yp2BHuB0yWMF4ewgLljZJ</a>)"}], "tags": [], "owner": {"reputation": 4326, "user_id": 8370633, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gxmCt.png?s=128&g=1", "display_name": "ImaginaryHuman072889", "link": "https://stackoverflow.com/users/8370633/imaginaryhuman072889"}, "is_accepted": false, "score": 0, "last_activity_date": 1518008608, "last_edit_date": 1518008608, "creation_date": 1518008260, "answer_id": 48664432, "question_id": 48663316, "link": "https://stackoverflow.com/questions/48663316/lookup-in-all-the-sheets-for-specific-text-and-if-match-then-write-value-of-same/48664432#48664432", "title": "Lookup in all the sheets for specific text and if match then write value of same row but different column value to master sheet", "body": "<p>For one sheet, this is easy to accomplish with a formula alone, e.g.</p>\n\n<pre><code>= INDEX(1:1,MATCH(\"yes\",5:5,0))\n</code></pre>\n\n<p>This finds the first instance of <code>yes</code> in the 5th row of the current sheet, and returns the value in 1st row and in the same column.</p>\n\n<p>One option is to have this formula above somewhere on each sheet in your workbook as a \"helper cell\" (e.g. cell <code>Z99</code>) and then have a formula somewhere on your master sheet to check all of these helper cells, e.g.</p>\n\n<pre><code>= IFERROR(Sheet1!Z99,IFERROR(Sheet2!Z99,IFERROR(Sheet3!Z99,IFERROR(...,\"no match\"))))\n</code></pre>\n\n<p>Of course, also possible without helper cells at all, but the formula just gets messy:</p>\n\n<pre><code>= IFERROR(INDEX(Sheet1!1:1,MATCH(\"yes\",Sheet1!5:5,0)),\n  IFERROR(INDEX(Sheet2!1:1,MATCH(\"yes\",Sheet2!5:5,0)),\n  IFERROR(INDEX(Sheet3!1:1,MATCH(\"yes\",Sheet3!5:5,0)),\n  IFERROR(...,\"no match\"))))\n</code></pre>\n\n<p>If you want a way without explicitly calling each sheet, then VBA is probably required. Just posting a solution without VBA to see if this will work for you.</p>\n"}], "owner": {"reputation": 13, "user_id": 9322719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/992c7d5c34d50692034767cd8edd9c0a?s=128&d=identicon&r=PG&f=1", "display_name": "ARSHITKUMAR H. DOBARIYA", "link": "https://stackoverflow.com/users/9322719/arshitkumar-h-dobariya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1518008608, "creation_date": 1518004914, "last_edit_date": 1518008258, "question_id": 48663316, "link": "https://stackoverflow.com/questions/48663316/lookup-in-all-the-sheets-for-specific-text-and-if-match-then-write-value-of-same", "title": "Lookup in all the sheets for specific text and if match then write value of same row but different column value to master sheet", "body": "<ul>\n<li>check over all sheets</li>\n<li>If specific text (e.g., yes) is found in the fifth row of a sheet, get data from that row (but different column) and write data to a master sheet\nHow can I do that?</li>\n</ul>\n\n<p>I found below code relatively useful for me but, not 100% matching with my requirement. please help me on this.</p>\n\n<p>Problem in this code is:- i have specific text(yes) in specific range(e6:e16). \n What I want is to check for only yes word.  If found then write value of column A &amp; row, in which yes word found, into master sheet and check it till last sheet.  </p>\n\n<pre><code>Sub SeachSheets()\n\n    Dim FirstAddress As String, WhatFor As String\n    Dim Cell As Range, Sheet As Worksheet\n\n    WhatFor = InputBox(\"What are you looking for?\", \"Search Criteria\")\n    If WhatFor = Empty Then Exit Sub\n\n    For Each Sheet In Sheets\n        If Sheet.Name &lt;&gt; \"SEARCH\" Then\n            With Sheet.Columns(1)\n                Set Cell = .Find(WhatFor, LookIn:=xlValues, LookAt:=xlPart)\n                If Not Cell Is Nothing Then\n                    FirstAddress = Cell.Address\n                    Do\n                        Cell.EntireRow.Copy _\n                        Destination:=Sheets(\"SEARCH\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\n                        Set Cell = .FindNext(Cell)\n                    Loop Until Cell Is Nothing Or Cell.Address = FirstAddress\n                End If\n            End With\n        End If\n    Next Sheet\n\n    Set Cell = Nothing\nEnd Sub\n</code></pre>\n\n<p>Any help will be appreciated.\nThank you.</p>\n"}, {"tags": ["vba", "excel", "inputbox"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9286035, "user_type": "registered", "profile_image": "https://graph.facebook.com/1850718641910037/picture?type=large", "display_name": "Pedro Amorim", "link": "https://stackoverflow.com/users/9286035/pedro-amorim"}, "edited": false, "score": 0, "creation_date": 1518005591, "post_id": 48663306, "comment_id": 84324272, "body": "thank you!. It is give a error: &quot;Only comments may appear afther End Sub, End Function, or End Property&quot;"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 11, "user_id": 9286035, "user_type": "registered", "profile_image": "https://graph.facebook.com/1850718641910037/picture?type=large", "display_name": "Pedro Amorim", "link": "https://stackoverflow.com/users/9286035/pedro-amorim"}, "edited": false, "score": 0, "creation_date": 1518006151, "post_id": 48663306, "comment_id": 84324624, "body": "Check you don\u2019t have anything after your end sub"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 1, "last_activity_date": 1518004882, "creation_date": 1518004882, "answer_id": 48663306, "question_id": 48663215, "link": "https://stackoverflow.com/questions/48663215/inputbox-to-insert-a-before-input-box/48663306#48663306", "title": "inputBox to insert a before input box", "body": "<p>Is this what you're looking for?</p>\n\n<pre><code>myValue = InputBox(\"insert the number\", \"Hello \" &amp; Range(\"T3\").Value)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9286035, "user_type": "registered", "profile_image": "https://graph.facebook.com/1850718641910037/picture?type=large", "display_name": "Pedro Amorim", "link": "https://stackoverflow.com/users/9286035/pedro-amorim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518004882, "creation_date": 1518004580, "last_edit_date": 1518004802, "question_id": 48663215, "link": "https://stackoverflow.com/questions/48663215/inputbox-to-insert-a-before-input-box", "title": "inputBox to insert a before input box", "body": "<p>I have difficult to insert in a Input ox a input that before was asked:</p>\n\n<p>Because the first input was : what is your name</p>\n\n<pre><code>Dim myValue As Variant\n\nmyValue = InputBox(\"insert the number\", \"Hello ***T3***\")\n\nRange(\"T4\").Value = myValue\n\nEnd Sub\n</code></pre>\n\n<p>T3 is the cell numeber </p>\n\n<p>Can you help me plese?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 120, "user_id": 5671265, "user_type": "registered", "profile_image": "https://graph.facebook.com/1218282431520363/picture?type=large", "display_name": "Kamal Bharakhda", "link": "https://stackoverflow.com/users/5671265/kamal-bharakhda"}, "is_accepted": true, "score": 1, "last_activity_date": 1519931918, "creation_date": 1519931918, "answer_id": 49057162, "question_id": 48663131, "link": "https://stackoverflow.com/questions/48663131/function-hdnum-is-creating-an-error-of-dll/49057162#49057162", "title": "Function HdNum() is creating an Error of DLL", "body": "<p>Anyhow, I got the solution to this problem. </p>\n\n<p>The problem I was facing because my friend has installed 64bit Version of MS Office. and to we all have an idea how coding differs in VB7 which is implied to the 64bit version of MS office. </p>\n\n<p>Here below I'm providing the code to this facility to generate HardDisk Serial no. from any of the version of Office. </p>\n\n<p>In the module paste this following code</p>\n\n<pre><code>#If VBA7 Then\nPrivate Declare PtrSafe Function GetVolumeInformation Lib _\n\"kernel32.dll\" Alias \"GetVolumeInformationA\" _\n(ByVal lpRootPathName As String, _\nByVal lpVolumeNameBuffer As String, _\nByVal nVolumeNameSize As Integer, _\nlpVolumeSerialNumber As Long, _\nlpMaximumComponentLength As Long, _\nlpFileSystemFlags As Long, _\nByVal lpFileSystemNameBuffer As String, _\nByVal nFileSystemNameSize As Long) As Long\n#Else\nPrivate Declare Function GetVolumeInformation Lib _\n\"kernel32.dll\" Alias \"GetVolumeInformationA\" _\n(ByVal lpRootPathName As String, _\nByVal lpVolumeNameBuffer As String, _\nByVal nVolumeNameSize As Integer, _\nlpVolumeSerialNumber As Long, _\nlpMaximumComponentLength As Long, _\nlpFileSystemFlags As Long, _\nByVal lpFileSystemNameBuffer As String, _\nByVal nFileSystemNameSize As Long) As Long\n#End If\n\nPublic Function DriveSerialNumber(ByVal Drive As String) As Long\n\nDim lAns As Long\nDim lRet As Long\nDim sVolumeName As String, sDriveType As String\nDim sDrive As String\n\nsDrive = Drive\nIf Len(sDrive) = 1 Then\n    sDrive = sDrive &amp; \":\\\"\nElseIf Len(sDrive) = 2 And Right(sDrive, 1) = \":\" Then\n    sDrive = sDrive &amp; \"\\\"\nEnd If\n\nsVolumeName = VBA.String$(255, Chr$(0))\nsDriveType = VBA.String$(255, Chr$(0))\nlRet = GetVolumeInformation(sDrive, sVolumeName, 255, lAns, 0, 0, sDriveType, 255)\nDriveSerialNumber = lAns\n\nEnd Function\n\nFunction HdNum() As String\n    HdNum = VBA.Hex(DriveSerialNumber(\"C:\\\"))\nEnd Function\n\nSub HD()\n    MsgBox HdNum\nEnd Sub\n</code></pre>\n\n<p>Thank you Guys. </p>\n"}], "owner": {"reputation": 120, "user_id": 5671265, "user_type": "registered", "profile_image": "https://graph.facebook.com/1218282431520363/picture?type=large", "display_name": "Kamal Bharakhda", "link": "https://stackoverflow.com/users/5671265/kamal-bharakhda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 49057162, "answer_count": 1, "score": 0, "last_activity_date": 1519931918, "creation_date": 1518004323, "last_edit_date": 1518010941, "question_id": 48663131, "link": "https://stackoverflow.com/questions/48663131/function-hdnum-is-creating-an-error-of-dll", "title": "Function HdNum() is creating an Error of DLL", "body": "<p>I found one the function of VBA EXCEL which gives me My System's HardDrive Serial No. in hex format.</p>\n\n<p>okay, I have active Microsoft Excel 16.0 Object Library on my system. </p>\n\n<p>when I have run the same code on my friend's system, I got an error of</p>\n\n<blockquote>\n  <p>Error Loading DLL</p>\n</blockquote>\n\n<p>While checking his systems references, I found He has Active Microsoft Excel 12.0 Object Library. Which is a clear case of Late Binding and Early Binding? (I thought So....!)</p>\n\n<p>Here's the Code of the function that I have got from the random forum, </p>\n\n<pre><code>Function HdNum() As String\n\n    Dim fsObj   As Object\n\n    Dim drv  As Object\n\n    Set fsObj = CreateObject(\"Scripting.FileSystemObject\")\n\n    Set drv = fsObj.Drives(\"C\")\n\n    HdNum = VBA.Hex(drv.serialnumber)\n\nEnd Function\n</code></pre>\n\n<p>can u please guide me what is the problem actually?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 58, "user_id": 5595257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/716bb641dae30a7a564bf5b37b166df9?s=128&d=identicon&r=PG&f=1", "display_name": "Mortaliar", "link": "https://stackoverflow.com/users/5595257/mortaliar"}, "edited": false, "score": 0, "creation_date": 1518004581, "post_id": 48663112, "comment_id": 84323623, "body": "You could try to convert the dates in your sql query. <a href=\"https://stackoverflow.com/questions/10643379/how-do-i-query-for-all-dates-greater-than-a-certain-date-in-sql-server\" title=\"how do i query for all dates greater than a certain date in sql server\">stackoverflow.com/questions/10643379/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 8059001, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155356388612459/picture?type=large", "display_name": "Neil", "link": "https://stackoverflow.com/users/8059001/neil"}, "reply_to_user": {"reputation": 58, "user_id": 5595257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/716bb641dae30a7a564bf5b37b166df9?s=128&d=identicon&r=PG&f=1", "display_name": "Mortaliar", "link": "https://stackoverflow.com/users/5595257/mortaliar"}, "edited": false, "score": 0, "creation_date": 1518006868, "post_id": 48663112, "comment_id": 84325070, "body": "Thanks @Mortaliar - Yes I had tried that one but it gives me; Run-time error &#39;1004&#39;: The command &#39;SELECT * FROM [storm sales (2)] WHERE ADVICEDATE &gt;= Convert(datetime , &amp;SellStartDate&amp;)&#39; isn&#39;t supported."}, {"owner": {"reputation": 11, "user_id": 8059001, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155356388612459/picture?type=large", "display_name": "Neil", "link": "https://stackoverflow.com/users/8059001/neil"}, "reply_to_user": {"reputation": 58, "user_id": 5595257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/716bb641dae30a7a564bf5b37b166df9?s=128&d=identicon&r=PG&f=1", "display_name": "Mortaliar", "link": "https://stackoverflow.com/users/5595257/mortaliar"}, "edited": false, "score": 0, "creation_date": 1518007222, "post_id": 48663112, "comment_id": 84325264, "body": "Also tried Convert(datetime , &#39;&amp;SellStartDate&amp;&#39;), Convert(datetime , &#39;SellStartDate&#39;), Convert(date , &#39;&amp;SellStartDate&amp;&#39;), etc which give: [DataFormat.Error] We couldn&#39;t parse the input as a Date value."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8059001, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155356388612459/picture?type=large", "display_name": "Neil", "link": "https://stackoverflow.com/users/8059001/neil"}, "edited": false, "score": 0, "creation_date": 1518008399, "post_id": 48664313, "comment_id": 84326129, "body": "Thank you for replying again, it is appreciated. Yes I tried with and without both &#39; and &amp; for date and datetime. Alas all leading to the same end, not parsing."}, {"owner": {"reputation": 58, "user_id": 5595257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/716bb641dae30a7a564bf5b37b166df9?s=128&d=identicon&r=PG&f=1", "display_name": "Mortaliar", "link": "https://stackoverflow.com/users/5595257/mortaliar"}, "reply_to_user": {"reputation": 11, "user_id": 8059001, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155356388612459/picture?type=large", "display_name": "Neil", "link": "https://stackoverflow.com/users/8059001/neil"}, "edited": false, "score": 0, "creation_date": 1518009483, "post_id": 48664313, "comment_id": 84326984, "body": "It could be the matter of how the date is stored in a particular cell. Did you run a simple select on just the value you&#39;re passing?   &quot;SELECT &amp;SellEndDate&amp;&quot;"}, {"owner": {"reputation": 11, "user_id": 8059001, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155356388612459/picture?type=large", "display_name": "Neil", "link": "https://stackoverflow.com/users/8059001/neil"}, "edited": false, "score": 0, "creation_date": 1518018275, "post_id": 48664313, "comment_id": 84333314, "body": "Run-time error &#39;1004&#39;: The command &#39;SELECT &amp;SellStartDate&amp;&#39; isn&#39;t supported  Ifr this helps  SELECT ADVICEDATE = &#39;&amp;SellStartDate&amp;&#39;  returns ADVICEDATE in the header row of the sheet with &amp;SellStartDate&amp; in the cell underneath."}, {"owner": {"reputation": 11, "user_id": 8059001, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155356388612459/picture?type=large", "display_name": "Neil", "link": "https://stackoverflow.com/users/8059001/neil"}, "edited": false, "score": 0, "creation_date": 1518019394, "post_id": 48664313, "comment_id": 84334112, "body": "What I can&#39;t get my head around is that = and != work but &gt; and &lt; don&#39;t. Am I missing something here?"}, {"owner": {"reputation": 58, "user_id": 5595257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/716bb641dae30a7a564bf5b37b166df9?s=128&d=identicon&r=PG&f=1", "display_name": "Mortaliar", "link": "https://stackoverflow.com/users/5595257/mortaliar"}, "reply_to_user": {"reputation": 11, "user_id": 8059001, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155356388612459/picture?type=large", "display_name": "Neil", "link": "https://stackoverflow.com/users/8059001/neil"}, "edited": false, "score": 0, "creation_date": 1518078855, "post_id": 48664313, "comment_id": 84358841, "body": "What is the datatype of ADVICEDATE in your SQL table?  It is possible it&#39;s not a date or datetime, thus you&#39;d have to convert ADVICEDATE as well."}, {"owner": {"reputation": 11, "user_id": 8059001, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155356388612459/picture?type=large", "display_name": "Neil", "link": "https://stackoverflow.com/users/8059001/neil"}, "edited": false, "score": 0, "creation_date": 1518105433, "post_id": 48664313, "comment_id": 84377297, "body": "I just double checked and can confirm it is a date."}], "tags": [], "owner": {"reputation": 58, "user_id": 5595257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/716bb641dae30a7a564bf5b37b166df9?s=128&d=identicon&r=PG&f=1", "display_name": "Mortaliar", "link": "https://stackoverflow.com/users/5595257/mortaliar"}, "is_accepted": false, "score": -1, "last_activity_date": 1518009349, "last_edit_date": 1518009349, "creation_date": 1518007921, "answer_id": 48664313, "question_id": 48663112, "link": "https://stackoverflow.com/questions/48663112/excel-expression-error-we-cannot-apply-operator-to-types-text-and-date/48664313#48664313", "title": "Excel [Expression.Error] We cannot apply operator &lt; to types Text and Date", "body": "<p>Did you try the conversion with apostrophes in the query? </p>\n\n<pre><code>Convert(datetime , &amp;SellStartDate&amp;)\n\nConvert(datetime ,' &amp;SellStartDate&amp; ')\n</code></pre>\n\n<p>This is how SQL converts with and without the apostrophes. </p>\n\n<pre><code>Convert(datetime, '2010-04-01' ) -&gt; 2010-04-01 00:00:00.000\n\nConvert(datetime, 2010-04-01 ) -&gt; 1905-06-29 00:00:00.000\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8059001, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155356388612459/picture?type=large", "display_name": "Neil", "link": "https://stackoverflow.com/users/8059001/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3172, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1518009349, "creation_date": 1518004266, "last_edit_date": 1518007360, "question_id": 48663112, "link": "https://stackoverflow.com/questions/48663112/excel-expression-error-we-cannot-apply-operator-to-types-text-and-date", "title": "Excel [Expression.Error] We cannot apply operator &lt; to types Text and Date", "body": "<p>I have been searching for several days now (as a total noob).</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim SellStartDate As Date 'Declare the SellStartDate as Date\nDim SellEndDate As Date 'Declare the SellEndDate as Date\nSellStartDate = Sheets(\"Summary\").Range(\"C3\").Value   'Pass value from \ncell B3 to SellStartDate variable\nSellEndDate = Sheets(\"Summary\").Range(\"C4\").Value    'Pass value from \ncell B4 to SellEndDate variable\n'Pass the Parameters values to the Stored Procedure used in the Data \nConnection\nWith ActiveWorkbook.Connections(\"Query - storm sales \n(2)\").OLEDBConnection\n.CommandText = \"SELECT * FROM [storm sales (2)] WHERE ADVICEDATE &gt;= \n'&amp;SellStartDate&amp;' AND ADVICEDATE &lt;= '&amp;SellEndDate&amp;'\"\nActiveWorkbook.Connections(\"Query - storm sales (2)\").Refresh\nEnd With\nEnd Sub\n</code></pre>\n\n<p>The above code was based on an item found elsewhere on the internet.</p>\n\n<p>It passes the values to the CommandText if you use <code>=</code> or <code>!=</code> but not if you use anything containing <code>&lt;</code> or <code>&gt;</code></p>\n\n<p>The error I get is </p>\n\n<blockquote>\n  <p>[Expression.Error] We cannot apply operator &lt; to types Text and Date</p>\n</blockquote>\n\n<p>What I am asking is what would give me the same result as <code>&gt;=</code> and <code>&lt;=</code> without the error.</p>\n\n<p>Thanks in advance,</p>\n\n<p>Neil.</p>\n"}, {"tags": ["arrays", "vba", "excel", "max"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1518001851, "post_id": 48662254, "comment_id": 84321902, "body": "What does the <code>max</code> have to do with your problem? You refer to it in both your question and its title, but the loop that you are asking about doesn&#39;t seem to involve it at all. The phrase &quot;the last repetition of the max&quot; suggests that this should somehow or other be involved with the loop -- but how?"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 1, "creation_date": 1518002236, "post_id": 48662254, "comment_id": 84322162, "body": "Not really answer to your question but doing <code>ReDim Preserve</code> inside loop per step is not considered as good practice. Your intent seems to load non-blank data from column D to I in an array. Is it correct understanding?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1518002426, "post_id": 48662254, "comment_id": 84322282, "body": "To add to the comment of @shrivallabha.redij -- using <code>ReDim Preserve</code> that way makes the complexity quadratic since at each stage you are allocating a new array and copying the old elements. A better strategy is to over-allocate the original array and use a single <code>ReDim Preserve</code> afterwards. Alternatively, just use a collection."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9103716"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1518003325, "post_id": 48662254, "comment_id": 84322854, "body": "the max comes into the code later but it is also where the last row of data is, is there away so that i can specify the code to work until the last row instead? @JohnColeman"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1518003611, "post_id": 48662254, "comment_id": 84323051, "body": "Something like <code>Cells(Rows.Count, &quot;D&quot;).End(xlUp).Row</code> is a standard way to get the last row in column D in the active sheet which contains data. It will give 1 in the event that column D is all blank."}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1518006546, "post_id": 48662254, "comment_id": 84324874, "body": "I&#39;d suggest <code>lngLastRow = Sheets(&quot;Result&quot;).Range(&quot;D:I&quot;).Find(&quot;*&quot;, Sheets(&quot;Result&quot;).Range(&quot;D1&quot;), , , xlByRows, xlPrevious).Row</code> which will locate the last row for specified columns."}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1518006774, "post_id": 48662254, "comment_id": 84325014, "body": "Max can give wrong / misleading results if there are blanks and the MAX doesn&#39;t match with filled rows. I have seen <code>COUNTA</code> being used for such purpose but there are better ways to get the last row in VBA."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1518001682, "creation_date": 1518001682, "answer_id": 48662304, "question_id": 48662254, "link": "https://stackoverflow.com/questions/48662254/vba-how-to-run-the-code-until-it-reaches-the-last-max-function/48662304#48662304", "title": "VBA how to run the code until it reaches the last max function", "body": "<p>Add a condition for the length of the cell before adding to the array:</p>\n\n<pre><code>For Each cell In DataRange.Cells\n    If Len(Trim(Cells)) &gt; 0 Then\n        ReDim Preserve myArray(x)\n        myArray(x) = cell.Value\n        x = x + 1\n    End If\nNext cell\n</code></pre>\n\n<p>The <code>Trim()</code> would remove the spaces from left and right, thus if there is a cell with just one space like this <code></code> it would still give 0 and would not be taken into account.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/ltrim-rtrim-and-trim-functions\" rel=\"nofollow noreferrer\">Trim MSDN</a></p>\n"}, {"tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": true, "score": 1, "last_activity_date": 1518007238, "creation_date": 1518007238, "answer_id": 48664095, "question_id": 48662254, "link": "https://stackoverflow.com/questions/48662254/vba-how-to-run-the-code-until-it-reaches-the-last-max-function/48664095#48664095", "title": "VBA how to run the code until it reaches the last max function", "body": "<p>Here's an alternative approach which should skip <code>ReDim Preserve</code> altogether.</p>\n\n<p>See if it helps your situation.</p>\n\n<pre><code>Sub BuildArray()\nDim lngLastRow As Long\nDim rng As Range\nDim arList As Object\nDim varOut As Variant\n\nlngLastRow = Sheets(\"Result\").Range(\"D:I\").Find(\"*\", Sheets(\"Result\").Range(\"D1\"), , , xlByRows, xlPrevious).Row\nSet arList = CreateObject(\"System.Collections.ArrayList\")\nFor Each rng In Sheets(\"Result\").Range(\"D1:I\" &amp; lngLastRow)\n    If Len(Trim(rng.Value)) &gt; 0 Then\n        arList.Add rng.Value\n    End If\nNext\nvarOut = arList.ToArray\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9103716"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 48664095, "answer_count": 2, "score": 1, "last_activity_date": 1518007238, "creation_date": 1518001521, "question_id": 48662254, "link": "https://stackoverflow.com/questions/48662254/vba-how-to-run-the-code-until-it-reaches-the-last-max-function", "title": "VBA how to run the code until it reaches the last max function", "body": "<p>I have a code for an array that saves all the data from my spreadsheet in columns D to I, however it also saves all of the blank cells from the sheet too which I don't want. All of the columns have the same number of rows, but ideally I want the array for every row from the second until it finds the last repetition of the max that it works out from column D. My code is:</p>\n\n<pre><code>Sub PopulatingArrayVariable()\n\nDim myArray() As Variant\nDim DataRange As Range\nDim cell As Range\nDim x As Long\nDim TotalTargets As Double\n\nTotalTargets = WorksheetFunction.Max(Columns(\"D\"))\n\nSet DataRange = Sheets(\"Result\").Range(\"D:I\")\n\nFor Each cell In DataRange.Cells\n    ReDim Preserve myArray(x)\n    myArray(x) = cell.Value\n    x = x + 1\nNext cell\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1518000430, "post_id": 48661694, "comment_id": 84321001, "body": "The easiest <i>is</i> with a &quot;helper column&quot; , which you could insert &amp; then remove programmatically, so it would be invisible to the user, and would accomplish your goal <b><i>much</b> more quickly</i>.  The helper column doesn&#39;t necessarily have to be next to it, or even on the same worksheet."}, {"owner": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1518000684, "post_id": 48661694, "comment_id": 84321172, "body": "@ashleedawg If that&#39;s the case, then that&#39;s what I&#39;ll do. I just thought it was worth asking just in case there was some super easy solution that I hadn&#39;t thought of."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1518000857, "post_id": 48661694, "comment_id": 84321285, "body": "You could use arrays and do all the sorting there, but @ashleedawg&#39;s suggestions seems the most sensible."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1518002260, "post_id": 48661694, "comment_id": 84322171, "body": "Oh, it&#39;s definitely 100% do-able the other way... just depends how much time you want to spend on it!  It would be a great learning exercise -- in fact I have fond memories of writing my first <a href=\"https://en.wikipedia.org/wiki/Bubble_sort\" rel=\"nofollow noreferrer\">bubble-sort routine</a>, on a (Commodore 64](<a href=\"https://virtualconsoles.com/online-emulators/c64/\" rel=\"nofollow noreferrer\">virtualconsoles.com/online-emulators/c64</a>) I think, before sorting algorithms were included in, well, everything.  (Sorry, that might sound like I&#39;m mocking the idea -- fact is, there could very well be a <i>reason</i> you can&#39;t do it any other way.)"}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 7240351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f022d85c0352244628cabc55dcb16a?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Lipinski", "link": "https://stackoverflow.com/users/7240351/maciej-lipinski"}, "edited": false, "score": 0, "creation_date": 1518002631, "post_id": 48662423, "comment_id": 84322417, "body": "<code>System.Collections.ArrayList</code>? How does it work, is that a .NET object that works in VBA via late binding? Do you need any special libraries to use this?"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 187, "user_id": 7240351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f022d85c0352244628cabc55dcb16a?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Lipinski", "link": "https://stackoverflow.com/users/7240351/maciej-lipinski"}, "edited": false, "score": 0, "creation_date": 1518002911, "post_id": 48662423, "comment_id": 84322597, "body": "ArrayLists are great - they are like collections except they have loads of useful functions where collections have pretty much none. No special libraries - just late bind or you can (manually, I think) make a reference and early bind too. Lots of good info here: <a href=\"http://www.snb-vba.eu/VBA_Arraylist_en.html\" rel=\"nofollow noreferrer\">snb-vba.eu/VBA_Arraylist_en.html</a>"}, {"owner": {"reputation": 187, "user_id": 7240351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f022d85c0352244628cabc55dcb16a?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Lipinski", "link": "https://stackoverflow.com/users/7240351/maciej-lipinski"}, "edited": false, "score": 1, "creation_date": 1518005199, "post_id": 48662423, "comment_id": 84324025, "body": "I know they&#39;re great, I use them in Java all the time :) Thanks for the link!"}, {"owner": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "edited": false, "score": 0, "creation_date": 1518010548, "post_id": 48662423, "comment_id": 84327752, "body": "Thank you, this is just the kind of thing I was looking for, and could never have worked out by myself!"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "edited": false, "score": 0, "creation_date": 1518010663, "post_id": 48662423, "comment_id": 84327827, "body": "@Slab, no problem -- it was an interesting question! If you have any questions about the solution just ask away :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1518016362, "post_id": 48662423, "comment_id": 84331903, "body": "@CallumDA - What would happen if we change <code>blue(4)</code> to <code>blue(7)</code> with this solution?"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1518017750, "post_id": 48662423, "comment_id": 84332909, "body": "@Vityata It would break. I didn&#39;t cater for that initially because there were no dupes in the example data. However, I&#39;ve now added a simple while loop which avoids problems with (up to 100m) duplicate numbers - keeping them in their original order. Good question :)"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 3, "last_activity_date": 1518017483, "last_edit_date": 1518017483, "creation_date": 1518002040, "answer_id": 48662423, "question_id": 48661694, "link": "https://stackoverflow.com/questions/48661694/sorting-by-column-using-character-in-middle-of-each-cell-without-helper-column/48662423#48662423", "title": "Sorting by column using character in middle of each cell, without helper column", "body": "<p>You can use a <code>Dictionary</code> to store your values and their corresponding numbers and then there are a number of sorting methods. I opted to use an <code>ArrayList</code> to do the sorting rather than writing a bespoke sorting function.</p>\n\n<pre><code>Public Sub SortByNumber()\n    Dim arrayList As Object, inputDictionary As Object, outputDictionary As Object 'late binding so you can drop the code in easily\n    Dim rng As Range, r As Range\n    Dim num As Double\n    Dim v As Variant\n\n    Set rng = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1:A4\")\n    Set arrayList = CreateObject(\"System.Collections.ArrayList\")\n    Set inputDictionary = CreateObject(\"Scripting.Dictionary\")\n    Set outputDictionary = CreateObject(\"Scripting.Dictionary\")\n\n    'put current values into dictionary and arraylist\n    For Each r In rng\n        num = CLng(Mid(r.Value, InStr(r.Value, \"(\") + 1, Len(r.Value) - InStr(r.Value, \"(\") - 1))\n        Do While inputDictionary.exists(num) 'avoid errors with duplicates numbers (see comments)\n            num = num + 0.00000001\n        Loop\n        inputDictionary.Add Item:=r.Value, Key:=num\n        arrayList.Add num\n    Next r\n\n    arrayList.Sort\n\n    'use sorted arraylist to determine order of items in output dictionary\n    For Each v In arrayList.toarray\n        outputDictionary.Add Item:=v, Key:=inputDictionary.Item(v)\n    Next v\n\n    'output values to the next column -- just remove the offset to overwrite original values\n    rng.Offset(0, 1).Value = WorksheetFunction.Transpose(outputDictionary.keys())\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>The result looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/s0HSZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s0HSZ.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1518002680, "creation_date": 1518002680, "answer_id": 48662599, "question_id": 48661694, "link": "https://stackoverflow.com/questions/48661694/sorting-by-column-using-character-in-middle-of-each-cell-without-helper-column/48662599#48662599", "title": "Sorting by column using character in middle of each cell, without helper column", "body": "<p>Try this:</p>\n\n<pre><code>Sub OrderByColumn()\nDim i As Long, tempColumn As Long, colorColumn As Long, color As String\n'get table to variable\nDim tableToOrder As Range\n'here ypou have to specify your own range!!\nSet tableToOrder = Range(\"A1:C5\")\ncolorColumn = tableToOrder.Column\ntempColumn = colorColumn + tableToOrder.Columns.Count\n'insert new column at the end of the table and populate with extracted numbers\nColumns(tempColumn).Insert\nFor i = tableToOrder.Row To (tableToOrder.Rows.Count + tableToOrder.Row - 1)\n    color = Cells(i, colorColumn).Value\n    Cells(i, tempColumn).Value = Mid(color, InStr(1, color, \"(\") + 1, InStr(1, color, \")\") - InStr(1, color, \"(\") - 1)\nNext\ni = i - 1 'now i points to last row in range\n'order whole table accordingly to temporary column\nRange(Cells(tableToOrder.Row, tableToOrder.Column), Cells(i, tempColumn)).Sort Key1:=Range(Cells(tableToOrder.Row, tempColumn), Cells(i, tempColumn))\n'delete column\nColumns(tempColumn).Delete\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "edited": false, "score": 1, "creation_date": 1518010065, "post_id": 48663867, "comment_id": 84327416, "body": "Thanks, that&#39;s an interesting solution."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1518010119, "last_edit_date": 1518010119, "creation_date": 1518006622, "answer_id": 48663867, "question_id": 48661694, "link": "https://stackoverflow.com/questions/48661694/sorting-by-column-using-character-in-middle-of-each-cell-without-helper-column/48663867#48663867", "title": "Sorting by column using character in middle of each cell, without helper column", "body": "<p>You can do something interesting, if you really do not want to add a helper column. Pretty much the following:</p>\n\n<ul>\n<li>let's say your <code>inputRange</code> is <code>Range(\"A1:A4\")</code></li>\n<li><p>declare a variant <code>virtualRange</code>, which would be a bit of a tricky - it would take the values of the <code>inputRange</code> and the next column:</p>\n\n<p><code>virtualRange = Union(inputRange, inputRange.Offset(0, 1)).Value</code></p></li>\n<li><p>then loop through your <code>inputRange</code> and assign the cell value to the second dimension of the <code>virtualRange</code>. It should pretty much look like this in the local window:</p></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/JjzY7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JjzY7.png\" alt=\"enter image description here\"></a></p>\n\n<ul>\n<li><p>Now the funny part - pass the virtualRange to the <code>SortDataBySecondValue</code> and it will return the <code>virtualRange</code> sorted. Here is a really important point - if you pass the <code>virtualRange</code> with parenthesis, like this <code>SortDataBySecondValue (virtualRange)</code> nothing useful would happen - the parenthesis overrule the <code>ByRef</code> argument in <code>SortDataBySecondValue()</code> and the <code>virtualRange</code> would remain untact.</p></li>\n<li><p>At the end you have your <code>virtualRange</code> sorted and you have to pass its values correctly to the inputRange. This is achievable with a simple loop:</p>\n\n<p><code>For Each myCell In inputRange\n    Dim cnt As Long\n    cnt = cnt + 1\n    myCell = virtualRange(cnt, 1)\nNext myCell</code></p></li>\n<li><p>Now the <code>inputRange</code> is sorted as expected:</p></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/dhLil.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dhLil.png\" alt=\"enter image description here\"></a></p>\n\n<p>The whole code is here:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim inputRange      As Range\n    Dim myCell          As Range\n    Dim virtualRange    As Variant\n\n    Set inputRange = Range(\"A1:A4\")\n    virtualRange = Union(inputRange, inputRange.Offset(0, 1)).Value\n\n    For Each myCell In inputRange.Columns(1).Cells\n        virtualRange(myCell.Row, 2) = locateNumber(myCell)\n    Next myCell\n\n    SortDataBySecondValue virtualRange\n\n    For Each myCell In inputRange\n        Dim cnt As Long\n        cnt = cnt + 1\n        myCell = virtualRange(cnt, 1)\n    Next myCell\n\nEnd Sub\n\nPublic Function locateNumber(ByVal s As String) As Long\n\n    Dim startIndex As Long\n    Dim endIndex As Long\n\n    startIndex = InStr(1, s, \"(\") + 1\n    endIndex = InStr(1, s, \")\")\n    locateNumber = Mid(s, startIndex, endIndex - startIndex)\n\nEnd Function\n\nSub SortDataBySecondValue(ByRef Data As Variant)\n\n    Dim i               As Long\n    Dim j               As Long\n    Dim temp            As Variant\n    Dim sortBy          As Long: sortBy = 2\n\n    ReDim temp(UBound(Data) - 1, sortBy)\n    For i = LBound(Data) To UBound(Data)\n        For j = i To UBound(Data)\n            If Data(i, sortBy) &gt; Data(j, sortBy) Then\n                temp(i, 1) = Data(i, 1)\n                temp(i, sortBy) = Data(i, sortBy)\n                Data(i, 1) = Data(j, 1)\n                Data(i, sortBy) = Data(j, sortBy)\n                Data(j, 1) = temp(i, 1)\n                Data(j, sortBy) = temp(i, sortBy)\n            End If\n        Next j\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 48662423, "answer_count": 3, "score": 3, "last_activity_date": 1518212841, "creation_date": 1517999956, "last_edit_date": 1518212841, "question_id": 48661694, "link": "https://stackoverflow.com/questions/48661694/sorting-by-column-using-character-in-middle-of-each-cell-without-helper-column", "title": "Sorting by column using character in middle of each cell, without helper column", "body": "<p>Is it possible to sort a range by a column, but sort using a single character in the middle of the string in each cell?</p>\n\n<p>So column looks like this:</p>\n\n<pre><code>red(7)\nblue(4)\norange(9)\ngreen(2)\netc..\n</code></pre>\n\n<p>I want to sort it using the number within the brackets.</p>\n\n<p>My current code sorts the columns alphabetically:</p>\n\n<pre><code>With sheetSUMMARY\n\n.Range(.Cells(summaryFirstRow, summaryReForenameCol)), _\n    .Cells(summaryLastRow, summaryReColourCol))). _\nSort _\nkey1:=.Range(.Cells(summaryFirstRow, summaryReColourCol)), _\n    .Cells(summaryLastRow, summaryReColourCol))), _\norder1:=xlAscending, _\nHeader:=xlNo\n\nEnd With\n</code></pre>\n\n<p>So it looks like this:</p>\n\n<pre><code>blue(4)\ngreen(2)\norange(9)\nred(7)\n</code></pre>\n\n<p>Without making a helper column in excel (which extracts the numbers), is it possible to sort it like this purely programatically? (I haven't really got space for a helper column at this stage)</p>\n\n<pre><code>green(2)\nblue(4)\nred(7)\norange(9)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1517998932, "post_id": 48661208, "comment_id": 84319898, "body": "Can&#39;t you just change those merged cells into <code>center across selection</code> cells ?"}, {"owner": {"reputation": 176, "user_id": 6077540, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fbc32e3fe52b45020414e6c7ab7b3bab?s=128&d=identicon&r=PG&f=1", "display_name": "Mick17", "link": "https://stackoverflow.com/users/6077540/mick17"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1517999104, "post_id": 48661208, "comment_id": 84320013, "body": "Can the merged cells be changed to center across selection cells by code?"}], "answers": [{"comments": [{"owner": {"reputation": 176, "user_id": 6077540, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fbc32e3fe52b45020414e6c7ab7b3bab?s=128&d=identicon&r=PG&f=1", "display_name": "Mick17", "link": "https://stackoverflow.com/users/6077540/mick17"}, "edited": false, "score": 0, "creation_date": 1518001283, "post_id": 48661476, "comment_id": 84321570, "body": "when I do this it doesn&#39;t take in account that the hidden rows shouldn&#39;t be copied to the &quot;destination&quot; sheet"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 3, "last_activity_date": 1517999384, "creation_date": 1517999384, "answer_id": 48661476, "question_id": 48661208, "link": "https://stackoverflow.com/questions/48661208/error-by-copy-pasting-ranged-due-to-merged-cells/48661476#48661476", "title": "Error by copy pasting ranged due to merged cells", "body": "<p>For the <code>Formats</code> and the <code>ColumnWidths</code> being in a merged cell, which is only partially copied, the easiest way is to add a new worksheet, to copy the initial values there and to unmerge it. Then do something like this:</p>\n\n<pre><code>Option Explicit\n\nSub TestMe()\n\n    Dim wksTheNew           As Worksheet\n    Dim wksReview           As Worksheet\n    Dim wksDestination      As Worksheet\n\n    Set wksReview = Worksheets(\"Review\")\n    Set wksDestination = Worksheets(\"Destination\")\n\n    Set wksTheNew = ThisWorkbook.Worksheets.Add\n\n    wksReview.Cells.Copy wksTheNew.Cells\n    wksTheNew.Cells.UnMerge\n\n    'now copy the formats and the values from wksTheNew\n    'it will not give an error, because it is unmerged\n\n    Application.DisplayAlerts = False\n    wksTheNew.Delete\n    Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>Once you are ready with your actions, you may simply delete the new worksheet.</p>\n"}, {"comments": [{"owner": {"reputation": 176, "user_id": 6077540, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fbc32e3fe52b45020414e6c7ab7b3bab?s=128&d=identicon&r=PG&f=1", "display_name": "Mick17", "link": "https://stackoverflow.com/users/6077540/mick17"}, "edited": false, "score": 0, "creation_date": 1518002067, "post_id": 48662260, "comment_id": 84322050, "body": "It works for the copy pasting, but this also doesnt take in account that the hidden rows shouldnt be pasted to the &quot;destination&quot; sheet. Is there a way to only let the copy pasting affect the visible rows?"}, {"owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "reply_to_user": {"reputation": 176, "user_id": 6077540, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fbc32e3fe52b45020414e6c7ab7b3bab?s=128&d=identicon&r=PG&f=1", "display_name": "Mick17", "link": "https://stackoverflow.com/users/6077540/mick17"}, "edited": false, "score": 0, "creation_date": 1518002697, "post_id": 48662260, "comment_id": 84322451, "body": "Humm... I used Autofilter. With autofilter it works, can you use it?"}, {"owner": {"reputation": 176, "user_id": 6077540, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fbc32e3fe52b45020414e6c7ab7b3bab?s=128&d=identicon&r=PG&f=1", "display_name": "Mick17", "link": "https://stackoverflow.com/users/6077540/mick17"}, "edited": false, "score": 0, "creation_date": 1518002890, "post_id": 48662260, "comment_id": 84322583, "body": "unfortunately not, but I think I solved it. If I use the solution below, unmerge the cells in a new worksheet. Then hide the rows. Then copy paste, with adding {.SpecialCells(xlCellTypeVisible)} before {.copy}"}, {"owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "reply_to_user": {"reputation": 176, "user_id": 6077540, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fbc32e3fe52b45020414e6c7ab7b3bab?s=128&d=identicon&r=PG&f=1", "display_name": "Mick17", "link": "https://stackoverflow.com/users/6077540/mick17"}, "edited": false, "score": 0, "creation_date": 1518012759, "post_id": 48662260, "comment_id": 84329266, "body": "Ok, you solved with <code>.SpecialCells</code>, so you don&#39;t need a new worksheet, as @vityata answered. You changed your question, but using &quot;Paste all&quot; you wouldn&#39;t get problem you originally want to solve."}], "tags": [], "owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "is_accepted": false, "score": 0, "last_activity_date": 1518001550, "creation_date": 1518001550, "answer_id": 48662260, "question_id": 48661208, "link": "https://stackoverflow.com/questions/48661208/error-by-copy-pasting-ranged-due-to-merged-cells/48662260#48662260", "title": "Error by copy pasting ranged due to merged cells", "body": "<p>Just change your sequence:</p>\n\n<pre><code>With Sheets(\"DESTINATION\").Range(\"A1\")\n    .PasteSpecial Paste:=xlPasteValues\n    .PasteSpecial Paste:=xlPasteFormats\n    .PasteSpecial Paste:=xlPasteColumnWidths\nEnd With\n</code></pre>\n\n<p>Pasting values first shouldn't trigger an error.</p>\n"}], "owner": {"reputation": 176, "user_id": 6077540, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fbc32e3fe52b45020414e6c7ab7b3bab?s=128&d=identicon&r=PG&f=1", "display_name": "Mick17", "link": "https://stackoverflow.com/users/6077540/mick17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2345, "favorite_count": 0, "accepted_answer_id": 48661476, "answer_count": 2, "score": 1, "last_activity_date": 1518010986, "creation_date": 1517998704, "last_edit_date": 1518010986, "question_id": 48661208, "link": "https://stackoverflow.com/questions/48661208/error-by-copy-pasting-ranged-due-to-merged-cells", "title": "Error by copy pasting ranged due to merged cells", "body": "<p>SOLVED, SEE CODE BELOW</p>\n\n<p>I'm working on a code for filtering data and pasting the filtered data to the \"destination\" sheet.\nIn the \"review\" sheet there is a long list with data that can be subdivided in certain categories. In cell F9 off the coversheet I can select a category.\nAfter pressing a button the data in the \"review\" sheet needs to be filtered and the data that is left after filtering should be pasted in the \"destination\" sheet. the \"destination\" sheet is a blank new sheet.</p>\n\n<p>The filtering part works, however the copy paste part is giving some errors. Because the \"review\" sheet has some merged cells in it. I am able to paste the formatting and the columnwidths, but the values give an error due to merged cells. Is there some way to work around this??</p>\n\n<p>In addition to this, when pasting the formatting, this is pasted to the same number of rows as in the \"review\" sheet before filtering. I want the formatting to be applicable on only the numer of rows left after filtering.</p>\n\n<p>I hope someone can help me out.</p>\n\n<p>See my source code below:</p>\n\n<pre><code>Dim wksCVP As Worksheet\nDim wksReview As Worksheet\nDim wksNew As Worksheet\n\nSet wksReview = Worksheets(\"REVIEW\")\nSet wksCVP = Worksheets(\"COVER PAGE\")\nSet wksNew = ThisWorkbook.Worksheets.Add\n\nwksReview.Cells.Copy wksNew.Cells\nwksNew.Cells.UnMerge\n\nDim LastRow As Long\nWith wksNew\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\n\nSelect Case wksCVP.Range(\"F9\").Value\n    Case \"Instrumentation\"\n        kolom = \"J\"\n    Case \"Equipment\"\n        kolom = \"K\"\n    Case \"Design / Fabrication\"\n        kolom = \"L\"\n    Case \"Inspection &amp; Testing\"\n        kolom = \"M\"\n    Case \"General / Other\"\n        kolom = \"N\"\nEnd Select\n\nIf wksCVP.Range(\"F9\").Value &lt;&gt; \"\" Then\n    For i = 5 To LastRow\n        If wksNew.Range(kolom &amp; i).Value &lt;&gt; \"X\" Then\n            wksNew.Rows(i).EntireRow.Hidden = True\n        End If\n    Next i\nEnd If\n\n wksNew.Activate\nActiveSheet.Range(\"A5\", \"Z\" &amp; LastRow + 1).SpecialCells(xlCellTypeVisible).Copy\n\nWith Sheets(\"DESTINATION\").Range(\"A1\")\n    .PasteSpecial Paste:=xlPasteAll\nEnd With\n\nwksNew.delete\n</code></pre>\n"}, {"tags": ["vba", "excel", "report", "userform"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1517996818, "post_id": 48660468, "comment_id": 84318500, "body": "That&#39;s okay if you really don&#39;t know where to start, but you must give us something which helps us to recreate your situation. Otherwise the solutions will vary wildly. As a bare minimum, edit your question to include some sample data and perhaps a screenshot of what your userform looks like."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1543155842, "post_id": 48660468, "comment_id": 93807312, "body": "Why have you never replied to these answers?"}, {"owner": {"reputation": 39, "user_id": 9304370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a768d895898aa8fbd04ce66a7e6b5f65?s=128&d=identicon&r=PG&f=1", "display_name": "war360", "link": "https://stackoverflow.com/users/9304370/war360"}, "edited": false, "score": 0, "creation_date": 1543161288, "post_id": 48660468, "comment_id": 93808945, "body": "At the time I told to move onto other functions the user form could do after looking at these answers not sure that what I was after. looking for user form to show live stats of how many matching words were in a column. I&#39;ll look into it again now."}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 1, "last_activity_date": 1517998187, "last_edit_date": 1517998187, "creation_date": 1517997693, "answer_id": 48660882, "question_id": 48660468, "link": "https://stackoverflow.com/questions/48660468/counting-words-in-column-and-then-display-said-amount-on-userform/48660882#48660882", "title": "Counting words in column and then display said amount on userform", "body": "<p>You can create a function to do this.</p>\n\n<p>Assign all the cells in your column into a string, then push that string into your function.</p>\n\n<pre><code>Function countWords(ByVal sText As String) As Long\n\n    Dim sTextArr() As String\n    sTextArr = Split(sText, \" \")\n    countWords = UBound(sTextArr) + 1\n\nEnd Function\n\nSub test()\n\n    Dim myStr As String\n    myStr = \"The dog barked non-stop. I wish he would stop\"\n    MsgBox countWords(myStr)\n\nEnd Sub\n</code></pre>\n\n<p>You would just assign the value of <code>countWords</code> to your userform control.</p>\n"}, {"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 1, "last_activity_date": 1518000923, "creation_date": 1518000923, "answer_id": 48662035, "question_id": 48660468, "link": "https://stackoverflow.com/questions/48660468/counting-words-in-column-and-then-display-said-amount-on-userform/48662035#48662035", "title": "Counting words in column and then display said amount on userform", "body": "<p>If you want to add the values into a ListBox with two columns on your UserForm, having the item in the first column and the count of items in the second column then the following will help:</p>\n\n<pre><code>Sub foo()\nDim k As Variant\nDim d As Variant\nDim c As Range\nDim rng As Range\nDim ws As Worksheet: Set ws = Sheets(\"Sheet1\")\n'declare and set your worksheet, amend as required\nLastRow = ws.Cells(ws.Rows.Count, \"B\").End(xlUp).Row\n'get the last row with data on Column B\nSet rng = ws.Range(\"B2:B\" &amp; LastRow)\nSet d = CreateObject(\"Scripting.Dictionary\")\n\nFor Each c In rng\n    d(c.Value) = d(c.Value) + 1\nNext c\n\nFor Each k In d\n    If k &lt;&gt; \"\" Then\n        ListBox1.AddItem k\n        ListBox1.List(ListBox1.ListCount - 1, 1) = d(k)\n    End If\nNext k\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9304370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a768d895898aa8fbd04ce66a7e6b5f65?s=128&d=identicon&r=PG&f=1", "display_name": "war360", "link": "https://stackoverflow.com/users/9304370/war360"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518000923, "creation_date": 1517996578, "question_id": 48660468, "link": "https://stackoverflow.com/questions/48660468/counting-words-in-column-and-then-display-said-amount-on-userform", "title": "Counting words in column and then display said amount on userform", "body": "<p>I don't know if this is possible or if I'm just searching wrong keywords. </p>\n\n<p>Basically I have user-form with multi-page arrangement and I wondered if it possible for one of multi-pages to display running tally of what on the worksheet. </p>\n\n<p>Example:on spreadsheet (Data) column B description of asset: Laptop, Desktop, Printer etc. and then User-form looks at sheet (Data) and then display to end user on user-form running tally of Laptops = 7 Desktop = 9 Printers = 2.</p>\n\n<p>Depending on how many words are in that column matching the word looking for. </p>\n\n<p>I don't know where to start to create code to do is and I can't seem to find any help on any websites when searching Google (VBA User-form to display column count).  </p>\n\n<p>Sorry If I'm not asking in correct way on here just at complete loss with what to do. </p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["vba", "shell", "winscp", "asynchronous"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 2, "creation_date": 1517996818, "post_id": 48660047, "comment_id": 84318501, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8902022/wait-for-shell-to-finish-then-format-cells-synchronously-execute-a-command\">Wait for Shell to finish, then format cells - synchronously execute a command</a>"}, {"owner": {"reputation": 123, "user_id": 9061059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01bcb1f7b3413bf61a61c38338f78354?s=128&d=identicon&r=PG&f=1", "display_name": "milanDD", "link": "https://stackoverflow.com/users/9061059/milandd"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1517998473, "post_id": 48660047, "comment_id": 84319603, "body": "The difference is that I am using winscp commands in my code"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1517998825, "post_id": 48660047, "comment_id": 84319821, "body": "then you should perhaps edit your question to explain in what way it makes a difference"}], "owner": {"reputation": 123, "user_id": 9061059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01bcb1f7b3413bf61a61c38338f78354?s=128&d=identicon&r=PG&f=1", "display_name": "milanDD", "link": "https://stackoverflow.com/users/9061059/milandd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517999389, "creation_date": 1517995358, "last_edit_date": 1517999389, "question_id": 48660047, "link": "https://stackoverflow.com/questions/48660047/synchronously-execute-a-shell-with-a-winscp-command-vba", "title": "Synchronously execute a shell with a winscp command - VBA", "body": "<p>I have currently this code:</p>\n\n<pre><code>Call Shell(\"(\"C:\\Folder\\WinSCP\\WinSCP.com /ini=nul /script=\"\"C:\\Folder\\WinSCP\\Remote2local.txt\"\" \", vbHide)\n\nApplication.Wait (Now + TimeValue(\"0:00:10\"))\n\nRest of the code ...\n</code></pre>\n\n<p>The problem with this code is that if the computer is slow, it will start the rest of the code before finishing the shell process, which will create an error. </p>\n\n<p>After some research I have come to the conclusion that the best idea is to use Wscript.shell instead, but I can't figure out how it should be used with a winscp command? </p>\n"}, {"tags": ["excel", "time", "charts", "series", "vba"], "comments": [{"owner": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "edited": false, "score": 0, "creation_date": 1517998394, "post_id": 48659818, "comment_id": 84319549, "body": "Whether you tried to format axis?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "edited": false, "score": 0, "creation_date": 1517998446, "post_id": 48659818, "comment_id": 84319582, "body": "What do you mean? The axis is already formatted as Time. I have a blank chart which I add the series to."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518015160, "post_id": 48666593, "comment_id": 84331047, "body": "I get a type mismatch with  Dim myVal As Double :  myVal = CDbl(&quot;00:07:00&quot;) . Though this sounds like the right thinking."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518015924, "post_id": 48666593, "comment_id": 84331580, "body": "@QHarr,  myVal = TimeValue(&quot;00:07:00&quot;)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518016312, "post_id": 48666593, "comment_id": 84331863, "body": "Doh! Back to where i started but had wrong datatype. Thanks so much for sorting."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1518016421, "post_id": 48666593, "comment_id": 84331945, "body": "@QHarr, Good luck."}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": true, "score": 1, "last_activity_date": 1518014746, "creation_date": 1518014746, "answer_id": 48666593, "question_id": 48659818, "link": "https://stackoverflow.com/questions/48659818/how-to-correctly-add-a-series-of-time-values-to-an-excel-chart/48666593#48666593", "title": "How to correctly add a series of time values to an Excel chart", "body": "<p>Change  myVal  variable type  to Double.</p>\n\n<pre><code>Dim myVal As Double\n</code></pre>\n"}], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 48666593, "answer_count": 1, "score": 1, "last_activity_date": 1518014746, "creation_date": 1517994686, "last_edit_date": 1531161705, "question_id": 48659818, "link": "https://stackoverflow.com/questions/48659818/how-to-correctly-add-a-series-of-time-values-to-an-excel-chart", "title": "How to correctly add a series of time values to an Excel chart", "body": "<p>I am trying to add a series composed of <code>Time</code> values to a chart. The y-axis is formatted as <code>Time</code>. I am using the variable <code>myVal</code> to hold the value I want to repeat, inside an array, as the series plot values.</p>\n\n<p>I know that <code>Time</code> is stored in the <code>Date</code> datatype. I am unsure how to how do the correct conversion to add a series to the chart via VBA. </p>\n\n<p>My attempts to assign the series values and plot via code keep resulting in a line being plotted around 0 on the y-axis indicating I have the wrong scale. See red line on chart image. </p>\n\n<p>Chart:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ox8LA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ox8LA.png\" alt=\"Chart series\"></a></p>\n\n<p>Trying to do conversions on <code>myVal</code> with <code>DateValue(\"00:07:00\")</code> and <code>TimeValue(\"00:07:00\")</code> ,and then scaling, are of no use as they return 0.</p>\n\n<p>I have also seen that there is <code>FormatDateTime</code> function, with argument  <code>vbLongTime</code>, but I can't see how to apply this in my situation.</p>\n\n<p>I know I can directly add the series from the sheet with :</p>\n\n<pre><code>.FullSeriesCollection(2).Values = _\n        \"=ChartDataResponseTimes!$BC$548:$BC$552\"\n</code></pre>\n\n<p>Where <code>$BC$548:$BC$552</code> is the range, as shown in the image above, containing <code>\"00:07:00\"</code> repeated. This is not the method I want to use as I want to assign the series values via an array within the code.</p>\n\n<p>This, I am certain, is so simple to do, but I am failing miserably today. </p>\n\n<p>Can anyone please solve this?</p>\n\n<p>Code:</p>\n\n<pre><code>Sub AddingSeries()\n\n    With ActiveSheet.ChartObjects(\"hidRTMeanCat1\").Chart\n\n        .SeriesCollection.NewSeries\n\n        .FullSeriesCollection(1).Values = _\n                                        \"=ChartDataResponseTimes!$B$548:$B$552\"\n\n        .FullSeriesCollection(1).XValues = _\n                                         \"=ChartDataResponseTimes!$A$548:$A$552\"\n\n        .SeriesCollection.NewSeries\n\n        Dim myVal As Date '**************************************Problem code***************\n\n        myVal = DateValue(\"00:07:00\")\n\n        .FullSeriesCollection(2).Values = Array(myVal, myVal)\n\n                          '**************************************Problem code***************\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Note: </p>\n\n<p><code>ChartDataResponseTimes!$A$548:$A$552\"</code> is the first column of data in the sample below.</p>\n\n<p><code>ChartDataResponseTimes!$B$548:$B$552</code> is the second column of data in the sample below.</p>\n\n<p>Data sample: </p>\n\n<pre><code>| Date   | North West |\n|--------|------------|\n| Aug-17 | 00:10:07   |\n| Sep-17 | 00:09:50   |\n| Oct-17 | 00:09:29   |\n| Nov-17 | 00:09:44   |\n| Dec-17 | 00:11:17   |\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1029, "user_id": 7404435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60b54ccc64c3d6dcb6a7f2781d74ba16?s=128&d=identicon&r=PG&f=1", "display_name": "Exception_al", "link": "https://stackoverflow.com/users/7404435/exception-al"}, "edited": false, "score": 2, "creation_date": 1517995154, "post_id": 48659778, "comment_id": 84317332, "body": "What is the result you are getting ? What is the expected result ? Do you get any error ??"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9326481, "user_type": "registered", "profile_image": "https://graph.facebook.com/1761274350584535/picture?type=large", "display_name": "Ph\u1ea1m T&#226;m", "link": "https://stackoverflow.com/users/9326481/ph%e1%ba%a1m-t%c3%a2m"}, "edited": false, "score": 0, "creation_date": 1517995240, "post_id": 48659830, "comment_id": 84317383, "body": "The thing is [Range(&quot;J4&quot;).Value = t.Offset(0, 1).Value ] is not accepted. This is where I am struggling.  The outcome is nothing."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 9326481, "user_type": "registered", "profile_image": "https://graph.facebook.com/1761274350584535/picture?type=large", "display_name": "Ph\u1ea1m T&#226;m", "link": "https://stackoverflow.com/users/9326481/ph%e1%ba%a1m-t%c3%a2m"}, "edited": false, "score": 0, "creation_date": 1517995349, "post_id": 48659830, "comment_id": 84317454, "body": "@Ph\u1ea1mT&#226;m - &quot;<code>t</code> can be <code>Nothing</code> if it is not found through the <code>.Find</code>.&quot;"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1517994723, "creation_date": 1517994723, "answer_id": 48659830, "question_id": 48659778, "link": "https://stackoverflow.com/questions/48659778/working-with-range-and-set-value-for-found-cell/48659830#48659830", "title": "Working with range and set value for found cell", "body": "<p><code>j</code> cannot be Nothing, because in your code you are assigning it to something here:</p>\n\n<pre><code>Set j = Range(\"j1\")\n</code></pre>\n\n<p>On the contrary, <code>t</code> can be <code>Nothing</code> if it is not found through the <code>.Find</code></p>\n\n<p>Thus:</p>\n\n<pre><code>Option Explicit\nSub findsub()\n\n    Dim t As Range\n    Dim j As Range\n\n    Set j = Range(\"j1\")\n    Set t = Range(\"G2:G19\").Find(\"j1\", LookIn:=xlValues)\n\n    If Not t Is Nothing Then\n        Range(\"J4\").Value = t.Offset(0, 1).Value\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Long story short, search in the internet for \"NULL, EMPTY, NOTHING, MISSING vba\" and read some articles for it. Like this one:\n<a href=\"http://allenbrowne.com/vba-NothingEmpty.html\" rel=\"nofollow noreferrer\">http://allenbrowne.com/vba-NothingEmpty.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1517996639, "creation_date": 1517996639, "answer_id": 48660499, "question_id": 48659778, "link": "https://stackoverflow.com/questions/48659778/working-with-range-and-set-value-for-found-cell/48660499#48660499", "title": "Working with range and set value for found cell", "body": "<p>may be you're after something like this (explanations in comments)</p>\n\n<pre><code>Option Explicit\n\nSub findsub()\n    Dim t As Range, j As Range\n\n    Set j = Range(\"J1\")\n\n    If IsEmpty(j) Then ' if cell J1 is empty\n        Debug.Print \"please enter the number in cell J1\"\n    Else\n        Set t = Range(\"G2:G19\").Find(j.Value, LookIn:=xlValues, LookAt:=xlWhole) ' always explicitly define  both LookIn and LookAt parameters otherwise those from last Find call (even from UI) will be used \n        If Not t Is Nothing Then Range(\"J4\").Value = t.Offset(0, 1).Value ' write in J4 if successfully found J1 value in range G2:G19\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9326481, "user_type": "registered", "profile_image": "https://graph.facebook.com/1761274350584535/picture?type=large", "display_name": "Ph\u1ea1m T&#226;m", "link": "https://stackoverflow.com/users/9326481/ph%e1%ba%a1m-t%c3%a2m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1517996921, "creation_date": 1517994540, "last_edit_date": 1531164843, "question_id": 48659778, "link": "https://stackoverflow.com/questions/48659778/working-with-range-and-set-value-for-found-cell", "title": "Working with range and set value for found cell", "body": "<p>Here is my procedure and I am newbie at VBA, I always find the struggle to work with such type of misstake.</p>\n\n<p>Please help me.</p>\n\n<pre><code>Sub findsub()\nDim t As Range\nDim j As Range\nSet j = Range(\"j1\")\n\nIf j Is Nothing Then\nDebug.Print \"please enter the number\"\nElse\nSet t = Range(\"G2:G19\").Find(\"j1\", LookIn:=xlValues)\nRange(\"J4\").Value = t.Offset(0, 1).Value '&lt;-- ERROR HERE\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-office", "ms-project"], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 5070490, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-JgqPYDH8XKs/AAAAAAAAAAI/AAAAAAAABbU/2fdAoI6FyLo/photo.jpg?sz=128", "display_name": "Doons", "link": "https://stackoverflow.com/users/5070490/doons"}, "is_accepted": true, "score": 0, "last_activity_date": 1518694687, "creation_date": 1518694687, "answer_id": 48806336, "question_id": 48659623, "link": "https://stackoverflow.com/questions/48659623/ms-project-equivalent-to-xland-enumeration-for-logical-operators/48806336#48806336", "title": "MS Project equivalent to &quot;xlAnd&quot;. Enumeration for logical operators", "body": "<p><code>Operation:=\"\"</code> works for FilterEdit, but not for SetAutoFilter.\nSo I ended up using the dreaded <code>If LocaleID</code>.</p>\n\n<p><strong>Teaching moment:</strong></p>\n\n<p>I found out most operators can be language independent, except for:\n<br><code>And</code>, <code>Or</code>, <code>Contains</code> and <code>Does Not Contain</code>.<br>\nThese needs to be translated for each locale.<br><br> I'll get to those in a minute. First I'll list all the language independent operators:<br>\n<code>&lt;</code>  Less than<br> <code>&lt;=</code> Less than or equal to <br> <code>&gt;</code> Greater than <br> <code>&gt;=</code> Greater than or equal to <br> <code>=</code> Equal to <br> <code>&lt;&gt;</code> Not equal to<br><br>\nMy trick for finding the translations I need for the language dependent operators  is the following <a href=\"https://support.office.com/en-us/article/filter-a-list-of-data-8ec38534-e2f1-41d0-b8bb-e3f5fcad95a0\" rel=\"nofollow noreferrer\">MS Office Support</a> page.</p>\n\n<p>Notice the category named <strong>\"Filter for specific text\"</strong> in the English support page. Here we can read all the \"words\" we need. Now go to the bottom of the web page and change the language: <a href=\"https://i.stack.imgur.com/nuO7I.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nuO7I.png\" alt=\"Button to switch Locale\"></a> \n<br>This opens up a new page listing all the different languages (not locale specific). Remembering where you found the word for <code>Contains</code> in English, then changing the language to for instance \"Magyar (Magyarorz\u00e1g)\", we can now see that <code>Contains = \"Tartalmazza\"</code> in Magyar.</p>\n\n<p>Next step is to google \"Magyar languge\" and learn that this actually equals Hungarian. So now you can go to this <a href=\"https://msdn.microsoft.com/en-us/library/ms912047(v=winembedded.10).aspx\" rel=\"nofollow noreferrer\">MSDN web page</a> to see that Hungarian = LocaleID: 1038.\n<br>\n<br>\nPutting all this together inside VBA makes you have to write the following code:\n<br></p>\n\n<pre><code>Dim LocalContains As String\n\nIf LocaleID = 1038 Then\n    LocalContains = \"Tartalmazza\" 'Hungarian\nElseIf LocaleID = 1044 Then\n    LocalContains = \"inneholder\"  'Norwegian\nElse\n    LocalContains = \"contains\"    'English\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 5070490, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-JgqPYDH8XKs/AAAAAAAAAAI/AAAAAAAABbU/2fdAoI6FyLo/photo.jpg?sz=128", "display_name": "Doons", "link": "https://stackoverflow.com/users/5070490/doons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 48806336, "answer_count": 1, "score": 1, "last_activity_date": 1518694687, "creation_date": 1517993995, "last_edit_date": 1517997986, "question_id": 48659623, "link": "https://stackoverflow.com/questions/48659623/ms-project-equivalent-to-xland-enumeration-for-logical-operators", "title": "MS Project equivalent to &quot;xlAnd&quot;. Enumeration for logical operators", "body": "<p>I'm trying to write a language independent filter for MS Project in VBA. I'm using the syntax:</p>\n\n<pre><code>FilterEdit (Name, Taskfilter, Create, Fieldname, Test, Value, Operation...)\n</code></pre>\n\n<p>I have managed to get the Fieldnames and Tests to be language independent, but I struggle with the <code>Operation:=</code> expression. For an English locale one would write: <code>Operation:=\"and\"</code> but that doesnt work for other locales.</p>\n\n<p>Is there a way to write the logical operator (and/or) as an enumeration? (not as a string?)</p>\n\n<p>For Excel one could write <code>xlAnd</code>, and Project has a lot of enumerations starting with Pj, ie. <code>PjTaskStart</code>. I also know there's a <code>Filter.LogicalOperationType</code>, but I haven't managed to figure out if this could work for me or not. I have also experimented with <code>FieldConstantToFieldName</code>, but I reckon there's no fieldname for the logical operator?</p>\n\n<p>I know I could use <code>If LocaleID = xxxx Then...</code>, but I'd like to not assume what locales will be in use.</p>\n\n<p><strong>Edit:</strong> I solved the first part of my problem!\nBy leaving it blank <code>Operation:=\"\"</code>, Project returns \"And\". But I haven't figured out yet how to return \"Or\"...</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 843, "user_id": 1936588, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a788eff656461afb21f08e3c3a815c?s=128&d=identicon&r=PG", "display_name": "bd528", "link": "https://stackoverflow.com/users/1936588/bd528"}, "edited": false, "score": 0, "creation_date": 1517996610, "post_id": 48659647, "comment_id": 84318343, "body": "I setup a string variable NextStateStr, and a Long variable LastStateNum. I can see in the immediate window 00005 (the correct value), but when I use NextStateStr, it is actually 5??"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 843, "user_id": 1936588, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a788eff656461afb21f08e3c3a815c?s=128&d=identicon&r=PG", "display_name": "bd528", "link": "https://stackoverflow.com/users/1936588/bd528"}, "edited": false, "score": 0, "creation_date": 1517996667, "post_id": 48659647, "comment_id": 84318378, "body": "@user1936588 - &quot;If it has a leading zero, it will not be a number, but a String. &quot; This means that you should declare the value as <code>String</code>, not as <code>Long</code>."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 843, "user_id": 1936588, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a788eff656461afb21f08e3c3a815c?s=128&d=identicon&r=PG", "display_name": "bd528", "link": "https://stackoverflow.com/users/1936588/bd528"}, "edited": false, "score": 0, "creation_date": 1517996808, "post_id": 48659647, "comment_id": 84318494, "body": "@user1936588 - What <code>LastStateNum</code> is and how did it become 4?"}, {"owner": {"reputation": 843, "user_id": 1936588, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a788eff656461afb21f08e3c3a815c?s=128&d=identicon&r=PG", "display_name": "bd528", "link": "https://stackoverflow.com/users/1936588/bd528"}, "edited": false, "score": 0, "creation_date": 1517996995, "post_id": 48659647, "comment_id": 84318639, "body": "Sorry, my mistake. The last statement number will be saved as a number in all cases. In my example, the value is 4, so my next value (which needs to be a string) is 00005. I will then save the value 5 to the database."}, {"owner": {"reputation": 843, "user_id": 1936588, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a788eff656461afb21f08e3c3a815c?s=128&d=identicon&r=PG", "display_name": "bd528", "link": "https://stackoverflow.com/users/1936588/bd528"}, "edited": false, "score": 1, "creation_date": 1517997254, "post_id": 48659647, "comment_id": 84318785, "body": "It does. Sorry - I set NextStateStr as Long also in erro. Thank you for your help!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1517996761, "last_edit_date": 1517996761, "creation_date": 1517994083, "answer_id": 48659647, "question_id": 48659587, "link": "https://stackoverflow.com/questions/48659587/incrementing-5-digit-number-including-leading-zeros/48659647#48659647", "title": "Incrementing 5 digit number, including leading zeros", "body": "<p>If it has a leading zero, it will not be a number, but a String. However, as far as it is not quite a bit difference, something like this works:</p>\n\n<pre><code>Sub TestMe()\n    Dim cnt         As Long\n    Dim myString    As String\n    For cnt = 98 To 120\n        myString = Format(cnt, \"00000\")\n        Debug.Print myString\n    Next cnt\nEnd Sub\n</code></pre>\n\n<p>This is what you get in the immediate window:</p>\n\n<pre><code>00098\n00099\n00100\n00101\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 843, "user_id": 1936588, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a788eff656461afb21f08e3c3a815c?s=128&d=identicon&r=PG", "display_name": "bd528", "link": "https://stackoverflow.com/users/1936588/bd528"}, "edited": false, "score": 0, "creation_date": 1517996651, "post_id": 48659767, "comment_id": 84318368, "body": "Same comment to you as Vityata"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1517994490, "creation_date": 1517994490, "answer_id": 48659767, "question_id": 48659587, "link": "https://stackoverflow.com/questions/48659587/incrementing-5-digit-number-including-leading-zeros/48659767#48659767", "title": "Incrementing 5 digit number, including leading zeros", "body": "<p>Yes, just first convert to a number:</p>\n\n<pre><code>NextValue = Format(Val(CurrentValue) + 1, \"00000\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1518007735, "creation_date": 1518007735, "answer_id": 48664263, "question_id": 48659587, "link": "https://stackoverflow.com/questions/48659587/incrementing-5-digit-number-including-leading-zeros/48664263#48664263", "title": "Incrementing 5 digit number, including leading zeros", "body": "<p>You could also use:</p>\n\n<pre><code>NextStateStr = Right(\"00000\" &amp; LastStateNum + 1, 5)\n</code></pre>\n"}], "owner": {"reputation": 843, "user_id": 1936588, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a788eff656461afb21f08e3c3a815c?s=128&d=identicon&r=PG", "display_name": "bd528", "link": "https://stackoverflow.com/users/1936588/bd528"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1281, "favorite_count": 0, "accepted_answer_id": 48659647, "answer_count": 3, "score": 0, "last_activity_date": 1593955920, "creation_date": 1517993900, "last_edit_date": 1593955920, "question_id": 48659587, "link": "https://stackoverflow.com/questions/48659587/incrementing-5-digit-number-including-leading-zeros", "title": "Incrementing 5 digit number, including leading zeros", "body": "<p>I need to generate statement numbers in Access 2016. These numbers need to be 5 digits long, and where the statement number is less than 5 digits, I need to pad the number with leading zeros.</p>\n\n<p>As a starting point, the first statement number will not be padded. So if the last statement number is 96, the next statement number needs to be 00097.</p>\n\n<p>Is it possible (I assume in VBA) to cater for both cases, where the number is 5 digits long, or where it is less.</p>\n\n<p>I was thinking of firstly stripping the leading zeros from the last statement number (if any existed), incrementing the remaining number by one, and then adding leading zeros to make the length of the number 5, but I'm not sure of the most efficient way of doing this.</p>\n"}, {"tags": ["vba", "excel", "solver"], "comments": [{"owner": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "edited": false, "score": 0, "creation_date": 1517990367, "post_id": 48658286, "comment_id": 84314760, "body": "At which line, it shows error?"}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 1, "creation_date": 1517990470, "post_id": 48658286, "comment_id": 84314804, "body": "It looks like you&#39;re missing a reference , try adding a solver add-in reference from Tools - &gt; References..."}, {"owner": {"reputation": 37, "user_id": 7186313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d77c8fe61169fc843de58fb51bd278f?s=128&d=identicon&r=PG&f=1", "display_name": "Red Eye", "link": "https://stackoverflow.com/users/7186313/red-eye"}, "edited": false, "score": 0, "creation_date": 1517991937, "post_id": 48658286, "comment_id": 84315560, "body": "Thanks Imran...I missed that part...it solves the issue"}], "answers": [{"tags": [], "owner": {"reputation": 5527, "user_id": 4082955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e670bd7627dcaaceead20dfdc02a7589?s=128&d=identicon&r=PG&f=1", "display_name": "Fratyx", "link": "https://stackoverflow.com/users/4082955/fratyx"}, "is_accepted": true, "score": 0, "last_activity_date": 1517990580, "creation_date": 1517990580, "answer_id": 48658685, "question_id": 48658286, "link": "https://stackoverflow.com/questions/48658286/vba-solver-compilation-error/48658685#48658685", "title": "VBA solver compilation error", "body": "<p>You have to activate the solver add-in. </p>\n\n<p>Look here:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/using-the-solver-vba-functions\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/using-the-solver-vba-functions</a></p>\n"}], "owner": {"reputation": 37, "user_id": 7186313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d77c8fe61169fc843de58fb51bd278f?s=128&d=identicon&r=PG&f=1", "display_name": "Red Eye", "link": "https://stackoverflow.com/users/7186313/red-eye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 0, "accepted_answer_id": 48658685, "answer_count": 1, "score": 0, "last_activity_date": 1518001180, "creation_date": 1517988954, "last_edit_date": 1518001180, "question_id": 48658286, "link": "https://stackoverflow.com/questions/48658286/vba-solver-compilation-error", "title": "VBA solver compilation error", "body": "<p>I get a compilation error (sub for function not defined) while executing this VBA solver code:</p>\n\n<pre><code>Sub Macro1()\nSolverReset\nSolverOk SetCell:=\"$H$6\", _\nMaxMinVal:=2, _\nValueOf:=\"0\", _\nByChange:=\"$H$15:$H$20\"\nSolverAdd CellRef:=\"$H$15:$H$20\", Relation:=4, FormulaText:=\"integer\"\nSolverAdd CellRef:=\"$H$15:$H$20\", Relation:=3, FormulaText:=\"0\"\nSolverAdd CellRef:=\"$H$9\", Relation:=3, FormulaText:=\"$I$9\"\nSolverAdd CellRef:=\"$H$10\", Relation:=3, FormulaText:=\"$I$10\"\nSolverAdd CellRef:=\"$H$24\", Relation:=2, FormulaText:=\"$I$24\"\nSolverAdd CellRef:=\"$H$25\", Relation:=2, FormulaText:=\"$I$25\"\nSolverSolve userFinish:=True\nEnd Sub\n</code></pre>\n\n<p>Am I missing anything here in the code?</p>\n"}, {"tags": ["excel", "vba", "webforms", "element", "fill"], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 1, "last_activity_date": 1517989555, "creation_date": 1517989555, "answer_id": 48658423, "question_id": 48658181, "link": "https://stackoverflow.com/questions/48658181/vba-code-to-fill-a-webform/48658423#48658423", "title": "VBA code to fill a webform", "body": "<p>Your element ID is actually the  </p>\n\n<pre><code>p_lt_ctl03_pageplaceholder_p_lt_ctl00_On_lineForm_viewBiz_Agent_Name_txtText\n</code></pre>\n\n<p>Also, I noticed that in your example you provided you used: <code>IE.document.getelementsbyID</code>. When dealing with the ID of an element, the proper syntax would be <code>getElementByID()</code> (no <strong>s</strong>), so therefore it would actually be:</p>\n\n<pre><code>IE.Document.getElementByID( _\n \"p_lt_ctl03_pageplaceholder_p_lt_ctl00_On_lineForm_viewBiz_Agent_Name_txtText\")\n</code></pre>\n\n<blockquote>\n  <p><code>getElements</code> (with an <strong>s</strong>) is used for element <em>collections</em>. IDs are unique, but <code>ClassName</code>, <code>Name</code>, <code>Tag</code> are collections, which is where the \"<strong>s</strong>\" comes in</p>\n</blockquote>\n"}], "owner": {"reputation": 11, "user_id": 9326048, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9EZZPdO3WoA/AAAAAAAAAAI/AAAAAAAAAD8/539XVsMqucI/photo.jpg?sz=128", "display_name": "Trainferry", "link": "https://stackoverflow.com/users/9326048/trainferry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 939, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1518007744, "creation_date": 1517988549, "last_edit_date": 1517989042, "question_id": 48658181, "link": "https://stackoverflow.com/questions/48658181/vba-code-to-fill-a-webform", "title": "VBA code to fill a webform", "body": "<p>I would like to create a code in VBA to complete some fields in a webform. Due to privacy-matters I can't copy the whole code of the form. However I can sent the part, where I'm stuck. To complete the webform it appears I should note something like this in VBA:</p>\n\n<pre><code>IE.document.getelementsbyID(\"ABCDEF\").Value =\"XYZ\"\n</code></pre>\n\n<p>in the source code it seems the element id would be <code>Agent_name</code>. However when submitting excel, the webform does not take over the value.</p>\n\n<p>This is the source code:</p>\n\n<p>Agent name:</p>\n\n<pre><code>input name=\"p$lt$ctl03$pageplaceholder$p$lt$ctl00$On_lineForm$viewBiz$Agent_Name$txtText\" \nclass=\"form-control\" \nid=\"p_lt_ctl03_pageplaceholder_p_lt_ctl00_On_lineForm_viewBiz_Agent_Name_txtText\" \ntype=\"text\" \nmaxlength=\"500\"\n</code></pre>\n\n<p>I hope someone can help me with this.</p>\n\n<p>Many thanks in advance! </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 2, "creation_date": 1517988146, "post_id": 48657946, "comment_id": 84313703, "body": "Short answer: no."}], "answers": [{"tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": false, "score": 2, "last_activity_date": 1517992185, "creation_date": 1517992185, "answer_id": 48659102, "question_id": 48657946, "link": "https://stackoverflow.com/questions/48657946/export-data-as-csv-with-formatting-and-comments/48659102#48659102", "title": "Export Data (as CSV) with formatting and Comments", "body": "<p>According to <a href=\"https://en.wikipedia.org/wiki/Comma-separated_values\" rel=\"nofollow noreferrer\">Wikipedia</a>:</p>\n\n<blockquote>\n  <p>In computing, a comma-separated values (CSV) file stores tabular data (numbers and text) in <strong>plain text</strong>.</p>\n</blockquote>\n\n<p>Thus no colors and no comments.</p>\n\n<p>If you want to store them in CSV, you can write code to collect these information from cells and store them as text somewhere in the worksheet (e.g. copy color as hex code).</p>\n"}], "owner": {"reputation": 161, "user_id": 7955781, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c04d43b2ea06ddeb392897f5834a7869?s=128&d=identicon&r=PG&f=1", "display_name": "C. Henke", "link": "https://stackoverflow.com/users/7955781/c-henke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517992185, "creation_date": 1517987517, "last_edit_date": 1531164843, "question_id": 48657946, "link": "https://stackoverflow.com/questions/48657946/export-data-as-csv-with-formatting-and-comments", "title": "Export Data (as CSV) with formatting and Comments", "body": "<p>Is there a way to Export my Data in Excel with VBA whilst also exporting Cellcomments and ColorFormatting?</p>\n\n<p>I don't quite find a solution to export it that way. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 8, "creation_date": 1517983354, "post_id": 48656818, "comment_id": 84311554, "body": "Your lookup range is C6:D12 - do you see a problem there?  That&#39;s not where your table is."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1517996377, "creation_date": 1517996377, "answer_id": 48660390, "question_id": 48656818, "link": "https://stackoverflow.com/questions/48656818/why-there-is-an-error-when-it-case-using-vlookup-for-int-type/48660390#48660390", "title": "Why there is an error when it case using vlookup for int type", "body": "<p>As @Tim Williams has mentioned in the comment, the problem is that your range is <code>C6:D12</code> and your data is on <code>C4:D10</code>.</p>\n\n<p>In VBA, instad of writing:</p>\n\n<pre><code>Range(Range(\"C\" &amp; 6), Range(\"D\" &amp; 12))\n</code></pre>\n\n<p>you may simply write <code>Range(\"C6:D12\")</code>, it is 100% the same and is really understandable.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/aa221536(v=office.11).aspx\" rel=\"nofollow noreferrer\">MSDN - refer to Cells and Ranges</a></p>\n"}], "owner": {"reputation": 89, "user_id": 8525203, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-BqX-MxnTHAI/AAAAAAAAAAI/AAAAAAAAGeE/YbbeL-Ciwtw/photo.jpg?sz=128", "display_name": "Heart Aim DJ", "link": "https://stackoverflow.com/users/8525203/heart-aim-dj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1518057388, "creation_date": 1517982543, "question_id": 48656818, "link": "https://stackoverflow.com/questions/48656818/why-there-is-an-error-when-it-case-using-vlookup-for-int-type", "title": "Why there is an error when it case using vlookup for int type", "body": "<p>I need to use vlookup module in VBA of EXCEL\nSo I Use the \"Application.vlookup\"</p>\n\n<p>But There is an error when it case using vlookup for <strong>int type</strong></p>\n\n<p>If Use 'vlookup' as a basic function in EXCEL,\nThere is no error.</p>\n\n<p>But It happend when I use \"Application.vlookup\" in VBA of EXCEL</p>\n\n<p>Please note capture.</p>\n\n<p><a href=\"https://i.stack.imgur.com/6kZGN.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6kZGN.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I really want to know how it can be solved</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1517982582, "post_id": 48656790, "comment_id": 84311273, "body": "Please detail the error"}, {"owner": {"reputation": 65, "user_id": 8359287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/184fbaa107f6206b682bf89079bdc46f?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Ong", "link": "https://stackoverflow.com/users/8359287/sebastian-ong"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1517982743, "post_id": 48656790, "comment_id": 84311313, "body": "It states Subscript out of range and highlights &quot;For Each sheet In Workbooks(fileName).Worksheets&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1517983338, "post_id": 48656790, "comment_id": 84311543, "body": "It doesn&#39;t like the path part of the now open workbook. It expects just the filename."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1517984840, "last_edit_date": 1517984840, "creation_date": 1517983423, "answer_id": 48656992, "question_id": 48656790, "link": "https://stackoverflow.com/questions/48656790/how-do-i-make-a-macro-that-enables-me-to-import-data-from-one-workbook-to-anothe/48656992#48656992", "title": "How do I make a macro that enables me to import data from one workbook to another ?B", "body": "<p>Remove the file path part. Variety of methods available. I used the one from <a href=\"https://stackoverflow.com/questions/1743328/how-to-extract-file-name-from-path\">here</a>. </p>\n\n<blockquote>\n  <p>The <a href=\"https://msdn.microsoft.com/en-us/library/ff841074(v=office.14).aspx\" rel=\"nofollow noreferrer\">Workbooks</a> object is the collection of all the Workbook\n  objects that are currently open in the Microsoft Excel application.</p>\n</blockquote>\n\n<p>It does not need the file path just the name. You could also have said <code>ActiveWorkbook</code>, though this would have been perhaps less robust.</p>\n\n<p>Edit: Or as in @TimWilliam's answer, you can store the now open workbook in a variable and use that as the reference.</p>\n\n<pre><code>Option Explicit\n\nSub BrowseForFile()\n\n    Dim directory As String, fileName As String, sheet As Worksheet, total As Integer\n\n    fileName = Application.GetOpenFilename(, , \"Browse for Workbook\")\n\n    Workbooks.Open (fileName)\n\n    Dim fso As New FileSystemObject 'Requires references to MS Scripting Runtime\n\n    fileName = fso.GetFileName(fileName)\n\n    For Each sheet In Workbooks(fileName).Worksheets '\n        Workbooks(fileName).Worksheets(sheet.Name).Copy _\n        after:=Workbooks(\"FIEP.xlsm\").Worksheets(total)\n    Next sheet\n\n    Workbooks(fileName).Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1517983666, "creation_date": 1517983666, "answer_id": 48657048, "question_id": 48656790, "link": "https://stackoverflow.com/questions/48656790/how-do-i-make-a-macro-that-enables-me-to-import-data-from-one-workbook-to-anothe/48657048#48657048", "title": "How do I make a macro that enables me to import data from one workbook to another ?B", "body": "<p>Use a variable for the workbook object:</p>\n\n<pre><code>Sub BrowseForFile()\n\n Dim directory As String, fileName As String, sheet As Worksheet, total As Long\n Dim wb As Workbook\n\n fileName = Application.GetOpenFilename(, , \"Browse for Workbook\")\n\n\n Set wb = Workbooks.Open(fileName)\n\n For Each sheet In wb.Worksheets\n    total = Workbooks(\"FIEP.xlsm\").Worksheets.count\n    sheet.Copy after:=Workbooks(\"FIEP.xlsm\").Worksheets(total)\n Next sheet\n\n wb.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 8359287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/184fbaa107f6206b682bf89079bdc46f?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Ong", "link": "https://stackoverflow.com/users/8359287/sebastian-ong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 48657048, "answer_count": 2, "score": 0, "last_activity_date": 1517994105, "creation_date": 1517982450, "last_edit_date": 1517994105, "question_id": 48656790, "link": "https://stackoverflow.com/questions/48656790/how-do-i-make-a-macro-that-enables-me-to-import-data-from-one-workbook-to-anothe", "title": "How do I make a macro that enables me to import data from one workbook to another ?B", "body": "<p>Basically I would like to import data by clicking on a button assigned with the macro which would open the file browser, prompting the user to open the excel file they would like to import. I have tried to debug my codes but my For Each loop keeps getting an error, any help is appreciated!</p>\n\n<pre><code>Sub BrowseForFile()  \n    Dim directory As String, fileName As String, sheet As Worksheet, total As Integer\n\n    fileName = Application.GetOpenFilename(, , \"Browse for Workbook\")\n    Workbooks.Open (fileName)\n\n    For Each sheet In Workbooks(fileName).Worksheets\n        total = Workbooks(\"FIEP.xlsm\").Worksheets.count\n        Workbooks(fileName).Worksheets(sheet.Name).Copy _\n          after:=Workbooks(\"FIEP.xlsm\").Worksheets(total)\n    Next sheet\n\n    Workbooks(fileName).Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "offset"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1517982358, "post_id": 48656712, "comment_id": 84311198, "body": "A1 to B7 is an OFFSET of 6 rows and 1 column. I am not sure about the mention of nested If etc but simply add the offset to the copy destination."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1517982473, "post_id": 48656712, "comment_id": 84311238, "body": "So, for example, Sheets(myarr(i) &amp; &quot;&quot;).Range(&quot;A1&quot;).Offset(6,1)"}, {"owner": {"reputation": 97, "user_id": 3788581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7b501a0f5d2d128efcdaeadbbbe9500?s=128&d=identicon&r=PG&f=1", "display_name": "user3788581", "link": "https://stackoverflow.com/users/3788581/user3788581"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1517983654, "post_id": 48656712, "comment_id": 84311666, "body": "I have edited that line and now the output tabs are empty"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1517983701, "post_id": 48656712, "comment_id": 84311690, "body": "That line would simply have moved the paste not made any difference to whether something was pasted."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1517983714, "post_id": 48656712, "comment_id": 84311696, "body": "Please please learn about indenting!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1517983768, "post_id": 48656712, "comment_id": 84311716, "body": "Are you overwriting due to the loop? Though this would have occurred before my suggestion."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1517984128, "post_id": 48656712, "comment_id": 84311858, "body": "By spacing out code I can now see an unclosed On Error Resume Next. Close it (with On Error GoTo 0) or better still, comment it out first and check no hidden errors when running the code."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1517984557, "post_id": 48656712, "comment_id": 84312042, "body": "Match doesn&#39;t return zero if there&#39;s no match.  if you use <code>Application.Match()</code> then you can check the return value using <code>IsError()</code> and get rid of that <code>On Error Resume Next</code>"}], "owner": {"reputation": 97, "user_id": 3788581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7b501a0f5d2d128efcdaeadbbbe9500?s=128&d=identicon&r=PG&f=1", "display_name": "user3788581", "link": "https://stackoverflow.com/users/3788581/user3788581"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517984088, "creation_date": 1517982039, "last_edit_date": 1517984088, "question_id": 48656712, "link": "https://stackoverflow.com/questions/48656712/adding-offset-to-vba-code", "title": "Adding Offset to VBA Code", "body": "<p>Adding Offset to VBA Code.</p>\n\n<p>Currently, I have a block of VBA code that does a good job of seperating different rows in to different tabs.</p>\n\n<pre><code>Sub Country_Seperator()\n\nDim lr As Long\nDim ws As Worksheet\nDim vcol, i As Integer\nDim icol As Long\nDim myarr As Variant\nDim title As String\nDim titlerow As Integer\n\nvcol = 1\nSet ws = Sheets(\"FILTERED\")\nlr = ws.Cells(ws.Rows.Count, vcol).End(xlUp).Row\ntitle = \"A1:E1\"\ntitlerow = ws.Range(title).Cells(1).Row\nicol = ws.Columns.Count\nws.Cells(1, icol) = \"Unique\"\n\nFor i = 2 To lr\n\n    On Error Resume Next\n\n    If ws.Cells(i, vcol) &lt;&gt; \"\" And Application.WorksheetFunction.Match(ws.Cells(i, vcol), ws.Columns(icol), 0) = 0 Then\n        ws.Cells(ws.Rows.Count, icol).End(xlUp).Offset(1) = ws.Cells(i, vcol)\n    End If\n\nNext\n\nmyarr = Application.WorksheetFunction.Transpose(ws.Columns(icol).SpecialCells(xlCellTypeConstants))\nws.Columns(icol).Clear\n\nFor i = 2 To UBound(myarr)\n\n    ws.Range(title).AutoFilter field:=vcol, Criteria1:=myarr(i) &amp; \"\"\n\n    If Not Evaluate(\"=ISREF('\" &amp; myarr(i) &amp; \"'!B7)\") Then\n        Sheets.Add(after:=Worksheets(Worksheets.Count)).Name = myarr(i) &amp; \"\"\n    Else\n        Sheets(myarr(i) &amp; \"\").Move after:=Worksheets(Worksheets.Count)\n    End If\n\n    ws.Range(\"A\" &amp; titlerow &amp; \":A\" &amp; lr).EntireRow.Copy Sheets(myarr(i) &amp; \"\").Range(\"B7\")\n    Sheets(myarr(i) &amp; \"\").Columns.AutoFit\n\nNext\n\nws.AutoFilterMode = False\nws.Activate\n\nEnd Sub\n</code></pre>\n\n<p>My main issue is that this code outputs data on A1 and I would like it for it to be offset (eg. output on to B7 over A1)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "edited": false, "score": 0, "creation_date": 1517979037, "post_id": 48656041, "comment_id": 84310179, "body": "You can use <code>Rows(ActiveCell.Row).Select</code> to select active row"}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1517982051, "creation_date": 1517982051, "answer_id": 48656715, "question_id": 48656041, "link": "https://stackoverflow.com/questions/48656041/copy-selected-row-cell-entries-to-other-sheet/48656715#48656715", "title": "copy selected row cell entries to other sheet", "body": "<p>You can use a combination of <code>UsedRange</code> and the <code>Rows()</code> property to get your active row.</p>\n\n<p>While <code>UsedRange</code> is not necessarily required, it would only select the used cells in that row as opposed to selecting the entire row of the workbook, which is very likely unneeded.</p>\n\n<p>You can use this function:  </p>\n\n<pre><code>Function rngActiveRow() As Range\n\n    Dim ws As Worksheet\n    Set ws = ActiveCell.Parent\n    Set rngActiveRow = ws.UsedRange.Rows(ActiveCell.Row)\n\nEnd Function\n</code></pre>\n\n<p>If you wanted to test it, you can try calling this function in a test sub to see it work:  </p>\n\n<pre><code>Sub test()\n\n    rngActiveRow.Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9325426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2490f762a18de0b0e3745adbaec26bb2?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/9325426/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517989001, "creation_date": 1517977777, "last_edit_date": 1517989001, "question_id": 48656041, "link": "https://stackoverflow.com/questions/48656041/copy-selected-row-cell-entries-to-other-sheet", "title": "copy selected row cell entries to other sheet", "body": "<p>I'm trying to provide the capability to select either a row or column in a row and copy certain cells off the row into a different sheet.</p>\n\n<p>For example...I have a list of renters (rows) each with the amount they owe and the amount collected on one sheet and the other sheet is a receipt. I'd like to enter the rent collected and have the receipt sheet updated automatically with the other sheets rows/individuals name and amount collected. </p>\n\n<p>Is there a VB function to identify the active row?</p>\n\n<p>If I can get that working the next thing would be adding/incrementing the invoice number.</p>\n"}, {"tags": ["vba", "excel", "textbox", "highlighting"], "comments": [{"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "edited": false, "score": 0, "creation_date": 1517979200, "post_id": 48656002, "comment_id": 84310230, "body": "Read this: <a href=\"http://www.cpearson.com/excel/findall.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/findall.aspx</a>. It will get the same job done, but not using InStr Function. after using the FindAll you can apply <code>Interior.ColorIndex</code> to highlight the cell"}, {"owner": {"reputation": 57, "user_id": 6539862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4be4b147ee95315f08d3462e36a8caa6?s=128&d=identicon&r=PG&f=1", "display_name": "dman", "link": "https://stackoverflow.com/users/6539862/dman"}, "reply_to_user": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "edited": false, "score": 0, "creation_date": 1517979705, "post_id": 48656002, "comment_id": 84310386, "body": "That is an interesting technique but I don&#39;t see how I can make this work in a userform textbox. This method is for worksheet objects."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1517981447, "post_id": 48656002, "comment_id": 84310910, "body": "Is this a form textbox? I am not sure about highlighting non-contiguous blocks of text - have you seen this somewhere?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1517983985, "post_id": 48656002, "comment_id": 84311795, "body": "You don&#39;t need to split the lines in order to find the start position.  Note - <code>instr()</code> has an optional <code>start</code> parameter to allow you to specify where to begin looking inside the string: use a global variable to keep track of the previous position of a hit, and adjust the value accordingly."}, {"owner": {"reputation": 57, "user_id": 6539862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4be4b147ee95315f08d3462e36a8caa6?s=128&d=identicon&r=PG&f=1", "display_name": "dman", "link": "https://stackoverflow.com/users/6539862/dman"}, "edited": false, "score": 0, "creation_date": 1518274610, "post_id": 48656002, "comment_id": 84442957, "body": "I was able to make your solution work after adding the split lines. The reason the split line is necessary is due to the instanceposition shifting by one space each time you go to a new line. I added a counter after the shift line and subtract the counter from the instanceposition if the counter is greater than 1. Thank you for your help!"}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1517986932, "creation_date": 1517986932, "answer_id": 48657777, "question_id": 48656002, "link": "https://stackoverflow.com/questions/48656002/how-can-i-use-the-instr-function-to-search-and-highlight-a-value-in-a-multiline/48657777#48657777", "title": "How can I use the InStr function to search and highlight a value in a multiline textbox?", "body": "<p>You can give this code a try (see comments for explanations):</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n    Static lastInstancePosition As Long ' use Static variable to have its value persist after Sub exiting\n    Dim instancePosition As Long\n\n    strVal = \"Find me\"\n    With myTextbox\n        instancePosition = InStr(lastInstancePosition + 1, .Text, strVal) 'search string occurrence starting from last found item\n        If instancePosition &gt; 0 Then\n            .SetFocus 'bring focus back ti the textbox after it has been taken by the button\n            .SelStart = instancePosition - 1\n            .SelLength = Len(strVal)\n            lastInstancePosition = instancePosition ' update starting position for next search\n       End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 6539862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4be4b147ee95315f08d3462e36a8caa6?s=128&d=identicon&r=PG&f=1", "display_name": "dman", "link": "https://stackoverflow.com/users/6539862/dman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 48657777, "answer_count": 1, "score": 0, "last_activity_date": 1522399653, "creation_date": 1517977486, "last_edit_date": 1531164843, "question_id": 48656002, "link": "https://stackoverflow.com/questions/48656002/how-can-i-use-the-instr-function-to-search-and-highlight-a-value-in-a-multiline", "title": "How can I use the InStr function to search and highlight a value in a multiline textbox?", "body": "<p>I am attempting to create a search inside of a multiline textbox that will find each instance of a value and highlight that value inside the textbox. It will need to work regardless of how many instances exist on a given line. So far I have used the following code to identify if a value exists on a line but cannot get the highlighting to work properly when there are multiple instances of the same value. </p>\n\n<pre><code>strVal = \"Find Me\"\narrLines =Split(myTextbox.value, vbCrLf)\nFor Each strLine In arrLines\n     If InStr(strVal, myTextbox.text) &gt; 0 Then\n          myTextbox.SelStart = InStr(strVal, my textbox.value)\n           myTextbox.SelLength = Len(strVal)\n           Exit For\n    End if\n Next\n</code></pre>\n\n<p>I want to have this macro linked to a button and have the macro find and highlight the next instance each time the button is clicked regardless if that instance is on the same line or a new line. Basically, a <kbd>Ctrl</kbd>+<kbd>F</kbd> feature for the textbox. Thanks!</p>\n"}, {"tags": ["excel", "ribbonx", "excel-iribbonui", "vba"], "comments": [{"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1517996547, "post_id": 48655916, "comment_id": 84318301, "body": "Where is the spCode procedure? In you addin? Is it declared as public?"}, {"owner": {"reputation": 99, "user_id": 7547802, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/71fb689e6af993d16b319d80de0e5aa5?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Rose", "link": "https://stackoverflow.com/users/7547802/jon-rose"}, "reply_to_user": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1518020461, "post_id": 48655916, "comment_id": 84334867, "body": "@Excel Developers - The <code>spCode</code> is in my Add-in.  It&#39;s located in the same module as the <code>spRibbon_onLoad</code> procedure.  As written above it&#39;s not public but I tried that too and received the same results."}], "answers": [{"tags": [], "owner": {"reputation": 99, "user_id": 7547802, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/71fb689e6af993d16b319d80de0e5aa5?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Rose", "link": "https://stackoverflow.com/users/7547802/jon-rose"}, "is_accepted": true, "score": 0, "last_activity_date": 1518149551, "creation_date": 1518149551, "answer_id": 48698640, "question_id": 48655916, "link": "https://stackoverflow.com/questions/48655916/run-time-error-1004-cannot-edit-a-macro-on-a-hidden-workbook-unhide-the-work/48698640#48698640", "title": "&quot;Run-time error &#39;1004&#39; Cannot edit a macro on a hidden workbook. Unhide the workbook using the Unhide command&quot; When using &quot;onLoad&quot; in Ribbon XML", "body": "<p>After a little more research I found out that a simple time delay of one second accomplished this.  It's not exactly what I was looking for but it works so I've decided to answer my own question.</p>\n\n<pre><code>Sub spRibbon_onLoad(ribbon As IRibbonUI)\n    Application.OnTime Now + TimeValue(\"00:00:01\"), \"spCode\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 7547802, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/71fb689e6af993d16b319d80de0e5aa5?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Rose", "link": "https://stackoverflow.com/users/7547802/jon-rose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "accepted_answer_id": 48698640, "answer_count": 1, "score": 2, "last_activity_date": 1518149551, "creation_date": 1517977015, "last_edit_date": 1531164843, "question_id": 48655916, "link": "https://stackoverflow.com/questions/48655916/run-time-error-1004-cannot-edit-a-macro-on-a-hidden-workbook-unhide-the-work", "title": "&quot;Run-time error &#39;1004&#39; Cannot edit a macro on a hidden workbook. Unhide the workbook using the Unhide command&quot; When using &quot;onLoad&quot; in Ribbon XML", "body": "<p>I have a feeling I'm using the \"onLoad\" callback incorrectly.  Essentially what I'm trying to do is run some code in VBA immediately after my custom ribbon loads (which is located on an add-in I've created).</p>\n\n<p><strong>This is the XML code:</strong></p>\n\n<pre><code>&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2009/07/customui\" onLoad=\"spRibbon_onLoad\"&gt;\n</code></pre>\n\n<p><strong>Here is the VBA code:</strong></p>\n\n<p>This is a global declaration:</p>\n\n<pre><code>Dim grxIRibbonUI\n</code></pre>\n\n<p>This is the code I'm attempting to run:</p>\n\n<pre><code>Sub spRibbon_onLoad(ribbon As IRibbonUI)\n    Set grxIRibbonUI = ribbon\n    Call spCode 'this is the code I'm attempting to run\nEnd Sub\n</code></pre>\n\n<p>The problem is, if I try and open an existing workbook (when no other instances of excel are open) I get the following error:</p>\n\n<blockquote>\n  <p>Run-time error '1004': Cannot edit a macro on a hidden workbook. \n  Unhide the workbook using the Unhide command.</p>\n</blockquote>\n\n<p>I then have to select the \"End\" button twice on the error because it pops up twice.</p>\n\n<p>I guess I can understand why it's throwing that error, my custom add-in hasn't loaded the customized ribbon yet but since the main ribbon has loaded it's attempting to run a macro it can't see.  However, if I have a workbook open already with my custom ribbon already visible, it simply won't run the code.  Any suggestions would be appreciated.</p>\n"}, {"tags": ["excel", "sorting", "columnsorting", "vba"], "comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1517976578, "post_id": 48655813, "comment_id": 84309550, "body": "formula to do it in B1 no.  a formula to place a corrected list in say column C probably.  If you are open to VBA as per your tag, then VBA can alter column B based on blank cells in column A."}], "answers": [{"tags": [], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "is_accepted": false, "score": 0, "last_activity_date": 1517976996, "creation_date": 1517976996, "answer_id": 48655913, "question_id": 48655813, "link": "https://stackoverflow.com/questions/48655813/if-a1-is-blank-move-text-in-b1-to-next-row/48655913#48655913", "title": "If A1 is blank move text in B1 to next row", "body": "<pre><code>=IF(A1=\"\",\"\",INDEX($B:$B,ROW(A1)-COUNTA($A$1:A1))\n</code></pre>\n\n<p>Place the above in C1 and copy down as far as needed and it should generate a corrected list in the neighbouring column.  This list could then be copied and values pasted back into B followed by a deletion of column C. </p>\n\n<p>There is a much cleaner way to do this in VBA but my brain is shot at the moment and I am not a VBA programmer to begin with.</p>\n"}, {"tags": [], "owner": {"reputation": 299, "user_id": 4527488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wn23p.png?s=128&g=1", "display_name": "Vipul Karkar", "link": "https://stackoverflow.com/users/4527488/vipul-karkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1522399713, "last_edit_date": 1522399713, "creation_date": 1517977168, "answer_id": 48655937, "question_id": 48655813, "link": "https://stackoverflow.com/questions/48655813/if-a1-is-blank-move-text-in-b1-to-next-row/48655937#48655937", "title": "If A1 is blank move text in B1 to next row", "body": "<ol>\n<li>Select the <code>Column A</code> </li>\n<li>Press <kbd>F5</kbd> </li>\n<li>Select <code>Special</code></li>\n<li>Select <code>Blanks</code> </li>\n<li>Press <kbd>Ctrl</kbd>+<kbd>-</kbd> </li>\n<li>Press <kbd>Shift</kbd>+<kbd>Up</kbd></li>\n<li>Press Ok</li>\n</ol>\n\n<p>Done!</p>\n"}], "owner": {"reputation": 37, "user_id": 2548731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3c959f40d77978ce46c58257e29cbf62?s=128&d=identicon&r=PG", "display_name": "beginner", "link": "https://stackoverflow.com/users/2548731/beginner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1811, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1522399713, "creation_date": 1517976258, "last_edit_date": 1531161705, "question_id": 48655813, "link": "https://stackoverflow.com/questions/48655813/if-a1-is-blank-move-text-in-b1-to-next-row", "title": "If A1 is blank move text in B1 to next row", "body": "<p>I have a table where A1 has country name, B1 has price, and some fields in country is deleted, is there a forumla to force B1 to move all values to next available field, below image example.</p>\n\n<ul>\n<li>Grenada is 131.5 (Correct)</li>\n<li>Guadeloupe is 81.0 (correct)</li>\n<li>Guatemala should be 131.5</li>\n<li>Guinea should be 98.0</li>\n<li>Guyana should be 102.0</li>\n<li>Guyane French should be 185.5 and so on </li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/iEpxy.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iEpxy.jpg\" alt=\"This is the table picture\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "edited": false, "score": 0, "creation_date": 1517970252, "post_id": 48654724, "comment_id": 84308105, "body": "Are you getting error? There&#39;s an extra <code>OR</code> in the IF"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9101211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2a52068fd2491d241fb91b11e59d36c?s=128&d=identicon&r=PG&f=1", "display_name": "jaik", "link": "https://stackoverflow.com/users/9101211/jaik"}, "edited": false, "score": 0, "creation_date": 1518026292, "post_id": 48656022, "comment_id": 84338577, "body": "I am trying to do this instead writing like yours, but it seems its ignoring this line.  Range(&quot;D&quot; &amp; rngCell.Row).Value &lt;&gt; WorksheetFunction.CountIf(Sheets(&quot;Filter&quot;).Range(&quot;B1:B&quot; &amp; rowLast), rngCell) Then"}, {"owner": {"reputation": 299, "user_id": 4527488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wn23p.png?s=128&g=1", "display_name": "Vipul Karkar", "link": "https://stackoverflow.com/users/4527488/vipul-karkar"}, "reply_to_user": {"reputation": 5, "user_id": 9101211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2a52068fd2491d241fb91b11e59d36c?s=128&d=identicon&r=PG&f=1", "display_name": "jaik", "link": "https://stackoverflow.com/users/9101211/jaik"}, "edited": false, "score": 0, "creation_date": 1518072222, "post_id": 48656022, "comment_id": 84355558, "body": "I have updated an answer so the code can handle different last rows for both the sheets."}, {"owner": {"reputation": 5, "user_id": 9101211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2a52068fd2491d241fb91b11e59d36c?s=128&d=identicon&r=PG&f=1", "display_name": "jaik", "link": "https://stackoverflow.com/users/9101211/jaik"}, "edited": false, "score": 0, "creation_date": 1518226827, "post_id": 48656022, "comment_id": 84432080, "body": "Thank you for the help, but I got the solution by myself. This code works way I wanted.                           If WorksheetFunction.CountIf(Sheets(&quot;Filter&quot;).Range(&quot;A1:A&quot; &amp; rowLast), rngCell) &lt;&gt; 0 And _        Range(&quot;I&quot; &amp; rngCell.Row).Value &lt;= 0 And _        WorksheetFunction.CountIf(Sheets(&quot;Filter&quot;).Range(&quot;B1:B&quot; &amp; rowLast), rngCell.Offset(, -2)) = 0 Then"}], "tags": [], "owner": {"reputation": 299, "user_id": 4527488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wn23p.png?s=128&g=1", "display_name": "Vipul Karkar", "link": "https://stackoverflow.com/users/4527488/vipul-karkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1518072266, "last_edit_date": 1518072266, "creation_date": 1517977638, "answer_id": 48656022, "question_id": 48654724, "link": "https://stackoverflow.com/questions/48654724/vba-to-compare-two-dynamic-fields-if-is-exisiting-on-other-page/48656022#48656022", "title": "vba to compare two dynamic fields if is exisiting on other page", "body": "<pre><code>Sub numbers()\nDim rngCell As Range\nDim lR_final, lR_filter As Long\n\nlR_final = Worksheets(\"Final\").Cells(Rows.Count, 6).End(xlUp).Row\nlR_filter = Worksheets(\"Filter\").Cells(Rows.Count, 1).End(xlUp).Row\n\nFor Each rngCell In Sheets(\"Final\").Range(\"F13:F\" &amp; lR_final)\n    If WorksheetFunction.CountIf(Sheets(\"Filter\").Range(\"A1:A\" &amp; lR_filter), rngCell) &lt;&gt; 0 And _\n       Range(\"I\" &amp; rngCell.Row).Value &lt;= 0 And _\n         Range(\"D\" &amp; rngCell.Row).Value &lt; WorksheetFunction.CountIf(Sheets(\"Filter\").Range(\"B1:B\" &amp; lR_filter), rngCell) Or _\n          Range(\"D\" &amp; rngCell.Row).Value &gt; WorksheetFunction.CountIf(Sheets(\"Filter\").Range(\"B1:B\" &amp; lR_filter), rngCell) Then\n\n       MsgBox \"Please add correct number \" &amp; rngCell\n       End\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Try This and let us know if it works or if it gives an error.</p>\n"}], "owner": {"reputation": 5, "user_id": 9101211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2a52068fd2491d241fb91b11e59d36c?s=128&d=identicon&r=PG&f=1", "display_name": "jaik", "link": "https://stackoverflow.com/users/9101211/jaik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518072266, "creation_date": 1517967860, "last_edit_date": 1518026624, "question_id": 48654724, "link": "https://stackoverflow.com/questions/48654724/vba-to-compare-two-dynamic-fields-if-is-exisiting-on-other-page", "title": "vba to compare two dynamic fields if is exisiting on other page", "body": "<pre><code>Sub numbers()\nDim rngCell As Range\nFor Each rngCell In Sheets(\"Final\").Range(\"F13:F\" &amp; rowLast)\n    If WorksheetFunction.CountIf(Sheets(\"Filter\").Range(\"A1:A\" &amp; rowLast), rngCell) &lt;&gt; 0 And _\n       Range(\"I\" &amp; rngCell.Row).Value &lt;= 0 And _\n         Range(\"D\" &amp; rngCell.Row).Value &lt; 50 Or _\n          Range(\"D\" &amp; rngCell.Row).Value &gt; 59 Then\n\n       MsgBox \"Please add correct number \" &amp; rngCell\n       End\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p>I have this code, but I would like to set this comparing value from filter sheet column B. instead of writing numbers manually just like first line of if statement.</p>\n\n<p>want to make change on this lines:</p>\n\n<pre><code>Range(\"D\" &amp; rngCell.Row).Value &lt; 50 Or _\nRange(\"D\" &amp; rngCell.Row).Value &gt; 59 Then\n</code></pre>\n\n<p>Is possible to make this filter compare values from column B like <code>If WorksheetFunction.CountIf(Sheets(\"Filter\").Range(\"A1:A\" &amp; rowLast), rngCell) &lt;&gt; 0 And _</code> \n?</p>\n\n<p>Any advice are welcome!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1517968421, "post_id": 48654614, "comment_id": 84307655, "body": "It can be done with custom classes. See <a href=\"https://stackoverflow.com/questions/1083603/vba-using-withevents-on-userforms/1923457#1923457\" title=\"vba using withevents on userforms\">stackoverflow.com/questions/1083603/&hellip;</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1517968496, "post_id": 48654614, "comment_id": 84307675, "body": "@ChrisMelville - the events the OP wants are not available using that method."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1517968635, "post_id": 48654614, "comment_id": 84307705, "body": "Is there a max. number of controls likely to be added at runtime?  Could you create them at design time but position the &quot;extra&quot; ones off the form or hide them from the user until required?"}, {"owner": {"reputation": 11, "user_id": 9324801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18dd6c45069dba59c68d58315e196528?s=128&d=identicon&r=PG&f=1", "display_name": "uludapata", "link": "https://stackoverflow.com/users/9324801/uludapata"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1517971546, "post_id": 48654614, "comment_id": 84308370, "body": "@Tim Williams - Hi Tim. Thank you for reading through that and for your suggestion. I&#39;ve not decided on an upper limit yet, but I expect some users to require  50-100 rows at times. That would mean creating 800 or so (100 rows of 8) controls in the design view along with 400 event handling procedures.  Tedious, but doable. Could Excel handle that many controls on a single useful without running into performance/memory issues? I suspect that some users will be running this on modest i3 machines."}, {"owner": {"reputation": 11, "user_id": 9324801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18dd6c45069dba59c68d58315e196528?s=128&d=identicon&r=PG&f=1", "display_name": "uludapata", "link": "https://stackoverflow.com/users/9324801/uludapata"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1517971869, "post_id": 48654614, "comment_id": 84308447, "body": "@ChrisMelville Hi Chris. Cheers for the suggestion. I tried this approach and found the available events prohibitive."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1517983150, "post_id": 48654614, "comment_id": 84311473, "body": "Well if you&#39;re hoping to handle that many dynamic rows then I wouldn&#39;t expect the same number of pre-made controls to result in slower performance (granted, we&#39;re talking about worse-case here...)  You could script the setup of the controls and event handling code."}], "owner": {"reputation": 11, "user_id": 9324801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18dd6c45069dba59c68d58315e196528?s=128&d=identicon&r=PG&f=1", "display_name": "uludapata", "link": "https://stackoverflow.com/users/9324801/uludapata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 895, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1517967024, "creation_date": 1517967024, "last_edit_date": 1531164843, "question_id": 48654614, "link": "https://stackoverflow.com/questions/48654614/excel-vba-how-to-create-event-handlers-for-dynamically-generated-controls-withi", "title": "Excel VBA: How to create event handlers for dynamically generated controls within an active userform?", "body": "<p>I\u2019m struggling with handling controls that are dynamically added during runtime to a pre-existing, active userform.</p>\n\n<p>The userform is called \u201cSalesInvoices\u201d and initially contains a 10x8 grid of Textbox and ComboBox fields (controls). These have been created within the design mode, along with a few command buttons.</p>\n\n<p>After the userform is launched, the user can add and delete additional rows by clicking the appropriate buttons. The userform remains active throughout, and the original 10x8 grid cannot be removed by the user.</p>\n\n<p>Aesthetically, adding, deleting, moving and resizing the controls and the containing frame all work as intended.</p>\n\n<p>The issue I\u2019m facing is with assigning event handling procedures to the <strong><em>additional</em></strong> controls.</p>\n\n<p>WithEvents doesn\u2019t appear to be useful in this scenario as I require the BeforeUpdate and AfterUpdate events to validate the entries made by the user.</p>\n\n<p>As such, I\u2019ve resorted to programmatically inserting and removing the requisite event handling procedures as and when the user adds/deletes additional rows.</p>\n\n<p>However, whilst my code appears to place the additional procedures accordingly, the event handlers are not triggered by the corresponding controls.</p>\n\n<p>For example, here is a snippet dealing with the addition of a single control, Net_Amount11:</p>\n\n<pre><code>Private Sub AddLineButton_Click()\n\n    Dim new_item_no As integer\n    Dim new_NetAmount As Control\n    Dim LineNum As Integer\n    Dim DynamicUserForm As Object\n\n    new_item_no = 11\n    Set new_NetAmount = Me.Controls(\"Frame6\").Add(\"Forms.TextBox.1\", \"Net_Amount\" &amp; new_item_no, True)\n\n    With new_NetAmount\n    .Left = 25\n    .Top = 50\n    .Width = 50\n    .Visible = True\n    End With\n\n\n    Set DynamicUserForm = ActiveWorkbook.VBProject.VBComponents(\"SalesInvoices\")\n\n    With DynamicUserForm.CodeModule\n     LineNum = .CountOfLines + 1\n        .InsertLines LineNum, _\n            \"Private Sub Net_Amount\" &amp; new_item_no &amp; \"_AfterUpdate()\" &amp; Chr(13) &amp; _\n            \"Call validate_net_amount_SI(\" &amp; new_item_no &amp; \")\" &amp; Chr(13) &amp; _\n            \"End Sub\"\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This code creates the additional control in Frame6 of the active UserForm, SalesInvoices, and it inserts the event handling procedure into the code section of that userform.</p>\n\n<p>But, when I update the value in the newly created Net_Amount11 TextBox, the event handler is not triggered nor is the procedure validate_net_amount_SI called.  (Note that the userform is active throughout).</p>\n\n<p>No errors are reported by the Editor.</p>\n\n<p>I\u2019m all out of ideas and would be grateful for some assistance. Hopefully I\u2019ve missed something simple. </p>\n\n<p>I did wonder whether this was because the inserted code needs to be compiled before it becomes operable (is this even possible on the fly without affecting the contents of the active userform?). Or perhaps there is some mismatch between the temporary nature of the new TextBox control and the permanent code relating to the userform. I couldn't find a solution either way.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 2682, "user_id": 9059424, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ez4b8InqhCI/AAAAAAAAAAI/AAAAAAAAAWE/IY8n6L2OBQk/photo.jpg?sz=128", "display_name": "aduguid", "link": "https://stackoverflow.com/users/9059424/aduguid"}, "edited": false, "score": 0, "creation_date": 1517963922, "post_id": 48653943, "comment_id": 84306470, "body": "Do you want to enter the time or do you need 24 hours from the current time?"}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1518001942, "creation_date": 1518001942, "answer_id": 48662391, "question_id": 48653943, "link": "https://stackoverflow.com/questions/48653943/date-and-time-range-where-date-and-date-1-cant-be-use-in-access-query/48662391#48662391", "title": "Date and time range where Date() and Date()-1 can&#39;t be use in access query", "body": "<p>You can do simple calculus with dates and times. Try the following:</p>\n\n<pre><code>Between Date() - 1  + #3:40:00 PM#  And  Date() + #3:39:59 PM#\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9324794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b9fa22ac36a60e748d1439e56818ca?s=128&d=identicon&r=PG&f=1", "display_name": "Luas04", "link": "https://stackoverflow.com/users/9324794/luas04"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 48662391, "answer_count": 1, "score": 0, "last_activity_date": 1593955594, "creation_date": 1517962004, "last_edit_date": 1593955594, "question_id": 48653943, "link": "https://stackoverflow.com/questions/48653943/date-and-time-range-where-date-and-date-1-cant-be-use-in-access-query", "title": "Date and time range where Date() and Date()-1 can&#39;t be use in access query", "body": "<p>I am trying to set up a query that pulls data from a date field. The date range (for example) that I need is from 3:40 PM of yesterday to today's date up to 3:40 PM. In other words my day does not star at midnight, so the function Date() can't cover it.</p>\n\n<p>I have set up the query as follows:</p>\n\n<p>Between #2/5/2018 3:40:00 PM# And #2/6/2018 3:39:59 PM#</p>\n\n<p>in a field formatted for general Date (mm/dd/yyyy h:mm:ss AM or PM). With this I would have to change the query every day.</p>\n\n<p>I would like to be able to use the function Date() &amp; Date()-1 to replace today's date (Date()) and Yesterday (Date()-1). How can I do it?</p>\n\n<p>I have also tried having two fields one for the Date (formatted as short date mm/dd/yyyy) when the order was entered, and the time the order was entered (formatted for general Date (mm/dd/yyyy h:mm:ss AM or PM). However when I use the function Date() on the date field and >#h:mm:ss# on the Time field the query yields 0 records.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1517957787, "post_id": 48653288, "comment_id": 84304693, "body": "<code>aWs.Range(&quot;A1&quot;).Resize(UBound(My2DArray,1) - LBound(My2DArray,1) + 1,UBound(My2DArray,2) - LBound(My2DArray,2) + 1).Value = My2DArray</code>"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1517958052, "post_id": 48653288, "comment_id": 84304780, "body": "any reason for using array of arrays (<code>(i)(j)</code>) instead of 2D rectangular array (<code>(i, j)</code>) ? You can use @ScottCraner&#39;s comment if you use 2D array"}, {"owner": {"reputation": 8136, "user_id": 461212, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SmGJ1.jpg?s=128&g=1", "display_name": "hornetbzz", "link": "https://stackoverflow.com/users/461212/hornetbzz"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1517958119, "post_id": 48653288, "comment_id": 84304800, "body": "@ScottCraner Thx, this leads to <code>subscript out of range</code>. Also I swapped i and j in the code as I want the data in columns."}, {"owner": {"reputation": 8136, "user_id": 461212, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SmGJ1.jpg?s=128&g=1", "display_name": "hornetbzz", "link": "https://stackoverflow.com/users/461212/hornetbzz"}, "edited": false, "score": 0, "creation_date": 1517958198, "post_id": 48653288, "comment_id": 84304830, "body": "All the rest of the code works with using that array, so I&#39;m not aiming to change it and introduce further bugs. I understand it would make it easier if rectangular."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1517958350, "post_id": 48653288, "comment_id": 84304878, "body": "Then looping is your only choice."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1517958406, "post_id": 48653288, "comment_id": 84304893, "body": "oh never mind .. I just noticed that the sub-arrays have different number of items"}, {"owner": {"reputation": 8136, "user_id": 461212, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SmGJ1.jpg?s=128&g=1", "display_name": "hornetbzz", "link": "https://stackoverflow.com/users/461212/hornetbzz"}, "edited": false, "score": 0, "creation_date": 1517958590, "post_id": 48653288, "comment_id": 84304960, "body": "Yes, I expected to be able to code it cleaner, say dumping data by columns using <code>range(..).resize(..)=arr</code> in function of the vector size. At least getting rid off one of the 2 loops."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1517958664, "post_id": 48653288, "comment_id": 84304991, "body": "so you want each &quot;Row&quot; in the array to be a column?"}, {"owner": {"reputation": 8136, "user_id": 461212, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SmGJ1.jpg?s=128&g=1", "display_name": "hornetbzz", "link": "https://stackoverflow.com/users/461212/hornetbzz"}, "edited": false, "score": 0, "creation_date": 1517958741, "post_id": 48653288, "comment_id": 84305019, "body": "Yes it would be nice to have what you can see on the screenshot into one column."}], "answers": [{"comments": [{"owner": {"reputation": 8136, "user_id": 461212, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SmGJ1.jpg?s=128&g=1", "display_name": "hornetbzz", "link": "https://stackoverflow.com/users/461212/hornetbzz"}, "edited": false, "score": 1, "creation_date": 1517958963, "post_id": 48653480, "comment_id": 84305095, "body": "Thx Impressive ! Tested and works like a charm. I was not far away on one of 1000 of tries :-)"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1517966008, "post_id": 48653480, "comment_id": 84307054, "body": "This will fail if LBound of My2DArray is not 1"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1517958820, "creation_date": 1517958820, "answer_id": 48653480, "question_id": 48653288, "link": "https://stackoverflow.com/questions/48653288/vba-how-to-dump-a-2d-array-into-a-worksheet-range/48653480#48653480", "title": "VBA how to dump a 2D array into a worksheet Range", "body": "<p>this eliminates one loop:</p>\n\n<pre><code>Public Sub Array2Range(My2DArray As Variant, aWS As Worksheet)\n' Ref : https://stackoverflow.com/questions/6063672/excel-vba-function-to-print-an-array-to-the-workbook\n' Ref : http://www.ozgrid.com/VBA/sort-array.htm\n' Ref : https://www.mrexcel.com/forum/excel-questions/14194-vba-arrays-examples-please-how-read-range-th.html\n' Ref : https://bettersolutions.com/excel/cells-ranges/vba-working-with-arrays.htm\n' Usage : Array2Range MyArray, aWS\n\n  Dim i as Long\n\n\n  For i = 1 To UBound(My2DArray) - LBound(My2DArray) + 1\n      aWS.Cells(1, i).Resize(UBound(My2DArray(i))).Value = Application.Transpose(My2DArray(i))\n  Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8136, "user_id": 461212, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SmGJ1.jpg?s=128&g=1", "display_name": "hornetbzz", "link": "https://stackoverflow.com/users/461212/hornetbzz"}, "edited": false, "score": 0, "creation_date": 1517961528, "post_id": 48653815, "comment_id": 84305857, "body": "Thx Slai, looks also as an elegant solution."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 1, "last_activity_date": 1517961111, "creation_date": 1517961111, "answer_id": 48653815, "question_id": 48653288, "link": "https://stackoverflow.com/questions/48653288/vba-how-to-dump-a-2d-array-into-a-worksheet-range/48653815#48653815", "title": "VBA how to dump a 2D array into a worksheet Range", "body": "<p>Similar, but a bit different alternative:</p>\n\n<pre><code>Sub ArrayToRange(jaggedArray, cell As Range): Dim subArray\n    For Each subArray In jaggedArray\n        cell.Resize(UBound(subArray), 1) = Application.Transpose(subArray)\n        Set cell = cell(, 2)\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 8136, "user_id": 461212, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SmGJ1.jpg?s=128&g=1", "display_name": "hornetbzz", "link": "https://stackoverflow.com/users/461212/hornetbzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1313, "favorite_count": 0, "accepted_answer_id": 48653480, "answer_count": 2, "score": 0, "last_activity_date": 1517961111, "creation_date": 1517957587, "last_edit_date": 1517958478, "question_id": 48653288, "link": "https://stackoverflow.com/questions/48653288/vba-how-to-dump-a-2d-array-into-a-worksheet-range", "title": "VBA how to dump a 2D array into a worksheet Range", "body": "<p>I'm looking for the <strong>nice and elegant solution</strong> to achieve this working code below. I could NOT find it after many searches and tries, since VBA rationales keep kind of magic for me.</p>\n\n<p>The looping code :</p>\n\n<pre><code>Public Sub Array2Range(My2DArray As Variant, aWS As Worksheet)\n' Ref : https://stackoverflow.com/questions/6063672/excel-vba-function-to-print-an-array-to-the-workbook\n' Ref : http://www.ozgrid.com/VBA/sort-array.htm\n' Ref : https://www.mrexcel.com/forum/excel-questions/14194-vba-arrays-examples-please-how-read-range-th.html\n' Ref : https://bettersolutions.com/excel/cells-ranges/vba-working-with-arrays.htm\n' Usage : Array2Range MyArray, aWS\n\n  Dim i, j As Integer\n  Dim elt As Variant\n\n  For i = 1 To UBound(My2DArray) - LBound(My2DArray) + 1\n      j = 1\n     For Each elt In My2DArray(i)\n        aWS.Cells(j, i) = elt\n        j = j + 1\n      Next elt\n  Next i\n\nEnd Sub\n</code></pre>\n\n<p>The watches window screenshot, to understand the 2D array structure\n<a href=\"https://i.stack.imgur.com/rT37l.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rT37l.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thx for your support and ideas.</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 5568749, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gp-yysHtw0Y/AAAAAAAAAAI/AAAAAAAAAAA/R7F83nJTXtc/photo.jpg?sz=128", "display_name": "Minott Opdyke", "link": "https://stackoverflow.com/users/5568749/minott-opdyke"}, "edited": false, "score": 0, "creation_date": 1518015631, "post_id": 48653203, "comment_id": 84331380, "body": "Ok, these are the changes. I get the error &#39;Object variable or With block variable not set&#39;                                                                                                  &#39;Dim rst AS Recordset &#39;                                                                                                          &#39;rst.OpenRecordset &quot;SELECT...&quot;&#39;"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 57, "user_id": 5568749, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gp-yysHtw0Y/AAAAAAAAAAI/AAAAAAAAAAA/R7F83nJTXtc/photo.jpg?sz=128", "display_name": "Minott Opdyke", "link": "https://stackoverflow.com/users/5568749/minott-opdyke"}, "edited": false, "score": 0, "creation_date": 1518016415, "post_id": 48653203, "comment_id": 84331942, "body": "You are still using your current code and not this answer: <code>rst.OpenRecordset</code> means you are trying to open a recordset on a recordset object. Use <code>CurrentDb.OpenRecordset</code>."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 4, "last_activity_date": 1517957121, "creation_date": 1517957121, "answer_id": 48653203, "question_id": 48653034, "link": "https://stackoverflow.com/questions/48653034/ms-access-2016-sql-in-vba/48653203#48653203", "title": "MS Access 2016 SQL in VBA", "body": "<p>You are conflating DAO recordsets and databases and hence the message is correct as the item is not found in collection. Simply initialize <em>rst</em> as a recordset and assign it to <code>OpenRecordset</code> call.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim rst As DAO.Recordset\n\nSet rst = CurrentDb.OpenRecordset(\"SELECT dbo_STCH.TE FROM dbo_STCH\" _\n                                  &amp; \" RIGHT JOIN dbo_SCVR ON dbo_STCH.TN = dbo_SCVR.TN_1\" _\n                                  &amp; \" WHERE dbo_SCVR.TN_1=99;\")\n\nMe.Text22.Text = rst!TE\n\nrst.Close\nSet rst = Nothing\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 5568749, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gp-yysHtw0Y/AAAAAAAAAAI/AAAAAAAAAAA/R7F83nJTXtc/photo.jpg?sz=128", "display_name": "Minott Opdyke", "link": "https://stackoverflow.com/users/5568749/minott-opdyke"}, "edited": false, "score": 0, "creation_date": 1518016409, "post_id": 48666882, "comment_id": 84331937, "body": "Ok, looks like that got me through to the record, but now I get &#39;You can&#39;t reference a property or method for a control unless the control has the focus.&#39;    on my textbox."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "reply_to_user": {"reputation": 57, "user_id": 5568749, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gp-yysHtw0Y/AAAAAAAAAAI/AAAAAAAAAAA/R7F83nJTXtc/photo.jpg?sz=128", "display_name": "Minott Opdyke", "link": "https://stackoverflow.com/users/5568749/minott-opdyke"}, "edited": false, "score": 0, "creation_date": 1518016599, "post_id": 48666882, "comment_id": 84332074, "body": "Remove the <code>.text</code> part: <code>Me.Text22 = rst!TE</code>"}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1518015564, "creation_date": 1518015564, "answer_id": 48666882, "question_id": 48653034, "link": "https://stackoverflow.com/questions/48653034/ms-access-2016-sql-in-vba/48666882#48666882", "title": "MS Access 2016 SQL in VBA", "body": "<p>You have to use <code>rst.MoveFirst</code> to move to the first record of the opened recordset before reading any values from it.</p>\n\n<p>Also as the answer above you have to <code>Set rst = CurrentDb.OpenRecordset</code></p>\n"}], "owner": {"reputation": 57, "user_id": 5568749, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gp-yysHtw0Y/AAAAAAAAAAI/AAAAAAAAAAA/R7F83nJTXtc/photo.jpg?sz=128", "display_name": "Minott Opdyke", "link": "https://stackoverflow.com/users/5568749/minott-opdyke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 0, "accepted_answer_id": 48653203, "answer_count": 2, "score": 1, "last_activity_date": 1518015564, "creation_date": 1517956199, "last_edit_date": 1517956835, "question_id": 48653034, "link": "https://stackoverflow.com/questions/48653034/ms-access-2016-sql-in-vba", "title": "MS Access 2016 SQL in VBA", "body": "<p>I'm sure I'm making a simple mistake. I have a SQL Server with tables that I have linked in MS Access. I am trying to run a SQL query in Form <code>OnLoad</code> to populate a text box based on a value in my form. </p>\n\n<p>Below is my code. The field I want returned <em>TE</em> is varchar in MSSQL and short text in Access. I am getting a <code>'Type Mismatch'</code> on the textbox. When I try outputting to a <code>MsgBox</code> I get:</p>\n\n<blockquote>\n  <p>'rst!TE not in collection'. </p>\n</blockquote>\n\n<p>TN and TN_1 are smallint, in Access they are Number.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim rst As DAO.Database\nSet rst = CurrentDb\n\nrst.OpenRecordset \"SELECT dbo_STCH.TE FROM dbo_STCH RIGHT JOIN dbo_SCVR ON               dbo_STCH.TN = dbo_SCVR.TN_1 WHERE dbo_SCVR.TN_1=99;\"\n\nMe.Text22.Text = rst!TE\nrst.Close\nSet rst = Nothing\n</code></pre>\n"}, {"tags": ["vba", "outlook", "vsto", "outlook-addin"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1518365482, "creation_date": 1518365482, "answer_id": 48733541, "question_id": 48652838, "link": "https://stackoverflow.com/questions/48652838/how-to-create-a-outlook-2013-add-in-command/48733541#48733541", "title": "How to create a Outlook 2013 Add-in Command?", "body": "<p>VBA doesn't allow creating a ribbon custom UI for Outlook. You need to develop a COM add-in for Outlook if you want to create a custom UI. Read more about that in the <a href=\"https://msdn.microsoft.com/en-us/library/cc668191.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Walkthrough: Creating Your First VSTO Add-In for Outlook</a> article. </p>\n\n<p>VSTO provides two main ways for creating a custom ribbon UI:</p>\n\n<ol>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/aa942955.aspx\" rel=\"nofollow noreferrer\">Walkthrough: Creating a Custom Tab by Using Ribbon XML</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/bb386104.aspx\" rel=\"nofollow noreferrer\">Walkthrough: Creating a Custom Tab by Using the Ribbon Designer</a></li>\n</ol>\n\n<p>You may find the Fluent UI described in depth in the following series of articles:</p>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/aa338202(v=office.12).aspx\" rel=\"nofollow noreferrer\">Customizing the 2007 Office Fluent Ribbon for Developers (Part 1 of 3)</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/aa338199(v=office.12).aspx\" rel=\"nofollow noreferrer\">Customizing the 2007 Office Fluent Ribbon for Developers (Part 2 of 3)</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/aa722523(v=office.12).aspx\" rel=\"nofollow noreferrer\">Customizing the 2007 Office Fluent Ribbon for Developers (Part 3 of 3)</a></li>\n</ul>\n\n<p>Also, you may consider creating web-based add-ins (former known as Mail Aps), see <a href=\"https://docs.microsoft.com/en-us/outlook/add-ins/add-in-commands-for-outlook\" rel=\"nofollow noreferrer\">Add-in commands for Outlook</a> for more information. </p>\n"}], "owner": {"reputation": 1973, "user_id": 3184810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868e662a5d063d975167744ee552410f?s=128&d=identicon&r=PG&f=1", "display_name": "ceeroover", "link": "https://stackoverflow.com/users/3184810/ceeroover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 687, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593057512, "creation_date": 1517955218, "last_edit_date": 1593057512, "question_id": 48652838, "link": "https://stackoverflow.com/questions/48652838/how-to-create-a-outlook-2013-add-in-command", "title": "How to create a Outlook 2013 Add-in Command?", "body": "<p>I want to create a Ribbon Button in the calendar view of Outlook that extracts some properties (e.g. data, time) of the current selected calendar item (appointment) in the Outlook calendar view and that creates a new Email with the properties listed in the text.</p>\n\n<p>I also appreciate answers that will provide links to blogs, articles or videos related to this task, as I couldn't find much with the necessary guidance and explanation I need for this. Also other solutions to do this with Outlook on-board tools are welcome. <strong>Important:</strong> I do not just want to forward the appointment as an attachment to a new Email, I want the properties as text <strong>in</strong> the Email. </p>\n\n<p>Remarks:</p>\n\n<ol>\n<li>I have no background in MS Office plugin development, please consider this</li>\n<li>I have successfully done this walktrough with the VBA code samples  (<a href=\"https://msdn.microsoft.com/en-us/library/cc668191.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/cc668191.aspx</a>), that adds some text to every new Email message, but I couldn't figure out how to go on effectively to get my task done</li>\n</ol>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1517955240, "post_id": 48652826, "comment_id": 84303727, "body": "becuase you are not updating your filename inside the for loop."}, {"owner": {"reputation": 3, "user_id": 8271517, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qkCy6MNdU_k/AAAAAAAAAAI/AAAAAAAADxw/lptu1aLKanE/photo.jpg?sz=128", "display_name": "Francis Deshaies", "link": "https://stackoverflow.com/users/8271517/francis-deshaies"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1518009533, "post_id": 48652826, "comment_id": 84327026, "body": "The name is updating itself in the K1 cell using the information from B4 and B5. Is-it still possible or do I have to copy in a third sheet and print out only once?"}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 8843645, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-E0i0xs5FEXs/AAAAAAAAAAI/AAAAAAAAAGA/YLFiL3zkaIE/photo.jpg?sz=128", "display_name": "chipie", "link": "https://stackoverflow.com/users/8843645/chipie"}, "is_accepted": false, "score": 0, "last_activity_date": 1517956196, "creation_date": 1517956196, "answer_id": 48653033, "question_id": 48652826, "link": "https://stackoverflow.com/questions/48652826/saving-and-looping-using-vba-in-excel/48653033#48653033", "title": "Saving and looping using vba in excel", "body": "<p>now, you r save the file 3 times. \nfirst you need to copy the data on a sheet 'Enveloppe'</p>\n\n<pre><code>for i = 2 To 4\nnext\n</code></pre>\n\n<p>then save the file:</p>\n\n<pre><code>Worksheets(\"Enveloppe\").Range(\"A1:I23\").ExportAsFixedFormat _\n    Type:=xlTypePDF, _\n    Filename:=FName\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1517956397, "creation_date": 1517956397, "answer_id": 48653067, "question_id": 48652826, "link": "https://stackoverflow.com/questions/48652826/saving-and-looping-using-vba-in-excel/48653067#48653067", "title": "Saving and looping using vba in excel", "body": "<p>Your copy/paste method is very inefficient. </p>\n\n<p>See if this works (untested):</p>\n\n<pre><code>'Your worksheet variables\nDim wsInfoCas As Worksheet, wsEnveloppe As Worksheet\nSet wsInfoCas = ThisWorkbook.Worksheets(\"Info-Cas\")\nSet wsEnveloppe = ThisWorkbook.Worksheets(\"Enveloppe\")\n\n'Your copy variable\nDim retVal, retArr1(), retArr2()\n\nFor i = 2 To 4\n\n    FName = wsEnveloppe.Range(\"K1\").Text\n\n    With wsInfoCas\n\n        retVal = .Range(\"K\" &amp; i).Value\n        retArr1 = .Range(\"A\" &amp; i, \"E\" &amp; i).Value\n        retArr2 = .Range(\"F\" &amp; i, \"J\" &amp; i).Value\n\n    End With\n\n    With Application.WorksheetFunction\n\n        wsEnveloppe.Range(\"A3\").Value = retVal\n        wsEnveloppe.Range(\"B4:B8\").Value = .Transpose( _\n                retArr1)\n        wsEnveloppe.Range(\"B10:B14\").Value = .Transpose( _\n                retArr2)\n    End With\n\nNext\n\nwsEnveloppe.Range(\"A1:I23\").ExportAsFixedFormat _\n    Type:=xlTypePDF, _\n    Filename:=FName\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8271517, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qkCy6MNdU_k/AAAAAAAAAAI/AAAAAAAADxw/lptu1aLKanE/photo.jpg?sz=128", "display_name": "Francis Deshaies", "link": "https://stackoverflow.com/users/8271517/francis-deshaies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1517956397, "creation_date": 1517955148, "last_edit_date": 1517955575, "question_id": 48652826, "link": "https://stackoverflow.com/questions/48652826/saving-and-looping-using-vba-in-excel", "title": "Saving and looping using vba in excel", "body": "<p>I'm trying to save as a PDF a section of an Excel sheet that is based from the information in another sheet of the workbook.</p>\n\n<p>The first sheet in which I got to print in a PDF the section A1:I23 is named Enveloppe.\nThe second sheet in which the data is stored is named Info-Cas.</p>\n\n<p>Basically, I made a table that I have to export as a PDF and merge every of the 144 PDF together. Of course, I don't want to type everyting one by one so I wrote the following macro. Obviously, it does not work right now.</p>\n\n<pre><code>Dim FName As String\nDim i As Integer\n\nFName = Worksheets(\"Enveloppe\").Range(\"K1\").Text\n\nFor i = 2 To 4\n\n    'Copier la journ\u00e9e du cas\n    Worksheets(\"Info-Cas\").Range(\"K\" &amp; i).Copy\n    Worksheets(\"Enveloppe\").Range(\"A3\").PasteSpecial Paste:=xlPasteValues\n\n    'Copier les informations principales (Cas, Num\u00e9ro d'\u00e9quipe, Salle)\n    Worksheets(\"Info-Cas\").Range(\"A\" &amp; i).Copy\n    Worksheets(\"Enveloppe\").Range(\"B4\").PasteSpecial Paste:=xlPasteValues\n    Worksheets(\"Info-Cas\").Range(\"B\" &amp; i).Copy\n    Worksheets(\"Enveloppe\").Range(\"B5\").PasteSpecial Paste:=xlPasteValues\n    Worksheets(\"Info-Cas\").Range(\"C\" &amp; i).Copy\n    Worksheets(\"Enveloppe\").Range(\"B6\").PasteSpecial Paste:=xlPasteValues\n    Worksheets(\"Info-Cas\").Range(\"D\" &amp; i).Copy\n    Worksheets(\"Enveloppe\").Range(\"B7\").PasteSpecial Paste:=xlPasteValues\n    Worksheets(\"Info-Cas\").Range(\"E\" &amp; i).Copy\n    Worksheets(\"Enveloppe\").Range(\"B8\").PasteSpecial Paste:=xlPasteValues\n\n    'Copier les informations sur l'horaire\n    Worksheets(\"Info-Cas\").Range(\"F\" &amp; i).Copy\n    Worksheets(\"Enveloppe\").Range(\"B10\").PasteSpecial Paste:=xlPasteValues\n    Worksheets(\"Info-Cas\").Range(\"G\" &amp; i).Copy\n    Worksheets(\"Enveloppe\").Range(\"B11\").PasteSpecial Paste:=xlPasteValues\n    Worksheets(\"Info-Cas\").Range(\"H\" &amp; i).Copy\n    Worksheets(\"Enveloppe\").Range(\"B12\").PasteSpecial Paste:=xlPasteValues\n    Worksheets(\"Info-Cas\").Range(\"I\" &amp; i).Copy\n    Worksheets(\"Enveloppe\").Range(\"B13\").PasteSpecial Paste:=xlPasteValues\n    Worksheets(\"Info-Cas\").Range(\"J\" &amp; i).Copy\n    Worksheets(\"Enveloppe\").Range(\"B14\").PasteSpecial Paste:=xlPasteValues\n\n\n    'Enregistrer le document au format PDF\n    Worksheets(\"Enveloppe\").Range(\"A1:I23\").ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        Filename:=FName\nNext\n</code></pre>\n\n<p>The problem I have is that, for the sample I tried, only the last PDF is saving right now.</p>\n\n<p>Also, I'd like to save the file in a certain folder on my computer. Can anyone help me doing those?</p>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9280134, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vMUu5NsacLM/AAAAAAAAAAI/AAAAAAAAAXg/eh2Ki0Zs9y0/photo.jpg?sz=128", "display_name": "HAMID ALGHURABI", "link": "https://stackoverflow.com/users/9280134/hamid-alghurabi"}, "edited": false, "score": 0, "creation_date": 1517954490, "post_id": 48652617, "comment_id": 84303416, "body": "Wow, that was very fast and on point! thank you very much...I am not that familiar with VB"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1517954087, "creation_date": 1517954087, "answer_id": 48652617, "question_id": 48652570, "link": "https://stackoverflow.com/questions/48652570/use-the-sum-of-two-text-box-values-as-a-parameter-for-select-top-statement-in-ac/48652617#48652617", "title": "Use the sum of two text box values as a parameter for select top statement in access", "body": "<p>That's because your text boxes contain strings. Cast them to numbers, and it will work fine:</p>\n\n<pre><code>strSQL=\"select TOP \" &amp; CLng([forms]![student_names].[txt_ibn_hayyan])+CLng([forms]![student_names].[txt_ibn_sina]) &amp; \" * \" _\n&amp; \"FROM sometable\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9280134, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vMUu5NsacLM/AAAAAAAAAAI/AAAAAAAAAXg/eh2Ki0Zs9y0/photo.jpg?sz=128", "display_name": "HAMID ALGHURABI", "link": "https://stackoverflow.com/users/9280134/hamid-alghurabi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 48652617, "answer_count": 1, "score": 0, "last_activity_date": 1594637751, "creation_date": 1517953907, "last_edit_date": 1594637751, "question_id": 48652570, "link": "https://stackoverflow.com/questions/48652570/use-the-sum-of-two-text-box-values-as-a-parameter-for-select-top-statement-in-ac", "title": "Use the sum of two text box values as a parameter for select top statement in access", "body": "<p>I need help with this SQL line...I have two text box named [txt_ibn_hayyan] and [txt_ibn_sina] in a form named [student_names].\nWhat I want to do is to use the sum of these text box values as a parameter for a select top N statement as shown in the code VB code below:</p>\n\n<pre><code>strSQL=\"select TOP \"&amp; [forms]![student_names].[txt_ibn_hayyan]+[forms]![student_names].[txt_ibn_sina]&amp; \" * \" _\n&amp; \"FROM sometable\n</code></pre>\n\n<p>what happens here that when the values of the two text  box are 4 and 3 for example, the resulted parameter will be 43 instead of 7 (which is what I want).\nIs there a way to sum the value of these two text box instead of joining them as a text? </p>\n"}, {"tags": ["vba", "email", "exchange-server", "outlook-2016"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1517953998, "post_id": 48652444, "comment_id": 84303187, "body": "Pointer: need macro in <b><code>ThisOutlookSession</code></b> with <code>Application_ItemSend</code> event. Depending on format of that message line, you can <b>Replace</b> it with <code>&quot;&quot;</code> in message&#39;s <code>.Body</code> or <code>.HTMLBody</code>."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1517954545, "post_id": 48652444, "comment_id": 84303437, "body": "Hint: Use the macro recorder if you need a push in the right direction. Then come back with specific code when you run into a specific problem. You&#39;ll get loads of help then. Oh, and welcome to the Ugly-Red-External-Email-Message club"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9229984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e236f80b8f8a3f34e4f22b752977a9?s=128&d=identicon&r=PG&f=1", "display_name": "tawm", "link": "https://stackoverflow.com/users/9229984/tawm"}, "edited": false, "score": 0, "creation_date": 1523124347, "post_id": 48673323, "comment_id": 86434260, "body": "This worked! Thanks! I understand the second line but the first is a mystery (after opening the private sub)"}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 2, "last_activity_date": 1518037926, "creation_date": 1518037926, "answer_id": 48673323, "question_id": 48652444, "link": "https://stackoverflow.com/questions/48652444/automatically-remove-warning-in-email-body/48673323#48673323", "title": "Automatically Remove Warning in Email Body", "body": "<p>In the ThisOutlookSession module.</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n\n     Item.HTMLBody = Replace(Item.HTMLBody, \"Caution - External Email\", \"\")\n\nEnd Sub\n</code></pre>\n\n<p>The Dim statement is not needed when using \"Application\". This is simpler than the way described in Microsoft documentation. If you needed it, it would be outside of the Sub at the top of the module.</p>\n"}], "owner": {"reputation": 33, "user_id": 9229984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e236f80b8f8a3f34e4f22b752977a9?s=128&d=identicon&r=PG&f=1", "display_name": "tawm", "link": "https://stackoverflow.com/users/9229984/tawm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4221, "favorite_count": 1, "accepted_answer_id": 48673323, "answer_count": 1, "score": 1, "last_activity_date": 1518037926, "creation_date": 1517953329, "last_edit_date": 1518036502, "question_id": 48652444, "link": "https://stackoverflow.com/questions/48652444/automatically-remove-warning-in-email-body", "title": "Automatically Remove Warning in Email Body", "body": "<p>Our Corporate Exchange admin decided to protect users from phishing by adding a bold red warning in the body of every incoming external email, just in case it might be a phishing attempt. bc MOST of my email is external, this has become obnoxious. I also very often need to manually remove the warning before forwarding or replying email (so as to not alarm the less-savvy recipient). Our corporate admin is not sympathetic to my plight. So, I am looking for a way to automate removing the warning, when email arrive or alternatively when I reply/forward the email. I have played with VB a bit but don\u2019t know enough to write the appropriate code. Any help would be greatly thanked! Using OL 2016 on Windows 10 and warning is in body of message (not subject line)</p>\n\n<p>Edit: Unfortunately OL does not allow macro recording like other office applications. So, I looked at some tutorials that helped but did not explain enough to bring success. I came up with this code but get \"Compile error: Invalid attribute in Sub or Function\" with the Dim statement highlighted:</p>\n\n<p><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n Dim WithEvents myOLMail As Outlook.MailItem\n Replace(myOLMail, \"Caution - External Email\", \"\") As String\n End Sub</code></p>\n\n<p>It is obvious I need more basic understanding. I read through <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736(v=office.14).aspx\" rel=\"nofollow noreferrer\">Getting Started with VBA in Outlook 2010</a> but need more. Any help or resources would be awesome. I have been wanting to learn VB for some time.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1517951568, "post_id": 48652025, "comment_id": 84302011, "body": "put in <code>Exit Sub</code> before the <code>End If</code>"}, {"owner": {"reputation": 162, "user_id": 8774443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34968cf2f584e23f5fe4f1ce0a6e9d68?s=128&d=identicon&r=PG&f=1", "display_name": "Ziggus", "link": "https://stackoverflow.com/users/8774443/ziggus"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1517953060, "post_id": 48652025, "comment_id": 84302739, "body": "This worked perfectly thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "is_accepted": true, "score": 1, "last_activity_date": 1517953080, "creation_date": 1517953080, "answer_id": 48652376, "question_id": 48652025, "link": "https://stackoverflow.com/questions/48652025/vba-excel-running-macro-based-on-multiple-criteria/48652376#48652376", "title": "VBA Excel running macro based on multiple criteria", "body": "<p>Like the comment above you will just need to add the <code>Exit Sub</code> to your <code>If</code> statement like this:</p>\n\n<pre><code>Sub EmailFRSErrors()\n    Dim SrchRng As Range, cel As Range\n    Set SrchRng = Range(\"A2:A5000\")\n\n    For Each cel In SrchRng\n        If InStr(1, cel.Value, \"22\") &gt; 0 Or InStr(1, cel.Value, \"26\") &gt; 0 Or InStr (1, cel.Value, \"44\") &gt; 0 Or InStr(1, cel.Value, \"46\") &gt; 0 Then\n            OpenOutlookEmail\n            Exit Sub 'This will exit the sub after sending only one email instead of continuing and potentially sending multiple\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 162, "user_id": 8774443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34968cf2f584e23f5fe4f1ce0a6e9d68?s=128&d=identicon&r=PG&f=1", "display_name": "Ziggus", "link": "https://stackoverflow.com/users/8774443/ziggus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 48652376, "answer_count": 1, "score": 0, "last_activity_date": 1593072872, "creation_date": 1517951490, "last_edit_date": 1593072872, "question_id": 48652025, "link": "https://stackoverflow.com/questions/48652025/vba-excel-running-macro-based-on-multiple-criteria", "title": "VBA Excel running macro based on multiple criteria", "body": "<p>I am attempting to automate an error report. I am sending an email with the results if one of the 4 conditions are true. Here is the code so far:</p>\n\n<pre><code>Sub EmailFRSErrors()\nDim SrchRng As Range, cel As Range\nSet SrchRng = Range(\"A2:A5000\")\n\nFor Each cel In SrchRng\n If InStr(1, cel.Value, \"22\") &gt; 0 Or InStr(1, cel.Value, \"26\") &gt; 0 Or InStr (1, cel.Value, \"44\") &gt; 0 Or InStr(1, cel.Value, \"46\") &gt; 0 Then\n OpenOutlookEmail\nEnd If\nNext\nEnd Sub\n</code></pre>\n\n<p>My issue is, if there are more than two errors it runs the OpenOutlookEmail macro once for each error. I want it to run once whether there is 1 error or 10. The macro it is running is going to copy the range and paste all the errors into outlook and send them off. I only need 1 email sent with all errors.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 2, "creation_date": 1517950954, "post_id": 48651752, "comment_id": 84301724, "body": "use intersect :<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-intersect-method-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a> <code>If Not Application.Intersect(Target, Range(&quot;E14:E100&quot;)) Is Nothing Then dO YOUR STUFF End If</code>"}], "answers": [{"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 1, "last_activity_date": 1517951200, "creation_date": 1517951200, "answer_id": 48651965, "question_id": 48651752, "link": "https://stackoverflow.com/questions/48651752/vba-limit-text-length-excel/48651965#48651965", "title": "VBA Limit Text Length Excel", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim cell As Range\nDim testRange As Range\n\nSet testRange = Range(\"e14:e1000\")\n\nIf Not Intersect(Target, testRange) Is Nothing Then\n    Application.EnableEvents = False\n\n    For Each cell In Intersect(Target, testRange)\n    If Len(cell) &gt; 10 Then\n        MsgBox \"Text length in cell \"\"\" &amp; cell.Address(0, 0) &amp; \"\"\" is more than 10.\", vbExclamation\n        Application.Undo\n        Exit For\n    End If\n    Next cell\n\nApplication.EnableEvents = True\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 7885268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd5321500837661a0acfab6a34794919?s=128&d=identicon&r=PG&f=1", "display_name": "MSauce", "link": "https://stackoverflow.com/users/7885268/msauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 630, "favorite_count": 0, "accepted_answer_id": 48651965, "answer_count": 1, "score": 0, "last_activity_date": 1517994209, "creation_date": 1517950281, "last_edit_date": 1517994209, "question_id": 48651752, "link": "https://stackoverflow.com/questions/48651752/vba-limit-text-length-excel", "title": "VBA Limit Text Length Excel", "body": "<p>I had a follow up question to a question I had a few hours ago, but haven't gotten a reply back. So here I am.</p>\n\n<p>The code below, how can I make it so that it only applies to a column? More specifically, E14:E1000. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim cell As Range\n    For Each cell In Target\n        If Len(cell) &gt; 10 Then\n            MsgBox \"Text length in cell \"\"\" &amp; cell.Address(0, 0) &amp; \"\"\" is more than 10.\", vbExclamation\n            Application.Undo\n            Exit For\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517951756, "post_id": 48651475, "comment_id": 84302112, "body": "For the record (pun not intended), that condition could be simplified to <code>Me.chxField2.Enabled = Me.Field1</code>"}, {"owner": {"reputation": 411, "user_id": 4691343, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/82436a10fd2462bbf8918b594c511a75?s=128&d=identicon&r=PG&f=1", "display_name": "arsarc", "link": "https://stackoverflow.com/users/4691343/arsarc"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517955852, "post_id": 48651475, "comment_id": 84303981, "body": "@Mat&#39;sMug oh nice! I&#39;ll make sure to use it like that in the future. Thank you."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517957194, "post_id": 48651475, "comment_id": 84304477, "body": "No problem! Note that this is one of the 50+ code inspections implemented in <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a>, an OSS project I manage."}], "answers": [{"comments": [{"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1517952490, "post_id": 48651812, "comment_id": 84302491, "body": "Have a look at the approach suggested in this thread: <a href=\"https://stackoverflow.com/questions/606976/disable-check-box-based-on-other-values\">Disable Check Box Based on Other Values</a>"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1517950566, "creation_date": 1517950566, "answer_id": 48651812, "question_id": 48651475, "link": "https://stackoverflow.com/questions/48651475/enabling-only-one-checkbox-in-a-row-in-access-multiple-item-form/48651812#48651812", "title": "Enabling only one checkbox in a row in Access Multiple Item Form", "body": "<p>Unfortunately, it's not (as far as I know).</p>\n\n<p>On a continuous form, there's actually only one instance of each control. This means that you can't have one of those Field2 checkboxes enabled, and another disabled.</p>\n\n<p>Things you can do:</p>\n\n<p>Use the Checkbox_BeforeUpdate event to check if Field1 is checkded. If it isn't checked, then rollback the change:</p>\n\n<pre><code>Private Sub Field2_BeforeUpdate(Cancel As Integer)\n    Cancel = Not Field1\nEnd Sub\n</code></pre>\n\n<p>Also, if you weren't using a checkbox, you would be able to use conditional formatting to give the control a \"disabled look\". Unfortunatlely, conditional formatting doesn't apply to checkboxes.</p>\n"}], "owner": {"reputation": 411, "user_id": 4691343, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/82436a10fd2462bbf8918b594c511a75?s=128&d=identicon&r=PG&f=1", "display_name": "arsarc", "link": "https://stackoverflow.com/users/4691343/arsarc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 0, "accepted_answer_id": 48651812, "answer_count": 1, "score": 1, "last_activity_date": 1517955960, "creation_date": 1517949071, "last_edit_date": 1517955960, "question_id": 48651475, "link": "https://stackoverflow.com/questions/48651475/enabling-only-one-checkbox-in-a-row-in-access-multiple-item-form", "title": "Enabling only one checkbox in a row in Access Multiple Item Form", "body": "<p>I have a multiple item form, where most of the checkboxes are disabled unless the user checks the box before it.</p>\n\n<p>Currently I'm using:</p>\n\n<pre><code>If Me.Field1 Then\n    Me.chxField2.Enabled = True\nElse\n    Me.chxField2.Enabled = False\nEnd If\n</code></pre>\n\n<p>But if I check the box, it enables the Field2 checkbox for all of them, I only want it to enable the checkbox for one particular row.</p>\n\n<p><a href=\"https://i.stack.imgur.com/f4enR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f4enR.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/sqjm3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sqjm3.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is this possible to do? If it isn't, that's ok but I just had to ask.</p>\n\n<p><strong>Edit</strong>: Thanks to Erik I did this in the BeforeUpdate like he described, and it gives the effect I wanted:</p>\n\n<pre><code>Private Sub chxField2_BeforeUpdate(Cancel As Integer)\n    Cancel = Not Field1\n    chxField2.Undo\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "stored-procedures", "input-parameters"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517951458, "post_id": 48651392, "comment_id": 84301946, "body": "You&#39;re <code>Set</code>-ing the exact same object reference twice: <code>Set rst1 = New ADODB.Recordset</code> is redundant and can be removed."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517951642, "post_id": 48651392, "comment_id": 84302052, "body": "Is there not an actual opened connection somewhere? Which specific line is throwing the error?"}, {"owner": {"reputation": 21, "user_id": 4401522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a8de673613e320f96ac9aa42c26efde?s=128&d=identicon&r=PG&f=1", "display_name": "ABCD", "link": "https://stackoverflow.com/users/4401522/abcd"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517951751, "post_id": 48651392, "comment_id": 84302108, "body": "removed it. Same error."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517951859, "post_id": 48651392, "comment_id": 84302178, "body": "I know, I was just saying it&#39;s redundant. Do you have an <code>ADODB.Connection</code> object that you <code>.Open</code> anywhere? I&#39;ve never used a <code>ADODB.Recordset</code> without an explicit <code>ADODB.Connection</code>... also try removing the <code>@</code> from the parameter names, and make sure the parameters are supplied in the exact same order as the SP is expecting them."}, {"owner": {"reputation": 21, "user_id": 4401522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a8de673613e320f96ac9aa42c26efde?s=128&d=identicon&r=PG&f=1", "display_name": "ABCD", "link": "https://stackoverflow.com/users/4401522/abcd"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517951937, "post_id": 48651392, "comment_id": 84302223, "body": "I have a connection object created and the command object executes with the help of the connection. Error is on the cmd1.execute statement. the connection is open and is working well as I have another stored procedures without parameters which are working well."}, {"owner": {"reputation": 21, "user_id": 4401522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a8de673613e320f96ac9aa42c26efde?s=128&d=identicon&r=PG&f=1", "display_name": "ABCD", "link": "https://stackoverflow.com/users/4401522/abcd"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517952054, "post_id": 48651392, "comment_id": 84302282, "body": "removed &#39;@&#39; and still got the same error."}, {"owner": {"reputation": 21, "user_id": 4401522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a8de673613e320f96ac9aa42c26efde?s=128&d=identicon&r=PG&f=1", "display_name": "ABCD", "link": "https://stackoverflow.com/users/4401522/abcd"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517952074, "post_id": 48651392, "comment_id": 84302291, "body": "The order is the same"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517952085, "post_id": 48651392, "comment_id": 84302301, "body": "try <code>Set .ActiveConnection = yourConnectionObject</code>, and if that still doesn&#39;t work then have this code written in a class module (a worksheet&#39;s code-behind can do), declare the connection <code>WithEvents</code> and handle its &quot;on error&quot; (not sure of the name) event to output the actual error message."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517952197, "post_id": 48651392, "comment_id": 84302363, "body": "A quick Google search with &quot;ADODB -2147217900 (80040e14)&quot; seems to point to a syntax error. Verify the stored procedure works."}, {"owner": {"reputation": 21, "user_id": 4401522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a8de673613e320f96ac9aa42c26efde?s=128&d=identicon&r=PG&f=1", "display_name": "ABCD", "link": "https://stackoverflow.com/users/4401522/abcd"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517952395, "post_id": 48651392, "comment_id": 84302452, "body": "stored procedure works on dry run. tried passing the values by copying from the quick watch feature and it did run well in sql"}, {"owner": {"reputation": 21, "user_id": 4401522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a8de673613e320f96ac9aa42c26efde?s=128&d=identicon&r=PG&f=1", "display_name": "ABCD", "link": "https://stackoverflow.com/users/4401522/abcd"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517952548, "post_id": 48651392, "comment_id": 84302521, "body": "datetime = DateSerial(2018, 2, 5) + TimeSerial(18, 0, 0) is one of the parameters to the sp. Can this be a problem ? the datatype for all the parameters in sql is varchar expect one which is datetime. can datatype on excel side be a problem?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517952581, "post_id": 48651392, "comment_id": 84302538, "body": "well <code>adVariant</code> isn&#39;t <code>adVarChar</code>, for one"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517952639, "post_id": 48651392, "comment_id": 84302562, "body": "See <a href=\"https://stackoverflow.com/a/41837692/1188513\">this post</a> for how you can listen to the messages your connection is sending. The event you want to handle is <code>InfoMessage</code>."}, {"owner": {"reputation": 21, "user_id": 4401522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a8de673613e320f96ac9aa42c26efde?s=128&d=identicon&r=PG&f=1", "display_name": "ABCD", "link": "https://stackoverflow.com/users/4401522/abcd"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517952732, "post_id": 48651392, "comment_id": 84302597, "body": "on changing it to adVarChar, it gives me run-time error 3708 application defined or object defined error."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517952801, "post_id": 48651392, "comment_id": 84302623, "body": "Great! Progress! You need to handle the connection&#39;s <code>InfoMessage</code> event if you want to retrieve an actually helpful error message."}, {"owner": {"reputation": 21, "user_id": 4401522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a8de673613e320f96ac9aa42c26efde?s=128&d=identicon&r=PG&f=1", "display_name": "ABCD", "link": "https://stackoverflow.com/users/4401522/abcd"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517952885, "post_id": 48651392, "comment_id": 84302654, "body": "tell me how to do it. I am very new to vba. Any leads?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517952900, "post_id": 48651392, "comment_id": 84302664, "body": "I just gave you a link, &quot;see [this post]&quot;..."}, {"owner": {"reputation": 21, "user_id": 4401522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a8de673613e320f96ac9aa42c26efde?s=128&d=identicon&r=PG&f=1", "display_name": "ABCD", "link": "https://stackoverflow.com/users/4401522/abcd"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517953539, "post_id": 48651392, "comment_id": 84302984, "body": "Can you show me with an example. Please help. Can you show me with my code?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1517953625, "post_id": 48651392, "comment_id": 84303018, "body": "You&#39;re going to have to try a bit harder than that... SO is Q&amp;A, not &quot;hold my hand until it works&quot; ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517951419, "post_id": 48651677, "comment_id": 84301930, "body": "Given <code>.CommandType = adCmdStoredProc</code>, I doubt this would be it. Changing <code>.CommandType</code> to <code>adCmdText</code> as well, could work though."}, {"owner": {"reputation": 21, "user_id": 4401522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a8de673613e320f96ac9aa42c26efde?s=128&d=identicon&r=PG&f=1", "display_name": "ABCD", "link": "https://stackoverflow.com/users/4401522/abcd"}, "edited": false, "score": 0, "creation_date": 1517951688, "post_id": 48651677, "comment_id": 84302074, "body": "I have another stored procedures not accepting any parameters and it works as the code above perfectly. Im sensing that the datatype or the datetime parameter is an issue."}], "tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": false, "score": 0, "last_activity_date": 1517951348, "last_edit_date": 1517951348, "creation_date": 1517949929, "answer_id": 48651677, "question_id": 48651392, "link": "https://stackoverflow.com/questions/48651392/excel-vba-sql-stored-procedure-calling-with-input-parameters/48651677#48651677", "title": "Excel vba SQL Stored procedure calling with input parameters", "body": "<p>Try using <code>EXEC</code>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>.CommandText = \"exec spGetPriceChangeTest\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 4401522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a8de673613e320f96ac9aa42c26efde?s=128&d=identicon&r=PG&f=1", "display_name": "ABCD", "link": "https://stackoverflow.com/users/4401522/abcd"}, "is_accepted": true, "score": 1, "last_activity_date": 1517955379, "creation_date": 1517955379, "answer_id": 48652874, "question_id": 48651392, "link": "https://stackoverflow.com/questions/48651392/excel-vba-sql-stored-procedure-calling-with-input-parameters/48652874#48652874", "title": "Excel vba SQL Stored procedure calling with input parameters", "body": "<p>When creating a parameter, ensure that the size defined in SQL is mentioned in the .CreateParameter(\"\",adVarchar,<strong><em>10</em></strong>,value)</p>\n\n<p>This post helped. It talks about how we can capture an error in detail.</p>\n\n<p><a href=\"https://support.microsoft.com/en-us/help/167957/info-extracting-error-information-from-ado-in-vb\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/167957/info-extracting-error-information-from-ado-in-vb</a></p>\n"}], "owner": {"reputation": 21, "user_id": 4401522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a8de673613e320f96ac9aa42c26efde?s=128&d=identicon&r=PG&f=1", "display_name": "ABCD", "link": "https://stackoverflow.com/users/4401522/abcd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1646, "favorite_count": 0, "accepted_answer_id": 48652874, "answer_count": 2, "score": 0, "last_activity_date": 1517955379, "creation_date": 1517948723, "last_edit_date": 1517951342, "question_id": 48651392, "link": "https://stackoverflow.com/questions/48651392/excel-vba-sql-stored-procedure-calling-with-input-parameters", "title": "Excel vba SQL Stored procedure calling with input parameters", "body": "<p>Thank you in advance. I am trying to run a stored procedure from excel which accepts input parameters and it is giving error Run-time error '-2147217900 (80040e14)' automation error. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>   Set cmd1 = New ADODB.Command\n             With cmd1\n             .ActiveConnection = sConnString\n             .CommandText = \"spGetPriceChangeTest\"\n             .CommandType = adCmdStoredProc\n             .CommandTimeout = 360\n             .Parameters.Append .CreateParameter(\"@suppliercode\", adVariant, adParamInput, , Range(\"A\" &amp; (x + 2)).Value)\n             .Parameters.Append .CreateParameter(\"@date1\", adDBTimeStamp, adParamInput, , datetime)\n             .Parameters.Append .CreateParameter(\"@proddescription\", adVariant, adParamInput, , Range(\"D\" &amp; (x + 1)).Value)\n             .Parameters.Append .CreateParameter(\"@vendorcode\", adVariant, adParamInput, , Range(\"C\" &amp; (x + 2)).Value)\n             .Parameters.Append .CreateParameter(\"@type\", adVariant, adParamInput, , Range(\"B\" &amp; (x + 2)).Value)\n             End With\n             Set rst1 = New ADODB.Recordset\n             Set rst1 = cmd1.Execute\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 0, "creation_date": 1517949442, "post_id": 48651304, "comment_id": 84301087, "body": "You need to find the <code>LastRow = ActiveSheet.Cells(ActiveSheet.Rows.count, ActiveColumn).End(xlUp).row</code> Then if you subtract the first 16 from that it will be the number of rows."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1517956154, "post_id": 48651304, "comment_id": 84304106, "body": "I wish I understood your needs. Could you be more descriptive?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9324008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57624a1b21a4c5346840a231f6767e6f?s=128&d=identicon&r=PG&f=1", "display_name": "SDenison", "link": "https://stackoverflow.com/users/9324008/sdenison"}, "edited": false, "score": 0, "creation_date": 1518022518, "post_id": 48651928, "comment_id": 84336274, "body": "This is helpful. I can see where it is going. However, I don&#39;t want to go all the way to the last row of the sheet. I want to go down to the last non-blank cell in that column and then with the next batch of data I pull, I want to skip down to the next non-blank cell and grab that starting cell down to the next non-blank cell and so on."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 0, "last_activity_date": 1518025563, "last_edit_date": 1592644375, "creation_date": 1517951004, "answer_id": 48651928, "question_id": 48651304, "link": "https://stackoverflow.com/questions/48651304/excel-vba-rows-count-reference-for-a-loop/48651928#48651928", "title": "Excel VBA Rows.Count reference for a loop", "body": "<p>Your explanation as to <em>why</em> you are trying to do this makes it appear you are placing more work on yourself than you need to.</p>\n<p>Let's create a couple functions.</p>\n<p>The first function we will call <code>nextBlankCell</code>, which will automatically grab the last cell before an empty range. In your case, we can even use your selection to determine this - which we will do in our next function.</p>\n<h2>nextBlankCell Function</h2>\n<pre><code>Function nextBlankCell(ByVal startRng As Range) As Range\n    Set nextBlankCell = startRng.End(xlDown)\nEnd Function\n</code></pre>\n<p>Next, let's create a function that will automatically set your entire range for you. In this case, it will be the range from your current selection to the last row containing data that we get from using the above function.</p>\n<h2>getRngDownwards Function</h2>\n<pre><code>Function getRngDownwards() As Range\n\n    Dim celStart As Range, celEnd As Range, ws As Worksheet\n    Set celStart = Selection\n    Set ws = celStart.Parent\n    Set celEnd = nextBlankCell(celStart)\n    Set getRngDownwards = ws.Range(celStart, celEnd)\n\nEnd Function\n</code></pre>\n<p>In the above function, we have two ranges <code>celStart</code> and <code>celEnd</code>. <code>celStart</code> is simply your current selection. I always prefer to immediately <strong>set</strong> your selection to a static range if you must use <code>Selection</code> <em>(most cases it\u2019s <strong>not</strong> necessary)</em>.</p>\n<p><code>celEnd</code> is the range that will contain the last used cell in your column.</p>\n<p>We also determine the worksheet <code>ws</code> by using the selection's parent object. <em>Protip: We avoided <code>ActiveSheet</code>!</em></p>\n<p>Now you can put it to the test:</p>\n<pre><code>Sub test()\n\n    ' This test shows you the address of the range\n    MsgBox getRngDownwards.Address\n\n    ' This test visually shows you the range\n    getRngDownwards.Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9324008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57624a1b21a4c5346840a231f6767e6f?s=128&d=identicon&r=PG&f=1", "display_name": "SDenison", "link": "https://stackoverflow.com/users/9324008/sdenison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 1, "accepted_answer_id": 48651928, "answer_count": 1, "score": 0, "last_activity_date": 1518025563, "creation_date": 1517948433, "last_edit_date": 1517951430, "question_id": 48651304, "link": "https://stackoverflow.com/questions/48651304/excel-vba-rows-count-reference-for-a-loop", "title": "Excel VBA Rows.Count reference for a loop", "body": "<p>I need to pull a range of data from a sheet where the top 16 rows will always be the same but the data below will vary. I can find the starting cell with this</p>\n\n<pre><code>Sheets(\"AA\").Next.Select\nRange(\"A17\").Select\nSelection.End(xlDown).Offset(2, 2).Select\n</code></pre>\n\n<p>and then I want to count the cells using (starting cell selected above) to end of cells containing data. I have tried this</p>\n\n<pre><code>Range(Selection, Range(Selection.End(xlDown)).Rows.Count\n</code></pre>\n\n<p>and all kinds of variations on it but cannot seem to make it work. I need to be able refer back to both the start cell and the number of rows to pull data from that cell down to the last cell using a loop (another topic I will probably ask questions on when I get that far)</p>\n\n<p>Can someone help?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 4, "last_activity_date": 1517949105, "last_edit_date": 1517949105, "creation_date": 1517948660, "answer_id": 48651373, "question_id": 48651210, "link": "https://stackoverflow.com/questions/48651210/multiple-checkboxes-show-multiple-colors-vba/48651373#48651373", "title": "Multiple checkboxes show multiple colors VBA", "body": "<p>Put this in the same module as the above code:</p>\n\n<pre><code>Sub colorCell()\nDim CB25 As Long\nDim CB26 As Long\nDim CB27 As Long\n\nCB25 = (ActiveSheet.CheckBoxes(\"Check Box 25\").Value = xlOn) * -1\nCB26 = (ActiveSheet.CheckBoxes(\"Check Box 26\").Value = xlOn) * -1\nCB27 = (ActiveSheet.CheckBoxes(\"Check Box 27\").Value = xlOn) * -1\n\nWith Worksheets(\"Sheet1\").Range(\"C18\").Interior\n    Select Case CB25 + CB26 + CB27\n        Case 1\n            .ColorIndex = 27\n        Case 2\n            .ColorIndex = 27 'Change to your color\n        Case 3\n            .ColorIndex = 27 'Change to your color\n        Case Else\n            .ColorIndex = 0\n    End Select\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Then in each event change to be like this one:</p>\n\n<pre><code>Sub CheckBox25_Click()\n    colorCell\nEnd Sub\n</code></pre>\n\n<p>Now, every time one changes it will do the count and change the color accordingly.</p>\n"}], "owner": {"reputation": 729, "user_id": 7673876, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c7e90895b2f01c5cb8df8e49a32ead2?s=128&d=identicon&r=PG&f=1", "display_name": "David Kris", "link": "https://stackoverflow.com/users/7673876/david-kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 48651373, "answer_count": 1, "score": 0, "last_activity_date": 1517949105, "creation_date": 1517947982, "question_id": 48651210, "link": "https://stackoverflow.com/questions/48651210/multiple-checkboxes-show-multiple-colors-vba", "title": "Multiple checkboxes show multiple colors VBA", "body": "<p>The code below shows three check boxes in vba, each of them (if checked) highlight a specific cell background in my workbook yellow. Is it possible so If one checkbox is checked the background will be yellow, if two are selected it will be orange and if three are selected it will be red. Also if none are selected there will be no fill for the background. I have the no fill and yellow part so far but I cant figure out how to add the other two colors. Anything helps, thanks.</p>\n\n<pre><code>Sub CheckBox25_Click()\n    With ActiveSheet.CheckBoxes(\"Check Box 25\")\n        If .Value = xlOn Then\n            Worksheets(\"Sheet1\").Range(\"C18\").Interior.ColorIndex = 27\n        Else: Worksheets(\"Sheet1\").Range(\"C18\").Interior.ColorIndex = 0\n        End If\n    End With\nEnd Sub\n\nSub CheckBox26_Click()\n    With ActiveSheet.CheckBoxes(\"Check Box 26\")\n        If .Value = xlOn Then\n            Worksheets(\"Sheet1\").Range(\"C18\").Interior.ColorIndex = 27\n        Else: Worksheets(\"Sheet1\").Range(\"C18\").Interior.ColorIndex = 0\n        End If\n    End With\nEnd Sub\n\nSub CheckBox27_Click()\n    With ActiveSheet.CheckBoxes(\"Check Box 27\")\n        If .Value = xlOn Then\n            Worksheets(\"Sheet1\").Range(\"C18\").Interior.ColorIndex = 27\n        Else: Worksheets(\"Sheet1\").Range(\"C18\").Interior.ColorIndex = 0\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "onedrive"], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 7889517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbabbb45e58afd3a6c7d7ee679d8eaf?s=128&d=identicon&r=PG&f=1", "display_name": "tsdn", "link": "https://stackoverflow.com/users/7889517/tsdn"}, "edited": false, "score": 0, "creation_date": 1517998083, "post_id": 48650965, "comment_id": 84319343, "body": "Thanks for your answer, Difster. If it&#39;s the location restriction, then why can the file be accessed manually by user, but not through automation? All my users&#39; laptops are the same domain-joined machines with the same image on them, and the remote users are always within the same small city. All user corporate accounts are on the same domain. Lastly, since yesterday, three users in the office reported the same problem, so now I am completely baffled by this :("}, {"owner": {"reputation": 3240, "user_id": 1463490, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5qId.png?s=128&g=1", "display_name": "Difster", "link": "https://stackoverflow.com/users/1463490/difster"}, "reply_to_user": {"reputation": 387, "user_id": 7889517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbabbb45e58afd3a6c7d7ee679d8eaf?s=128&d=identicon&r=PG&f=1", "display_name": "tsdn", "link": "https://stackoverflow.com/users/7889517/tsdn"}, "edited": false, "score": 0, "creation_date": 1518066427, "post_id": 48650965, "comment_id": 84353582, "body": "In that case, I don&#39;t have an answer. You should see if you can get any logging from OneDrive to see if you can discern something from them."}, {"owner": {"reputation": 387, "user_id": 7889517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbabbb45e58afd3a6c7d7ee679d8eaf?s=128&d=identicon&r=PG&f=1", "display_name": "tsdn", "link": "https://stackoverflow.com/users/7889517/tsdn"}, "edited": false, "score": 0, "creation_date": 1518086312, "post_id": 48650965, "comment_id": 84363896, "body": "So after some unpredictable behavior yesterday, I gave everyone &quot;Can Edit&quot; rights to the folder and the problem went away. This is a sub-optimal solution, but I can live with it until I find the cause or a better solution. Thanks again, Difster for your help!"}], "tags": [], "owner": {"reputation": 3240, "user_id": 1463490, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5qId.png?s=128&g=1", "display_name": "Difster", "link": "https://stackoverflow.com/users/1463490/difster"}, "is_accepted": false, "score": 0, "last_activity_date": 1517947069, "creation_date": 1517947069, "answer_id": 48650965, "question_id": 48650930, "link": "https://stackoverflow.com/questions/48650930/vba-macro-unable-to-access-file-on-onedrivefb-when-not-in-the-office/48650965#48650965", "title": "VBA macro, unable to access file on OneDriveFB when not in the office", "body": "<p>Your corporate OneDrive instance is location restricted. There's nothing Excel can do to overcome that. It's a security feature.</p>\n"}], "owner": {"reputation": 387, "user_id": 7889517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbabbb45e58afd3a6c7d7ee679d8eaf?s=128&d=identicon&r=PG&f=1", "display_name": "tsdn", "link": "https://stackoverflow.com/users/7889517/tsdn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517947069, "creation_date": 1517946939, "last_edit_date": 1531164843, "question_id": 48650930, "link": "https://stackoverflow.com/questions/48650930/vba-macro-unable-to-access-file-on-onedrivefb-when-not-in-the-office", "title": "VBA macro, unable to access file on OneDriveFB when not in the office", "body": "<p>My VBA macro has this line of code:</p>\n\n<pre><code>Workbooks.Open FileName:=\"https://&lt;MyOneDriveForBusinessFolder&gt;/&lt;MyFileName.xlsm&gt;\"\n</code></pre>\n\n<p>The whole macro works fine for users in the company office, but fails on the above line for users logging to corporate network from remote locations.\nThe folder is shared with entire security group, all users have \"Can View\" access level.\nAll users, including those for whom the code fails, are able to access the folder/file via browser.\nNot sure if this is of any importance, but as this is OneDrive for Business, I believe the file is encrypted.</p>\n\n<p>Can anyone advise please, why this is happening?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 0, "creation_date": 1517947030, "post_id": 48650868, "comment_id": 84299704, "body": "Maybe something like <code>destinationworksheet.ListObjects(&quot;tblPriorTable&quot;).value = sourceworksheet.ListObjects(&quot;Table1&quot;).value</code> might work?"}, {"owner": {"reputation": 2207, "user_id": 8357864, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4fe690b4dfe322a7c5b9d8ba23b3bd05?s=128&d=identicon&r=PG&f=1", "display_name": "LetEpsilonBeLessThanZero", "link": "https://stackoverflow.com/users/8357864/letepsilonbelessthanzero"}, "reply_to_user": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 1, "creation_date": 1517947215, "post_id": 48650868, "comment_id": 84299814, "body": "@Mike No such luck. Value isn&#39;t a property of ListObjects."}], "answers": [{"comments": [{"owner": {"reputation": 2207, "user_id": 8357864, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4fe690b4dfe322a7c5b9d8ba23b3bd05?s=128&d=identicon&r=PG&f=1", "display_name": "LetEpsilonBeLessThanZero", "link": "https://stackoverflow.com/users/8357864/letepsilonbelessthanzero"}, "edited": false, "score": 0, "creation_date": 1517949312, "post_id": 48651025, "comment_id": 84301011, "body": "Ah, actually this doesn&#39;t work, because it deletes one of my ListObjects. I start with two ListObjects called &quot;Table1&quot; and &quot;tblPriorTable&quot;. I need &quot;tblPriorTable&quot; to become the same as &quot;Table1&quot;. With your answer, I end up with &quot;tblPriorTable&quot; deleted and a completely new (third) table. This causes my other formulas in the workbook to break since tblPriorTable no longer exists."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 2207, "user_id": 8357864, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4fe690b4dfe322a7c5b9d8ba23b3bd05?s=128&d=identicon&r=PG&f=1", "display_name": "LetEpsilonBeLessThanZero", "link": "https://stackoverflow.com/users/8357864/letepsilonbelessthanzero"}, "edited": false, "score": 0, "creation_date": 1517952271, "post_id": 48651025, "comment_id": 84302389, "body": "@LetEpsilonBeLessThanZero  The only time I have seen the copy fail, is if I try to put the copied table in the same set of rows as the original."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1517955352, "last_edit_date": 1517955352, "creation_date": 1517947295, "answer_id": 48651025, "question_id": 48650868, "link": "https://stackoverflow.com/questions/48650868/how-to-set-a-listobject-equal-to-another-listobject/48651025#48651025", "title": "How to set a ListObject equal to another ListObject?", "body": "<p>The <code>ListObject</code> does not have a <code>.Copy</code> method, but a <code>Range</code> does:</p>\n\n<pre><code>Sub lksdhfs()\n    Dim r As Range\n    Set r = ActiveSheet.ListObjects(1).Range\n    r.Copy Range(\"g30\")\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/CkyFW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CkyFW.png\" alt=\"enter image description here\"></a></p>\n\n<p>NOTE:</p>\n\n<p>The copy produces another <code>ListObject</code>, not just a pile of cells.<br>Make sure the two tables do not overlap.</p>\n"}, {"tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": true, "score": 3, "last_activity_date": 1517997042, "creation_date": 1517997042, "answer_id": 48660648, "question_id": 48650868, "link": "https://stackoverflow.com/questions/48650868/how-to-set-a-listobject-equal-to-another-listobject/48660648#48660648", "title": "How to set a ListObject equal to another ListObject?", "body": "<p>You can use a procedure like this:</p>\n\n<pre><code>Sub Copy_Contents(FromTable As ListObject, ToTable As ListObject)\n\n    With ToTable\n        If Not .DataBodyRange Is Nothing Then\n            .DataBodyRange.ClearContents\n        End If\n\n        .Range(2, 1).Resize(FromTable.ListRows.Count, FromTable.ListColumns.Count).Value = FromTable.DataBodyRange.Value\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Note that it assumes your two listobjects have the same number of columns.</p>\n"}], "owner": {"reputation": 2207, "user_id": 8357864, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4fe690b4dfe322a7c5b9d8ba23b3bd05?s=128&d=identicon&r=PG&f=1", "display_name": "LetEpsilonBeLessThanZero", "link": "https://stackoverflow.com/users/8357864/letepsilonbelessthanzero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 578, "favorite_count": 0, "accepted_answer_id": 48660648, "answer_count": 2, "score": 0, "last_activity_date": 1517997042, "creation_date": 1517946736, "last_edit_date": 1531164843, "question_id": 48650868, "link": "https://stackoverflow.com/questions/48650868/how-to-set-a-listobject-equal-to-another-listobject", "title": "How to set a ListObject equal to another ListObject?", "body": "<p>I would like to set a ListObject to be an exact copy of another ListObject just like how you can set a range to be an exact copy of another range. Is this possible?</p>\n\n<p>I've tried the following but it did not work:</p>\n\n<pre><code>Set destinationWorksheet.ListObjects(\"tblPriorTable\") = sourceWorksheet.ListObjects(\"Table1\")\n</code></pre>\n\n<p>It is important that the \"tblPriorTable\" ListObject not be deleted, because I have formulas in my workbook which reference that ListObject and those formulas break when the ListObject gets deleted. I just want to essentially overwrite the contents of \"tblPriorTable\" to be equal to another ListObject without ever deleting \"tblPriorTable\".</p>\n"}]