[{"tags": ["excel", "vba", "input", "event-handling"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1567659623, "post_id": 57796807, "comment_id": 102029926, "body": "You could use a refedit control on a userform if the inputbox isn&#39;t working for you."}, {"owner": {"reputation": 434, "user_id": 8783311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe3948e7f0f1a9e258e7eaa9c94a665?s=128&d=identicon&r=PG&f=1", "display_name": "jblack", "link": "https://stackoverflow.com/users/8783311/jblack"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1567725232, "post_id": 57796807, "comment_id": 102059053, "body": "Creating a userform is an option, but I&#39;m more wondering whether this is an excel feature that worksheet events are disabled when specifically the built-in inputbox is active, or if there is something else that is the matter. And if it&#39;s not the default behaviour then how do I identify the issue"}], "answers": [{"comments": [{"owner": {"reputation": 434, "user_id": 8783311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe3948e7f0f1a9e258e7eaa9c94a665?s=128&d=identicon&r=PG&f=1", "display_name": "jblack", "link": "https://stackoverflow.com/users/8783311/jblack"}, "edited": false, "score": 0, "creation_date": 1567645259, "post_id": 57797084, "comment_id": 102027340, "body": "I would like the <code>Worksheet_SelectionChange</code> event to trigger before the user clicks on OK (before myRange is set, while the inputbox is still active), so that they can be sure it is the correct range they are selecting, and select elsewhere if it isn&#39;t what they wanted to select."}], "tags": [], "owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "is_accepted": false, "score": 0, "last_activity_date": 1567645172, "last_edit_date": 1567645172, "creation_date": 1567643936, "answer_id": 57797084, "question_id": 57796807, "link": "https://stackoverflow.com/questions/57796807/run-worksheet-selectionchange-event-while-inputbox-active/57797084#57797084", "title": "Run Worksheet_SelectionChange event while Inputbox active", "body": "<p>Add <code>myRange.Select</code> after you set myRange, which as</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set myRange = Application.InputBox(\"Select a range\", \"Range Selection\", Type:=8)\nmyRange.Select\n</code></pre>\n\n<p>That should trigger the <code>Worksheet_SelectionChange</code> event</p>\n"}], "owner": {"reputation": 434, "user_id": 8783311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe3948e7f0f1a9e258e7eaa9c94a665?s=128&d=identicon&r=PG&f=1", "display_name": "jblack", "link": "https://stackoverflow.com/users/8783311/jblack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567664591, "creation_date": 1567640807, "last_edit_date": 1567664591, "question_id": 57796807, "link": "https://stackoverflow.com/questions/57796807/run-worksheet-selectionchange-event-while-inputbox-active", "title": "Run Worksheet_SelectionChange event while Inputbox active", "body": "<p>I have an inputbox set up to ask a user to select a range. When selecting the range I would like the selection to automatically be resized to certain dimensions, so the user can see the new selection before clicking OK (before setting myRange).</p>\n\n<p>I have set up a Worksheet_SelectionChange event to handle resizing the selection. The problem is that the selectionChange event doesn't work while the inputbox is active.</p>\n\n<p>This is the code snippet that appears in my module:</p>\n\n<pre><code>InputboxActive=True   \n    Set myRange = Application.InputBox(\"Select a range\", \"Range Selection\", Type:=8)\nInputboxActive=False\n</code></pre>\n\n<p>This code appears in my worksheetChange sub:</p>\n\n<pre><code>if InputboxActive=True then Target.resize(5,10).select\n</code></pre>\n\n<p>The selectionChange event doesn't run while the inputbox is active. How do I fix this?</p>\n\n<p>Any assistance would be appreciated, thanks</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 12021872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9afcda1c35c10e60a85836ccd9b68bbd?s=128&d=identicon&r=PG&f=1", "display_name": "NeverBrave", "link": "https://stackoverflow.com/users/12021872/neverbrave"}, "edited": false, "score": 0, "creation_date": 1567643278, "post_id": 57796850, "comment_id": 102026983, "body": "You&#39;re right, my header was in row 1. This solution didn&#39;t work out unfortunately. There is still an override issue, its just in the second row instead of the first. The solution by @T4roy resolved my issue though. Thank you for your help."}], "tags": [], "owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "is_accepted": false, "score": 0, "last_activity_date": 1567641210, "creation_date": 1567641210, "answer_id": 57796850, "question_id": 57796512, "link": "https://stackoverflow.com/questions/57796512/how-to-paste-to-the-last-filled-row-without-including-first-row-headers/57796850#57796850", "title": "How to paste to the last filled row without including first row (headers)?", "body": "<p>Assuming your header is at row 1, can you add coding after this:</p>\n\n<p>lastrow = sht.Cells(sht.Rows.Count, 1).End(xlUp).Row</p>\n\n<p>If lastrow=1 then lastrow=2</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 12021872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9afcda1c35c10e60a85836ccd9b68bbd?s=128&d=identicon&r=PG&f=1", "display_name": "NeverBrave", "link": "https://stackoverflow.com/users/12021872/neverbrave"}, "edited": false, "score": 0, "creation_date": 1567643162, "post_id": 57796934, "comment_id": 102026960, "body": "This was spot on. I didn&#39;t think about how the &#39;nextrow&#39; function would snapshot the state of the sheet before pasting, so it would refer to the same line for both operations. I did as you suggested and it was accurate over several iterations. Thank you!"}, {"owner": {"reputation": 178, "user_id": 2046179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NKM4P.jpg?s=128&g=1", "display_name": "T4roy", "link": "https://stackoverflow.com/users/2046179/t4roy"}, "reply_to_user": {"reputation": 15, "user_id": 12021872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9afcda1c35c10e60a85836ccd9b68bbd?s=128&d=identicon&r=PG&f=1", "display_name": "NeverBrave", "link": "https://stackoverflow.com/users/12021872/neverbrave"}, "edited": false, "score": 0, "creation_date": 1567643369, "post_id": 57796934, "comment_id": 102026993, "body": "@NeverBrave no problem. FYI <b>nextrow</b> is a variable not a function, its value is stored and doesn&#39;t change until it is set again on the following iteration."}], "tags": [], "owner": {"reputation": 178, "user_id": 2046179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NKM4P.jpg?s=128&g=1", "display_name": "T4roy", "link": "https://stackoverflow.com/users/2046179/t4roy"}, "is_accepted": true, "score": 1, "last_activity_date": 1567642193, "creation_date": 1567642193, "answer_id": 57796934, "question_id": 57796512, "link": "https://stackoverflow.com/questions/57796512/how-to-paste-to-the-last-filled-row-without-including-first-row-headers/57796934#57796934", "title": "How to paste to the last filled row without including first row (headers)?", "body": "<p>I think you want to change the cell you are pasting to, you don't want to paste in <strong>lastrow</strong> it should be <strong>nextrow</strong>. </p>\n\n<p>You have;</p>\n\n<pre><code>Workbooks(\"zzmaster.xlsx\").Worksheets(\"Sheet1\").Cells(lastrow, 579).PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:=False, Transpose:=True\n</code></pre>\n\n<p>Change to;</p>\n\n<pre><code>Workbooks(\"zzmaster.xlsx\").Worksheets(\"Sheet1\").Cells(nextrow, 579).PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:=False, Transpose:=True\n</code></pre>\n\n<p>Looks like it wouldn't only be the first iteration of your loop but all of them. Try adding a breakpoint where you set <strong>lastrow</strong> and step through the execution to see where the issues arises, it will help to step through a few iterations of your loop and assess if it only happens once or not.</p>\n"}], "owner": {"reputation": 15, "user_id": 12021872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9afcda1c35c10e60a85836ccd9b68bbd?s=128&d=identicon&r=PG&f=1", "display_name": "NeverBrave", "link": "https://stackoverflow.com/users/12021872/neverbrave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 57796934, "answer_count": 2, "score": 0, "last_activity_date": 1567664616, "creation_date": 1567637932, "last_edit_date": 1567664616, "question_id": 57796512, "link": "https://stackoverflow.com/questions/57796512/how-to-paste-to-the-last-filled-row-without-including-first-row-headers", "title": "How to paste to the last filled row without including first row (headers)?", "body": "<p>I'm trying to paste data at the end of the last filled row in a sheet, but my syntax overwrites my headers in Row 1 during the first iteration of the loop.</p>\n\n<p>I'm running a looped code that copies and transposes variables from multiple spreadsheets on a single sheet. Variables are in two columns in the source files but go onto one row in the destination file. I use a \"next row\" function to place the data from the first column into the first empty row. I then want to use a \"last row\" function to append the data from the second column to the same row. However, during the first operation, my code doesn't know the difference between the first line of data and the variable names on the first row, so the second column data ends up shifted one row up from the first half of the data.</p>\n\n<pre><code>Dim lastrow As Long\nDim nextrow As Long\n\nSet sht = ThisWorkbook.Worksheets(\"Sheet1\")\n\nlastrow = sht.Cells(sht.Rows.Count, 1).End(xlUp).Row\nnextrow = sht.Cells(sht.Rows.Count, 1).End(xlUp).Row + 1\n    'assigns objects for the last filled row and the next unfilled row\n\n\nwb1.Worksheets(\"Database\").Range(\"B1:B578\").Copy\nWorkbooks(\"zzmaster.xlsx\").Worksheets(\"Sheet1\").Cells(nextrow, 1).PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:=False, Transpose:=True\nDoEvents\nApplication.CutCopyMode = False\n    'copies the relevant data from Column B in Sheet 3 of the source file...\n    'then transposes and pastes into the next available row of the destination file\n\n\nwb1.Worksheets(\"Database\").Range(\"C32:C578\").Copy\nWorkbooks(\"zzmaster.xlsx\").Worksheets(\"Sheet1\").Cells(lastrow, 579).PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:=False, Transpose:=True\nDoEvents\nApplication.CutCopyMode = False\n    'copies the relevant data from Column C in Sheet 3 of the source file...\n    'then tranposes and pastes into the same row as the previous function, beginning with...\n    'the next cell after the last data point\n</code></pre>\n\n<p>Is there a good way to adjust the syntax so that data does not paste to the first row of the spreadsheet? The goal is to have both columns from a source spreadsheet be pasted to the same row, and that each spreadsheet in the loop be pasted to the next empty row available. I appreciate any suggestions.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2956, "user_id": 2207924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d97be4271939adcd1eec201cd777f57?s=128&d=identicon&r=PG", "display_name": "JeffUK", "link": "https://stackoverflow.com/users/2207924/jeffuk"}, "edited": false, "score": 0, "creation_date": 1567637681, "post_id": 57796465, "comment_id": 102026003, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/26906689/excel-vba-getting-rid-of-error-1004-with-hide-and-unhide-macros-when-sheets-prot\">Excel VBA Getting rid of error 1004 With Hide and unhide Macros when sheets protected</a>"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1567637684, "post_id": 57796465, "comment_id": 102026004, "body": "<code>cel.EntireColumn.Hidden = True</code> should do it."}, {"owner": {"reputation": 35, "user_id": 4679489, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78480afdbae38a7f0c109b91dbc029b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rishabh Verma", "link": "https://stackoverflow.com/users/4679489/rishabh-verma"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1567637801, "post_id": 57796465, "comment_id": 102026018, "body": "@cybernetic.nomad Thank you :)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1567639976, "post_id": 57796465, "comment_id": 102026406, "body": "<code>cel.EntireColumn.Hidden = (cel.Value &lt; 0.75)</code> is a little more concise"}], "answers": [{"tags": [], "owner": {"reputation": 52, "user_id": 5713166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b9abaa7a86a5a57dff0e0a288bc34c?s=128&d=identicon&r=PG&f=1", "display_name": "TedZheng", "link": "https://stackoverflow.com/users/5713166/tedzheng"}, "is_accepted": false, "score": -1, "last_activity_date": 1567658131, "creation_date": 1567658131, "answer_id": 57798501, "question_id": 57796465, "link": "https://stackoverflow.com/questions/57796465/macro-to-hide-unhide-columns-in-excel-based-on-certain-cell-conditions/57798501#57798501", "title": "Macro to Hide Unhide columns in excel based on certain cell conditions", "body": "<p>Please try \"On Error resume next\" if you want to ignore the Error.</p>\n"}], "owner": {"reputation": 35, "user_id": 4679489, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78480afdbae38a7f0c109b91dbc029b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rishabh Verma", "link": "https://stackoverflow.com/users/4679489/rishabh-verma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567658131, "creation_date": 1567637499, "last_edit_date": 1567657486, "question_id": 57796465, "link": "https://stackoverflow.com/questions/57796465/macro-to-hide-unhide-columns-in-excel-based-on-certain-cell-conditions", "title": "Macro to Hide Unhide columns in excel based on certain cell conditions", "body": "<p>I want to hide a specific column based on value in a certain cell. For example, in my code I want to hide entire \"F\" column if cell value in F26 is less than 0.75. Likewise, hide \"G\" column if value in G26 is less than 0.75 and so on.</p>\n\n<pre><code>Sub HideColumn1()\n    Dim cel As Range\n    For Each cel In Range(\"F26:AB26\")\n        If cel.Value &lt; 0.75 Then\n            Columns(cel).EntireColumn.Hidden = True\n        Else\n            Columns(cel).EntireColumn.Hidden = False\n        End If\n    Next cel\nEnd Sub\n</code></pre>\n\n<p>Currently my code is giving me <code>1004 error</code> on line:</p>\n\n<pre><code>Columns(cel).EntireColumn.Hidden = True\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1567640131, "post_id": 57796206, "comment_id": 102026427, "body": "May the bigger question is why the data coming from Excel is different? Where do these non-ASCII characters get lost or replaced? You mighr also want to us ci_phrasematch operator instead of like: <a href=\"https://docs.microsoft.com/en-us/office/client-developer/outlook/pia/how-to-search-for-a-phrase-in-the-body-of-items-in-a-folder\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/client-developer/outlook/pia&zwnj;&#8203;/&hellip;</a>"}, {"owner": {"reputation": 79, "user_id": 8673378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c38e4adf0db133f5d760bcf28063642d?s=128&d=identicon&r=PG&f=1", "display_name": "rzenva", "link": "https://stackoverflow.com/users/8673378/rzenva"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1567641626, "post_id": 57796206, "comment_id": 102026686, "body": "Like I said, the data coming from Excel comes from a formula I built using the same parameters the emails&#39; subject will have. At simple view, my formula builds the subject exactly as the email subject - what I didn&#39;t forsee are non-ASCII characters coming from the subject."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1567643520, "post_id": 57796206, "comment_id": 102027023, "body": "Do try ci_phrasematch operator..."}, {"owner": {"reputation": 79, "user_id": 8673378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c38e4adf0db133f5d760bcf28063642d?s=128&d=identicon&r=PG&f=1", "display_name": "rzenva", "link": "https://stackoverflow.com/users/8673378/rzenva"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1567643700, "post_id": 57796206, "comment_id": 102027042, "body": "I will. I am still curious tho, I tried using wildcards between words \u201c%\u201d with Restrict but they didnt work. Do wildcards only work if they are at the end and beginning of the filter? What other way of searching can I use to search with wild cards and that will return email items with their meta data (receive date, etc) accesible?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1567659084, "post_id": 57796206, "comment_id": 102029795, "body": "Yes, MAPI only allows prefix or substring search, so it can only be &quot;%string&quot; or &quot;%string%&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 1, "last_activity_date": 1601768493, "creation_date": 1601768493, "answer_id": 64189948, "question_id": 57796206, "link": "https://stackoverflow.com/questions/57796206/search-email-via-restrict/64189948#64189948", "title": "Search email via Restrict", "body": "<p>Replace any non-breaking space with a normal space.</p>\n<pre><code>Private Sub replace_nbsp()\n\n    Dim strIn As String\n    Dim Result As String\n    \n    strIn = &quot;a&quot; &amp; Chr(160) &amp; &quot;b&quot;\n    Debug.Print &quot;strIn.:&quot; &amp; strIn\n        \n    ' replace nbsp with space\n    Result = Replace(strIn, Chr(160), &quot; &quot;)\n    \n    Debug.Print &quot;Result:&quot; &amp; Result\n\nEnd Sub\n</code></pre>\n<p><a href=\"https://stackoverflow.com/questions/26962323/what-is-this-insane-space-character-google-chrome\">What is this INSANE space character??? (google chrome)</a></p>\n"}], "owner": {"reputation": 79, "user_id": 8673378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c38e4adf0db133f5d760bcf28063642d?s=128&d=identicon&r=PG&f=1", "display_name": "rzenva", "link": "https://stackoverflow.com/users/8673378/rzenva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1601768493, "creation_date": 1567634910, "last_edit_date": 1601447107, "question_id": 57796206, "link": "https://stackoverflow.com/questions/57796206/search-email-via-restrict", "title": "Search email via Restrict", "body": "<p>I need to search some emails by specific subjects in a folder and reply to them via Excel VBA.</p>\n<p>I found Restrict via DASL query. I search emails by the exact string I know they will have.</p>\n<p>My idea was to have a function iterate through a range in a sheet that will have the exact mail subject (built using a formula) and the string to reply with.</p>\n<p>The code I have can find a match IF I copy paste the subject from Outlook but when I use the subject built from my formula it can't find a match.</p>\n<p><strong>subject1</strong> is copy pasted from Outlook. I find one match.</p>\n<p><strong>subject2</strong> is built from my formula. I can't find a match.</p>\n<p>Further testing led me to find a couple of non-ascii characters (unicode #160). How can I add % between each filter to ignore &quot; &quot; between words and not have to deal with non-ascii characters? I suppose I could modify my formula to include them but I can't ascertain there won't be other non-ascii characters there.</p>\n<pre><code>Sub RespondTassks()\n\nDim olApp As Outlook.Application\nDim olNS As Namespace\nDim Fldr As MAPIFolder\nDim olFldr As MAPIFolder\nDim olMail As Outlook.MailItem\nDim replyall As Outlook.MailItem\nDim emailItems As Outlook.items\nDim Filter As String\nDim subject As String\n\nSet olApp = New Outlook.Application\nSet olNS = olApp.GetNamespace(&quot;MAPI&quot;)\nSet Fldr = olNS.GetDefaultFolder(olFolderInbox)\nSet olFldr = Fldr.Folders(&quot;SchedulingCA&quot;)\n\nsubject1 = &quot;[Task/SCH] Validacion Final Cancelacion\u00a0orden 612666\u00a0del DF6548100 \u00a0- ID#1935&quot;\nsubject2 = &quot;[Task/SCH] Validacion Final Cancelacion orden 612666 del DF6548100  - ID#1935&quot;\n\nFilter1 = &quot;@SQL=&quot; &amp; Chr(34) &amp; &quot;urn:schemas:httpmail:subject&quot; &amp; _\n                    Chr(34) &amp; &quot;Like '%&quot; &amp; subject1 &amp; &quot;%'&quot;\n\nFilter2 = &quot;@SQL=&quot; &amp; Chr(34) &amp; &quot;urn:schemas:httpmail:subject&quot; &amp; _\n                    Chr(34) &amp; &quot; Like '%&quot; &amp; subject2 &amp; &quot;%'&quot;\n\nSet emailItems = olFldr.items.Restrict(Filter1)\n    \nIf emailItems.Count = 0 Then\n    'RespondTasks = &quot;No task mail found.&quot;\n    Exit Sub\nElse\n    If emailItems.Count &gt; 1 Then\n        'RespondTasks = &quot;Multiple task mails found&quot;\n    End If\nEnd If\n\nFor i = emailItems.Count To 1 Step -1\n    DoEvents\n    \n    If TypeOf emailItems(i) Is MailItem Then\n        Set olMail = emailItems(i)\n        Debug.Print olMail.subject &amp; &quot; &quot; &amp; olMail.ReceivedTime\n        \n        Set replyall = olMail.replyall\n        \n        With replyall\n            .HTMLBody = replyText\n            .Display\n        End With\n        \n        'RespondTasks = &quot;Reply sent&quot;\n        \n    End If\nNext i\n\nEnd Sub\n</code></pre>\n<p>I need to deal with one email per subject, if there are more than one I need to give the user a message that there were multiple matches found.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1567635352, "post_id": 57796200, "comment_id": 102025508, "body": "I&#39;m sure the levels are not called 1, 2, 3, 4. Can you use an example with a level hierarchy naming that more closely resembles the real thing? Is level 2 always the same text? Also, put in some sample data with more than one level 1 field."}, {"owner": {"reputation": 6884, "user_id": 351320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/eafd8fa01bed58c27c5baabdd110a0d8?s=128&d=identicon&r=PG", "display_name": "Barbara", "link": "https://stackoverflow.com/users/351320/barbara"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1567675299, "post_id": 57796200, "comment_id": 102036474, "body": "Thanks @teylyn. This is a stripped down example but levels (column A) are always called 1,2,3,4,5,6,7 or 8. It&#39;s a real thing example, it has just one Level 1 (it is used as a placeholder)."}], "answers": [{"comments": [{"owner": {"reputation": 6884, "user_id": 351320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/eafd8fa01bed58c27c5baabdd110a0d8?s=128&d=identicon&r=PG", "display_name": "Barbara", "link": "https://stackoverflow.com/users/351320/barbara"}, "edited": false, "score": 0, "creation_date": 1567674976, "post_id": 57796333, "comment_id": 102036280, "body": "Thank you @Whome! Almost. I need the current level + the next immediate sublevel only. C3 should be: current level (B3) + the next immediate sub level (B4:B8); C11= current level (B11)+next sublevel (B12:B13);C8=current level(B8)+next sublevel(B9:B10) and so on."}, {"owner": {"reputation": 9489, "user_id": 185565, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e47ed0b05ec5411f11fc1b19908717a7?s=128&d=identicon&r=PG", "display_name": "Whome", "link": "https://stackoverflow.com/users/185565/whome"}, "reply_to_user": {"reputation": 6884, "user_id": 351320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/eafd8fa01bed58c27c5baabdd110a0d8?s=128&d=identicon&r=PG", "display_name": "Barbara", "link": "https://stackoverflow.com/users/351320/barbara"}, "edited": false, "score": 1, "creation_date": 1567686435, "post_id": 57796333, "comment_id": 102042597, "body": "@Barbara This <code>If iSubLevel=iLevel+1 Then</code> condition should do the trick?"}, {"owner": {"reputation": 6884, "user_id": 351320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/eafd8fa01bed58c27c5baabdd110a0d8?s=128&d=identicon&r=PG", "display_name": "Barbara", "link": "https://stackoverflow.com/users/351320/barbara"}, "edited": false, "score": 0, "creation_date": 1567690640, "post_id": 57796333, "comment_id": 102045141, "body": "YES! This is exactly what I was looking for. I have only a basic grasp of VBA so I&#39;m going to study your code and try to figure it all out. Thank you @Whome for taking the time to help me. :D"}, {"owner": {"reputation": 9489, "user_id": 185565, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e47ed0b05ec5411f11fc1b19908717a7?s=128&d=identicon&r=PG", "display_name": "Whome", "link": "https://stackoverflow.com/users/185565/whome"}, "reply_to_user": {"reputation": 6884, "user_id": 351320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/eafd8fa01bed58c27c5baabdd110a0d8?s=128&d=identicon&r=PG", "display_name": "Barbara", "link": "https://stackoverflow.com/users/351320/barbara"}, "edited": false, "score": 0, "creation_date": 1567694005, "post_id": 57796333, "comment_id": 102047175, "body": "@Barbara If you want to parameterize <code>level,price</code> column index you may introduce two new func arguments <code>sumSubLevels(rSource As Range, levelCol as Integer, priceCol as Integer)</code> then no need to hardcode in VBA side. I leave this to your home work."}, {"owner": {"reputation": 6884, "user_id": 351320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/eafd8fa01bed58c27c5baabdd110a0d8?s=128&d=identicon&r=PG", "display_name": "Barbara", "link": "https://stackoverflow.com/users/351320/barbara"}, "edited": false, "score": 0, "creation_date": 1567694863, "post_id": 57796333, "comment_id": 102047654, "body": "Will do. Thanks."}], "tags": [], "owner": {"reputation": 9489, "user_id": 185565, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e47ed0b05ec5411f11fc1b19908717a7?s=128&d=identicon&r=PG", "display_name": "Whome", "link": "https://stackoverflow.com/users/185565/whome"}, "is_accepted": true, "score": 1, "last_activity_date": 1567636236, "creation_date": 1567636236, "answer_id": 57796333, "question_id": 57796200, "link": "https://stackoverflow.com/questions/57796200/excel-sum-nested-levels/57796333#57796333", "title": "Excel - sum nested levels", "body": "<p>Like this kind of VBA user-defined cell formula?\nUse cell formula <code>=sumSubLevels(A2)</code> in C2 cell, <code>=sumSubLevels(A3)</code> in C3 cell and so on. This example adds a current level+all recursive sublevels. This is a simple BOM(bill-of-material) case.</p>\n\n<pre><code>Option Explicit\n\nPublic Function sumSubLevels(rSource As Range) As Double\n    Dim iLevel As Long, iSubLevel As Long, iRow As Long\n    Dim dSum As Double\n\n    iLevel = rSource.Value\n    iRow = 0\n    dSum = rSource.Offset(0, 1)\n    Do While (True)\n        iRow = iRow + 1\n        If rSource.Offset(iRow, 0) = \"\" Then Exit Do\n        iSubLevel = rSource.Offset(iRow, 0)\n        If iSubLevel &gt; iLevel Then\n            dSum = dSum + rSource.Offset(iRow, 1)\n        ElseIf iSubLevel &lt;= iLevel Then\n            Exit Do\n        End If\n    Loop\n    sumSubLevels = dSum\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 6884, "user_id": 351320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/eafd8fa01bed58c27c5baabdd110a0d8?s=128&d=identicon&r=PG", "display_name": "Barbara", "link": "https://stackoverflow.com/users/351320/barbara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 1, "closed_date": 1567637716, "accepted_answer_id": 57796333, "answer_count": 1, "score": 0, "last_activity_date": 1567636236, "creation_date": 1567634849, "question_id": 57796200, "link": "https://stackoverflow.com/questions/57796200/excel-sum-nested-levels", "closed_reason": "Needs more focus", "title": "Excel - sum nested levels", "body": "<p>example file: <a href=\"https://app.box.com/shared/static/iqfjj51hmusu6uk0exwjfnwkjdlwhezr.xlsx\" rel=\"nofollow noreferrer\">https://app.box.com/shared/static/iqfjj51hmusu6uk0exwjfnwkjdlwhezr.xlsx</a></p>\n\n<p>I have some products which are made of many components.\nIn the example above my main product is made of n 5 Level 2 components, some of these Level 2 components are in turn made of many Level 3 components and so on.</p>\n\n<p>Each one of them has a fixed price (column B).</p>\n\n<p>Now, the question: I need to calculate the total for each level +  it's sub levels. In the example this is done manually, so let's take C3, you can see it's the sum of Level 2 itself + all the Level 3 components I need in order to manufacture it. Same goes for C8: the corresponding Level 3 component is made of n2 Level 4 components. Hope the example is clear enough.</p>\n\n<p>This is quite easy when done manually however I need a formula in column C which would select the correct cells for me (based on the value column A) since the range would be dynamic, meaning I can have has many sub-levels as I want and the number of rows is never fixed: right now level 3 goes A4:A8 but it could easily be A4:A6, A7:A30, you get the gist.</p>\n\n<p>I'm really stuck, I don't know how to do this in VBA and I've tried a few formulas (offset + if, match, index...) to see if I can come up with something but no luck.</p>\n\n<p>Does anybody have a suggestion/link or, even better, a solution?</p>\n\n<p>Many thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "do-while"], "comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1567779396, "post_id": 57796158, "comment_id": 102077599, "body": "Not clear if in the cases where a group has &quot;Permits Received&quot; or &quot;Cancelled&quot;, the value in column H is &quot;Ready to Build&quot; because &quot;Permits Received&quot; or &quot;Cancelled&quot; is found in the first line of the group. What if the first line of the group is &quot;Permits Submitted&quot; and only the last line is &quot;Permits Received&quot; or &quot;Cancelled&quot;, would the column H for that group be &quot;Ready to Build&quot; or \u201cMissing Permits\u201d?"}, {"owner": {"reputation": 1, "user_id": 12021928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b29f9152b3f445e89231bb312a1662f2?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/12021928/tom"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1567785480, "post_id": 57796158, "comment_id": 102080639, "body": "Only if all lines in the group are &quot;Permits Received&quot; or &quot;Cancelled&quot; is it supposed to be &quot;Ready to Build&quot;.  If any line or lines in the group are other than that then the FQNID_Status is &quot;Missing Permits&quot;.  A line or group of lines can contain any status but if even one &quot;Permits Submitted&quot; or &quot;Preliminary Designed&quot; is included then the status is &quot;Missing Permits&quot;."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1567786726, "post_id": 57796158, "comment_id": 102081167, "body": "Would you please make up your mind, you changed the requirements again, the new image shows very different results than the previous one."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1567787828, "post_id": 57796158, "comment_id": 102081588, "body": "See updated answer as per the latest image."}, {"owner": {"reputation": 1, "user_id": 12021928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b29f9152b3f445e89231bb312a1662f2?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/12021928/tom"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1567789536, "post_id": 57796158, "comment_id": 102082265, "body": "Your last solution worked perfectly!  Thank you so much for your time and effort!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12021928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b29f9152b3f445e89231bb312a1662f2?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/12021928/tom"}, "edited": false, "score": 0, "creation_date": 1567704292, "post_id": 57796525, "comment_id": 102052138, "body": "Thanks for the reply!  Both the first and second solutions generate the same output, which is almost correct. I think an image of the input and correct output would help dramatically in explaining my problem. How can I post an image to this thread??"}], "tags": [], "owner": {"reputation": 19, "user_id": 10220156, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217798203369327/picture?type=large", "display_name": "Lynn", "link": "https://stackoverflow.com/users/10220156/lynn"}, "is_accepted": false, "score": -1, "last_activity_date": 1567638069, "creation_date": 1567638069, "answer_id": 57796525, "question_id": 57796158, "link": "https://stackoverflow.com/questions/57796158/excel-vba-nested-do-loop-that-reads-ahead/57796525#57796525", "title": "Excel VBA Nested Do Loop that reads ahead", "body": "<p>I've encountered a similar issue when using a for loop to iterate rows like that when I use an integer as the data type for my loop index variable.  The Excel integer data is 2-bytes in length and has a range of -32,768 to 32,767.  Perhaps your mention of \"35766\" was a typo for 32766 or 32767.  If you change your variable 'i' from an int to a long, I would expect your issue to go away.</p>\n\n<p>If this macro is something for your personal use rather than something others will be using, I've often used the following approach to iterate down one column and modify another cell that's on the same row:</p>\n\n<pre><code>Do While IsEmpty(ActiveCell.value) = False\n    If ActiveCell.value = \"X\" Then\n        ActiveCell.Offset(0, 1).value = \"M\"     ' ActiveCell.Offset(row_offset, column_offset)\n    ElseIf ActiveCell.value = \"Y\" Then\n        ActiveCell.Offset(0, 1).value = \"N\"\n    End If\n    ActiveCell.Offset(1, 0).Activate            ' From currently active cell, activate the next cell one row down\nLoop\n</code></pre>\n\n<p>Before running a macro using this technique, you'd have to activate the first cell in the column being evaluated - which becomes the cell first evaluated as the ActiveCell.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 12021928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b29f9152b3f445e89231bb312a1662f2?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/12021928/tom"}, "edited": false, "score": 0, "creation_date": 1567697466, "post_id": 57796781, "comment_id": 102049100, "body": "Both the first and second solutions generate the same output, which is almost correct. I think an image of the input and correct output would help dramatically in explaining my problem. How can I post an image to this thread??"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 1, "user_id": 12021928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b29f9152b3f445e89231bb312a1662f2?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/12021928/tom"}, "edited": false, "score": 0, "creation_date": 1567710813, "post_id": 57796781, "comment_id": 102054735, "body": "@Tom, to add an image, edit your question, then in the <b>Body</b> section click the icon with a landscape figure (the no. 6), then follow the instructions."}, {"owner": {"reputation": 1, "user_id": 12021928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b29f9152b3f445e89231bb312a1662f2?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/12021928/tom"}, "edited": false, "score": 0, "creation_date": 1567779728, "post_id": 57796781, "comment_id": 102077774, "body": "EEM - I have added an image above to show the input data and expected output.  I sincerely appreciate you helping with this!!!  Hopefully the attached image will clarify the output I am looking for.  Thanks again!"}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 2, "last_activity_date": 1567796757, "last_edit_date": 1567796757, "creation_date": 1567640565, "answer_id": 57796781, "question_id": 57796158, "link": "https://stackoverflow.com/questions/57796158/excel-vba-nested-do-loop-that-reads-ahead/57796781#57796781", "title": "Excel VBA Nested Do Loop that reads ahead", "body": "<p><strong>Solution based on the image published:</strong>  </p>\n\n<p>Assuming that the default value for any <em>FIB:BUR</em> group is <em>\"Missing Permits\"</em>, unless all of its <em>FIB:PERMITs</em> have the values <em>\"Permits Received\"</em> or <em>\"Cancelled\"</em> then it should be marked as <em>\"Ready to Build\"</em>.</p>\n\n<p>This proposed solution uses <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.autofilter\" rel=\"nofollow noreferrer\">AutoFilter object (Excel)</a> combined with the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.specialcells\" rel=\"nofollow noreferrer\">Range.SpecialCells method (Excel)</a>. To create a range in which the groups are separated by <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.areas\" rel=\"nofollow noreferrer\">Range.Areas property (Excel)</a>.\nThen it uses <code>For\u2026Next</code> and the <code>WorksheetFunction.CountIf</code> to validate the presence of <em>\"Permits Received\"</em> or <em>\"Cancelled\"</em>, and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840060(v=office.15).aspx\" rel=\"nofollow noreferrer\">Range.Offset Property (Excel)</a> to set the resulting value for the group.</p>\n\n<pre><code>Sub Solution()\nDim rSrc As Range, rTrg As Range\nDim rArea As Range\nDim bCnt As Byte  'Change data type to long if the number of FIB:PERMITs by FIB:BUR exceeds 255\n\n    With ThisWorkbook.Worksheets(\"DATA\")    'change as required\n        If Not (.AutoFilter Is Nothing) Then .Cells(1).AutoFilter\n        Set rSrc = .Cells(2, 7).Resize(-1 + .UsedRange.Rows.Count, 2)\n    End With\n\n    With rSrc\n        .Columns(2).ClearContents\n        .Offset(-1, 0).Resize(1 + .Rows.Count).AutoFilter\n        .AutoFilter Field:=1, Criteria1:=\"&lt;&gt;\"\n        Set rTrg = .Columns(1).SpecialCells(xlCellTypeVisible)\n        .AutoFilter\n    End With\n\n    For Each rArea In rTrg.Areas\n        bCnt = 0\n        With WorksheetFunction\n            bCnt = .CountIf(rArea, \"Cancelled\")\n            bCnt = bCnt + .CountIf(rArea, \"Permits Received\")\n            rArea.Cells(1).Offset(-1, 1).Value2 = _\n                IIf(bCnt = rArea.Rows.Count, \"Ready to Build\", \"Missing Permits\")\n    End With: Next\n\n    End Sub\n</code></pre>\n\n<p><strong>Answer to original question</strong>  </p>\n\n<p>Instead of using a <code>Do\u2026Loop</code> within the <code>For\u2026Next</code>, you could have used <code>IF\u2026ELSEIF</code> or  <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/select-case-statement\" rel=\"nofollow noreferrer\">Select Case statement</a>. This proposed solution uses <code>Select Case</code></p>\n\n<pre><code>Sub Solution_1()\nDim rTrg As Range, lRow As Long\n    With ThisWorkbook.Worksheets(\"DATA\")    'change as required\n        Set rTrg = .Cells(2, 7).Resize(-1 + .UsedRange.Rows.Count, 2)\n    End With\n\n    With rTrg\n        For lRow = 1 To .Rows.Count\n            Select Case .Cells(lRow, 1).Value2\n            Case vbNullString   'NO ACTION!\n            Case \"Permits Received\", \"Cancelled\"\n                .Cells(lRow, 2).Value2 = \"Ready to Build\"\n            Case Else\n                .Cells(lRow, 2).Value2 = \"Missing Permits\"\n    End Select: Next: End With\n\n    End Sub\n</code></pre>\n\n<p>However, I try to avoid <code>For\u2026Next</code> whenever is possible, so this alternate solution uses \n<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.autofilter\" rel=\"nofollow noreferrer\">AutoFilter object (Excel)</a>  combined with the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.specialcells\" rel=\"nofollow noreferrer\">Range.SpecialCells method (Excel)</a>.</p>\n\n<pre><code>Sub Solution_2()\nDim rTrg As Range\n    With ThisWorkbook.Worksheets(\"DATA\")    'change as required\n        If Not (.AutoFilter Is Nothing) Then .Cells(1).AutoFilter\n        Set rTrg = .Cells(2, 7).Resize(-1 + .UsedRange.Rows.Count, 2) ' Set range to all used rows in column G\n    End With\n\n    With rTrg\n\n        .Offset(-1, 0).Resize(1 + .Rows.Count).AutoFilter\n        .Columns(2).Value2 = \"!\"\n        .AutoFilter Field:=2, Criteria1:=\"!\"\n\n        .AutoFilter Field:=1, Criteria1:=\"=Cancelled\", _\n            Operator:=xlOr, Criteria2:=\"=Permits Received\"\n        .Columns(2).SpecialCells(xlCellTypeVisible).Value2 = \"Ready to Build\"\n\n        .AutoFilter Field:=1, Criteria1:=\"&lt;&gt;\"\n        .Columns(2).SpecialCells(xlCellTypeVisible).Value2 = \"Missing Permits\"\n\n        .AutoFilter Field:=1\n        .Columns(2).SpecialCells(xlCellTypeVisible).ClearContents\n\n        .Cells(1).AutoFilter\n\n    End With\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12021928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b29f9152b3f445e89231bb312a1662f2?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/12021928/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 57796781, "answer_count": 2, "score": -1, "last_activity_date": 1567796757, "creation_date": 1567634616, "last_edit_date": 1567786657, "question_id": 57796158, "link": "https://stackoverflow.com/questions/57796158/excel-vba-nested-do-loop-that-reads-ahead", "title": "Excel VBA Nested Do Loop that reads ahead", "body": "<p>I am trying to read all values in column G until it finds a blank cell.  If values are \"Permits Received\" or \"Cancelled\" then I write \"Ready to Build\" in column H.  If I encounter anything other than received or cancelled then I write \"Missing Permits\".  So, I need to read ALL populated cells in column G and write ready... or missing... in column H.  The problem with my code is 1) its probably not the best approach, and 2) it only reads the first cell in column G then writes the output.</p>\n\n<p>This is for an automated workbook that works like a champ except for this loop.  I have been goofing with For Next, Do While and For Each with varying success but the code below is the closest I've been.</p>\n\n<pre><code>Dim i As Integer, j As Integer, rng As Range\n    Set rng = Range(\"$G$2:$G$\" &amp; ActiveSheet.UsedRange.Rows.Count) ' Set range to all used rows in column G\n\n    For i = 2 To rng.Rows.Count\n        Do While Cells(i, 7).Value = \"\"\n            If Cells(i + 1, 7).Value = \"Permits Received\" Or Cells(i + 1, 7).Value = \"Cancelled\" Then\n                Cells(i, 8).Value = \"Ready to Build\"\n            Else: Cells(i, 8).Value = \"Missing Permits\"\n            End If\n            i = i + 1\n            If i = rng.Rows.Count Then Exit For ' Without this code it will read all rows, not just used rows\n        Loop\n    Next i\n</code></pre>\n\n<p>I expect the loop to read all column G values then decide if it is \"Ready to Build\" or \"Missing Permits\".  The code runs to the 35766 then errs with Overflow if the Exit For is not included.</p>\n\n<p>(new) I only need one output line (col H) per each line or group of lines (col G).  The attached image shows how the output should look.  Thank you so, so much for looking at this!!!  I've been staring at it for a week!</p>\n\n<p><a href=\"https://i.stack.imgur.com/AIk79.png\" rel=\"nofollow noreferrer\">Example of input and correct output, need code for column H</a>\n<a href=\"https://i.stack.imgur.com/ZPHG0.png\" rel=\"nofollow noreferrer\">Example of output from latest solution</a></p>\n"}, {"tags": ["excel", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1567646167, "post_id": 57796006, "comment_id": 102027475, "body": "<code>Set db = CurrentDb</code> implies the current database that you are in or that is open. So, if you are really writing this in Excel VBA, use <code>ADO</code> or <code>DAO</code> to connect to and query the db"}, {"owner": {"reputation": 11, "user_id": 12004788, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDqhUYCp7ra5mzAgY5ttAmfFXhIle_PtqEa9frc=k-s128", "display_name": "Mithilesh Tiwari", "link": "https://stackoverflow.com/users/12004788/mithilesh-tiwari"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1567706329, "post_id": 57796006, "comment_id": 102052930, "body": "I used DAO but it is not working. Below is my updated code                                   Dim res3 As DAO.Recordset     Dim sql As String                                                                                            With res3                              .Fields(&quot;PRESENT&quot;) = &quot;Checked-In&quot;                 .Update                 .Close             End With                          Set res3 = Nothing"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1567777261, "post_id": 57796006, "comment_id": 102076440, "body": "To be honest, the code in your comment is so far off, I suggest you read a tutorial on how to connect to database via DAO and then subsequently update a record in a table. Then if you get stuck, draft a new question with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> on what your issue is."}], "owner": {"reputation": 11, "user_id": 12004788, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDqhUYCp7ra5mzAgY5ttAmfFXhIle_PtqEa9frc=k-s128", "display_name": "Mithilesh Tiwari", "link": "https://stackoverflow.com/users/12004788/mithilesh-tiwari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1567664802, "creation_date": 1567633707, "last_edit_date": 1567664802, "question_id": 57796006, "link": "https://stackoverflow.com/questions/57796006/update-statement-fails-in-vba-code-when-the-ms-access-database-is-closed", "title": "Update statement Fails in VBA code when the MS Access Database is Closed", "body": "<p>I have the following update statement in my VBA program.</p>\n\n<pre><code>Dim db As Database\nSet db = CurrentDb\ndb.Execute \"UPDATE SourceTicketData SET PRESENT = 'Checked-In' where CONTROLNUM = \" &amp; ticketno &amp; \"\"\n</code></pre>\n\n<p>However, this statement executes without any problem when my MS Access Database is Open. </p>\n\n<p>When I close the database, the update statement gives:</p>\n\n<blockquote>\n  <p>error code 91 object variable or with block variable not set.</p>\n</blockquote>\n\n<p>Please advise. Thanks.</p>\n"}, {"tags": ["sql", "vba", "ms-access", "dao"], "comments": [{"owner": {"reputation": 2956, "user_id": 2207924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d97be4271939adcd1eec201cd777f57?s=128&d=identicon&r=PG", "display_name": "JeffUK", "link": "https://stackoverflow.com/users/2207924/jeffuk"}, "edited": false, "score": 0, "creation_date": 1567634048, "post_id": 57795875, "comment_id": 102025228, "body": "WHERE is your UNION clause?"}, {"owner": {"reputation": 2956, "user_id": 2207924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d97be4271939adcd1eec201cd777f57?s=128&d=identicon&r=PG", "display_name": "JeffUK", "link": "https://stackoverflow.com/users/2207924/jeffuk"}, "edited": false, "score": 0, "creation_date": 1567634159, "post_id": 57795875, "comment_id": 102025251, "body": "Could it just be a coincidence that your where clause is on a new line.. is that the correct string concatenation syntax for VBA?"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1567634754, "post_id": 57795875, "comment_id": 102025385, "body": "If you format your sql like @LeeMac has done, you can use <a href=\"https://www.sqlinform.com/online-sql-formatter/\" rel=\"nofollow noreferrer\">sqlinform.com/online-sql-formatter</a> . That helps on debug."}], "answers": [{"comments": [{"owner": {"reputation": 1236, "user_id": 3207465, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/640579872/picture?type=large", "display_name": "Xipooo", "link": "https://stackoverflow.com/users/3207465/xipooo"}, "edited": false, "score": 0, "creation_date": 1567634070, "post_id": 57796055, "comment_id": 102025232, "body": "Awww, you beat me to it.  I was 5 seconds from hitting Post Answer. lol"}, {"owner": {"reputation": 3, "user_id": 11891270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b586lw0Qz3Y/AAAAAAAAAAI/AAAAAAAAATM/6lgTLdQhwdk/photo.jpg?sz=128", "display_name": "Lacie", "link": "https://stackoverflow.com/users/11891270/lacie"}, "edited": false, "score": 1, "creation_date": 1567634706, "post_id": 57796055, "comment_id": 102025374, "body": "Perfect. Thank you so much!"}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 3, "last_activity_date": 1567634244, "last_edit_date": 1567634244, "creation_date": 1567634010, "answer_id": 57796055, "question_id": 57795875, "link": "https://stackoverflow.com/questions/57795875/vba-access-dao-sql-with-union-clause-and-where-clause/57796055#57796055", "title": "VBA-ACCESS DAO SQL with UNION clause and WHERE clause", "body": "<p>You'll need to include the <code>where</code> clause in <strong>both</strong> <code>select</code> statements, since the <code>select</code> statements will be evaluated <em>before</em> the <code>union</code>; hence, you'll need something like:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT \n    [SummaryTbl].[WORK_ITEM_NMB], \n    [SummaryTbl].[WORK_ITEM_STS], \n    [SummaryTbl].[RELEASE_NMB], \n    [SummaryTbl].[NOMADS_PRIORITY], \n    [SummaryTbl].[TEST_ACTUAL_DT], \n    [SummaryTbl].[TRAIN_ACTUAL_DT], \n    [SummaryTbl].[TITLE], \n    [SummaryTbl].[DESCRIPTION], \n    [SummaryTbl].[DETAILED_RQ_COMMENTS], \n    [SummaryTbl].[TRAIN_COMMENTS], \n    [SummaryTbl].[TEST_COMMENTS], \n    [ParentChildTbl].[HasAssocWI] \nFROM \n    SummaryTbl LEFT JOIN ParentChildTbl ON\n    [SummaryTbl].[WORK_ITEM_NMB] = [ParentChildTbl].[WORK_ITEM_NMB] \nWHERE \n    ([SummaryTbl].[WORK_ITEM_NMB]&gt;2500) AND \n    ([ParentChildTbl].[WORK_ITEM_NMB]&gt;2500)\nUNION \nSELECT\n    [SummaryTbl].[WORK_ITEM_NMB], \n    [SummaryTbl].[WORK_ITEM_STS], \n    [SummaryTbl].[RELEASE_NMB],\n    [SummaryTbl].[NOMADS_PRIORITY], \n    [SummaryTbl].[TEST_ACTUAL_DT], \n    [SummaryTbl].[TRAIN_ACTUAL_DT], \n    [SummaryTbl].[TITLE], \n    [SummaryTbl].[DESCRIPTION], \n    [SummaryTbl].[DETAILED_RQ_COMMENTS], \n    [SummaryTbl].[TRAIN_COMMENTS], \n    [SummaryTbl].[TEST_COMMENTS], \n    [ParentChildTbl].[HasAssocWI] \nFROM \n    SummaryTbl RIGHT JOIN ParentChildTbl ON \n    [SummaryTbl].[WORK_ITEM_NMB] = [ParentChildTbl].[WORK_ITEM_NMB]\nWHERE \n    ([SummaryTbl].[WORK_ITEM_NMB]&gt;2500) AND \n    ([ParentChildTbl].[WORK_ITEM_NMB]&gt;2500)\n</code></pre>\n\n<p>Though, it looks like your second <code>select</code> statement should be sourcing the <code>WORK_ITEM_NMB</code> field from the <code>ParentChildTbl</code> table (on the right of the join), rather than the <code>SummaryTbl</code> table.</p>\n\n<p>Also, since you're joining on the <code>WORK_ITEM_NMB</code> field, you only need to filter this in the table for which all records are to be returned.</p>\n\n<p>You could also apply the selection criteria to the result of the <code>union</code>, e.g.:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT t.* \nFROM\n(\n    SELECT \n        [SummaryTbl].[WORK_ITEM_NMB], \n        [SummaryTbl].[WORK_ITEM_STS], \n        [SummaryTbl].[RELEASE_NMB], \n        [SummaryTbl].[NOMADS_PRIORITY], \n        [SummaryTbl].[TEST_ACTUAL_DT], \n        [SummaryTbl].[TRAIN_ACTUAL_DT], \n        [SummaryTbl].[TITLE], \n        [SummaryTbl].[DESCRIPTION], \n        [SummaryTbl].[DETAILED_RQ_COMMENTS], \n        [SummaryTbl].[TRAIN_COMMENTS], \n        [SummaryTbl].[TEST_COMMENTS], \n        [ParentChildTbl].[HasAssocWI] \n    FROM \n        SummaryTbl LEFT JOIN ParentChildTbl ON\n        [SummaryTbl].[WORK_ITEM_NMB] = [ParentChildTbl].[WORK_ITEM_NMB] \n    UNION \n    SELECT\n        [ParentChildTbl].[WORK_ITEM_NMB], \n        [SummaryTbl].[WORK_ITEM_STS], \n        [SummaryTbl].[RELEASE_NMB],\n        [SummaryTbl].[NOMADS_PRIORITY], \n        [SummaryTbl].[TEST_ACTUAL_DT], \n        [SummaryTbl].[TRAIN_ACTUAL_DT], \n        [SummaryTbl].[TITLE], \n        [SummaryTbl].[DESCRIPTION], \n        [SummaryTbl].[DETAILED_RQ_COMMENTS], \n        [SummaryTbl].[TRAIN_COMMENTS], \n        [SummaryTbl].[TEST_COMMENTS], \n        [ParentChildTbl].[HasAssocWI] \n    FROM \n        SummaryTbl RIGHT JOIN ParentChildTbl ON \n        [SummaryTbl].[WORK_ITEM_NMB] = [ParentChildTbl].[WORK_ITEM_NMB]\n) t\nWHERE t.[WORK_ITEM_NMB] &gt; 2500\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11891270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b586lw0Qz3Y/AAAAAAAAAAI/AAAAAAAAATM/6lgTLdQhwdk/photo.jpg?sz=128", "display_name": "Lacie", "link": "https://stackoverflow.com/users/11891270/lacie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 57796055, "answer_count": 1, "score": 0, "last_activity_date": 1567634244, "creation_date": 1567632870, "last_edit_date": 1567633338, "question_id": 57795875, "link": "https://stackoverflow.com/questions/57795875/vba-access-dao-sql-with-union-clause-and-where-clause", "title": "VBA-ACCESS DAO SQL with UNION clause and WHERE clause", "body": "<p>This is a small part of my code but in this particular section, I'm trying to     get the following statement to execute: </p>\n\n<p>\"WHERE ([SummaryTbl].[WORK_ITEM_NMB]>2500) AND ([ParentChildTbl].[WORK_ITEM_NMB]>2500)\"</p>\n\n<p>I've used all the JOINS/UNION since ACCESS doesn't support FULL OUTER JOIN and that all works. However, I want it to return only values where the WORK_ITEM_NMB for both tables is greater than 2500 and this does not work. It keeps giving me all the records. I'm thinking I either put the WHERE clause in the incorrect place and/or I have to add it to every JOIN statement.\nI don't get an error. I just get all the records. </p>\n\n<pre><code>Set db = OpenDatabase(DBLoc)\nSQL = \"SELECT [SummaryTbl].[WORK_ITEM_NMB], [SummaryTbl].[WORK_ITEM_STS], [SummaryTbl].[RELEASE_NMB], [SummaryTbl].[NOMADS_PRIORITY], [SummaryTbl].[TEST_ACTUAL_DT], [SummaryTbl].[TRAIN_ACTUAL_DT], [SummaryTbl].[TITLE], [SummaryTbl].[DESCRIPTION], [SummaryTbl].[DETAILED_RQ_COMMENTS], [SummaryTbl].[TRAIN_COMMENTS], [SummaryTbl].[TEST_COMMENTS], [ParentChildTbl].[HasAssocWI] FROM SummaryTbl LEFT JOIN ParentChildTbl ON [SummaryTbl].[WORK_ITEM_NMB] = [ParentChildTbl].[WORK_ITEM_NMB] UNION SELECT [SummaryTbl].[WORK_ITEM_NMB], [SummaryTbl].[WORK_ITEM_STS], [SummaryTbl].[RELEASE_NMB], [SummaryTbl].[NOMADS_PRIORITY], [SummaryTbl].[TEST_ACTUAL_DT], [SummaryTbl].[TRAIN_ACTUAL_DT], [SummaryTbl].[TITLE], [SummaryTbl].[DESCRIPTION], [SummaryTbl].[DETAILED_RQ_COMMENTS], [SummaryTbl].[TRAIN_COMMENTS], [SummaryTbl].[TEST_COMMENTS], [ParentChildTbl].[HasAssocWI] FROM SummaryTbl RIGHT JOIN ParentChildTbl ON [SummaryTbl].[WORK_ITEM_NMB] = [ParentChildTbl].[WORK_ITEM_NMB]\" &amp; _\n\"WHERE ([SummaryTbl].[WORK_ITEM_NMB]&gt;2500) AND ([ParentChildTbl].[WORK_ITEM_NMB]&gt;2500)\"\n\n\n'Execute Query and populate recordset\nSet rs = db.OpenRecordset(SQL, dbOpenSnapshot)\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 1, "creation_date": 1567632087, "post_id": 57795639, "comment_id": 102024681, "body": "Rng(&quot;J&quot; &amp; Rows.Count).End(xlUp).Offset(1).PasteSpecial it makes no sense. Maybe change Rng to Range. And &quot;J&quot; into &quot;F&quot;? You haven&#39;t menton what column J contains"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 1, "creation_date": 1567633086, "post_id": 57795639, "comment_id": 102025010, "body": "Put a &quot;stop&quot; after your Intersect line, change a cell in the sheet, then hit F8 to step through your code...you will catch an Invalid procedure call on your line after cell.Copy. Rafal is correct...that line is problematic."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1567633359, "post_id": 57795639, "comment_id": 102025084, "body": "If you want a value to appear in the next available cell below a range, I typically use <code>Range(&quot;A&quot; &amp; Range(&quot;A###&quot;).End(xlUp).Row + 1)</code> where ### is some row number below your dataset. There are more elegant ways to do this, but this is easy."}, {"owner": {"reputation": 1, "user_id": 8103559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ad60dfc6a26b7f0d0b343b496c62d5?s=128&d=identicon&r=PG&f=1", "display_name": "stephenbleu", "link": "https://stackoverflow.com/users/8103559/stephenbleu"}, "edited": false, "score": 0, "creation_date": 1567781715, "post_id": 57795639, "comment_id": 102078799, "body": "Thanks for the help everyone, I&#39;m not a &quot;developer&quot; by any meaning of the word so I&#39;m just doing what I can.  I&#39;ve copied a link to the excel file below just so you guys can see what i&#39;m working with. I can change the Rng to Range, and F is meant to be the column where the results will be pasted. However the code currently compiles so I didn&#39;t run into any issues like that. Will post back when I try these comments out. Thanks again!  <a href=\"https://xpologistics-my.sharepoint.com/personal/stephen_leu_xpo_com/Documents/TimeBeforeOTCalculator.xlsm?web=1\" rel=\"nofollow noreferrer\">xpologistics-my.sharepoint.com/personal/stephen_leu_xpo_com/&zwnj;&#8203;&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 8103559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ad60dfc6a26b7f0d0b343b496c62d5?s=128&d=identicon&r=PG&f=1", "display_name": "stephenbleu", "link": "https://stackoverflow.com/users/8103559/stephenbleu"}, "reply_to_user": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 0, "creation_date": 1567782305, "post_id": 57795639, "comment_id": 102079105, "body": "Thanks @Rafa\u0142B.! Just changing the Rng to Range made it paste the value in G to J, which is what I wanted. However its choosing the row to paste it to in that column seemingly at random. Do I just need to remove the End(x1Up).Offset(1) for that to paste with rows.count?"}], "owner": {"reputation": 1, "user_id": 8103559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ad60dfc6a26b7f0d0b343b496c62d5?s=128&d=identicon&r=PG&f=1", "display_name": "stephenbleu", "link": "https://stackoverflow.com/users/8103559/stephenbleu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567784798, "creation_date": 1567631193, "last_edit_date": 1567784798, "question_id": 57795639, "link": "https://stackoverflow.com/questions/57795639/trying-to-copy-cells-from-column-f-if-column-e-changes-only-if-column-f-0", "title": "Trying to copy cells from column F if column E changes, only if column F &gt; 0", "body": "<p>I'm using a macro assigned to Sheet1 to try and create a Macro that will copy the values in Column F if Column E changes to a certain value, by row specifically. The code debugs fine but doesn't seem to execute on a Worksheet_Change.</p>\n\n<p>Background: Also have macros set to run on open and close of workbook that list the current time ever 3 minutes in a particular cell. This current time is used to find out how long any given employee has been on the clock, given their start time. I want to copy their calculated time on the clock at the greatest point per person and actively sum that at any given moment for my supervisors.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Not Intersect(Target, Range(\"E3:E75\")) Is Nothing Then\n\nDim Rng As Range\n\nSet Rng = Worksheets(\"Sheet1\").Range(\"F3:F75\")\nFor Each cell In Rng\nIf cell.Value &gt; 0 Then\n    cell.Copy\nRng(\"J\" &amp; Rows.Count).End(xlUp).Offset(1).PasteSpecial xlPasteValues\nEnd If\nNext cell\n\nEnd If\n\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p>I don't have an output, nothing is pasted into column J</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 1, "creation_date": 1567632530, "post_id": 57795571, "comment_id": 102024817, "body": "If Cells(i, &quot;B&quot;).Value &lt;&gt; &quot; &quot; And Cells(i, &quot;B&quot;).Value = &quot; &quot;   -when is that TRUE? :)"}, {"owner": {"reputation": 9, "user_id": 12021941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e343ac2c8716999c70f04ff5069ead6?s=128&d=identicon&r=PG&f=1", "display_name": "DPaulDye", "link": "https://stackoverflow.com/users/12021941/dpauldye"}, "reply_to_user": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 0, "creation_date": 1567633100, "post_id": 57795571, "comment_id": 102025014, "body": "My spreadsheet is only 2 columns.  First is Date and Time, second is where data is entered.  Didn&#39;t know how to write this.  Any suggestions?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567633207, "post_id": 57795571, "comment_id": 102025038, "body": "Read the above comment again. You have <code>If A &lt;&gt; B And A = B Then</code> -- the two predicates are mutually exclusive, the condition will always be false."}, {"owner": {"reputation": 9, "user_id": 12021941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e343ac2c8716999c70f04ff5069ead6?s=128&d=identicon&r=PG&f=1", "display_name": "DPaulDye", "link": "https://stackoverflow.com/users/12021941/dpauldye"}, "edited": false, "score": 0, "creation_date": 1567635213, "post_id": 57795571, "comment_id": 102025468, "body": "So what would I use to auto populate column A with the date and time, when something is entered in Column B, also locking this date and time, so it won&#39;t change?  I am very new to this VBA.  Thanks."}, {"owner": {"reputation": 9, "user_id": 12021941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e343ac2c8716999c70f04ff5069ead6?s=128&d=identicon&r=PG&f=1", "display_name": "DPaulDye", "link": "https://stackoverflow.com/users/12021941/dpauldye"}, "edited": false, "score": 0, "creation_date": 1567635323, "post_id": 57795571, "comment_id": 102025500, "body": "This is where I got some of the code, tried to alter to my situation.  <a href=\"https://stackoverflow.com/questions/28574399/how-to-get-excel-spreadsheet-to-auto-populate-date-time-using-vba\" title=\"how to get excel spreadsheet to auto populate date time using vba\">stackoverflow.com/questions/28574399/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "is_accepted": false, "score": 0, "last_activity_date": 1567658605, "creation_date": 1567658605, "answer_id": 57798559, "question_id": 57795571, "link": "https://stackoverflow.com/questions/57795571/disalllow-editing-a-cell-once-there-is-an-entry/57798559#57798559", "title": "Disalllow editing a cell once there is an entry", "body": "<p>In the same <a href=\"https://stackoverflow.com/questions/28574399/how-to-get-excel-spreadsheet-to-auto-populate-date-time-using-vba\">article</a> you have a solution:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"B:B\")) Is Nothing Then\n        On Error GoTo SafeExit\n        Application.EnableEvents = False\n        Dim bc As Range   'no sense in declaring something until we actually need it\n        For Each bc In Intersect(Target, Range(\"B:B\")) 'deal with every cell that intersects. This is how to handle pastes into more than one cell\n            If Not IsEmpty(Cells(bc.Row, \"B\")) Then\n                Cells(bc.Row, \"A\").Value = Now 'Now is the equivalent of Date + Time\n                Cells(bc.Row, \"A\").NumberFormat = \"m/d/yyyy h:mm AM/PM\"\n            End If\n        Next bc\n        'Range(\"F:F\").EntireColumn.AutoFit 'this slows things down. you may want to comment this out and just set an apprpriate column width that will handle everything\n    End If\nSafeExit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>I just addpat for your case on Range B:B.</p>\n\n<p>Hope it helps</p>\n"}], "owner": {"reputation": 9, "user_id": 12021941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e343ac2c8716999c70f04ff5069ead6?s=128&d=identicon&r=PG&f=1", "display_name": "DPaulDye", "link": "https://stackoverflow.com/users/12021941/dpauldye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575659991, "creation_date": 1567630756, "last_edit_date": 1575659991, "question_id": 57795571, "link": "https://stackoverflow.com/questions/57795571/disalllow-editing-a-cell-once-there-is-an-entry", "title": "Disalllow editing a cell once there is an entry", "body": "<p>I am trying to build a log book where:</p>\n\n<ul>\n<li>Once the operator enters information that cell should lock.</li>\n<li>A date and time for the entry should auto populate.</li>\n</ul>\n\n<p>I have tried several codes I found on bulletin boards, but nothing works.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim i As Integer\n    Application.EnableEvents = False\n    If Target.Column = 2 Or Target.Column = 3 Then\n        For i = 2 To 1000\n            If Cells(i, \"B\").Value &lt;&gt; \" \" And Cells(i, \"B\").Value = \" \" Then\n                Cells(i, \"A\").Value = Date &amp; \" \" &amp; Time\n                Cells(i, \"A\").NumberFormat = \"m/d/yyyy h:mm AM/PM\"\n            End If\n        Next\n    End If\n    Range(\"F:F\").EntireColumn.AutoFit\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 12021872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9afcda1c35c10e60a85836ccd9b68bbd?s=128&d=identicon&r=PG&f=1", "display_name": "NeverBrave", "link": "https://stackoverflow.com/users/12021872/neverbrave"}, "edited": false, "score": 0, "creation_date": 1567630776, "post_id": 57795464, "comment_id": 102024255, "body": "Thank you so much! That is exactly what the issue was. It runs correctly now (right into my next error...) More debugging awaits!"}], "tags": [], "owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "is_accepted": true, "score": 2, "last_activity_date": 1567630162, "creation_date": 1567630162, "answer_id": 57795464, "question_id": 57795419, "link": "https://stackoverflow.com/questions/57795419/how-to-open-a-file-found-with-dir/57795464#57795464", "title": "How to open a file found with Dir?", "body": "<p><code>Dir</code> only returns the <em>filename</em> of each file in the folder. When you try to open it, VBA is looking in the current working directory. To open a file in another location you need to use the full path:</p>\n\n<pre><code>Set wb1 = Workbooks.Open(Filepath + MySource) \n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 12021872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9afcda1c35c10e60a85836ccd9b68bbd?s=128&d=identicon&r=PG&f=1", "display_name": "NeverBrave", "link": "https://stackoverflow.com/users/12021872/neverbrave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 57795464, "answer_count": 1, "score": 1, "last_activity_date": 1607008577, "creation_date": 1567629927, "last_edit_date": 1607008577, "question_id": 57795419, "link": "https://stackoverflow.com/questions/57795419/how-to-open-a-file-found-with-dir", "title": "How to open a file found with Dir?", "body": "<p>I'm attempting to loop through all Excel files in a folder and copy &amp; transpose information from sheet3 onto sheet1 on a master file.</p>\n<p>The looping function uses a filepath and the Dir command to return the file location, but presents an error message when instructed to open the file, saying: &gt;&quot;Run-time Error 1004: We could not find Testfile.xls. Is it possible it was moved, renamed or deleted?&quot;</p>\n<p>I've included the code for how the filepath is defined and how the loop function is meant to summon the first file. When I began working on this code this morning, I was able to open files; however, after updating my Excel (MAC 2017 edition) to get access to more tools in the VBA editor, I could no longer open files using <code>workbooks.open</code>.</p>\n<p>I tried <code>Application.FileDialog(msoFileDialogFolderPicker)</code> instead of stating the file path, but the dialogue box does not open. I'm not sure if I need to revert to an earlier version of Excel or if there is an issue in my syntax that I am overlooking that can explain why my error box can tell me the name of the file but thinks it isn't in the folder.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub LoopThroughDirectory()\n    \n    Dim MySource As String\n    'the name for file that data will come from\n    Dim Filepath As String\n    \n    Filepath = &quot;/Users/Victor/Desktop/Clocks/&quot;\n    'the folder that files are located in\n    MySource = Dir(Filepath)\n    'define location of source files\n    \n    'Establish loop\n    Do While Len(MySource) &gt; 0  \n        If MySource = &quot;zzmaster.xlsx&quot; Then\n            Exit Sub\n        End If\n        'process should loop through all files in the directory until it reaches the master file...\n        'master file should be the last file in the folder, so loop contains all relevant files\n    \n        'begin loop\n        Set wb1 = Workbooks.Open(MySource)    &lt;--the error generates at this step\n        DoEvents\n        \n        'Opens source file\n</code></pre>\n<p>The code is being run from the zzmaster.xlsx file, which is in a folder on my desktop along with five test files. I don't have the experience with this language to recognize if the error is in the syntax, in my file management, or in my decision to update Excel.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12021890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd1843227cdcd67d27aa4894a179f41?s=128&d=identicon&r=PG&f=1", "display_name": "user12021890", "link": "https://stackoverflow.com/users/12021890/user12021890"}, "edited": false, "score": 0, "creation_date": 1567685345, "post_id": 57795470, "comment_id": 102042016, "body": "Perfect! Thanks so much"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1567630176, "creation_date": 1567630176, "answer_id": 57795470, "question_id": 57795365, "link": "https://stackoverflow.com/questions/57795365/change-sheet-references-in-cell-formula-for-large-number-of-sheets/57795470#57795470", "title": "Change sheet references in cell formula for large number of sheets", "body": "<p>Iterate the sheets and use Replace:</p>\n\n<pre><code>Dim wks As Worksheet\nFor Each wks In ThisWorkbook.Worksheets\n    If wks.Name Like \"Clean*\" Then\n        wks.Range(\"A1:E9\").Replace \"Data1\", \"Data\" &amp; Replace(wks.Name, \"Clean\", \"\")\n    End If\nNext wks\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12021890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd1843227cdcd67d27aa4894a179f41?s=128&d=identicon&r=PG&f=1", "display_name": "user12021890", "link": "https://stackoverflow.com/users/12021890/user12021890"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 57795470, "answer_count": 1, "score": 0, "last_activity_date": 1567663005, "creation_date": 1567629586, "last_edit_date": 1567663005, "question_id": 57795365, "link": "https://stackoverflow.com/questions/57795365/change-sheet-references-in-cell-formula-for-large-number-of-sheets", "title": "Change sheet references in cell formula for large number of sheets", "body": "<p>I have a large number of raw data sheets (called Data1, Data2 etc) and I want to create a large number of clean data sheets (Clean1, Clean2 etc) that manipulate that data. Each sheet Clean'i' only references the data in the file Data'i'.</p>\n\n<p>I wrote a macro to create many copies of sheet Clean1 that are named Clean2, Clean3 etc and what I would now like to do is replace \"Data1\" in the formula by \"Data2\" in sheet Clean2, and for all other sheets.</p>\n\n<p>If it were just for one worksheet I would probably do something like this:</p>\n\n<pre><code>For Each cell In Range(\"A1:E9\")\n  If cell.Formula = \"Data1\" Then _\n     cell.Formula = \"Data2\"\nNext cell\nEnd Sub\n</code></pre>\n\n<p>But I don't know how to create a loop that says that if I am at sheet Clean3 I want to replace Data1 by Data3 \n(i.e. essentially referencing part of the name of the worksheet I am looping over and use that in the expression I am replacing)</p>\n"}, {"tags": ["vba", "regexp-replace"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5749045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd34b4bf44ed30cbc1c65f2bff91b0f?s=128&d=identicon&r=PG&f=1", "display_name": "informer", "link": "https://stackoverflow.com/users/5749045/informer"}, "edited": false, "score": 0, "creation_date": 1567664925, "post_id": 57795506, "comment_id": 102031500, "body": "I tried sFileName = Replace(typOpenFile.lpstrFile, Chr(1), &quot;&quot;, Compare:=vbBinaryCompare) but no success. SOH characters are not deleted"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 33, "user_id": 5749045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd34b4bf44ed30cbc1c65f2bff91b0f?s=128&d=identicon&r=PG&f=1", "display_name": "informer", "link": "https://stackoverflow.com/users/5749045/informer"}, "edited": false, "score": 0, "creation_date": 1567669767, "post_id": 57795506, "comment_id": 102033629, "body": "That&#39;s very hard to believe if they&#39;re true SOH characters... Please try to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 33, "user_id": 5749045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd34b4bf44ed30cbc1c65f2bff91b0f?s=128&d=identicon&r=PG&f=1", "display_name": "informer", "link": "https://stackoverflow.com/users/5749045/informer"}, "edited": false, "score": 0, "creation_date": 1567672157, "post_id": 57795506, "comment_id": 102034796, "body": "hu Erik, first thanks again for your help. Click on this <a href=\"https://www.developpez.net/forums/d2002105/logiciels/microsoft-office/excel/macros-vba-excel/regexp-suppression-caraceres-soh/\" rel=\"nofollow noreferrer\">link</a> and upload the New1.txt file for an example"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 33, "user_id": 5749045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd34b4bf44ed30cbc1c65f2bff91b0f?s=128&d=identicon&r=PG&f=1", "display_name": "informer", "link": "https://stackoverflow.com/users/5749045/informer"}, "edited": false, "score": 0, "creation_date": 1567674607, "post_id": 57795506, "comment_id": 102036090, "body": "That doesn&#39;t help me. My function is able to strip the SOH characters from that just fine. I did notice a typo (= should be :=), but the answer should just work"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 33, "user_id": 5749045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd34b4bf44ed30cbc1c65f2bff91b0f?s=128&d=identicon&r=PG&f=1", "display_name": "informer", "link": "https://stackoverflow.com/users/5749045/informer"}, "edited": false, "score": 0, "creation_date": 1567676227, "post_id": 57795506, "comment_id": 102036986, "body": "Please share the code on-site. Edit the question to demonstrate the whole issue. Also, I strongly recommend using the unicode equivalent functions. ANSI functions tend to have weird issues with strings."}, {"owner": {"reputation": 33, "user_id": 5749045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd34b4bf44ed30cbc1c65f2bff91b0f?s=128&d=identicon&r=PG&f=1", "display_name": "informer", "link": "https://stackoverflow.com/users/5749045/informer"}, "edited": false, "score": 0, "creation_date": 1567676825, "post_id": 57795506, "comment_id": 102037299, "body": "I added RegExp Tester screencopies still <a href=\"https://www.developpez.net/forums/d2002105/logiciels/microsoft-office/excel/macros-vba-excel/regexp-suppression-caraceres-soh/#post11114221\" rel=\"nofollow noreferrer\">here</a> which confirm correct regExp"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 33, "user_id": 5749045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd34b4bf44ed30cbc1c65f2bff91b0f?s=128&d=identicon&r=PG&f=1", "display_name": "informer", "link": "https://stackoverflow.com/users/5749045/informer"}, "edited": false, "score": 0, "creation_date": 1567677072, "post_id": 57795506, "comment_id": 102037431, "body": "Yes, please, with an English explanation. I don&#39;t like visiting random foreign sites."}, {"owner": {"reputation": 33, "user_id": 5749045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd34b4bf44ed30cbc1c65f2bff91b0f?s=128&d=identicon&r=PG&f=1", "display_name": "informer", "link": "https://stackoverflow.com/users/5749045/informer"}, "edited": false, "score": 0, "creation_date": 1567842325, "post_id": 57795506, "comment_id": 102092748, "body": "Replace fonction didn&#39;t work for me. SOH characters are still in the string."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 3, "last_activity_date": 1567674583, "last_edit_date": 1567674583, "creation_date": 1567630399, "answer_id": 57795506, "question_id": 57795303, "link": "https://stackoverflow.com/questions/57795303/delete-special-character-soh-with-regexp/57795506#57795506", "title": "Delete special character SOH with RegExp", "body": "<p>Just do a simple find and replace with nothing if you want to remove a specific character:</p>\n\n<pre><code>sStr1 = Replace(sStr1, Chr(1), \"\", Compare := vbBinaryCompare)\n</code></pre>\n\n<p><code>vbBinaryCompare</code> makes the find and replace binary, to avoid weirdness with control characters.</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 5749045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd34b4bf44ed30cbc1c65f2bff91b0f?s=128&d=identicon&r=PG&f=1", "display_name": "informer", "link": "https://stackoverflow.com/users/5749045/informer"}, "is_accepted": false, "score": 0, "last_activity_date": 1567697590, "last_edit_date": 1567697590, "creation_date": 1567679486, "answer_id": 57803495, "question_id": 57795303, "link": "https://stackoverflow.com/questions/57795303/delete-special-character-soh-with-regexp/57803495#57803495", "title": "Delete special character SOH with RegExp", "body": "<p>My code in a module</p>\n\n<pre><code>Public Declare Function GetOpenFileName Lib \"comdlg32.dll\" Alias \"GetOpenFileNameA\" (pOpenfilename As OPENFILENAME) As Long\n\nPublic Type OPENFILENAME\nlStructSize       As Long\nhwndOwner         As Long\nhInstance         As Long\nlpstrFilter       As String\nlpstrCustomFilter As String\nnMaxCustFilter    As Long\nnFilterIndex      As Long\nlpstrFile         As String\nnMaxFile          As Long\nlpstrFileTitle    As String\nnMaxFileTitle     As Long\nlpstrInitialDir   As String\nlpstrTitle        As String\nflags             As Long\nnFileOffset       As Integer\nnFileExtension    As Integer\nlpstrDefExt       As String\nlCustData         As Long\nlpfnHook          As Long\nlpTemplateName    As String\nEnd Type\n\nPublic typOpenFile As OPENFILENAME\n\nPublic Function RegParse(psStr As String, psPattern As String) As String\n\nDim oRegex As New RegExp\nDim sStr As String, sPattern As String\n\nsStr2 = Replace(psStr, Chr(1), \"\", Compare:=vbBinaryCompare)\nDebug.Print sStr2\n\n\nsPattern = psPattern\n    With oRegex\n    .Global = True     'restricting regex to find only first match.\n    .IgnoreCase = True  'ignoring cases while regex engine performs the search.\n    .Pattern = sPattern\n\n    If .Test(psStr) Then              'Testing if the pattern matches or not\n        sStr = .Execute(psStr)(0)     'will provide the String which matches with Regex \n        sStr1 = .Replace(psStr, \"$1\") '.Replace function will replace the String with whatever is in the first set of braces - $X\n    End If\nEnd With\n\nExit_:\n\nRegParse = sStr\nExit Function\n\nErr_:\nsStr = \"\"\ngsMsg = Err.Number &amp; \" : \" &amp; Err.Description &amp; Chr(13) &amp; \"Process aborted\"\nMsgBox gsMsg, vbCritical, \"Error message\"\nGoTo Exit_\n\nEnd Function\n\n\nPublic Function mfOpenFileDialog(psPathDir As String, Optional psFileCrit As String) As Boolean\n\nDim lReturn As Long\nDim strFilter As String\nDim sFileSelected As String\nDim bOk As Boolean\n\nbOk = True\n\ntypOpenFile.lStructSize = Len(typOpenFile)\nstrFilter = \"Text File (*\" &amp; psFileCrit &amp; \"*.csv)\" &amp; Chr(0) &amp; \"*\" &amp; psFileCrit &amp; \"*.csv\" &amp; Chr(0) '--&gt; Define your filter here\n\nWith typOpenFile\n    .lpstrFilter = strFilter\n    .nFilterIndex = 1\n    .lpstrFile = String(257, 0)\n    .nMaxFile = Len(.lpstrFile) - 1\n    .lpstrFileTitle = .lpstrFile\n    .nMaxFileTitle = .nMaxFile\n    .lpstrInitialDir = psPathDir\n    .lpstrTitle = \"My FileFilter Open\"\n    .flags = 0\nEnd With\n\nIf GetOpenFileName(typOpenFile) = 0 Then\n    MsgBox \"No file selected\", vbCritical, \"Error message\"\n    bOk = False\nEnd If\n\nExit_:\n\nmfOpenFileDialog = bOk\nExit Function\n\nErr_:\n\nbOk = False\ngsMsg = \"Function mfOpenFileDialog\" &amp; Chr(13) &amp; Err.Number &amp; Chr(13) &amp; Err.Description\nMsgBox gsMsg, vbCritical, \"Error message\"\nGoTo Exit_\n\nEnd Function\n</code></pre>\n\n<p>I call mfOpenFileDialog function from a click button event</p>\n\n<pre><code>sPathDefault = \"c:\\Extraction\"\nsFileCrit = \"rapport_\"\nIf mfOpenFileDialog(sPathDefault, sFileCrit) = False Then GoTo Exit_\nsPattern = \"(^.*?(?=\\x01))(\\x01*)\"\nsFileName = RegParse(typOpenFile.lpstrFile, sPattern)\n</code></pre>\n\n<p>That's all</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 5749045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd34b4bf44ed30cbc1c65f2bff91b0f?s=128&d=identicon&r=PG&f=1", "display_name": "informer", "link": "https://stackoverflow.com/users/5749045/informer"}, "is_accepted": true, "score": 0, "last_activity_date": 1567879567, "last_edit_date": 1567879567, "creation_date": 1567879246, "answer_id": 57836233, "question_id": 57795303, "link": "https://stackoverflow.com/questions/57795303/delete-special-character-soh-with-regexp/57836233#57836233", "title": "Delete special character SOH with RegExp", "body": "<p>In fact, the special characters are not chr(1) but chr(0) or x00\nI tested with this function </p>\n\n<pre><code>Public Function mfShowChar(psStr As String)\n  Dim i As Integer\n  Dim arrChar() As Integer\n\n  For i = 1 To Len(psStr)\n     ReDim Preserve arrChar(i)\n     ArrChar(i) = Asc(Mid(psStr, i)) \n  Next\n\n End Function\n</code></pre>\n\n<p>And the both solutions work</p>\n\n<ul>\n<li>sStr = Replace(typOpenFile.lpstrFile, Chr(0), vbNullString)</li>\n<li>RegExp but with sPattern = \"(^.<em>?(?=\\x00))(\\x00</em>)\"</li>\n</ul>\n"}], "owner": {"reputation": 33, "user_id": 5749045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd34b4bf44ed30cbc1c65f2bff91b0f?s=128&d=identicon&r=PG&f=1", "display_name": "informer", "link": "https://stackoverflow.com/users/5749045/informer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 57836233, "answer_count": 3, "score": 0, "last_activity_date": 1567879567, "creation_date": 1567629152, "last_edit_date": 1567842143, "question_id": 57795303, "link": "https://stackoverflow.com/questions/57795303/delete-special-character-soh-with-regexp", "title": "Delete special character SOH with RegExp", "body": "<p>For an Access development I used GetOpenFilename function as explained <a href=\"https://www.developpez.net/forums/d1088227/logiciels/microsoft-office/excel/macros-vba-excel/getopenfilename-filtre-d-apres-nom-d-fichier/#post6021744\" rel=\"nofollow noreferrer\">here</a>\nBut lpstrTitle is set with special character SOH. To delete SOH, I create a regExp function</p>\n\n<pre><code>Public Function RegParse(sStr As String) '----&gt; sStr is lpstrTitle from getopenfiled \n\nDim oRegex As New RegExp\n\nsPattern = \"^.*?(?=\\x01)\"  '--&gt; Failed on .Test   \n'sPattern = ^[^\\x01]*  '--&gt; successful.Test but SOH still there\n'sPattern = (^.*)v(.*)  '--&gt;Ok but  v deleted  \n.Replace(sStr, \"$1\")\n\nWith oRegex \n    .IgnoreCase = True\n    .pattern = sPattern\n    .Global = False\n\n    If .Test(sStr) Then\n     sStr1 = .Execute(sStr)(0) \n\nEnd With\n\nEnd Function\n</code></pre>\n\n<p>But sStr1 is still with SOH characters with sPattern = ^[^\\x01]* </p>\n\n<p>And command sStr1 = .replace(sStr1, \u201c$1\u201d) is impossible because sPattern = \"^.*?(?=\\x01) failed in .test</p>\n\n<p>Thanks by advance for any help</p>\n"}, {"tags": ["excel", "vba", "datasource"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1567628603, "post_id": 57795175, "comment_id": 102023453, "body": "most likely you don&#39;t have the u/p of the db stored directly in the connection object. reset the connection to the db and choose the option to store u/p directly in connection settings and that prompt will probably go away"}, {"owner": {"reputation": 59, "user_id": 6497419, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-shK7hILqZ9o/AAAAAAAAAAI/AAAAAAAAAG8/ymkRXu6lnts/photo.jpg?sz=128", "display_name": "Ricardo Carrera", "link": "https://stackoverflow.com/users/6497419/ricardo-carrera"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1567693660, "post_id": 57795175, "comment_id": 102046962, "body": "That work, thanks Scott."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 6497419, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-shK7hILqZ9o/AAAAAAAAAAI/AAAAAAAAAG8/ymkRXu6lnts/photo.jpg?sz=128", "display_name": "Ricardo Carrera", "link": "https://stackoverflow.com/users/6497419/ricardo-carrera"}, "edited": false, "score": 0, "creation_date": 1567632388, "post_id": 57795432, "comment_id": 102024761, "body": "I have Microsoft Excel 2013. Is there a way using only macro? I&#39;m not an excel expert and it would be fine if the macro select the data source automatically."}, {"owner": {"reputation": 3064, "user_id": 11971785, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tm3RpH5aT9s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfqnZceaddibCeBqwQbb0SmiR6prw/photo.jpg?sz=128", "display_name": "Andreas", "link": "https://stackoverflow.com/users/11971785/andreas"}, "reply_to_user": {"reputation": 59, "user_id": 6497419, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-shK7hILqZ9o/AAAAAAAAAAI/AAAAAAAAAG8/ymkRXu6lnts/photo.jpg?sz=128", "display_name": "Ricardo Carrera", "link": "https://stackoverflow.com/users/6497419/ricardo-carrera"}, "edited": false, "score": 0, "creation_date": 1567633231, "post_id": 57795432, "comment_id": 102025046, "body": "@RicardoCarrera, try first to simply connect to oracle. The following link might be helpful: <a href=\"https://community.oracle.com/thread/679324\" rel=\"nofollow noreferrer\">community.oracle.com/thread/679324</a> once you have established a connect, we can work on it."}, {"owner": {"reputation": 59, "user_id": 6497419, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-shK7hILqZ9o/AAAAAAAAAAI/AAAAAAAAAG8/ymkRXu6lnts/photo.jpg?sz=128", "display_name": "Ricardo Carrera", "link": "https://stackoverflow.com/users/6497419/ricardo-carrera"}, "edited": false, "score": 0, "creation_date": 1567635813, "post_id": 57795432, "comment_id": 102025596, "body": "I don&#39;t need to connect to Oracle in the macro. If I press Accept and OK in the windows that pops up (image from the question), it will refresh the data. But what I need is the macro select the data source PRODUCCION DWH without ask."}, {"owner": {"reputation": 3064, "user_id": 11971785, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tm3RpH5aT9s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfqnZceaddibCeBqwQbb0SmiR6prw/photo.jpg?sz=128", "display_name": "Andreas", "link": "https://stackoverflow.com/users/11971785/andreas"}, "reply_to_user": {"reputation": 59, "user_id": 6497419, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-shK7hILqZ9o/AAAAAAAAAAI/AAAAAAAAAG8/ymkRXu6lnts/photo.jpg?sz=128", "display_name": "Ricardo Carrera", "link": "https://stackoverflow.com/users/6497419/ricardo-carrera"}, "edited": false, "score": 0, "creation_date": 1567636074, "post_id": 57795432, "comment_id": 102025667, "body": "@RicardoCarrera, yes, because Excel &quot;does not know&quot; where the source is. To make it know where to find the connection one way would to first create a direct connection via VBA or via Power Query as mentioned in my answer. If you dont want to connect via VBA you can download power query as Add-Inn for Excel 2013, but as far as I know you need to specify the connection somewhere, otherwise Excel will always ask for it."}], "tags": [], "owner": {"reputation": 3064, "user_id": 11971785, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tm3RpH5aT9s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfqnZceaddibCeBqwQbb0SmiR6prw/photo.jpg?sz=128", "display_name": "Andreas", "link": "https://stackoverflow.com/users/11971785/andreas"}, "is_accepted": false, "score": 0, "last_activity_date": 1567629992, "creation_date": 1567629992, "answer_id": 57795432, "question_id": 57795175, "link": "https://stackoverflow.com/questions/57795175/how-can-i-automatically-select-a-data-source-via-vba-in-excel/57795432#57795432", "title": "How can I automatically select a data source via VBA in excel", "body": "<p>Besides using macros, you could also do it with power query which is included in Excel 2016 and higher by default:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MMDi7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MMDi7.png\" alt=\"enter image description here\"></a></p>\n\n<p>Select Data, then New Query, then Databases, then Oracle and create a connection to Oracle.</p>\n\n<p>Then you only need to set the refreshing intervall like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/veTGv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/veTGv.png\" alt=\"enter image description here\"></a></p>\n\n<p>Click Data again, then Connections, then Settings, then Update after X minutes.</p>\n\n<p>If you want control the exact time of the oracle power query update, just configure this macro:</p>\n\n<pre><code>Sub RefreshQuery()\nDim con As WorkbookConnection\nDim Cname As String\n\nFor Each con In ActiveWorkbook.Connections\n    If Left(con.name, 8) = \"Query - \" Then\n    Cname = con.name\n        With ActiveWorkbook.Connections(Cname).OLEDBConnection\n            .BackgroundQuery = False  'or true, up to you\n            .Refresh\n        End With\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p><em>Code found here: <a href=\"https://stackoverflow.com/a/38653892/11971785\">https://stackoverflow.com/a/38653892/11971785</a></em></p>\n"}], "owner": {"reputation": 59, "user_id": 6497419, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-shK7hILqZ9o/AAAAAAAAAAI/AAAAAAAAAG8/ymkRXu6lnts/photo.jpg?sz=128", "display_name": "Ricardo Carrera", "link": "https://stackoverflow.com/users/6497419/ricardo-carrera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1740, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1567638268, "creation_date": 1567628371, "last_edit_date": 1567638268, "question_id": 57795175, "link": "https://stackoverflow.com/questions/57795175/how-can-i-automatically-select-a-data-source-via-vba-in-excel", "title": "How can I automatically select a data source via VBA in excel", "body": "<p>I have an excel file with 4 sheets. Each sheet contains a pivot table that connects to an Oracle database. I need all pivot tables to update automatically at 4 am. To do this I have a macro. The problem is the macro asks me to select a data source manually. Is there a way the macro select the data source automatically?</p>\n\n<p>When I execute the macro, it shows me this window 4 times:</p>\n\n<p><a href=\"https://i.stack.imgur.com/89h0P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/89h0P.png\" alt=\"enter image description here\"></a></p>\n\n<p>And then:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZDenz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZDenz.png\" alt=\"enter image description here\"></a></p>\n\n<p>I need the macro select the one that is marked (PRODUCCION DWH).</p>\n\n<p>This is the macro:</p>\n\n<pre><code>Sub Actualiza_Reporte()\n\n    Dim pt As PivotTable    \n    Dim ws As Worksheet\n\n    For Each ws In ActiveWorkbook.Worksheets\n        For Each pt In ws.PivotTables      \n            pt.RefreshTable\n\n        Next pt\n    Next ws\n\n    ThisWorkbook.Save   ' Guardamos el archivo\n    ThisWorkbook.Close  ' Para cerrar el archivo\n    Application.Quit    ' Para cerrar Excel\nEnd Sub\n</code></pre>\n\n<p>I need to update the 4 sheets automatically, without asking me to select the data source.</p>\n\n<p>Thanks and regards.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1567625876, "post_id": 57794695, "comment_id": 102022763, "body": "Can you show what code you have tried so far? But I&#39;m guessing that a <code>For Each</code> statement would be the best route."}, {"owner": {"reputation": 1, "user_id": 5639950, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JLAfO.jpg?s=128&g=1", "display_name": "beewhite", "link": "https://stackoverflow.com/users/5639950/beewhite"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1567631489, "post_id": 57794695, "comment_id": 102024508, "body": "=IF(Sheet3!E36=&quot;BW&quot;,Sheet3!L36,&quot;&quot;)  is all I&#39;ve come up with, this just goes row for row and leaves big gaps where it doesn&#39;t find BW."}, {"owner": {"reputation": 2468, "user_id": 1011722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182b622b9ff2901ba98e3c6af8bc3672?s=128&d=identicon&r=PG", "display_name": "Trevor Reid", "link": "https://stackoverflow.com/users/1011722/trevor-reid"}, "edited": false, "score": 0, "creation_date": 1567632018, "post_id": 57794695, "comment_id": 102024658, "body": "Do you have a constraint that specifically calls for  VBA/ a codebased solution?  This is easy to do as a user using Data &gt; Filter?  And if you do need to accomplish that via VBA you could try Range(\u201cYour_Defined_range\u2033).AutoFilter"}, {"owner": {"reputation": 1, "user_id": 5639950, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JLAfO.jpg?s=128&g=1", "display_name": "beewhite", "link": "https://stackoverflow.com/users/5639950/beewhite"}, "edited": false, "score": 0, "creation_date": 1567634412, "post_id": 57794695, "comment_id": 102025307, "body": "I don&#39;t! I&#39;m just new to all this and thought that would be the way to go. I will check out data filters, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "is_accepted": false, "score": 0, "last_activity_date": 1567634571, "creation_date": 1567634571, "answer_id": 57796152, "question_id": 57794695, "link": "https://stackoverflow.com/questions/57794695/selectively-copy-rows-from-one-sheet-to-a-new-table-on-a-new-sheet/57796152#57796152", "title": "Selectively copy rows from one sheet to a new table on a new sheet", "body": "<p>Try This. It looks for your criteria in column \"E\" and then it copies the rows containing that criterion, in this case <code>\"BW\"</code>, to a destination range which in this code is <code>(\"Sheet2\")</code>. Hope this helps.</p>\n\n<pre><code>Sub Copyrowcriteria()\n    Dim target As Worksheet\n    Set target = ThisWorkbook.Worksheets(\"Sheet2\")\n    Dim i As Long\n    For i = 1 To Cells(Rows.Count, \"E\").End(xlUp).Row\n        If Cells(i, 5).Value = \"BW\" Then\n            Range(Cells(i, 1), Cells(i, 5)).Copy destination:=target.Range(\"A\" &amp; target.Cells(Rows.Count, \"A\").End(xlUp).Row + 1)\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5639950, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JLAfO.jpg?s=128&g=1", "display_name": "beewhite", "link": "https://stackoverflow.com/users/5639950/beewhite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567634571, "creation_date": 1567625157, "last_edit_date": 1567632487, "question_id": 57794695, "link": "https://stackoverflow.com/questions/57794695/selectively-copy-rows-from-one-sheet-to-a-new-table-on-a-new-sheet", "title": "Selectively copy rows from one sheet to a new table on a new sheet", "body": "<p>I have a quote log for my entire company pulled from an access database. The data populates nicely into a sheet in Excel. One column has the initials of the person in charge of the job.</p>\n\n<p>I'd like to pull all rows from this table that have my initials in it, and copy only these rows into a new table on a separate sheet. I think this is probably a VBA issue, I'm new to VBA and just looking for someone to point me in the right direction. </p>\n\n<p>I can go down row by row with an if statement but that creates massive gaps where my initials aren't present.</p>\n"}, {"tags": ["excel", "vba", "32bit-64bit"], "comments": [{"owner": {"reputation": 1952, "user_id": 4178262, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MVZ9ZR1BFos/AAAAAAAAAAI/AAAAAAAAAAA/aEP8yOumPbw/photo.jpg?sz=128", "display_name": "Mark Stewart", "link": "https://stackoverflow.com/users/4178262/mark-stewart"}, "edited": false, "score": 0, "creation_date": 1567625995, "post_id": 57794662, "comment_id": 102022815, "body": "Check your Integer variables too; and watch out for number of rows being greater than 65,535, etc.  What are some of the errors?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 2, "creation_date": 1567627488, "post_id": 57794662, "comment_id": 102023274, "body": "<a href=\"https://www.google.com/url?sa=t&amp;source=web&amp;rct=j&amp;url=https://support.microsoft.com/en-nz/help/971987/error-message-when-you-use-an-adodb-connection-object-with-an-odbc-dri&amp;ved=2ahUKEwi308ma-rfkAhVc7nMBHbj9DQAQFjABegQIBRAB&amp;usg=AOvVaw0iVXGRMwzBwnxGW7lGoblY&amp;cshid=1567627323090\" rel=\"nofollow noreferrer\">Possibility related</a>"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 1952, "user_id": 4178262, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MVZ9ZR1BFos/AAAAAAAAAAI/AAAAAAAAAAA/aEP8yOumPbw/photo.jpg?sz=128", "display_name": "Mark Stewart", "link": "https://stackoverflow.com/users/4178262/mark-stewart"}, "edited": false, "score": 1, "creation_date": 1567667595, "post_id": 57794662, "comment_id": 102032602, "body": "@MarkStewart The limits for the data types are exactly the same between 32 and 64 bit Excel. The number of rows is also the same."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1567667639, "post_id": 57794662, "comment_id": 102032630, "body": "@chrisneilsen Please use <a href=\"https://support.microsoft.com/en-hk/help/971987/error-message-when-you-use-an-adodb-connection-object-with-an-odbc-dri\" rel=\"nofollow noreferrer\">direct links</a> instead of the mangled tracking links that Google gives on the results page."}], "owner": {"reputation": 1, "user_id": 12020963, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDbXd-nfLPsVZJUCFHIgvm4HfGcthTis9jKEAQydA=k-s128", "display_name": "Tyler Hidalgo", "link": "https://stackoverflow.com/users/12020963/tyler-hidalgo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567667240, "creation_date": 1567625016, "last_edit_date": 1567667240, "question_id": 57794662, "link": "https://stackoverflow.com/questions/57794662/trying-to-convert-32-bit-excel-macros-into-64-bit", "title": "Trying to convert 32-Bit Excel Macros into 64-Bit", "body": "<p>I'm trying to run an Excel loaded with multiple macros. It was written for a 32-Bit and work upgraded me to a 64-Bit to do Power BI reporting. </p>\n\n<p>The Excel macros are spitting out errors. I tried to use other threads to help me convert it. However I keep having the debugger come back to me about the last line.</p>\n\n<p>I found this comment on a <a href=\"https://stackoverflow.com/questions/45161901/converting-excel-macro-from-32-bit-to-64-bit\">similar thread</a> and used it as a guideline to alter my code and was able to remove some of the data type errors I was being thrown. </p>\n\n<blockquote>\n  <p>Manually add <code>PtrSafe</code> to all declarations. Manually convert all <code>Long</code>s in the declarations that represent pointers to <code>LongPtr</code>s (in the code shown, that would be only <code>pidl</code>). Manually update declarations of <code>Long</code> variables in procedures that are passed as these parameters to <code>LongPtr</code>. There's no other way. You may try to look into refactoring tools/addins that may automate the replacements to a degree.</p>\n</blockquote>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set objmyconn = New ADODB.Connection\nSet Objmycmd = New ADODB. Connection\nSet obmyrecordset= New ADODB.Recordset\nobjmyconn.ConnectionTImeout = 0 \nobjmyconn.Open \"DSN=UU####; uid=NAME; pwd:1234\"\n</code></pre>\n\n<pre class=\"lang-none prettyprint-override\"><code>Run-time error '2147467259 (80004005)':\n</code></pre>\n"}, {"tags": ["excel", "vba", "pivot-table"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 12021489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9985c2155ade4454f4944eb48fc38290?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/12021489/will"}, "edited": false, "score": 0, "creation_date": 1567707313, "post_id": 57794760, "comment_id": 102053324, "body": "Tim, I made the change mentioned and I&#39;m still getting the same error.  Any ideas?"}, {"owner": {"reputation": 9, "user_id": 12021489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9985c2155ade4454f4944eb48fc38290?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/12021489/will"}, "edited": false, "score": 0, "creation_date": 1567709212, "post_id": 57794760, "comment_id": 102054037, "body": "On the Set PCache line."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1567710204, "last_edit_date": 1567710204, "creation_date": 1567625443, "answer_id": 57794760, "question_id": 57794091, "link": "https://stackoverflow.com/questions/57794091/vba-for-creating-pivot-table/57794760#57794760", "title": "VBA for creating pivot table", "body": "<p>Change this:</p>\n\n<pre><code>Set PCache = ActiveWorkbook.PivotCaches.Create _\n(SourceType:=xlDatabase, SourceData:=PRange). _\nCreatePivotTable(TableDestination:=PSheet.Cells(2, 2), _\nTableName:=\"PivotTable\")\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>Set PCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=PRange)\n\nSet PTable = PCache.CreatePivotTable(TableDestination:=PSheet.Cells(2, 2), _\n                               TableName:=\"PivotTable\")\n</code></pre>\n\n<p>In your original code <code>CreatePivotTable</code> returns a <code>PivotTable</code>, not a <code>PivotCache</code>, so giving you the \"type mismatch\" error</p>\n\n<p>Edit: tested this and works fine for me</p>\n\n<pre><code>Sub PivotTableAdd()\n\n        'Declare Variables\n        Dim PSheet As Worksheet\n        Dim DSheet As Worksheet\n        Dim PCache As PivotCache\n        Dim PTable As PivotTable\n        Dim PRange As Range\n        Dim LastRow As Long\n        Dim LastCol As Long\n\n        'Insert a New Blank Worksheet\n        'On Error Resume Next\n        Application.DisplayAlerts = False\n        'Worksheets(\"Pivot\").Delete\n        Sheets.Add Before:=ActiveSheet\n        ActiveSheet.Name = \"Pivot\"\n        Application.DisplayAlerts = True\n        Set PSheet = Worksheets(\"Pivot\")\n        Set DSheet = Worksheets(\"Report\")\n\n        'Define Data Range\n        LastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\n        LastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n        Set PRange = DSheet.Cells(1, 1).Resize(LastRow, LastCol)\n\n        'Define Pivot Cache\n       Set PCache = ActiveWorkbook.PivotCaches.Create( _\n                  SourceType:=xlDatabase, SourceData:=PRange)\n\n       Set PTable = PCache.CreatePivotTable(TableDestination:=PSheet.Cells(2, 2), _\n                               TableName:=\"PivotTable\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 12021489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9985c2155ade4454f4944eb48fc38290?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/12021489/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 57794760, "answer_count": 1, "score": 0, "last_activity_date": 1567715212, "creation_date": 1567622199, "last_edit_date": 1567715212, "question_id": 57794091, "link": "https://stackoverflow.com/questions/57794091/vba-for-creating-pivot-table", "title": "VBA for creating pivot table", "body": "<p>I am trying to use VBA to insert a pivot table.</p>\n\n<p>However, every time I try to run it I get an error: \"<strong>Run-time error 13: Type mismatch</strong>\" on the <em>Define Pivot Cache</em> portion.  </p>\n\n<p>I've tried changing the variable names as well as not using some of them, but I still get the same error. Am I missing something?</p>\n\n<pre><code>Sub PivotTableAdd()\n\n    'Declare Variables\n    Dim PSheet As Worksheet\n    Dim DSheet As Worksheet\n    Dim PCache As PivotCache\n    Dim PTable As PivotTable\n    Dim PRange As Range\n    Dim LastRow As Long\n    Dim LastCol As Long\n\n    'Insert a New Blank Worksheet\n    'On Error Resume Next\n    Application.DisplayAlerts = False\n    'Worksheets(\"Pivot\").Delete\n    Sheets.Add Before:=ActiveSheet\n    ActiveSheet.Name = \"Pivot\"\n    Application.DisplayAlerts = True\n    Set PSheet = Worksheets(\"Pivot\")\n    Set DSheet = Worksheets(\"Report\")\n\n    'Define Data Range\n    LastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\n    LastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n    Set PRange = DSheet.Cells(1, 1).Resize(LastRow, LastCol)\n\n    'Define Pivot Cache\n    Set PCache = ActiveWorkbook.PivotCaches.Create _\n    (SourceType:=xlDatabase, SourceData:=PRange). _\n    CreatePivotTable(TableDestination:=PSheet.Cells(2, 2), _\n    TableName:=\"PivotTable\")\n\n    'Insert Blank Pivot Table\n    Set PTable = PCache.CreatePivotTable _\n    (TableDestination:=PSheet.Cells(1, 1), TableName:=\"PivotTable\")\n\nEnd Sub\n</code></pre>\n\n<p>Edit:\nI changed this line and got it to work:</p>\n\n<pre><code>Set PCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=PRange.Address(True, True, xlR1C1, True))\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1567622634, "post_id": 57794083, "comment_id": 102021523, "body": "The error raises on this statement?? <code>For Each pic In sht.Pictures</code>?"}, {"owner": {"reputation": 1, "user_id": 12021279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f160f1751ae099963ca8b7554166d222?s=128&d=identicon&r=PG&f=1", "display_name": "akeom", "link": "https://stackoverflow.com/users/12021279/akeom"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1567624082, "post_id": 57794083, "comment_id": 102022049, "body": "Yes, exactly. that is where the error occurs."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1567624225, "post_id": 57794083, "comment_id": 102022107, "body": "Hmmm. That doesn&#39;t make any sense. <code>sht.Pictures</code> is a collection of <code>Picture</code> objects. I can&#39;t see any reason why that line would fail. Even if there are no picture on the sheet, that will just be an empty iterable."}, {"owner": {"reputation": 1, "user_id": 12021279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f160f1751ae099963ca8b7554166d222?s=128&d=identicon&r=PG&f=1", "display_name": "akeom", "link": "https://stackoverflow.com/users/12021279/akeom"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1567625021, "post_id": 57794083, "comment_id": 102022435, "body": "Yes, i am really stuck here. When I construct sheets from scratch or I put it into random workbooks the code works. Only in the target book it fails. I will paste the code in earlier versions and try to determine when the code breaks."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567625101, "post_id": 57794083, "comment_id": 102022465, "body": "Are you getting a type mismatch on the first iteration, or you get a bunch and suddenly it chokes on one particular picture?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567625253, "post_id": 57794083, "comment_id": 102022528, "body": "Try late binding  - declare <code>pic As Variant</code>, then insert <code>Debug.Assert TypeOf pic Is Excel.Picture</code> before the <code>ReDim</code>. Does the assert fail at any point?"}, {"owner": {"reputation": 1, "user_id": 12021279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f160f1751ae099963ca8b7554166d222?s=128&d=identicon&r=PG&f=1", "display_name": "akeom", "link": "https://stackoverflow.com/users/12021279/akeom"}, "edited": false, "score": 0, "creation_date": 1567625673, "post_id": 57794083, "comment_id": 102022676, "body": "Hi Matthieu, It starts at the very first iteration. I will look at your approach, one sec"}, {"owner": {"reputation": 1, "user_id": 12021279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f160f1751ae099963ca8b7554166d222?s=128&d=identicon&r=PG&f=1", "display_name": "akeom", "link": "https://stackoverflow.com/users/12021279/akeom"}, "edited": false, "score": 1, "creation_date": 1567626016, "post_id": 57794083, "comment_id": 102022824, "body": "I found the last iteration that worked and the first that is broken...The first broken version has copied sheets in it from another excel version. Maybe that is causing the trouble."}, {"owner": {"reputation": 1, "user_id": 12021279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f160f1751ae099963ca8b7554166d222?s=128&d=identicon&r=PG&f=1", "display_name": "akeom", "link": "https://stackoverflow.com/users/12021279/akeom"}, "edited": false, "score": 0, "creation_date": 1567626421, "post_id": 57794083, "comment_id": 102022961, "body": "Matthieu, the debug.assert fails when I try to access the pic.formula with error 438. Just as it would with Dim pic as Shape"}, {"owner": {"reputation": 1, "user_id": 12021279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f160f1751ae099963ca8b7554166d222?s=128&d=identicon&r=PG&f=1", "display_name": "akeom", "link": "https://stackoverflow.com/users/12021279/akeom"}, "edited": false, "score": 0, "creation_date": 1567627158, "post_id": 57794083, "comment_id": 102023231, "body": "I could isolate the sheet and version where the error 13 gets thrown. It is a sheet with two scroll bars linked to a cell. It is available in both versions, the one that does throw the error, and the one that does not. When I delete BOTH of the scroll bars in the workbook that has the error, then the code works, no error thrown. Now I&#39;ll figure out if there is a difference between the scroll bars in Book/Sheet A and B...This is an unexpected one..."}, {"owner": {"reputation": 1, "user_id": 12021279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f160f1751ae099963ca8b7554166d222?s=128&d=identicon&r=PG&f=1", "display_name": "akeom", "link": "https://stackoverflow.com/users/12021279/akeom"}, "edited": false, "score": 1, "creation_date": 1567630671, "post_id": 57794083, "comment_id": 102024218, "body": "Ok I&#39;m tired now. Inspecting the document with OpenXML. Something seems to be corrupt. I&#39;ll post it as soon as I have found the problem. Thank you for helping out David and Matthieu"}], "owner": {"reputation": 1, "user_id": 12021279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f160f1751ae099963ca8b7554166d222?s=128&d=identicon&r=PG&f=1", "display_name": "akeom", "link": "https://stackoverflow.com/users/12021279/akeom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567753318, "creation_date": 1567622152, "last_edit_date": 1567753318, "question_id": 57794083, "link": "https://stackoverflow.com/questions/57794083/excel-linked-pictures-performance-fix-worksheet-pictures-throws-type-mismatch-e", "title": "Excel Linked Pictures performance fix: worksheet.pictures throws type mismatch error 13 in For Each loop -SOLVED-", "body": "<p>I try to develop a VBA routine that allows me to manage the performance issue as well as some nice features that come with the use of linked pictures / camera tool.</p>\n\n<p>The code hereunder iterates through the .pictures collection of the worksheet, so I can extract the formula from the pic.formula member and use it later. </p>\n\n<p>My problem: The code works in test workbooks, but not the target one. As soon as the code hits the line For each pic in worksheet.pictures I get the runtime error 13, type mismatch</p>\n\n<p>I tried to work with shapes which does not throw the error, but when I do so I cannot access the .formula member of the shape object. Error 438, property not supported by the object.</p>\n\n<p>I tried to cast a shape to picture using the shape.type property to detect a picture. Didn't work.</p>\n\n<p>I tried to figure out if there is a 255 char limit problem with the .pictures collection by inspecting all picture names as well as constructing a sheet with 300+ linked pictures, linked pictures with linked pictures in them and also various groupings. In the test workbook it worked perfectly, in the target workbook i get the error. </p>\n\n<p>I tried the code on clean sheets in the affected workbook, the error is thrown there as well.</p>\n\n<p>I work the latest Office 365 release and Windows 10.</p>\n\n<p>The code herunder works fine if you create a workbook and place some linked pictures (camera tool) on the sheet.</p>\n\n<p>Any suggestions what I should try next?</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    Dim sht As Worksheet\n    Dim pic As Picture\n    Dim i As Integer\n    Dim ListAll As String\n    Dim arr() As Variant\n\n    i = 1 'for my array\n    Set sht = Sheets(\"Sheet1\")\n\n   For Each pic In sht.Pictures\n       ReDim Preserve arr(1 To i)\n       arr(i) = pic.Name &amp; \" \" &amp; pic.Formula\n       i = i + 1\n   Next pic\n\n'control output\n   ListAll = \"\"\n\n   While i &gt; 1\n     i = i - 1\n     ListAll = ListAll &amp; i &amp; \":\" &amp; arr(i) &amp; \" \"\n   Wend\n\n   MsgBox ListAll\n\nEnd Sub\n</code></pre>\n\n<p>The output should be a message box with a list of the pictures and according links/formula's</p>\n\n<p>What I get is the Type Mismatch error 13.</p>\n\n<p>UPDATE:</p>\n\n<p>I altered the code, works in the first broken workbook. I use the Shapes collection to scroll through the shapes, filter out the pictures, and initialize the pic variable from there.\nI was able to narrow the problem down, but I have no conclusive RCA. My guess is that the unexpected behavior is related to the use of scrollbars (i let the user manipulate cells through scrollbars); \nThe mismatch error occurs when the first scrollbar gets 'hit' in the 'for each pic in worksheet.pictures' loop. But I could not reproduce the error consistently in test workbooks.</p>\n\n<p>Still no clue why, but here is a workaround that does the trick:</p>\n\n<pre><code>Sub Test()\n\n    Dim sht As Worksheet\n    Dim shp As Shape\n    Dim pic As Picture\n    Dim i As Integer\n    Dim ListAll As String\n    Dim arr() As Variant\n\n    i = 1 'for my array\n    Set sht = Sheets(\"Sheet1\")\n\n    For Each shp In sht.Shapes\n\n     If shp.Type = msoPicture Then\n\n         Set pic = sht.Pictures(shp.Name)\n\n         ReDim Preserve arr(1 To i)\n         arr(i) = pic.Name &amp; \" \" &amp; pic.Formula\n         i = i + 1\n\n     End If\n\n   Next shp\n\n'control output\n   ListAll = \"\"\n\n   While i &gt; 1\n     i = i - 1\n     ListAll = ListAll &amp; i &amp; \":\" &amp; arr(i) &amp; \" \"\n   Wend\n\n   MsgBox ListAll\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["json", "excel", "vba", "oracle", "rest"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1567625047, "post_id": 57794037, "comment_id": 102022449, "body": "Just as a (potentially very stupid) question on my part... should <code>&quot;number&quot;</code> be <code>&quot;NUMBER&quot;</code> (all caps) ?"}, {"owner": {"reputation": 21, "user_id": 9286606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9771ce33b25279cfbf9561188b768b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Maggie", "link": "https://stackoverflow.com/users/9286606/maggie"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1567625537, "post_id": 57794037, "comment_id": 102022621, "body": "I tried that with no luck.."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1567625991, "post_id": 57794037, "comment_id": 102022812, "body": "Try <code>&quot;{&quot;&quot;number&quot;&quot;:123456,...</code>"}, {"owner": {"reputation": 21, "user_id": 9286606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9771ce33b25279cfbf9561188b768b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Maggie", "link": "https://stackoverflow.com/users/9286606/maggie"}, "edited": false, "score": 0, "creation_date": 1567626687, "post_id": 57794037, "comment_id": 102023064, "body": "Still, get the same error."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1567627919, "post_id": 57794037, "comment_id": 102023317, "body": "There&#39;s no real way we could know what the problem is here - do you have access to the server-side processing?  Or a reference for the API you can share?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1567628618, "post_id": 57794037, "comment_id": 102023458, "body": "Have you tried running the same XHR from Google Chrome console? In JavaScript you can model the JSON as an object and not as a simple String. If you still don&#39;t manage, then the issue is in the content of your request and should probably be seen on server side (we can&#39;t really help you with that). Else, it&#39;s  a syntax error in your JSON&#39;s string in VBA (in this second case, it makes sense to ask for help to troubleshoot here)."}, {"owner": {"reputation": 21, "user_id": 9286606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9771ce33b25279cfbf9561188b768b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Maggie", "link": "https://stackoverflow.com/users/9286606/maggie"}, "edited": false, "score": 0, "creation_date": 1567691058, "post_id": 57794037, "comment_id": 102045372, "body": "I downloaded WizTools.org RESTClient to try to POST straight json code into the database and it worked. I used the same URL, and specified application/json; charset=UTF-8. When I submitted in the headers tab I see: Content-Type\tapplication/json &amp; Transfer-Encoding chunked so I added objHTTP.setRequestHeader &quot;Transfer-Encoding&quot;, &quot;chunked&quot; and charset=&quot;&quot;UTF-8&quot;&quot;&quot; to my ContentType Header to my code. Still get the same error. So Im thinking its a VBA issue? Thanks for your help!!"}, {"owner": {"reputation": 21, "user_id": 9286606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9771ce33b25279cfbf9561188b768b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Maggie", "link": "https://stackoverflow.com/users/9286606/maggie"}, "edited": false, "score": 0, "creation_date": 1567712017, "post_id": 57794037, "comment_id": 102055245, "body": "I tried printing my Json string to Excel and then pasting that in the WizTool RestClient and that went through so its something with the Object. Is there a way to embed the body into the object?"}, {"owner": {"reputation": 21, "user_id": 9286606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9771ce33b25279cfbf9561188b768b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Maggie", "link": "https://stackoverflow.com/users/9286606/maggie"}, "edited": false, "score": 0, "creation_date": 1569002309, "post_id": 57794037, "comment_id": 102468475, "body": "I was able to resolve the issue by changing my Object to WinHttp.WinHttpRequest.5.1"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 9286606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9771ce33b25279cfbf9561188b768b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Maggie", "link": "https://stackoverflow.com/users/9286606/maggie"}, "is_accepted": true, "score": 0, "last_activity_date": 1569440934, "creation_date": 1569440934, "answer_id": 58105619, "question_id": 57794037, "link": "https://stackoverflow.com/questions/57794037/excel-vba-rest-api-connection-post-json-syntax-error/58105619#58105619", "title": "Excel VBA REST API connection POST json syntax error", "body": "<p>I was able to resolve the issue by changing my Object to WinHttp.WinHttpRequest.5.1\nso: </p>\n\n<pre><code>Set objHTTP = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9286606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9771ce33b25279cfbf9561188b768b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Maggie", "link": "https://stackoverflow.com/users/9286606/maggie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 58105619, "answer_count": 1, "score": 0, "last_activity_date": 1569440934, "creation_date": 1567621909, "question_id": 57794037, "link": "https://stackoverflow.com/questions/57794037/excel-vba-rest-api-connection-post-json-syntax-error", "title": "Excel VBA REST API connection POST json syntax error", "body": "<p>I am trying to set up a REST API Post call to save excel data into an Oracle database however I am having an issue with the POST call. </p>\n\n<p>Error Message:{\"message\": \"ORA-01400 cannot insert Null into (....\\\"NUMBER\\\")\"} </p>\n\n<pre><code>Sub PostTry()\nSet objHTTP = CreateObject(\"MSXML2.ServerXMLHTTP\")\nURL = \"http:TESTURL\"\nobjHTTP.Open \"POST\", URL, False\nobjHTTP.setRequestHeader \"ContentType\", \"application/json\"\nDim Json As String\nJson = \"{\"\"number\"\":\"\"123456\"\", \"\"DATE_TESTED\"\":\"\"01-JAN-99\"\", \"\"DILUTION\"\":\"\"10\"\", \"\"LOG_LEVEL\"\":\"\"1\"\"}\"\nobjHTTP.send (Json)\nMsgBox (objHTTP.responseText)\nMsgBox (Json)\nEnd Sub\n</code></pre>\n\n<p>I have tried adding these things with no help. Error message persisted.</p>\n\n<pre><code>'objHTTP.setRequestHeader \"Accept\", \"application/json\"\n'objHTTP.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\n'objHTTP.setRequestHeader \"Authorization\", \"Bearer &lt;api secret id&gt;\"\n</code></pre>\n\n<p>If you have any suggestions for me that would be greatly appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 369, "user_id": 5620644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70050e5c09ce3171441cb1f0edc3bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Andras", "link": "https://stackoverflow.com/users/5620644/andras"}, "edited": false, "score": 1, "creation_date": 1567621237, "post_id": 57793686, "comment_id": 102020928, "body": "Instead of: <code>For Each b In rng=</code> did you want: <code>For Each b In rng.Cells</code> for what you seem to want to do? Otherwise it isn&#39;t going to look at each cells."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 369, "user_id": 5620644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70050e5c09ce3171441cb1f0edc3bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Andras", "link": "https://stackoverflow.com/users/5620644/andras"}, "edited": false, "score": 1, "creation_date": 1567621561, "post_id": 57793686, "comment_id": 102021046, "body": "@AndrasDorko without parameters, <code>.Cells</code> is entirely redundant in a case like this."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567622065, "post_id": 57793686, "comment_id": 102021277, "body": "FYI <a href=\"http://www.rubberduckvba.com/\" rel=\"nofollow noreferrer\">Rubberduck</a> inspections are flagging <a href=\"http://rubberduckvba.com/Inspections/Details/ImplicitActiveSheetReference\" rel=\"nofollow noreferrer\">Implicit ActiveSheet references</a>, <code>Rng</code> being <a href=\"http://rubberduckvba.com/Inspections/Details/UndeclaredVariable\" rel=\"nofollow noreferrer\">undeclared</a> (which probably means <a href=\"http://rubberduckvba.com/Inspections/Details/OptionExplicit\" rel=\"nofollow noreferrer\">Option Explicit is missing</a> too), and warns about the <code>Top =</code> assignment implicitly assigning to <code>Range.[_Default]</code>, <a href=\"http://rubberduckvba.com/Inspections/Details/VariableNotAssigned\" rel=\"nofollow noreferrer\">used without being assigned</a> - that&#39;s why you get error 91."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567622448, "post_id": 57793686, "comment_id": 102021443, "body": "Also, you can&#39;t legally declare <code>top As Range</code> twice"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 7, "last_activity_date": 1567621553, "last_edit_date": 1567621553, "creation_date": 1567620346, "answer_id": 57793723, "question_id": 57793686, "link": "https://stackoverflow.com/questions/57793686/vba-store-address-within-loop-as-a-new-range-variable/57793723#57793723", "title": "VBA - Store Address within loop as a new range variable", "body": "<p>Missing <code>Set</code> (this is required when assigning values to object-type variables):    </p>\n\n<pre><code>Set top = Range(b.Offset(1, 1).Address)\n</code></pre>\n\n<p>but would be better as</p>\n\n<pre><code>Set top = b.Offset(1, 1)\n</code></pre>\n\n<p><code>b.Offset(1, 1)</code> is already a <code>Range</code> object, so no need to convert it to <code>Address</code> and then back to <code>Range</code>.</p>\n"}], "owner": {"reputation": 809, "user_id": 6301517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bae3b1b6120f28d727740eb0695836a2?s=128&d=identicon&r=PG&f=1", "display_name": "Yolo_chicken", "link": "https://stackoverflow.com/users/6301517/yolo-chicken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 57793723, "answer_count": 1, "score": 1, "last_activity_date": 1567621802, "creation_date": 1567620187, "last_edit_date": 1567621802, "question_id": 57793686, "link": "https://stackoverflow.com/questions/57793686/vba-store-address-within-loop-as-a-new-range-variable", "title": "VBA - Store Address within loop as a new range variable", "body": "<p>I am trying to get a new range of a cell inside a loop, and get the following error with my current code:</p>\n\n<blockquote>\n  <p>Object variable or With block variable not set</p>\n</blockquote>\n\n<p>This is my code and I tried looking off of <a href=\"https://stackoverflow.com/questions/24735803/store-location-of-cell-address-to-variable-in-vba\">this</a> question. The error comes from the <code>top= ...</code> line</p>\n\n<pre><code>Private Sub test_sub()\n\n\n    Dim rngReference As Range, b As Range, top as Range\n    Dim top As Range\n\n    Set rng= Workbooks(\"file.xlsx\").Worksheets(1).Columns(1)\n\n    For Each b In rng= \n    ' Look for cell that meets criteria\n        If InStr(1, b.Text, \"THIS CELL\") &gt; 0 Then\n        ' Store offset of current cell as new range\n            top = Range(b.Offset(1, 1).Address)\n\n            Debug.Print b.Address; b.Offset(1, 1).Address; top \n        End If\n\n    Next b\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "visio"], "comments": [{"owner": {"reputation": 687, "user_id": 7990528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gWVHp.png?s=128&g=1", "display_name": "Surrogate", "link": "https://stackoverflow.com/users/7990528/surrogate"}, "edited": false, "score": 0, "creation_date": 1567694401, "post_id": 57793623, "comment_id": 102047400, "body": "<a href=\"http://visguy.com/vgforum/index.php?topic=8898.msg39076#msg39076\" rel=\"nofollow noreferrer\">Cross-post</a>"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1567755054, "post_id": 57793623, "comment_id": 102065785, "body": "I&#39;ll check it out later, but you can just do <code>For each shp in selection</code> instead of the whole iterating..."}], "owner": {"reputation": 135, "user_id": 11045902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea760863dccef139e9632394db4693c?s=128&d=identicon&r=PG&f=1", "display_name": "Jon G", "link": "https://stackoverflow.com/users/11045902/jon-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567619859, "creation_date": 1567619859, "question_id": 57793623, "link": "https://stackoverflow.com/questions/57793623/changing-layout-of-org-chart-subordinates-in-vba-does-not-work", "title": "Changing layout of Org Chart subordinates in VBA does not work", "body": "<p>In Visio 2019 Standard, I have an org chart that I have created using the Org Chart Wizard, and I would like to change the layout of the subordinates in the org chart via a macro. I have found some code that should do the trick (see below), but the line that should be changing the layout is not changing the layout at all.</p>\n\n<p>From <a href=\"https://www.experts-exchange.com/questions/26988890/Possible-to-automatically-Arrange-Subordinates-re-layout-Visio-2003-org-chart-shapes-in-the-Org-Chart-stencil.html\" rel=\"nofollow noreferrer\">this page</a> I found that I should add something like this in my macro:</p>\n\n<pre><code>Call visio.Application.Addons(\"OrgC11\").Run(\"/toolbar_horiz1\")\n</code></pre>\n\n<p><a href=\"https://www.office-forums.com/threads/org-charts-auto-arrange-in-vba.1621640/\" rel=\"nofollow noreferrer\">This page</a> has something similar, but one of the poster's brought up a question about the version of Visio, and I'm not sure if that's relevant or not so I am including it here.</p>\n\n<p>I am running a macro based on the code attached to the first page, and here's what the relevant portion looks like:</p>\n\n<pre><code>    For i = 1 To sel.Count\n        Set shp = sel(i)\n        If shp.CellExists(\"User.Solsh\", False) Then\n            If shp.Cells(\"User.Solsh\").Formula = \"{0BF98B35-200C-41D5-8A23-20EF77CBC94A}\" Then\n                If shp.Cells(\"User.ShapeType\").ResultInt(visNoCast, False) = 1 Then     ' MANAGER\n                    ActiveWindow.Select shp, visDeselectAll + visSelect\n\n                    Call Visio.Application.Addons(\"OrgC11\").Run(\"/toolbar_horiz1\")\n\n                End If\n            End If\n        End If\n    Next i\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1567629614, "post_id": 57793618, "comment_id": 102023842, "body": "Actually, this hasn&#39;t changed. But if all the code you show is in the same code module then the event cannot work (and should not have worked in 2007). Content control events <i>must be</i> in the <code>ThisDocument</code> module."}], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 6105609, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4e882ca417f9f45432e0d7f799e609a7?s=128&d=identicon&r=PG", "display_name": "paulhr", "link": "https://stackoverflow.com/users/6105609/paulhr"}, "is_accepted": false, "score": 0, "last_activity_date": 1567697259, "creation_date": 1567697259, "answer_id": 57808681, "question_id": 57793618, "link": "https://stackoverflow.com/questions/57793618/after-upgrading-to-ms-word-2016-the-method-document-contentcontrolonexit-does-no/57808681#57808681", "title": "After upgrading to MS Word 2016 the method Document_ContentControlOnExit does not fire", "body": "<p>This mistake was what Cindy Meister pointed out.  When I copied the macro code from the old to the new template I failed to notice the location in the Visual Basic Editor.  Once the code was in the correct place it worked.</p>\n\n<p><a href=\"https://i.stack.imgur.com/xmtsT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xmtsT.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 149, "user_id": 6105609, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4e882ca417f9f45432e0d7f799e609a7?s=128&d=identicon&r=PG", "display_name": "paulhr", "link": "https://stackoverflow.com/users/6105609/paulhr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567697259, "creation_date": 1567619827, "last_edit_date": 1567629531, "question_id": 57793618, "link": "https://stackoverflow.com/questions/57793618/after-upgrading-to-ms-word-2016-the-method-document-contentcontrolonexit-does-no", "title": "After upgrading to MS Word 2016 the method Document_ContentControlOnExit does not fire", "body": "<p>I was on MS Word 2007 where the macros worked fine.\nAfter upgrading to MS Word 2016 the method Document_ContentControlOnExit does not fire.\nSince I write very few MS Word macros I don\u2019t keep up on fundamental change to the architecture.  Has something changed in MS Word 2016 that would cause the code to stop working?</p>\n\n<p>The set of methods will detect a Content Control exit.  Then update all Content Controls with the same tag name with the new value. </p>\n\n<p>I have put a breakpoint in Document_ContentControlOnExit.  Then made some changes to a Content Control.  Nothing.</p>\n\n<pre><code>Sub SetUp()  \n    Set eventHandler.doc = ActiveDocument  \nEnd Sub  \nSub Document_Close()  \n    Call UpdateAllFields  \nEnd Sub  \n\nPrivate Sub Document_ContentControlOnExit(ByVal ContentControl As ContentControl, Cancel As Boolean)  \n   ccTag = ContentControl.Tag  \n   ccValue = ContentControl.Range.Text  \n   Call updateValueInAllInstances(ccTag, ccValue)  \nEnd Sub  \n\nSub updateValueInAllInstances(ccTag, ccValue)  \n    Dim doc As Document  \n    Dim ccs As ContentControls  \n    Dim cc As ContentControl  \n    Set doc = ActiveDocument  \nFor Each cc In doc.SelectContentControlsByTag(ccTag)  \n    ' If the author of the document did not lock the contents, then perform a auto update.  \n    If cc.LockContents Then  \n        Respose = MsgBox(\"The author of this cookbook has deliberately designed this specific content control to not be editable.\", 0, \"Content Control is not editable\", \"\", 1000)  \n    Else  \n        cc.Range.Text = ccValue  \n    End If  \nNext cc  \nEnd Sub  \n\nSub UpdateAllFields()  \n    Dim objStory As Range  \n    Dim objTOC As TableOfContents  \n    Dim objTOA As TableOfAuthorities  \n    Dim objTOF As TableOfFigures  \n    Dim objIndex As Index  \n\n    Application.ScreenUpdating = False  \n    Application.DisplayAlerts = wdAlertsNone  \n\n    For Each objStory In ActiveDocument.StoryRanges  \n        UpdateFieldsInStory objStory  \n\n        While Not (objStory.NextStoryRange Is Nothing)  \n            Set objStory = objStory.NextStoryRange  \n            UpdateFieldsInStory objStory  \n        Wend  \n    Next  \n\n    For Each objTOC In ActiveDocument.TablesOfContents\n        objTOC.Update  \n    Next  \n\n    For Each objTOA In ActiveDocument.TablesOfAuthorities\n        objTOA.Update  \n    Next  \n\n    For Each objTOF In ActiveDocument.TablesOfFigures\n        objTOF.Update  \n    Next  \n\n    For Each objIndex In ActiveDocument.Indexes\n        objIndex.Update  \n    Next  \n\n    Application.DisplayAlerts = wdAlertsAll  \n    Application.ScreenUpdating = True\nEnd Sub  \nPrivate Sub UpdateFieldsInStory(iobjStory As Range)  \n    Dim objShape As Shape  \n\n    With iobjStory\n        .Fields.Update\n\n        Select Case .StoryType\n            Case wdMainTextStory, wdPrimaryHeaderStory, _\n              wdPrimaryFooterStory, wdEvenPagesHeaderStory, _\n              wdEvenPagesFooterStory, wdFirstPageHeaderStory, _\n              wdFirstPageFooterStory\n\n                For Each objShape In .ShapeRange\n                    With objShape.TextFrame\n                        If .HasText Then .TextRange.Fields.Update\n                    End With\n                Next\n        End Select\n    End With\nEnd Sub\n</code></pre>\n\n<p>I was hoping the code was not so out of date that it would keep working.</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010"], "comments": [{"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 2, "creation_date": 1567619935, "post_id": 57793571, "comment_id": 102020373, "body": "Are you working with a Continuous Form?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 4, "creation_date": 1567621480, "post_id": 57793571, "comment_id": 102021007, "body": "Multiple fields for cars sounds like non-normalized data structure. What if employee has more than 2 cars?"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1567628679, "post_id": 57793571, "comment_id": 102023485, "body": "Use a table for cars, with the employees ID as foreignkey (1:n) and have a subform on the form for the cars of employee (unlimited)! If you insist on that structure, you can use conditional format or Detail_Paint event to make control invisible."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 3, "creation_date": 1567632960, "post_id": 57793571, "comment_id": 102024975, "body": "I love data structures that force awful pivot queries later down the road lol"}], "owner": {"reputation": 11, "user_id": 11841859, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jkq7_LbtV_s/AAAAAAAAAAI/AAAAAAAAAAg/DMKCM46C7PE/photo.jpg?sz=128", "display_name": "Victor Mendon&#231;a Nogueira", "link": "https://stackoverflow.com/users/11841859/victor-mendon%c3%a7a-nogueira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594449953, "creation_date": 1567619634, "last_edit_date": 1594449953, "question_id": 57793571, "link": "https://stackoverflow.com/questions/57793571/how-can-i-set-visible-true-for-only-this-record-in-ms-access", "title": "How can I set visible = true for only this record in MS Access?", "body": "<p>I want to be able to add more fields depending on how many cars this employee have.</p>\n\n<p>I tried set Me.textfield.Visible = True\nSo it initiates with Visible = False, then when the button '+' is pressed the textfield is shown, but it won't work how I expected</p>\n\n<p>When I do :</p>\n\n<pre><code>Private Sub mostracarro2_Click()\n\n    Me.labelmodelo2.Visible = True\n    Me.Modelo2.Visible = True\n\n    Me.labelplaca2.Visible = True\n    Me.Placa2.Visible = True\n\n    Me.mostracarro3.Visible = True\nEnd Sub\n</code></pre>\n\n<p>All of the others records fields are set for true, but I just wanted to change this record field.</p>\n\n<p>If a employee has just one single car I want just one text field to be shown.</p>\n\n<p>If a employee has more than one car I want to have two text field to be shown.</p>\n\n<p>how can I do it in MS Access 2010?</p>\n"}, {"tags": ["vba", "ms-access", "combobox", "ms-access-forms"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1567621865, "post_id": 57793361, "comment_id": 102021187, "body": "First. ADODB provides <a href=\"https://stackoverflow.com/questions/10352211/vba-ado-connection-and-query-parameters\">parameter</a> that you should use to pass SP arguments!. Any bit-fields on rsYesNo? Show field-types."}, {"owner": {"reputation": 41, "user_id": 11810218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aeTRx-CorFs/AAAAAAAAAAI/AAAAAAAABBU/NI1789Vfatk/photo.jpg?sz=128", "display_name": "TooOldForThis", "link": "https://stackoverflow.com/users/11810218/toooldforthis"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1567625851, "post_id": 57793361, "comment_id": 102022747, "body": "I have used the command and parameter for ADODB, however there is nothing wrong with how the above is coded.  rsYesNo returns 2 columns with values Yes, -1 and No, 0.  I have changed the stored procedure to return different values. and the form still freezes."}, {"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 1, "creation_date": 1567663758, "post_id": 57793361, "comment_id": 102031100, "body": "You don&#39;t assign <code>rsYesNo</code>, but <code>rsCmbApplyRatio</code> to <code>cboYesNo.Recordset</code>: <code>Set Me.cboYesNo.Recordset = rsCmbApplyRatio</code>. Maybe this causes the issue? What field type is <code>YesNo</code> in SQL Server? Try <code>smallint</code> instead of a boolean type."}, {"owner": {"reputation": 41, "user_id": 11810218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aeTRx-CorFs/AAAAAAAAAAI/AAAAAAAABBU/NI1789Vfatk/photo.jpg?sz=128", "display_name": "TooOldForThis", "link": "https://stackoverflow.com/users/11810218/toooldforthis"}, "edited": false, "score": 0, "creation_date": 1567694538, "post_id": 57793361, "comment_id": 102047472, "body": "I have been working on this issue for days, I have tried changing the Row Source Type from &quot;Value List&quot; (Row Source = &quot;YES&quot;;-1;&quot;NO&quot;;0) changing the column count of the Combobox to 1 and passing &#39;YES&#39; or &#39;NO&#39; Back in the stored procedure, or even casting the bit value to an integer and modifying the row source accordingly.  In a perfect world, decision be to re-write the front end in VB.net, but this world is not perfect."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 0, "creation_date": 1568170579, "post_id": 57793361, "comment_id": 102186012, "body": "Try<code>&quot;YES&quot;;True;&quot;NO&quot;;False</code>as Value-List (Col Count + Bound Col = 2)  You recognized @UnhandledException hint to wrong RS assignment (implicating missing<code>Option Explicit</code> ) and request to show field-type of<code>YesNo</code>(Adodb RS type too)  <code>Click_Event</code>is very late raised. Events Dirty, Before/AfterUpdate are raised before click."}], "owner": {"reputation": 41, "user_id": 11810218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aeTRx-CorFs/AAAAAAAAAAI/AAAAAAAABBU/NI1789Vfatk/photo.jpg?sz=128", "display_name": "TooOldForThis", "link": "https://stackoverflow.com/users/11810218/toooldforthis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594449965, "creation_date": 1567618707, "last_edit_date": 1594449965, "question_id": 57793361, "link": "https://stackoverflow.com/questions/57793361/why-does-an-unbound-combobox-cause-the-access-database-to-freeze", "title": "Why does an unbound combobox cause the access database to freeze?", "body": "<p>I have a sub-form (it is a continuous form) that was previously bound to a query in an Access database, now I am un-binding all the controls on the form to link the form to a SQL Server database.  </p>\n\n<p>There are 3 combo boxes on the form, with the following Row Sources:</p>\n\n<ol>\n<li>Row source type of <code>Value List</code>.</li>\n<li><code>Table/Query</code>.</li>\n<li><code>Value List</code> with <code>Yes</code> or <code>No</code> values.  </li>\n</ol>\n\n<p>All 3 combo boxes populate correctly, but when changing the value in Combo box #3, everything freezes, and I have to right click to force the Parent form to close. This does not happen when I change the values in the other two combo boxes.</p>\n\n<p>I have tried changing the number of columns on the combo box from two (<code>\"Yes\";-1;\"No\";0</code>) to one (<code>\"YES\";\"NO\"</code>), changing the row source type to <code>Table/Query</code> and populating the combo box via a stored procedure, I added the <code>on click</code> event and put a break point within the event.  When I change the value, the freeze occurs before entering the <code>on click</code> sub.  </p>\n\n<pre><code>Private Sub Form_Load()\n\n    On Error GoTo Err_Handler\n\n    Dim strError As String\n    Dim lngCompanyID As Long\n    Dim lngTabulationID As Long\n    Dim dblTtlCEDEPosition As Double\n    Dim dblTtlTotalBNTreasury As Double\n\n    Dim cnn As ADODB.Connection\n    Dim rs As ADODB.Recordset\n    Dim rsCmbJob As ADODB.Recordset\n    Dim rsCmbClass As ADODB.Recordset\n    Dim rsYesNo As ADODB.Recordset\n\n    lngTabulationID = KeyTabulationID\n    lngCompanyID = mstrCompanyID\n\n    Set cnn = New ADODB.Connection\n        cnn.Open gconConnectOLEDB\n\n    Set rs = New ADODB.Recordset\n    With rs\n      Set .ActiveConnection = cnn\n          .Source = \"EXEC spLoadTabulatlatedClassInfo \" &amp; lngTabulationID\n          .LockType = adLockOptimistic\n          .CursorType = adOpenKeyset\n          .CursorLocation = adUseClient\n          .Open\n    End With\n    Set rs.ActiveConnection = Nothing\n    Set Me.Recordset = rs\n\n    Me.txtTabulationID.ControlSource = \"TabulationID\"\n    Me.txtJobID.ControlSource = \"JobID\"\n    Me.txtPlanID.ControlSource = \"PlanID\"\n    Me.cboClass.ControlSource = \"Class\"\n    Me.txtRatio.ControlSource = \"Ratio\"\n    Me.txtVotes.ControlSource = \"Votes\"\n    Me.cboYesNo.ControlSource = \"YesNo\"\n    Me.txtLineItem.ControlSource = \"LineItem\"\n    Me.cboJobName.ControlSource = \"JobName\"\n\n    Set rsCmbClass = New ADODB.Recordset\n    With rsCmbClass\n      Set .ActiveConnection = cnn\n          .Source = \"EXEC spLoadClassComboLoad \" &amp; lngCompanyID\n          .LockType = adLockOptimistic\n          .CursorType = adOpenKeyset\n          .CursorLocation = adUseClient\n          .Open\n    End With\n    Set rsCmbClass.ActiveConnection = Nothing\n    Set Me.cboClass.Recordset = rsCmbClass\n\n    '   Set rsYesNo = New ADODB.Recordset\n    '   With rsYesNo\n    '     Set .ActiveConnection = cnn\n    '         .Source = \"EXEC uspLoadYesNoCombo\"\n    '         .LockType = adLockOptimistic\n    '         .CursorType = adOpenKeyset\n    '         .CursorLocation = adUseClient\n    '        .Open\n    '   End With\n    '   Set rsYesNo.ActiveConnection = Nothing\n    '   Set Me.cboYesNo.Recordset = rsCmbApplyRatio\n\nExit_Handler:\n    On Error Resume Next\n\n    If LenB(strError) Then\n        MsgBox strError, vbCritical, Me.Name &amp; \".FormLoad\"\n    End If\n\n    If Not (rs Is Nothing) Then\n       rs.Close\n       Set rs = Nothing\n    End If\n\n    If Not (rsCmbJob Is Nothing) Then\n       rsCmbJob.Close\n       Set rsCmbJob = Nothing\n    End If\n\n   If Not (rsCmbClass Is Nothing) Then\n      rsCmbClass.Close\n      Set rsCmbClass = Nothing\n   End If\n\n'   If Not (rsYesNo Is Nothing) Then\n'      rsYesNo.Close\n'      Set rsYesNo = Nothing\n'   End If\n\n   If Not (cnn Is Nothing) Then\n      If Not (cnn.State = adStateClosed) Then cnn.Close\n      Set cnn = Nothing\n   End If\n\n   Exit Sub\n\nErr_Handler:\n    strError = \"Error \" &amp; Err.Number &amp; \": \" &amp; Err.Description\n    Resume Exit_Handler\nEnd Sub\n</code></pre>\n\n<p>I encounter this same issue on other sub-forms where there is a Yes/No combo box.  </p>\n\n<p>Any help will be appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1567618615, "post_id": 57793305, "comment_id": 102019877, "body": "Please do not add a image of your code - copy and paste it in your question"}, {"owner": {"reputation": 11, "user_id": 12021184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195cddedd4abb20398524f068aafa07d?s=128&d=identicon&r=PG&f=1", "display_name": "Ram_298", "link": "https://stackoverflow.com/users/12021184/ram-298"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1567619034, "post_id": 57793305, "comment_id": 102020037, "body": "Thank you! I am new to this site and still trying to figure it out. @urdearboy"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1567620497, "post_id": 57793305, "comment_id": 102020613, "body": "Looks like you have two loops when you probably only need one. What cells are selected when you run the code?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1567620624, "post_id": 57793305, "comment_id": 102020674, "body": "You can use Step 2 to skip every other row - you only need one loop for this though. For counter = start to end step 2 should suffice"}], "answers": [{"tags": [], "owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "is_accepted": false, "score": 0, "last_activity_date": 1567623313, "creation_date": 1567623313, "answer_id": 57794336, "question_id": 57793305, "link": "https://stackoverflow.com/questions/57793305/how-to-add-a-data-bar-in-every-other-cell-within-a-range-of-cells/57794336#57794336", "title": "How to Add a Data Bar in Every Other Cell within a Range of Cells?", "body": "<p>You need to use <code>step 2</code> for your counter. You also need <code>Counter</code> to be defined as an object for <code>Rows</code>. Hope this example helps:</p>\n\n<pre><code>Sub ShadeEveryOtherRow()\n    Dim Counter As Integer\n    Dim rng As Range\n    Set rng = ActiveSheet.Range(\"N4:N120\")\n    Dim cell As Range\n\n   'For every row in the current selection...\n    For Counter = 1 To rng.Rows.Count Step 2\n        rng.Rows(Counter).FormatConditions.AddDatabar\n\n    Next Counter\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12021184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195cddedd4abb20398524f068aafa07d?s=128&d=identicon&r=PG&f=1", "display_name": "Ram_298", "link": "https://stackoverflow.com/users/12021184/ram-298"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1567664812, "creation_date": 1567618389, "last_edit_date": 1567664812, "question_id": 57793305, "link": "https://stackoverflow.com/questions/57793305/how-to-add-a-data-bar-in-every-other-cell-within-a-range-of-cells", "title": "How to Add a Data Bar in Every Other Cell within a Range of Cells?", "body": "<p>I have coded a specific type of data bar I need in excel. I'm trying to apply this data bar to every other cell in a range of cells. It keeps applying it to all of my cell in my specific range instead of every other one. This is driving me crazy! Please help!</p>\n\n<pre><code>Sub ShadeEveryOtherRow()\n    Dim Counter As Integer\n    Dim rng As Range\n    Set rng = ActiveSheet.Range(\"N4:N120\")\n    Dim cell As Range\n\n   'For every row in the current selection...\n    For Counter = 1 To Selection.Rows.Count\n        'If the row is an odd number (within the selection)...\n        For Each cell In rng.Cells\n            If Counter Mod 2 = 1 Then\n                Call Add_Data_Bar(cell, cell.Value)\n                End If\n            Next cell\n        Next Counter\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 5, "creation_date": 1567617581, "post_id": 57793074, "comment_id": 102019474, "body": "Why are you writting <code>**</code> and you need to insert formulas like this: <code>Cells(LinhaAba, 20).FormulaR1C1 = &quot;=YOURFORMULA&quot;</code>"}, {"owner": {"reputation": 15, "user_id": 11300319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PlxJtBAx-tA/AAAAAAAAAAI/AAAAAAAAAik/xHzw9sR8Kwo/photo.jpg?sz=128", "display_name": "Ines Lopes", "link": "https://stackoverflow.com/users/11300319/ines-lopes"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1567619341, "post_id": 57793074, "comment_id": 102020150, "body": "I didn&#39;t put the **, they aren&#39;t appearing in the code on the VBA"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567619484, "post_id": 57793074, "comment_id": 102020194, "body": "<code>Cells(row, column) = 42</code> is assigning to <i>the value</i>, not the <i>formula</i> (the <code>=</code> probably makes it the formula, but that doesn&#39;t default to R1C1 AFAIK). That said you have <code>RC[...]</code> notation in one place, and <code>R2C4,RC9</code> in the other. <code>RC5</code> looks like a valid A1-style cell reference. So, fix the R1C1 notation and assign to <code>.FormulaR1C1</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1567620012, "post_id": 57793074, "comment_id": 102020407, "body": "Why do you have <code>CHR(10)</code> in the <i>formula</i>?"}, {"owner": {"reputation": 15, "user_id": 11300319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PlxJtBAx-tA/AAAAAAAAAAI/AAAAAAAAAik/xHzw9sR8Kwo/photo.jpg?sz=128", "display_name": "Ines Lopes", "link": "https://stackoverflow.com/users/11300319/ines-lopes"}, "edited": false, "score": 0, "creation_date": 1567620397, "post_id": 57793074, "comment_id": 102020567, "body": "I didn&#39;t write the formula on VBA, I wrote it directly on my cell and recorded the macro so it converted it to code... I&#39;m not sure why there&#39;s Chr(10).  I&#39;ll edit my question to include the formula itself, without coding"}], "owner": {"reputation": 15, "user_id": 11300319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PlxJtBAx-tA/AAAAAAAAAAI/AAAAAAAAAik/xHzw9sR8Kwo/photo.jpg?sz=128", "display_name": "Ines Lopes", "link": "https://stackoverflow.com/users/11300319/ines-lopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567629783, "creation_date": 1567617279, "last_edit_date": 1567622122, "question_id": 57793074, "link": "https://stackoverflow.com/questions/57793074/vba-wont-input-formula-on-range", "title": "VBA won&#39;t input formula on range", "body": "<p>I've got a macro where I want it to apply a formula to some cells. For the R1C1 formula to be right I recorded only the formula.\nWhen I went to test it I got the error 1004, but there's a range selected, so I'm not sure what's wrong...</p>\n\n<p>If someone could please help me, I'm quite stuck. Thanks!</p>\n\n<pre><code>UltLinhaBD = Cells(800, 1).End(xlUp).Row\n\n        For LinhaAba = 2 To UltLinhaBD\n\n            If Cells(LinhaAba, 1) &lt;&gt; \"\" Then\n                Cells(LinhaAba, 20) = _\n                    \"=IF(AND(RC5=Infos!R2C4,RC9='Premissas Financeiras'!R6C2,RC3='Premissas Financeiras'!R2C3),(-RC16*'Premissas Financeiras'!R6C3),\" &amp; Chr(10) &amp; \"IF(AND(RC5=Infos!R2C4,RC9='Premissas Financeiras'!R7C2,RC3='Premissas Financeiras'!R2C3),(-RC16*'Premissas Financeiras'!R7C3),\" &amp; Chr(10) &amp; \"IF(AND(RC5=Infos!R2C4,RC9='Premissas Financeiras'!R6C2,RC3='Premissas Financeiras'!R2C4),(-RC16*'Premissas Financ\" &amp; _\n                    \"6C4),\" &amp; Chr(10) &amp; \"IF(AND(RC5=Infos!R2C4,RC9='Premissas Financeiras'!R7C2,RC3='Premissas Financeiras'!R2C4),(-RC16*'Premissas Financeiras'!R7C4),\" &amp; Chr(10) &amp; \"IF(AND(RC5=Infos!R2C4,RC9='Premissas Financeiras'!R6C2,RC3='Premissas Financeiras'!R2C5),(-RC16*'Premissas Financeiras'!R6C5),\" &amp; Chr(10) &amp; \"IF(AND(RC5=Infos!R2C4,RC9='Premissas Financeiras'!R7C2,RC3='Premissas Financeiras'!R2C5),(-RC16*'Premissas F\" &amp; _\n                    \"s'!R7C5),))))))\"\n                Cells(LinhaAba, 22) = \"=-RC[-2]*RC[-1]\"\n                Cells(LinhaAba, 4) = \"Dedu\u00e7\u00e3o\"\n            End If\n\n        Next LinhaAba\n\n\n\n</code></pre>\n\n<p>The formula itself is:</p>\n\n<pre><code>=IF(AND($E3=Infos!$D$2;$I3='Premissas Financeiras'!$B$6;$C3='Premissas Financeiras'!$C$2);(-$P3*'Premissas Financeiras'!$C$6); IF(AND($E3=Infos!$D$2;$I3='Premissas Financeiras'!$B$7;$C3='Premissas Financeiras'!$C$2);(-$P3*'Premissas Financeiras'!$C$7); IF(AND($E3=Infos!$D$2;$I3='Premissas Financeiras'!$B$6;$C3='Premissas Financeiras'!$D$2);(-$P3*'Premissas Financeiras'!$D$6); IF(AND($E3=Infos!$D$2;$I3='Premissas Financeiras'!$B$7;$C3='Premissas Financeiras'!$D$2);(-$P3*'Premissas Financeiras'!$D$7); IF(AND($E3=Infos!$D$2;$I3='Premissas Financeiras'!$B$6;$C3='Premissas Financeiras'!$E$2);(-$P3*'Premissas Financeiras'!$E$6); IF(AND($E3=Infos!$D$2;$I3='Premissas Financeiras'!$B$7;$C3='Premissas Financeiras'!$E$2);(-$P3*'Premissas Financeiras'!$E$7);))))))\n\n</code></pre>\n\n<p>I used the macro recorder to convert it into vba, since I don't really know how to use the .FormulaR1C1 notation well.</p>\n\n<p>The full sub is:</p>\n\n<pre><code>\nSub Dedu\u00e7\u00f5es()\n\nDim Aba As String\nDim iCounter As Long\nDim Coluna As Long\nDim Linha As Long\nDim ColAba As Long\nDim LinhaAba As Long\nDim UltLinhaAba As Long\nDim UltLinhaBD As Long\n\nDim rng1 As Range\nDim rng2 As Range\nDim rng3 As Range\n\nDim Iniciativa As String\nDim Tipo As String\nDim Ano As Long\n\n\n' Dedu\u00e7\u00f5es\n\n' Inserir fun\u00e7\u00e3o que multiplica total da receita \u00e0 premissa de dedu\u00e7\u00e3o e fun\u00e7\u00e3o que multiplica valor unit\u00e1rio pela qtde\n    Sheets(\"Dedu\u00e7\u00f5es\").Select\n\n        Range(\"T2\").Select\n        ActiveCell.FormulaR1C1 = \"=RC[-4]*'Premissas Financeiras'!R7C3\"\n        Range(\"T2\").Select\n        Selection.AutoFill Destination:=Range(\"T2:T7\"), Type:=xlFillDefault\n\n\n        UltLinhaBD = Cells(800, 1).End(xlUp).Row\n\n        For LinhaAba = 2 To UltLinhaBD\n\n            If Cells(LinhaAba, 1) &lt;&gt; \"\" Then\n                Cells(LinhaAba, 20) = \"=RC[-4]*'Premissas Financeiras'!R7C3\"\n                Cells(LinhaAba, 22) = \"=-RC[-2]*RC[-1]\"\n                Cells(LinhaAba, 4) = \"Dedu\u00e7\u00e3o\"\n            End If\n\n        Next LinhaAba\n\n' Colar quantidade\n    Columns(\"Q:Q\").Select\n    Selection.Copy\n    Columns(\"U:U\").Select\n    ActiveSheet.Paste\n\n' Colar valor\n    Columns(\"T:V\").Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n' Deletar colunas indesejadas\n    Columns(\"P:S\").Select\n    Selection.Delete\n\n    UltLinhaBD = Cells(500, 1).End(xlUp).Row\n\n    For LinAba = 2 To UltLinhaBD\n\n        If Cells(LinAba, 1).Value = \"INICIATIVA\" Then\n            Cells(LinAba, 1).EntireRow.Delete\n        End If\n\n    Next LinAba\n\n' Cabe\u00e7alho\n\n    Cells(1, 1).Value = \"INICIATIVA\"\n    Cells(1, 2).Value = \"TIPO\"\n    Cells(1, 3).Value = \"ANO\"\n    Cells(1, 4).Value = \"R/D\"\n    Cells(1, 5).Value = \"AGRUPAMENTO\"\n    Cells(1, 6).Value = \"ETAPA\"\n    Cells(1, 7).Value = \"CAT 3\"\n    Cells(1, 8).Value = \"CAT 4\"\n    Cells(1, 9).Value = \"CAT 5\"\n    Cells(1, 10).Value = \"CAT 6\"\n    Cells(1, 11).Value = \"DETALHAMENTO\"\n    Cells(1, 12).Value = \"EMPRESA\"\n    Cells(1, 13).Value = \"CONTRIBUI\u00c7\u00c3O\"\n    Cells(1, 14).Value = \"UNIDADE\"\n    Cells(1, 15).Value = \"VIS\u00c3O\"\n    Cells(1, 16).Value = \"VALOR UNIT\u00c1RIO\"\n    Cells(1, 17).Value = \"QUANTIDADE\"\n    Cells(1, 18).Value = \"TOTAL\"\n    Cells(1, 19).Value = \"OBS\"\n\n\nSheets(\"Dedu\u00e7\u00f5es\").Select\n\n    Set rng1 = Cells.Find(\"*\", [a1], xlFormulas, , xlByRows, xlPrevious)\n    Set rng2 = Cells.Find(\"*\", [a1], xlFormulas, , xlByColumns, xlPrevious)\n    If Not rng1 Is Nothing Then\n        Set rng3 = Range([a1], Cells(rng1.Row, rng2.Column))\n        'if you need to actual select the range (which is rare in VBA)\n        Application.Goto rng3\n    Else\n        MsgBox \"sheet is blank\", vbCritical\n    End If\n\n    Selection.Copy\n    Sheets(\"BD\").Select\n    Range(\"A900\").Select\n    Selection.End(xlUp).Select\n    Selection.Offset(1, 0).Select\n    ActiveSheet.Paste\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2016"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1567621239, "post_id": 57792567, "comment_id": 102020929, "body": "You convert the wrong value, as<code>Amount</code>is text, it has to be converted to a number, rgen compare to controls. <code>Me.Tag = &quot;CCur(Nz(Amoun,0)t) Between &quot; &amp; CCur(Nz(Me.Between1.Vakue),0))</code>.Avoid that (and convert the field to number at table-level) as this prents the usage of an index on<code>Amount</code>. Use &#39;speaking&#39; names for controls, vars, etc .... Unsing tag as filter storage can `confuse, if tag is used otherwise."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 4, "creation_date": 1567624719, "post_id": 57792567, "comment_id": 102022307, "body": "Why is Amount field text and not number type?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1567685722, "post_id": 57792567, "comment_id": 102042217, "body": "<i>sometimes records can be lost while changing Data Types.</i> No. You don&#39;t &quot;just change&quot; data type. Never."}], "owner": {"reputation": 1, "user_id": 9661307, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Benzion weberman", "link": "https://stackoverflow.com/users/9661307/benzion-weberman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594449975, "creation_date": 1567614878, "last_edit_date": 1594449975, "question_id": 57792567, "link": "https://stackoverflow.com/questions/57792567/filter-by-amount-in-ms-access-query-text-data-type-field-with-vba", "title": "Filter by Amount in MS Access Query Text Data Type Field with VBA", "body": "<p>I have a Table the Field <code>[Amount]</code> is a text field and I need to filter between two amounts.</p>\n\n<p>I changed the date type in the table and it works, but sometimes records can be lost while changing Data Types.</p>\n\n<pre><code>Me.Tag = \"Amount Between \" &amp; CCur(Me.Text93) &amp; \" And \" &amp; CCur(Me.Text94)\nMe.Child77.Report.Filter = Me.Tag\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1503, "user_id": 3451919, "user_type": "registered", "profile_image": "https://graph.facebook.com/1514889262/picture?type=large", "display_name": "Aedvald Tseh", "link": "https://stackoverflow.com/users/3451919/aedvald-tseh"}, "edited": false, "score": 1, "creation_date": 1567612579, "post_id": 57791972, "comment_id": 102017265, "body": "are there any error messages shown ?"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 1, "creation_date": 1567612768, "post_id": 57791972, "comment_id": 102017359, "body": "As I Said in my <a href=\"https://stackoverflow.com/a/57792039/11167163\">answer</a> I think that you need to try with Application.Run . Don&#39;t least to read the <b>Note</b> Even if you are using <code>Excel.Run</code>"}, {"owner": {"reputation": 302, "user_id": 11958215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9htzU.jpg?s=128&g=1", "display_name": "Breno Teodoro", "link": "https://stackoverflow.com/users/11958215/breno-teodoro"}, "reply_to_user": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1567613279, "post_id": 57791972, "comment_id": 102017644, "body": "@Dorian to address the issue you&#39;ve indicated, the macro could also have the other workbook set as an object variable, right? This way, we ensure it&#39;s opened via the code itself."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 302, "user_id": 11958215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9htzU.jpg?s=128&g=1", "display_name": "Breno Teodoro", "link": "https://stackoverflow.com/users/11958215/breno-teodoro"}, "edited": false, "score": 0, "creation_date": 1567613382, "post_id": 57791972, "comment_id": 102017699, "body": "Sure @BrenoTeodoro I am not behinf my computer yet i will update my answer so if he don\u2019t know how to do he will know :)"}, {"owner": {"reputation": 13, "user_id": 12020711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b816ab8df1e6042f94cc758cd4832ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/12020711/aaron"}, "reply_to_user": {"reputation": 1503, "user_id": 3451919, "user_type": "registered", "profile_image": "https://graph.facebook.com/1514889262/picture?type=large", "display_name": "Aedvald Tseh", "link": "https://stackoverflow.com/users/3451919/aedvald-tseh"}, "edited": false, "score": 0, "creation_date": 1567624135, "post_id": 57791972, "comment_id": 102022073, "body": "@Aedvald Tseh No error messages appear when running this. It just doesn&#39;t run properly.  @Dorian I tried running with <code>Application.Run</code> instead of <code>Excel.Run</code> but it did not make a difference."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12020711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b816ab8df1e6042f94cc758cd4832ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/12020711/aaron"}, "edited": false, "score": 0, "creation_date": 1567616496, "post_id": 57792039, "comment_id": 102019029, "body": "This is the process I used. That&#39;s what this is:       <code>Excel.Run &quot;Macros.xlsm!OrderNumbers()&quot;</code>  I ran it both with and without the single quotes. And I also ran it with both workbooks open. No dice."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 13, "user_id": 12020711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b816ab8df1e6042f94cc758cd4832ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/12020711/aaron"}, "edited": false, "score": 0, "creation_date": 1567617108, "post_id": 57792039, "comment_id": 102019277, "body": "@Aaron do you have any error message so I can identify your real issue ?"}, {"owner": {"reputation": 13, "user_id": 12020711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b816ab8df1e6042f94cc758cd4832ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/12020711/aaron"}, "edited": false, "score": 0, "creation_date": 1567617297, "post_id": 57792039, "comment_id": 102019365, "body": "No error messages pop up. When I call that first macro, it runs it two times, but it works. When I call the second macro, nothing happens."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 13, "user_id": 12020711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b816ab8df1e6042f94cc758cd4832ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/12020711/aaron"}, "edited": false, "score": 0, "creation_date": 1567617451, "post_id": 57792039, "comment_id": 102019423, "body": "@Aaron The best way to solve this issue is to use the debugger so you understand what is doing your macro. Do you know how it works ?  <b>NB</b> I edited my answer to make your <code>FillFormulas</code> sub avoid <code>Select</code>"}, {"owner": {"reputation": 13, "user_id": 12020711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b816ab8df1e6042f94cc758cd4832ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/12020711/aaron"}, "edited": false, "score": 0, "creation_date": 1567621769, "post_id": 57792039, "comment_id": 102021152, "body": "I changed the <code>FillFormulas()</code> macro to what you have above, but it still did not work. I ran through the debugger. When running through each line in the macro database, it worked fine. But when running through the <code>Application.Run &quot;&#39;Another Workbook.xlsm&#39;!NameOfMacro&quot;</code>, there is some kind of disconnect. Same results as before, runs the first macro double, second one doesn&#39;t run at all."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 13, "user_id": 12020711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b816ab8df1e6042f94cc758cd4832ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/12020711/aaron"}, "edited": false, "score": 0, "creation_date": 1567685194, "post_id": 57792039, "comment_id": 102041927, "body": "@Aaron can you put the entiere sub where you call macros from other workbooks ? I will try to debug it"}, {"owner": {"reputation": 13, "user_id": 12020711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b816ab8df1e6042f94cc758cd4832ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/12020711/aaron"}, "edited": false, "score": 0, "creation_date": 1567719824, "post_id": 57792039, "comment_id": 102057890, "body": "In my original question, the <code>Private Sub OrderNumbers()</code> and <code>Private Sub Start_Click()</code> are the full codes I am using. <code>Private Sub OrderNumbers()</code> is in the database and <code>Private Sub Start_Click()</code> is in the individual worksheets."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 13, "user_id": 12020711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b816ab8df1e6042f94cc758cd4832ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/12020711/aaron"}, "edited": false, "score": 0, "creation_date": 1567722316, "post_id": 57792039, "comment_id": 102058465, "body": "@Aaron and what if you delete <code>()</code> : <code>Excel.Run &quot;Macros.xlsm!OrderNumbers&quot;</code>"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 13, "user_id": 12020711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b816ab8df1e6042f94cc758cd4832ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/12020711/aaron"}, "edited": false, "score": 0, "creation_date": 1567780837, "post_id": 57792039, "comment_id": 102078341, "body": "@Aaron Glad I could help you"}], "tags": [], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "is_accepted": true, "score": 3, "last_activity_date": 1567617348, "last_edit_date": 1567617348, "creation_date": 1567612531, "answer_id": 57792039, "question_id": 57791972, "link": "https://stackoverflow.com/questions/57791972/how-to-call-a-macro-from-another-workbook/57792039#57792039", "title": "How to call a macro from another workbook?", "body": "<p>What about <code>Application.Run</code></p>\n\n<pre><code>Application.Run \"'Another Workbook.xlsm'!NameOfMacro\"\n</code></pre>\n\n<p>The <code>'</code> marks are needed when the workbook name contains a space. If there is no space, the <code>'</code> marks are not required.  The code will still run correctly if they are included, so I recommend to use them for consistency.</p>\n\n<p><strong>NOTE :</strong> That the <code>workbook</code> which contains the macro <strong>MUST</strong> be open. If the <code>workbook</code> isn't open you will need to open it before runing the macro.</p>\n\n<p>Hope this helps, Waiting for your feedbacks.</p>\n\n<p><strong>BONUS</strong> It's better to avoid <code>select</code> so I did it for you : </p>\n\n<pre><code>Private Sub FillFormulas()\n\nDim myValue3 As Long\nmyValue3 = Range(\"A13\").Value\nRange(\"B2\").AutoFill Destination:=Range(\"B2:B\" &amp; myValue3)\nRange(\"C2\").AutoFill Destination:=Range(\"C2:C\" &amp; myValue3)\nRange(\"D2\").AutoFill Destination:=Range(\"D2:D\" &amp; myValue3)\nRange(\"E2\").AutoFill Destination:=Range(\"E2:E\" &amp; myValue3)\nRange(\"F2\").AutoFill Destination:=Range(\"F2:F\" &amp; myValue3)\nRange(\"G2\").AutoFill Destination:=Range(\"G2:G\" &amp; myValue3)\nRange(\"H2\").AutoFill Destination:=Range(\"H2:H\" &amp; myValue3)\nRange(\"I2\").AutoFill Destination:=Range(\"I2:I\" &amp; myValue3)\nRange(\"J2\").AutoFill Destination:=Range(\"J2:J\" &amp; myValue3)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12020711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b816ab8df1e6042f94cc758cd4832ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/12020711/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 57792039, "answer_count": 1, "score": 1, "last_activity_date": 1567617348, "creation_date": 1567612317, "question_id": 57791972, "link": "https://stackoverflow.com/questions/57791972/how-to-call-a-macro-from-another-workbook", "title": "How to call a macro from another workbook?", "body": "<p>I deal with order processing for a few retailers at my business and I manipulate the orders in excel worksheets. I import data from a query for each retailer and this process is the same across the 4 or 5 different accounts. But later steps differ, so each retailer has its own workbook. </p>\n\n<p>What I am attempting to do is automate the process of importing the data from the query to each workbook through the use of formulas in the workbook as well as VBA. But I wanted to consolidate the macros into one workbook (basically a macro database other worksheets can call from) since I don't want to have to change the code in 5 separate workbooks every time I make an adjustment.</p>\n\n<p>I have already attempted to put the code in the macro database and then just call the macro from each individual workbook and some of it has somewhat worked.</p>\n\n<p>Here is one of the macros I originally had in each workbook and it works fine when in each workbook.</p>\n\n<pre><code>Private Sub OrderNumbers()\n\nDim myValue1 As Variant\nDim myValue2 As Variant\nmyValue1 = InputBox(\"What is your first order number?\")\nmyValue2 = InputBox(\"What is your last order number?\")\nRange(\"A7\").Value = myValue1\nRange(\"A9\").Value = myValue2\n\nEnd Sub\n</code></pre>\n\n<p>Here is another macro.</p>\n\n<pre><code>Private Sub FillFormulas()\n\nDim myValue3 As Long\nmyValue3 = Range(\"A13\").Value\nRange(\"B2\").Select\nSelection.AutoFill Destination:=Range(\"B2:B\" &amp; myValue3)\nRange(\"C2\").Select\nSelection.AutoFill Destination:=Range(\"C2:C\" &amp; myValue3)\nRange(\"D2\").Select\nSelection.AutoFill Destination:=Range(\"D2:D\" &amp; myValue3)\nRange(\"E2\").Select\nSelection.AutoFill Destination:=Range(\"E2:E\" &amp; myValue3)\nRange(\"F2\").Select\nSelection.AutoFill Destination:=Range(\"F2:F\" &amp; myValue3)\nRange(\"G2\").Select\nSelection.AutoFill Destination:=Range(\"G2:G\" &amp; myValue3)\nRange(\"H2\").Select\nSelection.AutoFill Destination:=Range(\"H2:H\" &amp; myValue3)\nRange(\"I2\").Select\nSelection.AutoFill Destination:=Range(\"I2:I\" &amp; myValue3)\nRange(\"J2\").Select\nSelection.AutoFill Destination:=Range(\"J2:J\" &amp; myValue3)\n\nEnd Sub\n</code></pre>\n\n<p>I then moved the code to the database, and in each retailer workbook I put this code connected to buttons:</p>\n\n<pre><code>Private Sub Start_Click()\nExcel.Run \"Macros.xlsm!OrderNumbers()\"\nEnd Sub \n</code></pre>\n\n<p>For the OrderNumbers() macro, it calls it, but it calls it twice for some reason. However, the FillFormulas() macro doesn't work at all.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 30124, "user_id": 334849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f39fc02c4a24b3c4825dae3d850004a?s=128&d=identicon&r=PG", "display_name": "LittleBobbyTables - Au Revoir", "link": "https://stackoverflow.com/users/334849/littlebobbytables-au-revoir"}, "edited": false, "score": 2, "creation_date": 1567610442, "post_id": 57791423, "comment_id": 102016120, "body": "What&#39;s your question?"}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1567618387, "post_id": 57791423, "comment_id": 102019795, "body": "@Clive I rewrote his question, can you take it off of hold so I can answer?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1567665012, "post_id": 57791423, "comment_id": 102031535, "body": "Note that <code>Dim NP, i As Integer</code> only declares <code>i</code> as <code>Integer</code> but <code>NP</code> as <code>Variant</code>. In VBA you must specify a type for <b>every</b> variable (otherwise it is <code>Variant</code> by default): <code>Dim NP As Double, i As Long</code> Also <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long/26409520#26409520\">I recommend to use <code>Long</code> instead of <code>Integer</code></a> and <code>Double</code> for <code>NP</code>."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1567665643, "creation_date": 1567665643, "answer_id": 57799732, "question_id": 57791423, "link": "https://stackoverflow.com/questions/57791423/how-can-i-multiply-the-price-by-the-correct-currency-value/57799732#57799732", "title": "How can I multiply the price by the correct currency Value", "body": "<p>If the data looks like in the sheet below</p>\n\n<p><a href=\"https://i.stack.imgur.com/gEbgt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gEbgt.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can do that with a simple formula in column L</p>\n\n<pre><code>=INDEX(J:J,MATCH(F:F,I:I,0))*D:D\n</code></pre>\n\n<p>It uses the <a href=\"https://support.office.com/en-us/article/match-function-e8dffd45-c762-47d6-bf89-533f4a37673a\" rel=\"nofollow noreferrer\">MATCH function</a> to find the currency (column F) in the currency list (column I) and return its row number. And combines it with the <a href=\"https://support.office.com/en-us/article/index-function-a5dcf0dd-996d-40a4-a822-b56b061328bd\" rel=\"nofollow noreferrer\">INDEX function</a> to return the currency factor (column J) of that matched row, to finally multiply it with the price (column D).</p>\n"}, {"tags": [], "owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "is_accepted": false, "score": 0, "last_activity_date": 1567691248, "creation_date": 1567691248, "answer_id": 57806972, "question_id": 57791423, "link": "https://stackoverflow.com/questions/57791423/how-can-i-multiply-the-price-by-the-correct-currency-value/57806972#57806972", "title": "How can I multiply the price by the correct currency Value", "body": "<p>Try this. Your biggest problem was how you were declaring your variables. Also, the <code>P = 1 + i</code> helps you to avoid running an infinite loop in the first cell. Hope this helps!</p>\n\n<pre><code>Sub NP()\n\n    Dim NP As Long\n    Dim i As Long\n    Dim P As Long\n    Dim curr As String\n\n    For i = 2 To 10\n    P = Cells(i, 4)\n    curr = Cells(i, 6)\n        If curr = \"HKD\" Then\n            NP = Range(\"J2\").Value * P\n        ElseIf curr = \"USD\" Then\n            NP = Range(\"J3\").Value * P\n        Else\n            NP = Range(\"J4\").Value * P\n        End If\n    P = 1 + i\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 12020643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MyeEnyhoaIo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rerLK0Tdjkfxa5krf66xC4ny8vy4w/photo.jpg?sz=128", "display_name": "Timothy Chan", "link": "https://stackoverflow.com/users/12020643/timothy-chan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1567691248, "creation_date": 1567610331, "last_edit_date": 1567665652, "question_id": 57791423, "link": "https://stackoverflow.com/questions/57791423/how-can-i-multiply-the-price-by-the-correct-currency-value", "title": "How can I multiply the price by the correct currency Value", "body": "<p>Just started learning VBA</p>\n\n<p>I want to multiply the product price with the currency value to get a new price.</p>\n\n<pre><code>No      Name    Quantity Price Product Currency OrderID       Currency  $\n1       Tim     5       5       A       HKD     RX12            HKD 1\n2       Alan    6       5       A       HKD     PR22            USD 7.8\n3       Alan    2       6       B       USD     PR22            CAN 6\n4       Bob     3       5       A       HKD     ED45            \n5       Bob     8       8       C       CAN     ED45            \n6       Tim     10      6       B       USD     AS63            \n7       Rose    12      8       C       CAN     LM36            \n8       Cathy   15      6       B       USD     JI48            \n9       Rose    2       5       A       HKD     HG54            \n10      Tim     8       6       B       USD     VB87            \n</code></pre>\n\n<p>Here's the code I've tried so far. I keep getting object not defined errors. How can I fix this?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub NP()\n\n    Dim NP, i As Integer\n    NP = Range(\"L2:L11\").Value\n\n    For i = 1 To 10\n        P = Cells(4, i)\n        curr = Cells(6, i)\n\n        If curr = \"HKD\" Then\n            NP = Range(\"J2\").Value * P    \n        ElseIf curr = \"USD\" Then\n            NP = Range(\"J3\").Value * P    \n        Else\n            NP = Range(\"J4\").Value * P\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1580420155, "post_id": 57791292, "comment_id": 106102122, "body": "If it is possible to do this thing with a locked screen and Excel/VBA is simply being stubborn, then you may have success with a different type of ugly workaround - using Shell to copy the image with a different application."}, {"owner": {"reputation": 7510, "user_id": 1132334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8o6Nl.png?s=128&g=1", "display_name": "Cee McSharpface", "link": "https://stackoverflow.com/users/1132334/cee-mcsharpface"}, "edited": false, "score": 0, "creation_date": 1583769853, "post_id": 57791292, "comment_id": 107219238, "body": "this makes sense (the desktop window station is kind of &quot;paused&quot; while the lock screen is shown) and the behavior may differ between windows versions. excel cannot receive input and will likely not update its output anyway, so what is your application trying to achieve by capturing it while it is locked?"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 3438328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b113249f479235e18148f137fd10da5?s=128&d=identicon&r=PG&f=1", "display_name": "Alessandro", "link": "https://stackoverflow.com/users/3438328/alessandro"}, "is_accepted": false, "score": 0, "last_activity_date": 1587672211, "last_edit_date": 1587672211, "creation_date": 1587560604, "answer_id": 61365854, "question_id": 57791292, "link": "https://stackoverflow.com/questions/57791292/vba-copypicture-fails-on-locked-screen-error-1004-cannot-empy-clipboard/61365854#61365854", "title": "VBA CopyPicture fails on locked screen (&quot;error 1004 cannot empy clipboard&quot;)", "body": "<p>I had the same trouble and solved with a workaround: no lock of the screen using a Keyboard and Mouse blocker like this: <a href=\"https://sourceforge.net/projects/winkeylock/\" rel=\"nofollow noreferrer\">https://sourceforge.net/projects/winkeylock/</a></p>\n"}], "owner": {"reputation": 357, "user_id": 9376540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b67df096848bee2c49f9abb33bfffbda?s=128&d=identicon&r=PG&f=1", "display_name": "jabba", "link": "https://stackoverflow.com/users/9376540/jabba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1587672211, "creation_date": 1567609893, "last_edit_date": 1580415454, "question_id": 57791292, "link": "https://stackoverflow.com/questions/57791292/vba-copypicture-fails-on-locked-screen-error-1004-cannot-empy-clipboard", "title": "VBA CopyPicture fails on locked screen (&quot;error 1004 cannot empy clipboard&quot;)", "body": "<p>I have a simple VBA code that copies range (some charts and tables) using CopyPicture and saves it as .gif file. Everything works perfectly when the screen is unlocked but when it's locked, Excel throws 1004 error: \"cannot empty the clipboard\" from time to time (about 40% of attempts).</p>\n\n<p>I think I've tried everything:\n<br> - Every solution given in similar thread:\n<a href=\"https://stackoverflow.com/questions/24740062/copypicture-method-of-range-class-failed-sometimes\">CopyPicture method of range class failed - sometimes</a>\n<br> - Doing some error handling by waiting 5s and trying to repeat <code>(Application.Wait (Now + TimeValue(\"00:00:05\")))</code>\n<br> - Turning screenupdating to true <code>Application.Screenupdating=True</code>\n<br> - Clearing clipboard using some of solutions given in this thread:\n<a href=\"https://stackoverflow.com/questions/32736915/how-to-clear-office-clipboard-with-vba\">How to Clear Office Clipboard with VBA</a>\n<br> But nothing worked.</p>\n\n<p>Some sample code:</p>\n\n<pre><code>Function print(ByVal wb As Workbook, ByVal path As String, ByVal name As String)\n\nDim RNG as Range\nDim chtObj As ChartObject\nsFile = path &amp; name\n\nApplication.EnableEvents = False\n\nSet RNG = Sheets(1).Range(\"A1:M50\")\nwb.Activate\nApplication.CutCopyMode = False\nWith RNG  \n    .CopyPicture Appearance:=xlScreen, Format:=xlBitmap  **&lt;-- this is where code fails**\n    Set chtObj = ActiveSheet.ChartObjects.Add( _\n    .Left, .top, .Width, .Height)\n    chtObj.Chart.ChartArea.Format.Line.Visible = msoFalse\nEnd With\n\nchtObj.Chart.Paste\nApplication.CutCopyMode = False\nchtObj.Chart.Export sFile\nchtObj.Delete\n\nApplication.EnableEvents = True\nEnd Function\n\n</code></pre>\n\n<p>I'm using Windows 10 and Wxcel 2013.</p>\n\n<p>I am thinking of doing some ugly workaround by looping this function until it passes but that's the last thing I'd like to do.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 3, "creation_date": 1567610434, "post_id": 57791285, "comment_id": 102016114, "body": "What is the problem with the code you are currently using?"}, {"owner": {"reputation": 31, "user_id": 12000060, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAWHEs_nTC_mDe9KHG156DUlcChXs-v7jYQVv1Ppg=k-s128", "display_name": "jaydip dudhatra", "link": "https://stackoverflow.com/users/12000060/jaydip-dudhatra"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1567611030, "post_id": 57791285, "comment_id": 102016435, "body": "I am getting the run-time error : &#39;424&#39;"}, {"owner": {"reputation": 31, "user_id": 12000060, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAWHEs_nTC_mDe9KHG156DUlcChXs-v7jYQVv1Ppg=k-s128", "display_name": "jaydip dudhatra", "link": "https://stackoverflow.com/users/12000060/jaydip-dudhatra"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1567611077, "post_id": 57791285, "comment_id": 102016454, "body": "So basically I want to run the code which saves each excel sheets seperately except sheet 1."}], "answers": [{"comments": [{"owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "reply_to_user": {"reputation": 31, "user_id": 12000060, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAWHEs_nTC_mDe9KHG156DUlcChXs-v7jYQVv1Ppg=k-s128", "display_name": "jaydip dudhatra", "link": "https://stackoverflow.com/users/12000060/jaydip-dudhatra"}, "edited": false, "score": 0, "creation_date": 1567617105, "post_id": 57791602, "comment_id": 102019276, "body": "You&#39;re welcome. :) Please accept my answer so others can benefit from it."}, {"owner": {"reputation": 31, "user_id": 12000060, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAWHEs_nTC_mDe9KHG156DUlcChXs-v7jYQVv1Ppg=k-s128", "display_name": "jaydip dudhatra", "link": "https://stackoverflow.com/users/12000060/jaydip-dudhatra"}, "edited": false, "score": 0, "creation_date": 1567624360, "post_id": 57791602, "comment_id": 102022157, "body": "How I can do that ?"}, {"owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "reply_to_user": {"reputation": 31, "user_id": 12000060, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAWHEs_nTC_mDe9KHG156DUlcChXs-v7jYQVv1Ppg=k-s128", "display_name": "jaydip dudhatra", "link": "https://stackoverflow.com/users/12000060/jaydip-dudhatra"}, "edited": false, "score": 0, "creation_date": 1567624625, "post_id": 57791602, "comment_id": 102022270, "body": "To mark an answer as accepted, click on the check mark beside the answer to toggle it from greyed out to filled in. More info here: <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}], "tags": [], "owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "is_accepted": false, "score": 3, "last_activity_date": 1567611041, "creation_date": 1567611041, "answer_id": 57791602, "question_id": 57791285, "link": "https://stackoverflow.com/questions/57791285/how-to-save-each-sheet-as-a-separate-workbook-except-sheet-1/57791602#57791602", "title": "How to save each sheet as a separate workbook except sheet 1?", "body": "<p>The problem is you were referring to <code>xWs</code> variable which doesn't exist on your code. If you change it with <code>Sheet</code>, it works perfectly as I tested on my Excel:</p>\n\n<pre><code>Sub SaveShtsAsBook()\n    Dim xcsvFile As String\n    Dim datestring As String\n    Dim Count As Integer\n\n    datestring = DateValue(Now) &amp; Time\n    datestring = Replace(datestring, \"/\", \"_\")\n    datestring = Replace(datestring, \":\", \"_\")\n    datestring = Replace(datestring, \" \", \"_\")\n\n'    Application.WindowState = xlMinimized\n'    Application.Visible = False\n\n    Application.EnableEvents = True\n   ' Application.Calculation = xlCalculationManual\n  '  Application.Wait (Now + TimeValue(\"0:00:10\"))\n\n    For Count = 1 To 3000\n        DoEvents\n    Next Count\n\n\n    'For Each Sheet In Worksheets\n    For Each Sheet In ThisWorkbook.Worksheets ' Safer way to qualify the worksheets with the workbook where this code lies\n\n        Select Case Sheet.Name\n            Case \"Sheet1\"\n            ' do nothing\n\n            Case Else\n            xcsvFile = \"E:\\\" &amp; Sheet.Name &amp; \"_\" &amp; datestring &amp; \".csv\"\n            ' xcsvFile = \"E:\\\" &amp; \"\\\" &amp; xWs.Name &amp; \".csv\" 'compare mine to yours to see issues\n\n            Sheet.Copy\n\n            Dim newSheet As Workbook 'setting copied sheet to workbook variable for easier coding\n            Set newSheet = ActiveSheet.Parent 'parent of worksheet is workbook\n\n            newSheet.SaveAs Filename:=xcsvFile, FileFormat:=xlCSV, CreateBackup:=False\n            newSheet.Close False\n        End Select\n    Next\nEnd Sub\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 31, "user_id": 12000060, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAWHEs_nTC_mDe9KHG156DUlcChXs-v7jYQVv1Ppg=k-s128", "display_name": "jaydip dudhatra", "link": "https://stackoverflow.com/users/12000060/jaydip-dudhatra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1567663079, "creation_date": 1567609855, "last_edit_date": 1567663079, "question_id": 57791285, "link": "https://stackoverflow.com/questions/57791285/how-to-save-each-sheet-as-a-separate-workbook-except-sheet-1", "title": "How to save each sheet as a separate workbook except sheet 1?", "body": "<p>I have an excel workbook with 5 sheets but I only want to save sheet 2 to sheet - 5  but I don't want to save sheet 1. I want to exclude it from saving. How can I do it? </p>\n\n<p>I have tried some codes but I am having difficulties. </p>\n\n<pre><code>Sub SaveShtsAsBook()\n\n    Dim xcsvFile As String\n    Dim datestring As String\n    Dim Count As Integer\n\n\n    datestring = DateValue(Now) &amp; Time\n    datestring = Replace(datestring, \"/\", \"_\")\n    datestring = Replace(datestring, \":\", \"_\")\n    datestring = Replace(datestring, \" \", \"_\")\n\n'    Application.WindowState = xlMinimized\n'    Application.Visible = False\n\n    Application.EnableEvents = True\n   ' Application.Calculation = xlCalculationManual\n  '  Application.Wait (Now + TimeValue(\"0:00:10\"))\n\n    For Count = 1 To 3000\n    DoEvents\n    Next Count\n\n\n    'For Each Sheet In Worksheets\n    For Each Sheet In ThisWorkbook.Worksheets ' Safer way to qualify the worksheets with the workbook where this code lies\n\n       Select Case Sheet.Name\n        Case \"Sheet1\"\n        ' do nothing\n\n        Case Else\n           xcsvFile = \"E:\\\" &amp; xWs.Name &amp; \"_\" &amp; datestring &amp; \".csv\"\n       ' xcsvFile = \"E:\\\" &amp; \"\\\" &amp; xWs.Name &amp; \".csv\" 'compare mine to yours to see issues\n\n        xWs.Copy\n\n        Dim newSheet As Workbook 'setting copied sheet to workbook variable for easier coding\n        Set newSheet = ActiveSheet.Parent 'parent of worksheet is workbook\n\n        newSheet.SaveAs Filename:=xcsvFile, FileFormat:=xlCSV, CreateBackup:=False\n        newSheet.Close False\n       End Select\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "gmail"], "answers": [{"tags": [], "owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "is_accepted": false, "score": 0, "last_activity_date": 1567612584, "last_edit_date": 1567612584, "creation_date": 1567608790, "answer_id": 57791011, "question_id": 57790800, "link": "https://stackoverflow.com/questions/57790800/how-to-change-the-from-on-the-email-i-sent-using-vba-for-gmail/57791011#57791011", "title": "how to change the .from on the email I sent using vba for gmail?", "body": "<p>Try using the following syntax:</p>\n\n<pre><code>Name Surname &lt;mymail@gmail.com&gt;\n</code></pre>\n\n<p>So in your code it would be like:</p>\n\n<pre><code>.From = \"John Doe &lt;johndoe@gmail.com&gt;\" \n</code></pre>\n\n<p>It should do the tricks.</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 21, "user_id": 12020447, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RQC0jTJFRSI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfU0d7w-zPyIJzg4TQA7PwkHu8yMw/photo.jpg?sz=128", "display_name": "jonathan taieb", "link": "https://stackoverflow.com/users/12020447/jonathan-taieb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1567612584, "creation_date": 1567608052, "last_edit_date": 1567608174, "question_id": 57790800, "link": "https://stackoverflow.com/questions/57790800/how-to-change-the-from-on-the-email-i-sent-using-vba-for-gmail", "title": "how to change the .from on the email I sent using vba for gmail?", "body": "<p>I am sending email using a CDO.Message on vba from my gmail account.\nall works fine, however, on my </p>\n\n<pre><code>With Mail\n    .From\n</code></pre>\n\n<p>I am inserting the email address I want to send it from. When it arrives, it arrives with the email address itself and not the name associated to the gmail account:\n.from = johndoe@gmail.com => the email will be received from \"johndoe@gmail.com\" instead of John Doe as defined on the gmail account.</p>\n\n<p>Is there any way to get the name instead of the email address?</p>\n\n<p>thanks,</p>\n\n<p>all works fine except this detail.</p>\n\n<pre><code>     With Mail\n               .Subject = subj\n               .From = Range(\"acct\").Value\n               .To = dest\n               '.To = Range(\"mailing\").Offset(i, 0).Value\n               .textbody = body\n               If att = \"\" Then GoTo noatt\n               attnb = 1\n               While Not IsEmpty(Range(\"attachement\").Offset(attnb, 0))\n              .AddAttachment (Range(\"attachement\").Offset(attnb, 0)) 'To attach Documents in mail\n             attnb = attnb + 1\n            Wend\nnoatt:\n            End With\n            'to send the mail\n            Mail.Send\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1567608001, "post_id": 57790601, "comment_id": 102014726, "body": "Quite a bit of <i>telling</i> and less <i>showing</i> here. Natural languages like English tend to be imprecise. Better to illustrate examples with actual data of input and expected output."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10295420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33bc5bbb2d26d6718212726f3835bcc?s=128&d=identicon&r=PG&f=1", "display_name": "HealyRT", "link": "https://stackoverflow.com/users/10295420/healyrt"}, "edited": false, "score": 0, "creation_date": 1567608644, "post_id": 57790739, "comment_id": 102015107, "body": "I was thinking of something along those lines! The issue is, the data is entered through a Userform that adds data to the next empty row.  And if there are formulas in the cells, the rows aren&#39;t considered empty.  So I am looking to dynamically do this stuff as data is entered, which is why I was looking for a VBA option to tag on to the end of the data entry form.  Trying to avoid post processing as much as possible."}, {"owner": {"reputation": 23, "user_id": 10295420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33bc5bbb2d26d6718212726f3835bcc?s=128&d=identicon&r=PG&f=1", "display_name": "HealyRT", "link": "https://stackoverflow.com/users/10295420/healyrt"}, "edited": false, "score": 0, "creation_date": 1567608727, "post_id": 57790739, "comment_id": 102015159, "body": "ALSO, the &quot;Overview&quot; sheet contacts have more than just the name in each cell. So it needs to Contain the name, but not exactly match it (because of the additional information in the cell)."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 23, "user_id": 10295420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33bc5bbb2d26d6718212726f3835bcc?s=128&d=identicon&r=PG&f=1", "display_name": "HealyRT", "link": "https://stackoverflow.com/users/10295420/healyrt"}, "edited": false, "score": 0, "creation_date": 1567609659, "post_id": 57790739, "comment_id": 102015707, "body": "@HealyRT You can use these formulas and tweak to fit VBA... literally have VBA paste the formula in, or you could have it calculate and output an answer... will update post to give example of each using the Contacts formula"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 23, "user_id": 10295420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33bc5bbb2d26d6718212726f3835bcc?s=128&d=identicon&r=PG&f=1", "display_name": "HealyRT", "link": "https://stackoverflow.com/users/10295420/healyrt"}, "edited": false, "score": 0, "creation_date": 1567610145, "post_id": 57790739, "comment_id": 102015953, "body": "@HealyRT see Edit1."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 4, "last_activity_date": 1567610135, "last_edit_date": 1567610135, "creation_date": 1567607830, "answer_id": 57790739, "question_id": 57790601, "link": "https://stackoverflow.com/questions/57790601/how-does-one-count-the-number-of-occurances-of-a-string-on-separate-worksheets/57790739#57790739", "title": "How does one count the number of occurances of a string on separate worksheets?", "body": "<p>Shouldn't need VBA for this, as you can do it with formulas...</p>\n\n<hr>\n\n<p>You can use <code>CountIf</code> for the names, where one on the Contact sheet is a simple </p>\n\n<pre><code>B1 = CountIf(Overview!A:A,A1) \n</code></pre>\n\n<p>and the Overview sheet itself would be a self-counting sheet, where </p>\n\n<pre><code>B2 = CountIf(A$2:A2,A2)\n</code></pre>\n\n<p>That doesn't account for needing to split your string to include the initials \"JD\", but it may be more appropriate to just define those on your contact sheet and <code>index/match</code> the output, concatenating with your countif, similar to</p>\n\n<pre><code>B2 = Index(Contacts!C:C,Match(A2,Contacts!A:A,0))&amp;\"-\"&amp;CountIf(A$2:A2,A2)\n</code></pre>\n\n<hr>\n\n<p>Assumed Layout for Sheets(\"Contacts\"):</p>\n\n<pre><code>ColA      ColB     ColC\nName      Count    Initials\nJohn Doe  5       JD\n</code></pre>\n\n<hr>\n\n<p><strong>Edit1:</strong></p>\n\n<p>Since the userform is inputting new lines (assumes you have found <code>lr</code> (last row) and will use that variable), you can adjust the formula to support input by VBA:</p>\n\n<pre><code>' to input formula as is to the sheet:\nCells(lr+1,2).value = \"=Index(Contacts!C:C,Match(A\" &amp; lr+1 &amp; \",Contacts!A:A))&amp;\"-\"&amp;CountIf(A$2:A\" &amp; lr+1 &amp; \",A\" &amp; lr+1 &amp; \")\"\n\n'tweak to have VBA do calc\nWith Sheets(\"Overview\")\n    Cells(lr+1,2).value = Application.Index(Sheets(\"Contacts\").Columns(3),Match(.Cells(lr+1,1).value,Sheets(\"Contacts\").Columns(1)) &amp; \"-\" &amp; Application.CountIf(.Range(.Cells(2,1),.Cells(lr+1,1)),.Cells(lr+1,1).value)\nEnd with\n\n'I use cell references above, but you may want to swap .Cells(lr+1,1).value with the TextBox.Value from the userform\n</code></pre>\n\n<p>I dropped the \"exact match\" (<code>0</code>) from the match formula, so take that with a grain of salt, which may require more effort to make fit your exact model.  </p>\n\n<p>It may behoove you to have pre-determined Contact names for people to select from (think drop down) so that you don't have variance in the names that can/need to be found.</p>\n"}], "owner": {"reputation": 23, "user_id": 10295420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33bc5bbb2d26d6718212726f3835bcc?s=128&d=identicon&r=PG&f=1", "display_name": "HealyRT", "link": "https://stackoverflow.com/users/10295420/healyrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1567610135, "creation_date": 1567607370, "last_edit_date": 1567607910, "question_id": 57790601, "link": "https://stackoverflow.com/questions/57790601/how-does-one-count-the-number-of-occurances-of-a-string-on-separate-worksheets", "title": "How does one count the number of occurances of a string on separate worksheets?", "body": "<p>I have a workbook that contains multiple worksheets used for data entry and status monitoring for a project I am on at work.  The \"Overview\" Worksheet contains multiple columns that have basic information [Number, Contact Info, Page Number, Issue, Comments, Status] (from columns A to F).  The \"Contact\" Column contains a user's Name, Phone Number, Email, and Organization all in one cell.</p>\n\n<p>Each Row is a unique entry but the Contact fields are reused based on if the same person has multiple inputs.</p>\n\n<p>I have another Worksheet that is named \"Contacts\" that has the same information from the \"Contact Info\" Cells in the \"Overview\" worksheet, but divided into individual columns [Name, Phone Number, Email, Organization] (from columns A to D).</p>\n\n<p>All of the code for the data entry is in a Userform that adds information to both worksheets, but specifically, the \"Contacts\" worksheet when a unique contact is submitted.</p>\n\n<p>There are no duplicate rows in the \"Contacts\" worksheet.</p>\n\n<p>Here's the problem:</p>\n\n<p>I want to keep track of the number of occurrences of each contact in the \"Overview\" worksheet on the \"Contacts\" worksheet. That count will also be used to keep a unique enumeration per each contact on the \"Overview\" worksheet. (i.e. John Doe has 5 entries, so the \"Number\" Column on the \n\"Overview\" worksheet will indicate \"JD-1\" \"JD-2\" \u2026 \"JD-5\" for each entry).</p>\n\n<p>The intent is to have an aggregated list of all of the inputs but have a unique numbering methodology for each unique contact.</p>\n\n<p>Any guidance will be greatly appreciated.</p>\n\n<p>Problem I have encountered:</p>\n\n<p>I would have used a CountIf type function in the cell but it gets out of my skill level going between worksheets.</p>\n\n<p>Also, the way the Contacts worksheet is populated is to append unique entries on the next empty row, so if there are formulas in the Cells, it will not be viewed as a empty row.</p>\n\n<p>This Workbook is used by multiple users and has to be functional from the beginning with a clean sheet.</p>\n"}, {"tags": ["arrays", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1567672795, "post_id": 57791167, "comment_id": 102035105, "body": "If there are 100 rows, this works just fine... but if you have thousands and more, iterating through each cell is not a good idea. The less you interact with the sheet, the better."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1567678623, "post_id": 57791167, "comment_id": 102038255, "body": "@FAB I am familiar with minimize interacting with the sheet, but actually reading a value from a sheet to an array, doesn&#39;t consume so much time. I have MACROs that I read 200,000 records to arrays, and it does so in few seconds. You should run a bench mark to test it"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1567678693, "post_id": 57791167, "comment_id": 102038284, "body": "@FAB and by the way, this is really not a reason to down vote my answer, as the code is correct, and answers the <b>PO</b> question."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1567682503, "post_id": 57791167, "comment_id": 102040326, "body": "&quot;Few seconds&quot;, several times can add up quite quickly to a minute, then few minutes. Is everyone&#39;s taste to be honest, but I prefer it to run faster than slower. As for your second comment, I would say that by posting a code that rectifies the OP, and it works, it doesn&#39;t necessarily mean is correct, nor that it answers the question. &quot;Am I doing this properly?&quot;  Being blunt, the correct answer was <code>NO</code>. As for how correct your answer is according to what OP asked, maybe you want to edit <code>.Range(&quot;B&quot; &amp; i).Value</code> to <code>.Range(&quot;B&quot; &amp; i + 5).Value</code>."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1567682910, "post_id": 57791167, "comment_id": 102040585, "body": "@FAB we are here to help users with their code issues, not to get in to argument who writes better code, but I guess not everyone is here for the same reasons."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1567609370, "creation_date": 1567609370, "answer_id": 57791167, "question_id": 57790592, "link": "https://stackoverflow.com/questions/57790592/storing-data-to-array-from-worksheet/57791167#57791167", "title": "Storing data to array from worksheet", "body": "<p>Almost, try the code below (find explanation inside code's comments):</p>\n\n<pre><code>Option Explicit\n\nSub List_Rem_stock()\n\nDim last_row_Rem_stock As Long, i As Long\nDim array_Rem_Batch() As Long\n\nWith Worksheets(\"Rem stock\")\n    last_row_Rem_stock = .Cells(.Rows.Count, \"B\").End(xlUp).Row ' get last row with value in colum B\n\n    ReDim array_Rem_Batch(1 To last_row_Rem_stock - 5) ' redim array size\n\n    For i = 1 To last_row_Rem_stock - 5\n        array_Rem_Batch(i) = .Range(\"B\" &amp; i).Value\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 12020316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b1013bc2629a5db14ed77d9c07f4ef?s=128&d=identicon&r=PG", "display_name": "Rere", "link": "https://stackoverflow.com/users/12020316/rere"}, "edited": false, "score": 0, "creation_date": 1567610784, "post_id": 57791401, "comment_id": 102016317, "body": "Great thanks! For the -5, because my list starts at B6, I thought I needed to dimension my array from 1 to the last row -5. If my last row is 100 then my list would actually have only 95 values?"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 23, "user_id": 12020316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b1013bc2629a5db14ed77d9c07f4ef?s=128&d=identicon&r=PG", "display_name": "Rere", "link": "https://stackoverflow.com/users/12020316/rere"}, "edited": false, "score": 0, "creation_date": 1567673337, "post_id": 57791401, "comment_id": 102035382, "body": "See additional edit... you&#39;re right about the -5, to get the number of the rows, but in your example you allocated data in the array from row 1 to row 100 - 5. Should have been more like <code>For i = 6 to lastrow</code> instead, <b>or</b> <code>array_Rem_Batch(i) = Worksheets(&quot;Rem stock&quot;).Range(&quot;B&quot; &amp; i + 5)</code>."}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": false, "score": 0, "last_activity_date": 1567673208, "last_edit_date": 1567673208, "creation_date": 1567610251, "answer_id": 57791401, "question_id": 57790592, "link": "https://stackoverflow.com/questions/57790592/storing-data-to-array-from-worksheet/57791401#57791401", "title": "Storing data to array from worksheet", "body": "<p>You can allocate a range to an array (2D) as such:</p>\n\n<p><code>Dim arrData as variant: arrData = Range(\"B1:B\" &amp; lastrow)</code>.</p>\n\n<p>You can also put the array back on the spreadsheet the same way:</p>\n\n<p><code>Range(\"B1:B\" &amp; lastrow) = arrData</code></p>\n\n<p>Simple, easy and fast, without the need of iterating through data.</p>\n\n<p>In your example, you would probably do it like this.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub List_Rem_stock()  \n\n    Dim i as Long\n    Dim array_Rem_Batch as variant\n    array_Rem_Batch = Worksheets(\"Rem stock\").Range(\"B1:B\" &amp; last_row_Rem_stock)\n\n    for i = 6 to last_row_Rem_stock\n         debug.print array_Rem_Batch(i, 1)\n    next i\n\nEnd Sub\n</code></pre>\n\n<p>To note that arrays allocated this way will always start at 1, not 0.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I'm allocating the data starting at row 1, and not at row 6, purely for the nice 1:1 relation between array index and sheet rows. Is my prefered way, wherever the situation allows.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    If array_Rem_Batch(i, 1) = Range(\"B\" &amp; i) Then ....\n</code></pre>\n\n<p>Can always allocate the data from any row you want:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    array_Rem_Batch = Worksheets(\"Rem stock\").Range(\"B6:B100\") 'now the array has 95 rows.\n</code></pre>\n\n<p>In this case, array index 1, will corespond to row 6 in the sheet, and will have to manage this in the code if you need to something like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    If array_Rem_Batch(i, 1) = Range(\"B\" &amp; i + 5) Then ....\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12020316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b1013bc2629a5db14ed77d9c07f4ef?s=128&d=identicon&r=PG", "display_name": "Rere", "link": "https://stackoverflow.com/users/12020316/rere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 57791167, "answer_count": 2, "score": 2, "last_activity_date": 1567673208, "creation_date": 1567607347, "last_edit_date": 1567665906, "question_id": 57790592, "link": "https://stackoverflow.com/questions/57790592/storing-data-to-array-from-worksheet", "title": "Storing data to array from worksheet", "body": "<p>I'm trying to analyze some data from a worksheet, the first step was to find the last row, which I managed. Then I need to store the data in an array for each column to simplify further analysis.</p>\n\n<p>My data looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/k2Ncb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k2Ncb.png\" alt=\"Data picture\"></a></p>\n\n<p>I'm trying to store let's say the B column in an array but starting at B6:</p>\n\n<pre><code>Sub List_Rem_stock()  \n\n    Dim array_Rem_Batch(1 To last_row_Rem_stock - 5) As Integer\n\n    For i = 1 To last_row_Rem_stock - 5\n        array_Rem_Batch(i) = Worksheets(\"Rem stock\").Range(Bi)\n    Next i\n    Debug.Print array_Rem_Index\n\nEnd Sub\n</code></pre>\n\n<p><code>last_row_Rem_stock</code> represents the last row of the table.\nAm I doing this properly?</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1567621827, "creation_date": 1567621827, "answer_id": 57794014, "question_id": 57790487, "link": "https://stackoverflow.com/questions/57790487/finding-the-record-that-would-come-before-and-after-a-given-number/57794014#57794014", "title": "Finding the record that would come before and after a given number", "body": "<p>There are many ways to obtain the information you require - you could obtain the preceding the succeeding sequence records for a given application &amp; sequence using the following SQL queries:</p>\n\n<p><strong>Preceding Sequence record:</strong></p>\n\n<pre><code>select top 1 t.* \nfrom submissions_tbl t\nwhere \n    t.st_appno_txt = [YourAppNo] and \n    t.st_sequence_txt &lt; [YourSequenceNo] \norder by \n    t.st_sequence_txt desc\n</code></pre>\n\n<p><strong>Succeeding Sequence record:</strong></p>\n\n<pre><code>select top 1 t.* \nfrom submissions_tbl t\nwhere \n    t.st_appno_txt = [YourAppNo] and \n    t.st_sequence_txt &gt; [YourSequenceNo] \norder by \n    t.st_sequence_txt\n</code></pre>\n\n<p>Alternatively, you could obtain the preceding or succeeding Sequence number using the <code>DMax</code> or <code>DMin</code> functions respectively:</p>\n\n<p><strong>Preceding Sequence Number:</strong></p>\n\n<pre><code>DMax(\"st_sequence_txt\", \"submissions_tbl\", \"st_appno_txt = '17638' and st_sequence_txt &lt; '3'\")\n</code></pre>\n\n<p><strong>Succeeding Sequence Number:</strong></p>\n\n<pre><code>DMin(\"st_sequence_txt\", \"submissions_tbl\", \"st_appno_txt = '17638' and st_sequence_txt &gt; '3'\")\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 6580302, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/10154199873940180/picture?type=large", "display_name": "Samara Galv&#227;o", "link": "https://stackoverflow.com/users/6580302/samara-galv%c3%a3o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594449990, "creation_date": 1567606943, "last_edit_date": 1594449990, "question_id": 57790487, "link": "https://stackoverflow.com/questions/57790487/finding-the-record-that-would-come-before-and-after-a-given-number", "title": "Finding the record that would come before and after a given number", "body": "<p>I have a table with a application number, sequence and date. When a new sequence number for an application is to be added, I need to check for the date of the previous sequence and the date for the sequence that would come after (if it exists).</p>\n\n<p>Table example:</p>\n\n<pre><code>APPNO   SEQUENCE   DATE\n17638       1      08/10/2019\n17638       2      08/12/2019\n17638       4      08/20/2019\n</code></pre>\n\n<p>If I want to add the same application with sequence=3, I would have to check for the date of the previous sequence and the one after. If I want to add the same application with sequence=5, I would only check for the date of the last sequence added. </p>\n\n<p>Using a record set how can I accomplish this? How can I loop through the record set and get the desired information in Access VBA?</p>\n\n<p>I have created a record set and set up the loop, but I don't know where to go from here. I am new to Access.</p>\n\n<p>Started with</p>\n\n<pre><code>strSql = \"SELECT ST_APPNO_TX, ST_SEQUENCE_TXT, ST_DATE_DT FROM SUBMISSIONS_TBL where ST_APPNO_TXT= = '\" &amp; appno &amp; \"' ORDER ST_SEQUENCE_TXT;\"\nmaxVal = DLookup(\"[MaxVal]\", \"[MaxSequence_qry]\", \"[ST_APPNO_TXT]=\" &amp; appno)\n\nSet cnnLocalConnection = CurrentProject.AccessConnection\n        Set rstSequence = New ADODB.Recordset\n\n        rstSequence.Open strSql, cnnLocalConnection, adOpenForwardOnly, adLockReadOnly\n        preSeq = \"\"\n        For N = 1 To rstSequence.RecordCount\n</code></pre>\n\n<p>I would like to get the value for the previous sequence and the sequence after (if it exists)</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 11724559, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WDpomKXErPE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reAxSRy0dKrkQtLiADHFOE46sPayA/photo.jpg?sz=128", "display_name": "Noelia Sancho Mendez", "link": "https://stackoverflow.com/users/11724559/noelia-sancho-mendez"}, "edited": false, "score": 0, "creation_date": 1567607376, "post_id": 57790406, "comment_id": 102014302, "body": "Thank you I thought if I defined the variables with commas and after I would put the value of the variable all the variables would take the same value."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 131, "user_id": 11724559, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WDpomKXErPE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reAxSRy0dKrkQtLiADHFOE46sPayA/photo.jpg?sz=128", "display_name": "Noelia Sancho Mendez", "link": "https://stackoverflow.com/users/11724559/noelia-sancho-mendez"}, "edited": false, "score": 4, "creation_date": 1567607462, "post_id": 57790406, "comment_id": 102014358, "body": "@NoeliaSanchoMendez Also, don&#39;t use <code>Integer</code> use <code>Long</code> instead unless you have a real use case for it <a href=\"https://stackoverflow.com/a/26409520/3042759\">Source</a>"}], "tags": [], "owner": {"reputation": 166, "user_id": 11384581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ7fG.jpg?s=128&g=1", "display_name": "TheJeebo", "link": "https://stackoverflow.com/users/11384581/thejeebo"}, "is_accepted": false, "score": 3, "last_activity_date": 1567606632, "creation_date": 1567606632, "answer_id": 57790406, "question_id": 57790299, "link": "https://stackoverflow.com/questions/57790299/enters-an-infinite-loop/57790406#57790406", "title": "Enters an infinite loop", "body": "<p>Try defining all the variables as integers, the first time through the <code>minum</code> variable was reading as a string and was never equaling the integer variable, I tried this one and it worked.</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nDim aleatorio As Integer, minum As Integer, fila As Integer\n\naleatorio = Math.Round(Math.Rnd * 100)\nDebug.Print aleatorio\n\nWhile aleatorio &lt;&gt; minum\n    minum = InputBox(\"Introduce un n\u00ba entre 1 y 100\", \"\", , 150, 150)\n\n    Range(\"c22\").Offset(fila, 0).Value = minum\n\n    If aleatorio &gt; minum Then\n        MsgBox \"El n\u00ba es m\u00e1s alto\"\n    ElseIf aleatorio &lt; minum Then\n        MsgBox \"El n\u00ba es m\u00e1s bajo\"\n    Else\n        MsgBox \"Correcto\"\n    End If\nWend\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 4, "last_activity_date": 1567607879, "last_edit_date": 1567607879, "creation_date": 1567607114, "answer_id": 57790534, "question_id": 57790299, "link": "https://stackoverflow.com/questions/57790299/enters-an-infinite-loop/57790534#57790534", "title": "Enters an infinite loop", "body": "<p>When you don't define variable, VBA will try to do so for you. So <code>aleatorio = Math.Round(Math.Rnd * 100)</code> will pass as a <code>Variant/Single</code> variable while <code>InputBox(\"Introduce un n\u00ba entre 1 y 100\", \"\", , 150, 150)</code> will pass as a <code>Variant/String</code> variable, see \"watches\" below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/448mo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/448mo.png\" alt=\"enter image description here\"></a></p>\n\n<p>So the infinite loop comes from comparing a numeric value against a string value e.g.: <code>71</code> vs <code>\"71\"</code> which would never be the same. To change that you could either transform your <code>minim</code> variable into a numeric value, e.g.:</p>\n\n<pre><code>minum = CDbl(InputBox(\"Introduce un n\u00ba entre 1 y 100\", \"\", , 150, 150))\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>minum  = Application.InputBox(\"Introduce un n\u00ba entre 1 y 100\", \"\", , 150, 150, Type:=2)\n</code></pre>\n\n<p>Or even better declare variables:</p>\n\n<pre><code>Dim aleatorio As Double, minum As Double, fila as Double\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 11724559, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WDpomKXErPE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reAxSRy0dKrkQtLiADHFOE46sPayA/photo.jpg?sz=128", "display_name": "Noelia Sancho Mendez", "link": "https://stackoverflow.com/users/11724559/noelia-sancho-mendez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 57790534, "answer_count": 2, "score": 2, "last_activity_date": 1567607879, "creation_date": 1567606238, "last_edit_date": 1567606407, "question_id": 57790299, "link": "https://stackoverflow.com/questions/57790299/enters-an-infinite-loop", "title": "Enters an infinite loop", "body": "<p>I'm new at vba so I'm starting with examples I find and things like that.</p>\n\n<p>Now I'm trying to do an example i found on internet which is about a game where you have to guess a random number. </p>\n\n<p>My game is based on 3 columns and 2 buttons.</p>\n\n<p>In 1st column \"N\u00ba introducido\" I want that appears the number that user introduced in an inputbox, </p>\n\n<p>in 2nd column \"Situaci\u00f3n\" I want that programm tells teh user if the random number is greater, smaller or equal to the number he introduced</p>\n\n<p>and the 3st column \"Intentos\" must appears the number of attemps the user needed.</p>\n\n<p>All this must happen when I press the \"Jugar\" button but this enters an infinite loop, I even commented blocks of code to know where was the problem and I cant find it. The most extrange is I'm using the same code than in the example. </p>\n\n<p><a href=\"https://i.stack.imgur.com/gtFcc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gtFcc.png\" alt=\"image \"></a></p>\n\n<p>This is my piece of code:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\n    Dim aleatorio, minum, fila As Integer\n\n    aleatorio = Math.Round(Math.Rnd * 100)\n    Debug.Print aleatorio\n\n    While aleatorio &lt;&gt; minum\n        minum = InputBox(\"Introduce un n\u00ba entre 1 y 100\", \"\", , 150, 150)\n\n'        Range(\"c22\").Offset(fila, 0).Value = minum\n'\n'        If aleatorio &gt; minum Then\n'            MsgBox \"El n\u00ba es m\u00e1s alto\"\n'        ElseIf aleatorio &lt; minum Then\n'            MsgBox \"El n\u00ba es m\u00e1s bajo\"\n'        Else\n'            MsgBox \"Correcto\"\n'        End If\n    Wend\nEnd Sub\n</code></pre>\n\n<p>I'm using a debug.print to know the random number and I'm trying to put the same number that appears but the inputbox never is closed.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1567606138, "post_id": 57790235, "comment_id": 102013577, "body": "what is wrong with the code you provided? and what is your question?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1567606245, "post_id": 57790235, "comment_id": 102013643, "body": "<code>Dim position(1 To number, 2) As Single</code> isn&#39;t valid. You need to first <code>Dim</code> it and then <code>ReDim</code> it using <code>number</code>. Note that you can use a function that returns an array in an array formula in Excel, so that part is no problem."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1567606553, "post_id": 57790235, "comment_id": 102013812, "body": "Also depending on your settings <code>position(1 To number, 2)</code> will create an array with either 2 or 3 columns"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 12020150, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4Bi1E8VyEYo/AAAAAAAAAAI/AAAAAAAAAv8/egok2AQAcM4/photo.jpg?sz=128", "display_name": "Karel Ku\u017eelka", "link": "https://stackoverflow.com/users/12020150/karel-ku%c5%beelka"}, "edited": false, "score": 0, "creation_date": 1567696304, "post_id": 57790400, "comment_id": 102048441, "body": "This is perfect! It allows also to put the parameter in a cell and new data is generated with the chosen dimension after each change in the cell. Exactly what I needed! Thank you!"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 2, "last_activity_date": 1567606611, "creation_date": 1567606611, "answer_id": 57790400, "question_id": 57790235, "link": "https://stackoverflow.com/questions/57790235/how-to-populate-n-cells-with-a-vba-function-output-in-excel/57790400#57790400", "title": "How to populate n cells with a VBA function output in Excel?", "body": "<p>You can't use a variable like <code>number</code> in a <code>Dim</code> statement, but you can use it with <code>ReDim</code>. The following tweak of your code works:</p>\n\n<pre><code>Function generateForest(number As Long) As Variant\n    Randomize\n    Dim i As Long\n    Dim position As Variant\n    ReDim position(1 To number, 1 To 2)\n    For i = 1 To number\n        position(i, 1) = Rnd()\n        position(i, 2) = Rnd()\n    Next i\n    generateForest = position\nEnd Function\n</code></pre>\n\n<p>To use, select e.g. <code>A1:B10</code> in the spreadsheet, enter the formula</p>\n\n<pre><code>=generateForest(10)\n</code></pre>\n\n<p>and then use <code>Ctrl+Shift+Enter</code> to enter it as an array formula:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jTNKG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jTNKG.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 23, "user_id": 12020150, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4Bi1E8VyEYo/AAAAAAAAAAI/AAAAAAAAAv8/egok2AQAcM4/photo.jpg?sz=128", "display_name": "Karel Ku\u017eelka", "link": "https://stackoverflow.com/users/12020150/karel-ku%c5%beelka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 57790400, "answer_count": 1, "score": 2, "last_activity_date": 1567606611, "creation_date": 1567606030, "question_id": 57790235, "link": "https://stackoverflow.com/questions/57790235/how-to-populate-n-cells-with-a-vba-function-output-in-excel", "title": "How to populate n cells with a VBA function output in Excel?", "body": "<p>I need to generate repeatedly n random points in a given area. \nTherefore I want to create an excel function that populates n x 2 cells (x and y coordinates of n points).  n is a parameter of the function. </p>\n\n<pre><code>Function generateForest(number) As Variant\nDim position(1 To number, 2) As Single\nFor i = 1 To number\n x(i, 1) = Rnd()\n x(i, 2) = Rnd()\nNext i\ngenerateForest = positions\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 10374637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0388bdf404df330e748c133a47e4046?s=128&d=identicon&r=PG&f=1", "display_name": "C.Fsh", "link": "https://stackoverflow.com/users/10374637/c-fsh"}, "edited": false, "score": 0, "creation_date": 1567611707, "post_id": 57790710, "comment_id": 102016791, "body": "This lets me place the userform, which is fine, but the issue is that the ComboBox, in this case named xPriority, doesn&#39;t actually have anything in it if the userform&#39;s placement is set by anything other than that first block of text"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1567607750, "creation_date": 1567607750, "answer_id": 57790710, "question_id": 57790161, "link": "https://stackoverflow.com/questions/57790161/combobox-not-showing-contents/57790710#57790710", "title": "ComboBox not showing contents", "body": "<p><code>Application.Left</code> is used for the Excel window. If this is a userform use <code>Me.Left</code> to position the <code>ComboBox</code></p>\n"}], "owner": {"reputation": 55, "user_id": 10374637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0388bdf404df330e748c133a47e4046?s=128&d=identicon&r=PG&f=1", "display_name": "C.Fsh", "link": "https://stackoverflow.com/users/10374637/c-fsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1567607750, "creation_date": 1567605801, "question_id": 57790161, "link": "https://stackoverflow.com/questions/57790161/combobox-not-showing-contents", "title": "ComboBox not showing contents", "body": "<p>I'm having a little issue with centering the Userform in my screen, and getting a combobox to populate with options. I seem to have one block of code that fixes the placement of the form, but that stops the combobox from showing anything.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>   Me.Top = Application.Top + (Application.UsableHeight / 2) - (Me.Height / 3)\n   Me.Left = Application.Left + (Application.UsableWidth / 2) - (Me.Width / 2)\n\n   With Xpriority\n    .AddItem \"Low\"\n    .AddItem \"Medium\"\n    .AddItem \"High\"\n    .AddItem \"URGENT\"\n   End With\n</code></pre>\n\n<p>This is all well and good, but when I copy and paste the above into my new document, it sticks to the centre of the left edge of the screen.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>With alDemo\n  .StartUpPosition = 0\n  .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)\n  .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)\n  .Show\n</code></pre>\n\n<p>The above there makes the form perfectly centred, but then the Combobox fails to show any contents.</p>\n\n<p>What I want is the Userform to be centered in the screen, with a populated combobox, rather than being centered with an empty box, or stuck off-center.</p>\n"}, {"tags": ["vba", "ms-word", "page-break"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1567605891, "post_id": 57789879, "comment_id": 102013458, "body": "Have you tried recording a macro when typing a page break then putting it in instead of or before <code>objSelection.TypeParagraph</code>?"}, {"owner": {"reputation": 1, "user_id": 9358078, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Scott Doscher", "link": "https://stackoverflow.com/users/9358078/scott-doscher"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1567713759, "post_id": 57789879, "comment_id": 102055918, "body": "Cindy thank you so much for your suggestion. It was very helpful to get me to the next step."}], "owner": {"reputation": 1, "user_id": 9358078, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Scott Doscher", "link": "https://stackoverflow.com/users/9358078/scott-doscher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 501, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567604926, "creation_date": 1567604926, "question_id": 57789879, "link": "https://stackoverflow.com/questions/57789879/vba-page-break-in-ms-word", "title": "VBA Page Break in MS Word", "body": "<p>I am trying to combine individual MS Word docs into 1 MS Word doc.  The below code works just fine to do that.  The problem I am having is that I want to insert some code to create a page break after each document so that the next document starts on a new page.  I believe something needs to be added in the Sumit routine.</p>\n\n<p>I have tried every syntax that I can possibly find online.  Nothing is working.</p>\n\n<pre><code>'Dim fso As New FileSystemObject\n\n    Dim NoOfFiles As Double\n\n    Dim counter As Integer\n\n    Dim r_counter As Integer\n\n    Dim s As String\n\n    Dim listfiles As Files\n\n    Dim newfile As Worksheet\n\n    Dim mainworkbook As Workbook\n\n    Dim FetchFileClicked\n\n    Dim Folderpath As Variant\n\n\nSub Sumit()\n    If FetchFileClicked = False Then\n        MsgBox \"First click the 'Load Control File' button\"\n        End\n    End If\n\n    Application.ScreenUpdating = False\n    strRandom = Replace(Replace(Replace(Now, \":\", \"\"), \"/\", \"\"), \" \", \"\")\n    MergeFileName = \"Merger\" &amp; strRandom &amp; \".doc\"\n    MergeFolder = mainworkbook.Sheets(\"Main\").Range(\"L10\").Value\n\n    Set objWord = CreateObject(\"Word.Application\")\n\n   Set objDoc = objWord.Documents.Add\n\n   objWord.Visible = True\n\n   Set objSelection = objWord.Selection\n   objDoc.SaveAs (MergeFolder &amp; MergeFileName)\n    For i = 1 To NoOfFiles\n        If Range(\"B\" &amp; i).Value = \"Yes\" Then\n            Set objTempWord = CreateObject(\"Word.Application\")\n            Set tempDoc = objWord.Documents.Open(Folderpath &amp; \"\\\" &amp; Range(\"A\" &amp; i).Value)\n            Set objTempSelection = objTempWord.Selection\n            tempDoc.Range.Select\n            tempDoc.Range.Copy\n            objSelection.TypeParagraph\n            objSelection.Paste\n            tempDoc.Close\n        End If\n    Next\n    objDoc.Save\n    Application.ScreenUpdating = True\n    mainworkbook.Sheets(\"Main\").Activate\n    MsgBox \"Completed...Merge File is saved at \" &amp; MergeFolder &amp; MergeFileName\n    FetchFileClicked = False\nEnd Sub\n\n\n\nSub fetchFiles()\n    Set mainworkbook = ActiveWorkbook\n    Range(\"A:A\").Clear\n\n    Range(\"B:B\").Clear\n\n    Folderpath = mainworkbook.Sheets(\"Main\").Range(\"L8\").Value\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    NoOfFiles = fso.GetFolder(Folderpath).Files.Count\n    Set listfiles = fso.GetFolder(Folderpath).Files\n    counter = 0\n    For Each fls In listfiles\n        counter = counter + 1\n        Range(\"A\" &amp; counter).Value = fls.Name\n        'Range(\"B\" &amp; counter).Value = \"Yes\"\n        Range(\"A\" &amp; counter).Borders.Value = 1\n        Range(\"B\" &amp; counter).Borders.Value = 1\n        With Range(\"B\" &amp; counter).Validation\n             .Delete\n            'replace \"=A1:A6\" with the range the data is in.\n            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n             Operator:=xlBetween, Formula1:=\"Yes,No\"\n            .IgnoreBlank = True\n            .InCellDropdown = True\n            .InputTitle = \"\"\n            .ErrorTitle = \"\"\n            .InputMessage = \"\"\n            .ErrorMessage = \"\"\n            .ShowInput = True\n            .ShowError = True\n        End With\n    Next\n    Call controlFile\n     MsgBox \"Control File Loaded\"\n     FetchFileClicked = True\nEnd Sub\n\n\nSub controlFile()\n\n Worksheets(\"Main\").Range(\"b1:b6\").Formula = \"=iferror(VLOOKUP(A1,Table2,MATCH(\"\"load\"\",Table2[#Headers],0),0),\"\"\"\")&amp;\"\"\"\"\"\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nEnd Sub\n</code></pre>\n\n<p>I expect each of the individual documents that are added to the newly combined document to be added at the \"start of a new page\", NOT in the middle of an existing page, like it is today.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1567605218, "post_id": 57789802, "comment_id": 102013052, "body": "Instead of using <code>.SaveAs FileFormat:=xlCSV</code>, you could try <a href=\"https://stackoverflow.com/a/39781372/4717755\">converting the range to a CSV string</a>, then deleting the very last carriage return and then write the resulting string to a text file."}, {"owner": {"reputation": 3, "user_id": 12019607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980469f1c36e03066e27757a8e7c30d9?s=128&d=identicon&r=PG&f=1", "display_name": "Metharious", "link": "https://stackoverflow.com/users/12019607/metharious"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1568390468, "post_id": 57789802, "comment_id": 102271403, "body": "I did not attempt this due to finding the true issue at hand but it may be useful for someone else. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12019607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980469f1c36e03066e27757a8e7c30d9?s=128&d=identicon&r=PG&f=1", "display_name": "Metharious", "link": "https://stackoverflow.com/users/12019607/metharious"}, "edited": false, "score": 0, "creation_date": 1568390819, "post_id": 57791413, "comment_id": 102271561, "body": "While I did use this solution, I found the real error at hand which was the HMI would not accept the upload if the file was open at the same time. My macro left the .csv file open at the end of the cycle so the reason why I thought deleting the carriage return worked is because I would manually delete it, save and close. Where as if I just attempted to upload after my macro created the file, it wouldn&#39;t because it was still open. Thank you for your response, and I apologize for the delay in mine."}, {"owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "reply_to_user": {"reputation": 3, "user_id": 12019607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980469f1c36e03066e27757a8e7c30d9?s=128&d=identicon&r=PG&f=1", "display_name": "Metharious", "link": "https://stackoverflow.com/users/12019607/metharious"}, "edited": false, "score": 0, "creation_date": 1568392666, "post_id": 57791413, "comment_id": 102272382, "body": ":) No problem - better late then never ;) I am glad you find your tricky bug :)"}], "tags": [], "owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "is_accepted": true, "score": 0, "last_activity_date": 1572812664, "last_edit_date": 1572812664, "creation_date": 1567610279, "answer_id": 57791413, "question_id": 57789802, "link": "https://stackoverflow.com/questions/57789802/my-macro-creates-a-carriage-return-at-the-end-of-my-csv-txt-output-and-cant-fi/57791413#57791413", "title": "my macro creates a carriage return at the end of my csv .txt output and can&#39;t figure out why", "body": "<p>CRs and LFs might be added on purpose. Anyhow if it's like that this should cure it :)</p>\n\n<pre><code>function remove_lastwhitespace_if_any (S as string ,optional tester as string = vbtab &amp; vbcr &amp; vblf &amp; \" \") as string \n    if len(s) =0 then exit function\n\n    while instr(tester,right(s,1) ) &gt; 0 \n       S=left(s,len(s)-1)\n    wend\n\n    remove_lastwhitespace_if_any=s\nend function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12019607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980469f1c36e03066e27757a8e7c30d9?s=128&d=identicon&r=PG&f=1", "display_name": "Metharious", "link": "https://stackoverflow.com/users/12019607/metharious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 57791413, "answer_count": 1, "score": 0, "last_activity_date": 1572812664, "creation_date": 1567604715, "last_edit_date": 1567607917, "question_id": 57789802, "link": "https://stackoverflow.com/questions/57789802/my-macro-creates-a-carriage-return-at-the-end-of-my-csv-txt-output-and-cant-fi", "title": "my macro creates a carriage return at the end of my csv .txt output and can&#39;t figure out why", "body": "<p>My excel file has 3 sheets, one that contains a mass amount of static data (we'll call this Build Status), one that accepts data input (we'll call this Input) and one that returns data from Build Status sheet using IF and VLOOKUP functions based on values from Input sheet (we'll call this sheet Output). My Output sheet has static headers and my macro creates a csv from the Output sheet (macro tied to a button). For some reason I end up with a carriage return at the end of my .txt file (csv saved as .txt) and I have to delete it in order for the HMI of another program to accept the upload format. Any help on getting rid of the return or why it's being created would be appreciated.</p>\n\n<p>Whether outputting as .csv or .txt (in csv format), the carriage return is there when viewing in a text editor.</p>\n\n<pre><code>Option Explicit\n\nSub CreateCSV()\n    Dim wbI As Workbook, wbO As Workbook\n    Dim wsI As Worksheet, wsO As Worksheet\n    Dim jLastRow As Long\n    Dim LDate As String\n\n    '~~&gt; Set a format for current date\n    LDate = Format(Date, \"mm-dd-yyyy\")\n\n    '~~&gt; Source/Input Workbook\n    Set wbI = ThisWorkbook\n\n    '~~&gt; Set the relevant sheet from where you want to copy\n    Set wsI = wbI.Sheets(\"OUTPUT\")\n\n    '~~&gt; Sets an integer value for the last row of data being copied\n    jLastRow = wsI.Cells.Find(What:=\"*\", LookIn:=xlValues, SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n    '~~&gt; Destination/Output Workbook\n    Set wbO = Workbooks.Add\n\n    With wbO\n        '~~&gt; Set the relevant sheet to paste to\n        Set wsO = wbO.Sheets(\"Sheet1\")\n\n        '~~&gt; Copy the range\n        wsI.Range(\"A1:Z\" &amp; jLastRow).Copy\n\n        '~~&gt; Paste it in Cell A1.\n        wsO.Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n\n        '~~&gt;. Save the file\n        .SaveAs Filename:=\"\\\\TestFolder\\TestRecipe\" &amp; LDate &amp; \".txt\", FileFormat:=xlCSV\n\n        '~~&gt; Clear Clipboard\n        Application.CutCopyMode = False\n    End With\nEnd Sub\n</code></pre>\n\n<p>Expected: Creates comma separated values in .txt file named TestRecipe(Date) that works with third party software.</p>\n\n<p>Actual: File creation, name and format work but a carriage return is at the end of the file which prevents it from uploading into third party software. As soon as I delete this manually, it uploads fine.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1567605548, "post_id": 57789591, "comment_id": 102013261, "body": "You can create a dynamic named range and use that range in your chart series. <a href=\"https://peltiertech.com/dynamic-charts/\" rel=\"nofollow noreferrer\">Jon Peltier&#39;s website</a> has tons of good examples you can use to learn what you need. Start building your solution using that information and come back here with questions when you get stuck."}, {"owner": {"reputation": 3064, "user_id": 11768364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kK8lw.png?s=128&g=1", "display_name": "Terry W", "link": "https://stackoverflow.com/users/11768364/terry-w"}, "edited": false, "score": 0, "creation_date": 1567648076, "post_id": 57789591, "comment_id": 102027747, "body": "alternatively, create a new data table which will dynamically look up the values from the original table by given time, and create charts from the new data table instead."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1567681260, "post_id": 57789591, "comment_id": 102039620, "body": "I would then use a cell with data validation to be able to pick between current and previous..."}], "owner": {"reputation": 52, "user_id": 11493815, "user_type": "registered", "profile_image": "https://graph.facebook.com/893731690958613/picture?type=large", "display_name": "Juras Sulcas", "link": "https://stackoverflow.com/users/11493815/juras-sulcas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567604699, "creation_date": 1567604096, "last_edit_date": 1567604699, "question_id": 57789591, "link": "https://stackoverflow.com/questions/57789591/how-can-i-make-self-updating-chart-with-formula", "title": "How can I make self-updating chart with formula?", "body": "<p>I want to make a self updating chart for weekly sales KPI.\n<a href=\"https://i.stack.imgur.com/TIGpB.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TIGpB.jpg\" alt=\"!https://imgur.com/a/KWxh3SZ\"></a></p>\n\n<p>Columns are the times, every day, by hand I update it until that time.</p>\n\n<p>First row is the target, and then all the inputs are typed in by hand when we know how much we sold.</p>\n\n<p>I need the chart to update itself by taking into account what time it's now. E.g. If it's Monday 13:00, then it means chart will only look into 5 inputs. I hope it's clear.</p>\n\n<p>Green circle is % of how many goals we met, red circle would be how many goals were not met. Ignore the blue one.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 100, "user_id": 9735478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdL10.jpg?s=128&g=1", "display_name": "RaspiManu", "link": "https://stackoverflow.com/users/9735478/raspimanu"}, "edited": false, "score": 0, "creation_date": 1567663076, "post_id": 57789950, "comment_id": 102030880, "body": "Thank you very much for your help. I wasn&#39;t able to avoid the problem with the first option, but the second one worked like a charm. Problem solved!"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 100, "user_id": 9735478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdL10.jpg?s=128&g=1", "display_name": "RaspiManu", "link": "https://stackoverflow.com/users/9735478/raspimanu"}, "edited": false, "score": 0, "creation_date": 1567665445, "post_id": 57789950, "comment_id": 102031699, "body": "@RaspiManu, with the first option, that line of code comes after your two line. It worked for me at least."}, {"owner": {"reputation": 100, "user_id": 9735478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdL10.jpg?s=128&g=1", "display_name": "RaspiManu", "link": "https://stackoverflow.com/users/9735478/raspimanu"}, "edited": false, "score": 0, "creation_date": 1567757171, "post_id": 57789950, "comment_id": 102066676, "body": "I know, but it didn&#39;t work in my case. Maybe because I am using Excel 2010. Thank you a lot for helping me. I hope someone who also has the problem finds this and can choose his own working option."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1567605902, "last_edit_date": 1567605902, "creation_date": 1567605169, "answer_id": 57789950, "question_id": 57789361, "link": "https://stackoverflow.com/questions/57789361/excel-changes-numpads-to-after-printing-a-range-with-vbas-printprevie/57789950#57789950", "title": "Excel changes NumPad&#39;s &quot;,&quot; to &quot;.&quot; after printing a Range with VBA&#39;s &quot;printpreview&quot;", "body": "<p>I was able to recreate the problem. The odd thing is that under <em>File > Options > Advanced</em> the decimal seperator symbol will still show as the comma. However the problem gets fixed with:</p>\n\n<pre><code>Application.DecimalSeparator = \",\"\n</code></pre>\n\n<p>Which would set the decimal seperator to the comma again.</p>\n\n<hr>\n\n<p><strong>Edit</strong>, I guess it's a known bug as I found <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/all/after-printing-through-activesheetprintpreview-the/2ceb3ce2-51e7-424c-a8c1-ad96face8164?auth=1\" rel=\"nofollow noreferrer\">this</a> question on the same issue here. A solution provided there would be instead of <code>Worksheets(\"Table5\").PrintPreview</code> use:</p>\n\n<pre><code>Application.CommandBars.ExecuteMso \"FilePrintPreview\"\n</code></pre>\n\n<p>However for this option to work, the activesheet needs to be the one you want to print from. So I would still prefer to use the first suggestion and set the DecimalSeperator.</p>\n"}], "owner": {"reputation": 100, "user_id": 9735478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdL10.jpg?s=128&g=1", "display_name": "RaspiManu", "link": "https://stackoverflow.com/users/9735478/raspimanu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 57789950, "answer_count": 1, "score": 1, "last_activity_date": 1567605902, "creation_date": 1567603369, "last_edit_date": 1567604567, "question_id": 57789361, "link": "https://stackoverflow.com/questions/57789361/excel-changes-numpads-to-after-printing-a-range-with-vbas-printprevie", "title": "Excel changes NumPad&#39;s &quot;,&quot; to &quot;.&quot; after printing a Range with VBA&#39;s &quot;printpreview&quot;", "body": "<h1>The situation:</h1>\n\n<p>I am working on an Excel file that offers some worksheets to calculate different things. The last of these worksheets is a summary of all the others that is preformatted for perfect printing on a standard paper sheet. I want to print this summary by clicking a button on the main page (first worksheet). The code behind this button is stored in \"Table1\" and looks like this:</p>\n\n<pre><code>Sub Print()\n\nWorksheets(\"Table5\").PageSetup.PrintArea = \"B2:N48\"\nWorksheets(\"Table5\").PrintPreview\n\nEnd Sub\n</code></pre>\n\n<h1>The problem:</h1>\n\n<p>I've got a german Keyboard with \",\" as decimal separator on the NumPad. My whole system uses the \",\" as this. After opening the file, I can just enter something like \"1,4\" in a cell of choice and everything works. My problem starts when printing the summary via VBA code (see above). After this, pressing my NumPad's \",\" results in getting a \".\" instead. The standard \",\" of the keyboard still works as supposed.</p>\n\n<p>If I accidentially use the NumPad after printing, type \"1.4\" in a cell and hit Enter, the cell gets a user defined format as date (01.04. or in your case propably 01/04 or something else) and crashes everything.</p>\n\n<h1>What I tried:</h1>\n\n<p>I made a simple test file with only the two code lines above and just a blank space to print. I found out, that the problem only appears, if I really print the summary. Starting the preview and then cancelling it before printing does not cause the problem.</p>\n\n<p>I checked the file with Excel 2010 and 2016 and the problem appeared in both cases.</p>\n\n<p>If I save the file, close it and open it again, the problem is gone, but new formatted cells will stay and crash the file.</p>\n\n<p>What I also tried is checking Excel's options before and after printing, but nothing changed.</p>\n\n<h1>My guess:</h1>\n\n<p>There might be a problem with Excel-VBA's \"PrintPreview\" in general. It would be nice to get a confirmation of my problem, a solution for it or a workaround. I cannot change the printing process to standard printing, because my real file is much more difficult.</p>\n\n<p>Best wishes</p>\n\n<p>RaspiManu</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7315724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4259b0170752045788b29374af49636?s=128&d=identicon&r=PG&f=1", "display_name": "helio", "link": "https://stackoverflow.com/users/7315724/helio"}, "is_accepted": false, "score": 0, "last_activity_date": 1567605060, "creation_date": 1567605060, "answer_id": 57789923, "question_id": 57789244, "link": "https://stackoverflow.com/questions/57789244/how-to-populate-combobox-and-textbox-with-text-from-a-text-file/57789923#57789923", "title": "How to populate ComboBox and TextBox with text from a text file", "body": "<p>You can do this : </p>\n\n<pre><code>Private Sub UserForm_Activate()\n\nDim File As Integer\nDim NextLine As String\nFile = FreeFile\nOpen \"C:\\Users\\...\\Documents\\test.txt\" For Input As File\nWhile Not EOF(File)\n  Line Input #File, NextLine\n  UserForm1.ComboBox1.AddItem NextLine\nWend\nClose File\n\nEnd Sub\n</code></pre>\n\n<p>and to display text in TextBox1 :</p>\n\n<pre><code>Private Sub ComboBox1_Change()\nDim MyPos\nMyPos = InStr(1, ComboBox1.Value, \"|\")\n\nTextBox1.Value = \" \" &amp; Right(ComboBox1.Value, MyPos - 1)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 250, "user_id": 8247997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33206a33b56aaf9b9e01d1760419094c?s=128&d=identicon&r=PG&f=1", "display_name": "Somanna", "link": "https://stackoverflow.com/users/8247997/somanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567607925, "creation_date": 1567602933, "last_edit_date": 1567607925, "question_id": 57789244, "link": "https://stackoverflow.com/questions/57789244/how-to-populate-combobox-and-textbox-with-text-from-a-text-file", "title": "How to populate ComboBox and TextBox with text from a text file", "body": "<p>I'm new to vba and donot know much coding in vba. \nIve created a form in an excel workbook that contains a comboBox named <code>ComboBox1</code>and a textBox named <code>TextBox1</code>.</p>\n\n<p>And I have a text file that contains the following text:</p>\n\n<blockquote>\n  <p>Organisation1|taxid001<br>\n  Organisation2|taxid002<br>\n  Organisation3|taxid003<br>\n  Organisation4|taxid004  </p>\n</blockquote>\n\n<p>Here OrganisationX refers to Organisation name and taxidXXX refers to Tax ID of the corresponding organisation. </p>\n\n<p>When I load the form, <code>ComboBox1</code> should get filled with Organisation names and when I click on a particular item in the combobox containg the organization name, the corresponding Tax ID must get filled in <code>Textbox1</code>.<br>\nHow do I do this? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1567610761, "post_id": 57789072, "comment_id": 102016309, "body": "Your code (the WinHTTP-Part) works for me, but for huge downloads you can e-g use <a href=\"https://stackoverflow.com/questions/56789366/file-download-via-shdocvw-dll-with-custom-headers/56847505#56847505\">Wget</a>."}, {"owner": {"reputation": 89, "user_id": 11879643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d786eea6024059fd8a4a9dcd5974ea1d?s=128&d=identicon&r=PG&f=1", "display_name": "Vish", "link": "https://stackoverflow.com/users/11879643/vish"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1567615429, "post_id": 57789072, "comment_id": 102018578, "body": "The WinHTTP-Part also worked fine for me for another website but problem arises only for given website.  The file I am trying  to download is not a huge file, but don&#39;t know why this problem is arsisng for this website."}], "owner": {"reputation": 89, "user_id": 11879643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d786eea6024059fd8a4a9dcd5974ea1d?s=128&d=identicon&r=PG&f=1", "display_name": "Vish", "link": "https://stackoverflow.com/users/11879643/vish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567607942, "creation_date": 1567602346, "last_edit_date": 1567607942, "question_id": 57789072, "link": "https://stackoverflow.com/questions/57789072/vba-code-is-unable-to-download-and-save-files-from-website", "title": "VBA code is unable to download and save files from website", "body": "<p>I am unable to download and save file from website using VBA code. I have tried various methods for this still I am unable to download the file. If file is downloaded from another method its get corrupted. This problem exist only on this website this code works fine for another website. I am currently using Excel 2016.\nPlease find below vba code. Please help me on this and let me know what i am doing wrong.</p>\n\n<pre><code>Option Explicit\n\nSub teScrapping()\n\n    Const TITLES As String = \"Features\"\n\n    Dim IE As SHDocVw.InternetExplorer\n    Set IE = New InternetExplorer\n    Dim TitlesCount As Long, NoChangesCount As Long\n    Dim fileLink As MSHTML.IHTMLElementCollection\n    Dim searchBoxValue As String\n    Dim html As HTMLDocument\n    Dim WinHttpReq As Object\n    Dim oStream As Object\n    Dim cnt As Integer\n    Dim DownloadStatus As Long\n    Dim LinkStpFile As String\n    Dim LinkDrawingFile As String\n\n\n    searchBoxValue = \"5-212522-1\"\n\n    'On Error Resume Next\n\n    IE.Visible = True\n\n    IE.navigate \"https://www.te.com/usa-en/home.html\"\n\n    While IE.readyState &lt;&gt; 4 Or IE.Busy\n        DoEvents\n    Wend\n\n    Dim idoc As MSHTML.HTMLDocument\n    Set idoc = IE.document\n\n    idoc.getElementById(\"search-input\").Value = searchBoxValue\n\n    Dim doc_ele As MSHTML.IHTMLElement\n    Dim doc_eles As MSHTML.IHTMLElementCollection\n    Set doc_eles = idoc.getElementsByTagName(\"INPUT\")\n\n    For Each doc_ele In doc_eles\n        If doc_ele.getAttribute(\"value\") = \"Search by part # or keyword\" Then\n            doc_ele.Click\n            Exit For\n        Else\n        End If\n    Next doc_ele\n\n    ' Waiting page to load competely\n    Set html = IE.document\n    On Error Resume Next\n    Do\n        DoEvents\n        Application.Wait Now() + TimeValue(\"00:00:02\")\n        TitlesCount = GetClassCount(html, TITLES)\n        html.parentWindow.scrollBy 0, 99999\n        If TitlesCount = GetClassCount(html, TITLES) Then\n            NoChangesCount = NoChangesCount + 1\n        Else\n            NoChangesCount = 0\n        End If\n    Loop Until NoChangesCount = 5 ' If no changes for some attempts, assume end of dynamic page\n    On Error GoTo 0\n\n    LinkStpFile = \"https://www.te.com/commerce/DocumentDelivery/DDEController?Action=showdoc&amp;DocId=Customer+View+Model%7FCVM_5-212522-1%7FAE%7F3d_stp.zip%7FEnglish%7FENG_CVM_CVM_5-212522-1_AE.3d_stp.zip%7F5-212522-1\"\n\n    'Downloading stp fille\n    Set WinHttpReq = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n    WinHttpReq.Open \"POST\", LinkStpFile, False, \"username\", \"password\"\n    WinHttpReq.send\n\n    If WinHttpReq.Status = 200 Then\n        Set oStream = CreateObject(\"ADODB.Stream\")\n        oStream.Open\n        oStream.Type = 1\n        oStream.Write WinHttpReq.responseBody\n        oStream.SaveToFile \"C:\\MyDownloads\\StepFile.zip\", 2 ' 1 = no overwrite, 2 = overwrite\n        oStream.Close\n    End If\n\n\n    'Download Drawing File\n    LinkDrawingFile = \"https://www.te.com/commerce/DocumentDelivery/DDEController?Action=showdoc&amp;DocId=Customer+Drawing%7F212522%7FW%7Fpdf%7FEnglish%7FENG_CD_212522_W.pdf%7F5-212522-1\"\n\n    Set WinHttpReq = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n    WinHttpReq.Open \"POST\", LinkDrawingFile, False, \"username\", \"password\"\n    WinHttpReq.send\n\n    If WinHttpReq.Status = 200 Then\n        Set oStream = CreateObject(\"ADODB.Stream\")\n        oStream.Open\n        oStream.Type = 1\n        oStream.Write WinHttpReq.responseBody\n        oStream.SaveToFile \"C:\\MyDownloads\\DrawFile.pdf\", 2 ' 1 = no overwrite, 2 = overwrite\n        oStream.Close\n    End If\n\n\n  Set IE = Nothing\n\nEnd Sub\n\nPrivate Function GetClassCount(Doc As HTMLDocument, ClassName As String) As Long\n    GetClassCount = Doc.getElementsByClassName(ClassName).Length\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1567602082, "post_id": 57788938, "comment_id": 102011151, "body": "Where and how do you assign a value to <code>lastsheet</code>? And where is that variable declared (which module)?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 2, "creation_date": 1567602311, "post_id": 57788938, "comment_id": 102011270, "body": "Welcome to SO. First of all <code>On Error Resume Next</code> hides errors, but they still occur. I suggest you to code without using it if you are learning. Second, you define <code>Public lastsheet As String</code> but in your code you never assign a value to this variable. Default value in a string variable is <code>&quot;&quot;</code> and it equals to nothing ( a null value). It&#39;s kind of empty. So when you do <code>Sheets(lastsheet).Select</code> you are telling Excel to select a worksheet named <i>null value</i> and that can&#39;t be. All worksheets in a workbook <b>must</b> have a name"}, {"owner": {"reputation": 302, "user_id": 11958215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9htzU.jpg?s=128&g=1", "display_name": "Breno Teodoro", "link": "https://stackoverflow.com/users/11958215/breno-teodoro"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1567602554, "post_id": 57788938, "comment_id": 102011424, "body": "Hi, James, please also keep in mind that your &quot;For&quot; Loop in &quot;Sub SelectUnlockedCells()&quot; has no variable indicated after the &quot;Next&quot; statement. There are minor mistakes in your code that lead me to think that it could use some rethinking in the overall structure, such as the comment @Rory has indicated."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1567604436, "post_id": 57788938, "comment_id": 102012570, "body": "Use Option Explicit, and compile before running !!!!!!!!!!!!"}, {"owner": {"reputation": 13, "user_id": 12019853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d6a5dd35c7cab37987395774eaf83a9?s=128&d=identicon&r=PG&f=1", "display_name": "James Rucker", "link": "https://stackoverflow.com/users/12019853/james-rucker"}, "edited": false, "score": 0, "creation_date": 1567604949, "post_id": 57788938, "comment_id": 102012887, "body": "Thank you. The lastsheet value is assigned viaPrivate Sub Workbook_SheetDeactivate(ByVal Sh As Object) lastsheet = Sh.Name End Sub"}, {"owner": {"reputation": 13, "user_id": 12019853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d6a5dd35c7cab37987395774eaf83a9?s=128&d=identicon&r=PG&f=1", "display_name": "James Rucker", "link": "https://stackoverflow.com/users/12019853/james-rucker"}, "edited": false, "score": 0, "creation_date": 1567605155, "post_id": 57788938, "comment_id": 102013014, "body": "I&#39;m not a coder. The numerous exclamation marks may indicate your frustration with my lack of knowledge, but that is the reason I am asking the questions I am. I have no coding experience aside from what I can gather on sites like this. The vast majority of my job is nothing to do with coding, or computers. Please be gentle."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12019853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d6a5dd35c7cab37987395774eaf83a9?s=128&d=identicon&r=PG&f=1", "display_name": "James Rucker", "link": "https://stackoverflow.com/users/12019853/james-rucker"}, "edited": false, "score": 0, "creation_date": 1567605579, "post_id": 57789153, "comment_id": 102013285, "body": "Thank you. This works, but selects the last sheet in the workbook, whereas I want to select the last active sheet. I had actually missed some of the code before. Lastsheet is defined as the previously deactivated sheet Private Sub Workbook_SheetDeactivate(ByVal Sh As Object) lastsheet = Sh.Name End Sub"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1567603050, "last_edit_date": 1567603050, "creation_date": 1567602632, "answer_id": 57789153, "question_id": 57788938, "link": "https://stackoverflow.com/questions/57788938/vba-subscript-out-of-range-and-excels-default-variables/57789153#57789153", "title": "VBA subscript out of range and Excel&#39;s default variables", "body": "<p>Consider:</p>\n\n<pre><code>Public lastsheet As String\n\nSub Select_Last()\n    lastsheet = Sheets(Sheets.Count).Name\n    Sheets(lastsheet).Select\nEnd Sub\n</code></pre>\n\n<p>The key issue is to assign a value to a variable before using it.</p>\n"}], "owner": {"reputation": 13, "user_id": 12019853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d6a5dd35c7cab37987395774eaf83a9?s=128&d=identicon&r=PG&f=1", "display_name": "James Rucker", "link": "https://stackoverflow.com/users/12019853/james-rucker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567605086, "creation_date": 1567601903, "last_edit_date": 1567605086, "question_id": 57788938, "link": "https://stackoverflow.com/questions/57788938/vba-subscript-out-of-range-and-excels-default-variables", "title": "VBA subscript out of range and Excel&#39;s default variables", "body": "<p>This is my first post on here and I have very little formal training in coding, so this is probably a very easy problem. </p>\n\n<p>I'm running into an error 9, VBA Subscript out of range, when running macros defined by the code below. \nSpecifically, it is the Sub Select_Last() function. Excel does not like the subsequent expression, however if this is used on its own in a separate Excel file then it works fine. </p>\n\n<p>I think the problem is that Excel's default variable (Activesheet etc) are conflicting with each other. But I am not sure how to remedy this. The other subs work fine. Can anyone help? Thank you.</p>\n\n<pre><code>Public lastsheet As String\n\nSub Select_Last()\n   Sheets(lastsheet).Select\nEnd Sub\n\nSub Protect()\n   For i = 1 To Sheets.Count\n      Sheets(i).Protect\n   Next i\nEnd Sub\n\nSub UnProtect()\n   For i = 1 To Sheets.Count\n      Sheets(i).UnProtect\n   Next i\nEnd Sub\n\nSub SelectUnlockedCells()\n   Dim WorkRng As Range\n   Dim OutRng As Range\n   Dim Rng As Range\n   On Error Resume Next\n   Set WorkRng = Application.ActiveSheet.UsedRange\n   Application.ScreenUpdating = False\n\n   For Each Rng In WorkRng\n     If Rng.Locked = False Then\n        If OutRng.Count = 0 Then\n          Set OutRng = Rng\n        Else\n          Set OutRng = Union(OutRng, Rng)\n        End If\n     End If\n   Next\n   If OutRng.Count &gt; 0 Then OutRng.Select\n     Application.ScreenUpdating = True\n   End Sub\n</code></pre>\n\n<p>The other functions work OK.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1567601984, "post_id": 57788872, "comment_id": 102011110, "body": "Seems like a good job for pivot table. Would that be an option for you? Otherwise <code>SUMIF</code> would be able to do that job."}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1567602944, "post_id": 57788872, "comment_id": 102011696, "body": "If your data are in, let&#39;s say, A2:C51, and your year value is in G6, use =SUMIFS(A2:A51,C2:C51,CONCATENATE(&quot;=&quot;;G6)). Just custom it to whatever you have your data."}, {"owner": {"reputation": 1, "user_id": 11737195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d405b7ec7e276c3961eb943cb026f070?s=128&d=identicon&r=PG", "display_name": "user11737195", "link": "https://stackoverflow.com/users/11737195/user11737195"}, "edited": false, "score": 0, "creation_date": 1567614129, "post_id": 57788872, "comment_id": 102018043, "body": "Thanks for prompt response. I made a mistake in question. I need individual items list. In example given, for 2017 value should not sum but should come as 10000, 14500,19000 in separate rows. Sorry for inconvenience"}], "answers": [{"tags": [], "owner": {"reputation": 173, "user_id": 7898021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2f50f9ecf7be9e75eabfa654b688fbe?s=128&d=identicon&r=PG&f=1", "display_name": "M. Salem", "link": "https://stackoverflow.com/users/7898021/m-salem"}, "is_accepted": false, "score": 0, "last_activity_date": 1567606304, "creation_date": 1567606304, "answer_id": 57790316, "question_id": 57788872, "link": "https://stackoverflow.com/questions/57788872/copy-data-from-once-cell-to-another-cell-based-on-conditions/57790316#57790316", "title": "Copy Data from once cell to another cell based on conditions", "body": "<p>Excuse me for the German language. <em>SUMMEWENN</em> is, indeed, <em>SUMIF</em> function. You can use a sumif Formula:</p>\n\n<p>Sumif(Your criteria, Your search criterua, Your desired range to be summed)</p>\n\n<p>Please see the below screenshot illustrating your example</p>\n\n<p><a href=\"https://i.stack.imgur.com/fQz8i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fQz8i.png\" alt=\"enter image description here\"></a></p>\n\n<ul>\n<li><p><strong>Your criteria</strong>: Range C2 to C11</p></li>\n<li><p><strong>Your search criteria</strong>: B5 --> 2017</p></li>\n<li><strong>Your desired range to be summed</strong>: A2 to A11</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11737195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d405b7ec7e276c3961eb943cb026f070?s=128&d=identicon&r=PG", "display_name": "user11737195", "link": "https://stackoverflow.com/users/11737195/user11737195"}, "edited": false, "score": 0, "creation_date": 1567696155, "post_id": 57797632, "comment_id": 102048346, "body": "Thank you for explaining"}], "tags": [], "owner": {"reputation": 3064, "user_id": 11768364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kK8lw.png?s=128&g=1", "display_name": "Terry W", "link": "https://stackoverflow.com/users/11768364/terry-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1567649842, "creation_date": 1567649842, "answer_id": 57797632, "question_id": 57788872, "link": "https://stackoverflow.com/questions/57788872/copy-data-from-once-cell-to-another-cell-based-on-conditions/57797632#57797632", "title": "Copy Data from once cell to another cell based on conditions", "body": "<p><strong>Pivot Table</strong> is a possible solution but you will need a <strong>helper column</strong> to \"rank\" the <code>Year</code>.</p>\n\n<p>Put the following formula in Cell <code>D2</code> suppose your data range is <code>A2:C13</code>:</p>\n\n<pre><code>=COUNTIF($C$2:C2,C2)\n</code></pre>\n\n<p>Dray it down to apply across rows.</p>\n\n<p>Then <strong>sort</strong> the data range by <code>Year</code> and then by <code>Salary</code> <strong>from Smallest to Largest</strong>.</p>\n\n<p>Then <strong>insert a pivot table</strong> and layout the data as shown below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Yt0q3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Yt0q3.png\" alt=\"Pivot Table\"></a></p>\n\n<p>The problem can also be solved by formula or power query but if a list like that is all you want I believe using Pivot Table is the most efficient way.</p>\n\n<p>Let me know if you have any question. Cheers :)</p>\n"}], "owner": {"reputation": 1, "user_id": 11737195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d405b7ec7e276c3961eb943cb026f070?s=128&d=identicon&r=PG", "display_name": "user11737195", "link": "https://stackoverflow.com/users/11737195/user11737195"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1567649842, "creation_date": 1567601677, "last_edit_date": 1567614230, "question_id": 57788872, "link": "https://stackoverflow.com/questions/57788872/copy-data-from-once-cell-to-another-cell-based-on-conditions", "title": "Copy Data from once cell to another cell based on conditions", "body": "<p>I am facing an issue in excel in driving the formulas. I have data (Year, Salary, Name) in one sheet. It is updated vertically. In another sheet, I want to get list of salary for particular year. For 2019 there may be 4 rows for salary so I want all of them one by one. Below is the data:</p>\n\n<pre><code>Salary  EMP Year\n10000   a   2017\n11500   b   2018\n13000   c   2019\n14500   d   2017\n16000   f   2018\n17500   s   2019\n19000   g   2017\n20500   h   2018\n22000   h   2019\n</code></pre>\n\n<p>Output I require:</p>\n\n<pre><code>Year     2017      2018    2019\n         10000 11500 13000\n          14500 16000 17500\n           19000 20500 22000\n</code></pre>\n\n<p>So output should contain list of data for 2019 when I enter 2019 (all rows). there may be 50 rows in actual as I have given simple example of 8 rows only. </p>\n\n<p>Kindly help me on this. \nThanks, Sharmil</p>\n\n<p>I tried with pivot but it is giving total value rather than individual values. Also I tried with OFFSET, Index + Match function but it does not provide me correct output. Combination of OFFSET, Index + Match gives all rows for all single year.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1567608786, "post_id": 57788829, "comment_id": 102015185, "body": "The XML you attempt to create is not well-formed as the <i>request</i> node does not close. Run the <i>temp2.xml</i> through any online XML validator."}, {"owner": {"reputation": 1, "user_id": 12019801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a8cc8f35f5111de1326323ee52c0ee9?s=128&d=identicon&r=PG&f=1", "display_name": "RichardG", "link": "https://stackoverflow.com/users/12019801/richardg"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1567753119, "post_id": 57788829, "comment_id": 102064944, "body": "Thanks Parfait, I changed it and tested it again but fails. I digged into it somewhat more and use the XML source in XML to see if I could re-engineer the file in Excel and found out that the special characters are causing the problem. When I remove them from the data then the webserve call is executed just fine."}], "owner": {"reputation": 1, "user_id": 12019801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a8cc8f35f5111de1326323ee52c0ee9?s=128&d=identicon&r=PG&f=1", "display_name": "RichardG", "link": "https://stackoverflow.com/users/12019801/richardg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567608395, "creation_date": 1567601568, "last_edit_date": 1567608395, "question_id": 57788829, "link": "https://stackoverflow.com/questions/57788829/issue-with-xml-formatting-fso-write-createtextfile", "title": "Issue with XML formatting (fso.write, CreateTextFile)", "body": "<p>I am trying to send via Excel VBA data via a SOAP call to a webservice. Initially I built a version which works and is based on quite a decent amount of code lines but in concept took data from various excel tabs (<em>inout, connection details, codelists</em>) with help from <code>CreateObject(\"MSXML2.serverXMLHTTP\")</code> to send the data and <code>CreateObject(\"MSXML2.DOMDocument)\"</code> to store the response back into a XML. </p>\n\n<p>All worked fine except for large quantities of lines. When the Excel sheet Input has more than 250 lines than the processing time (CPU load) is high and takes about 6-7 minutes in which the application 'hangs'. With help from other post I rebuilt the code to use <code>fso.CreateObject(\"Scripting.FileSystemObject\")</code> and use <code>fso.CreateTextFile</code> to write the file immediately and not take the data into memory first. But now I run into a 'snag'. When I create the XML file (before sending it via the SOAP service) and open it in any browser I can only see that data itself and not the nodes. Where as if I open an XML create the old way then it shows perfectly. When opening the files in Notepad++ they seem to me as the same but somehow they are not.</p>\n\n<p>And this brings me to the biggest problem. When the XML is created (in the new way) then the connection is established but I get an error from the webservice. I believe this has to do with the fact that the <code>MyDom = CreateObject(\"MSXML2.DOMDocument\"): myDOM.load (myxml)</code> does not see the nodes but pure data like the brower does. </p>\n\n<p>I've already tried several ways and used the old XML files to send them via the webserice call. Tried also to add a blank line at the bottom but I do not understand the problem nor do I know how I can make the <code>MyDom = CreateObject(\"MSXML2.DOMDocument\"): MyDom (myXML)</code> visible to me so I can see what it is trying to post. Hence my question to you and see if you have idea's. </p>\n\n<p>Here is a shortened version of the code to create the XML file:</p>\n\n<pre><code>Function CallWS()\n\n'*****************************\nDim StartTimeCreateXML As Double\nDim SecondsElapsedCreateXML As Double\n\n'Remember time when macro starts\n  StartTimeCreateXML = Timer\n\n'***************************** \n\n    '==CLEAR CELLS WITH IDs AND WARNINGS\n    Call ClearCellsIDs\n\n    '==TURN SCREENUPDATE OFF\n    Application.ScreenUpdating = False\n\n    '==Declare our working variables\n    Dim sMsg As String\n    Dim sURL As String\n    Dim LogSetting As String\n    Dim fso As Object\n    Dim oFile As Object\n\n    '==DEFINE XMLHTTP\n    Dim ObjHTTP As Object\n    Set ObjHTTP = CreateObject(\"MSXML2.serverXMLHTTP\")\n\n    '==DEFINE XMLDOCPOST and XMLDOCRESP\n    Set XMLdocPost = CreateObject(\"ADODB.Stream\")\n    Set XMLdocResp = CreateObject(\"MSXML2.DOMDocument\")\n\n    '==DEFINITIONS\n    sURL = Sheets(\"Connection\").Range(\"I13\")\n    Client = Sheets(\"Connection\").Range(\"I14\")\n    User = Sheets(\"Connection\").Range(\"I15\") &amp; \"@\" &amp; Client\n    Password = Sheets(\"Connection\").Range(\"I16\")\n    OperationMode = Sheets(\"Connection\").Range(\"I20\")\n    LogSetting = Sheets(\"Connection\").Range(\"I21\").Value\n\n    '==CREATE UNIQUE ID FOR CONSIGNMENT AND DELIVERY\n    myEori = Sheets(\"Connection\").Range(\"I22\").Value\n    MyTimeString = Format(Now, \"yyyymmddhhmmss\")\n\n    myGenID = myEori &amp; \"-\" &amp; MyTimeString\n\n    '==DEFINE FSO AND OFILE\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set oFile = fso.CreateTextFile(\"C:\\Users\\XXX\\Desktop\\TEST\\2.B. Project Excel SOAP\\SOMECUSTOMER\\1a. Development XMLsource\\Temp2.xml\", True)\n\n    '==WE CREATE OUR XML FOR SUBMISSION TO THE WEB SERVICE\n\n    oFile.Write \"&lt;soap:Envelope xmlns:soap=\"\"http://schemas.xmlsoap.org/soap/envelope/\"\"&gt;\" &amp; vbCrLf\n    oFile.Write \"    &lt;soap:Body&gt;\" &amp; vbCrLf\n    oFile.Write \"        &lt;createConsignment xmlns=\"\"urn:de.aeb.xnsg.ic.bf\"\"&gt;\" &amp; vbCrLf\n    oFile.Write \"           &lt;request xmlns=\"\"\"\"&gt;\" &amp; vbCrLf\n    oFile.Write \"           &lt;Test1&gt;TEST1&lt;/Test1&gt;\" &amp; vbCrLf\n    oFile.Write \"           &lt;Test2&gt;TEST2&lt;/Test2&gt;\" &amp; vbCrLf\n    oFile.Write \"        &lt;/createConsignment&gt;\" &amp; vbCrLf\n    oFile.Write \"    &lt;/soap:Body&gt;\" &amp; vbCrLf\n    oFile.Write \"&lt;/soap:Envelope&gt;\" \n'END XML CREATION\n'=============================================================================\n    'CLOSE OFILE\n    oFile.Close\n\n    '==TURN SCREENUPDATE BACK ON\n    Application.ScreenUpdating = True\n\n    '==CLEAN UP CODE\n    Set ObjHTTP = Nothing\n    Set xmldoc = Nothing\n\nEnd Function\n</code></pre>\n\n<p>And here is the webservice call function: </p>\n\n<pre><code>Function WebServiceCall()\n\n'*****************************\nDim StartTimeWebServiceCall As Double\nDim SecondsElapsedWebServiceCall As Double\n\n'Remember time when macro starts\n  StartTimeWebServiceCall = Timer\n\n'*****************************\n'Insert Your Code Here...\n    '==DEFINE XMLHTTP\n    Dim myHTTP As Object\n    Set myHTTP = CreateObject(\"MSXML2.serverXMLHTTP\")\n\n    '==DEFINE XMLDOCPOST and XMLDOCRESP\n    Set MyDom = CreateObject(\"ADODB.Stream\")\n    Set MyDom = CreateObject(\"MSXML2.DOMDocument\")\n    Dim sURL As String\n\n    sURL = Sheets(\"Connection\").Range(\"I13\")\n    Client = Sheets(\"Connection\").Range(\"I14\")\n    User = Sheets(\"Connection\").Range(\"I15\") &amp; \"@\" &amp; Client\n    Password = Sheets(\"Connection\").Range(\"I16\")\n    OperationMode = Sheets(\"Connection\").Range(\"I20\")\n    LogSetting = Sheets(\"Connection\").Range(\"I21\").Value\n\n\n    'Create the DomDocument Object\n    Set MyDom = CreateObject(\"MSXML2.DOMDocument\")\n\n    'Load entire Document before moving on\n    MyDom.async = False\n    MyDom.Load ThisWorkbook.Path &amp; \"\\Temp2.xml\"\n\n    'wat wordt er gepost?\n\n\n    'open the connection\n    myHTTP.Open \"POST\", sURL, False\n    'We create the SOAP header for submission to the Web service\n    myHTTP.setRequestHeader \"Content-Type\", \"text/xml\"\n    myHTTP.setRequestHeader \"Authorization\", \"Basic \" + Base64Encode(User + \":\" + Password)\n\n    'send the XML\n    myHTTP.Send (MyDom.XML)\n\n    'Display the response\n    MsgBox myHTTP.ResponseText\n\n    '==CLEAN UP CODE\n    Set MyDom = Nothing\n    Set myHTTP = Nothing\n\n '*****************************\n'Determine how many seconds code took to run\n  SecondsElapsedWebServiceCall = Round(Timer - StartTimeWebServiceCall, 2)\n\n'Notify user in seconds\n  MsgBox \"This code WebServiceCall ran successfully in \" &amp; SecondsElapsedWebServiceCall &amp; \" seconds\", vbInformation\n'*****************************\n\nEnd Function\n</code></pre>\n\n<p>Not all code is mine here and there I copied some code from others for example the sections about the timers. </p>\n\n<p>The error I get from the webservice is: </p>\n\n<blockquote>\n  <p>Fehler bei XML-Reader: com.ctct.wstx.exc.WstxEOFException: Unexpected\n  EOD in prolog</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1567600147, "post_id": 57788239, "comment_id": 102010146, "body": "Try using <code>Set sourceBook = ThisWorkbook</code>"}, {"owner": {"reputation": 1, "user_id": 11587750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d14b5f825e89e4d418b6cb4733d2293?s=128&d=identicon&r=PG&f=1", "display_name": "mikeluke80", "link": "https://stackoverflow.com/users/11587750/mikeluke80"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1567600858, "post_id": 57788239, "comment_id": 102010500, "body": "Thanks, the workbook where the macro is located is the target, the problem seems to be that it is not using the correct reference for the source"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1567601013, "post_id": 57788239, "comment_id": 102010577, "body": "Also according to Tom&#39;s comment, change every &#39;ActiveSheet&#39; to specified sheet for example sheets(&quot;NameOfSheet&quot;)"}, {"owner": {"reputation": 1, "user_id": 11587750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d14b5f825e89e4d418b6cb4733d2293?s=128&d=identicon&r=PG&f=1", "display_name": "mikeluke80", "link": "https://stackoverflow.com/users/11587750/mikeluke80"}, "edited": false, "score": 0, "creation_date": 1567601439, "post_id": 57788239, "comment_id": 102010814, "body": "Yes i tried that previously but seem to get a &quot;Script out of range&quot; error on the line"}, {"owner": {"reputation": 1, "user_id": 11587750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d14b5f825e89e4d418b6cb4733d2293?s=128&d=identicon&r=PG&f=1", "display_name": "mikeluke80", "link": "https://stackoverflow.com/users/11587750/mikeluke80"}, "edited": false, "score": 0, "creation_date": 1567601446, "post_id": 57788239, "comment_id": 102010817, "body": "Set sourceSheet = sourceBook.Sheets(&quot;Fixed Costs Calc&quot;)"}, {"owner": {"reputation": 1, "user_id": 11587750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d14b5f825e89e4d418b6cb4733d2293?s=128&d=identicon&r=PG&f=1", "display_name": "mikeluke80", "link": "https://stackoverflow.com/users/11587750/mikeluke80"}, "edited": false, "score": 0, "creation_date": 1567604857, "post_id": 57788239, "comment_id": 102012836, "body": "Changing the Workbook.Count as above to &lt;&gt;2 makes the error window always flag, even if two workbooks are open?"}], "owner": {"reputation": 1, "user_id": 11587750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d14b5f825e89e4d418b6cb4733d2293?s=128&d=identicon&r=PG&f=1", "display_name": "mikeluke80", "link": "https://stackoverflow.com/users/11587750/mikeluke80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567603580, "creation_date": 1567599395, "last_edit_date": 1567603580, "question_id": 57788239, "link": "https://stackoverflow.com/questions/57788239/copy-data-from-one-workbook-to-another-when-the-file-name-is-never-the-same", "title": "Copy data from one workbook to another when the file name is never the same", "body": "<p>Trying to create a macro so i can open two identical workbooks but both will have constantly changing different file names and then copy a few data ranges from source to target. \nI have tried to put together something from a few different places but am getting lost with it so i was hoping someone could shed some new light for me. </p>\n\n<p>VBA for Excel 2016</p>\n\n<pre><code>Sub Button33_Click()\n\n\nDim sourceBook As Workbook\nDim targetBook As Workbook\nDim sourceSheet As Worksheet\nDim targetSheet As Worksheet\n\n' Must have exactly 2 workbooks open\nIf Workbooks.Count &lt;&gt; 2 Then 'if it is equal to 2 it will not work\n    MsgBox \"Open the calculation form that you want to copy from\", vbCritical + vbOKOnly, \"Copy Data From Old to New Sheets\"\n    Exit Sub\nEnd If\n\n' Set the source and target workbooks\nSet targetBook = ActiveWorkbook\n\nSet sourceBook = Workbooks(1)\n\n\n' Setting up the sheets\nSet sourceSheet = sourceBook.ActiveSheet\nSet targetSheet = targetBook.ActiveSheet\n\n' Copy the data from the cells\n\nsourceSheet.Range(\"D14:D18\").Copy Destination:=targetSheet.Range(\"D14:D18\")\nsourceSheet.Range(\"A2\").Copy Destination:=targetSheet.Range(\"A2\")\nsourceSheet.Range(\"B5\").Copy Destination:=targetSheet.Range(\"B5\")\nsourceSheet.Range(\"E26\").Copy Destination:=targetSheet.Range(\"E26\")\nsourceSheet.Range(\"G14\").Copy Destination:=targetSheet.Range(\"G14\")\n\n\nEnd Sub\n</code></pre>\n\n<p>The wrong data is being copied and i cant figure out where it is coming from.</p>\n"}, {"tags": ["excel", "vba", "matching"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1567599909, "post_id": 57788210, "comment_id": 102010008, "body": "Help us to help you; <b>post your current code.</b>"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1567602213, "post_id": 57788210, "comment_id": 102011220, "body": "You may try conditional formatting by UDF."}], "answers": [{"tags": [], "owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "is_accepted": false, "score": 2, "last_activity_date": 1567600827, "creation_date": 1567600827, "answer_id": 57788615, "question_id": 57788210, "link": "https://stackoverflow.com/questions/57788210/matching-with-a-column-containing-character-delimited-values-in-excel-using-vba/57788615#57788615", "title": "Matching with a column containing character-delimited values in excel using VBA", "body": "<p>That should work</p>\n\n<p>1)</p>\n\n<pre><code>Sub butA()\n\nDim szyt2 As Worksheet\nDim j As Long, i As Long, k As Long\nDim lastRow As Long\nDim araj1\nDim araj2\n\nSet szyt2 = ThisWorkbook.Sheets(\"Sheet2\")\nlastRow = szyt2.Cells(Rows.Count, 1).End(xlUp).row\naraj1 = szyt2.Range(\"A1:A\" &amp; lastRow).Value\naraj2 = szyt2.Range(\"B1:B\" &amp; lastRow).Value\n\nFor i = 1 To UBound(araj2, 1)\n    If Not (araj2(i, 1) = \"\") Then\n        If InStr(1, araj2(i, 1), \";\") &gt; 0 Then\n            ar = Split(araj2(i, 1), \";\")\n            For k = 0 To UBound(ar)\n                For j = 1 To UBound(araj1, 1)\n                    If araj1(j, 1) = ar(k) Then\n                        szyt2.Cells(j, 1).Interior.ColorIndex = 3\n                    End If\n                Next\n            Next\n        End If\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>2)</p>\n\n<pre><code>Sub butB()\n\nDim szyt2 As Worksheet\nDim j As Long, i As Long, k As Long\nDim lastRow As Long\nDim araj1\nDim araj2\n\nSet szyt2 = ThisWorkbook.Sheets(\"Sheet2\")\nlastRow = szyt2.Cells(Rows.Count, 1).End(xlUp).row\naraj1 = szyt2.Range(\"A1:A\" &amp; lastRow).Value\naraj2 = szyt2.Range(\"B1:B\" &amp; lastRow).Value\ncounter = 0\n\nFor i = 1 To UBound(araj2, 1)\n    If Not (araj2(i, 1) = \"\") Then\n        If InStr(1, araj2(i, 1), \";\") &gt; 0 Then\n            ar = Split(araj2(i, 1), \";\")\n            For k = 0 To UBound(ar)\n                For j = 1 To UBound(araj1, 1)\n                    If araj1(j, 1) = ar(k) Then\n                        counter = counter + 1\n                    End If\n                Next\n                If counter &gt; 0 Then Exit For\n            Next\n            If counter &gt; 0 Then\n                szyt2.Cells(i, 2).Interior.ColorIndex = 3\n            End If\n        End If\n    End If\n    counter = 0\nNext\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4490, "user_id": 3223138, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/46a0591e6137cfa9a77232502ab22924?s=128&d=identicon&r=PG&f=1", "display_name": "Crops", "link": "https://stackoverflow.com/users/3223138/crops"}, "edited": false, "score": 0, "creation_date": 1567661302, "post_id": 57796923, "comment_id": 102030348, "body": "The use of <code>Scripting.Dictionary</code> did the trick for me. Can the same strategy be used for checking duplicates within Column B (eg. B9 and B20)."}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1567661640, "post_id": 57796923, "comment_id": 102030446, "body": "Yes, Dictionaries are causing &quot;error&quot; in case of same id in collection, so yes (ofc You can go throw that error by On Error Resume Next etc.)"}, {"owner": {"reputation": 4490, "user_id": 3223138, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/46a0591e6137cfa9a77232502ab22924?s=128&d=identicon&r=PG&f=1", "display_name": "Crops", "link": "https://stackoverflow.com/users/3223138/crops"}, "edited": false, "score": 1, "creation_date": 1567672952, "post_id": 57796923, "comment_id": 102035182, "body": "Managed to get duplicates within the column with semi-colon separated values as follows: <code>For Each keyB In dicB             If dicB(keyB) Like &quot;*,*&quot; Then                 .Range(dicB(keyB)).Interior.Color = RGB(255, 183, 183)             End If         Next keyB</code>"}], "tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": true, "score": 1, "last_activity_date": 1567642076, "creation_date": 1567642076, "answer_id": 57796923, "question_id": 57788210, "link": "https://stackoverflow.com/questions/57788210/matching-with-a-column-containing-character-delimited-values-in-excel-using-vba/57796923#57796923", "title": "Matching with a column containing character-delimited values in excel using VBA", "body": "<p>Try this:</p>\n\n<pre><code>Sub rrrrr()\n\n    Dim dicA As Object: Set dicA = CreateObject(\"Scripting.Dictionary\")\n    Dim dicB As Object: Set dicB = CreateObject(\"Scripting.Dictionary\")\n    Dim lastRow&amp;, cl As Range, key$, keyA, keyB, x\n\n    With ActiveSheet 'replace with source\n\n        lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        'get dictionary for column A\n        For Each cl In .Range(.[A1], .Cells(lastRow, \"A\"))\n            If Trim(cl.Value2) &lt;&gt; \"\" Then\n                key = Trim(cl.Value2)\n                If Not dicA.exists(key) Then\n                    dicA.Add key, cl.Address(0, 0)\n                Else\n                    dicA(key) = dicA(key) &amp; \",\" &amp; cl.Address(0, 0)\n                End If\n            End If\n        Next cl\n\n        'get dictionary for column B\n        For Each cl In .Range(.[B1], .Cells(lastRow, \"B\"))\n            If Trim(cl.Value2) &lt;&gt; \"\" Then\n                For Each x In Split(cl.Value2, \";\")\n                    key = Trim(x)\n                    If Not dicB.exists(key) Then\n                        dicB.Add key, cl.Address(0, 0)\n                    Else\n                        dicB(key) = dicB(key) &amp; \",\" &amp; cl.Address(0, 0)\n                    End If\n                Next x\n            End If\n        Next cl\n\n        'keys in A not exist in B\n        For Each keyA In dicA\n            If Not dicB.exists(keyA) Then\n                .Range(dicA(keyA)).Interior.Color = vbYellow\n            End If\n        Next keyA\n\n        'keys in B not exist in A, and add comment what exact key not exists in B\n        For Each keyB In dicB\n            If Not dicA.exists(keyB) Then\n                With .Range(dicB(keyB))\n                    .Interior.Color = vbYellow\n                    .ClearComments: .AddComment:\n                    With .Comment\n                        .Text \"missed: \" &amp; keyB\n                        .Shape.TextFrame.AutoSize = 1\n                        .Shape.TextFrame.Characters.Font.Bold = 1\n                        .Shape.Fill.ForeColor.RGB = RGB(58, 82, 184)\n                        .Shape.AutoShapeType = msoShapeRoundedRectangle\n                        .Shape.TextFrame.Characters.Font.ColorIndex = 2\n                    End With\n                End With\n            End If\n        Next keyB\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>demo:\n<a href=\"https://i.stack.imgur.com/xbwyi.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xbwyi.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 4490, "user_id": 3223138, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/46a0591e6137cfa9a77232502ab22924?s=128&d=identicon&r=PG&f=1", "display_name": "Crops", "link": "https://stackoverflow.com/users/3223138/crops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "accepted_answer_id": 57796923, "answer_count": 2, "score": 0, "last_activity_date": 1567642076, "creation_date": 1567599303, "question_id": 57788210, "link": "https://stackoverflow.com/questions/57788210/matching-with-a-column-containing-character-delimited-values-in-excel-using-vba", "title": "Matching with a column containing character-delimited values in excel using VBA", "body": "<p>I have data in two columns in a sheet as follows.</p>\n\n<pre><code>+------------------+---------------------------------------+\n|       A          |                  B                    |\n+------------------+---------------------------------------+\n| Hector Hall      |                                       |\n| Guy Gardner      |                                       |\n| Bart Allen       |                                       |\n| Kyle Rayner      |                                       |\n| Dick Grayson     |                                       |\n| Khalid Nassour   |                                       |\n| Kent Nelson      |                                       |\n| Tim Drake        |                                       |\n| Bat 2            | Dick Grayson; James Gordon            |\n| James Gordon     |                                       |\n| Hal Jordan       |                                       |\n| Robin 2          | Tim Drake; Stephanie Brown            |\n| Jay Garrick      |                                       |\n| Jason Todd       |                                       |\n| Flash 1          | Barry Allen; Wally West               |\n| GL 2             | Guy Gardner; Kyle Rayner; Jon Stewart |\n| Fate 1           | Kent Nelson; Khalid Nassour           |\n| GL 1             | Alan Scott; Simon Baz                 |\n| Simon Baz        |                                       |\n| Robin 1          | Dick Grayson; Damien Wayne            |\n| Alan Scott       |                                       |\n| Bruce Wayne      |                                       |\n| Jean Paul Valley |                                       |\n| Wally West       |                                       |\n| Bat 1            | Bruce Wayne; Jean Paul Valley         |\n+------------------+---------------------------------------+\n</code></pre>\n\n<p>I am trying to create an ActiveX command button with <code>VBA</code> code which does the following conditional formatings:</p>\n\n<p>1) Highlight all the cells in <strong>A</strong> which are present as semi-colon separated values in <strong>B</strong>.</p>\n\n<p>2) Highlight all the cells in <strong>B</strong> whose semi-colon separated values are not present in <strong>A</strong>.</p>\n\n<p>Currently, I am able to do so by getting all the semi-colon spearated values in a separate sheet and using that for matching. But it gets tricky as the number of semi-colon separated values in <strong>B</strong> is not uniform and can vary widely.</p>\n\n<p>Is there a more elegant way of doing this in excel VBA?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1567598072, "post_id": 57787800, "comment_id": 102008971, "body": "Most likely the pivot table name is not <code>orderseur</code>"}, {"owner": {"reputation": 43, "user_id": 8380035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf514b784f88e4a1e5483b83005e44c?s=128&d=identicon&r=PG&f=1", "display_name": "byte00", "link": "https://stackoverflow.com/users/8380035/byte00"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1567598366, "post_id": 57787800, "comment_id": 102009148, "body": "I thought of this already and I changed the name to something else but I get the same error. The name is taken from Option Tab, PivotTable Name."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 1, "creation_date": 1567599078, "post_id": 57787800, "comment_id": 102009542, "body": "Record a macro when you do something with that pivot table"}], "owner": {"reputation": 43, "user_id": 8380035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf514b784f88e4a1e5483b83005e44c?s=128&d=identicon&r=PG&f=1", "display_name": "byte00", "link": "https://stackoverflow.com/users/8380035/byte00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1567600630, "creation_date": 1567597833, "last_edit_date": 1567600630, "question_id": 57787800, "link": "https://stackoverflow.com/questions/57787800/what-is-wrong-with-this-excel-vba-code-problem", "title": "What is wrong with this Excel VBA Code problem", "body": "<p>I do not know what is wrong with this Excel VBA code because it works in other sheets. I only changed names to refer to the sheet needed.</p>\n\n<pre><code>Sheets(\"Orders EUR in curs\").Select\nActiveSheet.PivotTables(\"orderseur\").PivotFields(\"Centru_Cost\").CurrentPage _\n    = \"(All)\"\nWith ActiveSheet.PivotTables(\"orderseur\").PivotFields(\"Centru_Cost\")\n    .PivotItems(\"CENTRU DIVERSE\").Visible = False\n\nEnd With\n</code></pre>\n\n<p>When run I get:</p>\n\n<blockquote>\n  <p>1004 error: application defined or object defined error.</p>\n</blockquote>\n\n<p>When I try to debug this part seems to be the problem:</p>\n\n<pre><code>ActiveSheet.PivotTables(\"orderseur\").PivotFields(\"Centru_Cost\").CurrentPage _\n    = \"(All)\"\n</code></pre>\n\n<p>Not sure if it matters but I use Office 2010.</p>\n\n<p><strong>Update</strong>: As a final option I have deleted the sheet and made it again and now it works. Still I have no idea what was the problem.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1567604759, "post_id": 57787254, "comment_id": 102012773, "body": "Can you show us what you have tried so far?"}, {"owner": {"reputation": 39, "user_id": 11803714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uoVpc.jpg?s=128&g=1", "display_name": "Husnain Iqbal", "link": "https://stackoverflow.com/users/11803714/husnain-iqbal"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1567663780, "post_id": 57787254, "comment_id": 102031109, "body": "I am trying to add code with unable to do it. I am new to stack. Please guide."}, {"owner": {"reputation": 39, "user_id": 11803714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uoVpc.jpg?s=128&g=1", "display_name": "Husnain Iqbal", "link": "https://stackoverflow.com/users/11803714/husnain-iqbal"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1567852607, "post_id": 57787254, "comment_id": 102094863, "body": "Does anybody have a solution for this?"}], "owner": {"reputation": 39, "user_id": 11803714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uoVpc.jpg?s=128&g=1", "display_name": "Husnain Iqbal", "link": "https://stackoverflow.com/users/11803714/husnain-iqbal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567693965, "creation_date": 1567595772, "last_edit_date": 1567693965, "question_id": 57787254, "link": "https://stackoverflow.com/questions/57787254/adding-row-via-vba-based-on-condition", "title": "Adding Row via VBA based on condition", "body": "<p>I use a VBA code to issue letters to defaulters. The data is maintained product-wise. If the Person1 has to pay for product1 it prints the SHEET2 (having data acquired from several other sheets) \nIf the same person has to pay for product2 it prints a second letter. \nI am looking for a solution that if a person is repeated the code should add a row to an existing letter.</p>\n\n<pre><code>Sub Complaintexporter()\n\nDim X As Integer\nDim rng As Range\n\n\nX = 3\nDo Until IsEmpty(Sheet1.Cells(X, 29))\n\nIf Sheet1.Cells(X, 29) = \"Legal Issued to Exporter\" And Date - Sheet1.Cells(X, 36) &gt; 21 Then\nSheet9.Cells(1, 1) = Sheet1.Cells(X, 4)\nSet rng = Sheet1.Cells(X, 4)\n'\n'Sheet1.Activate\n'    Cells.Find(What:=Sheet9.Cells(1, 1), After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\n'        xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n'        , SearchFormat:=False).Activate\n       'Remarks\n        Sheet1.Cells(X, 4).Offset(0, 25).Value = \"Pending In FEA Court\"\n        'FEAD/FEOD\n        Sheet1.Cells(X, 4).Offset(0, 24).Value = \"FEAD\"\n        'Details Penalty\n        Sheet1.Cells(X, 4).Offset(0, 26).Value = \"Pending In FEA Court\"\n        'year\n        Sheet1.Cells(X, 4).Offset(0, 28).Value = \"2019\"\n        'Complaint against\n        Sheet1.Cells(X, 4).Offset(0, 29).Value = \"Exporter\"\n        'Complainant/ Officer\n        Sheet1.Cells(X, 4).Offset(0, 36).Value = Sheet1.Cells(1, 4)\n        'Complaint No\n        Sheet1.Cells(X, 4).Offset(0, 27).Value = Sheet2.Cells(1, 2)\n        'Date of complaint against exporter\n        Sheet1.Cells(X, 4).Offset(0, 34).Value = Date\n\nSheet4.PrintOut\nSheet5.PrintOut\nSheet6.PrintOut\n\n'Write E-Form in list\nSheet2.Cells(Sheet2.Cells(1, 1), 2) = Sheet9.Cells(1, 1)\n'Write Date against E-Form\nSheet2.Cells(Sheet2.Cells(1, 1), 3) = Date\n'Increasing Serial No.\nSheet2.Cells(1, 1) = Sheet2.Cells(1, 1) + 1\n'Increasing Complaint No.\nSheet2.Cells(1, 2) = Sheet2.Cells(1, 2) + 1\n\nEnd If\nX = X + 1\nLoop\nMsgBox Sheet2.Cells(12, 9)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "image", "userform"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 9213726, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1KOc.jpg?s=128&g=1", "display_name": "Steven Goddard", "link": "https://stackoverflow.com/users/9213726/steven-goddard"}, "edited": false, "score": 1, "creation_date": 1568019085, "post_id": 57788910, "comment_id": 102128002, "body": "Thank you  Breno, I actually combined this with a piece of software I use called GreenShot which overrides my printscreen button.   I can use this program to automatically save screenshots to a defined directory. Combined with your sendkeys method it works a treat!  To remove the 3 buttons on the side I just created a duplicate userform without the buttons for use specifically when exporting."}], "tags": [], "owner": {"reputation": 302, "user_id": 11958215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9htzU.jpg?s=128&g=1", "display_name": "Breno Teodoro", "link": "https://stackoverflow.com/users/11958215/breno-teodoro"}, "is_accepted": true, "score": 1, "last_activity_date": 1567601817, "creation_date": 1567601817, "answer_id": 57788910, "question_id": 57787233, "link": "https://stackoverflow.com/questions/57787233/creating-an-image-from-a-userform-of-exported-charts/57788910#57788910", "title": "Creating an image from a userform of exported charts", "body": "<p>Steven,</p>\n\n<p>In the below sub, I used the SendKeys method to send <em>Alt+PrintScreen</em> (<strong>\"%{1068}\"</strong>) and <em>Ctrl+V</em> (<strong>\"^v\"</strong>) on the current application. The SendKeys method simulates the key presses of a keyboard, so it would replicate what you're doing right now.</p>\n\n<pre><code>Sub PrintTheScreen()\n    Application.SendKeys (\"%{1068}\")\n    DoEvents\n    Application.SendKeys (\"^v\")\n    DoEvents\nEnd Sub\n</code></pre>\n\n<p>Reference for this method can be found <a href=\"https://docs.microsoft.com/pt-br/office/vba/language/reference/user-interface-help/sendkeys-statement\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Having the sendkeys applied to the userform will simulate your button press. By then, you could set a word application object and paste the printed screen, for example.</p>\n\n<p>Sub CreatingWDDoc()\n    Dim appWD As Word.Application</p>\n\n<pre><code>Set appWD = CreateObject(\"Word.Application\")\n    appWD.Visible = True\n    appWD.Documents.Add\n    appWD.SendKeys (\"^v\")\n    ' Change the string to the path you wish to use for seving the file\n    appWD.SaveAs (\u201c\u201d)\n    appWD.Quit\nEnd Sub\n</code></pre>\n\n<p>Keep in mind that to use such functions, you need to have the word library referenced in your project, under <em>Tools >> References</em>. More information can be found <a href=\"https://docs.microsoft.com/pt-br/office/vba/excel/concepts/working-with-other-applications/controlling-one-microsoft-office-application-from-another\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 59, "user_id": 9213726, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1KOc.jpg?s=128&g=1", "display_name": "Steven Goddard", "link": "https://stackoverflow.com/users/9213726/steven-goddard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 57788910, "answer_count": 1, "score": 0, "last_activity_date": 1567601817, "creation_date": 1567595714, "question_id": 57787233, "link": "https://stackoverflow.com/questions/57787233/creating-an-image-from-a-userform-of-exported-charts", "title": "Creating an image from a userform of exported charts", "body": "<p>I have written a code that charts various data. The charts are then exported as .gif files. The image files are then loaded as pictures into image controls in a userform as shown below.</p>\n\n<p>How do I go about exporting the whole userform (preferably without the 3 buttons on the right) as an image for use in a report?</p>\n\n<p>Currently I am using manual printscreen but it is quite time consuming..</p>\n\n<p><a href=\"https://imgur.com/a/MYRLzMX\" rel=\"nofollow noreferrer\" title=\"Chart Window\">Chart Example</a></p>\n\n<p>Currently I am manually using printscreen but it is quite time consuming..\nIs there a way to access the alt-printscreen button perhaps?</p>\n\n<p>The chart creation code itself isn't really relevant but I can share if required.</p>\n\n<p>I expect an image file that I can then use within a word document.\nPreferably cropped to remove the 3 buttons on the right of the userform.</p>\n"}, {"tags": ["vba", "powershell"], "comments": [{"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 1, "creation_date": 1567598087, "post_id": 57787132, "comment_id": 102008982, "body": "<a href=\"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/group-object\" rel=\"nofollow noreferrer\">Group</a> by casenumber. <a href=\"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/sort-object\" rel=\"nofollow noreferrer\">Sort</a> <a href=\"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/foreach-object\" rel=\"nofollow noreferrer\">each</a> group and <a href=\"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/select-object\" rel=\"nofollow noreferrer\">pick</a> the last element. Then move those files."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12018000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eddb9ba42d67b6e73a6fc315bb1e4dd?s=128&d=identicon&r=PG&f=1", "display_name": "muggi", "link": "https://stackoverflow.com/users/12018000/muggi"}, "is_accepted": true, "score": 0, "last_activity_date": 1568035370, "last_edit_date": 1568035370, "creation_date": 1568034853, "answer_id": 57854798, "question_id": 57787132, "link": "https://stackoverflow.com/questions/57787132/move-newest-file-out-of-several-files-with-same-filename-prefix-date-to-fo/57854798#57854798", "title": "Move newest file out of several files with same filename (&quot;prefix&quot; + date) to folder", "body": "<p>Found 2 powershell solutions that after editing a bit, can be used for this\nthank you to among others ChristianB &amp; ArcSet &amp; user3019391 :</p>\n\n<pre><code># Copy files without renaming files\n# creates foldernames from part of filename before underscore.\n# copying files and grouping them in the folders created, matching the first part of filename.\n\n\n$SourceFolder = \"C:\\simtest\\\"\n$targetFolder = \"C:\\simtest2\\\"\n\n$numFiles = (Get-ChildItem -Path $SourceFolder -Filter *.xml).Count\n$i = 0\n\nclear-host;\nWrite-Host 'This script will copy ' $numFiles ' files from ' $SourceFolder ' to ' $targetFolder\nRead-host -prompt 'Press enter to start copying the files'\n\nGet-ChildItem -Path $SourceFolder -Filter *.xml | % { \n    [System.IO.FileInfo]$destination = (Join-Path -Path $targetFolder -ChildPath $_.Name.replace(\"_\", \"\\\"))\n\n    # keeping filesnames as original with 2 lines #\n    $destination = [System.IO.Path]::GetDirectoryName($destination.FullName)\n    $destination = $destination.FullName + \"\\\" + $_.Name\n    ## end of 2 lines \n\n    if (!(Test-Path -Path $destination.Directory )) {\n        New-item -Path $destination.Directory.FullName -ItemType Directory \n    }\n    [int]$percent = $i / $numFiles * 100\n\n    copy-item -Path $_.FullName -Destination $Destination.FullName\n    Write-Progress -Activity \"Copying ... ($percent %)\" -status $_  -PercentComplete $percent -verbose\n    $i++\n}\nWrite-Host 'Total number of files read from directory '$SourceFolder ' is ' $numFiles\nWrite-Host 'Total number of files that was copied to '$targetFolder ' is ' $i\nRead-host -prompt \"Press enter to complete...\"\nclear-host;\n</code></pre>\n\n<p>Second part, where code moves newest file from each subfolder, to another folder</p>\n\n<pre><code>&lt;#Gets subfolders\n\nGets all files in subfolders\n\nSorts files by Creation Date into a array\n\nGets first Entry\n\nMoves file to Destination directory\n\n*It will overwrite files with the same name in the destination folder #&gt;\n\n\nFunction Get-LatestFiles($SourceFolder,$Destination){\n    $Subfolders = Get-ChildItem $SourceFolder -Directory\n    [System.Collections.ArrayList]$SubFoldersExpanded = new-object System.Collections.ArrayList\n    Foreach($SubFolder in $SubFolders){\n        $SubFolderExpanded =  $Subfolder | %{(Get-ChildItem $_.FullName -File -Depth 1 | Sort-Object -Property CreationTime -Descending)}\n        if($SubFolderExpanded.Count -gt 0){\n            $SubFolderExpanded[0] | %{Move-Item $_.FullName -Destination $Destination -force}\n        }\n    }\n}\nGet-LatestFiles -SourceFolder C:\\Simtestsubfolders\\simtest2 -Destination C:\\SimtestsubfoldersDest\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12018000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eddb9ba42d67b6e73a6fc315bb1e4dd?s=128&d=identicon&r=PG&f=1", "display_name": "muggi", "link": "https://stackoverflow.com/users/12018000/muggi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 1, "accepted_answer_id": 57854798, "answer_count": 1, "score": -3, "last_activity_date": 1568035370, "creation_date": 1567595373, "last_edit_date": 1567598195, "question_id": 57787132, "link": "https://stackoverflow.com/questions/57787132/move-newest-file-out-of-several-files-with-same-filename-prefix-date-to-fo", "title": "Move newest file out of several files with same filename (&quot;prefix&quot; + date) to folder", "body": "<p>I have a program that have ongoing export of files. Another program needs to import these files.</p>\n\n<p>But it only need to import the newest file within a \"filename/date range\".</p>\n\n<p>The filename contains a 6 digit number (casenumber) and a <code>date+timestamp</code>.</p>\n\n<p>Example of file name:</p>\n\n<pre>\n732087_20190903114454043000\n</pre>\n\n<p>Picture for below color explanation.</p>\n\n<p><a href=\"https://i.stack.imgur.com/bsHm0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bsHm0.png\" alt=\"enter image description here\"></a></p>\n\n<p>Numbers in red are the casenumber.<br>\nNumbers in blue are the date (year/month/day).<br>\nNumbers in yellow are time (hour/minute/second/tenth or hundredth of a second.  </p>\n\n<p>Example of files created with ONLY same case number and Date stamp.\n(I isolated the range to only one Casenumber for this example)</p>\n\n<pre>\n732087_20190903114454043000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114452887000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114451713000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114446353000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114446161000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114445013000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114442719000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114439141000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114433660000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114431784000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114424999000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114423845000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114422669000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114421406000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114416004000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114414820000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114410392000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114405990000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114405784000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114404612000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114357807000.xml 18.979  03-09-2019 11:43    -a--\n732087_20190903114353325000.xml 18.979  03-09-2019 11:43    -a--\n732087_20190903114346777000.xml 18.979  03-09-2019 11:43    -a--\n732087_20190903114248766000.xml 18.979  03-09-2019 11:42    -a--\n732087_20190903114245183000.xml 18.979  03-09-2019 11:42    -a--\n</pre>\n\n<p>If I want to only move the last file (newest) created:\n<code>732087_20190903114454043000.xml</code> to a certain destination folder \nex: <code>n:\\Outbox\\Projectdata\\</code>\nand the rest in the same Casenumber range should be moved to an sub folder\nin ex: <code>n:\\Outbox\\Projectdata\\old</code></p>\n\n<p>A real example of several casenumbers created within same date and where the files I marked with bold should be moved to <code>n:\\Outbox\\Projectdata\\</code> the rest to <code>n:\\Outbox\\Projectdata\\old.</code></p>\n\n<pre>\n731218_20190903131544122000.xml 17.224  03-09-2019 13:15    -a--\n731218_20190903131108622000.xml 17.224  03-09-2019 13:11    -a--\n731218_20190903130833778000.xml 17.224  03-09-2019 13:08    -a--\n731218_20190903130819889000.xml 17.224  03-09-2019 13:08    -a--\n731218_20190903130332272000.xml 17.224  03-09-2019 13:03    -a--\n731218_20190903130329390000.xml 17.224  03-09-2019 13:03    -a--\n<b>734107_20190903125649782000.xml  1.833   03-09-2019 12:56    -a--</b>\n<b>732087_20190903114454043000.xml  18.979  03-09-2019 11:44    -a--</b>\n732087_20190903114452887000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114451713000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114446353000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114446161000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114445013000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114442719000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114439141000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114433660000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114431784000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114424999000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114423845000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114422669000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114421406000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114416004000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114414820000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114410392000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114405990000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114405784000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114404612000.xml 18.979  03-09-2019 11:44    -a--\n732087_20190903114357807000.xml 18.979  03-09-2019 11:43    -a--\n732087_20190903114353325000.xml 18.979  03-09-2019 11:43    -a--\n732087_20190903114346777000.xml 18.979  03-09-2019 11:43    -a--\n732087_20190903114248766000.xml 18.979  03-09-2019 11:42    -a--\n732087_20190903114245183000.xml 18.979  03-09-2019 11:42    -a--\n<b>731054_20190903110744981000.xml  18.851  03-09-2019 11:07    -a--</b>\n<b>731218_20190903102953782000.xml  17.224  03-09-2019 10:29    -a--</b>\n731218_20190903102939235000.xml 17.224  03-09-2019 10:29    -a--\n731218_20190903102939093000.xml 17.224  03-09-2019 10:29    -a--\n731218_20190903102936730000.xml 17.224  03-09-2019 10:29    -a--\n731218_20190903102928927000.xml 17.224  03-09-2019 10:29    -a--\n</pre>\n\n<p>Is it above possible, to get an VBA / Powershell or other code to look at this folder, lets say once every hour and perform the mentioned moved of ONLY newest file within each Casenumber/date?</p>\n\n<p>Problems that may occur:</p>\n\n<p>If \"move\" script is running and in the meantime/same instant a new exportfile is created, would the script take that file(s) into account, and treat it in next run. So it does not accidentally move the file to OLD folder.</p>\n\n<p>Possible solution: When script is running at first, maybe move the files to a temp folder, so if a new export file is created, the files in the temp foler is isolated from newly created files. Newly created files that would be trteated in the next script run.</p>\n\n<p>I found a topic but not sure if it is useable  in any way: \n<a href=\"https://stackoverflow.com/questions/97371/how-do-i-write-a-windows-batch-script-to-copy-the-newest-file-from-a-directory\">How do I write a Windows batch script to copy the newest file from a directory?</a></p>\n"}, {"tags": ["html", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11922854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54dd99b5275c289004b8e7a20d7ccf54?s=128&d=identicon&r=PG&f=1", "display_name": "Thejackal", "link": "https://stackoverflow.com/users/11922854/thejackal"}, "edited": false, "score": 0, "creation_date": 1567662744, "post_id": 57788080, "comment_id": 102030789, "body": "Thanks for the further assistance QHArr. Youre a machine. Looking into this now."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 31, "user_id": 11922854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54dd99b5275c289004b8e7a20d7ccf54?s=128&d=identicon&r=PG&f=1", "display_name": "Thejackal", "link": "https://stackoverflow.com/users/11922854/thejackal"}, "edited": false, "score": 0, "creation_date": 1567662980, "post_id": 57788080, "comment_id": 102030856, "body": "Any questions please ask away :-)"}, {"owner": {"reputation": 31, "user_id": 11922854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54dd99b5275c289004b8e7a20d7ccf54?s=128&d=identicon&r=PG&f=1", "display_name": "Thejackal", "link": "https://stackoverflow.com/users/11922854/thejackal"}, "edited": false, "score": 0, "creation_date": 1567676813, "post_id": 57788080, "comment_id": 102037291, "body": "Yeah I have a few.Just wondering how the option explicit works and why it is needed, when you are setting dimensions for variables, you write results() but its not set as anything. I see that it is redimensioned further down though. Can you explain or point me in the direction to learn about the queryselectorall . I have kind of put together what is happening in the redim results brackets, but unsure as to how it works, also unsure about how the trim function works with the query selector in relation to the node in the HTML2 document"}, {"owner": {"reputation": 31, "user_id": 11922854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54dd99b5275c289004b8e7a20d7ccf54?s=128&d=identicon&r=PG&f=1", "display_name": "Thejackal", "link": "https://stackoverflow.com/users/11922854/thejackal"}, "edited": false, "score": 0, "creation_date": 1567676933, "post_id": 57788080, "comment_id": 102037350, "body": "I know it seems like im asking about the whole thing haha. I see why it works and I have put together enough to adjust the code to exclude the latest season and count everything else. Im just wanting a better understanding of how the parts work. I have to do some more tweaking as ive just found out the above code will only work for multiple seasons. not single ones. I think it may be due to the set &quot;window&quot; that excludes the specials and the -2 for the end. If there are 2 or less nodes I think that would cause a problem."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 31, "user_id": 11922854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54dd99b5275c289004b8e7a20d7ccf54?s=128&d=identicon&r=PG&f=1", "display_name": "Thejackal", "link": "https://stackoverflow.com/users/11922854/thejackal"}, "edited": false, "score": 0, "creation_date": 1567678639, "post_id": 57788080, "comment_id": 102038263, "body": "It is absolutely fine. I am busy with work at moment but will update answer to address each point later today and drop you a line so you know. Then have a look and come back with any further questions."}, {"owner": {"reputation": 31, "user_id": 11922854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54dd99b5275c289004b8e7a20d7ccf54?s=128&d=identicon&r=PG&f=1", "display_name": "Thejackal", "link": "https://stackoverflow.com/users/11922854/thejackal"}, "edited": false, "score": 0, "creation_date": 1574359258, "post_id": 57788080, "comment_id": 104214932, "body": "Sorry QHarr, my follow up question is most likely asked here. The issue im having is the site code was changed, throwing a spanner in the works, mainly because I do not have access to the old HTML code to compare and figure the new one out. Your code should still work but im having trouble identifying the correct elements using the query selector. I think im having trouble with the syntax. I can get a return using the element IDs with a space in a certain  area but removing the space returns 0 results. I feel like im close but am stabbing in the dark."}, {"owner": {"reputation": 31, "user_id": 11922854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54dd99b5275c289004b8e7a20d7ccf54?s=128&d=identicon&r=PG&f=1", "display_name": "Thejackal", "link": "https://stackoverflow.com/users/11922854/thejackal"}, "edited": false, "score": 0, "creation_date": 1574359762, "post_id": 57788080, "comment_id": 104215169, "body": "Also is there a way to post code in the comments or do I need to post an answer for you to see what im trying to do"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 31, "user_id": 11922854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54dd99b5275c289004b8e7a20d7ccf54?s=128&d=identicon&r=PG&f=1", "display_name": "Thejackal", "link": "https://stackoverflow.com/users/11922854/thejackal"}, "edited": false, "score": 0, "creation_date": 1574363674, "post_id": 57788080, "comment_id": 104216974, "body": "you have enough rep to open a chat room Ithink  <a href=\"https://chat.stackoverflow.com/\">chat.stackoverflow.com</a> and add me as write access"}, {"owner": {"reputation": 31, "user_id": 11922854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54dd99b5275c289004b8e7a20d7ccf54?s=128&d=identicon&r=PG&f=1", "display_name": "Thejackal", "link": "https://stackoverflow.com/users/11922854/thejackal"}, "edited": false, "score": 0, "creation_date": 1574446973, "post_id": 57788080, "comment_id": 104249872, "body": "Hey qharr, I can&#39;t for the life of me find the create room button. I&#39;ve checked my rep and it says I&#39;m allowed but can&#39;t seem to find the actual &quot;new&quot; button."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 31, "user_id": 11922854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54dd99b5275c289004b8e7a20d7ccf54?s=128&d=identicon&r=PG&f=1", "display_name": "Thejackal", "link": "https://stackoverflow.com/users/11922854/thejackal"}, "edited": false, "score": 0, "creation_date": 1574448643, "post_id": 57788080, "comment_id": 104250542, "body": "It\u2019s at the bottom of the page of the link I shared"}, {"owner": {"reputation": 31, "user_id": 11922854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54dd99b5275c289004b8e7a20d7ccf54?s=128&d=identicon&r=PG&f=1", "display_name": "Thejackal", "link": "https://stackoverflow.com/users/11922854/thejackal"}, "edited": false, "score": 1, "creation_date": 1574450398, "post_id": 57788080, "comment_id": 104251211, "body": "Might be an issue through android. The only button I see down the bottom is show frozen rooms. I&#39;ll check on my pc when I get home."}, {"owner": {"reputation": 31, "user_id": 11922854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54dd99b5275c289004b8e7a20d7ccf54?s=128&d=identicon&r=PG&f=1", "display_name": "Thejackal", "link": "https://stackoverflow.com/users/11922854/thejackal"}, "edited": false, "score": 0, "creation_date": 1575711637, "post_id": 57788080, "comment_id": 104663862, "body": "Hey Qharr, Apologies for the lack of response. Was out of town for work on short notice. Tried the chat link but cant be found it says."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 31, "user_id": 11922854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54dd99b5275c289004b8e7a20d7ccf54?s=128&d=identicon&r=PG&f=1", "display_name": "Thejackal", "link": "https://stackoverflow.com/users/11922854/thejackal"}, "edited": false, "score": 0, "creation_date": 1575711705, "post_id": 57788080, "comment_id": 104663871, "body": "The room was deleted due to inactivity"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 31, "user_id": 11922854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54dd99b5275c289004b8e7a20d7ccf54?s=128&d=identicon&r=PG&f=1", "display_name": "Thejackal", "link": "https://stackoverflow.com/users/11922854/thejackal"}, "edited": false, "score": 0, "creation_date": 1575711796, "post_id": 57788080, "comment_id": 104663891, "body": "I can open a new one but having a day off today (mostly)"}, {"owner": {"reputation": 31, "user_id": 11922854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54dd99b5275c289004b8e7a20d7ccf54?s=128&d=identicon&r=PG&f=1", "display_name": "Thejackal", "link": "https://stackoverflow.com/users/11922854/thejackal"}, "edited": false, "score": 1, "creation_date": 1575987032, "post_id": 57788080, "comment_id": 104745416, "body": "ah sorry man. No rush. Im working this week too. off on the weekend. Ill shoot a message then and see if youre free."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1567697561, "last_edit_date": 1567697561, "creation_date": 1567598905, "answer_id": 57788080, "question_id": 57787078, "link": "https://stackoverflow.com/questions/57787078/how-to-scrape-season-episode-numbers-from-tvdb/57788080#57788080", "title": "How to scrape season episode numbers from tvdb", "body": "<p><code>Specials</code> is first and <code>All Seasons</code> is last so you can loop a <code>nodeList</code> from <code>1</code> to <code>nodeList.Length-2</code> to avoid those two nodes and simply sum the numbers in between. I use a surrogate HTMLDocument variable to hold each node's html so I can leverage <code>querySelector</code> again and avoid long chains via <code>getElements</code> and <code>nextSibling</code> etc. I wasn't really sure if you wanted the other info as well at some point so I stored each season name, dates and episode count in an array <code>results</code> (excluding nodes as described). This method also means code complexity is reduced to a single loop.</p>\n\n<pre><code>Option Explicit\nPublic Sub GetTotalEpisodes()\n    Dim i As Long, html As MSHTML.HTMLDocument, html2 As MSHTML.HTMLDocument, seasons As Object, results(), r As Long\n\n    Set html = New HTMLDocument: Set html2 = New HTMLDocument\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://www.thetvdb.com/series/legion\", False\n        .send\n        html.body.innerHTML = .responseText\n    End With\n\n    Set seasons = html.querySelectorAll(\".hidden-xs .list-group-item\")\n    ReDim results(1 To seasons.Length - 2, 1 To 3)\n\n    For i = 1 To seasons.Length - 2\n        html2.body.innerHTML = seasons.item(i).outerHTML\n        results(i, 1) = Trim$(html2.querySelector(\".list-group-item-heading\").innerText)\n        results(i, 2) = Trim$(html2.querySelector(\".list-group-item-text\").innerText)\n        results(i, 3) = 1 * html2.querySelector(\".badge\").innerText\n    Next\n    Debug.Print Application.Sum(Application.index(results, 0, 3))\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>If you wanted to store all info including first and last node but still perform a conditional sum you could house titles to exclude in an array and check against that during loop; only sum if current header not in array of exclusions</p>\n\n<pre><code>Option Explicit\nPublic Sub GetTotalEpisodes()\n    Dim i As Long, html As MSHTML.HTMLDocument, html2 As MSHTML.HTMLDocument, seasons As Object, results(), r As Long\n    Dim exclusions(), heading As String, badge As Long, total As Long\n\n    Set html = New HTMLDocument: Set html2 = New HTMLDocument\n    exclusions = Array(\"Specials\", \"All Seasons\")\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://www.thetvdb.com/series/legion\", False\n        .send\n        html.body.innerHTML = .responseText\n    End With\n\n    Set seasons = html.querySelectorAll(\".hidden-xs .list-group-item\")\n    ReDim results(1 To seasons.Length, 1 To 3)\n\n    On Error Resume Next\n    For i = 0 To seasons.Length - 1\n        html2.body.innerHTML = seasons.item(i).outerHTML\n        heading = Trim$(html2.querySelector(\".list-group-item-heading\").innerText)\n        badge = 1 * html2.querySelector(\".badge\").innerText\n        results(i + 1, 1) = html2.querySelector(\".list-group-item-heading\").innerText\n        results(i + 1, 2) = Trim$(html2.querySelector(\".list-group-item-text\").innerText)\n        results(i + 1, 3) = badge\n        If IsError(Application.match(heading, exclusions, 0)) Then\n            total = total + badge\n        End If\n    Next\n    On Error GoTo 0\n    Debug.Print total\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>OP questions:</p>\n\n<ol>\n<li><a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/option-explicit-statement\" rel=\"nofollow noreferrer\">Option Explicit</a> - forces variable declaration.</li>\n</ol>\n\n<blockquote>\n  <p>When Option Explicit On or Option Explicit appears in a file, you must\n  explicitly declare all variables by using the Dim or ReDim statements.\n  If you try to use an undeclared variable name, an error occurs at\n  compile time. The Option Explicit Off statement allows implicit\n  declaration of variables.</p>\n</blockquote>\n\n<p>It's best practice and useful for catching typos as well.</p>\n\n<ol start=\"2\">\n<li><p><code>results()</code> - I am declaring a <a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/declaring-arrays\" rel=\"nofollow noreferrer\">dynamic array</a> meaning I don't yet know the required dimensions but will later ReDim when I do. It is in fact results() As Variant (implicitly). See also <a href=\"http://www.cpearson.com/excel/VBAArrays.htm\" rel=\"nofollow noreferrer\">here</a>. I can ReDim later because at this point</p>\n\n<p>Set seasons = html.querySelectorAll(\".hidden-xs .list-group-item\")</p></li>\n</ol>\n\n<p><code>seasons.Length</code> will give me the number of rows for the first dimension of <code>results()</code>.</p>\n\n<ol start=\"3\">\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectoraLL\" rel=\"nofollow noreferrer\">querySelectorAll</a> - is akin to <code>getElementsBy</code>. It applies a <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">css selector</a> (or combination) to <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLDocument\" rel=\"nofollow noreferrer\">HTMLDocument</a> (e.g. <code>ie.Document</code>). </li>\n</ol>\n\n<blockquote>\n  <p>The Document method querySelectorAll() returns a static (not live)\n  NodeList representing a list of the document's elements that match the\n  specified group of selectors</p>\n</blockquote>\n\n<p>Modern browsers are optimized for css so this generally a fast and flexible method of finding nodes.</p>\n\n<ol start=\"4\">\n<li><p><code>Trim$</code> - is typed version of <code>Trim</code>. It is used to remove the surplus leading/trailing whitespace from the <code>node.innerText</code>.</p></li>\n<li><p>The bottom version should work for single seasons. Simply alter the array <code>exclusions</code> to account for what you wish to include/exclude. If it doesn't please provide me an example and I will update for you.</p></li>\n</ol>\n"}], "owner": {"reputation": 31, "user_id": 11922854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54dd99b5275c289004b8e7a20d7ccf54?s=128&d=identicon&r=PG&f=1", "display_name": "Thejackal", "link": "https://stackoverflow.com/users/11922854/thejackal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1567697561, "creation_date": 1567595099, "last_edit_date": 1567599532, "question_id": 57787078, "link": "https://stackoverflow.com/questions/57787078/how-to-scrape-season-episode-numbers-from-tvdb", "title": "How to scrape season episode numbers from tvdb", "body": "<p>I am attempting to isolate and work with total season episode numbers from the tvdb. Just as an easy example im working with the show LEGION (<a href=\"https://www.thetvdb.com/series/legion\" rel=\"nofollow noreferrer\">https://www.thetvdb.com/series/legion</a>). This main page will display how many seasons the show has and at the end of the row, there is a badge indicating the number of episodes in each season. I am wanting an \"absolute number\" of episodes for a show, so I need all these numbers added together. This I am able to do, however I want to exclude the \"specials\" season episode number, which is the hard part. Especially since the inner text of these elements will display the badge value before indicating the season it is referencing.</p>\n\n<p>I have gone through a few stages.\nFirst I was able to get the inner text of the parent tag which gives me a block of info stating everything in the table as follows (There seems to be 2 tags with the same class name which is why im getting double results. Any help with that would be appreciated too)</p>\n\n<p>Specials \nApril 2018 - April 2018 \n8 </p>\n\n<p>Season 1 \nFebruary 2017 - March 2017 \n11 </p>\n\n<p>Season 2 \nApril 2018 - June 2018 \n8 </p>\n\n<p>Season 3 \nJune 2019 - August 2019 </p>\n\n<p>All Seasons </p>\n\n<p>1 \nSpecials \nApril 2018 - April 2018 </p>\n\n<p>8 \nSeason 1 \nFebruary 2017 - March 2017 </p>\n\n<p>11 \nSeason 2 \nApril 2018 - June 2018 </p>\n\n<p>8 \nSeason 3 \nJune 2019 - August 2019 </p>\n\n<p>All Seasons </p>\n\n<p>Second I was able to isolate one block at a time by looping through all elements in the parent tag as follows</p>\n\n<p>1 \nSpecials \nApril 2018 - April 2018 </p>\n\n<p>Third I have gotten to the stage where I can loop through again and isolate just the number located in the badge (I say badge as that is how it is referenced in the html code)</p>\n\n<p>I also back tracked and worked with stage 2 and placed a regex function in to identify the word \"specials\" but was unable to figure out how to skip that and continue with in the running for loop. </p>\n\n<p>I believe I may need to be working with parent, children, sibling coding to achieve what I want.</p>\n\n<p>Thanks in advance</p>\n\n<pre><code>Sub()\n\nDim XML_05 As New MSXML2.XMLHTTP60\nDim HTML_05 As New MSHTML.HTMLDocument\n\nXML_05.Open \"GET\", \"https://www.thetvdb.com/series/legion\", False\nXML_05.send\nHTML_05.body.innerHTML = XML_05.responseText\n\nDim NETC_05 As MSHTML.IHTMLElementCollection\nDim NET_05 As MSHTML.IHTMLElement\nDim REO_05 As VBScript_RegExp_55.RegExp\nDim MO_05 As Object\nDim SeasonsList As MSHTML.IHTMLElementCollection\nDim SeasonsInfo As MSHTML.IHTMLElement\nDim SI_05 As MSHTML.IHTMLElement\nDim Badge As MSHTML.IHTMLElement\n\n\nSet SeasonsList = HTML_05.getElementsByClassName(\"hidden-sm hidden-md hidden-lg\")\n\nFor Each SeasonsInfo In SeasonsList\n    Debug.Print SeasonsList.Length\n        For Each SI_05 In SeasonsInfo.getElementsByTagName(\"li\")\n                    For Each Badge In SI_05.Children\n                    Debug.Print Badge.innerText\n                Next Badge\n        Next SI_05\nNext SeasonsInfo\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "excel", "vba", "xlwings"], "comments": [{"owner": {"reputation": 314, "user_id": 3521560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lhePH.jpg?s=128&g=1", "display_name": "Alexis S&#225;nchez Tello", "link": "https://stackoverflow.com/users/3521560/alexis-s%c3%a1nchez-tello"}, "edited": false, "score": 0, "creation_date": 1567759338, "post_id": 57786896, "comment_id": 102067616, "body": "It seems that there is not an invocation stack to manage this kind of recursion with Runpython, and environment variables are lost in the second xlwings.Book.caller() execution. I have just adopted a solution that does not use more than one xlwings.Book.caller() execution..."}, {"owner": {"reputation": 129, "user_id": 4495722, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16f9d2dc86ec7d4c42e5480347738fae?s=128&d=identicon&r=PG&f=1", "display_name": "skrhee", "link": "https://stackoverflow.com/users/4495722/skrhee"}, "edited": false, "score": 0, "creation_date": 1568999958, "post_id": 57786896, "comment_id": 102467593, "body": "I have this same issue, but with only one caller"}], "owner": {"reputation": 314, "user_id": 3521560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lhePH.jpg?s=128&g=1", "display_name": "Alexis S&#225;nchez Tello", "link": "https://stackoverflow.com/users/3521560/alexis-s%c3%a1nchez-tello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1567761244, "creation_date": 1567594393, "last_edit_date": 1567761244, "question_id": 57786896, "link": "https://stackoverflow.com/questions/57786896/blank-error-when-executing-a-macro-with-a-runpython-form-another-runpython", "title": "Blank error when executing a macro with a runpython form another runpython", "body": "<p>I have an Excel with a macro that calls a python process through runpython API from xlwings. The invocated python process opens another excel file that has got a macro  with a runpython and executes this macro.</p>\n\n<p>Excel 1 Macro:</p>\n\n<pre><code>Public Sub macro1()\n\n    Call RunPython(\"import myModule; myModule.inputProcess();\")\n\nEnd Sub\n</code></pre>\n\n<p>Python code 1:</p>\n\n<pre><code>wb = xw.Book.caller()\n# Performs some task with Excel 1 ...\n\n# Opens excel 2\nwb2 = xw.Book(os.path.dirname(os.path.realpath(__file__)) + '\\\\' + \\\n                         \"excel2.xlsm\")\n\nmacro_2 = wb2.macro(\"macro2\")\nmacro_2()\n</code></pre>\n\n<p>Excel 2 Macro:</p>\n\n<pre><code>Public Sub macro2()\n\n    Call RunPython(\"import myModule2; myModule2.inputProcess2();\")\n\nEnd Sub\n</code></pre>\n\n<p>When It starts to execute the second runpython I get the following blank error message window.</p>\n\n<p><a href=\"https://i.stack.imgur.com/cfUCx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cfUCx.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba", "listbox", "userform"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 11764579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849ff59ce84ef47cd12837233b6d4d31?s=128&d=identicon&r=PG&f=1", "display_name": "random_user_567", "link": "https://stackoverflow.com/users/11764579/random-user-567"}, "edited": false, "score": 0, "creation_date": 1567674307, "post_id": 57792417, "comment_id": 102035946, "body": "Thanks! This helps a lot! I get an error with the Workbooks.Open method (Compile Error: Method or data member not found). To compare, I have another .xlsm file where I don&#39;t get the error in Workbooks.Open. However, this file is from a post on some forum from 2008 and in a 97-2003 version of Excel. Do you have an idea of why I might get this error?"}, {"owner": {"reputation": 39, "user_id": 11764579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849ff59ce84ef47cd12837233b6d4d31?s=128&d=identicon&r=PG&f=1", "display_name": "random_user_567", "link": "https://stackoverflow.com/users/11764579/random-user-567"}, "edited": false, "score": 0, "creation_date": 1567675141, "post_id": 57792417, "comment_id": 102036374, "body": "I found the solution to my comment here: <a href=\"https://www.experts-exchange.com/questions/21542778/Do-you-know-how-I-can-resolve-the-Compile-Error-Method-Or-Data-Member-Not-Found.html\" rel=\"nofollow noreferrer\" title=\"Do you know how I can resolve the Compile Error Method Or Data Member Not Found.html\">experts-exchange.com/questions/21542778/&hellip;</a>"}, {"owner": {"reputation": 39, "user_id": 11764579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849ff59ce84ef47cd12837233b6d4d31?s=128&d=identicon&r=PG&f=1", "display_name": "random_user_567", "link": "https://stackoverflow.com/users/11764579/random-user-567"}, "edited": false, "score": 0, "creation_date": 1568106820, "post_id": 57792417, "comment_id": 102160202, "body": "Do you know if there&#39;s a way to name the workbooks items? Right now I have the folder structure links as the names of the list items, however I would like it to be only the name of the excel workbook. Any ideas?"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 39, "user_id": 11764579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849ff59ce84ef47cd12837233b6d4d31?s=128&d=identicon&r=PG&f=1", "display_name": "random_user_567", "link": "https://stackoverflow.com/users/11764579/random-user-567"}, "edited": false, "score": 0, "creation_date": 1568134963, "post_id": 57792417, "comment_id": 102175597, "body": "Suggest to do some research at SO as this would be to broad to answer - there are numerous solutions here how to search folders and subfolders using e.g. the <code>Dir</code> function. A more sophisticated approach using  ADODB might give you some additional ideas (e.g.  <a href=\"https://stackoverflow.com/questions/57775478/how-to-paste-csv-data-from-most-recent-folder\">how to checking for most recent file in folders</a>.   :-)"}, {"owner": {"reputation": 39, "user_id": 11764579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849ff59ce84ef47cd12837233b6d4d31?s=128&d=identicon&r=PG&f=1", "display_name": "random_user_567", "link": "https://stackoverflow.com/users/11764579/random-user-567"}, "edited": false, "score": 0, "creation_date": 1568963083, "post_id": 57792417, "comment_id": 102449334, "body": "I&#39;m certainly no expert, however I don&#39;t believe what i&#39;m trying to do is tremendously difficult. I have a list box with a set of X paths to my excel files, which I can open using your code above. They look something like this: C:\\Users\\UserName\\Data\\interest.xlsx, C:\\Users\\UserName\\Data\\Trades.xslx... Instead of having displayed the full file path in the listbox, I would rather have it say : Interest, Trades, and when you press it, you&#39;re opening the file by &quot;accessing&quot; the filepath"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 39, "user_id": 11764579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849ff59ce84ef47cd12837233b6d4d31?s=128&d=identicon&r=PG&f=1", "display_name": "random_user_567", "link": "https://stackoverflow.com/users/11764579/random-user-567"}, "edited": false, "score": 0, "creation_date": 1569002698, "post_id": 57792417, "comment_id": 102468632, "body": "If I understand you correctly - i.e. same folder, same extensions, short file Name - , it&#39;s simple, indeed: a) shorten the array list in the <i>Initialize</i> event to <code>myWBArray = Array(&quot;Interest&quot;, &quot;Trades&quot;, \u2026)</code>, b) put the file name together in the <i>doOpenSelectedWB</i> procedure, e.g. <code>myFileName = &quot;C:\\Users\\UserName\\Data\\&quot; &amp; .List(.ListIndex, 0) &amp; &quot;.xslx&quot;</code>. Of course you might add further column data to the listbox list (e.g. col 0: short name - as proposed in comment, col 1. full name, col 2: e.g. file description) :-)"}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1567616538, "last_edit_date": 1567616538, "creation_date": 1567614170, "answer_id": 57792417, "question_id": 57786860, "link": "https://stackoverflow.com/questions/57786860/listbox-add-in-with-an-overview-of-important-workbooks-and-ability-to-open-them/57792417#57792417", "title": "Listbox add-in with an overview of important workbooks and ability to open them", "body": "<p><strong>Open Workbooks via Userform Listbox</strong></p>\n\n<p>In a very basic form you can use the following code in your UserForm module; of course you can/should rename the used controls to more <em>speaking</em> names (e.g. \"OpenFileButton\" instead of CommandButton1). Added the \"Open file\" functionality also to the double click Event.</p>\n\n<pre><code>Option Explicit                  ' declaration head of userform code module\n\nPrivate Sub doOpenSelectedWB()\n' Purpose: add open file functionality (called by CommandButton1 and Listbox1's double click event)\n  With Me.ListBox1\n     ' [1] Escape proc if no valid item\n       If .ListIndex &lt; 0 Or .ListCount = 0 Then Exit Sub\n     ' [2] Get selected workbook name via list value (index 0 equals 1st column)\n       Dim myFileName As String\n       myFileName = .List(.ListIndex, 0)\n     ' [3] Open existing workbooks via Workbooks.Open method\n       If WBExists(myFileName) Then Workbooks.Open myFileName\n  End With\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n   doOpenSelectedWB\nEnd Sub\nPrivate Sub ListBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n   doOpenSelectedWB\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n' Purpose: prefill listbox with array values\n  Dim myWBArray()\n  myWBArray = Array(\"C:\\Users\\Admin\\documents\\test.xlsx\", \"C:\\Users\\Admin\\documents\\test2.xlsx\", \"C:\\Users\\Nowhere\\nonsens.xlsm\")\n  Me.ListBox1.List = myWBArray\nEnd Sub\n</code></pre>\n\n<p><strong>Helper function <code>WBExists()</code> and formatting of command button</strong></p>\n\n<pre><code>Private Function WBExists(Fullname$, Optional ByVal Infotext$ = \"File not found!\") As Boolean\n' Purpose: Check if workbook exists\n  If Dir(Fullname) = vbNullString Then\n      MsgBox \"File \" &amp; Fullname &amp; \" not found!\", vbExclamation, Infotext\n  Else\n      WBExists = True\n  End If\nEnd Function\n\nPrivate Sub UserForm_Layout()\n' Purpose: name command button\n  Me.CommandButton1.Caption = \"Open\"\nEnd Sub\n\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 11764579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849ff59ce84ef47cd12837233b6d4d31?s=128&d=identicon&r=PG&f=1", "display_name": "random_user_567", "link": "https://stackoverflow.com/users/11764579/random-user-567"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 57792417, "answer_count": 1, "score": 0, "last_activity_date": 1567616538, "creation_date": 1567594300, "last_edit_date": 1567608098, "question_id": 57786860, "link": "https://stackoverflow.com/questions/57786860/listbox-add-in-with-an-overview-of-important-workbooks-and-ability-to-open-them", "title": "Listbox add-in with an overview of important workbooks and ability to open them", "body": "<p>I want to create a macro that I can share with co-workers with a UserForm Listbox containing an easy overview of all the important workbooks we have. </p>\n\n<p>I'm just starting out with VBA Excel and have trouble figuring out how the program works. I've searched a lot on this issue but fail to find something that I can use. I suspect that the solution is quite straightforward. </p>\n\n<pre><code>Private Sub ListBox1_Click()\n\nEnd Sub\n</code></pre>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nListBox1.AddItem \"WB1\"\nListBox1.AddItem \"WB2\"\nListBox1.AddItem \"WB3\"\n\nEnd Sub\n</code></pre>\n\n<p>Essentially, I just want a Userform with a Listbox of workbooks that I define. The workbooks are in different folder structures so I would need to set the path for each individual workbook. </p>\n\n<p>The UserForm should have a command click box named \"Open\" that the user clicks on when having selected the workbook he or she wants to open.</p>\n"}, {"tags": ["excel", "vba", "ms-word", "formatting"], "answers": [{"comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1567603424, "post_id": 57787602, "comment_id": 102011978, "body": "There are, indeed, too many questions. That makes it &quot;too broad&quot; according to the site guidelines. When that happens, it&#39;s important that you <i>flag to close</i> the question, with an explanation as to why, if you feel it important to communicate to the OP why the question does not meet the site standards."}], "tags": [], "owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "is_accepted": false, "score": -1, "last_activity_date": 1567598525, "last_edit_date": 1567598525, "creation_date": 1567597134, "answer_id": 57787602, "question_id": 57786479, "link": "https://stackoverflow.com/questions/57786479/feasibility-of-using-macros-vba-for-my-formatting-needs-in-word-dates-currenc/57787602#57787602", "title": "Feasibility of using macros/VBA for my formatting needs in Word? (Dates, currencies, styles)", "body": "<p>Too many questions... Anyhow.\nRegarding the dates. It is not a simple macro as you want to change a lot of formats.\nCode to change from dd/mm/yyyy to dd mm yyyy:</p>\n\n<pre><code>Sub DateRepl()\n    Dim Test As Boolean\n\n    Selection.HomeKey Unit:=wdStory, Extend:=wdMove\n    Test = True\n    Do While Test\n        With Selection.Find\n            .ClearFormatting\n            .Replacement.ClearFormatting\n            .Text = \"([0-9]{1,2})[/]([0-9]{1,2})[/]([0-9]{4})\"\n            .Format = True\n            .Forward = True\n            .MatchWildcards = True\n        End With\n\n        Selection.Find.Execute Replace:=wdReplaceNone\n\n        If IsDate(Selection.Text) Then\n            Selection.Text = Format(Selection.Text, \"dd mm yyyy\")\n            Selection.Collapse wdCollapseEnd\n        Else\n            Test = False\n        End If\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Regarding the currency items, it will be very hard as you have many chances (million, billion...).</p>\n\n<p>Regarding the week substitution:</p>\n\n<pre><code>Dim Today, Workday\nToday = Now\nWorkday = Weekday(Today)\n\nWith Selection.Find \n .ClearFormatting \n .Text = \"last week\" \n .Replacement.ClearFormatting \n .Replacement.Text = \"the week ending \" &amp; DateAdd(\"d\", -Workday, Now)\n .Execute Replace:=wdReplaceAll, Forward:=True, _ \n Wrap:=wdFindContinue \nEnd With\n\nWith Selection.Find \n .ClearFormatting \n .Text = \"this week\" \n .Replacement.ClearFormatting \n .Replacement.Text = \"the week ending \" &amp; DateAdd(\"d\", 7-Workday, Now)\n .Execute Replace:=wdReplaceAll, Forward:=True, _ \n Wrap:=wdFindContinue \nEnd With\n\nWith Selection.Find \n .ClearFormatting \n .Text = \"next week\" \n .Replacement.ClearFormatting \n .Replacement.Text = \"the week ending \" &amp; DateAdd(\"d\", 14-Workday, Now)\n .Execute Replace:=wdReplaceAll, Forward:=True, _ \n Wrap:=wdFindContinue \nEnd With\n</code></pre>\n\n<p>Regarding the format, it is out of my knowledge.</p>\n\n<p>Hope it helps</p>\n"}], "owner": {"reputation": 1, "user_id": 12019176, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OoeOK.jpg?s=128&g=1", "display_name": "rchng", "link": "https://stackoverflow.com/users/12019176/rchng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1567606760, "creation_date": 1567592769, "last_edit_date": 1567606760, "question_id": 57786479, "link": "https://stackoverflow.com/questions/57786479/feasibility-of-using-macros-vba-for-my-formatting-needs-in-word-dates-currenc", "title": "Feasibility of using macros/VBA for my formatting needs in Word? (Dates, currencies, styles)", "body": "<p>I\u2019ve had some success finding existing code for some of my current needs but I was wondering whether/how I can use VBA to do the following in Microsoft Word as I currently spend a lot of time on formatting. I\u2019m not sure whether some of these are even possible under VBA, so I would really appreciate an indication of their feasibility before I spend even more time than I already have looking into this. Thank you so much!</p>\n\n<ol>\n<li><p>Change dates to my desired format.\ne.g  24/9/2019, 24 September 2019, 24 Sep 2019, Tuesday (24 Sep) \u2014\u2014> 24 Sep 19</p></li>\n<li><p>Change currencies.\ne.g. \u00a32 billion to GBP2bn, 179 billion euros to EUR179bn, US$70 million to USD70mn</p></li>\n<li><p>Change \u201clast week\u201d, \u201cthis week\u201d, \u201cnext week\u201d to \u201cthe week ending d mmm yy\u201d.\ne.g. last week \u2014\u2014> the week ending 1 Sep 19</p></li>\n</ol>\n\n<p>I understand that all of the edits above, if made using a macro, would be prone to a lot of error. My plan is to track changes before I use the macro so I can still accept or reject each change. I'm also unsure about how feasible changing the weeks are - can I use dates in real-time?</p>\n\n<ol start=\"4\">\n<li>Format my paragraphs to fit a style quickly\nLet\u2019s say my work takes the structure of:</li>\n</ol>\n\n<p><strong>Style 1</strong></p>\n\n<p><em>Style 2</em></p>\n\n<ul>\n<li><p>Body (Style 3)</p></li>\n<li><p>Body (Style 3)</p></li>\n<li><p>Body (Style 3)</p></li>\n</ul>\n\n<p><strong>Style 1</strong></p>\n\n<p><em>Style 2</em></p>\n\n<ul>\n<li><p>Body (Style 3)</p></li>\n<li><p>Body (Style 3)</p></li>\n<li><p>Body (Style 3)</p></li>\n</ul>\n\n<p>so on and so forth. \nThe paragraphs in Style 1s are all correctly formatted to begin with, but what I have to do now is format the Style 2s and Style 3s. Could a Macro somehow detect that my Style 2 paragraphs are always below a Style 1 paragraph, and format it for me? And likewise for how my Style 3 paragraphs are always below a Style 2/another Style 3 paragraph.</p>\n"}, {"tags": ["excel", "vba", "class"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 1, "creation_date": 1567591520, "post_id": 57786026, "comment_id": 102005676, "body": "See this. You may wanna change the dictionaries to collections, depending on your requirements. <a href=\"https://stackoverflow.com/questions/44965938/vba-creating-nested-class/44968814#44968814\" title=\"vba creating nested class\">stackoverflow.com/questions/44965938/vba-creating-nested-cla&zwnj;&#8203;ss/&hellip;</a>"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1567591692, "post_id": 57786026, "comment_id": 102005758, "body": "Thank you @KostasK. gonna read it, and about the second question? Is it a bad practice to fill the whole class upon <code>Class_Init</code>?"}, {"owner": {"reputation": 648, "user_id": 6626183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57210a6e0933a32691c61eba6f218df?s=128&d=identicon&r=PG&f=1", "display_name": "Hel O&#39;Ween", "link": "https://stackoverflow.com/users/6626183/hel-oween"}, "edited": false, "score": 1, "creation_date": 1567597912, "post_id": 57786026, "comment_id": 102008878, "body": "That depends. It&#39;s not inherently good or bad to do so in the <code>Initialize</code> event. However - I do prefer to determine the time of populating my object&#39;s properties with data myself, so I most of the time write my own (Public) <code>Init</code> method. Which then can be called either in the <code>Initialize</code> class event or independent from other parts of the application. Writing your own <code>Init</code> function also has the advantage of being able to return a result back to the caller, even it is just a boolean <code>True&#47;False</code>."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 648, "user_id": 6626183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57210a6e0933a32691c61eba6f218df?s=128&d=identicon&r=PG&f=1", "display_name": "Hel O&#39;Ween", "link": "https://stackoverflow.com/users/6626183/hel-oween"}, "edited": false, "score": 0, "creation_date": 1567605241, "post_id": 57786026, "comment_id": 102013064, "body": "I agree with @Hel O&#39;Ween. In general, avoid code that could throw errors in the object initializer. Let the object be created and call a public method to fill with data. You can even pass parameters to the method and handle exceptions. You should instantiate other objects in the initializer though."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1567605506, "post_id": 57786026, "comment_id": 102013227, "body": "@KostasK. I&#39;m trying to implement your answer to my needs but i&#39;m having troubles with this: <code>Public Property Get Department(ByVal StringKey As String) As Department</code> where is this <code>As Department</code> coming from? My structure is... Agents have ID, Location, Service.. Also Days, and Days have Deparments and Schedules for that agent. Is your example valid for my purpose?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1567606047, "post_id": 57786026, "comment_id": 102013527, "body": "Let me update my question with screens for the data so its clearer, also will update the code with what  I did following your answer."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1567606497, "post_id": 57786026, "comment_id": 102013778, "body": "@KostasK. Updated my question with the screenshots and the code I have so far with your answer."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1567611323, "post_id": 57786026, "comment_id": 102016577, "body": "<a href=\"https://www.youtube.com/watch?v=eAu9ePz1tgM\" rel=\"nofollow noreferrer\">YT video</a> discussing collection vs. dictionary,"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1567613657, "post_id": 57786026, "comment_id": 102017833, "body": "I recommend <a href=\"https://rubberduckvba.wordpress.com/2019/07/08/about-class-modules/\" rel=\"nofollow noreferrer\">About Class Modules</a> and related articles.. Also look at <a href=\"https://codereview.stackexchange.com/users/23788/mathieu-guindon\">Matthieu</a>&#39;s posts on Codereview on vba ."}, {"owner": {"reputation": 648, "user_id": 6626183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57210a6e0933a32691c61eba6f218df?s=128&d=identicon&r=PG&f=1", "display_name": "Hel O&#39;Ween", "link": "https://stackoverflow.com/users/6626183/hel-oween"}, "edited": false, "score": 0, "creation_date": 1567672686, "post_id": 57786026, "comment_id": 102035064, "body": "BTW, @Damian, if you can snatch a used copy of <a href=\"https://rads.stackoverflow.com/amzn/click/com/1562765779\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">Debora Kurata&#39;s Doing Objects...</a> book, it might be worth the expense. It helped me a lot back in the day. It&#39;s a VB6 book, but as VBA/VB6 is basically identical, the concepts in there apply to VBA and most of the code shown also works &quot;as is&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1567612172, "post_id": 57791875, "comment_id": 102017058, "body": "Thank you a lot! I&#39;m gonna try to implement this.. And regarding the dictionary don&#39;t worry, I&#39;m used to them and understand how they work!"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1567612710, "post_id": 57791875, "comment_id": 102017330, "body": "Now I&#39;ve read the code... This is part of my need but I want to be able to do this: <code>obj.Schedule(#1&#47;9&#47;2019#).Schedule = &quot;Schedule1&quot;</code> as well as <code>obj.Schedule(#1&#47;9&#47;2019#).Department= &quot;Department1&quot;</code> Is it possible to do so?"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1567612849, "post_id": 57791875, "comment_id": 102017406, "body": "Yep, you just need another object. I&#39;ll update the answer."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1567613675, "post_id": 57791875, "comment_id": 102017843, "body": "See updated answer. Instead of a string, you just need to return a Schedule object. Note, no setter property here. You will do the same with Department."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1567614914, "post_id": 57791875, "comment_id": 102018376, "body": "Genius!!!!!! Appreciate this a lot! Now I can go forward learning with class modules!"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1567620209, "post_id": 57791875, "comment_id": 102020495, "body": "Good, glad to assist. :)"}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1567672831, "last_edit_date": 1567672831, "creation_date": 1567611935, "answer_id": 57791875, "question_id": 57786026, "link": "https://stackoverflow.com/questions/57786026/creating-class-properties-with-sub-levels/57791875#57791875", "title": "Creating Class properties with sub levels", "body": "<p>You don\u2019t seem to have any issues with regular properties so let\u2019s focus on the complex ones; Schedule and Department. Both are the same, so same rules apply to both.</p>\n\n<p>The property is basically list, the date is the index and the item is an object. I personally prefer to work with dictionaries as I can look if a key exist etc. </p>\n\n<p>So, your Agent class could look something like this:</p>\n\n<hr>\n\n<pre><code>Option Explicit\nPrivate m_schedules As Object\n\nPublic Property Get Schedule(ByVal Key As Date) As Schedules\n    With m_schedules\n        If Not .Exists(Key) Then .Add Key, New Schedules\n    End With\n    Set Schedule = m_schedules(Key)\nEnd Property\n\n'For testing purposes - can be ommited.\nPublic Property Get Keys() As Variant\n    Keys = m_schedules.Keys\nEnd Property\n\n'For testing purposes - can be ommited.\nPublic Property Get Count() As Long\n    Count = m_schedules.Count\nEnd Property\n\nPrivate Sub Class_Initialize()\n    Set m_schedules = CreateObject(\"Scripting.Dictionary\")\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    Set m_schedules = Nothing\nEnd Sub\n</code></pre>\n\n<p>The Schedules class:</p>\n\n<hr>\n\n<pre><code>Option Explicit\nPrivate m_schedule As String\n\nPublic Property Get Schedule() As String\n    Schedule = m_schedule\nEnd Property\nPublic Property Let Schedule(ByVal param As String)\n    m_schedule = param\nEnd Property\n</code></pre>\n\n<p>Now, let's test it:</p>\n\n<hr>\n\n<pre><code>Sub Test()\n\n    Dim obj As Agent\n    Set obj = New Agent\n\n    obj.Schedule(#1/9/2019#).Schedule = \"Schedule 1\"\n    obj.Schedule(#2/9/2019#).Schedule = \"Schedule 2\"\n    obj.Schedule(#3/9/2019#).Schedule = \"Schedule 3\"\n\n    PrintToDebug obj\n\n    'Lets make a change\n    obj.Schedule(#2/9/2019#).Schedule = \"Schedule 2222\"\n\n    PrintToDebug obj\n\nEnd Sub\n\n\nPrivate Sub PrintToDebug(ByVal obj As Agent)\n\n    Debug.Print \"\"\n\n    Dim m As Variant\n    With obj\n        For Each m In .Keys\n            Debug.Print \"Key: \" &amp; m &amp; String(3, \" \") &amp; \"Value: \" &amp; .Schedule(m).Schedule\n        Next m\n    End With\n\n    Debug.Print \"Total Items: \" &amp; obj.Count\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>'Key: 09/01/2019   Value: Schedule 1\n'Key: 09/02/2019   Value: Schedule 2\n'Key: 09/03/2019   Value: Schedule 3\n'Total Items: 3\n\n'Key: 09/01/2019   Value: Schedule 1\n'Key: 09/02/2019   Value: Schedule 2222\n'Key: 09/03/2019   Value: Schedule 3\n'Total Items: 3\n</code></pre>\n\n<p>Additional information regarding the <code>Dictionary</code> object can be found here: <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/dictionary-object\" rel=\"nofollow noreferrer\">Dictionary object</a></p>\n\n<p>Also keep this in mind. It's quite important:</p>\n\n<blockquote>\n  <p>If key is not found when changing an item, a new key is created with\n  the specified newitem. If key is not found when attempting to return\n  an existing item, a new key is created and its corresponding item is\n  left empty.</p>\n</blockquote>\n\n<p>If the dictionary item is not a simple string, let me know to update the answer. Sorry, I couldnt read the data in the screenshots. :) </p>\n"}], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 57791875, "answer_count": 1, "score": 2, "last_activity_date": 1567672831, "creation_date": 1567591199, "last_edit_date": 1567606466, "question_id": 57786026, "link": "https://stackoverflow.com/questions/57786026/creating-class-properties-with-sub-levels", "title": "Creating Class properties with sub levels", "body": "<p>I've been reading this <a href=\"https://excelmacromastery.com/vba-class-modules/#A_Quick_Guide_to_the_VBA_Class_Module\" rel=\"nofollow noreferrer\">topic</a> on how to use class modules.</p>\n\n<p>My goal is to improve my code performance and readability so I think I'm in the right path.</p>\n\n<p>But I have some questions about the limitations.</p>\n\n<p>In my head i want to do this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8M8FA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8M8FA.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is it possible to achieve such a structure? </p>\n\n<p>The topic I've read has very few examples and this is not handled. I'm assuming this would be possible with collections of collections, but I not sure how to look for this.</p>\n\n<p>My data comes from 2 tables, one has all the items but the department and the other one has the ID's alongisde the departments. Both tables have the dates of the current month as headers and their Schedule/Department depending on the table.</p>\n\n<p>I'd know how to achieve this for one day, but not for a whole month.</p>\n\n<p>This is how I wrote the basics for my class:</p>\n\n<pre><code>Option Explicit\nPrivate DirNeg As String\nPrivate Agrup As String\nPrivate DNI As String\nPrivate Centro As String\nPrivate Servicio As String\nPrivate Nombre As String\nProperty Get Business() As String\n    Business = DirNeg\nEnd Property\nProperty Let Business(ByVal sBusiness As String)\n    DirNeg = sBusiness\nEnd Property\nProperty Get Group() As String\n    Group = Agrup\nEnd Property\nProperty Let Group(ByVal sGroup As String)\n    Agrup = sGroup\nEnd Property\nProperty Get ID() As String\n    ID = DNI\nEnd Property\nProperty Let ID(ByVal sID As String)\n    DNI = sID\nEnd Property\nProperty Get Location() As String\n    Location = Centro\nEnd Property\nProperty Let Location(ByVal sLocation As String)\n    Centro = sLocation\nEnd Property\nProperty Get Service() As String\n    Service = Servicio\nEnd Property\nProperty Let Service(ByVal sService As String)\n    Servicio = sService\nEnd Property\nProperty Get Name() As String\n    Name = Nombre\nEnd Property\nProperty Let Name(ByVal sName As String)\n    Nombre = sName\nEnd Property\n</code></pre>\n\n<p>On the other hand, is it correct to fill the whole class on the <code>Class_Initialize</code>event? My data will always be the same so I don't need to loop in a normal module to fill the class, it could be done everytime the class is created.</p>\n\n<p>EDIT/UPDATE:</p>\n\n<p>This is how my data looks like:</p>\n\n<p>Schedules alongside Agent's info</p>\n\n<p><a href=\"https://i.stack.imgur.com/70jk6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/70jk6.png\" alt=\"enter image description here\"></a></p>\n\n<p>Departments alongside Agent's ID</p>\n\n<p><a href=\"https://i.stack.imgur.com/J1S7x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J1S7x.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>clAgent Class Module:</strong></p>\n\n<pre><code>Option Explicit\nPrivate DirNeg As String\nPrivate Agrup As String\nPrivate DNI As String\nPrivate Centro As String\nPrivate Servicio As String\nPrivate Nombre As String\nPrivate Fechas As Object\nProperty Get Business() As String\n    Business = DirNeg\nEnd Property\nProperty Let Business(ByVal sBusiness As String)\n    DirNeg = sBusiness\nEnd Property\nProperty Get Group() As String\n    Group = Agrup\nEnd Property\nProperty Let Group(ByVal sGroup As String)\n    Agrup = sGroup\nEnd Property\nProperty Get ID() As String\n    ID = DNI\nEnd Property\nProperty Let ID(ByVal sID As String)\n    DNI = sID\nEnd Property\nProperty Get Location() As String\n    Location = Centro\nEnd Property\nProperty Let Location(ByVal sLocation As String)\n    Centro = sLocation\nEnd Property\nProperty Get Service() As String\n    Service = Servicio\nEnd Property\nProperty Let Service(ByVal sService As String)\n    Servicio = sService\nEnd Property\nProperty Get Name() As String\n    Name = Nombre\nEnd Property\nProperty Let Name(ByVal sName As String)\n    Nombre = sName\nEnd Property\nProperty Get clFechas(ByVal StringKey As String) As clFechas\n    With Fechas\n        If Not .Exists(StringKey) Then\n            Dim objFechas As New clFechas\n            .Add StringKey, objFechas\n        End If\n    End With\n\nEnd Property\nPrivate Sub Class_Initialize()\n\n    Set Fechas = CreateObject(\"Scripting.Dictionary\")\n\nEnd Sub\n</code></pre>\n\n<p><strong>clFechas Class Module:</strong></p>\n\n<pre><code>Option Explicit\nPrivate Modos As Object\nPrivate Horarios As Object\n'Aqi\u00e7o creamos la propiedad Modo para la clase Fecha\nPublic Property Get Modo(ByVal StringKey As String) As String\n    Modo = Modos(StringKey)\nEnd Property\nPublic Property Let Modo(ByVal StringKey As String, ByVal StringValue As String)\n    Modos(StringKey) = StringValue\nEnd Property\nPublic Property Get Keys() As Variant\n    Keys = Modos.Keys\nEnd Property\n'Aqu\u00ed creamos la propiedad Horario para la clase Fecha\nPublic Property Get Horario(ByVal StringKey As String) As String\n    Modo = Horarios(StringKey)\nEnd Property\nPublic Property Let Horario(ByVal StringKey As String, ByVal StringValue As String)\n    Horarios(StringKey) = StringValue\nEnd Property\nPublic Property Get Keys() As Variant\n    Keys = Horarios.Keys\nEnd Property\n'Iniciamos la clase\nPrivate Sub Class_Initialize()\n    Set Modos = CreateObject(\"Scripting.Dictionary\")\n    Set Horarios = CreateObject(\"Scripting.Dictionary\")\nEnd Sub\nPrivate Sub Class_Terminate()\n    Set Modos = Nothing\n    Set Horarios = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1567591349, "post_id": 57785992, "comment_id": 102005591, "body": "Change <code>lastrow = .Cells(Rows.Count, 1).End(xlUp).Row</code> to <code>lastrow = .Cells(.Rows.Count, 1).End(xlUp).Row</code> .. .you are missing a <code>.</code> should be <code>.Rows</code>"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1567591919, "post_id": 57785992, "comment_id": 102005875, "body": "Looking at how You set xlSheet You don&#39;t need that &#39;With xlApp&#39; and &#39;With xlBook&#39; because it is already included in xlSheet. Also here: &#39;.Close SaveChanges:=True&#39; You can&#39;t close xlSheet, but You can: xlBook.Close SaveChanges:=True"}, {"owner": {"reputation": 203, "user_id": 9983642, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-exJgyj9yleI/AAAAAAAAAAI/AAAAAAAAACI/8LrWEPZdJBw/photo.jpg?sz=128", "display_name": "J T", "link": "https://stackoverflow.com/users/9983642/j-t"}, "edited": false, "score": 0, "creation_date": 1567594384, "post_id": 57785992, "comment_id": 102007062, "body": "Thanks  Mikku and Teamothy for coming back, unfortunately none of these solutions work. Anymore ideas?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12019325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b857e8dfda59b073c11b4b04dd5035d7?s=128&d=identicon&r=PG&f=1", "display_name": "Adarnok", "link": "https://stackoverflow.com/users/12019325/adarnok"}, "is_accepted": false, "score": 0, "last_activity_date": 1567632229, "last_edit_date": 1567632229, "creation_date": 1567597465, "answer_id": 57787696, "question_id": 57785992, "link": "https://stackoverflow.com/questions/57785992/finding-last-row-throws-an-object-required-error/57787696#57787696", "title": "Finding last row throws an object required error", "body": "<p>Try replacing this line, <code>lastrow = .Cells(Rows.Count, 1).End(xlUp).Row</code>, with:</p>\n\n<p><code>lastrow = .Cells(1048576, 1).End(xlUp).Row</code></p>\n\n<p>or</p>\n\n<p><code>lastrow = .Cells(Rows.Count +1, 1).End(xlUp).Row</code></p>\n"}, {"tags": [], "owner": {"reputation": 203, "user_id": 9983642, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-exJgyj9yleI/AAAAAAAAAAI/AAAAAAAAACI/8LrWEPZdJBw/photo.jpg?sz=128", "display_name": "J T", "link": "https://stackoverflow.com/users/9983642/j-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1567655290, "creation_date": 1567655290, "answer_id": 57798163, "question_id": 57785992, "link": "https://stackoverflow.com/questions/57785992/finding-last-row-throws-an-object-required-error/57798163#57798163", "title": "Finding last row throws an object required error", "body": "<p>Jeeez this is crazy. I have found the problem finally and got a working code for anyone wanting similar usage. 1st off, I need to add the Microsoft excel add in. So in Outlook VBA, Tools -> references -> check Microsoft Excel 16.0 Object Library. This is to get rid of the 424 object required error, as I was trying to a call a excel built in method I guess. this is the line: </p>\n\n<pre><code>lastrow = .Cells(Rows.Count, 1).End(xlUp).Row\n</code></pre>\n\n<p>Pls note that I am calling this macro from Outlook. </p>\n\n<p>After this I faced a couple of other issues. \n1. errors such as 424 run time, remote server machine does not exist or is not available.\nfirst time running, it throws this error, 2nd time I click, the problem goes away. This is an issue with non specific use of the app, book and worksheet and so leaves VBA to assign on its own. Lesson learnt, be explicit about every thing.  </p>\n\n<ol start=\"2\">\n<li>leaves a copy of excel process even after program ends. This can be seen in task manager. This causes issues because then my excel file is linked to this process and not able to open without either read only or notify. Its locked with the process. So I cannot run again next time. </li>\n</ol>\n\n<p>Anyway. Here is the final code. And I have also changed it to .Range instead of .Cells. I believe it does not matter if I used either but the key culprit is : xlSheet.Rows.Count. Instead of just Rows.Count, explicitly use xlSheet.Rows.Count. </p>\n\n<pre><code>Option Explicit\n\nSub copyArts2File()\nMsgBox \"ok\"\nDim OutApp As Object, OutMail As Object, olInsp As Object, wdDoc As Object\nDim xlApp As Excel.Application, xlBook As Excel.Workbook, xlSheet As Object\nDim strText As String\nDim strTextArr As Variant\nDim fName As String\nDim fileDoesExist As Boolean\nDim i As Integer\nDim lastrow As Long\n\nOn Error Resume Next\n'Get Outlook if it's running\nSet OutApp = GetObject(, \"Outlook.Application\")\n\n'Outlook wasn't running, so cancel\nIf Err &lt;&gt; 0 Then\n    MsgBox \"Outlook is not running so nothing can be selected!\"\n    GoTo lbl_Exit\nEnd If\nOn Error GoTo 0\n\nSet OutMail = OutApp.ActiveExplorer.Selection.Item(1)\nWith OutMail\n    Set olInsp = .GetInspector\n    Set wdDoc = olInsp.WordEditor\n    strText = wdDoc.Application.Selection.Range.Text\nEnd With\n'MsgBox strText\n'Close out all shit\nSet OutMail = Nothing\nSet OutApp = Nothing\nSet olInsp = Nothing\nSet wdDoc = Nothing\n\nlbl_Exit:\nSet OutMail = Nothing\nSet OutApp = Nothing\nSet olInsp = Nothing\nSet wdDoc = Nothing\n\nOn Error Resume Next 'Create or use a Excel Application\nSet xlApp = GetObject(, \"Excel.Application\")\nIf Err.Number &gt; 0 Then Set xlApp = CreateObject(\"Excel.Application\")\nOn Error GoTo 0\n\nxlApp.Visible = False\nxlApp.DisplayAlerts = False\n\nfName = \"Artwork List.xlsx\"\nfileDoesExist = Dir(\"C:\\Users\\quaer\\Desktop\\DL Arts\\\" &amp; fName) &gt; \"\"\n\n' Check for existing file\nIf fileDoesExist Then\n    ' Open Excel file if present\n    Set xlBook = xlApp.Workbooks.Open(\"C:\\Users\\quaer\\Desktop\\DL Arts\\\" &amp; fName)\nElse\n    ' Add Excel file if not present\n    Set xlBook = xlApp.Workbooks.Add\n    xlBook.SaveAs fileName:=\"C:\\Users\\quaer\\Desktop\\DL Arts\\\" &amp; fName\nEnd If\nSet xlSheet = xlBook.Worksheets(1)\n\n\n' Do stuff with Excel workbook\nstrTextArr = Split(strText, \"Adding file\")\nlastrow = xlSheet.Range(\"A\" &amp; xlSheet.Rows.Count).End(xlUp).Row\nIf lastrow = 1 Then\n\n    For i = 1 To UBound(strTextArr)\n        xlSheet.Range(\"A\" &amp; i).Value = strTextArr(i)\n    Next i\n\nElse\n    For i = 1 To UBound(strTextArr)\n        xlSheet.Range(\"A\" &amp; (i + lastrow)).Value = strTextArr(i)\n    Next i\n\nEnd If\n\n\nxlBook.SaveAs fileName:=\"C:\\Users\\quaer\\Desktop\\DL Arts\\\" &amp; fName, AccessMode:=xlExclusive, ConflictResolution:=Excel.XlSaveConflictResolution.xlLocalSessionChanges\nxlBook.Close (True)\n\nSet xlBook = Nothing\nSet xlSheet = Nothing\nxlApp.Visible = True\nxlApp.Quit\n\nSet xlApp = Nothing\n\nMsgBox \"Done!\"\nExit Sub\nEnd Sub\n</code></pre>\n\n<p>Thanks for the help and suggestions nonetheless.  </p>\n"}], "owner": {"reputation": 203, "user_id": 9983642, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-exJgyj9yleI/AAAAAAAAAAI/AAAAAAAAACI/8LrWEPZdJBw/photo.jpg?sz=128", "display_name": "J T", "link": "https://stackoverflow.com/users/9983642/j-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 462, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574735908, "creation_date": 1567591114, "last_edit_date": 1574735908, "question_id": 57785992, "link": "https://stackoverflow.com/questions/57785992/finding-last-row-throws-an-object-required-error", "title": "Finding last row throws an object required error", "body": "<p>What I am trying to do.   </p>\n\n<ol>\n<li>I highlight some text in an email then run my macro.  </li>\n<li>It 'copies' the highlighted text and stores it in variable strText.  </li>\n<li>Then it creates a file called Artwork List.xlsx if it does not exist and if it exists it opens it. </li>\n<li>After that it copies the text into the file in column A row 1 if the lastrow is 1, and if not, it appends to lastrow + 1</li>\n</ol>\n\n<p>My code throws</p>\n\n<blockquote>\n  <p>'Run-time error 424, Object required'</p>\n</blockquote>\n\n<p>To narrow down, the error should be coming from:</p>\n\n<pre><code>lastrow = .Cells(Rows.Count, 1).End(xlUp).Row\n</code></pre>\n\n<p>or anything related to this line. </p>\n\n<pre><code>Sub copyArts2File()\nMsgBox \"ok\"\nDim OutApp As Object\nDim OutMail As Object\nDim olInsp As Object\nDim wdDoc As Object\nDim strText As String\n\nDim xlApp As Object\nDim xlBook As Object\nDim xlSheet As Object\n\nDim strTextArr As Variant\n\nOn Error Resume Next\n'Get Outlook if it's running\nSet OutApp = GetObject(, \"Outlook.Application\")\n\n'Outlook wasn't running, so cancel\nIf Err &lt;&gt; 0 Then\n    MsgBox \"Outlook is not running so nothing can be selected!\"\n    GoTo lbl_Exit\nEnd If\nOn Error GoTo 0\n\nSet OutMail = OutApp.ActiveExplorer.Selection.Item(1)\nWith OutMail\n    Set olInsp = .GetInspector\n    Set wdDoc = olInsp.WordEditor\n    strText = wdDoc.Application.Selection.Range.Text\nEnd With\n'MsgBox strText\n\nlbl_Exit:\nSet OutMail = Nothing\nSet OutApp = Nothing\nSet olInsp = Nothing\nSet wdDoc = Nothing\n\nSet xlApp = CreateObject(\"Excel.Application\")\nxlApp.Visible = False\n\nFileName = \"Artwork List.xlsx\"\nfileDoesExist = Dir(\"C:\\Users\\quaer\\Desktop\\DL Arts\\\" &amp; FileName) &gt; \"\"\n\n' Check for existing file\nIf fileDoesExist Then\n    ' Open Excel file\n    Set xlBook = xlApp.Workbooks.Open(\"C:\\Users\\quaer\\Desktop\\DL Arts\\\" &amp; FileName)\n    Set xlSheet = xlBook.Sheets(1)\nElse\n    ' Add Excel file\n    Set xlBook = xlApp.Workbooks.Add\n    With xlBook\n        .SaveAs FileName:=\"C:\\Users\\quaer\\Desktop\\DL Arts\\\" &amp; FileName\n    End With\n    Set xlSheet = xlBook.Sheets(1)\nEnd If\n\n' Do stuff with Excel workbook\nDim i As Integer\nDim lastrow As Long\nWith xlApp\n    With xlBook\n        With xlSheet\n        strTextArr = Split(strText, \"Adding file\")\n        lastrow = .Cells(Rows.Count, 1).End(xlUp).Row\n        MsgBox lastrow\n        If lastrow = 1 Then\n\n            For i = 1 To UBound(strTextArr)\n                .Range(\"A\" &amp; i).Value = strTextArr(i)\n            Next i\n\n        Else\n            For i = 1 To UBound(strTextArr)\n                .Range(\"A\" &amp; (i + lastrow)).Value = strTextArr(i)\n            Next i\n\n        End If\n        .Close SaveChanges:=True\n        End With\n    End With\nEnd With\nxlApp.Visible = True\nExit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 11995192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59c675d745545856b0b8be8f958702b?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/11995192/nick"}, "edited": false, "score": 0, "creation_date": 1567594577, "post_id": 57786118, "comment_id": 102007183, "body": "no it doesn&#39;t. If I were to rightclick on the shape with the macros(in the new workbook) and then press &quot;assign macro&quot; I can see that the currently assigned macro is &quot;&#39;name of old workbook.xlsm&#39;sheet4.macroname&quot; and not the new one. It might have something to do with how im copying the sheet to a new workbook(see code above)"}, {"owner": {"reputation": 49, "user_id": 11995192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59c675d745545856b0b8be8f958702b?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/11995192/nick"}, "edited": false, "score": 0, "creation_date": 1567601394, "post_id": 57786118, "comment_id": 102010785, "body": "what you are showing with your screenpicks has nothing to do with &quot;pointing&quot;. Yes the macro will be copied into &quot;the same place&quot; in the new workbook as it was before. But the shape with the assigned macro will not &quot;point&quot; to the macro in its own sheet but rather at the macro in the &quot;same&quot; sheet in the old workbook."}, {"owner": {"reputation": 49, "user_id": 11995192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59c675d745545856b0b8be8f958702b?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/11995192/nick"}, "edited": false, "score": 0, "creation_date": 1567601947, "post_id": 57786118, "comment_id": 102011090, "body": "read the answer by Dorian and you might understand what I mean!"}, {"owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "reply_to_user": {"reputation": 49, "user_id": 11995192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59c675d745545856b0b8be8f958702b?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/11995192/nick"}, "edited": false, "score": 0, "creation_date": 1567603038, "post_id": 57786118, "comment_id": 102011749, "body": "Nevermind. As long as it is solved."}, {"owner": {"reputation": 49, "user_id": 11995192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59c675d745545856b0b8be8f958702b?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/11995192/nick"}, "edited": false, "score": 0, "creation_date": 1567695702, "post_id": 57786118, "comment_id": 102048125, "body": "nevertheless, Thank you for at least trying to help me :)"}], "tags": [], "owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "is_accepted": false, "score": 0, "last_activity_date": 1567598602, "last_edit_date": 1567598602, "creation_date": 1567591520, "answer_id": 57786118, "question_id": 57785325, "link": "https://stackoverflow.com/questions/57785325/how-do-i-make-sure-my-shapes-points-to-the-correct-macro/57786118#57786118", "title": "How do I make sure my shapes &quot;points&quot; to the correct macro?", "body": "<p><a href=\"https://i.stack.imgur.com/cXGFl.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cXGFl.jpg\" alt=\"enter image description here\"></a>If your macro is created at the sheet, copying the sheet to new workbook will point to new workbook macro. </p>\n"}], "owner": {"reputation": 49, "user_id": 11995192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59c675d745545856b0b8be8f958702b?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/11995192/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "closed_date": 1569502821, "answer_count": 1, "score": 0, "last_activity_date": 1567598602, "creation_date": 1567588884, "question_id": 57785325, "link": "https://stackoverflow.com/questions/57785325/how-do-i-make-sure-my-shapes-points-to-the-correct-macro", "closed_reason": "Duplicate", "title": "How do I make sure my shapes &quot;points&quot; to the correct macro?", "body": "<p>I need to copy one sheet to a completely new workbook. I use this code below for this. My problem is, that this sheet contains a couple of shapes with assigned macros. In the new workbook these asigned macros \"points\" to the macros of the old workbook. I would need the new workbook to include it's own macros and point to themselves. I can solve the problem by just pressing assign macro on the shapes and choosing the correct ones. (The macro copies to the new workbook, but the shapes still \"points\" to the old workbook's macros)</p>\n\n<pre><code>sheettocopy = Range(\"EU10\").Value\nWorksheets(sheettocopy).Copy\n</code></pre>\n"}, {"tags": ["vba", "http", "pdf", "msxml"], "comments": [{"owner": {"reputation": 1, "user_id": 12018739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2d337c17b3862d55a1a0aaaa1cb06d?s=128&d=identicon&r=PG&f=1", "display_name": "PDM", "link": "https://stackoverflow.com/users/12018739/pdm"}, "edited": false, "score": 0, "creation_date": 1567589628, "post_id": 57785321, "comment_id": 102004562, "body": "Although I am still curious on the outcome, in the mean time I found the Function URLDownloadToFile Lib &quot;urlmon&quot; which does the trick..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1567590046, "post_id": 57785321, "comment_id": 102004788, "body": "Can we have the url?"}, {"owner": {"reputation": 1, "user_id": 12018739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2d337c17b3862d55a1a0aaaa1cb06d?s=128&d=identicon&r=PG&f=1", "display_name": "PDM", "link": "https://stackoverflow.com/users/12018739/pdm"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1567592252, "post_id": 57785321, "comment_id": 102006027, "body": "A bit difficult since it is an outside partner that provides us with the URL, will try to do my test with an arbitrary other public downloadable PDF and see if result is the same."}, {"owner": {"reputation": 35134, "user_id": 50543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RCFWL.jpg?s=128&g=1", "display_name": "Julian Reschke", "link": "https://stackoverflow.com/users/50543/julian-reschke"}, "edited": false, "score": 0, "creation_date": 1567592848, "post_id": 57785321, "comment_id": 102006345, "body": "(a) Setting content-type in a GET request doesn&#39;t make any sense, unless you&#39;re sending a request body.  (b) Check for a Content-Encoding response header field."}, {"owner": {"reputation": 648, "user_id": 6626183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57210a6e0933a32691c61eba6f218df?s=128&d=identicon&r=PG&f=1", "display_name": "Hel O&#39;Ween", "link": "https://stackoverflow.com/users/6626183/hel-oween"}, "edited": false, "score": 0, "creation_date": 1567595331, "post_id": 57785321, "comment_id": 102007570, "body": "As Julian pointed out, Content-Type doesn&#39;t make much sense here. However, you might want to look at setting the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept\" rel=\"nofollow noreferrer\">Accept header</a> for your request."}], "owner": {"reputation": 1, "user_id": 12018739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2d337c17b3862d55a1a0aaaa1cb06d?s=128&d=identicon&r=PG&f=1", "display_name": "PDM", "link": "https://stackoverflow.com/users/12018739/pdm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567588876, "creation_date": 1567588876, "question_id": 57785321, "link": "https://stackoverflow.com/questions/57785321/interpreting-content-of-the-http-responsebody-confronted-with-som-unexpected-pr", "title": "Interpreting content of the HTTP responsebody. Confronted with som unexpected prefix data", "body": "<p>I am trying to download a PDF file (URL is provided to me) from within VBA code. I am creating an WinHTTPReq object (MSXML6.XMLHTTP60). I set the content-type to application/pdf</p>\n\n<p>Everything works however for some reason the file that I write (I am writing the responsebody result to a file) contains a 12 byte kind of header ( the middle 4 are the real file length of the PDF)</p>\n\n<p>These bytes are not present if I click on the URL and download the PDF from a browser.</p>\n\n<p>I tried playing around with content-type a bit without avail.\nI googled to understand this 12 byte prefix better without result.</p>\n\n<pre><code>Private Function DownloadFileFromURL(sURL As String, sOutputFileSpec) As Boolean\n  Dim WinHttpReq As New MSXML2.XMLHTTP60\n  Dim iFileHandle As Integer\n  Dim s As String\n\n  WinHttpReq.Open \"GET\", sURL, False\n  WinHttpReq.setRequestHeader \"Content-Type\", \"application/pdf\"\n  WinHttpReq.send\n\n  If WinHttpReq.Status = 200 Then\n    iFileHandle = FreeFile()\n    Open sOutputFileSpec For Binary Access Write As iFileHandle\n    Put #iFileHandle, 1, WinHttpReq.responseBody\n\n    Close iFileHandle\n    DownloadFileFromURL = True\n  Else\n    DownloadFileFromURL = False\n  End If\nEnd Function\n</code></pre>\n\n<pre><code> od -x Test.pdf \n0000000      2011    0001    f39a    0016    0000    0000    5025    4644\n0000020      312d    342e    250d    e3e2    d3cf    0a0d    3437    3020\n0000040      6f20    6a62    3c0a    2f3c    694c    656e    7261    7a69\n</code></pre>\n\n<p>I don't know the reason for the 2011 0001 f39a 0016 0000 0000... (btw 0x0016f39a is the length of the PDF file (without the 12 bytes). After this the file really starts 5025 4644 (= %PDF)</p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 323, "user_id": 4054839, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001233515870/picture?type=large", "display_name": "Fredrik Stigsson", "link": "https://stackoverflow.com/users/4054839/fredrik-stigsson"}, "edited": false, "score": 0, "creation_date": 1567586662, "post_id": 57784621, "comment_id": 102002886, "body": "It seems that <a href=\"https://www.oslobors.no\" rel=\"nofollow noreferrer\">oslobors.no</a> uses JavaScript to load the data, the data does not exist when you request it."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 323, "user_id": 4054839, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001233515870/picture?type=large", "display_name": "Fredrik Stigsson", "link": "https://stackoverflow.com/users/4054839/fredrik-stigsson"}, "edited": false, "score": 0, "creation_date": 1567587232, "post_id": 57784621, "comment_id": 102003200, "body": "@FredrikStigsson sure it&#39;s not Ajax? JavaScript would mean the values are on the users computer. I have not looked at the source since I&#39;m typing on my phone"}, {"owner": {"reputation": 23, "user_id": 12018602, "user_type": "registered", "profile_image": "https://graph.facebook.com/10162268875425374/picture?type=large", "display_name": "Haakon Silberg", "link": "https://stackoverflow.com/users/12018602/haakon-silberg"}, "edited": false, "score": 0, "creation_date": 1567587366, "post_id": 57784621, "comment_id": 102003274, "body": "Thanks for the reply, Fredrik. I thought that might be a problem for the code, and I&#39;m guessing I might find some hlp in the following thread: <a href=\"https://stackoverflow.com/questions/43904054/scraping-javascript-tables-with-vba\" title=\"scraping javascript tables with vba\">stackoverflow.com/questions/43904054/&hellip;</a>"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1567587547, "post_id": 57784621, "comment_id": 102003387, "body": "Perhaps you can use an API instead? That means you get all values as a json string and you parse it to the worksheet. <a href=\"https://oms.no/no/products/\" rel=\"nofollow noreferrer\">oms.no/no/products</a>"}, {"owner": {"reputation": 23, "user_id": 12018602, "user_type": "registered", "profile_image": "https://graph.facebook.com/10162268875425374/picture?type=large", "display_name": "Haakon Silberg", "link": "https://stackoverflow.com/users/12018602/haakon-silberg"}, "edited": false, "score": 0, "creation_date": 1567587803, "post_id": 57784621, "comment_id": 102003512, "body": "Hi, Andreas. The purpose of the task I&#39;m using this data for does unfortunately not justify to become a subscriber of Oslo B&#248;rs services - but it would definitely solve the problem."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1567587936, "post_id": 57784621, "comment_id": 102003588, "body": "@HaakonSilberg There are several XHR requests being sent that you can use. Which data do you want to retrieve? Just the tables? The chart data?"}, {"owner": {"reputation": 23, "user_id": 12018602, "user_type": "registered", "profile_image": "https://graph.facebook.com/10162268875425374/picture?type=large", "display_name": "Haakon Silberg", "link": "https://stackoverflow.com/users/12018602/haakon-silberg"}, "reply_to_user": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1567591533, "post_id": 57784621, "comment_id": 102005683, "body": "@StavrosJon I was just interested in the tables, i.e. the latest data, not historical development from the charts. Thanks for the proposed solution btw."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1567591845, "post_id": 57784621, "comment_id": 102005832, "body": "@HaakonSilberg Then take a look at the answer below. It&#39;s fairly easy if you familiarize yourself with the mechanics. ;)"}], "answers": [{"comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1567592001, "post_id": 57785370, "comment_id": 102005903, "body": "Creative solution. +1 for that. But I believe just using a proper API will be more stable and reliable. If they change the name of the tables then all this work has to be redone."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1567592833, "post_id": 57785370, "comment_id": 102006337, "body": "@Andreas I think that&#39;s the closest thing to an API this website offers. If something changes, I think it will probably be reflected in the parameters included in the URL, which is fairly easy to update. If however there is an official API, then indeed that would be the way to go."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1567593152, "post_id": 57785370, "comment_id": 102006494, "body": "Nice and comprehesive +1"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1567593302, "post_id": 57785370, "comment_id": 102006561, "body": "The same values can be found &quot;all over internet&quot; so there is no reason to grab them from the page where it&#39;s the most problematic, in my opinion. As an example a quick google gives me this page: <a href=\"https://www.nordnet.se/mux/web/marknaden/varlden/rantor.html\" rel=\"nofollow noreferrer\">nordnet.se/mux/web/marknaden/varlden/rantor.html</a> where NIBOR 3 month is listed. Looking at the source it seems to be a simple table."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1567594901, "post_id": 57785370, "comment_id": 102007381, "body": "@Andreas Oh ok! I am not familiar with this dataset. I thought it was only provided by this particular website. Nice to know."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1567595028, "post_id": 57785370, "comment_id": 102007428, "body": "Neither was I, but I used the magic of google. :-) Generally stock numbers can be found everywhere."}, {"owner": {"reputation": 23, "user_id": 12018602, "user_type": "registered", "profile_image": "https://graph.facebook.com/10162268875425374/picture?type=large", "display_name": "Haakon Silberg", "link": "https://stackoverflow.com/users/12018602/haakon-silberg"}, "edited": false, "score": 0, "creation_date": 1567665644, "post_id": 57785370, "comment_id": 102031777, "body": "Thanks for the JSON solution @Stravos Jon I tested it out and it was sophisticated and worked very well. However, the excel model I&#39;m making is a template for other to use, so unless everyone in my team takes the time to enable JSON parser, it only works for me. So, I went with Andreas&#39; URL in my previous VBA code - NIBOR is not quoted everywhere (the Norwegian Nordnet &quot;sibling&quot; presents the quote in a more complex web language again - at least to me - <a href=\"https://www.nordnet.no/market\" rel=\"nofollow noreferrer\">nordnet.no/market</a>) so thanks to Andreas for finding a quote that is easy to web scrape:)"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 23, "user_id": 12018602, "user_type": "registered", "profile_image": "https://graph.facebook.com/10162268875425374/picture?type=large", "display_name": "Haakon Silberg", "link": "https://stackoverflow.com/users/12018602/haakon-silberg"}, "edited": false, "score": 0, "creation_date": 1567667621, "post_id": 57785370, "comment_id": 102032620, "body": "@HaakonSilberg no need for everyone to enable it. You just import it to the project (your template) and then share the macro enabled workbook with your colleagues. Scraping tables is much less efficient."}, {"owner": {"reputation": 23, "user_id": 12018602, "user_type": "registered", "profile_image": "https://graph.facebook.com/10162268875425374/picture?type=large", "display_name": "Haakon Silberg", "link": "https://stackoverflow.com/users/12018602/haakon-silberg"}, "edited": false, "score": 0, "creation_date": 1567862807, "post_id": 57785370, "comment_id": 102096936, "body": "@StavrosJon ok, so others can run the VBA module and update the values without having a JSON parser? Btw, how can I return the same values as displayed in the immediate window, to cells in excel (which is were I wanted it in the first place)? Your answers are very much appreciated:)"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 23, "user_id": 12018602, "user_type": "registered", "profile_image": "https://graph.facebook.com/10162268875425374/picture?type=large", "display_name": "Haakon Silberg", "link": "https://stackoverflow.com/users/12018602/haakon-silberg"}, "edited": false, "score": 0, "creation_date": 1568035460, "post_id": 57785370, "comment_id": 102136068, "body": "@HaakonSilberg Exactly. Importing the Json Converter module only takes effect on the specific project/workbook you&#39;re working with and not with your windows or excel installation. So, you only need to do it once and then you can share this workbook with your colleagues. The only thing they will have to do is run the macro. I updated the code to write the results in excel. If this helped you, please consider showing your appreciation by upvoting and/or accepting the answer. This helps good quality content to remain relevant."}], "tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": true, "score": 2, "last_activity_date": 1568034707, "last_edit_date": 1568034707, "creation_date": 1567589060, "answer_id": 57785370, "question_id": 57784621, "link": "https://stackoverflow.com/questions/57784621/web-scraping-with-excel-vba-returns-no-values-for-certain-sites/57785370#57785370", "title": "Web scraping with excel VBA returns no values for certain sites", "body": "<p>The tables you are trying to scrape are generated by scripts, so you will not find them in the HTML document. To get your hands on the data you will need to send an XHR request.</p>\n\n<p>To find out how this request should look like, you have to inspect the network traffic when the page is loaded. You can do that through your browser's developer tools (<kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>E</kbd> if you're using Firefox).</p>\n\n<p>There you will see several requests of different types being sent. In your case, you should look for <code>XHR</code> requests of type <code>json</code>. There's a few of them. If you go through the responses of these requests, you will eventually find the one you need, as it will contain the data you want.</p>\n\n<p>Here's how it looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Y8Wa7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y8Wa7.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If you go through the <code>Headers</code> and the <code>Params</code> of the request you will see how the url, the body and the headers should look like. In this particular case, all the parameters are encoded into the url and the headers are not essential to the success of the request, so all you need is the url.</p>\n\n<p>The response's payload is in <code>json</code> format. You can inspect its structure using a tool like <a href=\"http://jsonviewer.stack.hu/\" rel=\"nofollow noreferrer\">this</a>. Here's how it looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/z14Cx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/z14Cx.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>To parse a response like that you need a parser (look at the end of this post).</p>\n\n<p><strong>TL;DR</strong> :</p>\n\n<p>Here's how to get the data from the \"Nibor 3 month\" table:</p>\n\n<pre><code>Option Explicit\n\nSub oslobors()\nDim req As New WinHttpRequest\nDim respJSON As Object\nDim key As Variant\nDim url As String\nDim results()\nDim i As Integer\nDim sht As Worksheet\nSet sht = ThisWorkbook.Worksheets(\"Name of your worksheet\")\nurl = \"https://www.oslobors.no/ob/servlets/components?type=nibor&amp;source=feed.index.nibor.INDICES_FIXING&amp;view=DELAYED&amp;columns=ITEM%2C+CLOSENZ%2C+TRADE_TIME%2C+CLOSE_DATE%2C+CHANGENZ%2C+CHANGENZ_PCT&amp;filter=ITEM_SECTOR%3D%3DsNIBOR3M.NIBOR&amp;channel=e6da3e88c3464b7ad9620824b8d39c95\"\nWith req\n    .Open \"GET\", url, False\n    .send\n    Set respJSON = JsonConverter.ParseJson(.responseText)\nEnd With\nReDim results(1 To respJSON(\"rows\")(1)(\"values\").Count, 1 To 2)\ni = 1\nFor Each key In respJSON(\"rows\")(1)(\"values\").Keys\n    results(i, 1) = key\n    results(i, 2) = respJSON(\"rows\")(1)(\"values\")(key) 'write the results in an array\n    i = i + 1\nNext key\nsht.Cells(1, \"A\").Resize(UBound(results, 1), UBound(results, 2)) = results 'Print the results array in one go. The results will be printed to an area/range starting with cell A1 and expanding as much as it is needed\n\nEnd Sub\n</code></pre>\n\n<p>For demonstration purposes, the data is printed in your immediate window:</p>\n\n<p><a href=\"https://i.stack.imgur.com/e7qKR.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e7qKR.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>You will need to add the following references to your project (VBE>Tools>References):</p>\n\n<pre><code>Microsoft WinHTTP Services version 5.1\nMicrosoft HTML Objects Library\nMicrosoft Scripting Runtime\n</code></pre>\n\n<p>You will also need to add this <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">JSON parser</a> to your project. Follow the installation instructions in the link and you should be set to go.</p>\n\n<p>To get the data from the \"Historical Prices\" table you just have to change the url to this:</p>\n\n<pre><code>url = \"https://www.oslobors.no/ob/servlets/components?type=table&amp;source=feed.index.nibor.INDICES_FIXING&amp;view=DELAYED&amp;columns=CHANGE_1WEEK_PCT%2C+HIGH_1WEEK%2C+LOW_1WEEK%2C+CHANGE_1MONTH_PCT%2C+HIGH_1MONTH%2C+LOW_1MONTH%2C+CHANGE_YEAR_PCT%2C+HIGH_YEAR%2C+LOW_YEAR%2C+CHANGE_1YEAR_PCT%2C+HIGH_1YEAR%2C+LOW_1YEAR&amp;filter=ITEM_SECTOR%3D%3DsNIBOR3M.NIBOR&amp;channel=283044a7d182ca196a16337ba79f089c\"\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Modified the code to print the results in a worksheet named \"Name of your worksheet\".</p>\n"}], "owner": {"reputation": 23, "user_id": 12018602, "user_type": "registered", "profile_image": "https://graph.facebook.com/10162268875425374/picture?type=large", "display_name": "Haakon Silberg", "link": "https://stackoverflow.com/users/12018602/haakon-silberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 57785370, "answer_count": 1, "score": 2, "last_activity_date": 1568034707, "creation_date": 1567586334, "last_edit_date": 1567586870, "question_id": 57784621, "link": "https://stackoverflow.com/questions/57784621/web-scraping-with-excel-vba-returns-no-values-for-certain-sites", "title": "Web scraping with excel VBA returns no values for certain sites", "body": "<p>I'm trying to scrape data from Oslo B\u00f8rs related to 3months NIBOR using excel VBA. However my code do not return any values back to excel. The same code is able to retrieve table data from other similar websites, but could it be related to the ui-view set-up of the html language? I'm not very skilled on html language, so I do come to short here. Any help would be much appreciated. Thanks</p>\n\n<pre><code>Sub NIBOR3M_oslobors()\n\nDim ie As InternetExplorer\nDim InternetExplorer As Object\nDim strURL As String\n        Dim ws As Worksheet\n        Dim rng As Range\n        Dim tbl As Object\n        Dim rw As Object\n        Dim cl As Object\n        Dim nextrow As Long\n        Dim I As Long\n\nstrURL = \"https://www.oslobors.no/markedsaktivitet/#/details/NIBOR3M.NIBOR/overview\"\n\nSet ie = CreateObject(\"InternetExplorer.Application\")\nWith ie\n    .navigate strURL\n    Do Until .READYSTATE = 4: DoEvents: Loop\n        Do While .Busy: DoEvents: Loop\n            Set doc = ie.Document\n\n        Set ws = Worksheets(\"Interest rates\")\n\n        For Each tbl In doc.getElementsByTagName(\"table\")\n            nextrow = nextrow + 1\n            Set rng = ws.Range(\"M8:M8\" &amp; nextrow)\n            For Each rw In tbl.Rows\n                For Each cl In rw.Cells\n                    rng.Value = rw.innerText\n                    Set rng = rng.Offset(, 1)\n                    I = I + 1\n                Next cl\n                nextrow = nextrow + 1\n                Set rng = rng.Offset(1, -I)\n                I = 0\n            Next rw\n        Next tbl\n\n            .Quit\n        End With\n\n ActiveSheet.Range(\"M8\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1567587051, "post_id": 57784567, "comment_id": 102003106, "body": "What is &#39;i&#39;? Where do you set &#39;rRng&#39;? Can you show some sample data?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1567587055, "post_id": 57784567, "comment_id": 102003109, "body": "Welcome to SO. In this case, I think it would be better if you try your cases using <code>&#204;f...Then...Elseif...Then....End if</code>"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1567587339, "post_id": 57784567, "comment_id": 102003262, "body": "Because you did <code>Select Case rRng(i, k)</code>, you are expected to evaluate the value of that... and the only time you&#39;re doing that is in the <code>Case &quot;Vacation&quot;</code>. You should probably follow Fox&#39;s advice in this case."}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 1, "creation_date": 1567587339, "post_id": 57784567, "comment_id": 102003263, "body": "Change it to: <code>Select Case True</code>, and the third condition to <code>rRng(i, k) = &quot;Vacation&quot;</code>, this is the way to make it work, but the <code>If..</code> structure suggested above should be way more readible."}, {"owner": {"reputation": 33, "user_id": 12014262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a0393b311c70b9dbaba79b45e87b2a?s=128&d=identicon&r=PG&f=1", "display_name": "newtovba", "link": "https://stackoverflow.com/users/12014262/newtovba"}, "edited": false, "score": 0, "creation_date": 1567590199, "post_id": 57784567, "comment_id": 102004869, "body": "JvdV - updated text to show declaration of variables Foxfire And Burns And Burns - got it! I&#39;m familiar with regular coding of if statements but wanted to try to use select case FAB &amp; BrakNicku - got it thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 12014262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a0393b311c70b9dbaba79b45e87b2a?s=128&d=identicon&r=PG&f=1", "display_name": "newtovba", "link": "https://stackoverflow.com/users/12014262/newtovba"}, "edited": false, "score": 0, "creation_date": 1567590348, "post_id": 57785228, "comment_id": 102004942, "body": "Ah yes, that&#39;s what I originally had as the code but wanted to use select case (trying to learn some VBA language). Thank you!  To answer your question, I&#39;m actually looking for &#39;n&#39; number of message boxes, the message boxes are just for testing my code as of now."}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 0, "last_activity_date": 1567591551, "last_edit_date": 1567591551, "creation_date": 1567588493, "answer_id": 57785228, "question_id": 57784567, "link": "https://stackoverflow.com/questions/57784567/how-to-use-a-select-case-statement-if-an-array-contains-certain-text-e-g-if-rr/57785228#57785228", "title": "How to use a select case statement if an array contains certain text (e.g. if rRng(i,k) contains &quot;/2&quot;)", "body": "<p>Try with something like the following</p>\n\n<pre><code>Dim msg As String\n\n'k starts as the column  of the specified date\n'rRng includes each of the cases between k to rRng.Columns.Count\nFor k = iTargetCol To rRng.Columns.Count\n    msg = rRng(1, k).Value2\n\n    ' This is to see if a number\n    If IsNumeric(rRng(i, k).Value2) Then\n        msg = msg &amp; \" Working\"\n    ' This is to account if it's \"Sick/2\" or \"Vacation/2\" etc\n    ElseIf rRng(i, k).Value2 Like \"*/2\" Then\n        msg = msg &amp; \" Half-day\"\n    ElseIf rRng(i, k).Value2 = \"Vacation\" Then\n        msg = msg &amp; \" On vacation\"\n    Else\n        msg = vbNullString\n    End If\n\n    If Not msg = vbNullString Then MsgBox prompt:=msg\nNext k\n</code></pre>\n\n<p>or using <code>Select Case</code></p>\n\n<pre><code>Dim msg As String\n\n'k starts as the column  of the specified date\n'rRng includes each of the cases between k to rRng.Columns.Count\nFor k = iTargetCol To rRng.Columns.Count\n    msg = rRng(1, k).Value2\n\n    Select Case True\n        ' This is to see if a number\n        Case IsNumeric(rRng(i, k).Value2)\n            msg = msg &amp; \" Working\"\n        ' This is to account if it's \"Sick/2\" or \"Vacation/2\" etc\n        Case rRng(i, k).Value2 Like \"*/2\"\n            msg = msg &amp; \" Half-day\"\n        Case rRng(i, k).Value2 = \"Vacation\"\n            msg = msg &amp; \" On vacation\"\n        Case Else:\n            msg = vbNullString\n    End Select\n\n    If Not msg = vbNullString Then MsgBox prompt:=msg\nNext k\n</code></pre>\n\n<p>Although, do you really want 'n' number of message boxes?</p>\n"}], "owner": {"reputation": 33, "user_id": 12014262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a0393b311c70b9dbaba79b45e87b2a?s=128&d=identicon&r=PG&f=1", "display_name": "newtovba", "link": "https://stackoverflow.com/users/12014262/newtovba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 57785228, "answer_count": 1, "score": 0, "last_activity_date": 1567591551, "creation_date": 1567586148, "last_edit_date": 1567590043, "question_id": 57784567, "link": "https://stackoverflow.com/questions/57784567/how-to-use-a-select-case-statement-if-an-array-contains-certain-text-e-g-if-rr", "title": "How to use a select case statement if an array contains certain text (e.g. if rRng(i,k) contains &quot;/2&quot;)", "body": "<p>Edited at 17:29 09/04/2019 updated code to show variables part of my code that I left out of my original code </p>\n\n<p>I have a range rRng that may contain:</p>\n\n<ol>\n<li>Text</li>\n<li>Numbers</li>\n<li>Mix of Text and Numbers</li>\n</ol>\n\n<p>I'm trying to use a select case based off what the cell contains (e.g. if it's a number, if it's a mix of text and numbers, or if it's a certain text)</p>\n\n<p>The first row of rRng is the date (e.g. 8/1/2019, 8/2/2019, etc)</p>\n\n<p>I've tried instr, contains, and like</p>\n\n<pre><code>Dim rRng As Range\nDim i As Integer\nDim j As Integer\nDim k As Integer\n\nSet rRng = Sheet3.Range(\"HolidaySchedule\")\n\nFor i = 1 To rRng.Rows.Count\n    For j = 1 To rRng.Columns.Count\n        If rRng(i, j).Value = \"Specific\" Then\n            'MsgBox rRng(i, j + 1)\n            For k = iTargetCol To rRng.Columns.Count\n                Select Case rRng(i, k)\n                    Case IsNumeric(rRng(i, k).Value)\n                        'MsgBox rRng(i, k) &amp; \" Working\"\n                    Case rRng(i, k) Like \"*/2*\"\n                        MsgBox rRng(i, k)\n                    Case \"Vacation\"\n                        MsgBox rRng(1, k) &amp; \" On vacation\"\n                        Exit For\n                End Select\n            Next k\n        End If\n    Next j\nNext i\n</code></pre>\n\n<blockquote>\n  <p><strong>Expected:</strong></p>\n  \n  <ul>\n  <li>if it's a number, the message box should show the date and \" Working\"</li>\n  <li>If the cell contains \"/2\" in any part of the cell, the message should show the date and \" Half Day\"</li>\n  <li>If the cell contains \"Vacation\", the message should show the date and \" On vacation\"</li>\n  </ul>\n  \n  <p><strong>Actual:</strong></p>\n  \n  <p>Only the \"Vacation\" message box shows despite the other cases being\n  true between k and rRng.Columns.Count</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1567586361, "post_id": 57783973, "comment_id": 102002737, "body": "I&#39;m afraid it&#39;s not going to be so simple. I think your best bet would be to find the underlying POST method that is being sent when you upload the file and use a <code>multipart&#47;form-data</code> type of encoding for the request&#39;s body to include the path of the file."}, {"owner": {"reputation": 551, "user_id": 7862279, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d81f99dbb19cd58585415b7b724b75c0?s=128&d=identicon&r=PG&f=1", "display_name": "JackA", "link": "https://stackoverflow.com/users/7862279/jacka"}, "reply_to_user": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1567587106, "post_id": 57783973, "comment_id": 102003129, "body": "@StavrosJon mh I see... I will dig into that! Thanks you!"}, {"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1567683393, "post_id": 57783973, "comment_id": 102040857, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1696877/how-to-set-a-value-to-a-file-input-in-html\">How to set a value to a file input in HTML?</a>"}, {"owner": {"reputation": 551, "user_id": 7862279, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d81f99dbb19cd58585415b7b724b75c0?s=128&d=identicon&r=PG&f=1", "display_name": "JackA", "link": "https://stackoverflow.com/users/7862279/jacka"}, "reply_to_user": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1567689663, "post_id": 57783973, "comment_id": 102044529, "body": "@JeremyThompson No not really there it talks about a normal input box and I am talking about a browse button which more complicated to use programtically..."}], "owner": {"reputation": 551, "user_id": 7862279, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d81f99dbb19cd58585415b7b724b75c0?s=128&d=identicon&r=PG&f=1", "display_name": "JackA", "link": "https://stackoverflow.com/users/7862279/jacka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567584530, "creation_date": 1567584099, "last_edit_date": 1592644375, "question_id": 57783973, "link": "https://stackoverflow.com/questions/57783973/transfer-a-file-to-a-web-page-via-browse-button", "title": "Transfer a file to a web page via browse button", "body": "<p>I want to fill in a form in VBA. I can fill everything empty field and set the drop down menus. However I couldn't find a way to put a file in the browse button.</p>\n<p><a href=\"https://i.stack.imgur.com/YetDK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YetDK.png\" alt=\"browse button\" /></a></p>\n<p>The code for this button is:</p>\n<p><a href=\"https://i.stack.imgur.com/fpzro.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fpzro.png\" alt=\"enter image description here\" /></a></p>\n<p>I tried something like this</p>\n<pre><code>IE.Document.getElementById(&quot;browseFiles&quot;).Value = &quot;C:\\Users\\nx\\Documents\\BCAM development.docx&quot;\n</code></pre>\n<p>or</p>\n<pre><code>IE.Document.getElementById(&quot;fileElement&quot;).Value = &quot;C:\\Users\\nx\\Documents\\BCAM development.docx&quot;\n</code></pre>\n<p>As expected it didn't work even though it doesn't give me any error.</p>\n<p>Do you know if it is possible to transfer a file like this?</p>\n<p>Thank you in advance!</p>\n"}, {"tags": ["excel", "vba", "function"], "answers": [{"comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 1, "creation_date": 1567587661, "post_id": 57784139, "comment_id": 102003445, "body": "Kudos for using a lastrow variable, but you forgot to declare it. Try to run the above with <code>Option Explicit</code>..."}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 1, "creation_date": 1567587823, "post_id": 57784139, "comment_id": 102003529, "body": "Right, added declaration. Always working with Option Explicit, but this time it went off somewhere."}], "tags": [], "owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "is_accepted": true, "score": 2, "last_activity_date": 1567587760, "last_edit_date": 1567587760, "creation_date": 1567584719, "answer_id": 57784139, "question_id": 57783880, "link": "https://stackoverflow.com/questions/57783880/vba-to-check-if-values-from-one-sheet-are-found-in-another-sheet/57784139#57784139", "title": "VBA to check if values from one sheet are found in another sheet", "body": "<p>That should work</p>\n\n<pre><code>Sub test()\n\nDim i As Long\nDim rng As Range, cell As Range\nDim lastRow as Long\n\nSet Wks1 = Worksheets(\"Sheet1\")\nSet Wks2 = Worksheets(\"Sheet2\")\n\nSet rng = Wks1.Range(\"C3:O69\")\nlastRow = Wks2.Cells(Rows.Count, 1).End(xlUp).row\nFor Each cell In rng\n\n    If Not (IsEmpty(cell.Value)) Then\n\n        For i = 1 To lastRow\n\n            With Wks2\n\n                If (InStr(.Cells(i, 1), cell.Value) &lt;&gt; 0) Or (InStr(.Cells(i, 3), cell.Value) &lt;&gt; 0) Then\n\n                   .Cells(i, 4) = \"String contains substring\"\n\n                End If\n\n            End With\n        Next i\n\n    End If\n\nNext cell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11999816, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCwYAxoRCGiIcBxtnI7Nz9_jrFeRXSh6uFVclPQeg=k-s128", "display_name": "John241", "link": "https://stackoverflow.com/users/11999816/john241"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 57784139, "answer_count": 1, "score": 1, "last_activity_date": 1567587760, "creation_date": 1567583780, "last_edit_date": 1567587278, "question_id": 57783880, "link": "https://stackoverflow.com/questions/57783880/vba-to-check-if-values-from-one-sheet-are-found-in-another-sheet", "title": "VBA to check if values from one sheet are found in another sheet", "body": "<p>I want to develop a macro to check if values from one column in a sheet are found as substrings in the columns of another sheet.</p>\n\n<p>So, I want to check each cell of my first column, and if it's not empty, compare it to every cell in the second sheet, of columns 1 and 3.</p>\n\n<p>For this I used a \"for each\" loop, and then a \"for\" loop, with i from 1 to Rows.Count. </p>\n\n<p>This is where it gets tricky as I'm not sure if it's the right way to approach this. Also, the parameters of the instr() function to check if values are found as substrings don't seem to match, as I get a \"type mismatch\" error when trying to run the code. </p>\n\n<pre><code>Sub test()\n\nSet Wks1 = Worksheets(\"Sheet1\")\nSet Wks2 = Worksheets(\"Sheet2\")\n\nDim i As Long\nDim rng As Range, cell As Range\n\nSet rng = Wks1.Range(\"C3:O69\")\n\nFor Each cell In rng\n\n    If Not (IsEmpty(cell.Value)) Then\n\n        For i = 1 To Wks2.Rows.Count\n\n            If (InStr(Cells(i, 1), cell.Value, 1) &lt;&gt; 0) Or (InStr(Cells(i, 3), _\n                                                            cell.Value, 1) &lt;&gt; 0) Then\n                Cells(i, 4) = \"String contains substring\"\n\n            End If\n\n        Next i\n\n    End If\n\nNext cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1567582800, "post_id": 57783580, "comment_id": 102000961, "body": "If you put 0 and then clear them, you will have the same problem all over again, errors in your formulas. Or will you copy &amp; paste values?"}, {"owner": {"reputation": 49, "user_id": 11995192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59c675d745545856b0b8be8f958702b?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/11995192/nick"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1567583499, "post_id": 57783580, "comment_id": 102001277, "body": "Example: A1 and B1 are empty (or rather contains &quot;&quot;), C1 has a formula like A1-B1.   C1 shows a value error after I pasted &quot;&quot; in both A1 and B1. When I then manually put a 0 in A1 and B1 then deleting them. so both of the cells are now empty. I do not get the value error anymore.(this has nothing to do with refreashing with F9)"}, {"owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 0, "creation_date": 1567583893, "post_id": 57783580, "comment_id": 102001450, "body": "The only possible logic(?) in changing empty string to zero and make reverse operation is 1) when you won&#39;t change your formulas 2) empty string means something different from zero (e.g. empty string &quot;&quot; = no value read, 0 means - value is zero). Is this true? If not, your approach is wrong and loops (as presented in below answers) are not necessary and slow."}], "answers": [{"tags": [], "owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "is_accepted": false, "score": 1, "last_activity_date": 1567583972, "creation_date": 1567583972, "answer_id": 57783939, "question_id": 57783580, "link": "https://stackoverflow.com/questions/57783580/how-do-i-clear-content-in-rows-based-on-cell-value/57783939#57783939", "title": "How do I clear content in rows based on cell value?", "body": "<p>Try this one:</p>\n\n<pre><code>With Worksheets(1).Range( _'PLACE YOUR RANGE\n                                            ) \n    Set c = .Find(0, lookin:=xlValues) \n    If Not c Is Nothing Then \n        firstAddress = c.Address \n        Do \n           c.Value = \"\" \n            Set c = .FindNext(c) \n        Loop While Not c Is Nothing\n    End If \nEnd With\n</code></pre>\n\n<p>Hope it helps</p>\n\n<p>Anyhow, I think that will be simpler to place a condition in your operation formula: <code>=IF(OR(A1=\"\",B1=\"\"),Make when there is an unexpected value,A1-B1)</code></p>\n"}], "owner": {"reputation": 49, "user_id": 11995192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59c675d745545856b0b8be8f958702b?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/11995192/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567583972, "creation_date": 1567582608, "last_edit_date": 1567583638, "question_id": 57783580, "link": "https://stackoverflow.com/questions/57783580/how-do-i-clear-content-in-rows-based-on-cell-value", "title": "How do I clear content in rows based on cell value?", "body": "<p>I copy a lot of information (1000 rows and at least 24 columns) from one sheet to another. A lot of the cells contains \"\". This makes my other formulas(for example: A1-B1) to show an value error if either of these cells contains \"\". \nI believe I can solve the problem by never pasting \"\" but a \"0\" instead. But I would like to delete these \"0\" afterwards. </p>\n\n<p>There could be values in the first 3 rows but the other 997 rows have \"\". </p>\n\n<p>I would think I need to tell my macro to (Cell A1 in the \"sheet1\" sheet displays \"G5:H12\". the cells I need to delete): </p>\n\n<pre><code>Rowstodelete = Sheets(\"sheet1\").Range(\"A1\").Value\n\nSheets(\"sheet1\").Range(\"rowstodelete\").clearcontent\n</code></pre>\n\n<p>This does not work. anyone know how to do this?</p>\n\n<p>Summary(new example)</p>\n\n<p>If cell A1 = \"B1:B2\" I want to clear the content of B1 and B2, but if A1 now = B4:B6, that is the cells that should be cleared.</p>\n"}, {"tags": ["excel", "vba", "ribbonx"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1567582434, "post_id": 57783530, "comment_id": 102000784, "body": "I could be wrong, but I thought using two in a row worked... like <code>Settings &amp;&amp; Filters</code>"}, {"owner": {"reputation": 51, "user_id": 10956787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d54d7139ee14674ae4995b00d0bfefa1?s=128&d=identicon&r=PG&f=1", "display_name": "Jumpy73", "link": "https://stackoverflow.com/users/10956787/jumpy73"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1567687013, "post_id": 57783530, "comment_id": 102042926, "body": "Tks braX... I tried to do that in the screentip string but it doesn&#39;t work. It works so only if I use a callback function approach, but I consider this as a workaround because I don&#39;t need of a dynamic label for my ribbon button"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 10956787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d54d7139ee14674ae4995b00d0bfefa1?s=128&d=identicon&r=PG&f=1", "display_name": "Jumpy73", "link": "https://stackoverflow.com/users/10956787/jumpy73"}, "edited": false, "score": 0, "creation_date": 1567630126, "post_id": 57785252, "comment_id": 102024023, "body": "Thanks a lot. It works with call back function only"}, {"owner": {"reputation": 51, "user_id": 10956787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d54d7139ee14674ae4995b00d0bfefa1?s=128&d=identicon&r=PG&f=1", "display_name": "Jumpy73", "link": "https://stackoverflow.com/users/10956787/jumpy73"}, "edited": false, "score": 0, "creation_date": 1567630577, "post_id": 57785252, "comment_id": 102024182, "body": "Is there a way for directly use the &quot;&amp;&quot; special character into xml code? It would be a lighter code approach :)"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1599205087, "post_id": 57785252, "comment_id": 112707407, "body": "Didn&#39;t test: <code>&amp;#38;#38;</code> replacing ampersand :-)"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1567588617, "creation_date": 1567588617, "answer_id": 57785252, "question_id": 57783530, "link": "https://stackoverflow.com/questions/57783530/inserting-symbol-into-label-property-of-office-ribbon-xml-controls/57785252#57785252", "title": "Inserting &quot;&amp;&quot; symbol into Label property of Office Ribbon XML controls", "body": "<p>You need to duplicate a special character in the string to get it visible on the ribbon UI. For example:</p>\n\n<pre><code>Ribbon &amp;&amp; Fluent UI\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14215330, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9022277ca824a0932593b21e3f8987a0?s=128&d=identicon&r=PG", "display_name": "Dominikus", "link": "https://stackoverflow.com/users/14215330/dominikus"}, "is_accepted": false, "score": 0, "last_activity_date": 1599139959, "creation_date": 1599139959, "answer_id": 63724770, "question_id": 57783530, "link": "https://stackoverflow.com/questions/57783530/inserting-symbol-into-label-property-of-office-ribbon-xml-controls/63724770#63724770", "title": "Inserting &quot;&amp;&quot; symbol into Label property of Office Ribbon XML controls", "body": "<p>In the XML use:</p>\n<pre><code>&amp;amp;&amp;amp;\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 10956787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d54d7139ee14674ae4995b00d0bfefa1?s=128&d=identicon&r=PG&f=1", "display_name": "Jumpy73", "link": "https://stackoverflow.com/users/10956787/jumpy73"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 57785252, "answer_count": 2, "score": 0, "last_activity_date": 1599139959, "creation_date": 1567582350, "last_edit_date": 1567608130, "question_id": 57783530, "link": "https://stackoverflow.com/questions/57783530/inserting-symbol-into-label-property-of-office-ribbon-xml-controls", "title": "Inserting &quot;&amp;&quot; symbol into Label property of Office Ribbon XML controls", "body": "<p>I am building a ribbon tab for MS Excel 2016 from scratch using XML stored within a customUI14.xml file. I created buttons having the \"&amp;\" special character into the button label (i.e. \"Cut &amp; Paste\", or \"Trades &amp; Models\", etc...). The code for inserting the symbol works fine, but I cannot get the labels of the XML controls to display this symbol.</p>\n\n<p>I used both the methods described in the post <a href=\"https://stackoverflow.com/questions/8451331/inserting-symbols-into-office-ribbon-xml-controls\">Inserting symbols into Office Ribbon XML controls</a> but nothing seemed to work.</p>\n\n<p>I'm not state that those approaches don't work at all (I tried with other symbols and they worked - i.e. with the same symbol \"\u20ac\" of the above mentioned post the solution provided in the past post works well)</p>\n\n<pre><code>&lt;menu id=\"T1G2M1-PGSTRGY\" getLabel=\"RibSetCtlLabel\" size=\"normal\" itemSize=\"normal\" \nimageMso=\"ChartInsertGalleryNew\" screentip=\"Settings &amp;amp; Filters\" \nsupertip=\"Options to use during What-If Analysis.\" getEnabled=\"RibSetCtlEnabled\"&gt;\n</code></pre>\n\n<p>with this call-back procedure</p>\n\n<pre><code>Public Function RibSetCtlLabel(ctl As IRibbonControl, ByRef Label)\n  Label = \"Settings \" &amp; Chr(38) &amp; \" Filters\"\nEnd Function\n</code></pre>\n\n<p>Both approaches (\"&amp;\" symbol directly into the xml text or into the string applyed as result of the call-back procedure) fail tu run properly</p>\n\n<p>I expected to have the button label = \"Settings &amp; Filters\" but \"Settings \n Filters\" is displayed</p>\n\n<p>The workaround solution is required to be run both on x32 and x64 Office 2016 version</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1567581991, "post_id": 57782814, "comment_id": 102000583, "body": "Forms are intended for screen and reports for print. Making one serve for the other is bound to be frustrating. I don&#39;t think you will get what you want."}, {"owner": {"reputation": 1, "user_id": 11225450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3230162734e34b8406761ed6b2ed889?s=128&d=identicon&r=PG&f=1", "display_name": "JeffreyJ", "link": "https://stackoverflow.com/users/11225450/jeffreyj"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1567592652, "post_id": 57782814, "comment_id": 102006232, "body": "Yes and no... Making a form present data grouped and sub-grouped for displaying to management is just as troublesome.  Reports are excellent for this kind of presentation, I am just trying to extend functionality.  If you have code examples for a FORM to do what I need please send, it may work for what I need.   Keep in mind, the MS development made a decision to NOT allow visibility command to be addressed in Report View, not sure why, but C&#39;est La Vie, looking for a work-around."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1567609343, "post_id": 57782814, "comment_id": 102015515, "body": "Why don&#39;t you prevent Print-View and allow only Print-Preview? No other options as Print-View is only one huge Page. Thats why formatting is missing."}], "owner": {"reputation": 1, "user_id": 11225450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3230162734e34b8406761ed6b2ed889?s=128&d=identicon&r=PG&f=1", "display_name": "JeffreyJ", "link": "https://stackoverflow.com/users/11225450/jeffreyj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594450003, "creation_date": 1567579268, "last_edit_date": 1594450003, "question_id": 57782814, "link": "https://stackoverflow.com/questions/57782814/show-hide-footer-groupfooter-in-report-view-not-print-preview", "title": "Show/Hide Footer Groupfooter in Report View NOT Print Preview", "body": "<p>Good Day Mates, I have experience in MS Access but am stumped, maybe because MS Access just doesn't cut the mustard.  In a nutshell, I am trying to build a Smart Report that does not need to be printed.  Based on buttons clicked on the report, the report in REPORT VIEW (notice NOT Print Preview mode) and I want to HIDE or SHOW the Groupfooter based on the button clicks.  Note: I am trying to avoid having numerous reports for each condition, just want a Smart Report to handle it. </p>\n\n<p>Yes, Yes, Yes... I can make it work in PRINT PREVIEW using the Cancel command because the OnFormat event executes only in Print Preview mode.</p>\n\n<pre><code>Private Sub Groupfooter0_Format\n   If &lt;condition&gt; then\n      Cancel = True\n   End if\n</code></pre>\n\n<p>The OnPaint Event will <b>NOT</b> allow visibility commands to be set and gives an Error to that point, and the Cancel doesn't work either.</p>\n\n<pre><code>If &lt;condition&gt; Then\n    GroupFooter.Visible = True\nElse\n    GroupFooter.Visible = False\nEnd If\n</code></pre>\n\n<p>Again, I am hoping someone has experience with successfully hiding and showing groupfooters in REPORT VIEW using the OnPaint event and NOT the OnFormat event, because as explained, the user will control the report via buttons.  </p>\n\n<p>Cheers,</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1567579894, "post_id": 57782614, "comment_id": 101999633, "body": "Have you selected <code>Microsoft Outlook Library</code> from <code>Tools&gt;References</code> ?"}, {"owner": {"reputation": 1, "user_id": 12017936, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rsS01O1R3w0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfAGADdYehpCV0wdL5UgSn1HqeVGw/photo.jpg?sz=128", "display_name": "Irfan LATIF", "link": "https://stackoverflow.com/users/12017936/irfan-latif"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1567599181, "post_id": 57782614, "comment_id": 102009610, "body": "yes I have selected the &quot;Microsoft Outlook Library&quot;"}], "owner": {"reputation": 1, "user_id": 12017936, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rsS01O1R3w0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfAGADdYehpCV0wdL5UgSn1HqeVGw/photo.jpg?sz=128", "display_name": "Irfan LATIF", "link": "https://stackoverflow.com/users/12017936/irfan-latif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567608138, "creation_date": 1567578375, "last_edit_date": 1567608138, "question_id": 57782614, "link": "https://stackoverflow.com/questions/57782614/which-object-library-is-required-for-send-email-from-excel-using-mailenvelope", "title": "Which object library is required for send email from excel using &quot;mailenvelope&quot; property?", "body": "<p>I am trying to send email through MS Excel and using the code below. The code was working fine previously. But after re-installing the windows OS &amp; Microsoft office, the code is not working anymore. Error: \"Object library not registered\"</p>\n\n<p>Code is as given below</p>\n\n<pre><code>Sub Send_email()\n\nActiveSheet.Range(\"A1:D10\").Select\n\nActiveWorkbook.EnvelopeVisible = True\n\nWith ActiveSheet.MailEnvelope\n\n.Item.to = \"myemailaddress@myemail.com\"\n.Item.Subject = \"Test EMail\"\n.Item.send\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1567581517, "post_id": 57782495, "comment_id": 102000363, "body": "Seeing a couple of example inputs with expected outputs along with a bit more of the code would IMO help. We should be able to reproduce your problem."}, {"owner": {"reputation": 1, "user_id": 12017981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c73b23861ebcb26f7712b4ffe7018e90?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/12017981/kevin"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1567589551, "post_id": 57782495, "comment_id": 102004512, "body": "Hi QHarr and thank you for your interest in my little problem. I added more code to the original question"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1567589635, "post_id": 57782495, "comment_id": 102004564, "body": "Use <a href=\"https://stackoverflow.com/posts/57782495/edit\">edit</a> to make these changes to the question itself."}, {"owner": {"reputation": 1, "user_id": 12017981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c73b23861ebcb26f7712b4ffe7018e90?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/12017981/kevin"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1567590432, "post_id": 57782495, "comment_id": 102004997, "body": "That QHarr. I&#39;ve done that now. Hope this helps"}], "owner": {"reputation": 1, "user_id": 12017981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c73b23861ebcb26f7712b4ffe7018e90?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/12017981/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567655718, "creation_date": 1567577866, "last_edit_date": 1567655718, "question_id": 57782495, "link": "https://stackoverflow.com/questions/57782495/want-to-be-able-to-input-two-variables-into-one-cell-as-test-for-data-from-my-sc", "title": "Want to be able to input two variables into one cell as test for data from my school", "body": "<p>In our school we track students progress and teachers assign a colour code and a reason for picking this code. For example - Student A is green and there is 'no concern'. Student B is orange because of 'attendance'. We had a previous teacher generate the code and we have it working fine but the school has no asked us to add a grade to the output.</p>\n\n<p>So currently it looks like</p>\n\n<pre><code>Student     Subject 1\nStudent A.  Science\n        No concern - This cell in excel is green\n</code></pre>\n\n<p>There are images are what it looks like below.</p>\n\n<p>From the code below we can get it to find the value against the 'Academic Progress Reason' but am after how to add the 'result' which is the next cell down.</p>\n\n<p>So in the outcomes column is goes for each student for each subject they undertake\nIndicator - colour picked\nReason - Attendance, etc\n<em>new addition</em> Result - A, B etc</p>\n\n<p>This is way beyond my basic coding skill. </p>\n\n<p>Here is the code that collects the raw data and fills it into the cohort summary sheet.</p>\n\n<pre><code>  If (Sheets(\"RawData\").Cells(rawRowNum, 16).Value = task) Then   'check that the data line relates to the selected task\n        'check if this is a new subject for the student\n        If (Sheets(\"RawData\").Cells(rawRowNum, 22).Value) = nextTrigger Then\n            subjectNum = subjectNum + 1\n            Sheets(\"CohortSummary\").Cells(1, 4 + subjectNum).Value = (\"Subject \" &amp; CStr(subjectNum))\n        End If\n\n        'Find the subject for the row\n        subjectName = Sheets(\"RawData\").Cells(rawRowNum, 10).Value\n\n        'enter traffic light data\n        If Sheets(\"RawData\").Cells(rawRowNum, 22).Value = \"Progress Indicator\" Then  'colour code the cell\n            Select Case Sheets(\"RawData\").Cells(rawRowNum, 20).Value\n                Case \"Red\"\n                    Sheets(\"OutputGrid\").Cells(outputRow, subjectColumn(subjectName)).Interior.Color = red\n                    Sheets(\"CohortSummary\").Cells(outputRow, 4 + subjectNum).Interior.Color = red\n                Case \"Orange\"\n                    Sheets(\"OutputGrid\").Cells(outputRow, subjectColumn(subjectName)).Interior.Color = orange\n                    Sheets(\"CohortSummary\").Cells(outputRow, 4 + subjectNum).Interior.Color = orange\n                Case \"Green\"\n                    Sheets(\"OutputGrid\").Cells(outputRow, subjectColumn(subjectName)).Interior.Color = green\n                    Sheets(\"CohortSummary\").Cells(outputRow, 4 + subjectNum).Interior.Color = green\n                Case Else\n                    Sheets(\"OutputGrid\").Cells(outputRow, subjectColumn(subjectName)).Interior.Color = unidentified\n                    Sheets(\"CohortSummary\").Cells(outputRow, 4 + subjectNum).Interior.Color = unidentified\n                End Select\n        ElseIf Sheets(\"RawData\").Cells(rawRowNum, 22).Value = \"Academic Progress Reason\" Then 'enter the text into the cell\n            Sheets(\"CohortSummary\").Cells(outputRow, 4 + subjectNum).Value = (subjectName &amp; Chr(10) &amp; Chr(13) &amp; Sheets(\"RawData\").Cells(rawRowNum, 20).Value)\n            Sheets(\"CohortSummary\").Cells(outputRow, 4 + subjectNum).Value = (subjectName &amp; Chr(10) &amp; Chr(13) &amp; Sheets(\"RawData\").Cells(rawRowNum, 20).Value)\n        End If\n    End If\n\n\n\n    rawRowNum = rawRowNum + 1\nLoop\n\nSheets(\"OutputGrid\").Select\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/VAIi5.png\" rel=\"nofollow noreferrer\">Example of raw data</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/nOVG0.png\" rel=\"nofollow noreferrer\">First row has current output, row 2 has output that I am after</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1567577298, "post_id": 57782378, "comment_id": 101998603, "body": "I&#39;d use a Date variable and give the cell the Date variable instead the textbox value."}, {"owner": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1567577509, "post_id": 57782378, "comment_id": 101998692, "body": "there are multiple textboxes .could explain little more on how to use date variable"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1567577641, "post_id": 57782378, "comment_id": 101998747, "body": "<code>Dim MyDate As Date</code> and then <code>MyDate = TextBox3.Value</code> to finally pass <code>MyDate</code> to the cell"}, {"owner": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1567580525, "post_id": 57782378, "comment_id": 101999885, "body": "it is having an error when the textbox is blank .so does this mean i need to create if loop for each and every textbox"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1567580694, "post_id": 57782378, "comment_id": 101999947, "body": "<code>If Not Textbox3.Value = vbNullString Then</code> and inside the if you can set the Date Variable."}, {"owner": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1567581196, "post_id": 57782378, "comment_id": 102000185, "body": "i tried    ` If TextBox5.Value &lt;&gt; &quot;&quot;  Then`         <code>startdate = TextBox5.Value</code>          <code>End If</code> but it in case the textbox is blank it is enter date as 00-01-1900.how to get  cell as blank if textbox is empty"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "edited": false, "score": 0, "creation_date": 1567581946, "post_id": 57783291, "comment_id": 102000563, "body": "Thanks for the reply ,i tried it but now if textbox is blank ,Worksheets(1).Cells(i, 40) value  is 00-01-00 00:00 is there anyway to make it blank"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "edited": false, "score": 0, "creation_date": 1567582068, "post_id": 57783291, "comment_id": 102000622, "body": "@AshwinSooraj add an <code>Else</code> to the if statement, and then <code>Worksheets(1).Cells(i, 40).Value = vbNullstring</code> inside the <code>Else</code>"}, {"owner": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "edited": false, "score": 0, "creation_date": 1567583890, "post_id": 57783291, "comment_id": 102001449, "body": "sorry my mistake it worked just fine .thanks for the help"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "edited": false, "score": 0, "creation_date": 1567583956, "post_id": 57783291, "comment_id": 102001493, "body": "@AshwinSooraj Glad I could help you! May I ask you to accept my answer ?"}, {"owner": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "edited": false, "score": 0, "creation_date": 1567587977, "post_id": 57783291, "comment_id": 102003606, "body": "@Dorian  still the date is coming in  different format."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "edited": false, "score": 0, "creation_date": 1567593302, "post_id": 57783291, "comment_id": 102006562, "body": "@AshwinSooraj please try my edit, I bet it will solve your issue"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "edited": false, "score": 0, "creation_date": 1567593471, "post_id": 57783291, "comment_id": 102006630, "body": "@AshwinSooraj Waiting for your feedbacks ;)"}, {"owner": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "edited": false, "score": 0, "creation_date": 1567602366, "post_id": 57783291, "comment_id": 102011308, "body": "@Dorian thanks for the edit. I left the office.will try tomorrow and will update you.hope it works. right now for a workaround, I am using <code>dd-mmm-yy</code> format.in the edit you entered <code>&quot; format(Month(.Value) &amp; &quot;&#47;&quot; &amp; Day(.Value) &amp; &quot;&#47;&quot; &amp; Year(.Value), &quot;dd&#47;mm&#47;yyyy&quot;)&quot;</code> may i know why you used month/day/year"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "edited": false, "score": 0, "creation_date": 1567683728, "post_id": 57783291, "comment_id": 102041071, "body": "@AshwinSooraj Did this solve your issue ? I founded it because i had the same issue as yours several month ago tell me if your issue is fixed pls"}, {"owner": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "edited": false, "score": 0, "creation_date": 1567733974, "post_id": 57783291, "comment_id": 102060548, "body": "@Dorian, sorry i couldn&#39;t try it.i will be going to office only on next Friday.will try and let you know.mean while can you please explain how the edited code works."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "edited": false, "score": 0, "creation_date": 1568027090, "post_id": 57783291, "comment_id": 102131759, "body": "@AshwinSooraj  If this issue is solved May I ask you to accept this answer ? Click <a href=\"https://meta.stackexchange.com/a/5235\">here to see how to accept</a>"}], "tags": [], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "is_accepted": true, "score": 1, "last_activity_date": 1567593285, "last_edit_date": 1567593285, "creation_date": 1567581389, "answer_id": 57783291, "question_id": 57782378, "link": "https://stackoverflow.com/questions/57782378/date-format-getting-changed/57783291#57783291", "title": "date format getting changed", "body": "<p>Maybe you can give this a try  (had the same issue as yours the way to solve is to save value in <code>date var</code>):  </p>\n\n<pre><code>Sub tryme()\n\n    Dim TextBoxVal As Date\n\n    If Not TextBox3.Value = vbNullString Then\n        If IsEmpty(TextBox3.Value) = False Then\n\n\n\nTextBoxVal = TextBox3.Value\nTextBoxVal = Format(TextBox3.Value, \"dd-mm-yy HH:mm:ss\")\n\nWith ActiveWorkbook.Worksheets(1).Cells(i, 40)\n   TextBoxVal = format(Month(.Value) &amp; \"/\" &amp; Day(.Value) &amp; \"/\" &amp; Year(.Value), \"dd/mm/yyyy\")\n\nEnd With\nWorksheets(1).Cells(i, 40).Value = TextBoxVal\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 57783291, "answer_count": 1, "score": 0, "last_activity_date": 1567593285, "creation_date": 1567577208, "last_edit_date": 1567578253, "question_id": 57782378, "link": "https://stackoverflow.com/questions/57782378/date-format-getting-changed", "title": "date format getting changed", "body": "<p>I need to copy date  in format <code>\"dd-mm-yy\"</code> to a cell .\nBut while entering at cell it is in <code>\"mm-dd-yy\"</code> format,I believe this happens when date is less than 12</p>\n\n<pre><code>Worksheets(1).Cells(i, 40).Value = Format(TextBox3.Value, \"dd-mm-yy HH:mm:ss\")\n\nWorksheets(1).Cells(i, 40).Value = TextBox3.Value\n</code></pre>\n\n<p>if I enter <code>03-09-2019</code> in textbox and press submit .It should be in 03-09-2019 itself.</p>\n\n<p>Instead it is changing to <code>09-03-2019(09-march-19)</code>.column format is also in <code>\"dd-mm-yy\"</code> format .it was working fine when date was <code>\"30-08-19\"</code></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1567576717, "post_id": 57782179, "comment_id": 101998398, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. You should use this technique afer <b>every</b> macro recording to improve the macro in speed and reliabilty."}], "answers": [{"tags": [], "owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "is_accepted": false, "score": -1, "last_activity_date": 1567576352, "creation_date": 1567576352, "answer_id": 57782234, "question_id": 57782179, "link": "https://stackoverflow.com/questions/57782179/how-to-put-my-answer-in-next-row-without-overwriting-my-previous-answer-in-vba-m/57782234#57782234", "title": "How to put my answer in next row without overwriting my previous answer in VBA-Macro in Excel 2016?", "body": "<p>Just add lastRow1 line to set always lastRow +1 (empty cell)</p>\n\n<pre><code>Sub updateM()\n\n    Dim lastRow1 As Long\n\n    lastRow1 = Sheets(\"Sheet4\").Cells(Rows.Count, 2).End(xlUp).row + 1\n    Range(\"B4:G4\").Copy Sheets(\"Sheet4\").Range(\"B2\")\n    Sheets(\"Sheet3\").Range(\"B7:G7\").Copy Sheets(\"Sheet4\").Range(\"B3\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": -1, "last_activity_date": 1567578635, "creation_date": 1567578635, "answer_id": 57782669, "question_id": 57782179, "link": "https://stackoverflow.com/questions/57782179/how-to-put-my-answer-in-next-row-without-overwriting-my-previous-answer-in-vba-m/57782669#57782669", "title": "How to put my answer in next row without overwriting my previous answer in VBA-Macro in Excel 2016?", "body": "<p>This should do it. You should try to a void <code>Select</code> or <code>Activate</code> as P\u1d07\u029c said, here is an example on how to do it:</p>\n\n<pre><code>Option Explicit\nSub update()\n'\n' update Macro\n'\n\n'\n    Dim Answer1 As Range, Answer2 As Range\n\n    With ThisWorkbook.Sheets(\"sheet3\")\n        Set Answer1 = .Range(\"B4:G4\") 'set the range for the first answer\n        Set Answer2 = .Range(\"B7:G7\") 'set the range for the second answer\n    End With\n\n    Dim LastRow As Long\n    With ThisWorkbook.Sheets(\"Sheet4\")\n        'Copy the first answer\n        LastRow = .Cells(.Rows.Count, 2).End(xlUp).Row + 1 'calculate next blank cell\n        Answer1.Copy .Cells(LastRow, 2)\n        'Copy the second answer\n        LastRow = .Cells(.Rows.Count, 2).End(xlUp).Row + 1 'calculate next blank cell\n        Answer2.Copy .Cells(LastRow, 2)\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 2822275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf9add6da8f39f98d0acb4c018664080?s=128&d=identicon&r=PG", "display_name": "Param", "link": "https://stackoverflow.com/users/2822275/param"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1567578635, "creation_date": 1567576015, "last_edit_date": 1567576650, "question_id": 57782179, "link": "https://stackoverflow.com/questions/57782179/how-to-put-my-answer-in-next-row-without-overwriting-my-previous-answer-in-vba-m", "title": "How to put my answer in next row without overwriting my previous answer in VBA-Macro in Excel 2016?", "body": "<p>I have recorded a Macro in Excel 2016, however whenever I run this Macro it overwrite my previous answer, how should I put my new answer to next row?</p>\n\n<pre><code>Sub update()\n'\n' update Macro\n'\n\n'\n    Range(\"B4:G4\").Select\n    Selection.Copy\n    Sheets(\"Sheet4\").Select\n    Range(\"B2\").Select\n    ActiveSheet.Paste\n    Sheets(\"Sheet3\").Select\n    Range(\"B7:G7\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Sheet4\").Select\n    Range(\"B3\").Select\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 13, "user_id": 12017817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb41b3e50228a25a9db80d8e4257541?s=128&d=identicon&r=PG&f=1", "display_name": "PLL", "link": "https://stackoverflow.com/users/12017817/pll"}, "edited": false, "score": 0, "creation_date": 1567576774, "post_id": 57782087, "comment_id": 101998417, "body": "Thank you, I changed that but it doesn&#39;t solve my problems. God programming tip though."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12017817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb41b3e50228a25a9db80d8e4257541?s=128&d=identicon&r=PG&f=1", "display_name": "PLL", "link": "https://stackoverflow.com/users/12017817/pll"}, "edited": false, "score": 0, "creation_date": 1567577122, "post_id": 57782202, "comment_id": 101998543, "body": "The Dim OpenedWb as Workbook produce a compile error of User Defined Type not defined"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1567577712, "post_id": 57782202, "comment_id": 101998772, "body": "Ah because you used late-binding. Sorry missed that. In case of late-binding you must use <code>Dim OpenedWb As Object</code>"}, {"owner": {"reputation": 13, "user_id": 12017817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb41b3e50228a25a9db80d8e4257541?s=128&d=identicon&r=PG&f=1", "display_name": "PLL", "link": "https://stackoverflow.com/users/12017817/pll"}, "edited": false, "score": 0, "creation_date": 1567580502, "post_id": 57782202, "comment_id": 101999878, "body": "Thank you!!!! Works like a charm now! That fixed the problem perfectly."}, {"owner": {"reputation": 13, "user_id": 12017817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb41b3e50228a25a9db80d8e4257541?s=128&d=identicon&r=PG&f=1", "display_name": "PLL", "link": "https://stackoverflow.com/users/12017817/pll"}, "edited": false, "score": 0, "creation_date": 1567580850, "post_id": 57782202, "comment_id": 102000018, "body": "BTW - I couldn&#39;t get this to run from a Control (Button) on a form as a Sub. The RunCode event seemed to only work as a function, not sub. I tried to use the event RunMacro but it wouldn&#39;t find the macro from the drop down list on the far right of the field where you enter the Macro name."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 13, "user_id": 12017817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb41b3e50228a25a9db80d8e4257541?s=128&d=identicon&r=PG&f=1", "display_name": "PLL", "link": "https://stackoverflow.com/users/12017817/pll"}, "edited": false, "score": 0, "creation_date": 1567606686, "post_id": 57782202, "comment_id": 102013882, "body": "As long <code>Open_Share_Price_Excel</code> is <code>Public</code> and in a module it should work to run from a button I think. If this answered your question please mark it as solved: <a href=\"https://meta.stackexchange.com/a/5235\">Accepting Answers: How does it work?</a>"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 3, "last_activity_date": 1567577765, "last_edit_date": 1592644375, "creation_date": 1567576141, "answer_id": 57782202, "question_id": 57782087, "link": "https://stackoverflow.com/questions/57782087/how-to-fix-closing-excel-from-inside-access/57782202#57782202", "title": "How to fix closing Excel from inside Access", "body": "<ol>\n<li><p>What you need to do is to set the opened workbook to a variable <code>Set OpenedWb = .Workbooks.Open(Expath)</code> so you can access exactly that workbook to close it <code>OpenedWb.Close SaveChanges:=True</code>.</p>\n<p><code>.Workbooks.Close</code> does not work because <code>Workbooks</code> repersents <em>all</em> workbooks and not a specific one (but you must close each workbook on its own).</p>\n</li>\n<li><p>Please note that <code>Dim Expath, ModName As String</code> only declares <code>ModName As String</code> but <code>Expath As Variant</code>. In VBA you need to specify a type for <strong>every</strong> variable, otherwise it is <code>Variant</code> by default. So you must use: <code>Dim Expath As String, ModName As String</code> to make them both strings.</p>\n</li>\n<li><p>Your <code>Function</code> does not return anything. Therfore it should be a procedure <code>Sub</code> instead of a function.</p>\n</li>\n</ol>\n<p>You would end up using something like below:</p>\n<pre><code>Public Sub Open_Share_Price_Excel()    \n    ' Change Cursor to Hourglass\n    Screen.MousePointer = 11\n    \n    '\n    'Define where the Excel Spreadsheet is and the module to run\n    '\n    Dim Expath As String \n    Expath = &quot;C:\\Users\\peter\\Documents\\Financial Affairs\\Shares\\Share Price Bing.xlsm&quot;\n    Dim ModName As String\n    ModName = &quot;Combined_Module&quot;\n\n    Dim XLApp As Object\n    Set XLApp = CreateObject(&quot;Excel.Application&quot;)\n    With XLApp\n        .Application.Visible = True\n        .Application.DisplayAlerts = False\n        .UserControl = True\n    \n        Dim OpenedWb As Object\n        Set OpenedWb = .Workbooks.Open(Expath)\n    \n        .Run ModName\n    \n        OpenedWb.Close SaveChanges:=True\n    End With\n\n    XLApp.Quit\n    Set XLApp = Nothing\n    \n    'Change Cursor back and display finished message\n    Screen.MousePointer = 0\n\n    MsgBox (&quot;Price Update Finished - OK to Continue&quot;)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12017817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb41b3e50228a25a9db80d8e4257541?s=128&d=identicon&r=PG&f=1", "display_name": "PLL", "link": "https://stackoverflow.com/users/12017817/pll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 57782202, "answer_count": 1, "score": 1, "last_activity_date": 1567577765, "creation_date": 1567575530, "last_edit_date": 1567576367, "question_id": 57782087, "link": "https://stackoverflow.com/questions/57782087/how-to-fix-closing-excel-from-inside-access", "title": "How to fix closing Excel from inside Access", "body": "<p>I want to close an Excel workbook from inside Access using VBA code. The following code opens the workbook and runs a VBA module in the workbook correctly. Closing the workbook prompts with the standard Save dialogue which I want to avoid.</p>\n\n<p>I tried modifying the statement <code>.Workbooks.Close</code> to <code>.Workbooks.Close SaveChanges:=True</code> but that actually crashes the code.</p>\n\n<pre><code>Public Function Open_Share_Price_Excel()\n\n' Change Cursor to Hourglass\nScreen.MousePointer = 11\n\nDim Expath, ModName As String\nDim XLApp As Object\nSet XLApp = CreateObject(\"Excel.Application\")\n\n'\n'Define where the Excel Spreadsheet is and the module to run\n'\n\nExpath = \"C:\\Users\\peter\\Documents\\Financial Affairs\\Shares\\Share Price Bing.xlsm\"\nModName = \"Combined_Module\"\n\nWith XLApp\n    .Application.Visible = True\n    .Application.DisplayAlerts = False\n    .UserControl = True\n    .Workbooks.Open Expath\n    .Run ModName\n    .Workbooks.Close\nEnd With\n\nXLApp.Quit\nSet XLApp = Nothing\n\n'Change Cursor back and display finished message\n\nScreen.MousePointer = 0\nMsgBox (\"Price Update Finished - OK to Continue\")\n\nEnd Function\n</code></pre>\n\n<p>I tried modifying the statement <code>.Workbooks.Close</code> to <code>.Workbooks.Close SaveChanges:=True</code> but that actually crashes the code.</p>\n\n<p>Any suggestions welcome.</p>\n\n<p>Secondly, I would like to ensure that I close all the excel workbooks as I understand that the workbook Personal.xlsx may also be open. When I manually close the Excel spreadsheet it closes, but then EXcel immediately re-opens with a blank workbook.</p>\n\n<p>Help this newbie please</p>\n"}, {"tags": ["excel", "vba", "for-loop", "merge"], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 0, "last_activity_date": 1567572506, "creation_date": 1567572506, "answer_id": 57781661, "question_id": 57781529, "link": "https://stackoverflow.com/questions/57781529/merge-cells-in-vba-based-on-another-column/57781661#57781661", "title": "Merge cells in Vba based on another column", "body": "<ul>\n<li><p>You can use <code>Union</code> to create a range to merge before merging. Then use the function <code>Range.Merge</code> to merge them.</p></li>\n<li><p>This will work for a continuous range from <code>C6</code> as in the question. You can manipulate the code for your purpose.</p></li>\n</ul>\n\n<p><strong>Try this:</strong></p>\n\n<pre><code>Sub Mrg()\n\nDim consumerwb As Workbook\nDim CellSlct As Range, cel As Range\nSet consumerwb = Workbooks(\"Consumer_V2.xlsm\")\nconsumerwb.Activate\n\nSet CellSlct = Range(\"C6\").Offset(0, 3)\n\nFor Each cel In Range(\"C7:C\" &amp; Range(\"C6\").End(xlDown).row)\n\n    If cel.Value = cel.Offset(-1, 0).Value Then\n       Set CellSlct = Union(CellSlct, cel.Offset(0, 3))\n    Else\n        CellSlct.Merge\n        Set CellSlct = cel.Offset(0, 3)\n    End If\n\nNext\n\nCellSlct.Merge\n\nEnd Sub\n</code></pre>\n\n<p><strong>Demo:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/jcZp5.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jcZp5.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 3583822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38896b706f51d3c7a553574e3714b2f6?s=128&d=identicon&r=PG&f=1", "display_name": "user3583822", "link": "https://stackoverflow.com/users/3583822/user3583822"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 57781661, "answer_count": 1, "score": 0, "last_activity_date": 1567572746, "creation_date": 1567571556, "last_edit_date": 1567572746, "question_id": 57781529, "link": "https://stackoverflow.com/questions/57781529/merge-cells-in-vba-based-on-another-column", "title": "Merge cells in Vba based on another column", "body": "<p>I currently am automating tasks on a recurring Excel Dashboard. All the data fills out according to what I want but I hit a roadblock when it comes to formatting the said dashboard. \nThe idea would be to merge column F cells according to the values in <code>column C</code> cells. So far my code only merges the first 2 cells and the for loop keeps going without changing anything. </p>\n\n<p>I have tried both a <code>For Loop</code> and a <code>Do until Isempty</code> loop to no avail. </p>\n\n<pre><code>Dim consumerwb As Workbook\nDim CellSlct As Range, cell As Range\nSet consumerwb = Workbooks(\"Consumer_V2.xlsm\")\nconsumerwb.Activate\n\nSet CellSlct = Range(\"C6\").End(xlDown)\n\nMergeagain:\n\nOn Error Resume Next\n\nFor Each cell In CellSlct\n If cell.Value = cell.Offset(1, 0).Value And IsEmpty(cell) = False Then\n        Range(cell.Offset(0, 3), cell.Offset(1, 3)).Merge\n        GoTo Mergeagain\n End If  \nNext`\n</code></pre>\n\n<p>I want row <code>F</code> cells (empty) to be merged together according to the values of Row C:</p>\n\n<pre><code>C           D  E  F\ncustomer1   X  X  Cst1\ncustomer2   X  X  Cst2\ncustomer2   X  X  (Merged with above, this is where my code stops merging)\ncustomer2   X  X  (Merged with above)\ncustomer3   X  X  Cst3\ncustomer3   X  X  (Merged with above)\n</code></pre>\n\n<p>F column is completely empty, so far my code merges the first 2 reiterations of Customer2, stops working after that...</p>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 11500291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643d60c9b32975e8235a0ffd9bf996c3?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Casio", "link": "https://stackoverflow.com/users/11500291/carlos-casio"}, "edited": false, "score": 0, "creation_date": 1567609708, "post_id": 57781824, "comment_id": 102015733, "body": "Hello. It is not a shared mailbox, it&#39;s just another Outlook account. I.E. mail1@mail.com has categories &quot;red&quot;, &quot;blue&quot; and &quot;white&quot;, while mail2@mail.com has &quot;black&quot; and &quot;green&quot;. Whenever I populate combobox, it will always bring the 3 categories from mail 1. What I want is to be able to tell VBA which account to get the categories from."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 69, "user_id": 11500291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643d60c9b32975e8235a0ffd9bf996c3?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Casio", "link": "https://stackoverflow.com/users/11500291/carlos-casio"}, "edited": false, "score": 0, "creation_date": 1567613134, "post_id": 57781824, "comment_id": 102017569, "body": "OK, then you need to open the store that you need to retrieve categories from using the Namespace.Stores collection, call Store.GetDefaultFolder(olFolderCalendar), then use MAPIFolder.GetStorage to read the hidden message used to store the categories. Or you can use Redemotion and its RDOStore2.Categories collection."}, {"owner": {"reputation": 69, "user_id": 11500291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643d60c9b32975e8235a0ffd9bf996c3?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Casio", "link": "https://stackoverflow.com/users/11500291/carlos-casio"}, "edited": false, "score": 0, "creation_date": 1567723744, "post_id": 57781824, "comment_id": 102058771, "body": "Do you have any specific piece of code which I can use to accomplish that? I&#39;m not really used to VBA Outlook commands yet, still learning many things about it. Thank you"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 69, "user_id": 11500291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643d60c9b32975e8235a0ffd9bf996c3?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Casio", "link": "https://stackoverflow.com/users/11500291/carlos-casio"}, "edited": false, "score": 0, "creation_date": 1567740029, "post_id": 57781824, "comment_id": 102061619, "body": "I don&#39;t have ready to run code, sorry. What exactly are you having problems with?"}, {"owner": {"reputation": 69, "user_id": 11500291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643d60c9b32975e8235a0ffd9bf996c3?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Casio", "link": "https://stackoverflow.com/users/11500291/carlos-casio"}, "edited": false, "score": 0, "creation_date": 1567742420, "post_id": 57781824, "comment_id": 102062028, "body": "Where to insert the commands you typed into my code, where it should test if the account is the correct one and then extract categories from that account."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1567573742, "creation_date": 1567573742, "answer_id": 57781824, "question_id": 57781490, "link": "https://stackoverflow.com/questions/57781490/get-the-list-of-outlook-categories-from-specific-account/57781824#57781824", "title": "Get the list of Outlook Categories from specific Account", "body": "<p>Categories are stored in a hidden message with the message class of \"IPM.Configuration.CategoryList\" in the store's Calendar folder. You can see it in <a href=\"http://www.dimastr.com/outspy\" rel=\"nofollow noreferrer\">OutlookSpy</a> if you go to the shared Calendar folder and click the IMAPIFolder button, then go to the \"Associated Contents\" tab.</p>\n\n<p>That hidden message can be accessed using <code>MAPIFolder.GetStorage</code> in the Outlook Object Model.</p>\n\n<p>You can also access the Categories collection in <a href=\"http://www.dimastr.com/redemption\" rel=\"nofollow noreferrer\">Redemption</a> (I ma its author) using <a href=\"http://www.dimastr.com/redemption/rdocategories.htm\" rel=\"nofollow noreferrer\">RDOCategories</a> collection. Redemption exposes  categories both on the session level (<a href=\"http://www.dimastr.com/redemption/rdosession.htm\" rel=\"nofollow noreferrer\">RDOSession</a>.<code>Categories</code> from the default store) and on the store level (<a href=\"http://www.dimastr.com/redemption/rdostore.htm#RDOStore2\" rel=\"nofollow noreferrer\">RDOStore2</a>.<code>Categories</code>). A shared mailbox can be retrieved from the <code>RDOSession.Stores</code> collection (if it is already available in the profile) or opened using <code>RDOSession.GetSharedMailbox</code>.</p>\n"}], "owner": {"reputation": 69, "user_id": 11500291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643d60c9b32975e8235a0ffd9bf996c3?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Casio", "link": "https://stackoverflow.com/users/11500291/carlos-casio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586740743, "creation_date": 1567571277, "last_edit_date": 1586740743, "question_id": 57781490, "link": "https://stackoverflow.com/questions/57781490/get-the-list-of-outlook-categories-from-specific-account", "title": "Get the list of Outlook Categories from specific Account", "body": "<p>So I have the following code working, it is a UserForm and basically what it does here is to fill a ComboBox with each Category my Outlook Account has.</p>\n\n<p>However, it only works for main set-up account, and I can't find a way to make it get the categories from a previously selected account (with another combobox).\nThe code looks like this:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    Dim objNameSpace As NameSpace\n    Dim objCategory As Category\n    Dim strOutput As String\n\n    Set objNameSpace = Application.GetNamespace(\"MAPI\")\n        If objNameSpace.Categories.Count &gt; 0 Then\n            For Each objCategory In objNameSpace.Categories\n                strOutput = objCategory.Name    \n        With Me.ChosenCategory\n        .AddItem (strOutput)\n        End With     \n            Next    \n        With Me.ChosenCategory\n        .AddItem (\"Clear Category\")\n        End With\n\n        End If\n\nEnd Sub\n</code></pre>\n\n<p>Does anyone know how to specify first which Account do I want it to get the categories from? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1567564433, "post_id": 57780740, "comment_id": 101995977, "body": "You can use <code>WorksheetFunction.WorkDay</code> to get the previous work day. There may be better examples of its use but here is <a href=\"https://stackoverflow.com/questions/49512481/vba-if-previous-day-is-a-bank-holiday-open-file-from-previous-working-day\">one question</a> that could be helpful."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11796668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9d9d04a2bd37462788e71318b9cb4c0?s=128&d=identicon&r=PG&f=1", "display_name": "Xkluah89", "link": "https://stackoverflow.com/users/11796668/xkluah89"}, "edited": false, "score": 0, "creation_date": 1567565277, "post_id": 57780809, "comment_id": 101996110, "body": "does this work for working days? For example Monday-1 being previous Friday"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1567565382, "post_id": 57780809, "comment_id": 101996127, "body": "That assumes everyone works monday to friday, and not everyone does."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1567567782, "post_id": 57780809, "comment_id": 101996502, "body": "Ideally, I would make the -1 a variable that decreases in a loop to determine a filename to check for, and go back 7 days. That would find the &quot;most recent previous day worked&quot; file, if one exists. Check for yesterday, if found, use that, if not found, check for a file the day before that... and so on..."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 0, "last_activity_date": 1567571247, "last_edit_date": 1567571247, "creation_date": 1567564907, "answer_id": 57780809, "question_id": 57780740, "link": "https://stackoverflow.com/questions/57780740/how-to-open-file-with-yesterdays-workday-in-title/57780809#57780809", "title": "how to open file with yesterday&#39;s workday in title", "body": "<p>You can use the <code>DateAdd</code> function in VBA to subtract a day, like this:</p>\n\n<pre><code>sFilename = \"\\\\y:cash \" &amp; Format(DateAdd(\"d\", -1, Date), \"dd\") &amp; Format(Date, \"mm\") &amp; Right(Year(Date), 2) &amp; \".xlsx\"\n</code></pre>\n\n<p>And you dont need the CStr function, as the format and right functions already return strings.</p>\n\n<p>But what about the first day of the month? \nIt would be better to do it like this:</p>\n\n<pre><code>sFilename = \"\\\\y:cash \" &amp; Format(DateAdd(\"d\", -1, Date), \"ddmmyy\") &amp; \".xlsx\"\n</code></pre>\n\n<p>Alternatively, you can have a function that would return an empty string if no file was found, or return the filename of the most recent file based on your criteria, like this:</p>\n\n<pre><code>Public Function GetMostRecentFileByDate(dtStart As Date, sPath As String, sPrefix As String, sExt As String, sFormat As String) As String\n  Dim nDay As Integer\n  Dim sFilename As String\n  Dim dtDate As Date\n  Dim sFull As String\n\n  dtDate = dtStart\n  For nDay = -1 To -7 Step -1\n    sFilename = sPrefix &amp; Format(dtDate, sFormat) &amp; \".\" &amp; sExt\n    sFull = sPath &amp; \"\\\" &amp; sFilename\n    If Dir(sFull) &lt;&gt; \"\" Then\n      GetMostRecentFileByDate = sFull\n      Exit Function\n    End If\n    dtDate = DateAdd(\"d\", -1, dtDate)\n  Next\n\nEnd Function\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>sFullName = GetMostRecentFileByDate(\"03 Sept 2019\", \"\\\\y:\", \"cash \", \"xlsx\", \"ddmmyy\")\nIf sFullName &lt;&gt; \"\" Then\n  ' Do Something With It\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11796668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9d9d04a2bd37462788e71318b9cb4c0?s=128&d=identicon&r=PG&f=1", "display_name": "Xkluah89", "link": "https://stackoverflow.com/users/11796668/xkluah89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 57780809, "answer_count": 1, "score": 0, "last_activity_date": 1567571247, "creation_date": 1567564274, "last_edit_date": 1567564482, "question_id": 57780740, "link": "https://stackoverflow.com/questions/57780740/how-to-open-file-with-yesterdays-workday-in-title", "title": "how to open file with yesterday&#39;s workday in title", "body": "<p>i need to open a file with yesterday's workday in the title and i have no idea how to do it.</p>\n\n<p>Eg Monday (2nd sep) today, open Friday's (30th Aug) spreadsheet.</p>\n\n<p>The spreadsheet title is a follows - \"cash 300819\"</p>\n\n<p>I have tried the following code but doesnt seem to work</p>\n\n<pre><code>Dim wbO As Workbook, wbN As Workbook\n\nSet wbO = ActiveWorkbook\nSet wbN = Workbooks.Open(\"\\\\y:cash \" &amp; Format(CStr(Date)-1, \"dd\") &amp; CStr(Format(Date, \"mm\")) &amp; Right(CStr(Year(Date)), 4) &amp; \".xlsx\")\n\n</code></pre>\n\n<p>It will open previous working day's spreadsheet properly</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1567570256, "post_id": 57780709, "comment_id": 101996905, "body": "Where do you declare <code>newrow</code>? I assume that&#39;s a range? And then <code>newrow.range(1)</code> would be the ...first cell?"}, {"owner": {"reputation": 5, "user_id": 11992104, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KWllaTZdRR8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdONkhizdDMMtebs91ZTPduygRhkA/photo.jpg?sz=128", "display_name": "Kao BeHappy", "link": "https://stackoverflow.com/users/11992104/kao-behappy"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1567571643, "post_id": 57780709, "comment_id": 101997163, "body": "Yes, but when data not include in M4 and N5 then I click the button , The column will have empty cell in Column D and E. How to do empty cell will not happen when I click button?"}], "answers": [{"tags": [], "owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "is_accepted": true, "score": 0, "last_activity_date": 1567572821, "creation_date": 1567572821, "answer_id": 57781704, "question_id": 57780709, "link": "https://stackoverflow.com/questions/57780709/how-to-fix-the-code-empty-cell-when-click-the-button-to-input-data/57781704#57781704", "title": "How to fix the code empty cell when click the button to input data", "body": "<pre><code>Private Sub CommandButton1_Click()\n\nDim wks As Worksheet\nDim i As Long, j As Long\nSet wks = Worksheets(\"Sheet1\")\n\nSet AddNew1 = wks.Range(\"M65356\").End(xlUp).Offset(40, 0)\nSet AddNew2 = wks.Range(\"M65356\").End(xlUp).Offset(0, 0)\n\nIf wks.Range(\"M4\") &lt;&gt; \"\" And wks.Range(\"N4\") &lt;&gt; \"\" Then\n\n    Set newrow = wks.ListObjects(\"List\").ListRows.Add\n\n    With newrow\n        .Range(1) = wks.Range(\"M4\")\n        .Range(2) = wks.Range(\"N4\")\n\n    End With\n\n\n\n    For i = 1 To 2\n\n    AddNew1.Cells(i, j) = wks.Range(\"M4\").Cells(i, j)\n\n    Next i\n\n\n    wks.Range(\"M4:Q8\") = \"\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1567574672, "post_id": 57781889, "comment_id": 101997816, "body": "Anyhow, AddNew1 and AddNew2 should be defined as Range, newrow as ListRow, i and j as Long and ListRow.Range will not work. Could you give a little bit more information regarding what is your data an expected results?"}], "tags": [], "owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "is_accepted": false, "score": 0, "last_activity_date": 1567574185, "creation_date": 1567574185, "answer_id": 57781889, "question_id": 57780709, "link": "https://stackoverflow.com/questions/57780709/how-to-fix-the-code-empty-cell-when-click-the-button-to-input-data/57781889#57781889", "title": "How to fix the code empty cell when click the button to input data", "body": "<p>There is no a clear question... I will just assume (Sorry, I can not make comments)\nI am assuming that you are trying to introduce whatever data you have on M4-N4 Cells to your Range AddNew1. So try this.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim wks As Worksheet\nDim i As Long\n\nSet wks = Worksheets(1)\n\nFor i = 1 To 2\n    wks.Cells(65356 + i, 13).Value2 = wks.Cells(4, 12 + i).Value2\nNext i\n\nWith wks\n    Range(\"M4:Q8\").Value2 = \"\"\nEnd With\n</code></pre>\n\n<p>If you are trying to keep the information with the same setup (M and N columns)</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim wks As Worksheet\nDim i As Long\n\nSet wks = Worksheets(1)\n\n\nwks.Cells(65356 , 13).Value2 = wks.Cells(4, 13).Value2\nwks.Cells(65356 , 14).Value2 = wks.Cells(4, 14).Value2\n\n\nWith wks\n    Range(\"M4:Q8\").Value2 = \"\"\nEnd With\n</code></pre>\n\n<p>If you are not interested to copy empty cells, place a condition.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim wks As Worksheet\nDim i As Long\n\nSet wks = Worksheets(1)\n\nIf (wks.Cells(4, 13).Value2 &lt;&gt; \"\") &amp; (wks.Cells(4, 14).Value2 &lt;&gt; \"\") Then\n    wks.Cells(65356 , 13).Value2 = wks.Cells(4, 13).Value2\n    wks.Cells(65356 , 14).Value2 = wks.Cells(4, 14).Value2\nEnd If\n\nWith wks\n    Range(\"M4:Q8\").Value2 = \"\"\nEnd With\n</code></pre>\n\n<p>Hope it helps</p>\n"}], "owner": {"reputation": 5, "user_id": 11992104, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KWllaTZdRR8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdONkhizdDMMtebs91ZTPduygRhkA/photo.jpg?sz=128", "display_name": "Kao BeHappy", "link": "https://stackoverflow.com/users/11992104/kao-behappy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 57781704, "answer_count": 2, "score": 0, "last_activity_date": 1567574185, "creation_date": 1567563839, "last_edit_date": 1567568021, "question_id": 57780709, "link": "https://stackoverflow.com/questions/57780709/how-to-fix-the-code-empty-cell-when-click-the-button-to-input-data", "title": "How to fix the code empty cell when click the button to input data", "body": "<p>When I click the button to input data while data is blank. The 'blank' input data will be added to the table and on the output table, it will appears as a blank row. How can I fix this problem? If I only want just value or text that the user input to appear in the output table.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim wks As Worksheet\nDim i As Long, j As Long\nSet wks = Worksheets(\"Sheet1\")\n\nSet AddNew1 = wks.Range(\"M65356\").End(xlUp).Offset(40, 0)\nSet AddNew2 = wks.Range(\"M65356\").End(xlUp).Offset(0, 0)\n\nSet newrow = wks.ListObjects(\"List\").ListRows.Add\n\nWith newrow\n    .Range(1) = wks.Range(\"M4\")\n    .Range(2) = wks.Range(\"N4\")\n\nEnd With\n\n\n\nFor i = 1 To 2\n\nAddNew1.Cells(i, j) = wks.Range(\"M4\").Cells(i, j)\n\nNext i\n\n\nwks.Range(\"M4:Q8\") = \"\"\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/GMdqM.png\" rel=\"nofollow noreferrer\">Sample</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1567564558, "post_id": 57780696, "comment_id": 101995994, "body": "You need to qualify the worksheet that <code>Rows(i)</code> is on. Where exactly should it be pasted (why do you have <code>D:D</code>?) Then use <code>.Cells</code> instead of <code>.Range</code> in <code>Range(&quot;i,1&quot;)</code> (and lose the quotes)."}, {"owner": {"reputation": 1, "user_id": 12017244, "user_type": "registered", "profile_image": "https://graph.facebook.com/3127709863936663/picture?type=large", "display_name": "G&#252;nther Schatz", "link": "https://stackoverflow.com/users/12017244/g%c3%bcnther-schatz"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1567582938, "post_id": 57780696, "comment_id": 102001020, "body": "i want to paste it on column D in a different sheet. can you help me with you code, they way you understood the problem posed ?? thanks"}], "owner": {"reputation": 1, "user_id": 12017244, "user_type": "registered", "profile_image": "https://graph.facebook.com/3127709863936663/picture?type=large", "display_name": "G&#252;nther Schatz", "link": "https://stackoverflow.com/users/12017244/g%c3%bcnther-schatz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567564681, "creation_date": 1567563691, "last_edit_date": 1567564681, "question_id": 57780696, "link": "https://stackoverflow.com/questions/57780696/comparing-values-in-cells-from-a-sheet-to-find-identical-values-i-a-different-co", "title": "comparing values in cells from a sheet to find identical values i a different column in a different sheet", "body": "<p>If the values in columns 1 and 2 are the same in columns A and B the copy corresponding value of column 3 and paste in column C .removing duplicates then pasting the values.</p>\n\n<pre><code>Sub copyCurrentStatus()\n    Dim i As Long\n    Dim LastRow As Long\n\n    LastRow = Cells(Rows.Count, 2).End(xlUp).Row\n        For i = LastRow To 2 Step -1\n\n            'If Worksheets(\"Sending List\").Range(\"C:C\").Value = Worksheets(\"P13 D-Chain Status\").Range(\"A:A\").Value Then\n             If Worksheets(\"Sending List\").Cells(i, 1).Value = Worksheets(\"P13 D-Chain Status\").Range(\"i,1\").Value Then\n\n               'Copy Sales Organization\n                Rows(i).Copy\n                Worksheets(\"Sending List\").Range(\"D:D\").PasteSpecial\n\n            End If\n        Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1567564896, "post_id": 57780085, "comment_id": 101996050, "body": "What version of Excel? You may be able to use Power Query."}, {"owner": {"reputation": 1, "user_id": 6403591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31fb851288cf522a8610b074d5e7c87c?s=128&d=identicon&r=PG&f=1", "display_name": "C MIN", "link": "https://stackoverflow.com/users/6403591/c-min"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1567639830, "post_id": 57780085, "comment_id": 102026370, "body": "i don&#39;t have power query. I have 2010 excel"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1567642255, "post_id": 57780085, "comment_id": 102026795, "body": "Power Query is (according to <a href=\"https://support.office.com/en-us/article/power-query-overview-and-learning-ed614c81-4b00-4291-bd3a-55d80767f81d\" rel=\"nofollow noreferrer\">this link</a>) available to download for Excel 2010."}, {"owner": {"reputation": 1, "user_id": 6403591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31fb851288cf522a8610b074d5e7c87c?s=128&d=identicon&r=PG&f=1", "display_name": "C MIN", "link": "https://stackoverflow.com/users/6403591/c-min"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1567642541, "post_id": 57780085, "comment_id": 102026850, "body": "thanks ben. i&#39;ve now downloaded it however when i import the file how do i import it to the conditions that i set in my inquiry?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1567643083, "post_id": 57780085, "comment_id": 102026943, "body": "I think <a href=\"https://support.office.com/en-us/article/import-data-from-external-data-sources-power-query-be4330b3-5356-486c-a168-b68e9e616f5a\" rel=\"nofollow noreferrer\">this page</a> might be helpful."}, {"owner": {"reputation": 1, "user_id": 6403591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31fb851288cf522a8610b074d5e7c87c?s=128&d=identicon&r=PG&f=1", "display_name": "C MIN", "link": "https://stackoverflow.com/users/6403591/c-min"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1567643704, "post_id": 57780085, "comment_id": 102027043, "body": "thanks ben, i have been on this site which help me import it but would you know how to automate this query?"}], "owner": {"reputation": 1, "user_id": 6403591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31fb851288cf522a8610b074d5e7c87c?s=128&d=identicon&r=PG&f=1", "display_name": "C MIN", "link": "https://stackoverflow.com/users/6403591/c-min"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567569974, "creation_date": 1567556741, "last_edit_date": 1567569974, "question_id": 57780085, "link": "https://stackoverflow.com/questions/57780085/is-there-a-way-i-can-import-data-from-an-external-worksheet-into-the-working-she", "title": "Is there a way i can import data from an external worksheet into the working sheet but import only a specific set of data", "body": "<p>I have created a worksheet with column headings that match the same as the column headings of the worksheet i want to import. I only want to import the data from the imported worksheet that match the column headings of the worksheet i'm working on. For example i have 'supplier', 'SMA', and 'SKU' and i only want to import the data with those headings from the import sheet into the active worksheet</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1567552285, "post_id": 57779467, "comment_id": 101994106, "body": "Try <code>Me.Form.RecordSet = queryDef.OpenRecordset()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11464238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/915d43f90bd2496c20e5e1fc9dab5031?s=128&d=identicon&r=PG&f=1", "display_name": "Racma", "link": "https://stackoverflow.com/users/11464238/racma"}, "edited": false, "score": 0, "creation_date": 1567587801, "post_id": 57779673, "comment_id": 102003510, "body": "thank you very much! But why complex queries aren&#39;t working with the second choise ( = strSQL). Like it works with queries from one table but not with joins. It saying something as <i>can&#39; t find ...\\table\\ .mdb</i>"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1567588114, "post_id": 57779673, "comment_id": 102003679, "body": "Error in sql statement for sure. <code>Debug.Print strSQL</code> before assigining to recordsource and copy and paste the string into a new query (sql-view). This will show you the error when you try datasheet-view."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1567588671, "post_id": 57779673, "comment_id": 102004001, "body": "<i>Avoid the multiple usage ofCurrentDb,store it in a variable. Everytime it is used, a new copy of the database-instance is created, what consumes unnecessary resources.</i> :O never heard of that, but it&#39;s very interesting. Any source or documentation I can learn more about it?"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1567589027, "post_id": 57779673, "comment_id": 102004216, "body": "@FoxfireAndBurnsAndBurns Read <a href=\"https://sourcedaddy.com/ms-access/the-currentdb-function.html\" rel=\"nofollow noreferrer\">The CurrentDb() Function</a>. Never failed on a tabledef (missing parent)?.Use it in loop and compare execution time to stored reference. I always use the <code>CurrentDbC</code>property, as shown in link."}], "tags": [], "owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "is_accepted": false, "score": 1, "last_activity_date": 1567589944, "last_edit_date": 1567589944, "creation_date": 1567552298, "answer_id": 57779673, "question_id": 57779467, "link": "https://stackoverflow.com/questions/57779467/query-results-on-access-form-vba/57779673#57779673", "title": "Query results on Access form (VBA)", "body": "<p>You just mix up the forms recordsource and the forms recordset.</p>\n\n<p>The recordsource<code>Me.RecordSource</code>is a string, that contains a table/query-name or a sql select statement.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Me.RecordSource = strSQL\n</code></pre>\n\n<p>A recordset is an object. Because of that, it has to be set</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set Me.RecordSet = queryDef.OpenRecordSet\n</code></pre>\n\n<p>Avoid the multiple usage of<code>CurrentDb</code>,store it in a variable.</p>\n\n<p>Everytime it is used, a new copy of the database-instance (usually<code>DbEngine(0).Workspace(0)</code>) is created, what consumes unnecessary resources.</p>\n\n<p>Some useful links on that topic:</p>\n\n<ul>\n<li><p><a href=\"https://sourcedaddy.com/ms-access/the-currentdb-function.html\" rel=\"nofollow noreferrer\">The CurrentDb() Function</a></p></li>\n<li><p><a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/7ea9506f-5e91-4896-80b9-6712762388ea/currentdbtabledefs-vs-dbtabledefs-object-invalid-or-not-set-error?forum=accessdev\" rel=\"nofollow noreferrer\">CurrentDB.TableDefs vs db.TableDefs ... Object Invalid or Not Set Error</a></p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/1833746/ms-access-is-there-a-significant-overhead-when-using-currentdb-as-opposed-to-db\">MS Access: Is there a significant overhead when using CurrentDB as opposed to DBEngine(0)(0)?</a></p></li>\n</ul>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_Open(Cancel As Integer)\n    Dim db as DAO.Database\n    Dim strSQL As String, queryDef As DAO.queryDef\n    strSQL = \" *SELECT etc...* \"\n    Set db = CurrentDb\n\n    Set queryDef = db.CreateQueryDef(vbNullString, strSQL) ' vbNullstring is \"\" but typo-safe. If you create a querydef with an empty name, it is just temporary and will get lost after querydef is terminated\n    Set Me.RecordSet = queryDef.OpenRecordset() \n</code></pre>\n\n<p>Or just using the recordsource:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_Open(Cancel As Integer)\n    Dim strSQL As String\n    strSQL = \" *SELECT etc...* \"\n    Me.RecordSource = strSQL \n\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11464238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/915d43f90bd2496c20e5e1fc9dab5031?s=128&d=identicon&r=PG&f=1", "display_name": "Racma", "link": "https://stackoverflow.com/users/11464238/racma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567589944, "creation_date": 1567550085, "last_edit_date": 1567562245, "question_id": 57779467, "link": "https://stackoverflow.com/questions/57779467/query-results-on-access-form-vba", "title": "Query results on Access form (VBA)", "body": "<p>I am doing an Access project as a newbie and i am facing some problems (<strong>have to do all in VBA</strong>). In few words i have to show a query results on a form. I have few text boxes and i need to show some info. I understood that i have to change the RecordSource to the form and that i have to set the RecordSet for each text-box. Here is my code but is not working:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code> Private Sub Form_open(Cancel As Integer)\n    Dim strSQL As String, queryDef As DAO.queryDef\n    strSQL = \" *SELECT etc...* \"\n    CurrentDb.QueryDefs.Delete \"Info\"\n    Set queryDef = CurrentDb.CreateQueryDef(\"Info\", strSQL)\n    Me.RecordSource = queryDef.OpenRecordset() '**error here type mismatch\n</code></pre>\n\n<p>How can i change my RecordSource to a query that is created when open the form? \n(Tried already with <code>Me.RecordSet = strSQL</code> but is not working with INNER JOIN)<br>\nThank you a lot! </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12016827, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211788426545853/picture?type=large", "display_name": "Marcelo Carlos Torino Ribeiro", "link": "https://stackoverflow.com/users/12016827/marcelo-carlos-torino-ribeiro"}, "edited": false, "score": 0, "creation_date": 1567655737, "post_id": 57779456, "comment_id": 102029032, "body": "Dear Tevlyn, thanks for your suggestion and time but unfortunately it didn&#39;t work. I thank you again anyway."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 1, "user_id": 12016827, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211788426545853/picture?type=large", "display_name": "Marcelo Carlos Torino Ribeiro", "link": "https://stackoverflow.com/users/12016827/marcelo-carlos-torino-ribeiro"}, "edited": false, "score": 1, "creation_date": 1567656255, "post_id": 57779456, "comment_id": 102029129, "body": "What did not work? Did you get an error? What code exactly did you use? What condition?"}, {"owner": {"reputation": 1, "user_id": 12016827, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211788426545853/picture?type=large", "display_name": "Marcelo Carlos Torino Ribeiro", "link": "https://stackoverflow.com/users/12016827/marcelo-carlos-torino-ribeiro"}, "edited": false, "score": 0, "creation_date": 1567760627, "post_id": 57779456, "comment_id": 102068165, "body": "Dear Tevlyn, I believe it is better if I send you the sheet and explain what I need, ok? I will  do it later as I am writing from Brazil, 6:00 AM right now."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1567549942, "creation_date": 1567549942, "answer_id": 57779456, "question_id": 57779266, "link": "https://stackoverflow.com/questions/57779266/how-to-create-a-if-command-via-vba-to-sound-a-sentence/57779456#57779456", "title": "How to create a IF command, via VBA, to sound a sentence?", "body": "<p>Something like this maybe? You can use other conditions, of course.</p>\n\n<pre><code>Sub test()\nIf 1 = 1 Then\n    Application.Speech.Speak (\"hello world\")\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12016827, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211788426545853/picture?type=large", "display_name": "Marcelo Carlos Torino Ribeiro", "link": "https://stackoverflow.com/users/12016827/marcelo-carlos-torino-ribeiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "closed_date": 1568485716, "answer_count": 1, "score": -1, "last_activity_date": 1567887291, "creation_date": 1567548397, "last_edit_date": 1567679107, "question_id": 57779266, "link": "https://stackoverflow.com/questions/57779266/how-to-create-a-if-command-via-vba-to-sound-a-sentence", "closed_reason": "Needs more focus", "title": "How to create a IF command, via VBA, to sound a sentence?", "body": "<p>I am trying to create, via VBA, an \"IF\" command which would sound an specifc sentence when a pre determined condition is reached. Could you help me, please?</p>\n\n<p>The only thing I know is that I need to use the \"application.speech.speak\" command. That is it.\nPS: dear forum friends, as I am testing a suggested sent solution I ask you to wait a little while to see if it will work, avoiding taking your time. Thank you all.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1567547197, "post_id": 57779041, "comment_id": 101993083, "body": "Change <code>22 &#47; 9 &#47; 2019</code> to <code>CDate(&quot;22&#47;9&#47;2019&quot;)</code> - your code is just diving 22 by 9 by 2019."}], "answers": [{"tags": [], "owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "is_accepted": false, "score": 1, "last_activity_date": 1567615955, "last_edit_date": 1567615955, "creation_date": 1567548563, "answer_id": 57779294, "question_id": 57779041, "link": "https://stackoverflow.com/questions/57779041/excel-vba-macro-error-400-for-emailing-current-worksheet/57779294#57779294", "title": "Excel Vba Macro Error 400 For Emailing Current Worksheet", "body": "<p>You need to put your ranges in quotations <code>(\"A1\")</code>and <code>(\"C15\")</code> as well as make your <code>22 / 9 / 2019</code> to  <code>\"22/9/2019\"</code>.</p>\n\n<p>Also, you don't want to <code>set Range(\"C15\").value</code> just change the value.</p>\n\n<pre><code>Sub Send_Email()\n\n    Dim outlookApp As Object\n    Dim outlookMail As Object\n    Set outlookApp = CreateObject(\"Outlook.Application\")\n    Set outlookMail = outlookApp.CreateItem(0)\n\n        If Range(\"A1\").Value = \"22/9/2019\" And Range(\"C15\").Value = 1 Then\n\n            With outlookMail\n                .To = \"example@email.com\"\n                .Subject = \"Weekly Timetable\"\n                .BodyFormat = 2\n                .HTMLBody = \"&lt;p&gt;This is your schedule for the week&lt;/p&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;p&gt;Aaron&lt;/p&gt;\"\n                .Attachments.Add ActiveWorkbook.FullName\n                .Importance = 1\n                .Send\n            End With\n\n            Range(\"C15\").Value = 3   'changes value to 3 to change condition\n\n        End If\n\n    Set outlookMail = Nothing\n    Set outlookApp = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12016712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfa4d7447b795f53d684ca8b437cc670?s=128&d=identicon&r=PG&f=1", "display_name": "aaronhughes", "link": "https://stackoverflow.com/users/12016712/aaronhughes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1567615955, "creation_date": 1567546650, "question_id": 57779041, "link": "https://stackoverflow.com/questions/57779041/excel-vba-macro-error-400-for-emailing-current-worksheet", "title": "Excel Vba Macro Error 400 For Emailing Current Worksheet", "body": "<p>New-ish to creating macros for excel and cannot get any clarity on why the code I have written is giving an Error 400.</p>\n\n<pre><code>Sub Send_Email()\n\n    Dim outlookApp As Object\n    Dim outlookMail As Object\n\n    If Range(A1).Value = 22 / 9 / 2019 Then   'cell A1 has =TODAY() method\n\n        If Range(C15).Value = 1 Then   'cell C15 has conditional formatting\n\n            Set outlookApp = CreateObject(\"Outlook.Application\")\n            Set outlookMail = outlookApp.CreateItem(0)\n\n            With outlookMail\n                .To = \"example@email.com\"\n                .Subject = \"Weekly Timetable\"\n                .BodyFormat = 2\n                .HTMLBody = \"&lt;p&gt;This is your schedule for the week&lt;/p&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;p&gt;Aaron&lt;/p&gt;\"\n                .Attachments.Add ActiveWorkbook.FullName\n                .Importance = 1\n                .Send\n            End With\n\n            Set Range(C15).Value = 3   'changes value to 3 to change condition\n\n        End If\n\n    End If\n\n    Set outlookMail = Nothing\n    Set outlookApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Expected result is that if the date in A1 is 22/09/2019 and C15 contains value 1 that the email will be formed and sent to the email(changed for purpose of this question) of the \".To\" property and then the value in C15 to be changed to prevent duplicate emails. If any can help it will be much appreciated! Thanks.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1567546577, "post_id": 57778948, "comment_id": 101992899, "body": "You dont need to use the word <code>Call</code> to call a subroutine, so you can take those out. Also, what is the value of <code>Comittee</code> when you step through it? Also, you should add <code>Option Explicit</code> before any of the routines (at the top of the module) and make sure all of your variables are declared."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 3, "creation_date": 1567547367, "post_id": 57778948, "comment_id": 101993124, "body": "Also, look into using <code>Select Case</code> instead of your nested <code>If</code> statements. It will be much cleaner."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1567555766, "post_id": 57778948, "comment_id": 101994624, "body": "Where is the diff between the subs (IM, CDO, CFO, ...)?  Seems like you can create one sub and pass commitee as argument."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1567557667, "post_id": 57778948, "comment_id": 101994926, "body": "in addition to above comments, seems like <code>Begin_Click</code> contains a lot of declarations and variable setting that are never used in the module. get rid of that. it only serves to confuse. (if you removed some of the code in the module for posting purpose, than ignore this comment)."}], "owner": {"reputation": 23, "user_id": 11968527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8729c133a92fdc81e1050198e90d5af6?s=128&d=identicon&r=PG&f=1", "display_name": "Ethan ", "link": "https://stackoverflow.com/users/11968527/ethan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1567547522, "creation_date": 1567546080, "last_edit_date": 1567547522, "question_id": 57778948, "link": "https://stackoverflow.com/questions/57778948/i-am-having-issues-using-a-call-function", "title": "I am having issues using a call function", "body": "<p>I have watched many videos on calling another sub. But with my code every time it gets to the line where it should call the function. It just finished the IF statement without following this command. Please note that this code is from a commandbutton inside of a userforum</p>\n\n<pre><code>Sub Begin_Click()\n\nUnload BeginTheCode\n\nDim ws As Worksheet\nDim strDataRange As Range\nDim keyRange As Range\nDim wbk As Workbook\nDim wbkName As String\nDim wsName As String\nDim mName As String\nDim yName As String\nDim cName As String\n\nOn Error GoTo Err\n\n'This command puts the other code in this workbook on hold'\nApplication.DisplayAlerts = False\n\n'This provides shortcuts for future use in the code'\n    Set wa = ThisWorkbook.Worksheets(\"RE-I-A Raw\")\n    Set wb = ThisWorkbook.Worksheets(\"I-A Data Copy (1)\")\n    Set wc = ThisWorkbook.Worksheets(\"Untied Raw\")\n    Set wd = ThisWorkbook.Worksheets(\"Blanks\")\n\nDim IMRCCSpec() As String\nDim IMRSup() As String\nDim x As Integer\nDim y As Integer\nDim i As Integer\n\nIf Comittee = \"IMRCC\" Then\n    Call IM\n    Else\n    If Comittee = \"COO\" Then\n        Call COO\n        Else\n        If Comittee = \"CFO\" Then\n            Call CFO\n            Else\n            If Comittee = \"AURA\" Then\n                Call AURA\n                Else\n                If Comittee = \"Distribution\" Then\n                    Call Dist\n                    Else\n                    If Comittee = \"Legal\" Then\n                        Call Legal\n                    End If\n                End If\n            End If\n        End If\n    End If\nEnd If\n\nExit Sub\nErr:\nMsgBox \"Error on Line : Sub Begin_Click() \" &amp; Erl\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub IM()\n\n   On Error GoTo Err\n   Dim IMRCCSpec() As String\n   Dim IMRSup() As String\n   Dim x As Integer\n   Dim y As Integer\n   x = Application.WorksheetFunction.CountA(wt.Range(\"C:C\")) - 2\n   y = Application.WorksheetFunction.CountA(wt.Range(\"E:E\")) - 2\n   ReDim IMRCCSpec(x) As String\n   ReDim IMRCCSup(y) As String\n   Dim i As Integer\n\n   For i = 0 To x\n       IMRCCSpec(i) = wt.Range(\"A\" &amp; i + 2)\n   Next i\n   For i = 0 To y\n       IMRCCSup(i) = wt.Range(\"B\" &amp; i + 2)\n   Next i\n\n   'Call Something\n\nExit Sub\n\nErr:\nMsgBox \"Error on Line : Sub IM()\" &amp; Erl\n\nEnd Sub\n</code></pre>\n\n<p>No error messages occur. when I use the F8 command it goes through this line without any error and does not do anything</p>\n"}, {"tags": ["json", "excel", "vba", "api", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12016569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ed3f9cf43c1fe49350720a32a0fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Great Unknown", "link": "https://stackoverflow.com/users/12016569/great-unknown"}, "edited": false, "score": 0, "creation_date": 1567625619, "post_id": 57781255, "comment_id": 102022655, "body": "Thanks QHarr, it works like a champ! Now I just need to figure out how to pull in the current employer name, CRD# and address on the individual by state vba code"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 12016569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ed3f9cf43c1fe49350720a32a0fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Great Unknown", "link": "https://stackoverflow.com/users/12016569/great-unknown"}, "edited": false, "score": 0, "creation_date": 1567625758, "post_id": 57781255, "comment_id": 102022713, "body": "Note that, IIRC, from prior answer I gave to question on zip code search, there can be more than 1 current employer. So how are you planning on handling that? You\u2019ll need to examine some of the data - I give links to Json in this answer and my prior. Decide what assumptions need to be made and desired output format."}, {"owner": {"reputation": 21, "user_id": 12016569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ed3f9cf43c1fe49350720a32a0fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Great Unknown", "link": "https://stackoverflow.com/users/12016569/great-unknown"}, "edited": false, "score": 0, "creation_date": 1567628581, "post_id": 57781255, "comment_id": 102023444, "body": "Thanks Qharr! I&#39;ve looked at the json data and I just want to pull in the info for the first current employer. firm_id, firm_name, branch_city, branch_state &amp; branch_zip from the 1st inner hit."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 12016569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ed3f9cf43c1fe49350720a32a0fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Great Unknown", "link": "https://stackoverflow.com/users/12016569/great-unknown"}, "edited": false, "score": 0, "creation_date": 1567628742, "post_id": 57781255, "comment_id": 102023514, "body": "Please indicate the final headers then for indiv by state.... I presume the headers you have just mentioned plus? CRD Number Indiv.... + ......."}, {"owner": {"reputation": 21, "user_id": 12016569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ed3f9cf43c1fe49350720a32a0fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Great Unknown", "link": "https://stackoverflow.com/users/12016569/great-unknown"}, "edited": false, "score": 0, "creation_date": 1567629039, "post_id": 57781255, "comment_id": 102023621, "body": "So i would like to keep the current headers for CRD Number, Indiv Name, FINRA registered, Disclosures, In industry since, current employer firm ID, current employer firm name, current employer city, current employer state, current employer zip. Really appreciate the help!!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 12016569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ed3f9cf43c1fe49350720a32a0fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Great Unknown", "link": "https://stackoverflow.com/users/12016569/great-unknown"}, "edited": false, "score": 0, "creation_date": 1567629090, "post_id": 57781255, "comment_id": 102023645, "body": "m&#39;kay....I will have a look quickly now."}, {"owner": {"reputation": 21, "user_id": 12016569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ed3f9cf43c1fe49350720a32a0fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Great Unknown", "link": "https://stackoverflow.com/users/12016569/great-unknown"}, "edited": false, "score": 0, "creation_date": 1567630965, "post_id": 57781255, "comment_id": 102024318, "body": "Thanks @Qharr, it&#39;s perfect!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 12016569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ed3f9cf43c1fe49350720a32a0fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Great Unknown", "link": "https://stackoverflow.com/users/12016569/great-unknown"}, "edited": false, "score": 0, "creation_date": 1567630994, "post_id": 57781255, "comment_id": 102024331, "body": "you are most welcome :-)"}, {"owner": {"reputation": 21, "user_id": 12016569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ed3f9cf43c1fe49350720a32a0fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Great Unknown", "link": "https://stackoverflow.com/users/12016569/great-unknown"}, "edited": false, "score": 0, "creation_date": 1568387380, "post_id": 57781255, "comment_id": 102269873, "body": "Hi @Qharr! Your previous solution was great!! Is there a way to automate or change the individual by state program to pull in a list of first names and last names or first name, last name &amp; state or zipcode to run the api queries for that list and return the results for the names in the list? So there would be a separate file that contains the list of names to be queried against the site and that list needs to be pulled into the program variably to return the query results for those names/records."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 12016569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ed3f9cf43c1fe49350720a32a0fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Great Unknown", "link": "https://stackoverflow.com/users/12016569/great-unknown"}, "edited": false, "score": 0, "creation_date": 1568387970, "post_id": 57781255, "comment_id": 102270179, "body": "Short answer is yes. I think I detailed in the prior anawer how to retrieve a record for an individual (though I never checked whether that info was vastly different from what you get in the individual by state/ individual only queries (which seems very detailed anyway). Look at both answers and try to put something together then post a question. Be sure to include your code, a couple of rows of expected output and explain where stuck. And show example inputs as well."}, {"owner": {"reputation": 21, "user_id": 12016569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ed3f9cf43c1fe49350720a32a0fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Great Unknown", "link": "https://stackoverflow.com/users/12016569/great-unknown"}, "edited": false, "score": 0, "creation_date": 1568392827, "post_id": 57781255, "comment_id": 102272437, "body": "Thanks @QHarr posted new qeustion here <a href=\"https://stackoverflow.com/q/57927171/12016569?sem=2\">stackoverflow.com/q/57927171/12016569?sem=2</a>"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1567629860, "last_edit_date": 1567629860, "creation_date": 1567569052, "answer_id": 57781255, "question_id": 57778875, "link": "https://stackoverflow.com/questions/57778875/vba-macro-trying-to-edit-a-vba-macro-that-returns-json-data/57781255#57781255", "title": "VBA MACRO: Trying to edit a VBA Macro that returns json data", "body": "<p><strong>In a nutshell:</strong></p>\n\n<p>Manually make a request for <code>Individual by State</code>, and for <code>Firm by State</code>, and observe the web-traffic via dev tools <kbd>F12</kbd>. In the network tab you will see the API calls made for each and observe the additional param <code>state</code> in the API call; and that the <a href=\"https://angularjs.org/\" rel=\"nofollow noreferrer\">angular</a> callback identifier changes. The API call returns json which, in the case of <code>Firm by State</code>, requires you to alter your paths for json parsing in order to get the local office. </p>\n\n<hr>\n\n<p><strong>tl;dr</strong></p>\n\n<p>You just add a <code>state</code> param into the queryString of the url. The value then used is the uppercase <a href=\"https://www.factmonster.com/us/postal-information/state-abbreviations-and-state-postal-codes\" rel=\"nofollow noreferrer\">2 letter code</a> for the state e.g. Louisiana = LA. The angular callback identifier also changes to reflect using state.</p>\n\n<p>Still using LA as example....</p>\n\n<p>The API call for individual becomes:</p>\n\n<p><code>https://api.brokercheck.finra.org/individual?hl=true&amp;includePrevious=true&amp;json.wrf=angular.callbacks._0&amp;nrows=100&amp;r=25&amp;sort=score+desc&amp;state=LA&amp;wt=json</code></p>\n\n<p>And for firm:</p>\n\n<p><code>https://api.brokercheck.finra.org/firm?hl=true&amp;json.wrf=angular.callbacks._1&amp;nrows=100&amp;r=25&amp;sort=score+desc&amp;state=LA&amp;wt=json</code></p>\n\n<hr>\n\n<p><strong>Firm by state</strong></p>\n\n<p>An example re-write for <code>firm by state</code> would be as follows: </p>\n\n<p><sub> Note: This extracts first local office address though main office is available in <a href=\"https://jsoneditoronline.org/?id=8568b83b6e7f49619df13b794ddf4827\" rel=\"nofollow noreferrer\">json</a>. You also no longer need <code>LatLon</code>.</sub></p>\n\n<pre><code>Option Explicit\n'Firm by state\nPublic r As Long\n\nPublic Sub GetListings()\n    '&lt;  VBE &gt; Tools &gt; References &gt; Microsoft Scripting Runtime\n    Dim json As Object, apiUrl As String, re As Object, s As String, state As String\n    state = \"LA\"\n    r = 0\n    Set re = CreateObject(\"VBScript.RegExp\")\n    apiUrl = \"https://api.brokercheck.finra.org/firm?hl=true&amp;json.wrf=angular.callbacks._1&amp;nrows=100&amp;r=25&amp;sort=score+desc&amp;{START}&amp;state={STATE}&amp;wt=json\"\n    Dim xhr As Object, totalResults As Long, numPages As Long\n\n    Set xhr = CreateObject(\"MSXML2.XMLHTTP\")\n    apiUrl = Replace$(apiUrl, \"{STATE}\", state)\n    s = GetApiResults(xhr, Replace$(apiUrl, \"{START}\", \"start=0\"), re)\n\n    If s = \"No match\" Then Exit Sub\n\n    Set json = JsonConverter.ParseJson(s)(\"hits\")\n\n    totalResults = json(\"total\")\n\n    numPages = Application.RoundUp(totalResults / 100, 0)\n\n    Dim results(), ws As Worksheet, headers(), i As Long\n    ReDim results(1 To totalResults, 1 To 3)\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    headers = Array(\"CRD Number\", \"Name\", \"Address\")\n    results = GetFirmListings(results, json(\"hits\"))\n\n    If numPages &gt; 1 Then\n        For i = 2 To numPages\n            s = GetApiResults(xhr, Replace$(apiUrl, \"{START}\", \"start=\" &amp; (i - 1) * 100), re)\n            If s = \"No match\" Or InStr(s, \"Exceeded limit\") &gt; 0 Then Exit For\n            Set json = JsonConverter.ParseJson(s)(\"hits\")\n            results = GetFirmListings(results, json(\"hits\"))\n        Next\n    End If\n    With ws\n        .Cells(1, 1).Resize(1, UBound(headers) + 1) = headers\n        .Cells(2, 1).Resize(UBound(results, 1), UBound(results, 2)) = results\n    End With\nEnd Sub\n\nPublic Function GetApiResults(ByVal xhr As Object, ByVal apiUrl As String, ByVal re As Object) As String\n    With xhr\n        .Open \"GET\", apiUrl, False\n        .send\n        GetApiResults = GetJsonString(re, .responseText)\n    End With\nEnd Function\n\nPublic Function GetFirmListings(ByVal results As Variant, ByVal json As Object) As Variant\n    Dim row As Object\n\n    For Each row In json\n        r = r + 1  'Crd number, name and local office address (not main branch)\n        results(r, 1) = row(\"_source\")(\"firm_source_id\")\n        results(r, 2) = row(\"_source\")(\"firm_name\")\n        results(r, 3) = Join$(row(\"inner_hits\")(\"branchOfficeLocations\")(\"hits\")(\"hits\")(1)(\"_source\").items, \", \")\n    Next\n    GetFirmListings = results\nEnd Function\n\nPublic Function GetJsonString(ByVal re As Object, ByVal responseText As String) As String\n    With re\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = \"\\((.*)\\);\" 'regex pattern to get json string\n        If .test(responseText) Then\n            GetJsonString = .Execute(responseText)(0).SubMatches(0)\n        Else\n            GetJsonString = \"No match\"\n        End If\n    End With\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><strong>Individual by state:</strong></p>\n\n<pre><code>Option Explicit\n'Individual by state\nPublic r As Long\n\nPublic Sub GetListings2()\n    '&lt;  VBE &gt; Tools &gt; References &gt; Microsoft Scripting Runtime\n    Dim json As Object, apiUrl As String, re As Object, s As String, state As String\n    r = 0\n    state = \"LA\"\n    Set re = CreateObject(\"VBScript.RegExp\")\n    apiUrl = \"https://api.brokercheck.finra.org/individual?hl=true&amp;includePrevious=true&amp;json.wrf=angular.callbacks._0&amp;nrows=100&amp;r=25&amp;sort=score+desc&amp;{START}&amp;state=LA&amp;wt=json\"\n    Dim xhr As Object, totalResults As Long, numPages As Long\n\n    Set xhr = CreateObject(\"MSXML2.XMLHTTP\")\n    apiUrl = Replace$(apiUrl, \"{STATE}\", state)\n    s = GetApiResults(xhr, Replace$(apiUrl, \"{START}\", \"start=0\"), re)\n\n    If s = \"No match\" Then Exit Sub\n\n    Set json = JsonConverter.ParseJson(s)(\"hits\")\n\n    totalResults = json(\"total\")\n\n    numPages = Application.RoundUp(totalResults / 100, 0)\n\n    Dim results(), ws As Worksheet, headers(), i As Long\n\n    'example info retrieved. There is a lot more info in json\n    headers = Array(\"CRD Number Indiv\", \"Name\", \"FINRA registered\", \"Disclosures\", \"In industry since\", _\n                    \"Employer CRD\", \"Employer Name\", \"Employer City\", \"Employer State\", \"Employer Zip\")\n    ReDim results(1 To totalResults, 1 To UBound(headers) + 1)\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    results = GetIndividualListings(results, json(\"hits\"))\n    If numPages &gt; 1 Then\n        For i = 2 To numPages\n            DoEvents\n            s = GetApiResults(xhr, Replace$(apiUrl, \"{START}\", \"start=\" &amp; (i - 1) * 100), re)\n            If s = \"No match\" Or InStr(s, \"Exceeded limit\") &gt; 0 Then Exit For\n            Set json = JsonConverter.ParseJson(s)(\"hits\")\n            results = GetIndividualListings(results, json(\"hits\"))\n        Next\n    End If\n    With ws\n        .Cells(1, 1).Resize(1, UBound(headers) + 1) = headers\n        .Cells(2, 1).Resize(UBound(results, 1), UBound(results, 2)) = results\n    End With\nEnd Sub\n\nPublic Sub GetListings()\n    '&lt;  VBE &gt; Tools &gt; References &gt; Microsoft Scripting Runtime\n    Dim json As Object, apiUrl As String, re As Object, s As String, state As String\n    state = \"LA\"\n    r = 0\n    Set re = CreateObject(\"VBScript.RegExp\")\n    apiUrl = \"https://api.brokercheck.finra.org/firm?hl=true&amp;json.wrf=angular.callbacks._1&amp;nrows=100&amp;r=25&amp;sort=score+desc&amp;{START}&amp;state={STATE}&amp;wt=json\"\n    Dim xhr As Object, totalResults As Long, numPages As Long\n\n    Set xhr = CreateObject(\"MSXML2.XMLHTTP\")\n    apiUrl = Replace$(apiUrl, \"{STATE}\", state)\n    s = GetApiResults(xhr, Replace$(apiUrl, \"{START}\", \"start=0\"), re)\n\n    If s = \"No match\" Then Exit Sub\n\n    Set json = JsonConverter.ParseJson(s)(\"hits\")\n\n    totalResults = json(\"total\")\n\n    numPages = Application.RoundUp(totalResults / 100, 0)\n\n    Dim results(), ws As Worksheet, headers(), i As Long\n    ReDim results(1 To totalResults, 1 To 3)\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    headers = Array(\"CRD Number\", \"Name\", \"Address\")\n    results = GetFirmListings(results, json(\"hits\"))\n\n    If numPages &gt; 1 Then\n        For i = 2 To numPages\n            s = GetApiResults(xhr, Replace$(apiUrl, \"{START}\", \"start=\" &amp; (i - 1) * 100), re)\n            If s = \"No match\" Or InStr(s, \"Exceeded limit\") &gt; 0 Then Exit For\n            Set json = JsonConverter.ParseJson(s)(\"hits\")\n            results = GetIndividualListings(results, json(\"hits\"))\n        Next\n    End If\n    With ws\n        .Cells(1, 1).Resize(1, UBound(headers) + 1) = headers\n        .Cells(2, 1).Resize(UBound(results, 1), UBound(results, 2)) = results\n    End With\nEnd Sub\n\nPublic Function GetApiResults(ByVal xhr As Object, ByVal apiUrl As String, ByVal re As Object) As String\n    With xhr\n        .Open \"GET\", apiUrl, False\n        .send\n        GetApiResults = GetJsonString(re, .responseText)\n    End With\nEnd Function\n\nPublic Function GetIndividualListings(ByVal results As Variant, ByVal json As Object) As Variant\n    Dim row As Object\n      'can have numerous current employments. Alter here and below if want more info from json about the individual\n    ' CRD Number, Indiv Name, FINRA registered, Disclosures, In industry since, _\n    current employer firm ID, current employer firm name, current employer city, current employer state, current employer zip.\n    On Error Resume Next\n    For Each row In json\n        r = r + 1\n        results(r, 1) = row(\"_source\")(\"ind_source_id\")\n        results(r, 2) = Replace$(Join$(Array(row(\"_source\")(\"ind_firstname\"), row(\"_source\")(\"ind_middlename\"), row(\"_source\")(\"ind_lastname\")), \", \"), \", , \", \", \")\n        results(r, 3) = row(\"_source\")(\"ind_approved_finra_registration_count\")\n        results(r, 4) = row(\"_source\")(\"ind_bc_disclosure_fl\")\n        results(r, 5) = row(\"_source\")(\"ind_industry_cal_date\")\n        results(r, 6) = row(\"_source\")(\"ind_current_employments\")(1)(\"firm_id\")\n        results(r, 7) = row(\"_source\")(\"ind_current_employments\")(1)(\"firm_name\")\n        results(r, 8) = row(\"_source\")(\"ind_current_employments\")(1)(\"branch_city\")\n        results(r, 9) = row(\"_source\")(\"ind_current_employments\")(1)(\"branch_state\")\n        results(r, 10) = row(\"_source\")(\"ind_current_employments\")(1)(\"branch_zip\")\n    Next\n    On Error GoTo 0\n    GetIndividualListings = results\nEnd Function\n\nPublic Function GetJsonString(ByVal re As Object, ByVal responseText As String) As String\n    With re\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = \"\\((.*)\\);\" 'regex pattern to get json string\n        If .test(responseText) Then\n            GetJsonString = .Execute(responseText)(0).SubMatches(0)\n        Else\n            GetJsonString = \"No match\"\n        End If\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12016569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253ed3f9cf43c1fe49350720a32a0fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Great Unknown", "link": "https://stackoverflow.com/users/12016569/great-unknown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "closed_date": 1567799193, "accepted_answer_id": 57781255, "answer_count": 1, "score": 1, "last_activity_date": 1567786736, "creation_date": 1567545596, "last_edit_date": 1567786736, "question_id": 57778875, "link": "https://stackoverflow.com/questions/57778875/vba-macro-trying-to-edit-a-vba-macro-that-returns-json-data", "closed_reason": "Needs details or clarity", "title": "VBA MACRO: Trying to edit a VBA Macro that returns json data", "body": "<p>Please see the code below which works to query an api call. I show extracting only specific items from json. There is a lot more info returned e.g. all current employments which can be more than 1. How can the code be modified to query by state?</p>\n\n<pre><code>Option Explicit\n'Individual\nPublic r As Long\n\nPublic Sub GetListings2()\n    '&lt;  VBE &gt; Tools &gt; References &gt; Microsoft Scripting Runtime\n    Dim json As Object, apiUrl As String, re As Object, s As String, latLon()\n    r = 0\n    Set re = CreateObject(\"VBScript.RegExp\")\n    apiUrl = \"https://api.brokercheck.finra.org/individual?hl=true&amp;includePrevious=false&amp;json.wrf=angular.callbacks._d&amp;lat={LAT}&amp;lon={LON}&amp;nrows=100&amp;r=25&amp;sort=score+desc&amp;{START}&amp;wt=json\"\n    Dim xhr As Object, totalResults As Long, numPages As Long\n\n    Set xhr = CreateObject(\"MSXML2.XMLHTTP\")\n\n    latLon = GetLatLon(\"30047\", xhr, re)\n    apiUrl = Replace$(Replace$(apiUrl, \"{LAT}\", latLon(0)), \"{LON}\", latLon(1))\n    s = GetApiResults(xhr, Replace$(apiUrl, \"{START}\", \"start=0\"), re)\n\n    If s = \"No match\" Then Exit Sub\n\n    Set json = JsonConverter.ParseJson(s)(\"hits\")\n\n    totalResults = json(\"total\")\n\n    numPages = Application.RoundUp(totalResults / 100, 0)\n\n    Dim results(), ws As Worksheet, headers(), i As Long\n\n    'example info retrieved. There is a lot more info in json\n    headers = Array(\"CRD Number Indiv\", \"Name\", \"FINRA registered\", \"Disclosures\", \"In industry since\")\n    ReDim results(1 To totalResults, 1 To UBound(headers) + 1)\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    results = GetIndividualListings(results, json(\"hits\"))\n    If numPages &gt; 1 Then\n        For i = 2 To numPages\n            DoEvents\n            s = GetApiResults(xhr, Replace$(apiUrl, \"{START}\", \"start=\" &amp; (i - 1) * 100), re)\n            If s = \"No match\" Or InStr(s, \"Exceeded limit\") &gt; 0 Then Exit For\n            Set json = JsonConverter.ParseJson(s)(\"hits\")\n            results = GetIndividualListings(results, json(\"hits\"))\n        Next\n    End If\n    With ws\n        .Cells(1, 1).Resize(1, UBound(headers) + 1) = headers\n        .Cells(2, 1).Resize(UBound(results, 1), UBound(results, 2)) = results\n    End With\nEnd Sub\n\nPublic Function GetLatLon(ByVal zip As String, ByVal xhr As Object, ByVal re As Object) As Variant\n    Dim json As Object, lat As String, lon As String\n    With xhr\n        .Open \"GET\", Replace$(\"https://api.brokercheck.finra.org/locations?query={ZIP}&amp;results=1\", \"{ZIP}\", zip), False 'changed results = 10 to results = 1\n        .send\n        Set json = JsonConverter.ParseJson(.responseText)(\"hits\")(\"hits\")(1)(\"_source\")\n        lat = json(\"latitude\")\n        lon = json(\"longitude\")\n        GetLatLon = Array(lat, lon)\n    End With\nEnd Function\n\nPublic Function GetApiResults(ByVal xhr As Object, ByVal apiUrl As String, ByVal re As Object) As String\n    With xhr\n        .Open \"GET\", apiUrl, False\n        .send\n        GetApiResults = GetJsonString(re, .responseText)\n    End With\nEnd Function\n\nPublic Function GetIndividualListings(ByVal results As Variant, ByVal json As Object) As Variant\n    Dim row As Object\n      'can have numerous current employments. Alter here and below if want more info from json about the individual\n\n    For Each row In json\n        r = r + 1\n        results(r, 1) = row(\"_source\")(\"ind_source_id\")\n        results(r, 2) = Replace$(Join$(Array(row(\"_source\")(\"ind_firstname\"), row(\"_source\")(\"ind_middlename\"), row(\"_source\")(\"ind_lastname\")), \", \"), \", , \", \", \")\n        results(r, 3) = row(\"_source\")(\"ind_approved_finra_registration_count\")\n        results(r, 4) = row(\"_source\")(\"ind_bc_disclosure_fl\")\n        results(r, 5) = row(\"_source\")(\"ind_industry_cal_date\")\n    Next\n    GetIndividualListings = results\nEnd Function\n\nPublic Function GetJsonString(ByVal re As Object, ByVal responseText As String) As String\n    With re\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = \"\\((.*)\\);\" 'regex pattern to get json string\n        If .Test(responseText) Then\n            GetJsonString = .Execute(responseText)(0).SubMatches(0)\n        Else\n            GetJsonString = \"No match\"\n        End If\n    End With\nEnd Function\n</code></pre>\n\n<p>The results work but how can the query change to query against state instead of zipcode?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1567603505, "post_id": 57778261, "comment_id": 102012023, "body": "No one memorizes the error numbers - what&#39;s the error TEXT?"}], "answers": [{"tags": [], "owner": {"reputation": 886, "user_id": 653690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69b1310f729b7ba778b14a14858a1162?s=128&d=identicon&r=PG", "display_name": "x5657", "link": "https://stackoverflow.com/users/653690/x5657"}, "is_accepted": false, "score": -1, "last_activity_date": 1567543136, "creation_date": 1567543136, "answer_id": 57778452, "question_id": 57778261, "link": "https://stackoverflow.com/questions/57778261/why-do-i-got-an-error-91-with-checkbox-on-word/57778452#57778452", "title": "Why do i got an error 91 with checkbox on word", "body": "<p>Could you try using set, like this:</p>\n\n<p><code>set cont_texte = controle.Range</code></p>\n"}], "owner": {"reputation": 19, "user_id": 12016527, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAqPSCI6P69DK5FVyxBYd2-DcfclHaCsDZ8-ihx=k-s128", "display_name": "Hortaling", "link": "https://stackoverflow.com/users/12016527/hortaling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1567545600, "creation_date": 1567542051, "last_edit_date": 1567545600, "question_id": 57778261, "link": "https://stackoverflow.com/questions/57778261/why-do-i-got-an-error-91-with-checkbox-on-word", "title": "Why do i got an error 91 with checkbox on word", "body": "<p>I want to make a document on Word with some content control.</p>\n\n<p>I found this code on internet to hide the content control who are empty (some of them are optional)</p>\n\n<p>When the macro reach a checkbox, i got an </p>\n\n<blockquote>\n  <p>error 91</p>\n</blockquote>\n\n<p>How can i fix that ?</p>\n\n<pre><code>Sub\n    Dim controle As ContentControl\n    Dim cont_texte\n\n    For Each controle In ActiveDocument.ContentControls\n    cont_texte = controle.Range\n        If cont_texte = controle.placeHolderText Then\n            controle.Range.Font.Hidden = True\n        Else: controle.Range.Font.Hidden = False\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 2, "creation_date": 1567542853, "post_id": 57778199, "comment_id": 101991732, "body": "You can&#39;t stop them from instantiating an interface but you might be able to add a class_initialize method which pops up an appropriate error in a Message box."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1567547030, "post_id": 57778527, "comment_id": 101993044, "body": "An <a href=\"https://github.com/rubberduck-vba/Rubberduck/issues/5132\" rel=\"nofollow noreferrer\">up-for-grabs issue has been created for this</a>, if anyone wants to contribute to Rubberduck by implementing that inspection."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1567575249, "post_id": 57778527, "comment_id": 101997980, "body": "Thanks a lot Mathieu, for the explanation and for the issue in Rubberduck. I will read the repository rules and see if I can send you myself a pull request for this in the next days."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1567596223, "post_id": 57778527, "comment_id": 102007985, "body": "@MatteoNNZ awesome!! Don&#39;t hesitate to ask anything if you need help doing so!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1567543525, "creation_date": 1567543525, "answer_id": 57778527, "question_id": 57778199, "link": "https://stackoverflow.com/questions/57778199/stop-users-from-instancing-an-interface-and-not-its-implementation/57778527#57778527", "title": "Stop users from instancing an interface and not its implementation", "body": "<p>It's not a limitation of VBA, it's a <em>feature</em> of Classic VB: every single class defines an interface - the class' <em>default interface</em>: that's how any class can implement any other.</p>\n\n<p>There is therefore no way to get a <strong>compile-time</strong> error for this.</p>\n\n<p>Static code analysis tools can help though. <a href=\"http://rubberduckvba.com/Inspections/Details/ImplementedInterfaceMember\" rel=\"nofollow noreferrer\">Rubberduck's <em>Implemented Interface Member</em> inspection</a> warns about interface members that have an implementation (the code examples on that page probably need to be made clearer though), but that doesn't warn when the interface is instantiated... we could pretty easily implement an inspection that warns about instantiated interface classes though.</p>\n\n<p>Other than that, you can get a <strong>run-time</strong> error for <code>New</code>-ing up what's intended as an abstract interface, by throwing an error in the <code>Class_Initialize</code> handler, <a href=\"https://stackoverflow.com/questions/57778199/stop-users-from-instancing-an-interface-and-not-its-implementation#comment101991732_57778199\">as Freeflow suggested</a>.</p>\n"}], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 57778527, "answer_count": 1, "score": 3, "last_activity_date": 1567543525, "creation_date": 1567541680, "question_id": 57778199, "link": "https://stackoverflow.com/questions/57778199/stop-users-from-instancing-an-interface-and-not-its-implementation", "title": "Stop users from instancing an interface and not its implementation", "body": "<p>For a personal project I prepare some interfaces in a VBA workbook which (being interfaces) are supposed to be implemented by the final users.</p>\n\n<p>If I was coding in a language like Java, I wouldn't be able to instantiate an interface as the compiler would stop me: </p>\n\n<p><strong>Greetings.java</strong></p>\n\n<pre><code>public interface Greetings {\n    public String sayHello(String person);\n} \n</code></pre>\n\n<p><strong>GreetingsImpl.java</strong></p>\n\n<pre><code>public class GreetingsImpl implements Greetings {\n    @Override\n    public String sayHello(String person) {\n        return \"Hello \" + person;\n    }\n}\n</code></pre>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Greetings greets = new GreetingsImpl(); //&lt;-- OK\nGreetings greets = new Greetings(); //&lt;-- ERROR: Greetings is abstract; cannot be instantiated\n</code></pre>\n\n<p>However, in VBA I've noticed that you can instantiate an Interface, and the method would run as if it was called (just returning the default value). </p>\n\n<p><strong>IGreetings</strong></p>\n\n<pre><code>Public Function sayHello(person As String) As String\nEnd Function\n</code></pre>\n\n<p><strong>Greetings</strong></p>\n\n<pre><code>Implements IGreetings\nPublic Function IGreetings_sayHello(person As String) As String\n    IGreetings_sayHello = \"Hello \" &amp; person\nEnd Function \n</code></pre>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Dim greets As IGreetings\nSet greets = New Greetings\nMsgBox greets.sayHello(\"Matteo\") '&lt;-- it works\n\nSet greets = New IGreetings\nMsgBox greets.sayHello(\"Matteo\") '&lt;-- it shows empty, but it works\n</code></pre>\n\n<p>Is there any way I can refrain such a mistake on interface side, or should I just see it as a limitation of VBA?</p>\n\n<blockquote>\n  <p>Note: even though this issue may seem absurd/useless, it actually happened in real life. There was a method of an interface which was supposed to evaluate some parameters and return a <code>Boolean</code>. One of the clients implemented the logic but then he instantiated the interface instead of its implementation, and the method was always returning <code>False</code>. The code ran in production before they figured out it was always returning false, and it took some time to figure that out, I would like to know if I can avoid somehow else than just highlighting this in the documentation or relying on users care.</p>\n</blockquote>\n"}, {"tags": ["vba", "ms-access", "combobox", "eventtrigger"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1567541846, "post_id": 57777910, "comment_id": 101991363, "body": "Well, are you trying to account for blank selections? Try using LEN(Me.cmb_Event.Vaue)&gt;0. I would also make sure the control name is correct."}, {"owner": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1567542556, "post_id": 57777910, "comment_id": 101991621, "body": "I&#39;ll have to try blank selections when I get home tonight. I know I&#39;ve struggled to make those work, too. From what I&#39;ve experienced, Access VBA is pretty complicated when it comes to handling nulls, null strings, zeroes, and blanks."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1567545811, "post_id": 57777910, "comment_id": 101992680, "body": "Show us the properties tab labeled &quot;Other&quot; for this control"}, {"owner": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1567584471, "post_id": 57777910, "comment_id": 102001782, "body": "Here are the requested screenshots.  !<a href=\"https://imgur.com/ArxDVOa\" rel=\"nofollow noreferrer\">Valid XHTML</a>  !<a href=\"https://imgur.com/glWN98P\" rel=\"nofollow noreferrer\">Valid XHTML</a>"}, {"owner": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1567587912, "post_id": 57777910, "comment_id": 102003568, "body": "I didn&#39;t get much time to test for blank selections. Even those are a mystery to me, and it was a struggle to post those screenshots."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1567608754, "post_id": 57777910, "comment_id": 102015170, "body": "Show the event tab, not other!"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "edited": false, "score": 0, "creation_date": 1567542889, "post_id": 57778283, "comment_id": 101991753, "body": "Ok. I think from now on I&#39;ll have to use only the drop-downs from the property sheet to help ensure they&#39;re linked. Also, I didn&#39;t realize I could put a break point on the event handler. I&#39;ll check that out tonight."}, {"owner": {"reputation": 3021, "user_id": 11606193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DXr7w.jpg?s=128&g=1", "display_name": "Deepstop", "link": "https://stackoverflow.com/users/11606193/deepstop"}, "reply_to_user": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "edited": false, "score": 0, "creation_date": 1567599512, "post_id": 57778283, "comment_id": 102009800, "body": "Did this help at all?"}, {"owner": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "edited": false, "score": 0, "creation_date": 1567707407, "post_id": 57778283, "comment_id": 102053366, "body": "It turns out that one issue definitely was using the Property sheet for inserting code. That was another hard lesson for a budding Access developer. :)  The second and much more complicated part is making sure I&#39;m testing for the correct values. That seems like a journey that continues to unfold (and is maybe better suited for another thread), especially in light of the nulls vs. null strings vs. zeroes vs. blanks issue I mentioned above."}, {"owner": {"reputation": 3021, "user_id": 11606193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DXr7w.jpg?s=128&g=1", "display_name": "Deepstop", "link": "https://stackoverflow.com/users/11606193/deepstop"}, "reply_to_user": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "edited": false, "score": 0, "creation_date": 1567717524, "post_id": 57778283, "comment_id": 102057247, "body": "<code>Nz</code> is a useful function for that, as is <code>isnull</code>. I mostly use isnull to check for a null value in fields, although maybe &#39;len(nz(control.value, &quot;&quot;)) = 0 is a better check as it will find empty strings as well. If nulls aren&#39;t allowed, I just execute <code>Cancel = True</code> after informing the user with <code>MsgBox</code>."}], "tags": [], "owner": {"reputation": 3021, "user_id": 11606193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DXr7w.jpg?s=128&g=1", "display_name": "Deepstop", "link": "https://stackoverflow.com/users/11606193/deepstop"}, "is_accepted": true, "score": 1, "last_activity_date": 1567542185, "creation_date": 1567542185, "answer_id": 57778283, "question_id": 57777910, "link": "https://stackoverflow.com/questions/57777910/access-2010-combobox-events-do-not-trigger-at-all/57778283#57778283", "title": "Access 2010 combobox events do not trigger at all", "body": "<p>The only time I ever seen event handlers not firing like this is when writing (or pasting) an event handler doesn't actually link it to the appropriate event property and it is not listed in the event property sheet.</p>\n\n<p>If you create the <code>Sub</code> statement by selecting the handler from the drop-down it will add it to the property sheet, or it can be added manually.</p>\n\n<p>I presume you've also tried setting a breakpoint on the first statement of the handlers. If it doesn't hit it, then the handler is not linked to the control.</p>\n"}, {"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1567604234, "creation_date": 1567604234, "answer_id": 57789644, "question_id": 57777910, "link": "https://stackoverflow.com/questions/57777910/access-2010-combobox-events-do-not-trigger-at-all/57789644#57789644", "title": "Access 2010 combobox events do not trigger at all", "body": "<p>I think your issues has to do with testing the wrong values. Unless you are setting the default values to 0 (this is assuming there are no bound tables) then the controls will most likely never have 0 in them. And, if youre trying to test for nulls there are much better ways to do so</p>\n\n<pre><code>LEN(TRIM(Me.cmb_Event.Vaue))&gt;0\n</code></pre>\n\n<p>or</p>\n\n<pre><code> ISNULL(Me.cmb_Event.Vaue)=True \n</code></pre>\n\n<p>I had no issue replicating your scenario:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rRbPj.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rRbPj.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 57778283, "answer_count": 2, "score": 1, "last_activity_date": 1594450015, "creation_date": 1567540093, "last_edit_date": 1594450015, "question_id": 57777910, "link": "https://stackoverflow.com/questions/57777910/access-2010-combobox-events-do-not-trigger-at-all", "title": "Access 2010 combobox events do not trigger at all", "body": "<p>In Access 2010, I am struggling with making a combobox force users to give it input on a data entry form. In this case, I want the combobox to detect that the user has made no selection at all. </p>\n\n<p>I've put the included code in the OnClick, BeforeUpdate, and OnChange events of cbo_Event1. cmb_StartOfSeason, cmb_EndOfSeason, and cmb_MoneyRequired are comboboxes which will provide details for the user about cbo_Event1 on the search form. All four comboboxes are linked to other tables for lookup values.</p>\n\n<p>I've made bound (cbo_Event1) and unbound (cmb_Event) versions of the combobox. I've also used Me.cbo_Event1.Value, Me.cbo_Event1.ListIndex, and Me.cbo_Event1 in the code.</p>\n\n<pre><code>Private Sub cbo_Event1_AfterUpdate()\n   MsgBox (\"Me.cbo_Event1 = \" &amp; Me.cbo_Event1 &amp; \".\")\n   If Me.cmb_Event = 0 Then\n      Me.cmb_StartOfSeason = 0\n      Me.cmb_EndOfSeason = 0\n      Me.cmb_MoneyRequired = 0\n   End If\nEnd Sub\n\nPrivate Sub cbo_Event1_Change()\n   MsgBox (\"Me.cbo_Event1 = \" &amp; Me.cbo_Event1 &amp; \".\")\n   If Me.cmb_Event = 0 Then\n      Me.cmb_StartOfSeason = 0\n      Me.cmb_EndOfSeason = 0\n      Me.cmb_MoneyRequired = 0\n   End If\nEnd Sub\n\nPrivate Sub cbo_Event1_Click()\n   MsgBox (\"Me.cbo_Event1 = \" &amp; Me.cbo_Event1 &amp; \".\")\n   If Me.cmb_Event = 0 Then\n      Me.cmb_StartOfSeason = 0\n      Me.cmb_EndOfSeason = 0\n      Me.cmb_MoneyRequired = 0\n   End If\nEnd Sub\n\nPrivate Sub cmb_Event_AfterUpdate()\n   MsgBox (\"Me.cmb_Event = \" &amp; Me.cmb_Event &amp; \".\")\n   If Me.cmb_Event = 0 Then\n      Me.cmb_StartOfSeason = 0\n      Me.cmb_EndOfSeason = 0\n      Me.cmb_MoneyRequired = 0\n   End If\nEnd Sub\n\nPrivate Sub cmb_Event_BeforeUpdate(Cancel As Integer)\n   MsgBox (\"Me.cmb_Event = \" &amp; Me.cmb_Event &amp; \".\")\n   If Me.cmb_Event = 0 Then\n      Me.cmb_StartOfSeason = 0\n      Me.cmb_EndOfSeason = 0\n      Me.cmb_MoneyRequired = 0\n   End If\nEnd Sub\n\nPrivate Sub cmb_Event_Change()\n   MsgBox (\"Me.cmb_Event = \" &amp; Me.cmb_Event &amp; \".\")\n   If Me.cmb_Event = 0 Then\n      Me.cmb_StartOfSeason = 0\n      Me.cmb_EndOfSeason = 0\n      Me.cmb_MoneyRequired = 0\n   End If\nEnd Sub\n\nPrivate Sub cmb_Event_Click()\n   MsgBox (\"Me.cmb_Event = \" &amp; Me.cmb_Event &amp; \".\")\n   If Me.cmb_Event = 0 Then\n      Me.cmb_StartOfSeason = 0\n      Me.cmb_EndOfSeason = 0\n      Me.cmb_MoneyRequired = 0\n   End If\nEnd Sub\n</code></pre>\n\n<p>I get the same result across the board: the Event combobox does not detect that no selection was made when its drop-down list appears. The MsgBox function doesn't even trigger, indicating the event doesn't take place. I'm baffled as to why.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1567539752, "post_id": 57777759, "comment_id": 101990648, "body": "Can you be more specific when you say: &quot;So how would you change the .Rowsource to column?&quot; Are those named ranges you have defined in your workbook (&quot;CNRL&quot;, &quot;Centrica&quot;, etc?) If so, scoped to workbook or worksheet level?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567540030, "post_id": 57777759, "comment_id": 101990746, "body": "Format your data in rows... not sure I understand the question or the issue."}, {"owner": {"reputation": 149, "user_id": 2441245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/597c2fb23331c21662e5c22674ced342?s=128&d=identicon&r=PG", "display_name": "GoldFusion", "link": "https://stackoverflow.com/users/2441245/goldfusion"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1567540270, "post_id": 57777759, "comment_id": 101990823, "body": "@ScottHoltzman Yes, they are named ranges. The (vertical green column) is a named range for operating client (e.g.CNRL) and for each individual client there are Plant sites which are named ranges horizontally from each of those clients (e.g. Albian Plant)."}, {"owner": {"reputation": 149, "user_id": 2441245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/597c2fb23331c21662e5c22674ced342?s=128&d=identicon&r=PG", "display_name": "GoldFusion", "link": "https://stackoverflow.com/users/2441245/goldfusion"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567540434, "post_id": 57777759, "comment_id": 101990874, "body": "@MathieuGuindon My question is how would you use a similar function like .RowSource for columns."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1567540497, "post_id": 57777759, "comment_id": 101990890, "body": "<code>RowSource</code> isn&#39;t a function, it&#39;s a property of the dropdown control that expects data shaped a certain way. You make your data fit that format, not the other way around."}, {"owner": {"reputation": 149, "user_id": 2441245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/597c2fb23331c21662e5c22674ced342?s=128&d=identicon&r=PG", "display_name": "GoldFusion", "link": "https://stackoverflow.com/users/2441245/goldfusion"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567540813, "post_id": 57777759, "comment_id": 101991005, "body": "@MathieuGuindon There should be some kind of alternative, is there not?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1567541036, "post_id": 57777759, "comment_id": 101991079, "body": "@GoldFusion - there is no alternative using <code>.RowSource</code>. It&#39;s very easy to transpose your data. The only alternative is to load the items in <code>cbOPsite</code> via code on the change of <code>cbClient</code>, by looping through your columnar list."}], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1567546573, "creation_date": 1567546573, "answer_id": 57779024, "question_id": 57777759, "link": "https://stackoverflow.com/questions/57777759/is-there-rowsource-for-column/57779024#57779024", "title": "Is there .Rowsource for column?", "body": "<p>Maybe you can look into <code>.List</code> property instead as an alternative?</p>\n\n<p>Here is a small example:</p>\n\n<ul>\n<li>Data turned into named ranges:</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/VEb67.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VEb67.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/b4sD1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/b4sD1.png\" alt=\"enter image description here\"></a></p>\n\n<ul>\n<li>Quick userform with two comboboxes and following code:</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/wXh9R.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wXh9R.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private Sub ComboBox1_Change()\n\nMe.ComboBox2.Clear\nWith Sheets(\"Sheet1\")\n    If .Range(ComboBox1.Value).Count = 1 Then\n        Me.ComboBox2.AddItem .Range(ComboBox1.Value)\n    Else\n        Me.ComboBox2.List = Application.Transpose(.Range(ComboBox1.Value))\n    End If\nEnd With\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\nMe.ComboBox1.List = Array(\"Athabasca_Oil\", \"BlackPearl_Resources\", \"Brunei_Methanol\", \"Centrica\", \"CNRL\")\n\nEnd Sub\n</code></pre>\n\n<ul>\n<li>Changing combobox1 will change the <code>.List</code> property of the second one (unless the named range only hold one cell, because otherwise that would error out):</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/5JZ87.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5JZ87.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 149, "user_id": 2441245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/597c2fb23331c21662e5c22674ced342?s=128&d=identicon&r=PG", "display_name": "GoldFusion", "link": "https://stackoverflow.com/users/2441245/goldfusion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 57779024, "answer_count": 1, "score": 0, "last_activity_date": 1567546573, "creation_date": 1567539172, "last_edit_date": 1567539786, "question_id": 57777759, "link": "https://stackoverflow.com/questions/57777759/is-there-rowsource-for-column", "title": "Is there .Rowsource for column?", "body": "<p>So I have a code for a combobox <strong>cbClient</strong> which chooses user picks a name of a client then a dependable combobox <strong>cbOPsite</strong> chooses a plant site related to the corresponding client that was picked. </p>\n\n<p>The problem I am having is regarding the second combobox not listing out all the Plant sites instead it only shows \"Albian\" which is only one of the other plant Sites as shown below: \n<a href=\"https://i.stack.imgur.com/RL6kK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RL6kK.png\" alt=\"enter image description here\"></a>  </p>\n\n<p>Here is the table for Client and Site names:\n<a href=\"https://i.stack.imgur.com/kX1GE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kX1GE.png\" alt=\"enter image description here\"></a> </p>\n\n<p>Here is the code I have so far:</p>\n\n<pre><code>Private Sub cbClient_Change()\nSelect Case cbClient.value\n    Case Is = \"Athabasca Oil\"\n        cbOPSite.RowSource = \"Athabasca_Oil\"\n\n    Case Is = \"BlackPearl Resources \"\n        cbOPSite.RowSource = \"BlackPearl_Resources\"\n\n    Case Is = \"Brunei Methanol Company\"\n        cbOPSite.RowSource = \"Brunei_Methanol\"\n\n    Case Is = \"Centrica\"\n        cbOPSite.RowSource = \"Centrica\"\n\n    Case Is = \"CNRL\"\n        cbOPSite.RowSource = \"CNRL\"\n    End Select\nEnd Sub\n</code></pre>\n\n<p>So I am thinking its the .RowSource that is causing the issue and so how could the .Rowsource be changed to a column? Since I have tried .ColumnSource and doesn't work.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1567541764, "post_id": 57777252, "comment_id": 101991335, "body": "Welcome to SO. I am not sure if you are aware or not, but you have not actually asked any <i>specific</i> question or noted any <i>specific</i> problem, so it&#39;s impossible to help."}, {"owner": {"reputation": 3, "user_id": 12015901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97e9104f0e7681dce3592f974119457e?s=128&d=identicon&r=PG&f=1", "display_name": "Seb8912", "link": "https://stackoverflow.com/users/12015901/seb8912"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1567542853, "post_id": 57777252, "comment_id": 101991733, "body": "Dear Scott, the question is maybe not obvious but there is definitely one. How do I vlookup in a specific folder that depends of the month and in a specific file that depends either on a cell value or of the worksheet name to get information from previous month..."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12015901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97e9104f0e7681dce3592f974119457e?s=128&d=identicon&r=PG&f=1", "display_name": "Seb8912", "link": "https://stackoverflow.com/users/12015901/seb8912"}, "edited": false, "score": 0, "creation_date": 1567544443, "post_id": 57778296, "comment_id": 101992265, "body": "BRILLIANT !!!!!!!!! You saved my day, Ihave to adapt it a bit, but you solved in few min something I spent the day trying to Thank you very much"}, {"owner": {"reputation": 3064, "user_id": 11971785, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tm3RpH5aT9s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfqnZceaddibCeBqwQbb0SmiR6prw/photo.jpg?sz=128", "display_name": "Andreas", "link": "https://stackoverflow.com/users/11971785/andreas"}, "reply_to_user": {"reputation": 3, "user_id": 12015901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97e9104f0e7681dce3592f974119457e?s=128&d=identicon&r=PG&f=1", "display_name": "Seb8912", "link": "https://stackoverflow.com/users/12015901/seb8912"}, "edited": false, "score": 0, "creation_date": 1567548518, "post_id": 57778296, "comment_id": 101993379, "body": "Glad I could help!"}], "tags": [], "owner": {"reputation": 3064, "user_id": 11971785, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tm3RpH5aT9s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfqnZceaddibCeBqwQbb0SmiR6prw/photo.jpg?sz=128", "display_name": "Andreas", "link": "https://stackoverflow.com/users/11971785/andreas"}, "is_accepted": true, "score": 0, "last_activity_date": 1567542265, "creation_date": 1567542265, "answer_id": 57778296, "question_id": 57777252, "link": "https://stackoverflow.com/questions/57777252/vba-lookup-in-variable-workbook/57778296#57778296", "title": "VBA - lookup in variable workbook", "body": "<p>Has the solution to be in VBA? If not you should definetly check out PowerQuery which is included in Excel 2016 and higher. Power Query can do exactly what you asked and doesn't need any code.</p>\n\n<p>Anyway, if I understand you correctly you need to set a formula with VBA.\nTry this:</p>\n\n<pre><code>Sub set_formula()\n\nlastrow = 10\nPath = \"C:\\Folder\\\"\nworkbookname = \"Template.xlsx\"\nsheetname = \"Ids\"\n\nRange(\"D13\").Formula = \"=VLOOKUP(A2,'\" &amp; Path &amp; \"[\" &amp; workbookname &amp; \"]\" &amp; sheetname &amp; \"'!A2:O\" &amp; lastrow &amp; \",14,0)\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12015901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97e9104f0e7681dce3592f974119457e?s=128&d=identicon&r=PG&f=1", "display_name": "Seb8912", "link": "https://stackoverflow.com/users/12015901/seb8912"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 57778296, "answer_count": 1, "score": 0, "last_activity_date": 1567542265, "creation_date": 1567536548, "last_edit_date": 1567537274, "question_id": 57777252, "link": "https://stackoverflow.com/questions/57777252/vba-lookup-in-variable-workbook", "title": "VBA - lookup in variable workbook", "body": "<p>I have a little bit of a problem within an Excel Macro</p>\n\n<p>I have a file populated with huge amount of data extracted from different software and that has to be updated on a monthly basis.</p>\n\n<p>There is data from A2 to O &amp; Lastrow</p>\n\n<p>in column L there is a code that I use to split the sheet into as many sheets as needed (one per existing codes)</p>\n\n<p>Lets say my sheet has 50 lines, the codes present in L are 0250, 40 times and 1225, 10 times so I'll have 2 new sheets</p>\n\n<p>Then all these sheets are saved as individual files for further treatment - and column N of the newly created file will be changed by human</p>\n\n<p>So excel will create a folder and save these 2 sheets as 2 xlsx files according to the month we're in</p>\n\n<p>In my example, it will save them as:<br>\nc:\\ACCOUNTS\\SEP\\0250 SEP 19.xlsx<br>\nc:\\ACCOUNTS\\SEP\\1225 SEP 19.xlsx</p>\n\n<p>I'm looking for either in the raw extract entirely or at the time the file is split to add in column O a vlookup that will analyze each of these files from the previous month</p>\n\n<p>So I'd like to have a piece of code that will input a Vlookup in the cells, depending of what's in column L of the sheet name to have</p>\n\n<pre><code>=vlookup(A2,c:\\ACCOUNTS\\AUG\\0250 AUG 19.xlsx!A2:O &amp; lastrow,14,0)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>=vlookup(A2,c:\\ACCOUNTS\\AUG\\1225 AUG 19.xlsx!A2:O &amp; lastrow,14,0)\n</code></pre>\n\n<pre><code>Sub SPLIT()\n\nDim main As Worksheet\nDim lastrow As Long\n\nDim FileExtStr As String\nDim FileFormatNum As Long\nDim xWs As Worksheet\nDim xWb As Workbook\nDim FolderName As String\n\nSet xWb = Application.ThisWorkbook\n\nmBefore = Format(DateAdd(\"m\", -1, Date), \"MMM yy\")\nmPrevious = Format(DateAdd(\"m\", -1, Date), \"MMM yy\")\nSet main = Sheets(\"Global\")\nmain.Activate\n\n'ActiveSheet.name = \"Global\"\n'Set main = Sheets(\"Global\")\n\n'Calculation of last line\nlastrow = main.Cells(Rows.Count, \"l\").End(xlUp).Row\n'MsgBox lastrow\n\nSet FDWDownload1 = Sheets(\"Global\")\n\nSheets.Add(before:=Sheets(\"Global\")).name = \"List\"\n\nSet Ref = Sheets(\"List\")\n\n'Creates the table\nFDWDownload1.Range(\"L\" &amp; StartPointRow + 1 &amp; \":L\" &amp; lastrow).Copy\n        Ref.Activate\n        Ref.Range(\"B2\").PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n        Range(\"B:B\").RemoveDuplicates Columns:=1\n        Application.CutCopyMode = False\n\n        RefLastRow = Ref.Cells(Rows.Count, \"B\").End(xlUp).Row\n        FDWDownload1.Activate\n\n\nIf RefLastRow &gt; 0 Then\n            'For the second row to the end of the table on the References tab\n            For i = 3 To RefLastRow\n                'Copy the header from the download\n                FDWDownload1.Range(\"A1:P1\").Copy\n\n            'Add a new sheet placed after the sheet \"Global\" &amp; name it according to the reference table\n                Sheets.Add(after:=Sheets(\"Global\")).name = Ref.Range(\"B\" &amp; i)\n                Set ws = Application.ActiveSheet\n\n                'Paste the header into each newly created sheet\n                ws.Range(\"A1\").PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n                ws.Range(\"A1\").PasteSpecial Paste:=xlPasteFormats\n\n                  'Get the number of the last row on the newly created sheet\n                ForLastRow = ws.Cells(Rows.Count, \"L\").End(xlUp).Row\n\n                'As the download is grouped in Product Line order find the first and last row of the Product according to the worksheet name\n                    With FDWDownload1\n                        FDWDownload1.Activate\n                        k = .Range(\"L:L\").Find(what:=ws.name, after:=.Range(\"L1\")).Row\n                        l = .Range(\"L:L\").Find(what:=ws.name, after:=.Range(\"L1\"), searchdirection:=xlPrevious).Row\n                    End With\n                Range(\"A\" &amp; k &amp; \":O\" &amp; l).Copy\n                ws.Activate\n                ws.Range(\"A\" &amp; ForLastRow + 1).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n                Columns(\"A:P\").EntireColumn.AutoFit\n                Columns(\"A:O\").AutoFilter\n                Range(\"A:O\").Sort Key1:=Range(\"C1\"), Order1:=xlAscending, Header:=xlYes\n\n                ActiveSheet.name = ws.name &amp; \" \" &amp; \"GRIR\" &amp; \" \" &amp; mBefore\n\nNext i\n        Else\n        End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vlookup"], "comments": [{"owner": {"reputation": 341, "user_id": 8826022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb38589eec35643089af93724c1d9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Murphy", "link": "https://stackoverflow.com/users/8826022/michael-murphy"}, "edited": false, "score": 1, "creation_date": 1567535625, "post_id": 57777060, "comment_id": 101989121, "body": "What&#39;s the problem you&#39;re experiencing?"}, {"owner": {"reputation": 63, "user_id": 5871047, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-lukNeagYU1Q/AAAAAAAAAAI/AAAAAAAAB-0/Y-AKHPaFTcA/photo.jpg?sz=128", "display_name": "rakesh jayaram", "link": "https://stackoverflow.com/users/5871047/rakesh-jayaram"}, "reply_to_user": {"reputation": 341, "user_id": 8826022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb38589eec35643089af93724c1d9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Murphy", "link": "https://stackoverflow.com/users/8826022/michael-murphy"}, "edited": false, "score": 0, "creation_date": 1567536131, "post_id": 57777060, "comment_id": 101989319, "body": "I get &quot;#N/A&quot; as output in cell"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1567536705, "post_id": 57777060, "comment_id": 101989546, "body": "What is the point of a VLOOKUP on a single column range?"}, {"owner": {"reputation": 63, "user_id": 5871047, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-lukNeagYU1Q/AAAAAAAAAAI/AAAAAAAAB-0/Y-AKHPaFTcA/photo.jpg?sz=128", "display_name": "rakesh jayaram", "link": "https://stackoverflow.com/users/5871047/rakesh-jayaram"}, "edited": false, "score": 0, "creation_date": 1567537315, "post_id": 57777060, "comment_id": 101989773, "body": "to check its existence in the other sheet"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568216305, "post_id": 57777060, "comment_id": 102206538, "body": "@rakeshsharma  , May I Ask you to leave me some feedbacks on the answer I proposed ? If it answers to your needs May I ask you to accept my answer :  <a href=\"https://meta.stackexchange.com/a/5235\">look here to see how to accept</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "is_accepted": false, "score": 0, "last_activity_date": 1567548332, "creation_date": 1567548332, "answer_id": 57779257, "question_id": 57777060, "link": "https://stackoverflow.com/questions/57777060/vba-macro-to-use-vlookup/57779257#57779257", "title": "vba macro to use vlookup", "body": "<p>Maybe you need to set where <code>table2</code> is </p>\n\n<p>You can give this a try if <code>hiveCatalog</code> is where the table is located. </p>\n\n<pre><code>Sheet1.Cells(Row, Clm) = Application.VLookup(Sheet1.Cells(Row, Clm) = WorksheetFunction.VLookup(c1, Worksheets(\"hiveCatalog\").Table2, 1, False))\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5871047, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-lukNeagYU1Q/AAAAAAAAAAI/AAAAAAAAB-0/Y-AKHPaFTcA/photo.jpg?sz=128", "display_name": "rakesh jayaram", "link": "https://stackoverflow.com/users/5871047/rakesh-jayaram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1567548332, "creation_date": 1567535582, "last_edit_date": 1592644375, "question_id": 57777060, "link": "https://stackoverflow.com/questions/57777060/vba-macro-to-use-vlookup", "title": "vba macro to use vlookup", "body": "<p>I am trying to fetch the value using a vba macro and vlookup in excel. Expected value is the value from &quot;hiveCatalog&quot; sheet but actual result is &quot;N/A&quot;</p>\n<p>When i try normal vlookup in excel, i do get the expected value.</p>\n<p>Below is the code - written to update a specific column in the first sheet using the value from another sheet.</p>\n<pre><code>Sub **addVlookUpColumn**()\n\n Dim Row As Long\n Dim Clm   As Long\n Dim Sheet1 As Worksheet, Sheet2 As Worksheet\n\n Set Sheet1 = ThisWorkbook.Worksheets(&quot;Attributesstagingdirectload&quot;)\n Set Sheet2 = ThisWorkbook.Worksheets(&quot;hiveCatalog&quot;)\n\nTable1 = Sheet1.Range(&quot;A2:A11000&quot;)\nTable2 = Sheet2.Range(&quot;A3:A11000&quot;)\nRow = Sheet1.Range(&quot;D2&quot;).Row\nClm = Sheet2.Range(&quot;D2&quot;).Column\n\nFor Each cl In Table1\n Sheet1.Cells(Row, Clm) = Application.VLookup(c1, Table2, 1, False)\n  Row = Row + 1\nNext cl\n</code></pre>\n<p>End Sub</p>\n<p>Do let me know where i am going wrong</p>\n<p>Below image contains the column header of both the sheets and sheet names\n<a href=\"https://i.stack.imgur.com/qJ3EG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qJ3EG.png\" alt=\"enter image description here\" /></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1567534670, "post_id": 57776797, "comment_id": 101988743, "body": "<code>NextRow</code> should be declared as <code>Long</code>, not as a <code>String</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1567534787, "post_id": 57776797, "comment_id": 101988775, "body": "@DarrellH true, but unlikely the problem here"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "edited": false, "score": 0, "creation_date": 1567535552, "post_id": 57776914, "comment_id": 101989097, "body": "Thank you, this help a lot"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 6, "last_activity_date": 1567535660, "last_edit_date": 1567535660, "creation_date": 1567534908, "answer_id": 57776914, "question_id": 57776797, "link": "https://stackoverflow.com/questions/57776797/range-find-generates-object-variable-or-with-block-variable-not-set/57776914#57776914", "title": ".Range(&quot;...&quot;).Find generates Object variable or With Block variable not set", "body": "<blockquote>\n<pre><code>NextRow = ws.Range(\"A:K\").Find(What:=\"This City Is:\").Row\n</code></pre>\n</blockquote>\n\n<p>You're assuming that <code>Range.Find</code> will find what it's looking for... and it doesn't.</p>\n\n<p>So the <code>.Row</code> member call goes against <code>Nothing</code>, because <code>Range.Find</code> returns <code>Nothing</code> when it doesn't find what it's looking for. Any member call made against <code>Nothing</code> will raise error 91.</p>\n\n<p><strong>NEVER</strong> use the return value of <code>Range.Find</code> without first validating it. Capture the return value in a <code>Range</code> reference:</p>\n\n<pre><code>Dim result As Range\nSet result = ws.Range(\"...\").Find(...)\n</code></pre>\n\n<p>Then make sure it's not <code>Nothing</code>:</p>\n\n<pre><code>If Not result Is Nothing Then\n    NextRow = result.Row\n    ...\nEnd If\n</code></pre>\n\n<hr>\n\n<p>Note that <a href=\"http://www.github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> (free, open-source VBIDE add-in project that I manage) warns about this (and MANY other) situation:</p>\n\n<p><a href=\"http://rubberduckvba.com/Inspections/Details/ExcelMemberMayReturnNothing\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Zgj8c.png\" alt=\"Result of &#39;Range.Find&#39; call is not tested for &#39;Nothing&#39;\"></a></p>\n"}], "owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 57776914, "answer_count": 1, "score": 1, "last_activity_date": 1572938074, "creation_date": 1567534232, "last_edit_date": 1572938074, "question_id": 57776797, "link": "https://stackoverflow.com/questions/57776797/range-find-generates-object-variable-or-with-block-variable-not-set", "title": ".Range(&quot;...&quot;).Find generates Object variable or With Block variable not set", "body": "<p>I want to find a keyword and then execute an action on it.</p>\n\n<pre><code>Dim ws as Worksheet\nDim LastRow As Long\nDim NextRow as Long\n\nSet ws = ActiveWorkbook.ActiveSheet\n\nLastRow = ws.Range(\"A:A\").Find(What:=\"\", After:=Range(\"A10\")).Row\n\nNextRow = ws.Range(\"A:K\").Find(What:=\"This City Is:\").Row\n\nws.Cells(LastRow, 1) = Me.tbTextbox1.Value\nws.Cells(LastRow, 2) = Me.tbTextbox1.Value\nws.Cells(LastRow, 3) = Me.tbTextbox3.Value\nws.Cells(NextRow, 4) = \"This City is: \" + Me.tbTextbox4.Value\n\nEnd Sub\n</code></pre>\n\n<p>The part I am having a problem with is NextRow.</p>\n\n<pre><code>NextRow = ws.Range(\"A:K\").Find(What:=\"This City Is:\").Row\n</code></pre>\n\n<p>It is saying</p>\n\n<blockquote>\n  <p>\"Object variable or With Block variable not set\"</p>\n</blockquote>\n\n<p>I am trying to have Textbox4 row equal wherever the Text \"This City Is:\" would be. Because sometimes if I decide to insert a line somewhere, I still want the code to follow this term.</p>\n"}, {"tags": ["vba", "variables", "powerpoint", "rgb"], "comments": [{"owner": {"reputation": 166, "user_id": 11384581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ7fG.jpg?s=128&g=1", "display_name": "TheJeebo", "link": "https://stackoverflow.com/users/11384581/thejeebo"}, "edited": false, "score": 0, "creation_date": 1567534949, "post_id": 57776654, "comment_id": 101988836, "body": "The RGB() function can&#39;t be used like a string like in the first loop. Additionally, you can&#39;t pass a string into the RGB() function as it requires 3 Integers. Your best bet is to make 3 integer variables that the user can change that are then passed into the RGB() function."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567535802, "post_id": 57776654, "comment_id": 101989186, "body": "RGB color is a <code>Long</code> (best represented with a hex literal e.g. <code>&amp;H00FFDD</code>), not a <code>String</code>..."}, {"owner": {"reputation": 23, "user_id": 12015057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9ccfdd675d8b205194555abde50d47?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/12015057/dave"}, "edited": false, "score": 0, "creation_date": 1567544072, "post_id": 57776654, "comment_id": 101992131, "body": "Thanks for the response. I took TheJeebo advice and created a variable for each RGB and passed each separately."}], "answers": [{"tags": [], "owner": {"reputation": 166, "user_id": 11384581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ7fG.jpg?s=128&g=1", "display_name": "TheJeebo", "link": "https://stackoverflow.com/users/11384581/thejeebo"}, "is_accepted": false, "score": 0, "last_activity_date": 1567538629, "creation_date": 1567538629, "answer_id": 57777645, "question_id": 57776654, "link": "https://stackoverflow.com/questions/57776654/powerpoint-vba-passing-rgb-colors-as-a-variable/57777645#57777645", "title": "Powerpoint VBA - Passing RGB colors as a variable", "body": "<p>I got this to work, I usually work with Excel so there may be a better way to do this. Also, I would recommend some error trapping in case the user doesn't enter in the number in the right format \"#, #, #\". But this will essentially take the string of your default color or the color the user has entered in, split it into 3 parts and then pass it to the RGB() function.</p>\n\n<pre><code>Dim osld As Slide\nDim oshp As Shape\nDim strMainColor As String, strSecondColor As String\n'these are new\nDim MainInt As Variant, SecondInt As Variant\n\n'Set main color to default if users didn't enter a RGB value\nIf MainColor.Value = \"\" Then\n    strMainColor = \"73, 109, 164\"\n    MainInt = Split(strMainColor, \",\")\nElse\n    strMainColor = MainColor.Value\n    MainInt = Split(strMainColor, \",\")\nEnd If\n\n'Set Secondary color to default if users didn't enter a RGB value\nIf SecondColor.Value = \"\" Then\n    strSecondColor = \"207, 203, 201\"\n    SecondInt = Split(strSecondColor, \",\")\nElse\n    strSecondColor = SecondColor.Value\n    SecondInt = Split(strSecondColor, \",\")\nEnd If\n\nFor Each osld In ActivePresentation.Slides\nFor Each oshp In osld.Shapes\nIf Right(oshp.Name, 2) = \"_1\" Then\n   'Main Color to all slides\n   oshp.Fill.ForeColor.RGB = RGB(MainInt(0), MainInt(1), MainInt(2))\n   oshp.Fill.BackColor.RGB = RGB(MainInt(0), MainInt(1), MainInt(2))\n   ElseIf Right(oshp.Name, 2) = \"_2\" Then\n    'Secondary Colors\n    oshp.Fill.ForeColor.RGB = RGB(SecondInt(0), SecondInt(1), SecondInt(2))\n    oshp.Fill.BackColor.RGB = RGB(SecondInt(0), SecondInt(1), SecondInt(2))\nEnd If\nNext oshp\nNext osld\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 369, "user_id": 5620644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70050e5c09ce3171441cb1f0edc3bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Andras", "link": "https://stackoverflow.com/users/5620644/andras"}, "is_accepted": false, "score": 1, "last_activity_date": 1567538988, "creation_date": 1567538988, "answer_id": 57777709, "question_id": 57776654, "link": "https://stackoverflow.com/questions/57776654/powerpoint-vba-passing-rgb-colors-as-a-variable/57777709#57777709", "title": "Powerpoint VBA - Passing RGB colors as a variable", "body": "<p>As others have suggested RGB definition cannot be fed by strings.</p>\n\n<p>How about creating a Custom Type \"Color\" and use that to pass on the colour wherever you need it.</p>\n\n<p>If you are going to use this don't forget to put the Custom Type Definition block (Type Color) before the line <code>Sub Test()</code></p>\n\n<pre><code>Option Explicit\n\nType Color\n    R As Integer\n    G As Integer\n    B As Integer\nEnd Type\n\nSub Test()\n\n    Dim osld As Slide\n    Dim oshp As Shape\n    Dim MainColor As Color\n    Dim SecondColor As Color\n\n    'Set main color to default if users didn't enter a RGB value\n    With MainColor\n        If .R = 0 And .G = 0 And .B = 0 Then\n            .R = 73\n            .G = 109\n            .B = 164\n        End If\n    End With\n\n    'Set Secondary color to default if users didn't enter a RGB value\n    With SecondColor\n        If .R = 0 And .G = 0 And .B = 0 Then\n            .R = 207\n            .G = 203\n            .B = 201\n        End If\n    End With\n\n\n    For Each osld In ActivePresentation.Slides\n        For Each oshp In osld.Shapes\n            If Right(oshp.Name, 2) = \"_1\" Then\n               'Main Color to all slides\n                oshp.Fill.ForeColor.RGB = RGB(MainColor.R, MainColor.G, MainColor.B)\n                oshp.Fill.BackColor.RGB = RGB(MainColor.R, MainColor.G, MainColor.B)\n            ElseIf Right(oshp.Name, 2) = \"_2\" Then\n                'Secondary Colors\n                oshp.Fill.ForeColor.RGB = RGB(SecondColor.R, SecondColor.G, SecondColor.B)\n                oshp.Fill.BackColor.RGB = RGB(SecondColor.R, SecondColor.G, SecondColor.B)\n            End If\n        Next oshp\n    Next osld\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 12015057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9ccfdd675d8b205194555abde50d47?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/12015057/dave"}, "edited": false, "score": 0, "creation_date": 1572892979, "post_id": 57778937, "comment_id": 103694824, "body": "Hi ComputerVersteher, thank you for your response. I tried your response since ideally that would be the best ideal solution if it worked, but nothing seems to be happening. I pasted the code above and updated my on click button to now use your scripts, but nothing happens now. Should I have been prompted to select a color for both main and second using your script?"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 23, "user_id": 12015057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9ccfdd675d8b205194555abde50d47?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/12015057/dave"}, "edited": false, "score": 0, "creation_date": 1572896929, "post_id": 57778937, "comment_id": 103696294, "body": "Yes the dialog should appear two times. Sure code is executed (check by breakpoint or Msgbox)? Code compiles (Vba -&gt; Debug -&gt; Compile VBAProject)? Office Version and Bitness?"}, {"owner": {"reputation": 23, "user_id": 12015057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9ccfdd675d8b205194555abde50d47?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/12015057/dave"}, "edited": false, "score": 0, "creation_date": 1572986045, "post_id": 57778937, "comment_id": 103731014, "body": "Hi ComputerVersteher, thank you for your response and i appreciate your patience. I tried to msgbox the ColorPickerDialog and it returned a number. I&#39;m assuming that number was the default color set in the function. It doesn&#39;t prompt me to select a color. In terms of office version, I&#39;m using PowerPoint 365."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 23, "user_id": 12015057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9ccfdd675d8b205194555abde50d47?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/12015057/dave"}, "edited": false, "score": 0, "creation_date": 1572995601, "post_id": 57778937, "comment_id": 103734388, "body": "Bitness? If x64, try example here <a href=\"https://stackoverflow.com/a/54957092/9439330\">stackoverflow.com/a/54957092/9439330</a>."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 23, "user_id": 12015057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9ccfdd675d8b205194555abde50d47?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/12015057/dave"}, "edited": false, "score": 0, "creation_date": 1572999091, "post_id": 57778937, "comment_id": 103735255, "body": "<a href=\"https://codekabinett.com/rdumps.php?Lang=2&amp;targetDoc=windows-api-declaration-vba-64-bit\" rel=\"nofollow noreferrer\">A common pitfall - The size of user-defined types</a>(at end). Try edited code (Len to LenB)."}, {"owner": {"reputation": 23, "user_id": 12015057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9ccfdd675d8b205194555abde50d47?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/12015057/dave"}, "edited": false, "score": 0, "creation_date": 1573066389, "post_id": 57778937, "comment_id": 103763647, "body": "Thank you ComputerVersteher, the LenB change worked. You rock!"}], "tags": [], "owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "is_accepted": true, "score": 1, "last_activity_date": 1572999151, "last_edit_date": 1572999151, "creation_date": 1567546001, "answer_id": 57778937, "question_id": 57776654, "link": "https://stackoverflow.com/questions/57776654/powerpoint-vba-passing-rgb-colors-as-a-variable/57778937#57778937", "title": "Powerpoint VBA - Passing RGB colors as a variable", "body": "<p>What about using the <a href=\"http://vbnet.mvps.org/index.html?code/hooks/choosecolorcustomize.htm\" rel=\"nofollow noreferrer\">windows color picker</a>.</p>\n\n<p>Code in standard module:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPrivate Const CC_FULLOPEN = &amp;H2\nPrivate dwCustClrs(0 To 15) As Long\n\n#If VBA7 Then\n    Private Type COLORSTRUC\n      lStructSize As Long\n      hwndOwner As LongPtr\n      hInstance As LongPtr\n      rgbResult As Long\n      lpCustColors As LongPtr\n      flags As Long\n      lCustData As LongPtr\n      lpfnHook As LongPtr\n      lpTemplateName As String\n    End Type\n#Else\n    Private Type COLORSTRUC\n      lStructSize As Long\n      hwndOwner As Long\n      hInstance As Long\n      rgbResult As Long\n      lpCustColors As Long\n      flags As Long\n      lCustData As Long\n      lpfnHook As Long\n      lpTemplateName As String\n    End Type\n#End If\n\n#If VBA7 Then\n    Private Declare PtrSafe Function ChooseColor Lib \"comdlg32.dll\" Alias \"ChooseColorA\" (pChoosecolor As COLORSTRUC) As Long\n#Else\n    Private Declare Function ChooseColor Lib \"comdlg32.dll\" Alias \"ChooseColorA\" (pChoosecolor As COLORSTRUC) As Long\n#End If\n\nPrivate Sub SetCustomColors() 'Define custom colors of picker here.\n    dwCustClrs(0) = vbBlack\n    dwCustClrs(1) = vbWhite\n    dwCustClrs(2) = vbRed\n    dwCustClrs(4) = vbGreen\n    dwCustClrs(5) = vbBlue\n    dwCustClrs(6) = RGB(0, 0, 0)\n    dwCustClrs(7) = vbBlack\n    dwCustClrs(8) = vbBlack\n    dwCustClrs(9) = vbBlack\n    dwCustClrs(10) = vbBlack\n    dwCustClrs(11) = vbBlack\n    dwCustClrs(12) = vbBlack\n    dwCustClrs(13) = vbBlack\n    dwCustClrs(14) = vbBlack\n    dwCustClrs(15) = vbBlack\nEnd Sub\n\nPublic Function ColorPickerDialog(Optional DefaultColor As Long = vbWhite) As Long\n  Dim x As Long, CS As COLORSTRUC\n  SetCustomColors 'Comment out if all custom colors should be black\n  CS.lStructSize = LenB(CS) ' not Len, see https://codekabinett.com/rdumps.php?Lang=2&amp;targetDoc=windows-api-declaration-vba-64-bit at end\n  CS.flags = CC_FULLOPEN\n  CS.lpCustColors = VarPtr(dwCustClrs(0))\n  x = CHOOSECOLOR(CS)\n  If x = 0 Then\n    ColorPickerDialog = DefaultColor\n    Exit Function\n  Else\n    ColorPickerDialog = CS.rgbResult\n  End If\nEnd Function\n</code></pre>\n\n<p>Set shapes:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim osld As Slide\nDim oshp As Shape\nDim MainColor As Long, SecondColor As Long\n\n'Chose MainColor\nMainColor = ColorPickerDialog(RGB(73, 109, 164)) ' if no color choosen the default color RGB(73, 109, 164) is used\n\n'Choose SecondColors\nSecondColor = ColorPickerDialog(RGB(207, 203, 201))\n\n\nFor Each osld In ActivePresentation.Slides\n    For Each oshp In osld.Shapes\n        With oshp\n            If Right(.Name, 2) = \"_1\" Then\n               'Main Color to all slides\n               .Fill.ForeColor.RGB = MainColor\n               .Fill.BackColor.RGB = MainColor \n             ElseIf Right(.Name, 2) = \"_2\" Then\n                'Secondary Colors\n                .Fill.ForeColor.RGB = SecondColor\n                .Fill.BackColor.RGB = SecondColor\n            End If\n        End With\n    Next oshp\nNext osld\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12015057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9ccfdd675d8b205194555abde50d47?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/12015057/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 0, "accepted_answer_id": 57778937, "answer_count": 3, "score": 2, "last_activity_date": 1583835463, "creation_date": 1567533470, "last_edit_date": 1583835463, "question_id": 57776654, "link": "https://stackoverflow.com/questions/57776654/powerpoint-vba-passing-rgb-colors-as-a-variable", "title": "Powerpoint VBA - Passing RGB colors as a variable", "body": "<p>I want to allow users to enter in a RGB color via a text box and pass that variable to change the colors of all shapes. I wrote a loop that would look at the last 2 characters of the shape name to determine if it should be changed to the primary or secondary color.</p>\n\n<p>This is for powerpoint from the latest office 365.</p>\n\n<p>I've tried the following codes. I am getting either an type mismatch or invalid argument error:</p>\n\n<pre><code>Dim osld As Slide\nDim oshp As Shape\nDim strMainColor As String, strSecondColor As String\n\n'Set main color to default if users didn't enter a RGB value\nIf MainColor.Value = \"\" Then strMainColor = \"73, 109, 164\" Else strMainColor = MainColor.Value\n\n'Set Secondary color to default if users didn't enter a RGB value\nIf SecondColor.Value = \"\" Then strSecondColor = \"207, 203, 201\" Else strSecondColor = SecondColor.Value\n\nFor Each osld In ActivePresentation.Slides\nFor Each oshp In osld.Shapes\nIf Right(oshp.Name, 2) = \"_1\" Then\n   'Main Color to all slides\n   oshp.Fill.ForeColor.RGB = \"RGB(\" + strMainColor + \")\"\n   oshp.Fill.BackColor.RGB = \"RGB(\" + strMainColor + \")\"\n   ElseIf Right(oshp.Name, 2) = \"_2\" Then\n    'Secondary Colors\n    oshp.Fill.ForeColor.RGB = \"RGB(\" + strSecondColor + \")\"\n    oshp.Fill.BackColor.RGB = \"RGB(\" + strSecondColor + \")\"\nEnd If\nNext oshp\nNext osld\n\n\n\nDim osld As Slide\nDim oshp As Shape\nDim strMainColor As String, strSecondColor As String\n\n'Set main color to default if users didn't enter a RGB value\nIf MainColor.Value = \"\" Then strMainColor = \"73, 109, 164\" Else strMainColor = MainColor.Value\n\n'Set Secondary color to default if users didn't enter a RGB value\nIf SecondColor.Value = \"\" Then strSecondColor = \"207, 203, 201\" Else strSecondColor = SecondColor.Value\n\nFor Each osld In ActivePresentation.Slides\nFor Each oshp In osld.Shapes\nIf Right(oshp.Name, 2) = \"_1\" Then\n   'Main Color to all slides\n   oshp.Fill.ForeColor.RGB = RGB(strMainColor)\n   oshp.Fill.BackColor.RGB = RGB(strMainColor)\n   ElseIf Right(oshp.Name, 2) = \"_2\" Then\n    'Secondary Colors\n    oshp.Fill.ForeColor.RGB = RGB(strSecondColor)\n    oshp.Fill.BackColor.RGB = RGB(strSecondColor)\nEnd If\nNext oshp\nNext osld\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerquery"], "comments": [{"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 2, "creation_date": 1567536613, "post_id": 57776608, "comment_id": 101989508, "body": "Can you show us the code you&#39;ve written so far?"}, {"owner": {"reputation": 19, "user_id": 11873664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27cf2d1a4fd59fdf9f2bae478dfbb104?s=128&d=identicon&r=PG&f=1", "display_name": "carljong2019", "link": "https://stackoverflow.com/users/11873664/carljong2019"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1567537087, "post_id": 57776608, "comment_id": 101989697, "body": "As I said, I tried to record it but nothing recorded.  I&#39;ve read some other posts that say just use the GUI to set up the query, which I did.  However, hard coding a password doesn&#39;t work.  I&#39;m trying to figure out how I can set it programmatically.  But, when i look at the properties, it doesn&#39;t even look like you can set the password for a Power Query in VBA."}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1567887515, "post_id": 57776608, "comment_id": 102102633, "body": "You should <b>NEVER</b> save username and password! You should <b>NEVER</b> ask for user&#39;s password! I&#39;m pretty the users are just smiling at you, wishing you best of luck."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11873664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27cf2d1a4fd59fdf9f2bae478dfbb104?s=128&d=identicon&r=PG&f=1", "display_name": "carljong2019", "link": "https://stackoverflow.com/users/11873664/carljong2019"}, "edited": false, "score": 0, "creation_date": 1567623456, "post_id": 57778901, "comment_id": 102021799, "body": "You said &quot;you need to give all people access to the data sources contained in the workbook.&quot;  That sounds like the correct approach.  Could you give some more specific details on what you mean?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 19, "user_id": 11873664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27cf2d1a4fd59fdf9f2bae478dfbb104?s=128&d=identicon&r=PG&f=1", "display_name": "carljong2019", "link": "https://stackoverflow.com/users/11873664/carljong2019"}, "edited": false, "score": 0, "creation_date": 1567629331, "post_id": 57778901, "comment_id": 102023732, "body": "I mean that if the workbook has a query to a SQL Server database, for example, the person refreshing the query needs to enter credentials that can access the SQL Server database. Or if it&#39;s SharePoint, they need to have the  permissions to access that SharePoint list or library. And so on."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 2, "last_activity_date": 1567545768, "creation_date": 1567545768, "answer_id": 57778901, "question_id": 57776608, "link": "https://stackoverflow.com/questions/57776608/can-i-set-the-username-and-password-for-an-excel-power-query-via-vba/57778901#57778901", "title": "Can I set the username and password for an Excel Power Query via vba?", "body": "<p>There is no way to pass credentials to a Power Query with VBA. This would be in violation of the security model around Power Query. Every user that wants to refresh a query needs to have their own access to the data source. Credentials are not stored with the workbook or in the query. Instead the credentials are set with the connections, which are independent of particular workbooks and stored on the local machine. </p>\n\n<p>In your situation, you need to give all people access to the data sources contained in the workbook.</p>\n\n<p>As an alternative, you can set up a workbook with all the queries, load the data into the grid and refresh the data as required, using your credentials. Then you can build another workbook that reads the data from that file. Give the report consumers access to that workbook, then they don't need access to the original data sources.</p>\n"}], "owner": {"reputation": 19, "user_id": 11873664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27cf2d1a4fd59fdf9f2bae478dfbb104?s=128&d=identicon&r=PG&f=1", "display_name": "carljong2019", "link": "https://stackoverflow.com/users/11873664/carljong2019"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2028, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567576907, "creation_date": 1567533238, "last_edit_date": 1567576907, "question_id": 57776608, "link": "https://stackoverflow.com/questions/57776608/can-i-set-the-username-and-password-for-an-excel-power-query-via-vba", "title": "Can I set the username and password for an Excel Power Query via vba?", "body": "<p>I'm trying to set up a spreadsheet to be used by others that updates tables via Power Query.  When another user uses the spreadsheet they are asked 3 times to enter their username and password because I have 3 tables being updated.  How can I set these for each user via VBA?</p>\n\n<p>I tried setting the connections to anonymous, but they couldn't access the data.  I already ask the user their password and could use it.  I tried seeing how to set it by doing it as I recorded a macro, but the information was not recorded.  I looked at the objects to see if the listobject or the querytable has a password setting.  There is a save password but it is a property.  It doesn't look like I can set it.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1567546012, "post_id": 57776726, "comment_id": 101992740, "body": "Did you test that? This is riddled with errors, and after they are all fixed, it still returns the last row of any spreadsheet, i.e. 1048576."}], "tags": [], "owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "is_accepted": false, "score": 1, "last_activity_date": 1567546557, "last_edit_date": 1567546557, "creation_date": 1567533905, "answer_id": 57776726, "question_id": 57776591, "link": "https://stackoverflow.com/questions/57776591/excel-macro-how-to-find-last-row/57776726#57776726", "title": "EXCEL/Macro How to find last row", "body": "<p>You could try something like this.</p>\n\n<pre><code>Sub LastRow()\n\n    Dim sht As Worksheet\n    Dim LastRow As Long\n\n\n    Set sht = ActiveSheet\n    LastRow = sht.Cells(sht.Rows.Count, \"K\").End(xlUp).Row\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1567546611, "creation_date": 1567546611, "answer_id": 57779028, "question_id": 57776591, "link": "https://stackoverflow.com/questions/57776591/excel-macro-how-to-find-last-row/57779028#57779028", "title": "EXCEL/Macro How to find last row", "body": "<p>Since you want to fill down in column K, I assume that this column is empty below the cell K2. Another column probably has data and you want to fill down as far as that other column's last row of data. </p>\n\n<p>To do that, you can determine the last row in that other column, in my example, it's column A, but you can change that. Then plug the variable <code>lastRow</code> into your AutoFill statement.</p>\n\n<pre><code>Dim sht As Worksheet\nDim lastRow As Long\n\nSet sht = ActiveSheet\n\nlastRow = sht.Cells(Rows.Count, \"A\").End(xlUp).Row\n\nsht.Range(\"K1\").FormulaR1C1 = \"Total\"\nsht.Range(\"K2\").FormulaR1C1 = \"=TEXT(RC[-2]-RC[-3]-RC[-1],\"\"h:mm\"\")\"\nsht.Range(\"K2\").AutoFill Destination:=sht.Range(\"K2:K\" &amp; lastRow)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 3184216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/896e2e8c9e342cc0d53e53c529475e6b?s=128&d=identicon&r=PG&f=1", "display_name": "gira388", "link": "https://stackoverflow.com/users/3184216/gira388"}, "is_accepted": false, "score": -1, "last_activity_date": 1567555730, "creation_date": 1567555730, "answer_id": 57779977, "question_id": 57776591, "link": "https://stackoverflow.com/questions/57776591/excel-macro-how-to-find-last-row/57779977#57779977", "title": "EXCEL/Macro How to find last row", "body": "<p>Assuming you have your last row in column A:</p>\n\n<pre><code> Columns(\"K:K\").Select\n Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n Range(\"K1\").Select\n ActiveCell.FormulaR1C1 = \"Total\"\n Range(\"K2\").Select\n ActiveCell.FormulaR1C1 = \"=TEXT(RC[-2]-RC[-3]-RC[-1],\"\"h:mm\"\")\"\n Range(\"K2\").Select\n LastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n Selection.AutoFill Destination:=Range(\"K2:K\" &amp; LastRow)\n Range(\"K2:K\" &amp; LastRow).Select\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9963762, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Oq8LqyfF_SE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1D76N-4G6Q_3vdWOOXXN_UFSOyZw/mo/photo.jpg?sz=128", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/9963762/jeremy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1567570046, "creation_date": 1567533136, "last_edit_date": 1567570046, "question_id": 57776591, "link": "https://stackoverflow.com/questions/57776591/excel-macro-how-to-find-last-row", "title": "EXCEL/Macro How to find last row", "body": "<p>I used the Recorder to create this small macro... now I just need it to work with variable numbers of row (instead of my row 20000 cheat).</p>\n\n<p>Is there a tip or a trick that can tell this code to stop at the last row?</p>\n\n<pre><code> Columns(\"K:K\").Select\n Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n Range(\"K1\").Select\n ActiveCell.FormulaR1C1 = \"Total\"\n Range(\"K2\").Select\n ActiveCell.FormulaR1C1 = \"=TEXT(RC[-2]-RC[-3]-RC[-1],\"\"h:mm\"\")\"\n Range(\"K2\").Select\n Selection.AutoFill Destination:=Range(\"K2:K20000\")\n Range(\"K2:K20000\").Select\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1567533255, "post_id": 57776589, "comment_id": 101988250, "body": "<code>End Sub</code> is only used as a closing for a <code>Sub</code>. What you need is <code>Exit Sub</code> instead."}, {"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1567533444, "post_id": 57776589, "comment_id": 101988338, "body": "For more information, read the second half of the accepted answer in the linked question."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567533798, "post_id": 57776589, "comment_id": 101988468, "body": "<i>I&#39;ve tried to exit sub when TempArray IsEmpty, but for some reason it doesn&#39;t work.</i>  - <code>IsEmpty</code> returns <code>True</code> when a <code>Variant</code> subtype is <code>Variant&#47;Empty</code>: it will always be <code>False</code> for anything that isn&#39;t a <code>Variant&#47;Empty</code>. Don&#39;t use <code>IsEmpty</code> to verify whether an array contains elements. Use <code>UBound</code> for that, and in the case of <code>GetOpenFilename</code>, that <code>On Error Resume Next</code> is swallowing a <i>type mismatch</i> error when the dialog is cancelled. Remove it, and do <code>If VarType(tempArray) = vbBoolean Then Exit Sub</code> - the function returns <code>False</code> if the dialog is cancelled."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567533820, "post_id": 57776589, "comment_id": 101988479, "body": "IOW the problem is with <code>IsEmpty</code>, not <code>Exit Sub</code>."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12015918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2988ad07234e030172ce74daea00a407?s=128&d=identicon&r=PG&f=1", "display_name": "Piotrekdoro", "link": "https://stackoverflow.com/users/12015918/piotrekdoro"}, "edited": false, "score": 0, "creation_date": 1567535181, "post_id": 57776784, "comment_id": 101988927, "body": "Thank you for help, I understand. Do you happen to know how I could modify my FileFilter in a way which allows &quot;All Files&quot; option to work properly?"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1567534506, "last_edit_date": 1567534506, "creation_date": 1567534165, "answer_id": 57776784, "question_id": 57776589, "link": "https://stackoverflow.com/questions/57776589/how-to-exit-sub-early/57776784#57776784", "title": "How to exit Sub() early?", "body": "<p>The problem is with <code>IsEmpty</code>, not <code>Exit Sub</code>. <a href=\"https://stackoverflow.com/questions/36491908/whats-the-difference-between-end-and-exit-sub-in-vba\"><code>End Sub</code> can't be used like this.</a></p>\n\n<p><code>IsEmpty</code> will only ever be <code>True</code> when it's given a <code>Variant/Empty</code>. Given anything else, it returns <code>False</code>.</p>\n\n<p><code>Application.GetOpenFilename</code> does not return a variant array. It returns a <code>Variant</code> that may be an array that contains one or more filenames, <strong>or Boolean</strong> value <code>False</code> to indicate cancellation.</p>\n\n<p>So, capturing its value into a <code>Variant()</code> will throw a <em>type mismatch</em> error on cancellation - error that you are swallowing with <code>On Error Resume Next</code>... remove that first, along with <code>On Error GoTo 0</code>.</p>\n\n<p>Re-declare your result <code>As Variant</code>, and while you're at it, give it a meaningful name:</p>\n\n<pre><code>Dim selectedFiles As Variant\nselectedFiles = Application.GetOpenFilename(...)\n</code></pre>\n\n<p>Now to exit the procedure scope if the dialog was cancelled, verify what <code>Variant</code> subtype <code>selectedFiles</code> has:</p>\n\n<pre><code>If VarType(selectedFiles) = vbBoolean Then Exit Sub\n</code></pre>\n\n<p>If it's a Boolean, the dialog was cancelled. Otherwise, you're looking at an array of file names... for which you don't know the boundaries - so don't assume it's 1-based:</p>\n\n<pre><code>For i = LBound(selectedFiles) To UBound(selectedFiles)\n    ...\nNext\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><em>I can't get GetOpenFilename dialogue box to show all the other available filenames (xls, xlm, xlsx, xlsm) when \"All Files\" filter is selected</em></p>\n</blockquote>\n\n<p>AFAIK you need to specify explicitly what you want the \"all files\" filter to read like, just like every other file filter. Use wildcards as appropriate, and the dot for the file extensions:</p>\n\n<pre><code>FileFilter = \"Microsoft Excel Worksheet (*.xlsx),*.xlsx,\" &amp; _\n             \"Microsoft Excel Worksheet with Macros (*.xlsm),*.xlsm,\" &amp; _\n             \"Microsoft Excel 97-2003 Worksheet (*.xls),*.xls,\" &amp; _\n             \"Microsoft Excel 97-2003 Worksheet with Macros (*.xlm),*.xlm,\" &amp; _\n             \"All Files (*.*),*.*\"\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12015918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2988ad07234e030172ce74daea00a407?s=128&d=identicon&r=PG&f=1", "display_name": "Piotrekdoro", "link": "https://stackoverflow.com/users/12015918/piotrekdoro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 57776784, "answer_count": 1, "score": 1, "last_activity_date": 1567534506, "creation_date": 1567533133, "last_edit_date": 1567533583, "question_id": 57776589, "link": "https://stackoverflow.com/questions/57776589/how-to-exit-sub-early", "title": "How to exit Sub() early?", "body": "<p>I'm completely new to VBA for applications and I have some pretty basic questions. I'm creating a userform and I need to be able to exit one of the subs early. I simply don't want to get a debug error when I exit GetOpenFilename window without selecting any workbooks and just end the sub.\nSecondly, I can't get GetOpenFilename dialogue box to show all the other available filenames (xls, xlm, xlsx, xlsm) when \"All Files\" filter is selected. What should I change for this to work properly?</p>\n\n<p>I've tried to exit sub when TempArray IsEmpty, but for some reason it doesn't work.</p>\n\n<pre><code>   Private Sub cmdAddWorkbooks_Click()\n\n'Variables declarations\nDim FileFilter As String\nDim FilterIndex As Long\nDim Title As String\nDim MultiSelect As Boolean\nDim WorkbookCounter As Long\nDim TempArray() As Variant\nDim SelectedWorkbooksTemp() As Variant\n\nReDim SelectedWorkbooksTemp(0 To 1, 0 To 1)\n\n'Setting up GetOpenFilename parameteres\nFileFilter = \"Microsoft Excel Worksheet (*.xlsx),*xlsx,\" &amp; _\n             \"Microsoft Excel Worksheet with Macros (*.xlsm),*xlsm,\" &amp; _\n             \"Microsoft Excel 97-2003 Worksheet (*.xls),*xls,\" &amp; _\n             \"Microsoft Excel 97-2003 Worksheet with Macros (*.xlm),*xlm,\" &amp; _\n             \"All Files (.),.\"\nFilterIndex = 5\nTitle = \"Select Workbooks\"\nMultiSelect = True\n\n'Using GetOpenFilename\nOn Error Resume Next\nTempArray = Application.GetOpenFilename _\n    (FileFilter:=FileFilter, _\n    FilterIndex:=FilterIndex, _\n    Title:=Title, _\n    MultiSelect:=MultiSelect)\n'exiting doesnt work\nOn Error GoTo 0\nIf IsEmpty(TempArray) Then End Sub\n\nWorkbookCounter = UBound(TempArray)\nReDim SelectedWorkbooksTemp(1 To WorkbookCounter, 1 To WorkbookCounter)\nFor i = 1 To WorkbookCounter\n    SelectedWorkbooksTemp(i, 1) = TempArray(i)\n    SelectedWorkbooksTemp(i, 2) = Dir(TempArray(i))\nNext i\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1567532896, "post_id": 57776432, "comment_id": 101988111, "body": "Does <code>Workbooks(&quot;outputfile.xlsx&quot;).Sheets(2)</code> exist? I am talking about i) the workbook itself and ii) the sheet with index 2"}, {"owner": {"reputation": 1, "user_id": 11660328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a37206c304656bb03410f88830bd366c?s=128&d=identicon&r=PG&f=1", "display_name": "DZIQ", "link": "https://stackoverflow.com/users/11660328/dziq"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1567533725, "post_id": 57776432, "comment_id": 101988434, "body": "Yes, the workbook is being opened prior to the code where i try to copy over the new sheet. The workbook has 1 sheet currently in it when it&#39;s opened and I&#39;m trying to copy a new sheet after the sheet that&#39;s already there."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1567534397, "post_id": 57776432, "comment_id": 101988667, "body": "If thwe workbook has 1 sheet only then <code>Sheets(2)</code> will run into an error"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1567535056, "post_id": 57776432, "comment_id": 101988877, "body": "see how I did it, not saying it&#39;s the best though: <a href=\"https://stackoverflow.com/a/30605765/4961700\">stackoverflow.com/a/30605765/4961700</a>"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568216260, "post_id": 57776432, "comment_id": 102206508, "body": "@DZIQ  , May I Ask you to leave me some feedbacks on the answer I proposed ? If it answers to your needs May I ask you to accept my answer :  <a href=\"https://meta.stackexchange.com/a/5235\">look here to see how to accept</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "is_accepted": false, "score": 0, "last_activity_date": 1567543906, "creation_date": 1567543906, "answer_id": 57778592, "question_id": 57776432, "link": "https://stackoverflow.com/questions/57776432/copy-worksheets-from-1-workbook-to-another-open-workbook/57778592#57778592", "title": "Copy worksheets from 1 workbook to another open workbook", "body": "<p>Maybe you can use this :</p>\n\n<pre><code>Workbooks(\"Book1.xlsx\").Worksheets.Copy Before:=Workbooks(\"Book2.xlsx\").Sheets(1)\n</code></pre>\n\n<p>If you don't know the meaning of <code>sheet(1)</code> you can do <code>debug.print sheet(1).Name</code></p>\n\n<p>Kindest regards. </p>\n"}], "owner": {"reputation": 1, "user_id": 11660328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a37206c304656bb03410f88830bd366c?s=128&d=identicon&r=PG&f=1", "display_name": "DZIQ", "link": "https://stackoverflow.com/users/11660328/dziq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567543906, "creation_date": 1567532316, "last_edit_date": 1567532678, "question_id": 57776432, "link": "https://stackoverflow.com/questions/57776432/copy-worksheets-from-1-workbook-to-another-open-workbook", "title": "Copy worksheets from 1 workbook to another open workbook", "body": "<p>I'm using the below code to move a worksheet from one open workbook to another open workbook but it's breaking on the last line of the code. From everything that I see online, it looks like this code should work. </p>\n\n<pre><code>Error MSG : (Run-time error '9') (Subscription out of range)\n\nSheets(\"Summary ML\").Select\n\nWorkbooks.Open Filename:=outputfile\nWindows(wb).Activate\nSheets(\"Summary ML\").Select\nSheets(\"Summary ML\").Copy After:=Workbooks(\"outputfile.xlsx\").Sheets(2)\n</code></pre>\n"}, {"tags": ["excel", "vba", "for-loop", "nested-loops"], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1567530986, "creation_date": 1567530986, "answer_id": 57776160, "question_id": 57776070, "link": "https://stackoverflow.com/questions/57776070/is-there-a-way-to-have-a-for-statement-within-a-nested-if-loop/57776160#57776160", "title": "Is there a way to have a &quot;FOR&quot; statement within a nested-if loop?", "body": "<p>Give this a go and let me know any questions. I didn't comment to much because the code flow should be self-explanatory.</p>\n\n<pre><code>Option Explicit\n\nDim ws As Worksheet\n\nPrivate Sub cmdDeleteProj_Click()\n\n    'Remove project sheet after project has been completed\n\n    'Show error message if user input field is blank\n    If txtRemProjNum.Value = \"\" Then\n        MsgBox \"Input valid project number to continue.\", vbExclamation, \"Required Field Left Blank\"\n        uf_RemProj.txtRemProjNum.SetFocus\n        Exit Sub\n    End If\n\n    Dim projectFound As Boolean\n\n    'Delete user defined project sheet if it exists\n    For Each ws In ThisWorkbook.Worksheets\n        If ws.Name = txtRemProjNum Then\n            Application.DisplayAlerts = False\n            ws.Delete\n            Application.DisplayAlerts = True\n            MsgBox \"Project removed from inventory tracker.\"\n            projectFound = True\n            Exit For\n        End If\n    Next ws\n\n    If Not projectFound Then\n        MsgBox \"Project number not found.\" &amp; vbNewLine &amp; \"\" &amp; vbNewLine &amp; \"Input valid project number.\", vbCritical, \"Out of Range\"\n        uf_RemProj.txtRemProjNum.Text = \"\"\n        uf_RemProj.txtRemProjNum.SetFocus\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": false, "score": 0, "last_activity_date": 1567531025, "creation_date": 1567531025, "answer_id": 57776171, "question_id": 57776070, "link": "https://stackoverflow.com/questions/57776070/is-there-a-way-to-have-a-for-statement-within-a-nested-if-loop/57776171#57776171", "title": "Is there a way to have a &quot;FOR&quot; statement within a nested-if loop?", "body": "<p>I think you are seeing both messages because the worksheet is there in the first loop and not in the second. Why not just loop through once and use an <code>elseif</code> statement</p>\n\n<pre><code>For Each ws In ActiveWorkbook.Worksheets\n    If ws.Name = txtRemProjNum Then\n        Application.DisplayAlerts = False\n        ws.Delete\n        Application.DisplayAlerts = True\n        MsgBox \"Project removed from inventory tracker.\"\n    ElseIf\n        txtRemProjNum.Value &lt;&gt; \"\" And ws.Name &lt;&gt; txtRemProjNum Then\n        MsgBox \"Project number not found.\" &amp; vbNewLine &amp; \"\" &amp; vbNewLine &amp; \"Input \n                valid project number.\", vbCritical, \"Out of Range\"\n        uf_RemProj.txtRemProjNum.Text = \"\"\n        uf_RemProj.txtRemProjNum.SetFocus\n    End If\nNext ws\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 11442234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30221d1179a13aaf6d84e7f7544db79c?s=128&d=identicon&r=PG&f=1", "display_name": "radeg", "link": "https://stackoverflow.com/users/11442234/radeg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 57776160, "answer_count": 2, "score": 0, "last_activity_date": 1567563437, "creation_date": 1567530496, "last_edit_date": 1567563437, "question_id": 57776070, "link": "https://stackoverflow.com/questions/57776070/is-there-a-way-to-have-a-for-statement-within-a-nested-if-loop", "title": "Is there a way to have a &quot;FOR&quot; statement within a nested-if loop?", "body": "<p>I am attempting to delete a sheet within a workbook if it matches a user inputted value. If the value does not exist, show an error message. Is there a better way to do this than what I currently have?</p>\n\n<p>Initially, I tried a nested-if loop with several if statements to get my achieved result but that did not work. The code below is what I've come to but it still has some bugs in it. For example, when the first FOR condition is met, the message box will appear for both FOR statements (which is incorrect).</p>\n\n<pre><code>Dim ws As Worksheet\n\nPrivate Sub cmdDeleteProj_Click()\n'\n'Remove project sheet after project has been completed\n'\n\n'Show error message if user input field is blank\nIf txtRemProjNum.Value = \"\" Then\n    MsgBox \"Input valid project number to continue.\", vbExclamation, \"Required Field Left Blank\"\n    uf_RemProj.txtRemProjNum.SetFocus\nEnd If\n\n'Delete user defined project sheet if it exists\nOn Error Resume Next\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Name = txtRemProjNum Then\n        Application.DisplayAlerts = False\n        ws.Delete\n        Application.DisplayAlerts = True\n        MsgBox \"Project removed from inventory tracker.\"\n    End If\nNext ws\n\n'Show error message if project does not exist\nOn Error Resume Next\nFor Each ws In ActiveWorkbook.Worksheets\n    If txtRemProjNum.Value &lt;&gt; \"\" And ws.Name &lt;&gt; txtRemProjNum Then\n        MsgBox \"Project number not found.\" &amp; vbNewLine &amp; \"\" &amp; vbNewLine &amp; \"Input valid project number.\", vbCritical, \"Out of Range\"\n        uf_RemProj.txtRemProjNum.Text = \"\"\n        uf_RemProj.txtRemProjNum.SetFocus\n    End If\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>I expect a sheet to be deleted if it exists, but cannot get the if statements and FOR loops to work.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1567529086, "post_id": 57775726, "comment_id": 101986700, "body": "Yes, for most purposes, but there are exceptions eg <a href=\"https://stackoverflow.com/questions/23433096/using-a-udf-in-excel-to-update-the-worksheet\" title=\"using a udf in excel to update the worksheet\">stackoverflow.com/questions/23433096/&hellip;</a>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1567529292, "post_id": 57775726, "comment_id": 101986767, "body": "A sub should work though, it&#39;s a function that is problematic."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1567529515, "post_id": 57775726, "comment_id": 101986838, "body": "What goes wrong? Can you clarify &quot;but the code seems to be breaking when I attempt to assign a value to a cell outside that of the calling cell&quot;? With a Sub, you can usually edit any cell you desire...?"}, {"owner": {"reputation": 1, "user_id": 12015686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294deed083449ce35e7ccae4e68d1a4b?s=128&d=identicon&r=PG&f=1", "display_name": "tgoetjen", "link": "https://stackoverflow.com/users/12015686/tgoetjen"}, "edited": false, "score": 0, "creation_date": 1567531956, "post_id": 57775726, "comment_id": 101987748, "body": "Sure! Sorry for being vague. The message box line: MsgBox (&quot;New c.Value value is: &quot; &amp; c.Offset(0, (1 + RotNum)).Value) never shows up, but the one two lines prior appears just fine"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1567533110, "post_id": 57775726, "comment_id": 101988197, "body": "<i>It seems as though vba simply does not allow changing the value of a cell from a different cell. Is this true?</i> - nope. VBA would be pretty much useless if that were the case. Is that your entire code? Consider <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indenting it</a> to make it easier to follow the block structures. It makes no sense that a <code>MsgBox</code> function call would simply &quot;not run&quot; if other code in the same execution path <i>does</i> run - surely there&#39;s more to it than just a message box not showing up. Does <code>c.Offset(0, ...)</code> get written?"}, {"owner": {"reputation": 1, "user_id": 12015686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294deed083449ce35e7ccae4e68d1a4b?s=128&d=identicon&r=PG&f=1", "display_name": "tgoetjen", "link": "https://stackoverflow.com/users/12015686/tgoetjen"}, "edited": false, "score": 0, "creation_date": 1567545346, "post_id": 57775726, "comment_id": 101992534, "body": "This is not the entirety of the code, there is a call to this sub within a function. The <code>c.Offset(0, ...)</code> appears to not get updated, the original value in the spreadsheet remains"}, {"owner": {"reputation": 1, "user_id": 12015686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294deed083449ce35e7ccae4e68d1a4b?s=128&d=identicon&r=PG&f=1", "display_name": "tgoetjen", "link": "https://stackoverflow.com/users/12015686/tgoetjen"}, "edited": false, "score": 0, "creation_date": 1567547201, "post_id": 57775726, "comment_id": 101993084, "body": "I ended up trying a modified version of that shown here: <a href=\"https://stackoverflow.com/questions/15659779/set-a-cell-value-from-a-function\" title=\"set a cell value from a function\">stackoverflow.com/questions/15659779/&hellip;</a> and that seems to have worked!"}], "owner": {"reputation": 1, "user_id": 12015686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294deed083449ce35e7ccae4e68d1a4b?s=128&d=identicon&r=PG&f=1", "display_name": "tgoetjen", "link": "https://stackoverflow.com/users/12015686/tgoetjen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567545093, "creation_date": 1567528785, "last_edit_date": 1567545093, "question_id": 57775726, "link": "https://stackoverflow.com/questions/57775726/how-do-you-change-the-value-of-a-different-cell-from-which-you-call-a-user-defin", "title": "How do you change the value of a different cell from which you call a user-defined function?", "body": "<p>I am setting up an excel worksheet to automatically populate office rotations for an incoming class of graduate students. The input will be their choices of professors and the number of open seats the professors have. I want to update the value of the number of open seats the professors have as I assign a rotation slot to each student, but the code seems to be breaking when I attempt to assign a value to a cell outside that of the calling cell.</p>\n\n<p>I have tried switching between subs and functions to no avail. It seems as though VBA simply does not allow changing the value of a cell from a different cell. Is this true?</p>\n\n<pre><code>    Sub DecrementSeats(PIName As String, RotNum As Integer)\n\n        Dim i As Integer, seats As Integer\n        Dim c As Range\n        seats = 0\n        i = 2\n        MsgBox (\"In decrement\")\n\n        For Each c In Worksheets(\"Student Interest and Rotations\").Range(\"A2:A41\")  \n            If c.Value = PIName Then\n                 MsgBox (c.Value &amp; \" is the same as \" &amp; PIName)\n                 seats = c.Offset(0, (1 + RotNum)).Value\n                 MsgBox (\"Original seats value is: \" &amp; seats)\n                 seats = seats - 1\n                 c.Offset(0, (1 + RotNum)) = seats\n                 MsgBox (\"New c.Value value is: \" &amp; c.Offset(0, (1 + RotNum)).Value)\n                 Exit For\n            End If\n        MsgBox (c.Value &amp; \" is not the same as \" &amp; PIName &amp; \". Checking next PI name...\")\n        Next c\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "teradata"], "comments": [{"owner": {"reputation": 7316, "user_id": 2751573, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/GsKBw.jpg?s=128&g=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2751573/andrew"}, "edited": false, "score": 0, "creation_date": 1567528910, "post_id": 57775707, "comment_id": 101986624, "body": "Look at your connection string.  Here&#39;s a hint:  <code>Driver={SQL Server};</code>"}, {"owner": {"reputation": 1, "user_id": 12015667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dee776ccae748ba4746598c8584db0c1?s=128&d=identicon&r=PG&f=1", "display_name": "just_in_case_23", "link": "https://stackoverflow.com/users/12015667/just-in-case-23"}, "reply_to_user": {"reputation": 7316, "user_id": 2751573, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/GsKBw.jpg?s=128&g=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2751573/andrew"}, "edited": false, "score": 0, "creation_date": 1567529343, "post_id": 57775707, "comment_id": 101986788, "body": "@Andrew what am I supposed to put in for the driver? sorry I am very new to this :)"}, {"owner": {"reputation": 7316, "user_id": 2751573, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/GsKBw.jpg?s=128&g=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2751573/andrew"}, "edited": false, "score": 0, "creation_date": 1567529811, "post_id": 57775707, "comment_id": 101986954, "body": "I know nothing about VBA, but you need to specify the Teradata driver, not SQL Server.  Maybe try <code>Driver={Teradata}</code>"}, {"owner": {"reputation": 1, "user_id": 12015667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dee776ccae748ba4746598c8584db0c1?s=128&d=identicon&r=PG&f=1", "display_name": "just_in_case_23", "link": "https://stackoverflow.com/users/12015667/just-in-case-23"}, "reply_to_user": {"reputation": 7316, "user_id": 2751573, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/GsKBw.jpg?s=128&g=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2751573/andrew"}, "edited": false, "score": 0, "creation_date": 1567530420, "post_id": 57775707, "comment_id": 101987199, "body": "That didn&#39;t work unfortunately. Does anyone else know what I need to put in for Driver and where I can find it (if this is actually the issue)?"}, {"owner": {"reputation": 1203, "user_id": 11552426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f2774ccb05225f1a9b5ebac9dc971d?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/11552426/fred"}, "edited": false, "score": 0, "creation_date": 1567551225, "post_id": 57775707, "comment_id": 101993916, "body": "Do you have a Teradata client driver installed? What type and what is its actual name? For example, is it <code>Teradata Database ODBC Driver 16.20</code>? If so, you should be able to use that name inside the { }. (Older versions of the driver were in fact named just <code>Teradata</code> but newer ones are not.)"}], "answers": [{"tags": [], "owner": {"reputation": 709, "user_id": 6406676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tKqoTYfIoLg/AAAAAAAAAAI/AAAAAAAAAE4/nAM6WSK4jN0/photo.jpg?sz=128", "display_name": "David Cram", "link": "https://stackoverflow.com/users/6406676/david-cram"}, "is_accepted": false, "score": 0, "last_activity_date": 1567624733, "creation_date": 1567624733, "answer_id": 57794616, "question_id": 57775707, "link": "https://stackoverflow.com/questions/57775707/vba-code-to-run-query-in-teradata-and-paste-results-in-excel/57794616#57794616", "title": "VBA code to run query in Teradata and paste results in Excel", "body": "<p>If you know what driver you have installed then you need to supply the information for that driver.  In this case it should not be SQL Server.  If you don't know what is installed or how to use it, then it can be a little hard to figure out.  So here is a trick I use to build my connection strings.  </p>\n\n<p>Use notepad or some other text editor to create an empty file.  Name it so that the file extention is .udl.  Make sure .udl is the extension and not actually part of the file name.  If file extensions are hidden by default, you might have to change your folder options to show file extensions in order to get this to work.</p>\n\n<p>After creating the file, double click on it. It will open a connection wizard.  On the Provider tab look for one that seems like it will work...probably an ODBC or Teradata provider.  If there doesn't seem to be anything reasonable then you may need to install a driver.</p>\n\n<p>Go to the connection tab and supply the info you want to use to connect.  Hit the \"Test Connection\" button to see if it works.</p>\n\n<p>If it worked, click on ok.  Now open the udl file with notepad.  It will display the actual values used for the connection string.  You should be able to just copy and paste the values into your VBA connection string.</p>\n"}, {"tags": [], "owner": {"reputation": 259, "user_id": 4303647, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nKepGPv2r8Q/AAAAAAAAAAI/AAAAAAAABls/oUWGnZxYDGk/photo.jpg?sz=128", "display_name": "JonoMac", "link": "https://stackoverflow.com/users/4303647/jonomac"}, "is_accepted": false, "score": 0, "last_activity_date": 1617723639, "creation_date": 1617723639, "answer_id": 66971895, "question_id": 57775707, "link": "https://stackoverflow.com/questions/57775707/vba-code-to-run-query-in-teradata-and-paste-results-in-excel/66971895#66971895", "title": "VBA code to run query in Teradata and paste results in Excel", "body": "<p>If anyone else is still looking at this for an answer I use this to build my connection string in Excel Office 365:</p>\n<pre><code>strDriver = &quot;{Teradata Database ODBC Driver 16.20}&quot;\nstrConn = &quot;yourserveraddress&quot;\nstrDB = &quot;yourdatabasename&quot;\nstrUID = &quot;youruserid&quot;\nstrPW = &quot;yourpassword&quot;\n\nstrConnection = &quot;ODBC&quot; &amp; _\n        &quot;;DRIVER=&quot; &amp; strDriver &amp; _\n        &quot;;DBCNAME=&quot; &amp; strConn &amp; _\n        &quot;;DEFAULTDATABASE=&quot; &amp; strDB &amp; _\n        &quot;;DESCRIPTION=Intelliflex;EN&quot;), Array(&quot;ABLEPWD=1;ENABLEWALLET=0;MECHANISMNAME=LDAP&quot; &amp; _\n        &quot;;PWD=&quot; &amp; strPW &amp; _\n        &quot;;UID=&quot; &amp; strUID &amp; _\n        &quot;;USEINTEGRATEDSECURITY=0;&quot;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12015667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dee776ccae748ba4746598c8584db0c1?s=128&d=identicon&r=PG&f=1", "display_name": "just_in_case_23", "link": "https://stackoverflow.com/users/12015667/just-in-case-23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 594, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1617723639, "creation_date": 1567528693, "last_edit_date": 1567528798, "question_id": 57775707, "link": "https://stackoverflow.com/questions/57775707/vba-code-to-run-query-in-teradata-and-paste-results-in-excel", "title": "VBA code to run query in Teradata and paste results in Excel", "body": "<p>I cannot figure out why this VBA is not working to run a query in Teradata and paste the results in an excel spreadsheet</p>\n\n<p>this is the error I am getting: \"[Microsoft][ODBC SQL Server Driver][DBNETLIB]SQl Server does not exist or access denied.\"</p>\n\n<p>I don't believe it is because my access is denied because when I add my username and password to the code it still doesn't work.</p>\n\n<p>CODE:</p>\n\n<pre><code>Sub sql_query()\n\nDim Conn As New ADODB.Connection\nDim recset As New ADODB.Recordset\nDim sqlQry As String, sConnect As String\n\nsqlQry = \"SEL * FROM entpr_tx_actuarial.mrm sample 10;\"\n\nsConnect = \"Driver={SQL Server};Server=[Teradata-DATA.*****.com]; Database=[TERADATA_PRD];Trusted_Connection=yes;\"\n\nConn.Open sConnect\n\nSet recset = New ADODB.Recordset\n\n    recset.Open sqlQry, Conn\n    Sheet2.Cells(2, 1).CopyFromRecordset recset\n    recset.Close\n\nConn.Close\n\nSet recset = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12015496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7bbac4aaf4d7281927890d7645b2b6?s=128&d=identicon&r=PG&f=1", "display_name": "Chachie", "link": "https://stackoverflow.com/users/12015496/chachie"}, "edited": false, "score": 0, "creation_date": 1567692837, "post_id": 57775812, "comment_id": 102046464, "body": "Hello, thanks for the reply. I&#39;ve added your code and it appears to run but nothing happens. I&#39;m sorry but I&#39;m not the best with VBA. I have added all the references required and added the folder path in A1. If I run the script without a folder path I get the error message you included in the script; which makes me believe it is running properly. Obviously I&#39;m missing something though, where is the target paste location for the most recent CSV data? Thanks again for the help"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 1, "user_id": 12015496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7bbac4aaf4d7281927890d7645b2b6?s=128&d=identicon&r=PG&f=1", "display_name": "Chachie", "link": "https://stackoverflow.com/users/12015496/chachie"}, "edited": false, "score": 0, "creation_date": 1567708256, "post_id": 57775812, "comment_id": 102053694, "body": "I changed the code and you will find the result in A3. BTW, who wrote the code you posted?"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1567709325, "last_edit_date": 1567709325, "creation_date": 1567529150, "answer_id": 57775812, "question_id": 57775478, "link": "https://stackoverflow.com/questions/57775478/how-to-paste-csv-data-from-most-recent-folder/57775812#57775812", "title": "How to paste CSV data from most recent folder?", "body": "<p>I often use ADODB to do this in the follwoing way</p>\n\n<p>I create a In Memory recordset for the files</p>\n\n<pre><code>Option Explicit\nFunction rsFiles() As ADODB.Recordset\n    ' Defines In Memory Recordset for the files\n    ' In Memory Recordset\n    ' https://www.databasejournal.com/features/msaccess/article.php/3846361/Create-In-Memory-ADO-Recordsets.htm\n\n    Dim rsData As ADODB.Recordset\n\n    Set rsData = New ADODB.Recordset\n\n    rsData.Fields.Append \"Filename\", adVarChar, 256\n    rsData.Fields.Append \"Extension\", adVarChar, 8\n    rsData.Fields.Append \"Path\", adVarChar, 256\n    rsData.Fields.Append \"DateCreated\", adDate\n    rsData.Fields.Append \"DateLastModified\", adDate\n    Set rsFiles = rsData\n\nEnd Function\n</code></pre>\n\n<p>Then I fill this recordset with all the files in the directory structure </p>\n\n<pre><code>Sub RecursiveFolder(ByRef fld As Scripting.Folder, ByRef rsFiles As ADODB.Recordset, _\n    ByRef includeSubFolders As Boolean)\n\n    Dim FSO As Scripting.FileSystemObject   ' Needed because I wanted the extension in a separate field\n    Dim sngFile As Scripting.File\n    Dim subFld As Scripting.Folder\n\n    'Loop through each file in the folder\n    Set FSO = New Scripting.FileSystemObject\n    For Each sngFile In fld.Files\n        rsFiles.AddNew\n        rsFiles.Fields(\"FileName\") = sngFile.Name\n        rsFiles.Fields(\"Path\") = sngFile.Path\n        rsFiles.Fields(\"Extension\") = FSO.GetExtensionName(sngFile.Path &amp; Application.PathSeparator &amp; sngFile.Name)\n        rsFiles.Fields(\"DateCreated\") = sngFile.DateCreated\n        rsFiles.Fields(\"DateLastModified\") = sngFile.DateLastModified\n        rsFiles.Update\n    Next sngFile\n\n    'Loop through files in the subfolders\n    If includeSubFolders Then\n        For Each subFld In fld.SubFolders\n            Call RecursiveFolder(subFld, rsFiles, True)\n        Next subFld\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>And this is a way how to use it</p>\n\n<pre><code>Option Explicit\n\n' Example How to use RecursiveFolder and InMemory Recordset\n' Set a reference to Microsoft Scripting Runtime and\n' Micrososft Acitve Data Objects by using\n' Tools &gt; References in the Visual Basic Editor (Alt+F11)\n\nSub GetAFile()\n\n    Dim FSO As Scripting.FileSystemObject\n    Dim fld As Scripting.Folder\n    Dim myPath As String\n    Dim aFiles As ADODB.Recordset\n    Dim errMsg As String\n\n    On Error GoTo EH\n\n    'Specify the path to the folder\n    myPath = Range(\"A1\").Value2\n\n    'Create an instance of the FileSystemObject\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    'Make sure the folder exists\n    If Not FSO.FolderExists(myPath) Then\n        errMsg = \"No such folder exists!\"\n        GoTo EH\n    End If\n\n    'Get the folder\n    Set fld = FSO.GetFolder(myPath)\n\n    'Get the file names from the specified folder and its subfolders into an array\n    Set aFiles = rsFiles\n    aFiles.Open , , adOpenDynamic\n    RecursiveFolder fld, aFiles, True\n\n    ' Example - Filter the recordset by Extension and sort by DateCreated\n    Dim sFilter As String\n    ' Get the filter condition\n\n    sFilter = ThisWorkbook.Sheets(1).Range(\"A2\").Value2\n    If Len(sFilter) &gt; 0 Then\n        aFiles.Filter = \"Extension Like '\" &amp; sFilter &amp; \"'\"\n    Else\n        sFilter = \"CSV\"\n        aFiles.Filter = \"Extension Like '\" &amp; sFilter &amp; \"'\"\n    End If\n    aFiles.Sort = \"DateCreated DESC\"\n\n    ' Print the name of the file withe the latest creation date\n    If aFiles.RecordCount &gt; 0 Then\n        Range(\"A3\").value2 = aFiles.Fields(\"Path\")\n        Debug.Print aFiles.Fields(\"Path\"), aFiles.Fields(\"Filename\"), aFiles.Fields(\"DateLastModified\")\n    Else\n        Range(\"A3\").value2 =\"No file found\"\n        Debug.Print \"No file found\"\n    End If\n\n\nExitSub:\n    Exit Sub\n\n    'Error handling\nEH:\n    If Len(errMsg) &gt; 0 Then\n        MsgBox errMsg, vbExclamation\n        GoTo ExitSub\n    Else\n        MsgBox \"Error \" &amp; Err.Number &amp; \":  \" &amp; Err.Description\n        Resume ExitSub\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12015496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7bbac4aaf4d7281927890d7645b2b6?s=128&d=identicon&r=PG&f=1", "display_name": "Chachie", "link": "https://stackoverflow.com/users/12015496/chachie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1567709325, "creation_date": 1567527661, "question_id": 57775478, "link": "https://stackoverflow.com/questions/57775478/how-to-paste-csv-data-from-most-recent-folder", "title": "How to paste CSV data from most recent folder?", "body": "<p>We have a model which generates daily  results in CSV format and saves these files in a new folder each time. The csv files always have the same name, only the subfolder name changes (portion of the folder name contains the date).</p>\n\n<p>I would like to create a vba script which would search all the subfolders for the most recent csv file, copy it's data and paste this data (overriding the previous days data) in an excel file.</p>\n\n<p>I was hoping to build off something like this:</p>\n\n<pre><code>'Sub OpenLatestFile()\n\n'Declare the variables\nDim MyPath As String\nDim MyFile As String\nDim LatestFile As String\nDim LatestDate As Date\nDim LMD As Date\n\n'Specify the path to the folder\nMyPath = \"C:\\Users\\Desktop\\EmgMgmt\"\n\n'Make sure that the path ends in a backslash\nIf Right(MyPath, 1) &lt;&gt; \"\\\" Then MyPath = MyPath &amp; \"\\\"\n\n'Get the first Excel file from the folder\nMyFile = Dir(MyPath &amp; \"*.csv\", vbNormal)\n\n'If no files were found, exit the sub\nIf Len(MyFile) = 0 Then\n    MsgBox \"No files were found...\", vbExclamation\n    Exit Sub\nEnd If\n\n'Loop through each Excel file in the folder\nDo While Len(MyFile) &gt; 0\n\n    'Assign the date/time of the current file to a variable\n    LMD = FileDateTime(MyPath &amp; MyFile)\n\n    'If the date/time of the current file is greater than the latest\n    'recorded date, assign its filename and date/time to variables\n    If LMD &gt; LatestDate Then\n        LatestFile = MyFile\n        LatestDate = LMD\n    End If\n\n    'Get the next Excel file from the folder\n    MyFile = Dir\n\nLoop\n\n'Open the latest file\nWorkbooks.Open MyPath &amp; LatestFile\n    End Sub\n</code></pre>\n\n<p>This just opens the most recent csv in the specified folder. Seeing as a new folder is generated daily, I would like to code to search all sub folders for the newest csv file. I also don't want it to just open the csv but psate the information in a designated sheet.</p>\n\n<p>Thanks in advance for the help</p>\n"}]