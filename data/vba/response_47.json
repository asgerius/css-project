[{"tags": ["vba", "excel", "screen-scraping", "forex"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1449101833, "post_id": 34055445, "comment_id": 55865298, "body": "Do you mind sharing what line causes the error message?  Or should we try to guess?  Guessing:  You don&#39;t have a Sheet19.  That would cause that message."}, {"owner": {"reputation": 91, "user_id": 5092420, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8026f18b74dfb04037965c40e5686d38?s=128&d=identicon&r=PG&f=1", "display_name": "Pineapple", "link": "https://stackoverflow.com/users/5092420/pineapple"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1449102222, "post_id": 34055445, "comment_id": 55865402, "body": "Thanks, I quickly amended that.  It now shows a &#39;Run-time error &#39;91&#39;: object variable or With block variable not set&#39;.  I believe the issue is with the reference to the html element."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1449102313, "post_id": 34055445, "comment_id": 55865432, "body": "When the error occurs, if you choose the Debug option, a particular line should be highlighted in your code.  That would be the line that is causing the error.  You need to show that clearly in your question"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449102855, "post_id": 34055445, "comment_id": 55865578, "body": "change <code>ie.document.getelementsbyname(&quot;divQuotePage&quot;).Item.innertext</code> to <code>ie.document.getelementsbyname(&quot;divQuotePage&quot;).Item(0).innert&zwnj;&#8203;ext</code>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449103689, "post_id": 34055445, "comment_id": 55865860, "body": "you may also try: <code>ie.document.getElementById(&quot;dtaLast&quot;).innertHtml</code>"}], "answers": [{"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 2, "last_activity_date": 1449103609, "creation_date": 1449103609, "answer_id": 34055898, "question_id": 34055445, "link": "https://stackoverflow.com/questions/34055445/scraping-a-single-value-from-an-html-table-and-inserting-into-an-excel-cell-with/34055898#34055898", "title": "Scraping a single value from an HTML table and inserting into an Excel cell with VBA", "body": "<p>I'm not that accomplished at web scraping, but that kind of error often means that what you are looking for isn't there.  In particular, I don't see <code>divQuotePage</code> in the screen shot you provided.</p>\n\n<p>But if you want the quote (793.19) you could do something like:</p>\n\n<pre><code>Dim V As Variant\nSet V = ie.document.getelementbyid(\"dtaLast\")\nTxtRng = V.innertext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1449246065, "creation_date": 1449246065, "answer_id": 34092786, "question_id": 34055445, "link": "https://stackoverflow.com/questions/34055445/scraping-a-single-value-from-an-html-table-and-inserting-into-an-excel-cell-with/34092786#34092786", "title": "Scraping a single value from an HTML table and inserting into an Excel cell with VBA", "body": "<p>This will work.</p>\n\n<p>Sub Test()\n    Dim IE As Object</p>\n\n<pre><code>Set IE = CreateObject(\"InternetExplorer.Application\")\nWith IE\n    .Visible = True\n    .Navigate \"http://www.barchart.com/quotes/forex/British_Pound/Costa_Rican_Colon/%5EGBPCRC\" ' should work for any URL\n    Do Until .ReadyState = 4: DoEvents: Loop\n\n        x = .document.body.innertext\n        y = InStr(1, x, \"Last Price\")\n        Z = Mid(x, y, 19)\n\n        Range(\"A1\").Value = Trim(Z)\n\n        .Quit\n    End With\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1530390473, "creation_date": 1530390473, "answer_id": 51118244, "question_id": 34055445, "link": "https://stackoverflow.com/questions/34055445/scraping-a-single-value-from-an-html-table-and-inserting-into-an-excel-cell-with/51118244#51118244", "title": "Scraping a single value from an HTML table and inserting into an Excel cell with VBA", "body": "<p>You can target that element with a CSS selector of <code>div.pricechangerow &gt; span.last-change</code>;\nwhich can be simplified to <code>.last-change</code>. </p>\n\n<p>The \".\" means class and you can retrieve this specific item with </p>\n\n<pre><code>Debug.Print ie.document.querySelector.querySelector(\".last-change\").innerText\n</code></pre>\n\n<p>That is for the website's current incarnation at 2018-06-30</p>\n"}], "owner": {"reputation": 91, "user_id": 5092420, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8026f18b74dfb04037965c40e5686d38?s=128&d=identicon&r=PG&f=1", "display_name": "Pineapple", "link": "https://stackoverflow.com/users/5092420/pineapple"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 768, "favorite_count": 0, "accepted_answer_id": 34055898, "answer_count": 3, "score": 0, "last_activity_date": 1530390473, "creation_date": 1449100760, "last_edit_date": 1449102138, "question_id": 34055445, "link": "https://stackoverflow.com/questions/34055445/scraping-a-single-value-from-an-html-table-and-inserting-into-an-excel-cell-with", "title": "Scraping a single value from an HTML table and inserting into an Excel cell with VBA", "body": "<p>Please see the code below.  I am compiling a list of unusual currency pairings in excel and I wish to scrape this data with VBA.  I only want to insert the value itself into the cell.  Does anyone know where I am going wrong here?  I am getting a 'Run-time error '91': object variable or With block variable not set'.  I'm relatively new to VBA and i've put a lot a deal of thought into this.</p>\n\n<pre><code>Sub ie_open()\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim TxtRng As Range\n    Dim ie As Object\n\n    Set ie = CreateObject(\"INTERNETEXPLORER.APPLICATION\")\n    ie.NAVIGATE \"http://www.barchart.com/quotes/forex/British_Pound/Costa_Rican_Colon/%5EGBPCRC\"\n    ie.Visible = True\n\n    While ie.ReadyState &lt;&gt; 4\n        DoEvents\n    Wend\n\n    Set wb = ActiveWorkbook\n    Set ws = wb.Sheets(\"Test Sheet\")\n    Set TxtRng = ws.Range(\"A1\")\n    TxtRng.Value = ie.document.getelementsbyname(\"divQuotePage\").Item.innertext\n\nEnd Sub\n</code></pre>\n\n<p>This is the data which I am trying to scrape:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kRc4a.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kRc4a.jpg\" alt=\"\"></a></p>\n\n<p>Thanks.</p>\n"}, {"tags": ["regex", "vba"], "comments": [{"owner": {"reputation": 1289, "user_id": 4303407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5feb379946286f2086055b78892368e1?s=128&d=identicon&r=PG", "display_name": "Harsh", "link": "https://stackoverflow.com/users/4303407/harsh"}, "edited": false, "score": 0, "creation_date": 1449100526, "post_id": 34055351, "comment_id": 55864913, "body": "Something like this expression should give you groups which you can easily read in your code: <code>\\&lt;[A-Z]+ [A-Za-z]+=&quot;([a-zA-Z0-9]+[.]*[a-zA-Z0-9]+)&quot;\\&gt;.*</code>"}], "answers": [{"comments": [{"owner": {"reputation": 359, "user_id": 4905581, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/fab8b2fb6fecf36da08f768f6ca01b13?s=128&d=identicon&r=PG&f=1", "display_name": "JustQn4", "link": "https://stackoverflow.com/users/4905581/justqn4"}, "edited": false, "score": 0, "creation_date": 1449181758, "post_id": 34063422, "comment_id": 55908399, "body": "Thanks. I had to adapt it a bit but it works just fine to accomplish what I need. Very much appreciated :-)"}], "tags": [], "owner": {"reputation": 803, "user_id": 4186108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/170ff81c1ed126d7c00aa6aea33fa3bb?s=128&d=identicon&r=PG&f=1", "display_name": "cboden", "link": "https://stackoverflow.com/users/4186108/cboden"}, "is_accepted": true, "score": 0, "last_activity_date": 1449138783, "last_edit_date": 1449138783, "creation_date": 1449138307, "answer_id": 34063422, "question_id": 34055351, "link": "https://stackoverflow.com/questions/34055351/ms-vb-for-application-read-href-value-in-a-txt-file/34063422#34063422", "title": "MS VB For Application - Read href value in a txt file", "body": "<p>I really hate regular expressions. I would do it more \"old style\":</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub showLinks()\n    Dim content As String\n    Dim pos As Integer\n\n    ' read file content\n    content = readFile(\"C:\\Temp\\links.txt\")\n\n    ' search for links\n    Do While InStr(content, \"&lt;A HREF\")\n        ' find begin of link\n        pos = InStr(content, \"&lt;A HREF\")\n        content = Mid(content, pos + 7)\n\n        ' find closing &gt;\n        pos = InStr(content, \"&gt;\")\n        content = Mid(content, pos + 1)\n\n        ' find begin of closing tag\n        pos = InStr(content, \"&lt;\")\n\n        ' print out link text\n        Debug.Print Left(content, pos - 1)\n    Loop\nEnd Sub\n\nPrivate Function readFile(ByVal pFile As String) As String\n    Dim ret As String\n    Dim row As String\n\n    ' create file handle\n    Dim hnd As Integer\n    hnd = FreeFile\n\n    ' open file\n    Open pFile For Input As hnd\n\n    ' read file\n    Do Until EOF(hnd)\n        Line Input #hnd, row\n        ret = ret &amp; row\n    Loop\n\n    ' close file\n    Close hnd\n\n    ' return content\n    readFile = ret\nEnd Function\n</code></pre>\n\n<p>of course it's a little bit simplified to show the concept. It would need solid error handling for example to ensure that the file handle is released for example. But it should give you only an idea of how it could work.</p>\n\n<p>You can also use the FSO to read the file (or maybe also ADO) ... but I wanted to show you that it is possible without any external library as this often causes problems.</p>\n"}], "owner": {"reputation": 359, "user_id": 4905581, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/fab8b2fb6fecf36da08f768f6ca01b13?s=128&d=identicon&r=PG&f=1", "display_name": "JustQn4", "link": "https://stackoverflow.com/users/4905581/justqn4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 34063422, "answer_count": 1, "score": 0, "last_activity_date": 1449138783, "creation_date": 1449100133, "question_id": 34055351, "link": "https://stackoverflow.com/questions/34055351/ms-vb-for-application-read-href-value-in-a-txt-file", "title": "MS VB For Application - Read href value in a txt file", "body": "<p>My txt file (links.txt) contains several links as follows</p>\n\n<pre><code>&lt;A HREF=\"file1.oft\"&gt;File 1&lt;/A&gt;\n&lt;A HREF=\"file2.oft\"&gt;File 2&lt;/A&gt;\n&lt;A HREF=\"file3.oft\"&gt;File 3&lt;/A&gt;\n&lt;A HREF=\"file4.oft\"&gt;File 4&lt;/A&gt;\n&lt;A HREF=\"file5.oft\"&gt;File 5&lt;/A&gt;\n</code></pre>\n\n<p>What I need is to open the file and read the value of the links (File 1, File 2, etc)</p>\n\n<p>How can I do that? regex? I imagine this is something simple but I could find exactly what I need to accomplish.</p>\n\n<pre><code>??? strRegX = \"&lt;\\s*A(.|\\n)*?\\s*&gt;((.|\\n)*?)&lt;\\s*\\/A\\s*&gt;\"  ?????\n\nConst ForReading = 1\nSet objTextFile = objFSO.OpenTextFile(\"links.txt\", ForReading)\nDo Until objTextFile.AtEndOfStream\n***** CODE GOES HERE ******\nLoop\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1449106317, "post_id": 34055315, "comment_id": 55866675, "body": "You could make the links fire a function that find the data you want based on the link clicked and then do a range(&quot;A&quot; &amp; row).Activate"}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449167167, "post_id": 34060317, "comment_id": 55899921, "body": "Jeeped and @matthewD Didn&#39;t have time before presentation to work it out but thanks. Will probably come in handy for presentation next time."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1449128499, "creation_date": 1449128499, "answer_id": 34060317, "question_id": 34055315, "link": "https://stackoverflow.com/questions/34055315/adjust-zoom-based-on-resolution-via-followhyperlink-event/34060317#34060317", "title": "Adjust zoom based on resolution via FollowHyperlink event", "body": "<p>If you are looking to put A229 into the top-left corner of the visible worksheet area, then fool Excel by first going past the visible portion of the worksheet that you want and come back to it.</p>\n\n<p>In A13, put a hyperlink that goes to A1229, not A229.</p>\n\n<pre><code>Sub setup_Hyperlinks()\n    With Worksheets(\"Sheet1\")\n        With .Range(\"A13\")\n            .Hyperlinks.Delete\n            .Hyperlinks.Add Anchor:=.Cells(1), Address:=\"\", SubAddress:=\"Sheet1!A1229\", _\n                            ScreenTip:=\"Jump to row 229\", TextToDisplay:=\"Row 229\"\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>Note that the actual subaddress target is <code>A1229</code>, not <code>A229</code>.</p>\n\n<p>Right-click the worksheet's name tab and choose <strong>View Code</strong>. When the VBE opens, paste <strong>one</strong> of the following into the worksheet code sheet titled something like <em>Book1 - Sheet1 (Code)</em>.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Cells(1, 1).Row &gt; 1000 Then  'this will depend on how you craft the method for your own purposes\n        Application.Goto _\n          Reference:=Target.Cells(1, 1).Offset(-1000, 0)\n        '[optional] move one row down for personal aesthetics\n        'ActiveWindow.SmallScroll Down:=-1\n    End If\nEnd Sub\n</code></pre>\n\n<p>... or,</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n    If ActiveCell.Row &gt; 1000 Then  'this will depend on how you craft the method for your own purposes\n        Application.Goto _\n          Reference:=ActiveCell.Offset(-1000, 0)\n        '[optional] move one row down for personal aesthetics\n        'ActiveWindow.SmallScroll Down:=-1\n    End If\nEnd Sub\n</code></pre>\n\n<p>Use one or the other but not both. The former seems to have marginally less screen 'flash' on my system.</p>\n"}, {"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449511969, "post_id": 34109531, "comment_id": 56028652, "body": "I didn&#39;t explain my problem properly but you got the idea. It takes it to the row but I don&#39;t want it at the bottom but at the top so I counted how many rows I needed to make it happen which worked fine on my computer until I went to another with a much bigger screen. Don&#39;t have access to the big screen to really test this now :/ I will revisit next time I have another presentation thanks &lt;3"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449515301, "post_id": 34109531, "comment_id": 56030540, "body": "I see what you mean now and it just hit me to look at visible range.  Check out edit to answer.."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 1, "last_activity_date": 1449518757, "last_edit_date": 1449518757, "creation_date": 1449341692, "answer_id": 34109531, "question_id": 34055315, "link": "https://stackoverflow.com/questions/34055315/adjust-zoom-based-on-resolution-via-followhyperlink-event/34109531#34109531", "title": "Adjust zoom based on resolution via FollowHyperlink event", "body": "<p>It just hit me. Check out <code>Windows(1).VisibleRange.Rows.count</code></p>\n\n<p>You can see how many rows are displayed, go down so the link target will be at the top. This should be accurate regardless of the resolution.</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n    Dim iActive As Integer\n    Dim lBottom As Long\n    Dim ws As Excel.Worksheet\n\n    Set ws = ActiveWorkbook.Sheets(\"Sheet1\")\n\n    'Get the number of rows showing\n    iActive = Windows(1).VisibleRange.Rows.count\n\n    'Move to center of the active window\n    lBottom = ActiveCell.Row + (iActive / 2) - 1\n    ws.Range(\"A\" &amp; lBottom).Activate\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1449518757, "creation_date": 1449099967, "last_edit_date": 1531164843, "question_id": 34055315, "link": "https://stackoverflow.com/questions/34055315/adjust-zoom-based-on-resolution-via-followhyperlink-event", "title": "Adjust zoom based on resolution via FollowHyperlink event", "body": "<p>My sheet has data in columns A to Z. I have hyperlinks in rows 13 to 49 that jump to specific cells in rows below. For example, the hyperlink in row 13 will jump to row 229.</p>\n\n<p>The hyperlinks are fine until I do a presentation on another machine with a different resolution. Instead of jumping to row 229, it shows row 248.</p>\n\n<p>I have tinkered with <a href=\"https://stackoverflow.com/questions/11533942/adjusting-worksheet-zoom-level-based-on-screen-resolution/19439177#19439177\">this</a> and <a href=\"https://stackoverflow.com/questions/29367434/adjust-worksheet-to-fit-any-screen-resolution?rq=1\">this</a> but have had no success yet. Also tried this <a href=\"https://stackoverflow.com/questions/10966597/worksheet-followhyperlink-get-the-cell-value-in-which-the-hyperlink-is-located\">less related</a> answer to see if I can trick excel. I have also tried the below code:</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\nr = ActiveCell.Row\nRange(Cells(r, 1), Cells(r, 26)).Select\n'Target.Range.Select\nActiveWindow.Zoom = True\n</code></pre>\n"}, {"tags": ["string", "excel", "vba", "compare"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1449099336, "post_id": 34054672, "comment_id": 55864512, "body": "Note, in your Dim lines every item needs a As clause, otherwise they are declared as Variant"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1449106061, "post_id": 34054672, "comment_id": 55866593, "body": "To expand upon what Chris wrote, the <code>Like</code> operater returns <code>result</code> for <code>string Like pattern</code>.  In your code, you have <code>pattern Like string</code>.(See Help for the <code>Like</code> operator)."}], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1449099227, "creation_date": 1449099227, "answer_id": 34055157, "question_id": 34054672, "link": "https://stackoverflow.com/questions/34054672/vba-operator-like-not-correctly-comparing-2-strings/34055157#34055157", "title": "VBA operator &quot;Like&quot; not correctly comparing 2 strings", "body": "<p>If <code>dataValArray</code> contains the patterns, and <code>givenVal</code> contains the string to test, swap the parameters ie </p>\n\n<pre><code>givenVal Like dataValArray(j)\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5062504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8878e2a59118112b6e991bc3276877cd?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Charnow", "link": "https://stackoverflow.com/users/5062504/chris-charnow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 34055157, "answer_count": 1, "score": 1, "last_activity_date": 1449099227, "creation_date": 1449096872, "last_edit_date": 1449097267, "question_id": 34054672, "link": "https://stackoverflow.com/questions/34054672/vba-operator-like-not-correctly-comparing-2-strings", "title": "VBA operator &quot;Like&quot; not correctly comparing 2 strings", "body": "<p>I've got a sub that is trying to compare 1 string (captured in givenVal) to a variety of possible acceptable strings (columns E through N of mapping sheet) which include things like wildcards and specific operators (like * ? # [] etc) so I feel most comfortable continuing using the \"like\" operator. </p>\n\n<p>My problem is, even with a potential acceptable find, as shown in the screenshot, the flag is not being set correctly. Many of the fields are left as anything acceptable (so just *) and the blanks arent being accepted as falling under *, if that makes sense. I have tried debugging and the screenshot shows me tracking the 3 key parameters in the watch area. </p>\n\n<p>Any ideas? Screenshot here...</p>\n\n<p><a href=\"https://imgur.com/GXugz5P\" rel=\"nofollow noreferrer\">http://imgur.com/GXugz5P</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/5GRs1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5GRs1.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "loops", "powerpoint"], "comments": [{"owner": {"reputation": 370144, "user_id": 1271826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/duhm9.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/1271826/rob"}, "edited": false, "score": 0, "creation_date": 1485567761, "post_id": 34054656, "comment_id": 70993354, "body": "You should consider accepting the answer below. See <a href=\"http://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question</a>."}], "answers": [{"comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1485625696, "post_id": 34056791, "comment_id": 71007059, "body": "Belated thanks for the edit (more like &quot;Total rewrite with code&quot;), David."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 3, "last_activity_date": 1583688252, "last_edit_date": 1583688252, "creation_date": 1449109490, "answer_id": 34056791, "question_id": 34054656, "link": "https://stackoverflow.com/questions/34054656/powerpoint-vba-loop-through-all-presentations-in-folder/34056791#34056791", "title": "Powerpoint VBA loop through all presentations in folder", "body": "<p>Change the sub to:</p>\n\n<pre><code>Sub ChangeShapeColor(oPres as Presentation)\n\nDim oSh As Shape\nDim oSl As Slide\n\nFor Each oSl In oPres.Slides\n\n    For Each oSh In oSl.Shapes\n\n        If oSh.Fill.ForeColor.RGB = RGB(84, 133, 192) Then\n        oSh.Fill.ForeColor.RGB = RGB(0, 51, 204)\n        oSh.Fill.Transparency = 0.4\n        End If\n\n        If oSh.Fill.ForeColor.RGB = RGB(202, 24, 24) Then\n        oSh.Fill.ForeColor.RGB = RGB(212, 10, 10)\n        oSh.Fill.Transparency = 0.4\n        End If\n\n    Next oSh\nNext oSl\n\nEnd Sub\n</code></pre>\n\n<p>Then write a routine that iterates through your chosen subdirectory and all subdirs off that, and for each presentation found, </p>\n\n<pre><code>Set oPres = Presentations.Open(path_to_presentation_file)\nCall ChangeShapeColor(oPres)\noPres.Close\n</code></pre>\n\n<p>Tell Google:  vba list files in directory and subdirectories \nThat should get you any number of routines to get the file listings.</p>\n\n<p>One way to do this is with the <code>Dir</code> function in a loop. This does not scan sub-folders, you'll need a different approach for that.</p>\n\n<pre><code>path = \"\"\nfilename = Dir(path)   'Get the first file\nWhile filename &lt;&gt; \"\"\n    'Avoid errors if the file cannot be opened by PPT, i.e., it is a DOCX or some other format\n    On Error Resume Next\n    filename = path &amp; filename\n    Set oPres = Presentations.Open(filename, WithWindow:=False)\n    If Err.Number &lt;&gt; 0 Then\n        Debug.Print \"Unable to open \" &amp; filename\n    End If\n    On Error GoTo 0  ' Resume normal error handling\n    Call ChangeShapeColor(oPres)\n    oPres.Close\n    filename = Dir()  'Get the next file in the folder\nWend\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5090929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f65099e822039f2b967980e00b80caa7?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/5090929/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2193, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1583688252, "creation_date": 1449096815, "last_edit_date": 1485567692, "question_id": 34054656, "link": "https://stackoverflow.com/questions/34054656/powerpoint-vba-loop-through-all-presentations-in-folder", "title": "Powerpoint VBA loop through all presentations in folder", "body": "<p>so my problem is this:\nI want to change the color of a text shape in more than 250 presentations (files).\nI can do this if the presentations are active and open by doing this:</p>\n\n<pre><code>Sub ChangeShapeColor()\n    Dim oSh As Shape\n    Dim oSl As Slide\n    Dim prs As Presentation\n\n    For Each prs In Presentations\n\n        For Each oSl In ActivePresentation.Slides\n\n            For Each oSh In oSl.Shapes\n\n                If oSh.Fill.ForeColor.RGB = RGB(84, 133, 192) Then\n                oSh.Fill.ForeColor.RGB = RGB(0, 51, 204)\n                oSh.Fill.Transparency = 0.4\n                End If\n\n                If oSh.Fill.ForeColor.RGB = RGB(202, 24, 24) Then\n                oSh.Fill.ForeColor.RGB = RGB(212, 10, 10)\n                oSh.Fill.Transparency = 0.4\n                End If\n\n            Next oSh\n        Next oSl\n    Next prs\nEnd Sub\n</code></pre>\n\n<p>However all the files are stored in one folder and then many more subfolders.</p>\n\n<p>How do I have to adjust the code, that the vba opens within a loop step by step all the other presentations in a specific folder C://xyz/xyx/presentations, executes the sub and saves it?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1449095187, "creation_date": 1449095187, "answer_id": 34054309, "question_id": 34054247, "link": "https://stackoverflow.com/questions/34054247/delete-a-range-of-columns-using-two-named-ranges/34054309#34054309", "title": "Delete a range of columns using two named ranges", "body": "<p><code>Range(Cells(1,colRange),Cells(1,lastColumn)).EntireColumn.Delete</code></p>\n"}, {"tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 1, "last_activity_date": 1449096181, "creation_date": 1449096181, "answer_id": 34054539, "question_id": 34054247, "link": "https://stackoverflow.com/questions/34054247/delete-a-range-of-columns-using-two-named-ranges/34054539#34054539", "title": "Delete a range of columns using two named ranges", "body": "<p>you can simply use:</p>\n\n<pre><code>Range(Columns(colRange),Columns(lastColumn)).Delete\n</code></pre>\n\n<p>or directly:</p>\n\n<pre><code>With ActiveSheet\n  .Range(.Columns(.Cells(1, .Columns.Count).End(xlToLeft).Column - 6), .Columns(.Cells(1, .Columns.Count).End(xlToLeft).Column)).Delete\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1353, "user_id": 3682157, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f0fba83e4788bb33bb49f87611266fe2?s=128&d=identicon&r=PG&f=1", "display_name": "user3682157", "link": "https://stackoverflow.com/users/3682157/user3682157"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 34054309, "answer_count": 2, "score": 0, "last_activity_date": 1449096181, "creation_date": 1449094911, "last_edit_date": 1449095302, "question_id": 34054247, "link": "https://stackoverflow.com/questions/34054247/delete-a-range-of-columns-using-two-named-ranges", "title": "Delete a range of columns using two named ranges", "body": "<p>I need to delete a range of rows using two named ranges</p>\n\n<p>Current find the column numbers for the last column (lastColumn) and then the column 6 spots behind it (colrange)</p>\n\n<pre><code>Dim lastColumn As Integer\nWith ActiveSheet\n    lastColumn = .Cells(1, .Columns.Count).End(xlToLeft).Column\nEnd With\ncolrange = lastColumn - 6\n</code></pre>\n\n<p>I want to delete the columns in the range colrange:lastColumn but not sure how to do this?</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 606, "user_id": 2025707, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HmEor.jpg?s=128&g=1", "display_name": "jaromey", "link": "https://stackoverflow.com/users/2025707/jaromey"}, "edited": false, "score": 0, "creation_date": 1449094106, "post_id": 34053932, "comment_id": 55862261, "body": "Is there any way that you could post some sample data from each of the two tables as well as what you would expect the query to return, given the sample data?"}], "answers": [{"tags": [], "owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "is_accepted": false, "score": 0, "last_activity_date": 1449095282, "creation_date": 1449095282, "answer_id": 34054333, "question_id": 34053932, "link": "https://stackoverflow.com/questions/34053932/how-to-get-microsoft-access-sql-to-join-to-the-same-table-twice-with-null-ids-p/34054333#34054333", "title": "How to get microsoft access sql to join to the same table twice with null ID&#39;s possible occasionally?", "body": "<p>This is your second query:</p>\n\n<pre><code>SELECT A.ID, C1.Company, A.[Job Title], C2.Company\nFROM Applied AS A LEFT JOIN\n     Company AS C1\n     ON A.Site  = C1.ID LEFT JOIN\n     Company AS C2 ON A.Agent = C2.ID\nORDER BY A.ID DESC;\n</code></pre>\n\n<p>It is not valid syntax for MS Access.  You should check for errors.</p>\n\n<p>MS Access (rather pathetically) requires parentheses around joins:</p>\n\n<pre><code>SELECT A.ID, C1.Company, A.[Job Title], C2.Company\nFROM (Applied AS A LEFT JOIN\n      Company AS C1\n      ON A.Site  = C1.ID\n     ) LEFT JOIN\n     Company AS C2 ON A.Agent = C2.ID\nORDER BY A.ID DESC;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4442, "user_id": 5632412, "user_type": "registered", "accept_rate": 2, "profile_image": "https://www.gravatar.com/avatar/7922497d2bfc3a8fe33d4a22b15d995a?s=128&d=identicon&r=PG&f=1", "display_name": "Bimo", "link": "https://stackoverflow.com/users/5632412/bimo"}, "edited": false, "score": 0, "creation_date": 1449116263, "post_id": 34054337, "comment_id": 55869475, "body": "Thanks. That works. Except now the Select of C2.Company which is a string is showing up as A.Agent Integer in the Query.  Any Ideas on how to fix that one?    (Whoops... I just refreshed the form and now that problem is fixed as well)   Thanks again for your help!"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1449095300, "creation_date": 1449095300, "answer_id": 34054337, "question_id": 34053932, "link": "https://stackoverflow.com/questions/34053932/how-to-get-microsoft-access-sql-to-join-to-the-same-table-twice-with-null-ids-p/34054337#34054337", "title": "How to get microsoft access sql to join to the same table twice with null ID&#39;s possible occasionally?", "body": "<p>Try the second SQL in a regular query. Access normally wants parentheses when you have more than one JOIN in a query, and should complain. Actually I'm surprised it doesn't complain when it loads the second listbox.</p>\n\n<p>If that's the problem, simply do</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT A.ID, C1.Company, A.[Job Title], C2.Company \nFROM (Applied AS A LEFT JOIN Company AS C1 ON A.Site  = C1.ID)\nLEFT JOIN Company AS C2 ON A.Agent = C2.ID \nORDER BY A.ID DESC;\n</code></pre>\n"}], "owner": {"reputation": 4442, "user_id": 5632412, "user_type": "registered", "accept_rate": 2, "profile_image": "https://www.gravatar.com/avatar/7922497d2bfc3a8fe33d4a22b15d995a?s=128&d=identicon&r=PG&f=1", "display_name": "Bimo", "link": "https://stackoverflow.com/users/5632412/bimo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1556871585, "creation_date": 1449093712, "last_edit_date": 1556871585, "question_id": 34053932, "link": "https://stackoverflow.com/questions/34053932/how-to-get-microsoft-access-sql-to-join-to-the-same-table-twice-with-null-ids-p", "title": "How to get microsoft access sql to join to the same table twice with null ID&#39;s possible occasionally?", "body": "<p>I can get this to work, meaning a successful query:</p>\n\n<pre><code>Me.Listbox.RowSource = \n    \"SELECT A.ID, C1.Company, A.[Job Title] \n    FROM Applied AS A \n    LEFT JOIN Company AS C1 ON A.Site  = C1.ID \n    ORDER BY A.ID DESC;\"\n</code></pre>\n\n<p>However, this gives me an empty query result:</p>\n\n<pre><code>Me.Listbox.RowSource = \n    \"SELECT A.ID, C1.Company, A.[Job Title], C2.Company \n    FROM Applied AS A \n    LEFT JOIN Company AS C1 ON A.Site  = C1.ID \n    LEFT JOIN Company AS C2 ON A.Agent = C2.ID \n    ORDER BY A.ID DESC;\"\n</code></pre>\n\n<p>Any Idea's what's wrong with this?  </p>\n\n<p>I'm using Microsoft Access 2013 and VBA script. My Applied table has two integer fields (<code>Site</code> and <code>Agent</code>) that point to different primary keys in my <code>Company</code> table.  Both <code>Site</code> and <code>Agent</code> can have null values in an Apply Record, however <code>Site</code> is almost always filled in and <code>Agent</code> I only use occasionally to point to a company record. I thought about structuring it like an inventory application where you can have more than one company. I will never have more than two of these companies to keep track of; I just want their information pulled from the same companies database.</p>\n"}, {"tags": ["c#", "vb.net", "excel", "vba", "com"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1449096832, "post_id": 34053672, "comment_id": 55863538, "body": "if you are able to catch up the &quot;record macro&quot;, you could write a logfile with it.... but thats just an idea and i dont know if and how that may be possible..."}], "answers": [{"comments": [{"owner": {"reputation": 1749, "user_id": 1186073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Vr9Ya.jpg?s=128&g=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/1186073/hugo"}, "edited": false, "score": 0, "creation_date": 1449156500, "post_id": 34054913, "comment_id": 55892671, "body": "Thank for your input, your suggestion in combination with a little cell hidden format like Custom Format &quot;0,00E+00&quot;, will do the trick"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 1749, "user_id": 1186073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Vr9Ya.jpg?s=128&g=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/1186073/hugo"}, "edited": false, "score": 0, "creation_date": 1449173844, "post_id": 34054913, "comment_id": 55903876, "body": "Make sure you disable the detection of events (<code>Application.EnableEvents = False</code>) as soon as the worksheet change event fires because it will fire again as soon as your script pastes values to the cells. This will cause an infinite loop. Once you complete all you need then re-enable detection of events (<code>Application.EnableEvents = True</code>). Cheers,"}, {"owner": {"reputation": 1749, "user_id": 1186073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Vr9Ya.jpg?s=128&g=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/1186073/hugo"}, "edited": false, "score": 0, "creation_date": 1449243852, "post_id": 34054913, "comment_id": 55936384, "body": "Actually my script did not paste anything, it is just monitoring what the user is doing"}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": true, "score": 1, "last_activity_date": 1449098054, "creation_date": 1449098054, "answer_id": 34054913, "question_id": 34053672, "link": "https://stackoverflow.com/questions/34053672/excel-detect-pastespecial-operation/34054913#34054913", "title": "Excel Detect PasteSpecial operation", "body": "<p>you can detect a \"Paste Special\" event by monitoring the Undo list through:</p>\n\n<pre><code>If Application.CommandBars(\"Standard\").Controls(\"&amp;Undo\").List(1) = \"Paste Special\" Then\n</code></pre>\n\n<p>Not necessary to check the actual keystrokes.</p>\n\n<p>Sadly it doesn't offer any further detail of what type of paste special was performed. If you know the range (either predefined or through the <code>Target</code> in your <code>Workbook_SheetChange</code> event) you can then do an undo (<code>Application.Undo</code>), store the cell values before the paste, redo the paste at the Target. If the values have changed then it wasn't a \"Format Only - Special Paste\". Hope this helps.</p>\n"}], "owner": {"reputation": 1749, "user_id": 1186073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Vr9Ya.jpg?s=128&g=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/1186073/hugo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 34054913, "answer_count": 1, "score": 0, "last_activity_date": 1449098054, "creation_date": 1449092868, "question_id": 34053672, "link": "https://stackoverflow.com/questions/34053672/excel-detect-pastespecial-operation", "title": "Excel Detect PasteSpecial operation", "body": "<p>I'm working on a software that evaluate the skill of a user on Excel.\nSo the user do some operation within Excel, as asked in a series of question,\nand my job is to program something to validate what the user have done, using Excel COM Object.<br>\nI'm able to validate thing like; Cell format, Cell Orientation, Print Area, Font Type, merged Cells, etc. But I'm struggling to validate the \"Paste Special\" operation.\nI've a hook with the Change event of the WorkSheet and the WorkSheet itself. So I can catch what keyStroke the user have done and the the actual format of the cell. \nBut I'm not able to find a way to tell if the user have used the \"Format Only - Special Paste\". Has anyone can help me on this?</p>\n"}, {"tags": ["regex", "vba", "ms-access"], "comments": [{"owner": {"reputation": 12281, "user_id": 1322268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EfWtq.jpg?s=128&g=1", "display_name": "shawnt00", "link": "https://stackoverflow.com/users/1322268/shawnt00"}, "edited": false, "score": 2, "creation_date": 1449093114, "post_id": 34053517, "comment_id": 55861703, "body": "Create a function using <code>split()</code>: regex isn&#39;t necessary. First split on &quot;|&quot; then split each individual substring on &quot;-&quot;. If the second value there is &quot;KH&quot; (and I think you can assume the first value is a number) then just add the first value to your sum."}], "answers": [{"tags": [], "owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "is_accepted": false, "score": 0, "last_activity_date": 1449093477, "creation_date": 1449093477, "answer_id": 34053869, "question_id": 34053517, "link": "https://stackoverflow.com/questions/34053517/regex-summing-values-in-a-string/34053869#34053869", "title": "Regex - Summing values in a string", "body": "<p>You would do a single bulk insert into an SQL Server table using | as the field terminator, so you would have fields like f1,f2,f3,f4. Then you can use an expression like:</p>\n\n<pre><code>WITH numerics\n     AS ( SELECT CASE\n                     WHEN PATINDEX('%-KH-%', f1) &gt; 0\n                     THEN CAST(SUBSTRING(f1, 1, PATINDEX('%-KH-%', f1) - 1) AS INT)\n                     ELSE 0\n                 END AS f1,\n                CASE\n                    WHEN PATINDEX('%-KH-%', f2) &gt; 0\n                    THEN CAST(SUBSTRING(f2, 1, PATINDEX('%-KH-%', f2) - 1) AS INT)\n                    ELSE 0\n                END AS f2,\n                CASE\n                    WHEN PATINDEX('%-KH-%', f3) &gt; 0\n                    THEN CAST(SUBSTRING(f3, 1, PATINDEX('%-KH-%', f3) - 1) AS INT)\n                    ELSE 0\n                END AS f3,\n                CASE\n                    WHEN PATINDEX('%-KH-%', f4) &gt; 0\n                    THEN CAST(SUBSTRING(f4, 1, PATINDEX('%-KH-%', f4) - 1) AS INT)\n                    ELSE 0\n                END AS f4\n          FROM myTable )\n     SELECT f1 + f2 + f3 + f4 AS rowTotal;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 428, "user_id": 5520934, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e37c2789254e801492b819df6f8addcd?s=128&d=identicon&r=PG&f=1", "display_name": "SQLSuperHero", "link": "https://stackoverflow.com/users/5520934/sqlsuperhero"}, "edited": false, "score": 0, "creation_date": 1449098519, "post_id": 34055003, "comment_id": 55864220, "body": "Seems pretty cool. I&#39;m a little new to Powershell so this will take me a bit to understand but I like the idea."}], "tags": [], "owner": {"reputation": 9666, "user_id": 1419175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PRKSW.jpg?s=128&g=1", "display_name": "Dave Sexton", "link": "https://stackoverflow.com/users/1419175/dave-sexton"}, "is_accepted": false, "score": 0, "last_activity_date": 1449098403, "creation_date": 1449098403, "answer_id": 34055003, "question_id": 34053517, "link": "https://stackoverflow.com/questions/34053517/regex-summing-values-in-a-string/34055003#34055003", "title": "Regex - Summing values in a string", "body": "<p>You could do it with a Powershell script, that would give the power of regex to extract and sum the numbers. Something like the example below (I have tested the extracting from the file part but not the Access parts so they may need some tweaking):</p>\n\n<pre><code>$conn = New-Object -ComObject ADODB.Connection \n$recordset = New-Object -ComObject ADODB.Recordset\n$conn.Open()\n$cmd = $conn.CreateCommand()\n\n$ado.open(\"Provider = Microsoft.ACE.OLEDB.12.0;Data Source=\\\\path_to\\database.accdb\")\n# Microsoft.Jet.OLEDB.4.0 for older versions of Access\n\n(Select-String file.txt -Pattern '[\\d.]+(?=-KH)' -AllMatches) | % {\n    ($_.Matches | % {\n        [double]$_.Value\n    } | Measure-Object -Sum).Sum\n} | % {\n    $cmd.CommandText = \"INSERT INTO TABLE VALUES($($_))\"\n    Write-Output $cmd.ExecuteNonQuery()\n}\n$conn.Close()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12281, "user_id": 1322268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EfWtq.jpg?s=128&g=1", "display_name": "shawnt00", "link": "https://stackoverflow.com/users/1322268/shawnt00"}, "edited": false, "score": 0, "creation_date": 1449102356, "post_id": 34055579, "comment_id": 55865441, "body": "Considering the possibility that a numeric value appears between two of the hyphens do you think it&#39;s worth eliminating the inner loop?"}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "reply_to_user": {"reputation": 12281, "user_id": 1322268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EfWtq.jpg?s=128&g=1", "display_name": "shawnt00", "link": "https://stackoverflow.com/users/1322268/shawnt00"}, "edited": false, "score": 0, "creation_date": 1449121951, "post_id": 34055579, "comment_id": 55871316, "body": "@shawnt00 yes, the inner loop can be eliminated, I will post additional variant which you&#39;ve commented below OP, if you don&#39;t mind."}], "tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": true, "score": 0, "last_activity_date": 1449107338, "last_edit_date": 1449107338, "creation_date": 1449101516, "answer_id": 34055579, "question_id": 34053517, "link": "https://stackoverflow.com/questions/34053517/regex-summing-values-in-a-string/34055579#34055579", "title": "Regex - Summing values in a string", "body": "<p><strong>Using [Excel] can be done like this:</strong></p>\n\n<p><em>code:</em></p>\n\n<pre><code>Sub test()\n    Dim cl As Range, z!, x As Variant, x2 As Variant\n    For Each cl In [A1:A4]\n    z = 0\n        For Each x In Split(cl.Value2, \"|\")\n            If x Like \"*-KH-*\" Then\n                For Each x2 In Split(x, \"-\")\n                    If IsNumeric(x2) Then z = z + x2\n                Next x2\n            End If\n        Next x\n    cl.Offset(, 1).Value = z\n    Next cl\nEnd Sub\n</code></pre>\n\n<p><em>another variant, without second loop (using <code>@shawnt00</code> comment below OP)</em></p>\n\n<pre><code>Sub test()\n    Dim cl As Range, z!, x As Variant\n    For Each cl In [A1:A4]\n    z = 0\n        For Each x In Split(cl.Value2, \"|\")\n            If x Like \"*-KH-*\" Then z = z + Left(x, InStr(1, x, \"-\") - 1)\n        Next x\n    cl.Offset(, 1).Value = z\n    Next cl\nEnd Sub\n</code></pre>\n\n<p><em>output:</em><br>\n<a href=\"https://i.stack.imgur.com/DDwEd.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DDwEd.jpg\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong>Using [Access] can be something like this:</strong></p>\n\n<pre><code>Sub test2()\n    Dim z!, x As Variant\n    Dim rs As DAO.Recordset\n    Set rs = CurrentDb.OpenRecordset(\"SELECT * FROM Table1\")\n    Do Until rs.EOF = True\n        z = 0\n        For Each x In Split(rs!Field1, \"|\")\n                If x Like \"*-KH-*\" Then z = z + Left(x, InStr(1, x, \"-\") - 1)\n        Next x\n        Debug.Print rs!Field1, z\n        rs.MoveNext\n    Loop\nEnd Sub\n</code></pre>\n\n<p><em>test:</em><br>\n<a href=\"https://i.stack.imgur.com/mjdA2.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mjdA2.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 428, "user_id": 5520934, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e37c2789254e801492b819df6f8addcd?s=128&d=identicon&r=PG&f=1", "display_name": "SQLSuperHero", "link": "https://stackoverflow.com/users/5520934/sqlsuperhero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 34055579, "answer_count": 3, "score": 0, "last_activity_date": 1449107338, "creation_date": 1449092295, "last_edit_date": 1449092608, "question_id": 34053517, "link": "https://stackoverflow.com/questions/34053517/regex-summing-values-in-a-string", "title": "Regex - Summing values in a string", "body": "<p>We get data from another company in the following formats</p>\n\n<p><code>374-KH-ON-PEAK|807-KH-OFF-PEAK\n82.5-KH-TOTAL|8-K1-CURRENT\n44.5-KH-TOTAL\n65-KH-ON-PEAK|2.1-K1-ON-PEAK|164-KH-OFF-PEAK|27-K1</code></p>\n\n<p>These values go into a SQL Server table. The numbers represent electricity usages. I'm working on finding a way to extract the numbers and sum them together. </p>\n\n<p>There is only one condition: the number must be followed by \"-KH\". If it is followed by \"-K1\" we don't need to do anything with it.</p>\n\n<p>Upon inputting <code>\"65-KH-ON-PEAK|2.1-K1-ON-PEAK|164-KH-OFF-PEAK|27-K1\"</code>, I need to output <code>229</code> which stands for <code>65</code> + <code>164</code></p>\n\n<p>I'd prefer to find a solution using VBA for Access(For reasons related to the business's current software solutions), but I'm open to other solutions as well. </p>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1449161956, "creation_date": 1449161956, "answer_id": 34071876, "question_id": 34053320, "link": "https://stackoverflow.com/questions/34053320/highlighted-text-in-word/34071876#34071876", "title": "Highlighted text in Word", "body": "<ol>\n<li><p>You can use VBA code in Word documents and tables BUT the VBA that works with the tables/cells is NOT the same as the Excel code. Different application, different object model.</p></li>\n<li><p>Certainly. The Range.HighlightColorIndex returns the highlight color (WdColorIndex, as an integer) applied to the Range. No highlight is wdNoHighlight, integer value = 0.</p></li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 5632149, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CFtXrQgBOhw/AAAAAAAAAAI/AAAAAAAAAJQ/_nAjNpi0vnc/photo.jpg?sz=128", "display_name": "joanxm", "link": "https://stackoverflow.com/users/5632149/joanxm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449161956, "creation_date": 1449091571, "last_edit_date": 1495542616, "question_id": 34053320, "link": "https://stackoverflow.com/questions/34053320/highlighted-text-in-word", "title": "Highlighted text in Word", "body": "<p>I have a table in Word. What I would like to do is to sum the numbers from the rows that were highlighted (in only one column). I found on the internet <a href=\"http://www.exceltrick.com/how_to/sum-cells-based-on-background-color/\" rel=\"nofollow noreferrer\">the way to sum the content of the cells if they have specific background color</a>, and then using <a href=\"https://stackoverflow.com/questions/13913004/excel-user-defined-function-if-cell-is-highlighted-then\">this thread</a> I changed the function so that it checks for the highlight color, not background. That's what I created: </p>\n\n<pre><code>Function ColorIndex(Rng As Range)\n  ColorIndex = Rng.Interior.ColorIndex\nEnd Function\n</code></pre>\n\n<p>But, then when I wanted to check if it works in Excel, I realised that in Excel there is no 'higlight the text' option at all. It made me realise that probably the function would not be doing what I want anyway, I checked and as I expected, it would return the color of the cell background. Therefore, I wanted to see if the function will work in Word, but apparently you can only use some pre-programmed functions in Word, and I cannot choose the function I created in VBA using Insert -> Module. That's why I have two questions: <br><br>\n1) Is it possible to use a function created by VBA in Word table and if yes, how to do it? <br>\n2) Is there a way to have a function that would check whether the text is highlighted?</p>\n"}, {"tags": ["arrays", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5632339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a31207c5bb3a250b6cc25c7f0ae79?s=128&d=identicon&r=PG&f=1", "display_name": "rero360", "link": "https://stackoverflow.com/users/5632339/rero360"}, "edited": false, "score": 0, "creation_date": 1449096401, "post_id": 34053811, "comment_id": 55863358, "body": "Thank you, I made those changes and I&#39;ve made some progress.  What I have now is on sheet3 I get values to populate however where it lists 30 positions across the top, it will only input results in for the first 20, and same going down the horizontal, it lists 20 but then gives results for 30.  Plus all the results for each row is identical, so it&#39;s 0s all across the top, then 1.09319 next row down, and so on and so forth.  It seems to want to keep going and it gives me a subscript out of range again after displaying all that info."}, {"owner": {"reputation": 19, "user_id": 5632339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a31207c5bb3a250b6cc25c7f0ae79?s=128&d=identicon&r=PG&f=1", "display_name": "rero360", "link": "https://stackoverflow.com/users/5632339/rero360"}, "edited": false, "score": 0, "creation_date": 1449152913, "post_id": 34053811, "comment_id": 55889955, "body": "I think I&#39;m on the right track so far, what I&#39;m stuck at now it, my formulas are going through for the first client and populating the data into the array, but when it tries to go to the second client it crashes.  How do I get it so that the array will run through all the calculations for the first client, store that info, calculate everything for the second client, add the two amounts together, store that, start the third client and so on and so forth until the end?"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1449093262, "creation_date": 1449093262, "answer_id": 34053811, "question_id": 34053235, "link": "https://stackoverflow.com/questions/34053235/building-a-2d-array-in-excel/34053811#34053811", "title": "building a 2D array in excel", "body": "<p>When you dimension <code>loc#</code> via</p>\n\n<pre><code>ReDim loc#(Cust, 2)\n</code></pre>\n\n<p>The first index must be between 1 and <code>Cust</code></p>\n\n<p>The you have the loop</p>\n\n<pre><code>For k = 1 To Cust\nx = Cells(7 + k, 2)\ny = Cells(7 + k, 3)\nNext k\n</code></pre>\n\n<p>After this loop runs <code>k</code> has value <code>Cust + 1</code>, not <code>Cust</code> since for-loops in VBA first increment the counter and then test if it has exceeded the limit.</p>\n\n<p>You don't use <code>k</code> again until the line </p>\n\n<pre><code>di = Abs(Sheet3.Cells(1, x + 2) - loc(k, 1))\n</code></pre>\n\n<p>At this stage <code>k</code> is <code>Cust + 1</code> -- which is one more than the highest permissible subscript, hence the subscript out of range error. </p>\n\n<p>In context, I think that you meant to use <code>j</code> rather than <code>k</code> in both that line and the next line. I don't know if your code has other issues, but getting rid of <code>k</code> in those lines should help.</p>\n"}], "owner": {"reputation": 19, "user_id": 5632339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a31207c5bb3a250b6cc25c7f0ae79?s=128&d=identicon&r=PG&f=1", "display_name": "rero360", "link": "https://stackoverflow.com/users/5632339/rero360"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449189739, "creation_date": 1449091285, "last_edit_date": 1531161705, "question_id": 34053235, "link": "https://stackoverflow.com/questions/34053235/building-a-2d-array-in-excel", "title": "building a 2D array in excel", "body": "<p>I'm trying to build an array for a school project, scenario is this:</p>\n\n<p>You have a city that is 30 miles (y) by 20 miles (x) with roads every mile, have to write code that gives the best location for placement of a distribution center based on the business locations and cost to delivery goods to each.</p>\n\n<p>I have one bit of code that records the number of client businesses, an array that records the locations of the businesses, and an array that stores volume of product each client buys.</p>\n\n<p>Where I'm stuck at, is I think I should build an array that is 0 to 30, 0 to 20 (the size of the city) but I have to evaluate the cost based on user defined precision (.25, .5, 1, and 2 miles) so I should have the array be able to store the values from the calculations for 120 by 80 cells.</p>\n\n<p>Not sure if that makes sense, here is the requirements:\nSpecifically, your program should be able to complete the following tasks:</p>\n\n<ol>\n<li>Read the customer data, and user input for analysis resolution. Your program must be designed to\naccommodate changes in the number of customers, their locations, and their product delivery volumes. User options for analysis resolution will be: 0.25 miles, 0.5 miles, 1 mile, and 2 miles.</li>\n<li>Validate that user input is numeric and valid.</li>\n<li>Analyze the costs at all possible distribution center locations (which may be collocated with customer\nlocations), and determine the optimums.</li>\n<li>Display the X and Y values of the optimum distribution center locations and the corresponding minimum\nweekly cost. There may be multiple locations with the same minimum cost.</li>\n<li>Display the costs at all locations adjacent to the optimums, in order to show the sensitivity of the result.</li>\n</ol>\n\n<p>The formulas to use are:</p>\n\n<p>Distance to customer <code>(Di)=abs|x-xi|+|y+yi|</code></p>\n\n<p>Cost for customer <code>(Ci)=1/2*Di*Vi</code> (volume of customer product)* Ft</p>\n\n<pre><code>Ft = 0.03162*y+0.04213*x+0.4462\n\ncost = sum Ci from 1 to number of clients\n</code></pre>\n\n<p>Below is my code so far, I started it to have it basically build the array and display it on a second sheet, so I can visualize it but I can't have that in the final product. In debugging it, it gets to the line of code <code>di =</code> and gives me a subscript out of range.</p>\n\n<pre><code>Option Explicit\nOption Base 1\n\nSub load()\nDim Cust!, x#, y#, volume#(), n!, loc#(), i%, vol#, xi#, ci#, di#, j#\nDim choices#, val#(), nptsx!, nptsy!, Ft#, lowx!, lowy!, low!, M!\nDim costmatrix#(), npts!, cost!()\n\n'find number of customers\nCust = 0\nDo While Cells(8 + Cust, 1).Value &lt;&gt; \"\"\n  Cust = Cust + 1\nLoop\n\nIf Cust &lt; 2 Then\n  MsgBox \"number of customers must be greater than 1.\"\n  Exit Sub\nEnd If\n\n'establist array of customer locations\nReDim loc#(1, Cust)\n  For j = 1 To Cust\n    x = Cells(7 + j, 2)\n    y = Cells(7 + j, 3)\n  Next j\n\nReDim volume#(Cust, 1)\n  For i = 1 To Cust\n    vol = Cells(7 + i, 4)\n  Next i\n\nchoices = Cells(3, 7).Value\nnptsx = 30 / choices + 1\nnptsy = 20 / choices + 1\n\n '30x20 grid\nReDim costmatrix(x To nptsx, y To nptsy)\n  For x = 0 To nptsx - 1\n    Sheet3.Cells(1, x + 2) = x * choices\n  Next x\n  For y = 0 To nptsy - 1\n    Sheet3.Cells(2 + y, 1) = y * choices\n  Next y\n\n\n  For x = 0 To nptsx - 1\n  For y = 0 To nptsy - 1\n    For k = 1 To Cust\n  di = Abs(x * choices - Sheet1.Cells(7 + j, 2)) + Abs(y * choices - Sheet1.Cells(7 + j, 3))\n      Ft = 0.03162 * Sheet1.Cells(7 + j, 3) + 0.4213 * Sheet1.Cells(7 + j, 2) + 0.4462\n\n\n\nci = 1 / 2 * di * vol * Ft\n  Sheet3.Cells(x + 2, 2 + y) = ci\n  Next k\n\n  Next y\n  Next x\n\nlowx = x\nlowy = y\n\nRange(\"I9:J:3\").Clear\n\nRange(\"I9\") = \"optimum\"\nRange(\"J9\") = lowx * choices\nRange(\"K9\") = lowy * choices\nRange(\"L9\") = low\n\ni = 9\nIf lowy &lt; npts - 1 Then\n    i = i + 1\n    Cells(1, \"I\") = \"Increment North\"\n    Cells(1, \"L\") = cost(lowx, lowy + 1)\nEnd If\nIf lowy &gt; 0 Then\n    i = i + 1\n    Cells(1, \"I\") = \"Increment South\"\n    Cells(1, \"L\") = cost(lowx, lowy - 1)\nEnd If\nIf lowx &lt; npts - 1 Then\n    i = i + 1\n    Cells(1, \"I\") = \"Increment East\"\n    Cells(1, \"L\") = cost(lowx, lowy + 1)\nEnd If\nIf lowx &gt; 0 Then\ni = i + 1\n    Cells(1, \"I\") = \"Increment West\"\n    Cells(1, \"L\") = cost(lowx, lowy - 1)\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Updated, I have built the array, but I need to figure out how to do the calculations for all clients in one cell at a time, adding the results for each client together and putting the sum of them into the cell, then going onto the next cell.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5586811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a92049ec1c16986bca23a2e9360fde5d?s=128&d=identicon&r=PG&f=1", "display_name": "Nick ", "link": "https://stackoverflow.com/users/5586811/nick"}, "edited": false, "score": 0, "creation_date": 1450815895, "post_id": 34052873, "comment_id": 56589342, "body": "I had to add an End If after End With because I was getting an error.  It works but only if there is no page breaks in the range(&quot;A1:Z24&quot;). Any idea of how to get it to work if there are page breaks in the range (I just want one page per selection)?  Also, what if I only want to do it for the first 6 tabs, how could I get it to stop?  Thanks"}, {"owner": {"reputation": 41, "user_id": 5586811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a92049ec1c16986bca23a2e9360fde5d?s=128&d=identicon&r=PG&f=1", "display_name": "Nick ", "link": "https://stackoverflow.com/users/5586811/nick"}, "edited": false, "score": 0, "creation_date": 1451311898, "post_id": 34052873, "comment_id": 56731534, "body": "I am getting a subscript out of range code error in the .VPageBreaks(1) line"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 41, "user_id": 5586811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a92049ec1c16986bca23a2e9360fde5d?s=128&d=identicon&r=PG&f=1", "display_name": "Nick ", "link": "https://stackoverflow.com/users/5586811/nick"}, "edited": false, "score": 0, "creation_date": 1451312326, "post_id": 34052873, "comment_id": 56731726, "body": "what does your page look like in page break preview when it hits that line? is it already only 1 page?"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 3, "last_activity_date": 1450876273, "last_edit_date": 1450876273, "creation_date": 1449089968, "answer_id": 34052873, "question_id": 34052790, "link": "https://stackoverflow.com/questions/34052790/vba-code-to-set-print-area-fit-to-1x1-page-and-not-set-print-area-for-certain-t/34052873#34052873", "title": "VBA code To set Print Area, fit to 1x1 page and not set print area for certain tabs", "body": "<p>You were almost there. You can loop through the worksheets directly and not have to reference them with a counter.</p>\n\n<p>This should set you up pretty nicely :)</p>\n\n<pre><code>Sub PrintArea()\n\nApplication.ScreenUpdating = False\n\nDim ws As Worksheet\n\nFor Each ws In ActiveWorkbook.Worksheets\n\n    Select Case ws.Index\n\n        Case Is = 1, 2, 3, 4, 5, 6 'only perform action on first 6 sheets\n\n            If ws.Range(\"A25\") = \"Yes\" Then 'adjust to desired range and indicator\n\n                With ws.PageSetup\n                    .PrintArea = ws.Range(\"A1:Z24\").Address\n                    .Orientation = xlLandscape\n                    .FitToPagesWide = 1\n                    .FitToPagesTall = 1\n                End With\n\n                'set print area to only 1 page\n                With ws\n                    .Activate 'need to activate sheet to view Page Break Preview\n                    ActiveWindow.View = xlPageBreakPreview 'need to view Page Break Preview to drag page breaks\n                    .VPageBreaks(1).DragOff Direction:=xlToRight, RegionIndex:=1 `drag page over so it's just one page\n                    ActiveWindow.View = xlNormalView 'set view back to normal\n                End With\n\n            End If\n\n    End Select\n\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5586811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a92049ec1c16986bca23a2e9360fde5d?s=128&d=identicon&r=PG&f=1", "display_name": "Nick ", "link": "https://stackoverflow.com/users/5586811/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11096, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1450876273, "creation_date": 1449089718, "last_edit_date": 1449090079, "question_id": 34052790, "link": "https://stackoverflow.com/questions/34052790/vba-code-to-set-print-area-fit-to-1x1-page-and-not-set-print-area-for-certain-t", "title": "VBA code To set Print Area, fit to 1x1 page and not set print area for certain tabs", "body": "<p>I have this code to set the print area of certain sheets in a workbook.  I'm trying to set the print area so it fits each tab on one page and doesn't divide it into several pages.  Also could someone please help me with code to not set the print area on certain tabs based on the same cell value in each tab?</p>\n\n<pre><code>Sub PrintArea()\n\n    Dim I As Integer\n    Dim ws As Worksheet\n\n    WS_Count = ActiveWorkbook.Worksheets.Count\n    For I = 1 To 6\n\n    Set ws = ThisWorkbook.Sheets(I)\n\n    ws.PageSetup.PrintArea = ws.Range(\"A1:Z24\").Address\n\n    With ws.PageSetup\n        .Orientation = xlLandscape\n        .FitToPagesWide = 1\n        .FitToPagesTall = 1\n\n   End With\n   Next I\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1449132407, "post_id": 34052352, "comment_id": 55876126, "body": "Im not sure what the line <code>spend_plan_form_update</code> is meant to do? is it something you should be calling?.... In addition, is it possible for you to use <code>multirow</code> on your tab control?"}, {"owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "reply_to_user": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1449176313, "post_id": 34052352, "comment_id": 55905284, "body": "Ok.  Here&#39;s the latest.  I did try multirow - nothing.  I tried removing all of the other code except for setfocus to the spend plan and NOTHING fixed it.  But then I tried looking at it on another user&#39;s monitor and all of the symptoms were gone.  Huh?  So I&#39;ve been playing with code and all I need to do is change the monitor?  Should I make the form smaller?  Another thing I&#39;ve come to notice is that if I press &#39;Refresh All&#39; I get my tabs back.  So what is this setting that I need to make sure is in place?"}], "owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459421235, "creation_date": 1449088017, "last_edit_date": 1459421235, "question_id": 34052352, "link": "https://stackoverflow.com/questions/34052352/form-scrolls-down-and-loses-navigation-focus-after-changing-tabs", "title": "Form scrolls down and loses navigation focus after changing tabs", "body": "<p>I have a form that has 7 tabs.  Not all of the tabs show, so I have a button that unhides the tab when the user selects the button.  The reason for this is to control access to this tab with user security.</p>\n\n<p>Everything works nicely except for the fact that when I click on the button and the tab shows, it also scrolls up for some reason. At this point, I can't even do anything to get to the tabs which have scrolled out of view, and I don't want scroll bars either. I finally had to put a 'back' button so that I could get back to the tab that has the buttons on it at which point, I need to press the arrow keys to see the tabs again.</p>\n\n<p>Here is the code for the 'Spend Plan' button:  an iSecLevel of 1 gets to see all of the buttons.  iSecLevel of 2 only sees the Spend Plan Button</p>\n\n<pre><code>Private Sub cmdSP_Click()\n\nSelect Case iSecLevel\n\nCase 2\n    Me.TAB_SP.Pages(1).Visible = True\n    Me.TAB_SP.Pages(1).SetFocus\n    Me.TAB_SP.Pages(4).Visible = True\n    Me.TAB_SP.Pages(2).Visible = False\n    Me.TAB_SP.Pages(3).Visible = False\n    Me.TAB_SP.Pages(5).Visible = False\n    Me.TAB_SP.Pages(6).Visible = False\n    Me.cmdCopyFromServer.Visible = False\n    Me.cmdCopyToServer.Visible = False\n    Me.cmdCOB.Visible = False\n    Me.TAB_SP.Pages(6).Visible = False\n    strFormState = \"Default\"\n    Spend_Plan_Form_Update\n\nCase 1\n\n    Me.TAB_SP.Pages(1).Visible = True\n    Me.TAB_SP.Pages(1).SetFocus\n    Me.TAB_SP.Pages(4).Visible = True\n    Me.TAB_SP.Pages(2).Visible = False\n    Me.TAB_SP.Pages(3).Visible = False\n    Me.TAB_SP.Pages(5).Visible = True\n    Me.TAB_SP.Pages(6).Visible = True\n    Me.cmdCopyFromServer.Visible = True\n    Me.cmdCopyToServer.Visible = True\n    Me.cmdCOB.Visible = True\n    strFormState = \"Default\"\n    Spend_Plan_Form_Update\n\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p>Is it an anchor or centering problem that I am experiencing?  I would prefer for all of the tabs to remain visible at the top of the screen.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1449089058, "post_id": 34051840, "comment_id": 55859476, "body": "ChartObjects is a collection associated with a worksheet. It&#39;s not an Application-level item"}, {"owner": {"reputation": 1098, "user_id": 308553, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/13623c798460209d3cf244cc02e5ac5f?s=128&d=identicon&r=PG", "display_name": "user308553", "link": "https://stackoverflow.com/users/308553/user308553"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1449089621, "post_id": 34051840, "comment_id": 55859782, "body": "Can you elaborate a bit? so the hierarchy is something like Application.ActiveWorkbook.ActiveWorksheets.Range(&quot;A1&quot;).Valu&zwnj;&#8203;e. And usually when im working on a worksheet (it is currently active) I can just do Range(&quot;A1&quot;).value. So in this case with chartObjects why doesnt it work? Why do we have to specify Activesheet, when usually it just assume it is there? or am I misunderstanding something here"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1449101410, "post_id": 34051840, "comment_id": 55865169, "body": "<code>ActiveSheet</code> is a property of the <code>Application</code> object, since there can be only one per instance of Excel.  <code>Range()</code> <i>typically</i> defaults to the Active sheet, but if it&#39;s in a sheet code module it defaults to that sheet.  It&#39;s good practice however to never use <code>Range()</code> without qualifying it with a worksheet object: unqualified Range objects make your code brittle and difficult to debug."}], "owner": {"reputation": 1098, "user_id": 308553, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/13623c798460209d3cf244cc02e5ac5f?s=128&d=identicon&r=PG", "display_name": "user308553", "link": "https://stackoverflow.com/users/308553/user308553"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 340, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1449086151, "creation_date": 1449086151, "question_id": 34051840, "link": "https://stackoverflow.com/questions/34051840/why-need-to-specify-activesheet-for-chartobjects-add", "title": "Why need to specify activesheet for chartobjects.add", "body": "<pre><code>Sub smarterway()\n    Dim chartfirst As ChartObject\n    Dim rngChart As Range\n    Set rngChart = Range(\"D3:J20\")\n\n    Set chartfirst = ActiveSheet.ChartObjects.Add(Left:=rngChart.Left, Top:=rngChart.Top, Width:=rngChart.Width, Height:=rngChart.Height)\n[....]\n</code></pre>\n\n<p>For this line:</p>\n\n<blockquote>\n  <p>Set chartfirst = ActiveSheet.ChartObjects.Add(..)</p>\n</blockquote>\n\n<p>if I dont add in <em>Activesheet</em> in. I get a <em>Object Required</em> error. </p>\n\n<p>I don't understand why though. Isnt it assumed it is Activesheet, cause I usually don't put Activesheet in my codes and it works as long as I have the required sheet opened and activated.</p>\n\n<p>I'm clearly missing and misunderstanding something very fundamental in vba, please advice </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 137, "user_id": 1342775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3UGR.jpg?s=128&g=1", "display_name": "RB-232", "link": "https://stackoverflow.com/users/1342775/rb-232"}, "edited": false, "score": 0, "creation_date": 1449086117, "post_id": 34051785, "comment_id": 55857944, "body": "For reference the rest of the code is on this page <a href=\"https://forums.techguy.org/threads/importing-multiple-csv-files-and-transposing-data.896903/\" rel=\"nofollow noreferrer\">forums.techguy.org/threads/&hellip;</a>"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1449086577, "post_id": 34051785, "comment_id": 55858223, "body": "What I do is set the <code>NumberFormat</code> before importing the data. If all of the data in the column is the same type, then before you copy the data, add the line <code>ws.Range(&quot;B&quot; &amp; iRow, ws.Cells(iRow, i + 1)).NumberFormat = wsX.Range(&quot;B1&quot;).NumberFormat</code> If you have different types in the CSV file and you are fine just bringing it all over as text, you can just add the line to set the number format right before Add Data in the same way."}, {"owner": {"reputation": 137, "user_id": 1342775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3UGR.jpg?s=128&g=1", "display_name": "RB-232", "link": "https://stackoverflow.com/users/1342775/rb-232"}, "reply_to_user": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1449086856, "post_id": 34051785, "comment_id": 55858356, "body": "It seems like I would have to know specifically which column the data is in and this is subject to change since the multiple applications we receive don&#39;t always have the accounting/routing numbers in the same column.  I&#39;d rather just get the functionality of &quot;text to Columns&quot; except on a massive scale as is shown in this macro.  Maybe I&#39;m misinterpreting your response."}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1449086917, "post_id": 34051785, "comment_id": 55858393, "body": "The point with that line of code is that it won&#39;t matter - it will mirror the NumberFormat that the CSV uses on a column by column basis, so it should come over with leading zero&#39;s if it is stored as text in the CSV. I run into this all the time - my coworker had 50 or so lines of code to sort out what the number format should be ... I just copy the number format from the cells we are importing and we don&#39;t have issues anymore."}, {"owner": {"reputation": 137, "user_id": 1342775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3UGR.jpg?s=128&g=1", "display_name": "RB-232", "link": "https://stackoverflow.com/users/1342775/rb-232"}, "reply_to_user": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1449087244, "post_id": 34051785, "comment_id": 55858570, "body": "So where would you put this line of code? after &quot; &#39;add data &quot; ?"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1449087316, "post_id": 34051785, "comment_id": 55858606, "body": "Before Add Data - give it a shot and let me know if it works for you. Note that if there are some cells stored as Numbers and some cells stored as text, you will need to loop through the cells to assign the proper number format - this will probably have some associated overhead but is also doable."}, {"owner": {"reputation": 137, "user_id": 1342775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3UGR.jpg?s=128&g=1", "display_name": "RB-232", "link": "https://stackoverflow.com/users/1342775/rb-232"}, "reply_to_user": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1449088564, "post_id": 34051785, "comment_id": 55859210, "body": "Yeah this didn&#39;t seem to work"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1449092472, "post_id": 34051785, "comment_id": 55861364, "body": "Sorry for the late reply - since I can&#39;t see your data, I can&#39;t tell if B1 is the correct number format (that&#39;s the cell I chose in the code I gave you). Basically what I&#39;m getting at is this: The CSV will have that value stored as Text, when you copy the VALUE ONLY, excel will try to figure out what it is and change it - this is why you lose leading zero&#39;s. To fix this, copy the number format that the CSV uses AND the values. Downside is you can&#39;t transpose numberformats.so you will have to loop through the cells."}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1449094808, "post_id": 34051785, "comment_id": 55862631, "body": "To make all the data come over as &quot;Text&quot;, you can use <code>ws.Range(&quot;B&quot; &amp; iRow, ws.Cells(iRow, i + 1)).NumberFormat = &quot;@&quot;</code> before Add Data. If you want to set the NumberFormat to the same numberformat that is listed on the CSV, look at the code I posted below. You will need to pull the data differently instead of just using <code>Application.Transpose</code> because sadly you can&#39;t transpose numberformats and assign properties of cells in that way - you have to do it on a cell by cell basis if you have mixed data in your column. My original one-liner will work if the first piece of data is stored as text."}], "owner": {"reputation": 137, "user_id": 1342775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3UGR.jpg?s=128&g=1", "display_name": "RB-232", "link": "https://stackoverflow.com/users/1342775/rb-232"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1449094057, "creation_date": 1449085994, "question_id": 34051785, "link": "https://stackoverflow.com/questions/34051785/injecting-code-to-format-all-columns-as-text-to-retain-leading-zeros-from-csvs", "title": "Injecting Code to format all columns as text to retain leading zeros from CSVs", "body": "<p>So here is 1 part of a 3 part macro that lets you browse to a folder and consolidate/transpose/retain header of a bunch of .csv files.  The problem we have is where to inject some code so that routing and account numbers are formatted as text and retain their leading zeros.  If the easiest solution is to just format the entire sheet as text, that would work for us...whatever it takes without having to go into specifics since this info wont always be in the same column.</p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>Option Explicit\n\n'Set a public constant variable\nPublic Const DNL As String = vbNewLine &amp; vbNewLine\n\nSub ImportData()\n\n'Declare all variables\nDim wb As Workbook, ws As Worksheet\nDim wbX As Workbook, wsX As Worksheet\nDim i As Long, iRow As Long, iFileNum As Long, sMsg As String\nDim vFolder As Variant, sSubFolder As String, sFileName As String\nDim bOpen As Boolean\n\n'Turn off some application-level events to improve code efficiency\nCall TOGGLEEVENTS(False)\n\n'Have the user choose the folder\nvFolder = BrowseForFolder()\n\n'Exit if nothing was chosen, variable will be False\nIf vFolder = False Then Exit Sub\n\n'Check if this is what the user wants to do, confirm with a message box, exit if no\nsMsg = \"Are you sure you want to import data from this folder:\"\nsMsg = sMsg &amp; DNL &amp; vFolder\nIf MsgBox(sMsg, vbYesNo + vbDefaultButton2, \"ARE YOU SURE?\") &lt;&gt; vbYes Then Exit Sub\n\n'Set sub-folder as variable for save name at end of routine\nsSubFolder = Right(vFolder, Len(vFolder) - InStrRev(vFolder, Application.PathSeparator))\n\n'Set destination file with one worksheet\nSet wb = Workbooks.Add(xlWBATWorksheet)\nSet ws = wb.Sheets(1)\n\n'This will be the row to start data on, to incriment in loop\niRow = 2\n\n'Loop through files in folder\nsFileName = Dir$(vFolder &amp; \"\\\")\nDo Until sFileName = \"\"\n\n    'Check that the file pattern matches what you want, i.e. 12.16.00.xls\n    If sFileName Like \"*.csv\" Then '### set file extension here\n\n        'Check to see if the file is open\n        'If file is open, set as variable, if not, open and set as variable\n        If ISWBOPEN(sFileName) = True Then\n            Set wbX = Workbooks(sFileName)\n            bOpen = True\n        Else\n            Set wbX = Workbooks.Open(vFolder &amp; \"\\\" &amp; sFileName)\n            bOpen = False\n        End If\n\n        'Set first sheet in target workbok as worksheet variable, from which to mine data\n        Set wsX = wbX.Sheets(1)\n\n        'Get last row from column A (range for copy/pasting)\n        i = wsX.Cells(wsX.Rows.Count, 1).End(xlUp).Row\n\n        'Check if a file has been added, if not add headers (frequency)\n        If iFileNum = 0 Then\n            ws.Range(\"B1\", ws.Cells(1, i + 1)).Value = Application.Transpose(wsX.Range(\"A1:A\" &amp; i))\n        End If\n\n        'Add data\n        ws.Range(\"B\" &amp; iRow, ws.Cells(iRow, i + 1)).Value = Application.Transpose(wsX.Range(\"B1:B\" &amp; i))\n\n        'Add file name to column A\n        ws.Range(\"A\" &amp; iRow).Value = \"'\" &amp; Left$(sFileName, Len(sFileName) - 4)\n\n        'Incriment variable values\n        iRow = iRow + 1\n        iFileNum = iFileNum + 1\n\n        'If file was closed to start with, clean up and close it\n        If bOpen = False Then wbX.Close SaveChanges:=False\n\n    End If\n\n    'Get next file name\n    sFileName = Dir$()\nLoop\n\n'Check if file name to save exists\nIf Dir$(vFolder &amp; \"\\\" &amp; sSubFolder &amp; \".xls\", vbNormal) = \"\" Then\n    wb.SaveAs vFolder &amp; \"\\\" &amp; sSubFolder &amp; \".xls\"\n    MsgBox \"Complete!\", vbOKOnly\nElse\n    MsgBox \"File already exists!  File is NOT saved!\", vbInformation, \"COMPLETE!\"\nEnd If\n\n'Reset events back to application defaults\nCall TOGGLEEVENTS(True)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "shell", "zip"], "answers": [{"tags": [], "owner": {"reputation": 509, "user_id": 3883521, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e65b84e72d44a1c595b074394d68a75c?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Rebsamen", "link": "https://stackoverflow.com/users/3883521/marco-rebsamen"}, "is_accepted": true, "score": 1, "last_activity_date": 1449086317, "last_edit_date": 1495535274, "creation_date": 1449086317, "answer_id": 34051895, "question_id": 34051541, "link": "https://stackoverflow.com/questions/34051541/vba-copying-and-replacing-files-in-zip-folder/34051895#34051895", "title": "vba copying and replacing files in zip folder", "body": "<p>Maybe this helps:\n(taken from: <a href=\"https://stackoverflow.com/a/14987890/3883521\">https://stackoverflow.com/a/14987890/3883521</a>)</p>\n\n<pre><code>With oApp.NameSpace(ZipFile &amp; \"\\\")\n  If OverwriteFile Then\n     For Each fil In .Items\n        If FSO.FileExists(DefPath &amp; fil.Name) Then\n           Kill DefPath &amp; fil.Name\n        End If\n     Next\n  End If\n  oApp.NameSpace(CVar(DefPath)).CopyHere .Items\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3098, "favorite_count": 0, "accepted_answer_id": 34051895, "answer_count": 1, "score": 1, "last_activity_date": 1449086317, "creation_date": 1449085231, "question_id": 34051541, "link": "https://stackoverflow.com/questions/34051541/vba-copying-and-replacing-files-in-zip-folder", "title": "vba copying and replacing files in zip folder", "body": "<p>I have created a VBA macro that pulls files from folder/subfolders based on a number of parameters. This includes finding zip folders that meet those parameters and copying them to a new directory so that each file can be searched through also. The problem that I'm having is that many of the files in those zips are duplicates, and as the project is to be automated, I cannot sit there and push the don't copy button every time it pops up. Is there a way to search through zip files and ignore the duplicate files? What I have for this part of my code is:</p>\n\n<pre><code>Sub Unzip(fileName As String, mainSubfolder As String)\n\nDim sourceDir As String, fileString As String\nDim FileNameFolder As Variant\nDim oApp As Object\n\nsourceDir = \"\\\\Filesrv02\\depts\\AR\\EDIfiles\\Remits\"\nfileString = mainSubfolder + fileName\n\n    If Right(sourceDir, 1) &lt;&gt; \"\\\" Then\n        sourceDir = sourceDir &amp; \"\\\"\n    End If\n\n    FileNameFolder = sourceDir &amp; \"Unzipped\"\n\n    If Dir(FileNameFolder, vbDirectory) = vbNullString Then\n        MkDir FileNameFolder\n    End If\n\n    Set oApp = CreateObject(\"Shell.Application\")\n        oApp.Namespace(FileNameFolder).CopyHere oApp.Namespace(fileString).Items\nEnd Sub\n</code></pre>\n\n<p>The last two lines are where I copy files from the zip folder into a new folder called \"Unzipped\". However, I'm not sure how to get at each individual file in the zip folder to say if it already exists, ignore it. Any suggestions would be greatly appreciated!</p>\n"}, {"tags": ["vba", "excel", "count"], "comments": [{"owner": {"reputation": 63, "user_id": 2131749, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/673bb783a6cc390cd3ca93d0b100073b?s=128&d=identicon&r=PG", "display_name": "Zionmoose", "link": "https://stackoverflow.com/users/2131749/zionmoose"}, "edited": false, "score": 0, "creation_date": 1449083785, "post_id": 34051087, "comment_id": 55856630, "body": "I have replaced that with Windows.Count too, did not work."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449084050, "post_id": 34051087, "comment_id": 55856780, "body": "Try <code>for each b in application.workbooks</code>"}, {"owner": {"reputation": 63, "user_id": 2131749, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/673bb783a6cc390cd3ca93d0b100073b?s=128&d=identicon&r=PG", "display_name": "Zionmoose", "link": "https://stackoverflow.com/users/2131749/zionmoose"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449084227, "post_id": 34051087, "comment_id": 55856892, "body": "I tried <code>For Each b In Application.Workbooks         MsgBox (CStr(b.Name))     Next b</code> but no luck, stil only shows the workbook with the button."}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1449084254, "post_id": 34051087, "comment_id": 55856911, "body": "Are the workbooks open in different applications?  (For example, often a downloaded workbook will open up in a completely different excel application)"}, {"owner": {"reputation": 63, "user_id": 2131749, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/673bb783a6cc390cd3ca93d0b100073b?s=128&d=identicon&r=PG", "display_name": "Zionmoose", "link": "https://stackoverflow.com/users/2131749/zionmoose"}, "reply_to_user": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1449084395, "post_id": 34051087, "comment_id": 55857004, "body": "@Demetri Yes. Can it not count them if its different excels that are open? If not is there a way to make it get all of them if this happens?"}, {"owner": {"reputation": 63, "user_id": 2131749, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/673bb783a6cc390cd3ca93d0b100073b?s=128&d=identicon&r=PG", "display_name": "Zionmoose", "link": "https://stackoverflow.com/users/2131749/zionmoose"}, "edited": false, "score": 0, "creation_date": 1449084564, "post_id": 34051087, "comment_id": 55857090, "body": "You are right. When I opened them all under 1 Excel application it counts them all. There has to be a way to get the workbooks from all open applications."}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1449084633, "post_id": 34051087, "comment_id": 55857124, "body": "As far as I know, there is no easy way to count the workbooks when they are in different applications.  There may be a way using functions that look at windows, but they are quite advanced.  (FindWindowEx, GetWindowText, GetClassName)"}, {"owner": {"reputation": 63, "user_id": 2131749, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/673bb783a6cc390cd3ca93d0b100073b?s=128&d=identicon&r=PG", "display_name": "Zionmoose", "link": "https://stackoverflow.com/users/2131749/zionmoose"}, "edited": false, "score": 1, "creation_date": 1449084712, "post_id": 34051087, "comment_id": 55857167, "body": "OK I will revise my question to ask this."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449084835, "post_id": 34051087, "comment_id": 55857238, "body": "Should add that rather important comment to OP..."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449085049, "post_id": 34051087, "comment_id": 55857371, "body": "Check <a href=\"http://excelribbon.tips.net/T009452_Finding_Other_Instances_of_Excel_in_a_Macro.html\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 63, "user_id": 2131749, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/673bb783a6cc390cd3ca93d0b100073b?s=128&d=identicon&r=PG", "display_name": "Zionmoose", "link": "https://stackoverflow.com/users/2131749/zionmoose"}, "edited": false, "score": 0, "creation_date": 1449086764, "post_id": 34051087, "comment_id": 55858316, "body": "Found this as a good answer. <a href=\"http://stackoverflow.com/a/3303016/2131749\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1513605964, "post_id": 47867325, "comment_id": 82705303, "body": "Friendly hint: you redimmed Arr(1 To 100, 1 To 2), but assign your 1-100 items to the 2nd dimension; think this to be correct:   <code>Arr(i, 1) = .Name</code> and <code>Arr(i, 2) = .Path &amp; &quot;\\&quot; &amp; .Name</code>. BTW <code>SearchFor$</code> is not needed in this example."}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1513731199, "post_id": 47867325, "comment_id": 82761471, "body": "yeah, i know, it was re-used code that i changed to my needs, the outcome had to be index in first dimension, wich is not practical generaly speaking because of redim not working unless last dimension."}], "tags": [], "owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "is_accepted": false, "score": 0, "last_activity_date": 1513774852, "last_edit_date": 1513774852, "creation_date": 1513595673, "answer_id": 47867325, "question_id": 34051087, "link": "https://stackoverflow.com/questions/34051087/excel-vba-counting-and-storing-list-of-all-open-workbooks/47867325#47867325", "title": "Excel VBA Counting and Storing List of All Open Workbooks", "body": "<p>here is an example how it can be done (no API):</p>\n\n<pre><code>Public Function ListAllExcelWB(Optional ByVal SearchFor$) As Variant() 'exept this one\nOn Error Resume Next\n\n If SearchFor = vbNullString Then SearchFor = \"*.*\"\n\nDim xl As Excel.Application\nDim Wb As Workbook\nDim Status As Long\nDim Arr()\nReDim Arr(1 to 2, 1 To 100)\nDim i&amp;\n\nDo\n  Err.Clear\n  Set xl = GetObject(, \"Excel.Application\")\n  Status = Err.Number\n  If Status = 0 Then\n      'xl.Visible = True\n      For Each Wb In xl.Workbooks\n            With Wb\n                  If .Name &lt;&gt; ThisWorkbook.Name Then\n                    i = i + 1\n                    Arr(1, i) = .Name \n                    Arr(2, i) = .Path &amp; \"\\\" &amp; .Name\n                    If i &gt; 99 Then Status = 1\n                  Else: Status = 1 'stoppe la loop si se trouve soi meme, car au niveau des stack, l'instance active est la derniere\n                  End If\n            End With\n      Next\n\n  End If\nLoop Until Status &lt;&gt; 0 '= 429\n\nIf i &gt; 0 Then\n      ReDim Preserve Arr(1 to 2,1 To i)\nElse: Erase Arr 'ReDim Arr(0 To 0)\nEnd If\n\nErr.Clear: On Error GoTo 0\n\nSet xl = Nothing: Set Wb = Nothing\nListAllExcelWB = Arr\nErase Arr\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 2131749, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/673bb783a6cc390cd3ca93d0b100073b?s=128&d=identicon&r=PG", "display_name": "Zionmoose", "link": "https://stackoverflow.com/users/2131749/zionmoose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1234, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513774852, "creation_date": 1449083738, "last_edit_date": 1449084892, "question_id": 34051087, "link": "https://stackoverflow.com/questions/34051087/excel-vba-counting-and-storing-list-of-all-open-workbooks", "title": "Excel VBA Counting and Storing List of All Open Workbooks", "body": "<p>I am looking to try and count the current number of workbooks that are opened. <code>Workbooks.Count</code> will not work because not all of the files are in the same Excel application instance. When the file is opened after being downloaded, its in a new instance of excel, so <code>Workbooks</code> does not include it.</p>\n\n<p>Is there a way to get the count of all workbooks for every instance of Excel that is running?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5631818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef65bd1719b5813acbef8f1d6a11ed1?s=128&d=identicon&r=PG&f=1", "display_name": "SteveP65", "link": "https://stackoverflow.com/users/5631818/stevep65"}, "edited": false, "score": 0, "creation_date": 1449600396, "post_id": 34051475, "comment_id": 56074020, "body": "The comparison is being done on one column of data.  So Ideally I would want to copy the column to an array, within that array remove any duplicate values.  I would then use that array for additional processing."}], "tags": [], "owner": {"reputation": 1364, "user_id": 3802688, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5dd6d7ca4269119b95035d02a0bf48ef?s=128&d=identicon&r=PG", "display_name": "Beengie", "link": "https://stackoverflow.com/users/3802688/beengie"}, "is_accepted": false, "score": 0, "last_activity_date": 1449601572, "last_edit_date": 1449601572, "creation_date": 1449085039, "answer_id": 34051475, "question_id": 34051080, "link": "https://stackoverflow.com/questions/34051080/excel-vba-remove-duplicates-reiteration-vs-filter/34051475#34051475", "title": "Excel VBA Remove Duplicates Reiteration vs Filter", "body": "<p>Yes, just make arrays, then check against the arrays, then deliver your results back to the worksheet. Personally I like to do things in memory instead of through the Application IDE. </p>\n\n<p>It is much faster (especially with tens of thousands of rows), you don't have to worry about screen refreshing, or having your user wonder what is going on with everything moving around so fast. I usually handle everything in memory, hand it back, then activate the worksheet that I want the user to see.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>dim set1Array() as String\ndim set2Array() as String\ndim set1Rows as Long\ndim set2Rows as Long\ndim lngX as Long\ndim lngY as Long\ndim blnDebug as Boolean; blnDebug = true ' flag for debugging\n\n' get count of rows so we know how big to make the arrays\nset1Rows = GetLastRow(Ws1)\nset2Rows = GetLastRow(Ws2)\n\n' set arrays to the proper size\nredim set1Rows(set1Rows - 1, 1)' 1 represents 2 columns since it's 0 based. the second column is a flag for duplicated.\nredim set2Rows(set2Rows - 1, 0)' 0 represents 1 column since it's 0 based\n\n' load the arrays with the sheet data\nfor lngX = 1 to set1Rows\n  set1Rows(lngX - 1, 0) = Worksheets(\"Sheet1\").range(\"A\" &amp; lngX).Text\nnext lngX\n\nfor lngX = 1 to set2Rows\n  set2Rows(lngX - 1, 0) = Worksheets(\"Sheet2\").range(\"A\" &amp; lngX).Text\nnext lngX\n\n' I like to do a debug callout here to see what I got to make sure that I am good to go with the dataset\nif blnDebug then\n  for lngX = 0 to Ubound(set1Rows)\n    debug.print \"set1Rows(\" &amp; lngX &amp; \") - col1: \" &amp; set1Rows(lngX, 0)\n  next lngX\n\n  for lngX = 0 to Ubound(set2Rows)\n    debug.print \"set2Rows(\" &amp; lngX &amp; \") - col1: \" &amp; set2Rows(lngX, 0)\n  next lngX\n\nend if\n\n' now do your comparison\n\nfor lngX = 0 to Ubound(set1Rows)\n  for lngY = 0 to Ubound(set2Rows)\n    if set1Rows(lngX, 0) = set2Rows(lngY, 0) then\n      set1Rows(lngX, 1) = \"1\"\n    end if\n  next lngY\nnext lngX\n\n' now your duplicates are flagged in the set1Rows array\n\nfor lngX = 0 to Ubound(set1Rows)\n  if set1Rows(lngX, 1) = \"1\" then\n    ' code for duplicated\n  else\n    ' code for unique\n  end if\nnext lngX\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 5631818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef65bd1719b5813acbef8f1d6a11ed1?s=128&d=identicon&r=PG&f=1", "display_name": "SteveP65", "link": "https://stackoverflow.com/users/5631818/stevep65"}, "edited": false, "score": 0, "creation_date": 1449602484, "post_id": 34052592, "comment_id": 56075309, "body": "The only reason for the collection is that I am removing additional data after I remove the duplicate from outputVal.  It was easier to use the collection instead of redim a new array.  The only other way I can think of is to create a separate index array of what needs to be removed and then do the redim and copy to the new array all at once.  You have given me some ideas though thank you."}, {"owner": {"reputation": 33, "user_id": 5631818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef65bd1719b5813acbef8f1d6a11ed1?s=128&d=identicon&r=PG&f=1", "display_name": "SteveP65", "link": "https://stackoverflow.com/users/5631818/stevep65"}, "edited": false, "score": 0, "creation_date": 1449687910, "post_id": 34052592, "comment_id": 56120206, "body": "I am still looking into this.  One issue I found is that if a Variant array has a string in it longer than 255 characters the Application.Match fails with a type Mismatch error.  If I change my output array to a string array then I am able to process the entire data range."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 33, "user_id": 5631818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef65bd1719b5813acbef8f1d6a11ed1?s=128&d=identicon&r=PG&f=1", "display_name": "SteveP65", "link": "https://stackoverflow.com/users/5631818/stevep65"}, "edited": false, "score": 0, "creation_date": 1449697002, "post_id": 34052592, "comment_id": 56125223, "body": "@SteveP65 I added another function you may want to try (should be faster, but i can&#39;t tell for sure)... obviosely you will get a range which holds some benefits you may want to use later :)"}, {"owner": {"reputation": 33, "user_id": 5631818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef65bd1719b5813acbef8f1d6a11ed1?s=128&d=identicon&r=PG&f=1", "display_name": "SteveP65", "link": "https://stackoverflow.com/users/5631818/stevep65"}, "edited": false, "score": 0, "creation_date": 1449772298, "post_id": 34052592, "comment_id": 56162668, "body": "I converted everything over to arrays and its much quicker.  I copied the range into an array and using the idea you suggested <code>ReDim Preserve outputVal(i - 1)</code> I was able to get my resultant array without the duplicates.  Since I was comparing two arrays I did not try to use the <code>Intersect(runRng1, runRng2)</code> function. I reiterated through the array to find the duplicates."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 33, "user_id": 5631818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef65bd1719b5813acbef8f1d6a11ed1?s=128&d=identicon&r=PG&f=1", "display_name": "SteveP65", "link": "https://stackoverflow.com/users/5631818/stevep65"}, "edited": false, "score": 0, "creation_date": 1449773154, "post_id": 34052592, "comment_id": 56163086, "body": "@SteveP65 If you are able to improve your own coding, the mission of SO is accomplished. If you run into trouble again, feel free to come back and ask. :)"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 0, "last_activity_date": 1449696867, "last_edit_date": 1449696867, "creation_date": 1449088875, "answer_id": 34052592, "question_id": 34051080, "link": "https://stackoverflow.com/questions/34051080/excel-vba-remove-duplicates-reiteration-vs-filter/34052592#34052592", "title": "Excel VBA Remove Duplicates Reiteration vs Filter", "body": "<p>i don't know why it has to be a collection, but to get an array fast having all values without doubles (of filtered list) you could do it like this: (pretty close to your first example)</p>\n\n<pre><code>Function GetColVal(Ws As Worksheet, Column As Long) As Variant\n  Dim runner As Variant, outputVal() As Variant, i As Long\n  ReDim outputVal(Ws.Range(Ws.Cells(1, Column), Ws.Cells(GetLastRow(Ws), Column)).SpecialCells(xlCellTypeVisible).Count)\n  For Each runner In Ws.Range(Ws.Cells(1, Column), Ws.Cells(GetLastRow(Ws), Column)).SpecialCells(xlCellTypeVisible)\n    If i = 0 Then\n      outputVal(0) = runner.Value: i = 1\n    Else\n      If IsError(Application.Match(runner.Value, outputVal, 0)) Then outputVal(i) = runner.Value: i = i + 1\n    End If\n  Next\n  ReDim Preserve outputVal(i - 1)\n  GetColVal= outputVal\nEnd Function\n</code></pre>\n\n<p>the <code>Application.Match</code> is one of the fastest functions in VBA while <code>IsInCollection</code> can be extremely slow... better run a <code>For Each ...</code> loop to add everything in a collection than checking the collection...</p>\n\n<pre><code>Dim a As Variant\nFor Each a in GetColVal(Worksheets(\"SheetX\"),7)\n  MyCollection.Add a\nNext\n</code></pre>\n\n<p>should be much faster than your examples... still i recommend not using collections particularly if you just use values... better use the <code>GetColVal</code>-array directly if possible...<br>\n<code>variantVariable = GetColVal(Worksheets(\"SheetX\"),7)</code> then use the variant-variable for whatever you want to do (you also could paste it directly somewhere in a sheet)</p>\n\n<p>a simple output into a worksheet would be like that:</p>\n\n<pre><code>Dim a As Variant\na = GetColVal(Worksheets(\"Sheet1\"),13) 'values from sheet1 column M\n'pasting in one row (starting at A1 in Sheet2)\nThisWorkbook.Sheets(\"Sheet2\").Range(Cells(1, 1), Cells(1, ubound(a) + 1)).value = a\n'pasting in one column (starting at C5 in Sheet4)\nThisWorkbook.Sheets(\"Sheet4\").Range(Cells(5, 3), Cells(ubound(a) + 5, 3)).value = Application.Transpose(a)\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>To show something different:</p>\n\n<pre><code>Function GetColumnValues(ws As Worksheet, Column As Long) As Range\n  With ws\n    Dim srcRng As Range, outRng As Range, runRng1 As Range, runRng2 As Range, dBool As Boolean\n    Set srcRng = .Range(.Cells(1, Column), .Cells(GetLastRow(ws), Column)).SpecialCells(xlCellTypeVisible)\n    For Each runRng1 In a\n      If outRng Is Nothing Then Set outRng = runRng1\n      For Each runRng2 In outRng\n        If Intersect(runRng1, runRng2) Is Nothing Then\n          If runRng2.Value = runRng1.Value Then dBool = True: Exit For\n        End If\n      Next\n      If dBool Then dBool = False Else Set outRng = Union(outRng, runRng1)\n    Next\n  End With\n  Set GetColumnValues = outRng\nEnd Function\n</code></pre>\n\n<p>With this function you will get a range of all the cells which can be selected or copied to another location (with formating and everything else). Still you can add all elements into a collection with a <code>For Each ...</code>. I also not used <code>Match</code> to avoid the \"Len > 255\"-error</p>\n"}], "owner": {"reputation": 33, "user_id": 5631818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef65bd1719b5813acbef8f1d6a11ed1?s=128&d=identicon&r=PG&f=1", "display_name": "SteveP65", "link": "https://stackoverflow.com/users/5631818/stevep65"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 1, "accepted_answer_id": 34052592, "answer_count": 2, "score": 3, "last_activity_date": 1449696867, "creation_date": 1449083706, "question_id": 34051080, "link": "https://stackoverflow.com/questions/34051080/excel-vba-remove-duplicates-reiteration-vs-filter", "title": "Excel VBA Remove Duplicates Reiteration vs Filter", "body": "<p>I have a worksheet that contains ~8000 rows which have already been filtered.  I am trying to get a collection of values from a worksheet column with the duplicates removed.  Reading through the post here there are two ways to do this.  Loop through the collection and copy to a new collection if the value does not already exist in the new collection.<br>\nOr copy the data in the column to a temporary spreadsheet, filter and copy the the data to another column and then add it to the collection.</p>\n\n<p>When dealing with a large amount of data the copy filter has the best performance but is clunky since a new worksheet has to be created.</p>\n\n<p>I have not seen it but is there a way to do the copy filter in memory instead of creating a worksheet to do this?</p>\n\n<p><strong>Reiteration:</strong></p>\n\n<pre><code>Sub GetColumnValues(Ws As Worksheet, Column As Long, CollValues As Collection)\n\nDim RowIndex As Long\n\n    For RowIndex = 1 To GetLastRow(Ws)\n        If CollValues.Count = 0 Then\n            CollValues.Add (Ws.Cells(RowIndex, Column).Value)\n        Else\n            If IsInCollection(CollValues, Ws.Cells(RowIndex, Column).Value) = False Then\n                CollValues.Add (Ws.Cells(RowIndex, Column).Value)\n            End If\n        End If\n    Next RowIndex\n\nEnd Sub\n</code></pre>\n\n<p><strong>Filter and Copy:</strong></p>\n\n<pre><code>Sub GetColumnValues(Ws As Worksheet, Column As Long, CollValues As Collection)\n\nDim rowLast As Long\nDim c As Range\nDim tmpWS As Worksheet\nDim tmpWsName As String\n\n    tmpWsName = \"TempWS\"\n\n    Call DeleteWs(TsWb, tmpWsName)\n\n    Set tmpWS = TsWb.Sheets.Add()\n    tmpWS.Name = tmpWsName\n\n    rowLast = GetLastRow(Ws)\n\n    Ws.Range(Ws.Cells(1, Column), Ws.Cells(rowLast, Column)).Copy\n    tmpWS.Range(\"A1\").PasteSpecial\n\n    rowLast = GetLastRow(tmpWS)\n    tmpWS.Range(tmpWS.Cells(1, 1), tmpWS.Cells(rowLast, 1)).AdvancedFilter _\n        Action:=xlFilterCopy, _\n        CopyToRange:=tmpWS.Range(\"B1\"), _\n        Unique:=True\n\n    rowLast = GetLastRow(tmpWS)\n\n    For Each c In tmpWS.Range(tmpWS.Cells(1, 2), tmpWS.Cells(rowLast, 2))\n        If Len(c.value) &gt; 0 Then\n            CollValues.Add (c.value)\n        End If\n    Next c\n\n    Call DeleteWs(TsWb, tmpWsName)\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1449122206, "post_id": 34050549, "comment_id": 55871414, "body": "Try <code>excel.Application.Run(wbA.name + &#39;!update_links()&#39;);</code>  You don&#39;t include the workbook path - just the name."}, {"owner": {"reputation": 43, "user_id": 4525451, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8379e60803cac187e1b31bf80610647?s=128&d=identicon&r=PG", "display_name": "Doug Clarke", "link": "https://stackoverflow.com/users/4525451/doug-clarke"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1449158687, "post_id": 34050549, "comment_id": 55894393, "body": "I tried that, I got the same error only this time without the path."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1449161337, "post_id": 34050549, "comment_id": 55896421, "body": "Are you able to run the macro using VBA and the same parameters ?  You should be able to enter <code>Application.Run(&quot;&#39;namehere.xlsm&#39;!update_links&quot;)</code> in the Immediate pane and hit enter - that should run the macro and will tell you if it&#39;s a macro permissions problem.  Note also you don&#39;t include the parentheses on the end of the call."}, {"owner": {"reputation": 43, "user_id": 4525451, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8379e60803cac187e1b31bf80610647?s=128&d=identicon&r=PG", "display_name": "Doug Clarke", "link": "https://stackoverflow.com/users/4525451/doug-clarke"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1449171087, "post_id": 34050549, "comment_id": 55902336, "body": "Thanks Tim! I got it to work in both js and VBA using your notation.  I was missing some quotation marks. I&#39;m not entirely sure how it is running without the user enabling macros, but I&#39;m not going to lose any sleep over it. Thanks again!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1449172392, "post_id": 34050549, "comment_id": 55903114, "body": "I&#39;m pretty sure regular macro security doesn&#39;t affect what you can do when you&#39;re automating Excel: you already have full control over the application and it&#39;s assumed you trust whatever code you run using automation.  See (eg) <a href=\"https://technet.microsoft.com/en-us/library/ee857085.aspx#changeauto\" rel=\"nofollow noreferrer\">technet.microsoft.com/en-us/library/ee857085.aspx#changeauto</a> &quot;By default, when a separate program is used to programmatically start Excel 2013, PowerPoint 2013, or Word 2013, any macros can run in the application that was programmatically started&quot;"}], "owner": {"reputation": 43, "user_id": 4525451, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8379e60803cac187e1b31bf80610647?s=128&d=identicon&r=PG", "display_name": "Doug Clarke", "link": "https://stackoverflow.com/users/4525451/doug-clarke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1006, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1449081817, "creation_date": 1449081817, "question_id": 34050549, "link": "https://stackoverflow.com/questions/34050549/run-excel-vba-sub-from-javascript-in-a-secure-environment", "title": "Run Excel VBA sub from javascript in a secure environment", "body": "<p>I am attempting to do some automation of excel taks using javascipt.  These workbooks already have VBA modules, so I will need to be able to run them from javascript.  My challenge is that when I open a workbook using Javascript I do not get prompted to enable macros.  I am not able to change my trust center settings in my work environment and they are currently set to \"Disable all macros with notification,\" which asks the user to enable macros via a pop-up box if the file is opened manually. </p>\n\n<p>How do I allow the user to enable macros when opening a workbook from javascript?  </p>\n\n<p>Error message and code below:</p>\n\n<blockquote>\n  <p>SCRIPT1004: Cannot run the macro 'C:\\Users...\\JPO Mdl\n  v07.04.022-FY16MM.01.01_A.xlsm!update_links()'. The macro may not be\n  available in this workbook or all macros may be disabled.</p>\n</blockquote>\n\n<pre><code>function open_files(A, B, C) \n{ \n var excel = new ActiveXObject(\"Excel.Application\");\n excel.Visible=true;\n excel.DisplayAlerts = true;\n var wbA = excel.Workbooks.Open(document.getElementById(A).value);\n var wbB = excel.Workbooks.Open(document.getElementById(B).value);\n var wbC = excel.Workbooks.Open(document.getElementById(C).value);\n\n excel.EnableEvents = false\n excel.ScreenUpdating = false\n excel.Calculation = -4135 //xlCalculationManual enumeration\n\n var wb_collection = [wbA, wbB, wbC];\n excel.Application.Run(wbA.fullname + '!update_links()');\n}\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "worksheet-function", "vba"], "comments": [{"owner": {"reputation": 5957, "user_id": 997196, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/E5hdR.png?s=128&g=1", "display_name": "Rivasa", "link": "https://stackoverflow.com/users/997196/rivasa"}, "edited": false, "score": 0, "creation_date": 1449081885, "post_id": 34050467, "comment_id": 55855571, "body": "Is the data for each type separated or is it all mixed in?"}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1449082548, "post_id": 34050467, "comment_id": 55855919, "body": "Can you tell us the range of storey and area? - e.g. if storey goes from 1 to 50 and area goes from 1 to 1000 you can&#39;t tell them apart"}, {"owner": {"reputation": 3601, "user_id": 4786305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dWJCM.png?s=128&g=1", "display_name": "Erba Aitbayev", "link": "https://stackoverflow.com/users/4786305/erba-aitbayev"}, "edited": false, "score": 0, "creation_date": 1449082626, "post_id": 34050467, "comment_id": 55855962, "body": "Data for each type is separated by &#39;:&#39; and ordered according to types."}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1449088380, "post_id": 34050467, "comment_id": 55859129, "body": "Sorry, completely misunderstood the question. My last comment should be down-voted."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3601, "user_id": 4786305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dWJCM.png?s=128&g=1", "display_name": "Erba Aitbayev", "link": "https://stackoverflow.com/users/4786305/erba-aitbayev"}, "edited": false, "score": 1, "creation_date": 1449085651, "post_id": 34050750, "comment_id": 55857687, "body": "@AndreyRadik Glad I could help."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1449083351, "last_edit_date": 1449083351, "creation_date": 1449082545, "answer_id": 34050750, "question_id": 34050467, "link": "https://stackoverflow.com/questions/34050467/how-to-distribute-data-of-typevalue-format-by-categories-in-excel/34050750#34050750", "title": "How to distribute data of &quot;type:value&quot; format by categories in Excel?", "body": "<p>This should do what you want:</p>\n\n<pre><code>Sub Andrey()\nDim catArr() As String\nDim resArr() As String\nDim lastrow As Long\nDim ows As Worksheet\nDim tws As Worksheet\nDim i As Long\nDim j As Long\nDim startrow As Long\n\nSet ows = Sheets(\"Sheet9\") ' change to where your data is\nSet tws = Sheets(\"Sheet10\") ' change to where you want your data\n\nstartrow = 3 ' Change to the first row with data\n\nWith ows\n    lastrow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    For i = startrow To lastrow\n        tws.Cells(i, 1) = .Cells(i, 1)\n        tws.Range(tws.Cells(i, \"B\"), tws.Cells(i, \"G\")).Value = \"NULL\"\n        tws.Range(tws.Cells(i, \"B\"), tws.Cells(i, \"G\")).Font.Italic = True\n        tws.Range(tws.Cells(i, \"B\"), tws.Cells(i, \"G\")).Font.Bold = False\n        tws.Range(tws.Cells(i, \"A\"), tws.Cells(i, \"G\")).HorizontalAlignment = xlCenter\n        catArr = Split(.Cells(i, 2), \":\")\n        resArr = Split(.Cells(i, 3), \":\")\n        For j = LBound(catArr) To UBound(catArr)\n            tws.Cells(i, WorksheetFunction.Match(catArr(j), tws.Range(\"A1:G1\"), 0)) = resArr(j)\n            tws.Cells(i, WorksheetFunction.Match(catArr(j), tws.Range(\"A1:G1\"), 0)).Font.Bold = True\n            tws.Cells(i, WorksheetFunction.Match(catArr(j), tws.Range(\"A1:G1\"), 0)).Font.Italic = False\n        Next j\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>A couple of caveats.</p>\n\n<p>1) You need to put the data types as titles in the first row of the sheet into which the split data will be placed.</p>\n\n<p>2) I used the rows and columns from your example.  If different then you will need to adjust the cells references.</p>\n\n<p>Edit:  I changed the above to add the \"NULL\" and format the cells with bold and italics to match better what you want.</p>\n"}], "owner": {"reputation": 3601, "user_id": 4786305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dWJCM.png?s=128&g=1", "display_name": "Erba Aitbayev", "link": "https://stackoverflow.com/users/4786305/erba-aitbayev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 34050750, "answer_count": 1, "score": 3, "last_activity_date": 1475732929, "creation_date": 1449081503, "last_edit_date": 1531161705, "question_id": 34050467, "link": "https://stackoverflow.com/questions/34050467/how-to-distribute-data-of-typevalue-format-by-categories-in-excel", "title": "How to distribute data of &quot;type:value&quot; format by categories in Excel?", "body": "<p>I am on my way to do linear regression analysis of data parsed from a site.\nI was able to get data in the following inconvenient format only:</p>\n\n<p>Data in 1-st column contains data types separated by ':' symbol. For example:</p>\n\n<pre><code>Year:Storey:Area:Condition:Type:Name\n</code></pre>\n\n<p>Data in 2-nd column contains information corresponding to data types in 1st column also separated by ':' symbol:</p>\n\n<pre><code>2015:3:170:Renovated:TypeB:John\n</code></pre>\n\n<hr>\n\n<p>In my Excel table I have <strong>13000</strong> rows with such data in above mentioned format.\nI want to categorize this data by categories specified for the data.<br><br>\nTo clarify, I provide picture of original data fromat:\n<a href=\"https://i.stack.imgur.com/tvSt6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tvSt6.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I try to convert this data to the following format:\n<a href=\"https://i.stack.imgur.com/XmTLc.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XmTLc.jpg\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>I tried to split this data into columns by using delimiters, but the problem is that number of data types varies. 1 row may have 5 categories. Another row may have only 2 categories (data types). </p>\n\n<p>Is it possible to categorize that kind of data in Excel? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "edited": false, "score": 0, "creation_date": 1449081891, "post_id": 34050387, "comment_id": 55855575, "body": "There is with VBA. Do a loop through all your figures, and check with the <code>mod</code>operator whether its even or uneven."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1449082209, "creation_date": 1449082209, "answer_id": 34050659, "question_id": 34050387, "link": "https://stackoverflow.com/questions/34050387/excel-filter-unique-values-from-column-a-and-move-related-values-from-column-b/34050659#34050659", "title": "Excel - Filter unique values from Column A and move related values from Column B to other columns", "body": "<p>Here's a way to do it with formulas. It takes a small bit of formatting first though, so perhaps copy your data to a new sheet, then tweak.</p>\n\n<p>First, get the unique values from Column A.  In your example, these would be <code>A</code> and <code>B</code>.  (For long lists, copy column A to some random column.  Select that column, go to Data--> Remove Duplicates. This will give you your unique list).</p>\n\n<p>After you have the list, place it in Column D (for example).  Then, enter this formula as an array in column E (enter with <kbd>CTRL+SHIFT+ENTER</kbd>):</p>\n\n<pre><code>=IFERROR(INDEX($B$1:$B$6,SMALL(IF($A$1:$A$6=$D1,ROW($A$1:$A$6)-ROW($A$1)+1),ROWS(INDIRECT(\"$A$1:A\"&amp;COLUMN()-4)))),\"\")\n</code></pre>\n\n<p>A couple notes: Adjust the range from rows 1 to 6 as necessary.  Also, if you choose a column other than column E to put this in, adjust the <code>Column()-4</code> part at the end so that the column number minus the other number (in my example, <code>4</code>) equals 1.  (In my formula the <code>Column()</code> returns 5 (for \"E\") and 5-4=1.</p>\n\n<p>You can then drag over, and down, and it should work.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/4n93t.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4n93t.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 611, "user_id": 2950272, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0dba5f06b796da3d29d709cbdf4e3020?s=128&d=identicon&r=PG&f=1", "display_name": "RandomWanderer", "link": "https://stackoverflow.com/users/2950272/randomwanderer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 34050659, "answer_count": 1, "score": 1, "last_activity_date": 1449082209, "creation_date": 1449081208, "last_edit_date": 1531161705, "question_id": 34050387, "link": "https://stackoverflow.com/questions/34050387/excel-filter-unique-values-from-column-a-and-move-related-values-from-column-b", "title": "Excel - Filter unique values from Column A and move related values from Column B to other columns", "body": "<p>I have a excel like this</p>\n\n<pre><code>Col1 - Col2\nA - 1\nB - 2\nA - 3\nB - 4\nA - 5\n</code></pre>\n\n<p>I want to produce an excel from above one as shown below</p>\n\n<pre><code>Col1 - Col2 - Col3 - Col4\nA - 1 - 3 - 5\nB - 2 - 4\n</code></pre>\n\n<p>Is there a way in excel to do this?</p>\n\n<p>Please help</p>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 12216, "user_id": 2480047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d9d32532677b536217a7df8b35f106?s=128&d=identicon&r=PG", "display_name": "varocarbas", "link": "https://stackoverflow.com/users/2480047/varocarbas"}, "edited": false, "score": 0, "creation_date": 1449079726, "post_id": 34049861, "comment_id": 55854355, "body": "VB.NET has nothing to do with VBA/Office macros."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 4217282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42de4b13b9ec5dd646a297a9038bf3b1?s=128&d=identicon&r=PG&f=1", "display_name": "Dino Padilla", "link": "https://stackoverflow.com/users/4217282/dino-padilla"}, "edited": false, "score": 0, "creation_date": 1449082707, "post_id": 34050297, "comment_id": 55856017, "body": "When I try to run my code nothing happens and no errors are given. I added your function above my code and still nothing happens when it is run."}, {"owner": {"reputation": 7889, "user_id": 1911064, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/F8Vxe.jpg?s=128&g=1", "display_name": "Axel Kemper", "link": "https://stackoverflow.com/users/1911064/axel-kemper"}, "reply_to_user": {"reputation": 181, "user_id": 4217282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42de4b13b9ec5dd646a297a9038bf3b1?s=128&d=identicon&r=PG&f=1", "display_name": "Dino Padilla", "link": "https://stackoverflow.com/users/4217282/dino-padilla"}, "edited": false, "score": 0, "creation_date": 1449093627, "post_id": 34050297, "comment_id": 55861995, "body": "Marc a line of your code to start the VBA debugger, once the VBA line gets executed. Probably the only way to find out what is going on."}], "tags": [], "owner": {"reputation": 7889, "user_id": 1911064, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/F8Vxe.jpg?s=128&g=1", "display_name": "Axel Kemper", "link": "https://stackoverflow.com/users/1911064/axel-kemper"}, "is_accepted": false, "score": 0, "last_activity_date": 1449080888, "creation_date": 1449080888, "answer_id": 34050297, "question_id": 34049861, "link": "https://stackoverflow.com/questions/34049861/send-from-another-email-address-in-outlook/34050297#34050297", "title": "Send from another email address in Outlook", "body": "<p>What does not work in your code?</p>\n\n<p>Use the <code>smtpAddress</code> property to select an account.</p>\n\n<p>Example function:</p>\n\n<pre><code>Private Function GetAccountForEmailAddress(smtpAddress As String) As Outlook.account\n    Dim account As Outlook.account\n\n    For Each account In Application.Session.accounts\n        If LCase(account.smtpAddress) = LCase(smtpAddress) Then\n            Set GetAccountForEmailAddress = account\n            Exit Function\n        End If\n    Next account\n\n    MsgBox \"No Account with SmtpAddress: \" &amp; smtpAddress &amp; \" exists!\", vbCritical, \"Oops!\"\n\n    Set GetAccountForEmailAddress = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1449095324, "creation_date": 1449095324, "answer_id": 34054346, "question_id": 34049861, "link": "https://stackoverflow.com/questions/34049861/send-from-another-email-address-in-outlook/34054346#34054346", "title": "Send from another email address in Outlook", "body": "<p>The debug.print line will show you the accounts.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub New_Mail()\n\nDim oAccount As account\nDim oMail As mailItem\n\nFor Each oAccount In Session.Accounts\n    Debug.Print oAccount\n    If LCase(oAccount) = LCase(\"text copied from the immediate window\") Then\n        Set oMail = CreateItem(olMailItem)\n        oMail.SendUsingAccount = oAccount\n        oMail.Display\n    End If\n    Next\n\nExitRoutine:\n    Set oMail = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1449095578, "creation_date": 1449095578, "answer_id": 34054408, "question_id": 34049861, "link": "https://stackoverflow.com/questions/34049861/send-from-another-email-address-in-outlook/34054408#34054408", "title": "Send from another email address in Outlook", "body": "<p>A delegate mailbox will not be in the Namespace.Accounts list.</p>\n\n<p>Set the <code>MailItem.SentOnBehalfOfName</code> property instead.</p>\n"}, {"tags": [], "owner": {"reputation": 181, "user_id": 4217282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42de4b13b9ec5dd646a297a9038bf3b1?s=128&d=identicon&r=PG&f=1", "display_name": "Dino Padilla", "link": "https://stackoverflow.com/users/4217282/dino-padilla"}, "is_accepted": false, "score": 2, "last_activity_date": 1449098404, "creation_date": 1449098404, "answer_id": 34055005, "question_id": 34049861, "link": "https://stackoverflow.com/questions/34049861/send-from-another-email-address-in-outlook/34055005#34055005", "title": "Send from another email address in Outlook", "body": "<p>Using the following code with the SentOnBehalfOfName property starts a new email from the shared mailbox's address. Thanks to Dmitry Streblechenko for pointing me in the right direction.</p>\n\n<pre><code>Sub New_Mail()\nDim objMsg As MailItem\nSet objMsg = Application.CreateItem(olMailItem)\n\n\n With objMsg\n  .SentOnBehalfOfName = \"sharedMailboxAddress@domain.tld\"\n  .Display\nEnd With\n\nSet objMsg = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 4217282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42de4b13b9ec5dd646a297a9038bf3b1?s=128&d=identicon&r=PG&f=1", "display_name": "Dino Padilla", "link": "https://stackoverflow.com/users/4217282/dino-padilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12196, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1449098404, "creation_date": 1449079505, "last_edit_date": 1449093508, "question_id": 34049861, "link": "https://stackoverflow.com/questions/34049861/send-from-another-email-address-in-outlook", "title": "Send from another email address in Outlook", "body": "<p>My users have their personal mailbox as their primary account and an auto-mapped shared mailbox configured in their Outlook 2010 client. The shared mailbox is an Office 365 shared mailbox and thus cannot be logged into to set it as the primary account. </p>\n\n<p>I am trying to start a new email from the shared account's address.</p>\n\n<p>Below is the VBA code I have been trying to use. I have allowed Macros in Outlook's trust center settings.</p>\n\n<pre><code>Public Sub New_Mail()\nDim oAccount As Outlook.Account\nDim oMail As Outlook.MailItem\nFor Each oAccount In Application.Session.Accounts\n    If oAccount = \"sharedMailboxAddress@domain.tld\" Then\n        Set oMail = Application.CreateItem(olMailItem)\n        oMail.SendUsingAccount = oAccount\n        oMail.Display\n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1449077407, "post_id": 34049173, "comment_id": 55852991, "body": "Try setting your books and sheets?"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1449077936, "post_id": 34049173, "comment_id": 55853297, "body": "Default references... default references everywhere..."}, {"owner": {"reputation": 11, "user_id": 4892783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfb712a09d196eae6cfa34b2c19eb49f?s=128&d=identicon&r=PG&f=1", "display_name": "AHern", "link": "https://stackoverflow.com/users/4892783/ahern"}, "edited": false, "score": 0, "creation_date": 1449078994, "post_id": 34049173, "comment_id": 55853902, "body": "Yes that is the trouble I am having. Setting the books and sheets"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449085182, "post_id": 34049173, "comment_id": 55857454, "body": "Check <a href=\"http://stackoverflow.com/questions/26039872/declaring-variable-workbook-worksheet-vba\">here</a>"}, {"owner": {"reputation": 11, "user_id": 4892783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfb712a09d196eae6cfa34b2c19eb49f?s=128&d=identicon&r=PG&f=1", "display_name": "AHern", "link": "https://stackoverflow.com/users/4892783/ahern"}, "edited": false, "score": 0, "creation_date": 1449097786, "post_id": 34049173, "comment_id": 55863914, "body": "I guess I am stuck in the sense of how to address it based on the code I already have. Where to put the addressing of the worksheets."}, {"owner": {"reputation": 11, "user_id": 4892783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfb712a09d196eae6cfa34b2c19eb49f?s=128&d=identicon&r=PG&f=1", "display_name": "AHern", "link": "https://stackoverflow.com/users/4892783/ahern"}, "edited": false, "score": 0, "creation_date": 1449181600, "post_id": 34049173, "comment_id": 55908321, "body": "Hi all, the code has been edited. The editing of the variables worked great! However, I am having trouble with the code above. Which copies from the 2nd sheet and to go to the 2ndsheet in the master workbook"}], "owner": {"reputation": 11, "user_id": 4892783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfb712a09d196eae6cfa34b2c19eb49f?s=128&d=identicon&r=PG&f=1", "display_name": "AHern", "link": "https://stackoverflow.com/users/4892783/ahern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 303, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1449250430, "creation_date": 1449077299, "last_edit_date": 1531164843, "question_id": 34049173, "link": "https://stackoverflow.com/questions/34049173/excel-vba-to-copy-and-paste-to-worksheets-to-master-workbook-in-separate-workshe", "title": "Excel vba to copy and paste to worksheets to master workbook in separate worksheets", "body": "<p>I have used the following code successfully for the past few months. I now need to have 2 worksheets upload to the two separate sheets in the Master Workbook.</p>\n\n<p>The breakdown of the sheet names would be the following:<br>\nSheet: \u201cReferrals\u201d GOING TO Master Sheet: \u201cReferrals Report\u201d<br>\nSheet: \u201cNew Accounts\u201d GOING TO Master Sheet: \u201cNew Accounts Report\u201d</p>\n\n<p>Below is the code to send data from one worksheet to another but macros in the same workbook to send to their appropriate sheet in the Master Workbook. I'm hoping to use the same code but just need help telling it the sheets. Any help is appreciated.  </p>\n\n<pre><code>Sub ExportNewAccounts()\n\nDim wbl As Workbook\nDim wbm As Workbook\nDim wsl As Worksheet\nDim wsm As Worksheet\nSet wbl = ThisWorkbook\nSet wbm = Workbooks.Open(\"\\\\PROFILER\\2016 Global Tracker.xlsx\")\nSet wsl = wbl.Sheets(\"New Accounts\")\nSet wsm = wbm.Sheets(\"New Accounts Report\")\n\nIf MsgBox(\"Are you sure you want to export all data entered?\", vbYesNo + vbInformation) = vbNo Then Exit Sub\nApplication.ScreenUpdating = False\n\nWith wsl.Range(\"A4\")\n    Range(.Cells(1, 1), .End(xlDown).EntireRow).Copy\nEnd With ****HERE***\nwsm.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n:=False, Transpose:=False\nApplication.CutCopyMode = False\nRange(\"A1\").Select\nwbm.Save\nwbm.Close\nApplication.ScreenUpdating = True\nMsgBox (\"Thanks, your data has been successfully exported.\")\n\nEnd Sub\n\nFunction IsFileOpen(filename As String)\nDim filenum As Integer, errnum As Integer\nOn Error Resume Next\nfilenum = FreeFile()\nOpen filename For Input Lock Read As #filenum\nClose filenum\nerrnum = Err\nOn Error GoTo 0\nSelect Case errnum\nCase 0\nIsFileOpen = False\nCase 70\nIsFileOpen = True\nCase Else\nError errnum\nEnd Select\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1449077151, "post_id": 34049088, "comment_id": 55852830, "body": "Try <code>elseif</code> instead?"}, {"owner": {"reputation": 173, "user_id": 4639124, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EXQEo.jpg?s=128&g=1", "display_name": "UnbrokenChain", "link": "https://stackoverflow.com/users/4639124/unbrokenchain"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449077500, "post_id": 34049088, "comment_id": 55853041, "body": "do you know where exactly? running into issues if i replace the first if by elseif or the second one."}, {"owner": {"reputation": 173, "user_id": 4639124, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EXQEo.jpg?s=128&g=1", "display_name": "UnbrokenChain", "link": "https://stackoverflow.com/users/4639124/unbrokenchain"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449077619, "post_id": 34049088, "comment_id": 55853117, "body": "ah got it! I added it to the second if after looking up the elseif syntax. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 4639124, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EXQEo.jpg?s=128&g=1", "display_name": "UnbrokenChain", "link": "https://stackoverflow.com/users/4639124/unbrokenchain"}, "edited": false, "score": 0, "creation_date": 1449077766, "post_id": 34049267, "comment_id": 55853206, "body": "Thanks, the solution I posted above seems to work as well using elseif rather than two independent if statements. rpt date should be added once a date in format mm/dd/yyyy is entered by the user."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 3, "last_activity_date": 1449079787, "last_edit_date": 1449079787, "creation_date": 1449077588, "answer_id": 34049267, "question_id": 34049088, "link": "https://stackoverflow.com/questions/34049088/how-to-restrict-input-box-input-to-date-only/34049267#34049267", "title": "How to restrict Input box input to date only", "body": "<p>Your If statements are a little off for this. Here's a code that will remove the use of <code>GoTo</code> (which is best practice), and still loop correctly until you get the format you want.</p>\n\n<pre><code>Sub tt()\nDim ws1     As Worksheet\nSet ws1 = Sheets(\"Report Generation\")\n\nWith ws1\n    Dim rptdate As Variant\n    rptdate = InputBox(\"Please Enter the Report Date *Must be EOM format mm/dd/yyyy*\", \"Enter Date\")\n\n    Do While rptdate = \"\" Or Not IsDate(rptdate)\n        MsgBox (\"You did not enter a date in the correct format!\"), vbCritical, Error\n        rptdate = InputBox(\"Please Enter the Report Date *Must be EOM format mm/dd/yyyy*\", \"Enter Date\")\n    Loop\n\n    .Range(\"B8\").Value = rptdate\nEnd With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1449077853, "post_id": 34049288, "comment_id": 55853251, "body": "See my edit in my post for a solution that avoids <code>GoTo</code> (which is best practice for VB). It also cuts the length down a bit."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1449079770, "post_id": 34049288, "comment_id": 55854376, "body": "Using <code>GoTo</code> should be reserved for very few cases (<code>On Error GoTo ErrHandler</code> being one), in VBA and most programming languages from what I&#39;ve seen.  If you have many macros using <code>GoTo</code>, it&#39;s really, really worth reading up on how to avoid them with <code>If&#47;Then</code>, <code>Do While</code>, or <code>Do Until</code>, etc. loops.  (I also realize I forgot to add the <code>Range&quot;B8&quot;).Value = rptdate</code> in my edit, but I have added that in to the end)."}], "tags": [], "owner": {"reputation": 173, "user_id": 4639124, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EXQEo.jpg?s=128&g=1", "display_name": "UnbrokenChain", "link": "https://stackoverflow.com/users/4639124/unbrokenchain"}, "is_accepted": false, "score": 0, "last_activity_date": 1449077683, "creation_date": 1449077683, "answer_id": 34049288, "question_id": 34049088, "link": "https://stackoverflow.com/questions/34049088/how-to-restrict-input-box-input-to-date-only/34049288#34049288", "title": "How to restrict Input box input to date only", "body": "<p>The below accurately does what I wanted. Thanks findwindow.</p>\n\n<pre><code>'Updates the report date located in report generation tab cell B8\nDim ws1 As Worksheet\nSet ws1 = Sheets(\"Report Generation\")\nReTry:\nWith ws1\nDim rptdate As Variant\n    rptdate = InputBox(\"Please Enter the Report Date *Must be EOM format mm/dd/yyyy*\", \"Enter Date\")\n    If rptdate = \"\" Then\n    MsgBox (\"You did not enter a date!\"), vbCritical, Error\n    GoTo ReTry\n    ElseIf Not IsDate(rptdate) Then\n    MsgBox (\"You did not enter the correct format!\"), vbCritical, Error\n    GoTo ReTry\n    Else\n    Range(\"B8\").Value = rptdate\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 4639124, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EXQEo.jpg?s=128&g=1", "display_name": "UnbrokenChain", "link": "https://stackoverflow.com/users/4639124/unbrokenchain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3466, "favorite_count": 0, "accepted_answer_id": 34049267, "answer_count": 2, "score": 0, "last_activity_date": 1449079787, "creation_date": 1449077063, "question_id": 34049088, "link": "https://stackoverflow.com/questions/34049088/how-to-restrict-input-box-input-to-date-only", "title": "How to restrict Input box input to date only", "body": "<p>I would like to implement a control in the code below to only allow dates with mm/dd/yyyy format and to prevent blanks from being entered in the input box. I've tried adding some code but keep running into errors. The first control to check if it's blank works, but the second if Not seems to just be skipped.</p>\n\n<pre><code>'Updates the report date located in report generation tab cell B8\nDim ws1 As Worksheet\nSet ws1 = Sheets(\"Report Generation\")\nReTry:\nWith ws1\n    Dim rptdate As Variant\n        rptdate = InputBox(\"Please Enter the Report Date *Must be EOM format mm/dd/yyyy*\", \"Enter Date\")\n        If rptdate = \"\" Then\n        MsgBox (\"You did not enter a date!\"), vbCritical, Error\n        GoTo ReTry\n        If Not IsDate(rptdate) Then\n        MsgBox (\"You did not enter the correct format!\"), vbCritical, Error\n        GoTo ReTry\n        End If\n        Else\n        Range(\"B8\").Value = rptdate\n        End If\nEnd With\n</code></pre>\n"}, {"tags": ["php", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 135, "user_id": 1232754, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/z9llv.jpg?s=128&g=1", "display_name": "jazcam", "link": "https://stackoverflow.com/users/1232754/jazcam"}, "is_accepted": true, "score": 0, "last_activity_date": 1449155580, "creation_date": 1449155580, "answer_id": 34069469, "question_id": 34049005, "link": "https://stackoverflow.com/questions/34049005/what-object-is-omessage-in-hmailserver-email-piping/34069469#34069469", "title": "What object is &quot;oMessage&quot; in hMailServer email piping?", "body": "<p>Did get a reply from hMailServer: \"it is the filename that hmailserver creates when receiving a message (the physical .EML file) which is then streamed to clients when clients request it.\"</p>\n\n<p>So, the argument \"oMessage\" is passed from hMailServer, but it is not needed in this VBA adaptation.  </p>\n\n<p>The solution is simply to save the email to a text file in the body of the procedure, \"CurrentItem.SaveAs g_FileName, olTXT\", where g_FileName is declared as a constant.</p>\n\n<p>With that, the email has been piped to a text file, where it can be parsed in your language of choice.  In my case, PHP where values such as \"name\", \"store number\", \"phone number\", etc are retrieved and saved into a MySQL database.</p>\n\n<p>Finally, the rule applied in Outlook is that when the email is received, it is moved to a folder, and the OnDeliverMessage() script is called.</p>\n\n<p>The revised code then is:</p>\n\n<pre><code>Const g_sPHPPath = \"C:\\xampp\\php\\php.exe\"\nConst g_sScriptPath = \"C:\\xampp\\htdocs\\Recycler\\handler.php\"\nConst g_sPipeAddress = \"someone@mail.net\"\nConst g_FileName = \"C:\\tmp\\output.txt\"\nConst g_sDQ = \"\"\"\"\n\nSub OnDeliverMessage()\nDim Explorer As Outlook.Explorer\nDim CurrentItem As Object\n\nSet Explorer = Application.ActiveExplorer\nIf Explorer.Selection.Count Then\n    Set CurrentItem = Explorer.Selection(1)\nEnd If\n\nCurrentItem.SaveAs g_FileName, olTXT\n\nIf CurrentItem.Class = olMail Then\n    Dim sender\n    sender = CurrentItem.SenderEmailAddress\nEnd If\n\nIf g_sPipeAddress = \"\" Then\n    bPipeMessage = True\nElse\n    If LCase(sender) = LCase(g_sPipeAddress) Then\n        bPipeMessage = True\n    End If\nEnd If\n\nIf bPipeMessage Then\n    sCommandLine = \"cmd /c type \" &amp; g_sDQ &amp; g_FileName &amp; g_sDQ &amp; \" | \" &amp; g_sDQ &amp; g_sPHPPath &amp; g_sDQ &amp; \" \" &amp; g_sDQ &amp; g_sScriptPath &amp; g_sDQ\n    Set oShell = CreateObject(\"WScript.Shell\")\n    Call oShell.Run(sCommandLine, 0, True)\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 1232754, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/z9llv.jpg?s=128&g=1", "display_name": "jazcam", "link": "https://stackoverflow.com/users/1232754/jazcam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 636, "favorite_count": 0, "accepted_answer_id": 34069469, "answer_count": 1, "score": 0, "last_activity_date": 1593518352, "creation_date": 1449076818, "last_edit_date": 1593518352, "question_id": 34049005, "link": "https://stackoverflow.com/questions/34049005/what-object-is-omessage-in-hmailserver-email-piping", "title": "What object is &quot;oMessage&quot; in hMailServer email piping?", "body": "<p>I'm adapting some hMailServer code I found to MS Outlook vba.  The source code is at <a href=\"https://www.hmailserver.com/forum/viewtopic.php?f=14&amp;t=2960\" rel=\"nofollow\">https://www.hmailserver.com/forum/viewtopic.php?f=14&amp;t=2960</a></p>\n\n<p>I have tested this code in hMailServer and with Thunderbird and have it working.  However, in deployment I expect I won't have access to an hMailServer, and the mail client is likely to be MS Outlook.</p>\n\n<p>In the source code the author references \"oMessage\" but, duh, I can't determine what object \"oMessage\" is supposed to be, and in my adaptation causes an error in the command line string where the error is of course, \"object required\".  Up to that point my vba script is working ok.  Since the thread at hMailServer is several years old, I don't expect to get a reply on a question I posted there.</p>\n\n<p>Here is the original source code:</p>\n\n<pre><code>Const g_sPHPPath     = \"C:\\path\\to\\php.exe\" \nConst g_sScriptPath  = \"C:\\path\\to\\script.php\" \nConst g_sPipeAddress = \"something@yourdomain.com\"\n\nSub OnDeliverMessage(oMessage) \n\nIf g_sPipeAddress = \"\" Then\n    bPipeMessage = True\nElse\n    bPipeMessage = False\n\n    Set obRecipients = oMessage.Recipients\n\n    For i = 0 to obRecipients.Count - 1\n        Set obRecipient = obRecipients.Item(i)\n\n        If LCase(obRecipient.Address) = LCase(g_sPipeAddress) Then\n            bPipeMessage = True\n        End If\n    Next\nEnd If\n\nIf bPipeMessage Then\n    sCommandLine = \"cmd /c type \" &amp; g_sDQ &amp; oMessage.Filename &amp; g_sDQ &amp; \" | \" &amp; g_sDQ &amp; g_sPHPPath &amp; g_sDQ &amp; \" \" &amp; g_sDQ &amp; g_sScriptPath &amp; g_sDQ \n    Set oShell = CreateObject(\"WScript.Shell\") \n    Call oShell.Run(sCommandLine, 0, TRUE) \nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>And here is my adaptation:</p>\n\n<pre><code>Const g_sPHPPath = \"C:\\xampp\\php\\php.exe\"\nConst g_sScriptPath = \"C:\\xampp\\htdocs\\Recycler\\test.php\"\nConst g_sPipeAddress = \"someAddress@mail.net\"\nConst g_sDQ = \"\"\"\"\n\nSub OnDeliverMessage(oMessage)\nDim Explorer As Outlook.Explorer\nDim CurrentItem As Object\n\nSet Explorer = Application.ActiveExplorer\nIf Explorer.Selection.Count Then\n    Set CurrentItem = Explorer.Selection(1)\nEnd If\n\nIf CurrentItem.Class = olMail Then\n    Dim sender\n    sender = CurrentItem.SenderEmailAddress\nEnd If\n\nIf g_sPipeAddress = \"\" Then\n    bPipeMessage = True\nElse\n    If LCase(sender) = LCase(g_sPipeAddress) Then\n        bPipeMessage = True\n    End If\nEnd If\n\nIf bPipeMessage Then\n    sCommandLine = \"cmd /c type \" &amp; g_sDQ &amp; oMessage.FileName &amp; g_sDQ &amp; \" | \" &amp; g_sDQ &amp; g_sPHPPath &amp; g_sDQ &amp; \" \" &amp; g_sDQ &amp; g_sScriptPath &amp; g_sDQ\n    Set oShell = CreateObject(\"WScript.Shell\")\n    Call oShell.Run(sCommandLine, 0, True)\nEnd If\nEnd Sub\n</code></pre>\n\n<p>So, can anyone tell me what object oMessage would equate to in the Outlook model?  In the cmd string, what should I be looking for in \"oMessage.FileName\" ?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449076484, "post_id": 34048862, "comment_id": 55852367, "body": "Surprised <code>Range(&quot;J1&quot; &amp; LastRow).Cells</code> didn&#39;t throw an error. I think you meant <code>Range(&quot;J&quot; &amp; LastRow).Cells</code>? Which is really only one cell?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449076493, "post_id": 34048862, "comment_id": 55852373, "body": "<code>Dim dat as Range</code>.  Then <code>Set dat = cell.Offset(0, 6)</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1449076605, "post_id": 34048862, "comment_id": 55852453, "body": "@findwindow <code>Range(&quot;J1&quot; &amp; LastRow)</code> should be <code>Range(&quot;J1&quot;, .Range(&quot;J&quot; &amp; LastRow))</code>"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449076646, "post_id": 34048862, "comment_id": 55852484, "body": "Ahhh that makes more sense."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1449079097, "post_id": 34048862, "comment_id": 55853966, "body": "Or <code>Range(&quot;J1:J&quot; &amp; LastRow)</code>..."}], "answers": [{"comments": [{"owner": {"reputation": 68, "user_id": 5545108, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6315ac00caf5dec4d0098be07d43cab2?s=128&d=identicon&r=PG", "display_name": "Scap", "link": "https://stackoverflow.com/users/5545108/scap"}, "edited": false, "score": 0, "creation_date": 1449090062, "post_id": 34048977, "comment_id": 55860025, "body": "That worked, thank you! Also thanks for the Select Case suggestion, that looks much better."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 68, "user_id": 5545108, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6315ac00caf5dec4d0098be07d43cab2?s=128&d=identicon&r=PG", "display_name": "Scap", "link": "https://stackoverflow.com/users/5545108/scap"}, "edited": false, "score": 0, "creation_date": 1449090251, "post_id": 34048977, "comment_id": 55860149, "body": "@Scap Glad to help.  Please accept as correct, by selecting the green check mark under the down arrow."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1449079161, "last_edit_date": 1449079161, "creation_date": 1449076719, "answer_id": 34048977, "question_id": 34048862, "link": "https://stackoverflow.com/questions/34048862/vba-excel-how-to-iterate-through-a-column-and-change-offset-column-based-on-con/34048977#34048977", "title": "VBA excel: how to iterate through a column and change offset column based on condition", "body": "<p>Just because there was more than one item wrong, this combines mine and FindWindow's comments:</p>\n\n<pre><code>Sub RemoveDate()\n\nDim state\nDim dat As Range\nDim cell As Range\nDim LastRow As Long\n\n\nSheets(\"RawData\").Select\n\nLastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n'If cell in column J is = state then change the cell 6 columns to right\n\nFor Each cell In Range(\"J1\", Range(\"J\" &amp; LastRow)).Cells\n    state = cell.Value\n    Set dat = cell.Offset(0, 6)\n\n    If state = \"Pending\" Then\n        dat = \"TBD\"\n    ElseIf state = \"Under Review\" Then\n        dat = \"TBD\"\n    ElseIf state = \"BRD Refinement\" Then\n        dat = \"TBD\"\n    ElseIf state = \"On Hold\" Then\n        dat = \"TBD\"\n    End If\nNext\n\n\nEnd Sub\n</code></pre>\n\n<p>With <code>dat = cell.Offset(0, 6).Value</code> you are setting the variable dat to the contents of the cell.  Then with the if statements you replace the value in the variable alone not the cell.</p>\n\n<p>By making the variable a range, and using the <code>Set</code> keyword, it referes to the cell itself and replaces what ever is in the cell with the value set in your if statement.</p>\n\n<p>Just a side note look into Select Case, it is easier when using multiple elseif's.  Replace the whole loop with this:</p>\n\n<pre><code>For Each cell In Range(\"J1\", Range(\"J\" &amp; LastRow)).Cells\n   Select Case cell.Value\n        'because all the values result in the same outcome\n        Case \"Pending\", \"Under Review\", \"BRD Refinement\", \"On Hold\"\n            cell.Offset(0, 6) = \"TBD\"\n        Case Else\n    End Select        \nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 2, "last_activity_date": 1449080637, "last_edit_date": 1449080637, "creation_date": 1449077166, "answer_id": 34049121, "question_id": 34048862, "link": "https://stackoverflow.com/questions/34048862/vba-excel-how-to-iterate-through-a-column-and-change-offset-column-based-on-con/34049121#34049121", "title": "VBA excel: how to iterate through a column and change offset column based on condition", "body": "<p>why not this way:</p>\n\n<pre><code>Sub RemoveDate()\n  Dim state As String, cell As Variant, LastRow As Long\n  LastRow = Sheets(\"RawData\").Cells(Rows.Count, 1).End(xlUp).Row\n  For Each cell In Sheets(\"RawData\").Range(\"J1:J\" &amp; LastRow).Cells\n    state = cell.Value\n    If state = \"Pending\" Or state = \"Under Review\" Or state = \"BRD Refinement\" Or state = \"On Hold\" Then\n      cell.Offset(0, 6).Value = \"TBD\"\n    End If\n  Next\nEnd Sub\n</code></pre>\n\n<p>when doing it for a lot of cells, it may be slow, so i'd do it more like this way:</p>\n\n<pre><code>Sub RemoveDate()\n  Dim getRng As Variant, putRng As Variant, i As Long\n  i = Sheets(\"RawData\").Cells(Rows.Count, 1).End(xlUp).Row\n  Set getRng = Sheets(\"RawData\").Range(\"J1:J\" &amp; i).Value\n  Set putRng = Sheets(\"RawData\").Range(\"P1:P\" &amp; i).Value \n\n  While i &gt; 1\n    If getRng(i, 1) = \"Pending\" Or getRng(i, 1) = \"Under Review\" Or getRng(i, 1) = \"BRD Refinement\" Or getRng(i, 1) = \"On Hold\" Then\n      putRng(i, 1) = \"TBD\"\n    End If\n    i = i - 1\n  Wend\n  Sheets(\"RawData\").Range(\"P1:P\" &amp; Ubound(putRng)).Value = putRng\nEnd Sub\n</code></pre>\n\n<p>if there also formulas in <code>P</code> then better replace <code>.Value</code> with <code>.Formula</code>.<br>\nthe second code simply puts all the values of the range to check and change in to variables. then uses <code>i</code> as address to get the values in the variables to compare/change it (from the last item to the first). Which is much faster then doing it with the real cells. however, your <code>For Each ...</code> does the same in the first way, but the need of the <code>.Offset</code> kinda kills it again.  as last action it puts the whole range of the outputvalue back to your sheet. doing this for lots of cells in one step, is also much faster then doing this only for some cells one after another. this way it also overwrites the cells which havent changed with their old value (as a funny fact: this is still faster than leaving them out)</p>\n"}], "owner": {"reputation": 68, "user_id": 5545108, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6315ac00caf5dec4d0098be07d43cab2?s=128&d=identicon&r=PG", "display_name": "Scap", "link": "https://stackoverflow.com/users/5545108/scap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "accepted_answer_id": 34048977, "answer_count": 2, "score": 0, "last_activity_date": 1449080637, "creation_date": 1449076379, "question_id": 34048862, "link": "https://stackoverflow.com/questions/34048862/vba-excel-how-to-iterate-through-a-column-and-change-offset-column-based-on-con", "title": "VBA excel: how to iterate through a column and change offset column based on condition", "body": "<p>I am trying to change cells 6 columns to the right of my iteration. The vba below does not seem to come up with any errors, but when I run the Sub, nothing updates. Any ideas?</p>\n\n<pre><code>Sub RemoveDate()\n\nDim state\nDim dat\nDim cell As Range\nDim LastRow As Long\n\n\nSheets(\"RawData\").Select\n\nLastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n'If cell in column J is = state then change the cell 6 columns to right\n\nFor Each cell In Range(\"J1\" &amp; LastRow).Cells\n    state = cell.Value\n    dat = cell.Offset(0, 6).Value\n\n    If state = \"Pending\" Then\n        dat = \"TBD\"\n    ElseIf state = \"Under Review\" Then\n        dat = \"TBD\"\n    ElseIf state = \"BRD Refinement\" Then\n        dat = \"TBD\"\n    ElseIf state = \"On Hold\" Then\n        dat = \"TBD\"\n    End If\nNext\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 1596425, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/152a1d7f19282c770b12a1a43c1739c5?s=128&d=identicon&r=PG", "display_name": "Omen", "link": "https://stackoverflow.com/users/1596425/omen"}, "is_accepted": false, "score": 0, "last_activity_date": 1449085201, "creation_date": 1449085201, "answer_id": 34051524, "question_id": 34048701, "link": "https://stackoverflow.com/questions/34048701/extract-first-name-of-the-sender/34051524#34051524", "title": "Extract First Name of the sender", "body": "<p>Just replace this line:</p>\n\n<pre><code>Dim tekst$: tekst = \"Hi \" &amp; Split(objItem2.SenderName)(0) &amp; \",\" &amp; vbNewLine &amp; vbNewLine\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 475, "user_id": 5942173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f26112899040dc709bcdcd11bfd8b14?s=128&d=identicon&r=PG&f=1", "display_name": "Uttam", "link": "https://stackoverflow.com/users/5942173/uttam"}, "edited": false, "score": 0, "creation_date": 1538062696, "post_id": 49097023, "comment_id": 92021019, "body": "Thank you, below line of code got me first name for exchange user: Application.ActiveExplorer.Selection.Item(1).Sender.getexcha&zwnj;&#8203;ngeuser.firstname"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 475, "user_id": 5942173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f26112899040dc709bcdcd11bfd8b14?s=128&d=identicon&r=PG&f=1", "display_name": "Uttam", "link": "https://stackoverflow.com/users/5942173/uttam"}, "edited": false, "score": 0, "creation_date": 1538066780, "post_id": 49097023, "comment_id": 92023192, "body": "If the reply answers your question, please mark it as such."}, {"owner": {"reputation": 475, "user_id": 5942173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f26112899040dc709bcdcd11bfd8b14?s=128&d=identicon&r=PG&f=1", "display_name": "Uttam", "link": "https://stackoverflow.com/users/5942173/uttam"}, "edited": false, "score": 1, "creation_date": 1538070420, "post_id": 49097023, "comment_id": 92024883, "body": "Done...sorry not very frequent visitor on this path and missed. :P"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1520177562, "creation_date": 1520177562, "answer_id": 49097023, "question_id": 34048701, "link": "https://stackoverflow.com/questions/34048701/extract-first-name-of-the-sender/49097023#49097023", "title": "Extract First Name of the sender", "body": "<p>Why do you assume there is a first name and last name? All you get is a display name - it can be just the email address, or anything the sender wanted to show. You are of course free to parse the display name assuming it will be in the format \"first last\" or \"last, first\". Or \"first middle last\". Or any other format. </p>\n\n<p>In case of an Exchange sender, you can, of course, retrieve the <code>AddressEntry</code> object from <code>MailItem.Sender</code> and check if <code>AddressEntry.GetExchangeUser</code> is not null. If you have a valid object, you can use <code>ExchangeUser.FirstName</code> and <code>ExchangeUser.LastName</code>.</p>\n"}], "owner": {"reputation": 119, "user_id": 1596425, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/152a1d7f19282c770b12a1a43c1739c5?s=128&d=identicon&r=PG", "display_name": "Omen", "link": "https://stackoverflow.com/users/1596425/omen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2017, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1593041392, "creation_date": 1449075880, "last_edit_date": 1593041392, "question_id": 34048701, "link": "https://stackoverflow.com/questions/34048701/extract-first-name-of-the-sender", "title": "Extract First Name of the sender", "body": "<p>After receiving an email I want to extract the sender's First Name into the email body, to avoid name typos.</p>\n\n<p>I managed with Name and Surname, but I can\u2019t extract and display First Name only.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub Dodanie_imienia()\nOn Error GoTo brak_aktywnego\nDim objItem As MailItem: Set objItem = Application.ActiveExplorer.Selection.Item(1)\nOn Error GoTo 0\nDim objInsp As Outlook.Inspector: Set objInsp = objItem.GetInspector\nDim objDoc As Object: Set objDoc = objInsp.WordEditor 'Word.Document\nDim objWord As Object: Set objWord = objDoc.Application 'Word.Application\nDim objSel As Object: Set objSel = objWord.Selection 'Word.Selection\nDim objItem2 As Object: Set objItem2 = Application.ActiveExplorer.Selection.Item(1)\nDim tekst$: tekst = \"Hi \" &amp; objItem2.SenderName &amp; \",\" &amp; vbNewLine &amp; vbNewLine\n\n objSel.TypeText tekst\n\nExit Sub\nbrak_aktywnego:\n If Err.Number = 91 Then _\n MsgBox \"Utw\u00f3rz wiadomo\u015b\u0107 do edycji.\", vbExclamation, \"LB\" Else _\n MsgBox Err.Number &amp; \" \" &amp; Err.Description, vbExclamation, \"LB\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1449078324, "creation_date": 1449078324, "answer_id": 34049504, "question_id": 34048472, "link": "https://stackoverflow.com/questions/34048472/how-to-paste-clipboard-content-to-specific-location-in-word-table/34049504#34049504", "title": "How to paste clipboard content to specific location in word table", "body": "<p>The Range object also has the Paste, PasteFormat and similar methods. It's possible that you might first need to collapse the range so that it's inside the cell (rather than containing the cell). For example:</p>\n\n<pre><code>Set rng = Tbl.Cell(i, 5).Range\nrng.Collapse wdCollapseStart\nrng.PasteAndFormat wdPasteDefault\n</code></pre>\n"}], "owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1224, "favorite_count": 0, "accepted_answer_id": 34049504, "answer_count": 1, "score": 0, "last_activity_date": 1459262252, "creation_date": 1449075295, "last_edit_date": 1459262252, "question_id": 34048472, "link": "https://stackoverflow.com/questions/34048472/how-to-paste-clipboard-content-to-specific-location-in-word-table", "title": "How to paste clipboard content to specific location in word table", "body": "<p>As part to extract data form web I use following (problematic) code.</p>\n\n<pre><code>Sub USPTOAbstHTML1()\nApplication.ScreenUpdating = False\nDim Rng As Range, Tbl As table, StrTxt As String, HttpReq As Object, i As Long, oHtml As MSHTML.HTMLDocument, IE As SHDocVw.InternetExplorer\nSet HttpReq = CreateObject(\"Microsoft.XMLHTTP\")\nSet oHtml = New HTMLDocument\nSet IE = CreateObject(\"InternetExplorer.Application\")\nWith ActiveDocument.Range\n    For Each Tbl In .Tables\n        With Tbl\n            For i = 1 To .Rows.Count\n                With .Cell(i, 2).Range\n                            If .Hyperlinks.Count &gt; 0 Then\n                            MsgBox .Hyperlinks(1).Address\n                                HttpReq.Open \"GET\", .Hyperlinks(1).Address, False\n                                HttpReq.send\n                                oHtml.body.innerHTML = HttpReq.responseText\n                                MsgBox HttpReq.responseText\n                                StrTxt = oHtml.getElementsByClassName(\"claim\").Item.innerHTML\n                                With IE\n                                    .Visible = False\n                                    .navigate \"about:blank\"\n                                    .Document.body.innerHTML = StrTxt\n                                    .Document.execCommand \"SelectAll\"\n                                    .Document.execCommand \"Copy\"\n                                End With\n                                With Tbl.Cell(i, 5).Range\n                                   Selection.PasteAndFormat (wdPasteDefault)\n                                End With\n                            End If\n                            .Collapse wdCollapseEnd\n                            .Find.Execute\n                End With\n            Next\n        End With\n    Next\nEnd With\nSet HttpReq = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>The problem in above code is, I could not find any method by which i could add clipboard content to specific location i.e. Tbl.Cell(i, 5).Range\nThe code is inserting data wherever selection is.</p>\n\n<p>I tried MSForms.DataObject but I could only found examples with only text whereas my clipboard content is more than just text. (Formatted text with images)</p>\n\n<p>is there any other way I can get the job done?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1449076432, "post_id": 34048325, "comment_id": 55852338, "body": "Show the moveMail() function"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1449779179, "post_id": 34048325, "comment_id": 56166282, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/20214072/passing-variable-from-form-to-module-in-vba\">Passing variable from Form to Module in VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 60, "user_id": 2815681, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d295ff23c9e5eb5d823998728024bf79?s=128&d=identicon&r=PG&f=1", "display_name": "user2815681", "link": "https://stackoverflow.com/users/2815681/user2815681"}, "is_accepted": true, "score": -1, "last_activity_date": 1449154070, "creation_date": 1449154070, "answer_id": 34068950, "question_id": 34048325, "link": "https://stackoverflow.com/questions/34048325/how-do-i-send-the-email-object-to-a-function/34068950#34068950", "title": "How do I send the email object to a function?", "body": "<p>It is possible, you just need to be more careful declaring your variables.</p>\n\n<pre><code>Sub schaap()\nFor Each objItem In Application.ActiveExplorer.Selection\n    Dim mailbericht As Object\n    Set mailbericht = objItem\n    Call cavia(mailbericht)\nNext\nEnd Sub\n\nFunction cavia(mailbericht As Object)\n    MsgBox mailbericht.Subject\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 60, "user_id": 2815681, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d295ff23c9e5eb5d823998728024bf79?s=128&d=identicon&r=PG&f=1", "display_name": "user2815681", "link": "https://stackoverflow.com/users/2815681/user2815681"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 34068950, "answer_count": 1, "score": 1, "last_activity_date": 1593517836, "creation_date": 1449074924, "last_edit_date": 1593517836, "question_id": 34048325, "link": "https://stackoverflow.com/questions/34048325/how-do-i-send-the-email-object-to-a-function", "title": "How do I send the email object to a function?", "body": "<p>If have a function that loops through a selection of emails, an email is an object not a lose variable (<a href=\"https://stackoverflow.com/questions/20214072/passing-variable-from-form-to-module-in-vba\">Passing variable from Form to Module in VBA</a>):</p>\n\n<pre><code>Private Sub CommandButton5_Click()\n\nFor Each objItem In Application.ActiveExplorer.Selection\n    moveMail(TextBox1.Value, objItem)\nNext\nEnd Sub\n</code></pre>\n\n<p>based on - lets say - the subject I want to do something with that email. That means that I will have to move the mail object to a function. But if do like I did it now I get an error.</p>\n\n<pre><code>compiling error    \nsynstaxt error\n</code></pre>\n"}, {"tags": ["vba", "excel", "recordset"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1449075217, "post_id": 34048266, "comment_id": 55851492, "body": "Can&#39;t you get all the lines at once, using a <code>GROUP BY</code> query ?"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1449075344, "post_id": 34048266, "comment_id": 55851593, "body": "I don&#39;t quite understand your setup. Is just running 1 iteration of <code>Test</code> taking over a minute? You can add a timer variable to check between your code what is taking long to calculate. Might be some latency from querying your SQL. Can you do an ad hoc query directly from your db to see if the performance issue might be from that?"}, {"owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "edited": false, "score": 0, "creation_date": 1449079913, "post_id": 34048266, "comment_id": 55854463, "body": "I agree with iDevlop, you should pull a whole data set over to your workbook in one shot, preferably into a Pivot table where you can group by your arguments and then refer to the pivot table in your formula. Recordsets in functions are notoriously slow. Also don&#39;t forget to close your connection and set it to Nothing!"}, {"owner": {"reputation": 13, "user_id": 5631335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41de2defc6ac06ff1dfb217b817e8e4?s=128&d=identicon&r=PG&f=1", "display_name": "Takazeki", "link": "https://stackoverflow.com/users/5631335/takazeki"}, "edited": false, "score": 0, "creation_date": 1449139799, "post_id": 34048266, "comment_id": 55881062, "body": "The problem with taking the whole data in one shot to one worksheet is that the excel file gets extremely big (even if I import everything to a Pivotable). I&#39;m talking about &gt;40M files :( I need to work with ACTUAL information, ACTUAL -1 and Budget. And I need access to all accounts and cost centers from our General Ledger. Doing recordset allows me to keep our Balance Sheet and P&amp;L files around 1M, which is great. Btw, you&#39;re right about closing the connection, Thanks"}, {"owner": {"reputation": 13, "user_id": 5631335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41de2defc6ac06ff1dfb217b817e8e4?s=128&d=identicon&r=PG&f=1", "display_name": "Takazeki", "link": "https://stackoverflow.com/users/5631335/takazeki"}, "edited": false, "score": 0, "creation_date": 1449140072, "post_id": 34048266, "comment_id": 55881277, "body": "nbayly, 1 single interation takes like 2 seconds to retrieve the data to the excel cell (which is much slower that running the same query in SQL Server). As the reports have dozens of Cells, sometimes it take 1 to 2 minutes to fully update the reports. What I&#39;m searching for is possible solution that can save me 30 to 50%"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5631335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41de2defc6ac06ff1dfb217b817e8e4?s=128&d=identicon&r=PG&f=1", "display_name": "Takazeki", "link": "https://stackoverflow.com/users/5631335/takazeki"}, "edited": false, "score": 0, "creation_date": 1449142427, "post_id": 34059374, "comment_id": 55882928, "body": "Thanks, I will test that solution! This would only save me time if the query was previously executed right?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 13, "user_id": 5631335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41de2defc6ac06ff1dfb217b817e8e4?s=128&d=identicon&r=PG&f=1", "display_name": "Takazeki", "link": "https://stackoverflow.com/users/5631335/takazeki"}, "edited": false, "score": 0, "creation_date": 1449157939, "post_id": 34059374, "comment_id": 55893807, "body": "Yes- it&#39;s more about preventing queries from bein run repeatedly when excel recalculated the sheet.  As the other commenters suggested you might find it quicker to pull back all the data and query it client-side.  Really depends on how much data you have."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1449124743, "creation_date": 1449124743, "answer_id": 34059374, "question_id": 34048266, "link": "https://stackoverflow.com/questions/34048266/excel-vba-function-with-recordset-performance-issue/34059374#34059374", "title": "Excel VBA function with Recordset (Performance issue)", "body": "<p>If your data is not particularly time-sensitive then you can \"memoize\" your UDF by having it cache previously-queried results using a dictionary object.</p>\n\n<p>Untested:</p>\n\n<pre><code>Public Function Test(arg1 As String, arg2 As String, arg3 As Integer, _\n                            arg4 As Integer, arg5 As String) As Variant\n\n    Static dict As Object\n    Dim k As String, rv\n    Dim oConnection As ADODB.Connection\n    Dim oRecordset As ADODB.Recordset\n    Dim strSQL As String\n\n    'create the dictionary if not already created\n    If dict Is Nothing Then\n        Set dict = CreateObject(\"scripting.dictionary\")\n    End If\n\n    'create a unique \"key\" from the arguments\n    k = Join(Array(arg1, arg2, arg3, arg4, arg5), Chr(0))\n\n    'need to run this query?\n    If Not dict.exists(k) Then\n\n        Set oConnection = New ADODB.Connection\n        Set oRecordset = New ADODB.Recordset\n\n        strSQL = \"SELECT SUM(BALANCE) as Total FROM Accounting WHERE ARGUMENT1 = '\" &amp; _\n                 arg1 &amp; \"' AND ARGUMENT2 = '\" &amp; arg2 &amp; _\n                 \"' AND ARGUMENT3 = '\" &amp; arg3 &amp; \"' AND ARGUMENT4 = \" &amp; arg4 &amp; _\n                 \"  AND ARGUMENT5 = \" &amp; arg5 &amp; \"\"\n\n        oConnection.Open \"Provider=SQLOLEDB;\" &amp; _\n                             \"Data Source=(IP of database);\" &amp; _\n                             \"Initial Catalog=(catalog of database);\" &amp; _\n                             \"Trusted_connection=yes;\"\n\n        oRecordset.Open Source:=strSQL, ActiveConnection:=oConnection, _\n                        CursorType:=adOpenForwardOnly, LockType:=adLockReadOnly, _\n                        Options:=adCmdText\n\n\n        rv = oRecordset!Total\n\n        dict.Add k, rv\n\n        oRecordset.Close\n        Set oRecordset = Nothing\n\n    Else\n        'already ran the SQL - just return the result\n        rv = dict(k)\n    End If\n\n    Test = rv\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5631335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41de2defc6ac06ff1dfb217b817e8e4?s=128&d=identicon&r=PG&f=1", "display_name": "Takazeki", "link": "https://stackoverflow.com/users/5631335/takazeki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 976, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449124743, "creation_date": 1449074772, "question_id": 34048266, "link": "https://stackoverflow.com/questions/34048266/excel-vba-function-with-recordset-performance-issue", "title": "Excel VBA function with Recordset (Performance issue)", "body": "<p>I have a database in SQL Server that I'm using to feed some financial reports in Excel. I'm using Recordsets through a custom Excel Function that uses arguments from Cells to build the SQL queries. Here is how the code looks:</p>\n\n<pre><code> Public Function Test(arg1 As String, arg2 As String, arg3 As Integer, arg4 As Integer, arg5 As String) As Variant\n    Dim oConnection As ADODB.Connection\n    Set oConnection = New ADODB.Connection\n    Dim oRecordset As ADODB.Recordset\n    Set oRecordset = New ADODB.Recordset\n\n    Dim strSQL As String\n\n    strSQL = \"SELECT SUM(BALANCE) as Total FROM Accounting WHERE ARGUMENT1 = \" &amp; Chr$(39) &amp; arg1 &amp; Chr$(39) &amp; \" AND ARGUMENT2 = \" &amp; Chr$(39) &amp; arg2 &amp; Chr$(39) &amp; \" AND ARGUMENT3 = \" &amp; Chr$(39) &amp; arg3 &amp; Chr$(39) &amp; \" AND ARGUMENT4 = \" &amp; arg4 &amp; \"  AND ARGUMENT5 = \" &amp; arg5 &amp; \"\"\n\n    oConnection.Open \"Provider=SQLOLEDB;\" &amp; _\n                         \"Data Source=(IP of database);\" &amp; _\n                         \"Initial Catalog=(catalog of database);\" &amp; _\n                         \"Trusted_connection=yes;\"\n\n    oRecordset.Open Source:=strSQL, ActiveConnection:=oConnection, CursorType:=adOpenForwardOnly, LockType:=adLockReadOnly, Options:=adCmdText\n\n\n    Test = oRecordset!Total\n\n        oRecordset.Close\n        Set oRecordset = Nothing\n\n\nEnd Function\n</code></pre>\n\n<p>So, this code works very well but I'm having a performance issue. I have to fill dozens of cells, and each cell uses different arguments coming from different cells. So I have reports that take over 1 minute to load fully.</p>\n\n<p>I'm using adOpenForwardOnly, but are there any other fine tunings I can do to the code to speed up things?</p>\n\n<p>Thank you very much</p>\n"}, {"tags": ["excel", "vba", "solver"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449074619, "post_id": 34047947, "comment_id": 55851029, "body": "why not move this before the loop: <code>Application.Calculation = xlCalculationAutomatic</code> ...  Also, the copy paste can be written in 2 lines: <code>Sheets(&quot;DK Lineup&quot;).Range(&quot;Lineup&quot;)Copy (new line) Cells(T,1).PasteSpecial xlPasteValues</code>"}, {"owner": {"reputation": 1, "user_id": 5631296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d296eaeca3c62ddf1cf8313289c6d5?s=128&d=identicon&r=PG&f=1", "display_name": "VincentR", "link": "https://stackoverflow.com/users/5631296/vincentr"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449075508, "post_id": 34047947, "comment_id": 55851715, "body": "@ScottHoltzman I&#39;ve tried using the Application.Calculation = xlCalculationAutomatic before the loop, but that doesn&#39;t seem to work.  I had that code at the end because when I finished running the macro the calculations were always set to manual, which leads me to believe at some point during the loop the calculation is set to manual."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449075682, "post_id": 34047947, "comment_id": 55851847, "body": "did you step-through it line-by-line and see in fact which line sets the calcs to manual?"}, {"owner": {"reputation": 1, "user_id": 5631296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d296eaeca3c62ddf1cf8313289c6d5?s=128&d=identicon&r=PG&f=1", "display_name": "VincentR", "link": "https://stackoverflow.com/users/5631296/vincentr"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449076016, "post_id": 34047947, "comment_id": 55852057, "body": "@ScottHoltzman It seems to be the lines of solver code"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449076958, "post_id": 34047947, "comment_id": 55852699, "body": "I don&#39;t have time to research more now, set calcs back to auto after that line."}, {"owner": {"reputation": 1, "user_id": 5631296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d296eaeca3c62ddf1cf8313289c6d5?s=128&d=identicon&r=PG&f=1", "display_name": "VincentR", "link": "https://stackoverflow.com/users/5631296/vincentr"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449084429, "post_id": 34047947, "comment_id": 55857028, "body": "@ScottHoltzman Thanks, for your help but I realized the problem.  My code was never returning to the sheet in which Solver Function was set up on at the beginning of the loop so I thought the Solver Function was always returning the same values leading me to believe that the issue was due to the fact It wasn&#39;t updating the formulas within my sheet.  Sorry if I wasted any of your time.  Thanks again."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449087191, "post_id": 34047947, "comment_id": 55858537, "body": "I was going to point out that you never referenced the worksheet  in <code>Cells(T,1)</code> but decided to leave it alone. Turns out that was the trick :)"}], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 5569418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21c002f3aeef9a173da295e95e9f969e?s=128&d=identicon&r=PG", "display_name": "KiwiSteve", "link": "https://stackoverflow.com/users/5569418/kiwisteve"}, "is_accepted": false, "score": 0, "last_activity_date": 1449099879, "creation_date": 1449099879, "answer_id": 34055290, "question_id": 34047947, "link": "https://stackoverflow.com/questions/34047947/using-excel-solver-function-in-a-looping-vba-macro/34055290#34055290", "title": "Using Excel solver function in a looping VBA Macro", "body": "<p>Is it that the ScreenUpdating = False is the problem? I recall having this problem once.</p>\n\n<p>The code might be trying to work with what is displayed, which may have been calculated behind the scenes but appears to be not calculated.\nTry Rem (') before the ScreenUpdating statements to check this... remembering to step to the ... = True line to run just that line to ensure SU is set to update. Hope that makes sense</p>\n"}], "owner": {"reputation": 1, "user_id": 5631296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d296eaeca3c62ddf1cf8313289c6d5?s=128&d=identicon&r=PG&f=1", "display_name": "VincentR", "link": "https://stackoverflow.com/users/5631296/vincentr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 517, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1449099930, "creation_date": 1449073914, "last_edit_date": 1449099930, "question_id": 34047947, "link": "https://stackoverflow.com/questions/34047947/using-excel-solver-function-in-a-looping-vba-macro", "title": "Using Excel solver function in a looping VBA Macro", "body": "<p>I'm trying write an Excel looping macro using the Solver function in excel.  </p>\n\n<p>After each iteration in the loop I need formulas on the worksheet to recalculate, however it seems as if sometime during the loop the calculation is set to manual even though I did not code it to do such (at least not intentionally).  </p>\n\n<p>Ideally I would like my workbook to calculate all formulas at the beginning of my loop prior to it using the solver function.  </p>\n\n<p>I've attached the code I currently have.  </p>\n\n<p>Any help would be much appreciated.</p>\n\n<pre><code>Sub Lineups_Generator()\n'\n' Lineups_Generator Macro\n'\n' Keyboard Shortcut: Ctrl+q\n\n    Application.ScreenUpdating = False\n\n    Sheets(\"DK Lineups\").Select\n    Range(\"Output\").Select\n    Selection.ClearContents\n\n    E = Range(\"NumberOFLineups\").Value\n    T = 7\n\n\n    For I = 1 To E\n\n    Calculate\n\n\n    SolverOk SetCell:=\"$Q$12\", MaxMinVal:=1, ValueOf:=0, ByChange:=\"$H$4:$H$203\", _\n      Engine:=2, EngineDesc:=\"Simplex LP\"\n    SolverSolve Userfinish:=True\n\n    Sheets(\"DK Lineups\").Select\n    Range(\"Lineup\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Cells(T, 1).Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    T = T + 1\n\n    Next\n\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449073846, "post_id": 34047818, "comment_id": 55850458, "body": "Check <a href=\"http://stackoverflow.com/questions/34028430/deleting-via-autofilter-takes-too-long\">here</a>."}, {"owner": {"reputation": 4198, "user_id": 355294, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa7eb1d4b0091c5ca00178f0ce8f9e?s=128&d=identicon&r=PG", "display_name": "TheBlastOne", "link": "https://stackoverflow.com/users/355294/theblastone"}, "edited": false, "score": 0, "creation_date": 1449073895, "post_id": 34047818, "comment_id": 55850495, "body": "Well if you create ListObject lists in sheets, you have a very easy time keeping formatting and formulas consistent for all rows. Using this, I can handle sheets with hundreds of thousands of rows, inserting and deleting at will, without caring about the many formulas in that (or other) sheets. So I do not see any reason for creating VBA loops just to create formulas."}, {"owner": {"reputation": 1100, "user_id": 5086917, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/63a26c304d80483549e5949c8de2f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "apdm", "link": "https://stackoverflow.com/users/5086917/apdm"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449074227, "post_id": 34047818, "comment_id": 55850707, "body": "@findwindow That is cool.  Didn&#39;t he forget to clear the old data before putting in the new values though?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449074401, "post_id": 34047818, "comment_id": 55850876, "body": "Not sure what you mean. The arrays are empty to begin with. There&#39;s no old data."}, {"owner": {"reputation": 1100, "user_id": 5086917, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/63a26c304d80483549e5949c8de2f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "apdm", "link": "https://stackoverflow.com/users/5086917/apdm"}, "edited": false, "score": 0, "creation_date": 1449078355, "post_id": 34047818, "comment_id": 55853540, "body": "Oh I didn&#39;t realize that the newdat array was dimensioned to be the same size as the original range, so I thought when the newdat array values were put on the old range, the newdat array would be smaller and the old range would overlap.  I see what it&#39;s doing now.  That is a good solution"}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1449073939, "creation_date": 1449073939, "answer_id": 34047954, "question_id": 34047818, "link": "https://stackoverflow.com/questions/34047818/are-array-formulas-an-acceptable-alternative-to-loops/34047954#34047954", "title": "Are array formulas an acceptable alternative to loops?", "body": "<p>I'd almost always plump for using arrays:</p>\n\n<p>1) They will be faster.</p>\n\n<p>2) They tend to reduce the amount of VBA. No bad thing: VBA is considered to be a security hazard; many institutions disallow <code>xlsm</code> workbooks.</p>\n\n<p>3) It's difficult to overtype an array formula by accident. This helps to make a spreadsheet less brittle.</p>\n\n<p>One exception: I do find single cell array formulas pernicious: it's too easy to \"un-array\" them following an edit.</p>\n"}], "owner": {"reputation": 1100, "user_id": 5086917, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/63a26c304d80483549e5949c8de2f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "apdm", "link": "https://stackoverflow.com/users/5086917/apdm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449073939, "creation_date": 1449073573, "last_edit_date": 1531164843, "question_id": 34047818, "link": "https://stackoverflow.com/questions/34047818/are-array-formulas-an-acceptable-alternative-to-loops", "title": "Are array formulas an acceptable alternative to loops?", "body": "<p>I've been using VBA for a while now and began thinking that often times I'm too quick to use a loop.  They seem to be inefficient and cumbersome sometimes.  However, I haven't come across too many alternatives when browsing other real life examples, so I'm wondering if anyone tries using array formulas instead and if there are any disadvantages I'm not considering.</p>\n\n<p>Obviously I know that this alternative will not be able to replace most loops, but for a lot of simple worksheet loops it might.  I made this sub to easily demonstrate how an array formula is 13 seconds faster than a loop when it comes to displaying month names for only 500 rows.</p>\n\n<pre><code>Sub speedtest()\n\nDim sht As Worksheet\nDim time2 As Date\nSet sht = ActiveSheet\n\nApplication.ScreenUpdating = False\n\nWith sht\n    .Range(\"A1\").Value = \"Dates\"\n    .Range(\"B1\").Value = \"Array Formula\"\n    .Range(\"C1\").Value = \"Loop\"\n    .Range(\"F1\").Value = \"Formula Time - seconds\"\n    .Range(\"G1\").Value = \"Loop Time - seconds\"\n    .Columns(\"A\").NumberFormat = \"m/d/yyyy\"\n    .Range(\"A2:A500\").Formula = \"=RANDBETWEEN(41817, 42395)\"\n    .Range(\"A2:A500\").Value = .Range(\"A2:A500\").Value\n    'Array formula\n    time2 = Now\n    .Range(\"B2:B500\").FormulaArray = \"=TEXT(A2:A500,\" &amp; Chr(34) &amp; \"mmmm\" &amp; Chr(34) &amp; \")\"\n    .Range(\"B2:B500\").Value = .Range(\"B2:B500\").Value\n    .Range(\"F2\").Value = (Now - time2) * 24 * 60 * 60\n    'Loop\n    time2 = Now\n    For x = 2 To 500\n        .Range(\"C\" &amp; x).Value = Format(.Range(\"A\" &amp; x).Value, \"mmmm\")\n    Next x\n    .Range(\"G2\").Value = (Now - time2) * 24 * 60 * 60\n    .Columns(\"A:G\").AutoFit\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "edited": false, "score": 0, "creation_date": 1449073676, "post_id": 34047593, "comment_id": 55850329, "body": "May the folder you are testing with does not contain mails only? Maybe also other folders?"}, {"owner": {"reputation": 11, "user_id": 5630750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af331a2f0520d6c4f690598422a35059?s=128&d=identicon&r=PG", "display_name": "user5630750", "link": "https://stackoverflow.com/users/5630750/user5630750"}, "reply_to_user": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "edited": false, "score": 0, "creation_date": 1449074557, "post_id": 34047593, "comment_id": 55850990, "body": "Hey blckbird. Not sure what you mean? Its my normal Inbox, it doesnt have subfolders.  Just Inbox, Drafts, Sent Mail, Deleteted Items.  The default Outlook setup."}], "answers": [{"comments": [{"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 1, "creation_date": 1449076434, "post_id": 34048621, "comment_id": 55852341, "body": "Better yet: <code>If TypeOf obj Is MailItem Then ...</code>"}, {"owner": {"reputation": 11, "user_id": 5630750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af331a2f0520d6c4f690598422a35059?s=128&d=identicon&r=PG", "display_name": "user5630750", "link": "https://stackoverflow.com/users/5630750/user5630750"}, "edited": false, "score": 0, "creation_date": 1449080004, "post_id": 34048621, "comment_id": 55854495, "body": "You guys are awesome! Changed olMail to Variant and worked like a charm!  One day I hope to be as good as you, until then, I appreciate the help!"}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "reply_to_user": {"reputation": 11, "user_id": 5630750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af331a2f0520d6c4f690598422a35059?s=128&d=identicon&r=PG", "display_name": "user5630750", "link": "https://stackoverflow.com/users/5630750/user5630750"}, "edited": false, "score": 0, "creation_date": 1449138463, "post_id": 34048621, "comment_id": 55880060, "body": "@user Don&#39;t forget to mark the answer as accepted. This shows your appreciation and closes the thread."}], "tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": false, "score": 1, "last_activity_date": 1449075662, "creation_date": 1449075662, "answer_id": 34048621, "question_id": 34047593, "link": "https://stackoverflow.com/questions/34047593/outlook-mail-metrics-vba-mismatch-type/34048621#34048621", "title": "Outlook mail metrics vba mismatch type", "body": "<p>You For Each loop assumes that the object obtained from the indexer of the Items collection is returning a MailItem object into the olMail variable. That folder could contain non-email messages, such as ReportItem or MeetingRequest objects.  Instead declare an Object variable, and check the value of MessageClass or Type to verify that the message is a MailItem object before you cast it to a specific object time.  I would also use a For loop with an indexer instead of For Each, which consumes less memory resources when iterating Outlook objects.</p>\n"}], "owner": {"reputation": 11, "user_id": 5630750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af331a2f0520d6c4f690598422a35059?s=128&d=identicon&r=PG", "display_name": "user5630750", "link": "https://stackoverflow.com/users/5630750/user5630750"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1449075662, "creation_date": 1449072990, "last_edit_date": 1495535230, "question_id": 34047593, "link": "https://stackoverflow.com/questions/34047593/outlook-mail-metrics-vba-mismatch-type", "title": "Outlook mail metrics vba mismatch type", "body": "<p>Trying to use the vba from another thread, however, getting a mismatch type on the line for \"For Each olMail In flInbox.Items\".  Any ideas what I'm doing wrong?  I have outlook and excel referenced.</p>\n\n<pre><code>Dim olMail As MailItem\nDim aOutput() As Variant\nDim lCnt As Long\nDim xlApp As Excel.Application\nDim xlSh As Excel.Worksheet\nDim flInbox As Folder\n\nSet flInbox = Application.GetNamespace(\"MAPI\").GetDefaultFolder(olFolderInbox)\n\nReDim aOutput(1 To flInbox.Items.Count, 1 To 4)\n\nFor Each olMail In flInbox.Items\n    If TypeName(olMail) = \"MailItem\" Then\n        lCnt = lCnt + 1\n        aOutput(lCnt, 1) = olMail.SenderEmailAddress 'maybe stats on domain\n        aOutput(lCnt, 2) = olMail.ReceivedTime 'stats on when received\n        aOutput(lCnt, 3) = olMail.ConversationTopic 'group based on subject w/o regard to prefix\n        aOutput(lCnt, 4) = olMail.Subject 'to split out prefix\n    End If\nNext olMail\n\nSet xlApp = New Excel.Application\nSet xlSh = xlApp.Workbooks.Add.Sheets(1)\n\nxlSh.Range(\"A1\").Resize(UBound(aOutput, 1), UBound(aOutput, 2)).Value = aOutput\nxlApp.Visible = True\n</code></pre>\n\n<p>Link:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/16404224/using-vba-in-outlook-to-gather-statistics-on-received-emails/34045167#34045167\">Using VBA in Outlook to gather statistics on received emails</a></p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1449072355, "post_id": 34047254, "comment_id": 55849350, "body": "<code>Msgbox LastClmn(4,1)</code>Should do it.  Though it appears to be a 1 dimensional array it is actually a 2 dimensional array.  So you need to put the <code>,1</code>."}, {"owner": {"reputation": 3, "user_id": 5631147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aa482c6ec037e589d1c67387984ac16?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/5631147/phil"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449072738, "post_id": 34047254, "comment_id": 55849616, "body": "This works. Thanks, Scott!"}], "answers": [{"tags": [], "owner": {"reputation": 54, "user_id": 5112104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f806327b373260b8da3b4a5ea2b517c2?s=128&d=identicon&r=PG", "display_name": "ChipperG", "link": "https://stackoverflow.com/users/5112104/chipperg"}, "is_accepted": true, "score": -1, "last_activity_date": 1449072721, "creation_date": 1449072721, "answer_id": 34047503, "question_id": 34047254, "link": "https://stackoverflow.com/questions/34047254/reading-array-from-spreadsheet-data-vba/34047503#34047503", "title": "Reading array from Spreadsheet Data VBA", "body": "<p>Try <code>LastClmn(4,1)</code></p>\n\n<p>I found it by using the Locals Window under View in the menu bar.</p>\n"}], "owner": {"reputation": 3, "user_id": 5631147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aa482c6ec037e589d1c67387984ac16?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/5631147/phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 34047503, "answer_count": 1, "score": 0, "last_activity_date": 1449072721, "creation_date": 1449072020, "question_id": 34047254, "link": "https://stackoverflow.com/questions/34047254/reading-array-from-spreadsheet-data-vba", "title": "Reading array from Spreadsheet Data VBA", "body": "<p>I'm sending a range into an array in VBA.  But, when I try to reference parts of the array, I get a \"Subscript Out of Range\" error.  I know that the range is successfully being transferred, because I can then send the array back into a different range.</p>\n\n<pre><code>Dim LastClmn() As Variant   'The last column of brake data\nSet RangeSet = ws.Range(\"RJ2:RJ\" &amp; ii)\nLastClmn() = RangeSet\nMsgbox LastClmn(4)\n</code></pre>\n\n<p>Referencing a piece of the array is what causes the error</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449072959, "post_id": 34047212, "comment_id": 55849770, "body": "Can you show a photo of what sheet2 is looking like at the moment?"}, {"owner": {"reputation": 1364, "user_id": 3802688, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5dd6d7ca4269119b95035d02a0bf48ef?s=128&d=identicon&r=PG", "display_name": "Beengie", "link": "https://stackoverflow.com/users/3802688/beengie"}, "edited": false, "score": 1, "creation_date": 1449073238, "post_id": 34047212, "comment_id": 55849974, "body": "It looks like you are going beyond the normal usage of a spreadsheet. What you ask can be easily handled, but over time I think you will wish that you had done this in a database application or on an intranet backed by a database. Just think about years down the road when something needs to be added or combining workbooks to get annual numbers. Just a thought..."}, {"owner": {"reputation": 155, "user_id": 5152595, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0fe63ac592fdc0b2f3888adb1c596b42?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Chandler", "link": "https://stackoverflow.com/users/5152595/graham-chandler"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449100484, "post_id": 34047212, "comment_id": 55864901, "body": "@ScottCraner I just added a few more pictures"}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 5152595, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0fe63ac592fdc0b2f3888adb1c596b42?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Chandler", "link": "https://stackoverflow.com/users/5152595/graham-chandler"}, "edited": false, "score": 0, "creation_date": 1449245473, "post_id": 34055583, "comment_id": 55937505, "body": "thanks a lot this worked perfectly.  don&#39;t know why I was trying to make this so difficult."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 155, "user_id": 5152595, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0fe63ac592fdc0b2f3888adb1c596b42?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Chandler", "link": "https://stackoverflow.com/users/5152595/graham-chandler"}, "edited": false, "score": 0, "creation_date": 1449245565, "post_id": 34055583, "comment_id": 55937575, "body": "@GrahamChandler So glad I could help.  We all get caught in following threads when there is a shorter way."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1449102087, "last_edit_date": 1449102087, "creation_date": 1449101539, "answer_id": 34055583, "question_id": 34047212, "link": "https://stackoverflow.com/questions/34047212/excel-vba-displaying-arrays/34055583#34055583", "title": "Excel VBA: Displaying Arrays?", "body": "<p>There is no reason to use an array.  Ranges are arrays by their nature.</p>\n\n<p>This should do what you want:</p>\n\n<pre><code>Dim accountnum As Range\nDim accountnumrng As Range\nDim lastrow As Long\nDim sze As Long\n\nlastrow = Sheet1.Range(\"G2\").End(xlDown).Row\nsze = lastrow - 2 + 1\n\nSet accountnumrng = Sheet2.Range(\"B6:B1000\").SpecialCells(xlCellTypeConstants, 23)\n\nFor Each accountnum In accountnumrng.Cells\n    accountnum.Offset(1, 8).Resize(sze, 9).Value = Sheet1.Range(\"O2:W\" &amp; lastrow).value\n    accountnum.Offset(1, 0).Resize(sze, 7).Value = Sheet1.Range(\"G2:M\" &amp; lastrow).value\nNext accountnum\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 5152595, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0fe63ac592fdc0b2f3888adb1c596b42?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Chandler", "link": "https://stackoverflow.com/users/5152595/graham-chandler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 34055583, "answer_count": 1, "score": 2, "last_activity_date": 1449102087, "creation_date": 1449071903, "last_edit_date": 1449100460, "question_id": 34047212, "link": "https://stackoverflow.com/questions/34047212/excel-vba-displaying-arrays", "title": "Excel VBA: Displaying Arrays?", "body": "<p>I'm working on a project for work and I've hit a wall.  I'm trying to automate some formatting to speed up a process.  On Sheet1, there is a table in the range G2 to W21.  The data contained in this table is entered by the user via a userform.  After the data is entered, I use this data to drive out Sheet2 is formatted.  So far, I've figured out how to handle column G &amp; H of this table the way that I want.  I cant figure out how to handle columns I:M and O:W.</p>\n\n<p>Here is the code I've come up with so far:</p>\n\n<pre><code>Dim LineItems As Range, Cell As Range\nDim linearr() As Variant\nDim datasetarr() As Variant\nDim i As Integer\nDim j As Integer\nDim accountnum As Range\nDim accountnumrng As Range\n\nSet LineItems = Sheet1.Range(\"H2:H21\")\nSet DataSets = Sheet1.Range(\"G2:G21\")\n\nFor Each Cell In LineItems\n    If Len(Cell.Value) &gt; 0 Then\n        i = i + 1\n        ReDim Preserve linearr(1 To i)\n        linearr(i) = Cell.Value\n    End If\nNext Cell\n\nFor Each Cell In DataSets\n    If Len(Cell.Value) &gt; 0 Then\n        j = j + 1\n        ReDim Preserve datasetarr(1 To j)\n        datasetarr(j) = Cell.Value\n    End If\nNext Cell\n\nSet accountnumrng = Sheet2.Range(\"B6:B1000\").SpecialCells(xlCellTypeConstants, 23)\n\nFor Each accountnum In accountnumrng.Cells\n\naccountnum.Offset(1, 1).Cells(1, 1).Resize(UBound(linearr), 1).Value = Application.Transpose(linearr)\naccountnum.Offset(1, 0).Cells(1, 1).Resize(UBound(datasetarr), 1).Value = Application.Transpose(datasetarr)\n\nNext accountnum\n</code></pre>\n\n<p>here is a picture of the table on Sheet1.  Outlined in red are the columns I'm trying to work with</p>\n\n<p><a href=\"https://i.stack.imgur.com/7X19s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7X19s.png\" alt=\"enter image description here\"></a></p>\n\n<p>I basically just want to expand on what I've figured out so far.  Any help would be greatly appreciated.  </p>\n\n<p>Below is a Picture of what Sheet2 looks like right now\n<a href=\"https://i.stack.imgur.com/1Wazn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1Wazn.png\" alt=\"enter image description here\"></a></p>\n\n<p>Below is what I'd like Sheet2 to look like\n<a href=\"https://i.stack.imgur.com/lYZPZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lYZPZ.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["python", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 5153655, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uvGil-rYXoM/AAAAAAAAAAI/AAAAAAAAAXY/NgVe2WiU4BQ/photo.jpg?sz=128", "display_name": "Gato", "link": "https://stackoverflow.com/users/5153655/gato"}, "is_accepted": false, "score": 0, "last_activity_date": 1449084529, "creation_date": 1449084529, "answer_id": 34051325, "question_id": 34046988, "link": "https://stackoverflow.com/questions/34046988/run-macro-win32com-with-python-filename-excel-spaces-issue/34051325#34051325", "title": "Run Macro Win32com with python, Filename Excel Spaces issue", "body": "<p>SOLVED</p>\n\n<p>on the xlApp.Application.Run python doesn't need the whole name so i changed Main System FIndx.xlsm!Test_macro.Prueba to \"Test_macro.Prueba\" and works! :D</p>\n"}], "owner": {"reputation": 51, "user_id": 5153655, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uvGil-rYXoM/AAAAAAAAAAI/AAAAAAAAAXY/NgVe2WiU4BQ/photo.jpg?sz=128", "display_name": "Gato", "link": "https://stackoverflow.com/users/5153655/gato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 302, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449140199, "creation_date": 1449071360, "last_edit_date": 1531161705, "question_id": 34046988, "link": "https://stackoverflow.com/questions/34046988/run-macro-win32com-with-python-filename-excel-spaces-issue", "title": "Run Macro Win32com with python, Filename Excel Spaces issue", "body": "<p>I had a issue with running a macro from an excel with python/flask.</p>\n\n<p>When the file don't have spaces on his name works okay and run the macro, if the file have spaces in the filename i can't run it.</p>\n\n<p>Here's the code of the py file</p>\n\n<pre><code>    app.route('/process_done', methods=['POST'])    \ndef runmacros():\n     run_macro(\"Main System FIndx.xlsm!Test_macro.Prueba\",\"..\\System\\Main Test.xlsm\") \n\n\n return render_template('main.jade')\n</code></pre>\n\n<p>and the function</p>\n\n<pre><code>def run_macro(macroname, filetorun):\n        pythoncom.CoInitialize ()\n        xlApp = Dispatch('Excel.Application')\n        xlWb = xlApp.Workbooks.Open(filetorun)\n        xlSht = xlWb.WorkSheets(1)\n        xlApp.visible = True\n        xlApp.Application.Run(macroname)\n        xlWb.Saved = 0\n        xlWb.Save()\n        xlWb.Close(SaveChanges=True)\n        xlApp.application.Quit()\n</code></pre>\n\n<p>So if the file rename to \"MainTest\" the macro runs when the button template is pressed, but if I called \"Main Test\" doesn't work.</p>\n\n<p>Maybe the solution is very easy but I can find it.</p>\n\n<p>Thanks in advance.</p>\n\n<p>pd: the problem is displayed when I try to run the macro, the file did open without problem.</p>\n\n<p>EDIT:</p>\n\n<p>SOLVED</p>\n\n<p>on the xlApp.Application.Run python doesn't need the whole name so i changed Main System FIndx.xlsm!Test_macro.Prueba to \"Test_macro.Prueba\" and works! :D</p>\n"}, {"tags": ["forms", "vba", "audio"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1449072851, "post_id": 34046933, "comment_id": 55849696, "body": "You have to play the sound asynchronously. What is the code of your sndWarning function?"}, {"owner": {"reputation": 87, "user_id": 4815261, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3f53a5ae2385631944717152a7adeb4c?s=128&d=identicon&r=PG&f=1", "display_name": "FormaInnova Cursos", "link": "https://stackoverflow.com/users/4815261/formainnova-cursos"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1449127504, "post_id": 34046933, "comment_id": 55873675, "body": "<code>sndPlaySound32 &quot;C:\\Plantillas Word\\error.wav&quot;, 0&amp;</code>      Called from    <code>Public Declare Function sndPlaySound32 Lib &quot;winmm.dll&quot; Alias &quot;sndPlaySoundA&quot; ( _     ByVal lpszSoundName As String, ByVal uFlags As Long) As Long</code>"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1449130134, "post_id": 34046933, "comment_id": 55874927, "body": "Change the second parameter from 0&amp; (which means synchronous) to 1&amp; (async). See <a href=\"http://www.cpearson.com/excel/PlaySound.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/PlaySound.aspx</a> for others values available."}], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 4815261, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3f53a5ae2385631944717152a7adeb4c?s=128&d=identicon&r=PG&f=1", "display_name": "FormaInnova Cursos", "link": "https://stackoverflow.com/users/4815261/formainnova-cursos"}, "is_accepted": false, "score": 0, "last_activity_date": 1449145071, "creation_date": 1449145071, "answer_id": 34065892, "question_id": 34046933, "link": "https://stackoverflow.com/questions/34046933/run-a-vba-macro-when-loading-a-from/34065892#34065892", "title": "Run a VBA macro when loading a from", "body": "<p>As told by @Vincent, changing the  second parameter sovles the question. Thanks dude</p>\n"}], "owner": {"reputation": 87, "user_id": 4815261, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3f53a5ae2385631944717152a7adeb4c?s=128&d=identicon&r=PG&f=1", "display_name": "FormaInnova Cursos", "link": "https://stackoverflow.com/users/4815261/formainnova-cursos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449145071, "creation_date": 1449071184, "last_edit_date": 1449071525, "question_id": 34046933, "link": "https://stackoverflow.com/questions/34046933/run-a-vba-macro-when-loading-a-from", "title": "Run a VBA macro when loading a from", "body": "<p>I'tm trying to do something a little simple, but it's happening something i don't know how to fix.\nI have a form in VBA and i wanna play a sound when loading it (it's a custom error window). I'm trying with the following event:</p>\n\n<pre><code>Private Sub UserForm_Activate()\n    sndWarning\nEnd Sub\n</code></pre>\n\n<p>It plays the sound, but when playing, form becomes empty until sound finish. What am I missing?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1449069925, "post_id": 34046154, "comment_id": 55847507, "body": "If you first create <code>TempPayments</code> with all text fields, you can then use <code>TransferText</code> to import the data and the field types will remain text."}], "answers": [{"comments": [{"owner": {"reputation": 475, "user_id": 5045189, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/1df4ba32255405d1d48b9f73fe3a6cdc?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Kreifels II", "link": "https://stackoverflow.com/users/5045189/joseph-kreifels-ii"}, "edited": false, "score": 0, "creation_date": 1449070523, "post_id": 34046432, "comment_id": 55847990, "body": "Okay. Guess I&#39;ll use Specs. Thanks"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 1, "last_activity_date": 1449069841, "creation_date": 1449069841, "answer_id": 34046432, "question_id": 34046154, "link": "https://stackoverflow.com/questions/34046154/stop-access-from-auto-assigning-datatypes/34046432#34046432", "title": "Stop Access from Auto assigning Datatypes", "body": "<p>No.</p>\n\n<p>Really, there's nothing more to say. Just use an import specification.</p>\n"}, {"comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1449077513, "post_id": 34049051, "comment_id": 55853051, "body": "If you use <code>HasFieldNames = False</code>, Access will assign its own names to the source fields, such as <code>F1</code> for the first field, etc.  So you will need to create matching field names in the destination table in order to avoid complaints like <i>&quot;Field &#39;F1&#39; doesn&#39;t exist in destination table ...&quot;</i>."}, {"owner": {"reputation": 1262, "user_id": 1680712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f58684b74f0abaed8824df29ae8c232?s=128&d=identicon&r=PG", "display_name": "AVG", "link": "https://stackoverflow.com/users/1680712/avg"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1449091716, "post_id": 34049051, "comment_id": 55860970, "body": "You are correct. I typically use a temp table with field names F1, F2... That also allows me to check that the import file has the field names that are expected."}], "tags": [], "owner": {"reputation": 1262, "user_id": 1680712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f58684b74f0abaed8824df29ae8c232?s=128&d=identicon&r=PG", "display_name": "AVG", "link": "https://stackoverflow.com/users/1680712/avg"}, "is_accepted": false, "score": 1, "last_activity_date": 1449091529, "last_edit_date": 1449091529, "creation_date": 1449076941, "answer_id": 34049051, "question_id": 34046154, "link": "https://stackoverflow.com/questions/34046154/stop-access-from-auto-assigning-datatypes/34049051#34049051", "title": "Stop Access from Auto assigning Datatypes", "body": "<p>Create your own temp table ahead of time with all text fields, plus an autonumber ID. Then import your file into that table with HasFieldNames = False. You can then delete the first row (the field names), validate/massage the data any way you like and then append it wherever it needs to go.\nEdit: You'll need to name the fields in the temp table F1, F2, F3,...</p>\n"}], "owner": {"reputation": 475, "user_id": 5045189, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/1df4ba32255405d1d48b9f73fe3a6cdc?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Kreifels II", "link": "https://stackoverflow.com/users/5045189/joseph-kreifels-ii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1449091529, "creation_date": 1449069091, "question_id": 34046154, "link": "https://stackoverflow.com/questions/34046154/stop-access-from-auto-assigning-datatypes", "title": "Stop Access from Auto assigning Datatypes", "body": "<p>First of all, I know the easiest thing to do is define a specification, however, I'd like to make this simple eliminated the need for a spec.</p>\n\n<p>I'm using something as simple as</p>\n\n<pre><code>DoCmd.TransferText acImportDelim, , \"TempPayments\", theSource, True\n</code></pre>\n\n<p>When I do this, I get my temp table and it has predefined datatypes. This is horrible because Microsfot seems to think the \"USD\" is a long int and not a double. They also assume the values for \"Year\", \"Month\", and \"Day\" are long ints.</p>\n\n<p>I want everything to come in as \"Short Text\". Can I do this without using a spec?</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5630846, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SnNo1.jpg?s=128&g=1", "display_name": "Kinda", "link": "https://stackoverflow.com/users/5630846/kinda"}, "edited": false, "score": 0, "creation_date": 1449076510, "post_id": 34048248, "comment_id": 55852387, "body": "Thank you for that. It works but only if i&#39;m on the first slide plus, it deletes also a textbox.  Wouldn&#39;t it be possible to do sth. like Shp1 .Delete and repeat that for all the other shapes too? :)"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1449077795, "post_id": 34048248, "comment_id": 55853221, "body": "If you set a reference to Shp1 then Shp1.Delete will work.  W/o seeing the code you&#39;re using, it&#39;s hard to say how to fix it, though.  You could, when creating the shape, give it a name then later Slides(x).Shapes(&quot;YourShapeName&quot;).Delete (where x is the index of the slide you want to work with)"}, {"owner": {"reputation": 3, "user_id": 5630846, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SnNo1.jpg?s=128&g=1", "display_name": "Kinda", "link": "https://stackoverflow.com/users/5630846/kinda"}, "edited": false, "score": 0, "creation_date": 1449135233, "post_id": 34048248, "comment_id": 55877827, "body": "Thank you. Well, the the code just looks horrible. I&#39;m not really a programmer :) The idea behind this macro is, to display the color values that should be used in a ppt and I thought it could be nice to toggle these colors on and off - no matter in which slide you are. I will post the code I have above.."}], "tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": true, "score": 0, "last_activity_date": 1449074698, "creation_date": 1449074698, "answer_id": 34048248, "question_id": 34046108, "link": "https://stackoverflow.com/questions/34046108/vba-delete-specific-shapes/34048248#34048248", "title": "VBA delete specific shapes", "body": "<p>To delete shapes in a collection, you need to count backwards so this example shows how to delete all shapes from slide 1 of the active presentation:</p>\n\n<pre><code>Dim iCounter As Integer\nFor iCounter = ActivePresentation.Slides(1).Shapes.Count to 1 Step -1\n  ActivePresentation.Slides(1).Shapes(iCounter).Delete\nNext\n</code></pre>\n\n<p>You can of course add checks to decide which type/name of shape is to be deleted.</p>\n\n<p>Next, if you want to use the macro in an add-in in PowerPoint:mac 2011, save it as a .ppam file and then load it using <strong>Tools</strong>/<strong>Add-Ins...</strong> You might also want to add a menu to be able to access the features of your add-in and you'll need to use <strong>CommandBars</strong> for that on PowerPoint:mac 2011 This will get you started:</p>\n\n<pre><code>Dim oMenuBar\nDim oMenu As CommandBarPopup\nDim oCtrl As CommandBarControl\nDim iTools As Integer\n\n' Get the position of the native PowerPoint tools menu (English only)\niTools = Application.CommandBars.ActiveMenuBar.Controls(\"Tools\").Index\n\n' Create a new menu\nSet oMenuBar = Application.CommandBars.ActiveMenuBar\nSet oMenu = oMenuBar.Controls.Add(type:=msoControlPopup, Before:=iTools, Temporary:=True)\nWith oMenu\n  .Caption = \"My Menu\"\n  .Enabled = True\nEnd With\n\n' Add a control\nSet oCtrl = oMenu.Controls.Add(type:=msoControlButton)\nWith oCtrl\n  .Caption = \"My Tool\"\n  .OnAction = \"MyMacro\"\nEnd With\n</code></pre>\n\n<p>If this helps, please vote for the solution :-)</p>\n"}], "owner": {"reputation": 3, "user_id": 5630846, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SnNo1.jpg?s=128&g=1", "display_name": "Kinda", "link": "https://stackoverflow.com/users/5630846/kinda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4046, "favorite_count": 1, "accepted_answer_id": 34048248, "answer_count": 1, "score": 0, "last_activity_date": 1495198705, "creation_date": 1449068969, "last_edit_date": 1449135854, "question_id": 34046108, "link": "https://stackoverflow.com/questions/34046108/vba-delete-specific-shapes", "title": "VBA delete specific shapes", "body": "<p>I made a VBA macro for MS powerpoint 2011 on Mac. I'm really not into VBA but managed somehow to let 12 shapes appear on the screen with text but I basically took this here as a starting point. My modifications are probably not the best way to do this but it does the job.</p>\n\n<p>But now I would like to create another macro which lets the shapes, named from <code>Dim Shp As Shape</code> to <code>Dim Shp11 As Shape</code>, disappear or delete once the macro was executed. I tried a lot of things but always got errors. Some help here is highly appreciated..</p>\n\n<p>I was also not able to find out how I can make an Add-In out of a macro in MS PowerPoint 2011 for Mac. Does someone perhaps have an idea? </p>\n\n<p>Thank you so much!</p>\n\n<p><strong><em>Clarification:</em></strong></p>\n\n<p>The idea behind this macro is, to display the color values that should be used in a ppt and I thought it could be nice to toggle these colors on and off - no matter in which slide you are.</p>\n\n<p>So, again: The code looks horrible but i'm not a big programmer ;)</p>\n\n<pre><code>Sub show_ci_colors()\n\n'PURPOSE:Create a Text Box Shape and Reformat it\n'SOURCE: www.TheSpreadsheetGuru.com\n\nDim Sld As Slide\nDim Shp As Shape\nDim Shp1 As Shape\nDim Shp2 As Shape\nDim Shp3 As Shape\nDim Shp4 As Shape\nDim Shp5 As Shape\nDim Shp6 As Shape\nDim Shp7 As Shape\nDim Shp8 As Shape\nDim Shp9 As Shape\nDim Shp10 As Shape\nDim Shp11 As Shape\n\n'ERROR HANDLING\nIf ActivePresentation.Slides.Count = 0 Then\n    MsgBox \"You do not have any slides in your PowerPoint project.\"\n    Exit Sub\nEnd If\n\nSet Sld = Application.ActiveWindow.View.Slide\n\n'Create shape with Specified Dimensions and Slide Position\n    Set Shp = Sld.Shapes.AddShape(Type:=msoShapeRectangle, _\n    Left:=-80, Top:=20, Width:=60, Height:=40)\n\n    Set Shp1 = Sld.Shapes.AddShape(Type:=msoShapeRectangle, _\n    Left:=-80, Top:=62, Width:=60, Height:=40)\n\n    Set Shp2 = Sld.Shapes.AddShape(Type:=msoShapeRectangle, _\n    Left:=-80, Top:=104, Width:=60, Height:=40)\n\n    Set Shp3 = Sld.Shapes.AddShape(Type:=msoShapeRectangle, _\n    Left:=-80, Top:=146, Width:=60, Height:=40)\n\n    Set Shp4 = Sld.Shapes.AddShape(Type:=msoShapeRectangle, _\n    Left:=-80, Top:=186, Width:=60, Height:=40)\n\n    Set Shp5 = Sld.Shapes.AddShape(Type:=msoShapeRectangle, _\n    Left:=-80, Top:=230, Width:=60, Height:=40)\n\n    Set Shp6 = Sld.Shapes.AddShape(Type:=msoShapeRectangle, _\n    Left:=-80, Top:=272, Width:=60, Height:=40)\n\n    Set Shp7 = Sld.Shapes.AddShape(Type:=msoShapeRectangle, _\n    Left:=-80, Top:=314, Width:=60, Height:=40)\n\n    Set Shp8 = Sld.Shapes.AddShape(Type:=msoShapeRectangle, _\n    Left:=-80, Top:=356, Width:=60, Height:=40)\n\n    Set Shp9 = Sld.Shapes.AddShape(Type:=msoShapeRectangle, _\n    Left:=-80, Top:=398, Width:=60, Height:=40)\n\n    Set Shp10 = Sld.Shapes.AddShape(Type:=msoShapeRectangle, _\n    Left:=-80, Top:=440, Width:=60, Height:=40)\n\n    Set Shp11 = Sld.Shapes.AddShape(Type:=msoShapeRectangle, _\n    Left:=-80, Top:=482, Width:=60, Height:=40)\n\n\n\n'FORMAT SHAPE\n 'Shape Name\n    Shp.Name = \"My Header\"\n\n'No Shape Border\n    Shp.Line.Visible = msoFalse\n    Shp.Shadow.Visible = msoFalse\n    Shp1.Line.Visible = msoFalse\n    Shp1.Shadow.Visible = msoFalse\n    Shp2.Line.Visible = msoFalse\n    Shp2.Shadow.Visible = msoFalse\n    Shp3.Line.Visible = msoFalse\n    Shp3.Shadow.Visible = msoFalse\n    Shp4.Line.Visible = msoFalse\n    Shp4.Shadow.Visible = msoFalse\n    Shp5.Line.Visible = msoFalse\n    Shp5.Shadow.Visible = msoFalse\n    Shp6.Line.Visible = msoFalse\n    Shp6.Shadow.Visible = msoFalse\n    Shp7.Line.Visible = msoFalse\n    Shp7.Shadow.Visible = msoFalse\n    Shp8.Line.Visible = msoFalse\n    Shp8.Shadow.Visible = msoFalse\n    Shp9.Line.Visible = msoFalse\n    Shp9.Shadow.Visible = msoFalse\n    Shp10.Line.Visible = msoFalse\n    Shp10.Shadow.Visible = msoFalse\n    Shp11.Line.Visible = msoFalse\n    Shp11.Shadow.Visible = msoFalse\n\n'Shape Fill Color\n    Shp.Fill.ForeColor.RGB = RGB(4, 110, 151)                   'BLUE 700\n    Shp.Fill.BackColor.RGB = RGB(4, 110, 151)                   'BLUE 700\n\n    Shp1.Fill.ForeColor.RGB = RGB(6, 166, 227)                  'BLUE 300\n    Shp1.Fill.BackColor.RGB = RGB(6, 166, 227)                  'BLUE 300\n\n    Shp2.Fill.ForeColor.RGB = RGB(133, 199, 226)               'BLUE 100\n    Shp2.Fill.BackColor.RGB = RGB(133, 199, 226)                'BLUE 100\n\n    Shp3.Fill.ForeColor.RGB = RGB(23, 152, 131)                 'GREEN\n    Shp3.Fill.BackColor.RGB = RGB(23, 152, 131)                 'GREEN\n\n    Shp4.Fill.ForeColor.RGB = RGB(254, 201, 5)                     'YELLOW\n    Shp4.Fill.BackColor.RGB = RGB(254, 201, 5)                     'YELLOW\n\n    Shp5.Fill.ForeColor.RGB = RGB(189, 57, 47)    'RED 700\n    Shp5.Fill.BackColor.RGB = RGB(189, 57, 47)    'RED 700\n\n    Shp6.Fill.ForeColor.RGB = RGB(225, 92, 80)   'RED 300\n    Shp6.Fill.BackColor.RGB = RGB(225, 92, 80)   'RED 300\n\n    Shp7.Fill.ForeColor.RGB = RGB(237, 140, 52)   'ORANGE\n    Shp7.Fill.BackColor.RGB = RGB(237, 140, 52)   'ORANGE\n\n    Shp8.Fill.ForeColor.RGB = RGB(64, 64, 64)   'GREY 700\n    Shp8.Fill.BackColor.RGB = RGB(64, 64, 64)   'GREY 700\n\n    Shp9.Fill.ForeColor.RGB = RGB(84, 84, 84)   'GREY 600\n    Shp9.Fill.BackColor.RGB = RGB(84, 84, 84)   'GREY 600\n\n    Shp10.Fill.ForeColor.RGB = RGB(189, 189, 198)   'GREY 300\n    Shp10.Fill.BackColor.RGB = RGB(189, 189, 198)   'GREY 300\n\n    Shp10.Fill.ForeColor.RGB = RGB(189, 189, 198)   'GREY 300\n    Shp10.Fill.BackColor.RGB = RGB(189, 189, 198)   'GREY 300\n\n    Shp11.Fill.ForeColor.RGB = RGB(238, 238, 238)   'GREY 200\n    Shp11.Fill.BackColor.RGB = RGB(238, 238, 238)   'GREY 200\n\n\n'Shape Text Color\n    Shp.TextFrame.TextRange.Font.Color.RGB = RGB(255, 255, 255)\n    Shp11.TextFrame.TextRange.Font.Color.RGB = RGB(64, 65, 65)\n\n'Text inside Shape\n    Shp.TextFrame.TextRange.Characters.Text = \"Blue 700\" &amp; Chr(10) &amp; \"4 / 110 / 151\"\n    Shp1.TextFrame.TextRange.Characters.Text = \"Blue 300\" &amp; Chr(10) &amp; \"6 / 166 / 227\"\n    Shp2.TextFrame.TextRange.Characters.Text = \"Blue 100 \" &amp; Chr(10) &amp; \"133 / 199 / 226\"\n    Shp3.TextFrame.TextRange.Characters.Text = \"Green\" &amp; Chr(10) &amp; \"23 / 152 /131\"\n    Shp4.TextFrame.TextRange.Characters.Text = \"Yellow\" &amp; Chr(10) &amp; \"254 / 201 / 5\"\n    Shp5.TextFrame.TextRange.Characters.Text = \"Red 700\" &amp; Chr(10) &amp; \"189 / 57 / 47\"\n    Shp6.TextFrame.TextRange.Characters.Text = \"Red 300\" &amp; Chr(10) &amp; \"225 / 92 / 80\"\n    Shp7.TextFrame.TextRange.Characters.Text = \"Orange\" &amp; Chr(10) &amp; \"237 / 140 52\"\n    Shp8.TextFrame.TextRange.Characters.Text = \"Grey 700\" &amp; Chr(10) &amp; \"64 / 65 / 65\"\n    Shp9.TextFrame.TextRange.Characters.Text = \"Grey 600\" &amp; Chr(10) &amp; \"84 / 84 / 84\"\n    Shp10.TextFrame.TextRange.Characters.Text = \"Grey 300\" &amp; Chr(10) &amp; \"189 / 189 / 189\"\n    Shp11.TextFrame.TextRange.Characters.Text = \"Grey 200\" &amp; Chr(10) &amp; \"238 / 238 / 238\"\n\n\n'Center Align Text\n    Shp.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = msoAlignCenter\n    Shp1.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = msoAlignCenter\n    Shp2.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = msoAlignCenter\n    Shp3.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = msoAlignCenter\n    Shp4.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = msoAlignCenter\n    Shp5.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = msoAlignCenter\n    Shp6.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = msoAlignCenter\n    Shp7.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = msoAlignCenter\n    Shp8.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = msoAlignCenter\n    Shp9.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = msoAlignCenter\n    Shp10.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = msoAlignCenter\n    Shp11.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = msoAlignCenter\n\n'Vertically Align Text to Middle\n    'Shp.TextFrame.VerticalAnchor = msoAnchorMiddle\n\n'Adjust Font Size\n    Shp.TextFrame.TextRange.Font.Size = 8\n    Shp1.TextFrame.TextRange.Font.Size = 8\n    Shp2.TextFrame.TextRange.Font.Size = 8\n    Shp3.TextFrame.TextRange.Font.Size = 8\n    Shp4.TextFrame.TextRange.Font.Size = 8\n    Shp5.TextFrame.TextRange.Font.Size = 8\n    Shp6.TextFrame.TextRange.Font.Size = 8\n    Shp7.TextFrame.TextRange.Font.Size = 8\n    Shp8.TextFrame.TextRange.Font.Size = 8\n    Shp9.TextFrame.TextRange.Font.Size = 8\n    Shp10.TextFrame.TextRange.Font.Size = 8\n    Shp11.TextFrame.TextRange.Font.Size = 8\n\n\n'FONT STYLE DELETED\n'Adjust Font Style\n' Shp.TextFrame.TextRange.Font.Name = \"Verdana\"L\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1449070299, "post_id": 34046066, "comment_id": 55847823, "body": "It will be very difficult to get this working if there is a solution to this at all. However, it seems you prefer doing something with the document on the server anyway. Can you describe what actually should happen with the document?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1449072769, "post_id": 34046066, "comment_id": 55849640, "body": "FWIW it&#39;s not possible to pass parameters to a macro via command line. What you could do is write the information somewhere that the macro can then access. A webservice would be logical, but VBA would require a reference to a library in order to use it since that functionality is not built into VBA."}, {"owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "edited": false, "score": 0, "creation_date": 1449488196, "post_id": 34046066, "comment_id": 56012835, "body": "Thanks, I am trying to create a textfile and then read this textfile on word_open command, if no text file exits then just proceed as normal."}], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1594054536, "creation_date": 1449068867, "last_edit_date": 1594054536, "question_id": 34046066, "link": "https://stackoverflow.com/questions/34046066/run-specific-macro-in-word-by-using-hyperlink-from-a-webpage", "title": "Run specific macro in word by using hyperlink from a webpage", "body": "<p>Due to server rights I can not access the word object and can only starts word on the client by hyperlinking in asp, such as: </p>\n\n<pre><code>file:///Z:/Prosjekt/32637/LS_32637_PR_01_A.docm\n</code></pre>\n\n<p>However I would like to run a spefic macros with parameters, can I somehow do this?</p>\n\n<pre><code>file:///Z:/Prosjekt/32637/LS_32637_PR_01_A.docm?NewFile.NewFile,1,\"Test\"\n</code></pre>\n\n<p>Maybe it is possible to write an on open event that parses the <code>NewFile,1,\"Test\"</code> to call <code>NewFile.newFile(1,\"test\")</code></p>\n\n<p>But I am not sure how to do so. Any hint on how to solve it would be great. </p>\n"}, {"tags": ["vba", "stl", "catia"], "answers": [{"comments": [{"owner": {"reputation": 1060, "user_id": 615243, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aff09be09611bb9949fb8ac3022e91d0?s=128&d=identicon&r=PG&f=1", "display_name": "Nic", "link": "https://stackoverflow.com/users/615243/nic"}, "edited": false, "score": 0, "creation_date": 1449080681, "post_id": 34049565, "comment_id": 55854882, "body": "Thanks @Sree Harska . Therefore, I should export each CATBody in a separate CATPart and save it as STL. This takes quite some time as &quot;CATIA.Documents.Open(objFile.path)&quot; graphically loads the model. Is there a way to prevent opening the CATPart but still manipulate it?"}, {"owner": {"reputation": 98, "user_id": 5417613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/817ea4fba7c8b308d2328bdab498233f?s=128&d=identicon&r=PG&f=1", "display_name": "Sree Harsha", "link": "https://stackoverflow.com/users/5417613/sree-harsha"}, "reply_to_user": {"reputation": 1060, "user_id": 615243, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aff09be09611bb9949fb8ac3022e91d0?s=128&d=identicon&r=PG&f=1", "display_name": "Nic", "link": "https://stackoverflow.com/users/615243/nic"}, "edited": false, "score": 1, "creation_date": 1449139531, "post_id": 34049565, "comment_id": 55880837, "body": "you can start catia in batch mode by supplying &quot;-nowindow&quot; as command line argument. It will be much faster we once wrote a CATMacro that reads hundreds of CATProducts in a folder and identifies broken links There is significant reduction of time if we launch CATIA in batch mode with &quot;-nowindow&quot; and supply macro name that has to be executed"}], "tags": [], "owner": {"reputation": 98, "user_id": 5417613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/817ea4fba7c8b308d2328bdab498233f?s=128&d=identicon&r=PG&f=1", "display_name": "Sree Harsha", "link": "https://stackoverflow.com/users/5417613/sree-harsha"}, "is_accepted": true, "score": 1, "last_activity_date": 1449078535, "creation_date": 1449078535, "answer_id": 34049565, "question_id": 34045847, "link": "https://stackoverflow.com/questions/34045847/export-single-catia-body-from-catpart-as-stl-using-vba-macro/34049565#34049565", "title": "Export single CATIA body from CATPart as stl using VBA macro", "body": "<p>Catia V5 is capable of creating STL files from parts (CatiaPART files), but not from assemblies (CatiaPRODUCT files) or geometrical representations (car files). Therefore, source files, including those saved in a neutral format (STEP or IGES, for example), must be saved as parts. If the source design was saved as an assembly, it is imported to Catia as a product. - </p>\n\n<p>Source : <a href=\"http://www.stratasys.com/customer-support/cad-to-stl/catia\" rel=\"nofollow\">http://www.stratasys.com/customer-support/cad-to-stl/catia</a></p>\n\n<p>I tried exporting CATBody but was unsuccessful. We must have a CATPart to generate STL</p>\n"}], "owner": {"reputation": 1060, "user_id": 615243, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aff09be09611bb9949fb8ac3022e91d0?s=128&d=identicon&r=PG&f=1", "display_name": "Nic", "link": "https://stackoverflow.com/users/615243/nic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2971, "favorite_count": 0, "accepted_answer_id": 34049565, "answer_count": 1, "score": 0, "last_activity_date": 1449078535, "creation_date": 1449068278, "last_edit_date": 1449069839, "question_id": 34045847, "link": "https://stackoverflow.com/questions/34045847/export-single-catia-body-from-catpart-as-stl-using-vba-macro", "title": "Export single CATIA body from CATPart as stl using VBA macro", "body": "<p>Is it possible to export a single CATIA body as STL without creating a separate part with it?</p>\n\n<p>For the time being, I have coded a script which loops through the CATParts present in a folder, fetches the contained bodies and create a single CATPart with each of them and export into stl format.</p>\n\n<pre><code>    Dim output_stl_path_HD As String\n    Dim output_stl_path_MD As String\n    Dim output_stl_path_SD As String\n    Dim output_stl_path_via_points As String\n    Dim output_transformations_path As String\n    Dim input_path As String\n\n    Sub CATMain()\n    'Path for output file\n\n\n    input_path = CATIA.ActiveDocument.path + \"\\\"\n\n\n    Dim it As Integer\n    Dim prod As Product\n    Dim t_p_ref(11)\n\n    'List of part names to export\n    Dim list As Collection\n    Set list = New Collection\n\n\n    'GET LIST OF CATPART IN FOLDER\n    Dim objFSO As Object\n    Dim objFolder As Object\n    Dim objFile As Object\n    Dim i As Integer\n\n    'Create an instance of the FileSystemObject\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    'Get the folder object\n    Set objFolder = objFSO.GetFolder(input_path)\n    i = 1\n    'loops through each file in the directory and prints their names and path\n    For Each objFile In objFolder.Files\n\n        'print file name\n        If (InStr(objFile.path, \".CATPart\")) Then\n\n            list.Add (objFile.name)\n\n    '        Set objDocument = CATIA.Documents.Open(objFile.path)\n\n            Dim srcDoc As PartDocument\n            Set srcDoc = CATIA.Documents.Open(objFile.path)\n            Dim srcPart As Part\n            Set srcPart = srcDoc.Part\n\n            Dim oSel As Selection\n            Dim bodies1 As Bodies\n            Dim body1 As body\n    '\n            Set bodies1 = srcPart.Bodies\n\n            For Each single_body In srcPart.Bodies\n                A = exportStl(single_body)\n            Next\n            Set body1 = srcPart.Bodies.Item(i)\n\n    'Dim BoxProduct\n    'BoxProduct = MsgBox(\"Quantity of the bodies found:\" &amp; srcDoc.Part.Bodies.Count &amp; \"\", 64)\n\n        End If\n    Next\n\n    End Sub\n\n\n\n    Public Function exportStl(ByVal myBody As body)\n        Dim oSrc As Part\n        Dim oTgt As Part\n        Dim oSrcDoc As PartDocument\n        Dim oTgtDoc As PartDocument\n        Dim oBod As body\n        Dim oSel As Selection\n\n        'Sets documents for Source and Target files\n        Set oSrcDoc = CATIA.ActiveDocument\n        Set oTgtDoc = CATIA.Documents.Add(\"Part\")\n        oTgtDoc.Product.PartNumber = myBody.name\n\n\n\n\n        'Gets Body to copy\n        Set oSrc = oSrcDoc.Part\n        Set oTgt = oTgtDoc.Part\n        Set oBod = myBody\n        Set oSel = oSrcDoc.Selection\n\n        'Copies Body\n        oSel.Add oBod\n        oSel.Copy\n        Set oSel = oTgtDoc.Selection\n\n        'Sets and Pastes in Target file as result with link\n        oSel.Clear\n        oSel.Add oTgt.Bodies.Item(1)\n        oSel.Paste\n        oSrcDoc.Selection.Clear\n\n\n         CATIA.ActiveDocument.ExportData input_path + myBody.name, \"stl\"\n\n         CATIA.ActiveDocument.Close\n\n\n    End Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 2, "creation_date": 1449067699, "post_id": 34045544, "comment_id": 55845745, "body": "When you cut and paste, it should remove the row, so your iteration won&#39;t work well. Try your loop with <code>step -1</code>"}, {"owner": {"reputation": 780, "user_id": 2574177, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ab4240eecd1b7857e327cd47909398b4?s=128&d=identicon&r=PG", "display_name": "bmgh1985", "link": "https://stackoverflow.com/users/2574177/bmgh1985"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 1, "creation_date": 1449068710, "post_id": 34045544, "comment_id": 55846566, "body": "Also swap round your <code>i</code> values <code>For i = endrow To 2 Step -1</code>. As @Raystafarian suggests, the row gets deleted, meaning the next row (which would become <code>i</code> next) actually moves to your current <code>i</code> value, meaning it will get missed."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1449073351, "post_id": 34045544, "comment_id": 55850067, "body": "As everyone else said - you need to work backwards through the sheet. <b>Also</b> cutting a value won&#39;t delete the cell - it will leave a blank cell (try doing it manually).  After you&#39;ve made the cut delete the row - <code>ws1.Cells(i, &quot;M&quot;).EntireRow.Delete Shift:=xlUp</code>"}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1449073898, "creation_date": 1449073898, "answer_id": 34047935, "question_id": 34045544, "link": "https://stackoverflow.com/questions/34045544/vba-cut-and-past-function-without-any-blank-row/34047935#34047935", "title": "vba cut and past function without any blank row", "body": "<p>This will do the trick:</p>\n\n<pre><code>Sub Test()\n    Dim i As Long\n    Dim endrow As Long\n\n    'Added this code to get it working on my test file.\n    Dim ws1 As Worksheet\n    Dim ws2 As Worksheet\n    Dim str As String\n    Dim lastrow As Long\n    Set ws1 = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set ws2 = ThisWorkbook.Worksheets(\"Sheet2\")\n    str = \"DELETE THIS ROW\"\n    lastrow = 30\n    ''''''''''''''''''''''\n\n    endrow = ws1.Range(\"A\" &amp; ws1.Rows.Count).End(xlUp).Row\n    For i = endrow To 2 Step -1\n    If ws1.Cells(i, \"M\").Value = str Then\n        ws1.Cells(i, \"M\").EntireRow.Cut Destination:=ws2.Range(\"A\" &amp; lastrow).End(xlUp).Offset(1)\n        ws1.Cells(i, \"M\").EntireRow.Delete Shift:=xlUp\n    End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 5103111, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/81d8854c847ac9a8976f5edd04294387?s=128&d=identicon&r=PG&f=1", "display_name": "Gaus Shaikh", "link": "https://stackoverflow.com/users/5103111/gaus-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 298, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1449073898, "creation_date": 1449067377, "last_edit_date": 1531164843, "question_id": 34045544, "link": "https://stackoverflow.com/questions/34045544/vba-cut-and-past-function-without-any-blank-row", "title": "vba cut and past function without any blank row", "body": "<p>Please advise as to what is wrong in my below coding. I am able to cut and past the row but after that i can see blank row in my sheet. How can we automatically adjust the row.</p>\n\n<p>After cut and past there should not be any blank row in original sheet.</p>\n\n<pre><code>Dim i As Variant\nendrow = ws1.Range(\"A\" &amp; ws1.Rows.Count).End(xlUp).Row\nFor i = 2 To endrow\nIf ws1.Cells(i, \"M\").Value = str Then\nws1.Cells(i, \"M\").EntireRow.Cut Destination:=ws2.Range(\"A\" &amp; LastRow + ).EndxlUp).Offset(1)\nEnd If\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 3, "creation_date": 1449067734, "post_id": 34045479, "comment_id": 55845784, "body": "You can&#39;t hide just one cell. That would create a black-hole in your spreadsheet, opening it to the dark side. May the force be with you."}, {"owner": {"reputation": 531, "user_id": 4244864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/erHT8.jpg?s=128&g=1", "display_name": "bilbo_strikes_back", "link": "https://stackoverflow.com/users/4244864/bilbo-strikes-back"}, "edited": false, "score": 1, "creation_date": 1449068056, "post_id": 34045479, "comment_id": 55846047, "body": "You could change the font color to white to change the visibility."}, {"owner": {"reputation": 609, "user_id": 1742962, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/aRDMd.gif?s=128&g=1", "display_name": "frostbite", "link": "https://stackoverflow.com/users/1742962/frostbite"}, "reply_to_user": {"reputation": 531, "user_id": 4244864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/erHT8.jpg?s=128&g=1", "display_name": "bilbo_strikes_back", "link": "https://stackoverflow.com/users/4244864/bilbo-strikes-back"}, "edited": false, "score": 1, "creation_date": 1449068249, "post_id": 34045479, "comment_id": 55846212, "body": "Thanks.iDevelop and @Jason_Walker. The white knight (space) came to my rescue"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1449068546, "post_id": 34045479, "comment_id": 55846439, "body": "You can also use <code>Format Cell &#47; Protection &#47; Hidden</code> which prevents the formula or data to appear in the edit bar when you click in the cell. But that only works while you activate sheet protection, young padawan."}, {"owner": {"reputation": 609, "user_id": 1742962, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/aRDMd.gif?s=128&g=1", "display_name": "frostbite", "link": "https://stackoverflow.com/users/1742962/frostbite"}, "edited": false, "score": 0, "creation_date": 1449090203, "post_id": 34045479, "comment_id": 55860121, "body": "@iDevelop thanks again. Padawan yes, young I wish :)"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1449067940, "creation_date": 1449067940, "answer_id": 34045742, "question_id": 34045479, "link": "https://stackoverflow.com/questions/34045479/hide-specific-cells-in-a-row-in-vba-excel/34045742#34045742", "title": "Hide specific cells in a row in VBA excel", "body": "<p>If you want to to hide a <strong>single cell</strong> and do not want to hide the entire row, then hide the column.</p>\n"}, {"tags": [], "owner": {"reputation": 609, "user_id": 1742962, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/aRDMd.gif?s=128&g=1", "display_name": "frostbite", "link": "https://stackoverflow.com/users/1742962/frostbite"}, "is_accepted": true, "score": 0, "last_activity_date": 1509075728, "creation_date": 1509075728, "answer_id": 46967165, "question_id": 34045479, "link": "https://stackoverflow.com/questions/34045479/hide-specific-cells-in-a-row-in-vba-excel/46967165#46967165", "title": "Hide specific cells in a row in VBA excel", "body": "<p>As suggested by @Jason_Walker and Patrick Honorez.\nHide only works on columns and rows.\nI changed the font color to match the fill to 'hide' the cell.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15566518, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9d6324864314cd1921dd8f9ab55227d1?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/15566518/james"}, "is_accepted": false, "score": 0, "last_activity_date": 1617721011, "creation_date": 1617721011, "answer_id": 66971108, "question_id": 34045479, "link": "https://stackoverflow.com/questions/34045479/hide-specific-cells-in-a-row-in-vba-excel/66971108#66971108", "title": "Hide specific cells in a row in VBA excel", "body": "<p>As bilbo_strikes_back said &quot;You can't hide just one cell. You could change the font color to white to change the visibility</p>\n<p>If Range(&quot;A16&quot;) = &quot;&quot; Then</p>\n<pre><code>Range(&quot;B16:I16&quot;).Font.Color = vbWhite\n</code></pre>\n<p>Else</p>\n<pre><code>Range(&quot;B16:I16&quot;).Font.Color = vbBlack\n</code></pre>\n<p>End If</p>\n"}], "owner": {"reputation": 609, "user_id": 1742962, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/aRDMd.gif?s=128&g=1", "display_name": "frostbite", "link": "https://stackoverflow.com/users/1742962/frostbite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11031, "favorite_count": 0, "accepted_answer_id": 46967165, "answer_count": 3, "score": 0, "last_activity_date": 1617721011, "creation_date": 1449067220, "question_id": 34045479, "link": "https://stackoverflow.com/questions/34045479/hide-specific-cells-in-a-row-in-vba-excel", "title": "Hide specific cells in a row in VBA excel", "body": "<p>I see Hidden is an \"EntireRow\" attribute. Is there a way to hide just one cell in a row. My attempts so far have resulted in exceptions.\n\"Unable to set hidden property of Range class\"</p>\n\n<pre><code>Range(\"A23\").Hidden = false 'fails\nRange(\"A23\").EntireRow.Hidden = false 'Hides entire row, not what I want\n</code></pre>\n"}, {"tags": ["excel", "charts", "series", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449067840, "post_id": 34045406, "comment_id": 55845860, "body": "AFAIK, the chart points <code>(Value 12)</code> and data labels <code>(Europe)</code> are all <code>index</code> (by number) based and can only be referred to in VBA by their index number. That said, if you wanted to apply formatting or other conditions based on the label or value, you could loop each label / value and test against it&#39;s value before setting the condition. In some cases, I&#39;ve found it necessary to loop through the actual range that plots the data and test my conditions on that."}, {"owner": {"reputation": 713, "user_id": 2830928, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4becdee202932a3c335afa7e754eb3c2?s=128&d=identicon&r=PG&f=1", "display_name": "ProtoVB", "link": "https://stackoverflow.com/users/2830928/protovb"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449068171, "post_id": 34045406, "comment_id": 55846146, "body": "can you give an example on how to loop in the population of labels?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449068644, "post_id": 34045406, "comment_id": 55846513, "body": "do you mean x-axis (legend) labels? or actual data labels?"}, {"owner": {"reputation": 713, "user_id": 2830928, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4becdee202932a3c335afa7e754eb3c2?s=128&d=identicon&r=PG&f=1", "display_name": "ProtoVB", "link": "https://stackoverflow.com/users/2830928/protovb"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449069032, "post_id": 34045406, "comment_id": 55846795, "body": "These are Horizontal (Category) Axis label in my case"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449070144, "post_id": 34045406, "comment_id": 55847699, "body": "what type of chart, just so I can be sure?"}, {"owner": {"reputation": 713, "user_id": 2830928, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4becdee202932a3c335afa7e754eb3c2?s=128&d=identicon&r=PG&f=1", "display_name": "ProtoVB", "link": "https://stackoverflow.com/users/2830928/protovb"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449071455, "post_id": 34045406, "comment_id": 55848627, "body": "it&#39;s a pie chart (xlPie)"}], "answers": [{"comments": [{"owner": {"reputation": 713, "user_id": 2830928, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4becdee202932a3c335afa7e754eb3c2?s=128&d=identicon&r=PG&f=1", "display_name": "ProtoVB", "link": "https://stackoverflow.com/users/2830928/protovb"}, "edited": false, "score": 0, "creation_date": 1449073326, "post_id": 34046956, "comment_id": 55850050, "body": "Apparently this does not work with a pie chart but it does go well with a column chart. Thank you"}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1449116501, "post_id": 34046956, "comment_id": 55869533, "body": "XValues is already an array. Isn&#39;t using a collection just an extra step? Loop through the array until you find &quot;Europe&quot;, and that&#39;s the index of the point you want."}, {"owner": {"reputation": 437, "user_id": 360315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10b3c6750423b686703600e6c7e2cb82?s=128&d=identicon&r=PG", "display_name": "Bob Phillips", "link": "https://stackoverflow.com/users/360315/bob-phillips"}, "edited": false, "score": 1, "creation_date": 1449413231, "post_id": 34046956, "comment_id": 55986231, "body": "Yes, clearly XValues is an array, but I did it the way that I did for two reasons. Firstly, in response to the question, the OP seemed to want to reference the point by the name. Secondly, that collection allows them to do further actions by name reference, without continually looping."}], "tags": [], "owner": {"reputation": 437, "user_id": 360315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10b3c6750423b686703600e6c7e2cb82?s=128&d=identicon&r=PG", "display_name": "Bob Phillips", "link": "https://stackoverflow.com/users/360315/bob-phillips"}, "is_accepted": false, "score": 3, "last_activity_date": 1449073477, "last_edit_date": 1449073477, "creation_date": 1449071265, "answer_id": 34046956, "question_id": 34045406, "link": "https://stackoverflow.com/questions/34045406/points-in-excel-charts-vba/34046956#34046956", "title": "Points in Excel Charts (VBA)", "body": "<p>The name does not refer to the point, that has a given name such as S1P1.</p>\n\n<p>What you could do is to store the names and indexes of the XValues in a collection, then use that</p>\n\n<pre><code>Dim myValues As Collection\nDim xv As Variant\nDim i As Long\n\n    Set myValues = New Collection\n\n    With Worksheets(1).ChartObjects(1).Chart.SeriesCollection(1)\n\n        For Each xv In .XValues\n\n            i = i + 1\n            myValues.Add i, xv\n        Next xv\n\n        .Points(myValues.Item(\"Europe\")).MarkerStyle = xlDiamond\n    End With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 713, "user_id": 2830928, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4becdee202932a3c335afa7e754eb3c2?s=128&d=identicon&r=PG&f=1", "display_name": "ProtoVB", "link": "https://stackoverflow.com/users/2830928/protovb"}, "edited": false, "score": 0, "creation_date": 1449074522, "post_id": 34047105, "comment_id": 55850967, "body": "Also, this seems not to work with a Pie chart but it went well with a column chart (and probably also with a line chart!). Thank you"}, {"owner": {"reputation": 713, "user_id": 2830928, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4becdee202932a3c335afa7e754eb3c2?s=128&d=identicon&r=PG&f=1", "display_name": "ProtoVB", "link": "https://stackoverflow.com/users/2830928/protovb"}, "edited": false, "score": 0, "creation_date": 1449074558, "post_id": 34047105, "comment_id": 55850991, "body": "still interested to find out if something can be done with a Pie chart"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 713, "user_id": 2830928, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4becdee202932a3c335afa7e754eb3c2?s=128&d=identicon&r=PG&f=1", "display_name": "ProtoVB", "link": "https://stackoverflow.com/users/2830928/protovb"}, "edited": false, "score": 1, "creation_date": 1449074879, "post_id": 34047105, "comment_id": 55851238, "body": "@ProtoVB why did it not work with a Pie chart? One problem I do see is that you can not set legend marker styles on a Pie chart, since each series will be a <code>fill</code> slice of the pie by default. The code structure itself works on a pie, it&#39;s just that it will not update the <code>MarkerStyle</code> because it&#39;s not possible (nor does it make sense)."}, {"owner": {"reputation": 713, "user_id": 2830928, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4becdee202932a3c335afa7e754eb3c2?s=128&d=identicon&r=PG&f=1", "display_name": "ProtoVB", "link": "https://stackoverflow.com/users/2830928/protovb"}, "edited": false, "score": 1, "creation_date": 1449075799, "post_id": 34047105, "comment_id": 55851904, "body": "My bad, I had changed the  &quot;display&quot; (PlotBy:=xlColumns/xlRows). Select case does work and enable to amend the data using the designation instead of the Index. I was actually not using &quot;MarkerStyle&quot; but &quot;Interior.Color&quot; (which does apply to any Point of any type of chart). This is resolved, thank you"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 713, "user_id": 2830928, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4becdee202932a3c335afa7e754eb3c2?s=128&d=identicon&r=PG&f=1", "display_name": "ProtoVB", "link": "https://stackoverflow.com/users/2830928/protovb"}, "edited": false, "score": 0, "creation_date": 1449076201, "post_id": 34047105, "comment_id": 55852202, "body": "@ProtoVB - Glad it worked :) You could combine mine with what @Bob Phillips did below by looping through <code>.XValues</code> and testing the value xv and totally get rid of loading the formula into an array and looping through the range. There would be no need to add to the collection as he did, just to be clear. A more elegant solution, indeed."}, {"owner": {"reputation": 713, "user_id": 2830928, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4becdee202932a3c335afa7e754eb3c2?s=128&d=identicon&r=PG&f=1", "display_name": "ProtoVB", "link": "https://stackoverflow.com/users/2830928/protovb"}, "edited": false, "score": 0, "creation_date": 1449079137, "post_id": 34047105, "comment_id": 55853995, "body": "I may adapt Bob&#39;s suggestion and I agree that is seems more straight forward."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1449071630, "creation_date": 1449071630, "answer_id": 34047105, "question_id": 34045406, "link": "https://stackoverflow.com/questions/34045406/points-in-excel-charts-vba/34047105#34047105", "title": "Points in Excel Charts (VBA)", "body": "<p>There may be a better way to do this, but AFAIK and remember from my experience, this is the only way to test for Category Axis Labels when looping through charts and act upon the series based on the Category Axis Label.</p>\n\n<p>I have commented the code heavily in order to make it as clear as possible:</p>\n\n<pre><code>Sub LoopAxisLabels()\n\nDim ws As Worksheet\nDim c As ChartObject\nDim sc As SeriesCollection\n\nSet ws = Worksheets(1)\nSet c = ws.ChartObjects(1)\nSet sc = c.Chart.SeriesCollection\n\nDim aForm() As String\naForm() = Split(sc.Item(1).Formula, \",\")\n'^^^\n'|||get formula (chart data source) for the series collection (Item(1) denotes first series collection on chart\n'   assumes only 1 collection on chart)\n'   places formula into array separate by comma, based on =SERIES(Sheet1!$F$3,Sheet1!$E$4:$E$8,Sheet1!$F$4:$F$8,1) as example\n\nDim rLabel As Range, cel As Range\nSet rLabel = Range(aForm(1)) 'set the label range (Sheet1!$E$4:$E$8 in the example)\n\nDim i As Long\n\nFor Each cel In rLabel 'loop through actual cells of label and test for label values\n\n    i = i + 1 'use counter to refer to specific chart points (since points will be in order of data listed in range\n\n    Select Case cel.Value2\n\n        Case Is = \"Europe\": sc.Item(1).Points(i).MarkerStyle = xlDiamond 'Points(i) matches the relative range reference\n\n        Case Is = \"...\":\n\n        'continue with other Cases...\n\n    End Select\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 713, "user_id": 2830928, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4becdee202932a3c335afa7e754eb3c2?s=128&d=identicon&r=PG&f=1", "display_name": "ProtoVB", "link": "https://stackoverflow.com/users/2830928/protovb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2047, "favorite_count": 1, "accepted_answer_id": 34047105, "answer_count": 2, "score": 1, "last_activity_date": 1449073477, "creation_date": 1449067007, "last_edit_date": 1531164843, "question_id": 34045406, "link": "https://stackoverflow.com/questions/34045406/points-in-excel-charts-vba", "title": "Points in Excel Charts (VBA)", "body": "<p>Is there a way in VBA to identify a point in a chart with something else than its number reference?</p>\n\n<p>When placing the pointer above a section of the chart, it displays the serie number and also some narrative. Is this the \"Name\" of the point?</p>\n\n<p>Ex: Serie 1 Point \"<strong>Europe</strong>\" Value: 12 (51%)</p>\n\n<p>I am trying to move away from:</p>\n\n<p><code>Worksheets(1).ChartObjects(1).Chart. _\n    SeriesCollection(1).Points(3).MarkerStyle = xlDiamond</code></p>\n\n<p>and writing:</p>\n\n<p><code>Worksheets(1).ChartObjects(1).Chart. _\n    SeriesCollection(1).Points(\"Europe\").MarkerStyle = xlDiamond</code></p>\n"}, {"tags": ["excel", "vba", "activex"], "comments": [{"owner": {"reputation": 25586, "user_id": 30447, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/LlF5u.jpg?s=128&g=1", "display_name": "PA.", "link": "https://stackoverflow.com/users/30447/pa"}, "edited": false, "score": 0, "creation_date": 1449066863, "post_id": 34045180, "comment_id": 55845102, "body": "Don&#39;t use the clipboard for a simple copy action, the clipboard is a user resource that must be preserved. <b>Hint</b>: take a look at <code>Range().Copy()</code> method."}], "answers": [{"tags": [], "owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "is_accepted": true, "score": 2, "last_activity_date": 1449066821, "creation_date": 1449066821, "answer_id": 34045336, "question_id": 34045180, "link": "https://stackoverflow.com/questions/34045180/error-when-using-active-x-button-to-copy-and-paste/34045336#34045336", "title": "Error when using active x button to copy and paste", "body": "<p>Try this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nThisWorkbook.Sheets(\"Raw Data\").Activate\n\nSheets(\"Data AC\").Range(\"A1:J1000\").Copy Sheets(\"Raw Data\").Range(\"A2:J1001\")\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 5247998, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f17ff18250d59a66d174591d59859638?s=128&d=identicon&r=PG&f=1", "display_name": "Josie", "link": "https://stackoverflow.com/users/5247998/josie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 34045336, "answer_count": 1, "score": 1, "last_activity_date": 1449066821, "creation_date": 1449066415, "question_id": 34045180, "link": "https://stackoverflow.com/questions/34045180/error-when-using-active-x-button-to-copy-and-paste", "title": "Error when using active x button to copy and paste", "body": "<p>I am trying to set up a command button that will copy and paste data from one sheet to another. </p>\n\n<p>Currently my code looks like this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nThisWorkbook.Sheets(\"Raw Data\").Activate\n\nThisWorkbook.Sheets(\"Data AC\").Range(\"A1:J1000\").Select\nSelection.Copy\nThisWorkbook.Sheets(\"Raw Data\").Range(\"A2:J1001\").Select\nSelction.Paste\n\n\nEnd Sub\n</code></pre>\n\n<p>I keep getting an error saying 'select method of range class failed', but cannot work out how to fix it.\nThanks </p>\n"}, {"tags": ["vba", "excel", "runtime", "userform"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1449066505, "post_id": 34044919, "comment_id": 55844849, "body": "It should be possible. Add the Name of the new command e.g. like<code>ctl_Command.Name = &quot;name_&quot; &amp; i</code> and then in the <code>CmdEvents_Click</code> just use <code>CmdEvents.Name</code>."}, {"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1449066628, "post_id": 34044919, "comment_id": 55844946, "body": "if you add this as an answer, I&#39;ll give you a green checkmark :)"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1449067024, "post_id": 34044919, "comment_id": 55845207, "body": "I am glad it helped, thx :)"}], "answers": [{"tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": true, "score": 2, "last_activity_date": 1449066798, "creation_date": 1449066798, "answer_id": 34045327, "question_id": 34044919, "link": "https://stackoverflow.com/questions/34044919/vba-events-for-several-dynamically-added-buttons/34045327#34045327", "title": "VBA: Events for several dynamically added buttons", "body": "<ul>\n<li>Add the <code>Name</code> of the new command e.g. like <code>ctl_Command.Name = \"name_\" &amp; i</code></li>\n<li>Then in the <code>CmdEvents_Click</code> just use <code>CmdEvents.Name</code>. </li>\n</ul>\n"}], "owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 0, "accepted_answer_id": 34045327, "answer_count": 1, "score": 3, "last_activity_date": 1449066798, "creation_date": 1449065615, "last_edit_date": 1531164843, "question_id": 34044919, "link": "https://stackoverflow.com/questions/34044919/vba-events-for-several-dynamically-added-buttons", "title": "VBA: Events for several dynamically added buttons", "body": "<p>I am adding several CommandButtons dynamically to my user form. To assign code, I used the answer of this question: <a href=\"https://stackoverflow.com/questions/10224511/assign-code-to-a-button-created-dynamically\">Assign code to a button created dynamically</a> </p>\n\n<p>However, I need to determine which button has been clicked. They all do have different names. Therefore, my initial idea was to get the name of the clicked button in the <code>CmdEvents_Click()</code> procedure. However, I have not found a solution how to do that.</p>\n\n<p>Does anyone have a solution how to trigger button specific events?</p>\n"}, {"tags": ["vba", "excel", "duplicates"], "comments": [{"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1449076788, "post_id": 34044722, "comment_id": 55852583, "body": "If the solution worked, please mark the answer as accepted. (Click the check mark next to it.) :-)"}], "answers": [{"tags": [], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "is_accepted": true, "score": 1, "last_activity_date": 1449065501, "creation_date": 1449065501, "answer_id": 34044871, "question_id": 34044722, "link": "https://stackoverflow.com/questions/34044722/deleting-visible-duplicates-of-visible-rows-only/34044871#34044871", "title": "Deleting visible duplicates of visible rows only", "body": "<p>Add an extra condition to your <code>If</code> statement:</p>\n\n<p><code>If Not FoundDup Is Nothing And Not Cells(Row,3).EntireRow.Hidden Then</code></p>\n"}], "owner": {"reputation": 23, "user_id": 5630578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2a1d639a8289d4a5bd901f5f834fce9?s=128&d=identicon&r=PG&f=1", "display_name": "pabst009", "link": "https://stackoverflow.com/users/5630578/pabst009"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "accepted_answer_id": 34044871, "answer_count": 1, "score": 2, "last_activity_date": 1449071098, "creation_date": 1449065054, "question_id": 34044722, "link": "https://stackoverflow.com/questions/34044722/deleting-visible-duplicates-of-visible-rows-only", "title": "Deleting visible duplicates of visible rows only", "body": "<p>New at VBA. I am using the code below to identify and delete rows in Sheet1 which have duplicate values in Column C of Sheet2, but I need the code to <strong>not</strong> delete rows that are already hidden from a filter.</p>\n\n<p>I have searched around and tried using .SpecialCells(xlCellTypeVisible) but I don't know where to place it. Another option I thought was using EntireRow.Hidden syntax but I am not sure how to incorporate that either. </p>\n\n<p>Any help is appreciated. </p>\n\n<pre><code>Sub DeleteDuplicates()\n    Application.ScreenUpdating = False\n    Dim Row As Long\n    Dim FoundDup As Range\n\n    Sheets(\"Sheet1\").Select\n\n    For Row = Range(\"C65536\").End(xlUp).Row To 2 Step -1\n\n    Set FoundDup = Sheets(\"Sheet2\").Range(\"C:C\").Find(Cells(Row, 3), LookIn:=xlValues, lookat:=xlWhole)\n\n\n    If Not FoundDup Is Nothing Then\n        Cells(Row, 3).EntireRow.Delete\n    End If\n\n\n    Next Row\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "dictionary", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1449064624, "post_id": 34044427, "comment_id": 55843515, "body": "tbh, idk if this will work but you are going to have to <code>Set pDict.Item(Range(&quot;A&quot; &amp; i).Value) = p</code>. Subsequent changes to the <code>p</code> object (or setting to nothing) should be reflected in that dictionary item. Similar to setting a range object to a worksheet cell."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1449065536, "post_id": 34044427, "comment_id": 55844166, "body": "@Jeeped setting <code>p</code> to <code>Nothing</code> won&#39;t affect the dictionary item."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1449066871, "post_id": 34044427, "comment_id": 55845107, "body": "@Rory - good to know. thanks!"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1449067546, "post_id": 34044427, "comment_id": 55845615, "body": "Naturally, it was something elementary. I had tried <code>Set</code> earlier, but removed it during troubleshooting an unrelated error. Thanks! I also have no need to null any of the objects, I am using <code>.Remove</code> as the state of the objects themselves are of no interest or value outside of the dictionary. @Jeeped submit as answer if you want the checkmark."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1449068386, "creation_date": 1449068386, "answer_id": 34045886, "question_id": 34044427, "link": "https://stackoverflow.com/questions/34044427/adding-custom-object-with-default-property-to-dictionary/34045886#34045886", "title": "Adding custom object with default property to dictionary", "body": "<p>You are going to have to <code>Set pDict.Item(Range(\"A\" &amp; i).Value) = p</code>. Subsequent changes to the p object should be reflected in that dictionary item. Similar to setting a range type variable to a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range object</a>.</p>\n"}], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 34045886, "answer_count": 1, "score": 0, "last_activity_date": 1449068386, "creation_date": 1449064251, "last_edit_date": 1531164843, "question_id": 34044427, "link": "https://stackoverflow.com/questions/34044427/adding-custom-object-with-default-property-to-dictionary", "title": "Adding custom object with default property to dictionary", "body": "<p>Consider the following:</p>\n\n<pre><code>Dim p As myObject \nDim pDict As Scripting.Dictionary\n\np = New myObject\npDict = New Scripting.Dictionary\n\npDict.Item(Range(\"A\" &amp; i).Value) = p\n</code></pre>\n\n<p><code>p</code> has a default property <code>DefProperty</code> via <code>Attribute Value.VB_UserMemId = 0</code>. </p>\n\n<p>When I attempt to add <code>p</code> to <code>pDict</code>, only the default property gets added. The desired result is to add the <em>entirety</em> of <code>p</code> to <code>pDict</code>. </p>\n\n<p>Calling <code>? p</code> is the same as calling <code>? p.DefProperty</code>, so in hindsight I can kind of understand why I am getting the wrong result -- what I don't understand is how to get the right one.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1449064737, "post_id": 34044396, "comment_id": 55843590, "body": "I disagree - if you remove <code>Dim i As Integer</code> and it&#39;s still working then you&#39;ve not got <code>Option Explicit</code> at the top of the module which can open a whole big can of worms.  Change <code>Integer</code> to <code>Double</code> as <code>Integer</code> will only accept whole numbers, while <code>Double</code> can work with fractions of a number.  Or, use the built in functionality of Spin buttons to change a cell value and divide the number by 100 in another cell to get the value you&#39;re after."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1449064891, "post_id": 34044396, "comment_id": 55843716, "body": "@Darren Bartrup-Cook is correct.  You should not let VB guess what your variables should be.  You are asking for trouble."}], "tags": [], "owner": {"reputation": 1606, "user_id": 4296373, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0FjCTYoKpgU/AAAAAAAAAAI/AAAAAAAAAIE/4W7C-1H81lQ/photo.jpg?sz=128", "display_name": "Ebrahim Poursadeqi", "link": "https://stackoverflow.com/users/4296373/ebrahim-poursadeqi"}, "is_accepted": true, "score": 0, "last_activity_date": 1449065136, "last_edit_date": 1449065136, "creation_date": 1449064174, "answer_id": 34044396, "question_id": 34044148, "link": "https://stackoverflow.com/questions/34044148/refreshing-spinbutton-spinup-or-spindown/34044396#34044396", "title": "Refreshing SpinButton SpinUp or SpinDown", "body": "<p>change Integer to Double</p>\n\n<pre><code>Private Sub SpinButton1_SpinUp()\nDim i As Double\ni = Sheet1.Range(\"E8\").Value\nSheet1.Range(\"E8\") = i + 0.01\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 1, "creation_date": 1449064961, "post_id": 34044542, "comment_id": 55843769, "body": "@ManishChristian Hopefully the OP checks back and tries option explicit.  As you know, there are a lot of ways to make things work, but it doesn&#39;t mean they are correct."}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 1, "creation_date": 1449065304, "post_id": 34044542, "comment_id": 55844019, "body": "I agree and that&#39;s the reason accepted answer have been edited ;)"}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 3, "last_activity_date": 1449064976, "last_edit_date": 1449064976, "creation_date": 1449064519, "answer_id": 34044542, "question_id": 34044148, "link": "https://stackoverflow.com/questions/34044148/refreshing-spinbutton-spinup-or-spindown/34044542#34044542", "title": "Refreshing SpinButton SpinUp or SpinDown", "body": "<p>An integer will not store the decimal value.  So if you have 8 in cell E8 you are getting 8 in the int and then writing 8 + .01 to cell E8 so you get 8.01.</p>\n\n<p>The next time you read 8.01 into the int, VB is rounding off the decimals so you are getting 8 in the int again and adding the same value back in.</p>\n\n<p>You need to change the variable to decimal variable.</p>\n\n<p>Taking out the variable declaration will just make VB guess what to use and that is not a good practice.  You should use \"Option Explicit\" at the top of your code to prevent this.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub SpinButton1_SpinUp()\n\n    Dim i As Double\n\n    i = Sheet1.Range(\"E8\").Value\n    Sheet1.Range(\"E8\") = i + 0.01\n\nEnd Sub\n</code></pre>\n\n<p>You could also use</p>\n\n<pre><code>Dim i As Single\n</code></pre>\n\n<p>depending on the size of the decimal that it could get to.</p>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1449065377, "post_id": 34044562, "comment_id": 55844070, "body": "Sorry, have voted down as have not dealt with the <code>Integer</code> problem.  Actually, re-reading it you have - could at least remove the declaration bit though  - will vote back up again if I can.  :)  lol, can vote up to 1 or down to -1, but can&#39;t change back to 0."}], "tags": [], "owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "is_accepted": false, "score": 2, "last_activity_date": 1449066046, "last_edit_date": 1449066046, "creation_date": 1449064575, "answer_id": 34044562, "question_id": 34044148, "link": "https://stackoverflow.com/questions/34044148/refreshing-spinbutton-spinup-or-spindown/34044562#34044562", "title": "Refreshing SpinButton SpinUp or SpinDown", "body": "<p>You don't need to store the value in a variable. Try this.</p>\n\n<pre><code>Private Sub SpinButton1_SpinUp()\n\n    Sheet1.Range(\"E8\").Value = Sheet1.Range(\"E8\").Value + 0.01\n\nEnd Sub\n\nPrivate Sub SpinButton2_SpinDown()\n\n    Sheet1.Range(\"E8\").Value = Sheet1.Range(\"E8\").Value - 0.01\n\nEnd Sub\n</code></pre>\n\n\n"}], "owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1397, "favorite_count": 0, "accepted_answer_id": 34044396, "answer_count": 3, "score": 0, "last_activity_date": 1449066046, "creation_date": 1449063471, "last_edit_date": 1531161705, "question_id": 34044148, "link": "https://stackoverflow.com/questions/34044148/refreshing-spinbutton-spinup-or-spindown", "title": "Refreshing SpinButton SpinUp or SpinDown", "body": "<p>I am trying to add a spin button to my Excel spreadsheet so that when I click the spin button up my cell value increases by .01 and when I click the spin button down my cell value decreases by .01. I have the following code:</p>\n\n<pre><code>Private Sub SpinButton1_SpinUp()\n\nDim i As Integer\n\ni = Sheet1.Range(\"E8\").Value\nSheet1.Range(\"E8\") = i + 0.01\n\nEnd Sub\n</code></pre>\n\n<p>When I test the functionality of this code cell E8 goes up .01, but only once. When I click the button again, nothing happens. How can this be corrected?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-access-2007"], "comments": [{"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1449064083, "post_id": 34043882, "comment_id": 55843179, "body": "what are the column names in query1?, also you appear to have a mismatch with <code>strSQL</code> and <code>strQry</code>"}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 2, "last_activity_date": 1449065673, "creation_date": 1449065673, "answer_id": 34044943, "question_id": 34043882, "link": "https://stackoverflow.com/questions/34043882/save-the-result-of-a-sql-query-into-a-variable-in-vba/34044943#34044943", "title": "Save the result of a SQL query into a variable in VBA?", "body": "<p>If your query returns only a single column, and only zero or one records, you can use <code>rst(0)</code> to get the first field (the Fields collection is zero-based).</p>\n\n<pre><code>If rst.EOF Then\n    ' covers \"no records returned\"\n    Variable1 = \"\"\nElse\n    ' Nz() covers \"NULL returned\"\n    Variable1 = Nz(rst(0), \"\")\nEnd If\n</code></pre>\n\n<p>But using the field name from the query is better readable.</p>\n\n<pre><code>Variable1 = Nz(rst!myField, \"\")\n</code></pre>\n\n<p>You may also want to look into the <code>DLookup()</code> function, which is designed to return a single value.</p>\n"}, {"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": false, "score": 3, "last_activity_date": 1449066103, "creation_date": 1449066103, "answer_id": 34045075, "question_id": 34043882, "link": "https://stackoverflow.com/questions/34043882/save-the-result-of-a-sql-query-into-a-variable-in-vba/34045075#34045075", "title": "Save the result of a SQL query into a variable in VBA?", "body": "<p>I don't see why you need a recordset for this.  You could use <code>DLookup</code> to fetch the value returned by <code>Query1</code>.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim Variable1 As Variant\nVariable1 = DLookup(\"[column name here]\", \"Query1\")\n</code></pre>\n\n<p>I used <code>Variant</code> for <code>Variable1</code> so that it can accept Null.  If you wish to keep it as <code>String</code>, you can use <code>Nz()</code> as Andre demonstrated to transform Null to a string.</p>\n"}], "owner": {"reputation": 19, "user_id": 1454213, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b8856ab6f8afd5df7b0ca14ba3c235f5?s=128&d=identicon&r=PG", "display_name": "Stackbe", "link": "https://stackoverflow.com/users/1454213/stackbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3104, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1449066304, "creation_date": 1449062685, "last_edit_date": 1449066304, "question_id": 34043882, "link": "https://stackoverflow.com/questions/34043882/save-the-result-of-a-sql-query-into-a-variable-in-vba", "title": "Save the result of a SQL query into a variable in VBA?", "body": "<p>I am trying to assign the result of the query into the variable. I have one query (lets call it \"Query1\") that will check various criteria. I tried it as follows. </p>\n\n<pre><code>   Dim rst As DAO.Recordset\n   Dim strSQL As String\n   Dim Variable1 As String\n\n   strQry = \"Query1\"\n   Set rst = CurrentDb.OpenRecordset(strQry)\n\n Variable1 = ????? \n   rst.Close\n   Set rst = Nothing\n</code></pre>\n\n<p>I need help to complete the above code so that my variable will get the value returned by the query. Please note that my Query1 will either return a Null value or a single record. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1449062608, "post_id": 34043842, "comment_id": 55842152, "body": "Have a look at this: <a href=\"http://stackoverflow.com/a/17861992/3042759\">How do I find a specific string in one of many text .log files using VBA?</a>"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1449062685, "post_id": 34043842, "comment_id": 55842209, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/17860618/how-do-i-find-a-specific-string-in-one-of-many-text-log-files-using-vba\">How do I find a specific string in one of many text .log files using VBA?</a>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1449071908, "post_id": 34043842, "comment_id": 55849018, "body": "Are they actual &quot;.log&quot; files - or Excel workbooks that you are referring to as  &quot;log files&quot; ?"}], "owner": {"reputation": 1, "user_id": 5630383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038e2e2b2227848077df3f20bc58853c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/5630383/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1449062546, "creation_date": 1449062546, "question_id": 34043842, "link": "https://stackoverflow.com/questions/34043842/vba-code-to-search-substrings-in-a-file-and-print-the-entire-word", "title": "VBA code to search substrings in a file and print the entire word", "body": "<p>Is it possible to have a VBA code to print the entire word for a searched substring for multiple files in a location on a excel sheet?</p>\n\n<p>Suppose, </p>\n\n<ul>\n<li>I have 10log files in location <code>'C:\\Logs'</code> </li>\n<li>In each log file I want to search for strings listen in sheet 1 (in rows)</li>\n</ul>\n\n<p>Eg. </p>\n\n<pre><code>    1]Red\n    2]Blue\n    3]Green\n\n(where 1,2,3 are row numbers)\n</code></pre>\n\n<ul>\n<li>Suppose the substring <code>Red</code> is found in first log file <code>log1.txt</code> in the word <code>Red2312</code></li>\n<li>I want <code>Red2312</code> to be printed to the next excel sheet</li>\n<li>So, the output will be,</li>\n</ul>\n\n<blockquote>\n<pre><code>0] A  B  C |\n\n1] Red2312 | log1.txt\n\n2] Blue2121 | log1.txt\n\n3] Red1234 | log7.txt\n</code></pre>\n</blockquote>\n\n<p>Any help would be great! Even how to go ahead with it..</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1449062029, "post_id": 34043594, "comment_id": 55841745, "body": "Please add to your code example or tidy it up. You&#39;ve got <code>End With</code> and <code>End If</code> with no starting condition. Which line is it failing on? What is wrong?"}, {"owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1449062137, "post_id": 34043594, "comment_id": 55841828, "body": "Excuse me Tom. Total code was too long, giving an error. I approved your edit. Line that it is failing on is; Worksheets(&quot;ScrapLogboek&quot;).Cells(Rows.Count, &quot;A&quot;).End(xlUp).Offset(1, -1).  It works perfectly without this, but keeps overwriting the data found, and copied to another worksheet. To prevent this from happening i wanted to try it with the Offset function."}, {"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 1, "creation_date": 1449062234, "post_id": 34043594, "comment_id": 55841893, "body": "You aren&#39;t doing anything with the offset. Don&#39;t you want to select it or assign it a value?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1449062257, "post_id": 34043594, "comment_id": 55841911, "body": "You&#39;re telling the offset to go 1 down on the Row and 1 to the left on the Column. As you&#39;re doing this in Column A there is no where for it to go giving you the error."}, {"owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "reply_to_user": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1449062434, "post_id": 34043594, "comment_id": 55842029, "body": "Tom, that was pretty stupid. Thank you for that correction.  @Alex4336, i want the Pasting function below it to look for the first empty row and paste there, instead of pasting in A2 everytime, overwriting everything."}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "edited": false, "score": 0, "creation_date": 1449062743, "post_id": 34043774, "comment_id": 55842250, "body": "You&#39;re my hero of the day! Thank you for teaching me how to handle the Offset, and even correcting my code. Bon Merci!"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1449062330, "creation_date": 1449062330, "answer_id": 34043774, "question_id": 34043594, "link": "https://stackoverflow.com/questions/34043594/vba-offset-function-giving-synthaxis-error/34043774#34043774", "title": "VBA Offset Function giving Synthaxis error", "body": "<p>You are in <strong>column A</strong>, so you <strong>can't Offset minus one column</strong> because <strong>there is none other on the left</strong>!</p>\n\n<p>Try your code with <code>Worksheets(\"ScrapLogboek\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)</code> and it'll work! ;)</p>\n\n<p>And your code would always paste on A2 which is probably not the purpose, so here is the corrected version :</p>\n\n<pre><code>If Not Rng Is Nothing Then\n    Rng.EntireRow.Copy\n    Worksheets(\"ScrapLogboek\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0).PasteSpecial\n    Rng.EntireRow.Delete\nElse\n    MsgBox (\"Niks gescrapt. Check of het B-nummer correct is.\")\nEnd If\n\nEnd With\n    MsgBox (\"Logboek gescrapt.\")\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 34043774, "answer_count": 1, "score": 2, "last_activity_date": 1449062330, "creation_date": 1449061755, "last_edit_date": 1449062269, "question_id": 34043594, "link": "https://stackoverflow.com/questions/34043594/vba-offset-function-giving-synthaxis-error", "title": "VBA Offset Function giving Synthaxis error", "body": "<p>Currently doing the last bits of VBA on a macro. This macro is intented to via an Inputbox using Findstring, finding a row, copying it to a different worksheet, paste this row on the first empty row, and delete the row on the original worksheet.</p>\n\n<pre><code>If Not Rng Is Nothing Then\n    Rng.EntireRow.Copy\n    Worksheets(\"ScrapLogboek\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1, -1)\n    Worksheets(\"ScrapLogboek\").Range(\"A2\").PasteSpecial\n    Rng.EntireRow.Delete\nElse\n    MsgBox (\"Niks gescrapt. Check of het B-nummer correct is.\")\nEnd If\n\nEnd With\n    MsgBox (\"Logboek gescrapt.\")\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Now i keep getting a synthaxis-error on the Offset-function. What am i doing wrong? As said in the comments; Worksheets(\"ScrapLogboek\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1, -1). This line is giving me shit, for some reason.</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1449062381, "post_id": 34043467, "comment_id": 55841994, "body": "<a href=\"http://stackoverflow.com/questions/18062066/how-to-modify-text-in-powerpoint-via-excel-vba-without-changing-style?rq=1\">This</a> may help."}, {"owner": {"reputation": 1, "user_id": 5630101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d69dcf9249bea84066ef1ff6d4cd8172?s=128&d=identicon&r=PG&f=1", "display_name": "Slapol", "link": "https://stackoverflow.com/users/5630101/slapol"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1449087405, "post_id": 34043467, "comment_id": 55858653, "body": "Thank you, this is about change and replace. But how can I duplicate Slides(1).Shapes(1).TextFrame into Slides(1).Shapes(2).TextFrame."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5630101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d69dcf9249bea84066ef1ff6d4cd8172?s=128&d=identicon&r=PG&f=1", "display_name": "Slapol", "link": "https://stackoverflow.com/users/5630101/slapol"}, "edited": false, "score": 0, "creation_date": 1449336845, "post_id": 34071009, "comment_id": 55967042, "body": "Thanks JamieG for an advice. Unfortunately <code>.Text = Left(.Text, 10)</code> is not good enough. In that way I&#39;m losing text formatting. But it is OK when instead of Left (Right) I use <code>Characters(Start, Length).Delete</code> The next disadvantage of this resolution is problem with the autosize of the TextFrame. <code>oShp1.TextFrame.AutoSize = ppAutoSizeShapeToFitText</code> works as I execute code step-by-step, but doesn&#39;t work at run-time - frames are very big. IMHO because the copy-paste is very slow."}, {"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "reply_to_user": {"reputation": 1, "user_id": 5630101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d69dcf9249bea84066ef1ff6d4cd8172?s=128&d=identicon&r=PG&f=1", "display_name": "Slapol", "link": "https://stackoverflow.com/users/5630101/slapol"}, "edited": false, "score": 0, "creation_date": 1449482135, "post_id": 34071009, "comment_id": 56009368, "body": "Sorry, I meant to post my code with the .Delete method too! Regarding the ppAutoSizeShapeToFitText you need to make sure you apply that last (after text is changed) if I recall correctly."}, {"owner": {"reputation": 1, "user_id": 5630101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d69dcf9249bea84066ef1ff6d4cd8172?s=128&d=identicon&r=PG&f=1", "display_name": "Slapol", "link": "https://stackoverflow.com/users/5630101/slapol"}, "edited": false, "score": 0, "creation_date": 1449669103, "post_id": 34071009, "comment_id": 56107067, "body": "It&#39;s funny, ppAutoSizeShapeToFitText works correctly at run-time with PowerPoint 2013. Problems are with PowerPoint 2003."}], "tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 0, "last_activity_date": 1449159566, "creation_date": 1449159566, "answer_id": 34071009, "question_id": 34043467, "link": "https://stackoverflow.com/questions/34043467/manipulating-text-with-symbols-in-powerpoint-using-vba/34071009#34071009", "title": "Manipulating text with symbols in PowerPoint using VBA", "body": "<p>If possible, I would duplicate the shape and then delete what you don't want in the text. That way all formatting will be retained, character-by-character. Something along the lines of this:</p>\n\n<pre><code>Option Explicit\n\nSub CopyText()\n  Dim oShp1 As Shape\n  Dim oShp2 As Shape\n\n  Set oShp1 = ActivePresentation.Slides(1).Shapes(1)\n  oShp1.Copy\n  ActiveWindow.View.Slide.Shapes.Paste\n\n  Set oShp2 = ActivePresentation.Slides(1).Shapes(ActivePresentation.Slides(1).Shapes.Count)\n\n  With oShp1.TextFrame.TextRange\n    .Text = Left(.Text, 10)\n  End With\n\n  With oShp2.TextFrame.TextRange\n    .Text = Right(.Text, Len(.Text) - Len(oShp1.TextFrame.TextRange.Text))\n  End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5630101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d69dcf9249bea84066ef1ff6d4cd8172?s=128&d=identicon&r=PG&f=1", "display_name": "Slapol", "link": "https://stackoverflow.com/users/5630101/slapol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449159566, "creation_date": 1449061377, "last_edit_date": 1449061479, "question_id": 34043467, "link": "https://stackoverflow.com/questions/34043467/manipulating-text-with-symbols-in-powerpoint-using-vba", "title": "Manipulating text with symbols in PowerPoint using VBA", "body": "<p>I am trying to use VBA to manipulate text in a PowerPoint.</p>\n\n<p>I have formatted text in a frame with greek symbols, superscript and subscript. \nI want to divide that text into two frames.\nFor example I use something like this:</p>\n\n<pre><code>Dim frame1Text As String\nDim frame2Text As String\nSet frame1 = ActivePresentation.Slides(1).Shapes(1).TextFrame\nSet frame2 = ActivePresentation.Slides(1).Shapes(2).TextFrame\nframe1Text = frame1.TextRange.Text\nframe2Text = Right(frame1Text, Len(frame1Text) - 10)\nframe1Text = Left(frame1Text, Len(frame1Text) - Len(frame2Text))\nframe1.TextRange.Text = frame1Text\nframe2.TextRange.Text = frame2Text\n</code></pre>\n\n<p>As a result there are symbols and formatting lost. Is there any way to make it better?\nThanks for any help.</p>\n"}, {"tags": ["vba", "excel", "runtime-error"], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1449061389, "post_id": 34043339, "comment_id": 55841353, "body": "Or just use <code>cl.EntireRow.Cut</code> and skip activating altogether. (otherwise you also need to activate the right workbook first)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1449061700, "post_id": 34043339, "comment_id": 55841555, "body": "@Rory : Indeed, I just stop at the activation issue and didn&#39;t read the next line... But that is a better proposition if the OP doesn&#39;t need to use it (I do this to &quot;debug&quot; easily)"}, {"owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "edited": false, "score": 0, "creation_date": 1449065243, "post_id": 34043339, "comment_id": 55843970, "body": "Thank you very much guys, both worked perfectly. Much appreciated."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "edited": false, "score": 0, "creation_date": 1449065389, "post_id": 34043339, "comment_id": 55844082, "body": "@JoshWhitfield : Please take a minute to take the tour and learn how this site works (votes and accepting answers) : <a href=\"http://stackoverflow.com/tour\">stackoverflow.com/tour</a>"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1449060966, "creation_date": 1449060966, "answer_id": 34043339, "question_id": 34043199, "link": "https://stackoverflow.com/questions/34043199/error-1004-select-method-of-range-class-failed/34043339#34043339", "title": "Error 1004 select method of range class failed", "body": "<p>You need to active the sheet first, with <code>cl.Parent.Activate</code></p>\n\n<pre><code>    Sub FindString()\n    Dim SearchString As String\n    Dim SearchRange As Range, cl As Range\n    Dim FirstFound As String\n    Dim sh As Worksheet\n\n    'Open first item to search and paste destination\n    Workbooks.Open \"G:\\BS\\Josh Whitfield\\Credit_Chasing\\NEW PROCESS\\Markerstudy.xlsx\"\n    Workbooks.Open \"G:\\BS\\Josh Whitfield\\Credit_Chasing\\NEW PROCESS\\solved results.xlsx\"\n    Workbooks(\"markerstudy\").Activate\n\n    ' Set Search value\n    SearchString = \"solved\"\n    Application.FindFormat.Clear\n    ' loop through all sheets\n    For Each sh In ActiveWorkbook.Worksheets\n        ' Find first instance on sheet\n        Set cl = sh.Cells.Find(What:=SearchString, _\n            After:=sh.Cells(1, 1), _\n            LookIn:=xlValues, _\n            LookAt:=xlPart, _\n            SearchOrder:=xlByRows, _\n            SearchDirection:=xlNext, _\n            MatchCase:=False, _\n            SearchFormat:=False)\n        If Not cl Is Nothing Then\n            ' if found, remember location\n            FirstFound = cl.Address\n            ' format found cell\n            Do\n                cl.Parent.Activate\n                cl.Activate\n                ActiveCell.EntireRow.Cut\n                Workbooks(\"solved results\").Activate\n                Range(\"A1\").Select\n                If ActiveCell &lt;&gt; \"\" Then\n                    ActiveCell.Offset(1, 0).Select\n                    ActiveCell.PasteSpecial xlPasteAll\n                Else\n                    ActiveCell.PasteSpecial xlPasteAll\n                End If\n\n                ' find next instance\n                Set cl = sh.Cells.FindNext(After:=cl)\n                ' repeat until back where we started\n            Loop Until FirstFound = cl.Address\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 5598712, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a07c6c9ef49d10e924d586450e36adf0?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Whitfield", "link": "https://stackoverflow.com/users/5598712/josh-whitfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 463, "favorite_count": 0, "accepted_answer_id": 34043339, "answer_count": 1, "score": 1, "last_activity_date": 1488362568, "creation_date": 1449060562, "last_edit_date": 1488362568, "question_id": 34043199, "link": "https://stackoverflow.com/questions/34043199/error-1004-select-method-of-range-class-failed", "title": "Error 1004 select method of range class failed", "body": "<p>I can't see where I've gone wrong here, any help is appreciated.\nI'm trying to cut and paste any rows that have the word 'solved' in them to another spreadsheet, but the code is getting stuck on cl.activate at the start of the loop.</p>\n\n<pre><code>    Sub FindString()\n    Dim SearchString As String\n    Dim SearchRange As Range, cl As Range\n    Dim FirstFound As String\n    Dim sh As Worksheet\n\n    'Open first item to search and paste destination\n    Workbooks.Open \"G:\\BS\\Josh Whitfield\\Credit_Chasing\\NEW PROCESS\\Markerstudy.xlsx\"\n    Workbooks.Open \"G:\\BS\\Josh Whitfield\\Credit_Chasing\\NEW PROCESS\\solved results.xlsx\"\n    Workbooks(\"markerstudy\").Activate\n\n    ' Set Search value\n    SearchString = \"solved\"\n    Application.FindFormat.Clear\n    ' loop through all sheets\n    For Each sh In ActiveWorkbook.Worksheets\n        ' Find first instance on sheet\n        Set cl = sh.Cells.Find(What:=SearchString, _\n            After:=sh.Cells(1, 1), _\n            LookIn:=xlValues, _\n            LookAt:=xlPart, _\n            SearchOrder:=xlByRows, _\n            SearchDirection:=xlNext, _\n            MatchCase:=False, _\n            SearchFormat:=False)\n        If Not cl Is Nothing Then\n            ' if found, remember location\n            FirstFound = cl.Address\n            ' format found cell\n            Do\n                cl.Activate\n                ActiveCell.EntireRow.Cut\n                Workbooks(\"solved results\").Activate\n                Range(\"A1\").Select\n                If ActiveCell &lt;&gt; \"\" Then\n                    ActiveCell.Offset(1, 0).Select\n                    ActiveCell.PasteSpecial xlPasteAll\n                Else\n                    ActiveCell.PasteSpecial xlPasteAll\n                End If\n\n                ' find next instance\n                Set cl = sh.Cells.FindNext(After:=cl)\n                ' repeat until back where we started\n            Loop Until FirstFound = cl.Address\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1449060937, "post_id": 34043071, "comment_id": 55841040, "body": "Have a look at <a href=\"https://msdn.microsoft.com/en-us/library/bb386097.aspx\" rel=\"nofollow noreferrer\">this link</a> to be able to customize the ribbon. Then also look at <a href=\"http://www.rondebruin.nl/win/s2/win012.htm\" rel=\"nofollow noreferrer\">this as well</a> to be able to customize the default ribbon"}], "owner": {"reputation": 21, "user_id": 5620251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c48bf52f67648f60e99b7b2e5d878693?s=128&d=identicon&r=PG&f=1", "display_name": "Naveen", "link": "https://stackoverflow.com/users/5620251/naveen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2575, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1449060553, "creation_date": 1449060163, "last_edit_date": 1449060553, "question_id": 34043071, "link": "https://stackoverflow.com/questions/34043071/disable-home-and-other-ribbons-tabs-in-excel-using-vba", "title": "Disable Home and other ribbons tabs in excel using VBA", "body": "<p>We want to disable some of the ribbons tabs in Excel using VBA. But are unable to do so using VBA.</p>\n\n<p>We found out this below code but it hides the whole ribbon tab. But we want some of the controls to be enabled like Filters Fonts etc.</p>\n\n<pre><code>Application.ExecuteExcel4Macro \"Show.ToolBar(\"\"Ribbon\"\", False)\"\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 930, "user_id": 499486, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6ff3cd57318170e4bf342988eef9a3db?s=128&d=identicon&r=PG", "display_name": "DataWriter", "link": "https://stackoverflow.com/users/499486/datawriter"}, "is_accepted": false, "score": 0, "last_activity_date": 1449069054, "creation_date": 1449069054, "answer_id": 34046138, "question_id": 34042779, "link": "https://stackoverflow.com/questions/34042779/update-query-using-select-query-in-ms-access-vba/34046138#34046138", "title": "Update Query Using Select Query in MS Access VBA", "body": "<p>Access may not be immediately reflecting the changes you made to the table, unless you refresh the database window. </p>\n\n<p>Try adding the command <strong>Application.RefreshDatabaseWindow</strong> after you alter the tables and before you open the recordsets.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5630235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8245dcf0dd1ea20e8499224a985d78a?s=128&d=identicon&r=PG&f=1", "display_name": "Sanchi Sharma", "link": "https://stackoverflow.com/users/5630235/sanchi-sharma"}, "edited": false, "score": 0, "creation_date": 1449117159, "post_id": 34046306, "comment_id": 55869701, "body": "Thanks Andre.. Your last point did the trick. i will make further changes suggested by you."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1449069464, "creation_date": 1449069464, "answer_id": 34046306, "question_id": 34042779, "link": "https://stackoverflow.com/questions/34042779/update-query-using-select-query-in-ms-access-vba/34046306#34046306", "title": "Update Query Using Select Query in MS Access VBA", "body": "<p>Please remove <code>On Error Resume Next</code> from your code. Then fix all errors that you will get. E.g. </p>\n\n<ul>\n<li>missing space before ADD: <code>&amp; \"ADD Column [LOB] Text;\"</code></li>\n<li>adding [LOB] twice</li>\n<li>missing space after FROM: <code>(\"Select Field5 from\" &amp; \"[\" &amp;</code></li>\n<li>you open sq2..4 but don't do anything with them</li>\n<li><code>db.Execute</code> without parameters</li>\n</ul>\n\n<p>Defining a variable <code>sTable = \"[\" &amp; objtbl.Name &amp; \"]\"</code> and using that everywhere would make your code much better readable.</p>\n\n<p>If Field3 is a text field, you probably need</p>\n\n<pre><code>\" .[Account] = '\" &amp; rs!Field3 &amp; \"';\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5630235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8245dcf0dd1ea20e8499224a985d78a?s=128&d=identicon&r=PG&f=1", "display_name": "Sanchi Sharma", "link": "https://stackoverflow.com/users/5630235/sanchi-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 524, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1449069464, "creation_date": 1449059315, "last_edit_date": 1449068932, "question_id": 34042779, "link": "https://stackoverflow.com/questions/34042779/update-query-using-select-query-in-ms-access-vba", "title": "Update Query Using Select Query in MS Access VBA", "body": "<p>I am trying to add 4 columns in all the tables of ms access (which i will import), and then update them on the basis of my select query result. However my update query is not working. Can anyone please have a look and let me know the solution</p>\n\n<p>Thanks </p>\n\n<pre><code>    Dim db As DAO.Database\n    Dim objtbl As DAO.TableDef\n    Dim sqlstr As String\n    Dim rs As DAO.Recordset\n    Dim sq2 As DAO.Recordset\n    Dim sq3 As DAO.Recordset\n    Dim sq4 As DAO.Recordset\n    Dim sq5 As DAO.Recordset\n    Set db = CurrentDb\n    On Error Resume Next\n    For Each objtbl In db.TableDefs\n    db.Execute \"ALTER TABLE \" &amp; \"[\" &amp; objtbl.Name &amp; \"]\" &amp; \" ADD COLUMN     [Account] Text;\"\n  db.Execute \"ALTER TABLE \" &amp; \"[\" &amp; objtbl.Name &amp; \"]\" &amp; \" ADD COLUMN [Account_Serial] Text;\"\n  db.Execute \"ALTER TABLE \" &amp; \"[\" &amp; objtbl.Name &amp; \"]\" &amp; \" ADD COLUMN [Invoice_Date] Text;\"\n  db.Execute \"ALTER TABLE \" &amp; \"[\" &amp; objtbl.Name &amp; \"]\" &amp; \"ADD Column [LOB] Text;\"\n  db.Execute \"ALTER TABLE \" &amp; \"[\" &amp; objtbl.Name &amp; \"]\" &amp; \"ADD Column [LOB] Text;\"\n  q = \"Select [Field3] from \" &amp; \"[\" &amp; objtbl.Name &amp; \"]\" &amp; \" Where \" &amp; \"[\" &amp; objtbl.Name &amp; \"].[Field1] = \"\"CUSTOMERRECORD\"\";\"\n  Set rs = CurrentDb.OpenRecordset(\"Select [Field3] from \" &amp; \"[\" &amp; objtbl.Name &amp; \"]\" &amp; \" Where \" &amp; \"[\" &amp; objtbl.Name &amp; \"].[Field1] = \"\"CUSTOMERRECORD\"\";\")\n  Set sq2 = CurrentDb.OpenRecordset(\"Select Field4 from \" &amp; \"[\" &amp; objtbl.Name &amp; \"]\" &amp; \"Where\" &amp; \"[\" &amp; objtbl.Name &amp; \"].[Field1] = \"\"CUSTOMERRECORD\"\";\")\n  Set sq3 = CurrentDb.OpenRecordset(\"Select Field5 from\" &amp; \"[\" &amp; objtbl.Name &amp; \"]\" &amp; \"Where\" &amp; \"[\" &amp; objtbl.Name &amp; \"].[Field1] = \"\"Customerrecord\"\";\")\n  Set sq4 = CurrentDb.OpenRecordset(\"Select Field6 from\" &amp; \"[\" &amp; objtbl.Name &amp; \"]\" &amp; \"Where\" &amp; \"[\" &amp; objtbl.Name &amp; \"].[Field1] = \"\"Customerrecord\"\";\")\n  db.Execute\n  db.Execute \"Update \" &amp; \"[\" &amp; objtbl.Name &amp; \"] SET \" &amp; \"[\" &amp; objtbl.Name &amp; \"].[Account] = \" &amp; rs!Field3 &amp; \";\"\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel", "pdf"], "answers": [{"tags": [], "owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "is_accepted": true, "score": 1, "last_activity_date": 1449065959, "creation_date": 1449065959, "answer_id": 34045027, "question_id": 34042575, "link": "https://stackoverflow.com/questions/34042575/multiple-word-doc-to-pdf-convert/34045027#34045027", "title": "Multiple Word Doc to pdf convert", "body": "<p>You are trying to use Microsoft Word code from Excel without a reference. Add a reference to <strong>Microsoft Word 15.0 Object Library</strong> and try this code</p>\n\n<pre><code>'Set a Reference to Microsoft Word 15.0 Object Library\nSub convertword()\n    Dim irow As Integer\n    Dim objWord As Word.Application\n    Dim newdoc As Word.Document\n    Set objWord = New Word.Application\n    objWord.Visible = True\n\n    irow = 4\n    Do While Cells(irow, 2) &lt;&gt; Empty\n        Set newdoc = objWord.Documents.Open(Cells(irow, 2).Value)\n        newdoc.ExportAsFixedFormat OutputFileName:=Cells(irow, 3).Value, _\n            ExportFormat:=wdExportFormatPDF\n        newdoc.Close (False)\n        irow = irow + 1\n    Loop\n    objWord.Quit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5995, "favorite_count": 0, "accepted_answer_id": 34045027, "answer_count": 1, "score": 0, "last_activity_date": 1518038753, "creation_date": 1449058691, "last_edit_date": 1531164843, "question_id": 34042575, "link": "https://stackoverflow.com/questions/34042575/multiple-word-doc-to-pdf-convert", "title": "Multiple Word Doc to pdf convert", "body": "<p>I was working with a vba code that will convert multiple word docs in a folder to individual pdf files.</p>\n\n<p>The problem is that I am not able to save the word file as pdf.</p>\n\n<p>Below is the  code:</p>\n\n<pre><code>        Sub convertword()\n\n\n        Dim Filename As String\n        Dim irow As Integer\n        Dim jsObj As Object\n        Dim NewFileName As String\n        Dim objWord As Object\n        Dim strDocName As String, strDocName1 As String, strDocName2 As String\n        Dim strMyPath As String\n\n\n        irow = 4\n        Do While Cells(irow, 2) &lt;&gt; Empty\n        Filename = Cells(irow, 2).Value\n        NewFileName = Cells(irow, 3).Value\n\n        Set objWord = CreateObject(\"word.Application\")\n        objWord.Visible = True\n\n        objWord.Documents.Open Filename\n\n        'Document.SaveAs Filename, wdFormatPDF\n\n        'ActiveDocument.Visible = True\n\n        ActiveDocument.ExportAsFixedFormat OutputFileName:=NewFileName, ExportFormat:=wdExportFormatPDF\n\n        'ActiveDocument.Close\n\n        irow = irow + 1\n        Loop\n        End Sub\n</code></pre>\n\n<p>The line <code>ActiveDocument.ExportAsFixedFormat OutputFileName:=NewFileName, ExportFormat:=wdExportFormatPDF</code> is giving error as \"This command is not available because no document is open\".</p>\n\n<p>I am able to open the doc but just not able to save the doc as pdf.\nThank you in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28384, "user_id": 648265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4d98e414a47934d66cb78bf73d0845ba?s=128&d=identicon&r=PG", "display_name": "ivan_pozdeev", "link": "https://stackoverflow.com/users/648265/ivan-pozdeev"}, "edited": false, "score": 0, "creation_date": 1449059622, "post_id": 34042560, "comment_id": 55840201, "body": "Probably a race condition. E.g. your code tries to do something while Excel is still busy with a previous request."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1449060274, "post_id": 34042560, "comment_id": 55840575, "body": "That <code>On Error Resume Next</code> is really not helping you. There are a lot of simple errors there - eg trying to create a sheet that already exists, and not specifying the correct sheet name."}, {"owner": {"reputation": 279, "user_id": 5607762, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fae4c4a7bf2793baa71cd24bdced10f5?s=128&d=identicon&r=PG&f=1", "display_name": "GohanP", "link": "https://stackoverflow.com/users/5607762/gohanp"}, "edited": false, "score": 0, "creation_date": 1449062335, "post_id": 34042560, "comment_id": 55841960, "body": "Ok, when I edited my code, the error appear. Thanks for suggest."}, {"owner": {"reputation": 279, "user_id": 5607762, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fae4c4a7bf2793baa71cd24bdced10f5?s=128&d=identicon&r=PG&f=1", "display_name": "GohanP", "link": "https://stackoverflow.com/users/5607762/gohanp"}, "edited": false, "score": 0, "creation_date": 1449065858, "post_id": 34042560, "comment_id": 55844377, "body": "But now I have problems with ranges. I described it in my question. Maybe someone would know what is the problem?"}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 1, "creation_date": 1449075903, "post_id": 34042560, "comment_id": 55851980, "body": "I think you can shorten code by setting border properties to all borders at once. Not one by one"}, {"owner": {"reputation": 279, "user_id": 5607762, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fae4c4a7bf2793baa71cd24bdced10f5?s=128&d=identicon&r=PG&f=1", "display_name": "GohanP", "link": "https://stackoverflow.com/users/5607762/gohanp"}, "edited": false, "score": 0, "creation_date": 1449150819, "post_id": 34042560, "comment_id": 55888452, "body": "Yes, I did that already, but this code is still really long, when I can&#39;t multiple ranges :/"}], "answers": [{"comments": [{"owner": {"reputation": 279, "user_id": 5607762, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fae4c4a7bf2793baa71cd24bdced10f5?s=128&d=identicon&r=PG&f=1", "display_name": "GohanP", "link": "https://stackoverflow.com/users/5607762/gohanp"}, "edited": false, "score": 0, "creation_date": 1449062406, "post_id": 34042734, "comment_id": 55842008, "body": "I edited my code like you suggest (now there is not any .activate and .select) but another problem occured. I edited my first post with question and described it."}], "tags": [], "owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "is_accepted": false, "score": 1, "last_activity_date": 1449059207, "creation_date": 1449059207, "answer_id": 34042734, "question_id": 34042560, "link": "https://stackoverflow.com/questions/34042560/code-work-properly-while-pressing-f8-and-doesnt-while-pressing-f5/34042734#34042734", "title": "Code work properly while pressing F8 and doesn&#39;t while pressing F5", "body": "<p>So your main problem will be here, where you activate worksheet and then working with it. </p>\n\n<pre><code>    For Each wsSheet In ActiveWorkbook.Worksheets\n    wsSheet.Activate\n    sDesignSheetName = sResourcesProjectName &amp; \"_Design_Execution\"\n\n    If wsSheet.Name = sDesignSheetName Then ' --- if that sheet already exists, then exit sub and go to next project\n        bSheetFound = True\n        Exit Sub\n    End If\n\nNext wsSheet\n</code></pre>\n\n<p>I suggest you to use better aproach in your code. Properly declare variables, and work with sheets and cells like relative objects and <strong>AVOID .activate and .select</strong></p>\n\n<p>In short therm use something like this. This approach is much more robust for you and readable. </p>\n\n<pre><code>Sub doSomething()\n\n    Dim myCuteSheet As Worksheet\n    Set myCuteSheet = Sheets(\"pinkRidignSheet\")\n\n    With myCuteSheet\n        .Range(.Cells(1,1),.Cells(5,5)) 'then do something with range\n        .Cells(15,20) 'do something with cell\n        .Columns (\"F\") 'do something with column\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 279, "user_id": 5607762, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fae4c4a7bf2793baa71cd24bdced10f5?s=128&d=identicon&r=PG&f=1", "display_name": "GohanP", "link": "https://stackoverflow.com/users/5607762/gohanp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449065770, "creation_date": 1449058644, "last_edit_date": 1531164843, "question_id": 34042560, "link": "https://stackoverflow.com/questions/34042560/code-work-properly-while-pressing-f8-and-doesnt-while-pressing-f5", "title": "Code work properly while pressing F8 and doesn&#39;t while pressing F5", "body": "<p>I have a code, which create sheets with some formats. I have a problem that formatting doesn't work properly (for example it changes color of different range or it doesn't merge cells).</p>\n\n<p>I thought that maybe I did something in wrong order or something like that so I started to press F8 from the beggining to very end. And while doing it, it made exactly a sheet like I wanted.</p>\n\n<p>My code is quite long coz there is many subs inside so I'll try to write how it works and insert important parts. If it won't be enought, I'll put here the rest of my code.</p>\n\n<ul>\n<li>It takes name of the first project from ResourcesProjects sheet. It is stored in sResourcesProjectName variable (it works properly)</li>\n<li><p>Next, it calls 3 subs which create 3 sheets: ResourceSheet, DesignExecutionSheet and RisksSheet.\nAll of this subs have code to create and format created sheet.\nFirst sub (ResourceSheet) works properly, formatting is exactly like I wanted.\nThe problem is with subs DesignExecutionSheet and RisksSheet. It is not formatted well when it goes by F5.</p>\n\n<pre><code>Private Sub DesignExecutionSheet()\n\nApplication.PrintCommunication = True\n' Application.ScreenUpdating = False\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\n\nOn Error Resume Next\n\nbSheetFound = False\n\nFor Each wsSheet In ActiveWorkbook.Worksheets\n    wsSheet.Activate\n    sDesignSheetName = sResourcesProjectName &amp; \"_Design_Execution\"\n\n    If wsSheet.Name = sDesignSheetName Then ' --- if that sheet already exists, then exit sub and go to next project\n        bSheetFound = True\n        Exit Sub\n    End If\n\nNext wsSheet\n\n    Sheets.Add.Name = sResourcesProjectName &amp; \"_Design_Execution\"\n    Sheets(sDesignSheetName).Activate\n\nCells.EntireColumn.Hidden = False\nCells.EntireRow.Hidden = False\n\nCaptions sResourcesProjectName &amp; \" Design &amp; Execution\", RGB(235, 241, 222)\n\nColumns(\"C:C\").ColumnWidth = 3\nColumns(\"D:D\").ColumnWidth = 25\nRows(\"8:8\").RowHeight = 25\nRows(\"12:12\").RowHeight = 25\nRows(\"17:17\").RowHeight = 25\n\nRange(\"C8:E8,C12:E12,C17:E17\").Select\n\nWith Selection\n    .HorizontalAlignment = xlLeft\n    .VerticalAlignment = xlCenter\n    .WrapText = False\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = True\nEnd With\nSelection.Font.Bold = True\nWith Selection.Font\n    .Name = \"Calibri\"\n    .Size = 12\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .Color = RGB(118, 147, 60)\nEnd With\n\nRange(\"C8:E8\").FormulaR1C1 = \"STATUS OF REQUIREMENTS\"\nRange(\"C12:E12\").FormulaR1C1 = \"TEST EXECUTION\"\nRange(\"C17:E17\").FormulaR1C1 = \"VIR/SCR\"\n\n    Range(\"9:9,10:10,13:13,14:14,15:15,18:18,19:19,20:20\").Select\nSelection.RowHeight = 20\nRange(\"C9:C10,C13:C15,C18:C20\").Select\nWith Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .Color = RGB(235, 241, 222)\nEnd With\nRange(\"C9:E10,C13:E15,C18:E20\").Select\nSelection.Borders(xlDiagonalDown).LineStyle = xlNone\nSelection.Borders(xlDiagonalUp).LineStyle = xlNone\nWith Selection.Borders(xlEdgeLeft)\n    .LineStyle = xlContinuous\n    .ThemeColor = 1\n    .TintAndShade = -0.349986266670736\n    .Weight = xlThin\nEnd With\nWith Selection.Borders(xlEdgeTop)\n    .LineStyle = xlContinuous\n    .ThemeColor = 1\n    .TintAndShade = -0.349986266670736\n    .Weight = xlThin\nEnd With\nWith Selection.Borders(xlEdgeBottom)\n    .LineStyle = xlContinuous\n    .ThemeColor = 1\n    .TintAndShade = -0.349986266670736\n    .Weight = xlThin\nEnd With\nWith Selection.Borders(xlEdgeRight)\n    .LineStyle = xlContinuous\n    .ThemeColor = 1\n    .TintAndShade = -0.349986266670736\n    .Weight = xlThin\nEnd With\nSelection.Borders(xlInsideVertical).LineStyle = xlNone\nSelection.Borders(xlInsideHorizontal).LineStyle = xlNone\nRange(\"A6\").Select\n\n\nRange(\"D9:D10,D13:D15,D18:D20\").Select\nWith Selection\n    .HorizontalAlignment = xlRight\n    .VerticalAlignment = xlCenter\n    .WrapText = False\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\n    .Font.Color = RGB(89, 89, 89)\nEnd With\nSelection.Font.Bold = True\n\nRange(\"D9\").Value = \"ASSIGNED TO IT&amp;V:\"\nRange(\"D10\").Value = \"COVERED BY IT&amp;V:\"\nRange(\"D13\").Value = \"EXECUTED:\"\nRange(\"D14\").Value = \"PASSED:\"\nRange(\"D15\").Value = \"FAILED:\"\nRange(\"D18\").Value = \"OPEN:\"\nRange(\"D19\").Value = \"CLOSED:\"\nRange(\"D20\").Value = \"VERIFIED:\"\n\nSheets(sDesignSheetName).Visible = xlSheetHidden\n\n\n'Application.ScreenUpdating = True\nApplication.DisplayAlerts = True\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre></li>\n</ul>\n\n<p>with RisksSheet() there is similar problem so I don't put here code from that sub.</p>\n\n<ul>\n<li><p>After calling this subs, there is only this in code:</p>\n\n<pre><code>'Application.ScreenUpdating = True\nApplication.DisplayAlerts = True\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre></li>\n</ul>\n\n<p>EDIT:</p>\n\n<p>I edited my code like Lubo\u0161 Suk suggested. Now the problem is different. By pressing F8 it works again properly, but by pressing F5 there is an error \"application defined or object defined error\" in line</p>\n\n<pre><code>    With Sheets(sDesignSheetName).Range(\"C8:E8,C12:E12,C17:E17\")\n</code></pre>\n\n<p>What is more, the error isn't appear when I set a breakpoint in main sub in line</p>\n\n<pre><code>   Call DesignExecutionSheet\n</code></pre>\n\n<p>and press F5 twice.</p>\n\n<p>I also figured out that when I don't multiple ranges (for example only \"C8:E8\" instead of \"C8:E8,C12:E12,C17:E17\") it also works.\nBut I have many ranges inside, the code will be very long if I'll divide all of that ranges.</p>\n\n<p>This is my code:</p>\n\n<pre><code>    Private Sub DesignExecutionSheet()\n\n    Application.PrintCommunication = True\n    ' Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n\n    'On Error Resume Next\n\n        bSheetFound = False\n\n        For Each wsSheet In ActiveWorkbook.Worksheets\n            'wsSheet.Activate\n            sDesignSheetName = sResourcesProjectName &amp; \"_Design_Execution\"\n\n            If wsSheet.Name = sDesignSheetName Then ' --- if that sheet already exists, then exit sub and go to next project\n                bSheetFound = True\n                Exit Sub\n            End If\n\n        Next wsSheet\n\n            Sheets.Add.Name = sResourcesProjectName &amp; \"_Design_Execution\"\n            'Sheets(sDesignSheetName).Activate\n\n        With Sheets(sDesignSheetName)\n\n            .Cells.EntireColumn.Hidden = False\n            .Cells.EntireRow.Hidden = False\n\n            Captions sResourcesProjectName &amp; \" Design &amp; Execution\", RGB(235, 241, 222)\n\n            .Columns(\"C:C\").ColumnWidth = 3\n            .Columns(\"D:D\").ColumnWidth = 25\n            .Rows(\"8:8\").RowHeight = 25\n            .Rows(\"12:12\").RowHeight = 25\n            .Rows(\"17:17\").RowHeight = 25\n        End With\n\n\n            With Sheets(sDesignSheetName).Range(\"C8:E8,C12:E12,C17:E17\")\n                .HorizontalAlignment = xlLeft\n                .VerticalAlignment = xlCenter\n                .WrapText = False\n                .Orientation = 0\n                .AddIndent = False\n                .IndentLevel = 0\n                .ShrinkToFit = False\n                .ReadingOrder = xlContext\n                .MergeCells = True\n                .Font.Bold = True\n            End With\n\n            With Sheets(sDesignSheetName).Range(\"C8:E8,C12:E12,C17:E17\").Font\n                .Name = \"Calibri\"\n                .Size = 12\n                .Strikethrough = False\n                .Superscript = False\n                .Subscript = False\n                .OutlineFont = False\n                .Shadow = False\n                .Underline = xlUnderlineStyleNone\n                .Color = RGB(118, 147, 60)\n            End With\n\n            Sheets(sDesignSheetName).Range(\"C8:E8\").FormulaR1C1 = \"STATUS OF REQUIREMENTS\"\n            Sheets(sDesignSheetName).Range(\"C12:E12\").FormulaR1C1 = \"TEST EXECUTION\"\n            Sheets(sDesignSheetName).Range(\"C17:E17\").FormulaR1C1 = \"VIR/SCR\"\n\n\n            Sheets(sDesignSheetName).Range(\"9:9,10:10,13:13,14:14,15:15,18:18,19:19,20:20\").RowHeight = 20\n            With Sheets(sDesignSheetName).Range(\"C9:C10,C13:C15,C18:C20\").Interior\n                .Pattern = xlSolid\n                .PatternColorIndex = xlAutomatic\n                .Color = RGB(235, 241, 222)\n            End With\n            Sheets(sDesignSheetName).Range(\"C9:E10,C13:E15,C18:E20\").Borders(xlDiagonalDown).LineStyle = xlNone\n            Sheets(sDesignSheetName).Range(\"C9:E10,C13:E15,C18:E20\").Borders(xlDiagonalUp).LineStyle = xlNone\n            With Sheets(sDesignSheetName).Range(\"C9:E10,C13:E15,C18:E20\").Borders(xlEdgeLeft)\n                .LineStyle = xlContinuous\n                .ThemeColor = 1\n                .TintAndShade = -0.349986266670736\n                .Weight = xlThin\n            End With\n            With Sheets(sDesignSheetName).Range(\"C9:E10,C13:E15,C18:E20\").Borders(xlEdgeTop)\n                .LineStyle = xlContinuous\n                .ThemeColor = 1\n                .TintAndShade = -0.349986266670736\n                .Weight = xlThin\n            End With\n            With Sheets(sDesignSheetName).Range(\"C9:E10,C13:E15,C18:E20\").Borders(xlEdgeBottom)\n                .LineStyle = xlContinuous\n                .ThemeColor = 1\n                .TintAndShade = -0.349986266670736\n                .Weight = xlThin\n            End With\n            With Sheets(sDesignSheetName).Range(\"C9:E10,C13:E15,C18:E20\").Borders(xlEdgeRight)\n                .LineStyle = xlContinuous\n                .ThemeColor = 1\n                .TintAndShade = -0.349986266670736\n                .Weight = xlThin\n            End With\n            Sheets(sDesignSheetName).Range(\"C9:E10,C13:E15,C18:E20\").Borders(xlInsideVertical).LineStyle = xlNone\n            Sheets(sDesignSheetName).Range(\"C9:E10,C13:E15,C18:E20\").Borders(xlInsideHorizontal).LineStyle = xlNone\n           ' .Range(\"A6\").Select\n\n\n            With Sheets(sDesignSheetName).Range(\"D9:D10,D13:D15,D18:D20\")\n                .HorizontalAlignment = xlRight\n                .VerticalAlignment = xlCenter\n                .WrapText = False\n                .Orientation = 0\n                .AddIndent = False\n                .IndentLevel = 0\n                .ShrinkToFit = False\n                .ReadingOrder = xlContext\n                .MergeCells = False\n                .Font.Color = RGB(89, 89, 89)\n            End With\n            Sheets(sDesignSheetName).Range(\"D9:D10,D13:D15,D18:D20\").Font.Bold = True\n\n            Sheets(sDesignSheetName).Range(\"D9\").Value = \"ASSIGNED TO IT&amp;V:\"\n            Sheets(sDesignSheetName).Range(\"D10\").Value = \"COVERED BY IT&amp;V:\"\n            Sheets(sDesignSheetName).Range(\"D13\").Value = \"EXECUTED:\"\n            Sheets(sDesignSheetName).Range(\"D14\").Value = \"PASSED:\"\n            Sheets(sDesignSheetName).Range(\"D15\").Value = \"FAILED:\"\n            Sheets(sDesignSheetName).Range(\"D18\").Value = \"OPEN:\"\n            Sheets(sDesignSheetName).Range(\"D19\").Value = \"CLOSED:\"\n            Sheets(sDesignSheetName).Range(\"D20\").Value = \"VERIFIED:\"\n\n\n    Sheets(sDesignSheetName).Visible = xlSheetHidden\n\n\n    'Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    Application.EnableEvents = True\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "class", "excel"], "comments": [{"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1449056458, "post_id": 34041606, "comment_id": 55838217, "body": "I don&#39;t think Excel will write a one-dimensional array to a range (which is two-dimensional). You need to loop through your array and store the values in a 2D array, then write the 2D array to the range."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1449057568, "post_id": 34041606, "comment_id": 55838888, "body": "@ExcelDevelopers You can write a 1D array to a range - if it&#39;s a row it will work, if it&#39;s a column you just need to use <code>WorksheetFunction.Transpose()</code>"}], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1449060381, "post_id": 34041934, "comment_id": 55840661, "body": "Minor point: more efficient to just write to a 2D array in the first place rather than calling Transpose."}, {"owner": {"reputation": 115, "user_id": 4513792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WYnVt.png?s=128&g=1", "display_name": "Dave 2.71828", "link": "https://stackoverflow.com/users/4513792/dave-2-71828"}, "edited": false, "score": 0, "creation_date": 1449113093, "post_id": 34041934, "comment_id": 55868548, "body": "Thank you all very much for responding to my question, especially  Alex K. who had the most complete answer, Macro Man who noted the use of WorksheetFunction.Transpose() to flip the 1D row to a column, and Rory who noted an efficiency improvement in using an array configured as a single column:   Dim vals(0 to 1000, 1 to 1) as integer.  I have tried to upvote the answer, but I lack the 15 points of reputation needed.  I do thank you all very much!  Best regards, Dave"}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1449056672, "creation_date": 1449056672, "answer_id": 34041934, "question_id": 34041606, "link": "https://stackoverflow.com/questions/34041606/how-to-quickly-write-an-array-of-objects-out-to-a-worksheet-column/34041934#34041934", "title": "How to quickly write an array of objects out to a worksheet column?", "body": "<p>You need to loop as you must address each instance individually.  You can preload the values into an array and perform a <em>single</em> sheet update:</p>\n\n<pre><code>Dim MyArray(1 To 1000) As New cFoolish\n\nDim vals(1 To 1000) As Integer\nFor i = 1 To 1000\n    vals(i) = MyArray(i).ID\nNext\n\nThisWorkbook.Sheets(\"Test\").Range(\"A1:A1000\") = WorksheetFunction.Transpose(vals)\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 4513792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WYnVt.png?s=128&g=1", "display_name": "Dave 2.71828", "link": "https://stackoverflow.com/users/4513792/dave-2-71828"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 34041934, "answer_count": 1, "score": 1, "last_activity_date": 1449056672, "creation_date": 1449055664, "question_id": 34041606, "link": "https://stackoverflow.com/questions/34041606/how-to-quickly-write-an-array-of-objects-out-to-a-worksheet-column", "title": "How to quickly write an array of objects out to a worksheet column?", "body": "<p>In a large, many-property class named cFoolish is this code fragment:</p>\n\n<pre><code>''''' Property Definitions\nPrivate pID As Integer\nPublic Property Get ID() as Integer\n    ID = pID\nEnd Property\n</code></pre>\n\n<p>A code module declares a 1000 element array of cFoolish objects, and as part of a larger plan wants to write all 1000 .ID properties to a worksheet:</p>\n\n<pre><code>Public Sub Test()\n    Dim MyArray(1 To 1000) As New cFoolish\n    Dim rRange As Range\n\n    Set rRange = ThisWorkbook.Sheets(\"Test\").Range(\"A1:A1000\")\n    Set rRange.Value = MyArray.ID '''''clearly doesn't work!\nEnd Sub\n</code></pre>\n\n<p>I'm sorry, this is my first program using classes in VBA and I'm still pretty clueless.  The idea was to end up with the range A1:A1000 in worksheet \"Test\" be populated with the 1000 ID integers from the 1000 element array of cFoolish.</p>\n\n<p>Thank you for any help!\nDave</p>\n"}, {"tags": ["vba", "count", "character", "powerpoint"], "comments": [{"owner": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "edited": false, "score": 2, "creation_date": 1449057146, "post_id": 34041126, "comment_id": 55838612, "body": "what you are supposed to get by &#39;Chr(espace)&#39;? . i guess you want to do <code>space(espace)</code>"}, {"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "reply_to_user": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "edited": false, "score": 0, "creation_date": 1449057741, "post_id": 34041126, "comment_id": 55839000, "body": "@milevyo I am trying to write the number of the page of the slides (like table of contents) on the right side of the slide. I am tried the vbTab, but I dont get the numbers aligned. chr(espace) is supposed to put spaces between the titles and the page numbers (or so I thought). The error is before that chr() / space() confusion, so it doesn&#39;t read that far. (and this version is a modification of something that worked before, the page numbers were before the titles)"}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1449058463, "post_id": 34041126, "comment_id": 55839464, "body": "I am surprised this compiled/ran.  <code>titre</code> should be a string, which means the <code>set</code> should throw an error.  I think you wanted:  <code>titre = Diapo.Shapes.Title</code> <i>without</i> the <code>set</code>"}, {"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 1, "creation_date": 1449058794, "post_id": 34041126, "comment_id": 55839671, "body": "No, <code>titre</code> is not a string, it&#39;s a <code>Shape</code> object, so using <code>Set</code> is fine. However, since it is an object <code>Len()</code> will not work, you need to get the text from the shape to get the length."}], "answers": [{"comments": [{"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 0, "creation_date": 1449065679, "post_id": 34042659, "comment_id": 55844247, "body": "Can I do something like that but instead of getting the length, can I get the size of the string (in px or mm)?"}, {"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "reply_to_user": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 0, "creation_date": 1449065897, "post_id": 34042659, "comment_id": 55844405, "body": "Do you mean the font size? Or the size of the textbox?"}, {"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 0, "creation_date": 1449066484, "post_id": 34042659, "comment_id": 55844832, "body": "I mean the width of the string inside the textbox. I know that &quot;a&quot; doesn&#39;t have the same width as &quot;l&quot; does. So &quot;azerty&quot; isn&#39;t the same width as &quot;wwpmmm&quot; despite them both having 6 characters. In my presentation the size of the textbox is set as the width of the slide. I don&#39;t know if Im explaining it the right way, so, sorry for that."}, {"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 0, "creation_date": 1449068020, "post_id": 34042659, "comment_id": 55846015, "body": "Instead of length being expressed in number of character, would it be possible for it to be expressed in pixels or milimeters?"}, {"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "reply_to_user": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 0, "creation_date": 1449074117, "post_id": 34042659, "comment_id": 55850627, "body": "I see what you mean, but I don&#39;t know if it is possible,"}, {"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 0, "creation_date": 1449134840, "post_id": 34042659, "comment_id": 55877583, "body": "From what I gathered while searching, I don&#39;t think it is possible either (not by doing something simple). But thank you :)"}], "tags": [], "owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "is_accepted": true, "score": 2, "last_activity_date": 1449058964, "creation_date": 1449058964, "answer_id": 34042659, "question_id": 34041126, "link": "https://stackoverflow.com/questions/34041126/counting-the-number-of-characters-in-a-string/34042659#34042659", "title": "Counting the number of characters in a string", "body": "<p>Since <code>tietre</code> is a <code>Shape</code> object and not a string, <code>Len</code> will not work. You need to get the text from the shape to calculate the length, something like:</p>\n\n<pre><code>Set titre = Diapo.Shapes.Title\nnbcharac = Len(titre.TextFrame.TextRange.Text)\n</code></pre>\n\n<p>A lot of these problems can be prevented by using <code>Option Explicit</code> at the top of your module, which will force you to explicitly declare all variables, like <code>tietre</code> and <code>Diapo</code> (a <code>Slide</code> object) in your example, and show many of the problems at compile time instead of while running.</p>\n"}], "owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1209, "favorite_count": 0, "accepted_answer_id": 34042659, "answer_count": 1, "score": 0, "last_activity_date": 1449134896, "creation_date": 1449054187, "last_edit_date": 1449134896, "question_id": 34041126, "link": "https://stackoverflow.com/questions/34041126/counting-the-number-of-characters-in-a-string", "title": "Counting the number of characters in a string", "body": "<p>I am trying to get the number of characters from a variable using the Len() funtion, but vba says it doesn't recognise it. So I am wondering what is my mistake and how can I fix it?</p>\n\n<pre><code>Dim y As Long\nDim counthidden As Byte\nDim nbcharac As Long\nDim espace As Long\n\n'boucle sur toutes les diapos \u00e0 partir de la 2e\nFor y = 3 To ActivePresentation.Slides.Count\nSet Diapo = ActivePresentation.Slides(y)\n\nIf Diapo.SlideShowTransition.Hidden = msoTrue Then\ncounthidden = counthidden + 1\nEnd If\n'si la diapo a un titre\nIf Diapo.Shapes.HasTitle And Diapo.SlideShowTransition.Hidden = msoFalse Then\nSet titre = Diapo.Shapes.Title\nnbcharac = Len(titre)\nespace = 90 - nbcharac\ntexte_ajout = texte_ajout &amp; titre.TextFrame. _\nTextRange.Text &amp; space(espace) &amp; Format(y - counthidden, \"0\") &amp; vbCrLf\nEnd If\n\nNext y\n</code></pre>\n\n<p>Thank you in advance for your help\n(and also, if you know the number of characters that can fit into a powerpoint page, though I can test for that)</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1449056082, "post_id": 34041092, "comment_id": 55837978, "body": "I what line does the error occur?"}, {"owner": {"reputation": 25, "user_id": 5532643, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b59112facd447fa6fa53f000a313b4f1?s=128&d=identicon&r=PG&f=1", "display_name": "jaydub", "link": "https://stackoverflow.com/users/5532643/jaydub"}, "reply_to_user": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1449474042, "post_id": 34041092, "comment_id": 56005159, "body": "Hi there, sorry for the late reply. But I get it in the DelRange.Select line"}], "answers": [{"tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": true, "score": 1, "last_activity_date": 1454059389, "creation_date": 1454059389, "answer_id": 35080875, "question_id": 34041092, "link": "https://stackoverflow.com/questions/34041092/run-time-error-with-my-code-vba-word/35080875#35080875", "title": "Run time error with my code VBA Word", "body": "<p>You get the run time error probably because the <code>DelEndRange</code> was not found.</p>\n\n<p>Well in my testing this is what I found to be the problem.</p>\n\n<p>So check that the <code>EndWord</code> text is actually in the document.</p>\n"}], "owner": {"reputation": 25, "user_id": 5532643, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b59112facd447fa6fa53f000a313b4f1?s=128&d=identicon&r=PG&f=1", "display_name": "jaydub", "link": "https://stackoverflow.com/users/5532643/jaydub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 35080875, "answer_count": 1, "score": 0, "last_activity_date": 1459262477, "creation_date": 1449054085, "last_edit_date": 1459262477, "question_id": 34041092, "link": "https://stackoverflow.com/questions/34041092/run-time-error-with-my-code-vba-word", "title": "Run time error with my code VBA Word", "body": "<p>I get an error for the below code, every time I try run it with a data set of about 25 million words.it says \"Run-time error '91': object variable or With block variable not set\" could anyone please assist. The aim of the program is to find a start and an end and delete everything inbetween.</p>\n\n<pre><code>Sub SomeSub()\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    Dim StartWord As String, EndWord As String\n    Dim Find1stRange As Range, FindEndRange As Range\n    Dim DelRange As Range, DelStartRange As Range, DelEndRange As Range\n\n    'Setting up the Ranges\n    Set Find1stRange = ActiveDocument.Range\n    Set FindEndRange = ActiveDocument.Range\n    Set DelRange = ActiveDocument.Range\n\n    'Set your Start and End Find words here to cleanup the script\n    StartWord = \"From: Research.TA@traditionanalytics.com\"\n    EndWord = \"for malware by Websense. www.websense.com \"\n\n    'Starting the Find First Word\n    With Find1stRange.Find\n        .Text = StartWord\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindAsk\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    Application.ScreenUpdating = False\n        'Execute the Find\n        Do While .Execute\n            'If Found then do extra script\n            If .Found = True Then\n                'Setting the Found range to the DelStartRange\n                Set DelStartRange = Find1stRange\n                'Having these Selections during testing is benificial to test your script\n                DelStartRange.Select\n\n                'Setting the FindEndRange up for the remainder of the document form the end of the StartWord\n                FindEndRange.Start = DelStartRange.End\n                FindEndRange.End = ActiveDocument.Content.End\n\n                'Having these Selections during testing is benificial to test your script\n                FindEndRange.Select\n\n    Application.ScreenUpdating = False\n                'Setting the Find to look for the End Word\n                With FindEndRange.Find\n                    .Text = EndWord\n                    .Execute\n\n                    'If Found then do extra script\n                    If .Found = True Then\n                        'Setting the Found range to the DelEndRange\n                        Set DelEndRange = FindEndRange\n\n                        'Having these Selections during testing is benificial to test your script\n                        DelEndRange.Select\n\n                    End If\n\n                End With\n\n                'Selecting the delete range\n                DelRange.Start = DelStartRange.Start\n                DelRange.End = DelEndRange.End\n                'Having these Selections during testing is benificial to test your script\n                DelRange.Select\n\n                'Remove comment to actually delete\n                DelRange.Delete\n\n\n\n            End If      'Ending the If Find1stRange .Found = True\n        Loop        'Ending the Do While .Execute Loop\n    End With    'Ending the Find1stRange.Find With Statement\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2013", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5629812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a9490a3875ffd073b3646745aaace52?s=128&d=identicon&r=PG&f=1", "display_name": "Twin2", "link": "https://stackoverflow.com/users/5629812/twin2"}, "edited": false, "score": 0, "creation_date": 1449137909, "post_id": 34042511, "comment_id": 55879648, "body": "Hi Thank you so much for helping, I do appreciate it. I have done the change to the retvalue, but now I have the following:Dim strFileAndPath As String      retvalue = ActiveWorkbook.FullName &#39;Locals store this as &quot;C:\\Users\\name\\Desktop&quot;     strFileAndPath = retvalue &#39; Locals store this as &quot;C:\\Users\\name\\Desktop\\test ec.xlsx&quot;     Set finalFile = ActiveWorkbook     retvalue = Application.ActiveWorkbook.Path  &#39;Locals store this as &quot;C:\\Users\\name\\Desktop which is weird as this is not the full path shown above.     &#39;This later causes a problem with the msg box only showing Desktop"}, {"owner": {"reputation": 1, "user_id": 5629812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a9490a3875ffd073b3646745aaace52?s=128&d=identicon&r=PG&f=1", "display_name": "Twin2", "link": "https://stackoverflow.com/users/5629812/twin2"}, "edited": false, "score": 0, "creation_date": 1449138682, "post_id": 34042511, "comment_id": 55880224, "body": "I had conducted the msg box change:   answer = MsgBox(retvalue &amp; vbNewLine &amp; &quot;Please confirm that this is the file name you wish to change the entity names?&quot;, vbYesNo, &quot;Change Entity Names&quot;)  However, due to the first sub, I get a run-time error 9 as:   Workbooks(retvalue).Select  &#39;The value being held is &quot;Desktop&quot;.  Do you know how I may fix this, it needs to go back to the original file - unsure if it needs just the file name or file path to do this?"}, {"owner": {"reputation": 1, "user_id": 5629812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a9490a3875ffd073b3646745aaace52?s=128&d=identicon&r=PG&f=1", "display_name": "Twin2", "link": "https://stackoverflow.com/users/5629812/twin2"}, "edited": false, "score": 0, "creation_date": 1449138689, "post_id": 34042511, "comment_id": 55880232, "body": "Equally I am unsure how to store retvalue as a string and a workbook. I understand that you advise I should set this as Worksheet - shouldn&#39;t this be workbook?   As the change would have to be applied to several sheets in the workbook and I would not know how many sheets or the names being held by the user. Hence why I just wanted to store the workbook to then switch to this file to conduct the change wherever it sees the values to change.  Many thanks again for your help, I await to hear from you."}, {"owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "reply_to_user": {"reputation": 1, "user_id": 5629812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a9490a3875ffd073b3646745aaace52?s=128&d=identicon&r=PG&f=1", "display_name": "Twin2", "link": "https://stackoverflow.com/users/5629812/twin2"}, "edited": false, "score": 0, "creation_date": 1449172534, "post_id": 34042511, "comment_id": 55903188, "body": "Worksheet was just an example about not using <code>Active</code>. Please note the difference between <code>Workbook.FullName</code>(Including the name itself) and <code>Workbook.Path</code> (the location the Workbook is at). For the sake of clarity I suggest that you either edit your progress into the question or start a new one targeting the new issues."}], "tags": [], "owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "is_accepted": false, "score": 0, "last_activity_date": 1449058835, "last_edit_date": 1495542616, "creation_date": 1449058495, "answer_id": 34042511, "question_id": 34041052, "link": "https://stackoverflow.com/questions/34041052/how-to-get-file-path-switch-to-macro-file-then-back-to-the-original-active-work/34042511#34042511", "title": "How to get file path, switch to macro file then back to the original active workbook to execute code", "body": "<p>Welcome to StackOverflow, and congratulations to asking this detailed. Regarding your question(s):</p>\n\n<ol>\n<li>As far as I can see, <code>retvalue</code> has a proper value stored inside (You display it in the MsgBox, and you're not saying that it won't work there). I only see a problem in the code you commented out: <code>Workbooks(\"retvalue\").Activate</code> will look for a Workbook <em>named</em> \"retvalue\". To reference the value currently stored inside the variable <code>retvalue</code>, use <code>Workbooks(retvalue).Select</code> without the quotation marks.</li>\n<li>To store the result of a MsgBox inside a variable, you need to actively do so. If you look at your code, you will notice that you never assign a value to <code>answer</code>. Change this to <code>answer = MsgBox(retvalue &amp; vbNewLine &amp; ...)</code>. Notice the brackets!</li>\n</ol>\n\n<p>One last thought: In VBA, <code>.Activate</code> isn't your friend very often. In almost every case you'll be better off if you store the thing you're activating inside a variable (e.g. <code>Dim ws as Worksheet</code>), assign that variable (<code>Set ws = ThisworkBook.Sheets(\"Sheetname\")</code>) and then address it by using the <code>.Value</code>-property (e.g. <code>ws.Cells(1,1).Value</code>). This will save you a lot of confusion and preventable errors. For more information on this. see <a href=\"https://stackoverflow.com/q/12426794/4600127\" title=\"this thread on SO\">this thread on SO</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 5629812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a9490a3875ffd073b3646745aaace52?s=128&d=identicon&r=PG&f=1", "display_name": "Twin2", "link": "https://stackoverflow.com/users/5629812/twin2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1331, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449058835, "creation_date": 1449053972, "last_edit_date": 1531164843, "question_id": 34041052, "link": "https://stackoverflow.com/questions/34041052/how-to-get-file-path-switch-to-macro-file-then-back-to-the-original-active-work", "title": "How to get file path, switch to macro file then back to the original active workbook to execute code", "body": "<p>This is my first query posted online. I hope someone can help. Forgive me in advance, as I am no expert and in the <strong><em>very early stages of learning excel vba</em></strong>.</p>\n\n<p>I would appreciate if you could provide any help on the following. Any suggestions of improvement of codes is always welcome too!.</p>\n\n<p><strong>Overview of the objective of code:</strong></p>\n\n<p><strong>a)</strong> User will open the excel file 'Entity List Change' which has the vba and table contents - find and replace.</p>\n\n<p><strong>b)</strong> User will open the file they want to have text replaced by another value. The user will then click on Ctrl Q to execute the code held in 'Entity List Change' - I presume adding this on the options section of the macro will do this.</p>\n\n<p><strong>c)</strong> The code would then store the workbook name and file path of the one they want the details to be changed.</p>\n\n<p><strong>d)</strong> The code will then ask the user to confirm that the file which the code should be executed against using yes or no query.</p>\n\n<p><strong>e)</strong> If yes, then it will go to the 'Entity List Change' file to obtain array then excute the code against the original workbook held in the first sub.</p>\n\n<p><strong><em>I have the following problems:</em></strong></p>\n\n<p>1) I cannot seem to recall the workbook after switching workbooks to Entity Change name file \u2013 it cannot read the original workbook stored in first sub procedure. (Note I would not know what file is being used in the first instance).</p>\n\n<p>2) Msg box recognising yes selection by user it ignores running the function and goes straight to the else \u2013 do nothing procedure. \u2013 why I have no idea??\nIt recognises Yes as 0 and No as 0</p>\n\n<pre><code>**Excel VBA Code:**\n\nOption Explicit\nPublic retvalue As String ' hold the stored value so I can reuse it in a sub procedure.\nDim finalFile As Workbook\n\nPublic Sub GetFilePath() ' want to hold variable publicly so it can be reused.\n    Dim strFileAndPath As String\n    retvalue = ActiveWorkbook.FullName\n    strFileAndPath = retvalue\n    Set finalFile = ActiveWorkbook\n    retvalue = Application.ActiveWorkbook.Path\n    'finalFile = Application.ActiveWorkbook.Name this creates a 438 error, cannot use - unsure how to fix this?\n    'Debug.Print retvalue  '********************(first check)\n    'personal note if you have the string in the public then you do not need to hold it anywhere else.\n    'this part of the code works, retvalue hold the path and strFileAndPath hold the complete path and file name. FinalFile does store the activeworkbook at a workbook. - checked Locals window!\nEnd Sub\n\nSub Multi_FindReplace()\n'Note this code will not work if there are formula errors, these cells will be omitted from the change. - tested!\n\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = False\n\nDim sht As Worksheet\nDim fndList As Integer\nDim rplcList As Integer\nDim tbl As ListObject\nDim myArray As Variant\nDim ActiveOrgFilePath As String\nDim answer As Integer\nDim TempArray As Variant\nDim x As Integer\nDim strFileName As Workbook\n\n'Store and get the file name of the active workbook.\nCall GetFilePath\n\n''Debug.Print retvalue '********************(second check)\n'Convert the string (file path) to workbook name\nretvalue = Split(retvalue, \"\\\")(UBound(Split(retvalue, \"\\\")))\n\n'Confirm that this is the file you would like the change to occur.\nMsgBox retvalue &amp; vbNewLine &amp; \"Please confirm that this is the file name you wish to change the entity names?\", vbYesNo, \"Change Entity Names\"\n\n'if you wanted the file name to be held after the msg\nIf answer = vbYes Then\n    Debug.Print answer '********************(second check)\n'file with table array identified to obtain array information:\n    Windows(\"Entity List Change.xlsm\").Activate  'Obtain code and array from Macro workbook.\n'Create variable to point to your table\n    Set tbl = Worksheets(\"Sheet1\").ListObjects(\"EntityList1\")\n'Create an Array out of the Table's Data\n    Set TempArray = tbl.DataBodyRange\n    myArray = Application.Transpose(TempArray)\n'Designate Columns for Find/Replace data\n    fndList = 1\n    rplcList = 2\n'Then to go to the original workbook held at the beginning held in 'retvalue', to loop through all sheets in the workbook find values as per those held in Entity List Change.xlsm,\n'once found then replace the values in workbook 'retvalue'\n    Set finalFile = ActiveWorkbook\n'finalFile = Application.ActiveWorkbook.Name cannot use, not recognised in first sub procedure?\n'Windows(finalFile).Activate\n'Workbooks(\"retvalue\").Select\n'Windows(\"finalFile\").Activate\n'None of these are not working??\n\n'Loop through each item in Array lists\n    For x = LBound(myArray, 1) To UBound(myArray, 2)\n'Loop through each worksheet in ActiveWorkbook (skip sheet with table in it)\n        For Each sht In ActiveWorkbook.Worksheets\n            If sht.Name &lt; tbl.Parent.Name Then\n                sht.Cells.Replace What:=myArray(fndList, x), Replacement:=myArray(rplcList, x), _\n                LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n                SearchFormat:=False, ReplaceFormat:=False\n            End If\n        Next sht\n    Next x\n    MsgBox \"The Entity name change has been completed.\" &amp; vbNewLine &amp; \"Thank you for your patience.\"\nElse\n'do nothing\n    MsgBox \"The Entity name change has not been completed.\" &amp; vbNewLine &amp; \"Please find and open the correct file to make the change.\"\nEnd If\n\nApplication.ScreenUpdating = True\nApplication.DisplayStatusBar = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1449052010, "post_id": 34040258, "comment_id": 55835279, "body": "Can you add your code plz? Edit your post to include it ;)"}, {"owner": {"reputation": 108, "user_id": 5529341, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-g-Ro6ynLZbs/AAAAAAAAAAI/AAAAAAAAADk/soqpFDFxx1c/photo.jpg?sz=128", "display_name": "Touqeer", "link": "https://stackoverflow.com/users/5529341/touqeer"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1449056362, "post_id": 34040258, "comment_id": 55838151, "body": "@R3uK please have a look at code."}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1449116209, "post_id": 34040258, "comment_id": 55869457, "body": "In <code>ActiveChart.ChartWizard</code>, simply change <code>PlotBy:=xlRows</code> to <code>PlotBy:=xlColumns</code>."}, {"owner": {"reputation": 108, "user_id": 5529341, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-g-Ro6ynLZbs/AAAAAAAAAAI/AAAAAAAAADk/soqpFDFxx1c/photo.jpg?sz=128", "display_name": "Touqeer", "link": "https://stackoverflow.com/users/5529341/touqeer"}, "reply_to_user": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1449123972, "post_id": 34040258, "comment_id": 55872045, "body": "The code <code>ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select     ActiveChart.SetSourceData Source:=Range(myrange)</code> works.I want to ask one more thing.How i can group my data in chart.For example if i have two products in country america then i want it to group by in such a way that america should appear once with two products.Hope you understand  @Jon Peltier.<a href=\"http://peltiertech.com/chart-with-a-dual-category-axis/\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1449236236, "post_id": 34040258, "comment_id": 55931190, "body": "I don&#39;t know exactly what you want without seeing the data and chart. Usually you have to accomplish the grouping in the data, not in the chart."}], "answers": [{"comments": [{"owner": {"reputation": 108, "user_id": 5529341, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-g-Ro6ynLZbs/AAAAAAAAAAI/AAAAAAAAADk/soqpFDFxx1c/photo.jpg?sz=128", "display_name": "Touqeer", "link": "https://stackoverflow.com/users/5529341/touqeer"}, "edited": false, "score": 0, "creation_date": 1449124045, "post_id": 34041305, "comment_id": 55872077, "body": "The code <code>ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select     ActiveChart.SetSourceData Source:=Range(myrange)</code> works.I want to ask one more thing.How i can group my data in chart.For example if i have two products in country america then i want it to group by in such a way that america should appear once with two products.Hope you understand  @Vimalraj Selvam.<a href=\"http://peltiertech.com/chart-with-a-dual-category-axis/\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1449236354, "post_id": 34041305, "comment_id": 55931285, "body": "It&#39;s a good idea to explicitly add <code>PlotBy</code> to <code>SetSourceData</code>, and not rely on the default being what you want (I&#39;ve edited the answer to reflect this)."}], "tags": [], "owner": {"reputation": 1915, "user_id": 1505987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d44a854fdc6e93248d52602a208f6252?s=128&d=identicon&r=PG", "display_name": "Vimalraj Selvam", "link": "https://stackoverflow.com/users/1505987/vimalraj-selvam"}, "is_accepted": true, "score": 0, "last_activity_date": 1449236345, "last_edit_date": 1449236345, "creation_date": 1449054723, "answer_id": 34041305, "question_id": 34040258, "link": "https://stackoverflow.com/questions/34040258/how-to-make-an-excel-chart-with-vba-that-have-two-category-axis/34041305#34041305", "title": "How to make an Excel chart with vba that have two category axis", "body": "<p>It's very simple in Excel. Record a macro while inserting the chart and selecting the data for the chart. The recorder records the VBA steps and gives you the neat code which can do the same whenever you execute. For instance, the recorder gave me this 2 lines of code:</p>\n\n<pre><code>Sub Macro1()\n\n    ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n    ActiveChart.SetSourceData Source:=Range(\"A2:C5\"), PlotBy:=xlColumns\n\nEnd Sub\n</code></pre>\n\n<p>Pretty simple, isn't it?</p>\n"}, {"tags": [], "owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "is_accepted": false, "score": 0, "last_activity_date": 1449058836, "creation_date": 1449058836, "answer_id": 34042621, "question_id": 34040258, "link": "https://stackoverflow.com/questions/34040258/how-to-make-an-excel-chart-with-vba-that-have-two-category-axis/34042621#34042621", "title": "How to make an Excel chart with vba that have two category axis", "body": "<p>If you just wana to update data in already existing chart, better solution can be to update them. Basicaly create chart which you desire and assign some name to it. (for example myLovelyChart)</p>\n\n<pre><code>Sub updateChartSO()\n\n        Dim chartSheet As Worksheet\n        Set chartSheet = Sheets(\"testSheet\")\n\n        Dim chtSerie As Series\n\n        With chartSheet\n            For Each chtSerie In .ChartObjects(\"myLovelyChart\").SeriesCollection\n\n                'specify your values, can be specified by array or even from sheet'\n                chtSerie.Values = \"\"\n                chtSerie.XValues = \"\"\n            Next\n\n        End With\n\n\nEnd Sub\n</code></pre>\n\n<p>Or if you really wana to create new chart, take a closer look at <code>chartType</code> property (<a href=\"https://msdn.microsoft.com/en-us/library/office/ff820803.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff820803.aspx</a>) and its enumeration (<a href=\"https://msdn.microsoft.com/en-us/library/office/ff838409.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff838409.aspx</a>)</p>\n"}, {"tags": [], "owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1449069053, "creation_date": 1449069053, "answer_id": 34046135, "question_id": 34040258, "link": "https://stackoverflow.com/questions/34040258/how-to-make-an-excel-chart-with-vba-that-have-two-category-axis/34046135#34046135", "title": "How to make an Excel chart with vba that have two category axis", "body": "<p>In VBA, it auto define the format based on data range.</p>\n\n<p>However, You can using below code to control it</p>\n\n<pre><code>Chart(1).PlotBy = xlRows\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>Chart(1).PlotBy = xlColumns\n</code></pre>\n"}], "owner": {"reputation": 108, "user_id": 5529341, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-g-Ro6ynLZbs/AAAAAAAAAAI/AAAAAAAAADk/soqpFDFxx1c/photo.jpg?sz=128", "display_name": "Touqeer", "link": "https://stackoverflow.com/users/5529341/touqeer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 505, "favorite_count": 0, "accepted_answer_id": 34041305, "answer_count": 3, "score": 0, "last_activity_date": 1449236345, "creation_date": 1449051819, "last_edit_date": 1449056260, "question_id": 34040258, "link": "https://stackoverflow.com/questions/34040258/how-to-make-an-excel-chart-with-vba-that-have-two-category-axis", "title": "How to make an Excel chart with vba that have two category axis", "body": "<p>I have data in excel sheet like this</p>\n\n<pre><code>Country Product Price\nAmerica A   43\nChina   B   13\nGermany C   21\nTurkey  D   12\n</code></pre>\n\n<p>In excel i select this data and make a chart out of it that seems like this</p>\n\n<p><img src=\"https://i.stack.imgur.com/W8zlN.jpg\" alt=\"Graph from excel\"></p>\n\n<p>But the problem is when i select the same data with vba and draw the chart from vba then it results into</p>\n\n<p><img src=\"https://i.stack.imgur.com/h9PM8.jpg\" alt=\"Graph from vba\"></p>\n\n<p>Now i want the vba chart to display to category axis as same as we select data from excel and draw the chart.</p>\n\n<p>In short i want the vba chart to automatically adjust according to the data.</p>\n\n<p>Here is the code.</p>\n\n<pre><code>Sub CreateChart()\n\n         Range(\"a1\").Select\n         Selection.CurrentRegion.Select\n         myrange = Selection.Address\n         mysheetname = ActiveSheet.Name\n\n         Worksheets(1).Activate\n         'ActiveWindow.DisplayGridlines = False\n\n         ' Add a chart to the active sheet.\n         ActiveSheet.ChartObjects.Add(125.25, 60, 301.5, 155.25).Select\n         Application.CutCopyMode = False\n\n         ActiveChart.ChartWizard _\n            Source:=Sheets(mysheetname).Range(myrange), _\n            Gallery:=xlColumnStacked, Format:=10, PlotBy:=xlRows, _\n            CategoryLabels:=1, SeriesLabels:=1, HasLegend:=1, _\n            Title:=charttitle, CategoryTitle:=chartcategory, _\n            ValueTitle:=chartvalue, ExtraTitle:=\"\"\n\n      End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "reply_to_user": {"reputation": 5527, "user_id": 4082955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e670bd7627dcaaceead20dfdc02a7589?s=128&d=identicon&r=PG&f=1", "display_name": "Fratyx", "link": "https://stackoverflow.com/users/4082955/fratyx"}, "edited": false, "score": 0, "creation_date": 1449051950, "post_id": 34040193, "comment_id": 55835234, "body": "Edited it, so the error shows in the screen."}, {"owner": {"reputation": 5527, "user_id": 4082955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e670bd7627dcaaceead20dfdc02a7589?s=128&d=identicon&r=PG&f=1", "display_name": "Fratyx", "link": "https://stackoverflow.com/users/4082955/fratyx"}, "edited": false, "score": 0, "creation_date": 1449052206, "post_id": 34040193, "comment_id": 55835417, "body": "Just count your <code>If</code>s and your <code>End If</code>s and you will see it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1449054686, "post_id": 34040193, "comment_id": 55837100, "body": "See <a href=\"http://tinyurl.com/kdxb7le\" rel=\"nofollow noreferrer\">Why Not Images of Code and Sample Data</a>."}], "answers": [{"tags": [], "owner": {"reputation": 377, "user_id": 4685271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wrtXb.jpg?s=128&g=1", "display_name": "MaxD", "link": "https://stackoverflow.com/users/4685271/maxd"}, "is_accepted": false, "score": 2, "last_activity_date": 1449052224, "creation_date": 1449052224, "answer_id": 34040417, "question_id": 34040193, "link": "https://stackoverflow.com/questions/34040193/compilation-error-in-vba/34040417#34040417", "title": "Compilation error in VBA", "body": "<p>Your \"If Not Rng Is Nothing Then\" is missing an \"End If\"</p>\n\n<p>It should be more obvious if you indent correctly your code.</p>\n"}, {"comments": [{"owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "edited": false, "score": 0, "creation_date": 1449053200, "post_id": 34040418, "comment_id": 55836104, "body": "Thanks for making the way to think about indentation clear to me. Second good answer on one of my questions, hero."}, {"owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "reply_to_user": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "edited": false, "score": 0, "creation_date": 1449057820, "post_id": 34040418, "comment_id": 55839053, "body": "@RobExcel you&#39;re welcome :-) One more thing: Please try to add Code in writing rather than as screenshot. This makes it easier for us to try around with it without having to type everything from scratch!"}], "tags": [], "owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "is_accepted": true, "score": 2, "last_activity_date": 1449052226, "creation_date": 1449052226, "answer_id": 34040418, "question_id": 34040193, "link": "https://stackoverflow.com/questions/34040193/compilation-error-in-vba/34040418#34040418", "title": "Compilation error in VBA", "body": "<p>As the error message is telling you, you are missing one <code>End If</code>-Statement: You are opening three <code>If</code>-Cases, but close only two of them. (I guess you want to put the missing one before the line saying <code>If not Rng Is Nothing Then</code>, thus closing the statement <code>If Trim(FindString) &lt;&gt; \"\" Then</code>)</p>\n\n<p>For the future: Proper indentation of your code will help you spot errors like this easily!</p>\n"}], "owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 34040418, "answer_count": 2, "score": 0, "last_activity_date": 1449052226, "creation_date": 1449051623, "last_edit_date": 1449051937, "question_id": 34040193, "link": "https://stackoverflow.com/questions/34040193/compilation-error-in-vba", "title": "Compilation error in VBA", "body": "<p>Goodmorning from Holland,</p>\n\n<p>I'm just n00bing around VBA, and keep bumping in to said compilation error as seen in this screenshot; <a href=\"https://i.stack.imgur.com/s4NML.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s4NML.png\" alt=\"Screenshot\"></a>\nI would like to see this solved, but i want to learn how to kill these horrible errors. What is my mistake?</p>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1449054834, "post_id": 34039906, "comment_id": 55837206, "body": "See <a href=\"http://tinyurl.com/kdxb7le\" rel=\"nofollow noreferrer\">Why Not Images of Code and Sample Data</a>."}], "answers": [{"comments": [{"owner": {"reputation": 2564, "user_id": 610607, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3AbIP.jpg?s=128&g=1", "display_name": "Mian Asbat Ahmad", "link": "https://stackoverflow.com/users/610607/mian-asbat-ahmad"}, "edited": false, "score": 0, "creation_date": 1449053881, "post_id": 34040353, "comment_id": 55836552, "body": "Thanks a lot. Is it not possible to do it in one formula (combine them) because there are a lot of columns with similar date type and it will be a bit tedious to split each of them in year, month and day column and then combine them."}, {"owner": {"reputation": 9170, "user_id": 5039142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rm38D.png?s=128&g=1", "display_name": "G42", "link": "https://stackoverflow.com/users/5039142/g42"}, "reply_to_user": {"reputation": 2564, "user_id": 610607, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3AbIP.jpg?s=128&g=1", "display_name": "Mian Asbat Ahmad", "link": "https://stackoverflow.com/users/610607/mian-asbat-ahmad"}, "edited": false, "score": 0, "creation_date": 1449136492, "post_id": 34040353, "comment_id": 55878723, "body": "It is; replace <code>B2</code>,<code>C2</code> and <code>D2</code> in cell <code>E2</code> with the equations in those cells. This becomes <code>=DATE(RIGHT(A2,4),MONTH(DATEVALUE(RIGHT(LEFT(A2,7),3)&amp;&quot;1&quot;)),&zwnj;&#8203;RIGHT(LEFT(A2,10),2)&zwnj;&#8203;)</code>"}], "tags": [], "owner": {"reputation": 9170, "user_id": 5039142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rm38D.png?s=128&g=1", "display_name": "G42", "link": "https://stackoverflow.com/users/5039142/g42"}, "is_accepted": false, "score": 1, "last_activity_date": 1449052059, "creation_date": 1449052059, "answer_id": 34040353, "question_id": 34039906, "link": "https://stackoverflow.com/questions/34039906/how-can-i-convert-the-date-column-to-a-different-builtin-date-type-in-excel-thu/34040353#34040353", "title": "How can I convert the date column to a different builtin date type in excel (Thu Aug 04 00:00:00 BST 1983)", "body": "<p>You can use Excel's <code>DATE()</code> function to do this. This takes year, month and day as values. There is some manipulation required to your date to get these values.</p>\n\n<p>Please see below. 3rd row shows values: <code>30532</code> becomes <code>1983-08-04</code> when it is formatted (show formulae is on so you can see 2nd row)</p>\n\n<p><a href=\"https://i.stack.imgur.com/dmyOz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dmyOz.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 2564, "user_id": 610607, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3AbIP.jpg?s=128&g=1", "display_name": "Mian Asbat Ahmad", "link": "https://stackoverflow.com/users/610607/mian-asbat-ahmad"}, "edited": false, "score": 0, "creation_date": 1449055351, "post_id": 34040571, "comment_id": 55837530, "body": "Just to add that the column B in above case must be date type to work it properly."}, {"owner": {"reputation": 2564, "user_id": 610607, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3AbIP.jpg?s=128&g=1", "display_name": "Mian Asbat Ahmad", "link": "https://stackoverflow.com/users/610607/mian-asbat-ahmad"}, "edited": false, "score": 0, "creation_date": 1449057235, "post_id": 34040571, "comment_id": 55838670, "body": "Do you know how can I replace #VALUE! with blank as formula output. I tried IFERROR(formula, 0) but it is not working"}, {"owner": {"reputation": 1915, "user_id": 1505987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d44a854fdc6e93248d52602a208f6252?s=128&d=identicon&r=PG", "display_name": "Vimalraj Selvam", "link": "https://stackoverflow.com/users/1505987/vimalraj-selvam"}, "reply_to_user": {"reputation": 2564, "user_id": 610607, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3AbIP.jpg?s=128&g=1", "display_name": "Mian Asbat Ahmad", "link": "https://stackoverflow.com/users/610607/mian-asbat-ahmad"}, "edited": false, "score": 0, "creation_date": 1449057387, "post_id": 34040571, "comment_id": 55838764, "body": "@Asbat: I guess you are asking about this: <a href=\"http://stackoverflow.com/questions/10689235/how-do-i-recognize-value-in-excel-spreadsheets\" title=\"how do i recognize value in excel spreadsheets\">stackoverflow.com/questions/10689235/&hellip;</a>"}, {"owner": {"reputation": 2564, "user_id": 610607, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3AbIP.jpg?s=128&g=1", "display_name": "Mian Asbat Ahmad", "link": "https://stackoverflow.com/users/610607/mian-asbat-ahmad"}, "edited": false, "score": 0, "creation_date": 1449057600, "post_id": 34040571, "comment_id": 55838901, "body": "Thanks. I used it wrong first I tried =IFERROR(Your_formula, 0) where as the correct one is =IFERROR(Your_formula, &quot;&quot;)"}], "tags": [], "owner": {"reputation": 1915, "user_id": 1505987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d44a854fdc6e93248d52602a208f6252?s=128&d=identicon&r=PG", "display_name": "Vimalraj Selvam", "link": "https://stackoverflow.com/users/1505987/vimalraj-selvam"}, "is_accepted": true, "score": 1, "last_activity_date": 1449052614, "creation_date": 1449052614, "answer_id": 34040571, "question_id": 34039906, "link": "https://stackoverflow.com/questions/34039906/how-can-i-convert-the-date-column-to-a-different-builtin-date-type-in-excel-thu/34040571#34040571", "title": "How can I convert the date column to a different builtin date type in excel (Thu Aug 04 00:00:00 BST 1983)", "body": "<p>In case your string in excel is <code>Thu Aug 04 00:00:00 BST 1983</code> with the same format, then you can try this:</p>\n\n<p><img src=\"https://i.imgur.com/y92PUf2.png\" alt=\"Excel Example\" title=\"example\"></p>\n\n<p>Then goto Custom format cells and select <code>Date</code> first and then select <code>Custom</code> and type <code>YYYY-MM-DD</code> to get the desired format.</p>\n"}], "owner": {"reputation": 2564, "user_id": 610607, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3AbIP.jpg?s=128&g=1", "display_name": "Mian Asbat Ahmad", "link": "https://stackoverflow.com/users/610607/mian-asbat-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 34040571, "answer_count": 2, "score": 0, "last_activity_date": 1449054040, "creation_date": 1449050733, "last_edit_date": 1531161705, "question_id": 34039906, "link": "https://stackoverflow.com/questions/34039906/how-can-i-convert-the-date-column-to-a-different-builtin-date-type-in-excel-thu", "title": "How can I convert the date column to a different builtin date type in excel (Thu Aug 04 00:00:00 BST 1983)", "body": "<p>I have an excel file in which the dob column contains entry of this type <code>Thu Aug 04 00:00:00 BST 1983</code>. I am trying to import the excel file in SQL-Server therefore I want to convert it to <code>YYYY-MM-DD</code> type. I tried the format cells option but it is not working. Any simple way of doing it or do I have to find regex for it? </p>\n\n<p>Here is the sample file.</p>\n\n<p><a href=\"https://i.stack.imgur.com/JHtLc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JHtLc.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "treeview"], "answers": [{"comments": [{"owner": {"reputation": 8189, "user_id": 4342479, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ba8f7b5222688205d3047ef8093c2608?s=128&d=identicon&r=PG&f=1", "display_name": "\u0110\u1ee9c Thanh Nguy\u1ec5n", "link": "https://stackoverflow.com/users/4342479/%c4%90%e1%bb%a9c-thanh-nguy%e1%bb%85n"}, "edited": false, "score": 0, "creation_date": 1449071120, "post_id": 34041232, "comment_id": 55848404, "body": "Thank you, I tried different approach now and It works."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 2, "last_activity_date": 1449054475, "creation_date": 1449054475, "answer_id": 34041232, "question_id": 34039831, "link": "https://stackoverflow.com/questions/34039831/populate-treeview-control-with-hierarchical-data-from-excel-sheet/34041232#34041232", "title": "Populate treeview control with hierarchical data from Excel Sheet", "body": "<p>I guess it's somewhere around here:</p>\n\n<pre><code>Set cNode = cNode.Child.AddChild(c.Offset(, 3).Value2, c.Offset(, 3).Value2)\n</code></pre>\n\n<p><code>cNode.Child</code> simply picks the first child of <code>cNode</code>, not the one you want.</p>\n\n<p>Notice how AP003 is the only node under TP002, because it is the case where TP002 is created.</p>\n\n<hr>\n\n<p>General note: The global <code>On Error Resume Next</code> might seem elegant to spare you the need of checking if a node already exists, but it will also mask any other errors that might come up.</p>\n\n<p>IMHO a better approach is to always check: does the parent node I need already exist?<br>\nIf yes, this gets you the node you need to add the child.<br>\nIf no, create it, and then you have the parent node too.</p>\n"}, {"tags": [], "owner": {"reputation": 8189, "user_id": 4342479, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ba8f7b5222688205d3047ef8093c2608?s=128&d=identicon&r=PG&f=1", "display_name": "\u0110\u1ee9c Thanh Nguy\u1ec5n", "link": "https://stackoverflow.com/users/4342479/%c4%90%e1%bb%a9c-thanh-nguy%e1%bb%85n"}, "is_accepted": true, "score": 2, "last_activity_date": 1449071092, "creation_date": 1449071092, "answer_id": 34046891, "question_id": 34039831, "link": "https://stackoverflow.com/questions/34039831/populate-treeview-control-with-hierarchical-data-from-excel-sheet/34046891#34046891", "title": "Populate treeview control with hierarchical data from Excel Sheet", "body": "<p>OK, I got it now.I know it's spaghetti code, but for now It works.</p>\n\n<p>For future-people, who may need this</p>\n\n<pre><code>lastRow = Sheet14.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n' root nodes\nFor Each c In Sheet14.Range(\"A2:A\" &amp; lastRow)\n    If cRoot Is Nothing Then\n        Set cRoot = .AddRoot(sKey:=c.Value2, vCaption:=c.Value2)\n        cRoot.Bold = True\n        currentRootKey = cRoot.key\n        Set cExtraNode = cRoot.AddChild(\"ML_\" &amp; c.Value2, \"Meilensteine\")\n        currentMLKey = cExtraNode.key\n    End If\n    If c.Value2 &lt;&gt; currentRootKey Then\n        Set cRoot = .AddRoot(sKey:=c.Value2, vCaption:=c.Value2)\n        cRoot.Bold = True\n        currentRootKey = cRoot.key\n\n        Set cExtraNode = cRoot.AddChild(\"ML_\" &amp; c.Value2, \"Meilensteine\")\n        currentMLKey = cExtraNode.key\n    End If\nNext\n' level 1 children\nFor Each c In Sheet14.Range(\"B2:B\" &amp; lastRow)\n    If Not IsEmpty(c.Value2) And c.Value2 &lt;&gt; currNodeKey Then\n        Set cNode = .Nodes(c.Offset(, -1).Value2)\n        Set cNode = cNode.AddChild(c.Value2, c.Value2)\n        currNodeKey = cNode.key\n    End If\nNext\n'level 2 children\nFor Each c In Sheet14.Range(\"C2:C\" &amp; lastRow)\n    If Not IsEmpty(c.Value2) And c.Value2 &lt;&gt; currNodeKey Then\n        Set cNode = .Nodes(c.Offset(, -1).Value2)\n        Set cNode = cNode.AddChild(c.Value2, c.Value2)\n        currNodeKey = cNode.key\n    End If\nNext\n'level 3 children\nFor Each c In Sheet14.Range(\"D2:D\" &amp; lastRow)\n    If Not IsEmpty(c.Value2) And c.Value2 &lt;&gt; currNodeKey Then\n        Set cNode = .Nodes(c.Offset(, -1).Value2)\n        Set cNode = cNode.AddChild(c.Value2, c.Value2)\n        currNodeKey = cNode.key\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 8189, "user_id": 4342479, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ba8f7b5222688205d3047ef8093c2608?s=128&d=identicon&r=PG&f=1", "display_name": "\u0110\u1ee9c Thanh Nguy\u1ec5n", "link": "https://stackoverflow.com/users/4342479/%c4%90%e1%bb%a9c-thanh-nguy%e1%bb%85n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8687, "favorite_count": 3, "accepted_answer_id": 34046891, "answer_count": 2, "score": 4, "last_activity_date": 1449071092, "creation_date": 1449050533, "last_edit_date": 1449050947, "question_id": 34039831, "link": "https://stackoverflow.com/questions/34039831/populate-treeview-control-with-hierarchical-data-from-excel-sheet", "title": "Populate treeview control with hierarchical data from Excel Sheet", "body": "<p>I am currently using a treeview control from <a href=\"http://www.jkp-ads.com/Articles/treeview.asp\" rel=\"nofollow noreferrer\" title=\"JKP\">Treeview Control from JKP</a>. Trying to populate the tree with hierarchical data from an Excel Sheet, I encountered this problem: the tree I populated does not reflect the data. In this picture <code>AP0004</code> should be under <code>TP0002</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/mcknM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mcknM.png\" alt=\"Populate a treeview control in VBA\"></a></p>\n\n<p>The code I've tried is this</p>\n\n<pre><code>For Each c In Sheet14.Range(\"A2:A\" &amp; Sheet14.Range(\"A\" &amp; Rows.Count).End(xlUp).Row)\n\n    On Error Resume Next\n    'Populate level 1\n    Set cRoot = .AddRoot(sKey:=c.Value2, vCaption:=c.Value2)\n\n    Set cExtraNode = cRoot.AddChild(\"ML_\" &amp; c.Value2, \"Meilensteine\")\n\n    'Populate level 2\n    Set cNode = cRoot.AddChild(c.Offset(, 1).Value2, c.Offset(, 1).Value2)\n\n    'Populate level 3\n    If cNode.Level = 2 Then Set cNode = cNode.ParentNode\n\n    If Not IsEmpty(c.Offset(, 2).Value2) Then\n        Set cNode = cNode.AddChild(c.Offset(, 2).Value2, c.Offset(, 2).Value2)\n    End If\n\n    'Populate level 4\n    If Not IsEmpty(c.Offset(, 3).Value2) Then\n        If cNode.Level = 2 Then\n            Set cNode = cNode.AddChild(c.Offset(, 3).Value2, c.Offset(, 3).Value2)\n            Set cNode = cNode.ParentNode\n        ElseIf cNode.Level = 1 Then\n            Set cNode = cNode.Child.AddChild(c.Offset(, 2).Value2, c.Offset(, 2).Value2)\n            Set cNode = cNode.Child.AddChild(c.Offset(, 3).Value2, c.Offset(, 3).Value2)\n            Set cNode = cNode.ParentNode\n        End If\n    End If\nNext\n</code></pre>\n\n<p>There must be something wrong with my approach here. Any suggestion?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 5629294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf30c050eedcd0aac8704ea78a06aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Nallatheryth", "link": "https://stackoverflow.com/users/5629294/nallatheryth"}, "edited": false, "score": 0, "creation_date": 1449068773, "post_id": 34045801, "comment_id": 55846612, "body": "I think I am doing something wrong. Or maybe I explained badly. I entered the code, but it gives conscript out of range."}, {"owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "reply_to_user": {"reputation": 7, "user_id": 5629294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf30c050eedcd0aac8704ea78a06aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Nallatheryth", "link": "https://stackoverflow.com/users/5629294/nallatheryth"}, "edited": false, "score": 0, "creation_date": 1449068898, "post_id": 34045801, "comment_id": 55846703, "body": "I have download your excel file from your cloud and it works perfectly. Be sure of the name of your sheets, is this case is Sheet1 and Patterns"}, {"owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "reply_to_user": {"reputation": 7, "user_id": 5629294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf30c050eedcd0aac8704ea78a06aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Nallatheryth", "link": "https://stackoverflow.com/users/5629294/nallatheryth"}, "edited": false, "score": 0, "creation_date": 1449069358, "post_id": 34045801, "comment_id": 55847048, "body": "I edit the code, be sure to put it in a modul and to delete the Public Patterns"}, {"owner": {"reputation": 7, "user_id": 5629294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf30c050eedcd0aac8704ea78a06aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Nallatheryth", "link": "https://stackoverflow.com/users/5629294/nallatheryth"}, "edited": false, "score": 0, "creation_date": 1449069632, "post_id": 34045801, "comment_id": 55847281, "body": "That works perfectly. The only thing I noticed, case sensitivity. Is there a way to make it incensitive?"}, {"owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "reply_to_user": {"reputation": 7, "user_id": 5629294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf30c050eedcd0aac8704ea78a06aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Nallatheryth", "link": "https://stackoverflow.com/users/5629294/nallatheryth"}, "edited": false, "score": 0, "creation_date": 1449069796, "post_id": 34045801, "comment_id": 55847405, "body": "I add the fonction UCASE() like this is not case sensitive anymore"}, {"owner": {"reputation": 7, "user_id": 5629294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf30c050eedcd0aac8704ea78a06aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Nallatheryth", "link": "https://stackoverflow.com/users/5629294/nallatheryth"}, "edited": false, "score": 0, "creation_date": 1449074812, "post_id": 34045801, "comment_id": 55851181, "body": "It works. I adapted it to my table but it doesnt answer 1 fundamental question - it works many times slower this way that with the formula, which was the main thing I was trying to avoid. Any ideas there?"}, {"owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "reply_to_user": {"reputation": 7, "user_id": 5629294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf30c050eedcd0aac8704ea78a06aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Nallatheryth", "link": "https://stackoverflow.com/users/5629294/nallatheryth"}, "edited": false, "score": 0, "creation_date": 1449077886, "post_id": 34045801, "comment_id": 55853263, "body": "I change the second loop with a Do While loop and add a Boolean. It means when its found it goes directly to the other row. Then I added some spec to speed up the code which took me 2,97 secondes for 10&#39;000 rows. (I use your excel file). Let me know"}, {"owner": {"reputation": 7, "user_id": 5629294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf30c050eedcd0aac8704ea78a06aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Nallatheryth", "link": "https://stackoverflow.com/users/5629294/nallatheryth"}, "edited": false, "score": 0, "creation_date": 1449079123, "post_id": 34045801, "comment_id": 55853984, "body": "It is not executing. When assigning the Macro, I have option Normal and Speedup. Both are not performing the macro. If I run the macro from the VBA Editor, works fine. Where is my noobish head making the mistake sir?"}, {"owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "reply_to_user": {"reputation": 7, "user_id": 5629294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf30c050eedcd0aac8704ea78a06aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Nallatheryth", "link": "https://stackoverflow.com/users/5629294/nallatheryth"}, "edited": false, "score": 0, "creation_date": 1449079337, "post_id": 34045801, "comment_id": 55854120, "body": "you just need to run the Sub test() the code will call both Speedup and normal"}, {"owner": {"reputation": 7, "user_id": 5629294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf30c050eedcd0aac8704ea78a06aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Nallatheryth", "link": "https://stackoverflow.com/users/5629294/nallatheryth"}, "edited": false, "score": 0, "creation_date": 1449079640, "post_id": 34045801, "comment_id": 55854294, "body": "I cant seem to find a way to call it. When I create as I was trying a shape to assign the macro on it, I have options Normal and Speedup. I dont see test."}, {"owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "reply_to_user": {"reputation": 7, "user_id": 5629294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf30c050eedcd0aac8704ea78a06aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Nallatheryth", "link": "https://stackoverflow.com/users/5629294/nallatheryth"}, "edited": false, "score": 0, "creation_date": 1449079720, "post_id": 34045801, "comment_id": 55854349, "body": "my bad delete the &quot;Private&quot;, just let Sub test()"}], "tags": [], "owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "is_accepted": true, "score": 0, "last_activity_date": 1449079689, "last_edit_date": 1449079689, "creation_date": 1449068118, "answer_id": 34045801, "question_id": 34039610, "link": "https://stackoverflow.com/questions/34039610/excel-categorization-macroformula-based-on-string-of-text-containing-keywords/34045801#34045801", "title": "Excel/Categorization Macro(formula) based on string of text containing keywords", "body": "<p>Based on your excel file this code works: 10'000 rows done in 3 secondes with this code.</p>\n\n<pre><code>Sub test()\n\nDim lastrow As Long, lastrow2 As Long\nDim i As Integer, j As Integer\nDim PatternFound As Boolean\n\nCall speedup\n\nlastrow = Sheets(\"Keywords\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nlastrow2 = Sheets(\"SOURCE DATA\").Range(\"E\" &amp; Rows.Count).End(xlUp).Row\n\n\nFor i = 4 To lastrow2\n\nPatternFound = False\n\n    j = 1\n\nDo While PatternFound = False And j &lt; lastrow\n\n    j = j + 1\n\n            If UCase(Sheets(\"SOURCE DATA\").Range(\"E\" &amp; i).Value) Like \"*\" &amp; UCase(Sheets(\"Keywords\").Range(\"A\" &amp; j).Value) &amp; \"*\" Then\n                Sheets(\"SOURCE DATA\").Range(\"F\" &amp; i).Value = Sheets(\"Keywords\").Range(\"B\" &amp; j).Value\n                PatternFound = True\n            End If\n\n  Loop\n\nNext i\n\nCall normal\n\nEnd Sub\n\nPublic Sub speedup()\n\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\nEnd Sub\n\nPublic Sub normal()\n\nApplication.ScreenUpdating = True\nApplication.DisplayStatusBar = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 5629294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf30c050eedcd0aac8704ea78a06aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Nallatheryth", "link": "https://stackoverflow.com/users/5629294/nallatheryth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4725, "favorite_count": 0, "accepted_answer_id": 34045801, "answer_count": 1, "score": 0, "last_activity_date": 1469784312, "creation_date": 1449049928, "last_edit_date": 1495539862, "question_id": 34039610, "link": "https://stackoverflow.com/questions/34039610/excel-categorization-macroformula-based-on-string-of-text-containing-keywords", "title": "Excel/Categorization Macro(formula) based on string of text containing keywords", "body": "<p>Now I spent a few days searching up and down and need to find a solution. </p>\n\n<p>I saw two threads but both are not what I am looking for exactly and I admit, being not too good in VBA, I cant make heads or tales. </p>\n\n<p>What I have:\nI have 4300 lines of Bank statements. There are multiple columns but 1 is of importance - Description. This description might contain a lot of things, but usually there is 1 key word that is crucial. Roughly 96% can be automated and 3-4% just written manually every now and then. </p>\n\n<p>What I want:</p>\n\n<p>A VBA Macro that will read the column description, will match a keyword there from a list of many such in Sheet2, column \"keywords\" and then write in Column Category (sheet1) the assigned Categorizaion taken from Column Category on Sheet2.</p>\n\n<p>What I have done so far:</p>\n\n<p>the only thing I found to be working for me, and be able to actually reproduce is using a formula:</p>\n\n<pre><code>=IF(ISNUMBER(SEARCH(\"KEYWORD\",[Description])),\"OUTPUT\",\"\")\n</code></pre>\n\n<p>The above formula was repeated multiple times but this slows and lags everything. Besides being unmanagable. </p>\n\n<p>Its working but I need something better. So -> enter Macros. and here I am lost. </p>\n\n<p>I found that the answer of @JohnBustos is very good here:\n<a href=\"https://stackoverflow.com/questions/21993727/how-to-group-excel-items-based-on-custom-rules\">How to group excel items based on custom rules?</a>\nbut not working for me really. </p>\n\n<p>I found the answer of  Tomk Dallimore to be what I need or want:\n<a href=\"https://stackoverflow.com/questions/10062929/categorizing-bank-transactions-in-excel?answertab=active#tab-top\">Categorizing bank transactions in Excel</a></p>\n\n<p>but I cant make heads or tales how to get there??? He is very detailed but I am getting lost on the complexity which mind you is great. </p>\n\n<p>Can you please help me?</p>\n\n<p>I am attaching a very simple example of what I am talking.</p>\n\n<p><a href=\"http://1drv.ms/1Putpy5\" rel=\"nofollow noreferrer\">http://1drv.ms/1Putpy5</a></p>\n\n<p>Note#1\nI founnd a new formula that I incorporated. \n'=IFERROR(LOOKUP(10^10,SEARCH(\" \"&amp;KeywordTable[In-keyword]&amp;\" \",\" \"&amp;H29&amp; \" \"),KeywordTable[Out-keyword ]),\"\")</p>\n\n<p>But this is also troubling the CPU as it calculates each time a cell is moved. I imagine it will throw exception if I add 560 new rows or better yet move the table with 1 poisition. Temporary solution but need something more sophisticated.</p>\n\n<p>*****possibly a terrible idea****\nTo speed up the macro, such macro as the one you provided in your answer, is it possible to make it work like the automatic date filler macro:\nPrivate Sub Worksheet_Change(ByVal Target As Excel.Range)</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>With Target\r\n            If .Count &gt; 1 Then Exit Sub\r\n            If Not Intersect(Range(\"B2:B100\"), .Cells) Is Nothing Then\r\n                Application.EnableEvents = False\r\n                If IsEmpty(.Value) Then\r\n                    .Offset(0, 3).ClearContents\r\n                Else\r\n                    With .Offset(0, 3)\r\n                        .NumberFormat = \"dd mmm yyyy hh:mm:ss\"\r\n                        .Value = Now\r\n                    End With\r\n                End If\r\n                Application.EnableEvents = True\r\n            End If\r\n        End With\r\n    End Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Of course, I realize I am asking for something strange but if this can happen it will be rather fast and extremely helpful for optimzing the speed at which the macro is executed for large amounts of data. Now, I have 4500 rows to calculate. Within 2 months, this amount will double. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1449049587, "post_id": 34039446, "comment_id": 55833719, "body": "There are many solutions already present on the web you just need to search"}, {"owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "edited": false, "score": 2, "creation_date": 1449049626, "post_id": 34039446, "comment_id": 55833747, "body": "What have you tried so far? While you will find help to specific problems here, this isn&#39;t a code writing service. Provide some effort on your own!"}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 1, "creation_date": 1449049995, "post_id": 34039446, "comment_id": 55833997, "body": "You can simply use conditional formatting to do this. You no need VBA."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5629596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88be675e275d885f805dd5254483d928?s=128&d=identicon&r=PG&f=1", "display_name": "user5629596", "link": "https://stackoverflow.com/users/5629596/user5629596"}, "edited": false, "score": 0, "creation_date": 1449050426, "post_id": 34039777, "comment_id": 55834279, "body": "Thanks harun24hr. But i would want it as a VBA Script."}, {"owner": {"reputation": 1, "user_id": 5629596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88be675e275d885f805dd5254483d928?s=128&d=identicon&r=PG&f=1", "display_name": "user5629596", "link": "https://stackoverflow.com/users/5629596/user5629596"}, "edited": false, "score": 0, "creation_date": 1449051176, "post_id": 34039777, "comment_id": 55834750, "body": "Thanks guys ! I got the piece of code working fine.                            Sub Format_Boldheadings()  Dim StartCell As Range Set StartCell = Range(&quot;A1&quot;) Dim myList As Range Set myList = Range(&quot;A1:A&quot; &amp; Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row) Dim x As Range     For Each x In myList     &#39;myList.ClearFormats     x.Font.Bold = False          If InStr(1, x.Text, &quot;FG-DFG-123&quot;) &gt; 0 Or InStr(1, x.Text, &quot;FG-GHT-123&quot;) &gt; 0 Then                 x.Font.Bold = True                 Else                 x.Font.Bold = False           End If     Next End Sub"}], "tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": false, "score": 1, "last_activity_date": 1449050382, "creation_date": 1449050382, "answer_id": 34039777, "question_id": 34039446, "link": "https://stackoverflow.com/questions/34039446/vba-script-to-loop-through-entire-row-and-bold-the-cell-if-specific-substring-is/34039777#34039777", "title": "VBA Script to loop through entire row and Bold the cell if specific substring is found", "body": "<p>Simply use conditional format.</p>\n\n<p><a href=\"https://i.stack.imgur.com/WssWQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WssWQ.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5629596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88be675e275d885f805dd5254483d928?s=128&d=identicon&r=PG&f=1", "display_name": "user5629596", "link": "https://stackoverflow.com/users/5629596/user5629596"}, "is_accepted": false, "score": -1, "last_activity_date": 1449053491, "last_edit_date": 1449053491, "creation_date": 1449051272, "answer_id": 34040083, "question_id": 34039446, "link": "https://stackoverflow.com/questions/34039446/vba-script-to-loop-through-entire-row-and-bold-the-cell-if-specific-substring-is/34040083#34040083", "title": "VBA Script to loop through entire row and Bold the cell if specific substring is found", "body": "<p>Thanks guys. This piece of script is working fine.</p>\n\n<pre><code>Sub Format_Boldheadings()\n\n    Dim StartCell As Range\n    Set StartCell = Range(\"A1\")\n    Dim myList As Range\n\n    Set myList = Range(\"A1:A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row)\n    Dim x As Range\n\n    For Each x In myList\n        'myList.ClearFormats\n        x.Font.Bold = False\n        If InStr(1, x.Text, \"DFG\") &gt; 0 Or InStr(1, x.Text, \"RTY\") &gt; 0 Then\n            x.Font.Bold = True\n        Else\n            x.Font.Bold = False\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5629596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88be675e275d885f805dd5254483d928?s=128&d=identicon&r=PG&f=1", "display_name": "user5629596", "link": "https://stackoverflow.com/users/5629596/user5629596"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1036, "favorite_count": 0, "answer_count": 2, "score": -6, "last_activity_date": 1449053491, "creation_date": 1449049470, "question_id": 34039446, "link": "https://stackoverflow.com/questions/34039446/vba-script-to-loop-through-entire-row-and-bold-the-cell-if-specific-substring-is", "title": "VBA Script to loop through entire row and Bold the cell if specific substring is found", "body": "<p>How do i loop through an entire row say \"A\" till the row containing the last entry and search for the following substring in the cell \"FG-DFG-123\" ? \nOnce i find that the substring is present, i need to Bold the entire cell.</p>\n\n<p>Thanks in advance !</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1449050134, "post_id": 34039387, "comment_id": 55834093, "body": "S.O. isn&#39;t a distributor of code ready to use... you wrote:2. It needs to be manually processed by an employee. Well, start macro recorder and process your data, then post here your code and we help you to manipulate this code"}, {"owner": {"reputation": 55, "user_id": 5629487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f096cc87873046000b62d2e3bdf87a5?s=128&d=identicon&r=PG&f=1", "display_name": "Alterlai", "link": "https://stackoverflow.com/users/5629487/alterlai"}, "reply_to_user": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1449051087, "post_id": 34039387, "comment_id": 55834692, "body": "@Fabrizio Well there is a slight issue. At the moment, a few of the steps requires the employee to save the file as CSV and open it in notepad to replace the ()&#39;s with ;&#39;s so that the 4 letter code can be extracted. I can record a macro up to that point if that helps."}, {"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1449052528, "post_id": 34039387, "comment_id": 55835662, "body": "please input here the string that guy manipulate in notepad, I&#39;m incredulous... can be that this manipulation (if is necessary) will be processed by VBA"}, {"owner": {"reputation": 55, "user_id": 5629487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f096cc87873046000b62d2e3bdf87a5?s=128&d=identicon&r=PG&f=1", "display_name": "Alterlai", "link": "https://stackoverflow.com/users/5629487/alterlai"}, "reply_to_user": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1449052740, "post_id": 34039387, "comment_id": 55835796, "body": "The whole thing goes like this:  - Remove unnecessary text and images - Save as CSV.  - Open in notepad. Find and replace ( with a ; . Find and replace ) with nothing.   - Save again and open in excel.  What ends up happening is that the 4 letter code is now seperated from  the name and we are able to remove the name column and just keep the 4 letter code."}, {"owner": {"reputation": 55, "user_id": 5629487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f096cc87873046000b62d2e3bdf87a5?s=128&d=identicon&r=PG&f=1", "display_name": "Alterlai", "link": "https://stackoverflow.com/users/5629487/alterlai"}, "reply_to_user": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1449052955, "post_id": 34039387, "comment_id": 55835941, "body": "The whole thing is unwieldy, that&#39;s why i want to automate the process."}, {"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1449053410, "post_id": 34039387, "comment_id": 55836254, "body": "the whole thing is crowds, for this I ask you an exampe of your sheet, (ok for privacy) I just need one record with fancy names, you can do one print screen and update your tread, othewise I can&#39;t help you"}, {"owner": {"reputation": 55, "user_id": 5629487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f096cc87873046000b62d2e3bdf87a5?s=128&d=identicon&r=PG&f=1", "display_name": "Alterlai", "link": "https://stackoverflow.com/users/5629487/alterlai"}, "reply_to_user": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1449054768, "post_id": 34039387, "comment_id": 55837152, "body": "I hope the added info is of use."}, {"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1449055147, "post_id": 34039387, "comment_id": 55837411, "body": "more or less, post also the table before script. I want to evitate to copy the tab into notepad"}, {"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1449056993, "post_id": 34039387, "comment_id": 55838523, "body": "If I see the two img, cells.value in the colum A is the same (ok you delete header from original file) but if the imgbefore.cell(&quot;A24&quot;) is = imgafter.cell(&quot;A1&quot;) what append in notepad?!?!?"}, {"owner": {"reputation": 55, "user_id": 5629487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f096cc87873046000b62d2e3bdf87a5?s=128&d=identicon&r=PG&f=1", "display_name": "Alterlai", "link": "https://stackoverflow.com/users/5629487/alterlai"}, "reply_to_user": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1449058780, "post_id": 34039387, "comment_id": 55839662, "body": "Nothing has happend in notepad just yet in either of the two images. At this point I would open the file in notepad and replace all the ()s with ; so that once opened in excel again, the 4 letter code would be in a column between the name and costs. Then the name column is removed and the code and cost column get moved over to the left. Now we&#39;re left with just the 4 letter code and the cost."}], "answers": [{"comments": [{"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "edited": false, "score": 0, "creation_date": 1449058726, "post_id": 34042139, "comment_id": 55839631, "body": "You caught me while I was drinking my coffee so I just brain dumped on your project, if you want further help fell free to contact me here: <a href=\"https://www.fiverr.com/navenine/write-vba-code-or-create-userforms-for-you\" rel=\"nofollow noreferrer\">fiverr.com/navenine/write-vba-code-or-create-userforms-for-y&zwnj;&#8203;ou</a>  Deleting the empty rows and columns is less trivial and it&#39;s about time for me to get to work.  Hope that helps -E"}, {"owner": {"reputation": 55, "user_id": 5629487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f096cc87873046000b62d2e3bdf87a5?s=128&d=identicon&r=PG&f=1", "display_name": "Alterlai", "link": "https://stackoverflow.com/users/5629487/alterlai"}, "edited": false, "score": 0, "creation_date": 1449059513, "post_id": 34042139, "comment_id": 55840138, "body": "Hey Schalton, Thanks a LOT for the response, it was very helpfull. I found one issue when running the first script. It gave me the error: &quot;Next missing For&quot;. It&#39;s referring to &quot;Next r &quot;. Like i mentioned earlier. I have no experience in VBA so it might be a really easy fix. As for the alphabetical sorting, it worked perfectly. Also the tips for cleaning the data were really usefull!"}, {"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "reply_to_user": {"reputation": 55, "user_id": 5629487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f096cc87873046000b62d2e3bdf87a5?s=128&d=identicon&r=PG&f=1", "display_name": "Alterlai", "link": "https://stackoverflow.com/users/5629487/alterlai"}, "edited": false, "score": 0, "creation_date": 1449059691, "post_id": 34042139, "comment_id": 55840242, "body": "Oops, I made the change <code>Next r: to Nextr:</code> that should do it. That&#39;s a label to allow the code to skip the string edits when the value is empty. No worries, glad to help."}, {"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "reply_to_user": {"reputation": 55, "user_id": 5629487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f096cc87873046000b62d2e3bdf87a5?s=128&d=identicon&r=PG&f=1", "display_name": "Alterlai", "link": "https://stackoverflow.com/users/5629487/alterlai"}, "edited": false, "score": 0, "creation_date": 1449059786, "post_id": 34042139, "comment_id": 55840301, "body": "In your data you have more than 2 columns, where I have a &quot;2&quot; for the number of columns you can change that by adding the &quot;LastCol&quot; calc, or by making it 3,4,5.... if you want to sort more than just the two columns,"}, {"owner": {"reputation": 55, "user_id": 5629487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f096cc87873046000b62d2e3bdf87a5?s=128&d=identicon&r=PG&f=1", "display_name": "Alterlai", "link": "https://stackoverflow.com/users/5629487/alterlai"}, "edited": false, "score": 0, "creation_date": 1449060075, "post_id": 34042139, "comment_id": 55840459, "body": "Thanks for your response, after editing the script i&#39;m left with: mare)"}, {"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "reply_to_user": {"reputation": 55, "user_id": 5629487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f096cc87873046000b62d2e3bdf87a5?s=128&d=identicon&r=PG&f=1", "display_name": "Alterlai", "link": "https://stackoverflow.com/users/5629487/alterlai"}, "edited": false, "score": 0, "creation_date": 1449060220, "post_id": 34042139, "comment_id": 55840541, "body": "Yikes, that&#39;s what I get for not testing that script  replaced <code>CurrentString = left(CurrentString,instr(1,CurrentString,&quot;)&quot;)-1)</code>  The -1 will remove the last digit"}, {"owner": {"reputation": 55, "user_id": 5629487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f096cc87873046000b62d2e3bdf87a5?s=128&d=identicon&r=PG&f=1", "display_name": "Alterlai", "link": "https://stackoverflow.com/users/5629487/alterlai"}, "edited": false, "score": 0, "creation_date": 1449061850, "post_id": 34042139, "comment_id": 55841650, "body": "It&#39;s working down to the T! There is one tiny issue that&#39;s still left. When using the SortAlpha function, it the top record is not affected. When calling the function, the data start at A1. I&#39;ve tried changing it myself but I wasn&#39;t able to find it without breaking anything :("}, {"owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "reply_to_user": {"reputation": 55, "user_id": 5629487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f096cc87873046000b62d2e3bdf87a5?s=128&d=identicon&r=PG&f=1", "display_name": "Alterlai", "link": "https://stackoverflow.com/users/5629487/alterlai"}, "edited": false, "score": 0, "creation_date": 1449066220, "post_id": 34042139, "comment_id": 55844649, "body": "Yeah that sort method requires a header -- or a blank cell above, so you&#39;d need to insert a row above or sort it before deleting the mess at the top something like <code>Range(&quot;A1&quot;).EntireRow.Insert: Call SortAlpha: Rows(1).EntireRow.Delete</code> (I&#39;m writing this from my phone, but that should give you a general idea)."}, {"owner": {"reputation": 55, "user_id": 5629487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f096cc87873046000b62d2e3bdf87a5?s=128&d=identicon&r=PG&f=1", "display_name": "Alterlai", "link": "https://stackoverflow.com/users/5629487/alterlai"}, "edited": false, "score": 0, "creation_date": 1449066924, "post_id": 34042139, "comment_id": 55845142, "body": "I got it working using some other guy&#39;s code. If you&#39;re interrested I can send it to you but it&#39;s a bit too long to post it here in the comments :) Anyway, Thanks a lot for your help man!"}], "tags": [], "owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "is_accepted": true, "score": 0, "last_activity_date": 1449060185, "last_edit_date": 1495539880, "creation_date": 1449057345, "answer_id": 34042139, "question_id": 34039387, "link": "https://stackoverflow.com/questions/34039387/how-do-i-extract-data-from-a-cell-and-order-the-cells-alphabetically/34042139#34042139", "title": "How do I extract data from a cell and order the cells alphabetically?", "body": "<p>To get the 4 letter code you can search for the \"(\" and cut the string down</p>\n\n<p>Something like this will get you to the code, you could use regedit but that seems like overkill</p>\n\n<pre><code>Sub ReplaceName()\nLastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\nFor r = 2 to LastRow 'assumes data starts in row 2 with header in row 1\n    if Cells(r,1).value = \"\" then goto Nextr 'skips blanks\n    CurrentString = Cells(r,1).value 'assumes the names are in column 1\n    'At this point CurrentString = \"Mark Renner (mare)\"\n    CurrentString = Right(CurrentString,len(CurrentString)-instr(1,CurrentString,\"(\"))\n    'At this point CurrentString = \"mare)\"\n    CurrentString = left(CurrentString,instr(1,CurrentString,\")\")-1)\n    'At this point CurrentString = \"mare\"\n    Cells(r,1).value = CurrentString\nNextr:\nNext r\nEnd Sub\n</code></pre>\n\n<p>As far as putting it in alphabetical order, there are two ways that come to mind</p>\n\n<ol>\n<li>Move all of the values into an array then iterate through the array and sort them</li>\n<li>Create a filtered range and filter is</li>\n</ol>\n\n<p>the second option is MUCH easier, and for what you're doing I think it's probably fine. It'll look something like this:</p>\n\n<p>With data that looks like this (in cells A1 to B6):</p>\n\n<pre><code>Name    Cost\nTom     149\nDick    272\nHarry   186\nMoe     292\nLarry   377\n</code></pre>\n\n<p>I'd do something like this:</p>\n\n<pre><code>Sub SortAlpha()\nLastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\nRange(Cells(1,1),Cells(LastRow,2)).select 'selects the data and headers\nSelection.AutoFilter 'Adds Filter\nActiveWorkbook.ActiveSheet.AutoFilter.Sort.SortFields.Clear\n\nRange(Cells(1, 1), Cells(LastRow, 1)).Select 'selects name column\n\n'filters alpha\nActiveWorkbook.ActiveSheet.AutoFilter.Sort.SortFields.Add Key:=Selection _\n    , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.ActiveSheet.AutoFilter.Sort\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\nRange(Cells(1,1),Cells(LastRow,2)).select 'selects the data and headers\nSelection.AutoFilter 'Removes Filter\nEnd Sub\n</code></pre>\n\n<p>That'll Give you this:</p>\n\n<pre><code>Name    Cost\nDick    272\nHarry   186\nLary    377\nMoe     292\nTom     149\n</code></pre>\n\n<p>As Far as cleaning the data I usually do a couple of things when I have data tables that are really messy</p>\n\n<p>Start Here:</p>\n\n<pre><code> 1. iterate through the range and remove all merges\n 2. unwrap all of the text\n 3. delete all pictures\n 4. Delete any blank Rows or columns\n</code></pre>\n\n<p>I like this code for finding the last row:</p>\n\n<pre><code>LastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n</code></pre>\n\n<p>You can modify it to find the last column</p>\n\n<pre><code>LastCol = Cells.Find(\"*\", SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column\n</code></pre>\n\n<p>Then you can loop through your whole sheet cell by cell, or as a range\nCell by Cell: (I use this to unmerge the cells - can be slow)</p>\n\n<pre><code>For r = 1 to LastRow\n    For c = 1 to LastCol\n       'Do Stuff\n       Cells(r,c).UnMerge 'or Cells(r,c).MergeCells = False\n    Next c\nNext r\n</code></pre>\n\n<p>or as a range: I use this for unwrapping the text</p>\n\n<pre><code>Range(Cells(1,1),Cells(LastRow,LastCol)).WrapText = False\n</code></pre>\n\n<p>To delete the pictures I use this code:\n<a href=\"https://stackoverflow.com/questions/4480231/deleting-pictures-with-excel-vba\">Deleting pictures with Excel VBA</a></p>\n\n<pre><code>Dim shape As Excel.shape\nFor Each shape In ActiveSheet.Shapes\n    shape.Delete\nNext\n</code></pre>\n\n<p>This seems like it would work for saving the csv if you wanted to automate that also:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/10551353/saving-excel-worksheet-to-csv-files-with-filenameworksheet-name-using-vb\">Saving excel worksheet to CSV files with filename+worksheet name using VB</a></p>\n\n<p>I'd re-resize all of your rows and columns, rows to their default and columns to the fit:\nUnfortunately I haven't found a great way to do the rows without a range string so my code is a little messy:</p>\n\n<pre><code>RowRange = \"1:\" &amp; LastRow\nRows(RowRange).RowHeight = 12.75\n</code></pre>\n\n<p>Columns are about the same, but worse because they're not numbered</p>\n\n<pre><code>ColStart = Cells(1,1).Address\nColEnd = Cells(1,LastCol).Address\nColStart = left(ColStart,len(ColStart)-1)\nColEnd = left(ColEnd,len(ColEnd)-1)\nColStart = Replace(ColStart,\"$\",\"\")\nColEnd = Replace(ColEnd,\"$\",\"\")\nColRange = ColStart &amp; \":\" &amp; ColEnd\nColumns(ColRange).EntireColumn.AutoFit\n</code></pre>\n\n<p>you could alternatively just make it significantly large, but where's the fun in that?</p>\n\n<pre><code>Columns(\"A:ZZ\").EntireColumn.AutoFit\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5629487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f096cc87873046000b62d2e3bdf87a5?s=128&d=identicon&r=PG&f=1", "display_name": "Alterlai", "link": "https://stackoverflow.com/users/5629487/alterlai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "accepted_answer_id": 34042139, "answer_count": 1, "score": 1, "last_activity_date": 1449067896, "creation_date": 1449049273, "last_edit_date": 1449067896, "question_id": 34039387, "link": "https://stackoverflow.com/questions/34039387/how-do-i-extract-data-from-a-cell-and-order-the-cells-alphabetically", "title": "How do I extract data from a cell and order the cells alphabetically?", "body": "<p>I'm trying to automate excel modificaions.</p>\n\n<p>The process works like this:</p>\n\n<ol>\n<li>The Excel list gets created.</li>\n<li>It needs to be manually processed by an employee (removing images, sorted alphabetically, etc.)</li>\n<li>The list gets converted into a csv file.</li>\n<li>CSV gets uploaded and processed.</li>\n</ol>\n\n<p>Now I would like to automate this process as much as possible. I don't have any experience working with VBA or Excel macros.</p>\n\n<p>So far i've been able to scramble a few different scripts together to get halfway, but I haven't been able to get these two functions working.\nI've been able to remove all the bloat at the top (not at the bottom yet), remove empty rows and remove unused columns.</p>\n\n<p>I can't post the contents of the sheet itself because of privacy reasons, but the structure of the sheet looks like this:</p>\n\n<pre><code>| Name | Cost |\n\n| Mark Renner (mare) | \u20ac200,- |\n</code></pre>\n\n<p><strong>Question</strong></p>\n\n<p>I want to extract the 4 letter codes and replace them for the full names so only the 4 letter code remains in the cell.</p>\n\n<p>Also I would like the list to be sorted alphabetically. The range of the sheet differs per day so there is no fixed ammount of cells. </p>\n\n<p>There is nothing else on the sheet you need to worry about. I can provide more information if necessary.</p>\n\n<p>It would be tremendous if someone is able to help me with this. </p>\n\n<p><strong>Thanks in advance!</strong></p>\n\n<p>Edit:</p>\n\n<p>Here is some more requested information.</p>\n\n<p><a href=\"http://i.stack.imgur.com/Xd4Ym.jpg\" rel=\"nofollow\">Table example after current script</a></p>\n\n<p>This is the script I am currently using to remove all the bloat. I'm sure it's not perfect but it does the job for now.</p>\n\n<pre><code>\n    Sub run()\n    Call testvba\n    Call DeleteRowWithContents\n    Call usedR\n    End Sub\n\n    Sub testvba()\n    Dim i As Integer\n    For i = 1 To 21\n    Rows(1).EntireRow.Delete\n    Next i\n\n    For i = 1 To 10\n    Columns(4).EntireColumn.Delete\n    Next i\n\n    Dim shape As Excel.shape\n    For Each shape In ActiveSheet.Shapes\n    shape.Delete\n    Next\n\n\n    End Sub\n\n    Sub DeleteRowWithContents()\n    Last = Cells(Rows.Count, \"A\").End(xlUp).Row\n    For i = Last To 1 Step -1\n        If (Cells(i, \"A\").Value) = \"User\" Then\n            Cells(i, \"A\").EntireRow.Delete\n        End If\n    Next i\n    End Sub\n\n    Sub usedR()\n    ActiveSheet.UsedRange.Select\n    'Deletes the entire row within the selection if the ENTIRE row contains no      data.\n    Dim i As Long\n    'Turn off calculation and screenupdating to speed up the macro.\n    With Application\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\n    'Work backwards because we are deleting rows.\n    For i = Selection.Rows.Count To 1 Step -1\n    If WorksheetFunction.CountA(Selection.Rows(i)) = 0 Then\n    Selection.Rows(i).EntireRow.Delete\n    End If\n    Next i\n    .Calculation = xlCalculationAutomatic\n    .ScreenUpdating = True\n    End With\n    End Sub `\n</code></pre>\n\n<p>Here is the table before the script:</p>\n\n<p><a href=\"http://i.stack.imgur.com/Q8qs1.jpg\" rel=\"nofollow\">Before</a></p>\n\n<p><strong>SOLUTION:</strong></p>\n\n<p>I used Schalton's code for extracting the 4 letter code.</p>\n\n<p>I ended up using this line of code to alphabetize the records:</p>\n\n<pre><code>\n    Sub Alpha()\n    Dim fromRow As Integer\n    Dim toRow As Integer\n    fromRow = 1\n    toRow = ActiveSheet.UsedRange.Rows.Count\n        ActiveSheet.Rows(fromRow & \":\" & toRow).Sort Key1:=ActiveSheet.Range(\"A:A\"), _\n           Order1:=xlAscending, Header:=xlNo, OrderCustom:=1, _\n           MatchCase:=False, Orientation:=xlTopToBottom\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1449048791, "post_id": 34039067, "comment_id": 55833226, "body": "You could add a loop around the code you have written, and let it loop through every sheet."}], "answers": [{"comments": [{"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 0, "creation_date": 1497566898, "post_id": 34039284, "comment_id": 76145145, "body": "The problem with the method is that the workbook default is unchanged and new worksheets added will use the default font."}], "tags": [], "owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "is_accepted": false, "score": 3, "last_activity_date": 1449048978, "creation_date": 1449048978, "answer_id": 34039284, "question_id": 34039067, "link": "https://stackoverflow.com/questions/34039067/how-to-setup-font-and-size-for-entire-workbook-instead-of-sheet-by-sheet/34039284#34039284", "title": "How to setup font and size for entire workbook instead of sheet by sheet?", "body": "<p>This code should loop through every sheet in your workbook and change the properties.</p>\n\n<pre><code>Sub SetFormat()\nDim ws as Worksheet\n    For Each ws in Worksheets\n         With ws\n            .Cells.Font.Name = \"Segoe UI\"\n            .Cells.Font.Size = 10\n            .Cells.VerticalAlignment = xlCenter\n         End With\n    Next ws\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9396, "user_id": 658838, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c3f339119900406677ee99fdf4328048?s=128&d=identicon&r=PG", "display_name": "CustomX", "link": "https://stackoverflow.com/users/658838/customx"}, "edited": false, "score": 0, "creation_date": 1449049728, "post_id": 34039380, "comment_id": 55833821, "body": "what kind of side effects?"}, {"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 1, "creation_date": 1497566836, "post_id": 34039380, "comment_id": 76145133, "body": "I found that text already formatted to the workbook&#39;s default font and size are updated.  The row number and column letter font is also affected."}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 7, "last_activity_date": 1449049254, "creation_date": 1449049254, "answer_id": 34039380, "question_id": 34039067, "link": "https://stackoverflow.com/questions/34039067/how-to-setup-font-and-size-for-entire-workbook-instead-of-sheet-by-sheet/34039380#34039380", "title": "How to setup font and size for entire workbook instead of sheet by sheet?", "body": "<p>If that suits you, you can work on <code>Styles</code>. Changing the default style of the workbook is very quick, but may have side effects. Try it.  </p>\n\n<pre><code>With ActiveWorkbook.Styles(\"Normal\").Font\n    .Name = \"Aharoni\"\n    .Size = 11\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 9396, "user_id": 658838, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c3f339119900406677ee99fdf4328048?s=128&d=identicon&r=PG", "display_name": "CustomX", "link": "https://stackoverflow.com/users/658838/customx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22212, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1449049254, "creation_date": 1449048358, "last_edit_date": 1531164843, "question_id": 34039067, "link": "https://stackoverflow.com/questions/34039067/how-to-setup-font-and-size-for-entire-workbook-instead-of-sheet-by-sheet", "title": "How to setup font and size for entire workbook instead of sheet by sheet?", "body": "<p>I want my macro to update the entire workbooks font, size and verticalaligment but all I can find are options to do it sheet by sheet. It's not too much hassle, but I was wondering whether you can't set these globally and update the entire workbook with 1 command.</p>\n\n<pre><code>Sub SetFormat()\n    With Sheets(1)\n        .Cells.Font.Name = \"Segoe UI\"\n        .Cells.Font.Size = 10\n        .Cells.VerticalAlignment = xlCenter\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1449047976, "post_id": 34038851, "comment_id": 55832744, "body": "Did you put a breakpoint on the line with <code>If</code> to see if you enter it?"}, {"owner": {"reputation": 95, "user_id": 4309559, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8b1e179046348a1cdc73c8e759a4f55?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4309559/chris"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1449049399, "post_id": 34038851, "comment_id": 55833597, "body": "if I set a breakpoint on the If line, then run through the code, it will keep adding the values until an empty cell and then repeatedly add those values... so I&#39;m getting value 1, value 2, value 3, value 1, value 2, value 3 etc. instead of value 1, value 2, value 3, value 4... etc."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 4309559, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8b1e179046348a1cdc73c8e759a4f55?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4309559/chris"}, "edited": false, "score": 0, "creation_date": 1449048340, "post_id": 34038973, "comment_id": 55832962, "body": "Thanks for your response, it&#39;s still not populating the list though. I&#39;m not getting any errors or anything, it just isn&#39;t populating the combobox."}, {"owner": {"reputation": 95, "user_id": 4309559, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8b1e179046348a1cdc73c8e759a4f55?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4309559/chris"}, "edited": false, "score": 0, "creation_date": 1449048755, "post_id": 34038973, "comment_id": 55833200, "body": "When running the code, it&#39;s now populating the combobox up until an empty cell, however, I still have values under the empty cells that need to populate the box. It&#39;s not updating live though."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 95, "user_id": 4309559, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8b1e179046348a1cdc73c8e759a4f55?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4309559/chris"}, "edited": false, "score": 0, "creation_date": 1449048972, "post_id": 34038973, "comment_id": 55833343, "body": "Strange that it stop after an empty cell... It shouldn&#39;t have any issue as you use the <code>AddItem</code> method... I&#39;ll take a look around to see if there is an explanation!"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1449049869, "post_id": 34038973, "comment_id": 55833900, "body": "@Rory : I guess that is a question for the OP, you should have poked him, I&#39;m not sure he will have the notification for each comment on the answer (I haven&#39;t ask much in quite some times, so I&#39;m not sure)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 95, "user_id": 4309559, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8b1e179046348a1cdc73c8e759a4f55?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4309559/chris"}, "edited": false, "score": 0, "creation_date": 1449052921, "post_id": 34038973, "comment_id": 55835918, "body": "@SamWells I added the line to empty the combobox before filling it again, let me know if that solve your issue! ;)"}, {"owner": {"reputation": 95, "user_id": 4309559, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8b1e179046348a1cdc73c8e759a4f55?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4309559/chris"}, "edited": false, "score": 0, "creation_date": 1449053669, "post_id": 34038973, "comment_id": 55836414, "body": "Thank you! That works as a solution. One thing, this only loads when I change a value in column B (after that it works fine), is there a way to get this to load on Workbook_Open but also update when column B is changed? Also, a little off-topic, but is there a way to sort of the combobox alphabetically? As far as I&#39;m aware, VBA cannot sort data can it?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1449053771, "post_id": 34038973, "comment_id": 55836476, "body": "Yup, just add the name of the sub (<code>CompanyList</code>) in the Open event also and it&#39;ll be executed everytime you open the workbook! ;)"}, {"owner": {"reputation": 95, "user_id": 4309559, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8b1e179046348a1cdc73c8e759a4f55?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4309559/chris"}, "edited": false, "score": 0, "creation_date": 1449054430, "post_id": 34038973, "comment_id": 55836932, "body": "@R3uK I have the code in the Worksheet_Change sub, however, the code Private Sub Workbook_Open() Call Worksheet_Change End Sub doesn&#39;t work."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1449054823, "post_id": 34038973, "comment_id": 55837199, "body": "Nope, like I said, you should add <i>Call CompanyList</i> in the Open event. so you need to create a real Sub, I you haven&#39;t already! ;) You can&#39;t call an event handler."}, {"owner": {"reputation": 95, "user_id": 4309559, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8b1e179046348a1cdc73c8e759a4f55?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4309559/chris"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1449055144, "post_id": 34038973, "comment_id": 55837410, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/96786/discussion-between-sam-wells-and-r3uk\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1449052886, "last_edit_date": 1449052886, "creation_date": 1449048091, "answer_id": 34038973, "question_id": 34038851, "link": "https://stackoverflow.com/questions/34038851/filling-combobox-with-range-and-remove-blanks/34038973#34038973", "title": "Filling combobox with range and remove blanks", "body": "<p>Few corrections around the <code>With</code> statements, to properly define the range :</p>\n\n<pre><code>Private Sub CompanyList()\nDim c As Range\nComboBox1.Clear\nWith Worksheets(\"Database\")\n    For Each c In .Range(.Range(\"B3\"), .Range(\"B\" &amp; .Rows.Count).End(xlUp))\n        If c.Value &lt;&gt; vbNullString Then ComboBox1.AddItem c.Value\n    Next c\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 4309559, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8b1e179046348a1cdc73c8e759a4f55?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4309559/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11815, "favorite_count": 0, "accepted_answer_id": 34038973, "answer_count": 1, "score": 1, "last_activity_date": 1449054886, "creation_date": 1449047756, "last_edit_date": 1449054886, "question_id": 34038851, "link": "https://stackoverflow.com/questions/34038851/filling-combobox-with-range-and-remove-blanks", "title": "Filling combobox with range and remove blanks", "body": "<p>I thought this would be simple but for whatever reason, my combobox is always empty and I don't know why! In column B I have text from cell B3 downwards and want this list to populate my combobox (called ComboBox1). Some cells in column B are empty and I do not want these in the combobox so this is the code I have:</p>\n\n<pre><code>Private Sub CompanyList()\nDim c As Range\nWith Worksheets(\"Database\")\n    For Each c In Worksheets(\"Database\").Range(\"B3\", .Range(\"B\" &amp; Rows.Count).End(xlUp))\n        If c.Value &lt;&gt; \"\" Then ComboBox1.AddItem c.Value\n    Next c\nEnd With\nEnd Sub\n</code></pre>\n\n<p>My sheet is called Database, the ActiveX combobox is on the same sheet and it's called ComboBox1. Where am I going wrong here?</p>\n\n<p>UPDATE</p>\n\n<p>I've changed the code so that it runs whenever I update a cell so</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n</code></pre>\n\n<p>However, now when I update a cell, it will add the whole of column B in to the combobox again. It's not adding blank cells and it's adding values from underneath blank cells which is good, but it's just adding everything twice over whenever I make a change. </p>\n\n<p>Although thinking about it, I'm not sure why I thought otherwise. However, if I change a company name in the list, I still need the combobox to update in livetime.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1449049668, "post_id": 34038816, "comment_id": 55833777, "body": "Your code works fine for me. Could it be that you have multiple instances of the same value occuring in ws2 and ws1 ?"}, {"owner": {"reputation": 41, "user_id": 5625287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6f7753002d13a274e0da89201210072a?s=128&d=identicon&r=PG&f=1", "display_name": "Areki", "link": "https://stackoverflow.com/users/5625287/areki"}, "reply_to_user": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1449050132, "post_id": 34038816, "comment_id": 55834092, "body": "YES! that&#39;s it. How do I fix so those instances doesn&#39;t stop it from functioning?"}, {"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1449050326, "post_id": 34038816, "comment_id": 55834227, "body": "I&#39;m not sure, but I would have it check if the specified row has already been copied to ws3. Like inside your if statement make a second if statement to check if the row from ws1 has been copied before, and if it has, go to next i."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5625287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6f7753002d13a274e0da89201210072a?s=128&d=identicon&r=PG&f=1", "display_name": "Areki", "link": "https://stackoverflow.com/users/5625287/areki"}, "edited": false, "score": 0, "creation_date": 1449059708, "post_id": 34040672, "comment_id": 55840255, "body": "Thanks a lot! I do stumble once I run the code on a full-size version on my worksheet &quot;Not enough memory&quot;. I&#39;ll figure out how to break this down."}, {"owner": {"reputation": 61, "user_id": 5466906, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Amvy7jXrHho/AAAAAAAAAAI/AAAAAAAAAbk/l4MEBr6Mz9A/photo.jpg?sz=128", "display_name": "Israel Holetz", "link": "https://stackoverflow.com/users/5466906/israel-holetz"}, "reply_to_user": {"reputation": 41, "user_id": 5625287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6f7753002d13a274e0da89201210072a?s=128&d=identicon&r=PG&f=1", "display_name": "Areki", "link": "https://stackoverflow.com/users/5625287/areki"}, "edited": false, "score": 0, "creation_date": 1449076079, "post_id": 34040672, "comment_id": 55852104, "body": "Try changing this line: <code>lLastColumn = WorksheetFunction.Max(MAXCol, APT.Cells.SpecialCells(xlCellTypeLastCell).Column, BOM.Cells.SpecialCells(xlCellTypeLastCell).Column)</code> to <code>lLastColumn = WorksheetFunction.Min(MAXCol, WorksheetFunction.Max(APT.Cells.SpecialCells(xlCellTypeLastC&zwnj;&#8203;ell).Column, BOM.Cells.SpecialCells(xlCellTypeLastCell).Column))</code>. And set the constant MAXCol to the maximum column number you expect your data will reach."}], "tags": [], "owner": {"reputation": 61, "user_id": 5466906, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Amvy7jXrHho/AAAAAAAAAAI/AAAAAAAAAbk/l4MEBr6Mz9A/photo.jpg?sz=128", "display_name": "Israel Holetz", "link": "https://stackoverflow.com/users/5466906/israel-holetz"}, "is_accepted": true, "score": 0, "last_activity_date": 1449076319, "last_edit_date": 1449076319, "creation_date": 1449052881, "answer_id": 34040672, "question_id": 34038816, "link": "https://stackoverflow.com/questions/34038816/for-loop-to-copy-entire-row-when-match-found-between-two-sheets/34040672#34040672", "title": "For loop to copy entire row when match found between two sheets", "body": "<p>Your code is fine (not mentioning the missing <code>Application.ScreenUpdating = True</code>), but it will hang on large number of rows and columns because of the amount of interations with the application (Excel in this case).</p>\n\n<p>Each time you request a value from a single cell from Excel, your code will hang for about 4 secounds per 1 million requests. From an entire row it will hang for 4 secounds per 4000 requests. If you try writing a single cell, your code will hang for 4 secounds per 175000 requests, and writing an entire row will hang your code for 4 secounds per 300 requests.</p>\n\n<p>This way, only if you try parsing 15.000 rows of data from one sheet to another, your code will hang for about 3,3 minutes.. not to mention all read requests..</p>\n\n<p>So, always keep the amount of interactions with any application from vba to a minimum, even if you have to create a much bigger code.</p>\n\n<p>Here is what your code should look like if you want to handle a lot of data:</p>\n\n<pre><code>Sub CopyBetweenWorksheets2()\nDim aAPT, aBOM, aCombined As Variant\nDim lLastRow As Long, lLastColumn As Long\nDim i As Long, j As Long\n\nConst APTColRef = 3\nConst BOMColRef = 46\nConst MAXCol = 200\n\n'Speed up VBA in Excel\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n\n'Get the last row and column to use with the combined sheet\nlLastRow = WorksheetFunction.Min(APT.Cells.SpecialCells(xlCellTypeLastCell).Row, BOM.Cells.SpecialCells(xlCellTypeLastCell).Row)\nlLastColumn = WorksheetFunction.Min(MAXCol, WorksheetFunction.Max(APT.Cells.SpecialCells(xlCellTypeLastCell).Column, BOM.Cells.SpecialCells(xlCellTypeLastCell).Column))\n\n'Parse all values to an array, reducing interactions with the application\naAPT = Range(APT.Cells(1), APT.Cells(lLastRow, lLastColumn))\naBOM = Range(BOM.Cells(1), BOM.Cells(lLastRow, lLastColumn))\n\n'Creates a temporary array with the values to parse to the destination sheet\nReDim aCombined(1 To lLastRow, 1 To lLastColumn)\n\n'Loop trough values and parse the row value if true\nFor i = 1 To lLastRow\nIf aAPT(i, APTColRef) = aBOM(i, BOMColRef) Then\n    For j = 1 To lLastColumn\n        aCombined(i, j) = aAPT(i, j)\n    Next\nEnd If\nNext\n\n'Parse values from the destination array to the combined sheet\nCombined.Range(Combined.Cells(1), Combined.Cells(lLastRow, lLastColumn)) = aCombined\n\n'Disable tweaks\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationManual\nEnd Sub\n</code></pre>\n\n<p>!! I named the sheets objects in the VBA itself, so you don't have to declare a new variable and you also won't have any problems if you rename them later. So, insted of sheets(\"APT\"), I just used APT (you will have to rename it too if you want the code to work) !!</p>\n\n<p>Plus, here is my speed code I wrote for speed testing my codes. I always keep it at hand, and use it in almost every function i write</p>\n\n<pre><code>Sub Speed()\nDim i As Long\nDim dSec As Double\nDim Timer0#\nDim TimerS#\nDim TimerA#\nDim TimerB#\n\ndSec = 4 ''Target time in secounds''\ni = 1\nWP1:\nTimer0 = Timer\nFor n = 1 To i\nSpeedTestA\nNext\nTimerA = Timer\nFor n = 1 To i\nSpeedTestB\nNext\nTimerB = Timer\n\nIf TimerB - Timer0 &lt; dSec Then\n    If TimerB - Timer0 &lt;&gt; 0 Then\n        i = CLng(i * (dSec * 2 / (TimerB - Timer0)))\n        GoTo WP1\n    Else\n        i = i * 100\n        GoTo WP1\n    End If\nEnd If\nMsgBox \"C\u00f3digo A: \" &amp; TimerA - Timer0 &amp; vbNewLine &amp; \"C\u00f3digo B: \" &amp; TimerB - TimerA &amp; vbNewLine &amp; \"Itera\u00e7\u00f5es: \" &amp; i\nEnd Sub\n\nSub SpeedTestA() 'Fist Code\n\nEnd Sub\n\nSub SpeedTestB() 'Secound Code\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5625287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6f7753002d13a274e0da89201210072a?s=128&d=identicon&r=PG&f=1", "display_name": "Areki", "link": "https://stackoverflow.com/users/5625287/areki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "accepted_answer_id": 34040672, "answer_count": 1, "score": 0, "last_activity_date": 1449076319, "creation_date": 1449047632, "question_id": 34038816, "link": "https://stackoverflow.com/questions/34038816/for-loop-to-copy-entire-row-when-match-found-between-two-sheets", "title": "For loop to copy entire row when match found between two sheets", "body": "<p>I am trying to get a For loop which copies an entire row from worksheet 1 to worksheet 3 if the cell in column C in ws1 and column AT in ws2 matches. I have two issues:\n1. It seems to be stuck in the For i = xxxxx loop and does not move to the next k (only copies one line 25 times)\n2. When I use it on a sheet that has 100,000 rows for worksheet 1 and 15,000 rows on worksheet 2, excel just crashes. Is there a way to manage this?</p>\n\n<pre><code>Sub CopyBetweenWorksheets()\nApplication.ScreenUpdating = False\n\nDim i As Long, k As Long, ws1 As Worksheet, ws2 As Worksheet, myVar As String, myVar2 As String\nSet ws1 = Worksheets(\"BOM\")\nSet ws2 = Worksheets(\"APT\")\nSet ws3 = Worksheets(\"Combined\")\n\n'get the last row for w2 and w1\nii = ws1.Cells.SpecialCells(xlCellTypeLastCell).row\nkk = ws2.Cells.SpecialCells(xlCellTypeLastCell).row\n\nFor k = 2 To kk\n    myVar = ws2.Cells(k, 46)\nFor i = 688 To ii   '688 To ii\n    myVar2 = ws1.Cells(i, 3)\n    If myVar2 = myVar Then\n        ws3.Rows(k).EntireRow.Value = ws1.Rows(i).EntireRow.Value 'copy entire row\n      Exit For\n       End If\n    Next i\nNext k\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1313, "user_id": 1818055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LizLD.png?s=128&g=1", "display_name": "thepiyush13", "link": "https://stackoverflow.com/users/1818055/thepiyush13"}, "is_accepted": false, "score": 0, "last_activity_date": 1449046863, "creation_date": 1449046863, "answer_id": 34038562, "question_id": 34038348, "link": "https://stackoverflow.com/questions/34038348/using-output-of-findstring-in-vba/34038562#34038562", "title": "Using output of FindString in VBA", "body": "<p>Since you already have the range variable <strong>Rng</strong>, I would do something like this:</p>\n\n<pre><code>Rng.Cut\nDestinationSheet.Range(\"destinationRange\").select.Paste\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1449047311, "post_id": 34038622, "comment_id": 55832345, "body": "Or can just use <code>Rng.Copy Destination: Worksheet(&quot;Y&quot;).Range(&quot;A1&quot;)</code>  (or something like that)."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1449047413, "post_id": 34038622, "comment_id": 55832411, "body": "Indeed. I tend to keep operations separate, but that is just force of habit."}, {"owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "edited": false, "score": 0, "creation_date": 1449048768, "post_id": 34038622, "comment_id": 55833209, "body": "Gold answer. Only thing is now that i&#39;m getting a compilation error, probably missed an END IF."}], "tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": true, "score": 0, "last_activity_date": 1449047079, "creation_date": 1449047079, "answer_id": 34038622, "question_id": 34038348, "link": "https://stackoverflow.com/questions/34038348/using-output-of-findstring-in-vba/34038622#34038622", "title": "Using output of FindString in VBA", "body": "<pre><code>If Not Rng Is Nothing Then\n    Rng.Copy\n    Worksheet(\"Y\").Range(\"A1\").Paste\n    Rng.EntireRow.Delete\nElse\n    MsgBox(\"Nothing found\")\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 5529292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a48b7eaee61610366294e49b6a4f7410?s=128&d=identicon&r=PG&f=1", "display_name": "RobExcel", "link": "https://stackoverflow.com/users/5529292/robexcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 34038622, "answer_count": 2, "score": 0, "last_activity_date": 1449047079, "creation_date": 1449046175, "question_id": 34038348, "link": "https://stackoverflow.com/questions/34038348/using-output-of-findstring-in-vba", "title": "Using output of FindString in VBA", "body": "<p>I would like to ask for your help again. Working on a bit of VBA that opens up a Inputbox, and finds a certain value in worksheet X, and then cuts the complete row to worksheet Y. I've completed the Inputbox/FindString-part, which is shown in; <a href=\"https://i.stack.imgur.com/oOoWZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oOoWZ.png\" alt=\"this screenshot\"></a>.</p>\n\n<p>My question is pretty simple; How would i use the value found by the Inputbox/Findstring? With the intention on using this value to make the code that cuts the full row, and deletes the leftover space.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 2584809, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5f1f530cc0ffa06fed0b349769568a6b?s=128&d=identicon&r=PG", "display_name": "fundakk", "link": "https://stackoverflow.com/users/2584809/fundakk"}, "edited": false, "score": 0, "creation_date": 1449047262, "post_id": 34038421, "comment_id": 55832316, "body": "Yes, It was so easy that I feel stupid now. I just haven&#39;t thought about getting extra variable. Thanks!"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1449046406, "creation_date": 1449046406, "answer_id": 34038421, "question_id": 34038345, "link": "https://stackoverflow.com/questions/34038345/merging-cells-values-in-selected-range/34038421#34038421", "title": "Merging cells values in selected range", "body": "<p>Something like this?</p>\n\n<pre><code>Sub scal()\n    Dim rng As Range\n    Dim cell As Range\n    Dim v As Variant\n\n    Set rng = Selection\n    For Each cell In rng\n         v = v &amp; cell.Value\n    Next cell\n    rng.ClearContents\n    rng.Cells(1, 1) = v\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 2584809, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5f1f530cc0ffa06fed0b349769568a6b?s=128&d=identicon&r=PG", "display_name": "fundakk", "link": "https://stackoverflow.com/users/2584809/fundakk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 34038421, "answer_count": 1, "score": 0, "last_activity_date": 1449046694, "creation_date": 1449046163, "last_edit_date": 1449046694, "question_id": 34038345, "link": "https://stackoverflow.com/questions/34038345/merging-cells-values-in-selected-range", "title": "Merging cells values in selected range", "body": "<p>I'm trying to create simple macro (since I have some repetitive work) that would merge (but not merge in excel way of joining two cells, but moving value of rest of cells to the first one) values.\nI thought I could loop through selection, and join with <em>&amp;</em> symbol second cell to first, then third to first and so.\nSo I have something like this:</p>\n\n<pre><code>Sub scal()\n\nDim rng As Range\nDim cell As Range\n\nSet rng = Selection\n\nFor Each cell In rng\n     'code here\nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>This way I can maniopulate each cell, but how can I do merging (once again not merging-merging like making two cells one, but moving value of one to other)?</p>\n"}, {"tags": ["vba", "ms-word", "word-contentcontrol"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1449073340, "post_id": 34038173, "comment_id": 55850062, "body": "&quot; tried to limit the loop only for the specific bookmark, page, table, but it does not work&quot; How does it not work? That would certainly be the most efficient method and I am quite sure it CAN work..."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5629325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd7d40daace49015e4aecbde84ae657?s=128&d=identicon&r=PG&f=1", "display_name": "Opensoul", "link": "https://stackoverflow.com/users/5629325/opensoul"}, "edited": false, "score": 0, "creation_date": 1449385304, "post_id": 34040192, "comment_id": 55979379, "body": "Thank you DanL for you response! But I cannot figure out, sorry. I tried to incorporate it to the code, but VBA gives me an error message stating that object variable is not defined or WIth block variable is not defined. Could you please expand the code? The content controls that I want to edit are only in the page nummer 1  and in the table. I tried to set table as range, and all other stuff, but still cannot figure it out."}, {"owner": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "reply_to_user": {"reputation": 15, "user_id": 5629325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd7d40daace49015e4aecbde84ae657?s=128&d=identicon&r=PG&f=1", "display_name": "Opensoul", "link": "https://stackoverflow.com/users/5629325/opensoul"}, "edited": false, "score": 0, "creation_date": 1449474913, "post_id": 34040192, "comment_id": 56005515, "body": "You should include the code that you use to set the table in your question. Then, you should specify what line your code fails on. The error is incredibly unspecific - it merely states that you didn&#39;t define something."}, {"owner": {"reputation": 15, "user_id": 5629325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd7d40daace49015e4aecbde84ae657?s=128&d=identicon&r=PG&f=1", "display_name": "Opensoul", "link": "https://stackoverflow.com/users/5629325/opensoul"}, "edited": false, "score": 0, "creation_date": 1449751158, "post_id": 34040192, "comment_id": 56148876, "body": "Hi DanL, it was solved. First the table is selected, then the selection page via selection.information is identified, and after that if then statement is run. It worked out. Thank you for your help!"}, {"owner": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "reply_to_user": {"reputation": 15, "user_id": 5629325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd7d40daace49015e4aecbde84ae657?s=128&d=identicon&r=PG&f=1", "display_name": "Opensoul", "link": "https://stackoverflow.com/users/5629325/opensoul"}, "edited": false, "score": 0, "creation_date": 1449753341, "post_id": 34040192, "comment_id": 56150235, "body": "@Opensoul Good to hear. Please mark as answer if it solved your problem :-)"}], "tags": [], "owner": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "is_accepted": true, "score": 0, "last_activity_date": 1449051618, "creation_date": 1449051618, "answer_id": 34040192, "question_id": 34038173, "link": "https://stackoverflow.com/questions/34038173/format-content-control-on-specific-page/34040192#34040192", "title": "Format content control on specific page", "body": "<p>If you only want to format content controls on page 2, you should check the <code>Information</code> property of the content control's <code>Range</code>, e.g.:</p>\n\n<pre><code>Dim cc as ContentControl\nIf cc.Range.Information(wdActiveEndPageNumber) = 2 Then\n    ... Do work ...\nEnd If\n</code></pre>\n\n<p>The <code>wdActiveEndPageNumber</code> constant refers to the physical page. If you desire the logical page (e.g. if Word has been instructed to restart page numbering) instead, you should use the <code>wdActiveEndAdjustedPageNumber</code> constant. See <a href=\"http://word.tips.net/T000728_Determining_the_Current_Page_Number.html\" rel=\"nofollow\">this link</a> for source and details.</p>\n"}], "owner": {"reputation": 15, "user_id": 5629325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd7d40daace49015e4aecbde84ae657?s=128&d=identicon&r=PG&f=1", "display_name": "Opensoul", "link": "https://stackoverflow.com/users/5629325/opensoul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 0, "accepted_answer_id": 34040192, "answer_count": 1, "score": 0, "last_activity_date": 1545420550, "creation_date": 1449045580, "last_edit_date": 1545420550, "question_id": 34038173, "link": "https://stackoverflow.com/questions/34038173/format-content-control-on-specific-page", "title": "Format content control on specific page", "body": "<p>Could please someone help with MS Word's ContentControl formatting programmatically. \nI wrote a code that goes to specific ContentControl according to its tag. And this code works well by going to each ContentControl that is  specified by its Tag. However I need only to format only ContentControls on the page number 2. </p>\n\n<p>I tried to limit the loop only for the specific bookmark, page, table, but it does not work. I don't need to go through each ContentContorl in the document, it takes too much time, which is opposite of the purpose of the macros. I am creating this macros to speed up report formatting. </p>\n\n<p>Here is my code: </p>\n\n<pre><code>    Sub EditCCbyTag()\n\n    Dim cc As ContentControl\n    Dim strText As String\n\n    Dim oThisdoc As Word.Document\n    Dim oCC1 As ContentControl\n    Dim oCCs1 As ContentControls\n    Dim oCC2 As ContentControl\n    Dim oCCs2 As ContentControls\n    Dim oCC3 As ContentControl\n    Dim oCCs3 As ContentControls\n\n    Set oThisdoc = ActiveDocument\n    Set oCCs1 = oThisdoc.SelectContentControlsByTag(\"DgDocDate01\")\n\n    For Each oCC1 In oCCs1\n        If oCCs1.Count &gt; 0 Then\n        oCC1.Range.Select\n        Dialogs(wdDialogContentControlProperties).Show\n\n            strText = InputBox(\"Please enter the DATE of report\")\n\n            Set cc = ActiveDocument.SelectContentControlsByTag(\"DgDocDate01\")(1)\n            cc.Range.Text = strText\n        End If\n\n     Next oCC1\n\n    ' the next CC DgDnvReportNo01\n\n    Set oThisdoc = ActiveDocument\n    Set oCCs2 = oThisdoc.SelectContentControlsByTag(\"DgDnvReportNo01\")\n\n    For Each oCC2 In oCCs2\n\n        If oCCs2.Count &gt; 0 Then\n\n        oCC2.Range.Select\n        Dialogs(wdDialogContentControlProperties).Show\n\n            strText = InputBox(\"Please enter the NUMBER of report\")\n\n            Set cc = ActiveDocument.SelectContentControlsByTag(\"DgDnvReportNo01\")(1)\n            cc.Range.Text = strText\n        End If\n    Next oCC2\n\n    ' the next CC DgRevNo01\n\n    Set oThisdoc = ActiveDocument\n    Set oCCs3 = oThisdoc.SelectContentControlsByTag(\"DgRevNo01\")\n\n    For Each oCC3 In oCCs3\n\n        If oCCs3.Count &gt; 0 Then\n\n        oCC3.Range.Select\n        Dialogs(wdDialogContentControlProperties).Show\n\n            strText = InputBox(\"Please enter the REVISION of report\")\n\n            Set cc = ActiveDocument.SelectContentControlsByTag(\"DgRevNo01\")(1)\n            cc.Range.Text = strText\n\n        End If\n\n    Next oCC3\n\n    MsgBox \"Done!\"\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "is_accepted": false, "score": 0, "last_activity_date": 1449059899, "last_edit_date": 1449059899, "creation_date": 1449058648, "answer_id": 34042561, "question_id": 34038155, "link": "https://stackoverflow.com/questions/34038155/vba-replace-text-based-on-formatting/34042561#34042561", "title": "VBA: Replace text based on formatting", "body": "<p>It is possible to go character-by-character and remove those which have the strikethrough font enabled on them (the ones which are crossed out) <em>in MS Word</em>. However, as far as I know, there is no such possibility to detect a strike-through font in MS PowerPoint.</p>\n\n<p>If you just need to delete the text which has the strikethrough font on it in the selected text only, you can use this Word macro:</p>\n\n<pre><code>Sub RemoveStrikethroughFromSelection()\n    Dim char As Range\n    For Each char In Selection.Characters\n        If char.Font.StrikeThrough = -1 Then\n            char.Delete\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>If more integrated to copying a Word table to another Word document and PowerPoint presentation, the following code might be useful. It first pastes the table to a new Word file, then removes unnecessary characters, and after that pastes this new table to PowerPoint.</p>\n\n<pre><code>Sub CopyWithoutCrossedOutText()\n    Dim DocApp As Object: Set DocApp = CreateObject(\"Word.Application\")\n    Dim PptApp As Object: Set PptApp = CreateObject(\"PowerPoint.Application\")\n    Dim Doc As Object: Set Doc = DocApp.Documents.Add\n    Dim Ppt As Object: Set Ppt = PptApp.Presentations.Add\n    Dim c As Cell\n    Dim char As Range\n    DocApp.Visible = True\n    PptApp.Visible = True\n\n    'Copying Word table to the 2nd Word document\n    ThisDocument.Tables(1).Range.Copy\n    Doc.ActiveWindow.Selection.Paste\n\n    'In the 2nd Word document - removing characters having strikethrough font enabled on them\n    For Each c In Doc.Tables(Doc.Tables.Count).Range.Cells\n        For Each char In c.Range.Characters\n            If char.Font.StrikeThrough = -1 Then\n                char.Delete\n            End If\n        Next\n    Next\n\n    'Copying the table from the 2nd Word document to the PowerPoint presentation\n    Doc.Tables(1).Range.Copy\n    Ppt.Slides.Add(1, 32).Shapes.Paste\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 1, "creation_date": 1449067750, "post_id": 34044740, "comment_id": 55845799, "body": "Nice thought. Especially after I found some inconsistencies in looping approach, as sometimes <code>Selection</code> changes after some character is deleted by the code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "reply_to_user": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1449073436, "post_id": 34044740, "comment_id": 55850126, "body": "Thankyou, yeah, it&#39;s a pain repeatedly editing a selection - you can add those ranges to a collection and delete them in reverse (from the last range to the first) if you want to get it to work though."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "is_accepted": true, "score": 1, "last_activity_date": 1449065791, "last_edit_date": 1449065791, "creation_date": 1449065110, "answer_id": 34044740, "question_id": 34038155, "link": "https://stackoverflow.com/questions/34038155/vba-replace-text-based-on-formatting/34044740#34044740", "title": "VBA: Replace text based on formatting", "body": "<p>The best way to do this without suffering severe performance iterating characters or paragraphs in vba is to use find and replace.</p>\n\n<p>You can do this in vba as follows, note I have wrapped all the actions in a custom undo record, then you can call your current vba routine with <code>CopyDocumentToPowerPoint</code> and the word document will be restored to the state it was before the macro ran (crossed out text remains in word, but is not pasted to powerpoint).</p>\n\n<pre><code>'wrap everything you do in an undo record\nApplication.UndoRecord.StartCustomRecord \"Move to powerpoint\"\n\nWith ActiveDocument.Range.Find\n    .ClearFormatting\n    .Font.StrikeThrough = True\n    .Text = \"\"\n    .Replacement.Text = \"\"\n    .Execute Replace:=wdReplaceAll\nEnd With\n\n'copy to powerpoint and whatever else you want\nCopyDocumentToPowerPoint\n\nApplication.UndoRecord.EndCustomRecord\n\n'and put the document back to where you started\nActiveDocument.Undo\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5629309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c657aba5f6b332792f57fe4a322505f?s=128&d=identicon&r=PG&f=1", "display_name": "RagingRhino", "link": "https://stackoverflow.com/users/5629309/ragingrhino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1479, "favorite_count": 1, "accepted_answer_id": 34044740, "answer_count": 2, "score": 1, "last_activity_date": 1450102230, "creation_date": 1449045513, "last_edit_date": 1450102230, "question_id": 34038155, "link": "https://stackoverflow.com/questions/34038155/vba-replace-text-based-on-formatting", "title": "VBA: Replace text based on formatting", "body": "<p>I have a table in a Word file A which contains a bunch of different Contents. Which I just copy using VBA into another Word or PowerPoint file B. So far that is not a problem. </p>\n\n<p>However, since file A is a working sheet, people sometimes cross stuff out, which means: it should be removed, but for the record it stays in there first. In the final version it shouldnt be displayed, so in the process of copying everything in a different file, the crossed out text should be removed. </p>\n\n<p>To break it down to the technical stuff:\nI want to select text in a Word document, and then remove all text that has a certain formatting. </p>\n\n<p>Maybe there is a special selection possibility or a way to iterate through all characters and test for formatting.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": true, "score": 2, "last_activity_date": 1449047426, "creation_date": 1449047426, "answer_id": 34038740, "question_id": 34037650, "link": "https://stackoverflow.com/questions/34037650/access-compiles-all-code-before-running-first-function/34038740#34038740", "title": "Access compiles all code before running first function", "body": "<p>Sorry for question, I had to dig in more deeply before asking, I found the problem and, probably, it will be interesting for someone.</p>\n\n<p>I ran thru backups and found the copy where application works fine. Application has stopped to work when in the module with Init function was declared function with Enum type declared in common library. When I changed data type to Integer instead of Enum, application worked fine.</p>\n\n<p>Summary: Access checks data types of all functions, declared in module before running particular function and stops to work if <strong>any</strong> function data type not declared in current application.</p>\n"}], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 34038740, "answer_count": 1, "score": 1, "last_activity_date": 1449047426, "creation_date": 1449043622, "last_edit_date": 1495542616, "question_id": 34037650, "link": "https://stackoverflow.com/questions/34037650/access-compiles-all-code-before-running-first-function", "title": "Access compiles all code before running first function", "body": "<p>The application consists of 3 parts: frontend, backend and common library, used in both parts. The application has autoreconnect feature, which offers to select common library if reference to the library is broken and then it reconnects all tables. Application checks for valid common library reference in very first Init function, called from autoexec macro, the function doesn't have any references to common library. Everything worked fine for a long time, but now the application gives \"Syntax Error\" at start if the common library not found. I have no idea what happened with this application, I have many other applications with the same technology, they work fine on the same PC.</p>\n\n<p>I tried to compact/repair, decompile, compact/repair and compile again as it was described <a href=\"https://stackoverflow.com/questions/3266542/how-does-one-decompile-and-recompile-a-database-application\">here</a> - no luck. VBA editor and database options have the same settings for broken and working databases.\nAny ideas what can be done?</p>\n"}, {"tags": ["ms-access", "text", "import", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5629153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfaf6f85087441c3bea5a635f9e0e675?s=128&d=identicon&r=PG&f=1", "display_name": "mzag", "link": "https://stackoverflow.com/users/5629153/mzag"}, "edited": false, "score": 0, "creation_date": 1449051987, "post_id": 34039444, "comment_id": 55835257, "body": "I cant do that because ale is an unrecognized text file"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 13, "user_id": 5629153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfaf6f85087441c3bea5a635f9e0e675?s=128&d=identicon&r=PG&f=1", "display_name": "mzag", "link": "https://stackoverflow.com/users/5629153/mzag"}, "edited": false, "score": 0, "creation_date": 1449067046, "post_id": 34039444, "comment_id": 55845228, "body": "@mzag: rename the file to <code>A001R6Y6_AVID.tab</code>, because the values are Tab separated. The usual extension for this was <code>.tsv</code>, but Access wants <code>.tab</code> :shrug:"}], "tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1449049463, "creation_date": 1449049463, "answer_id": 34039444, "question_id": 34037506, "link": "https://stackoverflow.com/questions/34037506/getting-data-from-unsupported-text-file-with-vba-to-access-table/34039444#34039444", "title": "Getting data from unsupported text file with VBA to Access table", "body": "<p>Create Saved Import: External Data -> Text File, when import ended, tick \"Save Import\" checkbox. After this you can run this saved import using <code>ImportExportSpecifications</code> object:</p>\n\n<pre><code>Dim ieImport As ImportExportSpecification\nSet ieImport = CurrentProject.ImportExportSpecifications.Item(\"My Import Name\")\nieImport.Execute\n</code></pre>\n\n<p>Import the data to temporary table and delete unnecessary rows with service data or use this service data if needed.</p>\n"}], "owner": {"reputation": 13, "user_id": 5629153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfaf6f85087441c3bea5a635f9e0e675?s=128&d=identicon&r=PG&f=1", "display_name": "mzag", "link": "https://stackoverflow.com/users/5629153/mzag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1449053933, "accepted_answer_id": 34039444, "answer_count": 1, "score": 1, "last_activity_date": 1594640981, "creation_date": 1449043066, "last_edit_date": 1594640981, "question_id": 34037506, "link": "https://stackoverflow.com/questions/34037506/getting-data-from-unsupported-text-file-with-vba-to-access-table", "closed_reason": "Needs more focus", "title": "Getting data from unsupported text file with VBA to Access table", "body": "<p>I have an ale text file.\nThis file automatically created by a camera and it contains all the meta data of the recorded clips.</p>\n\n<p>I would like to create a function that gets the ale file address (C:\\test.ale) and adds all the rows (from row 11 and on, as you can see in the <a href=\"https://i.stack.imgur.com/hoR7e.jpg\" rel=\"nofollow noreferrer\">screenshot</a>) of the columns \"start\",\"end\",\"fps\" &amp; \"gamma\" from the test.ale file to \"Camera meta data\" table in my access database.</p>\n\n<p>I have tried using DoCmd.TransferSpreadsheet and DoCmd.TransferText but this file type is not recognized by access.</p>\n\n<p>I have added a <a href=\"https://drive.google.com/file/d/0BzCkf0ywgE9XUFhXX2NYWjhzcms/view?usp=sharing\" rel=\"nofollow noreferrer\">link to the ale file</a> and a screenshot of the file as it opens by Excel.</p>\n"}, {"tags": ["apache", "vba", "excel", "tomcat", "winhttp"], "comments": [{"owner": {"reputation": 71156, "user_id": 1190388, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5391819cc4abe0cb43587c9ef1808dbd?s=128&d=identicon&r=PG", "display_name": "hjpotter92", "link": "https://stackoverflow.com/users/1190388/hjpotter92"}, "edited": false, "score": 0, "creation_date": 1449047558, "post_id": 34037475, "comment_id": 55832501, "body": "What happens if you do: <code>JSONString = &quot;{&#39;name&#39;:&#39;long&#39;,&#39;startDate&#39;:12345,&#39;endDate&#39;:67890,&#39;status&#39;:&#39;&zwnj;&#8203;in progress&#39;}&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5629177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb4a1711397283f6192b4b81012dd07b?s=128&d=identicon&r=PG&f=1", "display_name": "Long", "link": "https://stackoverflow.com/users/5629177/long"}, "is_accepted": false, "score": 0, "last_activity_date": 1449143686, "creation_date": 1449143686, "answer_id": 34065435, "question_id": 34037475, "link": "https://stackoverflow.com/questions/34037475/wrong-string-parameter-when-sending-a-json-string-as-a-post-request/34065435#34065435", "title": "Wrong String parameter when sending a json string as a post request", "body": "<pre><code>I solved this problem:\n\nSub Macro1()\nDim URL As String, JSONString As String, objHTTP As Object\nSet objHTTP = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\nURL = \"xxxxx?name=long&amp;startDate=12345&amp;endDate=67890&amp;status=in progress\"\nobjHTTP.Open \"POST\", URL, False\nobjHTTP.setRequestHeader \"Content-type\", \"application/x-www-form-urlencoded\"\nobjHTTP.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\n\nobjHTTP.send\nDebug.Print objHTTP.Status\nDebug.Print objHTTP.responseText\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5629177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb4a1711397283f6192b4b81012dd07b?s=128&d=identicon&r=PG&f=1", "display_name": "Long", "link": "https://stackoverflow.com/users/5629177/long"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 421, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449143686, "creation_date": 1449042945, "last_edit_date": 1449043738, "question_id": 34037475, "link": "https://stackoverflow.com/questions/34037475/wrong-string-parameter-when-sending-a-json-string-as-a-post-request", "title": "Wrong String parameter when sending a json string as a post request", "body": "<p>I used this code for my Macro in VBA in excel:</p>\n\n<pre><code>Sub Macro1()\n\nDim URL As String, JSONString As String, objHTTP As Object\nSet objHTTP = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\nURL = \"xxxxx\"\nobjHTTP.Open \"POST\", URL, False\nobjHTTP.setRequestHeader \"Content-type\", \"application/x-www-form-urlencoded\"\nobjHTTP.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\nJSONString = \"{\"\"name\"\": \"\"long\"\",\"\"startDate\"\": 12345,\"\"endDate\"\": 67890,\"\"status\"\": \"\"in progress\"\"}\"\nobjHTTP.send JSONString\nDebug.Print objHTTP.Status\nDebug.Print objHTTP.responseText\n\nEnd Sub\n</code></pre>\n\n<p>In the immediate window, I received this error:</p>\n\n<blockquote>\n  <p>400  Apache Tomcat/8.0.28 - Error\n  reportH1\n  {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;}\n  H2\n  {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;}\n  H3\n  {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:14px;}\n  BODY\n  {font-family:Tahoma,Arial,sans-serif;color:black;background-color:white;}\n  B\n  {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;} P\n  {font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;}A\n  {color : black;}A.name {color : black;}.line {height: 1px;\n  background-color: #525D76; border: none;}\n  <h1>HTTP Status 400 - Required String parameter 'name' is\n  not present</h1><p><b>type</b> Status\n  report</p><p><b>message</b> Required String parameter 'name' is not\n  present</p><p><b>description</b> The request sent by the client\n  was syntactica lly incorrect.</p><h3>Apache\n  Tomcat/8.0.28</h3></p>\n</blockquote>\n\n<p>I have not known how to solve it, please help me !</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1236, "user_id": 992391, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2b821b424ca79c022f55b773aabb1215?s=128&d=identicon&r=PG", "display_name": "CHawk", "link": "https://stackoverflow.com/users/992391/chawk"}, "edited": false, "score": 0, "creation_date": 1449044004, "post_id": 34037288, "comment_id": 55830440, "body": "Can you clarify what you are trying to do? Do you want to take Range(&#39;A1:B20&#39;) in worksheet A and put them in worksheet B, erasing any content that was in worksheet B before?"}], "answers": [{"tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1449044219, "creation_date": 1449044219, "answer_id": 34037796, "question_id": 34037288, "link": "https://stackoverflow.com/questions/34037288/excel-vba-macro-how-to-create-an-empty-range-variable-object/34037796#34037796", "title": "Excel vba macro how to create an empty Range variable object", "body": "<p>After you have deleted a Range you cannot refer to it because it does not exist. The address A1 of course still exists but now points to a different range.</p>\n\n<p>You can clear a range or overwrite it with new data or copy a range from somewhere and paste it somewhere else.</p>\n\n<p>BTW inserting ranges can be very time-expensive ...</p>\n"}], "owner": {"reputation": 593, "user_id": 5101747, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4cbce6cd2a76e5fd2edd6aa8e35e4429?s=128&d=identicon&r=PG&f=1", "display_name": "vims liu", "link": "https://stackoverflow.com/users/5101747/vims-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3213, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522158395, "creation_date": 1449042171, "last_edit_date": 1522158395, "question_id": 34037288, "link": "https://stackoverflow.com/questions/34037288/excel-vba-macro-how-to-create-an-empty-range-variable-object", "title": "Excel vba macro how to create an empty Range variable object", "body": "<p>As the question says, how to create an empty range variable object:</p>\n\n<p>tested with the code below it cannot insert a new cell/range from a different source (workbook/worksheet).</p>\n\n<pre><code>Public Sub test()\n\nDim Sheet As Worksheet    \nDim t As Range    \nSet Sheet = ActiveWorkbook.Sheets(1)    \nSheet.Activate    \nSet t = Sheet.Range(\"A1:A1\")    \nt.Delete    \nt.Insert   \n\nEnd Sub\n</code></pre>\n\n<p>the above code gives me the object required exception. How do we create an empty Range and populate it with cells from another source or at least a custom made cell to be inserted in the Range? </p>\n\n<p>similar to how an array object is capable or in a gridview where we can create a row/column/cell object instantiate it and give values to it and add it to gridview, like how you do it in asp.net/c# winforms?</p>\n"}, {"tags": ["vba", "header-files", "vbe"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1449041448, "post_id": 34037058, "comment_id": 55829286, "body": "<a href=\"http://www.mztools.com/index.aspx\" rel=\"nofollow noreferrer\">mztools.com/index.aspx</a>"}, {"owner": {"reputation": 872, "user_id": 1317855, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/tt1uQ.jpg?s=128&g=1", "display_name": "SorryEh", "link": "https://stackoverflow.com/users/1317855/sorryeh"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1449599464, "post_id": 34037058, "comment_id": 56073426, "body": "@TimWilliams thank you! this helps plenty! sorry for late response."}], "answers": [{"comments": [{"owner": {"reputation": 872, "user_id": 1317855, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/tt1uQ.jpg?s=128&g=1", "display_name": "SorryEh", "link": "https://stackoverflow.com/users/1317855/sorryeh"}, "edited": false, "score": 0, "creation_date": 1449599410, "post_id": 34097902, "comment_id": 56073402, "body": "so sorry for late response, thank you Peter! this and what Tim posted are exactly what I was looking for! this helps me out a bunnch especially with other stuff I wasn&#39;t aware of lol. thanks again"}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 1, "last_activity_date": 1449265172, "last_edit_date": 1525816150, "creation_date": 1449265172, "answer_id": 34097902, "question_id": 34037058, "link": "https://stackoverflow.com/questions/34037058/creating-custom-header-in-ms-visual-basic-for-application/34097902#34097902", "title": "Creating Custom Header in MS Visual Basic for Application", "body": "<p>@TimWilliams linked to the tools that I use in my development. That toolset has exactly what you're for.</p>\n\n<p>But if you're looking for the details of how the VBA Editor is modified (as shown in your tutorial and in MZTools), you should read about the <code>VBE Object</code> in the <a href=\"https://msdn.microsoft.com/en-us/library/aa443984(v=vs.60).aspx\" rel=\"nofollow noreferrer\">MS Reference Documentation</a>. Chip Pearson also has an excellent intro to some of the concepts in <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">modifying the VBA programming environment</a> too.</p>\n"}], "owner": {"reputation": 872, "user_id": 1317855, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/tt1uQ.jpg?s=128&g=1", "display_name": "SorryEh", "link": "https://stackoverflow.com/users/1317855/sorryeh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 1, "accepted_answer_id": 34097902, "answer_count": 1, "score": 1, "last_activity_date": 1449265172, "creation_date": 1449041161, "last_edit_date": 1449042070, "question_id": 34037058, "link": "https://stackoverflow.com/questions/34037058/creating-custom-header-in-ms-visual-basic-for-application", "title": "Creating Custom Header in MS Visual Basic for Application", "body": "<p>I am going through learning modules and the author of the VBA tutorials did something cool.</p>\n\n<p>He clicked the \"Insert Code Element Header\" button and it automatically pasted something he made himself as a standard header (he uses repeatedly).</p>\n\n<p>I've been googling, but I can't seem to figure out how he did it.</p>\n\n<p>I am using Office 2013, and MS VB for Apps version 7.1, his version does seem older, maybe version 5.0/6.0, he doesn't state it. What he does is convenient because he just removes the comment for stuff that he knows hes going to use on most projects, whether they are modules, objects, or class modules.</p>\n\n<p>When I click the Insert Header button, it only gives me these options, that i cannot add to:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DXnO1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DXnO1.png\" alt=\"MSVBAmyHeader\"></a></p>\n\n<p>Here's a screenshot of what his VBA looks like, and the header:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dqVMJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dqVMJ.png\" alt=\"MSVBA\"></a></p>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["c#", "vba", "excel", "c#-4.0"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 5545870, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4511ce4ec1b0fdff2cda84a151542966?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh D", "link": "https://stackoverflow.com/users/5545870/rajesh-d"}, "edited": false, "score": 0, "creation_date": 1449047520, "post_id": 34038365, "comment_id": 55832483, "body": "Its not woking.. Thanks for your reply"}], "tags": [], "owner": {"reputation": 137, "user_id": 2135001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d54155efecb0b0801a18ad825842d5?s=128&d=identicon&r=PG", "display_name": "Santhosh Legent", "link": "https://stackoverflow.com/users/2135001/santhosh-legent"}, "is_accepted": false, "score": 0, "last_activity_date": 1449046246, "creation_date": 1449046246, "answer_id": 34038365, "question_id": 34036707, "link": "https://stackoverflow.com/questions/34036707/how-to-select-only-content-in-the-sheet-rather-all-unused-empty-cell-value/34038365#34038365", "title": "How to select only content in the sheet rather all unused/empty cell value", "body": "<pre><code>public DataTable ImportExceltoDatatable(string filepath)\n{\n    // string sqlquery= \"Select * From [SheetName$] Where YourCondition\";\n    string sqlquery = \"Select * From [SheetName$] Where Id='ID_007'\";\n    DataSet ds = new DataSet();\n    string constring = @\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" + filepath + \";Extended Properties=\\\"Excel 12.0;HDR=YES;\\\"\";\n    OleDbConnection con = new OleDbConnection(constring + \"\");\n    OleDbDataAdapter da = new OleDbDataAdapter(sqlquery, con);\n    da.Fill(ds);\n    DataTable dt = ds.Tables[0];\n    return dt;\n}\n</code></pre>\n\n<p>you can use this one, if it match </p>\n"}], "owner": {"reputation": 147, "user_id": 5545870, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4511ce4ec1b0fdff2cda84a151542966?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh D", "link": "https://stackoverflow.com/users/5545870/rajesh-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1449046246, "creation_date": 1449039632, "question_id": 34036707, "link": "https://stackoverflow.com/questions/34036707/how-to-select-only-content-in-the-sheet-rather-all-unused-empty-cell-value", "title": "How to select only content in the sheet rather all unused/empty cell value", "body": "<p>My goal is to load the excel(only one sheet) data to DataTable. so that i have used the following query. </p>\n\n<pre><code>                 System.Data.OleDb.OleDbConnection MyConnection;\n                System.Data.DataSet custdataset;\n                System.Data.OleDb.OleDbDataAdapter MyCommand;\n                MyConnection = new OleDbConnection\n                {\n                    ConnectionString = ConnectionString(filename, \"Yes\")\n                };\n\n                MyCommand = new System.Data.OleDb.OleDbDataAdapter(\"select * from [Sheet1$]\", MyConnection);\n                MyCommand.TableMappings.Add(\"Table\", \"TestTable\");\n                custdataset = new System.Data.DataSet();\n                MyCommand.Fill(custdataset);\n                MyConnection.Close();\n</code></pre>\n\n<p>but it load the all unused/empty cell value to datatable. how to avoid that? how to load only used cell value. For example A1 to F4 not whole sheet.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2999, "user_id": 531856, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/150c51b891ad8c627448ef04b882fced?s=128&d=identicon&r=PG", "display_name": "sMaN", "link": "https://stackoverflow.com/users/531856/sman"}, "edited": false, "score": 0, "creation_date": 1449037165, "post_id": 34035991, "comment_id": 55827400, "body": "IMO the first code fragment is more readable and thus preferred. Is there a benefit to having multiple definitions in-line?"}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1449037508, "post_id": 34035991, "comment_id": 55827547, "body": "Can you please provide more code example? and formate it as code? thanks"}], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 606318, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aiCP5.jpg?s=128&g=1", "display_name": "Tomasz P. Szynalski", "link": "https://stackoverflow.com/users/606318/tomasz-p-szynalski"}, "edited": false, "score": 0, "creation_date": 1608224058, "post_id": 34036529, "comment_id": 115524021, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/declaring-variables\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/concepts/&hellip;</a> says it explicitly"}], "tags": [], "owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "is_accepted": false, "score": 7, "last_activity_date": 1449038833, "creation_date": 1449038833, "answer_id": 34036529, "question_id": 34035991, "link": "https://stackoverflow.com/questions/34035991/vba-variable-declaration-okay-on-two-lines-but-not-when-comma-separated-compile/34036529#34036529", "title": "VBA variable declaration okay on two lines but not when comma separated. Compiler bug?", "body": "<p>So, please take a look at VBA editor on this. First statement seems like to declare 3 integers, but not. Variable <code>i</code> and <code>j</code> are variant and only <code>k</code> is integer.</p>\n\n<p>So if you look on your code, <code>table_rng</code> is declared as variant/empty and maybe this is what causing issue, but without rest of your code i cant tell you more.</p>\n\n<p>But i recommend you to use single variable declaration on line, its far more easier to read. Or if you wana to declare more variable on single line, you need to specifi date type for each of them (like last line on my example. If you wana to know variable types, use debugging in VBA and View/Locals window).</p>\n\n<pre><code>Sub testVarDeclar()\n\n    Dim i, j, k As Integer\n\n    Dim a As Integer, b As Integer\n\n    Dim table_rng, attachments_rng As Range\n\n    Dim table_rng2 As Range, attachments_rng2 As Range\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 136, "user_id": 5575785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eid5X.jpg?s=128&g=1", "display_name": "Tim Joy T-Square Consulting", "link": "https://stackoverflow.com/users/5575785/tim-joy-t-square-consulting"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1541, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1449038833, "creation_date": 1449036560, "last_edit_date": 1531164843, "question_id": 34035991, "link": "https://stackoverflow.com/questions/34035991/vba-variable-declaration-okay-on-two-lines-but-not-when-comma-separated-compile", "title": "VBA variable declaration okay on two lines but not when comma separated. Compiler bug?", "body": "<p>I have the following variable declaration in a procedure which works fine.</p>\n\n<pre><code>Dim table_rng As Range\nDim attachments_rng As Range\n</code></pre>\n\n<p>I did have it as: </p>\n\n<pre><code>Dim table_rng, attachments_rng As Range\n</code></pre>\n\n<p>but this caused a \"Compile error: ByRef argument type mismatch\".</p>\n\n<p>Since I have working code I'm not in a crisis but I wasted an hour finding this solution.  </p>\n\n<p>I'm using Excel 2010 with Visual Basic for Applications 7.0.1628</p>\n\n<p>As far as I know the second declaration is syntactically correct.   Am I missing something?  I searched in vain on the web and stackoverflow.com for any wisdom on the topic.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "listbox"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5596214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/010ac259e5b7c8c4ba852ebd1286c1ae?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Zell", "link": "https://stackoverflow.com/users/5596214/kevin-zell"}, "edited": false, "score": 0, "creation_date": 1449032085, "post_id": 34034771, "comment_id": 55825657, "body": "That didn&#39;t work it is saying Invalid or unqualified reference. Any idea how to fix that?"}, {"owner": {"reputation": 1236, "user_id": 992391, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2b821b424ca79c022f55b773aabb1215?s=128&d=identicon&r=PG", "display_name": "CHawk", "link": "https://stackoverflow.com/users/992391/chawk"}, "reply_to_user": {"reputation": 5, "user_id": 5596214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/010ac259e5b7c8c4ba852ebd1286c1ae?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Zell", "link": "https://stackoverflow.com/users/5596214/kevin-zell"}, "edited": false, "score": 0, "creation_date": 1449037671, "post_id": 34034771, "comment_id": 55827607, "body": "Eric K edited the code in my answer, may work now. If you want further help you&#39;ll have to be more specific. What line are you getting the error in? What is it highlighting?"}], "tags": [], "owner": {"reputation": 1236, "user_id": 992391, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2b821b424ca79c022f55b773aabb1215?s=128&d=identicon&r=PG", "display_name": "CHawk", "link": "https://stackoverflow.com/users/992391/chawk"}, "is_accepted": true, "score": 0, "last_activity_date": 1449037604, "last_edit_date": 1449037604, "creation_date": 1449029362, "answer_id": 34034771, "question_id": 34034337, "link": "https://stackoverflow.com/questions/34034337/use-a-listbox-selection-to-select-and-go-to-a-cell/34034771#34034771", "title": "Use a listbox selection to select and go to a cell", "body": "<p>You should iterate through the rows that contain the subIndustry value. If the subIndustry names are in column 'A'. </p>\n\n<p>Something like (warning: untested)</p>\n\n<pre><code>Dim c as Range\nLastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nFor Each c In Range(\"A1:A\" + LastRow).Cells\n  If c.Value == subIndustry Then\n    c.parent.activate 'Activate worksheet\n    c.select\n    Exit\n  End If\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 5596214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/010ac259e5b7c8c4ba852ebd1286c1ae?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Zell", "link": "https://stackoverflow.com/users/5596214/kevin-zell"}, "edited": false, "score": 0, "creation_date": 1449034430, "post_id": 34035470, "comment_id": 55826420, "body": "Thanks this helps, but it still isn&#39;t doing exactly what I am looking for it to do. I want the selected cell to be the SubIndustry that the user selects. The userform currently has two listboxes one that includes all the sectors and when the user clicks on a sector it goes to that sheet then the second listbox is populated with the unique sub industry values related to that sector. So I then want the unique sub industry that the user clicks on in the listbox to be the selected cell on that sheet."}, {"owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "reply_to_user": {"reputation": 5, "user_id": 5596214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/010ac259e5b7c8c4ba852ebd1286c1ae?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Zell", "link": "https://stackoverflow.com/users/5596214/kevin-zell"}, "edited": false, "score": 0, "creation_date": 1449035313, "post_id": 34035470, "comment_id": 55826731, "body": "Maybe u can snapshot your sub sector list. Do you means Autofilter by subsector in the Sector worksheet ?"}, {"owner": {"reputation": 5, "user_id": 5596214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/010ac259e5b7c8c4ba852ebd1286c1ae?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Zell", "link": "https://stackoverflow.com/users/5596214/kevin-zell"}, "edited": false, "score": 0, "creation_date": 1449035430, "post_id": 34035470, "comment_id": 55826759, "body": "How do I add a screenshot of it on here?"}, {"owner": {"reputation": 5, "user_id": 5596214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/010ac259e5b7c8c4ba852ebd1286c1ae?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Zell", "link": "https://stackoverflow.com/users/5596214/kevin-zell"}, "edited": false, "score": 0, "creation_date": 1449036718, "post_id": 34035470, "comment_id": 55827224, "body": "It is in my description now"}, {"owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "reply_to_user": {"reputation": 5, "user_id": 5596214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/010ac259e5b7c8c4ba852ebd1286c1ae?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Zell", "link": "https://stackoverflow.com/users/5596214/kevin-zell"}, "edited": false, "score": 0, "creation_date": 1449036941, "post_id": 34035470, "comment_id": 55827312, "body": "To confirm, do you means when click go to sector, it will Autofilter your data, Column M &amp; N, whichever records meet Sector &amp; SubSector ?"}, {"owner": {"reputation": 5, "user_id": 5596214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/010ac259e5b7c8c4ba852ebd1286c1ae?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Zell", "link": "https://stackoverflow.com/users/5596214/kevin-zell"}, "edited": false, "score": 0, "creation_date": 1449037079, "post_id": 34035470, "comment_id": 55827371, "body": "I just need it to make the active cell the first cell in column N that contains the selected item in the subindustry listbox"}, {"owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "reply_to_user": {"reputation": 5, "user_id": 5596214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/010ac259e5b7c8c4ba852ebd1286c1ae?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Zell", "link": "https://stackoverflow.com/users/5596214/kevin-zell"}, "edited": false, "score": 0, "creation_date": 1449038379, "post_id": 34035470, "comment_id": 55827916, "body": "you can use ActiveWindow.ScrollRow = RowYouWantToGo, in your case need a lookup logic to find out the Row Number."}], "tags": [], "owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1449104254, "last_edit_date": 1449104254, "creation_date": 1449033620, "answer_id": 34035470, "question_id": 34034337, "link": "https://stackoverflow.com/questions/34034337/use-a-listbox-selection-to-select-and-go-to-a-cell/34035470#34035470", "title": "Use a listbox selection to select and go to a cell", "body": "<p>Below function I use for my joining logic, it help identify the Row Number for matched record.</p>\n\n<p>This Function is flexible can match multiple criteria.</p>\n\n<p>In your case,</p>\n\n<pre><code>ActiveWindow.ScrollRow = getRowMultiMatch(Array(Range(\"M:M\"), Range(\"N:N\")), 1, Array(Sector,Subsector))\n\n\nFunction getRowMultiMatch(ByVal arrRange As Variant, ByVal startMatchOnRow As Single, ByVal arrMatchValue As Variant) As Single\n'Return 0 if unable to match\n'arrRange = Array of Source Range\n'startMatchOnRow = 1\n'arrMatchValue = Array of Value need to Match\n\nDim i, nRow, nStartRow, nLastRow As Single\nDim nRng, dataRng, nColRng As Range\nDim nWSD As Worksheet\nDim nValue As Variant\n\n        Set nColRng = arrRange(0)\n        Set nWSD = nColRng.Parent\n\n        'Start and Last (Row Number) Help define when to stop looping\n        nStartRow = nColRng.Cells(1).Row\n        If startMatchOnRow &gt; nStartRow Then nStartRow = startMatchOnRow\n        nLastRow = nColRng.Cells(nColRng.Cells.Count).Row\n\nRetry:\n        'Sizing nRng\n        Set nRng = Intersect(nColRng.EntireColumn, nWSD.Range(nWSD.Rows(nStartRow), nWSD.Rows(nLastRow)))\n\n        nValue = arrMatchValue(0)\n        If IsNumeric(nValue) = False Then\n            nValue = CStr(nValue)\n            nValue = Replace(nValue, \"*\", \"~*\")\n        End If\n\n        'Matching First Item\n        If IsError(Application.Match(nValue, nRng, 0)) Then\n            getRowMultiMatch = 0\n            Exit Function\n        Else\n            nRow = Application.Match(nValue, nRng, 0)\n            'Looping to Check if all values are match\n            For i = 1 To UBound(arrMatchValue) 'Start loop from 2nd Item\n                Set dataRng = Intersect(nWSD.Rows(nStartRow + nRow - 1), arrRange(i).EntireColumn)\n                If StrComp(dataRng.Value, arrMatchValue(i)) &lt;&gt; 0 Then\n                    'Not Match\n                    'Resize nRng then Retry\n                    GoTo NotMatch\n                Else\n                    'Matched\n                End If\n            Next i\n            'All Matched\n            getRowMultiMatch = nStartRow + nRow - 1\n            Exit Function\nNotMatch:\n            nStartRow = nStartRow + nRow\n            If nStartRow &gt; nLastRow Then\n                Exit Function\n            Else\n                GoTo Retry\n            End If\n        End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5596214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/010ac259e5b7c8c4ba852ebd1286c1ae?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Zell", "link": "https://stackoverflow.com/users/5596214/kevin-zell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2824, "favorite_count": 0, "accepted_answer_id": 34034771, "answer_count": 2, "score": 0, "last_activity_date": 1449104254, "creation_date": 1449026582, "last_edit_date": 1449036679, "question_id": 34034337, "link": "https://stackoverflow.com/questions/34034337/use-a-listbox-selection-to-select-and-go-to-a-cell", "title": "Use a listbox selection to select and go to a cell", "body": "<p><a href=\"http://i.stack.imgur.com/513mu.png\" rel=\"nofollow\">enter image description here</a>I have a workbook that contains a different worksheet for each industry sector in the S&amp;P 500 i.e Tech, Energy, Ect. and I created a userform with two listboxes that allow the user to first select a sector then a sub sector that is unique to that sector. The listboxes are working just fine, but now I want to create a command button that takes whatever sub sector the user selects and makes the first row of data on the active sheet containing that sub sector the active cell.</p>\n\n<pre><code>Private Sub GoToSectorButton_Click()\n'Declare variables\nDim SubIndustry As String\nDim IntRow As Integer\n\n'Set list box value equal to the variable\nSubIndustry = lstSubIndustry.Value\n\n'Locate the first occurance of the Sub Industry\nIntRow = 3\n\n'Select the row that contains\nActiveSheet.cell(SubIndustry).Select\n\nEnd Sub\n\n\nPrivate Sub UserForm_Initialize()\n\n'declare variable\nDim shtIndustry As Worksheet\n'shows Industries in lstIndustry that aren't the first set of sets\nFor Each shtIndustry In Application.Workbooks(\"VBA_Finance_Project_KEZE6983.xlsm\").Worksheets\n    If shtIndustry.Name &lt;&gt; \"Welcome\" And shtIndustry.Name &lt;&gt; \"Name Or Sector\" And shtIndustry.Name &lt;&gt; \"Name\" And shtIndustry.Name &lt;&gt; \"Sector\" And shtIndustry.Name &lt;&gt; \"Filter\" And shtIndustry.Name &lt;&gt; \"Master\" Then\n\n        lstIndustry.AddItem (shtIndustry.Name)\n\n    End If\nNext shtIndustry\n\n'select default list box item\nlstIndustry.ListIndex = 0\n\nEnd Sub\n\nPrivate Sub lstIndustry_Click()\n\n'declare variables\nDim strSI As String, rngData As Range, rngCell As Range, shtSubIndustry As Worksheet\n\n'clear list box\nlstSubIndustry.Clear\n\n'Save relevant worksheets to a vaiable so that we can use the vaiable in the rest of the program as a shortcut\nSet shtSubIndustry = Application.Workbooks(\"VBA_Finance_Project_KEZE6983.xlsm\").Worksheets(lstIndustry.ListIndex + 5)\n\n'activate worksheet clicked\nshtSubIndustry.Activate\n\n'assign address of Industry data to rngData variable\nSet rngData = Application.Workbooks(\"VBA_Finance_Project_KEZE6983.xlsm\").ActiveSheet.Range(\"A3\").CurrentRegion\n\n'assign Column heading to srtSI variable\nstrSI = \"GICS Sub Industry\"\n\n'Add the Sub Industry\nFor Each rngCell In rngData.Columns(14).Cells\n    If rngCell.Value &lt;&gt; strSI And rngCell.Value &lt;&gt; \"\" Then\n        lstSubIndustry.AddItem rngCell.Value\n        strSI = rngCell.Value\n    End If\nNext rngCell\n\n'select default list box item\nlstSubIndustry.ListIndex = 0\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 4652894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/130998a055ce92cacd559eec76cac2e0?s=128&d=identicon&r=PG&f=1", "display_name": "Akhil", "link": "https://stackoverflow.com/users/4652894/akhil"}, "edited": false, "score": 0, "creation_date": 1449035227, "post_id": 34034247, "comment_id": 55826698, "body": "Thanks a lot! Do i have to call this sub again elsewhere? I followed what you said, and added it into the sheet only. However, it doesn&#39;t seem to be working. What i meant by copying sheets is that: This is the &quot;template&quot; sheet, and hence, i would be copying the template sheet to a new sheet, and renaming it. Hence, i was hoping that the macro would follow as well."}, {"owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "reply_to_user": {"reputation": 39, "user_id": 4652894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/130998a055ce92cacd559eec76cac2e0?s=128&d=identicon&r=PG&f=1", "display_name": "Akhil", "link": "https://stackoverflow.com/users/4652894/akhil"}, "edited": false, "score": 1, "creation_date": 1449035624, "post_id": 34034247, "comment_id": 55826824, "body": "Worksheet_Change will be trigger when there have changes on cells in that sheet. The only thing u need to handle is the target, because u only it trigger when specific cells changed. If you duplicate the whole sheet then rename it, the code will follow, but be careful on your reference."}], "tags": [], "owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1449025934, "creation_date": 1449025934, "answer_id": 34034247, "question_id": 34034080, "link": "https://stackoverflow.com/questions/34034080/excel-macro-1-code-below-doesnt-work-2-how-do-i-make-a-macro-run-real-time/34034247#34034247", "title": "Excel Macro: (1) Code below doesn&#39;t work (2) How do i make a macro run real time on any sheet", "body": "<p>You need to put below code in with the sheet, not in module</p>\n\n<p><a href=\"https://i.stack.imgur.com/GtQU8.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GtQU8.gif\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Address(0, 0) = \"D42\" Then\n\n        Dim Number_1 As Integer\n        Dim Number_2 As Integer\n\n        Number_1 = Range(\"D42\").Value\n        Number_2 = Range(\"D43\").Value\n\n        If Number_1 - Number_2 &gt; 0 Then\n            Columns(\"E:P\").EntireColumn.Hidden = False\n        Else\n            Columns(\"E:P\").EntireColumn.Hidden = True\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I'm not sure about you means copy the sheet to another.</p>\n\n<p>If you copy the entire sheet to another workbook, above code will follow too.\nBecause it's attached with worksheet.</p>\n\n<p>Hope this help !</p>\n"}], "owner": {"reputation": 39, "user_id": 4652894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/130998a055ce92cacd559eec76cac2e0?s=128&d=identicon&r=PG&f=1", "display_name": "Akhil", "link": "https://stackoverflow.com/users/4652894/akhil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 34034247, "answer_count": 1, "score": 0, "last_activity_date": 1449050998, "creation_date": 1449024842, "last_edit_date": 1449050998, "question_id": 34034080, "link": "https://stackoverflow.com/questions/34034080/excel-macro-1-code-below-doesnt-work-2-how-do-i-make-a-macro-run-real-time", "title": "Excel Macro: (1) Code below doesn&#39;t work (2) How do i make a macro run real time on any sheet", "body": "<p>Let me explain the problem i am trying to solve using the macro below. There's a template sheet, where i would fill in Column D. If the value of D42(Which is calculated based on inputs earlier) is &lt; D43(A fixed value), I would like Columns E-P to remain hidden. If D42 > D43, i would like columns E-P to show up (which would require to be filled up). My code below is not working - It seems that Number_1 &amp; Number_2 are both being assigned 0.</p>\n\n<p>The second issue i am trying to solve is that I would copy this template sheet to another sheet (Let's call it XYZ) and run it there - I thought that using ActiveSheet would solve it, but doesn't seem to work. Ideally, I would like it if the macro could be running real time (Hence, no button to press to enable the macro) - No idea how to tackle this problem</p>\n\n<p>Any help is greatly appreciated!</p>\n\n<pre><code>Sheets(ActiveSheet.Name).Select\n\nColumns(\"E:P\").EntireColumn.Hidden = True\n\nDim Number_1 As Integer\nDim Number_2 As Integer\n\nNumber_1 = ActiveSheet.Range(\"D42\").Value\nNumber_2 = ActiveSheet.Range(\"D43\").Value\n\nIf Number_1 - Number_2 &gt; 0 Then\n\nColumns(\"E:P\").EntireColumn.Hidden = False\n\nElse\n\nColumns(\"E:P\").EntireColumn.Hidden = True\n\nEnd If\n</code></pre>\n"}, {"tags": ["xml", "excel", "vba"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1449025052, "post_id": 34033934, "comment_id": 55823543, "body": "You need an <code>End Sub</code> at the very end to close &quot;Sub xmltoxl()&quot;. An <code>Option Explicit</code> at the top of the module is also strongly advised"}, {"owner": {"reputation": 41, "user_id": 5548370, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/470485441d0316d3a442569fd97036f2?s=128&d=identicon&r=PG&f=1", "display_name": "bennyharassi", "link": "https://stackoverflow.com/users/5548370/bennyharassi"}, "reply_to_user": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1449068859, "post_id": 34033934, "comment_id": 55846676, "body": "Added but now I get an error &quot;Run-time error &#39;68&#39;.  Device unavailable.&quot;  Running this on a Mac - Excel 11&#39;"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1449112789, "post_id": 34033934, "comment_id": 55868463, "body": "A Windows path like &quot;C:\\Users\\Kanye...&quot; is not going to make any sense on a Mac. See <a href=\"http://stackoverflow.com/q/10045474/2127508\">this question</a> for how to use Dir on a Mac"}, {"owner": {"reputation": 41, "user_id": 5548370, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/470485441d0316d3a442569fd97036f2?s=128&d=identicon&r=PG&f=1", "display_name": "bennyharassi", "link": "https://stackoverflow.com/users/5548370/bennyharassi"}, "reply_to_user": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1449439858, "post_id": 34033934, "comment_id": 55995528, "body": "Thanks it works now but the files it returns give this error upon opening: <a href=\"http://imgur.com/SiyiGag\" rel=\"nofollow noreferrer\">imgur.com/SiyiGag</a> .. any clue why it&#39;s corrupted?"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1449450974, "post_id": 34033934, "comment_id": 55998614, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/ff841185(v=office.15).aspx\" rel=\"nofollow noreferrer\">Workbook.SaveAs</a> can take a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff198017.aspx\" rel=\"nofollow noreferrer\">FileFormat parameter</a> so try using either the &quot;xlCSV&quot; or &quot;xlCSVMac&quot; options - <code>wbk.SaveAs yourFilenameHere, xlCSV</code> or <code>wbk.SaveAs yourFilenameHere, xlCSVMac</code> (I don&#39;t have access to a Mac to check this directly, though)"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5228558, "user_type": "registered", "profile_image": "https://graph.facebook.com/479329272229523/picture?type=large", "display_name": "MR Curri Nate", "link": "https://stackoverflow.com/users/5228558/mr-curri-nate"}, "is_accepted": false, "score": -1, "last_activity_date": 1449025251, "creation_date": 1449025251, "answer_id": 34034146, "question_id": 34033934, "link": "https://stackoverflow.com/questions/34033934/converting-xml-files-to-excel/34034146#34034146", "title": "Converting XML files to Excel", "body": "<p>I'm not very sure what you mean with that can you tell me the error. And Here Are Some Nice Resources </p>\n\n<p>Click [here](<a href=\"http://www.appspro.com/Utilities/CodeCleaner.htm\" rel=\"nofollow\">http://www.appspro.com/Utilities/CodeCleaner.htm</a>\" Code Cleaner\")  for Code Cleaner</p>\n\n<p>Click <a href=\"https://en.wikipedia.org/wiki/Visual_Basic_for_Applications&quot;Wikipedia\" rel=\"nofollow\">here</a> for a Wikipedia</p>\n"}], "owner": {"reputation": 41, "user_id": 5548370, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/470485441d0316d3a442569fd97036f2?s=128&d=identicon&r=PG&f=1", "display_name": "bennyharassi", "link": "https://stackoverflow.com/users/5548370/bennyharassi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449075232, "creation_date": 1449023881, "last_edit_date": 1449075232, "question_id": 34033934, "link": "https://stackoverflow.com/questions/34033934/converting-xml-files-to-excel", "title": "Converting XML files to Excel", "body": "<p>I found the code below but I don't know VBA -- I get a compile error on the first line:</p>\n\n<pre><code>Sub xmltoxl()\nDim f As String\nDim wbk As Workbook\nDim s As Integer\n\nf = Dir(\"C:\\Users\\Kanye\\Downloads\\fwcommoncartridgesforsegtitles\\zipped\\basicLTILinks\" &amp; \"\\*.xml\")\ns = 0\n\nDo While Len(f) &gt; 0\n    s = s + 1\n    Set wbk = Workbooks.OpenXML(\"C:\\Users\\Kanye\\Downloads\\fwcommoncartridgesforsegtitles\\zipped\" &amp; \"\\\" &amp; f)\nwbk.SaveAs Filename:=\"C:\\Users\\Kanye\\Downloads\\fwcommoncartridgesforsegtitles\\zipped\\\" &amp; s &amp; \".xls\"\nwbk.Close False\nf = Dir()\nLoop\n</code></pre>\n\n<p>My directory for my .xlsm file:\nC:\\Users\\Kanye\\Downloads\\fwcommoncartridgesforsegtitles\\Texas_Gr6_IScience_2015</p>\n\n<p>My directory for my .xml files:\nC:\\Users\\Kanye\\Downloads\\fwcommoncartridgesforsegtitles\\Texas_Gr6_IScience_2015\\basicLTILinks</p>\n\n<p>Am I putting these in the right places?</p>\n\n<p>I'd like it so that the all the XML files are pulled into a single CSV </p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 4, "creation_date": 1449018606, "post_id": 34033156, "comment_id": 55821709, "body": "That sounds very similar to <a href=\"https://support.office.com/en-us/article/Use-AutoFilter-to-filter-your-data-7d87d63e-ebd0-424b-8106-e2ab61133d92\" rel=\"nofollow noreferrer\">AutoFilter</a> - what do you need to achieve that AutoFilter can&#39;t do?"}, {"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1449042818, "post_id": 34033156, "comment_id": 55829892, "body": "If AutoFilter is not an option, you could use a find loop."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5494880"}, "edited": false, "score": 0, "creation_date": 1449080198, "post_id": 34033735, "comment_id": 55854603, "body": "I know you said that was untested pseudocode...but could you provide a link where I could learn how to get it to work? Like a good tutorial site? I am new to VBA and don&#39;t know much about it.  for the code you posted all I have is one error with the line: Dim criteria = Range(&quot;M18&quot;).Value  Thanks so much for your input and help as this looks like exactly what I need."}, {"owner": {"reputation": 1236, "user_id": 992391, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2b821b424ca79c022f55b773aabb1215?s=128&d=identicon&r=PG", "display_name": "CHawk", "link": "https://stackoverflow.com/users/992391/chawk"}, "edited": false, "score": 0, "creation_date": 1449131499, "post_id": 34033735, "comment_id": 55875606, "body": "No problem! Looks like I made a mistake in declaring the Range variable. Googled &#39;How to set a range variable excel vba&#39; and came up with this link: <a href=\"http://stackoverflow.com/questions/12236316/how-store-a-range-from-excel-into-a-range-variable\" title=\"how store a range from excel into a range variable\">stackoverflow.com/questions/12236316/&hellip;</a>. Edited my answer with corrected code. As for overall VBA tutorials, I don&#39;t have a specific recommendation. Instead, Google for the basics: declaring a range, getting / setting cells, iterating (looping) through cells. After that, most things will flow together. Good luck!"}], "tags": [], "owner": {"reputation": 1236, "user_id": 992391, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2b821b424ca79c022f55b773aabb1215?s=128&d=identicon&r=PG", "display_name": "CHawk", "link": "https://stackoverflow.com/users/992391/chawk"}, "is_accepted": false, "score": 1, "last_activity_date": 1449131346, "last_edit_date": 1449131346, "creation_date": 1449022356, "answer_id": 34033735, "question_id": 34033156, "link": "https://stackoverflow.com/questions/34033156/searching-through-columns-to-give-a-history-of-an-item/34033735#34033735", "title": "Searching through columns to give a history of an item", "body": "<p>Similar to what barrowc said, probably the best way is to use the built in Autofilter. However, if you want to do some sort of customized search box that is always visible, you could use some VBA like (H5 is your search box):</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Target.Worksheet.Range(\"H5\")) Is Nothing Then\n      'Executes on cell change\n      Dim criteria as Range\n      Set criteria = Range(\"H5\")\n      'Range below is the total range of all your data to sort\n      'Field is the index of your column you want to sort by (Type)\n      Range(\"A1:D1\").AutoFilter Field:=1, Criteria1:=criteria.Value\n    End If\nEnd Sub\n</code></pre>\n\n<p>This will change the autofilter to search for the current value of your search cell. </p>\n\n<p><strong>Note: untested pseudo-code</strong></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5494880"}, "is_accepted": true, "score": 0, "last_activity_date": 1449103368, "creation_date": 1449103368, "answer_id": 34055860, "question_id": 34033156, "link": "https://stackoverflow.com/questions/34033156/searching-through-columns-to-give-a-history-of-an-item/34055860#34055860", "title": "Searching through columns to give a history of an item", "body": "<p><a href=\"http://trumpexcel.com/2015/01/dynamic-excel-filter/\" rel=\"nofollow\">http://trumpexcel.com/2015/01/dynamic-excel-filter/</a></p>\n\n<p>for anyone that is looking to create a literally search bar in their excel sheet without VBA follow this link.</p>\n\n<p>The other comments are also good here, but this completely avoids VBA.</p>\n\n<p>Thanks everyone for the help.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5494880"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 34055860, "answer_count": 2, "score": 1, "last_activity_date": 1449131346, "creation_date": 1449018171, "last_edit_date": 1531161705, "question_id": 34033156, "link": "https://stackoverflow.com/questions/34033156/searching-through-columns-to-give-a-history-of-an-item", "title": "Searching through columns to give a history of an item", "body": "<p>I have several columns in my excel sheet like this. My actual sheet is much more complex and I have a macro for static time. This however is about searching for a specified value then listing all of what is searched for...</p>\n\n<p>So you have this:</p>\n\n<pre><code>type item#   date\ncat   123451  11/3/14 1:00 pm\ndog   154321  12/3/14 2:00 pm\nfish  999900  10/4/12 4:00 pm\ncat   123651  11/7/14 1:00 pm\ndog   154621  12/8/14 2:00 pm\nfish  992900  10/1/12 3:00 pm\n</code></pre>\n\n<p>I want to create a search function where you type in the <strong><em>type</em></strong> and it lists all the information for that type.</p>\n\n<p>so as an example:</p>\n\n<pre><code>Search: cat\n</code></pre>\n\n<p>The user simply typed in cat and was given</p>\n\n<pre><code> cat   123651  11/7/14 1:00 pm\n cat   123451  11/3/14 1:00 pm\n</code></pre>\n\n<p>Hopefully...this can be done in some way.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1449017897, "creation_date": 1449017897, "answer_id": 34033116, "question_id": 34033033, "link": "https://stackoverflow.com/questions/34033033/hide-rows-with-an-inputbox-integer-starting-range/34033116#34033116", "title": "Hide rows with an inputbox integer starting range", "body": "<p>Below example is for input box</p>\n\n<pre><code>N = Application.InputBox(\"Input a number\", Type:=1)\n'Type:=0 A formula\n'Type:=1 A number\n'Type:=2 Text (a string)\n'Type:=4 A logical value (True or False)\n'Type:=8 A cell reference, as a Range object\n'Type:=16 An error value, such as #N/A\n'Type:=64 An array of values\n</code></pre>\n\n<p>But think you may create a logic auto detect the length of your record</p>\n\n<p>Using below function,</p>\n\n<p>nLastRow will be 3, if Column A have nothing.</p>\n\n<pre><code>nLastRow = getLastRow(Sheets(1).Range(\"A:A\"), 3)\n\nFunction getLastRow(ByVal inputRng As Range, ByVal headerRow As Single) As Single\nDim nRow As Single\n    nRow = 0\n    On Error Resume Next\n    nRow = inputRng.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n    If nRow = 0 Or nRow &lt;= headerRow Then\n        nRow = headerRow\n    End If\n    getLastRow = nRow\nEnd Function\n</code></pre>\n\n<p>Hope this help !</p>\n"}], "owner": {"reputation": 91, "user_id": 4966093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/92RpQ.png?s=128&g=1", "display_name": "proxy156", "link": "https://stackoverflow.com/users/4966093/proxy156"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449017897, "creation_date": 1449017398, "last_edit_date": 1449017715, "question_id": 34033033, "link": "https://stackoverflow.com/questions/34033033/hide-rows-with-an-inputbox-integer-starting-range", "title": "Hide rows with an inputbox integer starting range", "body": "<p>What I want to do is have a command button, that when pressed, pops up an inputbox asking for \"Please enter number of items (Limit 5000)\", then runs a VBA code that hides all rows between Inputbox.value + 3(the number of header rows) to row 5003 (the end of the sheet).</p>\n\n<p>I have found the below code which lets me hide columns using a toggle button</p>\n\n<pre><code>Private Sub ToggleButton1_Click()\n     Dim xAddress As String\n         xAddress = \"BV:CQ\"\n    If ToggleButton1.Value Then\n\n    Application.ActiveSheet.Columns(xAddress).Hidden = True\n    Else\n    Application.ActiveSheet.Columns(xAddress).Hidden = False\n    End If\nEnd Sub\n</code></pre>\n\n<p>Im unsure how exactly to create an inputbox, and then adjust that number to account for the headers, then to set that as the starting row for the range using the above code (changing Columns for Rows in the code).</p>\n"}, {"tags": ["excel", "odbc", "vba"], "comments": [{"owner": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 0, "creation_date": 1449039472, "post_id": 34033008, "comment_id": 55828371, "body": "install odbc driver?"}, {"owner": {"reputation": 11, "user_id": 3466950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2026fd25cb0569f13286e0ea132bddb4?s=128&d=identicon&r=PG&f=1", "display_name": "user3466950", "link": "https://stackoverflow.com/users/3466950/user3466950"}, "reply_to_user": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 0, "creation_date": 1449040349, "post_id": 34033008, "comment_id": 55828787, "body": "I have installed Oracle 12c Client. I can make DSN from System32/odbcad32.exe. Please help me."}, {"owner": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 0, "creation_date": 1449042318, "post_id": 34033008, "comment_id": 55829662, "body": "did you install <code>32</code>bit client?"}, {"owner": {"reputation": 11, "user_id": 3466950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2026fd25cb0569f13286e0ea132bddb4?s=128&d=identicon&r=PG&f=1", "display_name": "user3466950", "link": "https://stackoverflow.com/users/3466950/user3466950"}, "reply_to_user": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 0, "creation_date": 1449042999, "post_id": 34033008, "comment_id": 55829982, "body": "Yes, I install 32 bit client"}, {"owner": {"reputation": 11, "user_id": 3466950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2026fd25cb0569f13286e0ea132bddb4?s=128&d=identicon&r=PG&f=1", "display_name": "user3466950", "link": "https://stackoverflow.com/users/3466950/user3466950"}, "reply_to_user": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 1, "creation_date": 1449044346, "post_id": 34033008, "comment_id": 55830611, "body": "Thank you for your helping. I have solved the problem."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 3466950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2026fd25cb0569f13286e0ea132bddb4?s=128&d=identicon&r=PG&f=1", "display_name": "user3466950", "link": "https://stackoverflow.com/users/3466950/user3466950"}, "is_accepted": true, "score": 1, "last_activity_date": 1449045036, "creation_date": 1449045036, "answer_id": 34038031, "question_id": 34033008, "link": "https://stackoverflow.com/questions/34033008/unable-to-create-oracle-odbc-dsn-on-window-7-64-bit-using-syswow64-odbcad32-exe/34038031#34038031", "title": "Unable to Create ORACLE-ODBC DSN on Window 7 64 bit using SysWow64/odbcad32.exe", "body": "<p>I have solved this. Basically due to security reason, my registry was not configured properly at the time of installation. I have removed my previous installation and Set new ORACLE_HOME and run install As Run As Administrator. After that the problem is solved. </p>\n"}], "owner": {"reputation": 11, "user_id": 3466950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2026fd25cb0569f13286e0ea132bddb4?s=128&d=identicon&r=PG&f=1", "display_name": "user3466950", "link": "https://stackoverflow.com/users/3466950/user3466950"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 1, "accepted_answer_id": 34038031, "answer_count": 1, "score": 0, "last_activity_date": 1449045036, "creation_date": 1449017227, "last_edit_date": 1531164843, "question_id": 34033008, "link": "https://stackoverflow.com/questions/34033008/unable-to-create-oracle-odbc-dsn-on-window-7-64-bit-using-syswow64-odbcad32-exe", "title": "Unable to Create ORACLE-ODBC DSN on Window 7 64 bit using SysWow64/odbcad32.exe", "body": "<p>I am trying to create a DSN but I can't  do it. The processes I am applying these are as follows:\n            1. Oracle 12c (64bit) Installed in Remote PC\n            2. Using Oracle 12c Client on Windows 7 64 bit\n            3. Trying to Create DSN from Syswow64/odbcad32.exe becuase I want to use this DSN from my Excel 2013 VBA program and the office is 32 bit.\n            3. After pressing the Add button on the Microsoft ODBC Administrator from Syswow64/odbcad32.exe, I don't find the\nOracle In OracleClient12Home2 in the driver list.</p>\n\n<p>Please suggest me what should I do in this regard.</p>\n"}, {"tags": ["html", "excel", "vba", "import"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1449020988, "post_id": 34032953, "comment_id": 55822383, "body": "Which version of Internet Explorer is installed on the machine where the macro runs? IE9 was the first version of IE to support <code>getElementsByClassName</code>"}, {"owner": {"reputation": 2358, "user_id": 2109067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd1b5635a40eecb4a9f17135e8119bc?s=128&d=identicon&r=PG", "display_name": "ankhzet", "link": "https://stackoverflow.com/users/2109067/ankhzet"}, "edited": false, "score": 1, "creation_date": 1449021962, "post_id": 34032953, "comment_id": 55822654, "body": "I may be wrong, but <code>getElementsByClassName()</code> returns an array, no? So, must be smth like <code>.getElementsByClassName(&quot;amount&quot;)[0].innerText</code> (or in the loop with <code>.getElementsByClassName(&quot;amount&quot;)[nthElement].innerText</code>)... Sorry, I&#39;m not very familiar with VB..."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1449022228, "post_id": 34032953, "comment_id": 55822728, "body": "@ankzhet <code>getElementsByClassName</code> returns an IHTMLElementCollection so the syntax is slightly different - <code>.getElementsByClassName(&quot;amount&quot;)(0).innerText</code> - but your general point is entirely correct"}, {"owner": {"reputation": 3, "user_id": 5628050, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-8BxhnqHgjeo/AAAAAAAAAAI/AAAAAAAAAF8/DHGxZux8B0M/photo.jpg?sz=128", "display_name": "Tony", "link": "https://stackoverflow.com/users/5628050/tony"}, "edited": false, "score": 0, "creation_date": 1449024828, "post_id": 34032953, "comment_id": 55823478, "body": "Hi ... thank you  both.  I&#39;m using IE 11.  I&#39;ve gotten a bit closer with the following:  dd = IE.document.getElementById(&quot;amount&quot;)  but not sure how to pass that to B2.  I get no error.  Just nothing."}, {"owner": {"reputation": 2358, "user_id": 2109067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd1b5635a40eecb4a9f17135e8119bc?s=128&d=identicon&r=PG", "display_name": "ankhzet", "link": "https://stackoverflow.com/users/2109067/ankhzet"}, "edited": false, "score": 0, "creation_date": 1449025081, "post_id": 34032953, "comment_id": 55823559, "body": "If you using <code>getElementById</code> then your&#39;s <code>html</code> should look like <code>&lt;li id=&quot;amount&quot;&gt;$910.74&lt;&#47;li&gt;</code>"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1449026563, "post_id": 34032953, "comment_id": 55823999, "body": "<code>Range(&quot;B2&quot;).Value = dd</code> should work as long as the <code>getElementById</code> part actually worked"}, {"owner": {"reputation": 3, "user_id": 5628050, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-8BxhnqHgjeo/AAAAAAAAAAI/AAAAAAAAAF8/DHGxZux8B0M/photo.jpg?sz=128", "display_name": "Tony", "link": "https://stackoverflow.com/users/5628050/tony"}, "edited": false, "score": 0, "creation_date": 1449026793, "post_id": 34032953, "comment_id": 55824068, "body": "Well, that&#39;s going to be a variable.  It&#39;s not always going to be that amount.  I&#39;m trying to pull whatever amount is there when I run the code.  So, should I leave the dollar amount blank?  I&#39;ve been working on this for several days and I have no clue what I&#39;m doing.  I&#39;ve tried everything I can think of.  The code I tried above is the only thing that didn&#39;t produce an error, but it didn&#39;t produce anything else, either."}, {"owner": {"reputation": 3, "user_id": 5628050, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-8BxhnqHgjeo/AAAAAAAAAAI/AAAAAAAAAF8/DHGxZux8B0M/photo.jpg?sz=128", "display_name": "Tony", "link": "https://stackoverflow.com/users/5628050/tony"}, "edited": false, "score": 0, "creation_date": 1449113772, "post_id": 34032953, "comment_id": 55868740, "body": "No one has anything?  Is this just something that&#39;s not possible to do?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5628050, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-8BxhnqHgjeo/AAAAAAAAAAI/AAAAAAAAAF8/DHGxZux8B0M/photo.jpg?sz=128", "display_name": "Tony", "link": "https://stackoverflow.com/users/5628050/tony"}, "edited": false, "score": 0, "creation_date": 1449029251, "post_id": 34034551, "comment_id": 55824779, "body": "Hi barrowc,  I get a with variable not set at the range(&quot;B2&quot;).value = dd(0).InnerText  This is pretty tough stuff, this code business.  LOL"}, {"owner": {"reputation": 3, "user_id": 5628050, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-8BxhnqHgjeo/AAAAAAAAAAI/AAAAAAAAAF8/DHGxZux8B0M/photo.jpg?sz=128", "display_name": "Tony", "link": "https://stackoverflow.com/users/5628050/tony"}, "edited": false, "score": 0, "creation_date": 1449029467, "post_id": 34034551, "comment_id": 55824841, "body": "Oh, and to answer your question, I have an app that logs me into websites, so that shouldn&#39;t be any problem."}, {"owner": {"reputation": 3, "user_id": 5628050, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-8BxhnqHgjeo/AAAAAAAAAAI/AAAAAAAAAF8/DHGxZux8B0M/photo.jpg?sz=128", "display_name": "Tony", "link": "https://stackoverflow.com/users/5628050/tony"}, "edited": false, "score": 0, "creation_date": 1449055813, "post_id": 34034551, "comment_id": 55837811, "body": "I&#39;m getting an &quot;Object variable or with variable not set&quot; at the &quot;range(&quot;B2&quot;).value = dd(0).innertext&quot; line.  Not sure what to do."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "reply_to_user": {"reputation": 3, "user_id": 5628050, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-8BxhnqHgjeo/AAAAAAAAAAI/AAAAAAAAAF8/DHGxZux8B0M/photo.jpg?sz=128", "display_name": "Tony", "link": "https://stackoverflow.com/users/5628050/tony"}, "edited": false, "score": 0, "creation_date": 1449115972, "post_id": 34034551, "comment_id": 55869372, "body": "After the <code>Set dd = .getElementsByClassName(&quot;amount&quot;)</code> line, add this line to show how many elements were retrieved: <code>MsgBox &quot;Number of elements found = &quot; &amp; dd.length</code> Report back how many elements were found"}, {"owner": {"reputation": 3, "user_id": 5628050, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-8BxhnqHgjeo/AAAAAAAAAAI/AAAAAAAAAF8/DHGxZux8B0M/photo.jpg?sz=128", "display_name": "Tony", "link": "https://stackoverflow.com/users/5628050/tony"}, "edited": false, "score": 0, "creation_date": 1449118186, "post_id": 34034551, "comment_id": 55869987, "body": "I get: &quot;Number of elements found = 0&quot;"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "reply_to_user": {"reputation": 3, "user_id": 5628050, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-8BxhnqHgjeo/AAAAAAAAAAI/AAAAAAAAAF8/DHGxZux8B0M/photo.jpg?sz=128", "display_name": "Tony", "link": "https://stackoverflow.com/users/5628050/tony"}, "edited": false, "score": 0, "creation_date": 1449183705, "post_id": 34034551, "comment_id": 55909236, "body": "... then the HTML of the page you are examining doesn&#39;t have any elements with class=&quot;amount&quot;. After the <code>Set ieDoc = IE.document</code> line, add this new line: <code>MsgBox IE.LocationURL</code>. Check that the URL which appears in the message box corresponds to the correct webpage that you are trying to examine"}], "tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": false, "score": 0, "last_activity_date": 1449027987, "creation_date": 1449027987, "answer_id": 34034551, "question_id": 34032953, "link": "https://stackoverflow.com/questions/34032953/excel-2010-2013-vba-import-current-balance-from-website/34034551#34034551", "title": "Excel 2010/2013 VBA import Current Balance from Website", "body": "<p>Substitute this into your current code (keeping everything before the \"Set ieDoc\" line the same):</p>\n\n<pre><code>Set ieDoc = IE.document\n\nWith ieDoc\n    Set dd = .getElementsByClassName(\"amount\")\n\n    Range(\"B2\").Value = dd(0).InnerText\nEnd With\n\n' Clean up\nIE.Quit\nSet ieDoc = Nothing\nSet IE = Nothing\n\nApplication.StatusBar = \"\"\n\nEnd Sub\n</code></pre>\n\n<p>This uses \"getElementsByClassName\" because the HTML given doesn't have any element with an ID of \"amount\". This should return a collection from which we take the first item (item 0) and then copy its innerText to cell B2.</p>\n\n<p>What seems to be missing though is any form of login or navigation on the site you're trying to access. This code will only work if the data you're trying to download is visible on the <a href=\"https://www.discovercard.com\" rel=\"nofollow\">https://www.discovercard.com</a> page without needing you to login</p>\n"}], "owner": {"reputation": 3, "user_id": 5628050, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-8BxhnqHgjeo/AAAAAAAAAAI/AAAAAAAAAF8/DHGxZux8B0M/photo.jpg?sz=128", "display_name": "Tony", "link": "https://stackoverflow.com/users/5628050/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449027987, "creation_date": 1449016890, "last_edit_date": 1449019450, "question_id": 34032953, "link": "https://stackoverflow.com/questions/34032953/excel-2010-2013-vba-import-current-balance-from-website", "title": "Excel 2010/2013 VBA import Current Balance from Website", "body": "<p>I'm very new to VBA, and much less so to HTML.  What I'm trying to do is be able to click a button and retrieve the current balance from a website.  Ideally, I'd like to click one button and have it loop through all of the credit card links and pull the current balance, but I will be happy if I can just get it to work for one site.  I've scoured the web for the past few days and was able to cobble together what I have below.  Please excuse some of the commented out sections as I was going by trial and error.  Any help, and in terms a five year old could understand, would be greatly appreciated.</p>\n\n<p>So, where did I go wrong?  Thank you!!   </p>\n\n<p>By the way, I've switched out both of these following lines and associated \"dims\" with the same result.  'Object not supported by this property or method.'</p>\n\n<blockquote>\n<pre><code>With ieDoc\n .getElementsByClassName(\"amount\").innerText\nEnd With\n\n'    dd = IE.document.getElementsByClassName(\"amount\").innerText\n</code></pre>\n</blockquote>\n\n<pre><code> Sub CurrentBalance()\n\n    Dim IE As Object\n    Dim ieDoc As Object\n    Dim dd As Variant 'IHTMLElementCollection\n    ' Create InternetExplorer Object\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = True\n\n    ' Send the form data To URL As POST binary request\n    IE.Navigate \"https://www.discovercard.com\"\n\n    Do Until Not IE.Busy And IE.readyState = 4\n        DoEvents\n    Loop\n\n    Set ieDoc = IE.document\n\n    With ieDoc\n     .getElementsByClassName(\"amount\").innerText\n    End With\n\n'    dd = IE.document.getElementByClassName(\"amount\")\n\n    Range(\"B2\").Value = ieDoc\n\n\n' Clean up\n    Set IE = Nothing\n    Set objElement = Nothing\n    Set objCollection = Nothing\n\n    Application.StatusBar = \"\"\nEnd Sub\n</code></pre>\n\n<p>My apologies as I should add the HTML portion:</p>\n\n<pre><code>href=\"/cardmembersvcs/personalprofile/pp/MyProfilePage?ICMPGN=ACHOME_ACCTSUMM_PROFILE_TXT\" title=\"Profile\"&gt;Profile&lt;/a&gt;&lt;/li&gt;\n                    &lt;!-- WT blank content --&gt;\n                &lt;/ul&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"card-balances\"&gt;\n            &lt;ul&gt;\n                &lt;li&gt;Current Balance&lt;/li&gt;\n                &lt;li class=\"amount\"&gt;$910.74&lt;/li&gt;\n</code></pre>\n"}, {"tags": ["sql", "vba", "checkbox", "input", "using"], "comments": [{"owner": {"reputation": 11, "user_id": 5628085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d1ca230cca8dff7883980f6f124aa5?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish", "link": "https://stackoverflow.com/users/5628085/ashish"}, "edited": false, "score": 0, "creation_date": 1449174963, "post_id": 34032901, "comment_id": 55904538, "body": "Thanks for the response &quot;barrowc&quot;. Now, I am able to use varianles in query. I have few more issues :-                                                                 1. If I click all years then the following code works but if I select any one of them, it doesn&#39;t                                                                                   2. if [name] is &quot;Academy of Science&quot;. On executing query, it displays syntax error near &#39;of&#39; 3. I want that it should work for any checkbox checked"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1449188166, "post_id": 34032901, "comment_id": 55910871, "body": "I&#39;ve updated my answer with more code and edited the code from your answer into the question"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5628085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d1ca230cca8dff7883980f6f124aa5?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish", "link": "https://stackoverflow.com/users/5628085/ashish"}, "edited": false, "score": 0, "creation_date": 1449178038, "post_id": 34034298, "comment_id": 55906300, "body": "*If CheckBox1.Value = True Then  y1 = CheckBox1.Caption  i = i + 1 End If If CheckBox2.Value = True Then"}], "tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": false, "score": 0, "last_activity_date": 1449187885, "last_edit_date": 1495540340, "creation_date": 1449026352, "answer_id": 34034298, "question_id": 34032901, "link": "https://stackoverflow.com/questions/34032901/checkboxes-for-taking-input-for-a-sql-query-in-vba-userform-excel/34034298#34034298", "title": "Checkboxes for taking input for a sql query in VBA (userform-excel)", "body": "<p>It's as simple as <code>...and d.Year=\" &amp; CheckBox6.Caption &amp; \" group by...</code></p>\n\n<p>If you want to use the value of a variable then it has to be outside of the double quotes. You can then use the <code>&amp;</code> operator to join the pieces back together.</p>\n\n<p>BUT: constructing an SQL query from user input by joining strings together is asking for trouble. SQL injection can be a very real possibility - see <a href=\"https://xkcd.com/327/\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://www.owasp.org/index.php/SQL_Injection\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>You can use an ADODB <a href=\"https://msdn.microsoft.com/en-us/library/ms677502(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Command object</a> in conjunction with the <a href=\"https://msdn.microsoft.com/en-us/library/ms675869(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Parameters collection</a> to execute a paramaterized query in a safe manner. See <a href=\"https://stackoverflow.com/a/10353908/2127508\">this answer</a> for a demonstration of how to do so</p>\n\n<hr>\n\n<p>edit: if some of the values are text strings then they should be enclosed in single quotes like this:</p>\n\n<p><code>and [Name] IN  ('\" &amp; x3 &amp; \"','\" &amp; x4 &amp; \"')</code></p>\n\n<p>which will produce output like this:</p>\n\n<p><code>and [Name] IN  ('Academy of Science','Foo')</code></p>\n\n<p>If only some of the variables might have values then you need to construct the IN clause differently:</p>\n\n<pre><code>Dim yearsChosen As String\n\nIf CheckBox1.Value = True Then\n    yearsChosen = yearsChosen &amp; \",\" &amp; CheckBox1.Caption\n    i = i + 1\nEnd If\nIf CheckBox2.Value = True Then\n    yearsChosen = yearsChosen &amp; \",\" &amp; CheckBox2.Caption\n    i = i + 1\nEnd If\n\n' Check to see if anything was selected - if it was, remove the\n' leading comma and add the AND [Year] IN part\nIf Len(yearsChosen &lt;&gt; 0) Then\n    yearsChosen = \" AND [Year] IN (\" &amp; Mid$(yearsChosen, 2) &amp; \")\"\nEnd If\n</code></pre>\n\n<p>The Names part would work similarly except you need single quotes around the values:</p>\n\n<pre><code>namesChosen = namesChosen &amp; \",'\" &amp; CheckBox5.Caption &amp; \"'\"\n</code></pre>\n\n<p>Building the SQL query is quite simple:</p>\n\n<pre><code>Qry = \"  SELECT d.Year,d.[University name],d.[School name], COUNT(distinct d.Title) 'Number of paper published'from [dbo].[Ashish$] d where [Business/Non-business]='1' \"\nQry = Qry &amp; yearsChosen &amp; namesChosen &amp; vbCrLf\nQry = Qry &amp; \"group by d.Year,d.[University name],d.[School name]  order by d.[Year], [Number of paper published] desc;\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5628085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d1ca230cca8dff7883980f6f124aa5?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish", "link": "https://stackoverflow.com/users/5628085/ashish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1069, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1449187998, "creation_date": 1449016499, "last_edit_date": 1449187998, "question_id": 34032901, "link": "https://stackoverflow.com/questions/34032901/checkboxes-for-taking-input-for-a-sql-query-in-vba-userform-excel", "title": "Checkboxes for taking input for a sql query in VBA (userform-excel)", "body": "<p>I am trying to create a userform - which will have checkboxes for different years and command buttons for different queries. So if for example a user choses three checkboxes -1990,1993, 1995 and then the user clicks on a particular query. Then that query must be executed with that year in going into the \"<strong>where</strong> part of that query\"\nThis is my code :-</p>\n\n<p>*</p>\n\n<pre><code>  Private Sub CommandButton1_Click()\n    Dim connection As New ADODB.connection\n    Dim rst As New Recordset\n    Dim strConnectionStr As String\n    Dim Qry As String\n    strConnectionStr = \"Provider=SQLOLEDB;\" &amp; \"DATA SOURCE=\" &amp; _\n                      \"INITIAL CATALOG=;\" &amp; _\n                      \"UID=; PWD=\"\n    Qry = \"  SELECT d.Year,d.[University name],d.[School name], COUNT(distinct d.Title) 'Number of paper published'from [dbo].[Ashish$] d where [Business/Non-business]='1'group by d.Year,d.[University name],d.[School name]  order by d.[Year], [Number of paper published] desc;\"\n\n    ActiveSheet.Cells.ClearContents\n    connection.Open strConnectionStr\n    rst.Open Qry, connection\n    For iCols = 0 To rst.Fields.Count - 1\n        Sheets(\"Query1\").Cells(1, iCols + 1).Value = rst.Fields(iCols).Name\n    Next\n    Sheets(\"Query1\").Range(\"A2\").CopyFromRecordset rst*`\n\n\n    rst.Close\n    connection.Close\n\n    End Sub\n\n\nAbove is the code for normal command buttons without check box . Below is the code for taking user inputs by checkboxes ...\n\n    Private Sub CommandButton1_Click()\n    Dim connection As New ADODB.connection\n    Dim rst As New Recordset\n    Dim strConnectionStr As String\n    Dim Qry As String\n    Dim ctl As Control\n    Dim i As Integer\n    i = 0\n    strConnectionStr = \"Provider=SQLOLEDB;\" &amp; \"DATA SOURCE=;\" &amp; _\n                      \"INITIAL CATALOG=;\" &amp; _\n                      \"UID=; PWD=\"\n    If CheckBox6.Value = True Then\n       year1 = CheckBox6.Caption\n       i = i + 1\n    End If\n    If CheckBox5.Value = True Then\n       year2 = CheckBox5.Caption\n       i = i + 1\n    End If\n\n    Qry = \"  SELECT d.Year,d.[University name],d.[School name], COUNT(distinct d.Title) 'Number of paper published'from [dbo].[Ashish$] d where [Business/Non-business]='1'  and d.Year=CheckBox6.Caption  group by d.Year,d.[University name],d.[School name]  order by d.[Year], [Number of paper published] desc;\"\n\n    ActiveSheet.Cells.ClearContents\n\n    connection.Open strConnectionStr\n\n    rst.Open Qry, connection\n\n    For iCols = 0 To rst.Fields.Count - 1\n        Sheets(\"Query1\").Cells(1, iCols + 1).Value = rst.Fields(iCols).Name\n    Next\n\n    Sheets(\"Query1\").Range(\"A2\").CopyFromRecordset rst\n\n\n    rst.Close\n    connection.Close\n    End Sub\n</code></pre>\n\n<p>ub</p>\n\n<p>Basically I am unable to take values from checkboxes and use them  inside query statement for the purpose.</p>\n\n<p>I need help . Can anyone guide me on this?</p>\n\n<hr>\n\n<p>edit: the following was originally posted as an answer:</p>\n\n<pre><code>If CheckBox1.Value = True Then\n y1 = CheckBox1.Caption\n i = i + 1\nEnd If\nIf CheckBox2.Value = True Then\n y2 = CheckBox2.Caption\n i = i + 1\nEnd If\n\nIf CheckBox3.Value = True Then\nx1 = CheckBox3.Caption\nj = j + 1\nEnd If\n\nIf CheckBox4.Value = True Then\nx2 = CheckBox4.Caption\nj = j + 1\nEnd If\n\nIf CheckBox5.Value = True Then\nx3 = CheckBox5.Caption\nj = j + 1\nEnd If\n\nIf i = 0 Then\nMsgBox \"Select at least one year \"\nEnd If\n\nIf j = 0 Then\nMsgBox \"Select at least one journal \"\nEnd If\n\n\nstrConnectionStr = \"Provider=SQLOLEDB;\" &amp; \"DATA SOURCE=;\" &amp; _\n                  \"INITIAL CATALOG=;\" &amp; _\n                  \"UID=; PWD=\"\nQry = \"  SELECT d.Year,d.[University name],d.[School name], COUNT(distinct d.Title) 'Number of paper published'from [dbo].[Ashish$] d where [Business/Non-business]='1' and \"\nQry = Qry &amp; \"[Year] IN (\" &amp; y1 &amp; \",\" &amp; y2 &amp; \") and [Name] IN  (\" &amp; x3 &amp; \",\" &amp; x4 &amp; \") &amp; vbCrLf\"\nQry = Qry &amp; \"group by d.Year,d.[University name],d.[School name]  order by d.[Year], [Number of paper published] desc;\"\n\nActiveSheet.Cells.ClearContents\n\nconnection.Open strConnectionStr\n\nrst.Open Qry, connection\n\nFor iCols = 0 To rst.Fields.Count - 1\n    Sheets(\"Query1\").Cells(1, iCols + 1).Value = rst.Fields(iCols).Name\nNext\n\nSheets(\"Query1\").Range(\"A2\").CopyFromRecordset rst\n\n\nrst.Close\nconnection.Close\nEnd Sub\n</code></pre>\n\n<p>Above is my code and the question is posted in my last comment</p>\n"}, {"tags": ["excel", "vba", "filter"], "comments": [{"owner": {"reputation": 11, "user_id": 5623038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5279015a2859ea922b7507abb859687?s=128&d=identicon&r=PG&f=1", "display_name": "excelnubie4help", "link": "https://stackoverflow.com/users/5623038/excelnubie4help"}, "edited": false, "score": 0, "creation_date": 1449023982, "post_id": 34032755, "comment_id": 55823203, "body": "I know it can be done by special cells. I saw another post of someone that iterated through the rows of a filter."}], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 0, "last_activity_date": 1499459462, "last_edit_date": 1499459462, "creation_date": 1449016548, "answer_id": 34032912, "question_id": 34032755, "link": "https://stackoverflow.com/questions/34032755/vba-filter-on-criteria-and-loop-through-rows/34032912#34032912", "title": "VBA filter on criteria and loop through rows", "body": "<p>Because <code>AutoFilter</code> will probably produce a discontinuous range you need to loop over <code>Areas</code> and <code>Ranges</code>, like this</p>\n\n<pre><code>Dim ar as Range, row As Range, rng As Range\n\nWs.ShowAllData  'Remove All Filters \nlastrow_ = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).row\nWs.Range(\"A2\" &amp; lastrow_).AutoFilter Field:=1, Criteria1:=\"=1\" 'Filter on the Criteria\n\n'Set The Range\nSet rng = ws.Range(\"A1:P\" &amp; Cells(Rows.Count,\"A\").End(xlUp).row).SpecialCells(xlCellTypeVisible)\n\n'Loop through the range\nFor Each ar in rng.Areas\nFor Each row in ar.Rows\n    'do stuff\nNext row, ar\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5623038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5279015a2859ea922b7507abb859687?s=128&d=identicon&r=PG&f=1", "display_name": "excelnubie4help", "link": "https://stackoverflow.com/users/5623038/excelnubie4help"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1673, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1499459462, "creation_date": 1449015581, "question_id": 34032755, "link": "https://stackoverflow.com/questions/34032755/vba-filter-on-criteria-and-loop-through-rows", "title": "VBA filter on criteria and loop through rows", "body": "<p>I am reading many workbooks, each with over 50,000 lines in them. But I only need data from certain rows. When I am in a workbook, I am trying to filter based on criteria and then loop through ONLY those rows, but it is not working. </p>\n\n<pre><code>ActiveSheet.ShowAllData  'Remove All Filters \nlastrow_ = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).row\nActiveSheet.Range(\"A2\" &amp; lastrow_).AutoFilter Field:=1, Criteria1:=\"=1\" 'Filter on the Criteria\n\n'Set The Range\nSet rng = Range(\"A1:P\" &amp; Cells(Rows.Count,\"A\").End(xlUp).row).SpecialCells(xlCellTypeVisible)\n\n'Loop through the range\nFor each row in rng\n'do stuff\n</code></pre>\n\n<p>I've already defined row in another snippet of code. But this doesn't work. It doesn't loop through only the rows that apply in the filter. Any suggestions? Thank you!!!</p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1449011804, "post_id": 34032006, "comment_id": 55819457, "body": "You need to show your code - it&#39;s difficult to suggest changes when you don&#39;t include it in your question."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 2, "creation_date": 1449012203, "post_id": 34032006, "comment_id": 55819606, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1589939/how-to-detect-whether-vba-excel-found-something\">how to detect whether VBA excel found something?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5623480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4bddafe3fdb6fd1536b33d72d0886ba?s=128&d=identicon&r=PG&f=1", "display_name": "aaron2295", "link": "https://stackoverflow.com/users/5623480/aaron2295"}, "edited": false, "score": 0, "creation_date": 1449012721, "post_id": 34032131, "comment_id": 55819781, "body": "Hi nbayly, that&#39;s great thanks. Just on this point, how can I incorporate this into an IF statement that already exists. I&#39;ve added my code (not finished but outlined what I want to do) to my question above."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 27, "user_id": 5623480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4bddafe3fdb6fd1536b33d72d0886ba?s=128&d=identicon&r=PG&f=1", "display_name": "aaron2295", "link": "https://stackoverflow.com/users/5623480/aaron2295"}, "edited": false, "score": 1, "creation_date": 1449075022, "post_id": 34032131, "comment_id": 55851343, "body": "@aaron2295 I  have added code as per your additional inquiry. If you find this answer useful please consider marking it as useful. Warm regards."}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": true, "score": 3, "last_activity_date": 1449074967, "last_edit_date": 1495540439, "creation_date": 1449012159, "answer_id": 34032131, "question_id": 34032006, "link": "https://stackoverflow.com/questions/34032006/if-find-function-doesnt-find-anything-in-vba-then/34032131#34032131", "title": "IF FIND function doesn&#39;t find anything in vba then", "body": "<p>This question was already explored here: <a href=\"https://stackoverflow.com/questions/1589939/how-to-detect-whether-vba-excel-found-something\">How to detect whether VBA Excel found something</a>.</p>\n\n<p>Basically you set a range variable to the resulting <code>.find</code> range. If that range is <code>Nothing</code> then nothing was returned and you can respond to the user in the manner that best suits you.</p>\n\n<p>EDIT: Per OP's added inquiry</p>\n\n<pre><code>Sub findsomething()\n    Dim foundsomething As Range\n    Dim searchterm As String\n    searchterm = \"Search Term\"\n\n    Set foundsomething = Application.ActiveSheet.Find(What:=\"search term\", After:=ActiveCell, LookIn:=xlFormulas, _\n        LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False)\n    If (Not foundsomething Is Nothing) And columnD = \"Exists\" Then\n        ' Do something\n    End If\nEnd Sub\n</code></pre>\n\n<p>Cheers,</p>\n"}], "owner": {"reputation": 27, "user_id": 5623480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4bddafe3fdb6fd1536b33d72d0886ba?s=128&d=identicon&r=PG&f=1", "display_name": "aaron2295", "link": "https://stackoverflow.com/users/5623480/aaron2295"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20629, "favorite_count": 1, "accepted_answer_id": 34032131, "answer_count": 1, "score": 1, "last_activity_date": 1449074967, "creation_date": 1449011602, "last_edit_date": 1449013217, "question_id": 34032006, "link": "https://stackoverflow.com/questions/34032006/if-find-function-doesnt-find-anything-in-vba-then", "title": "IF FIND function doesn&#39;t find anything in vba then", "body": "<p>I'm currently automating a manual process that does the following steps:</p>\n\n<p>1.Prompts the user to open a data file and opens the file </p>\n\n<p>2.Inserts 4 columns</p>\n\n<p>3.Using the data that was already in the file creates a unique string in the format \"DD/MM/YYYY TEXT\" where text is a variable</p>\n\n<p>4.Uses an if statement to determine if a row exists within the Master Data File</p>\n\n<p>5.If the value in column d = \"Exists\" then find the string in the Master data file and use the vlookup function to transfer the data from the data file to the Master Data File</p>\n\n<p>6.Else (If the value = anything else) then Insert a new row name it and then use the vlookup function to transfer the data from the data file to the master file</p>\n\n<p>My issue lies with the fact that the Unq.String sometimes/rarely isn't an EXACT match so by using the FIND function it will return the message: \"We can't find what you are looking for. Click options for more ways to search\"</p>\n\n<p>My question to you guys is, is there a way that upon receiving this error message, that the data is then pasted on another tab called \"mop up\" before moving onto the next row? I'm using a LOOP within my code for steps 5 and 6 as I will need to jump down each row but I wouldn't know where to start this without breaking the loop.</p>\n\n<p>Thanks for your help in advance guys and let me know if you need any more information regarding the context.</p>\n\n<p>Aaron</p>\n\n<p>Thanks</p>\n\n<p>EDIT Comments explain how I plan to use this:</p>\n\n<pre><code>Dim ColumnD As String\nDim SearchValue As String\n\nIf ColumnD = \"Exists\" Then\n\n'Find SearchValue in Master data sheet and vlookup\n'ELSE Insert new row, add UNQ.String to New row then do the vlookup\n'Loop untill using Rows.count + 1 and lastRow (Already declared)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1449012905, "last_edit_date": 1449012905, "creation_date": 1449012530, "answer_id": 34032210, "question_id": 34031885, "link": "https://stackoverflow.com/questions/34031885/conditional-sum-with-merged-cells-using-sumiif/34032210#34032210", "title": "Conditional sum with merged cells using Sumiif()", "body": "<p>This is what I found:</p>\n\n<pre><code>=SUM(IF(LOOKUP(ROW(Sheet2!$A$2:$A$15),ROW(Sheet2!$A$2:$A$15)/(Sheet2!$A$2:$A$15&lt;&gt;\"\"),Sheet2!$A$2:$A$15)=A2,Sheet2!$C$2:$C$15))\n</code></pre>\n\n<p>This is an array formula.  Enter into sheet 1 C2.  Hit <kbd>Ctrl</kbd> <kbd>Shift</kbd> <kbd>Enter</kbd>.  Then copy down.</p>\n"}, {"comments": [{"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 1, "creation_date": 1449037594, "post_id": 34033042, "comment_id": 55827578, "body": "Amazing solution! Compared to <a href=\"http://stackoverflow.com/questions/34031885/excel-weekly-sums-with-grouped-cells#34032210\">the first solution by @ScottCraner</a>, the OP would be able to use a regular <code>SUMIF</code> on the whole column and not to loose performance, as array formulas work bad if they are applied to the whole column. I was thinking about some UDF, but this would easily work in a macro-disabled file and I see it as an advantage."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 1, "creation_date": 1449050401, "post_id": 34033042, "comment_id": 55834265, "body": "@ZygD Ta. Yes, avoid merged cells, so you can use regular formulas that reference each row or column. That is one of the reasons to avoid merged cells. The formatting  is just the icing on the cake. Experienced Excel bakers have that in their toolbox."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1449074450, "post_id": 34033042, "comment_id": 55850912, "body": "&lt;Sarcasm&gt; I worked very hard for my formula and here you come and give a simple fix. mumble..mumble..&lt;/Sarcasm&gt;  This works great in this instance, but what if the spacing was not identical but varied?  Could your approach be modified for this?  I am not trying to be difficult just curious, because I run into this often.  I agree it should be avoided but I have bosses that like the look."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1449110650, "post_id": 34033042, "comment_id": 55867872, "body": "@ScottCraner If there are irregular numbers of rows in each set, a conditional format can be set up for a change in value. If the value in the row above is different, then show this cell&#39;s value."}, {"owner": {"reputation": 223, "user_id": 4846344, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2b68420bc412b2dedee19883a66190a2?s=128&d=identicon&r=PG&f=1", "display_name": "Bertsector", "link": "https://stackoverflow.com/users/4846344/bertsector"}, "edited": false, "score": 0, "creation_date": 1449380672, "post_id": 34033042, "comment_id": 55978547, "body": "Hey my apologizes for the delayed thank you! But this answer turned out to work great for this scenario, definitively what I was looking for. I appreciate the help, thanks a bunch! Keep up the awesome work miss!"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 5, "last_activity_date": 1449017460, "creation_date": 1449017460, "answer_id": 34033042, "question_id": 34031885, "link": "https://stackoverflow.com/questions/34031885/conditional-sum-with-merged-cells-using-sumiif/34033042#34033042", "title": "Conditional sum with merged cells using Sumiif()", "body": "<p>Merged cells are a bad idea for several reasons and should be avoided.</p>\n\n<p>That does not mean that you can't achieve the look your client wants. You can fill the numbers into all the unmerged cells and then use conditional formatting to hide six of the seven numbers. In the screenshot below, column A has a conditional format with this formula</p>\n\n<pre><code>=MOD((ROW()+2)/7,1)\n</code></pre>\n\n<p>The format applied is custom number format <code>;;;</code> (or use white font on white background). Adjust the formula if your data starts on a different row.</p>\n\n<p>Note that the formula bar clearly shows that the selected cell has the value 26.</p>\n\n<p><a href=\"https://i.stack.imgur.com/NdAVQ.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/NdAVQ.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 450, "user_id": 2981328, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/55b5a57989320394ee6a2acaf766c01f?s=128&d=identicon&r=PG&f=1", "display_name": "hymced", "link": "https://stackoverflow.com/users/2981328/hymced"}, "edited": false, "score": 0, "creation_date": 1555682053, "post_id": 42890056, "comment_id": 98200405, "body": "works fine in this case, but does not in the general case where for example week 28 becomes week 26 again in column A..."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1489946083, "creation_date": 1489946083, "answer_id": 42890056, "question_id": 34031885, "link": "https://stackoverflow.com/questions/34031885/conditional-sum-with-merged-cells-using-sumiif/42890056#42890056", "title": "Conditional sum with merged cells using Sumiif()", "body": "<p>From my point of view, the important aspect to this specific layout is that a week has 7 days and you are listing every day in the week. A merged cell is identified by the top-left cell in the merged area. Looking for 26 returns A2 and looking for 27 returns A9. If you reference column C with those row numbers and extend the range to 7 rows then you can sum for the matching week.</p>\n\n<p>In G2 (per the image supplied),</p>\n\n<pre><code>'volatile OFFSET function\n=SUM(OFFSET(INDEX(C:C, MATCH(E2, A:A, 0)), 0, 0, 7, 1))\n'non-volatile INDEX function\n=SUM(INDEX(C:C, MATCH(E2, A:A, 0)):INDEX(C:C, MATCH(E2, A:A, 0)+6))\n</code></pre>\n\n<p>The dates in either table are inconsequential beyond visual reference.</p>\n\n<p><a href=\"https://i.stack.imgur.com/v3pWB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/v3pWB.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 223, "user_id": 4846344, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2b68420bc412b2dedee19883a66190a2?s=128&d=identicon&r=PG&f=1", "display_name": "Bertsector", "link": "https://stackoverflow.com/users/4846344/bertsector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10788, "favorite_count": 0, "accepted_answer_id": 34033042, "answer_count": 3, "score": 3, "last_activity_date": 1489946083, "creation_date": 1449010977, "last_edit_date": 1449050727, "question_id": 34031885, "link": "https://stackoverflow.com/questions/34031885/conditional-sum-with-merged-cells-using-sumiif", "title": "Conditional sum with merged cells using Sumiif()", "body": "<p>Scenario is 2 worksheets, Sheet1 and Sheet2.</p>\n\n<p>Sheet1 config:</p>\n\n<p><a href=\"https://i.stack.imgur.com/K752C.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K752C.png\" alt=\"Sheet1\"></a></p>\n\n<p>Sheet2 Config:</p>\n\n<p><a href=\"https://i.stack.imgur.com/17IIq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/17IIq.png\" alt=\"Sheet2\"></a></p>\n\n<p>The problem:\nThe customer wants to input the daily amounts of bananas in Sheet2 (C:C) and have the totals automatically add in Sheet1 for the week number. The problem I'm facing with this, I believe is the merged cells. I was successful when I removed the merged cells and added the week number to all the cells with this formula    ( =SUMIF(A:A,E3,'Sheet2!C:C) ) But the customer would prefer to keep the merged cells, and with that it only returns the first value of that week. Am I missing something simple here? Can't seem to wrap my head around this. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5626700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220737670776d0f4411662975e22fee5?s=128&d=identicon&r=PG&f=1", "display_name": "The Don", "link": "https://stackoverflow.com/users/5626700/the-don"}, "edited": false, "score": 0, "creation_date": 1449010742, "post_id": 34031585, "comment_id": 55819028, "body": "Thanks for the quick response. Unfortunately I received a Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method. The line the error occurs is the:       .SetSourceDataSource:=Range(&quot;OCM_VMonM24!$A$1:$I$2544&quot;)."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 15, "user_id": 5626700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220737670776d0f4411662975e22fee5?s=128&d=identicon&r=PG&f=1", "display_name": "The Don", "link": "https://stackoverflow.com/users/5626700/the-don"}, "edited": false, "score": 0, "creation_date": 1449011615, "post_id": 34031585, "comment_id": 55819385, "body": "@TheDon sorry for that... i just tried to avoid <code>select</code> without testing ^^; but have you tried to simply make the sheet to work with active? does that help?"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 15, "user_id": 5626700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220737670776d0f4411662975e22fee5?s=128&d=identicon&r=PG&f=1", "display_name": "The Don", "link": "https://stackoverflow.com/users/5626700/the-don"}, "edited": false, "score": 0, "creation_date": 1449014203, "post_id": 34031585, "comment_id": 55820379, "body": "@TheDon i changed the main-code... pls try it again"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 1, "last_activity_date": 1449014169, "last_edit_date": 1449014169, "creation_date": 1449009632, "answer_id": 34031585, "question_id": 34031415, "link": "https://stackoverflow.com/questions/34031415/plotting-line-graph-different-worksheets-using-vba/34031585#34031585", "title": "Plotting Line Graph Different Worksheets using VBA", "body": "<p>try to change your code a bit:</p>\n\n<pre><code>With Worksheets(\"OCM_VMonM24\").Shapes.AddChart2(332, xlLineMarkers).Chart\n  .SetSourceData Source:=Range(\"OCM_VMonM24!$A$1:$I$2544\")\n  .FullSeriesCollection(1).Delete\n  .FullSeriesCollection(1).XValues = \"=OCM_VMonM24!$A$3:$A$2544\"\n\n  With .ChartTitle\n    .Text = \"O-CAMS -24V\"\n    .Format.TextFrame2.TextRange.Characters.Text = \"O-CAMS -24V\"\n  End With\n  .SetElement (msoElementPrimaryCategoryAxisTitleAdjacentToAxis)\n  .Axes(xlCategory, xlPrimary).AxisTitle.Text = \"Self_Test_GV\"\nEnd With\n</code></pre>\n\n<p>also... you may only add</p>\n\n<pre><code> Worksheets(\"OCM_VMonM12\").Activate\n</code></pre>\n\n<p>in front of</p>\n\n<pre><code> Worksheets(\"OCM_VMonM12\").Shapes.AddChart2(332, xlLineMarkers).Select\n</code></pre>\n\n<p>selecting a shape in a nonactive sheet leads often to errors...</p>\n"}], "owner": {"reputation": 15, "user_id": 5626700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220737670776d0f4411662975e22fee5?s=128&d=identicon&r=PG&f=1", "display_name": "The Don", "link": "https://stackoverflow.com/users/5626700/the-don"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 34031585, "answer_count": 1, "score": 1, "last_activity_date": 1449051012, "creation_date": 1449008786, "last_edit_date": 1449051012, "question_id": 34031415, "link": "https://stackoverflow.com/questions/34031415/plotting-line-graph-different-worksheets-using-vba", "title": "Plotting Line Graph Different Worksheets using VBA", "body": "<p>I have 7 Excel Worksheets containing data that I want to use to produce a line graph with markers. I'm able to create the line graph on the first worksheet however I can't recreate the right graph on the second worksheet. I just recorded a macro to get an idea of how to plot in VBA so I'm not sure if this is the best way to produce linegraphs but essentially the first column A will contain the X-values and the other Columns B - I will contain the Y Data Values. </p>\n\n<p>Here is a snip of my code:</p>\n\n<pre><code>    Worksheets(\"OCM_VMonM24\").Shapes.AddChart2(332, xlLineMarkers).Select\n    ActiveChart.SetSourceData Source:=Range(\"OCM_VMonM24!$A$1:$I$2544\")\n    ActiveChart.FullSeriesCollection(1).Delete\n    ActiveChart.FullSeriesCollection(1).XValues = \"=OCM_VMonM24!$A$3:$A$2544\"\n\n    ActiveChart.ChartTitle.Select\n    ActiveChart.ChartTitle.Text = \"O-CAMS -24V\"\n    Selection.Format.TextFrame2.TextRange.Characters.Text = \"O-CAMS -24V\"\n    ActiveChart.SetElement (msoElementPrimaryCategoryAxisTitleAdjacentToAxis)\n    Selection.Format.TextFrame2.TextRange.Characters.Text = \"Self_Test_GV\"\n</code></pre>\n\n<p>That works for correctly plotting the data on the first worksheet, so I just tried copying and pasting for the other worksheet however it just plots over the graph in the first Excel worksheet with the data from the second worksheet. Here is copy and pasted version:</p>\n\n<pre><code>    Worksheets(\"OCM_VMonM12\").Shapes.AddChart2(332, xlLineMarkers).Select\n    ActiveChart.SetSourceData Source:=Range(\"OCM_VMonM12!$A$1:$I$2544\")\n    ActiveChart.FullSeriesCollection(1).Delete\n    ActiveChart.FullSeriesCollection(1).XValues = \"=OCM_VMonM12!$A$3:$A$2544\"\n\n    ActiveChart.ChartTitle.Select\n    ActiveChart.ChartTitle.Text = \"O-CAMS -12V\"\n    Selection.Format.TextFrame2.TextRange.Characters.Text = \"O-CAMS -12V\"\n    ActiveChart.SetElement (msoElementPrimaryCategoryAxisTitleAdjacentToAxis)\n    Selection.Format.TextFrame2.TextRange.Characters.Text = \"Self_Test_GV\"\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1453281466, "post_id": 34031319, "comment_id": 57528559, "body": "I think it might be insightful to know what SA_Duplicate does, but since just assigning it&#39;s result down the road to range.Value2 just works, I assume the new data is correct?  So I suspect Excel internally keeps it&#39;s data in some other structure than a safearray, and the .Value/.Value2 properties are just shells that performs the translation; this would mean that direct memory manipulation of the variant these properties return is pointless."}], "answers": [{"tags": [], "owner": {"reputation": 7165, "user_id": 2250183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f863401bc800df07245b6dfd1a66ab?s=128&d=identicon&r=PG", "display_name": "AndASM", "link": "https://stackoverflow.com/users/2250183/andasm"}, "is_accepted": true, "score": 1, "last_activity_date": 1456960007, "last_edit_date": 1456960007, "creation_date": 1456959451, "answer_id": 35759888, "question_id": 34031319, "link": "https://stackoverflow.com/questions/34031319/copying-an-array-to-range-value2-safearray-pvdata-successful-but-excel-fails-to/35759888#35759888", "title": "Copying an array to Range.Value2 SafeArray.pvData successful, but Excel fails to update", "body": "<p>Well, you didn't provide a working implementation of several vital parts, especially <code>SA_Duplicate</code>, so this is mostly guess work. But, I think the answer is likely quite simple.</p>\n\n<p><code>Range.Value2</code> is a property, not a variable. So behind the scenes it is actually two functions, lets call them <code>Range.let_Value2</code> and <code>Range.get_Value2</code>.</p>\n\n<p>That said, how do you expect the call <code>SA_Duplicate rngSort.Value2, arrSort</code> to work? Because what I see is <code>SA_Duplicate rngSort.get_Value2, arrSort</code>. I would assume that <code>rngSort.get_Value2</code> is creating a new SafeArray, then copying the data from Excel's internal data structures into that SafeArray. If I'm correct, you're then writing your data to a temporary buffer that VBA later discards and Excel has already forgotten about.</p>\n\n<p>You need to use <code>rngSort.let_Value2 arrSort</code> which is usually called as <code>rngSort.Value2 = arrSort</code>.</p>\n\n<p>As a side note, if <code>get_Value2</code> allocates a new array as I think it does, both the <code>SA_Duplicate</code> calls are unnecessary and you might be able to sort the returned array in place. Do remember to pass it to <code>let_Value2</code> by assigning the array variable back to the property when you are done.</p>\n"}], "owner": {"reputation": 103, "user_id": 5627106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dddc0230e89ecc6273bd28468072e4e?s=128&d=identicon&r=PG&f=1", "display_name": "VBA For Anything", "link": "https://stackoverflow.com/users/5627106/vba-for-anything"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 615, "favorite_count": 1, "accepted_answer_id": 35759888, "answer_count": 1, "score": 10, "last_activity_date": 1476126553, "creation_date": 1449008420, "last_edit_date": 1531164843, "question_id": 34031319, "link": "https://stackoverflow.com/questions/34031319/copying-an-array-to-range-value2-safearray-pvdata-successful-but-excel-fails-to", "title": "Copying an array to Range.Value2 SafeArray.pvData successful, but Excel fails to update", "body": "<p><strong>EDIT</strong></p>\n\n<p>Indeed, there is no direct way of editing the range values in memory.\nThanks @AndASM for the detailed answer and Carl; good hunch, it was spot-on. I must have been too tangled in all the reversing at that moment, forgetting <code>Value2</code> is just a property.</p>\n\n<p>Meanwhile, I delved a bit deeper with some other tests and debugging with OllyDbg and found a few interesting things:</p>\n\n<ol>\n<li>Cells are arranged in 16 x 1024 areas. The structure holding the\nareas may very well be the worksheet, but I can't confirm yet;</li>\n<li>Each time the <code>Value</code> property is invoked, absolute sheet\noffsets (row, column) are used to find the corresponding area and\nthen for some indexing inside the area to get the actual value;</li>\n<li>A 2D SAFEARRAY of type VARIANT is created;</li>\n<li>Values are not retrieved in a contiguous block, but individually.\nThis means that each \"point\" in a range (row,col) is sent to the\nindexing procedure to return a value (variant, obviously) for its\ncorresponding SAFEARRAY element;</li>\n<li>As a consequence of the above, each time you retrieve a value via\n<code>Range.Value2(row,col)</code>, the whole process is reiterated for all the\nvalues in the range. Imagine the performance hit if you do this\nmultiple times inside a procedure or, even worse, inside a loop.\nJust don't; you're better off creating a copy of <code>Value2</code> and\naddressing it via indexing;</li>\n<li><p>Last, yet not least, the distribution of values inside\n<code>SAFEARRAY.pvData</code> is column-based <code>(col,row)</code>, not row-based, which\nmay be found counter-intuitive and at odds with the VBA indexing\nmode, which is <code>(row,col)</code>. This may come in handy if you need\naccessing pvData directly in memory and keeping dimension coherence.\nAs an example, a range like the one below</p>\n\n<pre><code>    1, 2, 3, 4  \n    5, 6, 7, 8\n</code></pre>\n\n<p>would be stored in <code>pvData</code> in the following order:</p>\n\n<pre><code>    1, 5, 2, 6, 3, 7, 4, 8\n</code></pre></li>\n</ol>\n\n<p>I hope the above helps.\nTo sum up, in absence of any such exported function in Excel, the best way around is creating a copy of <code>Value2</code>, sorting / manipulating it towards the desired outcome and assigning it back to the range property.</p>\n\n<hr>\n\n<p>I have recently finished a variation of QuickSort and intend to implement in for Excel. The algorithm is effective and would really bring value as an add-in, if not for the extra time spent on putting the array values into the range. Transposing only works for less than 65537, while the 'paste variant-array to range takes too long on large sorts.</p>\n\n<p>So, I wrote a few procedures that would allow copying the 2D values from the range into a 1D array (1D is needed for sorting) and (after the sorting is done) putting them back, all based on SAFEARRAY and MemCopy(RtlMoveMemory) and, alternately, WriteProcessMemory.</p>\n\n<p>All works well, as far as memory operations are concerned:\n - the range values are copied to the array (from one SafeArray.pvData to the other);\n - the array values (after running the sorting algo) are successfully copied to the Range.Value2 SafeArray.pvData.</p>\n\n<p>Still, the range does not update, as it seems to flip back to the old values (more on that in the code below).\nWhy would \"Range.Value2 = SomeOther2dArray\" work and not modifying the data directly in memory? I have a feeling I am missing something here. Is a formula sort / update needed, as well?</p>\n\n<p>Here is the main procedure:</p>\n\n<pre><code>    Public Sub XLSORT_Array2()\n    With Application\n        screenUpdateState = .ScreenUpdating\n        statusBarState = .DisplayStatusBar\n        calcState = .Calculation\n        eventsState = .EnableEvents\n\n        .ScreenUpdating = False\n        .DisplayStatusBar = False\n        .Calculation = xlCalculationManual\n        .EnableEvents = False\n    End With\n\n    Dim rngSort As Range\n    Dim arrSort() As Variant\n    Dim arrTemp As Variant\n    Dim i As Long\n    Dim dblTime As Double\n    Dim dblInitTime As Double: dblInitTime = Timer\n\n    Set rngSort = Selection\n\n    If Not rngSort Is Nothing Then\n        If rngSort.Cells.Count &gt; 1 And rngSort.Areas.Count = 1 Then\n            dblTime = Timer\n            ReDim arrSort(1 To rngSort.Cells.Count)\n            Debug.Print Timer - dblTime &amp; vbTab &amp; \"(Redim)\"\n\n            'just testing Excel memory location\n            'Debug.Print VarPtr(rngSort.Value2(1, 1))\n\n            dblTime = Timer\n            SA_Duplicate arrSort, rngSort.Value2\n            Debug.Print Timer - dblTime &amp; vbTab &amp; \"(Copy)\"\n\n            dblTime = Timer\n            SORTVAR_QSWrapper arrSort, 1, rngSort.Cells.Count\n            Debug.Print Timer - dblTime &amp; vbTab &amp; \"(Sort)\"\n\n            'this would be the fastest method\n            'variants are copied to memory\n            'yet the range does not update with the new values\n            SA_Duplicate rngSort.Value2, arrSort\n\n            'dblTime = Timer\n            'looping = too slow\n            'For i = 1 To rngSort.Cells.Count\n            '    rngSort.Cells(i).Value = arrSort(i)\n            'Next\n\n            'this works, but it's too slow, as well\n            'If rngSort.Cells.Count &gt; 65536 Then\n            '    ReDim arrTemp(LBound(rngSort.Value2, 1) To UBound(rngSort.Value2, 1), LBound(rngSort.Value2, 2) To UBound(rngSort.Value2, 2))\n            '    SA_Duplicate arrTemp, arrSort\n            '    rngSort.Value2 = arrTemp\n            'Else\n            '    rngSort.Value2 = WorksheetFunction.Transpose(arrSort)\n            '    Debug.Print \"Transposed\"\n            'End If\n            'Debug.Print Timer - dblTime &amp; vbTab &amp; \"(Paste)\"\n        End If\n\n    End If\n\n    With Application\n        .ScreenUpdating = screenUpdateState\n        .DisplayStatusBar = statusBarState\n        .Calculation = calcState\n        .EnableEvents = eventsState\n    End With\n\n    Debug.Print VarPtr(rngSort.Value2(1, 1)) &amp; vbTab &amp; Mem_ReadHex(ByVal VarPtr(rngSort.Value2(1, 1)), rngSort.Cells.Count * 16)\n    Set rngSort = Nothing\n    Debug.Print Timer - dblInitTime &amp; vbTab &amp; \"(Total Time)\" &amp; vbNewLine\nEnd Sub\n</code></pre>\n\n<p>Let's say the values in the range are 4, 3, 2, and 1.\nBefore <code>SA_Duplicate arrSort, rngSort.Value2</code> the memory reads:</p>\n\n<pre><code>130836704   05000000 00000000 00000000 00001040 05000000 00000000 00000000 00000840 05000000 00000000 00000000 00000040 05000000 00000000 00000000 0000F03F \n129997032   00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000\n</code></pre>\n\n<p>where <code>130836704</code> is <code>Range.Value2 SafeArray.pvData</code> and  <code>129997032</code> is <code>SortArray SafeArray.pvData</code>. Each 16-byte batch represents the variant actual data, as read from memory (no LE translation, just in hex), with the first 2 bytes indicating the VarType. In this case, vbDouble.</p>\n\n<p>After the copy, as expected, the memory reads:</p>\n\n<pre><code>130836704   05000000 00000000 00000000 00001040 05000000 00000000 00000000 00000840 05000000 00000000 00000000 00000040 05000000 00000000 00000000 0000F03F \n129997032   05000000 00000000 00000000 00001040 05000000 00000000 00000000 00000840 05000000 00000000 00000000 00000040 05000000 00000000 00000000 0000F03F\n</code></pre>\n\n<p>After the sort is complete, the SortArray SafeArray.pvData reads:</p>\n\n<pre><code>129997032   05000000 00000000 00000000 0000F03F 05000000 00000000 00000000 00000040 05000000 00000000 00000000 00000840 05000000 00000000 00000000 00001040\n</code></pre>\n\n<p>After executing <code>SA_Duplicate rngSort.Value2, arrSort</code>, the memory shows that the Range.Value2 SafeArray.pvData has been updated:</p>\n\n<pre><code>129997032   05000000 00000000 00000000 0000F03F 05000000 00000000 00000000 00000040 05000000 00000000 00000000 00000840 05000000 00000000 00000000 00001040\n130836704   05000000 00000000 00000000 0000F03F 05000000 00000000 00000000 00000040 05000000 00000000 00000000 00000840 05000000 00000000 00000000 00001040\n</code></pre>\n\n<p>All looking fine so far, except that <code>Debug.Print VarPtr(rngSort.Value2(1, 1)) &amp; vbTab &amp; Mem_ReadHex[...]</code> shows that the values flipped back to the initial order:</p>\n\n<pre><code>130836704   05000000 00000000 00000000 00001040 05000000 00000000 00000000 00000840 05000000 00000000 00000000 00000040 05000000 00000000 00000000 0000F03F\n</code></pre>\n\n<p>Please share any thoughts or methods you found effective. Any help is appreciated. It's frustrating having to wait for Excel about 4 seconds ( sorting 1,000,000 + cells), when even the most challenging sort takes less than that.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["perl", "excel", "batch-file", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1919238"}, "edited": false, "score": 2, "creation_date": 1449009825, "post_id": 34031236, "comment_id": 55818675, "body": "Why do you need to use all three languages?"}, {"owner": {"reputation": 10786, "user_id": 4158862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKDhB.png?s=128&g=1", "display_name": "SomethingDark", "link": "https://stackoverflow.com/users/4158862/somethingdark"}, "edited": false, "score": 0, "creation_date": 1449009973, "post_id": 34031236, "comment_id": 55818735, "body": "All that code and you still haven&#39;t included the contents of the batch file."}, {"owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "edited": false, "score": 0, "creation_date": 1449010018, "post_id": 34031236, "comment_id": 55818746, "body": "Since I am on a windows machine I am using a <code>batch</code> file to run a <code>perl</code> script as it seems easier.  i wrote the initial script in <code>perl</code> using ubuntu but most of the users are on a windows platform.  Thank you :)."}, {"owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "reply_to_user": {"reputation": 10786, "user_id": 4158862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKDhB.png?s=128&g=1", "display_name": "SomethingDark", "link": "https://stackoverflow.com/users/4158862/somethingdark"}, "edited": false, "score": 0, "creation_date": 1449010204, "post_id": 34031236, "comment_id": 55818816, "body": "@SomethingDark I edited the post to include the batch file.  Thank you :)."}, {"owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "edited": false, "score": 0, "creation_date": 1449014347, "post_id": 34031236, "comment_id": 55820423, "body": "@dan1111 since users are familiar with <code>excel</code> it made sense to use <code>vba</code> as well. Thank you :)."}, {"owner": {"reputation": 10786, "user_id": 4158862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKDhB.png?s=128&g=1", "display_name": "SomethingDark", "link": "https://stackoverflow.com/users/4158862/somethingdark"}, "edited": false, "score": 2, "creation_date": 1449018477, "post_id": 34031236, "comment_id": 55821675, "body": "Perl exists on Windows, and in fact must be installed on your users&#39; systems in order for your batch script to even work at all. I recommend getting rid of both the VBA and batch options and working exclusively in Perl for this task."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1449021980, "post_id": 34031236, "comment_id": 55822663, "body": "It&#39;s unclear how local variables in a VBA macro (var1, var2, var3, var4) could be visible to the batch file without being added as parameters to wshell.Run"}], "answers": [{"comments": [{"owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "edited": false, "score": 0, "creation_date": 1449093558, "post_id": 34036000, "comment_id": 55861950, "body": "I was prompting for a name on the command line previously and that was causing some errors, so thought <code>vba</code> may help. However, it is a bit more difficult then anticipated.  I will post a new thread in a day or so with a more updated script (maybe it will work).Thank you very much :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1919238"}, "is_accepted": false, "score": 1, "last_activity_date": 1449036604, "creation_date": 1449036604, "answer_id": 34036000, "question_id": 34031236, "link": "https://stackoverflow.com/questions/34031236/use-excel-2010-to-update-variables-in-batch-file/34036000#34036000", "title": "use excel 2010 to update variables in batch file", "body": "<p>Your code fails because it confuses VBA local variables with Windows environment variables.  The variables that you are setting in your VBA macro are not visible to the batch file, because the batch file is totally unaware of the VBA environment.</p>\n\n<p>You could fix this (for example by making system calls in the VBA script that set environment variables); however, the bigger problem is that your design makes no sense.\nThere is no reason to involve VBA and a batch file in the task of running a Perl script, and doing so adds unnecessary complexity.</p>\n\n<p>As others have suggested, why not simply use Perl for the task?</p>\n\n<p>If your Windows users are not comfortable with command line arguments, simply make the script prompt for each file name that is needed.  I would also make your script work with input and output files directly, rather than requiring STDIN and STDOUT to be redirected.  If you do this, then you could create a shortcut for your script and have a very easy way of accessing it.</p>\n\n<p>If some users will want to use the script on the command line, you can accept both modes of input:</p>\n\n<pre><code>my $directory;\nmy $descriptor;\nmy $input_file;\nmy $output_file;\n\n#\nif (@ARGV == 4)\n{\n    $directory = $ARGV[0];\n    $descriptor = $ARGV[1];\n    ...etc.\n}\nelse\n{\n    print \"Enter directory name: \"\n    $directory = &lt;&gt;;\n    chomp $directory;  #remove newline\n    ...etc.\n}\n</code></pre>\n"}], "owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449036604, "creation_date": 1449008097, "last_edit_date": 1531164843, "question_id": 34031236, "link": "https://stackoverflow.com/questions/34031236/use-excel-2010-to-update-variables-in-batch-file", "title": "use excel 2010 to update variables in batch file", "body": "<p>I am trying to update variables using <code>excel 2010 vba</code> that are used in a <code>batch</code> file that runs a code in <code>perl</code>.  Below is the <code>VBA</code> that updates each of the variables and the <code>perl</code> code without the variables is the code that works. With the variables the batch file opens and closes quickly so the syntax appears to be wrong.  Even when I remove <code>@echo off</code> I can not view the error. Thank you :).</p>\n\n<p><strong>VBA</strong> </p>\n\n<pre><code>'Update values and call perl\nDim var1 As String\nDim var2 As String\nDim var3 As String\nDim var4 As String\n\nvar1 = MyDirectory\nvar2 = MyDirectory &amp; \"sample_descriptor.txt\"\nvar3 = \"C:\\cygwin\\home\\cmccabe\\test_probes8.txt\"\nvar4 = MyDirectory &amp; \"output.txt\"\nSet wshell = CreateObject(\"wscript.shell\")\nwshell.Run Chr(34) &amp; \"C:\\Users\\cmccabe\\Desktop\\EmArray\\Design\\spikein.bat\"\n</code></pre>\n\n<p><strong>perl code (no variables)</strong></p>\n\n<pre><code>perl get_imagene_spikein_probe_values.pl \"N:\\1_DATA\\MicroArray\\NexusData\\555_7-2-2015\" \"sample_descriptor.txt\" &lt; test_probes8.txt &gt; \"N:\\1_DATA\\MicroArray\\NexusData\\555_7-2-2015\\output.txt\"\n</code></pre>\n\n<p><strong>perl code (with variables)</strong></p>\n\n<pre><code>perl get_imagene_spikein_probe_values.pl \"%var1%\" \"%var2%\" &lt; %var3% &gt; \"%var4%\"\n</code></pre>\n\n<p><strong>Batch file</strong></p>\n\n<pre><code>@echo off\nperl \"C:\\cygwin\\home\\cmccabe\\get_imagene_spikein_probe_values.pl\" \"%var1%\" \"%var2%\" &lt; \"%var3\" &gt; \"%var4%\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1449006651, "post_id": 34030718, "comment_id": 55817159, "body": "What is <code>Range(LastRow)</code>"}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1449006700, "post_id": 34030718, "comment_id": 55817183, "body": "Do you know how to use your <code>Sub</code>? Do you know that in order to call it you need to create a separate sub?"}, {"owner": {"reputation": 23, "user_id": 5627606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e070f27e3df619afcd574ca2374e292?s=128&d=identicon&r=PG&f=1", "display_name": "SkiBum", "link": "https://stackoverflow.com/users/5627606/skibum"}, "edited": false, "score": 0, "creation_date": 1449248054, "post_id": 34030718, "comment_id": 55939235, "body": "Yes - this is a sub that will be called by other subroutines, that is why I pass in parameters.  I am an old C programmer (pre-Visual C, C++, etc).  But new to VBA.  I am struggling with some of the methods and how they work.  Is there a reason I should not use called sub routines?"}], "answers": [{"comments": [{"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1449007401, "post_id": 34030887, "comment_id": 55817572, "body": "And now it&#39;s even more worth upvoting! The answer is correct, but I just doubt if the OP knows how to call this kind of sub (he said he found the code on this site, but he didn&#39;t say he knew how to use it). It requires parameters to be stated and it can only be done from another sub."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 1, "creation_date": 1449008064, "post_id": 34030887, "comment_id": 55817916, "body": "@ZygD Yes, I assumed that the OP knows what they are doing, but I added a quick blurb to my edit."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1449008014, "last_edit_date": 1449008014, "creation_date": 1449006689, "answer_id": 34030887, "question_id": 34030718, "link": "https://stackoverflow.com/questions/34030718/excel-vba-duplicate-rows/34030887#34030887", "title": "Excel VBA - duplicate rows", "body": "<p>You don't need to loop with autofill:</p>\n\n<pre><code>Sub AddRows(Cnt As Integer, DestName As String)\n\n    Dim DestSheet As Worksheet\n    Set DestSheet = Worksheets(DestName)\n\n    DestSheet.Cells(2, 1).AutoFill _\n              Destination:=DestSheet.Cells(2, 1).Resize(Cnt)\n\nEnd Sub\n</code></pre>\n\n<p>The above will fill A2 down to the number Rows in CNT.  If you want to fill the whole row 2 down, use this.</p>\n\n<pre><code>Sub AddRows(Cnt As Integer, DestName As String)\n\n    Dim DestSheet As Worksheet\n    Set DestSheet = Worksheets(DestName)\n    Dim colcnt As Long\n    With DestSheet\n        colcnt = .Cells(2, .Columns.Count).End(xlToLeft).Column\n\n        .Range(.Cells(2, 1), .Cells(2, colcnt)).AutoFill _\n              Destination:=.Range(.Cells(2, 1), .Cells(2, colcnt)).Resize(Cnt)\n    End With\nEnd Sub\n</code></pre>\n\n<p>AS ZygD explained, Because of the variable in the Sub line, this cannot run on its own it must be called.</p>\n\n<pre><code>Sub CallAddRows()\nDim rwcnt as integer\ndim DestShtNme as String\n\nrwcnt = 20\nDestShtNme = \"Sheet1\" 'Change to your sheet.\n\nAddRows rwcnt, DestShtNme\n\nEnd Sub\n</code></pre>\n\n<p>I assume in your code you are iterating through various sheets and calling this sub to send to add lines.  The above is just an example. How you come up with the two variables to pass into the AddRows sub is up to you.  The important part is that the variable get passed to the sub.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 5627606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e070f27e3df619afcd574ca2374e292?s=128&d=identicon&r=PG&f=1", "display_name": "SkiBum", "link": "https://stackoverflow.com/users/5627606/skibum"}, "is_accepted": false, "score": 1, "last_activity_date": 1449248529, "creation_date": 1449248529, "answer_id": 34093619, "question_id": 34030718, "link": "https://stackoverflow.com/questions/34030718/excel-vba-duplicate-rows/34093619#34093619", "title": "Excel VBA - duplicate rows", "body": "<p>This is what I came up with:</p>\n\n<pre><code>sub x()\nNbrRows = Sheets(SrcName).Range(\"A\" &amp; Rows.Count).End(xlUp).Row  ' get the number of rows on the  sheet to know how many rows to add to the dest sheet\nIf NbrRows &gt; 1 Then\n    Call AddRows(NbrRows, DestName)\nEnd If\n\nend sub\n\nSub AddRows(Cnt As Integer, DestName As String)\n\nDim DestSheet As Worksheet\nDim Dest As String\n\n\nSet DestSheet = Worksheets(DestName)\n' DestSheet.Activate\n\nDest = \"3:\" &amp; Cnt\n\nSheets(DestName).Rows(\"2:2\").Select\nSelection.Copy\nSheets(DestName).Rows(Dest).Select\nSheets(DestName).Paste\nSheets(DestName).Range(\"A2\").Select\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>End Sub ' AddRows</p>\n"}], "owner": {"reputation": 23, "user_id": 5627606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e070f27e3df619afcd574ca2374e292?s=128&d=identicon&r=PG&f=1", "display_name": "SkiBum", "link": "https://stackoverflow.com/users/5627606/skibum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1215, "favorite_count": 0, "accepted_answer_id": 34030887, "answer_count": 2, "score": 0, "last_activity_date": 1449248529, "creation_date": 1449006066, "last_edit_date": 1531161705, "question_id": 34030718, "link": "https://stackoverflow.com/questions/34030718/excel-vba-duplicate-rows", "title": "Excel VBA - duplicate rows", "body": "<p>I need to duplicate a row that is full of formulas N times.  N is defined by the number of rows on a different sheet.  The formulas are unique per row, but I think autofill will handle that.</p>\n\n<p>In \"DestSheet\":\n    Row 1 is a header\n    Row 2 has the line I want to replicate \"Cnt\" times, starting in Row 3.\n    Row 2 has cells that are unique to the row - =Credentials!C2\n    I need Row 2 to be the same as row 2 but increment the row numbers\n         So that I get =Credntials!C3 on row 3 and =Credentials!C4 on row 4\n    (other formulas are more complex - but follow the same model)\n    When the function is done, \"DestSheet\" will have \"Cnt\" rows of what started on line 2</p>\n\n<p>I am close from code I found on this site.....</p>\n\n<pre><code>Sub AddRows(Cnt As Integer, DestName As String)\n\n    Dim DestSheet As Worksheet\n    Dim i As Integer\n\n\n    Set DestSheet = Worksheets(DestName)\n\n    For i = 1 To Cnt\n\n        Sheets(DestName).cell(i + 2, 1).AutoFill _\n              Destination:=Range(LastRow)\n    Next i\nEnd Sub ' AddRows\n</code></pre>\n"}, {"tags": ["vba", "ms-access-2007"], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 4, "last_activity_date": 1449008729, "last_edit_date": 1449008729, "creation_date": 1449008393, "answer_id": 34031316, "question_id": 34030230, "link": "https://stackoverflow.com/questions/34030230/change-a-field-type-programatically-using-vba-access-2007/34031316#34031316", "title": "Change a field type programatically using VBA Access 2007", "body": "<p>You can't change the type of a table field once it's part of a table. Setting <code>fld.Type</code> only works when adding new fields to a table.</p>\n\n<p>Your code probably gives \"Error 3219: Invalid Operation\" ?</p>\n\n<p>But you can do it with DDL (Data Definition Language) SQL, with an <code>ALTER TABLE</code> - <code>ALTER COLUMN</code> statement:</p>\n\n<pre><code>db.Execute \"ALTER TABLE [MBDA List] ALTER COLUMN [MBDA Piece ID] LONG\" \n</code></pre>\n\n<p>Edit: Here's an overview of DDL data type names vs. DAO constants (e.g. <code>dbLong</code>): <a href=\"http://allenbrowne.com/ser-49.html\" rel=\"nofollow\">http://allenbrowne.com/ser-49.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8301278, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/41bdf8c433a0bcb1e5e7594443c514d7?s=128&d=identicon&r=PG", "display_name": "Brian Roberts", "link": "https://stackoverflow.com/users/8301278/brian-roberts"}, "is_accepted": false, "score": 0, "last_activity_date": 1538553375, "last_edit_date": 1538553375, "creation_date": 1499940210, "answer_id": 45077448, "question_id": 34030230, "link": "https://stackoverflow.com/questions/34030230/change-a-field-type-programatically-using-vba-access-2007/45077448#45077448", "title": "Change a field type programatically using VBA Access 2007", "body": "<pre><code>Sub vRunSetFieldType()\n\nCall vSetFieldType(\"Reporting Period\", \"LONG\")\n\nEnd Sub\n\nSub vSetFieldType(strFld As String, strFldType As String)\n\nDim db As dao.Database\nDim tbl As TableDef\nDim fld As dao.Field\nDim strSQL As String\n\nSet db = CurrentDb\n\nFor Each tbl In db.TableDefs\n    If InStr(1, LCase(tbl.Name), \"msys\") = 0 Then\n        For Each fld In tbl.Fields\n            If LCase(fld.Name) = LCase(strFld) Then\n                'Debug.Print tbl.Name &amp; Chr(9) &amp; fld.Name &amp; Chr(9) &amp; fld.Type\n                strSQL = \"ALTER TABLE [\" &amp; tbl.Name &amp; \"] ALTER COLUMN [\" &amp; fld.Name &amp; \"] \" &amp; strFldType &amp; \";\"\n                Debug.Print strSQL\n                db.Execute strSQL\n            End If\n        Next fld\n    End If\nNext tbl\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11228244, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/fcdbdc5ea50b6fa03335b742aa50e62f?s=128&d=identicon&r=PG", "display_name": "Khairul Amin", "link": "https://stackoverflow.com/users/11228244/khairul-amin"}, "is_accepted": false, "score": 0, "last_activity_date": 1553021461, "last_edit_date": 1553021461, "creation_date": 1553020244, "answer_id": 55247821, "question_id": 34030230, "link": "https://stackoverflow.com/questions/34030230/change-a-field-type-programatically-using-vba-access-2007/55247821#55247821", "title": "Change a field type programatically using VBA Access 2007", "body": "<p>you can try this</p>\n\n<pre><code>Sub AlterDataType()\n   Dim strSQL As String\n   strSQL = \"ALTER TABLE [myTable] ALTER COLUMN myColumnDbl memo\"\n   DoCmd.RunSQL strSQL\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5627554, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153853558959653/picture?type=large", "display_name": "Ted David", "link": "https://stackoverflow.com/users/5627554/ted-david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12128, "favorite_count": 0, "answer_count": 3, "score": 5, "last_activity_date": 1553021461, "creation_date": 1449004273, "question_id": 34030230, "link": "https://stackoverflow.com/questions/34030230/change-a-field-type-programatically-using-vba-access-2007", "title": "Change a field type programatically using VBA Access 2007", "body": "<p>I have a routine that imports an Excel table, changes several column (field) names, adds an index and several new fields.  However, the indexed field imports from Excel as a Double and I would like to change it to Long.  This code snippet works all except for changing the type:</p>\n\n<pre><code>Set tdf = db.TableDefs(TableName) ' Modify the new MBDA List table\nFor Each fld In tdf.Fields\n    Select Case fld.Name ' Change the name of specific fields\n        Case \"MBDA Piece ID #\"\n            fld.Name = \"MBDA Piece ID\"\n            fld.Type = dbLong ' change the type from Double to Long\n        Case \"&gt;&gt;Grade Level\"\n            fld.Name = \"Grade\"\n        Case Else\n    End Select\nNext fld\nNumFlds = i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449003743, "post_id": 34030040, "comment_id": 55815527, "body": "A quick check is sum. And if not too many columns, concatenate them and do a vlookup."}], "answers": [{"comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1449004851, "post_id": 34030164, "comment_id": 55816134, "body": "simple quick answer <i>+1</i>"}], "tags": [], "owner": {"reputation": 1313, "user_id": 1818055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LizLD.png?s=128&g=1", "display_name": "thepiyush13", "link": "https://stackoverflow.com/users/1818055/thepiyush13"}, "is_accepted": true, "score": 5, "last_activity_date": 1449004575, "last_edit_date": 1449004575, "creation_date": 1449004113, "answer_id": 34030164, "question_id": 34030040, "link": "https://stackoverflow.com/questions/34030040/excel-how-to-compare-sheets-from-2-different-workbooks-for-differences/34030164#34030164", "title": "Excel: How to compare sheets from 2 different workbooks for differences", "body": "<p>I think you already know how to verify data using formula so is the problem to refer to a row in a different workbook ? if so,  following might be helpful :</p>\n\n<pre><code>=[yourFile.xls]SheetName!$Col$Row\n</code></pre>\n\n<p>this way you can update your formula like(yourFile.xls refers to the complete path including the file name) :</p>\n\n<pre><code>=[file1.xls]April12!A1=[file2.xls]April15!A1\n</code></pre>\n"}], "owner": {"reputation": 731, "user_id": 3345200, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ad6c12a8725ac515660c50f070d9411?s=128&d=identicon&r=PG&f=1", "display_name": "Reeggiie", "link": "https://stackoverflow.com/users/3345200/reeggiie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 1, "accepted_answer_id": 34030164, "answer_count": 1, "score": 1, "last_activity_date": 1521474587, "creation_date": 1449003618, "last_edit_date": 1521474587, "question_id": 34030040, "link": "https://stackoverflow.com/questions/34030040/excel-how-to-compare-sheets-from-2-different-workbooks-for-differences", "title": "Excel: How to compare sheets from 2 different workbooks for differences", "body": "<p>I have an original excel file that I have ran a simulation that inputs financial data. I made a copy of this file, and wired the formulas up differently to try and increase calculation performances.</p>\n\n<p>I now have 2 workbooks, the original and the final.  I want to compare each sheet from each of the workbooks together to make sure that the financial numbers have remained the same, to make sure the new formulas are not effecting the numbers received.</p>\n\n<p>I have tried to put copies of the two sheets into one workbook, name them April12 and April15. Then insert a third sheet. In cell A1 of the third sheet, I wanted to use the formula</p>\n\n<pre><code>=April12!A1=April15!A1\n</code></pre>\n\n<p>to get TRUE/FALSE values. But the formulas in these sheets reference many other sheets that are not in this new workbook, so all of my numbers turn up as #REF.</p>\n\n<p>Iv googled many different ways of approaching this but I cant seem to get any of them to work. Does anyone know a simple way I can compare just the values from 2 sheets from 2 different workbooks to find out if the numbers have remained the same or have changed?</p>\n\n<p>Note:I am using excel 2010.</p>\n"}]