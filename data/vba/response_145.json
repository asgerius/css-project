[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 862, "user_id": 1560126, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8cebd478b6291f992ce5b2547b9c36f3?s=128&d=identicon&r=PG", "display_name": "ale10ander", "link": "https://stackoverflow.com/users/1560126/ale10ander"}, "edited": false, "score": 0, "creation_date": 1508370052, "post_id": 46820765, "comment_id": 80589059, "body": "This question would be more appropriate for Super User, as, unless you are looking for a VBA solution, it does not involve programming. Please consider adding an excel-vba tag or moving your question."}, {"owner": {"reputation": 169, "user_id": 8747567, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e8bf5c4bb797832996c75c64d1b6cabf?s=128&d=identicon&r=PG&f=1", "display_name": "Jesus", "link": "https://stackoverflow.com/users/8747567/jesus"}, "reply_to_user": {"reputation": 862, "user_id": 1560126, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8cebd478b6291f992ce5b2547b9c36f3?s=128&d=identicon&r=PG", "display_name": "ale10ander", "link": "https://stackoverflow.com/users/1560126/ale10ander"}, "edited": false, "score": 0, "creation_date": 1508370292, "post_id": 46820765, "comment_id": 80589121, "body": "Just did, thank you for the suggestion!"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1508370878, "post_id": 46820765, "comment_id": 80589266, "body": "You can probably add Custom Data Validation with something like <code>=MOD(A1,1)=0</code> <a href=\"https://support.office.com/en-us/article/Apply-data-validation-to-cells-29fecbcc-d1b9-42c1-9d76-eff3ce5f7249\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 169, "user_id": 8747567, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e8bf5c4bb797832996c75c64d1b6cabf?s=128&d=identicon&r=PG&f=1", "display_name": "Jesus", "link": "https://stackoverflow.com/users/8747567/jesus"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1508371688, "post_id": 46820765, "comment_id": 80589494, "body": "@Slai, wouldn&#39;t it be =MOD(A1,1)&lt;&gt;0?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1508371823, "post_id": 46820765, "comment_id": 80589526, "body": "What have you tried?  What happened?"}], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 8747567, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e8bf5c4bb797832996c75c64d1b6cabf?s=128&d=identicon&r=PG&f=1", "display_name": "Jesus", "link": "https://stackoverflow.com/users/8747567/jesus"}, "edited": false, "score": 0, "creation_date": 1508427191, "post_id": 46821239, "comment_id": 80614763, "body": "Awesome! that works perfectly :)  Thank you for the help."}, {"owner": {"reputation": 169, "user_id": 8747567, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e8bf5c4bb797832996c75c64d1b6cabf?s=128&d=identicon&r=PG&f=1", "display_name": "Jesus", "link": "https://stackoverflow.com/users/8747567/jesus"}, "edited": false, "score": 0, "creation_date": 1508427682, "post_id": 46821239, "comment_id": 80615094, "body": "the only issue that I am seeing though is that if I select &quot;BNR&quot; and input a decimal value (ex 3.4) in column W and then I leave that number and only change column V from &quot;BNR&quot; to &quot;BCD&quot; then that decimal stays there and does not output any error."}, {"owner": {"reputation": 3725, "user_id": 4388883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3cf69657df9c46dd460e73760894308?s=128&d=identicon&r=PG&f=1", "display_name": "ian0411", "link": "https://stackoverflow.com/users/4388883/ian0411"}, "reply_to_user": {"reputation": 169, "user_id": 8747567, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e8bf5c4bb797832996c75c64d1b6cabf?s=128&d=identicon&r=PG&f=1", "display_name": "Jesus", "link": "https://stackoverflow.com/users/8747567/jesus"}, "edited": false, "score": 0, "creation_date": 1508427863, "post_id": 46821239, "comment_id": 80615229, "body": "I know.  That is something this <code>Data Validation</code> didn&#39;t work quite well.  You can also copy paste the decimal numbers in and it wouldn&#39;t error out.  I will say probably try <code>Conditional Formatting</code> as a second layer to warn people."}, {"owner": {"reputation": 169, "user_id": 8747567, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e8bf5c4bb797832996c75c64d1b6cabf?s=128&d=identicon&r=PG&f=1", "display_name": "Jesus", "link": "https://stackoverflow.com/users/8747567/jesus"}, "edited": false, "score": 0, "creation_date": 1508428913, "post_id": 46821239, "comment_id": 80615911, "body": "Thank you, will do that."}, {"owner": {"reputation": 3725, "user_id": 4388883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3cf69657df9c46dd460e73760894308?s=128&d=identicon&r=PG&f=1", "display_name": "ian0411", "link": "https://stackoverflow.com/users/4388883/ian0411"}, "reply_to_user": {"reputation": 169, "user_id": 8747567, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e8bf5c4bb797832996c75c64d1b6cabf?s=128&d=identicon&r=PG&f=1", "display_name": "Jesus", "link": "https://stackoverflow.com/users/8747567/jesus"}, "edited": false, "score": 0, "creation_date": 1508429325, "post_id": 46821239, "comment_id": 80616183, "body": "You are very welcome."}], "tags": [], "owner": {"reputation": 3725, "user_id": 4388883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3cf69657df9c46dd460e73760894308?s=128&d=identicon&r=PG&f=1", "display_name": "ian0411", "link": "https://stackoverflow.com/users/4388883/ian0411"}, "is_accepted": true, "score": 1, "last_activity_date": 1508373197, "creation_date": 1508373197, "answer_id": 46821239, "question_id": 46820765, "link": "https://stackoverflow.com/questions/46820765/how-to-use-data-validation-to-allow-the-user-to-only-input-an-integer-otherwise/46821239#46821239", "title": "How to use data validation to allow the user to ONLY input an integer, otherwise it outputs an error when a decimal is inputted", "body": "<p><img src=\"https://i.stack.imgur.com/0AS6c.png\" alt=\"\"></p>\n\n<p>If I understand your question correctly (you mentioned <code>UDP</code> but shows <code>BCD</code> in your screenshot), you can try this.</p>\n\n<p>Under <code>Data Validation</code>, you can use a Custom Formula like below:</p>\n\n<pre><code>=(V2=\"BCD\")*(INT(W2)=W2)+(V2&lt;&gt;\"BCD\")\n</code></pre>\n\n<p>The error will only shows when <code>column V</code> has <code>BCD</code> with <code>column W</code> has decimal numbers.  And don't forget to drag it down to cover all the fields in <code>column W</code>.</p>\n\n<p>Try and let me know if this is what you are looking for.</p>\n"}], "owner": {"reputation": 169, "user_id": 8747567, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e8bf5c4bb797832996c75c64d1b6cabf?s=128&d=identicon&r=PG&f=1", "display_name": "Jesus", "link": "https://stackoverflow.com/users/8747567/jesus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "closed_date": 1508399868, "accepted_answer_id": 46821239, "answer_count": 1, "score": 0, "last_activity_date": 1508427834, "creation_date": 1508369592, "last_edit_date": 1508427834, "question_id": 46820765, "link": "https://stackoverflow.com/questions/46820765/how-to-use-data-validation-to-allow-the-user-to-only-input-an-integer-otherwise", "closed_reason": "Needs details or clarity", "title": "How to use data validation to allow the user to ONLY input an integer, otherwise it outputs an error when a decimal is inputted", "body": "<p>I am trying to use data validation in excel that would produce an error if a user inputs a decimal value in a column (column W) AND selected the \"BCD\" option from another column (column V). Please see the picture below where it shows the two columns I am describing. </p>\n\n<p>In the picture, I don't want the user to input 23.45 (a decimal value) because in column V they selected BCD. Rather, I would display an error message saying that an integer needs to be input.</p>\n\n<p><a href=\"https://i.stack.imgur.com/K1Sco.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K1Sco.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba", "countif", "visual-studio-macros"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508371663, "post_id": 46820708, "comment_id": 80589481, "body": "that is not <code>countif in a macro</code>. you are using a macro to place a formula into a cell (same as if you have typed it in).  check the resulting formula in the worksheet cell to see if it is correct and make corrections to your code if it is not correct ..... note: do not use <code>select ... activecell</code> ... use <code>ActiveCell.Offset(1, 0).Value = &quot;=countif(B2:&quot; + lastcell + &quot;, John)&quot;</code>"}, {"owner": {"reputation": 162, "user_id": 8789482, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10207644192263165/picture?type=large", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8789482/jonathan"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508384071, "post_id": 46820708, "comment_id": 80592318, "body": "Thank you jstola, but the result is still 0."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508386565, "post_id": 46820708, "comment_id": 80592839, "body": "what is the formula in cell below lastcell ?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508387655, "post_id": 46820708, "comment_id": 80593071, "body": "use <code>ActiveCell.Offset(1, 0).Value = &quot;=countif(B2:&quot; + lastcell + &quot;, &quot;&quot;John&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 162, "user_id": 8789482, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10207644192263165/picture?type=large", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8789482/jonathan"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508398643, "post_id": 46820708, "comment_id": 80597138, "body": "THANK YOU!!!!!!!!!!!! it works now!"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508398806, "post_id": 46820708, "comment_id": 80597232, "body": "makes no sense why that worked and Tim&#39;s code did not"}, {"owner": {"reputation": 162, "user_id": 8789482, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10207644192263165/picture?type=large", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8789482/jonathan"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508404265, "post_id": 46820708, "comment_id": 80600341, "body": "Will I able to loop on that too? For example, it will count the number of &quot;John&quot;, &quot;Mark&quot;, &quot;Mike&quot; and highlight the row of that name (in any color) if it&#39;s more than 50% of the total count. Let&#39;s say there are 10 entries and there are 5 or more &quot;John&quot; in that column.  Thank you so much for the help. Really appreciate it."}], "answers": [{"comments": [{"owner": {"reputation": 162, "user_id": 8789482, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10207644192263165/picture?type=large", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8789482/jonathan"}, "edited": false, "score": 0, "creation_date": 1508383687, "post_id": 46821009, "comment_id": 80592215, "body": "Hi Jeeped, Thank you for answering my query. It is returning a 0 as a results."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1508371438, "creation_date": 1508371438, "answer_id": 46821009, "question_id": 46820708, "link": "https://stackoverflow.com/questions/46820708/countif-in-macros-gives-0-results/46821009#46821009", "title": "countif in macros gives 0 results", "body": "<p>Try,</p>\n\n<pre><code>ActiveCell.formula = \"=countif(B2:\" &amp; lastcell &amp; chr(44) &amp; chr(34) &amp;\"John\" &amp;chr(34) &amp; \")\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 162, "user_id": 8789482, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10207644192263165/picture?type=large", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8789482/jonathan"}, "edited": false, "score": 0, "creation_date": 1508383359, "post_id": 46821109, "comment_id": 80592138, "body": "Thank you for answering my query. I tried your code (copy+paste) and it is giving me a syntax error."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508387436, "post_id": 46821109, "comment_id": 80593034, "body": "that should have worked ... are any of the lines colored red in the editor?  ... do you have any data in column B ?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1508389686, "post_id": 46821109, "comment_id": 80593608, "body": "Works for me.  It will fail if there&#39;s no content in B3 though."}, {"owner": {"reputation": 162, "user_id": 8789482, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10207644192263165/picture?type=large", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8789482/jonathan"}, "edited": false, "score": 0, "creation_date": 1508396160, "post_id": 46821109, "comment_id": 80595765, "body": "Hi Tim, oh sorry need to inform you that it&#39;s in a table style  medium 2( blue and white. Thank you Tim."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508398714, "post_id": 46821109, "comment_id": 80597178, "body": "makes no difference what color the cells are"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1508372096, "creation_date": 1508372096, "answer_id": 46821109, "question_id": 46820708, "link": "https://stackoverflow.com/questions/46820708/countif-in-macros-gives-0-results/46821109#46821109", "title": "countif in macros gives 0 results", "body": "<pre><code>Public Sub counting()\n    With Range(\"B2\").End(xlDown)\n        .Offset(1, 0).Formula = \"=COUNTIF(B2:\" &amp; .Address(False, False) &amp; \", \"\"John\"\")\"\n    End with\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 162, "user_id": 8789482, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10207644192263165/picture?type=large", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8789482/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1508372096, "creation_date": 1508369222, "question_id": 46820708, "link": "https://stackoverflow.com/questions/46820708/countif-in-macros-gives-0-results", "title": "countif in macros gives 0 results", "body": "<p>\u200bI was trying to do a countif in a column B named First Name that has different names in it but the results is returning 0.</p>\n\n<p>Here is my code:</p>\n\n<p>Public Sub counting()\n    Dim lastcell As String</p>\n\n<pre><code>Range(\"B2\").Select\n\nSelection.End(xlDown).Select\nlastcell = ActiveCell.Address\n\nActiveCell.Offset(1, 0).Select\nActiveCell.Value = \"=countif(B2:\" + lastcell + \", John)\"\n\nEnd Sub\n</code></pre>\n\n<p>If I check the formula written in the active cell it is:</p>\n\n<p>=COUNTIF(B2:$B$16, John)</p>\n\n<p>Please help.</p>\n\n<p>I tried changing the line from</p>\n\n<p>ActiveCell.Value = \"=countif(B2:\" + lastcell + \", John)\"</p>\n\n<p>to</p>\n\n<p>ActiveCell.Value = \"=countif(B2:\" + lastcell + \", \"John\")\" still not working.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1508796420, "post_id": 46820466, "comment_id": 80745720, "body": "Hi there. A number of folks in our community sometimes say that every time they see gendered assumptions about software engineers, they worry about people feeling excluded. I wonder, could you try to avoid adding male-oriented greetings and pronouns in your posts, so as to make for a more welcoming environment? Thank you."}, {"owner": {"reputation": 79, "user_id": 8673378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c38e4adf0db133f5d760bcf28063642d?s=128&d=identicon&r=PG&f=1", "display_name": "rzenva", "link": "https://stackoverflow.com/users/8673378/rzenva"}, "reply_to_user": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1508820508, "post_id": 46820466, "comment_id": 80751493, "body": "Honestly and without any intention of offending, what are you even talking about?"}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1508834586, "post_id": 46820466, "comment_id": 80758515, "body": "See my edit, in which I removed &quot;gentlemen&quot; from &quot;This is a table, gentlemen, with over 10k rows&quot;. The wording was a bit odd, though - did I misunderstand what you meant?"}, {"owner": {"reputation": 79, "user_id": 8673378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c38e4adf0db133f5d760bcf28063642d?s=128&d=identicon&r=PG&f=1", "display_name": "rzenva", "link": "https://stackoverflow.com/users/8673378/rzenva"}, "reply_to_user": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1508883012, "post_id": 46820466, "comment_id": 80789152, "body": "Not really, I used gentlemen without trying to offend anybody."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1508883661, "post_id": 46820466, "comment_id": 80789369, "body": "It&#39;s cool, no-one is offended. I am interested in language since I think it is a reflection of how people think, and what their subconscious motivations and biases are. Thus, if there is a corner of (male) brains that says &quot;programmers are male&quot;, then this will be reflected in thought processes within the industry, sometimes including in hiring. I like the idea that we can challenge that, even if we sometimes have to question ourselves on how we think (a practice I try to subject myself to also)."}], "owner": {"reputation": 79, "user_id": 8673378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c38e4adf0db133f5d760bcf28063642d?s=128&d=identicon&r=PG&f=1", "display_name": "rzenva", "link": "https://stackoverflow.com/users/8673378/rzenva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508796443, "creation_date": 1508367505, "last_edit_date": 1531161705, "question_id": 46820466, "link": "https://stackoverflow.com/questions/46820466/insert-x-rows-under-a-table-by-a-cell-value", "title": "Insert x rows under a table by a cell value", "body": "<p>I have researched before posting this and I managed to piece together some code, but for some reason it is not working as I want it to.</p>\n\n<p>I want to add X number of rows under a cell in Excel if its value is changed to something that is greater than 1. </p>\n\n<p>For example, I have a table like this:</p>\n\n<pre><code>        Col1            Col2        Col3    Split\n   R1  something1      thing2      thing3      2\n   R2  something2      thing3      thing4   \n   R3  something3      thing4      thing5   \n</code></pre>\n\n<p>If I have a value greater than 1 in col4, like 2 in R1 for something1, then my code will insert one row into the table under R1 but it will copy the values from R1, in the end there will be two something1 (because there are two split). So, it will end in something like this:</p>\n\n<pre><code>        Col1            Col2        Col3    Split\n   R1  something1      thing2     thing3     2\n   R2  something1      thing2     thing3     2\n   R4  something2      thing3     thing4    \n   R5  something3      thing4     thing5    \n</code></pre>\n\n<p>Right now, I have this code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As range)\n    Dim KeyCells As range\n    Dim tbl As ListObject\n    Dim tRows As Long\n    Dim tCols As Long\n    Dim miss As Integer\n\n    Set tbl = ActiveSheet.ListObjects(\"TableQueryLawson\")\n    With tbl.DataBodyRange\n        tRows = .Rows.Count\n        tCols = .Columns.Count\n    End With\n\n    col = ColumnNumberByHeader(\"Splits\")\n\n    If col &lt;&gt; 0 Then\n        Set KeyCells = range(Cells(5, col), Cells(tRows, col))\n    Else\n        Cancel = True\n        MsgBox \"Check that column COMMENTS exist\"\n        Exit Sub\n    End If\n\n\n    If Not Application.Intersect(KeyCells, range(Target.Address)) Is Nothing Then\n\n        If Target.Value &gt; 1 Then\n            MsgBox \"Cell \" &amp; Target.Address &amp; \" has changed.\"\n        End If\n\n            Set newRow = tbl.ListRows.Add()\n\n    End With\n    End If\nEnd Sub\n</code></pre>\n\n<p>But, I am stuck at the part of adding a new row and filling down the data that was in the row below. I also need it to be able add to even 10 rows if the user specify so in the Split column.</p>\n\n<p>This is a table with over 10k rows and over 40 columns.</p>\n\n<p>I am using Excel 2013.</p>\n"}, {"tags": ["c#", "vba", "ms-word"], "comments": [{"owner": {"reputation": 797, "user_id": 4476568, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JS3FJ.png?s=128&g=1", "display_name": "Red Wei", "link": "https://stackoverflow.com/users/4476568/red-wei"}, "edited": false, "score": 0, "creation_date": 1508381920, "post_id": 46820186, "comment_id": 80591818, "body": "What do you mean by &quot;you have to go in and change which string you want to replace for each value&quot;? I assume that is when the program runs, it will open Microsoft Word and popup &quot;Find and Replace&quot; like you perform it in Microsoft Word without the program? And which type of document your program will process, doc or docx?"}, {"owner": {"reputation": 1, "user_id": 8798280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4729fad786f394466ba2a96fb670d06?s=128&d=identicon&r=PG&f=1", "display_name": "jchmns", "link": "https://stackoverflow.com/users/8798280/jchmns"}, "reply_to_user": {"reputation": 797, "user_id": 4476568, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JS3FJ.png?s=128&g=1", "display_name": "Red Wei", "link": "https://stackoverflow.com/users/4476568/red-wei"}, "edited": false, "score": 0, "creation_date": 1508438647, "post_id": 46820186, "comment_id": 80621098, "body": "@RedWei I dont care whether it is doc or docx, I can do whichever. I do not want to have to use the built in find and replace feature- there is a lot of copy and pasting for each value I want to replace. If you go and look at the microsoft word document I attached, you can see how the content controls all update when you edit one."}, {"owner": {"reputation": 797, "user_id": 4476568, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JS3FJ.png?s=128&g=1", "display_name": "Red Wei", "link": "https://stackoverflow.com/users/4476568/red-wei"}, "edited": false, "score": 0, "creation_date": 1508458928, "post_id": 46820186, "comment_id": 80629200, "body": "It IS important whether you want to process doc or docx. If you go for doc you must stick with Interop, if you go for docx and DOCX ONLY you have to process OOXML which is easier and don&#39;t require Microsoft Word."}, {"owner": {"reputation": 797, "user_id": 4476568, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JS3FJ.png?s=128&g=1", "display_name": "Red Wei", "link": "https://stackoverflow.com/users/4476568/red-wei"}, "edited": false, "score": 0, "creation_date": 1508460273, "post_id": 46820186, "comment_id": 80629533, "body": "When you work with Interop, your must close all the WINWORD.exe processes in the Task Manager because it will open a hidden Microsoft Word process whenever you open a document by Interop. They DO dynamically respond during run-time but you can&#39;t see it because it is reflected inside the process WINWORD.exe which doesn&#39;t have an UI. You must save the document to see that change. When you have changed all the required content, you call document.Save() or document.SaveAs2() method to save the word file and see the change"}], "owner": {"reputation": 1, "user_id": 8798280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4729fad786f394466ba2a96fb670d06?s=128&d=identicon&r=PG&f=1", "display_name": "jchmns", "link": "https://stackoverflow.com/users/8798280/jchmns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 308, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508365587, "creation_date": 1508365587, "question_id": 46820186, "link": "https://stackoverflow.com/questions/46820186/replacing-microsoft-word-content-control-dynamically-at-runtime", "title": "Replacing Microsoft Word Content Control Dynamically At Runtime", "body": "<p>I want to be able to bind content control fields to each others' values. Basically if you change a  field at the top, all others in the document also update to that. I'm replacing hundreds of individual variables, each with 100 duplicates. There is a better way than the 'Find and Replace Tool'. </p>\n\n<p>Here is a sample document directly from Microsoft's site that shows exactly what I would like to be able to do: </p>\n\n<p><a href=\"https://omextemplates.content.office.net/support/templates/en-us/tf03444179.dotx\" rel=\"nofollow noreferrer\">https://omextemplates.content.office.net/support/templates/en-us/tf03444179.dotx</a></p>\n\n<p>When the '' value is changed, all others in the document update.</p>\n\n<p>I've already looked at plenty of solutions like: <a href=\"https://stackoverflow.com/questions/19252252/c-sharp-word-interop-find-and-replace-everything\">c# word interop find and replace everything</a></p>\n\n<p>But they do not dynamically respond during run-time. In other words you have to go in and change which string you want to replace for each value.</p>\n\n<p>Been looking for a while now, thanks in advance if anyone else can figure this out.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 8697740, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/686fb3ecbe208f8aca4e15cffc92d4cb?s=128&d=identicon&r=PG&f=1", "display_name": "zero", "link": "https://stackoverflow.com/users/8697740/zero"}, "edited": false, "score": 0, "creation_date": 1508453712, "post_id": 46820891, "comment_id": 80627905, "body": "Getting a <code>resume without error</code> message box followed by a blank message box which repeats infinitely. <code>dicCommentNames(oComment.Shape.Name)</code> should be an iteration for the parameter instead of <code>.name</code> then <code>=.name</code>?"}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "reply_to_user": {"reputation": 17, "user_id": 8697740, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/686fb3ecbe208f8aca4e15cffc92d4cb?s=128&d=identicon&r=PG&f=1", "display_name": "zero", "link": "https://stackoverflow.com/users/8697740/zero"}, "edited": false, "score": 0, "creation_date": 1508462041, "post_id": 46820891, "comment_id": 80629938, "body": "My very bad; add Exit Sub after <code>Application.ScreenUpdating = True</code>. I&#39;ll update the answer."}], "tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": true, "score": 0, "last_activity_date": 1508462160, "last_edit_date": 1508462160, "creation_date": 1508370509, "answer_id": 46820891, "question_id": 46820021, "link": "https://stackoverflow.com/questions/46820021/delete-textboxes-but-keep-comments/46820891#46820891", "title": "Delete textboxes but keep comments", "body": "<p>You can do something along those lines:</p>\n\n<pre><code>Sub DeleteTextboxesButKeepComments\n    Dim bx As Excel.TextBox\n    Dim oComment As Excel.Comment\n    Dim dicCommentNames As Object 'Scripting.Dictionary\n\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    On Error GoTo errHandler\n\n    'Build a dictionary of the worksheet's comment's shape names.\n    Set dicCommentNames = CreateObject(\"Scripting.Dictionary\")\n    dicCommentNames.CompareMode = VbCompareMethod.vbBinaryCompare\n    For Each oComment In Target.Worksheet.Comments\n        dicCommentNames(oComment.Shape.Name) = True\n    Next oComment\n\n    If Intersect(Target, Target.Worksheet.Range(\"B5:B34\")) Is Nothing Then 'Or Target = \"\" Then\n        For Each bx In Target.Worksheet.TextBoxes\n            'Avoid deleting textboxes whose name is among those used for comments.\n            If Not dicCommentNames.Exists(bx.Name) Then\n                bx.Delete\n            End If\n        Next\n    End If\n\nCleanup:\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n    Exit Sub\n\nerrHandler:\n    MsgBox Err.Description, vbExclamation + vbOKOnly, \"Error\"\n    Resume Cleanup\nEnd Sub\n</code></pre>\n\n<p>I'm not sure what you want to do by testing for <code>Target = \"\"</code> but it won't work if there are more than 1 cell in Target. Let me know and I'll amend my answer.</p>\n"}], "owner": {"reputation": 17, "user_id": 8697740, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/686fb3ecbe208f8aca4e15cffc92d4cb?s=128&d=identicon&r=PG&f=1", "display_name": "zero", "link": "https://stackoverflow.com/users/8697740/zero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 46820891, "answer_count": 1, "score": 0, "last_activity_date": 1508462160, "creation_date": 1508364559, "last_edit_date": 1531161705, "question_id": 46820021, "link": "https://stackoverflow.com/questions/46820021/delete-textboxes-but-keep-comments", "title": "Delete textboxes but keep comments", "body": "<p>I have the following code which fires via <code>Worksheet_SelectionChange</code>. However, it appears comments are getting deleted as well. How can I keep comments?</p>\n\n<pre><code>If Intersect(Target, Range(\"B5:B34\")) Is Nothing Or Target = \"\" Then\n    For Each bx In ActiveSheet.TextBoxes\n        bx.Delete\n    Next\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "indexing", "match"], "comments": [{"owner": {"reputation": 19, "user_id": 8701550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1277917848981073/picture?type=large", "display_name": "Bruno Pimenta", "link": "https://stackoverflow.com/users/8701550/bruno-pimenta"}, "edited": false, "score": 0, "creation_date": 1508365927, "post_id": 46819897, "comment_id": 80587961, "body": "I tried by using the code mentioned in the other post, but didn&#39;t get correct responde, its occuring an incompatible variable type error."}], "owner": {"reputation": 19, "user_id": 8701550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1277917848981073/picture?type=large", "display_name": "Bruno Pimenta", "link": "https://stackoverflow.com/users/8701550/bruno-pimenta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "closed_date": 1508364897, "answer_count": 0, "score": 1, "last_activity_date": 1508367211, "creation_date": 1508363817, "last_edit_date": 1508367211, "question_id": 46819897, "link": "https://stackoverflow.com/questions/46819897/vba-using-index-and-match-with-two-columns-as-criterias-incompatible-variable", "closed_reason": "Duplicate", "title": "VBA: using index and match with two columns as criterias (INCOMPATIBLE VARIABLE ERROR)", "body": "<p>I'm trying to implement an index+match formula by using two columns as refereces to get a third column.</p>\n\n<p>I have the following table and the code. \nany suggestions?</p>\n\n<p><code>billy  FESTO   1\nbilly   FELIPE  2\nbilly   JOHNY   3\nbilly   MARCO   4\nbilly   TOS     5\njohn    CASTRO  6\nbilly   CAM     7\nbilly   THR     8\nbilly   SIS     9\nbilly   VIX    10\nbilly   KOX    11\nbilly   JUH    12\nbilly   MIL    13\nbilly   MIS    14\nbilly   MR    15\nbilly   MAN   16</code></p>\n\n<pre><code>`  Sub test()\n   Dim teste As String\n\n   teste = WorksheetFunction.Index(Range(\"C1:C100\"), \n   WorksheetFunction.Match(\"billy\" &amp; \"&amp;\" &amp; \"TOS\", Range(\"A1:A100\") _\n   &amp; \"&amp;\" &amp; Range(\"B1:B100\"), 0))\n\n   End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8797786, "user_type": "registered", "profile_image": "https://graph.facebook.com/1976234989330497/picture?type=large", "display_name": "Conceptic", "link": "https://stackoverflow.com/users/8797786/conceptic"}, "edited": false, "score": 0, "creation_date": 1508674595, "post_id": 46820911, "comment_id": 80694861, "body": "Works very nice, but I&#39;m still having some troubles: 1. When the movie is aborted, I would like to add the text &quot;aborted&quot; in cells with finish date/time, to make the position disappeared from the ComboBox list. 2. In case of second break during the movie, I don&#39;t know how to go automatically to the next columns (I have a space for three breaks in a table). Could you help me with this?"}, {"owner": {"reputation": 13, "user_id": 8797786, "user_type": "registered", "profile_image": "https://graph.facebook.com/1976234989330497/picture?type=large", "display_name": "Conceptic", "link": "https://stackoverflow.com/users/8797786/conceptic"}, "edited": false, "score": 0, "creation_date": 1508712686, "post_id": 46820911, "comment_id": 80707010, "body": "I decided to add dependent Combobox with the reasons of movie break. Unfortunately I am lost with getting the value from the first Combobox - &quot;myval = Me.Combobox.Column(1)&quot; does not work. Do you know why?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 13, "user_id": 8797786, "user_type": "registered", "profile_image": "https://graph.facebook.com/1976234989330497/picture?type=large", "display_name": "Conceptic", "link": "https://stackoverflow.com/users/8797786/conceptic"}, "edited": false, "score": 0, "creation_date": 1508730186, "post_id": 46820911, "comment_id": 80710469, "body": "<code>Movie_Title_ComboBox.List(Movie_Title_ComboBox.ListIndex, 1)</code> will give you the value of the first column of the selected item. <code>Movie_Title_ComboBox.List(Movie_Title_ComboBox.ListIndex, 3)</code> will give you the value of the third column of the selected item."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1508370664, "creation_date": 1508370664, "answer_id": 46820911, "question_id": 46819705, "link": "https://stackoverflow.com/questions/46819705/excel-2013-vba-multiple-userforms-to-fill-out-the-table/46820911#46820911", "title": "Excel 2013 VBA multiple userforms to fill out the table", "body": "<p>In my example below, I show how to configure a ComboBox to hold multiple columns of data and to later retrieve the values.   This will allow you to store the Row number along with the movie data in the ComboBox.</p>\n\n<p>'Filtering for not finished jobs for combobox\n    Private Sub UserForm_Initialize()\n        Dim ws As Worksheet\n        Dim x As Long</p>\n\n<pre><code>    With Me.Movie_Title_ComboBox\n        .ColumnCount = 4\n        .ColumnWidths = \"0 pt;250 pt;90 pt; 90 pt;\"\n        '.ListWidth = 500\n        .TextColumn = 2\n        .BoundColumn = 1\n    End With\n\n    Set ws = Sheet2\n    With ws\n        For x = 2 To .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n            If .Cells(x, 4).Value = \"\" Then\n                AddItems Me.Movie_Title_ComboBox, x, .Cells(x, 1).Value, Format(.Cells(x, 3).Value, \"MM/DD/YYYY\"), Format(.Cells(x, 3).Value, \"HH:MM\")\n            End If\n        Next\n    End With\nEnd Sub\n\nPrivate Sub Movie_Title_ComboBox_Change()\n    With Me.Movie_Title_ComboBox\n        If .ListIndex &gt; -1 Then\n            Finish_Date_Box.Value = .List(.ListIndex, 2)\n        End If\n    End With\nEnd Sub\n\nPrivate Sub movie_finished_save_Click()\n    With Sheet2\n        .Cells(Me.Movie_Title_ComboBox.Value, 4) = Me.Finish_Date_Box.Value\n        .Cells(Me.Movie_Title_ComboBox.Value, 5) = Me.Start_Time_Box.Value\n    End With\nEnd Sub\n</code></pre>\n\n<p>Add this function to a Public Code Module so that it will be available to all your userforms.</p>\n\n<pre><code>Sub AddItems(oComboBox As MSForms.ComboBox, ParamArray Items() As Variant)\n    Dim x As Long\n\n    With oComboBox\n        .AddItem Items(0)\n        For x = 1 To UBound(Items)\n            .List(.ListCount - 1, x) = Items(x)\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8797786, "user_type": "registered", "profile_image": "https://graph.facebook.com/1976234989330497/picture?type=large", "display_name": "Conceptic", "link": "https://stackoverflow.com/users/8797786/conceptic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 769, "favorite_count": 1, "accepted_answer_id": 46820911, "answer_count": 1, "score": 0, "last_activity_date": 1508370664, "creation_date": 1508362861, "last_edit_date": 1508363250, "question_id": 46819705, "link": "https://stackoverflow.com/questions/46819705/excel-2013-vba-multiple-userforms-to-fill-out-the-table", "title": "Excel 2013 VBA multiple userforms to fill out the table", "body": "<p>I am working on simple excel application for multiple users who will enter the data during different stages of the process. Unfortunately I met the problems with storage the data from multiple userforms in one row of the table.</p>\n\n<p>I will try to explain what is the whole thing about as clear as I can. </p>\n\n<p>For example purposes I called the application \"Movie Time Control\". Let's imagine that it is a tool for controlling the movies watched with focus on:</p>\n\n<ul>\n<li>when the movie started,  </li>\n<li>if there were some breaks during displaying (and why)</li>\n<li>when the movie has been restarted (how long the break took, and how many breaks there were and what actions were taken to continue),</li>\n<li>in case when the movie was aborted, when, and why? </li>\n<li>when the movie ended.</li>\n</ul>\n\n<p>The MENU of application segment will look as on the screenshot below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sJ916.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sJ916.png\" alt=\"enter image description here\"></a></p>\n\n<p>For each button different userform is assigned. The data entered in each form should be stored in <strong>one row in specific sheet</strong>. </p>\n\n<p><strong>Functionality of the userforms:</strong></p>\n\n<ol>\n<li>MOVIE START: Creating the entry in the table with movie title, date and time when its started.</li>\n<li>MOVIE BREAK: Based on the movie title previously defined, filling out the  date and time, reason of break (from the drop-down list or text box if not standard). The function can be used up to three times (three breaks).</li>\n<li>MOVIE RESTART: If the break occurred, filling out the information about the date, time when movie was restarted, and what action has been taken in order to deal with the previously defined reason of break. For each break (possible three) function can be used.</li>\n<li>MOVIE ABORT When (date and time) movie has been aborted (without intention to continue).</li>\n<li>MOVIE FINISHED When (date and time) movie ended.</li>\n</ol>\n\n<p><strong>Where the problems occurred (questions):</strong> </p>\n\n<ol>\n<li>When the data from the first row are entered, the entry with the specific title is created in the table separate sheet. Based on this entry, Title Combobox in all other userforms should list the titles which were started but not finished or aborted - just to quickly choose the \"open title\" and fill out other information related to the title. <strong>How to create a macro to list the \"open cases\" in the combobox?</strong></li>\n<li>I couldn't find out how to transfer the rest of the data to the same row of the table but different columns from all the forms after creating the entry with the specific movie title. Important thing is that the data can be added only to  row with corresponding title (chosen from combobox from first question). <strong>Could you help me with the macro?</strong></li>\n</ol>\n\n<hr>\n\n<p><strong>Macros</strong> I created until now (I am very beginner with VBA, thanks for understanding): </p>\n\n<p>MOVIE START: For creating the entry with movie title.</p>\n\n<pre><code>Private Sub movie_start_save_Click()\n\nIf MsgBox(\"ARE YOU SURE?\", vbYesNo, \"Please confirm\") = vbYes Then\n\nDim emptyRow As Long\n\n'Make Sheet2 active\nSheet2.Activate\n\n'Determine emptyRow\nemptyRow = WorksheetFunction.CountA(Range(\"A:A\")) + 1\n\n'Transfer information\nCells(emptyRow, 1).Value = Movie_Title_Box.Value\nCells(emptyRow, 2).Value = Start_Date_Box.Value\nCells(emptyRow, 3).Value = Start_Time_Box.Value\n'Closing the form\nUnload Me\n'Back to MENU\nSheet1.Select\nEnd If\nEnd Sub\n\n\nPrivate Sub movie_start_cancel_Click()\n\nUnload Me\n\nEnd Sub\n</code></pre>\n\n<p>MOVIE BREAK: For defining the time and reason (cannot transfer the data):</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n'Fill ReasonComboBox\nWith ReasonComboBox\n    .AddItem \"Tea\"\n    .AddItem \"Coffee\"\n    .AddItem \"Popcorn\"\n    .AddItem \"Dinner\"\n    .AddItem \"Not standard\"\nEnd With\n\n'Default text in the reason box\nReasonTextBox.ForeColor = &amp;HC0C0C0 '&lt;~~ Grey Color\n    ReasonTextBox.Text = \"In case of 'not standard' reason leave your comment here\"\n    movie_break_cancel.SetFocus '&lt;~~ This is required so that the focus moves from TB\n\nEnd Sub\n'Default text in the reason box - disapearing when you want to edit\nPrivate Sub ReasonTextBox_Enter()\n    With ReasonTextBox\n        If .Text = \"In case of 'not standard' reason leave your comment here\" Then\n            .ForeColor = &amp;H80000008 '&lt;~ Black Color\n            .Text = \"\"\n        End If\n    End With\nEnd Sub\n'Default text in the reason box - somehow disappearing for good, but ok\nPrivate Sub ReasonTextBox_AfterUpdate()\n    With ReasonTextBox\n        If .Text = \"\" Then\n            .ForeColor = &amp;H80000008\n            .Text = \"\"\n        End If\n    End With\nEnd Sub\n\n'Cancel Button\nPrivate Sub movie_break_cancel_Click()\n\nUnload Me\n\nEnd Sub\n</code></pre>\n\n<p>The rest is actually similar with a few differences.</p>\n\n<hr>\n\n<p><strong>Link to download the excel file:</strong></p>\n\n<p><a href=\"https://drive.google.com/file/d/0BxFSL2h-9qflQjRzNTQ2ZlhJNjA/view?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/file/d/0BxFSL2h-9qflQjRzNTQ2ZlhJNjA/view?usp=sharing</a></p>\n\n<p>Hopefully I expressed myself clear enough to understand this. \nGreetings!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8615705, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mW2AeNXKGxI/AAAAAAAAAAI/AAAAAAAAARc/aktHBreQEeM/photo.jpg?sz=128", "display_name": "LA_MAR2", "link": "https://stackoverflow.com/users/8615705/la-mar2"}, "edited": false, "score": 0, "creation_date": 1508368592, "post_id": 46819699, "comment_id": 80588691, "body": "This was exactly the issue.  Can you explain further what was wrong with the the original code?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 31, "user_id": 8615705, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mW2AeNXKGxI/AAAAAAAAAAI/AAAAAAAAARc/aktHBreQEeM/photo.jpg?sz=128", "display_name": "LA_MAR2", "link": "https://stackoverflow.com/users/8615705/la-mar2"}, "edited": false, "score": 0, "creation_date": 1508378001, "post_id": 46819699, "comment_id": 80590916, "body": "@MaxHollander See my update. I hope it is clearer now. ;)"}, {"owner": {"reputation": 31, "user_id": 8615705, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mW2AeNXKGxI/AAAAAAAAAAI/AAAAAAAAARc/aktHBreQEeM/photo.jpg?sz=128", "display_name": "LA_MAR2", "link": "https://stackoverflow.com/users/8615705/la-mar2"}, "edited": false, "score": 0, "creation_date": 1508519413, "post_id": 46819699, "comment_id": 80655432, "body": "Do you have much experiance with C++ i have a few questions regarding it  ability etc"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 31, "user_id": 8615705, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mW2AeNXKGxI/AAAAAAAAAAI/AAAAAAAAARc/aktHBreQEeM/photo.jpg?sz=128", "display_name": "LA_MAR2", "link": "https://stackoverflow.com/users/8615705/la-mar2"}, "edited": false, "score": 0, "creation_date": 1508563963, "post_id": 46819699, "comment_id": 80668295, "body": "@LA_MAR2 No, I am not well versed in C++ but you can post your question here and I&#39;m sure there are a lot of gurus here."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 1, "last_activity_date": 1508377908, "last_edit_date": 1508377908, "creation_date": 1508362835, "answer_id": 46819699, "question_id": 46819598, "link": "https://stackoverflow.com/questions/46819598/vba-range-using-a-variable-to-set-a-location/46819699#46819699", "title": "VBA Range using a variable to set a location", "body": "<p>Try this:</p>\n\n<pre><code>n = sh.Range(rn, rn.End(xlToRight)).Columns.Count\n</code></pre>\n\n<p>It follows the <em>Range([Cell1],[Cell2])</em> syntax.<br>\nRemember that <code>rn</code> is already a fully referenced range address so you can use it directly as arguments to <em>Range</em> object. More about <a href=\"https://stackoverflow.com/a/30406676/2685412\">Range Syntax</a>.</p>\n\n<p>Why does your original code fail?</p>\n\n<p>Because based on <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-object-excel\" rel=\"nofollow noreferrer\">this article</a>, in <em>Range(arg)</em> syntax, <em>arg</em> names the range.<br>And take note that <em>Range Object</em>'s default property is <code>Value</code>.<br>\nSo your code:</p>\n\n<pre><code>sh.Range(rn).End(xlToRight)\n</code></pre>\n\n<p>is actually evaluating the value of <code>rn</code> and supplies it as <em>arg</em> for the <em>Range(arg)</em> syntax. If the value of that cell is not a valid cell or range address (or name as the article mentioned), it will throw an error. Above actually evaluates like below:</p>\n\n<pre><code>sh.Range(\"value from rn range object\").End(xlToRight)\n</code></pre>\n\n<p>If you try changing the value of that cell with a valid cell or range name/address, it will work. For example:</p>\n\n<pre><code>With sh\n    Set rn = .Cells(9, 1)\n    rn.Value2 = \"A9\"\n    n = .Range(rn, .Range(rn).End(xlToRight)).Columns.Count\n    MsgBox n\nEnd With\n</code></pre>\n\n<p>In short:</p>\n\n<ol>\n<li><em>Range(arg)</em> expects a valid range name or address.</li>\n<li><em>Range([cell1],[cell2])</em> expects a valid range object reference.</li>\n</ol>\n"}], "owner": {"reputation": 31, "user_id": 8615705, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mW2AeNXKGxI/AAAAAAAAAAI/AAAAAAAAARc/aktHBreQEeM/photo.jpg?sz=128", "display_name": "LA_MAR2", "link": "https://stackoverflow.com/users/8615705/la-mar2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1508490139, "creation_date": 1508362348, "last_edit_date": 1531164843, "question_id": 46819598, "link": "https://stackoverflow.com/questions/46819598/vba-range-using-a-variable-to-set-a-location", "title": "VBA Range using a variable to set a location", "body": "<p>I want to have my program begin a count at a specific location defined by a variable.  I know that you can use <code>rn = sh.Cells(9, 1)</code> for example, and the variable <code>rn</code> is now holding the location of <code>cells(9,1)</code>.  But when I use the variable <code>rn</code> in my count command, I am getting the following error:</p>\n\n<blockquote>\n  <p>Method 'Range' of object' _worksheet' failed </p>\n</blockquote>\n\n<p>Here's my code:</p>\n\n<pre><code>Option Explicit\nSub Struc_Equa()\nDim n As Integer\n\nEnd sub\nSub countN(n)\n\nDim sh As Worksheet\nDim rn As Range\nDim SheNa As String\nSheNa = ActiveSheet.Name\nSet sh = ThisWorkbook.Sheets(SheNa)\n\nSet rn = sh.Cells(9, 1)\n\n' The command below does not work\n'n = sh.Range(rn, sh.Range(rn).End(xlToRight)).Columns.Count\n\n' I am able to do what I want but in a inefficient way (shown below)\n'n = sh.Range(\"A9\", sh.Range(\"A9\").End(xlToRight)).Columns.Count\nrn.Activate\n MsgBox (n)\n\nEnd Sub\n</code></pre>\n\n<p>Why is this error happening?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "edited": false, "score": 0, "creation_date": 1508362094, "post_id": 46819425, "comment_id": 80586517, "body": "Is there any specific reason you don&#39;t use something like frequency?"}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "reply_to_user": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "edited": false, "score": 0, "creation_date": 1508362182, "post_id": 46819425, "comment_id": 80586549, "body": "i m fairly new to vba can always try as long as you can help me get started...."}, {"owner": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "edited": false, "score": 0, "creation_date": 1508362288, "post_id": 46819425, "comment_id": 80586608, "body": "Frequency is a function, so no need for VBA really. You define the buckets/ranges (called bins) and Excel does the heavy lifting. Have a look here: <a href=\"https://support.office.com/en-us/article/FREQUENCY-function-44e3be2b-eca0-42cd-a3f7-fd9ea898fdb9\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "reply_to_user": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "edited": false, "score": 0, "creation_date": 1508362396, "post_id": 46819425, "comment_id": 80586658, "body": "i can check it out, thank you, and i just need to display the results as pivot table and i was doing vba codes since i started with vba on the first half where I did the data manipulation and all the look ups....thats why I figured I should continue using vba codes..."}, {"owner": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "edited": false, "score": 0, "creation_date": 1508362558, "post_id": 46819425, "comment_id": 80586738, "body": "Makes sense, if you have to use a pivot table, I would always define the ranges in the underlying data and then have the pivot display it. But I&#39;ve never been a pivot expert..."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "reply_to_user": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "edited": false, "score": 0, "creation_date": 1508420798, "post_id": 46819425, "comment_id": 80610248, "body": "Thank you again, I have 4 pivot tables I need to manually group by so that is why I was looking for ways to cut down editing time."}], "answers": [{"comments": [{"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1508420149, "post_id": 46821411, "comment_id": 80609760, "body": "Thank you for your input but I think there is a slight difference in the answer since the way we group is differently. Is there a way to fix that? Thanks,"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1508439150, "post_id": 46821411, "comment_id": 80621353, "body": "Can you elaborate further on how you want to group differently? I&#39;m not quite understanding what it is you want."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1508440594, "post_id": 46821411, "comment_id": 80622076, "body": "To clarify, is there a lower bound (-x) at which you want to group numbers below that lower bound together? I understand than numbers above positive 1000 are to be grouped together. What about numbers say below negative 1000?"}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1508445402, "post_id": 46821411, "comment_id": 80624668, "body": "For negative entries, I would hope to get ranges like -$199 - $100, -$99 to -$0 as results so have $99 as ranges, and anything above 0 has been displayed in the picture above. For the lowest bound, I haven&#39;t seen anything that is less than -$1,000. If that is solved, I m still looking for ways to label it correctly since it&#39;s in dollar amount. I hope this helps clarifying some of the questions you have but let me know."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1508451962, "post_id": 46821411, "comment_id": 80627383, "body": "Answer updated to reflect your requirements. Please accept the answer if it answers your question."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1508526974, "post_id": 46821411, "comment_id": 80659200, "body": "Hi just some minor things not sure if you can take a look at it. 1) Formatting like $1,000 instead of $1000 2) for the last entry, we have &gt;$1,000 but I am looking for $1,000 + 3) Right now I am seeing &lt;-$1000 but really there are no entries and anyway to hide it? I did if statements but no luck. 1) &amp; 2) were shown in my results from yesterday so."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 1, "creation_date": 1508528575, "post_id": 46821411, "comment_id": 80659998, "body": "I&#39;ve done amendments 1 and 2 and updated my answer. I don&#39;t understand what you mean by 3, so you&#39;ll have to post a screenshot."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1508528968, "post_id": 46821411, "comment_id": 80660190, "body": "Hello thanks, I got your revision and please see the picture for desired results. I think before if my entry is blank, I just filter out blanks but now it can be any of the pivot item so I want to know if we can filter out if Total Values are 0."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1508530859, "post_id": 46821411, "comment_id": 80661059, "body": "I added my version of filtering but it&#39;s showing $1,000+ and 5 as Total Values and the rest is filtered out...not sure why..."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1508773978, "post_id": 46821411, "comment_id": 80734228, "body": "Thanks, I started another question just for this part so if you have figured out, please go and answer. Thanks again"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1508819590, "post_id": 46821411, "comment_id": 80751208, "body": "Cool...posted an answer at that one two."}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": true, "score": 2, "last_activity_date": 1508528411, "last_edit_date": 1508528411, "creation_date": 1508374965, "answer_id": 46821411, "question_id": 46819425, "link": "https://stackoverflow.com/questions/46819425/grouping-numerical-values-pivot-using-vba/46821411#46821411", "title": "Grouping numerical values pivot using VBA", "body": "<p>You're misinterpreting what the Start and End arguments do. You don't need to know in advance what your smallest and largest numbers are...because the Start and End parameters are the thresholds at which data <em>outside</em> those bounds are grouped together. In other words, if you wanted groupings of 100, and wanted to lump together anything below -1000 together and also lump anything over 1000 together, you would use this:</p>\n\n<pre><code>Set pf = pt.PivotFields(\"Price Difference\")\npf.LabelRange.Group Start:=-999, End:=1000, By:=100\npf.Caption = \"Price Range\"\n</code></pre>\n\n<p>...which would give you these groupings, based on some random data I generated:</p>\n\n<p><a href=\"https://i.stack.imgur.com/E4saY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E4saY.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If you wanted to automatically change the formatting of this so that it <em>appears</em> as currency values, then you need some code that also intelligently adds the $ signs in all the relevant places, like this:</p>\n\n<pre><code>    Sub AmendGroupings()\nDim pt          As PivotTable\nDim pf          As PivotField\nDim pi          As PivotItem\nDim sCaption    As String\n\nConst sDelim = \"to\" 'Change this if you want to use something other than the English word \"to\".\n\nSet pt = ActiveSheet.PivotTables(\"PivotTable1\") '&lt;= Change as appropriate\nSet pf = pt.PivotFields(\"Price Range\") '&lt;= Change as appropriate\n\nApplication.ScreenUpdating = False\n\npf.LabelRange.Group Start:=-1000, End:=1000, By:=100\n\n'Format so that groupings appear as currency values\nFor Each pi In pf.PivotItems\n    sCaption = \"$\" &amp; pi.Caption\n    sCaption = Replace$(sCaption, \"$-\", \"|\")\n    sCaption = Replace$(sCaption, \"-\", \" to $\")\n    sCaption = Replace$(sCaption, \"to $ to $\", \"to -$\")\n    sCaption = Replace$(sCaption, \"|\", \"-$\")\n    sCaption = Replace$(sCaption, \"$&lt; to \", \"&lt;-\")\n    If InStr(sCaption, \"&gt;\") Then sCaption = Replace$(sCaption, \"&gt;\", \"\") &amp; \" +\"\n    'sCaption = Replace$(sCaption, \"to\", sDelim) '&lt;= Uncomment if you want to use a different delimiter\n    sCaption = Replace$(sCaption, \"$1000\", \"$1,000\")\n    pi.Caption = sCaption\nNext pi\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>...which does this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yi0d1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yi0d1.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 599, "favorite_count": 1, "accepted_answer_id": 46821411, "answer_count": 1, "score": 0, "last_activity_date": 1508530795, "creation_date": 1508361538, "last_edit_date": 1508530795, "question_id": 46819425, "link": "https://stackoverflow.com/questions/46819425/grouping-numerical-values-pivot-using-vba", "title": "Grouping numerical values pivot using VBA", "body": "<p>I am doing a price check of the products we sell each week, and each entry represent the price change from last week to this week, so values can be positive or negative.</p>\n\n<p>I am using vba codes to create a pivot table, which will show ranges/groups of prices. Below is the section of my codes that I have currently but not producing the desired results since I can't know what my lowest and highest change in price. For the grouping method, everything up to $999 (from negative number) I would like to group them by $100 and anything above $1000 I would like make it as one group and display it as $1,000 +.</p>\n\n<p>So I need help with custom grouping of numerical values and have pivot to display the ranges like $100-$199 and $1,000 + . First picture is based on my codes and second graph is what I hope to get, I know the total is not the same for both so just get my grouping method. </p>\n\n<p>I am not sure if I can use <code>Case</code> statement or <code>If</code> statements to assign them into ranges. And if I can, how can I modify my codes so I can do this custom grouping.</p>\n\n<pre><code>        'Group by\n        Dim pf As PivotField\n\n        Pvt.RowAxisLayout xlTabularRow\n        Set pf = Pvt.PivotFields(\"$ Premium Difference from Prior Term\")\n        pf.LabelRange.Group Start:=-300, End:=5000, By:=100\n        pf.Caption = \"Price Range\"\n\n\n        'Filter out blanks in row labels\nFor Each pi In pf.PivotItems\nDim LR88, i As Long\n\n    LR88 = PSheet.Cells(Rows.Count, \"B\").End(xlUp).Row\n    For i = 3 To LR88 - 1\n        PSheet.Cells(i, 1).FormulaR1C1 = \"=IF(RC[2]=\"\"\"\",\"\"Hide\"\",\"\"\"\")\"\n        Next i\n\nDim rng, mycell As Range\n    Set rng = Range(\"A:A\" &amp; LR88 - 1)\n        For Each mycell In rng.Cells\n            If mycell = \"Hide\" Then\n                    pi.Visible = False\n            Else\n            pi.Visible = True\n\n            End If\n\n         Next mycell\n         Next pi\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Udqyj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Udqyj.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1508362326, "post_id": 46819340, "comment_id": 80586626, "body": "Are there <b>formulas</b> in the cells or <b>constants</b> entered by hand ??"}, {"owner": {"reputation": 218, "user_id": 8761052, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9d0d4f61ff8005bbd8654b09d3842385?s=128&d=identicon&r=PG&f=1", "display_name": "sharsart", "link": "https://stackoverflow.com/users/8761052/sharsart"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1508415812, "post_id": 46819340, "comment_id": 80606839, "body": "no formula&#39;s just a date in the format of yyyy/mm/dd h:mm:ss"}], "owner": {"reputation": 218, "user_id": 8761052, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9d0d4f61ff8005bbd8654b09d3842385?s=128&d=identicon&r=PG&f=1", "display_name": "sharsart", "link": "https://stackoverflow.com/users/8761052/sharsart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508361212, "creation_date": 1508361212, "question_id": 46819340, "link": "https://stackoverflow.com/questions/46819340/run-macro-if-date-time-values-in-a-column-changes", "title": "Run macro if date time values in a column changes", "body": "<p>I have a date/time column in an excel sheet (yyyy/mm/dd h:mm:ss) that can be updated.  I have several VBA functions I want to run only if any of the date values in this column changes.  </p>\n\n<p>Right I record the dates in another sheet and then compare the two columns.  I was wondering if there is a better way of doing it.  Thanks  </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1508361911, "post_id": 46819095, "comment_id": 80586429, "body": "At the moment, <code>ws</code> is not being used anywhere in the code.  There is no point in <code>Set</code>ting it unless you also suggest a change to the rest of the code to use it (i.e. <code>ws.Range</code>)."}], "tags": [], "owner": {"reputation": 421, "user_id": 5024658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-md8UhJRxd_g/AAAAAAAAAAI/AAAAAAAAhyg/igUflaP6DH4/photo.jpg?sz=128", "display_name": "Liss", "link": "https://stackoverflow.com/users/5024658/liss"}, "is_accepted": false, "score": 0, "last_activity_date": 1508360207, "creation_date": 1508360207, "answer_id": 46819095, "question_id": 46819058, "link": "https://stackoverflow.com/questions/46819058/vba-macro-to-run-on-a-specific-worksheet/46819095#46819095", "title": "VBA Macro to run on a specific worksheet", "body": "<pre><code>Set ws = ThisWorkbook.Worksheets(\"originalNeg\") \n</code></pre>\n\n<p>instead of the if on the name.</p>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1508361640, "post_id": 46819209, "comment_id": 80586276, "body": "<code>Rows.Count</code> ?  Unqualified?!?!?!  Come on, an extra <code>.</code> isn&#39;t too much effort to type."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1508363351, "post_id": 46819209, "comment_id": 80587074, "body": "@YowE3K - I&#39;ve actually been pondering myself - with <code>Rows.Count</code>, wouldn&#39;t it <b>always</b> be the same? I agree that the, hm, where is it? ah, <code>.</code> isn&#39;t that hard to type. But I consciously left it out here to almost bait *someone* to comment, so I could ask. ...So, does <code>Rows.Count</code> unqualified actually matter ever, or slow things down? :D"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1508363576, "post_id": 46819209, "comment_id": 80587160, "body": "Actually, given that you have an unqualified <code>Worksheets</code>, and therefore you are referring to a worksheet in the <code>ActiveWorkbook</code>, which is therefore the same workbook as <code>ActiveSheet</code>, in this case it <b>won&#39;t</b> matter.  But if the active workbook was an <code>xlsx</code> file and the worksheet you were referring to was in a <code>xls</code> file, then <code>ActiveSheet.Rows.Count</code> would be <code>1048576</code> and the sheet being processed would only have <code>65536</code> rows - thus giving a 1004 error.  (And, if the files were the other way around, you might miss row 1000000 being used because you went up from 65536.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1508363669, "post_id": 46819209, "comment_id": 80587194, "body": "I just like always using it so that it doesn&#39;t come back to bite people once they start working on multiple workbooks - get them into the habit from the start and we end up with less questions to answer.  (And, FWIW, I had to ask the same question as you just asked about a year ago, and I think it was Tim or Scott who had to explain it to me.)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1508363918, "post_id": 46819209, "comment_id": 80587294, "body": "@YowE3K - Ohhh, the <code>xlsx</code> vs <code>xls</code> is a great point!  I&#39;ll keep it unqualified here, just to keep these comments on-point, but I&#39;ll qualify my <code>Rows&#47;Columns.Count</code> in the future.  (Also thanks for reminding me to qualify the <code>Worksheets</code>, I edited that in).  Excellent points, cheers! :D"}, {"owner": {"reputation": 35, "user_id": 8429214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/192d03e3f82304f6b83b609e7778e671?s=128&d=identicon&r=PG&f=1", "display_name": "OneaboveAll", "link": "https://stackoverflow.com/users/8429214/oneaboveall"}, "edited": false, "score": 0, "creation_date": 1508444339, "post_id": 46819209, "comment_id": 80624149, "body": "Thanks a lot for your help guys. This is so useful. Would you be able to teach me on how to add an extra code in there so instead of changing those negative values to positive in the same sheet, it can add an extra sheet to the work book, paste the same data but instead of negative values , convert everything to positive. @BruceWayne"}, {"owner": {"reputation": 35, "user_id": 8429214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/192d03e3f82304f6b83b609e7778e671?s=128&d=identicon&r=PG&f=1", "display_name": "OneaboveAll", "link": "https://stackoverflow.com/users/8429214/oneaboveall"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1508444445, "post_id": 46819209, "comment_id": 80624205, "body": "Also if you can help as well that would be much appreciated. Both of you guys are great @YowE3K"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 35, "user_id": 8429214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/192d03e3f82304f6b83b609e7778e671?s=128&d=identicon&r=PG&f=1", "display_name": "OneaboveAll", "link": "https://stackoverflow.com/users/8429214/oneaboveall"}, "edited": false, "score": 1, "creation_date": 1508444665, "post_id": 46819209, "comment_id": 80624322, "body": "@OneaboveAll That should be a new question."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1508363845, "last_edit_date": 1508363845, "creation_date": 1508360619, "answer_id": 46819209, "question_id": 46819058, "link": "https://stackoverflow.com/questions/46819058/vba-macro-to-run-on-a-specific-worksheet/46819209#46819209", "title": "VBA Macro to run on a specific worksheet", "body": "<pre><code>Sub ntp()\nDim ws      As Worksheet\nDim cel     As Range\nWith Activeworkbook.Worksheets(\"originalNeg\")\n    For Each cel In .Range(\"I2:I\" &amp; .Range(\"I\" &amp; Rows.Count).End(xlUp).row)\n        If cel.Value &lt; 0 Then cel.Value = Abs(cel.Value)\n    Next cel\nEnd With\nEnd Sub\n</code></pre>\n\n<p>This uses the worksheet, and note the <code>.</code> before <code>Range()</code> which links the range to that specific sheet.</p>\n\n<p>Also, only rarely would you want to use <em>all</em> cells in a column. I used the <code>.End(xlUp).Row</code> to get the last used row in Column I for you to loop through.</p>\n"}], "owner": {"reputation": 35, "user_id": 8429214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/192d03e3f82304f6b83b609e7778e671?s=128&d=identicon&r=PG&f=1", "display_name": "OneaboveAll", "link": "https://stackoverflow.com/users/8429214/oneaboveall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1442, "favorite_count": 0, "accepted_answer_id": 46819209, "answer_count": 2, "score": 0, "last_activity_date": 1508363845, "creation_date": 1508359992, "last_edit_date": 1531161705, "question_id": 46819058, "link": "https://stackoverflow.com/questions/46819058/vba-macro-to-run-on-a-specific-worksheet", "title": "VBA Macro to run on a specific worksheet", "body": "<p>I am looking to have a macro to run for a specific worksheet only. The purpose of the macro would be to look for a specified range and find negative values and if there is any to extract the whole row into a new worksheet and at the same time transform those negatives to positives. I came up with some but i know for sure that this is totally wrong...missing a lot of stuff. Still trying to learn, new to this vba stuff. Thanks in advance for any help that you can provide. fyi ntp stands for negativestopositives. Not sure if that will help, just thought i can write all the details to my small \"code\" </p>\n\n<pre><code>Sub ntp()\nDim ws As Worksheet\nIf ws.Name &lt;&gt; \"originalNeg\" Then\n    For Each Cell In Range(\"I2:I1048576\")\n        If Cell.Value &lt; 0 Then\n            Cell.Value = Abs(Cell.Value)\n        End If\n    Next Cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1508359682, "post_id": 46818944, "comment_id": 80585301, "body": "Can you re-format the data to match more how Excel is presented? Doing the columns going down makes it tricky to work in Excel with.  Also, how isn&#39;t the current code working? Are there errors? Is it running, but not returning what you expect, etc?"}, {"owner": {"reputation": 1, "user_id": 8797912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125394bdf7f2d9203f8907bfb789dc5b?s=128&d=identicon&r=PG&f=1", "display_name": "Aki Roche", "link": "https://stackoverflow.com/users/8797912/aki-roche"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1508359868, "post_id": 46818944, "comment_id": 80585395, "body": "Sorry, I didn&#39;t know how to write it on the question box. I have the columns and rows formatted the way EXCEL has it. I added the code, changed the grade on a student from the MASTER and nothing changed from the Case Workers tab."}, {"owner": {"reputation": 1, "user_id": 8797912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125394bdf7f2d9203f8907bfb789dc5b?s=128&d=identicon&r=PG&f=1", "display_name": "Aki Roche", "link": "https://stackoverflow.com/users/8797912/aki-roche"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1508360019, "post_id": 46818944, "comment_id": 80585475, "body": "I made a sample file of what it looks like. How do I send it?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1508363344, "creation_date": 1508363344, "answer_id": 46819795, "question_id": 46818944, "link": "https://stackoverflow.com/questions/46818944/master-sheet-to-copy-specific-rows-to-corresponding-sheets/46819795#46819795", "title": "Master Sheet to copy specific rows to corresponding sheets", "body": "<p>The OP says that the worksheets are named after the students' Caseworkers then and the Caseworkers tabs have a list of the students that they track.  So what you actually have to do is search each worksheets for the student's name and then update their class schedule.</p>\n\n<p>Note: This assumes that the student names are listed in column A of the caseworkers' worksheets.</p>\n\n<h2>Batch Students</h2>\n\n<p>If you wanted to process all the students at one time this will work.</p>\n\n<pre><code>Sub ProcessStudents()\n    Application.ScreenUpdating = False\n\n    Const MASTERSHEETNAME As String = \"MASTER SHEET\"\n    Dim cell As Range, ws As Worksheet\n    Dim students As Object\n    Set students = CreateObject(\"Scripting.Dictionary\")\n\n    With ThisWorkbook.Worksheets(MASTERSHEETNAME)\n        For Each cell In .Range(\"A2\", .Range(\"A\" &amp; .Row.Count).End(xlUp))\n            If Not students.Exists(cell.Value) Then students.Add cell.Value, cell.Offset(0, 1).Resize(1, 7).Value\n        Next\n    End With\n\n    For Each ws In ThisWorkbook.Worksheets\n        With ws\n            If UCase(ws.Name) &lt;&gt; UCase(MASTERSHEETNAME) Then\n                For Each cell In .Range(\"A2\", .Range(\"A\" &amp; .Row.Count).End(xlUp))\n                    If students.Exists(cell.Value) Then students.Add cell.Offset(0, 1).Resize(1, 7).Value = students(cell.Value)\n                Next\n            End If\n        End With\n    Next\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<h2>Update using the Worksheet_Change event</h2>\n\n<p>Update as a Student's schedule is being changed.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Application.ScreenUpdating = False\n    If Not Intersect(Target, Range(\"H2\", Range(\"A\" &amp; Row.Count).End(xlUp))) Is Nothing Or Target.Cells.Count &gt; 1 Then Exit Sub\n\n    If Cells(Target.Row, 1) &lt;&gt; \"\" Then ProcessStudent Cells(Target.Row, 1)\n\n    Application.ScreenUpdating = True\nEnd Sub\n\nSub ProcessStudent(Target As Range)\n    Dim cell As Range\n    Dim students As Object\n    Set students = CreateObject(\"System.Collections.ArrayList\")\n\n     For Each ws In ThisWorkbook.Worksheets\n        With ws\n            If ws.Name &lt;&gt; Target.Parent.Name Then\n                Set cell = .Find(What:=FindString, After:=.Cells(.Cells.Count), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\n                If Not cell Is Nothing Then\n                    cell.Resize(1, 8).Value = Target.Resize(1, 8).Value\n                End If\n                Exit For\n            End If\n        End With\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8797912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125394bdf7f2d9203f8907bfb789dc5b?s=128&d=identicon&r=PG&f=1", "display_name": "Aki Roche", "link": "https://stackoverflow.com/users/8797912/aki-roche"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1508363344, "creation_date": 1508359490, "last_edit_date": 1508361371, "question_id": 46818944, "link": "https://stackoverflow.com/questions/46818944/master-sheet-to-copy-specific-rows-to-corresponding-sheets", "title": "Master Sheet to copy specific rows to corresponding sheets", "body": "<p>I have a worksheet on <strong>EXCEL 2013</strong> that has a <strong>MASTER SHEET</strong> with all of the students names and grades. I have created a table with the students <strong>names</strong> are on <strong>Column A</strong> and their <strong>Period (class)</strong> is on <strong>Columns B-H</strong>. I have sheets with the <strong>Case Workers name labeled on the bottom tab and their list of students they track in their sheet.</strong> </p>\n\n<p><em>Here is a sample code someone gave me that didn't work:</em> </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nIf Intersect(Target, Columns(\"A:A\")) Is Nothing Then Exit Sub\nTarget.EntireRow.Copy Sheets(Target.Value).Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\n\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong><em>Here is a sample of my worksheet:</em></strong></p>\n\n<p><strong>MASTER SHEET TAB</strong></p>\n\n<pre><code>Column A row 1: Name \nColumn B row 1: Period 1\nColumn C row 1: Period 2\nColumn D row 1: Period 3\nColumn E row 1: Period 4\nColumn F row 1: Period 5\nColumn G row 1: Period 6\nColumn H row 1: 7\n\nColumn A row 2: Skywalker, Luke (example)\nColumn B row 2: F1, GUITAR\nColumn C row 2: C, HEALTH\nColumn D row 2: B, GEOMETRY\nColumn E row 2: A, YR1 ALGEBRA1\nColumn F row 2: C+, US HISTORY\nColumn G row 2: B, ENGLISH\nColumn H row 2: (BLANK)\n</code></pre>\n\n<p><strong>ELIZABETH (SHEET)</strong></p>\n\n<p>Same as above format.</p>\n\n<p>Copy student from master sheet to corresponding name on sheet.</p>\n\n<hr>\n\n<p>This may be easier adding information from the separate sheets and consolidate them to the master.</p>\n"}, {"tags": ["html", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1508359548, "post_id": 46818807, "comment_id": 80585235, "body": "&quot;answers 1 and 4&quot; - the sorting depends on who&#39;s viewing them and how they&#39;re sorting answers. &quot;1 and 4&quot; means pretty much nothing. If you mean to link to specific SO posts, use the appropriate [share] links under each."}, {"owner": {"reputation": 428, "user_id": 492526, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/eaf9ab68aca7021a0bee6762cb19aa99?s=128&d=identicon&r=PG", "display_name": "RobertSF", "link": "https://stackoverflow.com/users/492526/robertsf"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1508363824, "post_id": 46818807, "comment_id": 80587254, "body": "@Mat&#39;sMug Thanks. I didn&#39;t know that. I did link to a specific SO post, and I included the code snippets from the answers, so I&#39;ll edit the question."}], "answers": [{"comments": [{"owner": {"reputation": 428, "user_id": 492526, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/eaf9ab68aca7021a0bee6762cb19aa99?s=128&d=identicon&r=PG", "display_name": "RobertSF", "link": "https://stackoverflow.com/users/492526/robertsf"}, "edited": false, "score": 0, "creation_date": 1508380129, "post_id": 46821806, "comment_id": 80591390, "body": "Thank you! The trick seems to be not using <code>.Open</code>. Then the object will work as a HTML -&gt; text converter.  To clarify, I know about <code>with</code>. What I don&#39;t understand is why <code>&quot;htmlfile&quot;</code> is a valid object name. I thought the argument to <code>CreateObject</code> had to be the name of an object that VBA knows about, but I don&#39;t find it with the object browser."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 428, "user_id": 492526, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/eaf9ab68aca7021a0bee6762cb19aa99?s=128&d=identicon&r=PG", "display_name": "RobertSF", "link": "https://stackoverflow.com/users/492526/robertsf"}, "edited": false, "score": 1, "creation_date": 1508382478, "post_id": 46821806, "comment_id": 80591933, "body": "found it ... it is a windows COM object, so windows knows about it .... and by default, so does VBA (i think) ... some info here <a href=\"https://autohotkey.com/board/topic/56987-com-object-reference-autohotkey-v11/\" rel=\"nofollow noreferrer\">autohotkey.com/board/topic/&hellip;</a>    .......... probably would work for any registered dll file"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1598225388, "post_id": 46821806, "comment_id": 112380381, "body": "They are not equivalent if the HTML string you are trying to pass has a &quot;head&quot; section. If you pass such string to <code>body.innerHTML</code>, the head part won&#39;t be added to the HTMLDocument object."}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": true, "score": 1, "last_activity_date": 1508379058, "last_edit_date": 1508379058, "creation_date": 1508378454, "answer_id": 46821806, "question_id": 46818807, "link": "https://stackoverflow.com/questions/46818807/how-to-fix-this-early-binding-failure/46821806#46821806", "title": "How to fix this early binding failure?", "body": "<p>these two are equivalent, i think</p>\n\n<pre><code>Option Explicit\n\nSub Macro1()\n\n    Dim aaa As Object\n    Set aaa = CreateObject(\"htmlfile\")\n    aaa.Open\n    aaa.write \"&lt;p&gt;foo &lt;i&gt;bar&lt;/i&gt; &lt;u class='farp'&gt;argle &lt;/zzzz&gt; hello &lt;/p&gt;\"\n    aaa.Close\n    Debug.Print \"text=\" &amp; aaa.body.outerText\n\n' ---------------------------------------------------\n\n    Dim bbb As New HTMLDocument\n    bbb.body.innerHTML = \"&lt;p&gt;foo &lt;i&gt;bar&lt;/i&gt; &lt;u class='farp'&gt;argle &lt;/zzzz&gt; hello &lt;/p&gt;\"\n    Debug.Print \"text=\" &amp; bbb.body.outerText\n\nEnd Sub\n</code></pre>\n\n<p>your question about <code>CreateObject(\"htmlfile\")</code> should read <em>\"why does <code>With CreateObject(\"htmlfile\")</code> work...\"</em></p>\n\n<p>the <code>with</code> command creates an temporary, unnamed object (it is similar to the lambda function that is used in some languages)</p>\n\n<p>if you need to examine it, then use a set command to create a variable that references it</p>\n"}], "owner": {"reputation": 428, "user_id": 492526, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/eaf9ab68aca7021a0bee6762cb19aa99?s=128&d=identicon&r=PG", "display_name": "RobertSF", "link": "https://stackoverflow.com/users/492526/robertsf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 1, "accepted_answer_id": 46821806, "answer_count": 1, "score": 1, "last_activity_date": 1508379058, "creation_date": 1508358909, "last_edit_date": 1508363837, "question_id": 46818807, "link": "https://stackoverflow.com/questions/46818807/how-to-fix-this-early-binding-failure", "title": "How to fix this early binding failure?", "body": "<p>I'm trying to strip HTML from a string and found <a href=\"https://stackoverflow.com/questions/12804067/stripping-html-from-a-string/12815487\">two methods in this SO thread</a>.</p>\n\n<p>The code for the first answer works but uses late binding.</p>\n\n<pre><code>With CreateObject(\"htmlfile\")\n    .Open\n    .write \"&lt;p&gt;foo &lt;i&gt;bar&lt;/i&gt; &lt;u class='farp'&gt;argle &lt;/zzzz&gt; hello &lt;/p&gt;\"\n    .Close\n    MsgBox \"text=\" &amp; .body.outerText\nEnd With\n</code></pre>\n\n<p>The code for the alternative answer, which uses early binding, gives a compile error (\"Function or interface marked as restricted, or the function uses an Automation type not supported in Visual Basic\"). </p>\n\n<pre><code>Public Function StripHtml(inputHtml As String) As String\n    With New HTMLDocument\n        .Open\n        'Following line gives compile error\n        .write \"&lt;p&gt;foo &lt;i&gt;bar&lt;/i&gt; &lt;u class='farp'&gt;argle &lt;/zzzz&gt; hello &lt;/p&gt;\"\n        .Close\n       StripHtml = .body.outerText\n    End With\nEnd Function\n</code></pre>\n\n<p>My questions:</p>\n\n<ol>\n<li>Is the alternative answer simply not the equivalent?</li>\n<li>Is there an early binding equivalent to the first answer, which works?</li>\n<li>Why does <code>CreateObject(\"htmlfile\")</code> work at all when I cannot find that object type in the object browser?</li>\n</ol>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013", "dcount"], "answers": [{"comments": [{"owner": {"reputation": 454, "user_id": 7619285, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bbc9b3a13af2220617a51c1d4c82432?s=128&d=identicon&r=PG&f=1", "display_name": "IcyPopTarts", "link": "https://stackoverflow.com/users/7619285/icypoptarts"}, "edited": false, "score": 0, "creation_date": 1508358345, "post_id": 46818636, "comment_id": 80584619, "body": "That gives me a compile error - expected expression error"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 454, "user_id": 7619285, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bbc9b3a13af2220617a51c1d4c82432?s=128&d=identicon&r=PG&f=1", "display_name": "IcyPopTarts", "link": "https://stackoverflow.com/users/7619285/icypoptarts"}, "edited": false, "score": 0, "creation_date": 1508358445, "post_id": 46818636, "comment_id": 80584674, "body": "I was missing a double quote."}, {"owner": {"reputation": 454, "user_id": 7619285, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bbc9b3a13af2220617a51c1d4c82432?s=128&d=identicon&r=PG&f=1", "display_name": "IcyPopTarts", "link": "https://stackoverflow.com/users/7619285/icypoptarts"}, "edited": false, "score": 0, "creation_date": 1508358491, "post_id": 46818636, "comment_id": 80584696, "body": "When I step through the code and I use a Debug.Print ReturnedCount it is Empty - and if it matters CountOfItems is a Number and NameOfItem is a shortttext"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 454, "user_id": 7619285, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bbc9b3a13af2220617a51c1d4c82432?s=128&d=identicon&r=PG&f=1", "display_name": "IcyPopTarts", "link": "https://stackoverflow.com/users/7619285/icypoptarts"}, "edited": false, "score": 0, "creation_date": 1508359602, "post_id": 46818636, "comment_id": 80585258, "body": "<code>DCount</code> will return 0 but never returns empty.  Likewise if <code>ReturnedCount</code>  was properly typed (e.g. Dim ReturnedCount As Long) then it would not return empty."}, {"owner": {"reputation": 454, "user_id": 7619285, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bbc9b3a13af2220617a51c1d4c82432?s=128&d=identicon&r=PG&f=1", "display_name": "IcyPopTarts", "link": "https://stackoverflow.com/users/7619285/icypoptarts"}, "edited": false, "score": 0, "creation_date": 1508360016, "post_id": 46818636, "comment_id": 80585472, "body": "Is there a way to have it return 0 if NULL?  And turns out DSUM() is what I was after as well ,not the DCount()"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 454, "user_id": 7619285, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bbc9b3a13af2220617a51c1d4c82432?s=128&d=identicon&r=PG&f=1", "display_name": "IcyPopTarts", "link": "https://stackoverflow.com/users/7619285/icypoptarts"}, "edited": false, "score": 0, "creation_date": 1508360494, "post_id": 46818636, "comment_id": 80585678, "body": "I don&#39;t think that the D-Functions can return null.  In any case, <a href=\"https://msdn.microsoft.com/en-us/library/office/aa172237(v=office.11).aspx\" rel=\"nofollow noreferrer\">Nz Function</a> is used in Access to return a differenct value when null.  (e.g. NZ(Value,0) returns 0 if Value is null)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1508359452, "last_edit_date": 1508359452, "creation_date": 1508358233, "answer_id": 46818636, "question_id": 46818553, "link": "https://stackoverflow.com/questions/46818553/dcount-in-vba-always-returning-a-null-value/46818636#46818636", "title": "DCount() In VBA Always Returning A Null Value", "body": "<p><code>NameOfItem</code> implies a string.  You need to wrap strings in single quotes when passing them as a parameter to a D-Function; just like passing them as a parameter in a Query.</p>\n\n<blockquote>\n  <p>ReturnedCount = DCount(\"CountOfItems\", \"[__TestTable]\", \"NameOfItem = '\" &amp; ItemName &amp; \"'\")</p>\n</blockquote>\n\n<p>Using the immediate window to test your D-Functions will simplify debugging.</p>\n\n<p><a href=\"https://i.stack.imgur.com/VxUZ7.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VxUZ7.gif\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 454, "user_id": 7619285, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bbc9b3a13af2220617a51c1d4c82432?s=128&d=identicon&r=PG&f=1", "display_name": "IcyPopTarts", "link": "https://stackoverflow.com/users/7619285/icypoptarts"}, "edited": false, "score": 1, "creation_date": 1508398168, "post_id": 46818868, "comment_id": 80596860, "body": "That is not possible, except if you have error handling. Remove that - see edit."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1508398192, "last_edit_date": 1508398192, "creation_date": 1508359164, "answer_id": 46818868, "question_id": 46818553, "link": "https://stackoverflow.com/questions/46818553/dcount-in-vba-always-returning-a-null-value/46818868#46818868", "title": "DCount() In VBA Always Returning A Null Value", "body": "<p>You should use:</p>\n\n<pre><code>On Error Goto 0\nReturnedCount = DCount(\"*\", \"[__TestTable]\", \"NameOfItem = '\" &amp; ItemName &amp; \"'\")\n</code></pre>\n\n<p>It will at least return 0 (zero) ... if the table and field names are correct.</p>\n"}], "owner": {"reputation": 454, "user_id": 7619285, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bbc9b3a13af2220617a51c1d4c82432?s=128&d=identicon&r=PG&f=1", "display_name": "IcyPopTarts", "link": "https://stackoverflow.com/users/7619285/icypoptarts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 0, "accepted_answer_id": 46818636, "answer_count": 2, "score": 0, "last_activity_date": 1594638943, "creation_date": 1508357910, "last_edit_date": 1594638943, "question_id": 46818553, "link": "https://stackoverflow.com/questions/46818553/dcount-in-vba-always-returning-a-null-value", "title": "DCount() In VBA Always Returning A Null Value", "body": "<p>I am attempting to use the DCount() Function to return a count from my table.  My issue is that it always returns a NULL value.</p>\n\n<p>How should I Re-write this VBA statement so that it returns the accurate count?</p>\n\n<pre><code>ReturnedCount = DCount(\"CountOfItems\", \"[__TestTable]\", \"NameOfItem = \" &amp; ItemName)\nDebug.Print ReturnedCount\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1508378616, "post_id": 46818477, "comment_id": 80591046, "body": "Why are you running an update query on a workbook? Just use Excel processes."}, {"owner": {"reputation": 118, "user_id": 3242046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc8befc7bdb0a3a6fed0c4f9beb8685?s=128&d=identicon&r=PG&f=1", "display_name": "Dman", "link": "https://stackoverflow.com/users/3242046/dman"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1508416835, "post_id": 46818477, "comment_id": 80607456, "body": "Hi Parfait, thanks for the response, I was doing that originally, however this portion is just a smaller portion of the overall code and doing it using a loop or excel function takes forever, since we are dealing with a large data set (unless I am misunderstanding what you mean by &#39;excel processes&#39;). From other portions of the code I have switched to queries I have cut the processing time down by quite a bit, which is why I would have proffered to use Access for this project, but I can&#39;t."}, {"owner": {"reputation": 118, "user_id": 3242046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc8befc7bdb0a3a6fed0c4f9beb8685?s=128&d=identicon&r=PG&f=1", "display_name": "Dman", "link": "https://stackoverflow.com/users/3242046/dman"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1508416837, "post_id": 46818477, "comment_id": 80607458, "body": "I did however find out what is causing it, i have another update statement which runs before this one and I think it is causing some kind of lock because if i don&#39;t run that statement, the statement above runs just fine."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1508419786, "post_id": 46818477, "comment_id": 80609481, "body": "Try closing the <code>db</code> object or releasing it: <code>Set db = Nothing</code>. And yes, you should use MS Access, a better multiple user application and automation environment. Have that sit down with the boss!"}, {"owner": {"reputation": 118, "user_id": 3242046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc8befc7bdb0a3a6fed0c4f9beb8685?s=128&d=identicon&r=PG&f=1", "display_name": "Dman", "link": "https://stackoverflow.com/users/3242046/dman"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1508424957, "post_id": 46818477, "comment_id": 80613218, "body": "Thanks Parfait, I have tried closing it and set it to nothing and then reopening it already, still no luck. Also now it will only run the SQL statement without error sometimes, its hit and miss. Time for that sit down I think :)"}], "owner": {"reputation": 118, "user_id": 3242046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc8befc7bdb0a3a6fed0c4f9beb8685?s=128&d=identicon&r=PG&f=1", "display_name": "Dman", "link": "https://stackoverflow.com/users/3242046/dman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 461, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1508362143, "creation_date": 1508357647, "last_edit_date": 1508362143, "question_id": 46818477, "link": "https://stackoverflow.com/questions/46818477/running-update-query-with-excel-vba-update-error", "title": "Running update query with excel VBA - update error", "body": "<p>I am trying to run an update query on an excel worksheet using the following code:</p>\n\n<pre><code>With db\n    .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    .ConnectionString = \"Data Source='\" &amp; ThisWorkbook.FullName &amp; \"'; \" &amp; \"Extended Properties='Excel 12.0;HDR=YES'\"\n    .Mode = adModeReadWrite\n    .Open\nEnd With\n\nsql_str = \"UPDATE [unload_data$] INNER JOIN [action_combos$] ON [unload_data$].action = [action_combos$].action1 \" &amp; _\n        \"AND [unload_data$].pick_ticket = [action_combos$].pick_ticket SET [unload_data$].conflict = [action_combos$].invalid \"\n\ndb.Execute (sql_str)\n</code></pre>\n\n<p>However I get the following error:</p>\n\n<pre><code>Run-time error '-2147467259 (80004005)':\nThe Microsoft Access database engine stopped the process because you and \nanother user are attempting to change the same data at the same time\n</code></pre>\n\n<p>Now if I hard code a value in the SQL statement for <code>[unload_data$].conflict</code>  it works fine, but it won't update with the value from the field in the joint table. I have looked around online but so far haven't come up with any answer. </p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1508357461, "post_id": 46818393, "comment_id": 80584185, "body": "Thats not VB.NET code."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1508357987, "post_id": 46818393, "comment_id": 80584435, "body": "Two out of two tags incorrect - not bad!!  (Fixed)"}, {"owner": {"reputation": 31, "user_id": 8724105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oKuI9.jpg?s=128&g=1", "display_name": "Malik Draz", "link": "https://stackoverflow.com/users/8724105/malik-draz"}, "edited": false, "score": 0, "creation_date": 1508358104, "post_id": 46818393, "comment_id": 80584489, "body": "What do you mean? Can you please explain it to me a bit?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1508358265, "post_id": 46818393, "comment_id": 80584571, "body": "The type of &quot;Visual Basic&quot; within MS Access is &quot;Visual Basic for Applications&quot;.  &quot;VB.Net&quot; is an entirely different thing.  And the [access] tag you used has a description of &quot;DO NOT USE this tag for Microsoft Access, use [ms-access] instead. In computer security, general access control includes identification, authorization, authentication, access approval, and audit.&quot;, so is referring to something completely different to your question."}, {"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 0, "creation_date": 1508358603, "post_id": 46818393, "comment_id": 80584765, "body": "It would also be helpful if you would explain the minor errors. Do you have compiler errors or does the code not behave as expected when it is run?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1508358623, "post_id": 46818393, "comment_id": 80584783, "body": "Please also edit the question to explain what the &quot;minor errors&quot; are, so that we don&#39;t have to guess.  (My first guess is the line continuation issues, my second guess is a subcript out of range error on <code>CustomerName = CustomerName(num)</code> after setting <code>num</code> using <code>num = Int((200 - 0 + 1) * Rnd + 0)</code>.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1508358799, "post_id": 46818393, "comment_id": 80584887, "body": "And my third guess is that your <code>[CustomerID]</code> field is not actually <code>&quot;Short Text&quot;</code>.  (It&#39;s strange to use a short text data type for an ID that starts off being a number, generated sequentially.)"}, {"owner": {"reputation": 31, "user_id": 8724105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oKuI9.jpg?s=128&g=1", "display_name": "Malik Draz", "link": "https://stackoverflow.com/users/8724105/malik-draz"}, "edited": false, "score": 0, "creation_date": 1508358911, "post_id": 46818393, "comment_id": 80584938, "body": "<a href=\"http://prntscr.com/gz3ulz\" rel=\"nofollow noreferrer\">prntscr.com/gz3ulz</a> This is the error I&#39;m getting"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1508359044, "post_id": 46818393, "comment_id": 80584993, "body": "Please edit the question if you have an image to include - that way it will be stored with the question itself, and not on a 3rd party website which may delete it in a couple of years time.  (Or just include the text of the error message in the question, and tell us which line the error occurs on.)"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1508359193, "post_id": 46818857, "comment_id": 80585068, "body": "That&#39;s why I insisted that the OP post the actual code - the revised version shows that there are no line continuations, so no line continuation characters needed."}, {"owner": {"reputation": 31, "user_id": 8724105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oKuI9.jpg?s=128&g=1", "display_name": "Malik Draz", "link": "https://stackoverflow.com/users/8724105/malik-draz"}, "edited": false, "score": 0, "creation_date": 1508359331, "post_id": 46818857, "comment_id": 80585129, "body": "I&#39;m using everything in one single line. I don&#39;t think so it is a problem. Check the screenshot which I&#39;ve given in comments. Anyway thanks for answering."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 31, "user_id": 8724105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oKuI9.jpg?s=128&g=1", "display_name": "Malik Draz", "link": "https://stackoverflow.com/users/8724105/malik-draz"}, "edited": false, "score": 0, "creation_date": 1508359622, "post_id": 46818857, "comment_id": 80585271, "body": "Well spotted on the <code>CustomerName</code>!!  My eyes didn&#39;t notice that one.  @MalikDraz <b>Please</b> edit your question to say what the &quot;minor errors&quot; are."}], "tags": [], "owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "is_accepted": false, "score": 0, "last_activity_date": 1508360219, "last_edit_date": 1508360219, "creation_date": 1508359123, "answer_id": 46818857, "question_id": 46818393, "link": "https://stackoverflow.com/questions/46818393/multiple-record-insertion-in-microsoft-access-through-vb/46818857#46818857", "title": "Multiple Record Insertion in Microsoft Access through VB", "body": "<p>The language you are using is \"Visual Basic for Applications\" (VBA). This language is line-oriented. It menas that one statement must fit on one single line, unless you are using a line continuation character (<code>_</code>) preceeded by at least one whitespace.</p>\n\n<pre><code>Dim CustomerID As Long, num1 As Long, CustomerName As String, CustomerAddress _\n    As String, CustomerPhoneNo As String\n</code></pre>\n\n<p>But I would place the <code>Long</code> and <code>String</code> variables on separate lines and write:</p>\n\n<pre><code>Dim CustomerID As Long, num1 As Long\nDim CustomerName As String, CustomerAddress As String, CustomerPhoneNo As String\n</code></pre>\n\n<p>The second syntax error is in the <code>InsertRecord = \"INSERT INTO ...</code> statement. same problem here. It shoul look like this:</p>\n\n<pre><code>    InsertRecord = \"INSERT INTO CUSTOMERS (CustomerID,CustomerName,\" _\n        &amp; \"CustomerAddress,CustomerPhoneNo) VALUES \" _\n        &amp; \"(\" &amp; \"'\" &amp; CustomerID &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; CustomerName &amp; \"'\" &amp; \",\" &amp; \"'\" _\n        &amp; CustomerAddress &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; CustomerPhoneNo &amp; \"'\" &amp; \")\"\n</code></pre>\n\n<hr>\n\n<p>Also, what are the <code>- 0</code> and <code>+ 0</code> good for in <code>Int((200 - 0 + 1) * Rnd + 0)</code>. The expression is equivalent to <code>Int(201 * Rnd)</code>.</p>\n\n<hr>\n\n<p>After your edits it seems that you have no line continuations.</p>\n\n<p>THE ERROR IS: You have 2 variables named <code>CustomerName</code>. Variable names must be unique:</p>\n\n<pre><code>Dim CustomerName() As Variant\nDim CustomerName As String\n</code></pre>\n\n<p>For instance, name the array <code>CustomerNames</code>:</p>\n\n<pre><code>Dim CustomerNames() As Variant\n</code></pre>\n\n<hr>\n\n<p>And you should indent your code. It makes it much easier to read.</p>\n\n<pre><code>Sub arrayData()\n    Dim CustomerName() As Variant\n    ...\n    CustomerID = 0\n    For num1 = 0 To 10\n        CustomerID = CustomerID + 1\n        ...\n        Debug.Print CustomerID, CustomerName, CustomerAddress, CustomerPhoneNo\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8724105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oKuI9.jpg?s=128&g=1", "display_name": "Malik Draz", "link": "https://stackoverflow.com/users/8724105/malik-draz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1508360219, "creation_date": 1508357277, "last_edit_date": 1508359855, "question_id": 46818393, "link": "https://stackoverflow.com/questions/46818393/multiple-record-insertion-in-microsoft-access-through-vb", "title": "Multiple Record Insertion in Microsoft Access through VB", "body": "<p>I've created DB within Access and given Data Type \"Short Text.\" </p>\n\n<p>Now I'm trying to prompt record into this table through Visual Basic. I wrote a code so far but need help to fix an error. I'm getting the compile error:</p>\n\n<blockquote>\n  <p>Duplicate declaration in current scope</p>\n</blockquote>\n\n<p>I can't figure it out what it is?</p>\n\n<pre><code>Option Compare Database\n\nSub arrayData()\n\nDim CustomerName() As Variant \nDim num As Integer, dbs As Database, InsertRecord As String\nDim CustomerID As Long, num1 As Long, CustomerName As String\n\nSet dbs = CurrentDb() \nCustomerID = 0\nFor num1 = 0 To 49999\n\nCustomerID = CustomerID + 1\nCustomerName = Array(\"Peter\", \"Mary\")\nCustomerAddress = Array(\"163 City Rd, SOUTHBANK\", \"65 Orange St, BENTLEIGH EAST\")\nCustomerPhoneAddress = Array(\"0416874963\", \"0478937534\")\nnum = Int((200 - 0 + 1) * Rnd + 0)\nCustomerName = CustomerName(num)\nCustomerAddress = CustomerAddress(num)\nCustomerPhoneNo = CustomerPhoneNo(num)\nInsertRecord = \"INSERT INTO Customers (CustomerID,CustomerName,CustomerAddress,CustomerPhoneNo) VALUES (\" &amp; \"'\" &amp; CustomerID &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; CustomerName &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; CustomerAddress &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; CustomerPhoneNo &amp; \"'\" &amp; \")\"\n\ndbs.Execute InsertRecord\nDebug.Print CustomerID, CustomerName, CustomerAddress, CustomerPhoneNo\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p>What can I do in this situation? Any help would be appreciated. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1508357521, "post_id": 46818344, "comment_id": 80584221, "body": "No need to select/activate: e.g. <code>strTemp = cell.Formula</code>, <code>cell.Clear</code>, <code>cell.resize(2,1).merge</code>"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1508357524, "post_id": 46818344, "comment_id": 80584224, "body": "Use VBA to select the active cell and the neighboring cell you want to merge with.  Then the code is Selection.MergeCells = True."}, {"owner": {"reputation": 13, "user_id": 8761766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70ec428855c1a56174cf016ad068c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "toupenator", "link": "https://stackoverflow.com/users/8761766/toupenator"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1508358029, "post_id": 46818344, "comment_id": 80584458, "body": "@TimWilliams Everything seems to be working fine until i get to the cell.Resize([2,1]).Merge line where I get a Run-time error&#39;1004&#39;: Application-defined or object-defined error"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 13, "user_id": 8761766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70ec428855c1a56174cf016ad068c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "toupenator", "link": "https://stackoverflow.com/users/8761766/toupenator"}, "edited": false, "score": 0, "creation_date": 1508358824, "post_id": 46818526, "comment_id": 80584895, "body": "Great, so glad it helped you!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": true, "score": 1, "last_activity_date": 1508357816, "creation_date": 1508357816, "answer_id": 46818526, "question_id": 46818344, "link": "https://stackoverflow.com/questions/46818344/having-trouble-merging-cells-in-vba/46818526#46818526", "title": "Having trouble merging cells in VBA", "body": "<p>Try using:</p>\n\n<pre><code>Range(Cells(ActiveCell.Row, ActiveCell.Column), Cells(ActiveCell.Row + 1, ActiveCell.Column)).Merge\n</code></pre>\n\n<p>Hope it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1508390238, "creation_date": 1508390238, "answer_id": 46823228, "question_id": 46818344, "link": "https://stackoverflow.com/questions/46818344/having-trouble-merging-cells-in-vba/46823228#46823228", "title": "Having trouble merging cells in VBA", "body": "<p>Something like this.  Note you rarely need select/activate and should try to avoid it as much as possible.</p>\n\n<pre><code>Private Sub CommandButton22_Click()\n\n    Dim cell As Range\n\n    For Each cell In Range(\"H87:H89\").Cells\n        If cell.HasFormula Then\n            If IsError(cell.Value) Then\n                cell.Clear\n                cell.Resize(2, 1).Merge\n            End If\n        End If\n    Next cell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8761766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70ec428855c1a56174cf016ad068c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "toupenator", "link": "https://stackoverflow.com/users/8761766/toupenator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 46818526, "answer_count": 2, "score": 1, "last_activity_date": 1508390238, "creation_date": 1508357107, "question_id": 46818344, "link": "https://stackoverflow.com/questions/46818344/having-trouble-merging-cells-in-vba", "title": "Having trouble merging cells in VBA", "body": "<p>So I'm writing some VBA code that goes through my document and looks for where a formula returns an error and it merges and centers it with the cell that's underneath it.</p>\n\n<pre><code>Private Sub CommandButton22_Click()\n     Dim strTemp As String\n     Dim ev As Variant\n     Dim rng As Range, cell As Range\n     Set rng = Range(\"H87:H89\")\n\n\nFor Each cell In rng\n    If (cell.HasFormula) Then\n        cell.Select\n\n        strTemp = ActiveCell.Formula\n        ev = Evaluate(strTemp)\n\n        If (IsError(ev)) Then\n            ActiveCell.Clear\n            ActiveCell.Merge ([0,1])\n\n        End If\n    End If\nNext cell\nEnd Sub\n</code></pre>\n\n<p>This is what I have so far, it clears the cell properly but won't merge.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1508369145, "post_id": 46818227, "comment_id": 80588834, "body": "How about concatenating the content of the 2 columns, using a formula, and referring to the range covering those formulas?"}, {"owner": {"reputation": 1295, "user_id": 4360863, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/heWif.png?s=128&g=1", "display_name": "Philip Brack", "link": "https://stackoverflow.com/users/4360863/philip-brack"}, "reply_to_user": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1508369787, "post_id": 46818227, "comment_id": 80588987, "body": "I came up with this <code>Formula1:=&quot;=Sheet1!A1&amp;Sheet1!B1&quot;</code> based on your suggestion but realized it doesn&#39;t yield a range but a value. Can a formula be constructed to yield a range of values based on calculation?  I am wondering if building an array (or some intermediate data structure) is the only way."}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 1, "creation_date": 1508370753, "post_id": 46818227, "comment_id": 80589236, "body": "Compute the values on the worksheet, then refer to those computed values. Example: A1 and A2 contain &quot;Hello&quot; and B1 and B2 contain &quot;World&quot;. Put formula <code>=A1&amp;&quot; &quot;&amp;B1</code> into C1 and pull it down to C2. Finally, make subRange point to C1:C2."}, {"owner": {"reputation": 1295, "user_id": 4360863, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/heWif.png?s=128&g=1", "display_name": "Philip Brack", "link": "https://stackoverflow.com/users/4360863/philip-brack"}, "reply_to_user": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1508370896, "post_id": 46818227, "comment_id": 80589271, "body": "That would def do the trick and in my case it would suffice because as I mentioned Sheet1 is not really for the user to understand.  Thank you @Excelosaurus for being a sound board. I can definately implement that for now. I would still be interested if there is an elegant solution without this."}], "owner": {"reputation": 1295, "user_id": 4360863, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/heWif.png?s=128&g=1", "display_name": "Philip Brack", "link": "https://stackoverflow.com/users/4360863/philip-brack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 334, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508356643, "creation_date": 1508356643, "last_edit_date": 1531164843, "question_id": 46818227, "link": "https://stackoverflow.com/questions/46818227/vba-validation-xlvalidatelist-for-item-is-string-concat-of-value-from-2-columns", "title": "VBA Validation xlValidateList for item is string concat of value from 2 columns in row", "body": "<p>Currently I have the following code to identify a valid list of values for a particular range in Sheet2 by specifying a range in Sheet1.  Note Sheet 1 is sort've like a database of things and Sheet2 is sort've like a form.</p>\n\n<pre><code>Set subRange = Worksheets(\"Sheet1\").Range(\"A2:A14\")\nWith Worksheets(\"Sheet2\").Range(\"D6:D517\").Validation\n        .Delete\n        .Add Type:=xlValidateList, Formula1:=\"='Sheet1'!\" &amp; subRange.Address\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .ErrorTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = True\n        .ShowError = True\n    End With\n</code></pre>\n\n<p>Next I would like to update my Validation such that the same range in Sheet2 is confined to a list where each entry is a string concat of two columns in same row of Sheet1. Let a given row in Sheet1 be \"r\", I would like the item in the validation list to be</p>\n\n<pre><code>' a concat of columns A and D infer the list entry\nWorksheets(\"Sheet1\").Cells(r,1).Value &amp; Worksheets(\"Sheet1\").Cells(r,4).Value\n</code></pre>\n\n<p>I plan to use arrays to build up this confined list with a for loop over the rows in Sheet1 but I was wondering if there was a better way to setup this Validation restriction. This seems like this is a fairly common action.</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1508356805, "post_id": 46818170, "comment_id": 80583864, "body": "Well, you could at least start with providing sample data and expected output, so we can actually see things like how your table is structured, what you expect to happen if week number is not the same, etc."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1508357189, "post_id": 46818170, "comment_id": 80584052, "body": "A query <i>against what data</i> ?"}, {"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 0, "creation_date": 1508357200, "post_id": 46818170, "comment_id": 80584058, "body": "You can find an answer here: <a href=\"https://msdn.microsoft.com/en-us/library/office/hh134613%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">How to Find the First and Last Day in a Given Week, Month, or Year in Access 2010</a>."}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1508429238, "post_id": 46818170, "comment_id": 80616121, "body": "Ok, I added in some sample data. If the week number is NOT the same, the date range should move forward. For instance as the week number switches from 1 to 2, the date range moves to the next week."}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1508430353, "creation_date": 1508430353, "answer_id": 46834622, "question_id": 46818170, "link": "https://stackoverflow.com/questions/46818170/writing-a-date-range-in-access-query/46834622#46834622", "title": "Writing a date range in access query", "body": "<p>You can use <code>WEEKDAY</code> which will tell you the day number of the week that your date falls on.  A quick calculation will return Sundays date - add 7 and you get the following Saturday date.  </p>\n\n<pre><code>SELECT MyDate-Weekday(MyDate,1)+1 &amp; \" - \" &amp; MyDate-Weekday(MyDate,1)+7\nFROM Table1\n</code></pre>\n"}], "owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 46834622, "answer_count": 1, "score": 0, "last_activity_date": 1508430353, "creation_date": 1508356447, "last_edit_date": 1508429153, "question_id": 46818170, "link": "https://stackoverflow.com/questions/46818170/writing-a-date-range-in-access-query", "title": "Writing a date range in access query", "body": "<p>I'm hoping to write a query in access that will show the week date range from Sunday to Saturday.\nFor instance, this week's would be formatted like: 10/15/17 - 10/21/17</p>\n\n<p>Not sure how to even begin with this.</p>\n\n<p>I do have a column of the Week Number using the formula: DatePart(\"ww\",[date]).</p>\n\n<p>It seems logical to write something that says </p>\n\n<p><code>if week number is the same, minimum date &amp; \" - \"&amp; maximum date</code></p>\n\n<p>I have no idea how to write this in a query though or if this would be to use VBA...</p>\n\n<p>Here is essentially how the table looks. Column C is how I would like the query data to look once the query runs:</p>\n\n<pre><code>| Date    | Week | Date Range        |\n|---------|------|-------------------|\n| 8/1/17  | 1    | 8/1/17 - 8/7/17   |\n| 8/4/17  | 1    | 8/1/17 - 8/7/17   |\n| 8/7/17  | 1    | 8/1/17 - 8/7/17   |\n| 8/8/17  | 2    | 8/8/17 - 8/14/17  |\n| 8/11/17 | 2    | 8/8/17 - 8/14/17  |\n| 8/14/17 | 2    | 8/8/17 - 8/14/17  |\n| 8/15/17 | 3    | 8/15/17 - 8/21/17 |\n| 8/18/17 | 3    | 8/15/17 - 8/21/17 |\n| 8/21/17 | 3    | 8/15/17 - 8/21/17 |\n</code></pre>\n\n<p>Any help would be appreciated!</p>\n"}, {"tags": ["vba", "excel", "charts", "double-click"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1508356808, "post_id": 46818098, "comment_id": 80583866, "body": "You could get the <code>X,Y</code> from the mouse cursor, and if it&#39;s within the chart&#39;s area on the page, trigger the event...But this seems pretty complicated. Perhaps you could add a button to each page that does the same? That macro would be a little easier to program (just a button that says say, &quot;Click to Enlarge/Shrink Chart&quot;)?  This might be bordering on an <a href=\"https://meta.stackexchange.com/questions/66377/\">XY Problem</a>"}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1508809011, "post_id": 46818098, "comment_id": 80748730, "body": "To make the double click do anything, you need to use Chart Events. You can read my tutorial about <a href=\"https://peltiertech.com/chart-events-microsoft-excel/\" rel=\"nofollow noreferrer\">Chart Events in Microsoft Excel</a>. Combine the double click event with the code in the other answers that resize the charts."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8797760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/137cf18fa6d8dbe652aaebdb8619c8b9?s=128&d=identicon&r=PG&f=1", "display_name": "Big J", "link": "https://stackoverflow.com/users/8797760/big-j"}, "edited": false, "score": 0, "creation_date": 1508360574, "post_id": 46818303, "comment_id": 80585722, "body": "Would this code example be inserted on the code pane for the worksheet that the charts are on?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 1, "user_id": 8797760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/137cf18fa6d8dbe652aaebdb8619c8b9?s=128&d=identicon&r=PG&f=1", "display_name": "Big J", "link": "https://stackoverflow.com/users/8797760/big-j"}, "edited": false, "score": 0, "creation_date": 1508512458, "post_id": 46818303, "comment_id": 80651636, "body": "Yes, you should add this code manually for each Chart. It&#39;s important to replace <code>Chart1</code> with the name of the objects that you create."}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1508809032, "post_id": 46818303, "comment_id": 80748732, "body": "The code will only work if you set up a class module to handle the chart events, as I describe in my tutorial <a href=\"https://peltiertech.com/chart-events-microsoft-excel/\" rel=\"nofollow noreferrer\">Chart Events in Microsoft Excel</a>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1508356935, "creation_date": 1508356935, "answer_id": 46818303, "question_id": 46818098, "link": "https://stackoverflow.com/questions/46818098/double-click-event-on-charts-in-a-worksheet/46818303#46818303", "title": "Double Click Event on charts in a worksheet", "body": "<p>You can write your code for every chart.\nLet's assume your charts are <code>Chart1, Chart2, Chart3, Chart4</code>.\nYou can write a Sub to modify the size of your chart and then, call for every <code>BeforeDoubleClick</code> event.</p>\n\n<pre><code>Private Sub Chart1_BeforeDoubleClick(ByVal ElementID As Long, _ \n ByVal Arg1 As Long, ByVal Arg2 As Long, Cancel As Boolean) \n    Call ChartSize (Chart1)\nend Sub\n</code></pre>\n\n<p>Hope it helps.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8797760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/137cf18fa6d8dbe652aaebdb8619c8b9?s=128&d=identicon&r=PG&f=1", "display_name": "Big J", "link": "https://stackoverflow.com/users/8797760/big-j"}, "edited": false, "score": 0, "creation_date": 1508364443, "post_id": 46819830, "comment_id": 80587499, "body": "That&#39;s a interesting approuch. I&#39;ll give that a try."}], "tags": [], "owner": {"reputation": 23, "user_id": 3703143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb226694f5c5cb185c69390ac8660664?s=128&d=identicon&r=PG&f=1", "display_name": "AjW-Dred", "link": "https://stackoverflow.com/users/3703143/ajw-dred"}, "is_accepted": false, "score": 0, "last_activity_date": 1508363529, "creation_date": 1508363529, "answer_id": 46819830, "question_id": 46818098, "link": "https://stackoverflow.com/questions/46818098/double-click-event-on-charts-in-a-worksheet/46819830#46819830", "title": "Double Click Event on charts in a worksheet", "body": "<p>Easy to do with single click and change the window zoom rather than the chart size.  You could modify as above for a double click.  You might need to change the zoom values.\nIf you've already set up your charts you have cell refs for positioning; you need these to deselect the chart so that the next time the user clicks the code runs again.  Otherwise they have to manually click off the chart before selecting it again.</p>\n\n<p>Inside a Module:</p>\n\n<pre><code>Sub Setup()\n    ActiveSheet.ChartObjects(\"Chart 1\").Activate\n    Selection.OnAction = \"Chart1_Click\"\n    ActiveSheet.ChartObjects(\"Chart 2\").Activate\n    Selection.OnAction = \"Chart2_Click\"\n    ActiveSheet.ChartObjects(\"Chart 3\").Activate\n    Selection.OnAction = \"Chart3_Click\"\n    ActiveSheet.ChartObjects(\"Chart 4\").Activate\n    Selection.OnAction = \"Chart4_Click\"\nEnd Sub\n\nSub Chart1_Click()\n    ChartZoom (\"Chart 1\")\nEnd Sub\n\nSub Chart2_Click()\n    ChartZoom (\"Chart 2\")\n    '  you could select a cell under the chart here; easier than in the sub below\nEnd Sub\n\nSub Chart3_Click()\n    ChartZoom (\"Chart 3\")\nEnd Sub\n\nSub Chart4_Click()\n    ChartZoom (\"Chart 4\")\nEnd Sub\n\nSub ChartZoom(chartRef As String)\n    ActiveSheet.ChartObjects(chartRef).Select 'Activate\n    If ActiveWindow.Zoom = 100 Then\n        ActiveWindow.Zoom = True\n        ' Insert code here to select a range underneath chartRef\n    Else\n        If ActiveWindow.Zoom &lt;&gt; 100 Then\n            ActiveWindow.Zoom = 100\n            Range(\"A1\").Select ' &lt;-- Brings back the scroll position to top left\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8797760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/137cf18fa6d8dbe652aaebdb8619c8b9?s=128&d=identicon&r=PG&f=1", "display_name": "Big J", "link": "https://stackoverflow.com/users/8797760/big-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1623, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1508363529, "creation_date": 1508356163, "last_edit_date": 1508356319, "question_id": 46818098, "link": "https://stackoverflow.com/questions/46818098/double-click-event-on-charts-in-a-worksheet", "title": "Double Click Event on charts in a worksheet", "body": "<p>I have a macro that inserts a worksheet and then inserts 4 charts on to that work sheet. These charts are sized and positioned in such a way that they have a quarter of the screen in that worksheet. </p>\n\n<p>Now I am trying to figure out how to allow the user to double click on one of these charts, which it will enlarge the chart to the full size of the worksheet. When they double click again, it will restore back to its quarter size. </p>\n\n<p>My biggest stumbling block is how to handle and the double click event over the chart in question. I have been able to make it work over the worksheet. But the charts seem to be tricky because they are not there initially. The positioning and sizing is the easy bit. There is help on the web about similar issues, but they assume your chart is a chart and not a worksheet. </p>\n\n<p>Any suggestions will be much appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1508356908, "post_id": 46818074, "comment_id": 80583923, "body": "Yeah, what is MyTimeSheet?  It&#39;s not defined in this subroutine.  Is it a global variable?  Try removing &quot;&amp; MyTimeSheet&quot; and see what happens"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8786239, "user_type": "registered", "profile_image": "https://graph.facebook.com/1771577272854513/picture?type=large", "display_name": "Daniel Shaw", "link": "https://stackoverflow.com/users/8786239/daniel-shaw"}, "edited": false, "score": 0, "creation_date": 1508356881, "post_id": 46818183, "comment_id": 80583905, "body": "MyTimeSheet is a different string variable that houses the name of the workbook already open and does not need to be included here. I already figured out a slicker way to accomplish this;                     Workbooks.Open Filename:=MyDetailReport Set Detailwb = Workbooks(Workbooks.Count), Thanks for your response though."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1508356496, "creation_date": 1508356496, "answer_id": 46818183, "question_id": 46818074, "link": "https://stackoverflow.com/questions/46818074/how-do-i-set-workbook-variable-based-on-a-filename-i-has-as-a-string-variable/46818183#46818183", "title": "How do I set workbook variable based on a filename I has as a string variable? (VBA)", "body": "<p>Workbooks.Open returns a reference to the opened workbook, so you only need one line for this:</p>\n\n<pre><code>Set Detailwb = Workbooks.Open(Filename:=MyDetailReport &amp; MyTimeSheet)\n</code></pre>\n\n<p>What's <code>MyTimeSheet</code> doing though?</p>\n"}], "owner": {"reputation": 1, "user_id": 8786239, "user_type": "registered", "profile_image": "https://graph.facebook.com/1771577272854513/picture?type=large", "display_name": "Daniel Shaw", "link": "https://stackoverflow.com/users/8786239/daniel-shaw"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 687, "favorite_count": 0, "closed_date": 1508356688, "answer_count": 1, "score": -1, "last_activity_date": 1508356496, "creation_date": 1508356077, "question_id": 46818074, "link": "https://stackoverflow.com/questions/46818074/how-do-i-set-workbook-variable-based-on-a-filename-i-has-as-a-string-variable", "closed_reason": "Duplicate", "title": "How do I set workbook variable based on a filename I has as a string variable? (VBA)", "body": "<p>I am trying to set a workbook variable \"Detailwb\" as a workbook that the user selects with the Application.FileDialog(msoFileDialogFilePicker) function but I am receiving the following error msg: \"Run-Time error '9': Subscript out of range\" on the last line of the code below. I know that the workbooks call should be in this format; Workbooks(\"file name\") but I want the program to call whatever .xlsx file the user selects. I'm just not sure what the proper syntax/method is to accomplish this.</p>\n\n<p>Here's an excerpt;</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n'Define All Variables\nDim GCell As Range\nDim fDialog As FileDialog, result As Integer\nDim Detailwb As Workbook\nDim Timewb As Workbook\nDim MyDetailReport As String\nDim MyTimeSheet As String\nDim MySheet As String\nDim ProjNum As String\nDim PhaseCode As String\nDim Hours As String\nDim WkEndDate As String\nDim FindRowNumber As Long\nDim FindColumn As Long\n\n\n'Define Workbooks\nSet Timewb = ThisWorkbook\n\n\n'Find source file\nSet fDialog = Application.FileDialog(msoFileDialogFilePicker)\n    fDialog.AllowMultiSelect = False\n    fDialog.Title = \"Select Daily Report File to Import\"\n    fDialog.InitialFileName = \"W:\\PDX - Mechanical Construction\\Operations\\Detailing\\Daily Tracking Logs\\\"\n    fDialog.Filters.Clear\n    fDialog.Filters.Add \"Excel files\", \"*.xlsx\"\n    If fDialog.Show = -1 Then\n        MyDetailReport = fDialog.SelectedItems(1)\n    End If\n\nWorkbooks.Open Filename:=MyDetailReport &amp; MyTimeSheet\nSet Detailwb = Workbooks(MyDetailReport)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2227, "user_id": 4175515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dVuYh.jpg?s=128&g=1", "display_name": "Joao  Vitorino", "link": "https://stackoverflow.com/users/4175515/joao-vitorino"}, "edited": false, "score": 0, "creation_date": 1508359076, "post_id": 46818060, "comment_id": 80585009, "body": "Post your code. What you have done so far."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1508357257, "creation_date": 1508357257, "answer_id": 46818388, "question_id": 46818060, "link": "https://stackoverflow.com/questions/46818060/excel-vba-macro-to-remove-each-shapes-hyperlink/46818388#46818388", "title": "Excel VBA macro to remove each shape&#39;s hyperlink", "body": "<p>Try using the follow procedure to remove all the hyperlinks as once.</p>\n\n<pre><code>Sub DeleteHyperLinks()\n  Sheet1.Hyperlinks.Delete\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8797750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6954adedc6a623b73602eae8a54c52e0?s=128&d=identicon&r=PG&f=1", "display_name": "G. B.", "link": "https://stackoverflow.com/users/8797750/g-b"}, "edited": false, "score": 0, "creation_date": 1508369411, "post_id": 46819175, "comment_id": 80588894, "body": "Works perfectly. Thank you so much!"}], "tags": [], "owner": {"reputation": 1262, "user_id": 7416484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a4ded2dfe3912f01a9477f4518546ab?s=128&d=identicon&r=PG", "display_name": "GSD", "link": "https://stackoverflow.com/users/7416484/gsd"}, "is_accepted": true, "score": 0, "last_activity_date": 1508367921, "last_edit_date": 1508367921, "creation_date": 1508360523, "answer_id": 46819175, "question_id": 46818060, "link": "https://stackoverflow.com/questions/46818060/excel-vba-macro-to-remove-each-shapes-hyperlink/46819175#46819175", "title": "Excel VBA macro to remove each shape&#39;s hyperlink", "body": "<p>This example deletes the hyperlinks from the shapes in Column A, adjust column as necessary.</p>\n\n<pre><code>Sub DeleteHyperlink()\nDim shp As Shape\nDim r As Range\n\n        Set r = Columns(\"A:A\")\n        For Each shp In ActiveSheet.Shapes\n            If Not Intersect(Range(shp.TopLeftCell, shp.BottomRightCell), r) Is Nothing Then\n                On Error Resume Next\n                If shp.Hyperlink.Address &lt;&gt; \"\" Then shp.Hyperlink.Delete\n            End If\n        Next shp\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8797750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6954adedc6a623b73602eae8a54c52e0?s=128&d=identicon&r=PG&f=1", "display_name": "G. B.", "link": "https://stackoverflow.com/users/8797750/g-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1508, "favorite_count": 0, "accepted_answer_id": 46819175, "answer_count": 2, "score": -1, "last_activity_date": 1508465614, "creation_date": 1508356015, "last_edit_date": 1531164843, "question_id": 46818060, "link": "https://stackoverflow.com/questions/46818060/excel-vba-macro-to-remove-each-shapes-hyperlink", "title": "Excel VBA macro to remove each shape&#39;s hyperlink", "body": "<p>I have an excel spreadsheet with a shape in each row of a column, with more shapes to be added to the column over time.  The problem is, some shapes have hyperlinks and others do not.  I want to write a vba macro to loop through each shape in the column and remove the current shape's hyperlink if it has one.  I have tried recording a macro where I manually remove a shape's hyperlink and then apply this action globally. However, there are other shapes on the sheet that have hyperlinks so my macro must only be applied to this specific column.  Any ideas? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1508356718, "post_id": 46818027, "comment_id": 80583820, "body": "Rows.Count is the total number of rows in the sheet, not the number of <i>occupied</i> rows."}, {"owner": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1508357430, "post_id": 46818027, "comment_id": 80584169, "body": "I thought that was what xlUp or xlDown did then? Find the last occupied cell or something? I found my code and it was using xlUp instead of Down but it was only copying to the TOP 2 rows. I changed it to xlDown and now it does everything below."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1508357663, "post_id": 46818027, "comment_id": 80584279, "body": "You are going &quot;down&quot; starting at the bottom of the sheet."}, {"owner": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1508357880, "post_id": 46818027, "comment_id": 80584386, "body": "hmm Well THAT won&#39;t work will it!?? haha"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "edited": false, "score": 0, "creation_date": 1508358029, "post_id": 46818328, "comment_id": 80584459, "body": "Thanks! That works perfectly. What is the main difference between this and my code? Is it just you put in the resize statement to change what column it goes to? I am trying to figure out how things work more. Thanks!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "edited": false, "score": 0, "creation_date": 1508359475, "post_id": 46818328, "comment_id": 80585196, "body": "Really just the changes around which range is selected for pasting. Also it&#39;s good practice to always specify a worksheet when you use Range/Cells, otherwise they end up referring to whatever happens to be the active sheet, and that can make your code brittle and prone to doing odd things."}, {"owner": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "edited": false, "score": 0, "creation_date": 1508360280, "post_id": 46818328, "comment_id": 80585581, "body": "Yeah I was still working on fixing that up. Thanks for the help!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 7, "last_activity_date": 1508357044, "creation_date": 1508357044, "answer_id": 46818328, "question_id": 46818027, "link": "https://stackoverflow.com/questions/46818027/vba-copy-formatting-from-a-row-to-several-rows/46818328#46818328", "title": "VBA copy formatting from a row to several rows", "body": "<p>Try this:</p>\n\n<pre><code>Dim rngCopy As Range, rngPaste As Range\n\n\nWith ActiveSheet\n    Set rngCopy = .Range(.Range(\"A2\"), .Cells(2, Columns.Count).End(xlToLeft))\n\n    Set rngPaste = .Range(.Range(\"A2\"), _\n                       .Cells(Rows.Count, 1).End(xlUp)).Resize( , rngCopy.Columns.Count)\n\nEnd With\n\nrngCopy.Copy\nrngPaste.PasteSpecial  Paste:=xlPasteFormats\nApplication.CutCopyMode = False\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8892, "favorite_count": 1, "accepted_answer_id": 46818328, "answer_count": 1, "score": 2, "last_activity_date": 1508357044, "creation_date": 1508355858, "question_id": 46818027, "link": "https://stackoverflow.com/questions/46818027/vba-copy-formatting-from-a-row-to-several-rows", "title": "VBA copy formatting from a row to several rows", "body": "<p>Alright so I am really close to getting this but I am just trying to make it work better. I want to copy row 2 formatting that goes until like Column H. The data only goes until Column H. So my code copies ONLY row 2 until Column H. But when it goes to paste, it highlights the whole sheet besides row 1 and it looks like it copies the formatting across the whole thing. It is not really an issue but I would rather know how to make it paste only in the rows and columns I want for future reference. I only want it going to cells that have data in it basically. Thanks for the help in advance!</p>\n\n<pre><code>    Range(\"A2\", Cells(2, Columns.Count).End(xlToLeft)).COPY\n    Range(\"A2\", Cells(Range(\"A\" &amp; Rows.Count).End(xlDown).Row)).PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n    Application.CutCopyMode = False\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1508354099, "post_id": 46817560, "comment_id": 80582496, "body": "You converted the string to upper case so that if statement will always be true."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1508354284, "post_id": 46817560, "comment_id": 80582587, "body": "either remove <code>UCase</code> or use upper case of all sheet names: <code>If Strname &lt;&gt; &quot;IMPORT&quot; And _ Strname &lt;&gt; &quot;COMPARISON&quot; And _  Strname &lt;&gt; &quot;CONTROL SHEET&quot; Then</code>"}, {"owner": {"reputation": 106, "user_id": 8409084, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0b243d25c4f5fa36b3075c79a5b9f81e?s=128&d=identicon&r=PG&f=1", "display_name": "mithun nair", "link": "https://stackoverflow.com/users/8409084/mithun-nair"}, "edited": false, "score": 0, "creation_date": 1508354553, "post_id": 46817560, "comment_id": 80582730, "body": "Ya Thanks for helping me"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 106, "user_id": 8409084, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0b243d25c4f5fa36b3075c79a5b9f81e?s=128&d=identicon&r=PG&f=1", "display_name": "mithun nair", "link": "https://stackoverflow.com/users/8409084/mithun-nair"}, "edited": false, "score": 0, "creation_date": 1508361194, "post_id": 46818591, "comment_id": 80586017, "body": "YW Happy coding!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1508358033, "creation_date": 1508358033, "answer_id": 46818591, "question_id": 46817560, "link": "https://stackoverflow.com/questions/46817560/how-to-avoid-a-sheet-when-we-run-a-macro-combines-data-from-many-sheets-into-a-s/46818591#46818591", "title": "How to avoid a sheet when we run a macro combines data from many sheets into a single sheet", "body": "<p>A Select Case statement are well suited for handling multiple comparisions to value. </p>\n\n<pre><code>    Select Case UCase(wksSrc.Name)\n        Case UCase(\"Import\"), UCase(\"Comparison\"), UCase(\"Control Sheet\")\n\n        Case Else\n\n    End Select\n</code></pre>\n\n<hr>\n\n<p>Here I use <code>Filter</code> for it's text comparison ability.  </p>\n\n<p>I prefer to pass the Source range to a helper function.  This makes debugging very easy.</p>\n\n<pre><code>Public Sub CombineDataFromAllSheets2()\n    Dim LastUsedCell As Range, ws As Worksheet\n\n    For Each ws In ThisWorkbook.Worksheets\n        With ws\n            If Filter(Array(\"Import\", \"Comparison\", \"Control Sheet\"), .Name, True, vbTextCompare) = -1 Then\n\n                Set LastUsedCell = getLastUsedCell(ws)\n                If LastUsedCell Is Nothing Then\n                    MsgBox \"No Cells Found on Worksheet: \" &amp; ws.Name, vbInformation, \"Worksheet Skipped\"\n                Else\n                    ImportRange .Range(.Cells(2, 1), LastUsedCell)\n                End If\n\n            End If\n        End With\n    Next\nEnd Sub\n\nPublic Sub ImportRange(Source As Range)\n    With ThisWorkbook.Worksheets(\"Import\")\n        With .Range(\"A\" &amp; .Rows.Count).End(xlUp)\n            Source.Copy Destination:=.Offset(1)\n        End With\n    End With\nEnd Sub\n\nPublic Function getLastUsedCell(ws As Worksheet) As Range\n    Set getLastUsedCell = ws.Cells.Find(What:=\"*\", After:=ws.Range(\"A1\"), Lookat:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious, MatchCase:=False)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 106, "user_id": 8409084, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0b243d25c4f5fa36b3075c79a5b9f81e?s=128&d=identicon&r=PG&f=1", "display_name": "mithun nair", "link": "https://stackoverflow.com/users/8409084/mithun-nair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 46818591, "answer_count": 1, "score": 0, "last_activity_date": 1508358033, "creation_date": 1508353914, "question_id": 46817560, "link": "https://stackoverflow.com/questions/46817560/how-to-avoid-a-sheet-when-we-run-a-macro-combines-data-from-many-sheets-into-a-s", "title": "How to avoid a sheet when we run a macro combines data from many sheets into a single sheet", "body": "<p>I am new to macro, but have some basic idea how it works or like able to write small VBA codes.</p>\n\n<p>Is it possible to avoid more than 1 sheets when i use below macro which actually copy data from different sheets to one sheet called Import</p>\n\n<p>VBA CODE</p>\n\n<pre><code>Option Explicit\nPublic Sub CombineDataFromAllSheets()\n\nDim wksSrc As Worksheet, wksDst As Worksheet\nDim rngSrc As Range, rngDst As Range\nDim lngLastCol As Long, lngSrcLastRow As Long, lngDstLastRow As Long\nDim Strname As String\n\n'Notes: \"Src\" is short for \"Source\", \"Dst\" is short for \"Destination\"\n\n'Set references up-front\nSet wksDst = ThisWorkbook.Worksheets(\"Import\")\nlngDstLastRow = LastOccupiedRowNum(wksDst) '&lt;~ defined below (and in Toolbelt)!\nlngLastCol = LastOccupiedColNum(wksDst) '&lt;~ defined below (and in Toolbelt)!\n\n'Set the initial destination range\nSet rngDst = wksDst.Cells(lngDstLastRow + 1, 1)\n\n'Loop through all sheets\nFor Each wksSrc In ThisWorkbook.Worksheets\n\n    'Make sure we skip the \"Import\" destination sheet!\n    Strname = UCase(wksSrc.Name)\n    If Strname &lt;&gt; \"Import\" And _\n    Strname &lt;&gt; \"Import2\" Then\n\n        'Identify the last occupied row on this sheet\n        lngSrcLastRow = LastOccupiedRowNum(wksSrc)\n\n        'Store the source data then copy it to the destination range\n        With wksSrc\n            Set rngSrc = .Range(.Cells(2, 1), .Cells(lngSrcLastRow, lngLastCol))\n            rngSrc.Copy Destination:=rngDst\n        End With\n\n        'Redefine the destination range now that new data has been added\n        lngDstLastRow = LastOccupiedRowNum(wksDst)\n        Set rngDst = wksDst.Cells(lngDstLastRow + 1, 1)\n\n    End If\n\nNext wksSrc\nEnd Sub\n\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'INPUT       : Sheet, the worksheet we'll search to find the last row\n'OUTPUT      : Long, the last occupied row\n'SPECIAL CASE: if Sheet is empty, return 1\nPublic Function LastOccupiedRowNum(Sheet As Worksheet) As Long\n    Dim lng As Long\n    If Application.WorksheetFunction.CountA(Sheet.Cells) &lt;&gt; 0 Then\n        With Sheet\n            lng = .Cells.Find(What:=\"*\", _\n                              After:=.Range(\"A1\"), _\n                              Lookat:=xlPart, _\n                              LookIn:=xlFormulas, _\n                              SearchOrder:=xlByRows, _\n                              SearchDirection:=xlPrevious, _\n                              MatchCase:=False).Row\n        End With\n    Else\n        lng = 1\n    End If\n    LastOccupiedRowNum = lng\nEnd Function\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'INPUT       : Sheet, the worksheet we'll search to find the last column\n'OUTPUT      : Long, the last occupied column\n'SPECIAL CASE: if Sheet is empty, return 1\nPublic Function LastOccupiedColNum(Sheet As Worksheet) As Long\n    Dim lng As Long\n    If Application.WorksheetFunction.CountA(Sheet.Cells) &lt;&gt; 0 Then\n        With Sheet\n            lng = .Cells.Find(What:=\"*\", _\n                              After:=.Range(\"A1\"), _\n                              Lookat:=xlPart, _\n                              LookIn:=xlFormulas, _\n                              SearchOrder:=xlByColumns, _\n                              SearchDirection:=xlPrevious, _\n                              MatchCase:=False).Column\n        End With\n    Else\n        lng = 1\n    End If\n    LastOccupiedColNum = lng\nEnd Function\n</code></pre>\n\n<p>For example \nI have 5 sheets in an excel, they are </p>\n\n<p>Sheet1. Control Sheet (more like a Dash board/UI)<br>\n Sheet2. Import (Where data need to be copied)<br>\n Sheet3. Comparison (No need to copy data from this sheet)<br>\n Sheet4. CSV file 1 (All data available will be copied to IMPORT\n    sheet)<br>\n Sheet5. CSV file 2 (All data available will be copied to IMPORT\n    sheet)  </p>\n\n<p>now when user run the query only data from sheet 5 and sheet 6 get copied to Sheet 2 (Import)</p>\n\n<p>I used  </p>\n\n<pre><code>Strname = UCase(wksSrc.Name)\nIf Strname &lt;&gt; \"Import\" And _\nStrname &lt;&gt; \"Comparison\" And _ \nStrname &lt;&gt; \"Control Sheet\" Then\n</code></pre>\n\n<p>But this actually not working and just copy everything available under all 5 sheets.</p>\n\n<p>Kindly help me on this.</p>\n\n<p>Thanks in Advance</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "excel-2016", "vba"], "comments": [{"owner": {"reputation": 34313, "user_id": 121309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a620f1f95441b8bde0e6c2c5140581d?s=128&d=identicon&r=PG", "display_name": "Hans Ke\ufb06ing", "link": "https://stackoverflow.com/users/121309/hans-ke%ef%ac%86ing"}, "edited": false, "score": 0, "creation_date": 1508403957, "post_id": 46817488, "comment_id": 80600128, "body": "What was that warning? What was that &quot;menu option&quot; you tried? Please <a href=\"https://stackoverflow.com/posts/46817488/edit\">edit</a> that into your question along with details (like formula) of the cells that gave the error."}, {"owner": {"reputation": 35, "user_id": 8776659, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/8yjng.jpg?s=128&g=1", "display_name": "Kasih Ditaningtyas", "link": "https://stackoverflow.com/users/8776659/kasih-ditaningtyas"}, "reply_to_user": {"reputation": 34313, "user_id": 121309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a620f1f95441b8bde0e6c2c5140581d?s=128&d=identicon&r=PG", "display_name": "Hans Ke\ufb06ing", "link": "https://stackoverflow.com/users/121309/hans-ke%ef%ac%86ing"}, "edited": false, "score": 0, "creation_date": 1508412747, "post_id": 46817488, "comment_id": 80605048, "body": "Hi @HansKesting I&#39;ve edited my question. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 8776659, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/8yjng.jpg?s=128&g=1", "display_name": "Kasih Ditaningtyas", "link": "https://stackoverflow.com/users/8776659/kasih-ditaningtyas"}, "edited": false, "score": 0, "creation_date": 1508413613, "post_id": 46817765, "comment_id": 80605571, "body": "Thank you for your answer. However the answer is really different with my question. I need to use #N/A in order to draw gaps in my dynamic chart."}], "tags": [], "owner": {"reputation": 71, "user_id": 5424373, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YG1QOBbKj1s/AAAAAAAAAAI/AAAAAAAAAAA/lV1YpP4lXt4/photo.jpg?sz=128", "display_name": "Alvaro Carvalho", "link": "https://stackoverflow.com/users/5424373/alvaro-carvalho"}, "is_accepted": false, "score": 0, "last_activity_date": 1508354798, "creation_date": 1508354798, "answer_id": 46817765, "question_id": 46817488, "link": "https://stackoverflow.com/questions/46817488/how-to-avoid-error-warning-in-dynamic-chart-if-we-use-zero-values-and-n-a/46817765#46817765", "title": "How to avoid error warning in dynamic chart if we use zero values and #N/A?", "body": "<p>Have you tried the IFERROR function?</p>\n\n<p><a href=\"http://www.excel-easy.com/examples/iferror.html\" rel=\"nofollow noreferrer\">http://www.excel-easy.com/examples/iferror.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 34313, "user_id": 121309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a620f1f95441b8bde0e6c2c5140581d?s=128&d=identicon&r=PG", "display_name": "Hans Ke\ufb06ing", "link": "https://stackoverflow.com/users/121309/hans-ke%ef%ac%86ing"}, "is_accepted": false, "score": 0, "last_activity_date": 1508415168, "creation_date": 1508415168, "answer_id": 46829578, "question_id": 46817488, "link": "https://stackoverflow.com/questions/46817488/how-to-avoid-error-warning-in-dynamic-chart-if-we-use-zero-values-and-n-a/46829578#46829578", "title": "How to avoid error warning in dynamic chart if we use zero values and #N/A?", "body": "<p>Your image shows that you tried the function</p>\n\n<pre><code>=IF(F18&gt;0;4;#N/A)\n</code></pre>\n\n<p>Excel probably trips over that \"#N/A\".</p>\n\n<p>So use the <a href=\"https://support.office.com/en-us/article/NA-function-5469c2d1-a90c-4fb5-9bbc-64bd9bb6b47c\" rel=\"nofollow noreferrer\">NA function</a> <code>NA()</code></p>\n\n<pre><code>=IF(F18&gt;0;4;NA())\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 7612487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f3d5b9164bf7a8eadf9e1b304f07cd2?s=128&d=identicon&r=PG&f=1", "display_name": "J3NKO", "link": "https://stackoverflow.com/users/7612487/j3nko"}, "is_accepted": false, "score": 0, "last_activity_date": 1508423057, "creation_date": 1508423057, "answer_id": 46832242, "question_id": 46817488, "link": "https://stackoverflow.com/questions/46817488/how-to-avoid-error-warning-in-dynamic-chart-if-we-use-zero-values-and-n-a/46832242#46832242", "title": "How to avoid error warning in dynamic chart if we use zero values and #N/A?", "body": "<p>Excel charts ignore data cells with ANY text in it so suggest you use something other than #N/A. </p>\n\n<p>=IF(F18>0;4;\"-\")</p>\n\n<p>Hope that helps</p>\n"}], "owner": {"reputation": 35, "user_id": 8776659, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/8yjng.jpg?s=128&g=1", "display_name": "Kasih Ditaningtyas", "link": "https://stackoverflow.com/users/8776659/kasih-ditaningtyas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 338, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1508423057, "creation_date": 1508353690, "last_edit_date": 1531161705, "question_id": 46817488, "link": "https://stackoverflow.com/questions/46817488/how-to-avoid-error-warning-in-dynamic-chart-if-we-use-zero-values-and-n-a", "title": "How to avoid error warning in dynamic chart if we use zero values and #N/A?", "body": "<p>I have a problem in running my dynamic chart. I use zero values and #N/A in my chart because it is important to be able to illustrate my data. Zero values indicate the dry period and I use #N/A in order to make gaps in my chart, because if I use zero, it will draw chart in zero values.</p>\n\n<p>I made formula for my dynamic chart by using OFFSET Formula and then use it to my dynamic chart.\nMy formula is like :\nWaterLevelSeries: =OFFSET(Datafeeds1!$L$18,0,0,COUNTA(Datafeeds!$L:$L)-1)</p>\n\n<p>and then I change the series data in the graph so that it use this \"WaterLevelSeries\" formula.</p>\n\n<p>My data is about dry period and the peak flow, so to distinguish between those two, it is important to define zero values for the chart. However there is a warning I received like this :\n<a href=\"https://i.stack.imgur.com/9bDw2.png\" rel=\"nofollow noreferrer\">warning error</a> </p>\n\n<p>and when I tracked it with \"F5 then Go to Special\" and ticked \"Formula\", it seems that my excel sheet did not like zero values and #N/A because it highlights my cells that contain those values. \nHowever since I really need zero values and this #N/A in my dynamic chart, is there a way to inactivate the error warning? I  tried the option menu in excel (Options - Formulas - unchecked all the Error Formulas Rule), but it did not work. The warning still appeared.</p>\n\n<p>Thank you for your help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1508353793, "post_id": 46817288, "comment_id": 80582312, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/17606045/delete-entire-row-if-cell-contains-the-string-x\">Delete entire row if cell contains the string X</a>  Just include, within your <code>For Each WS In ActiveWorkbook.Worksheets</code> loop, similar code to recommended in that question."}, {"owner": {"reputation": 13, "user_id": 8797428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3635f67c9f483eb4fc459150733ff47d?s=128&d=identicon&r=PG&f=1", "display_name": "Farhan", "link": "https://stackoverflow.com/users/8797428/farhan"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1508428782, "post_id": 46817288, "comment_id": 80615830, "body": "It is not working when I am inserting the code within the loop."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8797428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3635f67c9f483eb4fc459150733ff47d?s=128&d=identicon&r=PG&f=1", "display_name": "Farhan", "link": "https://stackoverflow.com/users/8797428/farhan"}, "edited": false, "score": 0, "creation_date": 1508428858, "post_id": 46818770, "comment_id": 80615878, "body": "Can you guide me where do I need insert the line in the master code I mentioned ? I am new to VBA here"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 13, "user_id": 8797428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3635f67c9f483eb4fc459150733ff47d?s=128&d=identicon&r=PG&f=1", "display_name": "Farhan", "link": "https://stackoverflow.com/users/8797428/farhan"}, "edited": false, "score": 0, "creation_date": 1508512621, "post_id": 46818770, "comment_id": 80651727, "body": "You can insert your if block before you save the workbook."}, {"owner": {"reputation": 13, "user_id": 8797428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3635f67c9f483eb4fc459150733ff47d?s=128&d=identicon&r=PG&f=1", "display_name": "Farhan", "link": "https://stackoverflow.com/users/8797428/farhan"}, "edited": false, "score": 0, "creation_date": 1508612761, "post_id": 46818770, "comment_id": 80681405, "body": "I am getting the Run - time Error : 1004  I have inserted the below if block after &quot;Next WS&quot; line  If Cells(oRow, 1).Value = 0 Then Rows(oRow).EntireRow.Delete"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 13, "user_id": 8797428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3635f67c9f483eb4fc459150733ff47d?s=128&d=identicon&r=PG&f=1", "display_name": "Farhan", "link": "https://stackoverflow.com/users/8797428/farhan"}, "edited": false, "score": 0, "creation_date": 1508635148, "post_id": 46818770, "comment_id": 80686425, "body": "<code>oRow</code> is a variable, so you need to declare it first and store a value to set the Row number and then delete it."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1508358786, "creation_date": 1508358786, "answer_id": 46818770, "question_id": 46817288, "link": "https://stackoverflow.com/questions/46817288/macro-for-row-killer-convert-all-fields-as-zero-save-as-xls/46818770#46818770", "title": "Macro for Row killer + Convert all fields as zero + Save as .xls", "body": "<p>You can add a validation for each cell in column A using something like <code>If cells(oRow,1).Value = 0 Then</code> and then you can delete the Row with \n <code>Rows(oRow).EntireRow.Delete</code></p>\n"}], "owner": {"reputation": 13, "user_id": 8797428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3635f67c9f483eb4fc459150733ff47d?s=128&d=identicon&r=PG&f=1", "display_name": "Farhan", "link": "https://stackoverflow.com/users/8797428/farhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508358786, "creation_date": 1508352966, "last_edit_date": 1531161705, "question_id": 46817288, "link": "https://stackoverflow.com/questions/46817288/macro-for-row-killer-convert-all-fields-as-zero-save-as-xls", "title": "Macro for Row killer + Convert all fields as zero + Save as .xls", "body": "<p>I need help in achieving the below in my excel sheet with one master MACRO VBA Code</p>\n\n<ol>\n<li><p>If column A contains 0 - Delete the entire row. ( Row Killer ) - This should run on all the sheets in the workbook</p></li>\n<li><p>Since the excel file is heavily linked - All fields needs to converted to values (E.g. Paste as Values)</p></li>\n<li><p>Save AS file in .xls format with the file name SAMAmonthlyReport</p></li>\n</ol>\n\n<p>I have the code for point 2 and 3 from this site but need help in adding the 1 point.</p>\n\n<p>Below is the code</p>\n\n<pre><code>Sub CopyValuesToSync()\n    Dim OrigWkbkFpth As String\n    Dim OrigWkbk As String\n    Dim ValueWkbk As String\n    Dim WS As Worksheet\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    OrigWkbkFpth = Application.ActiveWorkbook.FullName\n    OrigWkbk = Application.ActiveWorkbook.Name\n\n    For Each WS In ActiveWorkbook.Worksheets\n        WS.Select\n        Cells.Select\n        Selection.Copy\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n        Application.CutCopyMode = False\n        Range(\"A1\").Select\n    Next WS\n\n    ActiveWorkbook.SaveAs Filename:=\"C:\\SAMA\\SamaMonthly.xls\", _\n    FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\n\n    ValueWkbk = Application.ActiveWorkbook.Name\n\n    Workbooks.Open Filename:=OrigWkbkFpth\n    Windows(ValueWkbk).Activate\n    ActiveWindow.Close\n    Windows(OrigWkbk).Activate\n\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 2, "creation_date": 1508351803, "post_id": 46816886, "comment_id": 80581218, "body": "I&#39;d recommend re-writing as a stand alone question and then posting an answer to your own question (<a href=\"https://stackoverflow.com/help/self-answer\">yes this is allowed on SO</a>)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1508352816, "post_id": 46816886, "comment_id": 80581771, "body": "<a href=\"https://stackoverflow.com\">Stack Overflow</a> is Q&amp;A, not some discussion forum. Question field hosts questions, answer fields hold answers, and titles don&#39;t have <code>[SOLVED]</code> or <code>[SOLUTION]</code> or whatever other annoying tags in the title. Please <a href=\"https://stackoverflow.com/posts/46816886/edit\">edit</a> your post so that it <i>looks</i> like a Q&amp;A. As it stands, it&#39;s completely unclear what you&#39;re asking."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1508355923, "post_id": 46816886, "comment_id": 80583409, "body": "So you are using a userform from a non-visible workbook to act as the control window to do predefined functions on other workbooks?  Good Idea."}, {"owner": {"reputation": 1, "user_id": 6635915, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3Ydv4bkoag4/AAAAAAAAAAI/AAAAAAAAAD4/PpozR65wStw/photo.jpg?sz=128", "display_name": "Daniel Talbert", "link": "https://stackoverflow.com/users/6635915/daniel-talbert"}, "edited": false, "score": 0, "creation_date": 1508358710, "post_id": 46816886, "comment_id": 80584840, "body": "Sorry about the poor format of my post, this was my first posting here, and I thought that in my search for pieces of my solution that I saw several SO posts like that.  I&#39;ve edited this post to match suggestions.  Thanks for the input."}], "answers": [{"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": -1, "last_activity_date": 1508354731, "creation_date": 1508354731, "answer_id": 46817748, "question_id": 46816886, "link": "https://stackoverflow.com/questions/46816886/how-to-make-a-excel-based-vba-userform-act-on-its-own/46817748#46817748", "title": "How to make a Excel based VBA UserForm act on its own?", "body": "<p>this is your workbook_open with the code rearranged</p>\n\n<pre><code>Private Sub WorkBook_Open()\n\n    If Workbooks.Count = 1 Then Application.Visible = False\n\n    Workbooks(\"MyBook.xlsm\").Windows(1).Visible = False\n\n    UserForm1.Show vbModeless\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6635915, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3Ydv4bkoag4/AAAAAAAAAAI/AAAAAAAAAD4/PpozR65wStw/photo.jpg?sz=128", "display_name": "Daniel Talbert", "link": "https://stackoverflow.com/users/6635915/daniel-talbert"}, "is_accepted": false, "score": 0, "last_activity_date": 1508360774, "last_edit_date": 1508360774, "creation_date": 1508358588, "answer_id": 46818719, "question_id": 46816886, "link": "https://stackoverflow.com/questions/46816886/how-to-make-a-excel-based-vba-userform-act-on-its-own/46818719#46818719", "title": "How to make a Excel based VBA UserForm act on its own?", "body": "<p>Code will go in several different places, \"ThisWorkbook\" object and the \"UserForm\" code.</p>\n\n<p>\"ThisWorkbook\" contains code that will determine if the UserForm is the only Excel thing (workbook) open, and if it is it will hide the Excel application and hide the workbook itself. and if other workbooks are open it simply hides the workbook.  I have it set to hide the application and the workbook in both cases so that a new instance of Excel can be opened after the UserForm is running without pulling up the workbook associated with the UserForm.  The code for this is below (goes into the \"ThisWorkbook\" object):</p>\n\n<pre><code>Private Sub WorkBook_Open()\n  Dim wb As Workbook\n     Set wb = Workbooks(\"MyBook.xlsm\")\n    If Workbooks.Count &gt; 1 Then \n\n       wb.Windows(1).Visible = False\n    Else\n       wb.Windows(1).Visible = False\n       Application.Visible = False\n    End If\n   UserForm1.Show vbModeless\n   'Put defaults and populations here\nEnd Sub\n</code></pre>\n\n<p>The <code>UserForm1.Show vbModeless</code>allows for Excel to be used while the UserForm is active.\nA couple of notes on this section:</p>\n\n<ul>\n<li>\"UserForm1\" is the name of my UserForm, change this to the name of yours</li>\n<li>Where I <code>Set wb = Workbooks(\"\")</code> change inside the quotes to the name of the \nworkbook the UserForm is in</li>\n<li>The <code>IfElse</code> statement could be eliminated and moved to the <code>If</code>, if you don't need any other action on the opening with no other workbooks open</li>\n</ul>\n\n<p>The next section of code goes in the UserForm Code. I have a button set up to show the Excel workbook in order to edit it and whatnot, you could have a region you click if you don't want a button to show up.  When you want to activate the Excel sheet and the application will need to be activated.  I unload (deactivate) the active thing (the UserForm).  This bit of code isn't necessary if the user doesn't need access to the spreadsheet:</p>\n\n<pre><code>Private Sub See_Excel_Click()\n\n   Dim wb As Workbook\n   Set wb = Workbooks(\"MyBook.xlsm\")\n   wb.Windows(1).Visible = True\n   Application.Visible = True\n   wb.Sheets(\"Sheet1\").Activate\n\n   Unload Me\n\nEnd Sub\n</code></pre>\n\n<p>Within the userform there should be a way to handle what happens when the userform is closed, as the excel application and workbook will stay open hidden in the background.  I have the action close the workbook and the application.  A quick note, if you set the <code>Cancel = True</code> then the red x button won't close the userform.  The code I use for this is:</p>\n\n<pre><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n\n    If CloseMode = 0 Then\n      Cancel = False\n      Dim wb As Workbook\n      Set wb = Workbooks(\"MyBook.xlsm\")\n      wb.Windows(1).Visible = True\n      Application.Visible = True\n      ThisWorkbook.Saved = True\n      ThisWorkbook.Activate\n\n     If Workbooks.Count &gt; 1 Then\n          ActiveWorkbook.Close\n       Else\n          Application.Quit\n     End If\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>That is it for the code that goes inside the UserForm. And the code that is necessary to have the UserForm in VBA act as it's own application while allowing for Excel to operate normally at the same time as the UserForm.    </p>\n\n<p>To summarize what happens:</p>\n\n<ol>\n<li>When the Workbook is launched the workbook is hidden, and if no other workbook is open the the Excel application is hidden.</li>\n<li>The UserForm is initiated to allow for Excel to be used at the same time</li>\n<li>When the spreadsheet is activated again excel is re-enabled and the application and un-hide the worksheet</li>\n<li>When the user form is closed, the workbook is closed, and if there are no other workbooks the excel application is closed</li>\n<li>If you set defaults or populate ComboBoxes put them in the \"WorkBook\" object code.</li>\n</ol>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8244044"}, "is_accepted": false, "score": 0, "last_activity_date": 1509085569, "creation_date": 1509085569, "answer_id": 46968716, "question_id": 46816886, "link": "https://stackoverflow.com/questions/46816886/how-to-make-a-excel-based-vba-userform-act-on-its-own/46968716#46968716", "title": "How to make a Excel based VBA UserForm act on its own?", "body": "<p>If your issue is having all the workbooks open, you can add a procedure to close all them all.</p>\n\n<pre><code>Sub Close_xls()\nDim objXl as Object\nOn error Go To GenerateXlErr\nSet objXl = GetObject(, \"Excel.Application\")\nIf not (ObjXl is Nothing) Then\n    ObjXl.Application.DisplayAlerts = False\n    ObjXl.Workbooks.Close\n    ObjXl.Quit\n    set ObjXl = Nothing\nEnd If\nExit Sub\nGenerateXLErr:\nIf Err.number = 432 or err.number = 429 THen\n   Resume Next\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6635915, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3Ydv4bkoag4/AAAAAAAAAAI/AAAAAAAAAD4/PpozR65wStw/photo.jpg?sz=128", "display_name": "Daniel Talbert", "link": "https://stackoverflow.com/users/6635915/daniel-talbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1884, "favorite_count": 1, "answer_count": 3, "score": -1, "last_activity_date": 1509085569, "creation_date": 1508351324, "last_edit_date": 1531164843, "question_id": 46816886, "link": "https://stackoverflow.com/questions/46816886/how-to-make-a-excel-based-vba-userform-act-on-its-own", "title": "How to make a Excel based VBA UserForm act on its own?", "body": "<p>I've created a UserForm in Excel 2016 that utilizes UDF's; I'd like to be able to have the UserForm run without having the excel sheet open up and allow for other excel workbooks to be opened and manipulated at the same time that the tool is active.  Some solutions I've found say to use the following:</p>\n\n<pre><code>Private Sub MyForm_Initialize()\n  Application.Visible = False\n  UserForm1.Activate\nEnd Sub\n</code></pre>\n\n<p>However, this leaves the Excel open in the background after the UserForm is closed, and all other active Excel sheets are hidden and cannot easily be manipulated.</p>\n\n<p>Is there a way to make the UserForm essentially act as a standalone application without using VBA.net?</p>\n"}, {"tags": ["ms-access", "geolocation", "vba", "google-geocoder"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1508352786, "post_id": 46816849, "comment_id": 80581754, "body": "Counting the number of commas (or rather splitting on the commas and then concatenating) seems like a reasonable thing to do. If you can&#39;t show a situation where it doesn&#39;t work, it&#39;s hard to account for it for us."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1508352991, "post_id": 46816849, "comment_id": 80581869, "body": "Is it possible for you to provide with a valid link?"}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1508354926, "post_id": 46816849, "comment_id": 80582915, "body": "Shahin, here is the link I found:  <a href=\"https://access-programmers.co.uk/forums/showthread.php?t=206247\" rel=\"nofollow noreferrer\">access-programmers.co.uk/forums/showthread.php?t=206247</a>"}, {"owner": {"reputation": 815, "user_id": 6748684, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/0cc018e0b3232721c816d2b49300b2c6?s=128&d=identicon&r=PG&f=1", "display_name": "CyberNinja", "link": "https://stackoverflow.com/users/6748684/cyberninja"}, "edited": false, "score": 0, "creation_date": 1535136911, "post_id": 46816849, "comment_id": 90971310, "body": "man.I have this same issues where our user would input address then floor number or office number, city and state eg 1st road parkway tower 1st floor, austin,tx. I want to eliminate the 1st floor. I am thinking that this will be uncontrollable issues if our dumb nurses keeps on entering invalidated address we also use a 3rd party geomap tool and not google. so we built everything from core while calling the geomapping api."}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1508400102, "last_edit_date": 1508400102, "creation_date": 1508399346, "answer_id": 46825037, "question_id": 46816849, "link": "https://stackoverflow.com/questions/46816849/geolocation-parsing-formatted-address/46825037#46825037", "title": "GeoLocation - Parsing //Formatted_Address?", "body": "<p>I'm a bit of a beginner in <code>XPath</code>, but I think I can solve this:</p>\n\n\n\n<p>Instead of:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code> 'formatted_address\n  Geocode.sRetAddress = .selectSingleNode(\"//formatted_address\").Text\n</code></pre>\n\n<p>Use:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Build an address:\nGeocode.sRetAddress = oXMLDoc.selectSingleNode(\"descendant::address_component[type='street_number']/short_name\").text\nGeocode.sRetAddress = Geocode.sRetAddress &amp; \" \" oXMLDoc.selectSingleNode(\"descendant::address_component[type='route']/short_name\").text\nGeocode.sRetAddress = Geocode.sRetAddress &amp; \", \" oXMLDoc.selectSingleNode(\"descendant::address_component[type='locality']/short_name\").text\nGeocode.sRetAddress = Geocode.sRetAddress &amp; \", \" oXMLDoc.selectSingleNode(\"descendant::address_component[type='administrative_area_level_1']/short_name\").text\nGeocode.sRetAddress = Geocode.sRetAddress &amp; \" \" oXMLDoc.selectSingleNode(\"descendant::address_component[type='postal_code']/short_name\").text\nGeocode.sRetAddress = Geocode.sRetAddress &amp; \", \" oXMLDoc.selectSingleNode(\"descendant::address_component[type='country']/short_name\").text\n</code></pre>\n\n<p>to manually build up an adress based on components provided by the Google Maps geocode API.</p>\n\n<p>Note that if you're parsing things like cities and states out of this, that's a rather silly thing to do, since they're just available in the XML document. You're better of reading them directly from the XML.</p>\n"}, {"comments": [{"owner": {"reputation": 815, "user_id": 6748684, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/0cc018e0b3232721c816d2b49300b2c6?s=128&d=identicon&r=PG&f=1", "display_name": "CyberNinja", "link": "https://stackoverflow.com/users/6748684/cyberninja"}, "edited": false, "score": 0, "creation_date": 1535137014, "post_id": 46834284, "comment_id": 90971354, "body": "this is my issue.if I start to put a dictionary of words or terms that they put after the actual address it is endless."}], "tags": [], "owner": {"reputation": 95, "user_id": 8611161, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155105680331902/picture?type=large", "display_name": "AndrewBanjo1968", "link": "https://stackoverflow.com/users/8611161/andrewbanjo1968"}, "is_accepted": false, "score": 0, "last_activity_date": 1508430075, "last_edit_date": 1508430075, "creation_date": 1508429263, "answer_id": 46834284, "question_id": 46816849, "link": "https://stackoverflow.com/questions/46816849/geolocation-parsing-formatted-address/46834284#46834284", "title": "GeoLocation - Parsing //Formatted_Address?", "body": "<p>Just re-read and it looks like your specific situation is geared to just hospitals so you will not need to consider all of the issues listed here.  I'll leave this up, though, in case someone else is looking to parse addresses containing more than just \"floor\".  And still--you could consider the algorithm for finding just the \"root\".</p>\n\n<p>I worked on a similar project where I needed to identify the \"root\" physical address and it can be way more complicated than meets the eye.  There are SO many pitfalls to watch out for.  I ended up having to build a full-on rules engine.  Anticipate every possible combination and account for it.  </p>\n\n<p>-2 Main St 4th floor\n-2 Main St 3rd floor\n-2 Main St Unit 3\n-4th floor 2 Main St\n-Apt 3 2 Main street\n-Apt 3 22 Rte 7\n-2 Main st 1st floor\n...many more</p>\n\n<p>As a general rule you are usually trying to identify a section of the address formatted as \"2 Main Street\" where you have a number, a street name, and the suffix describing the street/road/drive, etc.  Here is a general algorithm which is only the base.  You'll need to expand.</p>\n\n<p>If there are any commas, split the string into separate elements to be evaluated individually</p>\n\n<p>Remove all punctuation in the address elements</p>\n\n<p>Find index of the \"Street\"  You'll have to have a fairly extensive list, but here are some:</p>\n\n<p>Road, Rd, Street, St, Boulevard, Blvd, Blv, Way, Avenue, Ave, Kill, Drive, Dr, Lane, Ln, Path, Highway, Hwy, BiWay, Bwy, Expressway. Circle, Cir, Crossing, Xing, Route, Rte, Rural Route, RR\nI'm sure you can think of more.</p>\n\n<p>Find the right-most instance of one of those and work backwards from that index until you find a numeric value (or, more accurately, the index of the beginning of a contiguous set of numerical values).\n- Make sure that numeric value is not part of the street name (i.e. \"3rd Street), which means make sure the numeric value is not followed by a \"rd\" or \"th\" or \"nd\" or make sure it has a space following it. If it is, keep looking back until you find the numeric part of the street address.\n- Once you find the numeric value you will likely have what you need.  Grab everything between the numeric value and the \"Street\".</p>\n\n<p>Other things to be careful of:\n- Abbreviation for \"Street\" and for \"Saint\" are the same.  as in \"2 St Francis St\"\n- Abbreviation for \"Doctor\" and for \"Drive\" are the same.  \"3 Dr Jones Dr\"\n- \"Route\"s and \"Highways\" can have numeric values following them as in \"2 Route 5\"\n- Abbreviations for the many incarnations of \"Street/Drive\" are very often buried in the street name.  \"3 Caveman Arrival St\"  contains \"ave\" and \"rr\" an \"st\"\n- Numeric portions may also be written as a word as in \"Three Main Street\",</p>\n\n<p>If you choose to try and identify unwanted sections of address instead of the desired section, you will likewise need to account for a plethora of potential situations:</p>\n\n<p>Apartment, Apt, Suite, Ste, Floor, Fl, Unit, #, Flat, Box, POBox, PO, Building,, Bldg, Bld, Dorm, Room, Rm</p>\n\n<p>Ultimately, you'll likely end up with many scenarios/exceptions you'd need to account for and many \"Cases\". You might also consider using regular expressions to identify them. Good luck!</p>\n"}], "owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 424, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1594638939, "creation_date": 1508351175, "last_edit_date": 1594638939, "question_id": 46816849, "link": "https://stackoverflow.com/questions/46816849/geolocation-parsing-formatted-address", "title": "GeoLocation - Parsing //Formatted_Address?", "body": "<p>I am playing with a new function in an AccessDB app to return Lat/Lon info from Hospital names.  The following function provides what I need when I provide a Name &amp; Address.  I noticed (unexpected) the function returns a formatted address even if I provide JUST a valid hospital name.  I think I can exploit this to backfill address info into my database.  </p>\n\n<p>It appears that <code>Geocode.sRetAddress = .selectSingleNode(\"//formatted_address\").Text</code> is \"mostly\" consistent and easilly parsed to grab Address/City/State/ZIP info using \",\" as a delimiter.  My complication is the rare occasion where a \"Floor Number\" is included in the formatted address string.  My parsing routine fails.</p>\n\n<p>I found this routine (not mine):</p>\n\n<pre><code>Option Explicit\nOption Compare Database\n\n'Public Type containing the geocoding of the postal address\nPublic Type tGeocodeResult\n   dLatitude As Double\n   dLongitude As Double\n   sRetAddress As String\n   sAccuracy As String\n   sStatus As String\nEnd Type\n\n'---------------------------------------------------------------------------------------\n' Procedure : Geocode with Google Geocoding API v3\n' Version   : 1.01\n' DateTime  : 03/03/2011\n' Author    : Philben\n' Purpose   : converting addresses into geographic coordinates\n' Parameter : No mandatory. string format or NULL\n' Reference : http://code.google.com/intl/fr-FR/apis/maps/documentation/geocoding/index.html\n' Remark    : Query limit of 2,500 geolocation requests per day\n'           : A good accuracy is different of a good geocoding !!!\n'           : Minimum delay between two queries : &gt;= 200 ms\n'---------------------------------------------------------------------------------------\nPublic Function Geocode(Optional ByVal vAddress As Variant = Null, _\n                        Optional ByVal vTown As Variant = Null, _\n                        Optional ByVal vPostCode As Variant = Null, _\n                        Optional ByVal vRegion As Variant = Null, _\n                        Optional ByVal sCountry As String = \"UNITED STATES+\") As tGeocodeResult\n   On Error GoTo catch\n   Dim oXmlDoc As Object\n   Dim sUrl As String, sFormatAddress As String\n   If Not IsNull(vAddress) Then vAddress = Replace(vAddress, \",\", \" \")\n   sFormatAddress = (vAddress + \",\") &amp; _\n                    (vTown + \",\") &amp; _\n                    (vRegion + \",\") &amp; _\n                    (vPostCode + \",\") &amp; _\n                    sCountry\n   'To create the URL\n   sUrl = \"http://maps.googleapis.com/maps/api/geocode/xml?address=\" &amp; sFormatAddress &amp; \"&amp;sensor=false\"\n   ''XMLDOM to get the XML response\n   Set oXmlDoc = CreateObject(\"Microsoft.XMLDOM\")\n   With oXmlDoc\n      .Async = False\n      If .Load(sUrl) And Not .selectSingleNode(\"GeocodeResponse/status\") Is Nothing Then\n         'Status code\n         Geocode.sStatus = .selectSingleNode(\"GeocodeResponse/status\").Text\n         'If a result is returned\n         If Not .selectSingleNode(\"GeocodeResponse/result\") Is Nothing Then\n            'formatted_address\n            Geocode.sRetAddress = .selectSingleNode(\"//formatted_address\").Text\n            'Accuracy\n            Geocode.sAccuracy = .selectSingleNode(\"//location_type\").Text\n            'Latitude and longitude\n            Geocode.dLatitude = Val(.selectSingleNode(\"//location/lat\").Text)\n            Geocode.dLongitude = Val(.selectSingleNode(\"//location/lng\").Text)\n         End If\n      End If\n   End With\n   Set oXmlDoc = Nothing\n   Exit Function\ncatch:\n   Set oXmlDoc = Nothing\n   Err.Raise Err.Number, , Err.Description\nEnd Function\n</code></pre>\n\n<p><strong>Example Results (Geocode.sRetAddress - formatted address):</strong></p>\n\n<p>good: 100 S Raymond Ave, Alhambra, CA 91801, USA<br>\ngood: 3040 Salt Creek Ln, Arlington Heights, IL 60005, USA<br>\nbad:  4th floor, 2450 Ashby Ave, Berkeley, CA 94705, USA   </p>\n\n<p><strong>Question</strong></p>\n\n<p>Any clue if the \"Floor\" component of the Formatted Address can be excluded, or alternatively explicitly return JUST the desired components?</p>\n\n<p>Thanks,</p>\n\n<p>Mark Pelletier</p>\n\n<p>PS>  I am currently counting the number of \",\" in the string and conditionally handling the parsing task.  But As a general purpose approach, there will likely be other exceptions I have not encountered yet.</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 1, "creation_date": 1508351370, "post_id": 46816835, "comment_id": 80581013, "body": "How do you expect these values to be returned? - Concatenated within 1 cell, or as an array? And what code have you tried so far?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1508351904, "post_id": 46816835, "comment_id": 80581279, "body": "Returned as an array.   I have strictly tried array formulas with index/match."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1508353768, "post_id": 46816835, "comment_id": 80582299, "body": "I have done this both with formula and a VBA code. With formulas, it will be really hard and it will put limitations, you need to go with the VBA solution. Look it up and you will find some stuff, unfortunately, I cannot just write the code for you here since this is not a write-me-the-code forum, but a Q &amp; A one"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1508354322, "post_id": 46816835, "comment_id": 80582609, "body": "Understandable. I am still in the process of learning how to write the code and a few are up to write solution for rep and i&#39;m hoping one of them stumbles across this. I agree that a VBA solution here is ideal."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1508354672, "post_id": 46816835, "comment_id": 80582780, "body": "You can combine <code>COUNTIF($A$2:A2,A2)</code> with the Index + Match formula found here <a href=\"https://www.extendoffice.com/documents/excel/2699-excel-vlookup-find-first-2nd-match.html\" rel=\"nofollow noreferrer\">How To Vlookup Find The First, 2nd Or Nth Match Value In Excel</a> .  The COUNTIF formula I provided is based off the running total pattern: <a href=\"https://fiveminutelessons.com/learn-microsoft-excel/calculate-running-total-column-cells-excel\" rel=\"nofollow noreferrer\">Calculate a running total of a column of cells in Excel</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1508353384, "post_id": 46817051, "comment_id": 80582109, "body": "&lt;a href=&quot;<a href=\"https://imgur.com/1Kz4NWP&quot;&gt;&lt;img\" rel=\"nofollow noreferrer\">imgur.com/1Kz4NWP&quot;&gt;&lt;img</a> src=&quot;<a href=\"https://i.imgur.com/1Kz4NWP.png\" rel=\"nofollow noreferrer\">i.imgur.com/1Kz4NWP.png</a>&quot; title=&quot;source: imgur.com&quot; /&gt;&lt;/a&gt;"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1508353448, "post_id": 46817051, "comment_id": 80582144, "body": "The setup would look like this with the output going down column B. I&#39;m sorry this wasn&#39;t clear above."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1508355190, "post_id": 46817051, "comment_id": 80583048, "body": "There is no need for the last <code>If</code> statement. <code>Join(dict.keys, &quot;, &quot;)</code> returns &quot;&quot; if the <code>dict.Count = 0</code>.  Of course it might be slightly more efficient to test if <code>dict.Count = 0</code> but in that case you can eliminate the <code>Else</code> block because `CustomVLookup returns &quot;&quot; if you don&#39;t assign it a value. Nice work +1."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1508405740, "post_id": 46817051, "comment_id": 80601186, "body": "@ThomasInzina I agree. The possibilities are endless. :)"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1508416316, "post_id": 46817051, "comment_id": 80607139, "body": "@ThomasInzina Thanks Lol"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 1, "last_activity_date": 1508351953, "creation_date": 1508351953, "answer_id": 46817051, "question_id": 46816835, "link": "https://stackoverflow.com/questions/46816835/vlookup-return-all-possible-values-not-unique/46817051#46817051", "title": "VLOOKUP return all possible values (not unique)", "body": "<p>Give this User Defined Function a try...</p>\n\n<pre><code>Function CustomVLookup(ByVal Lookup_Val As Range, Table_Array As Range, ColIndex As Integer) As String\nDim x, dict\nDim i As Long\nx = Table_Array.Value\nSet dict = CreateObject(\"Scripting.Dictionary\")\nFor i = 1 To UBound(x, 1)\n    If x(i, 1) = Lookup_Val.Value Then\n        dict.Item(x(i, ColIndex)) = \"\"\n    End If\nNext i\nIf dict.Count &gt; 0 Then\n    CustomVLookup = Join(dict.keys, \", \")\nElse\n    CustomVLookup = \"\"\nEnd If\nEnd Function\n</code></pre>\n\n<p>And then use it on the sheet like below...</p>\n\n<pre><code>=CustomVLookup(A2,F2:G25,2)\n</code></pre>\n\n<p>Where A2 is the cell which contains the lookup value, F2:G25 is the table array and 2 is the column index which is 2 i.e. column G in this case.</p>\n\n<p>Edit: The above function will return all the unique values which belong to the lookup value. If you want to return all the values not unique only, you will need a different approach. Let me know if that is the case.</p>\n"}], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1341, "favorite_count": 0, "accepted_answer_id": 46817051, "answer_count": 1, "score": -1, "last_activity_date": 1508351953, "creation_date": 1508351101, "question_id": 46816835, "link": "https://stackoverflow.com/questions/46816835/vlookup-return-all-possible-values-not-unique", "title": "VLOOKUP return all possible values (not unique)", "body": "<p>I need an array formula or VBA code that will work like a vlookup but will return all possible values instead of just the first value. </p>\n\n<p>If the lookup value corresponds to 5 unique values, I need the code to show all 5 values. </p>\n\n<p>We can assume the lookup values are going down Column A, the lookup range is columns F:G (with the 5 unique values in column G). </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508351236, "post_id": 46816608, "comment_id": 80580949, "body": "use SQL to get data from the worksheet"}], "answers": [{"tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": true, "score": 1, "last_activity_date": 1508351937, "creation_date": 1508351937, "answer_id": 46817050, "question_id": 46816608, "link": "https://stackoverflow.com/questions/46816608/disabling-macros-from-other-excel-sheets/46817050#46817050", "title": "Disabling macros from other Excel sheets", "body": "<p>This seems to open the file without the macros and it's read only.\nWhen testing this, I can't even see the macro module in VBA editor for the opened file..</p>\n\n<pre><code>Application.AutomationSecurity = msoAutomationSecurityForceDisable\nWorkbooks.Open Filename:=strFilepath &amp; strFilename, ReadOnly:=True\nApplication.AutomationSecurity = msoAutomationSecurityByUI\n</code></pre>\n"}], "owner": {"reputation": 3607, "user_id": 5865514, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/2998757368247/picture?type=large", "display_name": "Yu Chen", "link": "https://stackoverflow.com/users/5865514/yu-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1018, "favorite_count": 0, "accepted_answer_id": 46817050, "answer_count": 1, "score": 0, "last_activity_date": 1508353967, "creation_date": 1508350319, "last_edit_date": 1508353967, "question_id": 46816608, "link": "https://stackoverflow.com/questions/46816608/disabling-macros-from-other-excel-sheets", "title": "Disabling macros from other Excel sheets", "body": "<p>I'm working on a few VBA macros in Excel for a project. Is there a way to ensure that VBA macros don't launch from other Excel workbooks when you are opening them through a macro?</p>\n\n<p>For example, let's say I have a macro inside one workbook to open some other Excel file:</p>\n\n<pre><code>Sheets(\"Sheet1\").Select \nPathName = Range(\"D3\").Value \nFilename = Range(\"D4\").Value \nTabName = Range(\"D5\").Value \nControlFile = ActiveWorkbook.Name \nWorkbooks.Open Filename:=PathName &amp;; Filename \n</code></pre>\n\n<p>What I've usually done is include a <code>Application.EnableEvents = False</code> to the subroutine to ensure that I'm not triggering code upon opening the other workbooks. This is also the methodology suggested by this prior <a href=\"https://stackoverflow.com/questions/16301530/open-a-workbook-from-vba-and-disable-workbook-open-code\">SO post</a>.</p>\n\n<p>But two questions come to mind:</p>\n\n<ol>\n<li><p>Is this \"secure\"? Are there other ways that users could write their own macros that execute on my active application even if I disable events?</p></li>\n<li><p>Are there other workarounds besides fully disabling events? This seems somewhat limiting and almost \"throwing the baby out with the bathwater\".</p></li>\n</ol>\n"}, {"tags": ["excel", "vbscript", "vba"], "comments": [{"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1508351799, "post_id": 46816350, "comment_id": 80581216, "body": "Do you want a new sheet with the updated info (which would be a lot easier and faster), or are you wanting the current sheet modified ??"}, {"owner": {"reputation": 1, "user_id": 8797154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a32bdefa6a7a1947d938b5343aaa10a?s=128&d=identicon&r=PG&f=1", "display_name": "Damon Jones", "link": "https://stackoverflow.com/users/8797154/damon-jones"}, "reply_to_user": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1508422929, "post_id": 46816350, "comment_id": 80611783, "body": "I want it in a new sheet!  Thanks for your time, i do appreciate it"}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1508458781, "creation_date": 1508458781, "answer_id": 46840684, "question_id": 46816350, "link": "https://stackoverflow.com/questions/46816350/breakup-row-into-2-rows-pulling-specific-cells-into-each-row/46840684#46840684", "title": "breakup row into 2 rows, pulling specific cells into each row", "body": "<p>Study this code by stepping through each line, using <kbd>F8</kbd></p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub SplitRows()\n    Application.ScreenUpdating = False\n\n    Dim newWs As Worksheet\n    With ThisWorkbook.Worksheets\n        Set newWs = .Add(After:=Worksheets(.Count))         'Add a new ws\n        newWs.Name = Format(Now, \"yyyy-mmm-dd hh-mm-ss\")    'Rename it\n    End With\n\n    newWs.Range(\"A1:C1\") = Split(\"Contract VIN# Amount$\")   'Add headers to the new ws\n\n    Dim colA As Range\n    With ThisWorkbook.Worksheets(\"Sheet1\").UsedRange        'Get UsedRange in colA (Sheet1)\n        Set colA = .Columns(\"A\").Offset(1).Resize(.Rows.Count - 1, 1)\n    End With\n\n    Dim itm As Range, oldRow As Long, newRow As Long\n    oldRow = 1\n\n    For Each itm In colA.Cells\n        oldRow = oldRow + 1     'increment row on old sheet (Sheet1)\n        newRow = newRow + 2     'increment row on new sheet (double)\n        With newWs\n            .Cells(newRow, \"A\") = Sheet1.Cells(oldRow, \"A\")     'row1new(A) = row1old(A)\n            .Cells(newRow, \"B\") = Sheet1.Cells(oldRow, \"B\")     'row1new(B) = row1old(B)\n            .Cells(newRow, \"C\") = Sheet1.Cells(oldRow, \"C\")     'row1new(C) = row1old(C)\n            .Cells(newRow + 1, \"A\") = Sheet1.Cells(oldRow, \"A\") 'row2new(A) = row1old(A)\n            .Cells(newRow + 1, \"B\") = Sheet1.Cells(oldRow, \"B\") 'row2new(B) = row1old(B)\n            .Cells(newRow + 1, \"C\") = Sheet1.Cells(oldRow, \"D\") 'row2new(C) = row1old(D)\n        End With\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8797154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a32bdefa6a7a1947d938b5343aaa10a?s=128&d=identicon&r=PG&f=1", "display_name": "Damon Jones", "link": "https://stackoverflow.com/users/8797154/damon-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1508458781, "creation_date": 1508349420, "last_edit_date": 1531161705, "question_id": 46816350, "link": "https://stackoverflow.com/questions/46816350/breakup-row-into-2-rows-pulling-specific-cells-into-each-row", "title": "breakup row into 2 rows, pulling specific cells into each row", "body": "<p>I need to copy each row into 2 rows with certain columns from the orignal row separated into row 1 and row 2, using excel vba. What I need is demonstrated below:</p>\n\n<p>Input data:<br>\n<strong>Contract___VIN#____Interest$___Principal$</strong><br>\ncontract1___1234____$20________$400<br>\ncontract2___abcd____$40________$600</p>\n\n<p>Desired output:<br>\n<strong>Contract___VIN#____Amount$</strong><br>\ncontract1___1234____$20<br>\ncontract1___1234____$400<br>\ncontract2___abcd____$40<br>\ncontract2___abcd____$600</p>\n\n<p>I'm struggling with the concept of how to precisely navigate through rows and columns of ranges... I'm thinking this will be a for loop?</p>\n\n<p>Any help will be greatly appreciated</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1508347779, "post_id": 46815840, "comment_id": 80579092, "body": "If you are doing this for any thing worth of any importance. JUST DON&#39;T DO IT.  This is the worst way to schedule jobs."}, {"owner": {"reputation": 1383, "user_id": 5015813, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7FvAJ.jpg?s=128&g=1", "display_name": "Georgi Antonov", "link": "https://stackoverflow.com/users/5015813/georgi-antonov"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1508347823, "post_id": 46815840, "comment_id": 80579120, "body": "its important can you suggest how to to it then ?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 2, "creation_date": 1508348028, "post_id": 46815840, "comment_id": 80579230, "body": "One way would be to create a vb script to call/execute the excel macro.  Then schedule that vbs through windows scheduler."}, {"owner": {"reputation": 1383, "user_id": 5015813, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7FvAJ.jpg?s=128&g=1", "display_name": "Georgi Antonov", "link": "https://stackoverflow.com/users/5015813/georgi-antonov"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1508348228, "post_id": 46815840, "comment_id": 80579315, "body": "I just have to call GetTime on specific time of the day and each day how to schedule this GetTime using windows scheduler"}, {"owner": {"reputation": 3640, "user_id": 5463636, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hwpDa.jpg?s=128&g=1", "display_name": "freginold", "link": "https://stackoverflow.com/users/5463636/freginold"}, "edited": false, "score": 0, "creation_date": 1508349109, "post_id": 46815840, "comment_id": 80579775, "body": "@GeorgiAntonov How to schedule your task via Windows Task Scheduler would probably be a good question to ask on the <a href=\"https://superuser.com/\">Super User</a> site."}], "answers": [{"comments": [{"owner": {"reputation": 1383, "user_id": 5015813, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7FvAJ.jpg?s=128&g=1", "display_name": "Georgi Antonov", "link": "https://stackoverflow.com/users/5015813/georgi-antonov"}, "edited": false, "score": 0, "creation_date": 1508349534, "post_id": 46816159, "comment_id": 80580008, "body": "why to close the workbook i might want to still operate it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 1383, "user_id": 5015813, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7FvAJ.jpg?s=128&g=1", "display_name": "Georgi Antonov", "link": "https://stackoverflow.com/users/5015813/georgi-antonov"}, "edited": false, "score": 0, "creation_date": 1508350016, "post_id": 46816159, "comment_id": 80580284, "body": "If you want to use your approach and use Task Scheduler to open a file everyday, you need to close the file and let the TaskScheduler open the file again and call the Workbook_Open event. If you open a file that is already open, Workbook_Open event will not be called."}, {"owner": {"reputation": 1383, "user_id": 5015813, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7FvAJ.jpg?s=128&g=1", "display_name": "Georgi Antonov", "link": "https://stackoverflow.com/users/5015813/georgi-antonov"}, "edited": false, "score": 0, "creation_date": 1509042012, "post_id": 46816159, "comment_id": 80869846, "body": "ill use the first method. but I dont like to close the excel since im doing stuff on it and i need it opened."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1508348635, "creation_date": 1508348635, "answer_id": 46816159, "question_id": 46815840, "link": "https://stackoverflow.com/questions/46815840/call-public-sub-each-day-at-specific-time-without-reopening-the-file-again/46816159#46816159", "title": "Call public sub each day at specific time without reopening the file again", "body": "<p>Try using the following code:</p>\n\n<pre><code>Private Sub Workbook_Open()\n   Call DailyRun\nEnd Sub\n</code></pre>\n\n<p>DailyRun code:</p>\n\n<pre><code>Sub DailyRun()\n    Application.OnTime TimeValue(\"22:40:00\"), \"GetTime\"    \n    Application.OnTime TimeValue(\"23:59:00\"), \"DailyRun\"\nEnd Sub\n</code></pre>\n\n<p>The <em>DailyRun</em> macro calls itself at the end of each day to create new Ontime event.</p>\n\n<p>If you want to run the macro using Windows <strong>Task Scheduler</strong>, add your macro to Workbook Open event:</p>\n\n<pre><code>Private Sub Workbook_Open()\n  Application.OnTime TimeValue(\"22:40:00\"), \"GetTime\"\n  Me.Close\nEnd Sub\n</code></pre>\n\n<p>Don't forget to close your workbook.</p>\n"}], "owner": {"reputation": 1383, "user_id": 5015813, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7FvAJ.jpg?s=128&g=1", "display_name": "Georgi Antonov", "link": "https://stackoverflow.com/users/5015813/georgi-antonov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508348635, "creation_date": 1508347321, "question_id": 46815840, "link": "https://stackoverflow.com/questions/46815840/call-public-sub-each-day-at-specific-time-without-reopening-the-file-again", "title": "Call public sub each day at specific time without reopening the file again", "body": "<p>I have this public sub defined in Module 1 of my excel workbook</p>\n\n<pre><code>Public Sub AutoUpdate()\n    Application.OnTime TimeValue(\"22:40:00\"), \"GetTime\"\nEnd Sub\n</code></pre>\n\n<p>And in my workbook code i have this to call this AutoUpdate method.</p>\n\n<pre><code>Public Sub Workbook_Open()\n    Call AutoUpdate\nEnd Sub\n</code></pre>\n\n<p>My problem is that when i open the file it ways the time to be 22:40:00 and it calls <code>\"GetTime\"</code> but then on the next day the excel either crashes or the function is not called again.\nIs this <code>Application.OnTime method</code>  working for each day without needing to reopen ( refresh ) the workbook again.</p>\n"}, {"tags": ["html", "excel", "web-scraping", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 8796677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4863e36214bda057abb32c350dc82bcc?s=128&d=identicon&r=PG&f=1", "display_name": "Adam R", "link": "https://stackoverflow.com/users/8796677/adam-r"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1508351295, "post_id": 46815445, "comment_id": 80580978, "body": "Thanks for the advice Shahin! I&#39;ve added a few more details of what exactly i&#39;m looking for, I hope that helps explain what I&#39;m looking to do."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8796677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4863e36214bda057abb32c350dc82bcc?s=128&d=identicon&r=PG&f=1", "display_name": "Adam R", "link": "https://stackoverflow.com/users/8796677/adam-r"}, "edited": false, "score": 0, "creation_date": 1508351349, "post_id": 46816386, "comment_id": 80581002, "body": "Thanks, I&#39;m going to give this a swing and see how I can play with it to make it fit what I need."}], "tags": [], "owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "is_accepted": false, "score": 1, "last_activity_date": 1508349548, "creation_date": 1508349548, "answer_id": 46816386, "question_id": 46815445, "link": "https://stackoverflow.com/questions/46815445/excel-macros-using-excel-data-to-scrape-html-page/46816386#46816386", "title": "Excel Macros - Using Excel Data to scrape HTML page", "body": "<p>This is the code I use for scraping a web page on our company site. I put all my data in column B, so make adjustments accordingly. This should get you started.</p>\n\n<pre><code>Sub TestScrape()\n'   SCRAPE A WEB PAGE\nDim ieDoc As New HTMLDocument 'ieDocDocument\nDim tdCollection As Object 'table that has the javascript attributes and contains the element I want to click\nDim AnchorLinks As Object\nDim tdElements As Object\nDim tdElement As Object\nDim AnchorLink As Object\nDim lRow As Long\nDim ie As InternetExplorer\nDim cls As IHTMLElementCollection\n\nSet ie = New SHDocVw.InternetExplorer\n With ie\n   .Visible = True\n   .Left = 0\n   .TheaterMode = True   '&lt;&lt;-- Comment this out if you don't want Theater Mode\n   .Navigate url:=\"Enter your URL here\"\n\n   While .ReadyState &lt; 4 Or .Busy:  DoEvents:  Wend\n\n End With\n\n        Application.Wait Now + TimeSerial(0, 0, 4)\n\n\nieDoc.body.innerHTML = ie.Document.body.innerHTML\n\nWith ieDoc.body\n    Set AnchorLinks = .getElementsByTagName(\"table\")\n    Set tdElements = .getElementsByTagName(\"td\") '\n\n    For Each AnchorLink In AnchorLinks\n        Debug.Print AnchorLink.innerText\n    Next AnchorLink\n\nEnd With\n\nlRow = 1\n   For Each tdElement In tdElements\n      Debug.Print tdElement.innerText\n      Cells(lRow, 2).Value = tdElement.innerText\n      lRow = lRow + 1\n   Next\n     Application.Wait (Now + TimeValue(\"0:00:1\"))\n With ie\n  .TheaterMode = False\n  .Quit\n End With\nSet ie = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8796677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4863e36214bda057abb32c350dc82bcc?s=128&d=identicon&r=PG&f=1", "display_name": "Adam R", "link": "https://stackoverflow.com/users/8796677/adam-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 654, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508351246, "creation_date": 1508345840, "last_edit_date": 1531164843, "question_id": 46815445, "link": "https://stackoverflow.com/questions/46815445/excel-macros-using-excel-data-to-scrape-html-page", "title": "Excel Macros - Using Excel Data to scrape HTML page", "body": "<p>As with many other questions, I'm really new to using Excel macros and HTML. </p>\n\n<p>I'm building a table with entries of items from Dungeons and Dragons (DnD) that I want to get descriptions of from a particular web page: <a href=\"http://www.5esrd.com/gamemastering/magic-items/\" rel=\"nofollow noreferrer\">http://www.5esrd.com/gamemastering/magic-items/</a> . For example, An entry in my table would be Adamantine Armor, so I would want the macro to search the web page for that listing, scrape the description that's entered on the webpage and save that to the excel document. In this case, that specific description (as per the 5esrd webpage) is as follows: </p>\n\n<p>Armor (medium or heavy, but not hide), uncommon</p>\n\n<p>This suit of armor is reinforced with adamantine, one of the hardest substances in existence. While you\u2019re wearing it, any critical hit against you becomes a normal hit.</p>\n\n<p>On this page, all the items are links to pages that have them grouped by type (Sword, wand, etc.). I would like to iterate through my row of items in Excel, search for that item on the page and scrape its description into my excel table. </p>\n\n<p>I was following along this page: <a href=\"https://www.wiseowl.co.uk/blog/s393/scrape-website-html.htm\" rel=\"nofollow noreferrer\">https://www.wiseowl.co.uk/blog/s393/scrape-website-html.htm</a>, which scrapes data from stackoverflow's home page. It directly targets some of the tables that the web page uses to organize its entries. The DnD page I'm trying to use doesn't organize its entries into tables like this, so I'm a little lost with how to proceed.</p>\n\n<p>If anyone could help point me in the right direction, I would be very grateful!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 1, "creation_date": 1508346537, "post_id": 46815412, "comment_id": 80578523, "body": "yes, it is possible, but I could not figure out quickly how your code should work since I don&#39;t have the whole Excel file here. I have a code like that, but I use listbox. Can you explain how your code is supposed to work?"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1508356589, "post_id": 46815412, "comment_id": 80583728, "body": "Ditto...  I think you have cells with drop-down boxes in them, and each drop-down has different elements.  He can choose several elements from different drop-downs, and these can be formatted and concatenated together to be sent to another system.  Right?  And once the user selects an item from a particular dropdown and it is sent to the other system, then you want that item to be removed from that drop down.  Is that what you are asking?"}, {"owner": {"reputation": 961, "user_id": 8054843, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5509c35e6566c57c5ec9fe5e7d559181?s=128&d=identicon&r=PG&f=1", "display_name": "ipenguin67", "link": "https://stackoverflow.com/users/8054843/ipenguin67"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1508359965, "post_id": 46815412, "comment_id": 80585441, "body": "@JohnMuggins Not quite, but close. There&#39;s another sub on this page (selectionchange event) that dynamically adjusts data validation based on lists on another page. Let&#39;s say my list is Business Units. When a client uses this drop down in the cell, they can select more than one business unit. The code allows them to do so and it will format it like &quot;Unit 1&quot;,&quot;Unit2&quot; which allows us to upload the data into our site. We need to be able to unselect Unit 2 in some way and have it removed. Directly editing/deleting doesn&#39;t work b/c &quot;Unit 1&quot; isn&#39;t in the list, Unit 1 is."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1508876474, "post_id": 46815412, "comment_id": 80786134, "body": "Let me try again:  A user has a drop-down list with several items.  He can choose Multiple items.  If he mistakenly chooses an incorrect item, then you want a way for him to deselect that item?  I&#39;ll take a look at n alternative.  Give me a day or two."}], "answers": [{"comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1508950512, "post_id": 46935847, "comment_id": 80823189, "body": "I forgot to mention:  To remove an item from the target.cell string, simply select it again from the drop box.  It will search the string for that item and delete it from the target.cell if found, or add it to the target.cell if not found in the instr function."}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 1, "last_activity_date": 1508943772, "creation_date": 1508943772, "answer_id": 46935847, "question_id": 46815412, "link": "https://stackoverflow.com/questions/46815412/vba-removing-values-from-a-multi-select-field/46935847#46935847", "title": "VBA: Removing values from a multi-select field", "body": "<p>You need to remove the \"If\" statement that prohibits doubles of the same item to be able to delete it from the string.  Try the following code, leaving the doubles statement commented out.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    'Updated: 2016/4/12\n    Dim xRng As Range\n    Dim xValue1 As String\n    Dim xValue2 As String\n    If Target.Count &gt; 1 Then Exit Sub\n    On Error Resume Next\n    Set xRng = Cells.SpecialCells(xlCellTypeAllValidation)\n    If xRng Is Nothing Then Exit Sub\n    Application.EnableEvents = False\n    If Not Application.Intersect(Target, xRng) Is Nothing Then\n        xValue2 = Target.Value\n        Application.Undo\n        xValue1 = Target.Value\n        Target.Value = xValue2\n        If xValue1 &lt;&gt; \"\" Then\n            If xValue2 &lt;&gt; \"\" Then\n'                If xValue1 = xValue2 Or _\n'                   InStr(1, xValue1, \", \" &amp; xValue2) Or _\n                   InStr(1, xValue1, xValue2 &amp; \",\") Then\n                If InStr(1, xValue1, xValue2 &amp; \",\") &gt; 0 Then\n                    xValue1 = Replace(xValue1, xValue2 &amp; \", \", \"\") ' If it's in the middle with comma\n                    Target.Value = xValue1\n                    GoTo jumpOut\n                End If\n                If InStr(1, xValue1, \", \" &amp; xValue2) &gt; 0 Then\n                    xValue1 = Replace(xValue1, \", \" &amp; xValue2, \"\") ' If it's at the end with a comma in front of it\n                    Target.Value = xValue1\n                    GoTo jumpOut\n                End If\n                If xValue1 = xValue2 Then ' If it is the only item in string\n                    xValue1 = \"\"\n                    Target.Value = xValue1\n                    GoTo jumpOut\n                End If\n                Target.Value = xValue1 &amp; \", \" &amp; xValue2\n            End If\njumpOut:\n        End If\n    End If\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6440, "user_id": 3768332, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qXVHN.jpg?s=128&g=1", "display_name": "Jamie Counsell", "link": "https://stackoverflow.com/users/3768332/jamie-counsell"}, "is_accepted": false, "score": 0, "last_activity_date": 1548262993, "creation_date": 1548262993, "answer_id": 54332252, "question_id": 46815412, "link": "https://stackoverflow.com/questions/46815412/vba-removing-values-from-a-multi-select-field/54332252#54332252", "title": "VBA: Removing values from a multi-select field", "body": "<p>I had a few issues with John's answer, where values like \"707\" and \"7\" would cause problems. Here's the script I ended up using. Note that the implementation of the first part is a bit different too.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n'Code by Sumit Bansal from https://trumpexcel.com\n' To allow multiple selections in a Drop Down List in Excel (without repetition)\nApplication.EnableEvents = True\nOn Error GoTo Exitsub\nIf Target.Column = 9 Then\n    If Target.SpecialCells(xlCellTypeAllValidation) Is Nothing Then\n        GoTo Exitsub\n    ElseIf Target.Value = \"\" Then\n        GoTo Exitsub\n    Else\n        Application.EnableEvents = False\n        Newvalue = Target.Value\n        Application.Undo\n        Oldvalue = Target.Value\n        Target.Value = Newvalue\n       If Oldvalue &lt;&gt; \"\" Then\n            If Newvalue &lt;&gt; \"\" Then\n                If InStr(1, Oldvalue, \", \" &amp; Newvalue &amp; \",\") &gt; 0 Then\n                    Oldvalue = Replace(Oldvalue, Newvalue &amp; \", \", \"\") ' If it's in the middle with comma\n                    Target.Value = Oldvalue\n                    GoTo jumpOut\n                End If\n                If Left(Oldvalue, Len(Newvalue &amp; \", \")) = Newvalue &amp; \", \" Then\n                    Oldvalue = Replace(Oldvalue, Newvalue &amp; \", \", \"\") ' If it's at the start with comma\n                    Target.Value = Oldvalue\n                    GoTo jumpOut\n                End If\n                If Right(Oldvalue, Len(\", \" &amp; Newvalue)) = \", \" &amp; Newvalue Then\n                    Oldvalue = Left(Oldvalue, Len(Oldvalue) - Len(\", \" &amp; Newvalue)) ' If it's at the end with a comma in front of it\n                    Target.Value = Oldvalue\n                    GoTo jumpOut\n                End If\n                If Oldvalue = Newvalue Then ' If it is the only item in string\n                    Oldvalue = \"\"\n                    Target.Value = Oldvalue\n                    GoTo jumpOut\n                End If\n                Target.Value = Oldvalue &amp; \", \" &amp; Newvalue\n            End If\njumpOut:\n        End If\n    End If\nEnd If\nApplication.EnableEvents = True\nExitsub:\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 961, "user_id": 8054843, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5509c35e6566c57c5ec9fe5e7d559181?s=128&d=identicon&r=PG&f=1", "display_name": "ipenguin67", "link": "https://stackoverflow.com/users/8054843/ipenguin67"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2156, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1548262993, "creation_date": 1508345731, "question_id": 46815412, "link": "https://stackoverflow.com/questions/46815412/vba-removing-values-from-a-multi-select-field", "title": "VBA: Removing values from a multi-select field", "body": "<p>I have a page in my workbook where certain cells are multi-select. Users can choose values from a dropdown list and it will append them and format them to be uploaded into our system. It works great -- but there's just one problem. There's no way to remove a single value currently. If a user selects the wrong value from the dropdown, they'd have to delete and start over. Is there a way to remove individual values? Here's the current multi-select code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim rngDV As Range\nDim oldVal As String\nDim newVal As String\nDim strSep As String\nDim strSep2 As String\nDim header As String\nDim MatchField As Range\nDim AnsType As Range\n\nApplication.ScreenUpdating = False\n\nstrSep = Chr(34) &amp; \",\" &amp; Chr(34)\nstrSep2 = \",\" &amp; Chr(34)\n\nheader = Me.Cells(11, Target.Column).Value \nSet MatchField = ThisWorkbook.Worksheets(\"User Fields\").Range(\"B16:B100\").Find(header) \n\nIf Not MatchField Is Nothing Then\n    Set AnsType = MatchField.Offset(0, 2) \nEnd If\n\nApplication.EnableEvents = False\nOn Error Resume Next\n\nIf Target.Count &gt; 1 Then GoTo exitHandler \n\nSet rngDV = Cells.SpecialCells(xlCellTypeAllValidation)\nOn Error GoTo exitHandler\n\nIf rngDV Is Nothing Then GoTo exitHandler\n\nIf Intersect(Target, rngDV) Is Nothing Then \n   'do nothing\nElse 'cell has data validation\n    If InStr(1, AnsType, \"Multiple\") &gt; 0 Then 'Determines if current column corresponds to a multi-select field\n\n    newVal = Target.Value \n    Application.Undo \n    oldVal = Target.Value \n    Target.Value = newVal \n\n    If newVal = \"\" Then\n        'do nothing\n    Else \n        If oldVal = \"\" Then \n            Target.Value = newVal \n        ElseIf InStr(1, oldVal, newVal) = 0 Then \n            If InStr(1, oldVal, Chr(34)) &gt; 0 Then \n                Target.Value = oldVal &amp; strSep2 &amp; newVal &amp; Chr(34) \n            Else \n                Target.Value = Chr(34) &amp; oldVal &amp; strSep &amp; newVal &amp; Chr(34) \n            End If\n        Else\n            Target.Value = oldVal\n        End If\n    End If\n  End If\nEnd If\nApplication.ScreenUpdating = True\nexitHandler:\n  Application.EnableEvents = True\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1508345480, "post_id": 46815277, "comment_id": 80577991, "body": "You have to use <code>Cells(r.Row + 1, &quot;C&quot;)</code> etc - either individual lines or set up a loop. In your <code>rng</code> line you should specify a sheet too."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 8726203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b4c57199fbe70fb04cc65c978590df?s=128&d=identicon&r=PG&f=1", "display_name": "Rmoore", "link": "https://stackoverflow.com/users/8726203/rmoore"}, "edited": false, "score": 0, "creation_date": 1508346767, "post_id": 46815595, "comment_id": 80578634, "body": "So that is getting closer to what I am looking for! At least I get some highlighted cells! It looks like it is only highlighting cells PAST the range area.. so if J2 through J10 in the range, J11 is being highlighted only."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 35, "user_id": 8726203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b4c57199fbe70fb04cc65c978590df?s=128&d=identicon&r=PG&f=1", "display_name": "Rmoore", "link": "https://stackoverflow.com/users/8726203/rmoore"}, "edited": false, "score": 0, "creation_date": 1508347102, "post_id": 46815595, "comment_id": 80578777, "body": "Past, as in the next row? If that&#39;s the case, it&#39;s because your code called for r.row + 1. You could remove the +1. I updated the code for <code>row = r.row</code> rather than <code>row = r.row + 1</code>. See if that helps."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 35, "user_id": 8726203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b4c57199fbe70fb04cc65c978590df?s=128&d=identicon&r=PG&f=1", "display_name": "Rmoore", "link": "https://stackoverflow.com/users/8726203/rmoore"}, "edited": false, "score": 0, "creation_date": 1508347663, "post_id": 46815595, "comment_id": 80579027, "body": "I just reread you question as well. You were wanting to highlight cells when <code>L</code> was not blank. So I updated your portion of the code from <code>If r.Value = &quot;&quot; Then</code> to <code>If r.Value &lt;&gt; &quot;&quot; Then</code>"}, {"owner": {"reputation": 35, "user_id": 8726203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b4c57199fbe70fb04cc65c978590df?s=128&d=identicon&r=PG&f=1", "display_name": "Rmoore", "link": "https://stackoverflow.com/users/8726203/rmoore"}, "edited": false, "score": 0, "creation_date": 1508347877, "post_id": 46815595, "comment_id": 80579146, "body": "Thanks.. that should I been something I caught when I looked at the code anyway.. just one of those days where I&#39;ve been looking at it all day and things start to blend together :)   Thanks for your help!"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1508347610, "last_edit_date": 1508347610, "creation_date": 1508346368, "answer_id": 46815595, "question_id": 46815277, "link": "https://stackoverflow.com/questions/46815277/vba-highlight-cells-when-other-value-is-present/46815595#46815595", "title": "VBA Highlight Cells When Other Value is Present", "body": "<p>One method would be to <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-union-method-excel\" rel=\"nofollow noreferrer\">create a union of ranges</a>.</p>\n\n<pre><code>Sub test()\n\n    Dim Rng As Range, r As Range, uRng As Range, row As Long\n\n    Set wb = ThisWorkbook\n    Set sht1 = wb.Sheets(\"From GIS\")\n    Set sht2 = wb.Sheets(\"To MapCall\")\n\n    Set Rng = Intersect(sht2.UsedRange, Range(\"L:L\")).Cells\n\n    For Each r In Rng\n        If r.Value &lt;&gt; \"\" Then\n            row = r.row\n\n            Set uRng = Union(Cells(row, \"C\"), Cells(row, \"J\"))  'Etc... Keep going with each column\n            uRng.Interior.Color = RGB(255, 255, 0)\n\n        End If\n    Next r\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 8726203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b4c57199fbe70fb04cc65c978590df?s=128&d=identicon&r=PG&f=1", "display_name": "Rmoore", "link": "https://stackoverflow.com/users/8726203/rmoore"}, "edited": false, "score": 0, "creation_date": 1508347753, "post_id": 46815609, "comment_id": 80579076, "body": "Great! That does just what I was looking for! For clarification, I am using r.Row+1 because I want it to skip the row of headers. If there is an easier way to do this, I&#39;m all ears. I don&#39;t use VBA in my job but have been asked to learn it for this project. This site has been invaluable! Thank you."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 35, "user_id": 8726203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b4c57199fbe70fb04cc65c978590df?s=128&d=identicon&r=PG&f=1", "display_name": "Rmoore", "link": "https://stackoverflow.com/users/8726203/rmoore"}, "edited": false, "score": 0, "creation_date": 1508348515, "post_id": 46815609, "comment_id": 80579473, "body": "@Rmoore You&#39;r welcome! Glad it worked. Stick with it if it works for you that way."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 1, "last_activity_date": 1508346448, "creation_date": 1508346448, "answer_id": 46815609, "question_id": 46815277, "link": "https://stackoverflow.com/questions/46815277/vba-highlight-cells-when-other-value-is-present/46815609#46815609", "title": "VBA Highlight Cells When Other Value is Present", "body": "<p>Please give this a try and change r.Value = \"\" to r.Value &lt;> \"\" as you want to apply a color if something is entered in the range not when it is blank. Tweak it as per what you actually need. I am also not sure why have you used r.Row + 1? It that's not what you want, replace i = r.Row + 1 in the below code with i = r.Row.</p>\n\n<p>Also it's a good practice to declare all the variables used in the code.</p>\n\n<pre><code>Dim wb As Workbook\nDim sht1 As Worksheet, sht2 As Worksheet\nDim rng As Range, r As Range, clrRng As Range\nDim i As Long\nSet wb = ThisWorkbook\nSet sht1 = wb.Sheets(\"From GIS\")\nSet sht2 = wb.Sheets(\"To MapCall\")\n\nSet rng = Intersect(sht2.UsedRange, Range(\"L:L\")).Cells\nFor Each r In rng\n    If r.Value = \"\" Then\n        i = r.Row + 1\n        Set clrRng = Union(Range(\"C\" &amp; i), Range(\"J\" &amp; i &amp; \":K\" &amp; i), Range(\"Q\" &amp; i), Range(\"AI\" &amp; i), Range(\"AV\" &amp; i &amp; \":AZ\" &amp; i), Range(\"BR\" &amp; i))\n        clrRng.Interior.Color = RGB(255, 255, 0)\n    End If\nNext r\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8726203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b4c57199fbe70fb04cc65c978590df?s=128&d=identicon&r=PG&f=1", "display_name": "Rmoore", "link": "https://stackoverflow.com/users/8726203/rmoore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 823, "favorite_count": 0, "accepted_answer_id": 46815609, "answer_count": 2, "score": 0, "last_activity_date": 1508347610, "creation_date": 1508345236, "question_id": 46815277, "link": "https://stackoverflow.com/questions/46815277/vba-highlight-cells-when-other-value-is-present", "title": "VBA Highlight Cells When Other Value is Present", "body": "<p>I am looking to highlight certain cells in a spreadsheet when a value is entered in a different column. I realize this can be done with conditional formatting but, due to circumstances within the company, I must use VBA. (The spreadsheet is passed onto another program that can't read conditional formatting)</p>\n\n<p>I am trying to highlight 11 different columns within my range of values whenever <strong>ANYTHING</strong> is entered into column L. For example, when a date it entered in L2, then C2, J2, K2, etc. are highlighted yellow. </p>\n\n<p>Below is what I have come up with.. unfortunately, when I run the macro, nothing happens. I see it run, but I get no results - not even an error message. Thanks in advance for the time you take to help me out!</p>\n\n<pre><code>Dim rng As Range, r As Range\n\nSet wb = ThisWorkbook\nSet sht1 = wb.Sheets(\"From GIS\")\nSet sht2 = wb.Sheets(\"To MapCall\")\n\nSet rng = Intersect(sht2.UsedRange, Range(\"L:L\")).Cells\n\n\nFor Each r In rng\n    If r.Value = \"\" Then\n        Cells(r.Row + 1, \"C,J,K,Q,AI,AV,AW,AX,AY,AZ,BR\").Interior.Color = RGB(255, 255, 0)\n\n    End If\nNext r\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1508344196, "post_id": 46814908, "comment_id": 80577296, "body": "lRow is defined as a <code>Long</code> but you are trying to set it equal to a <code>Range</code> object."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1508344792, "post_id": 46814908, "comment_id": 80577601, "body": "@braX How and where?"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1508345197, "post_id": 46814908, "comment_id": 80577819, "body": "@braX your statement is wrong, since there is <code>.Row</code> at the end of <code>range</code> which makes it is numeric and not range, who upvoted that should be downvoted himself"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1508345242, "post_id": 46814908, "comment_id": 80577852, "body": "It doesn&#39;t show you the line the error occurs on? Also, you do have a <code>SchoolName</code> named range, correct?  As for <code>lrow</code>, perhaps skip using <code>Find</code> and do <code>Range(&quot;A&quot;&amp;Rows.Count).End(xlUp).Row</code>, or use <code>xlDown</code> from <code>A1</code>, if it&#39;s contiguous data and you have gaps where there are other things you don&#39;t consider part of the table.)  Also, <code>SchoolMatch</code> should be a <b><code>Range</code></b>, not <code>Object</code> I believe. That may be causing an error."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1508345358, "post_id": 46814908, "comment_id": 80577931, "body": "@LindyNewman use F8 to run and it will run it line by line and the moment that it is executing the problematic line it will throw the error, that way you can tell us which line is the problem"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1508345707, "post_id": 46814908, "comment_id": 80578111, "body": "Why not change it to a combobox and set the RowSource to your list of schools in the worksheet.  This would eliminate any need for them to type in the name.  They select it from your list."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1508348436, "last_edit_date": 1508348436, "creation_date": 1508345690, "answer_id": 46815397, "question_id": 46814908, "link": "https://stackoverflow.com/questions/46814908/vba-range-find-procedure-cant-find-type-mismatch/46815397#46815397", "title": "VBA Range.Find procedure - can&#39;t find Type Mismatch", "body": "<p>It looks like the use of <code>Object</code> may be causing the error.  Also, with a slight tweak to how <code>lRow</code> is assigned, this should run better:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub cbtnSearchSchool_Click()\n\nDim lrow As Long\nDim schoolmatch As Range\n\n'defines \"lrow\" as the last completely empty row in the table\nlrow = Range(\"A1\").End(xlDown).Row\n\n'defines \"schoolmatch\" variable as the first school in the list that\n'matches what was entered in the text box.\nSet schoolmatch = Range(\"SchoolName\").find(What:=txtbSchoolName.Value, _\n    After:=ActiveCell, _\n    LookIn:=xlValues, _\n    LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, _\n    SearchDirection:=xlNext, _\n    MatchCase:=False, _\n    SearchFormat:=False)\n\n'returns value of first found cell to check for accuracy\nMsgBox schoolmatch.Value\n</code></pre>\n\n<p>A note with <code>lRow</code>, if say cell <code>A100</code> is empty but <code>B100</code> isn't, it will improperly assign that row (row <code>100</code>) as the last row.  </p>\n\n<p>If you really need to make sure this doesn't happen (same with your OP), you could loop through all rows until a blank.  Like this perhaps:</p>\n\n<pre><code>lRow = 1\nDo While WorksheetFunction.CountA(Rows(lRow)) &lt;&gt; 0\n    lRow  = lRow  + 1\nLoop\nDebug.print \"Last row is: \" &amp; lRow\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8767513, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8pbfFgx9Oco/AAAAAAAAAAI/AAAAAAAAALY/H5FtY0znJKM/photo.jpg?sz=128", "display_name": "Lindy Newman", "link": "https://stackoverflow.com/users/8767513/lindy-newman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508427239, "creation_date": 1508343930, "last_edit_date": 1508356693, "question_id": 46814908, "link": "https://stackoverflow.com/questions/46814908/vba-range-find-procedure-cant-find-type-mismatch", "title": "VBA Range.Find procedure - can&#39;t find Type Mismatch", "body": "<p>I'm working on a database for my workplace, which is the Outreach department of a large science center. We have a lot of schools that violate our (pretty specific) contract, so we're looking to track and reduce these violations.</p>\n\n<p>To cut down on misspellings that would make searching the database later more difficult, I want the user (when entering a new school) to pull up the Userform, enter the name of their school, then click a search button to populate a listbox with the names of schools that match what they entered. If they click on a school in that list, the form uses that as the school name. If not, it prompts them to enter a new school name.</p>\n\n<p>My code is pretty basic right now. I'm trying to use a Find &amp; FindNext procedure to pull up all instances of a school name, but I'm getting a Type Mismatch error (#13) with the code I have currently and I can't find where that might come from. I've checked that no variables or Userform objects are misspelled.</p>\n\n<p>I want the Find function to return only the Range of the first cell, so that I can turn it into .Address or .Value as needed.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub cbtnSearchSchool_Click()\n\nDim lrow As Long\nDim schoolmatch As Range\n\n'defines \"lrow\" as the last completely empty row in the table\nlrow = Cells.find(What:=\"\", _\n        After:=Range(\"A1\"), _\n        LookIn:=xlValues, _\n        LookAt:=xlPart, _\n        SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, _\n        MatchCase:=False, _\n        SearchFormat:=False).Row\n\nRange(\"A1\").Activate\n\n'defines \"schoolmatch\" variable as the first school in the list that\n'matches what was entered in the text box.\nSet schoolmatch = Range(\"SchoolName\").find(What:=txtbSchoolName.Value, _\n    After:=ActiveCell, _\n    LookIn:=xlValues, _\n    LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, _\n    SearchDirection:=xlNext, _\n    MatchCase:=False, _\n    SearchFormat:=False)\n\n'returns value of first found cell to check for accuracy\nMsgBox schoolmatch.Value\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/gSF3a.png\" rel=\"nofollow noreferrer\">This is a photo of the Userform if anybody would like to see it.</a></p>\n\n<p>Edit: Sorry, I actually dimensioned schoolmatch as a Range originally and just changed it to Object while I was debugging - I got the same error before and after changing it.</p>\n\n<p>It shows me the line I'm getting the error on - it's the <code>Set schoolmatch = Range.Find</code> operation, but I can't figure out anywhere that I would be mixing up data types. I have a SchoolName range that I've double-checked, and I've checked all of the other variable names for misspellings.</p>\n\n<p>Over time there will be thousands of schools on this list, so this search function is necessary to filter some results before users select a school on the form.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 3, "creation_date": 1508344295, "post_id": 46814866, "comment_id": 80577351, "body": "If you are simply doing this to create a file name when saving, why don&#39;t you just set the format when you create the file name itself? <code>FileName = Format(MyRng, &quot;MM-DD-YYYY&quot;)</code>"}, {"owner": {"reputation": 9, "user_id": 5656058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa595deccc82a62ba02cff2eee2d78e?s=128&d=identicon&r=PG&f=1", "display_name": "Calderon315", "link": "https://stackoverflow.com/users/5656058/calderon315"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1508353815, "post_id": 46814866, "comment_id": 80582333, "body": "Thanks @K.Davis, but @stenci had the approach I was looking for. Without going into too much detail, I needed the format to be with hyphens in Excel as I was opening that file with a Mitutoyo program to extract data within. When I used <code>Range(&quot;A1&quot;).value</code> it would still give me the date with <code>&#47;</code> rather than <code>-</code> which was a problem. Within that program I was building a file path using this variable assigned to <code>Range(&quot;A1&quot;).value</code>."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 5656058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa595deccc82a62ba02cff2eee2d78e?s=128&d=identicon&r=PG&f=1", "display_name": "Calderon315", "link": "https://stackoverflow.com/users/5656058/calderon315"}, "edited": false, "score": 0, "creation_date": 1508353584, "post_id": 46814959, "comment_id": 80582212, "body": "This is what helped my problem, thank you. Never thought of this solution."}], "tags": [], "owner": {"reputation": 7225, "user_id": 1899628, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PAWN2.png?s=128&g=1", "display_name": "stenci", "link": "https://stackoverflow.com/users/1899628/stenci"}, "is_accepted": true, "score": 0, "last_activity_date": 1508344120, "creation_date": 1508344120, "answer_id": 46814959, "question_id": 46814866, "link": "https://stackoverflow.com/questions/46814866/replacing-forward-slash-with-hyphen-in-date-vba/46814959#46814959", "title": "Replacing forward slash with hyphen in date VBA", "body": "<p>Using <code>Range(\"A1\").Text</code> instead of <code>Range(\"A1\").Value</code> you get whatever formatting was applied to the cell.</p>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1508344386, "creation_date": 1508344386, "answer_id": 46815042, "question_id": 46814866, "link": "https://stackoverflow.com/questions/46814866/replacing-forward-slash-with-hyphen-in-date-vba/46815042#46815042", "title": "Replacing forward slash with hyphen in date VBA", "body": "<p>You can format the string in the code</p>\n\n<pre><code>    Sub SaveIt()\n    Dim s As String\n    s = Format(Range(\"A1\"), \"mm-dd-yy\")\n    ActiveWorkbook.SaveAs Filename:=\"C:\\Users\\dmorrison\\Downloads\\\" &amp; s &amp; \".xlsm\", _\n                          FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4066647"}, "is_accepted": false, "score": 1, "last_activity_date": 1508344391, "creation_date": 1508344391, "answer_id": 46815044, "question_id": 46814866, "link": "https://stackoverflow.com/questions/46814866/replacing-forward-slash-with-hyphen-in-date-vba/46815044#46815044", "title": "Replacing forward slash with hyphen in date VBA", "body": "<p>The value shown in the formula bar has nothing to do with how you're formatting the date in Excel.</p>\n\n<p>It's a system-wide setting that you'll have to modify by going to Control Panel > Region and Language.</p>\n\n<p>Edit:</p>\n\n<p>And, as K.Davis said in your comment, you can simply use <code>Format(rng, \"mm-dd-yyyy\")</code> to name the files.</p>\n"}], "owner": {"reputation": 9, "user_id": 5656058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa595deccc82a62ba02cff2eee2d78e?s=128&d=identicon&r=PG&f=1", "display_name": "Calderon315", "link": "https://stackoverflow.com/users/5656058/calderon315"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4394, "favorite_count": 0, "accepted_answer_id": 46814959, "answer_count": 3, "score": 0, "last_activity_date": 1508344391, "creation_date": 1508343822, "last_edit_date": 1531161705, "question_id": 46814866, "link": "https://stackoverflow.com/questions/46814866/replacing-forward-slash-with-hyphen-in-date-vba", "title": "Replacing forward slash with hyphen in date VBA", "body": "<p>I have searched all over and normally find my answer, however this one is peculiar. I have to format a date for a program such that it doesn't have forward slashes in the date to write to a file path. I am able to get the <strong>look</strong> in the cell to appear as if it's using hyphens, but the <strong>value</strong> in the formula bar still shows it with backslashes. </p>\n\n<p>For instance, today's date could be typed into cell A1 as <em>\"10/18/2017\"</em> and it would appear in the cell it's typed as <em>\"10-18-2017\"</em>, but in the formula bar and when I get the value of the that cell it's still <em>10/18/2017</em>.\nI'm extracting the value like: <code>Range(\"A1\").value</code></p>\n\n<p>Below is the code that I'm using to try to change the actual value of the cell.</p>\n\n<pre><code>Range(\"A1\").NumberFormat = \"mm-dd-yyyy\"\n</code></pre>\n\n<p>This did exactly what I mention above. Tricks the user into thinking they solved the problem, but not really. Then I thought well let's just replace the <code>/</code> character...</p>\n\n<pre><code>Range(\"A1\").value = Replace(Range(\"A1\").value, \"/\", \"-\")\n</code></pre>\n\n<p>Still no dice and not anything I can find on the interwebs. Sorry if this has been answered, I searched and searched, even within stack</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 1, "creation_date": 1508344211, "post_id": 46814806, "comment_id": 80577303, "body": "You&#39;re always going to be putting data into A2, because you&#39;re always starting at A1. You need to find the last used row + 1 in each routine and paste data there. Like <code>Range(&quot;A&quot; &amp; lastRow)</code>"}, {"owner": {"reputation": 33, "user_id": 8736126, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1fec2aae04c1a4c4ff613ccc5a0c013b?s=128&d=identicon&r=PG&f=1", "display_name": "J Ding", "link": "https://stackoverflow.com/users/8736126/j-ding"}, "reply_to_user": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1508396285, "post_id": 46814806, "comment_id": 80595823, "body": "Thank you for the advice."}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1508343899, "creation_date": 1508343899, "answer_id": 46814894, "question_id": 46814806, "link": "https://stackoverflow.com/questions/46814806/each-item-has-one-button-to-add-quantities-to-another-order-list-offset-is-not/46814894#46814894", "title": "Each item has one button to add quantities to another order list. Offset is not working", "body": "<p>Use this instead which will find the last used cell and then move down to the next cell (your code never updates the destination cell, it is fixed at A2). What sort of buttons are these - you should be able to avoid repeating your code 20 times.</p>\n\n<pre><code>wsSource.Range(\"B28\").Copy wsDest.Range(\"A\" &amp; rows.count).end(xlup).Offset(1,0)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8736126, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1fec2aae04c1a4c4ff613ccc5a0c013b?s=128&d=identicon&r=PG&f=1", "display_name": "J Ding", "link": "https://stackoverflow.com/users/8736126/j-ding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 46814894, "answer_count": 1, "score": 0, "last_activity_date": 1508343899, "creation_date": 1508343653, "question_id": 46814806, "link": "https://stackoverflow.com/questions/46814806/each-item-has-one-button-to-add-quantities-to-another-order-list-offset-is-not", "title": "Each item has one button to add quantities to another order list. Offset is not working", "body": "<p>I have one Command Buttons been set up for each product line. Totally, I have more than 20 buttons on Sheet 1. </p>\n\n<p>If I click any of them with quantity more than 1, the product name will be copied and pasted to Order List sheet. </p>\n\n<p>I try to use the Offset to paste it to blank column under line A from A2 in Order List. </p>\n\n<p>However, it is only replacing A2 rather than paste to A3 after I click another button. </p>\n\n<p>Code details for first two buttons are as following (all 20 buttons should be same code, as they will not be clicked in order. As long as it picks up the blank column, it should be fine):</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim wb As Workbook\n    Dim wsSource As Worksheet\n    Dim wsDest As Worksheet\n\n    Set wb = ActiveWorkbook\n    Set wsSource = wb.Sheets(\"Sheet1\")  \n    Set wsDest = wb.Sheets(\"Order List\")\n\n    'Stop if report not filled in fully\n    If wsSource.Range(\"G28\").Value &lt; 1 Then\n        MsgBox \"Please Amend Quantity\"\n        Exit Sub\n    End If\n\n    wsSource.Range(\"B28\").Copy wsDest.Range(\"A1\").Offset(1,0)\n    wsDest.Range(\"A:D\").EntireColumn.AutoFit\n\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n\n    Dim wb As Workbook\n    Dim wsSource As Worksheet\n    Dim wsDest As Worksheet\n\n    Set wb = ActiveWorkbook\n    Set wsSource = wb.Sheets(\"Sheet1\")  \n    Set wsDest = wb.Sheets(\"Order List\")\n\n    'Stop if report not filled in fully\n    If wsSource.Range(\"G28\").Value &lt; 1 Then\n        MsgBox \"Please Amend Quantity\"\n        Exit Sub\n    End If\n\n    wsSource.Range(\"B28\").Copy wsDest.Range(\"A1\").Offset(1,0)\n    wsDest.Range(\"A:D\").EntireColumn.AutoFit\n\nEnd Sub\n</code></pre>\n\n<p>Please advise me. Many thanks</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 60, "user_id": 4838102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e338425afbbc3b5b60ec1f1e47fa95a0?s=128&d=identicon&r=PG&f=1", "display_name": "SScoder93", "link": "https://stackoverflow.com/users/4838102/sscoder93"}, "edited": false, "score": 1, "creation_date": 1508345208, "post_id": 46814802, "comment_id": 80577825, "body": "Looks like it works, although I had to tweak it since i&#39;m searching for missing country_id&#39;s from the static table. I instead am selecting country_ref1 and country_ref2 instead of country_id since it would be missing. Thank you!"}], "tags": [], "owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "is_accepted": true, "score": 3, "last_activity_date": 1508343640, "creation_date": 1508343640, "answer_id": 46814802, "question_id": 46814775, "link": "https://stackoverflow.com/questions/46814775/comparison-of-a-single-field-to-two-fields-in-sql/46814802#46814802", "title": "Comparison of a single field to two fields in SQL", "body": "<p>Use <code>NOT EXISTS</code>:</p>\n\n<pre><code>SELECT c.country_id\nFROM country as c\nWHERE NOT EXISTS (SELECT 1\n                  FROM References r\n                  WHERE c.country_id IN (Country_ref1, Country_ref2)\n                 );\n</code></pre>\n"}], "owner": {"reputation": 60, "user_id": 4838102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e338425afbbc3b5b60ec1f1e47fa95a0?s=128&d=identicon&r=PG&f=1", "display_name": "SScoder93", "link": "https://stackoverflow.com/users/4838102/sscoder93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 1, "accepted_answer_id": 46814802, "answer_count": 1, "score": 0, "last_activity_date": 1508344168, "creation_date": 1508343530, "last_edit_date": 1508344168, "question_id": 46814775, "link": "https://stackoverflow.com/questions/46814775/comparison-of-a-single-field-to-two-fields-in-sql", "title": "Comparison of a single field to two fields in SQL", "body": "<p>I have a table in Microsoft Access which acts as a static list of countries(named country table), with a country_id field as a primary key identifier. I'm attempting to use country_id within the static list and compare them to another table (named references table) which hold country references (country_ref1 and country_ref2). Please note that the references table have duplicate entries within country_ref1 and country_ref2 and also include nulls/empty values. All fields are of the same type \"Short/Text\", and consist of two letters when populated. </p>\n\n<p><strong>If the country_id in the country table DOES NOT match country_ref1 AND country_ref2 in the references table, i'd like the country_id to be populated in my query.</strong></p>\n\n<p>This is what I've come up with so far, however it's not working (perhaps due to the \"NOT IN\" statement not accounting for nulls). I've also tried using LEFT JOIN &amp; NOT EXISTS with no solution.</p>\n\n<pre><code>SELECT country_id FROM country WHERE country_id NOT IN (SELECT DISTINCT Country_ref1 FROM References) AND country_id NOT IN (SELECT DISTINCT Country_ref2 FROM References)\n</code></pre>\n\n<p>Any help would be appreciated. Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1508343711, "post_id": 46814754, "comment_id": 80577015, "body": "without seeing any of your code, this is the best i have.. change the code to <code>IE.Document.getElementsByName(\u201cname\u201d)(0).Value = \u201cValue\u201d</code>"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1508345060, "post_id": 46814754, "comment_id": 80577752, "body": "The IE.Document.getElementsByName(\u201cname\u201d) returns a collection of elements not a single element so you cannot set it&#39;s value like that. Try what @user1 has suggested. Remember the index in the collection will start from 0 so change it as per your requirement."}, {"owner": {"reputation": 13, "user_id": 8796778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ac19c4c2bdfd82650bdd2e40ba1c32e?s=128&d=identicon&r=PG&f=1", "display_name": "YaYaYaYaYaYa", "link": "https://stackoverflow.com/users/8796778/yayayayayaya"}, "edited": false, "score": 0, "creation_date": 1508349283, "post_id": 46814754, "comment_id": 80579875, "body": "This is the HTML of the text box I am trying to write to: &lt;input type=&quot;text&quot; class=&quot;gwt-TextBox&quot; name=&quot;caseNumber&quot;&gt;."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1508349676, "post_id": 46814754, "comment_id": 80580084, "body": "@user1 example should work then .... you already have the code in the program that you posted"}, {"owner": {"reputation": 13, "user_id": 8796778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ac19c4c2bdfd82650bdd2e40ba1c32e?s=128&d=identicon&r=PG&f=1", "display_name": "YaYaYaYaYaYa", "link": "https://stackoverflow.com/users/8796778/yayayayayaya"}, "edited": false, "score": 0, "creation_date": 1508350290, "post_id": 46814754, "comment_id": 80580451, "body": "Well I&#39;ve modified it since, attempting to get it it to work. It throws a &#39;Method &quot;Document&quot; of object &#39;IWebBrowser2&#39; failed&#39; error."}, {"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1508350747, "post_id": 46814754, "comment_id": 80580701, "body": "Show us your variable declaration for IE and DOCUMENT"}, {"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1508350770, "post_id": 46814754, "comment_id": 80580713, "body": "You are getting the error probably because you defined the variables inappropriately"}, {"owner": {"reputation": 13, "user_id": 8796778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ac19c4c2bdfd82650bdd2e40ba1c32e?s=128&d=identicon&r=PG&f=1", "display_name": "YaYaYaYaYaYa", "link": "https://stackoverflow.com/users/8796778/yayayayayaya"}, "edited": false, "score": 0, "creation_date": 1508351248, "post_id": 46814754, "comment_id": 80580957, "body": "It is simply <code>DIM IE As Object</code>. Apologies for being vague, I&#39;m extremely inexperienced with VBA. Essentially, I am just googling for methods, rampantly."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1508353363, "post_id": 46814754, "comment_id": 80582094, "body": "@YaYaYaYaYaYa ,There is nothing wrong with being extremely inexperienced. Anyways, reveal the link (if that is not a problem) to get direct help. Otherwise any link that resembles the one you are working with."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1508357144, "post_id": 46814754, "comment_id": 80584023, "body": "What web page are you trying to automate?  Can you give us an address?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508386202, "post_id": 46814754, "comment_id": 80592757, "body": "change the wait loop to this   <code>While IE.Busy Or IE.readyState &lt;&gt; 4</code>"}], "answers": [{"tags": [], "owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "is_accepted": false, "score": 0, "last_activity_date": 1508416530, "creation_date": 1508416530, "answer_id": 46830021, "question_id": 46814754, "link": "https://stackoverflow.com/questions/46814754/ie-document-getelementsbynamename-value-value-not-working/46830021#46830021", "title": "IE.Document.getElementsByName(&quot;name&quot;).Value = &quot;Value&quot; not working", "body": "<p>Try the below   </p>\n\n<pre><code>Option Explicit\n\nDim IE as Object\n\nSub YSF_automation()\n    Application.ScreenUpdating = False\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\nIE.Navigate \"URL\"\n\nWhile IE.Busy\n    DoEvents\nWend\n\nset document = IE.document\nwith document\n    .getElementsByName(\"ElementName\")(0).value=\"test\"\nend with\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8796778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ac19c4c2bdfd82650bdd2e40ba1c32e?s=128&d=identicon&r=PG&f=1", "display_name": "YaYaYaYaYaYa", "link": "https://stackoverflow.com/users/8796778/yayayayayaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 8035, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1617188406, "creation_date": 1508343443, "last_edit_date": 1581463134, "question_id": 46814754, "link": "https://stackoverflow.com/questions/46814754/ie-document-getelementsbynamename-value-value-not-working", "title": "IE.Document.getElementsByName(&quot;name&quot;).Value = &quot;Value&quot; not working", "body": "<p>When I try and do this, it throws a number of errors at me depending on other bits of my code, such as the method is not associated with that object or an unspecified error.</p>\n\n<p>I am trying to go down a list of Excel cells with strings and use a web form to search for those strings.</p>\n\n<p>My code currently looks like this:</p>\n\n<pre><code>Sub YSF_automation()\n    Application.ScreenUpdating = False\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = True\n    IE.Navigate \"URL\"\n\n    While IE.Busy\n        DoEvents\n    Wend\n\n    IE.Document.getElementsByName(\"ElementName\")(0).Value = \"test\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1508344496, "post_id": 46814674, "comment_id": 80577458, "body": "Date value  starts from  year 1900. So 1899 year is  nothing in computer time."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4066647"}, "edited": false, "score": 1, "creation_date": 1508345439, "post_id": 46814674, "comment_id": 80577967, "body": "Show us how you&#39;re assigning to the variables <code>cell</code> and <code>h</code>. That&#39;ll help us understand your situation a bit more clearly."}], "answers": [{"tags": [], "owner": {"reputation": 4465, "user_id": 6584288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bvDzQ.png?s=128&g=1", "display_name": "Indent", "link": "https://stackoverflow.com/users/6584288/indent"}, "is_accepted": false, "score": 1, "last_activity_date": 1508343742, "last_edit_date": 1508343742, "creation_date": 1508343342, "answer_id": 46814729, "question_id": 46814674, "link": "https://stackoverflow.com/questions/46814674/compare-two-time-in-vba-30-12-1899-error/46814729#46814729", "title": "Compare two time in vba 30/12/1899 error", "body": "<p>A common way in <strong>any Langage</strong> :\n<p>To compare 2 dates time convert each date in string using <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">ISO</a> format :</p>\n\n<p>For VBA :</p>\n\n<pre><code>Format(cell, \"yyyy-MM-dd hh:mm:ss\") // for a second precision\nFormat(cell, \"yyyy-MM-dd hh:mm\") // for a minute precision\nFormat(cell, \"yyyy-MM-dd\") // for a day precision\nFormat(cell, \"yyyy\") // for a year precision etc...\n</code></pre>\n\n<p>After you can simply compare the strings</p>\n\n<p><em>Note : the best practice is to using specific comparator function for each Langage</em></p>\n"}], "owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508343742, "creation_date": 1508343156, "last_edit_date": 1531164843, "question_id": 46814674, "link": "https://stackoverflow.com/questions/46814674/compare-two-time-in-vba-30-12-1899-error", "title": "Compare two time in vba 30/12/1899 error", "body": "<p>in one long code I've one step to compare two times (var cell and var h), the both  value are the same.\nbelow that I can saw on immediate view:</p>\n\n<pre><code>Debug.Print Format(cell, \"dd/MM/yyyy hh:mm:ss\"); \" \"; Format(h, \"dd/MM/yyyy hh:mm:ss\")\n30/12/1899 02:30:00 30/12/1899 02:30:00\nif h=cell then debug.Print \"yes\" else debug.Print \"no\"\nno\ndebug.print cell-h\n 3,46944695195361E-16 \n</code></pre>\n\n<p>Ho I can compare the two times and retreive the correct result (true in my example)\nthnk Fabrizio</p>\n"}, {"tags": ["mysql", "excel", "vba", "validation"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1508343012, "post_id": 46814536, "comment_id": 80576602, "body": "Like a worksheet change event that checks a cell entry against an array holding your query recordset? Thinking out loud and haven&#39;t tried to see if such a thing is possible."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8760063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b24e8f695e3d27728e5efe74b8d5effa?s=128&d=identicon&r=PG&f=1", "display_name": "NJQ", "link": "https://stackoverflow.com/users/8760063/njq"}, "edited": false, "score": 0, "creation_date": 1508349143, "post_id": 46815474, "comment_id": 80579793, "body": "Thanks for this, I know I can save the results into a table, my question was how to use the results from the query without saving them into a table first."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 3, "user_id": 8760063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b24e8f695e3d27728e5efe74b8d5effa?s=128&d=identicon&r=PG&f=1", "display_name": "NJQ", "link": "https://stackoverflow.com/users/8760063/njq"}, "edited": false, "score": 0, "creation_date": 1508350004, "post_id": 46815474, "comment_id": 80580276, "body": "It depends on the size of the records. You cannot insert more than 255 characters in the <code>Source</code> section so if you are sure your records altogether character count will be less than 255 characters, then you can simply insert them as <code>option1,option2,option3,...</code>. If the character count exceeds 255 then your options will be truncated, but will not fail"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 3, "user_id": 8760063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b24e8f695e3d27728e5efe74b8d5effa?s=128&d=identicon&r=PG&f=1", "display_name": "NJQ", "link": "https://stackoverflow.com/users/8760063/njq"}, "edited": false, "score": 0, "creation_date": 1508350132, "post_id": 46815474, "comment_id": 80580345, "body": "BTW, by <code>saving</code> I did not mean that you have to really save the workbook if you simply dump the results there and once you are done, close your workbook and not save it, it is all fine, your drop-down will work just fine. In this case, I would rather remove the validation before closing the workbook since if your options change constantly, then they would show validation errors when you use the workbook later"}, {"owner": {"reputation": 3, "user_id": 8760063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b24e8f695e3d27728e5efe74b8d5effa?s=128&d=identicon&r=PG&f=1", "display_name": "NJQ", "link": "https://stackoverflow.com/users/8760063/njq"}, "edited": false, "score": 0, "creation_date": 1508412521, "post_id": 46815474, "comment_id": 80604930, "body": "Thanks lbo - unfortunately my list is very much bigger than this, approx. 400 rows with up to 60 chars per entry."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 3, "user_id": 8760063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b24e8f695e3d27728e5efe74b8d5effa?s=128&d=identicon&r=PG&f=1", "display_name": "NJQ", "link": "https://stackoverflow.com/users/8760063/njq"}, "edited": false, "score": 0, "creation_date": 1508424695, "post_id": 46815474, "comment_id": 80613063, "body": "There is no other way and that is how Excel works, you have only 2 options: 1-direct entry (limited to 255 characters) 2-Excel range (range must be consecutive and not scattered) I have worked on this for a very long time in a big data governance project and I am sure so you have to go with the range option"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 3, "user_id": 8760063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b24e8f695e3d27728e5efe74b8d5effa?s=128&d=identicon&r=PG&f=1", "display_name": "NJQ", "link": "https://stackoverflow.com/users/8760063/njq"}, "edited": false, "score": 0, "creation_date": 1508424804, "post_id": 46815474, "comment_id": 80613128, "body": "you did not give me enough details, but practically you need to dump your records once in a sheet and take care of filtration for each drop down in Excel with VBA/Excel itself. Many connections to DB may fail or hinder users from having a good performance"}, {"owner": {"reputation": 3, "user_id": 8760063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b24e8f695e3d27728e5efe74b8d5effa?s=128&d=identicon&r=PG&f=1", "display_name": "NJQ", "link": "https://stackoverflow.com/users/8760063/njq"}, "edited": false, "score": 0, "creation_date": 1508519352, "post_id": 46815474, "comment_id": 80655397, "body": "Thanks all - I guess I&#39;ll just go with loading the results into a table on a hidden tab and validating against that if that&#39;s the best Excel can offer. Thanks for your input everyone."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 3, "user_id": 8760063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b24e8f695e3d27728e5efe74b8d5effa?s=128&d=identicon&r=PG&f=1", "display_name": "NJQ", "link": "https://stackoverflow.com/users/8760063/njq"}, "edited": false, "score": 0, "creation_date": 1508563984, "post_id": 46815474, "comment_id": 80668301, "body": "You can upvite people or choose the right answer for your questions so helpers can get credit for that :)"}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": false, "score": 0, "last_activity_date": 1508345928, "creation_date": 1508345928, "answer_id": 46815474, "question_id": 46814536, "link": "https://stackoverflow.com/questions/46814536/loading-an-excel-validation-list-directly-from-a-sql-query/46815474#46815474", "title": "Loading an Excel Validation list directly from a SQL Query", "body": "<p>Yes, you can and it is easy if you use Excel tables.</p>\n\n<p>You need to always save the records returned from your SQL query into an Excel table. You can create it each time or you can just create one, rename it and always keep it there in a visible or hidden worksheet. It depends on you.</p>\n\n<p>Let's say that you have created an Excel Table that keeps the options for your drop down list and it is called <code>Table1</code>. The trick is when you are defining the validation in the cell (or cells), in the <code>Source</code> section you write this:</p>\n\n<pre><code>=INDIRECT(\"Table1\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/INuzo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/INuzo.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 8760063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b24e8f695e3d27728e5efe74b8d5effa?s=128&d=identicon&r=PG&f=1", "display_name": "NJQ", "link": "https://stackoverflow.com/users/8760063/njq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2135, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508345928, "creation_date": 1508342655, "question_id": 46814536, "link": "https://stackoverflow.com/questions/46814536/loading-an-excel-validation-list-directly-from-a-sql-query", "title": "Loading an Excel Validation list directly from a SQL Query", "body": "<p>I want to know if it's possible to load an Excel Validation list directly from an external query. I'm expecting to do this in VBA somehow. I have the query which works fine and I can load the resultant list into a table in a worksheet via VBA without a problem, but I wanted to know if I can use this result set directly into a validation list without having to first load the query results into a workbook and then refer to this table as the source for the validation list.</p>\n\n<p>I'm working with MySQL and Excel 2016 and the combination works well for everything so far, but I'm stuck on this. Any ideas please?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1508343204, "post_id": 46814487, "comment_id": 80576732, "body": "I recognise that code. It was working wasn&#39;t it, and I can&#39;t see any obvious problem there. What is the value of <code>numrange</code> when it errors?"}, {"owner": {"reputation": 29, "user_id": 6375471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4132f894086ee0d6c2e489a14542feb2?s=128&d=identicon&r=PG&f=1", "display_name": "A.Denis", "link": "https://stackoverflow.com/users/6375471/a-denis"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1508343932, "post_id": 46814487, "comment_id": 80577122, "body": "Hey SJR, indeed it&#39;s me again and yes it was working but on closer inspection I found that the output it was giving had multiples of a lot of the rows. I think this was down to the &quot;Numrange +100&quot; that I did which Isn&#39;t always true as in it&#39;s not always +100 to the end of the sheet. Hence why I have tried to introduce the LastRow variable so that I can give an exact end location on each sheet which should hopefully fix the problem."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1508344224, "post_id": 46814487, "comment_id": 80577313, "body": "Have you tried stepping through your code and checking the values of the variables? What is the error on the copy line? Is the problem with a particular sheet?"}, {"owner": {"reputation": 29, "user_id": 6375471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4132f894086ee0d6c2e489a14542feb2?s=128&d=identicon&r=PG&f=1", "display_name": "A.Denis", "link": "https://stackoverflow.com/users/6375471/a-denis"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1508344581, "post_id": 46814487, "comment_id": 80577493, "body": "Right I managed to fix it. When I change all to LastRow it seems to work. For some reason it doesn&#39;t like it when i was using Lastrow on some ranges and NumRange on others.. Not sure I understand what was happening but it&#39;s working now."}], "owner": {"reputation": 29, "user_id": 6375471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4132f894086ee0d6c2e489a14542feb2?s=128&d=identicon&r=PG&f=1", "display_name": "A.Denis", "link": "https://stackoverflow.com/users/6375471/a-denis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508342500, "creation_date": 1508342500, "question_id": 46814487, "link": "https://stackoverflow.com/questions/46814487/copying-a-union-range-with-a-last-row-value", "title": "Copying a union range with a last row value", "body": "<p>I have the following code that is sort of working now but I've hit another snag. For some reason it is copying from the same sheet multiple times and pasting to the new workbook. I think this is due to my <code>NumRange + 100</code> perimeter I set because I couldnt get the LastRow variable to work.</p>\n\n<pre><code>Public Sub extractCol()\n\n'Find FF&amp;E Section, Add 3 rows and Identify relevant columns.\n\nDim rFind As Range, CRange As String, ERange As String, KRange As String, MRange As String\nDim ws As Worksheet\nDim NewBook As Workbook\nDim NumRange As Long\nDim LastRow As Long\n\nSet NewBook = Workbooks.Add ' Open new Workbook\n\nFor Each ws In ThisWorkbook.Worksheets\nWith ws\n    Set rFind = .Range(\"A:A\").Find(What:=\"FF&amp;E\", LookAt:=xlWhole,     MatchCase:=False, SearchFormat:=False)\n    If Not rFind Is Nothing Then\n\n        LastRow = .Cells(.Rows.Count, \"E\").End(xlUp).Row\n        NumRange = rFind.Row + 3 ' Find FF&amp;E line and add three\n\n        CRange = \"C\" &amp; NumRange &amp; \":\" &amp; \"C\" &amp; NumRange + 100 ' Define First 100 Lines in Column C\n        ERange = \"E\" &amp; NumRange &amp; \":\" &amp; \"E\" &amp; NumRange + 100 ' Define First 100 Lines in Column E\n        KRange = \"K\" &amp; NumRange &amp; \":\" &amp; \"K\" &amp; NumRange + 100 ' Define First 100 Lines in Column K\n        MRange = \"M\" &amp; NumRange &amp; \":\" &amp; \"M\" &amp; NumRange + 100 ' Define First 100 Lines in Column M\n\n        Set range1 = Union(.Range(CRange), .Range(ERange), .Range(KRange), .Range(MRange)) ' Combine individual column ranges in to one selection\n        range1.Copy ' Copy new combined range\n\n        NewBook.Sheets(1).Range(\"B\" &amp; Rows.Count).End(xlUp)(2).PasteSpecial Paste:=xlPasteValues ' Paste to new Workbook\n        NewBook.Sheets(1).Range(\"A\" &amp; Rows.Count).End(xlUp)(2).Resize(range1.Rows.Count).Value = FindRoom(ws)\n\n    End If\nEnd With\nNext ws\n\nEnd Sub\n\nFunction FindRoom(ws As Worksheet)\n\nshtName = ws.Name\n\nDim arr() As String\narr = VBA.Split(shtName, \" \")\n\nxCount = UBound(arr)\nIf xCount &lt; 1 Then\n    FindRoom = \"Unknown\"\nElse\n    FindRoom = arr(xCount)\nEnd If\nEnd Function\n</code></pre>\n\n<p>So I tried fixing it by doing the following;</p>\n\n<pre><code>            CRange = \"C\" &amp; NumRange &amp; \":\" &amp; \"C\" &amp; LastRow\n            ERange = \"E\" &amp; NumRange &amp; \":\" &amp; \"E\" &amp; LastRow\n            KRange = \"K\" &amp; NumRange &amp; \":\" &amp; \"K\" &amp; LastRow\n            MRange = \"M\" &amp; NumRange &amp; \":\" &amp; \"M\" &amp; LastRow\n</code></pre>\n\n<p>But this causes an error on the following line;</p>\n\n<pre><code>range1.Copy\n</code></pre>\n\n<p>Any help on where I'm going wrong would be appreciated.\nThanks!</p>\n"}, {"tags": ["excel", "tracking", "recording", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1508345332, "post_id": 46814423, "comment_id": 80577910, "body": "Your example isn&#39;t much of an example. It doesn&#39;t show what your output should look like. Can you modify your question to say when <code>Cell1</code> does this, then <code>Cell2</code> does this, as it stands right now your question is somewhat vague."}, {"owner": {"reputation": 1, "user_id": 8796596, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V3TXvBw8dTE/AAAAAAAAAAI/AAAAAAAAJ88/brsvFqrz1vQ/photo.jpg?sz=128", "display_name": "Curt Nichols", "link": "https://stackoverflow.com/users/8796596/curt-nichols"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1508427784, "post_id": 46814423, "comment_id": 80615176, "body": "Your right-I wasnt clear.  I have two cells that capture separate sum totals, AR67 and CU67 in my sheet as an example .  When either of those totals change I would like to post the values for both cells in a new sheet that tracks every change. When the value of AR67 changes I would like to post that new value PLUS the value of CU67-even though it did not change. My intent is to create a running score tracker-so I hope this clarifies the question.Thanks in advance for your help!"}, {"owner": {"reputation": 1, "user_id": 8796596, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V3TXvBw8dTE/AAAAAAAAAAI/AAAAAAAAJ88/brsvFqrz1vQ/photo.jpg?sz=128", "display_name": "Curt Nichols", "link": "https://stackoverflow.com/users/8796596/curt-nichols"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1508428502, "post_id": 46814423, "comment_id": 80615655, "body": "Ran out of time....Your right-I wasnt clear.  I have two cells that capture separate sum totals, AR67 and CU67 in my sheet as an example .  When either of those totals change I would like to post the values for both cells in a new sheet that tracks every change. So when the value of AR67 changes I would like to post that new value PLUS the value of CU67-even though it did not change. So AR67 would post to sheet 2 cell B1 and CU67 would post to sheet to cell B2 and when either AR67 or CU67 changes they would post to C1 and C2 etc, Hope that helps!  Thanks for taking time to respond!"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1508532866, "post_id": 46814423, "comment_id": 80661985, "body": "Were you wanting to Change both of <code>Sheet2</code> values when a single change is made in either column on sheet1, or update row <code>A</code> sheet2 when a change has been placed in col <code>AY</code>, and row <code>B</code> on sheet2 when a cell has changed in col <code>DB</code>?"}, {"owner": {"reputation": 1, "user_id": 8796596, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V3TXvBw8dTE/AAAAAAAAAAI/AAAAAAAAJ88/brsvFqrz1vQ/photo.jpg?sz=128", "display_name": "Curt Nichols", "link": "https://stackoverflow.com/users/8796596/curt-nichols"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1508533282, "post_id": 46814423, "comment_id": 80662184, "body": "Change both of Sheet2 values when a single change is made in either column on sheet1-as long as those changes post in sheet two as you previously were able to achieve."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8796596, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V3TXvBw8dTE/AAAAAAAAAAI/AAAAAAAAJ88/brsvFqrz1vQ/photo.jpg?sz=128", "display_name": "Curt Nichols", "link": "https://stackoverflow.com/users/8796596/curt-nichols"}, "edited": false, "score": 0, "creation_date": 1508519442, "post_id": 46837883, "comment_id": 80655442, "body": "Excellent work!  The data sequences out exactly as I envisioned in sheet 2, but is dependent on physically entering data in the reference cells (AR67 and CU67) in sheet 1.  Both of these cells in sheet one return a sum total from different series in sheet 1. So if I key in a value in sheet 1 AR67 or CU67 the change in value does record  for both every time one or the other cell value changes in sheet 2.  Hope that makes sense."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 1, "user_id": 8796596, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V3TXvBw8dTE/AAAAAAAAAAI/AAAAAAAAJ88/brsvFqrz1vQ/photo.jpg?sz=128", "display_name": "Curt Nichols", "link": "https://stackoverflow.com/users/8796596/curt-nichols"}, "edited": false, "score": 0, "creation_date": 1508521844, "post_id": 46837883, "comment_id": 80656701, "body": "What is the range you want to trigger the event? Example: Do you want sheet 2 to update when you enter a value in any cell in column A or row 1? Do you want to trigger when any cell on sheet 1 is changed?"}, {"owner": {"reputation": 1, "user_id": 8796596, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V3TXvBw8dTE/AAAAAAAAAAI/AAAAAAAAJ88/brsvFqrz1vQ/photo.jpg?sz=128", "display_name": "Curt Nichols", "link": "https://stackoverflow.com/users/8796596/curt-nichols"}, "edited": false, "score": 0, "creation_date": 1508524737, "post_id": 46837883, "comment_id": 80658157, "body": "When sheet 1 AR57 or CU57 changes it needs to trigger the event.    AR57=SUM(AY7+AY11+AY15+AY19+AY23+AY27+AY31+AY35+AY39+AY43+AY&zwnj;&#8203;47+AY51+AY55+AY59+AY&zwnj;&#8203;63) CU57=SUM(DB7+DB11+DB15+DB19+DB23+DB27+DB31+DB35+DB39+DB43+DB&zwnj;&#8203;47+DB51+DB55+DB59+DB&zwnj;&#8203;63) I have command buttons assigned that return cumulative sum total values to  a target cell in each row and this is repeated for multiple rows in the sheet thats assigned for each player to track scoring.. AR-57 and CU-57 reflects the updated totals for the assigned range.   Thanks again!"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 1, "user_id": 8796596, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V3TXvBw8dTE/AAAAAAAAAAI/AAAAAAAAJ88/brsvFqrz1vQ/photo.jpg?sz=128", "display_name": "Curt Nichols", "link": "https://stackoverflow.com/users/8796596/curt-nichols"}, "edited": false, "score": 0, "creation_date": 1508530190, "post_id": 46837883, "comment_id": 80660757, "body": "The only way this event fires is when the cell changes. Technically, the cells <code>AR57</code> and <code>CU57</code> never change, because the formula that you entered into it always stays the same. So I can make the event fire when a change occurs in either <code>AY</code> or <code>DB</code> columns. ///// Another method would be using the <code>Worksheet_Calculate</code> event, but this would require that you use two helper cells that keeps track of the before values so it can compare if the value changes after each time the worksheet recalculates, or you could possibly use <code>Global Variables</code>, but I&#39;m not too fond of using those for your issue"}, {"owner": {"reputation": 1, "user_id": 8796596, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V3TXvBw8dTE/AAAAAAAAAAI/AAAAAAAAJ88/brsvFqrz1vQ/photo.jpg?sz=128", "display_name": "Curt Nichols", "link": "https://stackoverflow.com/users/8796596/curt-nichols"}, "edited": false, "score": 0, "creation_date": 1508531091, "post_id": 46837883, "comment_id": 80661157, "body": "KD, if the event fires when a change occurs in columns AY or DB should not create an issue or conflict.   Thanks!"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 1, "user_id": 8796596, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V3TXvBw8dTE/AAAAAAAAAAI/AAAAAAAAJ88/brsvFqrz1vQ/photo.jpg?sz=128", "display_name": "Curt Nichols", "link": "https://stackoverflow.com/users/8796596/curt-nichols"}, "edited": false, "score": 0, "creation_date": 1508533780, "post_id": 46837883, "comment_id": 80662350, "body": "Updated. Please let me know if this is what you are looking for"}, {"owner": {"reputation": 1, "user_id": 8796596, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V3TXvBw8dTE/AAAAAAAAAAI/AAAAAAAAJ88/brsvFqrz1vQ/photo.jpg?sz=128", "display_name": "Curt Nichols", "link": "https://stackoverflow.com/users/8796596/curt-nichols"}, "edited": false, "score": 0, "creation_date": 1508769157, "post_id": 46837883, "comment_id": 80731016, "body": "KD,  I used the ghost cell option and added a line to each command button to get the code to fire:"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1508533764, "last_edit_date": 1508533764, "creation_date": 1508442801, "answer_id": 46837883, "question_id": 46814423, "link": "https://stackoverflow.com/questions/46814423/tracking-changes-in-values-and-posting-in-a-series-of-cells/46837883#46837883", "title": "Tracking changes in values and posting in a series of cells", "body": "<h2>Important!</h2>\n\n<p>This needs to be pasted into <code>Sheet1</code> object. You can get there by right-clicking the <code>Sheet1</code> tab > View Code.</p>\n\n<p><em>Also, I have done only minimal testing. Please let me know if this works for you.</em></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Debug.Print Now; \" &gt;&gt; ws1 Value Chg'd @ \"; Target.Address\n    Dim ws As Worksheet, iSectAY As Range, iSectDB As Range\n    Dim RngAY As Range, RngDB As Range\n    Dim RngAR As Range, RngCU As Range\n\n    Set ws = ThisWorkbook.Worksheets(1)\n    Set RngAR = ws.Range(\"AR67\")\n    Set RngCU = ws.Range(\"CU67\")\n    Set RngAY = ws.Range(\"AY:AY\")\n    Set RngDB = ws.Range(\"DB:DB\")\n\n    'Determine if the cell changed is a target cell\n    Set iSectAY = Intersect(Target, RngAY)\n    Set iSectDB = Intersect(Target, RngDB)\n    Dim iRow As Integer\n    If Not iSectAY Is Nothing Then\n        iRow = 1\n        If RngCU = \"\" Then\n            Application.EnableEvents = False\n            RngCU = 0\n            Application.EnableEvents = True\n        End If\n    ElseIf Not iSectDB Is Nothing Then\n        iRow = 2\n        If RngAR = \"\" Then\n            Application.EnableEvents = False\n            RngAR = 0\n            Application.EnableEvents = True\n        End If\n    Else\n        Exit Sub    'Cell updated was not the target\n    End If\n\n    'Set Sheet2's objects\n    Dim ws2 As Worksheet, UpdateRng1 As Range, UpdateRng2 As Range, iCol As Long\n    Set ws2 = ThisWorkbook.Worksheets(2)\n    iCol = ws2.Cells(iRow, Columns.Count).End(xlToLeft).Column + 1\n    Set UpdateRng1 = ws2.Cells(1, iCol)\n    Set UpdateRng2 = ws2.Cells(2, iCol)\n\n    UpdateRng1 = RngAR.Value\n    UpdateRng2 = RngCU.Value\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8796596, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V3TXvBw8dTE/AAAAAAAAAAI/AAAAAAAAJ88/brsvFqrz1vQ/photo.jpg?sz=128", "display_name": "Curt Nichols", "link": "https://stackoverflow.com/users/8796596/curt-nichols"}, "is_accepted": false, "score": 0, "last_activity_date": 1508769742, "creation_date": 1508769742, "answer_id": 46892162, "question_id": 46814423, "link": "https://stackoverflow.com/questions/46814423/tracking-changes-in-values-and-posting-in-a-series-of-cells/46892162#46892162", "title": "Tracking changes in values and posting in a series of cells", "body": "<p>I used the following in conjunction with the editing the command buttons to get the results needed</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Private Sub CommandButton108_Click()\r\nRange(\"CI7\") = Range(\"CI7\") + 2\r\nRange(\"CA7\") = Range(\"CA7\") + 2\r\nRange(\"DH7\") = Range(\"DH7\")\r\nEnd Sub\r\nOption Explicit\r\n\r\nPrivate Sub Worksheet_Change(ByVal Target As Range)\r\n\r\n    Debug.Print Now; \" &gt;&gt; ws1 Value Chg'd @ \"; Target.Address\r\n    Dim ws As Worksheet, iSectAY As Range, iSectDH As Range\r\n    Dim RngAY As Range, RngDB As Range\r\n    Dim RngAR As Range, RngCU As Range\r\n\r\n    Set ws = ThisWorkbook.Worksheets(1)\r\n    Set RngAR = ws.Range(\"AR67\")\r\n    Set RngCU = ws.Range(\"CU67\")\r\n    Set RngAY = ws.Range(\"AY7:AY63\")\r\n    Set RngDH = ws.Range(\"DH7:DH63\")\r\n\r\n    'Determine if the cell changed is a target cell\r\n    Set iSectAY = Intersect(Target, RngAY)\r\n    Set iSectDH = Intersect(Target, RngDH)\r\n    Dim iRow As Integer\r\n    If Not iSectAY Is Nothing Then\r\n        iRow = 1\r\n        If RngCU = \"\" Then\r\n            Application.EnableEvents = False\r\n            RngCU = 0\r\n            Application.EnableEvents = True\r\n        End If\r\n    ElseIf Not iSectDH Is Nothing Then\r\n        iRow = 2\r\n        If RngAR = \"\" Then\r\n            Application.EnableEvents = False\r\n            RngAR = 0\r\n            Application.EnableEvents = True\r\n        End If\r\n    Else\r\n        Exit Sub    'Cell updated was not the target\r\n    End If\r\n\r\n    'Set Sheet4's objects\r\n    Dim ws4 As Worksheet, UpdateRng1 As Range, UpdateRng2 As Range, iCol As Long\r\n    Set ws4 = ThisWorkbook.Worksheets(4)\r\n    iCol = ws4.Cells(iRow, Columns.Count).End(xlToLeft).Column + 1\r\n    Set UpdateRng1 = ws4.Cells(1, iCol)\r\n    Set UpdateRng2 = ws4.Cells(2, iCol)\r\n\r\n    UpdateRng1 = RngAR.Value\r\n    UpdateRng2 = RngCU.Value\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 1, "user_id": 8796596, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V3TXvBw8dTE/AAAAAAAAAAI/AAAAAAAAJ88/brsvFqrz1vQ/photo.jpg?sz=128", "display_name": "Curt Nichols", "link": "https://stackoverflow.com/users/8796596/curt-nichols"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 354, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1508769742, "creation_date": 1508342315, "last_edit_date": 1531164843, "question_id": 46814423, "link": "https://stackoverflow.com/questions/46814423/tracking-changes-in-values-and-posting-in-a-series-of-cells", "title": "Tracking changes in values and posting in a series of cells", "body": "<p>I have two cells with each returning a total from a series independent from each other.   I would like to post these totals in new cells each time a change is made to either of the cells, with the values of both cells recorded each time.  This is a score sheet that would track a running score showing that score each time there is a change to either of the cells.</p>\n\n<p>Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dYSVS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dYSVS.jpg\" alt=\"Example\"></a></p>\n"}, {"tags": ["excel", "vba", "pareto-chart"], "answers": [{"tags": [], "owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1508342649, "creation_date": 1508342649, "answer_id": 46814535, "question_id": 46814339, "link": "https://stackoverflow.com/questions/46814339/generating-a-pareto-chart-based-on-date/46814535#46814535", "title": "Generating a Pareto chart based on date", "body": "<p>Simply get the distinct months, apply simple excel formulaes to create 2 columns (one for the bar data and one for the line data) and create a combo chart with that data with one of the series as a line</p>\n"}], "owner": {"reputation": 1, "user_id": 8796654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f9ecb395d7158964c4814802033f356?s=128&d=identicon&r=PG&f=1", "display_name": "alice123", "link": "https://stackoverflow.com/users/8796654/alice123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1508342649, "creation_date": 1508341996, "question_id": 46814339, "link": "https://stackoverflow.com/questions/46814339/generating-a-pareto-chart-based-on-date", "title": "Generating a Pareto chart based on date", "body": "<p>I would like to make a Pareto chart based on 2 columns of Data. 1 is a string of letters and numbers let's call it column A, the other is a date (formatted as dd-mmm-yy e.g. 18-Oct-2017). </p>\n\n<p>There is no option to create a Pareto chart in Excel 2010 (the version I'm using), and I was wondering if it's possible to create a Pareto chart with those data. </p>\n\n<p>Basically I want it to display, based on year, how many entries there are in Column A. For example, if there are 4 entries in Column A associated with 2014, I want 2014 on the X-axis and the 4 on the Y-axis to show in the chart.</p>\n\n<p>I'm new to vba coding so I would really appreciate any help I can get in this. I have already tried to google it but there isn't anything that could help. If you have sample code that would be really nice. </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508341765, "post_id": 46814235, "comment_id": 80575765, "body": "Where do you call <code>headDict</code>?"}, {"owner": {"reputation": 5, "user_id": 6933262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a3da63fad86fa9364ee19f660ff0e4?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/6933262/ryan"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508341865, "post_id": 46814235, "comment_id": 80575842, "body": "I call it automatically when I close a userform. In testing, I&#39;ve been manually running headDict for troubleshooting to receive the same errors."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508342404, "post_id": 46814235, "comment_id": 80576218, "body": "I&#39;m afraid you really haven&#39;t given us anything to go on. Half the relevant code is missing and I suspect from the error message that the content of the dictionary is not a valid column letter or number."}, {"owner": {"reputation": 5, "user_id": 6933262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a3da63fad86fa9364ee19f660ff0e4?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/6933262/ryan"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508342503, "post_id": 46814235, "comment_id": 80576290, "body": "Dictionaries go by named keys, so the content is pulling the headers as the key and the column number as the content?"}, {"owner": {"reputation": 5, "user_id": 6933262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a3da63fad86fa9364ee19f660ff0e4?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/6933262/ryan"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508343502, "post_id": 46814235, "comment_id": 80576899, "body": "Is it impossible to have a second dictionary in my module? Thanks"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508344321, "post_id": 46814235, "comment_id": 80577367, "body": "You haven&#39;t posted the <code>addToDict</code> function. You can have as many Dictionaries declared as you like. Have you verified the content and data type of <code>hedDict(&quot;Order UOM Price&quot;)</code>?"}, {"owner": {"reputation": 5, "user_id": 6933262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a3da63fad86fa9364ee19f660ff0e4?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/6933262/ryan"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508345061, "post_id": 46814235, "comment_id": 80577754, "body": "Added the addToDict. Yes, I tested it with the MsgBox(x) in the headDict function. And the crazy thing- when I run headDict by itself, the msgBox shows with no problem, when I run it in the ChckTest subroutine it pops up with the error. Thank you"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508350880, "post_id": 46814235, "comment_id": 80580766, "body": "There is no <code>Msgbox</code> in <code>headDict</code>. What does <code>Msgbox TypeName(hedDict(&quot;Order UOM Price&quot;)) &amp; &quot;: &quot; &amp; hedDict(&quot;Order UOM Price&quot;)</code> return?"}, {"owner": {"reputation": 5, "user_id": 6933262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a3da63fad86fa9364ee19f660ff0e4?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/6933262/ryan"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508355018, "post_id": 46814235, "comment_id": 80582960, "body": "Yeah, that works in both queries. I was able to troubleshoot it down and I think I found out what the problem was. A singular capital letter difference in the key and the query. I appreciate all your help and I apologize that it was just some misc detail that was ravaging everything"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508398069, "post_id": 46814235, "comment_id": 80596796, "body": "No problem - at least it&#39;s fixed. :)"}], "owner": {"reputation": 5, "user_id": 6933262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a3da63fad86fa9364ee19f660ff0e4?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/6933262/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508344923, "creation_date": 1508341574, "last_edit_date": 1531164843, "question_id": 46814235, "link": "https://stackoverflow.com/questions/46814235/why-is-my-public-dictionary-popping-out-1004-errors", "title": "Why is my public dictionary popping out 1004 errors?", "body": "<p>I'm trying to establish a public dictionary to query at various points in the use of my document. But- the document appears to \"forget\" about the dictionary assigned? Is there a problem with my code?</p>\n\n<pre><code>Dim hedDict As Scripting.Dictionary\n\nPublic Function headDict()\nOn Error Resume Next\nDim i As Long\nDim z As Long\nDim x As Variant\nDim c As Variant\nDim d As Variant\nSet hedDict = New Dictionary\nz = Range(\"A1\").End(xlToRight).Column\nSheets(\"New Item Entry\").Select\nRange(\"A2\").Select\ni = 1\nDo While i &lt;= z\n    c = Columns(i).Rows(1).Value\n    d = i\n    Call addToDict(hedDict, c, d)\n    i = i + 1\nLoop\nEnd Function\n\nFunction addToDict(dic, iteem, val)\ndic.Add iteem, val\nEnd Function\n\nSub ChckTst()\nDim x as Long\nx = Cells(i, hedDict(\"Order UOM Price\")).Value\nMsgBox (x)\nEnd Sub\n</code></pre>\n\n<p>The subroutine above does various other things before calling on the dictionary, such as calling a plethora of variables, assigning an array, and creating a collection. If that could interfere, please let me know.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vbscript", "vba"], "comments": [{"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1508344541, "post_id": 46813990, "comment_id": 80577482, "body": "app.getValue - is it a string or array? If its an array, you can simply use <a href=\"https://www.w3schools.com/asp/func_filter.asp\" rel=\"nofollow noreferrer\"><code>Filter</code></a> to check if the required pdf value is present or not - hence directly using it in <code>If</code> condition without having to loop through the entire array. And if its a string, use InStr directly"}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "reply_to_user": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1508344765, "post_id": 46813990, "comment_id": 80577593, "body": "@PankajJaju I think it is a string. That&#39;s why he is performing the split operation to get an array containing the filenames"}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1508344930, "post_id": 46813990, "comment_id": 80577673, "body": "Its confusing because he said its an array and the way he represented the data, it looks like an array. But then he used split. So not sure if his code or data is correct."}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "edited": false, "score": 0, "creation_date": 1508401641, "post_id": 46813990, "comment_id": 80598730, "body": "@DevendraVastrakar Did the solution help?"}], "answers": [{"tags": [], "owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "is_accepted": false, "score": 1, "last_activity_date": 1508344441, "last_edit_date": 1508344441, "creation_date": 1508343466, "answer_id": 46814761, "question_id": 46813990, "link": "https://stackoverflow.com/questions/46813990/check-value-in-the-array-in-vbscript/46814761#46814761", "title": "check value in the array in Vbscript", "body": "<p>It seems that the app.getvalue is returning a string containing the pdf file names <strong>with each name surrounded by double-quotes</strong>. So, remove those double-quotes as shown below and run the code again.</p>\n\n<p>Replace this:</p>\n\n<pre><code>filename_array = app.getValue(\"Model.OutputArrays.FinalCompleteFileName_Array\")\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>filename_array = replace(trim(app.getValue(\"Model.OutputArrays.FinalCompleteFileName_Array\")),\"\"\"\",\"\")\n</code></pre>\n\n<p><strong>Alternative Solution:</strong></p>\n\n<p>If you don't want to use the <code>replace</code> method, you can modify your <code>if</code> condition to use the <code>instr</code> method instead of <code>strcomp</code> method as shown below:</p>\n\n<pre><code>If InStr(1,TestArray(i), pdfname , 1) &gt; 0 Then\n      CompareStrings = True\n     MsgBox(\"Found \" &amp; pdfname &amp; \" at index \" &amp; i)\n    Else\n     CompareStrings = False\n     MsgBox \"String not found!\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 8411416, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh3.googleusercontent.com/-x9EZEdf7VqI/AAAAAAAAAAI/AAAAAAAAAFs/_eIK67IhVpg/photo.jpg?sz=128", "display_name": "Devendra Vastrakar", "link": "https://stackoverflow.com/users/8411416/devendra-vastrakar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 653, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508344441, "creation_date": 1508340818, "last_edit_date": 1531164843, "question_id": 46813990, "link": "https://stackoverflow.com/questions/46813990/check-value-in-the-array-in-vbscript", "title": "check value in the array in Vbscript", "body": "<p>I have one array <strong>app.getValue(\"Model.OutputArrays.FinalCompleteFileName_Array\")=\"6F_HMBDConfig_978153ewnqsettgb73171_1219_31_640.pdf\",\"6F_HMBDConfig_978153ewnqsettgb73171_1219_31_640.pdf\",\"6F_HMBDConfig_978153ewnqsettgb73171_1219_31_640.pdf\"</strong></p>\n\n<p>I have to apply a condition or check in the array if <strong>pdfname</strong> is already exist in the array then it will go to under If condition. But for the below code pdfname is always going to the Else condition even the pdfname is present in the filename_array.</p>\n\n<p>please correct me where i am going wrong. </p>\n\n<pre><code>sub run\n\npdfname = \"6F_HMBDConfig_978153ewnqsettgb73171_1219_31_640.pdf\"\nfilename_array = app.getValue(\"Model.OutputArrays.FinalCompleteFileName_Array\")\nTestArray = Split(filename_array , \",\")\n  For i=Lbound(TestArray) to Ubound(TestArray)\n    If StrComp(TestArray(i), pdfname , 1) = 0 Then\n      CompareStrings = True\n     MsgBox(\"Found \" &amp; pdfname &amp; \" at index \" &amp; i)\n    Else\n     CompareStrings = False\n     MsgBox \"String not found!\"\nEnd If\nNext\n\nend sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1508343343, "post_id": 46813956, "comment_id": 80576812, "body": "The <code>BeforeUpdate</code> event won&#39;t fire on the calculated control.  You say the user completes entry of <i>downtime</i>  - add the code to the control that the user manually completes."}, {"owner": {"reputation": 25, "user_id": 8684729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fc615e4f2dbb0d3d76bb9ba2dff1c97?s=128&d=identicon&r=PG&f=1", "display_name": "Flammie", "link": "https://stackoverflow.com/users/8684729/flammie"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1508344974, "post_id": 46813956, "comment_id": 80577697, "body": "That was the first place I tried the code. I&#39;m sorry, I should have mentioned that as well. I&#39;ve tried putting the code in the user entry box, the form itself and the calculated field."}], "answers": [{"comments": [{"owner": {"reputation": 116, "user_id": 4950542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/736eb435a104873393b977a5c6093b91?s=128&d=identicon&r=PG", "display_name": "David Marten", "link": "https://stackoverflow.com/users/4950542/david-marten"}, "edited": false, "score": 0, "creation_date": 1508346906, "post_id": 46815512, "comment_id": 80578687, "body": "<code>Cancel = True</code> does nothing in this code. The AfterUpdate event does not have a <code>Cancel</code> argument. You may wish to consider adding <code>Option Explicit</code> to the top of every code module, so it will highlight undeclared variables when you compile (Here <code>Cancel</code> is undeclared.)"}], "tags": [], "owner": {"reputation": 25, "user_id": 8684729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fc615e4f2dbb0d3d76bb9ba2dff1c97?s=128&d=identicon&r=PG&f=1", "display_name": "Flammie", "link": "https://stackoverflow.com/users/8684729/flammie"}, "is_accepted": false, "score": 0, "last_activity_date": 1508346057, "creation_date": 1508346057, "answer_id": 46815512, "question_id": 46813956, "link": "https://stackoverflow.com/questions/46813956/my-vba-code-is-not-reacting-when-a-condition-has-been-met/46815512#46815512", "title": "My VBA code is not reacting when a condition has been met", "body": "<p>I got it to work. I had to put the code in the user's data entry box AND as an \"after update\" since the calculation wouldn't happen until after the entry has been made. Thank you, Darren, for your help. :) Here is the code that works.</p>\n\n<pre><code>*Private Sub MinutesDown_AfterUpdate()\n    If (Me.RunningTotal &lt; 0) Then\n        MsgBox (RunningTotal &amp; \"Please check your downtime.\")\n        Cancel = True\n    End If\nEnd Sub*\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8684729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fc615e4f2dbb0d3d76bb9ba2dff1c97?s=128&d=identicon&r=PG&f=1", "display_name": "Flammie", "link": "https://stackoverflow.com/users/8684729/flammie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508346057, "creation_date": 1508340736, "last_edit_date": 1508343189, "question_id": 46813956, "link": "https://stackoverflow.com/questions/46813956/my-vba-code-is-not-reacting-when-a-condition-has-been-met", "title": "My VBA code is not reacting when a condition has been met", "body": "<p>I am using VBA in Microsoft Access. I want the code to run before the user completes each entry of \"downtime\". I am trying to make sure that the value of a box is not a negative number. The box actually holds a formula. I don't know if that matters but, I thought I would mention that. I want to check the result of the calculation (the value that is showing in that box) and if it is less than 0, I want a MsgBox to pop up. My code is doing nothing. No error, no pop-up, no warnings.  </p>\n\n<p>Here is my code. </p>\n\n<pre><code>Private Sub Form_BeforeUpdate(Cancel As Integer)\n    If (Me.RunningTotal.Value &lt; 0) Then\n        MsgBox (RunningTotal &amp; \"Please check your downtime.\")\n        Cancel = True\n    End If\nEnd Sub \n</code></pre>\n\n<p>I have tried using the \"RunningTotal\" in brackets as well with no luck. I have also tried beforeupdat as well as afterupdate. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 151, "user_id": 4459307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d24b1cb69ddebc08bc048633ad5dccbe?s=128&d=identicon&r=PG&f=1", "display_name": "Ravarro", "link": "https://stackoverflow.com/users/4459307/ravarro"}, "edited": false, "score": 0, "creation_date": 1508341063, "post_id": 46813937, "comment_id": 80575227, "body": "To clarify - the error usually happens when I try to run the code again. To help me understand the code better, I&#39;m trying to work out what triggers that error?"}], "owner": {"reputation": 151, "user_id": 4459307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d24b1cb69ddebc08bc048633ad5dccbe?s=128&d=identicon&r=PG&f=1", "display_name": "Ravarro", "link": "https://stackoverflow.com/users/4459307/ravarro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1023, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1508340680, "creation_date": 1508340680, "question_id": 46813937, "link": "https://stackoverflow.com/questions/46813937/split-excel-sheet-into-multiple-workbooks-based-on-column-value", "title": "Split Excel sheet into multiple workbooks based on column value", "body": "<p>Let's say I have a spreadsheet with three columns, with column A having duplicate values. The row headers are in row 3. I'd like to split the sheet for each unique value in column A and its associated rows, where they're copied over to different workbooks - one workbook per unique value from column A.</p>\n\n<p>I've been using the code below based on something I found online, however it seems very temperamental. Sometimes it works, but other times I get the error \"Run-time error '1004': No cells were found.\" I've indicated the row in the code below with a comment where the debugger states the error is. Can someone please help me troubleshoot the code?</p>\n\n<pre><code>Option Explicit\n\nSub ParseItems()\n'Based on selected column, data is filtered to individual workbooks\n'workbooks are named for the value plus today's date\nDim LR As Long, Itm As Long, MyCount As Long, vCol As Long\nDim ws As Worksheet, MyArr As Variant, vTitles As String, SvPath As String\n\n'Sheet with data in it\n   Set ws = Sheets(\"input data\")\n\n'Path to save files into, remember the final \\\n    SvPath = \"C:\\My Work Documents\\\"\n\n'Range where titles are across top of data, as string, data MUST\n'have titles in this row, edit to suit your titles locale\n    vTitles = \"A1:AT1\"\n\n'Choose column to evaluate from, column A = 1, B = 2, etc.\n   vCol = 1\n\n'Spot bottom row of data\n   LR = ws.Cells(ws.Rows.Count, vCol).End(xlUp).Row\n\n'Speed up macro execution\n   Application.ScreenUpdating = False\n\n'Get a temporary list of unique values from key column\n    ws.Columns(vCol).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=ws.Range(\"EE1\"), Unique:=True\n\n'Sort the temporary list\n    ws.Columns(\"EE:EE\").Sort Key1:=ws.Range(\"EE2\"), Order1:=xlAscending, Header:=xlYes, _\n       OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, DataOption1:=xlSortNormal\n\n'(THIS IS WHERE THE DEBUGGER STOPS) Put list into an array for looping (values cannot be the result of formulas, must be constants)\n    MyArr = Application.WorksheetFunction.Transpose(ws.Range(\"EE2:EE\" &amp; Rows.Count).SpecialCells(xlCellTypeConstants))\n\n'clear temporary worksheet list\n    ws.Range(\"EE:EE\").Clear\n\n'Turn on the autofilter, one column only is all that is needed\n    ws.Range(vTitles).AutoFilter\n\n'Loop through list one value at a time\n    For Itm = 1 To UBound(MyArr)\n        ws.Range(vTitles).AutoFilter Field:=vCol, Criteria1:=MyArr(Itm)\n\n        ws.Range(\"A1:A\" &amp; LR).EntireRow.Copy\n        Workbooks.Add\n        Range(\"A1\").PasteSpecial xlPasteAll\n        Cells.Columns.AutoFit\n        MyCount = MyCount + Range(\"A\" &amp; Rows.Count).End(xlUp).Row - 1\n\n        ActiveWorkbook.SaveAs SvPath &amp; MyArr(Itm) &amp; Format(Date, \" MM-DD-YY\"), xlNormal\n        'ActiveWorkbook.SaveAs SvPath &amp; MyArr(Itm) &amp; Format(Date, \" MM-DD-YY\") &amp; \".xlsx\", 51   'use for Excel 2007+\n        ActiveWorkbook.Close False\n\n        ws.Range(vTitles).AutoFilter Field:=vCol\n    Next Itm\n\n'Cleanup\n    ws.AutoFilterMode = False\n    MsgBox \"Rows with data: \" &amp; (LR - 1) &amp; vbLf &amp; \"Rows copied to other sheets: \" &amp; MyCount &amp; vbLf &amp; \"Hope they match!!\"\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1508341479, "post_id": 46813704, "comment_id": 80575546, "body": "What happens if you try manually saving to that location with that filename?"}, {"owner": {"reputation": 15, "user_id": 7822605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bba9ce95764a550a695fda756e5447?s=128&d=identicon&r=PG&f=1", "display_name": "Adije", "link": "https://stackoverflow.com/users/7822605/adije"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1510767954, "post_id": 46813704, "comment_id": 81578833, "body": "Yeah the problem was privileges.. It wouldn&#39;t have worked if I made changes and tried to save. I overlooked that. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7822605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bba9ce95764a550a695fda756e5447?s=128&d=identicon&r=PG&f=1", "display_name": "Adije", "link": "https://stackoverflow.com/users/7822605/adije"}, "edited": false, "score": 0, "creation_date": 1510767830, "post_id": 46814031, "comment_id": 81578764, "body": "The issue was privileges... I was given read only access, I didn&#39;t think about not having write until you said that, I just got write and it works. Thank you"}], "tags": [], "owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1508341344, "last_edit_date": 1508341344, "creation_date": 1508340955, "answer_id": 46814031, "question_id": 46813704, "link": "https://stackoverflow.com/questions/46813704/method-saveas-of-object-workbook-failed-vba/46814031#46814031", "title": "Method &#39;SaveAs&#39; of object &#39;_Workbook&#39; failed VBA", "body": "<p>Try this</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:=\"\\\\sw\\mes\\PS\\SC\\SCM_Supply_Execution\\Spares\\This Weeks Number Database\\This Weeks Numbers(raw) \" &amp; rdate &amp; \".xlsm\" _\n        , FileFormat:=xlOpenXMLWorkbookMacroEnabled\n</code></pre>\n\n<p>This might have issues if the file already exists because then a pop-up will ask you if you want to overwrite it or not</p>\n\n<p>Though I think the error is due to an issue with privileges in that specific location or connection issues</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 7822605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bba9ce95764a550a695fda756e5447?s=128&d=identicon&r=PG&f=1", "display_name": "Adije", "link": "https://stackoverflow.com/users/7822605/adije"}, "edited": false, "score": 0, "creation_date": 1510768110, "post_id": 46814286, "comment_id": 81578918, "body": "Yeah the problem was privileges.. I overlooked that and spent an hour thinking my code was bad when the only problem was no write access -_- Thanks for the help"}], "tags": [], "owner": {"reputation": 76, "user_id": 7612487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f3d5b9164bf7a8eadf9e1b304f07cd2?s=128&d=identicon&r=PG&f=1", "display_name": "J3NKO", "link": "https://stackoverflow.com/users/7612487/j3nko"}, "is_accepted": false, "score": 1, "last_activity_date": 1508341764, "creation_date": 1508341764, "answer_id": 46814286, "question_id": 46813704, "link": "https://stackoverflow.com/questions/46813704/method-saveas-of-object-workbook-failed-vba/46814286#46814286", "title": "Method &#39;SaveAs&#39; of object &#39;_Workbook&#39; failed VBA", "body": "<p>As a test, run the code against file locations only YOU have access to. I'm noticing a reference to shared drive on the second command so maybe someone is already in it and it can't be saved over.</p>\n\n<p>Set display alerts to true for now.</p>\n\n<p>Also, When you run the test macro, make sure you don't have any windows explorer windows open and feed back here with results and I'll assist if it debugs again.</p>\n\n<p>On the face of it, the code looks good to me.</p>\n"}], "owner": {"reputation": 15, "user_id": 7822605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bba9ce95764a550a695fda756e5447?s=128&d=identicon&r=PG&f=1", "display_name": "Adije", "link": "https://stackoverflow.com/users/7822605/adije"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3553, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1508341764, "creation_date": 1508340001, "last_edit_date": 1531164843, "question_id": 46813704, "link": "https://stackoverflow.com/questions/46813704/method-saveas-of-object-workbook-failed-vba", "title": "Method &#39;SaveAs&#39; of object &#39;_Workbook&#39; failed VBA", "body": "<p>I have a workbook that is connected to a database and when you refresh the workbook, it refreshes your data in the workbook. Afterwards a macro is ran to save the new (raw) data in two different locations, then the macro will do analysis on that raw data, and save the same workbook later on in 4 other locations.\nWhen I am trying to do the first save of the raw data, I am able to save to the first location, but when it moves to the second location I am getting the error: Run-time error '1004': Method 'SaveAs' of object '_Workbook' failed. Both of the locations are valid locations.</p>\n\n<p>Here is one sub in the macro that does the first file save:</p>\n\n<pre><code>Sub saveraw()\n\nDim rdate As String\nDim rawfilename As String, rawfilename1 As String\nDim mywb As Workbook\n\nSet mywb = ActiveWorkbook\n\nrdate = Format(Now(), \"mm-dd-yy\")\n\nrawfilename = \"\\\\sw\\mes\\PS\\SC\\SCM_Supply_Execution\\Spares\\This Weeks Number Database\\This Weeks Numbers(raw) \" &amp; rdate &amp; \".xlsm\"\nrawfilename1 = \"\\\\sw\\mes\\PS\\SC\\SCM_Shared\\Spares Reports\\This Weeks Numbers(raw) \" &amp; rdate &amp; \".xlsm\"\n\nmywb.Save\n\nWorksheets(\"Sheet2\").Range(\"A2\") = Null\n\nApplication.DisplayAlerts = False\n\nmywb.SaveAs Filename:=rawfilename\nmywb.SaveAs Filename:=rawfilename1\n\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>I have also tried using the method of</p>\n\n<pre><code>ActiveWorkbook.SaveAs\n</code></pre>\n\n<p>in place of both of the mywb.SaveAs, but that did not work either.</p>\n"}, {"tags": ["html", "vba", "web-scraping", "screen-scraping"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 1, "creation_date": 1539518615, "post_id": 52579042, "comment_id": 92523466, "body": "Thanks so much, QHarr! Was not expecting an answer on this but meant I could pick this up again :)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1538319396, "creation_date": 1538319396, "answer_id": 52579042, "question_id": 46813691, "link": "https://stackoverflow.com/questions/46813691/vba-click-through-website-menu/52579042#52579042", "title": "VBA Click Through Website Menu", "body": "<p>Firstly, the method you are trying to use is not part of IE but of <code>.document</code> so you would have needed <code>.document.getElementsByTagName(\"button\")</code></p>\n\n<p>I would use the following:</p>\n\n<p>The first button has an id so you could have tried:</p>\n\n<pre><code>.document.getElementById(\"otherActionsButton\").Click\n</code></pre>\n\n<p>The second button you can use an attribute=value  CSS selector to target the <code>data-qa</code> attribute by its value:</p>\n\n<pre><code>[data-qa='show-history']\n</code></pre>\n\n<p>You apply as follows:</p>\n\n<pre><code>.document.querySelector(\"[data-qa='show-history']\").Click\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 794, "favorite_count": 0, "accepted_answer_id": 52579042, "answer_count": 1, "score": 1, "last_activity_date": 1539521575, "creation_date": 1508339954, "last_edit_date": 1539521575, "question_id": 46813691, "link": "https://stackoverflow.com/questions/46813691/vba-click-through-website-menu", "title": "VBA Click Through Website Menu", "body": "<p>I want to create some VBA to extract information from a website. I found the information in the HTML, but I believe it's only shown/populated in the HTML source when certain buttons are clicked on the page. I've been trying to use getElementsByTagName to perform the clicks but it has not worked so far. My code so far is to try for the second click straight away:</p>\n\n<pre><code>Sub googlesearch()\n    Set objIE = CreateObject(\"InternetExplorer.Application\")\n    WebSite = \"MyLink\"\n\n    With objIE\n        .Visible = True\n        .navigate WebSite\n        Do While .Busy Or .readyState &lt;&gt; 4\n            DoEvents\n        Loop\n\nSet elems = .getElementsByTagName(\"button\")\n    For Each e In elems\n\n        If (e.getAttribute(\"id\") = \"show-history\") Then\n            e.Click\n            Exit For\n        End If\n\n    Next e\n\nEnd With\n\n Set ie = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I get Run Time error 438, the object doesn't support property or method.</p>\n\n<p>The code for the element I want to click first is:</p>\n\n<pre><code>&lt;button class=\"btn btn-lg btn-trigger other-actions-btn\" id=\"otherActionsButton\" aria-haspopup=\"true\" type=\"button\" data-qa=\"toggle-other-actions\" olive-menu-initialized=\"true\" olive-menu-trigger=\"otherActionsMenu\" olive-menu-position=\"below right\" olive-menu=\"otherActionsMenu\"&gt;Other Actions&lt;/button&gt;\n</code></pre>\n\n<p>The code for the second button is:</p>\n\n<pre><code>&lt;button class=\"item button-link\" type=\"button\" data-qa=\"show-history\" data-action=\"show:history\"&gt;View History&lt;/button&gt;\n</code></pre>\n\n<p>There seems to be a lag sometimes between the page loading and all the elements being clickable because of something happening in the background, I'm not sure if this would be causing an issue?</p>\n\n<p>Any thoughts welcome!</p>\n\n<p>James</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3365, "user_id": 4000926, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ad4c1c6e6b99d7976e29e54661a0260?s=128&d=identicon&r=PG&f=1", "display_name": "cramopy", "link": "https://stackoverflow.com/users/4000926/cramopy"}, "edited": false, "score": 0, "creation_date": 1508338421, "post_id": 46813128, "comment_id": 80573343, "body": "What errors do you get? What is your <b>exact</b> problem? Right now is hard to help you with the information provided.... Please clarify!"}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "reply_to_user": {"reputation": 3365, "user_id": 4000926, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ad4c1c6e6b99d7976e29e54661a0260?s=128&d=identicon&r=PG&f=1", "display_name": "cramopy", "link": "https://stackoverflow.com/users/4000926/cramopy"}, "edited": false, "score": 0, "creation_date": 1508338716, "post_id": 46813128, "comment_id": 80573546, "body": "I get &quot;syntax error&quot; when trying to run the above loop. I am fairly sure the syntax is wrong (after &quot;Then&quot;) but I cannot figure out how to use the right syntax with the &quot;x&quot; variable added."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1508338756, "post_id": 46813128, "comment_id": 80573576, "body": "Check your parenthesis as well."}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1508339029, "post_id": 46813128, "comment_id": 80573793, "body": "What do you mean by that? I am trying to select Range(&quot;A1:I4&quot;) but using 1 as an &quot;x&quot; variable, and 4 as an x+3 variable."}], "answers": [{"comments": [{"owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "edited": false, "score": 0, "creation_date": 1508338796, "post_id": 46813176, "comment_id": 80573602, "body": "I never knew you could use column letters for the column input on <code>Cells(row,col)</code>! Learn something new every day."}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1508339015, "post_id": 46813176, "comment_id": 80573776, "body": "The first bit works right imo its the part after &quot;Then&quot; that doesn&#39;t work. Unfortunately I get syntax error likewise when trying your version."}, {"owner": {"reputation": 2454, "user_id": 8784938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753bb55c80a644f950a41ae11cfbe48c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperStew", "link": "https://stackoverflow.com/users/8784938/superstew"}, "edited": false, "score": 1, "creation_date": 1508339115, "post_id": 46813176, "comment_id": 80573849, "body": "Just noticed it looks like there is an extra ) at the end before .ClearContents. Try removing that real quick."}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1508339367, "post_id": 46813176, "comment_id": 80574029, "body": "Yep that worked, I would&#39;ve never figured out the correct syntax by myself. I am taking note of this. Thank you for the help!"}], "tags": [], "owner": {"reputation": 2454, "user_id": 8784938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753bb55c80a644f950a41ae11cfbe48c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperStew", "link": "https://stackoverflow.com/users/8784938/superstew"}, "is_accepted": true, "score": 4, "last_activity_date": 1508339335, "last_edit_date": 1508339335, "creation_date": 1508338467, "answer_id": 46813176, "question_id": 46813128, "link": "https://stackoverflow.com/questions/46813128/vba-loop-if-cell-contains-specific-value-then-delete-the-row-containing-the-val/46813176#46813176", "title": "VBA Loop: if cell contains specific value then delete the row containing the value and the next 3 rows below", "body": "<p>I think you just to fix this part and put the colon in the quotes.</p>\n\n<pre><code>If Range(\"B\" &amp; x).Value = \"DELETE\" Then Range(\"A\" &amp; x &amp; \":I\" &amp; x + 4)).ClearContents\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>You may also use \"Cell\" rather than Range for the first bit. </p>\n\n<pre><code>If Cells(x,\"B\").Value = .....\n</code></pre>\n\n<p>This works for me:</p>\n\n<pre><code>Sub RemoveDel()\nlastrow = Cells(Rows.Count, \"B\").End(xlUp).Row\nFor x = 1 To lastrow\n\n    If Range(\"B\" &amp; x).Value = \"DELETE\" Then Range(\"A\" &amp; x &amp; \":I\" &amp; x + 4).ClearContents\n\nNext x\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2445, "favorite_count": 0, "accepted_answer_id": 46813176, "answer_count": 1, "score": 0, "last_activity_date": 1508339335, "creation_date": 1508338316, "question_id": 46813128, "link": "https://stackoverflow.com/questions/46813128/vba-loop-if-cell-contains-specific-value-then-delete-the-row-containing-the-val", "title": "VBA Loop: if cell contains specific value then delete the row containing the value and the next 3 rows below", "body": "<p>Hi there I am trying to loop through a long report that removes deletions.</p>\n\n<p>The general logic would be this: if the script finds the value \"DELETE\" in the column B1 then it should delete the range \"A1:I4\". I have the below script which obviously doesn't work. I am trying to figure out the correct syntax for a range across multiple columns using the \"X\" variable. Any help would be appreciated!</p>\n\n<p>I have the following loop:</p>\n\n<pre><code>Sub RemoveDel()\nlastrow = Cells(Rows.Count, \"B\").End(xlUp).Row\nFor x = 1 To lastrow\n\n    If Range(\"B\" &amp; x).Value = \"DELETE\" Then Range(\"A\" &amp; x:\"I\" &amp; x + 4)).ClearContents\n\n     Next x\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "edited": false, "score": 0, "creation_date": 1508338359, "post_id": 46813024, "comment_id": 80573300, "body": "Is the Order List sheet hidden, by chance? Try <code>Range(&quot;B28&quot;).Copy Sheets(&quot;Order List&quot;).Range(&quot;A1&quot;).Offset(1,0)</code> inside of your <code>If Range(&quot;G28&quot;) &gt;= &quot;1&quot;</code> if instead of what&#39;s in there now."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1508338830, "post_id": 46813024, "comment_id": 80573627, "body": "You cannot select a cell on a sheet which is inactive."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8736126, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1fec2aae04c1a4c4ff613ccc5a0c013b?s=128&d=identicon&r=PG&f=1", "display_name": "J Ding", "link": "https://stackoverflow.com/users/8736126/j-ding"}, "edited": false, "score": 0, "creation_date": 1508338994, "post_id": 46813250, "comment_id": 80573761, "body": "Thank you very much. However, if I click button again for other lines, will it paste to A3 rather than replacing A2?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 33, "user_id": 8736126, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1fec2aae04c1a4c4ff613ccc5a0c013b?s=128&d=identicon&r=PG&f=1", "display_name": "J Ding", "link": "https://stackoverflow.com/users/8736126/j-ding"}, "edited": false, "score": 0, "creation_date": 1508339048, "post_id": 46813250, "comment_id": 80573805, "body": "@JDing It will not.  That logic wasn&#39;t in your original code.  I encourage you to edit what I&#39;ve provided to include that functionality.  Create a new question if you get stuck."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1508338657, "creation_date": 1508338657, "answer_id": 46813250, "question_id": 46813024, "link": "https://stackoverflow.com/questions/46813024/trying-to-copy-data-from-multiple-sheets-one-by-one-and-paste-to-a-different-she/46813250#46813250", "title": "Trying to copy data from multiple sheets one by one and paste to a different sheet.", "body": "<p>Don't use .Select or .Activate.  That's what's causing your problem.  See this explanation for how to avoid it and why: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n\n<p>Here's an updated version of your code which should work for you:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim wb As Workbook\n    Dim wsSource As Worksheet\n    Dim wsDest As Worksheet\n\n    Set wb = ActiveWorkbook\n    Set wsSource = wb.Sheets(\"Sheet1\")  'Set to correct source worksheet name\n    Set wsDest = wb.Sheets(\"Order List\")\n\n    'Stop if report not filled in fully\n    If wsSource.Range(\"G28\").Value &lt; 1 Then\n        MsgBox \"Please Amend Quantity\"\n        Exit Sub\n    End If\n\n    wsSource.Range(\"B28\").Copy wsDest.Range(\"A2\")\n    wsDest.Range(\"A:D\").EntireColumn.AutoFit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8736126, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1fec2aae04c1a4c4ff613ccc5a0c013b?s=128&d=identicon&r=PG&f=1", "display_name": "J Ding", "link": "https://stackoverflow.com/users/8736126/j-ding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 46813250, "answer_count": 1, "score": 0, "last_activity_date": 1508338657, "creation_date": 1508338026, "question_id": 46813024, "link": "https://stackoverflow.com/questions/46813024/trying-to-copy-data-from-multiple-sheets-one-by-one-and-paste-to-a-different-she", "title": "Trying to copy data from multiple sheets one by one and paste to a different sheet.", "body": "<p>I am trying to copy data from multiple sheets one by one and paste them to a different sheet. Here is my code below. However, it shows \"Run-time error 1004: Select method of Range class failed\". </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n'Stop if report not filled in fully\nIf Range(\"G28\") &lt; \"1\" Then\nMsgBox (\"Please Amend Quantity\")\nEnd If\n\n\n\n If Range(\"G28\") &gt;= \"1\" Then\n\n  Range(\"B28\").Select\n  Selection.Copy\n  Sheets(\"Order List\").Range(\"A1\").Offset(1, 0).Select\n  ActiveSheet.Paste\n\n End If\n\n Sheets(\"Order List\").Columns(\"A:D\").AutoFit\n\n\n\nEnd Sub\n</code></pre>\n\n<p>The code: \"Sheets(\"Order List\").Range(\"A1\").Offset(1,0).Select\" is highlighted error. I was trying to let it select the blank column in Line A from A1 under Order List sheet and paste the value from B28 under current sheet to it. Please give me some advice. Many thanks</p>\n"}, {"tags": ["excel", "ms-access", "sharepoint", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1508337592, "post_id": 46812768, "comment_id": 80572763, "body": "Well, if the path is not valid, and you&#39;re not sharing the actual path... I&#39;d say it&#39;s this space here:<code>db ;</code>. But who knows, I&#39;m debugging an imaginary path."}, {"owner": {"reputation": 588, "user_id": 7049751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6b0e27ce4e8c20a20d34e793f4e4636?s=128&d=identicon&r=PG&f=1", "display_name": "Sphinx", "link": "https://stackoverflow.com/users/7049751/sphinx"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1508338966, "post_id": 46812768, "comment_id": 80573739, "body": "But it&#39;s working like 95% of the time. I can save and download data to/from database. Just sometimes it won&#39;t connect and i don&#39;t know why."}], "owner": {"reputation": 588, "user_id": 7049751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6b0e27ce4e8c20a20d34e793f4e4636?s=128&d=identicon&r=PG&f=1", "display_name": "Sphinx", "link": "https://stackoverflow.com/users/7049751/sphinx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1167, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1585210160, "creation_date": 1508337440, "last_edit_date": 1531164843, "question_id": 46812768, "link": "https://stackoverflow.com/questions/46812768/vba-connect-from-excel-to-access-database-file-placed-on-sharepoint", "title": "VBA Connect from excel to Access database file placed on sharepoint", "body": "<p>I got a little problem with connecting to .accdb file.\n<BR> Couple words of explanation \n<BR>I have excel file and access database \n<BR>Access database is located on sharepoint folder. \n<BR>Excel file is located on my desktop \n<BR>Usually there is no problem but sometimes i got -2147467259 error when trying to connect to .accdb file form excel. Error description is something like \"String \"connection string\" is not a valid path...\" (this is only part of description) \n<BR> When this error occurs i can still open sharepoint site using web browser and access all files in folder. \n<BR> Error dissapears when i open database file using browser.\n<BR> \n<BR> My connection string is <code>cnn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\\\\some\\path\\to\\folder\\on\\sharepoint\\Database.accdb ;Jet OLEDB:Database Password=xxxx\"</code></p>\n\n<p><BR> Does anyone knows why it's not working from time to time? </p>\n"}, {"tags": ["arrays", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1295, "user_id": 4360863, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/heWif.png?s=128&g=1", "display_name": "Philip Brack", "link": "https://stackoverflow.com/users/4360863/philip-brack"}, "is_accepted": false, "score": 1, "last_activity_date": 1508340546, "creation_date": 1508340546, "answer_id": 46813887, "question_id": 46812468, "link": "https://stackoverflow.com/questions/46812468/how-to-see-if-an-array-is-contained-in-a-column/46813887#46813887", "title": "How to see if an array is contained in a column?", "body": "<p>To check if a string is contained within another you would do so using </p>\n\n<pre><code>If InStr(1, str, substr, vbTextCompare) &gt; 0) Then\n    ' put logic for when substr is within str\nEnd If\n</code></pre>\n\n<p>which will return a positive number of the substr is found anywhere within str. </p>\n\n<p>For your specific application I would work on debugging your loop, it looks like you are on the right track</p>\n"}], "owner": {"reputation": 159, "user_id": 5363515, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/988955301154818/picture?type=large", "display_name": "Calin Lencar", "link": "https://stackoverflow.com/users/5363515/calin-lencar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508340546, "creation_date": 1508336488, "question_id": 46812468, "link": "https://stackoverflow.com/questions/46812468/how-to-see-if-an-array-is-contained-in-a-column", "title": "How to see if an array is contained in a column?", "body": "<p>I am looking for a vba code for finding out if an array of strings is contained(not totally matched) in the cells of a column. I have a list of fake emails stored in a sheet and in another sheet i have the list of emails I want to check. If an email from the first list is found in the 2nd column i need the row to be coloured in yellow.\nHere is what i have:</p>\n\n<pre><code>Dim list As String, c As Range, count As Long, total As Long\ncount = 1\ntotal = Range(\"I\" &amp; Rows.count).End(xlUp).Row\nFor ix = 1 To total\nlist = Worksheets(\"Helper\").Range(\"A\" &amp; counter).Value\nk = \"a\" &amp; count\n    For Each c In Worksheets(\"JP\").Range(k)\n        c.EntireRow.Interior.Color = 255\n    Next c\nEnd If\nEnd If\ncount = count + 1\nNext ix\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1508337038, "post_id": 46812467, "comment_id": 80572351, "body": "See <a href=\"https://stackoverflow.com/questions/10714251\">how to avoid using <code>.Select</code>/<code>.Activate</code></a>. That may help clarify how to work directly with data."}], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 0, "last_activity_date": 1508337937, "creation_date": 1508337937, "answer_id": 46812979, "question_id": 46812467, "link": "https://stackoverflow.com/questions/46812467/vba-creating-multiple-files-from-list/46812979#46812979", "title": "VBA - Creating multiple files from list", "body": "<p>Something like this should work for you:</p>\n\n<pre><code>Sub tst()\n\n    Dim wb As Workbook\n    Dim wsNames As Worksheet\n    Dim wsDest As Worksheet\n    Dim NameCells As Range\n    Dim NameCell As Range\n    Dim cesta As String\n    Dim Nazev As String\n\n    cesta = \"C:\\Test\\\"\n    Set wb = ActiveWorkbook\n    Set wsNames = wb.Sheets(\"CC\")\n    Set wsDest = wb.Sheets(\"CZK\")\n    Set NameCells = wsNames.Range(\"A3\", wsNames.Cells(wsNames.Rows.Count, \"A\").End(xlUp))\n\n    Application.DisplayAlerts = False\n    For Each NameCell In NameCells\n        Nazev = NameCell.Value\n        wsDest.Range(\"B2\").Value = Nazev\n        wb.SaveAs cesta &amp; Nazev &amp; \".xlsm\", xlOpenXMLWorkbookMacroEnabled\n    Next NameCell\n    Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8796126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aadf2cd4ce762eb8c53693b4079f963?s=128&d=identicon&r=PG&f=1", "display_name": "David P", "link": "https://stackoverflow.com/users/8796126/david-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 46812979, "answer_count": 1, "score": 0, "last_activity_date": 1576319591, "creation_date": 1508336478, "last_edit_date": 1576319591, "question_id": 46812467, "link": "https://stackoverflow.com/questions/46812467/vba-creating-multiple-files-from-list", "title": "VBA - Creating multiple files from list", "body": "<p>I am struggling with my VBA code. Instead of fixed values in a table, which contains the names how the workbooks should be saved as. My range needs to be variable (below example for starting with range \"A3\").</p>\n\n<pre><code>Sheets(\"CC\").Select  'sheet with the names\nRange(\"A3\").Select   ' starting from this range are the names in a column\nSelection.Copy\nSheets(\"CZK\").Select  'going to different sheet to paste some value\nRange(\"B2\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False      'pasting values to different sheet \nApplication.CutCopyMode = False\nSheets(\"CC\").Select        'returning back to the sheet with names\nNazev = Range(\"A3\")\nActiveWorkbook.SaveAs Filename:=cesta &amp; Nazev    'saving it with predefined path and name\n</code></pre>\n\n<p>I have to start like this:</p>\n\n<pre><code>Set MyRange = Sheets(\"CC\").Range(\"A3\")   ' predefining varible range\nSet MyRange = Range(MyRange, MyRange.End(xlDown))\n</code></pre>\n\n<p>But then I am stuck.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 3, "creation_date": 1508337058, "post_id": 46812350, "comment_id": 80572365, "body": "please share your efforts ! SO is not a free coding service."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8790930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa55ad89fc8161dd477c0d87446cfc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mir81", "link": "https://stackoverflow.com/users/8790930/mir81"}, "edited": false, "score": 0, "creation_date": 1508339243, "post_id": 46812728, "comment_id": 80573936, "body": "Thanks J.Fox I am not code expert, but i tried following Sub Test()     Dim ws As Worksheet     Dim rFind As Range          Set ws = ThisWorkbook.Worksheets(&quot;sheet2&quot;)     Set rFind = Range(&quot;A:A&quot;).Find(&quot;<i>TOTAL</i>&quot;, LookIn:=xlValues)          Worksheets(&quot;sheet1&quot;).Range(&quot;B11&quot;) = rFind       End Sub"}, {"owner": {"reputation": 1, "user_id": 8790930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa55ad89fc8161dd477c0d87446cfc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mir81", "link": "https://stackoverflow.com/users/8790930/mir81"}, "edited": false, "score": 0, "creation_date": 1508339494, "post_id": 46812728, "comment_id": 80574118, "body": "But it does the job but I was not able to extract the &quot;XX%&quot; and the other problem was that it worked only once that that picked the value and pasted in Cell but if you run the macro again it after deleting the value it was giving blank"}], "tags": [], "owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "is_accepted": false, "score": 1, "last_activity_date": 1508337327, "creation_date": 1508337327, "answer_id": 46812728, "question_id": 46812350, "link": "https://stackoverflow.com/questions/46812350/macro-script-to-search-specific-text-in-a-column-where-row-keep-changing/46812728#46812728", "title": "Macro script to search specific text in a column where row keep changing", "body": "<p>This was a pretty easy one so I just did it real quick. Remember like Gilles said though, be sure to show some effort on your part before posting or your question will likely be closed: see <a href=\"https://stackoverflow.com/help/mcve\">https://stackoverflow.com/help/mcve</a> for more information.</p>\n\n<pre><code>Sub FindPhrase()\nDim i As Long, searchCol As Long, dCell As Range, ws As Worksheet\n\nSet ws = ActiveSheet\n\n'column A\nsearchCol = 1\n\n'output cell\nSet dCell = ws.Range(\"B1\")\n\n'search through cells in specified column\nFor i = 1 To ws.Cells(ws.Rows.Count, searchCol).End(xlUp).Row\n    If InStr(ws.Cells(i, searchCol), \"The cpu utilization is \") &gt; 0 And InStr(ws.Cells(i, searchCol), \"%\") &gt; 0 Then\n        dCell.Value = CDbl(Replace(Mid(ws.Cells(i, searchCol), InStr(ws.Cells(i, searchCol), \"%\") - 2, 2), \"%\", \"\"))\n        Exit For\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8790930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa55ad89fc8161dd477c0d87446cfc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mir81", "link": "https://stackoverflow.com/users/8790930/mir81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1508341732, "creation_date": 1508336170, "last_edit_date": 1531164843, "question_id": 46812350, "link": "https://stackoverflow.com/questions/46812350/macro-script-to-search-specific-text-in-a-column-where-row-keep-changing", "title": "Macro script to search specific text in a column where row keep changing", "body": "<p>I am trying to create a macro that will go through a column Let say Column A and in that column there is a row that contains a text \" the cpu utilization is xx%\" and from that line if the macro can strip the \"XX%\" and put this value into a new sheet anywhere in the same workbook.</p>\n\n<p>Please note that row is not fixed the text remains same but rows will change and column remain same</p>\n\n<pre><code>Sub Test() \nDim ws As Worksheet \nDim rFind As Range \nSet ws = ThisWorkbook.Worksheets(\"sheet2\") \nSet rFind = Range(\"A:A\").Find(\"*TOTAL*\", LookIn:=xlValues) \nWorksheets(\"sheet1\").Range(\"B11\") = rFind \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508337698, "post_id": 46812312, "comment_id": 80572835, "body": "I would personally just use <code>Range(&quot;A1&quot;).Currentregion</code> to get the right range for the pivot."}, {"owner": {"reputation": 113, "user_id": 6235840, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/185d99992a1fdeb921bf7398145308ec?s=128&d=identicon&r=PG&f=1", "display_name": "Xiodrade", "link": "https://stackoverflow.com/users/6235840/xiodrade"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508348480, "post_id": 46812312, "comment_id": 80579456, "body": "Could you elaborate please? It won&#39;t take <code>SourceData:= Range(&quot;A1&quot;).Currentregion</code> because it says it needs more than one cell. Not sure how it&#39;s only pulling one cell though."}], "owner": {"reputation": 113, "user_id": 6235840, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/185d99992a1fdeb921bf7398145308ec?s=128&d=identicon&r=PG&f=1", "display_name": "Xiodrade", "link": "https://stackoverflow.com/users/6235840/xiodrade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508336054, "creation_date": 1508336054, "last_edit_date": 1531164843, "question_id": 46812312, "link": "https://stackoverflow.com/questions/46812312/condense-pivot-cell-selects", "title": "Condense pivot cell selects", "body": "<p>I was just wondering if there is a way to condense this down to minimal code?\nI am using lastrow for my end worksheet (the sheet my code generates after all is said and done with the pivot table), and lastrow2 is assisting in grabbing the range for the pivot table source data. I am not sure if lastrow2 is even required though?</p>\n\n<pre><code>Dim lastrow As Long\nDim lastrow2 As Long\n    lastrow = Cells(Rows.Count, \"A\").End(xlUp).Row\n    lastrow2 = Cells(Rows.Count, \"M\").End(xlUp).Row\n    Range(\"1:1\").Delete 'Report title\n    'Adding pivot table\n        Range(\"A1\").CurrentRegion.Select\n        Sheets.Add.Name = \"Pivot\"\n        ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase,     SourceData:= _\n            \"FNDWRR!A1:M\" &amp; lastrow2,     Version:=xlPivotTableVersion15).CreatePivotTable _\n            TableDestination:=\"Pivot!R3C1\", TableName:=\"StatPivot\"\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot-table", "calculated-field"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1508336462, "post_id": 46812007, "comment_id": 80571954, "body": "You appear to have a stray space after the equals and before (&#39;Monthly Forecasted Cost&#39;  Are you sure the field is actually being added and not failing silently on the .Add?"}, {"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1508338154, "post_id": 46812007, "comment_id": 80573162, "body": "@HarassedDad I am not sure whether it dies ! Possibly it\u2019s the formula too , but I deduct the pivot fields correctly , as the names that I use are actually the names of the fields and the formula seems to be correct in terms of commas, etc ... any idea what could be wrong with the formula ?"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1508354988, "post_id": 46812007, "comment_id": 80582946, "body": "Fire up the macro recorder, add the field manually, then review the code to see how it differs from what you&#39;ve posted."}], "owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508335253, "creation_date": 1508335253, "question_id": 46812007, "link": "https://stackoverflow.com/questions/46812007/error-while-adding-calculated-field-in-pivot-table", "title": "Error while adding calculated field in Pivot Table", "body": "<p>I have created a pivot table and I want to add a calculated field. I have written some lines of code trying to make it work but it keeps saying unable to get the PivotFields property of the PivotTable class. the error appears in line </p>\n\n<pre><code>With .PivotFields(\"Diff\")\n</code></pre>\n\n<p>The lines of code related to adding the new calculated field are below</p>\n\n<pre><code>.CalculatedFields.Add \"Diff\", \"= ('Monthly Forecasted Cost'- 'Actual Cost')\"\n\n With .PivotFields(\"Diff\")\n .Orientation = xlDataField\n .Position = 11\n End With\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 1, "last_activity_date": 1508335313, "creation_date": 1508335313, "answer_id": 46812023, "question_id": 46811826, "link": "https://stackoverflow.com/questions/46811826/select-value-of-a-dropdown-menu-second-colume/46812023#46812023", "title": "select value of a dropdown menu (second colume)", "body": "<p><code>docmd.runsql</code> is for <em>action</em> queries (Insert,Delete,Append) but doesn't return a recordset (for Select queries).</p>\n\n<p>If \"Anzahl_Etiketten\" returns only 1 value (the number of labels) then try <a href=\"https://support.office.com/en-us/article/DLookup-Function-8896cb03-e31f-45d1-86db-bed10dca5937\" rel=\"nofollow noreferrer\">dlookup</a>:</p>\n\n<pre><code>DoCmd.PrintOut , , , acHigh,dlookup(\"Anzahl_Etiketten\",\"qry_WEZ_TAB\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "is_accepted": true, "score": 0, "last_activity_date": 1508335837, "creation_date": 1508335837, "answer_id": 46812231, "question_id": 46811826, "link": "https://stackoverflow.com/questions/46811826/select-value-of-a-dropdown-menu-second-colume/46812231#46812231", "title": "select value of a dropdown menu (second colume)", "body": "<p>So I was way to much into the sql i goth a solution now:</p>\n\n<pre><code>Private Sub cmd_openreport_Click()\n\n'Set Variables\nDim Report\nDim Etikette\nDim anzahl\nDim SQL As String\n\n\nDoCmd.SetWarnings (WarningsOff) 'Turns Off Warnings\n\nEtikette = comb_etiketten_auswahl 'Etikette Equals the comb_etiketten_auswahl value\nReport = comb_etiketten_layout 'Report equals the value in the dropdown list\nanzahl = Forms!frm_Hauptmenu!comb_etiketten_auswahl.Column(1)\n\n\nMsgBox anzahl\n\n'If The Etiketten Dropdown is empty message to client\nIf Etikette &lt;&gt; \"\" Then\nElse\nMsgBox \"Bitte w\u00e4hlen Sie einen Datensatz aus.\"\nExit Sub\nEnd If\n\n'If The Report Dropdown is empty message to client\nIf Report &lt;&gt; \"\" Then\nElse\nMsgBox \"Bitte w\u00e4hlen Sie eine Etikettenauswahl aus.\"\nExit Sub\nEnd If\n\n\nDoCmd.OpenReport Report, acViewReport 'Open report\nDoCmd.PrintOut , , , acHigh, anzahl\nDoCmd.Close\nDoCmd.SetWarnings (WarningsOn) 'Turns Warnings back On\nEnd Sub\n</code></pre>\n\n<p>hope this can help anyone of you guys</p>\n"}], "owner": {"reputation": 13, "user_id": 8318347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4Idou.jpg?s=128&g=1", "display_name": "kint", "link": "https://stackoverflow.com/users/8318347/kint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 46812231, "answer_count": 2, "score": -1, "last_activity_date": 1522931191, "creation_date": 1508334707, "last_edit_date": 1522931191, "question_id": 46811826, "link": "https://stackoverflow.com/questions/46811826/select-value-of-a-dropdown-menu-second-colume", "title": "select value of a dropdown menu (second colume)", "body": "<p>im working on an acces db and im strugling on my vba code</p>\n\n<p><a href=\"https://i.stack.imgur.com/DjfSg.jpg\" rel=\"nofollow noreferrer\">this is my form</a></p>\n\n<p>and this is my code:</p>\n\n<pre><code>Private Sub cmd_openreport_Click()\n\n'Set Variables\nDim Report\nDim Etikette\nDim amount_of_copies\nDim SQL As String\n\n\nDoCmd.SetWarnings (WarningsOff) 'Turns Off Warnings\n\nEtikette = comb_etiketten_auswahl 'Etikette Equals the comb_etiketten_auswahl value\nReport = comb_etiketten_layout 'Report equals the value in the dropdown list\n'SQL = \"SELECT [qry_WEZ_TAB].[Anzahl_Etiketten] FROM [qry_WEZ_TAB];\n\n\n'If The Etiketten Dropdown is empty message to client\nIf Etikette &lt;&gt; \"\" Then\nElse\nMsgBox \"Bitte w\u00e4hlen Sie einen Datensatz aus.\"\nExit Sub\nEnd If\n\n'If The Report Dropdown is empty message to client\nIf Report &lt;&gt; \"\" Then\nElse\nMsgBox \"Bitte w\u00e4hlen Sie eine Etikettenauswahl aus.\"\nExit Sub\nEnd If\n\n'DoCmd.RunSQL SQL\n\n\n\nDoCmd.OpenReport Report, acViewReport 'Open report\nDoCmd.PrintOut , , , acHigh,amount_of_copies\nDoCmd.Close\nDoCmd.SetWarnings (WarningsOn) 'Turns Warnings back On\nEnd Sub\n</code></pre>\n\n<p>the problem is *HERE:</p>\n\n<pre><code>DoCmd.OpenReport Report, acViewReport 'Open report\nDoCmd.PrintOut , , , acHigh,*HERE\nDoCmd.Close\n</code></pre>\n\n<p>The value ther is the amount of copies printed out.... the problem is that value is set in my db but my idea was to use:</p>\n\n<pre><code>docmd.runsql SQL\n</code></pre>\n\n<p>as in my code set to:</p>\n\n<pre><code>\"SELECT [qry_WEZ_TAB].[Anzahl_Etiketten] FROM [qry_WEZ_TAB];\"\n</code></pre>\n\n<p>but the problem is that even that the sql command is correct i'll get an error...</p>\n\n<p>any idea how to fix this issue??</p>\n\n<p>if you have an alternate idea how to get that amount of copyes from the tab feel free to comment^^</p>\n\n<p><strong>EDIT :</strong></p>\n\n<p><strong>This question is Irelevant and does not have a purpose anymore!\nit was an internal script mistake!</strong></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1508334643, "post_id": 46811379, "comment_id": 80570686, "body": "That connection is attached to something (a querytable, a listobject, a pivottable). Check what data they have after the refresh."}], "answers": [{"comments": [{"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 1, "creation_date": 1508334454, "post_id": 46811515, "comment_id": 80570568, "body": "I think he means if the SQL Stored Procedure returns no rows"}], "tags": [], "owner": {"reputation": 730, "user_id": 7077298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Y0iM.jpg?s=128&g=1", "display_name": "hod", "link": "https://stackoverflow.com/users/7077298/hod"}, "is_accepted": true, "score": 0, "last_activity_date": 1508333742, "creation_date": 1508333742, "answer_id": 46811515, "question_id": 46811379, "link": "https://stackoverflow.com/questions/46811379/vba-code-calling-a-stored-proc-display-message-box-if-no-records-returned/46811515#46811515", "title": "VBA code calling a stored proc - display message box if no records returned", "body": "<p>Try this:</p>\n\n<pre><code>property_id = Sheets(\"Pro Forma Input\").Range(\"AD3\").Value\n\nIf property_id = \"\" Then\n    MsgBox \"There is nothing here!\"\nElse\nEnd If\n</code></pre>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 3947154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc656ef26cf698b871ccfd7f48859a64?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Ph", "link": "https://stackoverflow.com/users/3947154/benjamin-ph"}, "is_accepted": false, "score": 0, "last_activity_date": 1508335559, "creation_date": 1508335559, "answer_id": 46812109, "question_id": 46811379, "link": "https://stackoverflow.com/questions/46811379/vba-code-calling-a-stored-proc-display-message-box-if-no-records-returned/46812109#46812109", "title": "VBA code calling a stored proc - display message box if no records returned", "body": "<p>Thanks for the other poster for the solution, for some reason his/her post was deleted.  Here's what I did in case someone else needs it.</p>\n\n<pre><code>With ActiveWorkbook.Connections(\"FirstKey_One_Pager_connection\").OLEDBConnection\n.CommandText = \"EXEC dbo.usp_FirstKey_One_Pager '\" &amp; property_id &amp; \"'\"\nActiveWorkbook.Connections(\"FirstKey_One_Pager_connection\").Refresh\n\nIf Sheets(\"DataSource\").Range(\"B9\").Value = \"\" Then\n    MsgBox \"No property found using the RR ID entered\"\nElse\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 3947154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc656ef26cf698b871ccfd7f48859a64?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Ph", "link": "https://stackoverflow.com/users/3947154/benjamin-ph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 46811515, "answer_count": 2, "score": 0, "last_activity_date": 1508335559, "creation_date": 1508333395, "last_edit_date": 1508334819, "question_id": 46811379, "link": "https://stackoverflow.com/questions/46811379/vba-code-calling-a-stored-proc-display-message-box-if-no-records-returned", "title": "VBA code calling a stored proc - display message box if no records returned", "body": "<p>I borrowed this code and it seems to work fine. However, I'd like for it to show a message if the stored proc returns no record? Your help is greatly appreciated.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim property_id As Double\n\nproperty_id = Sheets(\"Pro Forma Input\").Range(\"AD3\").Value\n\nWith ActiveWorkbook.Connections(\"MyDataConnection\").OLEDBConnection\n.CommandText = \"EXEC dbo.my_stored_proc '\" &amp; property_id &amp; \"'\"\nActiveWorkbook.Connections(\"MyDataConnection\").Refresh\n\nEnd With\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1508333299, "post_id": 46811302, "comment_id": 80569716, "body": "You should just use <code>VLOOKUP</code>s to return the columns you want to your total tab"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8792478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fXftI.png?s=128&g=1", "display_name": "Roote", "link": "https://stackoverflow.com/users/8792478/roote"}, "is_accepted": false, "score": 0, "last_activity_date": 1508339654, "last_edit_date": 1508339654, "creation_date": 1508335779, "answer_id": 46812207, "question_id": 46811302, "link": "https://stackoverflow.com/questions/46811302/make-a-difference-amount-from-2-sheet-using-macro/46812207#46812207", "title": "Make a difference Amount from 2 sheet using Macro", "body": "<pre><code>=INDEX (\u00a0Column I want a return value from\u00a0; MATCH (\u00a0My Lookup Value\u00a0;\u00a0Column I want to Lookup against;0))\n</code></pre>\n\n<p>Use this formula to get the values in each column, then just subtract the results. </p>\n"}], "owner": {"reputation": 285, "user_id": 8475183, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/9f2400e5151b9ac9f48ab67e5594ab09?s=128&d=identicon&r=PG&f=1", "display_name": "Raspi Surya", "link": "https://stackoverflow.com/users/8475183/raspi-surya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1508339654, "creation_date": 1508333138, "last_edit_date": 1508333297, "question_id": 46811302, "link": "https://stackoverflow.com/questions/46811302/make-a-difference-amount-from-2-sheet-using-macro", "title": "Make a difference Amount from 2 sheet using Macro", "body": "<p>I have a problem to be solved. I have data from sheet 2016 and 2017. What I want to do is to make another sheet to calculate the difference money within 2016 and 2017. Please see the image link attached:</p>\n\n<p><strong>Case 1:</strong>\n<a href=\"https://i.stack.imgur.com/ru4Id.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ru4Id.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Case 2:</strong>\n<a href=\"https://i.stack.imgur.com/CDJHQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CDJHQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I want to do is simply create the new sheet to compare each column except column A (column name). \nand another problem is the number of columns is not fixed. some case may have 1 column to be compared, another might have more. So I guess I need the number of columns to become a variable?</p>\n\n<p>How is the idea to make the total (comparison) sheet using macro that can solve case 1 and case 2? please share your thought!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 1, "creation_date": 1508333497, "post_id": 46811288, "comment_id": 80569852, "body": "You want to look into <code>Application.FileDialog</code>"}, {"owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "reply_to_user": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 0, "creation_date": 1508335871, "post_id": 46811288, "comment_id": 80571571, "body": "@KacireeSoftware <code>FileDialog</code> is to choose a file that is not already opened."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1508337081, "post_id": 46811288, "comment_id": 80572380, "body": "There is a good example here how to populate a combobox with fill names<a href=\"https://stackoverflow.com/questions/35148314/how-to-display-the-file-name-from-the-path-name-in-combobox\">Populate Combobox with File names</a>"}, {"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "reply_to_user": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 0, "creation_date": 1508337136, "post_id": 46811288, "comment_id": 80572423, "body": "@simpLEMAn Yes that is true. I think I&#39;m suffering dementia. Hmm. I have a little code somewhere for iterating through open excel instances and each workbook in them. I suppose if the primary workbook stays the same, then a userform and a small class module would get him what he needed. I will play around if I get some time today"}, {"owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1508337904, "post_id": 46811288, "comment_id": 80572987, "body": "Like @Davesexcel said you will likely have to create a user form and dynamically populate a combo box on the form with the available options. If you haven&#39;t worked with user forms before, check this link: <a href=\"https://powerspreadsheets.com/create-excel-userforms/\" rel=\"nofollow noreferrer\">powerspreadsheets.com/create-excel-userforms</a> . Essentially you will want to use the <code>Private Sub UserForm_Initialize()</code> event to add values to the combo box, then on <code>Private Sub CommandButton1_Click()</code>, grab the value from the combo box and use it in your macro."}, {"owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 0, "creation_date": 1508338949, "post_id": 46811288, "comment_id": 80573721, "body": "<code>Private Sub CommandButton1_Change()</code> I think would be more appropriated."}], "owner": {"reputation": 37, "user_id": 7793096, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/51e5f1c3c8eda8e59ceea7c5a15dfc8c?s=128&d=identicon&r=PG&f=1", "display_name": "NeilD137", "link": "https://stackoverflow.com/users/7793096/neild137"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508333110, "creation_date": 1508333110, "question_id": 46811288, "link": "https://stackoverflow.com/questions/46811288/ammend-code-to-include-drop-down-selection-instead-of-type-in-prompt", "title": "Ammend code to include drop down selection instead of type-in prompt", "body": "<p>I have the following code which prompts the user which open file/window to switch to. I am using this to get around the fact the name of my dependent data file is changing on a daily basis. The following code works. However, instead of asking in the prompt box to type the name of the file to switch to, I would like for it to recognize the open files and give me a drop down or some sort of selection to choose from to just select the file I want to switch to.\nAnybody know how to do that?</p>\n\n<pre><code> Sub switch()\n Dim i As Integer\n Dim n As Integer\n Dim s As String\n Dim t As Variant\n\n n = Windows.Count\n s = \"Pick From:\"\n For i = 1 To n\n s = s &amp; Chr(10) &amp; Windows(i).Caption\n Next\n t = Application.InputBox(prompt:=s, Type:=2)\n If t = False Then\n Exit Sub\n End If\n\nWindows(t).Activate\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "outlook"], "comments": [{"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 0, "creation_date": 1508333058, "post_id": 46810907, "comment_id": 80569551, "body": "What are the results of your <code>Debug.Print</code> statements? Can you run the Procedure and Copy/Paste immediate window text in here? As a side note, you may find it helpful to include a timestamp in your <code>Debug.Print</code> statement (<code>Debug.Print now(),Variable1, Variable2</code>)"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 1, "creation_date": 1508333108, "post_id": 46810907, "comment_id": 80569579, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/14948295/email-data-exported-to-excel-sort-by-received-date\">Email data exported to Excel - Sort by Received Date</a>"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1508333187, "post_id": 46810907, "comment_id": 80569635, "body": "You get one question per post. Create a new question for the skipped save and edit to remove it from this one."}, {"owner": {"reputation": 31, "user_id": 6866553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bd3363a89f676f57a37923ecf8477?s=128&d=identicon&r=PG&f=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6866553/brad"}, "edited": false, "score": 0, "creation_date": 1508334642, "post_id": 46810907, "comment_id": 80570685, "body": "The Debug.Print statements show correct information, the right email address, the correct subject, and the correct number of attachments but it&#39;s as if the code is saying they are failing. I triple checked spelling and format for each of the IF statement requirements."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1508345683, "post_id": 46810907, "comment_id": 80578093, "body": "Why do you expect the Items collection to be sorted in any particular way? It will only be sorted when you explicitly call Items.Sort."}, {"owner": {"reputation": 31, "user_id": 6866553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bd3363a89f676f57a37923ecf8477?s=128&d=identicon&r=PG&f=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6866553/brad"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1508352682, "post_id": 46810907, "comment_id": 80581701, "body": "I am assuming the loop is reading the items in chronological order based on the debug outputs for Received Time. <code>9&#47;26&#47;2017 3:36:31 PM  9&#47;26&#47;2017 3:23:32 PM  9&#47;26&#47;2017 3:14:50 PM  9&#47;26&#47;2017 3:03:37 PM  9&#47;26&#47;2017 2:52:16 PM  9&#47;26&#47;2017 2:52:11 PM  9&#47;26&#47;2017 2:52:08 PM  9&#47;26&#47;2017 1:57:59 PM  9&#47;26&#47;2017 1:24:07 PM  9&#47;26&#47;2017 12:32:18 PM  9&#47;26&#47;2017 11:48:41 AM  9&#47;26&#47;2017 10:29:33 AM </code> @DmitryStreblechenko"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1508355583, "post_id": 46810907, "comment_id": 80583226, "body": "No, once again, do not expect any particular order. You can rely on an order if and only if you previously called Sort on the same instance  of the Items object."}, {"owner": {"reputation": 31, "user_id": 6866553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bd3363a89f676f57a37923ecf8477?s=128&d=identicon&r=PG&f=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6866553/brad"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1508357382, "post_id": 46810907, "comment_id": 80584148, "body": "So is there a way to find the default order of the loop? The debug shows that it appears to be in chronological descending order, just starting at the wrong date @DmitryStreblechenko"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1508358815, "post_id": 46810907, "comment_id": 80584891, "body": "Why are you stuck on the default (whatever that is) order? It is implementation specific and most likely the order in which the items are created, which is not the same as the received date. Just read the MAPIFolder.Items into a separate variable, call Items.Sort, then loop through the items. MOre than that, you should never process all items in a folder - call Items.Restrict or Items.Find/FindNext first wit the appropriate restriction (&quot;[UnRead] = True&quot; in your case)."}, {"owner": {"reputation": 31, "user_id": 6866553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bd3363a89f676f57a37923ecf8477?s=128&d=identicon&r=PG&f=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6866553/brad"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1508360166, "post_id": 46810907, "comment_id": 80585532, "body": "I added the sort to the code and it did not solve the problem. I&#39;m focused on the loop order because obviously something is not behaving as intended. I did add the &quot;[Unread] = True&quot; part and that actually seems to have solved my problem. Thank you for your help @DmitryStreblechenko"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1508362733, "post_id": 46810907, "comment_id": 80586829, "body": "Show your updated code. Make sure you are working with only one instance of the Items object instead of calling MAPIFolder.Items every time (which will return a brand new Items object every time)"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6866553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bd3363a89f676f57a37923ecf8477?s=128&d=identicon&r=PG&f=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6866553/brad"}, "edited": false, "score": 0, "creation_date": 1508357265, "post_id": 46814968, "comment_id": 80584095, "body": "I saw this solution on here and it did not work. It&#39;s as if the loop is ignoring that line as soon as it is executed. The only thing I can think of is that i had my hard drive replaced on that date so something might be triggering it to start there instead of the most recent emails. @niton"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 31, "user_id": 6866553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bd3363a89f676f57a37923ecf8477?s=128&d=identicon&r=PG&f=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6866553/brad"}, "edited": false, "score": 0, "creation_date": 1508361420, "post_id": 46814968, "comment_id": 80586143, "body": "If the collection is sorted the wrong way around then <code>fldItems.Sort &quot;ReceivedTime&quot;, false</code>  <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/items-sort-method-outlook\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/outlook-vba/articles/&hellip;</a>"}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1508344136, "creation_date": 1508344136, "answer_id": 46814968, "question_id": 46810907, "link": "https://stackoverflow.com/questions/46810907/my-vba-loop-is-not-starting-at-the-beginning-of-a-subfolder-in-outlook/46814968#46814968", "title": "My VBA loop is not starting at the beginning of a subfolder in Outlook", "body": "<p>For a For Each loop, you can sort a collection of the items in the folder by ReceivedTime as described here <a href=\"https://stackoverflow.com/questions/14948295/email-data-exported-to-excel-sort-by-received-date\">Email data exported to Excel - Sort by Received Date</a></p>\n\n<p>Note: Untested code to demonstrate how to sort</p>\n\n<pre><code>Option Explicit\n\nSub MovingAttachmentsIntoNetworkFolders()\n\nDim objNS As NameSpace\nDim olFolder As Folder\n\ndim objItem as object\ndim fldItems as items\n\nSet objNS = GetNamespace(\"MAPI\")\nSet olFolder = objNS.GetDefaultFolder(olFolderInbox)\n\n'Specify Folder here\nSet olFolder = olFolder.Folders(\"Email Subfolder\")\n\nOn Error GoTo ErrorHandler\n\n' https://stackoverflow.com/questions/14948295/email-data-exported-to-excel-sort-by-received-date\nset fldItems = olFolder.Items\nfldItems.Sort \"ReceivedTime\", true\n\nFor Each objItem In fldItems\n    Debug.Print objItem.ReceivedTime\n    If objItem.UnRead = True Then\n        If TypeOf objItem Is MailItem Then\n\n            Debug.Print objItem.SenderEmailAddress\n            Debug.Print objItem.Subject\n            Debug.Print objItem.Attachments.Count\n\n            If objItem.Sender = \"emailaddress@email.com\" And _\n              objItem.Subject = \"EmailSubject\" And _\n              objItem.Attachments.Count = 1 Then\n\n                ' mark as read\n                objItem.UnRead = False\n            End If\n        End If\n    End If\n    set objItem = Nothing\nNext\n\nProgramExit:\n    Set objNS = Nothing\n    Set olFolder = Nothing\n    set fldItems = Nothing\n    set objItem = Nothing\n    Exit Sub\n\nErrorHandler:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n    Resume ProgramExit\n\nEnd Sub\n</code></pre>\n\n<p>If code is in Outlook there is no need to reference Outlook.</p>\n\n<p>Avoid using Item and olMail for variable names as they already have a purpose.</p>\n"}], "owner": {"reputation": 31, "user_id": 6866553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bd3363a89f676f57a37923ecf8477?s=128&d=identicon&r=PG&f=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6866553/brad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508344136, "creation_date": 1508331956, "last_edit_date": 1508334380, "question_id": 46810907, "link": "https://stackoverflow.com/questions/46810907/my-vba-loop-is-not-starting-at-the-beginning-of-a-subfolder-in-outlook", "title": "My VBA loop is not starting at the beginning of a subfolder in Outlook", "body": "<p>I have the below code that runs through a folder looking for unread messages from a specific person with a specific subject. The loop is not beginning at the most recent emails. It's beginning a month ago where all the messages are read.</p>\n\n<pre><code>Sub MovingAttachmentsIntoNetworkFolders()\nDim olApp As Outlook.Application\nDim objNS As Outlook.NameSpace\nDim olFolder As Outlook.MAPIFolder\nSet olApp = Outlook.Application\nSet objNS = olApp.GetNamespace(\"MAPI\")\nSet olFolder = objNS.GetDefaultFolder(olFolderInbox).Folders(\"Email Subfolder\") 'Specify Folder here\n\nOn Error GoTo ErrorHandler\n\nFor Each Item In olFolder.Items\n    Debug.Print Item.ReceivedTime\n    If Item.UnRead = True Then\n        If TypeOf Item Is Outlook.MailItem Then\n            Dim oMail As Outlook.MailItem: Set oMail = Item\n\n            Debug.Print Item.SenderEmailAddress\n            Debug.Print Item.Subject\n            Debug.Print Item.Attachments.Count\n\n            If Item.Sender = \"emailaddress@email.com\" And _\n            Item.Subject = \"EmailSubject\" And _\n            Item.Attachments.Count = 1 Then\n            'Set folder to save in.\n                Dim olDestFldr As Outlook.MAPIFolder\n                Dim myAttachments As Outlook.Attachments\n                Dim Att As String\n\n            'location to save in.  Can be root drive or mapped network drive.\n                Const attPath As String = \"mappednetworkdrive\"\n\n            ' save attachment\n                Set myAttachments = Item.Attachments\n                Att = myAttachments.Item(1).FileName\n                Debug.Print Att &amp; \"\\\" &amp; Format(Item.ReceivedTime, \"mm-dd-yyyy\")\n                myAttachments.Item(1).SaveAsFile Format(Item.ReceivedTime, \"mm.dd.yyyy\") &amp; \" \" &amp; Att\n\n            ' mark as read\n                Item.UnRead = False\n            End If\n        End If\n    End If\nNext\n\nProgramExit:\n  Exit Sub\n\nErrorHandler:\n  MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n  Resume ProgramExit\n\nEnd Sub\n</code></pre>\n\n<p>Any reason why my code is behaving this way?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1508332287, "post_id": 46810837, "comment_id": 80569077, "body": "Have you tried implementing that code? How many columns of data do you have?"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1508332338, "post_id": 46810837, "comment_id": 80569103, "body": "To optmize, try to use autofilter with an array multi criteria and delete the rows on a single task. Or if you don&#39;t want to use filter, you can make a non contiguous range and delete all at once later. Because the most time consuming action in your code, is every time you perform actions on your worksheet, in your case when you delete. And refer to <a href=\"http://www.cpearson.com/excel/optimize.htm\" rel=\"nofollow noreferrer\">this</a>, <a href=\"https://stackoverflow.com/q/30959315/7690982\">this</a> and <a href=\"https://stackoverflow.com/questions/46077673/improving-a-loop-to-delete-rows-in-excel-faster\">this</a>."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1508332879, "creation_date": 1508332879, "answer_id": 46811220, "question_id": 46810837, "link": "https://stackoverflow.com/questions/46810837/delete-rows-if-value-is-not-mentioned-in-range/46811220#46811220", "title": "Delete rows if value is not mentioned in range", "body": "<p>Let's say the values are as in the code below - <code>rngCheck</code> and <code>rngDelete</code>.</p>\n\n<p>A nested loop can do exactly this job. The outer loop goes through the range, which should be deleted <code>rngDelete</code> and the inner goes through the checking values <code>rngCheck</code>. </p>\n\n<p>If a matching value is found, it is deleted and the inner loop is exited. As far as we are looping through rows and we need to delete some of them, the for loop is with reversed counting:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim cnt         As Long\n    Dim rngDelete   As Range\n    Dim rngCheck    As Range\n    Dim rngCell     As Range\n\n    Set rngCheck = Worksheets(2).Range(\"A1:A2\")\n    Set rngDelete = Worksheets(1).Range(\"A1:A20\")\n\n    For cnt = rngDelete.Rows.Count To 1 Step -1\n        For Each rngCell In rngCheck\n            If rngCell = rngDelete.Cells(cnt, 1) Then\n                rngDelete.Rows(cnt).Delete\n                Exit For\n            End If\n        Next rngCell\n    Next cnt\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1508333276, "creation_date": 1508333276, "answer_id": 46811344, "question_id": 46810837, "link": "https://stackoverflow.com/questions/46810837/delete-rows-if-value-is-not-mentioned-in-range/46811344#46811344", "title": "Delete rows if value is not mentioned in range", "body": "<p>Here's an array approach which saves on reading from and writing to spreadsheets and so should be a bit quicker. This method includes the cells which do match rather than excluding those which don't. Adjust your range of cells against which you are checking accordingly. I have assumed your data start in A1 of sheet 2016.</p>\n\n<pre><code>Sub DelRows()\n\nDim v, i As Long, j As Long, vOut(), k As Long, rExcl As Range\n\nSet rExcl = Sheets(\"Sheet2\").Range(\"A1:A5\") 'adjust accordingly\n\nWith Worksheets(\"2016\")\n    v = .Range(\"A1\").CurrentRegion.Value\n    .Range(\"A1\").CurrentRegion.Offset(1).ClearContents\n    ReDim vOut(1 To UBound(v, 1), 1 To UBound(v, 2))\n    For i = LBound(v, 1) To UBound(v, 1)\n        If IsNumeric(Application.Match(v(i, 2), rExcl, 0)) Then\n            j = j + 1\n            For k = LBound(v, 2) To UBound(v, 2)\n                vOut(j, k) = v(i, k)\n            Next k\n        End If\n    Next i\n    .Range(\"A2\").Resize(j, UBound(v, 2)) = vOut\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6720336, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/FHmIR.jpg?s=128&g=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/6720336/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 501, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1508333276, "creation_date": 1508331745, "question_id": 46810837, "link": "https://stackoverflow.com/questions/46810837/delete-rows-if-value-is-not-mentioned-in-range", "title": "Delete rows if value is not mentioned in range", "body": "<p>Out of a file with approximately 50.000 rows I want to delete rows which don't have a specific number in column B. I use this code:</p>\n\n<pre><code>Sub DelRows()\n\nApplication.ScreenUpdating = False\n\nWorksheets(\"2016\").Activate\n\nlastrow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\nFor i = lastrow To 2 Step -1\nIf Cells(i, \"B\").Value &lt;&gt; \"1060\" And _\nCells(i, \"B\").Value &lt;&gt; \"1061\" And _\nCells(i, \"B\").Value &lt;&gt; \"1062\" And _\nCells(i, \"B\").Value &lt;&gt; \"1063\" And _\nCells(i, \"B\").Value &lt;&gt; \"1064\" And _\nCells(i, \"B\").Value &lt;&gt; \"1105\" And _\nCells(i, \"B\").Value &lt;&gt; \"11050\" And _\nCells(i, \"B\").Value &lt;&gt; \"11051\" And _\nCells(i, \"B\").Value &lt;&gt; \"11053\" And _\nCells(i, \"B\").Value &lt;&gt; \"11054\" And _\nCells(i, \"B\").Value &lt;&gt; \"1160\" And _\nCells(i, \"B\").Value &lt;&gt; \"1161\" And _\nCells(i, \"B\").Value &lt;&gt; \"1162\" And _\nCells(i, \"B\").Value &lt;&gt; \"1163\" And _\nCells(i, \"B\").Value &lt;&gt; \"1164\" And _\nCells(i, \"B\").Value &lt;&gt; \"1166\" And _\nCells(i, \"B\").Value &lt;&gt; \"1168\" And _\nCells(i, \"B\").Value &lt;&gt; \"1169\" And _\nCells(i, \"B\").Value &lt;&gt; \"8060\" And _\nCells(i, \"B\").Value &lt;&gt; \"8061\" And _\nCells(i, \"B\").Value &lt;&gt; \"8062\" And _\nCells(i, \"B\").Value &lt;&gt; \"8063\" And _\nCells(i, \"B\").Value &lt;&gt; \"8064\" And _\nCells(i, \"B\").Value &lt;&gt; \"8068\" And _\nCells(i, \"B\").Value &lt;&gt; \"8192\" Then\nCells(i, \"B\").EntireRow.Delete\nEnd If\n\nNext i\n\nEnd Sub   \n</code></pre>\n\n<p>This macro takes a lot of time and it seems to be that there is a maximum of 'and-statements'. </p>\n\n<p>I tried to figure it out with an array or a filter, but it's hard for me as a beginner. </p>\n\n<p>I would like to put the numbers on a separate worksheet as a range e.g.:</p>\n\n<pre><code>     A\n1   1060 \n2   1061\n3   1062\n4   1063\n5   1064\n\u2026\n</code></pre>\n\n<p>I've tried to figure it out with section <strong>Criteria range on a different sheet*</strong> on <a href=\"https://www.rondebruin.nl/win/winfiles/MoreDeleteCode.txt\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/winfiles/MoreDeleteCode.txt</a>, but I don't fully understand this VBA code. </p>\n\n<p>Can somebody please help me?\nKind regards, \nRichard</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1508334019, "post_id": 46810663, "comment_id": 80570247, "body": "Do you want the userform to be auto-populated with the current date/time once the userform has been shown via the selection change?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1508334164, "post_id": 46810663, "comment_id": 80570342, "body": "See <a href=\"https://stackoverflow.com/questions/16681900/excel-vba-timevalue-format-hhmm-am-pm\" title=\"excel vba timevalue format hhmm am pm\">stackoverflow.com/questions/16681900/&hellip;</a> as a reference for formatting the time."}, {"owner": {"reputation": 149, "user_id": 5764239, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/KRFvZ.jpg?s=128&g=1", "display_name": "Rey Taino", "link": "https://stackoverflow.com/users/5764239/rey-taino"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1508334493, "post_id": 46810663, "comment_id": 80570591, "body": "Yes, that would be much better. The current date and time will be all the user should need to enter in that cell."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1508334524, "post_id": 46810663, "comment_id": 80570618, "body": "If you don&#39;t want the current time to be used you&#39;ll have to update UserForm3 to allow for a time to be entered somewhere and this will have to be added to the date before passing in the <code>DateClicked</code> argument."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1508334649, "post_id": 46810663, "comment_id": 80570689, "body": "If you only want the current date and time entered in a cell you could use the code <code>Target.Value = Now</code> within a <code>WorkSheet_BeforeDoubleClick</code> event procedure - double click the cell and it will add the current date/time to that cell."}, {"owner": {"reputation": 149, "user_id": 5764239, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/KRFvZ.jpg?s=128&g=1", "display_name": "Rey Taino", "link": "https://stackoverflow.com/users/5764239/rey-taino"}, "edited": false, "score": 0, "creation_date": 1508335304, "post_id": 46810663, "comment_id": 80571203, "body": "I do not have a textbox in the userform. I&#39;m using microsoft datepicker. The user would select a cell in the range and the date picker will popup for them to choose a date. I would like to keep this function - only adding the time once the date is selected."}, {"owner": {"reputation": 149, "user_id": 5764239, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/KRFvZ.jpg?s=128&g=1", "display_name": "Rey Taino", "link": "https://stackoverflow.com/users/5764239/rey-taino"}, "edited": false, "score": 0, "creation_date": 1508335956, "post_id": 46810663, "comment_id": 80571625, "body": "WorkSheet_BeforeDoubleClick event procedure.. worked for my application. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1508334694, "creation_date": 1508334694, "answer_id": 46811821, "question_id": 46810663, "link": "https://stackoverflow.com/questions/46810663/how-to-pop-up-a-calendar-when-clicking-a-specific-cell-in-excel-and-have-the-da/46811821#46811821", "title": "How To Pop Up A Calendar When Clicking A Specific Cell In Excel, and have the date and time insert in that cell?", "body": "<p>Assuming the my question in the comment is correct, you can do either of the following... In the userform (1 of two ways): </p>\n\n<p>1</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Not Intersect(Target, Range(\"M4:M300\")) Is Nothing Then UserForm3.Show\n    UserForm3.TextBox1.Value = Format(Time, \"hh:mm AM/PM\") 'Assumes you have a textbox in the Userform\nEnd Sub\n</code></pre>\n\n<p>2</p>\n\n<pre><code>Private Sub UserForm3_Initialize()\n    TextBox1.Value = Format(Time, \"hh:mm AM/PM\")\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>From selectionchange:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Not Intersect(Target, Range(\"M4:M300\")) Is Nothing Then UserForm3.Show\n    ActiveCell.Formula = Format(Time, \"hh:mm AM/PM\") 'Activecell as the current range\nEnd Sub\n</code></pre>\n\n<p>If you want somethign sequential in the Excel only, you might want an if statement like:</p>\n\n<pre><code>If ActiveCell.Offset(-1,0).Value=\"\" Then Exit Sub\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 5764239, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/KRFvZ.jpg?s=128&g=1", "display_name": "Rey Taino", "link": "https://stackoverflow.com/users/5764239/rey-taino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1794, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508335458, "creation_date": 1508331196, "last_edit_date": 1531161705, "question_id": 46810663, "link": "https://stackoverflow.com/questions/46810663/how-to-pop-up-a-calendar-when-clicking-a-specific-cell-in-excel-and-have-the-da", "title": "How To Pop Up A Calendar When Clicking A Specific Cell In Excel, and have the date and time insert in that cell?", "body": "<p>I have used the following code to select a cell and have the date picker popup. It works fine. however, for my application I need the user to input the date as well as the time(am/pm). How can I add the time alongside the date? When I format the cells to show date and time, the time defaults to 12:00 AM. Please advise. </p>\n\n<p><em>userform</em></p>\n\n<pre><code>    Private Sub MonthView1_DateClick(ByVal DateClicked As Date)\n On Error Resume Next\n   Dim xRg As Object\n   For Each xRg In Selection.Cells\n      xRg.Value = DateClicked\n   Next xRg\n   Unload Me\nEnd Sub\n</code></pre>\n\n<p><em>sheet1</em></p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"M4:M300\")) Is Nothing Then UserForm3.Show\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/fMCHZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fMCHZ.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "formula", "nested-if"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1508330932, "post_id": 46810493, "comment_id": 80568205, "body": "Please make this a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (perhaps with fewer keywords). The fact that you just give a fragment of your statement makes it hard to debug."}, {"owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1508330935, "post_id": 46810493, "comment_id": 80568207, "body": "Are you sure you are using a double quotation mark after <code>_</code> in new line?"}, {"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1508331212, "post_id": 46810493, "comment_id": 80568402, "body": "I think so... let me post something else above, that may be easier if we can find a way to tweak it."}, {"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1508331536, "post_id": 46810493, "comment_id": 80568614, "body": "If you can VBA, why not write a decent function with a more readable <code>Select Case</code> statment ?"}, {"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1508331652, "post_id": 46810493, "comment_id": 80568687, "body": "Hi TSion.D.P. - I have written some, but I would say I am still beginner. Would you have some links or more info on select case? I would definitely give it a try!"}], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1508332587, "post_id": 46810893, "comment_id": 80569261, "body": "Hi Raunak Thomas! This may actually be perfect- my only question being, can the range it is searching be set to the activecell? I tried making it Activecell.Find(arr(i), LookIn:=xlValues) however that did not work.(I ask because I would need to check a lot of cells and I was going to use a do loop with and Activecell.offset for that.)"}, {"owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "reply_to_user": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1508332916, "post_id": 46810893, "comment_id": 80569459, "body": "active does work, I just tried it. change sheets(1).range(&quot;b2&quot;) to sheets(&quot;your_sheet_name&quot;).range(&quot;b2&quot;) and try."}, {"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1508333753, "post_id": 46810893, "comment_id": 80570048, "body": "Raunak Thomas, thank you so so much! With a few tweaks, I got it to work exactly how I wanted! :) (I updated your comment with my specific solution code, but it has to be peer reviewed before it will show up. I will mark it as an answer.)"}, {"owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "reply_to_user": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1508333971, "post_id": 46810893, "comment_id": 80570208, "body": "The edit that you suggested will result in an infinite loop, you will have to keep some criteria for the loop to end"}, {"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1508341292, "post_id": 46810893, "comment_id": 80575403, "body": "I apologize. I had some cells below that were filled in (related to other parts of the sheet) that would stop it upon activecell &lt;&gt; &quot;&quot;. Thank you for catching that. One last question- say I am searching for &quot;Hello&quot; but sometimes the cell says &quot;Helo&quot;- is there any way to output an alias of &quot;Hello&quot; for the &quot;Helo&quot; cell?"}, {"owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "reply_to_user": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1508341654, "post_id": 46810893, "comment_id": 80575681, "body": "Well a simple solution is to just change the if statement, something like   If Not C Is Nothing and Keywords(i) = &quot;helo&quot; then ActiveCell.Offset(0, 1).Value = &quot;Hello&quot; elseif Not C Is Nothing then  ActiveCell.Offset(0, 1).Value = Keywords(i) end if  If there are many aliases then I would maybe simply create 2 arrays"}], "tags": [], "owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "is_accepted": true, "score": 2, "last_activity_date": 1508334235, "last_edit_date": 1508334235, "creation_date": 1508331907, "answer_id": 46810893, "question_id": 46810493, "link": "https://stackoverflow.com/questions/46810493/excel-vba-formulas-nested-if-highlighted-red/46810893#46810893", "title": "(Excel VBA Formulas) Nested IF Highlighted Red", "body": "<p>If you want to use VBA you could use this simple code assuming that u just want the word found</p>\n\n<pre><code>arr = Array(\"keyword1\", \"keyword2\", \"keyword3\") 'List of keywords to look for\nFor i = 0 To 2\n    Set c = Sheets(1).Range(\"a2\").Find(arr(i), LookIn:=xlValues)\n    If Not c Is Nothing Then Sheets(1).Range(\"b2\").Value = arr(i)  'Setting the value if the keyword is found\nNext i\n</code></pre>\n\n<p>But if multiple words are found it will print only the last one (u can modify the code in case u need that). Of course because this is not a calculation you would need to run the code each time the cell value changes</p>\n\n<p>Specific Solution:</p>\n\n<pre><code>Sub Find_Keywords()\n\nKeywords = Array(\"Awesome\", \"hey\", \"world\") 'List of keywords to look for\n\nRange(\"A2\").Activate\n\n    Do Until ActiveCell = Range(\"a14\")\n\n        For i = 0 To 2\n            Set C = ActiveCell.Find(Keywords(i), LookIn:=xlValues)\n            If Not C Is Nothing Then ActiveCell.Offset(0, 1).Value = Keywords(i) 'Setting the value if the keyword is found\n        Next i\n\n    ActiveCell.Offset(1, 0).Activate\n\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 1, "creation_date": 1508333794, "post_id": 46811006, "comment_id": 80570069, "body": "Hi TSion.D.P. Thank you for posting this. I will do some more reading on Select Case and play around with your code. I think it could prove a good solution as well! I appreciate your help :)"}], "tags": [], "owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "is_accepted": false, "score": 1, "last_activity_date": 1508332248, "creation_date": 1508332248, "answer_id": 46811006, "question_id": 46810493, "link": "https://stackoverflow.com/questions/46810493/excel-vba-formulas-nested-if-highlighted-red/46811006#46811006", "title": "(Excel VBA Formulas) Nested IF Highlighted Red", "body": "<pre><code>Function SearchMyKeywords(rng As Range)\n   Select Case rng\n       Case _1st_keyword\n            SearchMyKeywords = Whatever_You_Like\n       Case _2nd_keyword\n            SearchMyKeywords = Whatever_You_Like2\n       ...\n       Case Else ' For all the rest  \n            SearchMyKeywords = Whatever_suitable_here\n   End Select\n</code></pre>\n\n<p>Then you can use your function like built in functions </p>\n"}], "owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 46810893, "answer_count": 2, "score": 0, "last_activity_date": 1508345250, "creation_date": 1508330678, "last_edit_date": 1508345250, "question_id": 46810493, "link": "https://stackoverflow.com/questions/46810493/excel-vba-formulas-nested-if-highlighted-red", "title": "(Excel VBA Formulas) Nested IF Highlighted Red", "body": "<p>I have a formula that works in the cell, but it is a really long nested if. It is essentially trying to check a cell for multiple different values.</p>\n\n<p>A2 = This is my description.\nB2 contains the nested if, which searches the A2 description for multiple words. As it runs through each if statement, it will print the word that is found.</p>\n\n<p>I need to use VBA to set this formula to multiple cells, but I am not sure why the formula is wrong. (Excel highlights it red.) Is there a better way to write this?</p>\n\n<p>(I've been doing two nested if's on a line, and using \" &amp; _\" to separate to the next line down.)</p>\n\n<pre><code>Sub Search_For_Keywords()\nDo Until ActiveCell.Value = \"\"\n\n    Range(B2).Activate\n    With ActiveCell\n    .Formula = \"=IF(ISNUMBER(SEARCH(\"\"Keyword1 \"\",A2,1)),\"\"1\"\",IF(ISNUMBER(SEARCH(\"\"Keyword2 \"\",A2,1)),\"\"2\"\", &amp; _\n</code></pre>\n\n<p>... there are 48 keywords, and more may need to be added in the future ...       </p>\n\n<pre><code>IF(ISNUMBER(SEARCH(\"\"Keyword_n\"\",A2,1)),\"\"n\"\",\"\"No Keywords Found\"\")))))))))))))))))))))))))))))))))))))))))))))))\"\n\n    End With\nLoop\nEnd Sub\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>Another solution (workaround?) is using </p>\n\n<pre><code>=IFERROR(INDEX(E2:E6,MATCH(D2:D6,A2:A6,0)),\"Not Found\")\n\n=INDEX (column to return a value from, MATCH (lookup value/column, column to lookup against, 0))\n</code></pre>\n\n<p>So for mine, I had D2:D6 containing the keywords to search for, E2:E6 containing each keyword's alias, and then A2:A6 held the actual descriptions I wanted to try and see if the keywords were in. </p>\n\n<p>This code is now short enough to be put in VBA, the only downside being you do have to have columns containing this information. </p>\n\n<p>Thanks again for all the help. Other more VBA specific solutions can be found below.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1508331042, "post_id": 46810412, "comment_id": 80568282, "body": "Your existing code is looping through a range of cells - what is that you want to add? Is it a list of sheet names, and if so, does this exist somewhere?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1508336508, "post_id": 46810412, "comment_id": 80571981, "body": "You might want to look at the INDIRECT function"}, {"owner": {"reputation": 1, "user_id": 8795553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6354a9cf503a9fbebe20f8c6638271be?s=128&d=identicon&r=PG&f=1", "display_name": "decadence", "link": "https://stackoverflow.com/users/8795553/decadence"}, "edited": false, "score": 0, "creation_date": 1508398222, "post_id": 46810412, "comment_id": 80596892, "body": "I am trying to get the cell value for the active sheet using another workbook sheet, I have 50+ sheets of data in that workbook and 10+ specific words I need values for in the active sheet but can have up to 7000 rows. I would like to step through and match the specific words in the active sheet against the sheet name from the other workbook. If found then add the cell value from the matched sheet to the active sheet. If not found then go to next word,"}, {"owner": {"reputation": 1, "user_id": 8795553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6354a9cf503a9fbebe20f8c6638271be?s=128&d=identicon&r=PG&f=1", "display_name": "decadence", "link": "https://stackoverflow.com/users/8795553/decadence"}, "edited": false, "score": 0, "creation_date": 1508398498, "post_id": 46810412, "comment_id": 80597048, "body": "Also is it possible to add the values to a column where a specific header name is instead of the range being set to just one column."}], "owner": {"reputation": 1, "user_id": 8795553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6354a9cf503a9fbebe20f8c6638271be?s=128&d=identicon&r=PG&f=1", "display_name": "decadence", "link": "https://stackoverflow.com/users/8795553/decadence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 473, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508330399, "creation_date": 1508330399, "question_id": 46810412, "link": "https://stackoverflow.com/questions/46810412/get-values-from-another-workbook-based-on-cell-values-matching-sheet-names-vba", "title": "Get values from another workbook based on cell values matching sheet names vba", "body": "<p>The code I have works fine but I can't figure out how to get the code to step through an Array of cell values to match an Array of sheet names, then if the value and sheet name matches then get the offset cell value from that sheet.\nIf no value found go to the next value/Sheet. Can someone help with this please?.</p>\n\n<pre><code>Sub Data()\nDim wb1 As Workbook, wb2 As Workbook, sh1 As Worksheet, sh2 As Worksheet, mywb As String, LR As Long, c As Range, x As Range\nApplication.ScreenUpdating = False\nmywb = \"Part Description 2017.xlsx\"\nWorkbooks.Open Filename:=\"C:\\Users\\Me\\Desktop\\Part Description 2017.xlsx\"\nActiveWindow.Visible = False\nSet wb1 = ActiveWorkbook\nSet wb2 = Workbooks(\"Part Description 2017.xlsx\")\nSet sh1 = wb1.ActiveSheet\nSet sh2 = wb2.Sheets(\"Customer Prefix\")\nApplication.ScreenUpdating = False\nLR = sh1.Cells(Rows.Count, 2).End(xlUp).row\nFor Each c In Range(\"B2:B\" &amp; LR)\n    Set x = sh2.Range(\"A:A\").Find(c.Value, , xlValues, xlWhole)\n        If Not x Is Nothing Then\n            c.Offset(0, 1).Value = x.Offset(0, 1).Value\n        End If\nNext\nSet x = Nothing\nWorkbooks(mywb).Close False\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": ["ms-access", "search", "vba"], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 5105773, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10155726797595231/picture?type=large", "display_name": "Will Dutcher", "link": "https://stackoverflow.com/users/5105773/will-dutcher"}, "edited": false, "score": 0, "creation_date": 1508331542, "post_id": 46810398, "comment_id": 80568618, "body": "This is perfect, but have one question!  When I type a space after a search (for example: &quot;Smith &quot;, it immediately blanks out the search and nothing I do, short of closing the search form and bringing it up again, will restore my list of people. Is there a way to make an exception for that so if a usertypes in an errant character, it won&#39;t crash it, or is it possible to throw a message box, blank out the search textbox, and re-set the focus? Or perhaps there&#39;s a better way to handle errors like that?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 309, "user_id": 5105773, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10155726797595231/picture?type=large", "display_name": "Will Dutcher", "link": "https://stackoverflow.com/users/5105773/will-dutcher"}, "edited": false, "score": 0, "creation_date": 1508332198, "post_id": 46810398, "comment_id": 80569022, "body": "Hm, I don&#39;t see why this would happen. To debug this, comment out <code>On Error Resume Next</code>. You could start the _Change sub with <code>Me.txtSearch.Text = Trim(Me.txtSearch.Text)</code>. -- In my sub, I also set <code>.SelLength = 0</code> in addition to setting <code>.SelStart</code>, but I&#39;m not sure if that makes a difference. @WillDutcher"}, {"owner": {"reputation": 309, "user_id": 5105773, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10155726797595231/picture?type=large", "display_name": "Will Dutcher", "link": "https://stackoverflow.com/users/5105773/will-dutcher"}, "edited": false, "score": 0, "creation_date": 1508336307, "post_id": 46810398, "comment_id": 80571852, "body": "I don&#39;t think it likes that at all, for some reason. Here&#39;s all the relevant code I have:  <code>code</code> &#39; This will reset the line every time the user clicks in, giving a blank field to work with, and requerying the search to show all people: Private Sub txtSearch_Click()     Me.txtSearch.Text = &quot;&quot;     Me.Requery     With Me.txtSearch         .SetFocus         .SelStart = Len(Me.txtSearch.Text)     End With End Sub <code>code</code>  &lt;cont.&gt;"}, {"owner": {"reputation": 309, "user_id": 5105773, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10155726797595231/picture?type=large", "display_name": "Will Dutcher", "link": "https://stackoverflow.com/users/5105773/will-dutcher"}, "edited": false, "score": 0, "creation_date": 1508336595, "post_id": 46810398, "comment_id": 80572039, "body": "&lt;cont&gt;  <code>code</code> &#39; This is the code from top. If I search and enter a &lt;space&gt;, if I delete entered text, it will requery correctly, showing all.  <code>code</code> Private Sub txtSearch_Change()     Dim strFilter As String     On Error Resume Next     If Me.txtSearch.Text &lt;&gt; &quot;&quot; Then         strFilter = &quot;[Last_Name] Like &#39;<i>&quot; &amp; Me.txtSearch.Text &amp; &quot;</i>&#39;&quot;         Me.Filter = strFilter         Me.FilterOn = True     Else         Me.Filter = &quot;&quot;         Me.FilterOn = False     End If     With Me.txtSearch         .SetFocus         .SelStart = Len(Me.txtSearch.Text)     End With End Sub <code>code</code>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 309, "user_id": 5105773, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10155726797595231/picture?type=large", "display_name": "Will Dutcher", "link": "https://stackoverflow.com/users/5105773/will-dutcher"}, "edited": false, "score": 0, "creation_date": 1508395307, "post_id": 46810398, "comment_id": 80595371, "body": "@WillDutcher: please ask this in a new question so it will get more attention."}, {"owner": {"reputation": 309, "user_id": 5105773, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10155726797595231/picture?type=large", "display_name": "Will Dutcher", "link": "https://stackoverflow.com/users/5105773/will-dutcher"}, "edited": false, "score": 0, "creation_date": 1508418640, "post_id": 46810398, "comment_id": 80608624, "body": "I&#39;ve re-created it here: <a href=\"https://stackoverflow.com/questions/46828210/multi-field-searching-that-show-results-as-you-type\" title=\"multi field searching that show results as you type\">stackoverflow.com/questions/46828210/&hellip;</a>  And the answer has been solved, for the most part. If you&#39;re interested, can you take a look and tell me what you think, esp re: typing and characters show backward when I took out .Text for .Value, per suggestions from others? Thanks!"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1508330358, "creation_date": 1508330358, "answer_id": 46810398, "question_id": 46810301, "link": "https://stackoverflow.com/questions/46810301/access-multi-field-search-with-results-as-you-type/46810398#46810398", "title": "Access Multi-field Search with Results as you type", "body": "<p>You only need to change the definition of <code>strFilter</code>. For convenience I would use an additional variable.</p>\n\n<pre><code>Dim sSearch As String\nIf Me.txtSearch.Text &lt;&gt; \"\" Then\n    ' Avoid problems with search strings containing \"'\"\n    sSearch = \"'*\" &amp; Replace(Me.txtSearch.Text, \"'\", \"''\") &amp; \"*'\"\n    ' Add all fields you want to search with OR\n    strFilter = \"[Last_Name] Like \" &amp; sSearch  &amp; \" OR [First_Name] Like \" &amp; sSearch ' etc.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 309, "user_id": 5105773, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10155726797595231/picture?type=large", "display_name": "Will Dutcher", "link": "https://stackoverflow.com/users/5105773/will-dutcher"}, "is_accepted": false, "score": 2, "last_activity_date": 1508418680, "creation_date": 1508418680, "answer_id": 46830711, "question_id": 46810301, "link": "https://stackoverflow.com/questions/46810301/access-multi-field-search-with-results-as-you-type/46830711#46830711", "title": "Access Multi-field Search with Results as you type", "body": "<p>First, the textbox click event whereby when you click the box, it clears the text and resets the search (no need for a reset button)</p>\n\n<pre><code>Private Sub txtSearch_Click()\n    Me.txtSearch.SetFocus 'new line of code\n    Me.txtSearch.Text = \"\"\n    Me.Requery\nWith Me.txtSearch\n    .SetFocus\n    .SelStart\nEnd With\nEnd Sub\n</code></pre>\n\n<p>This is the actual search, that will search multiple fields</p>\n\n<pre><code>Private Sub txtSearch_Change()\n    Dim strFilter As String\n    Dim sSearch As String\n    On Error Resume Next\n\nIf Me.txtSearch.Text &lt;&gt; \"\" Then\n    sSearch = \"'*\" &amp; Replace(Me.txtSearch.Text, \"'\", \"''\") &amp; \"*'\"\n    strFilter = \"[Last_Name] Like \" &amp; sSearch &amp; \" OR [First_Name] Like \" &amp; sSearch &amp; \" OR [SSN] Like \" &amp; sSearch\n    Me.Filter = strFilter\n    Me.FilterOn = True\nElse\n    Me.Filter = \"\"\n    Me.FilterOn = False\nEnd If\n\nIf Me.Recordset.RecordCount = 0 Then 'new line of code\n    Me.Filter = \"\" 'new line of code\n    Me.FilterOn = False 'new line of code\n    Me.txtSearch.SetFocus 'new line of code\n    Me.txtSearch.Text = \"\" 'new line of code\nExit Sub 'new line of code\nEnd If 'new line of code\n\nWith Me.txtSearch\n    .SetFocus\n    .SelStart = Len(Me.txtSearch.Text)\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 5105773, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10155726797595231/picture?type=large", "display_name": "Will Dutcher", "link": "https://stackoverflow.com/users/5105773/will-dutcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4479, "favorite_count": 0, "accepted_answer_id": 46810398, "answer_count": 2, "score": 1, "last_activity_date": 1508418680, "creation_date": 1508330007, "last_edit_date": 1508351591, "question_id": 46810301, "link": "https://stackoverflow.com/questions/46810301/access-multi-field-search-with-results-as-you-type", "title": "Access Multi-field Search with Results as you type", "body": "<p>Good morning, all,</p>\n\n<p>My question today is regarding multi-field search.</p>\n\n<p>I have a split form (fields and individual record at the top, all data in datasheet view on the bottom). I have multiple fields I would like to search on, so that a user may find a particular person based on a number of criteria.</p>\n\n<p>Here is the VBA that a colleague helped me with that works PERFECTLY right now, and I'd like to add just a <em>bit</em> more functionality to it by allowing it to search on more than just the one field.</p>\n\n<pre><code>Private Sub txtSearch_Change()\n    Dim strFilter As String\n    On Error Resume Next\n    If Me.txtSearch.Text &lt;&gt; \"\" Then\n        strFilter = \"[Last_Name] Like '*\" &amp; Me.txtSearch.Text &amp; \"*'\"\n        Me.Filter = strFilter\n        Me.FilterOn = True\n    Else\n        Me.Filter = \"\"\n        Me.FilterOn = False\n    End If\n    With Me.txtSearch\n        .SetFocus\n        .SelStart = Len(Me.txtSearch.Text)\n    End With\nEnd Sub\n</code></pre>\n\n<p>Every time I type a letter, the search requeries and supplies only the information that meets that search criteria. What I would like it to do is filter even if it was a First_Name field or the SSN field, etc. Can anyone supply what bit of code I'd need to make it work? I've been searching through multiple forums, videos, posts, etc. and nothing seems to make a bit of difference as I keep throwing errors.</p>\n\n<p>What is the OR statement I need to enable my search to span multiple fields within my form (assuming there is one)?</p>\n\n<p>*Note that I would like to do this without a search button, so I want to keep this as a Change() event, <strong>not</strong> an AfterUpdate().</p>\n\n<p>Thank you!</p>\n\n<p><strong><em>EDIT</em></strong></p>\n\n<p>Code too long for standard reply comment: </p>\n\n<p>This code hangs. I'm probably setting up VBA wrong.</p>\n\n<pre><code>'This code works great, but if I put in a space character, it crashes the DB\nPrivate Sub txtSearch_Change()\n    Me.txtSearch.Text = Trim(Me.txtSearch.Text)\n    Dim strFilter As String\n    Dim sSearch As String\n\n    If Me.txtSearch.Text &lt;&gt; \"\" Then\n        sSearch = \"'*\" &amp; Replace(Me.txtSearch.Text\"'\", \"''\") &amp; \"*'\"\n        strFilter2 = \"[Last_Name] Like \" &amp; sSearch &amp; \" OR [First_Name] Like \" &amp; sSearch &amp; \" OR [SSN] Like \" &amp; sSearch\n        Me.Filter = strFilter\n        Me.FilterOn = True\n    Else\n        Me.Filter = \"\"\n        Me.FilterOn = False\n    End If\n    With Me.txtSearch\n        .SetFocus\n        .SelLength = 0\n        .SelStart = Len(Me.txtSearch.Text)\n    End With\nEnd Sub\n\n\n'This code is what I have that will reset the textbox to blank and requery, giving me all the people in the DB\nPrivate Sub txtSearch_Click()\n    Me.txtSearch.Text = \"\"\n    Me.Requery\n    With Me.txtSearch\n        .SetFocus\n        .SelStart = Len(Me.txtSearch.Text)\n    End With\nEnd Sub\n</code></pre>\n\n<p>Does this throw any red flags as to why I'm getting a crash?</p>\n"}, {"tags": ["vba", "batch-file", "autocad", "autolisp"], "answers": [{"tags": [], "owner": {"reputation": 427, "user_id": 4101032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COY5q.jpg?s=128&g=1", "display_name": "Wes Lord", "link": "https://stackoverflow.com/users/4101032/wes-lord"}, "is_accepted": true, "score": 2, "last_activity_date": 1508379883, "creation_date": 1508379883, "answer_id": 46821978, "question_id": 46810227, "link": "https://stackoverflow.com/questions/46810227/start-autocad-and-run-vba-automatically-with-bat-files/46821978#46821978", "title": "Start Autocad and run VBA automatically with .bat files", "body": "<p>The command line switch to specify a script for AutoCAD to run on opening is /b.</p>\n\n<p>\"C:\\Program Files\\Autodesk\\AutoCAD 20XX\\acad.exe /b firstListOfCommands.scr\u201d</p>\n\n<p>Reference:\n<a href=\"http://help.autodesk.com/view/ACD/2016/ENU/?guid=GUID-8E54B6EC-5B52-4F62-B7FC-0D4E1EDF093A\" rel=\"nofollow noreferrer\">http://help.autodesk.com/view/ACD/2016/ENU/?guid=GUID-8E54B6EC-5B52-4F62-B7FC-0D4E1EDF093A</a></p>\n"}], "owner": {"reputation": 1373, "user_id": 3902958, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4I8vc.png?s=128&g=1", "display_name": "panoskarajohn", "link": "https://stackoverflow.com/users/3902958/panoskarajohn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 936, "favorite_count": 0, "accepted_answer_id": 46821978, "answer_count": 1, "score": 0, "last_activity_date": 1511099004, "creation_date": 1508329760, "last_edit_date": 1511099004, "question_id": 46810227, "link": "https://stackoverflow.com/questions/46810227/start-autocad-and-run-vba-automatically-with-bat-files", "title": "Start Autocad and run VBA automatically with .bat files", "body": "<p>I have the following problem. I have an app that retrieves dwg files from a specific network location. Once retrieved i have written some vba commands that retrieve those files and do some operations on them.</p>\n\n<p>I want to be able to automate this whole procedure with a .bat file.</p>\n\n<p>Start .net -> finish .net -> start Autocad.</p>\n\n<p>And again for the second program.</p>\n\n<p>For one app this works great. I have used this <a href=\"https://knowledge.autodesk.com/search-result/caas/ConnectHelp/autocad/enu/online-help/ACD/2012/ENU/pages/WS73099cc142f4875513fb5cd10c4aa30d6b-7f97-htm.html\" rel=\"nofollow noreferrer\">VBA run on startup</a>.\nBut this limits me to one since the programs will start at different times and start the same instance of vba.\nThese two programs will run on the same computer and will run as services.</p>\n\n<p>The simpler way that i found to start autocad with .net is through a bat file. \nIs there some way to automate some commands with the bat file or whatever.</p>\n\n<p>For example the 2 script might look sth like this inside a bat file.</p>\n\n<p>\"C:\\Program Files\\Autodesk\\AutoCAD 20XX\\acad.exe\" with firstListOfCommands.scr</p>\n\n<p>\"C:\\Program Files\\Autodesk\\AutoCAD 20XX\\acad.exe\" with secondListOfCommands.scr</p>\n\n<p>Do you have any suggestions on how can i achieve this?</p>\n"}, {"tags": ["vba", "image-quality", "ms-access-reports"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1508412782, "post_id": 46809910, "comment_id": 80605075, "body": "JPG (and all bitmaps) sucks for those jobs. The best format I could find (supported by Access) is definitely EMF. It&#39;s vectorial, so its scales perfectly. Great for logos. To create those I used Inkscape, which can read a PDF, select part of it, and save it as EMF."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1508412866, "post_id": 46809910, "comment_id": 80605134, "body": "Does the Print view really matter ? After all, it&#39;s rather a &quot;preview&quot; before printing. So the real question is: how does it look once printed, right ?"}, {"owner": {"reputation": 7631, "user_id": 706293, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/45cce6f7e7eb45177e8018bd7aa9bee7?s=128&d=identicon&r=PG", "display_name": "Francesco", "link": "https://stackoverflow.com/users/706293/francesco"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1508420576, "post_id": 46809910, "comment_id": 80610067, "body": "I tried as a test and the printed version looks good, therefore now I am waiting a feedback from the customer about it. Alternatively I proposed to reduce the image size (actually 1888x830px) to 20%, as that case the Print View is acceptable, but of course the final printed copy will not be in good quality."}], "owner": {"reputation": 7631, "user_id": 706293, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/45cce6f7e7eb45177e8018bd7aa9bee7?s=128&d=identicon&r=PG", "display_name": "Francesco", "link": "https://stackoverflow.com/users/706293/francesco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1094, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1534005741, "creation_date": 1508328782, "last_edit_date": 1508334186, "question_id": 46809910, "link": "https://stackoverflow.com/questions/46809910/ms-access-2013-report-bad-quality-image-on-print-view-but-fine-on-layout-view", "title": "MS Access 2013 Report - Bad quality image on Print view, but fine on Layout view", "body": "<p>In a <strong>MS Access 2013 Report</strong>, I import into an Image Control an image as OLE Object from an Oracle DB (from a BLOB column). The images are stored as .jpg to the DB with high resolution.</p>\n\n<p>In Report View the image is correctly displayed, but in Print View the image is rendered really poorly:</p>\n\n<p><a href=\"https://i.stack.imgur.com/75eMc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/75eMc.png\" alt=\"enter image description here\"></a></p>\n\n<p>I already tried to select the option \"Convert all picture data to bitmaps\" as suggested <a href=\"http://accesscodetips.blogspot.ch/2008/10/settings-ms-access-2007-poor-image.html\" rel=\"nofollow noreferrer\">here</a>, but doing this not only does <em>not</em> solve the problem, but also triggeres the following exception on opening the report:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MsBR6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MsBR6.png\" alt=\"enter image description here\"></a></p>\n\n<p>Why there is such a difference between Layout and Print View and how can I achieve the same quality also on Print View? </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>If I select Size Mode = Clip for the Image Control, the image is displayed in a good quality, but of course only a fragment of it is visible. </p>\n\n<p><a href=\"https://i.stack.imgur.com/61Jy6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/61Jy6.png\" alt=\"enter image description here\"></a></p>\n\n<p>Could it be that the original jpg image is too big in size and Access cannot \"stretch\" it correctly into the image control size (13x5cm)?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "edited": false, "score": 0, "creation_date": 1508327914, "post_id": 46809577, "comment_id": 80566324, "body": "What do you mean by a &quot;related&quot; ID? Do you mean the same or a partial match. How is a Batch Number derived from the ID?"}, {"owner": {"reputation": 487, "user_id": 4133516, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/763fe3e55e30ce0d51aebd43e48ae3de?s=128&d=identicon&r=PG", "display_name": "Wickey312", "link": "https://stackoverflow.com/users/4133516/wickey312"}, "reply_to_user": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "edited": false, "score": 0, "creation_date": 1508328988, "post_id": 46809577, "comment_id": 80567027, "body": "Hi John. Related ID is the linked relationship. So in my screenshot above, a1 links to b1 and b1 links to c1 so they are all batches or maybe an easier term dependencies. The batch number would be a unique identifier for all related dependencies for one batch."}, {"owner": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "edited": false, "score": 0, "creation_date": 1508329635, "post_id": 46809577, "comment_id": 80567454, "body": "Can a later entry link to an earlier one? e.g. could row 5 be X1 &gt; A1"}, {"owner": {"reputation": 487, "user_id": 4133516, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/763fe3e55e30ce0d51aebd43e48ae3de?s=128&d=identicon&r=PG", "display_name": "Wickey312", "link": "https://stackoverflow.com/users/4133516/wickey312"}, "reply_to_user": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "edited": false, "score": 0, "creation_date": 1508329875, "post_id": 46809577, "comment_id": 80567583, "body": "Yep - they link both ways as well.. So it could be A1 &gt; X1 and they should be linked."}, {"owner": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "edited": false, "score": 0, "creation_date": 1508330175, "post_id": 46809577, "comment_id": 80567760, "body": "Hmm. so half-way down the list you might think you have two separate groups then suddenly an entry in one group links to an entry in the other and hey presto you realise they are all members of the same group?"}, {"owner": {"reputation": 487, "user_id": 4133516, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/763fe3e55e30ce0d51aebd43e48ae3de?s=128&d=identicon&r=PG", "display_name": "Wickey312", "link": "https://stackoverflow.com/users/4133516/wickey312"}, "reply_to_user": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "edited": false, "score": 0, "creation_date": 1508330746, "post_id": 46809577, "comment_id": 80568089, "body": "Correct! Absolute nightmare.. I can&#39;t even get a proper do while loop working because it seems to go down into multiple loops.. It&#39;s a one time thing so if there&#39;s a manual codey way to do it I&#39;m all ears."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1508330964, "post_id": 46809577, "comment_id": 80568227, "body": "Could you perhaps cut down the size of the current screenshot and add another one which illustrates your desired results?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1508335379, "post_id": 46809577, "comment_id": 80571255, "body": "Declare them as recordsets and use SQL to join them?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1508336133, "post_id": 46809577, "comment_id": 80571740, "body": "Will the data always be two columns?"}, {"owner": {"reputation": 487, "user_id": 4133516, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/763fe3e55e30ce0d51aebd43e48ae3de?s=128&d=identicon&r=PG", "display_name": "Wickey312", "link": "https://stackoverflow.com/users/4133516/wickey312"}, "edited": false, "score": 0, "creation_date": 1508336174, "post_id": 46809577, "comment_id": 80571757, "body": "Yes data will always be in two columns."}], "answers": [{"comments": [{"owner": {"reputation": 487, "user_id": 4133516, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/763fe3e55e30ce0d51aebd43e48ae3de?s=128&d=identicon&r=PG", "display_name": "Wickey312", "link": "https://stackoverflow.com/users/4133516/wickey312"}, "edited": false, "score": 0, "creation_date": 1508405432, "post_id": 46812655, "comment_id": 80600990, "body": "Hi Tiger. Appreciate the attempt on this. First column doesn&#39;t always contain first link.. Could be other way round."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 1, "last_activity_date": 1508337102, "creation_date": 1508337102, "answer_id": 46812655, "question_id": 46809577, "link": "https://stackoverflow.com/questions/46809577/linking-entries-from-two-columns/46812655#46812655", "title": "Linking Entries from Two Columns", "body": "<p>Assumptions:</p>\n\n<ul>\n<li>First column always contains start link</li>\n<li>Second column always contains chain link</li>\n<li>To continue the link chain, what is listed in second column must later be found in first column to continue the chain (as shown in your example).  This prevents \"link splitting\" where a link can split into different chains.</li>\n</ul>\n\n<p>If these assumptions are true, then this code will work for you:</p>\n\n<pre><code>Sub tgr()\n\n    Const Link1Col As String = \"A\"\n    Const Link2Col As String = \"B\"\n    Const LinkIDCol As String = \"C\"\n\n    Dim ws As Worksheet\n    Dim linkColumns(1 To 2) As Range\n    Dim FoundLink As Range\n    Dim LinkID As Long\n    Dim i As Long\n\n    Set ws = ActiveWorkbook.ActiveSheet\n    Set linkColumns(1) = ws.Range(Link1Col &amp; \"1\", ws.Cells(ws.Rows.Count, Link1Col).End(xlUp))\n    Set linkColumns(2) = Intersect(linkColumns(1).EntireRow, ws.Columns(Link2Col))\n\n    Intersect(linkColumns(1).EntireRow, ws.Columns(LinkIDCol)).ClearContents\n    LinkID = 0\n\n    For i = linkColumns(1).Row To linkColumns(1).Row + linkColumns(1).Rows.Count - 1\n        If Len(ws.Cells(i, LinkIDCol).Value) = 0 Then\n            LinkID = LinkID + 1\n            ws.Cells(i, LinkIDCol).Value = LinkID\n            Set FoundLink = linkColumns(1).Find(ws.Cells(i, Link2Col).Value, , xlValues, xlWhole)\n            If Not FoundLink Is Nothing Then\n                Do\n                    ws.Cells(FoundLink.Row, LinkIDCol).Value = LinkID\n                    Set FoundLink = linkColumns(1).Find(ws.Cells(FoundLink.Row, Link2Col).Value, , xlValues, xlWhole)\n                Loop While Not FoundLink Is Nothing\n            End If\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1508352145, "post_id": 46816139, "comment_id": 80581412, "body": "interesting approach, but suggest to use fully qualified range reference and to change the identification  <code>Me.</code> within your worksheet code to avoid error messages."}, {"owner": {"reputation": 487, "user_id": 4133516, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/763fe3e55e30ce0d51aebd43e48ae3de?s=128&d=identicon&r=PG", "display_name": "Wickey312", "link": "https://stackoverflow.com/users/4133516/wickey312"}, "edited": false, "score": 0, "creation_date": 1508405847, "post_id": 46816139, "comment_id": 80601235, "body": "Hi John! Thanks this is really elegant. It&#39;s blank for about 20 values even though there&#39;s a valid link. What are the parameters where it won&#39;t fill in a number?"}, {"owner": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "reply_to_user": {"reputation": 487, "user_id": 4133516, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/763fe3e55e30ce0d51aebd43e48ae3de?s=128&d=identicon&r=PG", "display_name": "Wickey312", "link": "https://stackoverflow.com/users/4133516/wickey312"}, "edited": false, "score": 0, "creation_date": 1508408249, "post_id": 46816139, "comment_id": 80602547, "body": "@Wickey312 Yes I have found the same problem when I increased my sample size to large number of entries. I have found the problem and working on the solution."}, {"owner": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1508408365, "post_id": 46816139, "comment_id": 80602605, "body": "@T.M. Good points - the coding was rushed I will fix in revised version."}, {"owner": {"reputation": 487, "user_id": 4133516, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/763fe3e55e30ce0d51aebd43e48ae3de?s=128&d=identicon&r=PG", "display_name": "Wickey312", "link": "https://stackoverflow.com/users/4133516/wickey312"}, "edited": false, "score": 0, "creation_date": 1508408394, "post_id": 46816139, "comment_id": 80602617, "body": "@johnrc I appreciate it! Also would be interested to know what the issue is when you&#39;ve worked out the solution."}], "tags": [], "owner": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "is_accepted": true, "score": 2, "last_activity_date": 1508421184, "last_edit_date": 1508421184, "creation_date": 1508348546, "answer_id": 46816139, "question_id": 46809577, "link": "https://stackoverflow.com/questions/46809577/linking-entries-from-two-columns/46816139#46816139", "title": "Linking Entries from Two Columns", "body": "<p>This is a modification on 19Oct of the code that I posted on 18Oct which had a serious bug and some other failings. Hopefully this version is more effective. I have put a note about the bug at the end of this post.</p>\n\n<p>This solution utilises a class, cGroup which represents the identifier for a group, where a group is defined as all the strings in col A and col B that appear on the same rows. So membership of a group means that somewhere in the worksheet there is a row on which there are two members of the same group, and at least one of those members also appears on another row in the list (unless both values appear only once, on the same row, and they have a group of their very own). Each group has an original class ID which it is assigned when it is created, but it might be linked later to another, parent, group (see below), in which case it adopts the class id of its parent group.</p>\n\n<p>The code runs down the list, and assigns the key values in col A and col B to a pre-existing group if either key has previously appeared in the list. If neither has previously appeared, then a new group with a new class ID is created for them. If they have both previously appeared on different rows and been assigned to different groups, then the groups must be linked. This is by choosing one group to be the parent of the other, which can then form a hierarchy of child>parent relationships. The child group adopts the classID of its parent - the ClassID property contains the logic for this. The big advantage of this approach is that it avoids large-scale iteration, although there is still iteration up the child>Parent ClassID hierarchy to discover the ClassID of a child lower in the hiearchy.</p>\n\n<p>I use Scripting.Dictionary to provide a lookup from a key to its class. To use this in your code set up a reference to Microsoft Scripting Runtime library in Tools > References.</p>\n\n<p>I have implemented the code that processes the key data as a separate class cGrouper with a single method, AllocateClassIDs, which is given a 3-column area of a worksheet to process - the three columns being the KeyA, KeyB inputs on each row of the first two columns and the corresponding output class number in the third column. To use this class the code will be something like:</p>\n\n<pre><code>Public Sub run()\n\n    Dim oGrouper As New cGrouper\n\n    '// rTestData1 is a named range in the a worksheet that is 3 columns x n rows, containing n pairs of keys\n    '// in col1 and col2. the allocated class number is written into column 3 of the range\n    oGrouper.AllocateClassIDs [rTestData1]\n\nEnd Sub\n</code></pre>\n\n<p>Here is the code for the cGrouper class:</p>\n\n<pre><code>Option Explicit\n'// This class will identify groups of related key values in two Key columns of a worksheet and then assign group numbers.\n'// A group is defined as the set of Keys that appear on the same rows in the two key columns. So if A and B are on\n'// row 3 and B and C on row 4, then A, B and C are in the same group, along with any other key values that share\n'// the same relationship with each other.\n\n'// Corollary: Keys are in different goups only if each key in the group never appears on the same row as any of the keys in any other group\n\n\n\n'// Dictionaries\n'// Lookup from a key value to the related class. Key value is a string that appears in colA or colB\nDim GroupMembers As New Scripting.Dictionary\n\n'// Lookup to the groups that have already been created. The key is the GroupGroupID (integer assigned on creation)\nDim Groups As New Scripting.Dictionary\n\n\n'// This subroutine does all the work\n    Public Sub AllocateClassIDs(Keys As Range)\n\n        '// First clear out the dictionaries\n        GroupMembers.RemoveAll\n        Groups.RemoveAll\n\n        g.Reset\n\n        '// Check the given ranges\n        If Keys.Columns.Count &lt;&gt; 3 Then\n            MsgBox \"Range must have three columns - cannot process\"\n            Exit Sub\n        End If\n\n        '// Set up references to the sub-ranges within the sheet\n        Dim KeysA As Range, KeysB As Range, ClassIDs As Range\n\n        Set KeysA = Keys.Columns(1)\n        Set KeysB = Keys.Columns(2)\n        Set ClassIDs = Keys.Columns(3)\n\n\n\n        Dim iRow As Integer, sAKey As String, sBKey As String\n        Dim iAGroup As cGroup, iBGroup As cGroup\n\n        '// Run down every row of the given range\n        For iRow = 1 To KeysA.Rows.Count\n\n            '// Get the key values from Col A and Col B\n            sAKey = KeysA.Cells(iRow)\n            sBKey = KeysB.Cells(iRow)\n\n            '// Check if these keys have already been found earlier\n            If GroupMembers.Exists(sAKey) Then Set iAGroup = GroupMembers.Item(sAKey) Else Set iAGroup = Nothing\n            If GroupMembers.Exists(sBKey) Then Set iBGroup = GroupMembers.Item(sBKey) Else Set iBGroup = Nothing\n\n\n            '// Now check the combination of possibilities:\n            Select Case True\n                Case iAGroup Is Nothing And iBGroup Is Nothing\n\n                    '// Neither key was found so we need to create a new group to hold the class number\n                    If Len(sAKey) &gt; 0 Or Len(sBKey) &gt; 0 Then\n                        With New cGroup\n                            '// Add the group to the dictionary of groups\n                             Groups.Add .GroupID, .Self\n\n                            '// Add the keys to the dictionary of group members. This links the key to the group\n                            If Len(sAKey) &gt; 0 Then GroupMembers.Add sAKey, .Self\n                            If sAKey &lt;&gt; sBKey And Len(sBKey) &gt; 0 Then GroupMembers.Add sBKey, .Self\n                        End With\n                    End If\n                Case iBGroup Is Nothing\n                    '// Key in col A is already in a group from an earlier line, but key in Col B is not\n                    '// we just add ColB key to the same group as the col A key\n                    If Len(sBkey)&gt;0 Then\n                        Set iAGroup = GroupMembers.Item(sAKey)\n                        GroupMembers.Add sBKey, iAGroup\n                    End If\n\n                Case iAGroup Is Nothing\n                    '// Key in Col B is already in a group, but Key in col A is not\n                    '// We just add ColA key to the same group as the col B key\n                    IF Len(sAkey)&gt;0 Then\n                        Set iBGroup = GroupMembers.Item(sBKey)\n                        GroupMembers.Add sAKey, iBGroup\n                    End IF\n\n\n                Case Else\n                    '// They are both already in a group. That's fine if they are members of the same class but...\n                    If iAGroup.ClassID &lt;&gt; iBGroup.ClassID Then\n\n                        '// They are in DIFFERENT Classes so we must merge them together by settung\n                        '// the class ID of one group to be the same as the other\n\n                            '// Always use the lower-numbered class ID\n                            If iAGroup.ClassID &lt; iBGroup.ClassID Then\n                                iBGroup.JoinGroupMembership iAGroup\n                            Else\n                                iAGroup.JoinGroupMembership iBGroup\n                            End If\n\n\n                    End If\n                End Select\n\n        Next iRow\n\n\n        '// Remember the last row\n        Dim iLastRow As Integer: iLastRow = iRow - 1\n\n        '// Assign the class numbers. This just makes sure each unique class has a number, starting at 1.\n        Dim ClassNumbers As New Scripting.Dictionary\n        Dim ix As Integer\n\n        Dim iGroup As cGroup\n        Dim iClassNumber As Integer\n\n        For ix = 0 To Groups.Count - 1\n            '// Get the next group object\n            Set iGroup = Groups.Item(Groups.Keys(ix))\n\n            '// Check if this is a \"ROOT\" group, i.e. the group ID is the same as the class ID\n            If iGroup.bIsRootGroup Then\n                iClassNumber = iClassNumber + 1\n                'If iClassNumber = 30 Then MsgBox \"Classnumber 30\"\n\n                '// Add it to the dictionary of class numbers\n                ClassNumbers.Add iGroup.ClassID, iClassNumber\n            End If\n\n        Next ix\n\n        '// Finally, we can assign the class numbers to the rows in the spreadsheet\n        Application.Calculation = xlCalculationManual\n\n        For ix = 1 To iLastRow\n\n            '// Put the relevant class number into column 3\n            ClassIDs.Cells(ix) = ClassNumbers.Item(GroupMembers.Item(KeysA.Cells(ix).Value).ClassID)\n\n        Next ix\n         Application.Calculation = xlCalculationAutomatic\n\n        MsgBox \"done\"\n\n    End Sub\n</code></pre>\n\n<p>Here is the code of the cGroup Class</p>\n\n<pre><code>    Option Explicit\n\n    '// Properties of the class\n    Public GroupID As Integer\n\n    '// The group master of this class (i.e. another group to which it has been joined)\n    '// Can be Nothing if not joined to any other group or if this is the master group \n    '// of a set of joined groups\n    Private memberOfGroup As cGroup\n\n\n    Private Sub class_initialize()\n        '// Assign an ID to myself\n        GroupID = g.NextGroupID\n\n        '// I am not a member of any other group\n        Set memberOfGroup = Nothing\n\n    End Sub\n\n    Public Sub JoinGroupMembership(NewLinkedGroup As cGroup)\n        '// Links this group to membership of another group.\n        '// Note that this group may already be a member of another group, in which case\n        '// group membership is changed on the parent group as well as this group\n\n        '// To avoid circular references, the group with the lower classid is always chosen to be the parent\n\n        If NewLinkedGroup.ClassID &gt; Me.ClassID Then\n            NewLinkedGroup.JoinGroupMembership Me\n            Exit Sub\n        End If\n\n        '// If I am already member of a group, make sure my parent group\n        '// joins the new group\n        If Not memberOfGroup Is Nothing Then\n            memberOfGroup.JoinGroupMembership NewLinkedGroup\n        End If\n\n        '// Now set the new linked group to be my parent\n        Set memberOfGroup = NewLinkedGroup\n\n\n    End Sub\n\n\n    Public Function ClassID() As Integer\n    '// Returns the classID of this group's master group\n    '// Note that this is recursive, it will work up through the hierarchy of\n    '// parent groups until it hits the group with no parent.\n\n\n        '// Check if I am the master group\n        If memberOfGroup Is Nothing Then\n            '// Return my GroupID as the classID\n            ClassID = GroupID\n        Else\n            '// Return the classID of my parent\n            ClassID = memberOfGroup.ClassID\n        End If\n\n    End Function\n\n    Public Function bIsRootGroup() As Boolean\n    '// Returns true if this group is not a member of another group\n        bIsRootGroup = memberOfGroup Is Nothing\n    End Function\n\n    Public Function Self() As cGroup\n        Set Self = Me\n\n    End Function\n</code></pre>\n\n<p>Here is the code of a Module which I have named g</p>\n\n<pre><code>    Option Explicit\n\n    '// Global register of Group ID\n    Private gMaxGroupNumber As Integer\n\n    '// Method to get the next available GroupID\n    Public Function NextGroupID() As Integer\n        gMaxGroupNumber = gMaxGroupNumber + 1\n        NextGroupID = gMaxGroupNumber\n\n    End Function\n\n    '// Method to reset the groupID\n    Public Sub Reset()\n        gMaxGroupNumber = 0\n\n    End Sub\n</code></pre>\n\n<hr>\n\n<p>About the bug: In my earlier version of the code the group hierarchy did not work because it was a simple allocation of a parent classID to a group. This is fine as long as the groups were joined in a controlled sequence, but if two separate groups had already formed, then a later sequence of merging of two groups could isolate previously-linked members - their classIDs did not get updated with the new parent class so they were effectively orphaned.</p>\n"}], "owner": {"reputation": 487, "user_id": 4133516, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/763fe3e55e30ce0d51aebd43e48ae3de?s=128&d=identicon&r=PG", "display_name": "Wickey312", "link": "https://stackoverflow.com/users/4133516/wickey312"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 1, "accepted_answer_id": 46816139, "answer_count": 2, "score": 0, "last_activity_date": 1508421184, "creation_date": 1508327692, "last_edit_date": 1508329040, "question_id": 46809577, "link": "https://stackoverflow.com/questions/46809577/linking-entries-from-two-columns", "title": "Linking Entries from Two Columns", "body": "<p><a href=\"https://i.stack.imgur.com/FZGar.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FZGar.png\" alt=\"enter image description here\"></a>I have IDs in two columns, let's say column A and column B. In these columns are ids and they will appear in either a or b multiple times. What I'd like to do is provide a batch number like the example below, where any related ID is put under one batch. </p>\n\n<p>Are there any good ideas of how to do this in excel/vba? I have 15000 rows. So far I have tried looping through each row and trying to tag 1 with 2, then 2 to 4 etc but the for loops suddenly become almost unlimited. I don't care about providing code, it's more the logic side! </p>\n"}, {"tags": ["vba", "excel", "pivot-table", "calculated-field"], "comments": [{"owner": {"reputation": 767, "user_id": 8411349, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/hdm06.jpg?s=128&g=1", "display_name": "PeterH", "link": "https://stackoverflow.com/users/8411349/peterh"}, "edited": false, "score": 0, "creation_date": 1508329361, "post_id": 46809490, "comment_id": 80567269, "body": "have you tried changing the pivot table layout from compact to outline form ?"}, {"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "reply_to_user": {"reputation": 767, "user_id": 8411349, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/hdm06.jpg?s=128&g=1", "display_name": "PeterH", "link": "https://stackoverflow.com/users/8411349/peterh"}, "edited": false, "score": 0, "creation_date": 1508329419, "post_id": 46809490, "comment_id": 80567312, "body": "no .. I am not really sure how to do that!"}, {"owner": {"reputation": 767, "user_id": 8411349, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/hdm06.jpg?s=128&g=1", "display_name": "PeterH", "link": "https://stackoverflow.com/users/8411349/peterh"}, "edited": false, "score": 0, "creation_date": 1508329609, "post_id": 46809490, "comment_id": 80567437, "body": "Its under the &#39;Design Tab&#39; -&gt; &#39;Report Layout&#39; -&gt; &#39;Show in outline Form&#39; it may help solve your issue"}], "answers": [{"comments": [{"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1508354440, "post_id": 46817632, "comment_id": 80582673, "body": "Thanks for the feedback ! Then , do you have any idea how it is possible to make calculation inside the pivot table between cells of the pivot table ??"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1508354874, "post_id": 46817632, "comment_id": 80582889, "body": "See my revised answer."}, {"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1508356684, "post_id": 46817632, "comment_id": 80583798, "body": "I will provide a screenshot of my pivot table so as to be more clear... what I am actually trying to do is add a new column to my pivot table which will print the result of the difference between column &quot;Monthly Forecasted $/SU&quot; and &quot;Actual $/SU&quot;. So, I want to have a column with three rows with values 0,11-0,28=-0,17 | 0,33-0,35=-0,02 | 0,17-0,18=-0,01 . So, what I actually want is a column to print the difference between the values of cells of the pivot table.. do you think it is possible?? Thanks again for your time!"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1508358644, "post_id": 46817632, "comment_id": 80584798, "body": "What version of Excel do you have?"}, {"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1508358681, "post_id": 46817632, "comment_id": 80584816, "body": "Its excel 2016!"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 1, "creation_date": 1508358899, "post_id": 46817632, "comment_id": 80584930, "body": "Okay. Note the last line in my answer above: Creating Calculated Fields in this manner has pretty much been made redundant, as in Excel 2013 and later you can use the Data Model to do this and a heck of a lot more. Give Google a spin, and also check out ExcelIsFun YouTube channel for a whole heap of examples on how to do this."}, {"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1508359099, "post_id": 46817632, "comment_id": 80585022, "body": "Ok thank you !! The only reason that I tried to find a solution with this type of code is that I actually have created the entire pivot table with Vba, and it is a part of a huge macro actually, so its kind of sad to get stuck in the last line when you simple have to add just a column :( nevertheless, thank you very much for the hints!"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1508359485, "post_id": 46817632, "comment_id": 80585203, "body": "Cool. I&#39;ll try to find time today to amend my answer to show how to do this with the DataModel. But given I&#39;ve already answered your question, can you please accept my answer?"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1508359760, "post_id": 46817632, "comment_id": 80585342, "body": "I answered another question on SO some time back that slaved a Table to a PivotTable, and effectively let you do what you are trying to do. I&#39;ll see if I can find the link and post it here."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1508359906, "post_id": 46817632, "comment_id": 80585411, "body": "WHat SKU of Excel do you have? I.e. professional plus? Office 365? Something else?"}, {"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1508359910, "post_id": 46817632, "comment_id": 80585413, "body": "ok great!! literally, the only thing I want is just a column which will print the results as I told you above! I can even provide to you my entire code... Maybe you could be able to find a solution.. The weird thing is that EVERYTHING runs great.. but I cannot add this column.. I can add it externally with a formula, next to the pivot table but I want to add it  inside!"}, {"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1508359992, "post_id": 46817632, "comment_id": 80585459, "body": "I have the professional / business version (I think)"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 1, "creation_date": 1508360274, "post_id": 46817632, "comment_id": 80585576, "body": "Okay, then you can use PowerPivot to do what you want. Even without that SKU, you could still achieve this using the Data Model and  Measures, which is like Calculated Fields on steroids. (See my answer at <a href=\"https://stackoverflow.com/questions/40614801/excel-data-model-without-using-powerpivot/45044988#45044988\" title=\"excel data model without using powerpivot\">stackoverflow.com/questions/40614801/&hellip;</a> that has links regarding non-PowerPivot use of the Data Model). But you can also do this without the Data Model, using my Slaved Table method I talk about at <a href=\"https://stackoverflow.com/questions/38859656/select-newest-record-and-create-new-table-of-unique-values-in-excel/38867978#38867978\" title=\"select newest record and create new table of unique values in excel\">stackoverflow.com/questions/38859656/&hellip;</a>"}, {"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1508362399, "post_id": 46817632, "comment_id": 80586660, "body": "that is great!! I will try to implement it tomorrow and if something comes up I will ask you :) thank you again!!!!"}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": true, "score": 2, "last_activity_date": 1508362108, "last_edit_date": 1508362108, "creation_date": 1508354240, "answer_id": 46817632, "question_id": 46809490, "link": "https://stackoverflow.com/questions/46809490/add-a-calculated-field-in-a-pivot-table-with-a-reference-to-a-cell-of-the-pivot/46817632#46817632", "title": "Add a calculated field in a Pivot table with a reference to a cell of the Pivot Table", "body": "<p>Your calculated field formula is invalid, which is why you can't add it manually. As per the article at <a href=\"http://www.contextures.com/excel-pivot-table-calculated-field.html\" rel=\"nofollow noreferrer\">http://www.contextures.com/excel-pivot-table-calculated-field.html</a> </p>\n\n<ul>\n<li>Calculated field formulas cannot refer to the pivot table totals or\nsubtotals</li>\n<li>Calculated field formulas cannot refer to worksheet cells by address\nor by name.</li>\n<li>Sum is the only function available for a calculated field.</li>\n<li>Calculated fields are not available in an OLAP-based pivot table.</li>\n</ul>\n\n<p>Here's a screeshot showing how to set up a calculated field:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sNleb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sNleb.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>...and here's the result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WoxV9.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WoxV9.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Note that creating Calculated Fields in this manner has pretty much been made redundant, as in Excel 2013 and later you can use the Data Model to do this and a heck of a lot more (even if your version of Excel isn't one of the 'premium' SKUs that ship with the PowerPivot addin).</p>\n\n<p>Here's an example showing that approach:</p>\n\n<p>First, select your data source, turn it into an Excel Table, and then create a new PivotTable but this time check the box at the bottom of the dialog <strong>\"Add this data to the Data Model\"</strong>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/47LQG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/47LQG.png\" alt=\"enter image description here\"></a></p>\n\n<p>When you click on the PivotTable this produces, you'll see that the PivotTable Fields dialog looks slightly different: It will show the Table name, and then under that table it will list each field:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VxRit.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VxRit.png\" alt=\"enter image description here\"></a></p>\n\n<p>Right-click on the Table name in that dialog, and then click the Add Measure option:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fH5pq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fH5pq.png\" alt=\"enter image description here\"></a></p>\n\n<p>Give the Measure a name, and type the formula you want in the dialog box. (You don't actually have to type that 'Sum of' stuff...just type 'Forecast' and you'll see an autocomplete box come up where you can choose the field you want)</p>\n\n<p><a href=\"https://i.stack.imgur.com/r9Skl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r9Skl.png\" alt=\"enter image description here\"></a></p>\n\n<p>Bam: You've got a new calculated field in the PivotTable:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MwT9y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MwT9y.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5194, "favorite_count": 0, "accepted_answer_id": 46817632, "answer_count": 1, "score": 0, "last_activity_date": 1508362108, "creation_date": 1508327409, "last_edit_date": 1508356742, "question_id": 46809490, "link": "https://stackoverflow.com/questions/46809490/add-a-calculated-field-in-a-pivot-table-with-a-reference-to-a-cell-of-the-pivot", "title": "Add a calculated field in a Pivot table with a reference to a cell of the Pivot Table", "body": "<p>I have been trying to add a calculated field in the pivot table. The entire pivot table is created perfectly so far. The last column that I want to add id the calculated one. Unfortunately, so far I cannot even do it manually. However, if I just insert as a formula right next to the pivot table the below provided formula, then it works perfectly. </p>\n\n<pre><code>=GETPIVOTDATA('Monthly $/SU Forecast',$A$15,'T-Lane','Athens to GREECE')-GETPIVOTDATA('Monthly $/SU Actual',$A$15,'T-Lane','Athens to GREECE')\n</code></pre>\n\n<p>When I type the below inside the macro then it says 'Unable to get the PivotFields property of the PivotTable class' for the line </p>\n\n<pre><code>.PivotFields(\"Diff\").Orientation = xlDataField\n</code></pre>\n\n<p>The entire part of the code is this :</p>\n\n<pre><code>.CalculatedFields.Add \"Diff\", \"=GETPIVOTDATA('Monthly $/SU Forecast',$A$15,'T-Lane','Athens to GREECE')-GETPIVOTDATA('Monthly $/SU Actual',$A$15,'T-Lane','Athens to GREECE')\"\n.PivotFields(\"Diff\").Orientation = xlDataField\n</code></pre>\n\n<p>My Pivot Table </p>\n\n<p><a href=\"https://i.stack.imgur.com/w0B8R.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w0B8R.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1508326906, "post_id": 46809307, "comment_id": 80565664, "body": "You cannot use a colon in a filename."}, {"owner": {"reputation": 1, "user_id": 8733730, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d89f524b2b61bbbd97e151072ba7a2ed?s=128&d=identicon&r=PG&f=1", "display_name": "Roz_sxo", "link": "https://stackoverflow.com/users/8733730/roz-sxo"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1508327598, "post_id": 46809307, "comment_id": 80566119, "body": "I just clicked record and thats the code that came up, i just changed the part towards the end where it says OOR &amp; DATE &amp; TIME  The macro seems to be working but it saves the file name as OOR DATE TIME instead of OOR 10/18/2017 07:53 AM"}, {"owner": {"reputation": 1286, "user_id": 6122062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43dd41fb587ae514e874f9167fd74a4c?s=128&d=identicon&r=PG&f=1", "display_name": "bassfader", "link": "https://stackoverflow.com/users/6122062/bassfader"}, "edited": false, "score": 0, "creation_date": 1508327707, "post_id": 46809307, "comment_id": 80566196, "body": "The colon character (<code>:</code>) is not valid in the name of a file or folder (at least on windows), so you&#39;d need to replace that by something else."}, {"owner": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "edited": false, "score": 0, "creation_date": 1508328255, "post_id": 46809307, "comment_id": 80566546, "body": "If you are putting date and time in a file name then best to use ISO-like format with 24hr clock, for example OOR 2017-10-18 0753 - non-ambiguous, sorts correctly."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8733730, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d89f524b2b61bbbd97e151072ba7a2ed?s=128&d=identicon&r=PG&f=1", "display_name": "Roz_sxo", "link": "https://stackoverflow.com/users/8733730/roz-sxo"}, "edited": false, "score": 0, "creation_date": 1508328266, "post_id": 46809575, "comment_id": 80566548, "body": "I used the Now method, and its still giving me a bug :(   it says it can not find the file name"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1508327688, "creation_date": 1508327688, "answer_id": 46809575, "question_id": 46809307, "link": "https://stackoverflow.com/questions/46809307/save-file-in-excel-using-vba/46809575#46809575", "title": "Save file in excel using VBA", "body": "<p>You need to close the constant String part with <code>\"</code> before adding the variable of <code>Date</code> and <code>Time</code>.</p>\n\n<p>Change the last part of the string from:</p>\n\n<pre><code>\\OOR &amp; DATE &amp; TIME.xlsx\"\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>\\OOR\" &amp; Date &amp; Time &amp; \".xlsx\"\n</code></pre>\n\n<p><strong>Or</strong>, you could use VBA <code>Now</code>, which will give you both <code>Date</code> and <code>Time</code>:</p>\n\n<pre><code>\\OOR\" &amp; Now &amp; \".xlsx\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "is_accepted": false, "score": -2, "last_activity_date": 1508328996, "creation_date": 1508328996, "answer_id": 46809976, "question_id": 46809307, "link": "https://stackoverflow.com/questions/46809307/save-file-in-excel-using-vba/46809976#46809976", "title": "Save file in excel using VBA", "body": "<pre><code>:\n    ActiveWorkbook.SaveAs _\n     Filename:= _\n      \"C:\\Users\\spall1\\Desktop\\Base Business\\Base Business Report\\OOR Report\\OOR \" &amp; Format(Now(), \"YYYY-MM-DD HHMM\") &amp; \".xls\" _\n     , FileFormat:=xlOpenXMLWorkbook _\n     , CreateBackup:=False\n:\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8733730, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d89f524b2b61bbbd97e151072ba7a2ed?s=128&d=identicon&r=PG&f=1", "display_name": "Roz_sxo", "link": "https://stackoverflow.com/users/8733730/roz-sxo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2167, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1508328996, "creation_date": 1508326779, "last_edit_date": 1508326880, "question_id": 46809307, "link": "https://stackoverflow.com/questions/46809307/save-file-in-excel-using-vba", "title": "Save file in excel using VBA", "body": "<p>I recoreded a macro of me saving a file, but I want the name of the file to be </p>\n\n<p>\"OOR\" &amp; \" \" &amp; Date &amp; \" \" &amp; Time </p>\n\n<p>so the output should be OOR 10.18.2017 07:38 AM</p>\n\n<p>Can someone help me with the code? Greatly apreciate it: </p>\n\n<pre><code> ChDir \"C:\\Users\\spall1\\Desktop\\Base Business\\Base Business Report\\OOR Report\"\n     ActiveWorkbook.SaveAs Filename:= _\n     \"C:\\Users\\spall1\\Desktop\\Base Business\\Base Business Report\\OOR Report\\OOR &amp; DATE &amp; TIME.xlsx\" _\n    , FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3725, "user_id": 4388883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3cf69657df9c46dd460e73760894308?s=128&d=identicon&r=PG&f=1", "display_name": "ian0411", "link": "https://stackoverflow.com/users/4388883/ian0411"}, "edited": false, "score": 0, "creation_date": 1508333379, "post_id": 46809179, "comment_id": 80569772, "body": "Very weird...Or can you try with this statement and see if it will work?  <code>Range(&quot;C1&quot;).EntireColumn.Insert</code>"}, {"owner": {"reputation": 11, "user_id": 8795277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a04349cd6939b811a4be37a6106f23d9?s=128&d=identicon&r=PG&f=1", "display_name": "LouH", "link": "https://stackoverflow.com/users/8795277/louh"}, "reply_to_user": {"reputation": 3725, "user_id": 4388883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3cf69657df9c46dd460e73760894308?s=128&d=identicon&r=PG&f=1", "display_name": "ian0411", "link": "https://stackoverflow.com/users/4388883/ian0411"}, "edited": false, "score": 0, "creation_date": 1508334333, "post_id": 46809179, "comment_id": 80570485, "body": "Thanks - tried that and have exactly the same issue. works fine via run macro but fails with the shortcut. It is indeed, very weird."}, {"owner": {"reputation": 3725, "user_id": 4388883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3cf69657df9c46dd460e73760894308?s=128&d=identicon&r=PG&f=1", "display_name": "ian0411", "link": "https://stackoverflow.com/users/4388883/ian0411"}, "edited": false, "score": 0, "creation_date": 1508334721, "post_id": 46809179, "comment_id": 80570747, "body": "Sorry to hear that.  Maybe try to run MS Office diagnostics and see if that will fix it for you automatically.  Other than that, I have no clue how to fix it."}], "owner": {"reputation": 11, "user_id": 8795277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a04349cd6939b811a4be37a6106f23d9?s=128&d=identicon&r=PG&f=1", "display_name": "LouH", "link": "https://stackoverflow.com/users/8795277/louh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1146, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1508326826, "creation_date": 1508326323, "last_edit_date": 1508326826, "question_id": 46809179, "link": "https://stackoverflow.com/questions/46809179/excel-macros-not-working-on-shortcut-key", "title": "Excel Macros not working on shortcut key", "body": "<p>I've been looking everywhere for an answer to this one but can't seem to anything so hopefully someone here can help.</p>\n\n<p>Every Macro I have runs fine via Macros, Run. BUT whenever I use a shortcut key (which never includes Shift, I've checked and know this causes problems) and varies between macros and workbooks (Ctrl+j, Ctrl+h, Ctrl+m)  if the macro includes an insert column code it fails and stalls at this point. Up to then its fine and, like I said, if I run it via Macro run, it works fine including this line. Any ideas? example of my insert column line of code as follows:</p>\n\n<pre><code>Columns(\"B:B\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1508326315, "post_id": 46808949, "comment_id": 80565321, "body": "You can use the answers given to create an <b>UDF</b> (User Defined Function) and have the worksheet as input."}, {"owner": {"reputation": 4465, "user_id": 6584288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bvDzQ.png?s=128&g=1", "display_name": "Indent", "link": "https://stackoverflow.com/users/6584288/indent"}, "edited": false, "score": 0, "creation_date": 1508335829, "post_id": 46808949, "comment_id": 80571540, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6688131/test-or-check-if-sheet-exists\">Test or check if sheet exists</a>"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1508325696, "creation_date": 1508325696, "answer_id": 46809006, "question_id": 46808949, "link": "https://stackoverflow.com/questions/46808949/error-handling-when-sheet-does-not-exist/46809006#46809006", "title": "Error Handling when sheet does not exist", "body": "<p>Try the little piece of code below:</p>\n\n<pre><code>Option Explicit\n\nSub SheetExits()\n\nDim ws As Worksheet\nDim ws_str As String\n\nws_str = \"aaa\" ' for test\n\nOn Error Resume Next\nSet ws = Worksheets(ws_str)\nOn Error GoTo 0\nIf ws Is Nothing Then Exit Sub    \n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 2, "last_activity_date": 1508325899, "creation_date": 1508325899, "answer_id": 46809060, "question_id": 46808949, "link": "https://stackoverflow.com/questions/46808949/error-handling-when-sheet-does-not-exist/46809060#46809060", "title": "Error Handling when sheet does not exist", "body": "<p>This will solve your problem:</p>\n\n<pre><code>Sub ErrorHandling()\nOn Error GoTo ExitSub\nDim ws As Worksheet\n\nSet ws = Worksheets(\"NonExistingSheet\") 'it will throw an error\nMsgBox (\"This won't be displayed\")\n\nExitSub:\nEnd Sub\n</code></pre>\n\n<p>Basically, at the beginning define, where your code should resume in case of an error. To satisfy your requirement, place the resuming point right before <code>End Sub</code>, so it goes directly there in case of an error.</p>\n"}, {"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 2, "last_activity_date": 1508335565, "creation_date": 1508335565, "answer_id": 46812110, "question_id": 46808949, "link": "https://stackoverflow.com/questions/46808949/error-handling-when-sheet-does-not-exist/46812110#46812110", "title": "Error Handling when sheet does not exist", "body": "<pre><code> Function SheetExists(sheetname as string) as boolean\n On error goto whoops\n dim ws as worksheet\n set ws = worksheets(sheetname)\n set ws = nothing\n sheetexists = true\n exit function\n whoops:\n sheetexists = false\n end function \n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 7690917, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/b9e7b42a2a7abd3dd2ea0f8896c56fd2?s=128&d=identicon&r=PG&f=1", "display_name": "bub", "link": "https://stackoverflow.com/users/7690917/bub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2841, "favorite_count": 0, "accepted_answer_id": 46809006, "answer_count": 3, "score": 2, "last_activity_date": 1508335565, "creation_date": 1508325474, "last_edit_date": 1531164843, "question_id": 46808949, "link": "https://stackoverflow.com/questions/46808949/error-handling-when-sheet-does-not-exist", "title": "Error Handling when sheet does not exist", "body": "<pre><code>If Error(Sheets(ws_str)) = True Then Exit Sub\n</code></pre>\n\n<p>Returns run-time error 9.\nI know this sheet does not exist. How do I do errorhandling in cases where the worksheet does not exist?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1508324940, "post_id": 46808552, "comment_id": 80564451, "body": "Instead of creating newtextboxes, you could have one TextBox created and then just change the value of that TextBox when cell A1 is changed."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1508325605, "post_id": 46808552, "comment_id": 80564865, "body": "@danieltakeshi - its a nice idea, but the OP wants to delete it when the value is empty."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 1, "creation_date": 1508326404, "post_id": 46808552, "comment_id": 80565365, "body": "Yeah, I just gave a tip, because i think that changing the TextBox value is simpler and has a better time performance."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1508333877, "post_id": 46808552, "comment_id": 80570120, "body": "@danieltakeshi - it is. :)"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7409049, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/90810c8bdb362e262f09641c119022d3?s=128&d=identicon&r=PG&f=1", "display_name": "user7409049", "link": "https://stackoverflow.com/users/7409049/user7409049"}, "edited": false, "score": 0, "creation_date": 1508326960, "post_id": 46808875, "comment_id": 80565698, "body": "Thank you so much for the help, but when I delete the value in A1, the shape is not deleted. Is that possible? It does delete the old ones but if the cell is empty I still have the textbox"}, {"owner": {"reputation": 33, "user_id": 7409049, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/90810c8bdb362e262f09641c119022d3?s=128&d=identicon&r=PG&f=1", "display_name": "user7409049", "link": "https://stackoverflow.com/users/7409049/user7409049"}, "edited": false, "score": 0, "creation_date": 1508344078, "post_id": 46808875, "comment_id": 80577227, "body": "now I am trying to expand my code to more lines and I am getting a problem with the last macro again.  <code>Sub criarcaixastexto()     Dim wsActive As Worksheet    Dim box As Shape  For i = 1 To 3        Set wsActive = Worksheets(2)        Set box = wsActive.Shapes.AddTextbox(msoTextOrientationHorizontal, 20, 20, 100, 50)     box.TextFrame.Characters.Text = Worksheets(1).Cells(i, 1).Value    Next      End Sub</code>  so i changed this one and it works but now the one that starts the macro just by imputing nrs doesn&#39;t. Can you help me out?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1508328981, "last_edit_date": 1508328981, "creation_date": 1508325190, "answer_id": 46808875, "question_id": 46808552, "link": "https://stackoverflow.com/questions/46808552/refresh-a-textbox-vba/46808875#46808875", "title": "refresh a textbox VBA", "body": "<p>To ignore empty values change the event to this one:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Count &gt; 1 Then Exit Sub 'to avoid multiple selection.\n    If Target.Address = \"$A$1\" Then\n        RemoveShapes\n        If Len(Target) &gt; 1 then Criarcaixastexto\n    End If\nEnd Sub\n</code></pre>\n\n<p>This will remove the shapes, before writing new ones.</p>\n\n<pre><code>Sub RemoveShapes()\n\n    Dim shp As Shape\n    For Each shp In Worksheets(2).Shapes\n        If shp.Type = msoTextBox Then shp.Delete\n    Next shp\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7409049, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/90810c8bdb362e262f09641c119022d3?s=128&d=identicon&r=PG&f=1", "display_name": "user7409049", "link": "https://stackoverflow.com/users/7409049/user7409049"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1195, "favorite_count": 0, "accepted_answer_id": 46808875, "answer_count": 1, "score": 2, "last_activity_date": 1519383762, "creation_date": 1508324107, "last_edit_date": 1519383762, "question_id": 46808552, "link": "https://stackoverflow.com/questions/46808552/refresh-a-textbox-vba", "title": "refresh a textbox VBA", "body": "<p>I want a macro that creates a textbox in Worksheet2 when I write something in Worksheet1!A1. The problem is that I want it to refresh whenever I refresh the data.\nI made one but is runs the macro again, so I am left with several textbox, one on top of the others. Also I want to delete the textbox if the cell is empty.</p>\n\n<p>I would appreciate any help. Thanks. Here is my code:</p>\n\n<pre><code>Sub criarcaixastexto()\n\n    Dim wsActive As Worksheet\n    Dim box As Shape\n\n    Set wsActive = Worksheets(2)\n    Set box = wsActive.Shapes.AddTextbox(msoTextOrientationHorizontal, 20, 20, 100, 50)\n\n    box.TextFrame.Characters.Text = Range(\"Folha1!A1\").value\n\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = \"$A$1\" Then\n        Call criarcaixastexto\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1508326940, "post_id": 46809316, "comment_id": 80565684, "body": "Was just writing up a similar answer. Add the <code>Me.Bookmark = rs.Bookmark</code> to navigate to the record, then your answer is complete."}, {"owner": {"reputation": 2113, "user_id": 969113, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/4f54ad6e06546aedf024dfcda9406724?s=128&d=identicon&r=PG", "display_name": "user969113", "link": "https://stackoverflow.com/users/969113/user969113"}, "edited": false, "score": 0, "creation_date": 1508327368, "post_id": 46809316, "comment_id": 80565963, "body": "Adding your Me.Bookmark and it works like a charme. Thank you guys! Very much appreciated"}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1508327264, "last_edit_date": 1508327264, "creation_date": 1508326817, "answer_id": 46809316, "question_id": 46808489, "link": "https://stackoverflow.com/questions/46808489/access-vba-get-row-number-by-criteria/46809316#46809316", "title": "Access - VBA - Get row number by criteria", "body": "<p>Have you tried the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194787.aspx\" rel=\"nofollow noreferrer\">FindFirst</a> method?</p>\n\n<blockquote>\n  <p>Locates the first record in a dynaset - or - snapshot-type Recordset\n  object that satisfies the specified criteria and makes that record the\n  current record.</p>\n</blockquote>\n\n<pre><code>Dim rs As Recordset\nSet rs = Me.RecordsetClone\n\nrs.FindFirst \"name_ = '\" &amp; Environ(\"Username\") &amp; \"'\"\n\nIf Not rs.NoMatch Then\n    Me.Bookmark = rs.Bookmark\nElse\n    MsgBox \"No match was found.\", vbExclamation\nEmd If\n</code></pre>\n"}], "owner": {"reputation": 2113, "user_id": 969113, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/4f54ad6e06546aedf024dfcda9406724?s=128&d=identicon&r=PG", "display_name": "user969113", "link": "https://stackoverflow.com/users/969113/user969113"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "accepted_answer_id": 46809316, "answer_count": 1, "score": 0, "last_activity_date": 1508327264, "creation_date": 1508323905, "last_edit_date": 1508324813, "question_id": 46808489, "link": "https://stackoverflow.com/questions/46808489/access-vba-get-row-number-by-criteria", "title": "Access - VBA - Get row number by criteria", "body": "<p>Looking at the following code, how can I receive the row number for a user using the variable <code>usern</code>?\nI can check whether a user exists using the <code>DCount</code> function as can be seen. Once received the row number, I would like to use it to navigate to that entry using  <code>DoCmd.GoToRecord</code>. <code>GoToRecord</code> itself works already. I just cannot find a way to receive the row number...</p>\n\n<pre><code>Private Sub Form_Current()\n\nDim usern As String\nDim count As Integer\n\nusern = Environ(\"Username\")\n\ncount = DCount(\"name_\", \"Fragebogen\", \"name_='\" &amp; usern &amp; \"'\")\n\nDoCmd.GoToRecord acDataForm, \"Fragebogen\", acGoTo, 3\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9, "user_id": 8706729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363c62b69c6d9e6cafa8daab0fc3c5b0?s=128&d=identicon&r=PG&f=1", "display_name": "Rana", "link": "https://stackoverflow.com/users/8706729/rana"}, "edited": false, "score": 0, "creation_date": 1508322373, "post_id": 46807994, "comment_id": 80562950, "body": "=IF(A4=&quot;Ended OK&quot;,&quot;Completed&quot;,IF(A4=&quot;Executing&quot;,&quot;In progress&quot;,IF(D4=1,ROUND(((NOW()-1)-(B4+E4))*24,0),ROUND(((NO&zwnj;&#8203;W())-(B4+E4))*24,0))&zwnj;&#8203;))"}, {"owner": {"reputation": 547, "user_id": 8059407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934f6ca1d34101080b991ef766e3a165?s=128&d=identicon&r=PG", "display_name": "itChi", "link": "https://stackoverflow.com/users/8059407/itchi"}, "edited": false, "score": 0, "creation_date": 1508323253, "post_id": 46807994, "comment_id": 80563487, "body": "Which aspect of your code are you having trouble with? Please show your work in progress, and point out any errors you are getting."}, {"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1508323479, "post_id": 46807994, "comment_id": 80563626, "body": "@Rana...record a macro"}], "answers": [{"tags": [], "owner": {"reputation": 547, "user_id": 8059407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934f6ca1d34101080b991ef766e3a165?s=128&d=identicon&r=PG", "display_name": "itChi", "link": "https://stackoverflow.com/users/8059407/itchi"}, "is_accepted": false, "score": 0, "last_activity_date": 1508323814, "creation_date": 1508323814, "answer_id": 46808453, "question_id": 46807994, "link": "https://stackoverflow.com/questions/46807994/vba-to-assign-nested-if-condition-to-some-range-cells/46808453#46808453", "title": "VBA to assign nested if condition to some range cells", "body": "<p>You can use this, you may need to modify wb and ws to your needs.</p>\n\n<pre><code>Sub mysub()\nDim wb As Workbook\nDim ws As Worksheet\nSet wb As ActiveWorkbook\nSet ws As wb.Sheets(\"Sheet1\")\nws.Range(\"G4:G1000\").Formula = \"=IF(A4=\"Ended OK\",\"Completed\",IF(A4=\"Executing\",\"In progress\",IF(D4=1,ROUND(((NOW()-1)-(B4+E4))*24,0),ROUND(((NO\u200c\u200bW())-(B4+E4))*24,0))\u200c\u200b))\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8706729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363c62b69c6d9e6cafa8daab0fc3c5b0?s=128&d=identicon&r=PG&f=1", "display_name": "Rana", "link": "https://stackoverflow.com/users/8706729/rana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1508341328, "creation_date": 1508322348, "last_edit_date": 1508341328, "question_id": 46807994, "link": "https://stackoverflow.com/questions/46807994/vba-to-assign-nested-if-condition-to-some-range-cells", "title": "VBA to assign nested if condition to some range cells", "body": "<p>i need a requirement of VBA code to assign the below formula to range G4:G1000,</p>\n\n<p>by comparing other columns and current date, please help me.</p>\n\n<p><a href=\"https://i.stack.imgur.com/S839m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S839m.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/EWwsq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EWwsq.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "if-statement", "is-empty", "vba"], "comments": [{"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1508322767, "post_id": 46807896, "comment_id": 80563170, "body": "use conditional formatting"}, {"owner": {"reputation": 73, "user_id": 8197979, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/2a6461a7d280eee535b7fd4618e4ee15?s=128&d=identicon&r=PG&f=1", "display_name": "Dany 7elo", "link": "https://stackoverflow.com/users/8197979/dany-7elo"}, "reply_to_user": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1508322811, "post_id": 46807896, "comment_id": 80563200, "body": "@Rosetta no i need to add it in my code"}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1508323006, "post_id": 46807896, "comment_id": 80563327, "body": "<code>if cells(i,6) &lt;&gt; &quot;&quot; then cells(i,3).entirerow.interior.color = vbRed</code>... does this solve your problem?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1508323184, "post_id": 46807896, "comment_id": 80563455, "body": "@Dany7elo see my answer and code below"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 8197979, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/2a6461a7d280eee535b7fd4618e4ee15?s=128&d=identicon&r=PG&f=1", "display_name": "Dany 7elo", "link": "https://stackoverflow.com/users/8197979/dany-7elo"}, "edited": false, "score": 0, "creation_date": 1508323855, "post_id": 46808191, "comment_id": 80563859, "body": "i do not want to make the entire row colored Green or red ...if i want to just fill the column <b>D,E,F</b>  with a gray color  and the rest of the column stay as it is in my code ... i will edit my question"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 73, "user_id": 8197979, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/2a6461a7d280eee535b7fd4618e4ee15?s=128&d=identicon&r=PG&f=1", "display_name": "Dany 7elo", "link": "https://stackoverflow.com/users/8197979/dany-7elo"}, "edited": false, "score": 0, "creation_date": 1508324308, "post_id": 46808191, "comment_id": 80564101, "body": "@Dany7elo see edited code, replace the part i wrote <code>... &#39; selectyourcolor</code> with the color you want to put there"}, {"owner": {"reputation": 73, "user_id": 8197979, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/2a6461a7d280eee535b7fd4618e4ee15?s=128&d=identicon&r=PG&f=1", "display_name": "Dany 7elo", "link": "https://stackoverflow.com/users/8197979/dany-7elo"}, "edited": false, "score": 0, "creation_date": 1508324863, "post_id": 46808191, "comment_id": 80564410, "body": "your code is working but still have one problem that is even if the cell(i,3) is empty the cell will be colored Green.... WHAT I WANT IS if the (i,3) is empty must not be colored"}, {"owner": {"reputation": 73, "user_id": 8197979, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/2a6461a7d280eee535b7fd4618e4ee15?s=128&d=identicon&r=PG&f=1", "display_name": "Dany 7elo", "link": "https://stackoverflow.com/users/8197979/dany-7elo"}, "edited": false, "score": 0, "creation_date": 1508324911, "post_id": 46808191, "comment_id": 80564437, "body": "for this reason i thing the IF statement will be better right ?"}, {"owner": {"reputation": 73, "user_id": 8197979, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/2a6461a7d280eee535b7fd4618e4ee15?s=128&d=identicon&r=PG&f=1", "display_name": "Dany 7elo", "link": "https://stackoverflow.com/users/8197979/dany-7elo"}, "edited": false, "score": 0, "creation_date": 1508324989, "post_id": 46808191, "comment_id": 80564490, "body": "yes  i told you it work perfectly but still have this problem"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1508324265, "last_edit_date": 1508324265, "creation_date": 1508322949, "answer_id": 46808191, "question_id": 46807896, "link": "https://stackoverflow.com/questions/46807896/vba-excel-how-to-check-if-cell-not-empty-and-color-the-entire-row/46808191#46808191", "title": "vba excel how to check if cell not empty and color the entire row?", "body": "<p>You need to check also if <code>Trim(Range(\"F\" &amp; i).Value) &lt;&gt; \"\"</code> in the relevant criterias.</p>\n\n<p>I've also modifed the logic of your current code to be shorter and faster to run through (switched to <code>Select Case</code>, etc.)</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim i As Long\nDim NumofDays As Long\n\nFor i = Range(\"C5000\").End(xlUp).Row To 2 Step -1 'Range upto 5000, chnge this as per your requirment'\n    Cells(i, 3).Interior.Color = xlNone ' set as inital color, only change if all criterias are met\n\n    NumofDays = CDate(Cells(i, 3)) - Date\n\n    Select Case NumofDays\n        Case Is &lt; 0\n            Cells(i, 3).Interior.Color = vbGreen\n\n        Case 0\n            Cells(i, 3).Interior.Color = vbYellow\n\n        Case 1 To 4\n            Cells(i, 3).Interior.Color = vbRed\n\n        Case 5 To 10\n            Cells(i, 3).Interior.Color = vbCyan\n\n    End Select\n\n    ' your 2nd criteria to color the entire row if \"F\" is not empty\n    If Trim(Range(\"F\" &amp; i).Value) &lt;&gt; \"\" Then Range(\"D\" &amp; i &amp; \":F\" &amp; i).Interior.Color = ... ' selectyourcolor \nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 533, "user_id": 3368958, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mfVLE.jpg?s=128&g=1", "display_name": "Nelda.techspiress", "link": "https://stackoverflow.com/users/3368958/nelda-techspiress"}, "edited": false, "score": 0, "creation_date": 1560264526, "post_id": 46808494, "comment_id": 99674397, "body": "I think the question was to do the conditional formatting programmatically."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1508323914, "creation_date": 1508323914, "answer_id": 46808494, "question_id": 46807896, "link": "https://stackoverflow.com/questions/46807896/vba-excel-how-to-check-if-cell-not-empty-and-color-the-entire-row/46808494#46808494", "title": "vba excel how to check if cell not empty and color the entire row?", "body": "<p>Conditional Formatting is easiest, just <a href=\"https://www.ablebits.com/office-addins-blog/2013/10/29/excel-change-row-background-color/#change-row-color\" rel=\"nofollow noreferrer\">a few clicks</a>.</p>\n\n<blockquote>\n  <ol>\n  <li>Start with selecting the cells the background color of which you want to change.</li>\n  <li>Create a new formatting rule by clicking Conditional Formatting > New Rule... on the Home tab.</li>\n  <li>On the Home tab, click Conditional Formatting > New Rule... In the \"New Formatting Rule\" dialog window that opens, choose the option \"Use\n  a formula to determine which cells to format\" and enter the following\n  formula in the \"Format values where this formula is true\" field:\n  =$C2>4</li>\n  <li>Open the 'New Formatting Rule' dialog and enter the needed formula. Instead of C2, you enter a cell that contains the value you want to\n  check in your table and put the number you need instead of 4. And\n  naturally, you can use the less (&lt;) or equality (=) sign so that your\n  formulas will read =$C2&lt;4 and =$C2=4, respectively.</li>\n  <li>Also, pay attention to the dollar sign $ before the cell's address, you need to use it to keep the column letter the same when the formula\n  gets copied across the row. Actually, it is what makes the trick and\n  applies formatting to the whole row based on a value in a given cell.</li>\n  <li>Click the \"Format...\" button and switch to Fill tab to choose the background color. If the default colors do not suffice, click the\n  \"More Colors...\" button to pick the one to your liking, and then click\n  OK twice.</li>\n  </ol>\n</blockquote>\n"}], "owner": {"reputation": 73, "user_id": 8197979, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/2a6461a7d280eee535b7fd4618e4ee15?s=128&d=identicon&r=PG&f=1", "display_name": "Dany 7elo", "link": "https://stackoverflow.com/users/8197979/dany-7elo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4699, "favorite_count": 0, "accepted_answer_id": 46808191, "answer_count": 2, "score": 0, "last_activity_date": 1508324265, "creation_date": 1508322019, "last_edit_date": 1531164843, "question_id": 46807896, "link": "https://stackoverflow.com/questions/46807896/vba-excel-how-to-check-if-cell-not-empty-and-color-the-entire-row", "title": "vba excel how to check if cell not empty and color the entire row?", "body": "<p>i have VBA code that compare dates of the user input with the current dates and fill the background by the appropriate color. all it works fine.</p>\n\n<p>now i need to make the system to check if the  cell in column <strong>F</strong>  of the selected row <strong>is not empty</strong> i need to colored the column <strong>D,E,F</strong> in  gray color.</p>\n\n<h1>code:</h1>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim i As Integer\n\n    For i = Range(\"C5000\").End(xlUp).Row To 2 Step -1 'Range upto 5000, chnge this as per your requirment'\n\n        If IsEmpty(Cells(i, 3)) Then\n            Cells(i, 3).Interior.Color = xlNone\n\n        ElseIf (VBA.CDate(Cells(i, 3)) - VBA.Date()) &lt; 0 Then\n            Cells(i, 3).Interior.Color = vbGreen\n\n        ElseIf (VBA.CDate(Cells(i, 3)) - VBA.Date()) = 0 Then\n            Cells(i, 3).Interior.Color = vbYellow\n\n        ElseIf (VBA.CDate(Cells(i, 3)) - VBA.Date()) &gt;= 1 And (VBA.CDate(Cells(i, 3)) - VBA.Date()) &lt;= 4 Then\n            Cells(i, 3).Interior.Color = vbRed\n\n        ElseIf (VBA.CDate(Cells(i, 3)) - VBA.Date()) &gt;= 5 And (VBA.CDate(Cells(i, 3)) - VBA.Date()) &lt;= 10 Then\n            Cells(i, 3).Interior.Color = vbCyan\n\n        Else\n            Cells(i, 3).Interior.ColorIndex = xlNone\n\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>i will appreciate any help </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 5, "last_activity_date": 1508322586, "creation_date": 1508322586, "answer_id": 46808073, "question_id": 46807805, "link": "https://stackoverflow.com/questions/46807805/unable-to-get-the-sort-property-of-the-range-class/46808073#46808073", "title": "Unable to get the Sort property of the Range class", "body": "<p><code>ws.Columns(\"A:E\").Sort</code> is calling the <code>Sort</code> function of a <code>Range</code> which is different from the <code>Sort</code> class of the worksheet:</p>\n\n<p><a href=\"https://i.stack.imgur.com/T9na5.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/T9na5.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>(hit F2 in the VBA editor to get to that screen)</p>\n\n<p>So your code will likely work if you just remove the <code>.Columns(\"A:E\")</code> of your snippet e.g.:</p>\n\n<pre><code>With ws.Sort\n    .SortFields.Clear\n    .SortFields.Add Key:=ws.Range(\"A2:A\" &amp; oldLastRow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    .SetRange ws.Range(\"A1:E\" &amp; oldLastRow)\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n\n<p>You are already saying what you want to sort with <code>.SetRange ws.Range(\"A1:E\" &amp; oldLastRow)</code> so you can see it is a bit redundant to also have it in the <code>With</code> statement (as well as generating the error).</p>\n\n<p>PS I get</p>\n\n<blockquote>\n  <p>Run-time error '438': Object doesn't support this property or method</p>\n</blockquote>\n"}], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2501, "favorite_count": 0, "accepted_answer_id": 46808073, "answer_count": 1, "score": 2, "last_activity_date": 1508322586, "creation_date": 1508321695, "last_edit_date": 1531164843, "question_id": 46807805, "link": "https://stackoverflow.com/questions/46807805/unable-to-get-the-sort-property-of-the-range-class", "title": "Unable to get the Sort property of the Range class", "body": "<p>I'm getting the above error when performing a sort. I've fully qualified all objects and checked that my variables hold the correct values. The error occurs on the first line:</p>\n\n<pre><code>With ws.Columns(\"A:E\").Sort\n    .SortFields.Clear\n    .SortFields.Add Key:=ws.Range(\"A2:A\" &amp; oldLastRow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    .SetRange ws.Range(\"A1:E\" &amp; oldLastRow)\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n\n<p>It doesn't seem to matter how I refer to the range, each of these gives the same error:</p>\n\n<pre><code>With ws.Range(\"A:E\").Sort\n\n\nWith ws.Range(\"A1:E\" &amp; oldLastRow).Sort\n</code></pre>\n\n<p>There is data in each cell of the range and the columns have headers. What could be causing this problem?</p>\n"}, {"tags": ["excel", "office-2010", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 8794967, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154949620818093/picture?type=large", "display_name": "Mohamed Fathy", "link": "https://stackoverflow.com/users/8794967/mohamed-fathy"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1508340454, "post_id": 46807793, "comment_id": 80574794, "body": "What do you mean ?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8794967, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154949620818093/picture?type=large", "display_name": "Mohamed Fathy", "link": "https://stackoverflow.com/users/8794967/mohamed-fathy"}, "edited": false, "score": 0, "creation_date": 1508340401, "post_id": 46812508, "comment_id": 80574747, "body": "No, this answer for another problem."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 11, "user_id": 8794967, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154949620818093/picture?type=large", "display_name": "Mohamed Fathy", "link": "https://stackoverflow.com/users/8794967/mohamed-fathy"}, "edited": false, "score": 0, "creation_date": 1508405987, "post_id": 46812508, "comment_id": 80601302, "body": "It might not be your answer, but I have seen situations where having the scroll lock on and pressing an arrow key causes the behaviour you have described. (adding for anyone looking for solutions in the future)"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1508336654, "creation_date": 1508336654, "answer_id": 46812508, "question_id": 46807793, "link": "https://stackoverflow.com/questions/46807793/excel-arrow-key-is-creating-a-formula/46812508#46812508", "title": "Excel Arrow Key is Creating a Formula?", "body": "<p>Your scroll lock is on. This is a bug in excel that surfaces sometimes - particularly in 64 bit office</p>\n"}], "owner": {"reputation": 11, "user_id": 8794967, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154949620818093/picture?type=large", "display_name": "Mohamed Fathy", "link": "https://stackoverflow.com/users/8794967/mohamed-fathy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 715, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1508336654, "creation_date": 1508321655, "last_edit_date": 1531161705, "question_id": 46807793, "link": "https://stackoverflow.com/questions/46807793/excel-arrow-key-is-creating-a-formula", "title": "Excel Arrow Key is Creating a Formula?", "body": "<p>I am having a problem with Excel 2010 that I have never seen before. When I hit the arrow key to move to the next cell, instead of moving to the next cell, it tries to add the next cell. </p>\n\n<p>Example: From Cell A1 if I hit the right arrow key, it does not move to Cell A2, but instead comes up with \"+A2\" within Cell A1. Has anyone experienced this before? </p>\n\n<p>I'm thinking it's some weird option that can be turned on or off because it happens, no matter which spreadsheet I am in. Thanks in advance for the help. </p>\n\n<p>P.S. - This is NOT the problem where the spreadsheet scrolls when you use the arrow keys. I've already been there and done that. :)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1508323623, "post_id": 46807461, "comment_id": 80563699, "body": "Is there a formula in a cell with #N/A or just the string?"}, {"owner": {"reputation": 653, "user_id": 8047989, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10209068940431987/picture?type=large", "display_name": "Daniel Sl&#228;tt", "link": "https://stackoverflow.com/users/8047989/daniel-sl%c3%a4tt"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1508324134, "post_id": 46807461, "comment_id": 80564020, "body": "Just strings! =)"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1508325562, "post_id": 46807461, "comment_id": 80564835, "body": "I believe it&#39;s a <code>Transpose</code> issue - see my answer below"}], "answers": [{"comments": [{"owner": {"reputation": 653, "user_id": 8047989, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10209068940431987/picture?type=large", "display_name": "Daniel Sl&#228;tt", "link": "https://stackoverflow.com/users/8047989/daniel-sl%c3%a4tt"}, "edited": false, "score": 0, "creation_date": 1508323031, "post_id": 46808003, "comment_id": 80563345, "body": "That was my first idea as well =) Unfortunately, my Excel crashes when trying to use this tool to scrape .HTM-pages."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 653, "user_id": 8047989, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10209068940431987/picture?type=large", "display_name": "Daniel Sl&#228;tt", "link": "https://stackoverflow.com/users/8047989/daniel-sl%c3%a4tt"}, "edited": false, "score": 0, "creation_date": 1508324407, "post_id": 46808003, "comment_id": 80564155, "body": "I see that NHL page is all nasty and locked-down so you can&#39;t even right-click to &quot;View Page Source&quot; (although CTRL+U will overcome that in Firefox).  The quickest way to get the data into Excel is simply File \u2192 Open \u2192 Browse \u2192 and paste in your URL <code>http:&#47;&#47;www.nhl.com&#47;scores&#47;htmlreports&#47;20172018&#47;PL020003.HTM</code> and you&#39;ll get a nicely formatted copy of the page."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1508326496, "last_edit_date": 1508326496, "creation_date": 1508322381, "answer_id": 46808003, "question_id": 46807461, "link": "https://stackoverflow.com/questions/46807461/n-a-value-when-scraping-html-with-excel-vba/46808003#46808003", "title": "#N/A value when scraping HTML with Excel VBA", "body": "<p>It might be easier to use Excel's built-in web query tools.  (If you haven't used the feature before it might seem more complicated than it is.)  Click the DATA menu, then \"From Web\", enter the site, and Excel will download all the organized data it can find there.  The attached image shows the steps and results, and here is a link to <a href=\"https://support.office.com/en-us/article/Get-external-data-from-a-Web-page-708f2249-9569-4ff9-a8a4-7ee5f1b1cfba#bmcreate_a_web_query\" rel=\"nofollow noreferrer\">more about Excel web queries</a>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/RcvNz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RcvNz.jpg\" alt=\"Example Image\"></a></p>\n\n<p>To automate, you could record a macro of the steps to import a file, and then edit the macro as VBA to enter your custom dates, etc.</p>\n\n<p>If you're somewhat comfortable with MS Access, it is better suited to scraping; I have a file I could pass on which I've used for scraping everything from Google to eBay (before I learned about API's!) </p>\n\n<hr>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Oh!  One of your problems: Your code doesn't <code>set ie = nothing</code> when it's done, so <em>each time you run the code</em>, Excel opens <em>another copy of Internet Explorer</em> (hidden in the background).  CTRL-ALT-DEL to see the Task Manager and I bet you have multiple copies of <strong>iexplore.exe</strong> running, sucking up all your memory, andcausing the crashes.  Reboot to fix that and try again, or try another method (after rebooting).  </p>\n\n<p>This is another way to do it, more memory-friendly:</p>\n\n<pre><code>Sub nhl_test()\n\n    Dim ie As Object, doc As HTMLDocument\n    Dim Y1 As String, Y2 As String, GameID As String, html As String\n    Dim SourceCode As Worksheet, c As Range, y As Long, x As Long\n\n    Set ie = New InternetExplorer\n    Set SourceCode = Worksheets(\"Source Code\")\n    Y1 = \"2017\"\n    Y2 = \"2018\"\n    GameID = \"0003\"\n\n    ie.navigate \"http://www.nhl.com/scores/htmlreports/\" &amp; Y1 &amp; Y2 &amp; \"/PL02\" &amp; GameID &amp; \".HTM\"\n\n    Do\n        DoEvents\n    Loop Until ie.readyState = READYSTATE_COMPLETE\n\n    Set doc = ie.document\n    html = doc.DocumentElement.innerHTML 'put HTML into a variable\n    Set doc = Nothing 'free up memory\n    Set ie = Nothing 'free up memory, close IE\n\n    arr = Split(html, vbLf) 'now split the html into lines\n\n    For x = 1 To UBound(arr) ' x counts the line # in the file\n        If Trim(arr(x)) &lt;&gt; \"\" Then\n            y = y + 1 ' y counts the line # that isn't blank\n            SourceCode.Cells(y, 1).Value = arr(x) 'put line x into row y\n        End If\n    Next x\n    MsgBox \"done (\" &amp; y &amp; \"rows)\"\nEnd Sub\n</code></pre>\n\n<p>...but it's still not a very organized set of data.  What's your plan once you have the html loaded into a worksheet?</p>\n"}, {"comments": [{"owner": {"reputation": 653, "user_id": 8047989, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10209068940431987/picture?type=large", "display_name": "Daniel Sl&#228;tt", "link": "https://stackoverflow.com/users/8047989/daniel-sl%c3%a4tt"}, "edited": false, "score": 0, "creation_date": 1508330352, "post_id": 46808963, "comment_id": 80567856, "body": "Many many thanks for the input and effort! This looks a lot more solid, and has solved most of the cases where I got the error! However - there&#39;s a few occasions that still give the same error, but this time it&#39;s much further down the file - row 53 614 for example. Any idea on why this could be?  EDIT: Actually, it&#39;s always on row 53 614.."}, {"owner": {"reputation": 653, "user_id": 8047989, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10209068940431987/picture?type=large", "display_name": "Daniel Sl&#228;tt", "link": "https://stackoverflow.com/users/8047989/daniel-sl%c3%a4tt"}, "edited": false, "score": 0, "creation_date": 1508330541, "post_id": 46808963, "comment_id": 80567962, "body": "It should be said that I&#39;m using this code in a for loop where GameID increments from 0001 to 1230, so and I&#39;m using the code twice (using arr3 as variant, arr4 as array for the second twice) in every instance of the loop... Could it be that I have to empty the arrays after every instance of the loops?"}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 2, "last_activity_date": 1508326372, "last_edit_date": 1508326372, "creation_date": 1508325519, "answer_id": 46808963, "question_id": 46807461, "link": "https://stackoverflow.com/questions/46807461/n-a-value-when-scraping-html-with-excel-vba/46808963#46808963", "title": "#N/A value when scraping HTML with Excel VBA", "body": "<p>There's an undocumented limit on the <code>Transpose</code> function at 65,536 items. There's some discussion <a href=\"https://social.msdn.microsoft.com/Forums/en-US/c45d37f1-a5f1-4cf4-938d-69d294d8e447/limitations-on-arrays?forum=isvvba\" rel=\"nofollow noreferrer\">here</a> on MSDN and you can google 'transpose vba limit' and see some other threads.</p>\n\n<p>So your files are coming in at <strong>around</strong> 60,000 rows and some may go over the 65,536 limit and it looks like you hit that limit with that GameID.</p>\n\n<p>One workaround, is to create a second array e.g. </p>\n\n<pre><code>Dim arr2() As String &lt;-- we will make this a 2d array and fill it from arr\n\n'... later in the code\n\narr = Split(doc.DocumentElement.innerHTML, vbLf) '&lt;-- get the array with your original code\nReDim Preserve arr2(1 To UBound(arr), 1 To 1) '&lt;-- redim arr2 to be suitable for writing to a range\n\n' now fill the array from arr - basically doing a \"manual\" transpose\nDim i As Long\nFor i = 1 To UBound(arr)\n    arr2(i, 1) = arr(i)\nNext i\n</code></pre>\n\n<p>Full working code:</p>\n\n<pre><code>Option Explicit\n\nSub Foo()\n\n    Dim ie As Object, doc As HTMLDocument\n    Dim Y1 As String, Y2 As String, GameID As String\n    Dim SourceCode As Worksheet, c As Range\n    Dim arr As Variant, arr2() As String\n\n    Set ie = New InternetExplorer\n    Set SourceCode = Worksheets(\"Source Code\")\n    Y1 = \"2017\"\n    Y2 = \"2018\"\n    GameID = \"0003\"\n\n    ie.navigate \"http://www.nhl.com/scores/htmlreports/\" &amp; Y1 &amp; Y2 &amp; \"/PL02\" &amp; GameID &amp; \".HTM\"\n\n    Do\n        DoEvents\n    Loop Until ie.readyState = READYSTATE_COMPLETE\n\n    Set doc = ie.document\n\n    arr = Split(doc.DocumentElement.innerHTML, vbLf)\n    ReDim Preserve arr2(1 To UBound(arr), 1 To 1)\n    Dim i As Long\n    For i = 1 To UBound(arr)\n        arr2(i, 1) = arr(i)\n    Next i\n\n    SourceCode.Range(\"A1\").Resize(UBound(arr), 1).Value = arr2\n\n    ' see comment by ashleedawg on the other answer\n    Set ie = nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 653, "user_id": 8047989, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10209068940431987/picture?type=large", "display_name": "Daniel Sl&#228;tt", "link": "https://stackoverflow.com/users/8047989/daniel-sl%c3%a4tt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1508326496, "creation_date": 1508320557, "last_edit_date": 1531164843, "question_id": 46807461, "link": "https://stackoverflow.com/questions/46807461/n-a-value-when-scraping-html-with-excel-vba", "title": "#N/A value when scraping HTML with Excel VBA", "body": "<p>I'm having an issue with extracting HTML-code from .HTM game reports. As you can see I'm splitting the HTML file using <code>Split()</code> and it usually creates around 60,000 rows for this particular play-by-play report. </p>\n\n<p>Now, for 99 games out of 100 this works perfectly fine, but every now and then (such as with this exact GameID) it for whatever reason starts putting out <code>#N/A</code> after just a few thousand rows - very early into the document. </p>\n\n<p>I've checked the .HTM in question and it looks just like any other document that I've extracted.</p>\n\n<p>Here's the code snippet:</p>\n\n<pre><code>Dim ie As Object, doc As HTMLDocument\nDim Y1 As String, Y2 As String, GameID As String\nDim SourceCode As Worksheet, c As Range\n\nSet ie = New InternetExplorer\nSet SourceCode = Worksheets(\"Source Code\")    \nY1 = \"2017\"\nY2 = \"2018\"\nGameID = \"0003\"\n\nie.navigate \"http://www.nhl.com/scores/htmlreports/\" &amp; Y1 &amp; Y2 &amp; \"/PL02\" &amp; GameID &amp; \".HTM\"\n\nDo\n    DoEvents\nLoop Until ie.readyState = READYSTATE_COMPLETE\n\nSet doc = ie.document\n\narr = Split(doc.DocumentElement.innerHTML, vbLf)\n\nSourceCode.Range(\"A1\").Resize(UBound(arr) + 1, 1).Value = Application.Transpose(arr)\n</code></pre>\n\n<p>And this is what happens (occasionally):</p>\n\n<p><a href=\"https://i.stack.imgur.com/ADckv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ADckv.png\" alt=\"NHL Game Play By Play HTML Extract\"></a></p>\n\n<p>Does anyone have a suggestion for how to error handle this? I haven't got the slightest clue what could be causing it.</p>\n"}, {"tags": ["vba", "ms-access", "lookup", "username"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5211201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fbaae6c2f81617292598d64bd3815ae?s=128&d=identicon&r=PG&f=1", "display_name": "VeeEss", "link": "https://stackoverflow.com/users/5211201/veeess"}, "edited": false, "score": 0, "creation_date": 1508322190, "post_id": 46807277, "comment_id": 80562847, "body": "Thank you so much I am going to try these out now. I have a follow up question though... Which do you think is the best way to go? Directly in the Record Source or VBA? (I don&#39;t have prior ms access knowledge so sorry for the question...)"}, {"owner": {"reputation": 31, "user_id": 5211201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fbaae6c2f81617292598d64bd3815ae?s=128&d=identicon&r=PG&f=1", "display_name": "VeeEss", "link": "https://stackoverflow.com/users/5211201/veeess"}, "edited": false, "score": 0, "creation_date": 1508323536, "post_id": 46807277, "comment_id": 80563651, "body": "Hello I tried adding it to the record source but i am getting an error: &quot;The record source &#39;=DlookUp ...&quot;)&#39; specified on this form or report does not exist. What I did was copy the code you gave me and pasted it directly to the record source property. am i doing something wrong?"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 31, "user_id": 5211201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fbaae6c2f81617292598d64bd3815ae?s=128&d=identicon&r=PG&f=1", "display_name": "VeeEss", "link": "https://stackoverflow.com/users/5211201/veeess"}, "edited": false, "score": 0, "creation_date": 1508323653, "post_id": 46807277, "comment_id": 80563726, "body": "What does the error say? Try one of the VBA options to see if you get the error."}, {"owner": {"reputation": 31, "user_id": 5211201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fbaae6c2f81617292598d64bd3815ae?s=128&d=identicon&r=PG&f=1", "display_name": "VeeEss", "link": "https://stackoverflow.com/users/5211201/veeess"}, "edited": false, "score": 0, "creation_date": 1508323743, "post_id": 46807277, "comment_id": 80563791, "body": "It says: &quot;The record source &#39;=DlookUp ...&quot;)&#39; specified on this form or report does not exist. What I did was copy the code you gave me and pasted it directly to the record source property. am i doing something wrong?"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 31, "user_id": 5211201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fbaae6c2f81617292598d64bd3815ae?s=128&d=identicon&r=PG&f=1", "display_name": "VeeEss", "link": "https://stackoverflow.com/users/5211201/veeess"}, "edited": false, "score": 0, "creation_date": 1508324065, "post_id": 46807277, "comment_id": 80563985, "body": "Hmm... I believe the <code>Environ(&quot;username&quot;)</code> function is causing the issue. Try one of the VBA options/"}, {"owner": {"reputation": 31, "user_id": 5211201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fbaae6c2f81617292598d64bd3815ae?s=128&d=identicon&r=PG&f=1", "display_name": "VeeEss", "link": "https://stackoverflow.com/users/5211201/veeess"}, "edited": false, "score": 0, "creation_date": 1508324415, "post_id": 46807277, "comment_id": 80564160, "body": "Hello @Kostas K. I am so happy the VBA method worked!!! I don&#39;t know how to thank you enough for this!!! I have no knowledge in MS Access yet I was tasked to do it here at work and I thought I was on a dead end. This means so much to me and the people who will eventually use the dbase. With all my heart, THANK YOU!"}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1508324573, "last_edit_date": 1508324573, "creation_date": 1508320042, "answer_id": 46807277, "question_id": 46806783, "link": "https://stackoverflow.com/questions/46806783/ms-access-how-to-lookup-environ-username-in-a-table-in-ms-access-so-that-the-fu/46807277#46807277", "title": "MS ACCESS: How to lookup environ username in a table in MS Access so that the full name is returned in a textbox?", "body": "<p>As a VBA Function:</p>\n\n<pre><code>Public Function GetFullName() As String\n    GetFullName = DLookUp(\"Participant\", \"VCUsers\", \"[User ID]='\" &amp; Environ$(\"username\") &amp; \"'\")\nEnd Function\n\n'=GetFullName()\n</code></pre>\n\n<p>When the form loads:</p>\n\n<pre><code>Private Sub Form_Load()\n    Me.YourTextBoxName.Value = DLookUp(\"Participant\", \"VCUsers\", \"[User ID]='\" &amp; Environ$(\"username\") &amp; \"'\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5211201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fbaae6c2f81617292598d64bd3815ae?s=128&d=identicon&r=PG&f=1", "display_name": "VeeEss", "link": "https://stackoverflow.com/users/5211201/veeess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 557, "favorite_count": 1, "accepted_answer_id": 46807277, "answer_count": 1, "score": 0, "last_activity_date": 1508324573, "creation_date": 1508318496, "last_edit_date": 1508323707, "question_id": 46806783, "link": "https://stackoverflow.com/questions/46806783/ms-access-how-to-lookup-environ-username-in-a-table-in-ms-access-so-that-the-fu", "title": "MS ACCESS: How to lookup environ username in a table in MS Access so that the full name is returned in a textbox?", "body": "<p>Application: MS ACCESS</p>\n\n<p>1: I used this code found in Stackoverflow (thank you!) to get the username of the current user of the dbase. the problem is I need to lookup the username in the table named \"VCUsers\" to get the \n\"Participant\".</p>\n\n<p>2: This is the \"VCUsers\" table. The username and its corresponding \"Participant\" is listed here. How do I lookup the username I got via VBA from this table so that the \"Participant\" shows up in the \"User\" text box in the home page?</p>\n\n<p>3: This is the Home Page and the User text box at the upper left.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LMzUT.png\" rel=\"nofollow noreferrer\">See screenshots here.</a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1508319898, "post_id": 46807175, "comment_id": 80561476, "body": "I read it however it does not state about the limits of the loop which my code supposedly broke due to complexity"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1508320432, "post_id": 46807175, "comment_id": 80561806, "body": "@MarcSantos - are you serious?"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1508319684, "creation_date": 1508319684, "answer_id": 46807175, "question_id": 46806759, "link": "https://stackoverflow.com/questions/46806759/invalid-procedure-call-or-argument-error-in-do-while-loop-in-excel-vba/46807175#46807175", "title": "&quot;Invalid procedure call or argument&quot; error in Do-While-Loop in Excel VBA?", "body": "<p>Your <code>Do...Loop</code> is too complicated.  More info <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/doloop-statement\" rel=\"nofollow noreferrer\">here</a> or <a href=\"http://www.excel-easy.com/vba/examples/do-until-loop.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1508321522, "post_id": 46807580, "comment_id": 80562454, "body": "Thanks for this I actually do not know the language well since it&#39;s only been about a month since I started and there&#39;s a lot of syntax that I do not know of i&#39;ll try to break down my code. Organizing the code has been a pain given the time constraint I have"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1508320915, "creation_date": 1508320915, "answer_id": 46807580, "question_id": 46806759, "link": "https://stackoverflow.com/questions/46806759/invalid-procedure-call-or-argument-error-in-do-while-loop-in-excel-vba/46807580#46807580", "title": "&quot;Invalid procedure call or argument&quot; error in Do-While-Loop in Excel VBA?", "body": "<p>Writing extreme big conditions in the loop are not considered clean code. As mentioned, split the condition to separate boolean functions and evaluate them separately. Like this:</p>\n\n<pre><code>Public Sub TestMe()\n\n    While isIt1 Or isItRegular\n        'do something\n    Wend\n\nEnd Sub\n\nPublic Function isIt1() As Boolean\n\n    isIt1 = Application.WorksheetFunction.Weekday(Worksheets(\"DTR\").Cells(i, 3) - x) = 1\n\nEnd Function\n\nPublic Function isItRegular() As Boolean\n\n    With Application.WorksheetFunction\n        isItRegular = .index(Worksheets(\"Holidays Table\").Range(\"B2:B1048576\"), .match(Worksheets(\"DTR\").Cells(i, 3), Worksheets(\"Holidays Table\").Range(\"A2:A1048576\"), 0)) = \"Regular\"\n    End With\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1508321572, "post_id": 46807732, "comment_id": 80562484, "body": "Yes that is true. I actually corrected it just a moment ago. I made them dynamic relative to x. Edited the main post sorry for that"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1508321768, "post_id": 46807732, "comment_id": 80562606, "body": "And while I was watching through the whole condition of the loop I was wondering whether there would be someone else to do the same. You have even gone 2 steps further, by analyzing it."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1508326949, "post_id": 46807732, "comment_id": 80565693, "body": "@MarcSantos I improved the answer due to your edit of the conditions. Note that if we split up the conditions that way you can see in which condition an error occurs. This way it is much easier to debug."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1508492153, "post_id": 46807732, "comment_id": 80640077, "body": "@Peh Thank you for your help. I will get back to this after I fix the logic of the code. I realized I need 2 <code>Do-While-Loop</code> for my objective and i&#39;m still trying to figure out how to do it."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 1, "creation_date": 1508738728, "post_id": 46807732, "comment_id": 80712893, "body": "The main reason I figured out why the loop is failing is because of the <code>Application.WorksheetFunction.Match</code> portion. When I turn it dynamic (e.g. <code>Application.WorksheetFunction.Match(Cells(i,3)-x)</code>) it will cause the program to error when it cannot find a match in the designated table. So I fixed it accordingly. Just to update you"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1508742304, "post_id": 46807732, "comment_id": 80714465, "body": "@MarcSantos As you see, the best way to debug a complicated code is always to break it down into peaces so you can determine the exact position of the issue. Packing everything in one single line of code is mostly not the best option, because shorter code is not better code, but human readable code is better code because it leads into less errors. And in most cases differences in speed of longer code is minimal and may be neglected."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1508744509, "post_id": 46807732, "comment_id": 80715611, "body": "It&#39;s less time consuming to debug for sure. I have to review my code and fix them because they are too compact and probably did not optimize the spacing in between lines like you did and not separated into portions just like how @Vityata did it"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1508337232, "last_edit_date": 1508337232, "creation_date": 1508321451, "answer_id": 46807732, "question_id": 46806759, "link": "https://stackoverflow.com/questions/46806759/invalid-procedure-call-or-argument-error-in-do-while-loop-in-excel-vba/46807732#46807732", "title": "&quot;Invalid procedure call or argument&quot; error in Do-While-Loop in Excel VBA?", "body": "<h3>1. First solution (see 2 for updated conditions)</h3>\n\n<p>Having a look at your loop \u2026</p>\n\n<pre><code>Do While Application.WorksheetFunction.Weekday(Worksheets(\"DTR\").Cells(i, 3) - x) = 1 _\n   Or Application.WorksheetFunction.Index(Worksheets(\"Holidays Table\").Range(\"B2:B1048576\"), Application.WorksheetFunction.Match(Worksheets(\"DTR\").Cells(i, 3), Worksheets(\"Holidays Table\").Range(\"A2:A1048576\"), 0)) = \"Regular\" _\n   Or Application.WorksheetFunction.Index(Worksheets(\"Holidays Table\").Range(\"B2:B1048576\"), Application.WorksheetFunction.Match(Worksheets(\"DTR\").Cells(i, 3), Worksheets(\"Holidays Table\").Range(\"A2:A1048576\"), 0)) = \"SNWH\" _\n   And Application.WorksheetFunction.Sum(Worksheets(\"DTR\").Range(\"P\" &amp; i &amp; \":S\" &amp; i)) &gt; 0\n    x = x + 1\nLoop\n</code></pre>\n\n<p>where you only increase <code>x</code>, the only <code>x</code> depending part of your loop is the right before first <code>Or</code>. </p>\n\n<pre><code>Application.WorksheetFunction.Weekday(Worksheets(\"DTR\").Cells(i, 3) - x) = 1\n'only part that depends on x\n</code></pre>\n\n<p>So all the other statements can be checked before the loop because they are static (relative to x).</p>\n\n<p>So your loop is calculating less in each iteration than before because <code>A</code>, <code>B</code> and <code>C</code> are only calculated once. We can do this because they don't change by iterating the loop.</p>\n\n<pre><code>A = Application.WorksheetFunction.Index(Worksheets(\"Holidays Table\").Range(\"B2:B1048576\"), Application.WorksheetFunction.Match(Worksheets(\"DTR\").Cells(i, 3), Worksheets(\"Holidays Table\").Range(\"A2:A1048576\"), 0)) = \"Regular\"\nB = Application.WorksheetFunction.Index(Worksheets(\"Holidays Table\").Range(\"B2:B1048576\"), Application.WorksheetFunction.Match(Worksheets(\"DTR\").Cells(i, 3), Worksheets(\"Holidays Table\").Range(\"A2:A1048576\"), 0)) = \"SNWH\"\nC = Application.WorksheetFunction.Sum(Worksheets(\"DTR\").Range(\"P\" &amp; i &amp; \":S\" &amp; i)) &gt; 0\n\nDo While Application.WorksheetFunction.Weekday(Worksheets(\"DTR\").Cells(i, 3) - x) = 1 _\n   Or A _\n   Or B _\n   And C\n    x = x + 1\nLoop\n</code></pre>\n\n<hr>\n\n<h3>2. Update since OP changed the loop code to \u2026</h3>\n\n<pre><code>Do While Application.WorksheetFunction.Weekday(Worksheets(\"DTR\").Cells(i, 3) - x) = 1 _\n    Or Application.WorksheetFunction.Index(Worksheets(\"Holidays Table\").Range(\"B2:B1048576\"), Application.WorksheetFunction.Match(Worksheets(\"DTR\").Cells(i, 3)-x, Worksheets(\"Holidays Table\").Range(\"A2:A1048576\"), 0)) = \"Regular\" _\n    Or Application.WorksheetFunction.Index(Worksheets(\"Holidays Table\").Range(\"B2:B1048576\"), Application.WorksheetFunction.Match(Worksheets(\"DTR\").Cells(i, 3)-x, Worksheets(\"Holidays Table\").Range(\"A2:A1048576\"), 0)) = \"SNWH\" _\n    And Application.WorksheetFunction.Sum(Worksheets(\"DTR\").Range(\"P\" &amp; i-x &amp; \":S\" &amp; i-x)) &gt; 0\n    x = x + 1\nLoop\n</code></pre>\n\n<p>\u2026 where every of the 4 conditions depends on <code>x</code>, we can do something like this:</p>\n\n<pre><code>Dim RunLoop As Boolean\nDo\n    'we split up the conditions into A-D so if an error occurs we know in which condition\n    A = Application.WorksheetFunction.Weekday(Worksheets(\"DTR\").Cells(i, 3) - x) = 1\n    B = Application.WorksheetFunction.Index(Worksheets(\"Holidays Table\").Range(\"B2:B1048576\"), Application.WorksheetFunction.Match(Worksheets(\"DTR\").Cells(i, 3) - x, Worksheets(\"Holidays Table\").Range(\"A2:A1048576\"), 0)) = \"Regular\"\n    C = Application.WorksheetFunction.Index(Worksheets(\"Holidays Table\").Range(\"B2:B1048576\"), Application.WorksheetFunction.Match(Worksheets(\"DTR\").Cells(i, 3) - x, Worksheets(\"Holidays Table\").Range(\"A2:A1048576\"), 0)) = \"SNWH\"\n    D = Application.WorksheetFunction.Sum(Worksheets(\"DTR\").Range(\"P\" &amp; i - x &amp; \":S\" &amp; i - x)) &gt; 0\n    'now we check all coditions\n    RunLoop = A Or B Or C And D\n    'and exit the loop if the condition is false\n    If RunLoop = False Then Exit Do\n    x = x + 1\nLoop\n</code></pre>\n\n<p><strong>Note:</strong> I additionally recommend to use <code>Option Explicit</code> and declare every variable properly.</p>\n"}], "owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1508337232, "creation_date": 1508318428, "last_edit_date": 1508337061, "question_id": 46806759, "link": "https://stackoverflow.com/questions/46806759/invalid-procedure-call-or-argument-error-in-do-while-loop-in-excel-vba", "title": "&quot;Invalid procedure call or argument&quot; error in Do-While-Loop in Excel VBA?", "body": "<p>Why is there an </p>\n\n<blockquote>\n  <p>\"Invalid procedure call or argument\" </p>\n</blockquote>\n\n<p>error in this Do-While-Loop in Excel VBA?</p>\n\n<p>I cannot seem to find the problem I do not believe there is a typo. The error is directed at the line of code with the asterisks.</p>\n\n<p>Note that <code>Worksheets(\"DTR\").Cells(i,3)</code> is a date. </p>\n\n<pre><code>For i = 2 To Total_rows_DTR\n    m = Application.Match(Worksheets(\"DTR\").Cells(i, 3), Worksheets(\"Holidays Table\").Range(\"A2:A1048576\"), 0)\n    If Not IsError(m) Then\n        If Application.WorksheetFunction.Index(Worksheets(\"Holidays Table\").Range(\"B2:B1048576\"), Application.WorksheetFunction.Match(Worksheets(\"DTR\").Cells(i, 3), Worksheets(\"Holidays Table\").Range(\"A2:A1048576\"), 0)) = \"Regular\" Then\n            x = 1\n            '** Error occurs in the following line:\n            Do While Application.WorksheetFunction.Weekday(Worksheets(\"DTR\").Cells(i, 3) - x) = 1 Or Application.WorksheetFunction.Index(Worksheets(\"Holidays Table\").Range(\"B2:B1048576\"), Application.WorksheetFunction.Match(Worksheets(\"DTR\").Cells(i, 3)-x, Worksheets(\"Holidays Table\").Range(\"A2:A1048576\"), 0)) = \"Regular\" Or Application.WorksheetFunction.Index(Worksheets(\"Holidays Table\").Range(\"B2:B1048576\"), Application.WorksheetFunction.Match(Worksheets(\"DTR\").Cells(i, 3)-x, Worksheets(\"Holidays Table\").Range(\"A2:A1048576\"), 0)) = \"SNWH\" And Application.WorksheetFunction.Sum(Worksheets(\"DTR\").Range(\"P\" &amp; i-x &amp; \":S\" &amp; i-x)) &gt; 0\n                x = x + 1\n            Loop\n            If Application.WorksheetFunction.Sum(Worksheets(\"DTR\").Range(\"P\" &amp; i &amp; \":S\" &amp; i)) = 0 Then\n                Worksheets(\"DTR\").Cells(i, 26) = 0\n            End If\n        End If\n    End If\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement", "populate"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1508319873, "post_id": 46806414, "comment_id": 80561456, "body": "Did one of the suggested solutions work for you?"}], "answers": [{"tags": [], "owner": {"reputation": 767, "user_id": 8411349, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/hdm06.jpg?s=128&g=1", "display_name": "PeterH", "link": "https://stackoverflow.com/users/8411349/peterh"}, "is_accepted": false, "score": 1, "last_activity_date": 1508317526, "creation_date": 1508317526, "answer_id": 46806493, "question_id": 46806414, "link": "https://stackoverflow.com/questions/46806414/vba-how-to-populate-one-column-with-if-condition/46806493#46806493", "title": "VBA: How to populate one column with IF condition", "body": "<pre><code>Sub Macro1()\n    ActiveCell.FormulaR1C1 = \"=IF(R[5]C[11]&lt;&gt;\"\"\"\",LEFT(R[5]C,2),\"\"\"\")\"\n\n    'CHANGE C1:C38 TO THE RANGE OF YOUR THIRD COLUMN\n    Selection.AutoFill Destination:=Range(\"C1:C38\"), Type:=xlFillDefault\n\nEnd Sub\n</code></pre>\n\n<p>Just adjust <code>C1:C38</code> to suit your third column range</p>\n"}, {"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1508317970, "creation_date": 1508317970, "answer_id": 46806623, "question_id": 46806414, "link": "https://stackoverflow.com/questions/46806414/vba-how-to-populate-one-column-with-if-condition/46806623#46806623", "title": "VBA: How to populate one column with IF condition", "body": "<pre><code>Public Function myThirdColumn(myFirstColumn, mySecondColumn)\n    If mySecondColumn &lt;&gt; \"\" Then\n        myThirdColumn = Left(myFirstColumn, 2)\n    Else\n        myThirdColumn = \"\"\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "is_accepted": false, "score": 1, "last_activity_date": 1508317987, "creation_date": 1508317987, "answer_id": 46806629, "question_id": 46806414, "link": "https://stackoverflow.com/questions/46806414/vba-how-to-populate-one-column-with-if-condition/46806629#46806629", "title": "VBA: How to populate one column with IF condition", "body": "<p>This should do it,</p>\n\n<pre><code>Sub test()\n  Sheets(\"Sheet1\").Range(\"C1:C10\").Formula = \"=IF(C1 &lt;&gt; \"\"\"\", LEFT(C1,2), \"\"\"\")\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 1, "last_activity_date": 1508318068, "creation_date": 1508318068, "answer_id": 46806665, "question_id": 46806414, "link": "https://stackoverflow.com/questions/46806414/vba-how-to-populate-one-column-with-if-condition/46806665#46806665", "title": "VBA: How to populate one column with IF condition", "body": "<p>Considering the data you showed, give this a try...</p>\n\n<pre><code>Sub InsertFormula()\nDim lr As Long\nlr = Cells(Rows.Count, 1).End(xlUp).Row\nRange(\"C2:C\" &amp; lr).Formula = \"=IF(N2 &lt;&gt; \"\"\"\", LEFT(A2,2), \"\"\"\")\"\nEnd Sub\n</code></pre>\n\n<p>The above code assumes that the data lies in column A and B and you need to place the formula in column C starting from Row2 based on the column N.</p>\n"}], "owner": {"reputation": 1, "user_id": 8794414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8309367fb067701c70ff2da7aef8444?s=128&d=identicon&r=PG&f=1", "display_name": "Bradi", "link": "https://stackoverflow.com/users/8794414/bradi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1762, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1508319074, "creation_date": 1508317300, "last_edit_date": 1508319074, "question_id": 46806414, "link": "https://stackoverflow.com/questions/46806414/vba-how-to-populate-one-column-with-if-condition", "title": "VBA: How to populate one column with IF condition", "body": "<p>So here's my problem. I've 3 columns with headers. And for this example let's say the first column is a normal text string. The second one is an optional field, which is either empty or filled. The third column is the one to be populated with the following rule: If the 2nd column is not empty, then the first 2 letters of the 1st column should be auto populated to 3rd column. See the picture below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/PhCTh.jpg\" rel=\"nofollow noreferrer\">Example table</a></p>\n\n<p>With functions all I'd have to do is to put =IF(B2 &lt;> \"\"; LEFT(A2;2); \"\") -formula to all cells in 3rd column. But could someone tell me how would I do the same in VBA? (I have no choice to use the function in this case).</p>\n\n<p>Edit: Thank you for all the answers :)</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "is_accepted": false, "score": 2, "last_activity_date": 1508321370, "last_edit_date": 1508321370, "creation_date": 1508317598, "answer_id": 46806516, "question_id": 46806396, "link": "https://stackoverflow.com/questions/46806396/vba-if-value-a-in-cell-matches-value-in-cell-b-then-copy-cell-c-to-cell-d/46806516#46806516", "title": "VBA: if value a in cell matches value in cell b then copy cell C to cell D", "body": "<p>Try to split your problem into smaller pieces and then solve them one at a time. If there is a specific step which fails, then ask in here. You problem looks something like this:</p>\n\n<ul>\n<li>Get the value of column A in worksheet 3 and 7</li>\n<li>Check if values are identical</li>\n<li>If yes: Copy from ws7 column K to ws3 column L</li>\n<li>Loop the above for all rows</li>\n</ul>\n\n<p>Now you have four steps to solve. There are many ways to do this, and I am not going to code it for you. But it should not be difficult to find a solution to any of them.</p>\n"}], "owner": {"reputation": 1, "user_id": 8683676, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155806872069036/picture?type=large", "display_name": "David Lipkens", "link": "https://stackoverflow.com/users/8683676/david-lipkens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1515190842, "creation_date": 1508317257, "last_edit_date": 1515190842, "question_id": 46806396, "link": "https://stackoverflow.com/questions/46806396/vba-if-value-a-in-cell-matches-value-in-cell-b-then-copy-cell-c-to-cell-d", "title": "VBA: if value a in cell matches value in cell b then copy cell C to cell D", "body": "<p>I'm working on the automisation of a workbook and I can't seem to fix the next thing. What I want to do: </p>\n\n<p>If the values in column A of worksheet3 matches the values in column A of worksheet7 then copy the value of column K of worksheet7 to column L in worksheet3. </p>\n\n<p>Does anybody knows the code? Tried several things on Google, but I can't seem to find what I exactly need. </p>\n"}, {"tags": ["vba", "excel", "loops", "for-loop"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1508317468, "post_id": 46806394, "comment_id": 80559880, "body": "Use conditional formatting???"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 2, "creation_date": 1508317696, "post_id": 46806394, "comment_id": 80560029, "body": "Try wrapping the loop with <code>Application.ScreenUpdating = False</code> at the beginning and <code>Application.ScreenUpdating = True</code> at the end."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508317785, "post_id": 46806394, "comment_id": 80560084, "body": "Also don&#39;t update the status bar at every iteration of the loop."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1508318636, "post_id": 46806394, "comment_id": 80560614, "body": "Principally you should avoid to format too much single cells instead of whole columns or whole rows in order to avoid exploding file sizes."}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1508319246, "post_id": 46806750, "comment_id": 80561006, "body": "If you read this 3 times I am pretty sure that you will manage to upgrade your code one level - <a href=\"https://support.office.com/en-us/article/TRANSPOSE-function-ed039415-ed8a-4a81-93e9-4b6dfac76027\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1508319476, "post_id": 46806750, "comment_id": 80561174, "body": "@Vityata, of course, only tried to show the direction. Follow up later."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1508319514, "post_id": 46806750, "comment_id": 80561198, "body": "The direction is a nice one, just one part of it can be upgraded."}, {"owner": {"reputation": 479, "user_id": 4998200, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dd3a2459595410b6e15ef53fc027b34?s=128&d=identicon&r=PG&f=1", "display_name": "Mand", "link": "https://stackoverflow.com/users/4998200/mand"}, "edited": false, "score": 0, "creation_date": 1508325435, "post_id": 46806750, "comment_id": 80564764, "body": "Wauw! This one decreases the time to only 15 seconds! The only thing is that the cells are not formatted in the colors needed. How does that come?"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 479, "user_id": 4998200, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dd3a2459595410b6e15ef53fc027b34?s=128&d=identicon&r=PG&f=1", "display_name": "Mand", "link": "https://stackoverflow.com/users/4998200/mand"}, "edited": false, "score": 0, "creation_date": 1508326027, "post_id": 46806750, "comment_id": 80565148, "body": "@Mand, Added new functionality if there are formula Errors to be suspected; above all I&#39;m not a friend of interior.Color formatting, as I commented. (Cleared existing formats, too)"}, {"owner": {"reputation": 479, "user_id": 4998200, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dd3a2459595410b6e15ef53fc027b34?s=128&d=identicon&r=PG&f=1", "display_name": "Mand", "link": "https://stackoverflow.com/users/4998200/mand"}, "edited": false, "score": 0, "creation_date": 1508326292, "post_id": 46806750, "comment_id": 80565304, "body": "My bad. I filled in the wrong sheet... &gt;.&lt;. Thanks dude! This one works like a charm! Question answered!"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1508344695, "post_id": 46806750, "comment_id": 80577554, "body": "@Vityata, thx but couldn&#39;t find the need of transposing in this case"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1508345114, "post_id": 46806750, "comment_id": 80577777, "body": "@T.M. - it will help you to build it with a one dimensional array, not with a two dimensional. Give it a try, its a worthy one liner :)"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1508346667, "post_id": 46806750, "comment_id": 80578580, "body": "@Vityata, I appreciate your helpful hints, but I didn&#39;t find any improvement in time using a 1dim array: <code>v = Application.Transpose(ws.Range(&quot;M1:M&quot; &amp; n).value)</code>."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1508347343, "post_id": 46806750, "comment_id": 80578874, "body": "@T.M. - in time it probably stays the same, but the readability improves, as far as you do not need the second dimension."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1508348720, "post_id": 46806750, "comment_id": 80579573, "body": "@Vityata, I agree that needing only one Dimension both approaches have their advantages. As for me, the datafield method allows to use one method without contraint to distinguish between one or multicolumn source ranges and to use different coding. BTW, I think your link to be interesting for number of users."}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 3, "last_activity_date": 1508324948, "last_edit_date": 1508324948, "creation_date": 1508318395, "answer_id": 46806750, "question_id": 46806394, "link": "https://stackoverflow.com/questions/46806394/for-loop-setting-font-and-interior-of-range-taking-way-too-long/46806750#46806750", "title": "For loop setting Font and Interior of Range taking way too long", "body": "<p>Avoid looping through a range. You can speed up your code by looping through an array and do formatting after it. Furthermore you could split your loop for the status bar count into portions.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub Greater500()\nDim ws As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"MySheet\")\nDim v As Variant\nDim i As Long, n As Long, m As Long, r As Long\nDim t As Double\n' stop watch\n  t = timer\n' get last row in column M\n  n = ws.Range(\"M\" &amp; ws.Rows.Count).End(xlUp).Row\n' get values to one based 2dim array\n  v = ws.Range(\"M1:M\" &amp; n).value\n' clear existing colors over the WHOLE column to minimize file size\n      ws.Range(\"M:M\").Interior.ColorIndex = xlColorIndexNone\n\n  For i = 1 To n\n      ' avoid troubles with formula errors, e.g. divisions :/ zero\n        If IsError(v(i, 1)) Then\n      ' check condition (neglecting date, string and boolean data types)\n        ElseIf Val(v(i, 1)) &gt; 500 Then\n           ws.Cells(i, 13).Interior.ColorIndex = 37\n           ws.Cells(i, 13).Font.Color = vbBlack\n           ws.Cells(i, 13).Font.Bold = True\n        End If\n  Next i\n  MsgBox \"Time needed: \" &amp; Format(timer - t, \"0.00\") &amp; \" seconds.\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 2, "last_activity_date": 1508319363, "creation_date": 1508319363, "answer_id": 46807064, "question_id": 46806394, "link": "https://stackoverflow.com/questions/46806394/for-loop-setting-font-and-interior-of-range-taking-way-too-long/46807064#46807064", "title": "For loop setting Font and Interior of Range taking way too long", "body": "<p><code>Rows.Count</code> includes <em>every</em> row, not just the ones with data.  (<strong>1,048,576 rows</strong> in Excel 2016).  The status bar shouldn't slow it down too much.</p>\n\n<pre><code>Sub test()\n    Dim c As Range, count As Integer\n    Worksheets(\"Sheet1\").Activate\n    ActiveSheet.UsedRange.Select\n    For Each c In Application.Selection.Cells\n        If Cells(c.Row, 13).Value &gt; 500 Then\n            Cells(c.Row, 13).Interior.ColorIndex = 37\n            Cells(c.Row, 13).Font.Color = Black\n            Cells(c.Row, 13).Font.Bold = True\n            count = count + 1\n        End If\n        Application.StatusBar = count\n    Next c\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "is_accepted": false, "score": 1, "last_activity_date": 1508327945, "creation_date": 1508327945, "answer_id": 46809673, "question_id": 46806394, "link": "https://stackoverflow.com/questions/46806394/for-loop-setting-font-and-interior-of-range-taking-way-too-long/46809673#46809673", "title": "For loop setting Font and Interior of Range taking way too long", "body": "<p>The reason your code slows down is it takes all the rows when you're writing Rows.Count.</p>\n\n<p>Try to limit your range and update the format at once at the very end which should fix your problem.</p>\n\n<p>Below code takes 50000 cells and completes in more or less 8 seconds on my machine.</p>\n\n<p>I also tried for each loop with almost same times.</p>\n\n<pre><code>Sub test()\n\n    Dim counter As Long\n    Dim count As Long\n    Dim st As Double\n    Dim et As Double\n    Dim tottime As Double\n    Dim rangetoformat As Range\n\n    'remove timer\n    st = Timer\n\n    For counter = 1 To 50000\n        If Not rangetoformat Is Nothing Then\n            If Cells(counter, 13).Value &gt; 500 Then\n                Set rangetoformat = Union(rangetoformat, Cells(counter, 13))\n            End If\n        Else\n            Set rangetoformat = Cells(counter, 13)\n        End If\n        count = count + 1\n        Application.StatusBar = count\n    Next counter\n\n    rangetoformat.Cells.Interior.ColorIndex = 37\n    rangetoformat.Cells.Font.Color = Black\n    rangetoformat.Cells.Font.Bold = True\n\n    'remove timer\n    et = Timer\n    totaltime = et - st\n    MsgBox totaltime\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 479, "user_id": 4998200, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dd3a2459595410b6e15ef53fc027b34?s=128&d=identicon&r=PG&f=1", "display_name": "Mand", "link": "https://stackoverflow.com/users/4998200/mand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 46806750, "answer_count": 3, "score": 3, "last_activity_date": 1508327945, "creation_date": 1508317253, "last_edit_date": 1508317494, "question_id": 46806394, "link": "https://stackoverflow.com/questions/46806394/for-loop-setting-font-and-interior-of-range-taking-way-too-long", "title": "For loop setting Font and Interior of Range taking way too long", "body": "<p>I have a sheet with a lot of data (almost 14.000 rows and 13 columns). </p>\n\n<p>I am running a <code>For</code> loop within this sheet but it takes sometimes over 2 minutes to complete it. Also the application is not responding during the <code>For</code> loop. </p>\n\n<p>Is there a way I can re-write my loop so it will run a lot faster?</p>\n\n<p>Here is my code: </p>\n\n<pre><code>For counter = 1 To Rows.Count\n    If Cells(counter, 13).Value &gt; 500 Then\n        Cells(counter, 13).Interior.ColorIndex = 37\n        Cells(counter, 13).Font.Color = Black\n        Cells(counter, 13).Font.Bold = True\n    End If\n    count = count + 1\n    Application.StatusBar = count\nNext counter\n</code></pre>\n\n<p>Thanks in advance :).</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1508317155, "post_id": 46806191, "comment_id": 80559700, "body": "<code>For Each shp In ws</code> should be <code>For Each shp In ws.Shapes</code>"}, {"owner": {"reputation": 123, "user_id": 7746302, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/600d7439413cb33871a0962cdb0c2e8e?s=128&d=identicon&r=PG&f=1", "display_name": "tj123", "link": "https://stackoverflow.com/users/7746302/tj123"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1508319325, "post_id": 46806191, "comment_id": 80561058, "body": "Have made this amend and now &#39;91&#39; get object or with block variable not set"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1508320037, "post_id": 46806191, "comment_id": 80561563, "body": "Which line does the new error come on?"}, {"owner": {"reputation": 123, "user_id": 7746302, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/600d7439413cb33871a0962cdb0c2e8e?s=128&d=identicon&r=PG&f=1", "display_name": "tj123", "link": "https://stackoverflow.com/users/7746302/tj123"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1508320242, "post_id": 46806191, "comment_id": 80561680, "body": "Its line 17 = sShape.Right = 0"}], "owner": {"reputation": 123, "user_id": 7746302, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/600d7439413cb33871a0962cdb0c2e8e?s=128&d=identicon&r=PG&f=1", "display_name": "tj123", "link": "https://stackoverflow.com/users/7746302/tj123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508321055, "creation_date": 1508316592, "question_id": 46806191, "link": "https://stackoverflow.com/questions/46806191/excel-vba-hide-show-move-shape", "title": "Excel VBA hide/show/move Shape", "body": "<p>Am trying to hide or move a series of shapes in excel.  </p>\n\n<p>I have a range of cells that I want to copy as a picture and basically if the shape isn't 'active' i.e. contains text then I don't want the shapes to be visable in this range of cells. Each shape is linked and if the if/vlookup is true the shape will contain text.</p>\n\n<p>The following is not working - have tried modifying .Visable with .Right i.e. to shift the shapes out of range - but it says object does not support this property or method.</p>\n\n<pre><code> Sub Macro3()\n Dim ws As Worksheet\n Set ws = ThisWorkbook.ActiveSheet\n Dim shp As Shape\n Dim tr As TextRange2\n Dim grp As Shape\n Dim sShape As Shape\n\n Set shp = ws.Shapes(\"Line Callout 1 2\")\n Set tr = shp.TextFrame2.TextRange\n\n For Each ws In ThisWorkbook.Worksheets\n    For Each shp In ws\n            If shp.Name Like \"Line Callout 1\" And tr.Characters.Text = \"\" Then\n                sShape.Right = 300\n            Else\n                sShape.Right = 0\n            End If\n    Next shp\n    Next ws\n    End Sub\n</code></pre>\n\n<p>If I specify a named cell I can alter the visability but for over 600 shapes I want to auomate this somehow This works for named shape and named range:</p>\n\n<pre><code>Sub Macro1()\nDim ws As Worksheet\n\nSet ws = ThisWorkbook.ActiveSheet\nWith ws.Shapes.Range(Array(\"Line Callout 1 1\"))\n       .Fill.Visible = Range(\"x\")\n       .Line.Visible = Range(\"x\")\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1508316939, "post_id": 46806045, "comment_id": 80559556, "body": "Without seeing your data it is hard to tell if or how the pivot tables will overlap. Why do you use code to create the pivot tables? The idea with pivot tables is that only the data changes, so the pivot table definitions stay the same and you only need to refresh them. Also, consider using Excel Table Objects as the source for pivot tables, then the data source will grow and shrink dynamically. Books have been written about this subject, so you may want to do a bit more research and learning about pivot tables and dynamic data sources."}, {"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1508317052, "post_id": 46806045, "comment_id": 80559626, "body": "@teylyn thanks for the feedback! I wanted to create them automatically, because this macro will run inside different workbooks daily. (I will be copy pasting it daily to other sheets!"}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1508322189, "post_id": 46806419, "comment_id": 80562846, "body": "@sktneer just curious why you are not using your <code>Pivot</code> objects after you <code>Set</code> them ? Instead of <code>With ActiveSheet.PivotTables(&quot;PivotTable1&quot;)</code> you can use <code>With PTable1</code>, the same for &quot;PivotTable2&quot;"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1508322541, "post_id": 46806419, "comment_id": 80563044, "body": "@ShaiRado I didn&#39;t change the OP&#39;s code just removed the line and placed it at the correct position in order to avoid the error OP was getting. I was not supposed to rewrite the code though. :)"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 2, "last_activity_date": 1508317333, "creation_date": 1508317333, "answer_id": 46806419, "question_id": 46806045, "link": "https://stackoverflow.com/questions/46806045/two-pivot-tables-in-the-same-excel-sheet/46806419#46806419", "title": "Two Pivot Tables in the same excel sheet", "body": "<p>When you insert the first pivot table and insert another one before populating the first one, the empty pivot table range of the first pivot table occupies the destination cell [DSheet.Cells(17, 2)] of the second pivot table.</p>\n\n<p>I think you should insert the first pivot table and populate it and then insert another one and populate that as well.</p>\n\n<p>See if that resolves your issue.</p>\n\n<pre><code>Dim DSheet As Worksheet\nDim PCache As PivotCache\nDim PTable1 As PivotTable\nDim PTable2 As PivotTable\nDim PRange As Range\n\nApplication.DisplayAlerts = True\nSet DSheet = Worksheets(\"Budget_Report\")\n\nSet PRange = DSheet.Range(Cells(1, 53), Cells.SpecialCells(xlCellTypeLastCell))\n\nSet PCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=PRange)\nSet PTable1 = PCache.CreatePivotTable(TableDestination:=DSheet.Cells(4, 1), TableName:=\"PivotTable1\")\n\nWith ActiveSheet.PivotTables(\"PivotTable1\")\n\n  With .PivotFields(\"T-Lane\")\n    .Orientation = xlRowField\n    .Position = 1\n    .Subtotals(1) = True\n    .Subtotals(1) = False\n  End With\n\n  With .PivotFields(\"Monthly Cost FCST\")\n    .Orientation = xlDataField\n    .Position = 1\n    .Function = xlAverage\n    .Caption = \"Monthly Cost Forecast\"\n  End With\n\nEnd With\n\nSet PTable2 = PCache.CreatePivotTable(TableDestination:=DSheet.Cells(17, 2), TableName:=\"PivotTable2\")\n\nWith ActiveSheet.PivotTables(\"PivotTable2\")\n\n  With .PivotFields(\"Oran\")\n    .Orientation = xlRowField\n    .Position = 1\n    .Subtotals(1) = True\n    .Subtotals(1) = False\n  End With\n\n  With .PivotFields(\"Monthly Cost FCST\")\n    .Orientation = xlDataField\n    .Position = 1\n    .Function = xlAverage\n    .Caption = \"Monthly Cost Forecast\"\n  End With\n\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1508323022, "creation_date": 1508323022, "answer_id": 46808213, "question_id": 46806045, "link": "https://stackoverflow.com/questions/46806045/two-pivot-tables-in-the-same-excel-sheet/46808213#46808213", "title": "Two Pivot Tables in the same excel sheet", "body": "<p>From the <a href=\"https://msdn.microsoft.com/en-us/library/aa578091.aspx\" rel=\"nofollow noreferrer\">MSDN doc on pivot tables</a>:</p>\n\n<blockquote>\n  <p>\"<strong>Important</strong>\" If you define multiple PivotTables on the Excel\n  Worksheet, <strong>it is <em>possible</em> the resulting tables can grow and overlap\n  each other</strong> if the Activity returns a large dataset. In this scenario,\n  you will receive \"A PivotTable report cannot overlap another\n  PivotTable report\" when you refresh the data. You can correct this\n  error by adding addition columns or rows between the pivot tables to\n  allow the tables to grow with out overlapping.</p>\n</blockquote>\n"}], "owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4317, "favorite_count": 0, "accepted_answer_id": 46806419, "answer_count": 2, "score": 0, "last_activity_date": 1508323022, "creation_date": 1508316082, "question_id": 46806045, "link": "https://stackoverflow.com/questions/46806045/two-pivot-tables-in-the-same-excel-sheet", "title": "Two Pivot Tables in the same excel sheet", "body": "<p>I have created a Pivot Table in the same sheet with the source data. Now, I want to create a second Pivot Table in the same sheet with same data source, but with different printed data inside the Pivot Table (of course). I keep getting an error, as it says that Pivot Table cannot overwrite another Pivot Table. However, they way I have selected the ranges where the pivot tables are created, they dont overwrite each other. I tested manually too. Also, if I record the process it just uses exact references for the source data, which I dont want to use because the lastrow and lastcolumn change daily. Just to remind it, the macro works great for creating the first table. The second table is the issue. Below, I will provide my code as it is now. </p>\n\n<pre><code>Dim DSheet As Worksheet\nDim PCache As PivotCache\nDim PTable1 As PivotTable\nDim PTable2 As PivotTable\nDim PRange As Range\n\nApplication.DisplayAlerts = True\nSet DSheet = Worksheets(\"Budget_Report\")\n\nSet PRange = DSheet.Range(Cells(1, 53), Cells.SpecialCells(xlCellTypeLastCell))\n\nSet PCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=PRange)\nSet PTable1 = PCache.CreatePivotTable(TableDestination:=DSheet.Cells(4, 1), TableName:=\"PivotTable1\")\nSet PTable2 = PCache.CreatePivotTable(TableDestination:=DSheet.Cells(17, 2), TableName:=\"PivotTable2\")\n\nWith ActiveSheet.PivotTables(\"PivotTable1\")\n\n  With .PivotFields(\"T-Lane\")\n    .Orientation = xlRowField\n    .Position = 1\n    .Subtotals(1) = True\n    .Subtotals(1) = False\n  End With\n\n  With .PivotFields(\"Monthly Cost FCST\")\n    .Orientation = xlDataField\n    .Position = 1\n    .Function = xlAverage\n    .Caption = \"Monthly Cost Forecast\"\n  End With\n\nEnd With\n\nWith ActiveSheet.PivotTables(\"PivotTable2\")\n\n  With .PivotFields(\"Oran\")\n    .Orientation = xlRowField\n    .Position = 1\n    .Subtotals(1) = True\n    .Subtotals(1) = False\n  End With\n\n  With .PivotFields(\"Monthly Cost FCST\")\n    .Orientation = xlDataField\n    .Position = 1\n    .Function = xlAverage\n    .Caption = \"Monthly Cost Forecast\"\n  End With\n\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1508315584, "post_id": 46805416, "comment_id": 80558778, "body": "<code>Dim strWorkbookName As String: strWorkbookName = InputBox(&quot;Select a workbook&quot;)</code>"}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 1, "creation_date": 1508315777, "post_id": 46805416, "comment_id": 80558882, "body": "Using Power Query would be simpler and more efficient."}], "answers": [{"tags": [], "owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "is_accepted": false, "score": 0, "last_activity_date": 1508326716, "creation_date": 1508326716, "answer_id": 46809287, "question_id": 46805416, "link": "https://stackoverflow.com/questions/46805416/importing-text-files-into-master-excel-document-vba/46809287#46809287", "title": "Importing text files into master excel document (VBA)?", "body": "<p>First, a launcher to select files, and commence import on each file:</p>\n\n<pre><code>Sub SelectFilesForImport()\n    Dim fd  As FileDialog\n    Dim i   As Long\n\n    'set and determine file picker behaviors\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n    fd.AllowMultiSelect = True\n\n    'Launch file picker, exit if no files selected. \n    'Hold Ctrl to select multiple files. Ctrl+A to select all files\n    If Not fd.Show = -1 Then Exit Sub\n\n    'Start import selected files, file by file.\n    For i = 1 To fd.SelectedItems.Count\n        Call ImportFile(fd.SelectedItems(i))\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Second sub, import line by line (w/o opening the file in Excel)</p>\n\n<pre><code>Private Sub ImportFile(ByVal FilePathAndName As String)\n    Dim DataInTransit   As String\n    Dim FileName        As String\n    Dim N               As Integer\n\n    N = FreeFile\n    Open FilePathAndName For Input As #N\n        Do While Not EOF(N)\n            Line Input #N, DataInTransit\n\n            ' ##################################################\n            ' Up to this point, \"DataInTransit\" is a single line text.\n            ' Now it depends on how you want to massage and put it into the worksheet.\n            ' You can also skip lines which do not fit into context _\n              by adding conditional IF statements.\n            ' Modify below to suit your needs:\n                Arr = Split(DataInTransit, \";\")\n                ActiveCell.Resize(1, UBound(Arr) + 1) = Split(DataInTransit, \" \")\n                ActiveCell.Offset(1).Activate\n            ' ##################################################\n\n        Loop\n    Close #N\nEnd Sub\n</code></pre>\n\n<p>For where to place the import, I think it simpler to place directly into <code>ActiveCell</code> as shown is second sub above, then offset to next row for new lines. But it could be slow if you have many calculations (could be solve by turn of automatic calculation). Otherwise, as you suggested, use array to collect the lines and then put them in all at once into the worksheet. Either way, the user only have to select the top-left corner of the range where to begin the import (It would be nice to prompt a message to ask them to select the cell where to begin placing the import, otherwise they could mess up their whole worksheet, p/s also allow them to cancel the macro in the prompt for just in case). This can be done by simply adding the lines below into the first sub.</p>\n\n<pre><code>    Dim k\n    k = Application.InputBox(\"Please select where to place the import.\")\n    On Error GoTo Term 'If k is not a range, go to Term\n    Range(k).Activate\n    Exit Sub\n\n    Term:\n    End\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8794239, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TzTTN3nZiWY/AAAAAAAAAAI/AAAAAAAAAJU/dCEKr2dgRSg/photo.jpg?sz=128", "display_name": "Kathryn", "link": "https://stackoverflow.com/users/8794239/kathryn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508330196, "creation_date": 1508313833, "last_edit_date": 1531164843, "question_id": 46805416, "link": "https://stackoverflow.com/questions/46805416/importing-text-files-into-master-excel-document-vba", "title": "Importing text files into master excel document (VBA)?", "body": "<p>I have written a code that allows the user to select a folder, and then it loops through all the files in the folder, copying a specific column of data into my master document 'PQ Analysis spreadsheet'.</p>\n\n<p>I would like to improve this code, to make it more generic.</p>\n\n<p>Is there any way I can alter it so I don't have to specify 'PQ Analysis spreadsheet' as the master document? i.e. So it can be called whatever the user wishes.</p>\n\n<p>Additionally, I currently open each file into a new workbook, and copy from there. I'm sure there must be a way to input directly from the txt file into an array, and print from there? </p>\n\n<p>Any suggestions would be appreciated. This is the first VBA code I have written, so am very new to this language! Thanks.</p>\n\n<pre><code>Sub tabdelim()\nDim strFileToOpen\nDim InputFile As Workbook\nDim OutputFile As Workbook\n\n'Dialogue box to select file to open\nstrFileToOpen = Application.GetOpenFilename _\n(Title:=\"Please choose a file to open\", _\nFileFilter:=\"Text Files *.txt* (*.txt*),\")\n\nIf strFileToOpen = False Then\n    MsgBox \"No file selected.\", vbExclamation, \"No file selected!\"\n    Exit Sub\n\nElse\n    'Open selected file in new workbook\n    Workbooks.OpenText Filename:= _\n    strFileToOpen, _\n    Origin:=65001, StartRow:=1, DataType:=xlDelimited, TextQualifier:= _\n    xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=False, _\n    Comma:=False, Space:=False, Other:=False, FieldInfo:=Array(Array(1, 1), _\n    Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), Array(7, 1), Array(8, 1), _\n    Array(9, 1)), TrailingMinusNumbers:=True\n\n\nEnd If\n\n\nSet InputFile = ActiveWorkbook\n\n'Now, copy what you want from InputFile:\nActiveSheet.Range(\"I3:I660\").Copy\n\n\n'Now, paste to OutputFile worksheet:\nWindows(\"PQ Analysis spreadsheet.xls\").Activate\nSet OutputFile = ActiveWorkbook\nRange(\"C43\").Select\nActiveSheet.Paste\n\n\n'Close InputFile\nInputFile.Close\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/cP9ua.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cP9ua.png\" alt=\"example of txt document input\"></a></p>\n"}, {"tags": ["vba", "runtime"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8777110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39748ac76d71c27903dceccf803d927?s=128&d=identicon&r=PG&f=1", "display_name": "lofgren", "link": "https://stackoverflow.com/users/8777110/lofgren"}, "edited": false, "score": 0, "creation_date": 1508389690, "post_id": 46807239, "comment_id": 80593610, "body": "Thank you for your answer. I will correct the names. The problem is that the VBA awaits to find a date (dd/mm/yyyy) in cell a21 from sheet 908. But there are some days when i have no request in this page. Instead of a date, the client is writing &quot;no forecast available&quot;. When the code find this text instead of a date, it gives me the &quot;runtime error 1004&quot;.  Is it possible to modify the code so that, if it does not find a date in sheet 908, cell A21, to ignore that line and not try to import my data?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1508319903, "creation_date": 1508319903, "answer_id": 46807239, "question_id": 46804734, "link": "https://stackoverflow.com/questions/46804734/runtime-error-1004-method-range-of-object-global-failed-vba-error/46807239#46807239", "title": "&quot;runtime error 1004 method range of object _global failed&quot; VBA error", "body": "<p>Try like this:</p>\n\n<pre><code>If FndRw = vbNullString then Stop\nWorksheets(\"19_01\").Range(\"AM\" &amp; FndRw &amp; \":AM\" &amp; lastRw1).ClearContents\n</code></pre>\n\n<p>And always make sure that you refer to the correct worksheet and specify the type of your variables.</p>\n"}], "owner": {"reputation": 25, "user_id": 8777110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39748ac76d71c27903dceccf803d927?s=128&d=identicon&r=PG&f=1", "display_name": "lofgren", "link": "https://stackoverflow.com/users/8777110/lofgren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1876, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508319903, "creation_date": 1508311257, "last_edit_date": 1508315639, "question_id": 46804734, "link": "https://stackoverflow.com/questions/46804734/runtime-error-1004-method-range-of-object-global-failed-vba-error", "title": "&quot;runtime error 1004 method range of object _global failed&quot; VBA error", "body": "<p>Please help with the error:</p>\n\n<blockquote>\n  <p>runtime error 1004 method range of object _global failed</p>\n</blockquote>\n\n<p>That I recieve in this vba. </p>\n\n<p>I have around 10 more VBAs before this one, none of them return an error, but this one (they are identical, only page numbers a different):</p>\n\n<pre><code>Sub actualizare()\nDim lastRw1, lastRw2, nxtRw, m\nDim StartRow, x\nDim StartDate As String\nDim FndRw As String\n\nlastRw1 = Sheets(11).Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\nStartDate = Range(\"908!A21\").Value\n\nFor StartRow = 1 To lastRw1\nIf Range(\"19_01!B\" &amp; StartRow).Value = StartDate Then\n\nFndRw = StartRow\nExit For\nEnd If\nNext\n\n***Range(\"19_01!AM\" &amp; FndRw &amp; \":AM\" &amp; lastRw1).ClearContents***\n\nlastRw2 = Sheets(15).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor nxtRw = 1 To lastRw2\n\nWith Sheets(11).Range(\"B2000:B\" &amp; lastRw1)\n\nSet m = .Find(Sheets(15).Range(\"A\" &amp; nxtRw), lookat:=xlWhole)\n\nIf Not m Is Nothing Then\nSheets(15).Range(\"B\" &amp; nxtRw).Copy _\nSheets(11).Range(\"AM\" &amp; m.Row)\n\nEnd If\nEnd With\nNext\nEnd Sub\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1508311538, "post_id": 46804707, "comment_id": 80556480, "body": "Code that works but need optimizing may be a candidate for posting on Code review.  See here for advice on posting there: <a href=\"https://codereview.meta.stackexchange.com/questions/2436/how-to-get-the-best-value-out-of-code-review-asking-questions\" title=\"how to get the best value out of code review asking questions\">codereview.meta.stackexchange.com/questions/2436/&hellip;</a>"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1508332682, "post_id": 46804707, "comment_id": 80569314, "body": "Also read <a href=\"https://codereview.meta.stackexchange.com/questions/5777/a-guide-to-code-review-for-stack-overflow-users\">A guide to Code Review for Stack Overflow users</a>"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "edited": false, "score": 0, "creation_date": 1508312032, "post_id": 46804832, "comment_id": 80556749, "body": "Thanks for your help! I&#39;ve tried the code, but get an error on &quot;If Not MergeRng Is Nothing Then&quot; -&gt; it says &quot;Object required&quot;"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "edited": false, "score": 0, "creation_date": 1508312098, "post_id": 46804832, "comment_id": 80556785, "body": "@ErikSlui try edited code, I forgot to add the part where you define the <code>Range</code> object"}, {"owner": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "edited": false, "score": 0, "creation_date": 1508312188, "post_id": 46804832, "comment_id": 80556842, "body": "Thank you so much Shai Rado! much tried it out and worked like a charm, only takes a couple of seconds now! :-)"}, {"owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 2, "creation_date": 1508312571, "post_id": 46804832, "comment_id": 80557077, "body": "I use <code>Set mrg=Union(IIf(mrg Is Nothing, rng, mrg), rng)</code> to handle union of null ranges. (just a tip/opinion!)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1508323624, "post_id": 46804832, "comment_id": 80563700, "body": "@LS_\u1d05\u1d07\u1d20 cleaver.  It&#39;s not as efficient but the difference is probably negligible,"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1508323673, "post_id": 46804832, "comment_id": 80563744, "body": "@ThomasInzina you&#39;re still with us :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1508324170, "post_id": 46804832, "comment_id": 80564036, "body": "I&#39;m hooked for life!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1508324679, "post_id": 46804832, "comment_id": 80564303, "body": "I just spent most of the day creating a wrapper class for <code>System.Text.StringBuilder</code> then when I was going to post it on CodeReview I found this <a href=\"http://blog.nkadesign.com/2013/access-using-net-strings-in-vba-for-fun-and-profit/\" rel=\"nofollow noreferrer\">Access: using .Net strings in VBA for fun and profit</a>.  They did a much better job of doing it."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 8, "last_activity_date": 1508312079, "last_edit_date": 1508312079, "creation_date": 1508311654, "answer_id": 46804832, "question_id": 46804707, "link": "https://stackoverflow.com/questions/46804707/faster-vba-to-hide-rows/46804832#46804832", "title": "Faster VBA to hide rows", "body": "<p>The most time consuimng action in your code, is every time you perform actions on your worksheet, in your case when you hide each row (multiple times), here:</p>\n\n<pre><code>c.EntireRow.Hidden = True\n</code></pre>\n\n<p>In order to save time, every time your condition is met, just add tha range <code>c</code> to a <code>MergeRng</code>, and at the end (when you exit the loop), just hide the entire rows at once.</p>\n\n<p>Try the code below:</p>\n\n<pre><code>Dim MergeRng As Range ' define range object\n\nFor Each c In targetRange.Rows\n    If (WorksheetFunction.CountIf(c, \"&lt;&gt;0\") - WorksheetFunction.CountIf(c, \"\") = 0) And (WorksheetFunction.CountA(c) - WorksheetFunction.Count(c) = 0) Then\n        If Not MergeRng Is Nothing Then\n            Set MergeRng = Application.Union(MergeRng, c)\n        Else\n            Set MergeRng = c\n        End If\n    End If\nNext c\n\n' hide the entire rows of the merged range at one time\nMergeRng.EntireRow.Hidden = True\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2758, "favorite_count": 0, "accepted_answer_id": 46804832, "answer_count": 1, "score": 4, "last_activity_date": 1508312079, "creation_date": 1508311153, "question_id": 46804707, "link": "https://stackoverflow.com/questions/46804707/faster-vba-to-hide-rows", "title": "Faster VBA to hide rows", "body": "<p>I have a code that checks for each row if the cells in that row are zero (or empty). If a row applies to that rule the row is hidden. If not it remains visible. </p>\n\n<p>The code works perfectly, however it is very very slow (takes about 40 seconds to complete each time I run it).. </p>\n\n<p>I was wondering if anyone could see why my code is slow (or have an alternative which I can use which is faster than my current code).. </p>\n\n<pre><code> Sub hide()\n' Macro hides all rows with position \"zero\" or \"blank\"\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim c As Range\n    Dim targetRange As Range\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Sheets(\"Sheet 1\")\n    Set targetRange = ws.Range(\"I10:N800\")\n\n    targetRange.EntireRow.Hidden = False\n\n    For Each c In targetRange.Rows\n       If (WorksheetFunction.CountIf(c, \"&lt;&gt;0\") - WorksheetFunction.CountIf(c, \"\") = 0) And (WorksheetFunction.CountA(c) - WorksheetFunction.Count(c) = 0) Then\n       c.EntireRow.Hidden = True\n       End If\n    Next c\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "math", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1508308919, "post_id": 46804094, "comment_id": 80555116, "body": "You can&#39;t use AND in this way. It preceeds the multiple conditions you want to evaluate. It is not interposed."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1508309296, "post_id": 46804094, "comment_id": 80555296, "body": "Also, make your question more specific. The following &quot;If SNR text exists it gets values of AD6. If it doesn\u2019t exist it get values of AD6&quot; , what is &#39;it&#39;? And if   you get the value of AD6 no matter what, just set &#39;it&#39; to AD6. No test required. Do you mean =IF(Sheet1!$D6 =&quot;SNR&quot;, AD6, IF(Sheet1!$D6 =&quot;SR&quot;,AA1, do whatever when neither found))"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1508309576, "post_id": 46804094, "comment_id": 80555440, "body": "Also, your title doesn&#39;t match the detail you give in the question i.e. where does AG come into it and AG and AA?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8539691"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1508309770, "post_id": 46804094, "comment_id": 80555536, "body": "Instead of AA1 I am trying to use Q6 + F6.  I don&#39;t think it lets you refer to the cell you are working in though.  I am wanting the total.  HMMM.  Thanks though that did the trick, I am at one last road block :S"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1508309959, "post_id": 46804094, "comment_id": 80555624, "body": "Q6 = Q6 + F6 ? No."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8539691"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1508310300, "post_id": 46804094, "comment_id": 80555813, "body": "I am working in Q6 with =IF(Sheet1!$D6 =&quot;SNR&quot;, AD6, IF(Sheet1!$D6 =&quot;SR&quot;,AA1 and am wanting to basically change AA1 -&gt; AG6. And in AG6 I have Q6 (total) + F6 (a number I want to add to that that changes). Problem is I am working in Q6 so it doesn&#39;t like it  I suppose the only solution here is to create a new column.... Hmm thats not an option in this case. HMM"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1508310396, "post_id": 46804094, "comment_id": 80555858, "body": "You cannot have a circular reference where the the result depends on itself in the calculation. I think i used the right term there. The answer still is no you can&#39;t. Why can&#39;t you have a helper column?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1508319022, "post_id": 46804094, "comment_id": 80560863, "body": "@QHarr circular references are possible in special cases, but you need to activate iterative calculation. Here is an Example: <a href=\"http://www.k2e.com/tech-update/tips/433-tip-performing-iterative-calculations-in-excel\" rel=\"nofollow noreferrer\">k2e.com/tech-update/tips/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1508319807, "post_id": 46804094, "comment_id": 80561410, "body": "@Peh - thanks, i had a sneaking suspicion i was using the term incorrectly. I will have a look at your link. Much obliged."}, {"owner": {"reputation": 3725, "user_id": 4388883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3cf69657df9c46dd460e73760894308?s=128&d=identicon&r=PG&f=1", "display_name": "ian0411", "link": "https://stackoverflow.com/users/4388883/ian0411"}, "edited": false, "score": 0, "creation_date": 1508338555, "post_id": 46804094, "comment_id": 80573425, "body": "You can just use <code>=IF(COUNTIF(Sheet1!D6,&quot;*SNR*&quot;),Sheet1!AD6,Sheet1!AA1)</code> if there is only two conditions (SNR or SR).  Otherwise, try this: <code>=IF(COUNTIF(Sheet1!D6,&quot;*SNR*&quot;),Sheet1!AD6,IF(COUNTIF(Sheet1!&zwnj;&#8203;D6,&quot;*SR*&quot;),Sheet1!AA&zwnj;&#8203;1,&quot;Neither Matched&quot;))</code>"}], "owner": {"user_type": "does_not_exist", "display_name": "user8539691"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 267, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508308521, "creation_date": 1508308521, "last_edit_date": 1531161705, "question_id": 46804094, "link": "https://stackoverflow.com/questions/46804094/multiple-ifisnumbersearch-for-excel-issue-if-text-sr-or-snr-exists-get-c", "title": "Multiple =if(isnumber(search))) for excel issue (If text SR or SNR exists, get cells AG, AG and AA)", "body": "<p>If SNR text exists it gets values of AD6.  If it doesn\u2019t exist it get values of AD6.</p>\n\n<p>If SR exists, it gets value of AA1</p>\n\n<p>I am able to get this working with <code>=IF(ISERR(SEARCH(\"SNR \",\" \" &amp; Sheet1!$D6&amp; \" \")),Sheet1!AD6,AD6)</code>\nHowever I cannot seem to include SR. </p>\n\n<pre><code>=IF(ISERR(SEARCH(\"SNR \",\" \" &amp; Sheet1!$D6&amp; \" \")),Sheet1!AD6,AD6) AND IF(ISERR(SEARCH(\"SR \",\" \" &amp; Sheet1!$D6&amp; \" \")),Sheet1!AA1,AA1) \n</code></pre>\n\n<p>Is there a way around this issue or is this a limitation of excel?<br>\nI have included an image to more accurately convey what I am saying.</p>\n\n<p><a href=\"https://i.stack.imgur.com/CDTQd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CDTQd.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1508308356, "post_id": 46803998, "comment_id": 80554843, "body": "check <a href=\"https://stackoverflow.com/a/26970322/7889129\">stackoverflow.com/a/26970322/7889129</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1508308423, "post_id": 46803998, "comment_id": 80554874, "body": "Did you try seeing what the macro recorder produced and then adapting?"}], "answers": [{"comments": [{"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1508309762, "post_id": 46804203, "comment_id": 80555535, "body": "Great it worked, but actually it does not print the results I want.. I tried to fix the formula of the column and the new formula that works is this one..              .CalculatedFields.Add &quot;Diff&quot;, &quot;=GETPIVOTDATA(&#39;Monthly $/SU Forecast&#39;,$A$15,&#39;T-Lane&#39;,&#39;Athens to GREECE&#39;)-GETPIVOTDATA(&#39;Monthly $/SU Actual&#39;,$A$15,&#39;T-Lane&#39;,&#39;Athens to GREECE&#39;)&quot; .PivotFields(&quot;Diff&quot;).Orientation = xlDataField"}, {"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1508309820, "post_id": 46804203, "comment_id": 80555559, "body": "However, this new formula has an error as it says Unable to set property"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1508311657, "post_id": 46804203, "comment_id": 80556536, "body": "Record macro while you create the calculated field manually and then analyze the code, that will give you an idea and then tweak it as per your requirement."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 2, "last_activity_date": 1508309015, "creation_date": 1508309015, "answer_id": 46804203, "question_id": 46803998, "link": "https://stackoverflow.com/questions/46803998/add-a-calculated-field-in-pivot-table/46804203#46804203", "title": "Add a calculated field in Pivot Table", "body": "<p>After adding the Calculated field, you need to set it's orientation to xlDataField to make it visible on the Pivot Table.</p>\n\n<p>Try something like this...</p>\n\n<pre><code>.CalculatedFields.Add \"Diff\", \"= 'Monthly Cost FCST'- 'Monthly Cost Actuals'\"\n.PivotFields(\"Diff\").Orientation = xlDataField\n</code></pre>\n"}], "owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 941, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508309015, "creation_date": 1508308027, "question_id": 46803998, "link": "https://stackoverflow.com/questions/46803998/add-a-calculated-field-in-pivot-table", "title": "Add a calculated field in Pivot Table", "body": "<p>I have created a pivot table and I want to add a column in it , in which it will print the difference (in value) between two other columns of the Pivot Table. I will provide the part of my code related to building the pivot table. As it is clear, I have tried something in the last part of it, but it wont print nothing. It runs but it just does not print anything . It only prints the Pivot Table correctly, but not the new column.</p>\n\n<pre><code>Dim DSheet As Worksheet\nDim PCache As PivotCache\nDim PTable As PivotTable\nDim PRange As Range\n\nApplication.DisplayAlerts = True\nSet DSheet = Worksheets(\"Budget_Report\")\n\nSet PRange = DSheet.Range(Cells(1, 27), Cells.SpecialCells(xlCellTypeLastCell))\n\nSet PCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=PRange)\nSet PTable = PCache.CreatePivotTable(TableDestination:=DSheet.Cells(15, 1), TableName:=\"PivotTable1\")\n\nWith ActiveSheet.PivotTables(\"PivotTable1\")\n With .PivotFields(\"T-Lane\")\n    .Orientation = xlRowField\n    .Position = 1\n    .Subtotals(1) = True\n    .Subtotals(1) = False\n End With\n\nWith .PivotFields(\"Monthly Cost FCST\")\n    .Orientation = xlDataField\n    .Position = 1\n    .Function = xlAverage\n    .NumberFormat = \"0.00\"\n    .Caption = \"Monthly Cost Forecast\"\nEnd With\n\nWith .PivotFields(\"Monthly Vol FCST\")\n    .Orientation = xlDataField\n    .Position = 2\n    .Function = xlAverage\n    .NumberFormat = \"0.00\"\n    .Caption = \"Monthly Vol Forecast\"\nEnd With\n\nWith .PivotFields(\"Monthly $/SU FCST\")\n    .Orientation = xlDataField\n    .Position = 3\n    .Function = xlAverage\n    .NumberFormat = \"0.00\"\n    .Caption = \"Monthly $/SU Forecast\"\nEnd With\n\nWith .PivotFields(\"Monthly Cost Actuals\")\n    .Orientation = xlDataField\n    .Position = 4\n    .Function = xlSum\n    .NumberFormat = \"0.00\"\n    .Caption = \"Monthly Cost Actual\"\nEnd With\n\nWith .PivotFields(\"Monthly Vol Actuals\")\n    .Orientation = xlDataField\n    .Position = 5\n    .Function = xlSum\n    .NumberFormat = \"0.00\"\n    .Caption = \"Monthly Vol Actual\"\nEnd With\n\nWith .PivotFields(\"Monthly $/SU Actuals\")\n    .Orientation = xlDataField\n    .Position = 6\n    .Function = xlAverage\n    .NumberFormat = \"0.00\"\n    .Caption = \"Monthly $/SU Actual\"\nEnd With\n\n    .CalculatedFields.Add \"Diff\", \"= 'Monthly Cost FCST'- 'Monthly Cost Actuals'\"\n\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1508312769, "post_id": 46805066, "comment_id": 80557191, "body": "Exactly!! (VBA) Macros cannot and should not be able to enable other macros. Yet, just to make your answer more complete you might want to add that you <b>can</b> generally trust all Excel files and open them with macros enabled. Of course, that should never be done and Microsoft also recommends not to do so. But maybe this is what the OP is looking for?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1508313311, "post_id": 46805066, "comment_id": 80557530, "body": "@Ralph I think he is not talking about himself having that issues but other users (3rd party users) to whom he shares his Excel file. So that would be only an option option for himself. Best practice here would be code signing."}, {"owner": {"reputation": 101, "user_id": 4241396, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000239705022/picture?type=large", "display_name": "Mamed Aliyev", "link": "https://stackoverflow.com/users/4241396/mamed-aliyev"}, "edited": false, "score": 0, "creation_date": 1508320813, "post_id": 46805066, "comment_id": 80562028, "body": "Thanks your replies"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 4, "last_activity_date": 1508312513, "creation_date": 1508312513, "answer_id": 46805066, "question_id": 46803791, "link": "https://stackoverflow.com/questions/46803791/use-macro-enabled-excel-file-in-onedrive/46805066#46805066", "title": "use macro enabled Excel file in OneDrive", "body": "<p>\"<em>Is it possible?</em>\"<br>\nNot really clear what you exactly mean by \"<em>use it on web (online)</em>\".<br>\nBut fact is you need Excel to open an Excel file and use macros. Therefore you cannot do this online, but the users need to (temporarily) download that file and open it locally then.</p>\n\n<p>\"<em>enable macros</em>\" and \"<em>enable editing</em>\"<br>\nThese messages are for security reason! So nobody can run evil code on your computer without permission.<br>\nThere is no way that <strong>you</strong> can enable macros at your users site.  But you can sign your code digitally with a certificate which \u2026</p>\n\n<ul>\n<li>\u2026 is generated by a trusted certificate authority (not free, need to pay).</li>\n<li>\u2026 is generated by yourself (free).<br>\nBut then your users need to trust that certificate once on their computer.</li>\n</ul>\n\n<p>If the macros are digitally signed and the certificate is trusted you won't get the message to enable the macros.</p>\n"}], "owner": {"reputation": 101, "user_id": 4241396, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000239705022/picture?type=large", "display_name": "Mamed Aliyev", "link": "https://stackoverflow.com/users/4241396/mamed-aliyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3972, "favorite_count": 1, "accepted_answer_id": 46805066, "answer_count": 1, "score": 1, "last_activity_date": 1508312513, "creation_date": 1508306899, "last_edit_date": 1508311172, "question_id": 46803791, "link": "https://stackoverflow.com/questions/46803791/use-macro-enabled-excel-file-in-onedrive", "title": "use macro enabled Excel file in OneDrive", "body": "<p>I've created login_form that appears before worksheet and gets data (username or code) from login_form then filters inside Excel. Now I want to use this Excel file (.xlsm ) in OneDrive, that login_form will appear and users can use it on web (online). Is it possible? </p>\n\n<p>And when users open this file in local, asks \"enable macros\" and \"enable editing\". Is there function that VBA automatically enables macros and editing in this file? Thanks in advance</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508302910, "post_id": 46803104, "comment_id": 80552805, "body": "you are missing the <code>if</code> command line  ... the code that you posted cannot possibly be <code>code to reach the objects</code>"}, {"owner": {"reputation": 23, "user_id": 8699059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbd0285f43d8288cc2efc5690f777da?s=128&d=identicon&r=PG&f=1", "display_name": "bbb android", "link": "https://stackoverflow.com/users/8699059/bbb-android"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508303036, "post_id": 46803104, "comment_id": 80552846, "body": "ok <code>endif</code> deleted i can get object names i will edit the question"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508303654, "post_id": 46803104, "comment_id": 80553024, "body": "what is the file extension of the word doc file? how many files are you processing?"}, {"owner": {"reputation": 23, "user_id": 8699059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbd0285f43d8288cc2efc5690f777da?s=128&d=identicon&r=PG&f=1", "display_name": "bbb android", "link": "https://stackoverflow.com/users/8699059/bbb-android"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508303958, "post_id": 46803104, "comment_id": 80553129, "body": "Word file extension is .doc, i have nearly 20 word files to process and all of them have only 1 PDF embedded file."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508304318, "post_id": 46803104, "comment_id": 80553246, "body": "this may work ... open doc with 7-zip and navigate to word\\media folder ... if you do not have 7-zip then add <code>.zip</code> to the filename  <code>myDoc.docm.zip</code>, then open with windows explorer"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508304700, "post_id": 46803104, "comment_id": 80553385, "body": "double clicking the acrobat object in the word document opens it in acrobat viewer, then you can save it .... i am still checking for VBA code that would do the job"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1508305811, "post_id": 46803104, "comment_id": 80553807, "body": ".doc file format is not a zip archive: save as docx first..."}, {"owner": {"reputation": 23, "user_id": 8699059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbd0285f43d8288cc2efc5690f777da?s=128&d=identicon&r=PG&f=1", "display_name": "bbb android", "link": "https://stackoverflow.com/users/8699059/bbb-android"}, "edited": false, "score": 0, "creation_date": 1508306711, "post_id": 46803104, "comment_id": 80554166, "body": "Thanks for ideas, I have found a solution for Excel and edited my question further to adapt this to Word."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8699059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbd0285f43d8288cc2efc5690f777da?s=128&d=identicon&r=PG&f=1", "display_name": "bbb android", "link": "https://stackoverflow.com/users/8699059/bbb-android"}, "edited": false, "score": 0, "creation_date": 1508306533, "post_id": 46803593, "comment_id": 80554074, "body": "Thanks but what i require is to run a macro (from Excel or Word doesn&#39;t matter) and save the embedded attachments in the Word file by this macro without user interference, i have edited my question further to show where i got stuck."}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1508305865, "creation_date": 1508305865, "answer_id": 46803593, "question_id": 46803104, "link": "https://stackoverflow.com/questions/46803104/save-embedded-pdfs-in-word-file/46803593#46803593", "title": "Save embedded PDFs in Word file", "body": "<p>try this </p>\n\n<p>it does not save the pdf file but it opens it in acrobat so that you can save it</p>\n\n<pre><code>Sub pdfExtract()\n\n    ' opens embedded pdf file in acrobat reader for saving\n\n    Dim shap As InlineShape\n\n    For Each shap In ActiveDocument.InlineShapes\n        If Not shap.OLEFormat Is Nothing Then\n            If shap.OLEFormat.ClassType = \"AcroExch.Document.DC\" Then\n                shap.OLEFormat.DoVerb wdOLEVerbOpen\n            End If\n        End If\n    Next shap\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8699059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbd0285f43d8288cc2efc5690f777da?s=128&d=identicon&r=PG&f=1", "display_name": "bbb android", "link": "https://stackoverflow.com/users/8699059/bbb-android"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 738, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1508353392, "creation_date": 1508302755, "last_edit_date": 1508353392, "question_id": 46803104, "link": "https://stackoverflow.com/questions/46803104/save-embedded-pdfs-in-word-file", "title": "Save embedded PDFs in Word file", "body": "<p>I need a VBA macro for MS Word 2013 to save the embedded PDF attachments in the Word file into a folder.</p>\n\n<p>I found a working solution in Excel which saves embedded files in the Excel document, I have made some modifications to work in Word VBA, but it doesn't work any ideas to make it work in Word ?</p>\n\n<pre><code>Private Declare PtrSafe Function CloseClipboard Lib \"user32\" () As Long\nPrivate Declare PtrSafe Function GlobalLock Lib \"kernel32\" (ByVal hMem As Long) As Long\nPrivate Declare PtrSafe Function GlobalSize Lib \"kernel32\" (ByVal hMem As Long) As Long\nPrivate Declare PtrSafe Function OpenClipboard Lib \"user32\" (ByVal hWnd As Long) As Long\nPrivate Declare PtrSafe Function GlobalUnlock Lib \"kernel32\" (ByVal hMem As Long) As Long\nPrivate Declare PtrSafe Function GetClipboardData Lib \"user32\" (ByVal wFormat As Long) As Long\nPrivate Declare PtrSafe Sub RtlMoveMemory Lib \"kernel32\" (Destination As Any, Source As Any, ByVal Length As Long)\n\nSub Embed_Files_Save_PDF_Run()\nFor Each file In ThisDocument.InlineShapes\nCall Embed_Files_Save_PDF(file)\nNext\nEnd Sub\n\nSub Embed_Files_Save_PDF(ByVal Embedded_PDF)\n\n      On Error Resume Next\n\n      Dim PDF_Path As String\n      PDF_Path = ActiveDocument.Path\n\n      If Right$(PDF_Path, 1) &lt;&gt; Application.PathSeparator Then PDF_Path = PDF_Path &amp; Application.PathSeparator\n\n      Dim PDF_Name As String\n      PDF_Name = UCase$(Left$(Embedded_PDF.OLEFormat.IconLabel, 1)) &amp; Mid$(Embedded_PDF.OLEFormat.IconLabel, 2)    \n      PDF_Name = PDF_Name &amp; \".PDF\"\n\n      Dim FileEOF As Long\n      Dim FileLOF As Long\n      Dim CB_Lock As Long           ' ClipBoard Lock\n      Dim CB_Size As Long           ' ClibBoard Size\n      Dim PDF_File() As Byte\n      Dim Temp_PDF() As Byte\n\n      Embedded_PDF.Copy\n      If OpenClipboard(0) Then\n            Counter = GetClipboardData(49156)\n            If Counter &lt;&gt; 0 Then CB_Size = GlobalSize(Counter)\n            If CB_Size &lt;&gt; 0 Then CB_Lock = GlobalLock(Counter)\n            If CB_Lock &lt;&gt; 0 Then\n                  ReDim Temp_PDF(1 To CLng(CB_Size))\n                  RtlMoveMemory Temp_PDF(1), ByVal CB_Lock, CB_Size\n                  Call GlobalUnlock(Counter)\n                  Counter = InStrB(Temp_PDF, StrConv(\"%PDF\", vbFromUnicode))\n                  If Counter &gt; 0 Then\n                        FileEOF = InStrB(Counter, Temp_PDF, StrConv(\"%%EOF\", vbFromUnicode))\n                        While FileEOF\n                              FileLOF = FileEOF - Counter + 7\n                              FileEOF = InStrB(FileEOF + 5, Temp_PDF, StrConv(\"%%EOF\", vbFromUnicode))\n                        Wend\n\n                        ReDim PDF_File(1 To FileLOF)\n                        For FileEOF = 1 To FileLOF\n                              PDF_File(FileEOF) = Temp_PDF(Counter + FileEOF - 1)\n                        Next\n                  End If\n            End If\n            CloseClipboard\n            If Counter &gt; 0 Then\n                  Counter = FreeFile\n                  Open PDF_Path &amp; PDF_Name For Binary As #Counter\n                        Put #Counter, 1, PDF_File\n                  Close #Counter\n            End If\n      End If\n\n      Set Embedded_PDF = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1508302564, "post_id": 46802641, "comment_id": 80552709, "body": "to copy range A:H, you can use <code>intersect(xRg(K).EntireRow, Range(&quot;A:H&quot;)).Copy ...</code>"}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1508302796, "post_id": 46802641, "comment_id": 80552774, "body": "i&#39;m sorry i don&#39;t get you, is the &#39;store&#39; / &#39;log&#39; sheet has a list table in it, and the data does not goes into the table? List table i mean the one we insert through the INSERT menu followed by Table under the Tables group."}, {"owner": {"reputation": 13, "user_id": 8793413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0591072ee945cab5055198438adbe126?s=128&d=identicon&r=PG&f=1", "display_name": "Straarup", "link": "https://stackoverflow.com/users/8793413/straarup"}, "reply_to_user": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1508303376, "post_id": 46802641, "comment_id": 80552946, "body": "Thank you for your reply!  The &quot;Print&quot; sheet is a table, where I can sort on &quot;Date&quot; - When I copy the rows to the next sheet (Store), I would like to be able to sort on the date as well since I want those rows with the next due date to be on top.   I Hope this makes it more clear"}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1508304382, "post_id": 46802641, "comment_id": 80553271, "body": "np... Is it possible to make a screen shot of how &#39;store&#39; / &#39;log&#39; sheet looks like after you ran the macro? so we can have better idea whats going on?"}, {"owner": {"reputation": 13, "user_id": 8793413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0591072ee945cab5055198438adbe126?s=128&d=identicon&r=PG&f=1", "display_name": "Straarup", "link": "https://stackoverflow.com/users/8793413/straarup"}, "reply_to_user": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1508314936, "post_id": 46802641, "comment_id": 80558436, "body": "<a href=\"http://imageshack.com/a/img922/9446/gpL9Ov.png\" rel=\"nofollow noreferrer\">imageshack.com/a/img922/9446/gpL9Ov.png</a>"}, {"owner": {"reputation": 13, "user_id": 8793413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0591072ee945cab5055198438adbe126?s=128&d=identicon&r=PG&f=1", "display_name": "Straarup", "link": "https://stackoverflow.com/users/8793413/straarup"}, "reply_to_user": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1508314997, "post_id": 46802641, "comment_id": 80558469, "body": "I have uploaded a screenshot that shows what the &quot;Store&quot; looks like after I have run the macro.   Thank you for your time"}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1508322181, "post_id": 46802641, "comment_id": 80562842, "body": "great! it looks like you have a list table"}], "answers": [{"tags": [], "owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "is_accepted": true, "score": 0, "last_activity_date": 1508322156, "creation_date": 1508322156, "answer_id": 46807935, "question_id": 46802641, "link": "https://stackoverflow.com/questions/46802641/excel-copying-rows-to-table-in-another-sheet-using-vba/46807935#46807935", "title": "Excel: Copying rows to table in another sheet using VBA", "body": "<p>Since you have a list object table, it would be much easier.</p>\n\n<p>To copy from A:H columns of the row only, use <code>Intersect()</code> to crop for A:H column.</p>\n\n<p>Then to copy into a list object table, set the destination to a new <em>list row</em>:</p>\n\n<pre><code>Intersect(xRg(K).EntireRow, Range(\"A:H\")).Copy _\n    Destination:=range(\"Table1\").ListObject.ListRows.Add.Range\n</code></pre>\n\n<p>The table name can be found below, which is defaulted to Table#:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SG3B3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SG3B3.png\" alt=\"Menu\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/byONG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/byONG.png\" alt=\"table name\"></a> </p>\n"}], "owner": {"reputation": 13, "user_id": 8793413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0591072ee945cab5055198438adbe126?s=128&d=identicon&r=PG&f=1", "display_name": "Straarup", "link": "https://stackoverflow.com/users/8793413/straarup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2338, "favorite_count": 0, "accepted_answer_id": 46807935, "answer_count": 1, "score": 1, "last_activity_date": 1508323332, "creation_date": 1508299643, "last_edit_date": 1531161705, "question_id": 46802641, "link": "https://stackoverflow.com/questions/46802641/excel-copying-rows-to-table-in-another-sheet-using-vba", "title": "Excel: Copying rows to table in another sheet using VBA", "body": "<p>I'm currently working on a spreadsheet in Excel. </p>\n\n<p>My aim is to create a VBA that copies rows with specific criteria to the next sheet in my workbook and to a \"log sheet\". </p>\n\n<p>My VBA looks like this: </p>\n\n<pre><code>Sub ImportRows()\n\n    Dim xRg As Range\n    Dim xCell As Range\n    Dim I As Long\n    Dim J As Long\n    Dim K As Long\n    I = Worksheets(\"Print\").UsedRange.Rows.Count\n    J = Worksheets(\"Store\").UsedRange.Rows.Count\n    If J = 1 Then\n       If Application.WorksheetFunction.CountA(Worksheets(\"Store\").UsedRange) = 0 Then J = 0\n    End If\n    Set xRg = Worksheets(\"Print\").Range(\"I2:I\" &amp; I)\n    On Error Resume Next\n    Application.ScreenUpdating = False\n    For K = 1 To xRg.Count\n        If CStr(xRg(K).Value) = \"Print\" Then\n\n            xRg(K).EntireRow.Copy Destination:=Worksheets(\"Store\").Range(\"A\" &amp; J +1) \n            xRg(K).EntireRow.Copy Destination:=Worksheets(\"Log\").Range(\"A\" &amp; J +1) \n            xRg(K).EntireRow.Delete\n            If CStr(xRg(K).Value) = \"Print\" Then\n                K = K - 1\n            End If\n            J = J + 1\n        End If\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>The problem is when I am copying from Sheet1 called Print the data is in a table, but when I copy into the next sheet called \"store\" (or Log) - The data doesn't go into to table but appears in the first row beneath the table making it impossible to sort the data. </p>\n\n<p>Any suggestions on how to fix this? I think, that it might have something to do with the destination range, but I'm not sure. </p>\n\n<hr>\n\n<p>I'm also struggling with the amount of data that I'm copying - When copying from \"Print\" to \"store\" I only wish to copy cell \"A:H\" and not \"EntireRow\". </p>\n\n<hr>\n\n<p>I'm fairly new to Excel! I appreciate any help! </p>\n\n<p>Thank you!  </p>\n\n<hr>\n\n<p>I have uploaded a screenshot that shows what the \"Store\" looks like after I have run the macro.</p>\n\n<p><a href=\"https://i.stack.imgur.com/oDN1K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oDN1K.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"http://imageshack.com/a/img922/9446/gpL9Ov.png\" rel=\"nofollow noreferrer\">http://imageshack.com/a/img922/9446/gpL9Ov.png</a> </p>\n"}, {"tags": ["vba", "loops", "msgbox"], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 2, "last_activity_date": 1510479344, "last_edit_date": 1510479344, "creation_date": 1508300729, "answer_id": 46802800, "question_id": 46802500, "link": "https://stackoverflow.com/questions/46802500/loop-result-post-msgbox-new-line/46802800#46802800", "title": "Loop result post Msgbox new line", "body": "<p>You need to persist the old value of <code>txt</code>.</p>\n\n<pre><code>txt = txt &amp; \"Duplicates found for\" &amp; \" \" &amp; ws.Range(\"A\" &amp; i).Value &amp; \" \" &amp; \"in\" &amp; ws.Range(\"L\" &amp; i).Value &amp; vbNewLine\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8657373, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/cdae75dd45464ac646931b3e6abb7dc5?s=128&d=identicon&r=PG&f=1", "display_name": "L.Frederiksen", "link": "https://stackoverflow.com/users/8657373/l-frederiksen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 505, "favorite_count": 0, "accepted_answer_id": 46802800, "answer_count": 1, "score": 0, "last_activity_date": 1510479344, "creation_date": 1508298640, "last_edit_date": 1508363681, "question_id": 46802500, "link": "https://stackoverflow.com/questions/46802500/loop-result-post-msgbox-new-line", "title": "Loop result post Msgbox new line", "body": "<p>I have a loop looking for text in a column (that is working) and I want to post the result in a MsgBox, but when I use the msgbox in or outside the loop I will get a msgbox for every result found or only one msgbox with one result. What I would like is to make it post every result in 1 msgbox with a line break after each result.</p>\n\n<p>I know the first code is not the prettiest or best way to go around finding duplicates and I should use an array for it, but it's the only way I got it to work. </p>\n\n<p>The first code finding duplicates (not relevant for the question):</p>\n\n<pre><code>Dim lastRow As Long\nDim i As Long\nDim ws As Worksheet\nDim txt As String\nSet ws = Sheets(\"Player List\")\nDim matchFoundIndex As Long\nDim iCntr As Long\n\nlastRow = Range(\"A201\").End(xlUp).Row\nFor iCntr = 1 To lastRow\n    If Cells(iCntr, 1) &lt;&gt; \"\" Then\n        matchFoundIndex = WorksheetFunction.Match(Cells(iCntr, 1), Range(\"A1:A\" &amp; \n        lastRow), 0)\n        If iCntr &lt;&gt; matchFoundIndex Then\n            Cells(iCntr, 2) = \"Duplicate\"\n        End If\n    End If\nNext\n</code></pre>\n\n<p>The loop with the msgbox:</p>\n\n<pre><code>For i = 2 To 201\n    If ws.Range(\"B\" &amp; i).Value = \"Duplicate\" Then\n        txt = \"Duplicates found for\" + \" \" + ws.Range(\"A\" &amp; i).Value + \" \" + \"in\" + \n            ws.Range(\"L\" &amp; i).Value + vbNewLine\n        End If\n    Next i\nMsgBox txt\n</code></pre>\n"}, {"tags": ["vba", "vb6"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508303342, "post_id": 46802381, "comment_id": 80552935, "body": "what will happen if a cell has a space in its text?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1508397174, "post_id": 46802381, "comment_id": 80596282, "body": "Your file is specifically <i>not</i> csv. If you want a csv, save the data with separators to begin with, as opposed to fixed-width columns. If you want to keep fixed width columns and still open the file in Excel, see <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbooks-opentext-method-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>."}, {"owner": {"reputation": 9, "user_id": 8793422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ae85a23bdda45160e2c943193c9900?s=128&d=identicon&r=PG&f=1", "display_name": "sopian", "link": "https://stackoverflow.com/users/8793422/sopian"}, "edited": false, "score": 0, "creation_date": 1508474337, "post_id": 46802381, "comment_id": 80632577, "body": "jsotola, the result will be (10/13/17 04:48PM  E344   T10203 25596595                 00:01&#39;33) in column A, like first picture"}], "answers": [{"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1508303254, "creation_date": 1508303254, "answer_id": 46803182, "question_id": 46802381, "link": "https://stackoverflow.com/questions/46802381/need-help-in-vb6-save-textbox-as-csv-but-all-a-column-want-delimited-space/46803182#46803182", "title": "need help in Vb6 save textbox as .csv, but all A column want delimited space", "body": "<p>this may work</p>\n\n<p>found here <a href=\"https://support.office.com/en-us/article/Import-or-export-text-txt-or-csv-files-5250ac4c-663c-47ce-937b-339e391393ba\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/Import-or-export-text-txt-or-csv-files-5250ac4c-663c-47ce-937b-339e391393ba</a></p>\n\n<p>Change the separator in all .csv text files</p>\n\n<p>In Microsoft Windows, click the <strong>Start button</strong>, and then click <strong>Control Panel</strong>.</p>\n\n<p>Open the dialog box for changing <strong>Regional and Language settings</strong>.</p>\n\n<p>Type a new separator in the <strong>List separator box</strong>.</p>\n\n<p>Click OK twice.</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 8793422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ae85a23bdda45160e2c943193c9900?s=128&d=identicon&r=PG&f=1", "display_name": "sopian", "link": "https://stackoverflow.com/users/8793422/sopian"}, "edited": false, "score": 0, "creation_date": 1508381111, "post_id": 46811466, "comment_id": 80591610, "body": "Hrqls, i need vb6 code for automatically save just like you explain above"}, {"owner": {"reputation": 2819, "user_id": 1584106, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ex2I0.jpg?s=128&g=1", "display_name": "Hrqls", "link": "https://stackoverflow.com/users/1584106/hrqls"}, "edited": false, "score": 0, "creation_date": 1508407030, "post_id": 46811466, "comment_id": 80601924, "body": "the code you showed in your post should work ... what does it show when you open the file in notepad?"}], "tags": [], "owner": {"reputation": 2819, "user_id": 1584106, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ex2I0.jpg?s=128&g=1", "display_name": "Hrqls", "link": "https://stackoverflow.com/users/1584106/hrqls"}, "is_accepted": false, "score": 1, "last_activity_date": 1508333628, "creation_date": 1508333628, "answer_id": 46811466, "question_id": 46802381, "link": "https://stackoverflow.com/questions/46802381/need-help-in-vb6-save-textbox-as-csv-but-all-a-column-want-delimited-space/46811466#46811466", "title": "need help in Vb6 save textbox as .csv, but all A column want delimited space", "body": "<p>I assume your csv file has a comma as separation between the columns?\nSo a line in the file actually looks like:</p>\n\n<pre><code>10/13/17,04:48PM,E344,T10203,25596595,00:01'33\n</code></pre>\n\n<p>If the file looks like that, then it is a csv (comma separated values) file.</p>\n\n<p>If you open the csv file directly from Windows and chose Excel as the program to open it with, then Excel won't process it as an csv file but just as a plain text file.</p>\n\n<p>To open a csv file in Excel you first need to start Excel, then then open the csv file from within Excel. It will then ask you how to handle the file:</p>\n\n<p><a href=\"https://i.stack.imgur.com/202z8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/202z8.png\" alt=\"Excel csv import (1)\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/LxYPy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LxYPy.png\" alt=\"Excel csv import (2)\"></a></p>\n\n<p>The language in the screenshots is dutch, but I guess the layout will be similar in your local version.</p>\n\n<p>The name of my test file was <code>tmp.txt</code></p>\n"}], "owner": {"reputation": 9, "user_id": 8793422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ae85a23bdda45160e2c943193c9900?s=128&d=identicon&r=PG&f=1", "display_name": "sopian", "link": "https://stackoverflow.com/users/8793422/sopian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1508402717, "creation_date": 1508297796, "last_edit_date": 1508398884, "question_id": 46802381, "link": "https://stackoverflow.com/questions/46802381/need-help-in-vb6-save-textbox-as-csv-but-all-a-column-want-delimited-space", "title": "need help in Vb6 save textbox as .csv, but all A column want delimited space", "body": "<p>need help, in Vb6 save textbox as .csv, but all A column want delimited space </p>\n\n<p>hai, i have problem when save textbox as .csv with vb6 code, i cant find any code to automatically save as delimited space, so all word become column separately</p>\n\n<p>here, my code in VB6 like this</p>\n\n<pre><code>Private Sub Command1_Click()\nDim mytxt As String\nmytxt = Text1.Text\nOpen \"C:\\Documents and Settings\\user\\Desktop\\history.csv\" For Append As #1\nPrint #1, mytxt\nClose #1\nEnd Sub\n</code></pre>\n\n<p>here, my save in history.csv, output like this </p>\n\n<pre><code>(10/13/17 04:48PM  E344   T10203 25596595                 00:01'33)\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/KyQRj.jpg\" alt=\"enter image description here\"></p>\n\n<p>this all text in A column, </p>\n\n<p>i want automatically save history.csv output in Vb6, like this</p>\n\n<pre><code>10/13/17(in A Column)\n04:48PM(in B Column)\nE344(in C Column)\nT10105(in D Column)\n25596595(in E Column)\n00:01'33(in F Column)\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/9lyO2.jpg\" alt=\"enter image description here\">\n    delimited space, until unlimited row\nplease help me, this Vb6 code problem</p>\n"}]