[{"tags": ["excel", "vba", "excel-2010"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1556754813, "post_id": 55943863, "comment_id": 98541083, "body": "If you&#39;re planning on publishing as PDF from Excel, you do know that the &quot;supressed&quot; values are still exported, and can easily be revealed?  Just checking."}, {"owner": {"reputation": 9, "user_id": 7614287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f2cd44b0aa72b70d980be9c02165cd?s=128&d=identicon&r=PG&f=1", "display_name": "doctorjay", "link": "https://stackoverflow.com/users/7614287/doctorjay"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556840349, "post_id": 55943863, "comment_id": 98574450, "body": "@TimWilliams I feel like a total idiot, but I did <i>not</i> realize that! It&#39;s been standard practice where I work for ages. Yikes! I&#39;m going to have to find some other workaround. Hmmm... Thank you soooooo much!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556842871, "post_id": 55943863, "comment_id": 98574914, "body": "You can make a temporary copy of the file and have your macro actually <i>clear</i> the values (or set to e.g. &quot;redacted&quot;)  instead of setting the font color."}, {"owner": {"reputation": 9, "user_id": 7614287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f2cd44b0aa72b70d980be9c02165cd?s=128&d=identicon&r=PG&f=1", "display_name": "doctorjay", "link": "https://stackoverflow.com/users/7614287/doctorjay"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556911749, "post_id": 55943863, "comment_id": 98602668, "body": "@TimWilliams - Yes! Thank you! That&#39;s what I would actually prefer to do! How do I go about doing that? Sorry. I&#39;m a whiz at SAS and Stata, but a real idiot when it comes to VBA. I&#39;m guessing it has something to do with ClearContents, but I&#39;m not sure where to put that statement."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7614287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f2cd44b0aa72b70d980be9c02165cd?s=128&d=identicon&r=PG&f=1", "display_name": "doctorjay", "link": "https://stackoverflow.com/users/7614287/doctorjay"}, "edited": false, "score": 0, "creation_date": 1556840114, "post_id": 55944028, "comment_id": 98574409, "body": "Thank you so much! I&#39;&#39;m familiar with <code>for each</code> loops in other software, so this make a lot of sense to me!"}], "tags": [], "owner": {"reputation": 663, "user_id": 7131122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VRUK1MTcgY4/AAAAAAAAAAI/AAAAAAAAA_8/VlNsZARthCY/photo.jpg?sz=128", "display_name": "Christofer Weber", "link": "https://stackoverflow.com/users/7131122/christofer-weber"}, "is_accepted": false, "score": 0, "last_activity_date": 1556754881, "last_edit_date": 1556754881, "creation_date": 1556754482, "answer_id": 55944028, "question_id": 55943863, "link": "https://stackoverflow.com/questions/55943863/vba-code-to-change-font-color-for-3-columns-based-on-the-value-of-1-column-mult/55944028#55944028", "title": "VBA code to change font color for 3 columns based on the value of 1 column (multiple tables)", "body": "<p>Are they always in Column \"<code>C</code>\"? If not, you have to check that kind of stuff as well.<br>\nDoes it always start at row 10?<br>\nAs far as just looping through the sheets and values, if you want simple, this is about as simple as it gets:</p>\n\n<pre><code>Sub whiteout()\nDim c As Range, ws As Worksheet\nFor Each ws In ThisWorkbook.Worksheets\n    For Each c In Range(ws.Range(\"C10\"), ws.Range(\"C65000\").End(xlUp))\n        If c.Value &lt; 10 Then c.Font.Color = vbWhite\n    Next c\nNext ws\nEnd Sub\n</code></pre>\n\n<p><code>For each</code> loops are pretty intuitive, but be aware that accessing and changing things like this in a loop can be pretty slow on a major scale.</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 7614287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f2cd44b0aa72b70d980be9c02165cd?s=128&d=identicon&r=PG&f=1", "display_name": "doctorjay", "link": "https://stackoverflow.com/users/7614287/doctorjay"}, "edited": false, "score": 0, "creation_date": 1556840267, "post_id": 55944105, "comment_id": 98574434, "body": "Fantastic! Thank you so much! This worked perfectly! If you have a moment, would you mind explaining the role of <code>Next</code>? If not, no worries. I can always Google it. Thanks again!"}, {"owner": {"reputation": 447, "user_id": 7806215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tbOrO.jpg?s=128&g=1", "display_name": "francovici", "link": "https://stackoverflow.com/users/7806215/francovici"}, "reply_to_user": {"reputation": 9, "user_id": 7614287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f2cd44b0aa72b70d980be9c02165cd?s=128&d=identicon&r=PG&f=1", "display_name": "doctorjay", "link": "https://stackoverflow.com/users/7614287/doctorjay"}, "edited": false, "score": 0, "creation_date": 1556841277, "post_id": 55944105, "comment_id": 98574626, "body": "Sure ! <code>Next</code> is used to increment the counter that is carrying on the For Loop. If your counter was a variable named <b>i</b> you could write the For loop like this : <code>For i = 0 To 10     &#39;Do stuff  Next i </code>. That would be the explicit way to tell Visual Basic to add 1 to the counter. In my code (<b>For Each</b> loops), there are no explicit counters, but internally, VB understands that at the ocurrence of the <b>Next</b> word is where it should increment its internal counter for processing the next item on the list."}, {"owner": {"reputation": 9, "user_id": 7614287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f2cd44b0aa72b70d980be9c02165cd?s=128&d=identicon&r=PG&f=1", "display_name": "doctorjay", "link": "https://stackoverflow.com/users/7614287/doctorjay"}, "edited": false, "score": 0, "creation_date": 1556912316, "post_id": 55944105, "comment_id": 98602891, "body": "Oh! That totally makes sense! Thank you so much for your help and for the new knowledge!"}], "tags": [], "owner": {"reputation": 447, "user_id": 7806215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tbOrO.jpg?s=128&g=1", "display_name": "francovici", "link": "https://stackoverflow.com/users/7806215/francovici"}, "is_accepted": false, "score": 0, "last_activity_date": 1556755206, "creation_date": 1556755206, "answer_id": 55944105, "question_id": 55943863, "link": "https://stackoverflow.com/questions/55943863/vba-code-to-change-font-color-for-3-columns-based-on-the-value-of-1-column-mult/55944105#55944105", "title": "VBA code to change font color for 3 columns based on the value of 1 column (multiple tables)", "body": "<p>doctorjay.</p>\n\n<p>I worked on a dummy table of my own, based loosely on your dataset.</p>\n\n<p>I would use a macro like this one:</p>\n\n<pre><code>Sub clean_lower_than_10()\nDim Sheet As Worksheet\n\n\nFor Each Sheet In ActiveWorkbook.Sheets\n    For Each Row In Sheet.UsedRange.Rows\n            'Columns where the frequency and percentage are: C,D -&gt; 3,4\n            For Each Cell In Row.Cells\n                'Inside this condition, you should change the numbers for the column number that corresponds to the ones on your tables.\n                If Cell.Column = 3 Or Cell.Column = 4 Then\n                    If Cell.Value &lt; 10 Then\n                        Cell.Font.ColorIndex = 2\n                    End If\n                End If\n            Next\n        Next\nNext\n\n\nEnd Sub\n</code></pre>\n\n<p>The colorIndex = 2 means white color for the cell font.</p>\n\n<p>This solution assumes that your percentage and frequency values are always on the same columns on every sheet. </p>\n\n<p>If this is not the case, you'll have to work on the code to make it work, but it think this will be a good startpoint.</p>\n\n<p>My table before executing macro:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pwjIa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pwjIa.png\" alt=\"Before executing macro\"></a></p>\n\n<p>My table after executing macro:</p>\n\n<p><a href=\"https://i.stack.imgur.com/e72w7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e72w7.png\" alt=\"After executing macro\"></a></p>\n\n<p>Notice that the value remains intact, but the font color has changed to white. </p>\n\n<p>Hope it helps</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 7614287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f2cd44b0aa72b70d980be9c02165cd?s=128&d=identicon&r=PG&f=1", "display_name": "doctorjay", "link": "https://stackoverflow.com/users/7614287/doctorjay"}, "edited": false, "score": 0, "creation_date": 1557261319, "post_id": 55978043, "comment_id": 98703827, "body": "Oh! Thank you soooo much! I found <code>clearcontents</code>, but just wasn&#39;t sure where to put it in my macro. I&#39;ve been trying to teach myself by recording a macro and making sense of it, but I couldn&#39;t do that step manually. You (and the other responders) are pure gold! Thank you!!!!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1556924797, "creation_date": 1556924797, "answer_id": 55978043, "question_id": 55943863, "link": "https://stackoverflow.com/questions/55943863/vba-code-to-change-font-color-for-3-columns-based-on-the-value-of-1-column-mult/55978043#55978043", "title": "VBA code to change font color for 3 columns based on the value of 1 column (multiple tables)", "body": "<p>Answering side-question about creating a temporary copy for export:</p>\n\n<pre><code>Sub CreateExportCopy()\n\n    Dim wb As Workbook, wbExport As Workbook, newPath As String\n\n    Set wb = Workbooks(\"DataTables.xlsx\") '&lt;&lt; your (open) data file\n\n    newPath = wb.Path &amp; \"\\ForPDF_\" &amp; wb.Name\n\n    'this will create a copy of the workbook in the same location,\n    '  with the name prepended by \"ForPFDF_\"\n    wb.SaveCopyAs newPath\n\n    'open the copy\n    Set wbExport = Workbooks.Open(newPath)\n\n    'follow one of the other answers here to process the\n    '  tables in wbExport, but use (eg)\n    '     c.ClearContents\n    '  instead of\n    '     c.Font.Color = vbWhite\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7614287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1f2cd44b0aa72b70d980be9c02165cd?s=128&d=identicon&r=PG&f=1", "display_name": "doctorjay", "link": "https://stackoverflow.com/users/7614287/doctorjay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 582, "favorite_count": 0, "accepted_answer_id": 55978043, "answer_count": 3, "score": -1, "last_activity_date": 1556924797, "creation_date": 1556752736, "question_id": 55943863, "link": "https://stackoverflow.com/questions/55943863/vba-code-to-change-font-color-for-3-columns-based-on-the-value-of-1-column-mult", "title": "VBA code to change font color for 3 columns based on the value of 1 column (multiple tables)", "body": "<p><strong>The situation:</strong></p>\n\n<p>I have about 2,600 tables in one .xlsx workbook, one table per tab. They're to be published online as PDFs but, first, I need to suppress frequencies and percentages in rows with frequencies smaller than 10. Mask formatting doesn't work with the crosslist option in SAS 9.3. So, I think the most efficient way is to change the font color in the appropriate cells to white. Unfortunately, conditional formatting doesn't work when you select multiple tabs. Using VBA seems like the best option, but I know very little about it.</p>\n\n<p>Here's an example of the tables (I've hidden the rows for grades 4-7 for brevity):</p>\n\n<p><a href=\"https://i.stack.imgur.com/YzSMv.png\" rel=\"nofollow noreferrer\">Example: Original Table</a></p>\n\n<p><strong>The Goal:</strong></p>\n\n<p>Change the color of the font in cells with calculated values to white to mimic suppression. For example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EvxTm.png\" rel=\"nofollow noreferrer\">Example: \"Suppressed\" Table</a></p>\n\n<p>Can anyone please point me in the right direction? I feel like this should be pretty straightforward but, every time I think that, it's the exact opposite. I saw a few similar questions, but none with answers that looked relevant to my issue.</p>\n\n<p>Many thanks!!!!</p>\n"}, {"tags": ["vba", "ms-access", "sharepoint"], "comments": [{"owner": {"reputation": 1988, "user_id": 2847946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5SuY2.jpg?s=128&g=1", "display_name": "Mark Moretto", "link": "https://stackoverflow.com/users/2847946/mark-moretto"}, "edited": false, "score": 0, "creation_date": 1556752878, "post_id": 55943633, "comment_id": 98540737, "body": "Will this help? <a href=\"https://bytes.com/topic/access/answers/961807-vba-auto-refresh-linked-table-manager-linked-tables\" rel=\"nofollow noreferrer\">bytes.com/topic/access/answers/&hellip;</a>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1556767314, "post_id": 55943633, "comment_id": 98543199, "body": "None that I know of. Links are live connections. Why would you need to &#39;refresh&#39; table?"}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556773705, "post_id": 55943633, "comment_id": 98544496, "body": "You can hide MS Access tables interface from user, and provide him with own linked table update form with corresponding VBA actions"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 11820228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d71c3fcb38f2720fff218aee7c94e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11820228/kiran"}, "is_accepted": false, "score": 0, "last_activity_date": 1581254152, "creation_date": 1581254152, "answer_id": 60137022, "question_id": 55943633, "link": "https://stackoverflow.com/questions/55943633/ms-access-detect-when-refreshing-a-linked-table/60137022#60137022", "title": "MS Access Detect when Refreshing a Linked Table", "body": "<p>AFAIK, there is no event for handling the tdf.RefreshLink method. You can refresh all table links with code like this:</p>\n\n<pre><code>Public Sub Refresh_Linked_Tables()\n\n    Dim mdb As Access.Application\n\n    Dim db As DAO.Database\n    Dim tdf As DAO.TableDef\n\n        Set mdb = Access.Application\n        Set db = mdb.CurrentDb\n\n        For Each tdf In db.TableDefs\n            If LCase(Left(tdf.Name, 4)) &lt;&gt; \"msys\" Then\n                If Len(tdf.Connect) &gt; 0 Then\n                    tdf.RefreshLink\n                End If\n            End If\n        Next tdf\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 10002608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25dbe43ef913ba476750014aee99f86f?s=128&d=identicon&r=PG&f=1", "display_name": "Stigma", "link": "https://stackoverflow.com/users/10002608/stigma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593954513, "creation_date": 1556750763, "last_edit_date": 1593954513, "question_id": 55943633, "link": "https://stackoverflow.com/questions/55943633/ms-access-detect-when-refreshing-a-linked-table", "title": "MS Access Detect when Refreshing a Linked Table", "body": "<p>Is there a way to detect when the user presses Refresh All or Refresh in Access? I would like to run a VBA script when the table is refreshed. If there isn't a way, how do I refresh all linked tables using VBA? I only know of refreshing/requerying  forms.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6227711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128ed4a1c8300d75bb0de59701cc49fe?s=128&d=identicon&r=PG&f=1", "display_name": "jusrleb1", "link": "https://stackoverflow.com/users/6227711/jusrleb1"}, "is_accepted": false, "score": 0, "last_activity_date": 1557446837, "creation_date": 1557446837, "answer_id": 56069079, "question_id": 55943013, "link": "https://stackoverflow.com/questions/55943013/how-do-i-print-save-only-the-visible-columns-and-rows-to-an-xlsx-file-in-vba/56069079#56069079", "title": "How do I print/save only the visible columns and rows to an XLSX file in VBA?", "body": "<p>Here is the solution.</p>\n\n<pre><code>Sub exportToFile()\n    Dim rng As Range\n\n    With ActiveSheet\n      Set rng = Application.Intersect(.UsedRange, .Cells.Resize(.Rows.Count - 2, .Columns.Count - 2).Offset(2, 2))\n    End With\n\n    rng.Select\n    rng.SpecialCells(xlCellTypeVisible).copy\n\n    Workbooks.Add\n    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    ActiveSheet.Paste\n    Range(\"A\" &amp; Row &amp; \":N\" &amp; Row).EntireRow.AutoFit\n    ActiveSheet.Range(\"A1\").Select\n    Application.Dialogs(xlDialogSaveAs).Show (\"c:\\\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6227711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128ed4a1c8300d75bb0de59701cc49fe?s=128&d=identicon&r=PG&f=1", "display_name": "jusrleb1", "link": "https://stackoverflow.com/users/6227711/jusrleb1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560795673, "creation_date": 1556746660, "last_edit_date": 1560795673, "question_id": 55943013, "link": "https://stackoverflow.com/questions/55943013/how-do-i-print-save-only-the-visible-columns-and-rows-to-an-xlsx-file-in-vba", "title": "How do I print/save only the visible columns and rows to an XLSX file in VBA?", "body": "<p>I have a macro-enabled spreadsheet that allows me to hide various columns and rows based on certain criteria I select and trigger on the sheet.</p>\n\n<p>First I select the relevant columns by marking that column with a \"Y\", and hiding the remaining columns with a \"N\" with the following routine:</p>\n\n<pre><code>Sub Hidecolumn()\nDim p As Range\n\n    For Each p In Range(\"H1:BN1\").Cells\n        If p.Value = \"N\" Then\n            p.EntireColumn.Hidden = True\n\n\n        End If\n    Next p\n\nEnd Sub\n</code></pre>\n\n<p>Please note that Columns(\"A:G\") will always be visible.  Only Columns(\"H:BN\") can be hidden based on the above.  This works perfectly.</p>\n\n<p>Then, I will hide the the various rows that do not have a value in the remaining visible columns for Columns(\"H:BN\"), which is 59 possible columns. If any column within that row has a value, then that row will remain visible.  If there are NO values in any of the visible columns for that row, then I hide that row. It is entirely possible that the 59 columns could reduce to 7. I do this with the following routine:</p>\n\n<pre><code>Sub HideRowsSecond()\n\n    Module2.Unhiderow\n\n    Dim srcRng As Range, ws As Worksheet\n    Set ws = ActiveSheet\n    Set srcRng = ws.Rows(\"5:\" &amp; ws.Cells(ws.Rows.Count, 4).End(xlUp).Row)\n\n    Dim R As Range, hideRng As Range\n    For Each R In srcRng\n        If Application.CountA(R.Columns(\"H:BN\").SpecialCells(xlCellTypeVisible)) = 0 Then\n            If hideRng Is Nothing Then\n                Set hideRng = R.EntireRow\n            Else\n                Set hideRng = Application.Union(hideRng, R.EntireRow)\n            End If\n        End If\n    Next R\n\n    If Not hideRng Is Nothing Then hideRng.EntireRow.Hidden = True\n    MsgBox (\"Complete\")\nEnd Sub\n</code></pre>\n\n<p>Please note that the starting row is Row(\"5\"), and we use Column(\"D\") as the counting column because it has a value in every cell down to the bottom of the data set.  This works perfectly.</p>\n\n<p>Now that I have my desired data set, I need to save this visible data set to a new XLSX file that the user can name themselves and save in the directory of their choice.  The target range will begin with cell \"C3\" and we need to save however many visible columns there are to the right and however many visible rows there are down to the bottom of the data set.</p>\n\n<p>Can someone please help me with this final step?</p>\n"}, {"tags": ["excel", "vba", "string", "find"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1556746089, "post_id": 55942921, "comment_id": 98539079, "body": "You can do this with conditional formatting. Is VBA required?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1556746289, "post_id": 55942921, "comment_id": 98539143, "body": "<code>Left(macCell.Value, 3) &lt;&gt; &quot;SEP&quot; And  Left(macCell.Value, 3) &lt;&gt;  &quot;SIP&quot;</code>"}, {"owner": {"reputation": 25, "user_id": 11435155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8da5548c6462b80a61392f126eb5f1cb?s=128&d=identicon&r=PG&f=1", "display_name": "PMNIServ1", "link": "https://stackoverflow.com/users/11435155/pmniserv1"}, "edited": false, "score": 0, "creation_date": 1556746404, "post_id": 55942921, "comment_id": 98539192, "body": "I am using vba to import data into a vba created workbook. I need vba to apply the formating, it will be a new book every time."}, {"owner": {"reputation": 25, "user_id": 11435155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8da5548c6462b80a61392f126eb5f1cb?s=128&d=identicon&r=PG&f=1", "display_name": "PMNIServ1", "link": "https://stackoverflow.com/users/11435155/pmniserv1"}, "edited": false, "score": 0, "creation_date": 1556746505, "post_id": 55942921, "comment_id": 98539225, "body": "Thank you Scott. Works perfectly."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11435155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8da5548c6462b80a61392f126eb5f1cb?s=128&d=identicon&r=PG&f=1", "display_name": "PMNIServ1", "link": "https://stackoverflow.com/users/11435155/pmniserv1"}, "edited": false, "score": 0, "creation_date": 1556832003, "post_id": 55946330, "comment_id": 98572380, "body": "Is the Select Case version case sensitive as well? When listing values, does I need to include &quot;SEP&quot; and &quot;sep&quot;?"}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "reply_to_user": {"reputation": 25, "user_id": 11435155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8da5548c6462b80a61392f126eb5f1cb?s=128&d=identicon&r=PG&f=1", "display_name": "PMNIServ1", "link": "https://stackoverflow.com/users/11435155/pmniserv1"}, "edited": false, "score": 0, "creation_date": 1556836159, "post_id": 55946330, "comment_id": 98573582, "body": "@PMNIServ1 to remove case sensitivity you can add <code>Option Compare Text</code> at the top of the module (see updated post), or  apply upper case <code>Ucase(Left(macCell.Value, 3))</code> or lower case <code>Lcase(Left(macCell.Value, 3))</code>"}], "tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": true, "score": 1, "last_activity_date": 1556836258, "last_edit_date": 1556836258, "creation_date": 1556776197, "answer_id": 55946330, "question_id": 55942921, "link": "https://stackoverflow.com/questions/55942921/how-to-find-and-highlight-string-if-it-contains-sep-or-sip-in-the-first-thre/55946330#55946330", "title": "How to find and highlight string if it contains &quot;SEP&quot; or &quot;SIP&quot; in the first three characters?", "body": "<p>You don't need to use <code>left()</code> with <code>like</code> operator (<code>[]</code> not required either). if you need to check that string starts from specific text then use <code>\"pattern*\"</code>, in case you need to check last characters use <code>\"*pattern\"</code>, and if you want to check that string contains the specific text then use <code>\"*pattern*\"</code> (or several <code>\"*pattern1*pattern2*pattern3*\"</code>). also, please note that <code>like</code> is case sensitive operator (to remove case sensitivity you can use <code>Lcase()</code>, <code>Ucase()</code> or <code>Option Compare Text</code>) .\nYour updated code is below:</p>\n\n<pre><code>Sub test0()\n    Dim macRange As Range, macCell As Range\n    Set macRange = Range(\"A1:A\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row)\n    For Each macCell In macRange\n        With macCell\n            If Not (.Value Like \"SEP*\" Or .Value Like \"SIP*\") And .Value &lt;&gt; \"\" Then\n                .Interior.ColorIndex = 6\n            End If\n        End With\n    Next macCell\nEnd Sub\n</code></pre>\n\n<p>or like this:</p>\n\n<pre><code>Sub test1()\n    Dim macRange As Range, macCell As Range\n    Set macRange = Range(\"A1:A\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row)\n    For Each macCell In macRange\n        With macCell\n            If .Value &lt;&gt; \"\" And Not \"SEP|SIP\" Like \"*\" &amp; Left(.Value, 3) &amp; \"*\" Then\n                .Interior.ColorIndex = 6\n            End If\n        End With\n    Next macCell\nEnd Sub\n</code></pre>\n\n<p>additional variants:</p>\n\n<p>using <code>select case ...</code>:</p>\n\n<pre><code>Option Compare Text 'if you need to remove case sensitivity\n\nSub test2()\n    Dim macRange As Range, macCell As Range\n    Set macRange = Range(\"A1:A\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row)\n    For Each macCell In macRange\n        Select Case Left(macCell.Value, 3)\n            Case \"SEP\", \"SIP\", \"\" 'list values that should be ignored\n            Case Else: macCell.Interior.ColorIndex = 6\n        End Select\n    Next macCell\nEnd Sub\n</code></pre>\n\n<p>using dictionary:</p>\n\n<pre><code>Sub test3()\n    Dim macRange As Range, macCell As Range, dic As Object\n    Set dic = CreateObject(\"Scripting.Dictionary\")\n    dic.comparemode = vbTextCompare 'use in case when you need to remove case sensitivity for dictionary\n    dic.Add \"SEP\", \"\"\n    dic.Add \"SIP\", \"\"\n    dic.Add \"\", \"\"\n    Set macRange = Range(\"A1:A\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row)\n    For Each macCell In macRange\n        If Not dic.exists(Left(macCell.Value, 3)) Then macCell.Interior.ColorIndex = 6\n    Next macCell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11435155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8da5548c6462b80a61392f126eb5f1cb?s=128&d=identicon&r=PG&f=1", "display_name": "PMNIServ1", "link": "https://stackoverflow.com/users/11435155/pmniserv1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 1, "accepted_answer_id": 55946330, "answer_count": 1, "score": 1, "last_activity_date": 1556836258, "creation_date": 1556746058, "last_edit_date": 1556779745, "question_id": 55942921, "link": "https://stackoverflow.com/questions/55942921/how-to-find-and-highlight-string-if-it-contains-sep-or-sip-in-the-first-thre", "title": "How to find and highlight string if it contains &quot;SEP&quot; or &quot;SIP&quot; in the first three characters?", "body": "<p>I have a range of Cisco mac addresses located in the first column of the first sheet of my workbook. I am looking to highlight data in this range that doesn't begin with SEP or SIP. It will be the first three characters in the string.</p>\n\n<pre><code>Dim macRange As Range\nDim macCell As Range\n\nColumns(\"A:A\").Select\nSet macRange = Selection\nFor Each macCell In macRange\n    If Not IsEmpty(macCell) Then\n        If Left(macCell.Value, 3) not like \"*[SEP]*\" or \"*[SIP]*\" Then macCell.Interior.ColorIndex = 6\n    End If\nNext macCell\n</code></pre>\n\n<p>Obviously this doesn't work but I am struggling to find a relative alternative.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1556745266, "post_id": 55942758, "comment_id": 98538772, "body": "I&#39;ve read through this post a couple of times and I can&#39;t make any sense of it... please try to re-organize it, and indent your code with 4 spaces so that it appears like <code>this</code>."}, {"owner": {"reputation": 1, "user_id": 11438860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e58ef6313fd20255ccb2aeb2228e8?s=128&d=identicon&r=PG&f=1", "display_name": "fuzzvba", "link": "https://stackoverflow.com/users/11438860/fuzzvba"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1556746388, "post_id": 55942758, "comment_id": 98539183, "body": "I want to put a date in a cell on &#39;that&#39; sheet.  The location of the cell is on another sheet, &#39;this&#39; sheet.  That location is A5.  In A5 is P4.  P4 on &#39;that&#39; sheet is where I want to put a date.  How can I do that?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11438860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e58ef6313fd20255ccb2aeb2228e8?s=128&d=identicon&r=PG&f=1", "display_name": "fuzzvba", "link": "https://stackoverflow.com/users/11438860/fuzzvba"}, "edited": false, "score": 0, "creation_date": 1556906629, "post_id": 55943266, "comment_id": 98600733, "body": "I can&#39;t navigate your site.  No place to &#39;edit&#39; so I&#39;ll &#39;answer&#39;: Thank you @Tim Williams for the concept of &#39;.value&#39;.  I think you need to move your trailing &#39;)&#39; to the left of the &#39;.&#39;.  That&#39;s what I did:    Nope - can&#39;t insert code here (or anywhere else) so I guess the words will have to do.            Sheets(tabname).Range(Sheets(&quot;Status&quot;).Range(xFrom)).Value = [a1]"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 11438860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e58ef6313fd20255ccb2aeb2228e8?s=128&d=identicon&r=PG&f=1", "display_name": "fuzzvba", "link": "https://stackoverflow.com/users/11438860/fuzzvba"}, "edited": false, "score": 0, "creation_date": 1556908382, "post_id": 55943266, "comment_id": 98601385, "body": "You should be able to edit your question if you have something to add."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 11438860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e58ef6313fd20255ccb2aeb2228e8?s=128&d=identicon&r=PG&f=1", "display_name": "fuzzvba", "link": "https://stackoverflow.com/users/11438860/fuzzvba"}, "edited": false, "score": 0, "creation_date": 1556908458, "post_id": 55943266, "comment_id": 98601424, "body": "My trailing <code>)</code> is fine, though I did omit the default/optional <code>.Value</code> just after that."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1556748303, "creation_date": 1556748303, "answer_id": 55943266, "question_id": 55942758, "link": "https://stackoverflow.com/questions/55942758/a-cell-on-this-sheet-has-a-cell-address-of-a-cell-on-that-sheet-im-trying/55943266#55943266", "title": "A cell on &#39;this&#39; sheet has a cell address of a cell on &#39;that&#39; sheet. I&#39;m trying to change the contents of the cell on &#39;that&#39; sheet", "body": "<p>For example:</p>\n\n<pre><code>Dim thisSheet As WorkSheet\nDim thatSheet As WorkSheet\n\nSet thisSheet = ThisWorkbook.Sheets(\"this\")\nSet thatSheet = ThisWorkbook.Sheets(\"that\")\n\nthatSheet.Range(thisSheet.Range(\"A5\").Value) = Date\n</code></pre>\n\n<p>If A5 on sheet \"this\" contains the value \"P4\" then this code would populate the date in P4 on sheet \"that\"</p>\n"}], "owner": {"reputation": 1, "user_id": 11438860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2e58ef6313fd20255ccb2aeb2228e8?s=128&d=identicon&r=PG&f=1", "display_name": "fuzzvba", "link": "https://stackoverflow.com/users/11438860/fuzzvba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556998631, "creation_date": 1556745093, "last_edit_date": 1556998631, "question_id": 55942758, "link": "https://stackoverflow.com/questions/55942758/a-cell-on-this-sheet-has-a-cell-address-of-a-cell-on-that-sheet-im-trying", "title": "A cell on &#39;this&#39; sheet has a cell address of a cell on &#39;that&#39; sheet. I&#39;m trying to change the contents of the cell on &#39;that&#39; sheet", "body": "<p>I have stopped using relative addressing and stopped using [  ] in lieu of Range.  The code that functions (but not correctly)  is below </p>\n\n<pre><code>Dim rStat, cLoan As Integer\nDim tabname, xFrom As String\nSheets(\"Status\").Select\n\n[a1].FormulaR1C1 = \"=Now()\"\n\nSheets(\"Status\").Select\n\ncLoan = 0\nDo While Cells(2, 2 + 3 * cLoan) &lt;&gt; Empty\n    rStat = 4\n    tabname = Sheets(\"Status\").Cells(2, 2 + 3 * cLoan)\n    While Cells(rStat, 1 + 3 * cLoan) &lt;&gt; Empty\n        If (Sheets(\"Status\").Cells(rStat, 3 * cLoan + 2) = Empty) _\n        Or (Sheets(\"Status\").Cells(rStat, 3 * cLoan + 3) = Empty) Then\n\n\nSheets(tabname).Range(Sheets(\"Status\").Range(Sheets(\"Status\").Cells(rStat, 1 \n+ 3 * cLoan).Value)) = [a1]\n\nSheets(tabname).Range(Sheets(\"Status\").Range(Sheets(\"Status\").Cells(rStat, 1 \n+ 3 * cLoan)).Value).NumberFormat = \"m/d/yyyy\"\n        End If\n        rStat = rStat + 1\n    Wend\n    cLoan = cLoan + 1\nLoop\n</code></pre>\n\n<p>In the first iteration the test for a blank cell fails so the subject code is skipped.  Test passes the 2nd iteration so rStat is 5.  cStat still zero.</p>\n\n<p>The data structure on \"Status\" sheet [worth 1000 words] is</p>\n\n<pre><code>'   A   B   C                     P\n'4  P3  aa  bb                    P3\n'5  P4  cc\n'6  P5      dd\n</code></pre>\n\n<p>The test detects that C5 is blank, so the task is to place the date [A1] in P4 [the contents of A5] of the tabname sheet.  ie tabname.Range(\"P4\") = date, where P4 comes from A5.</p>\n\n<p>The code places the date at P3 instead P4.</p>\n\n<p>I have determined that the code is using the P4 address on the Status sheet [notice that data P3 is stored at cell P4] and uses that content at that address, P3, as the destination on the tabname sheet.  That is, tabname.Range(\"P3\") = date.</p>\n\n<p>I have not determined how or why it is doing that.</p>\n\n<p>Removing the \".value\" from the first of the 2 ['store' and 'format'] lines does not change the destination or its content.  Still tabname.Range(\"P3\") = date.</p>\n\n<p>I need to say tabname.Range(\"content of Status.Range(\"A5\")) = date</p>\n\n<p>If I take out the first \"Sheets(\"Status\").\", </p>\n\n<pre><code>Sheets(tabname).Range(Range(Sheets(\"Status\").Cells(rStat, 1 + 3 * \ncLoan)).value) = [a1]\n</code></pre>\n\n<p>there was nothing [a blank?] stored tabname.P3 - twice. tabname.P3 is selected but empty after the macro finishes.  The 3rd time I ran this same code, I got a compiler error: With the 2nd 'Range' highlighted, \" Wrong number of arguments or invalid property assignment.\"</p>\n\n<p>I removed the \".value\" and ran again.  No compiler error, but tabname.O3 is highlighted and P3 and P4 still have bogus values I put there to see if they were ignored or had blanks stored.  They were both ignored - still my bogus values.</p>\n\n<p>I put bogus data in tabname.O3 to see if it was  blanked or ignored/merely highlighted and got the compiler error again.</p>\n\n<p>Any suggestions would be appreciated.</p>\n\n<p>My current code is working perfectly.\nThe Status sheet is wider than 26 columns so I have to calculate column references [colLetter()] </p>\n\n<pre><code>    rStat = 4\n    tabname = Sheets(\"Status\").Cells(2, 2 + 3 * cLoan)\n    While Cells(rStat, 1 + 3 * cLoan) &lt;&gt; Empty\n        A_Stat = colLetter(1 + 3 * cLoan) &amp; CStr(rStat) \n</code></pre>\n\n<p>The data store is correct, and the next line, the formatting of that date, works, too.  I was expecting more formatting than I was doing.  </p>\n\n<pre><code>Sheets(tabname).Range(Sheets(\"Status\").Range(A_Stat)).Value = [a1]\n\nSheets(tabname).Range(Sheets(\"Status\").Range(A_Stat)).NumberFormat = \n\"m/d/yyyy\"\n</code></pre>\n\n<p>When everything is resolved, how do I quit/leave this post?  Just quit posting?  The instructions say \"Don't say Thank you\".</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1556745479, "post_id": 55942752, "comment_id": 98538849, "body": "You can achieve most of this with just using <code>VLOOKUP</code>, but you need a permanent reference somewhere so that you can populate your <code>Data2</code> column - otherwise, when you add/remove a row, how is that data supposed to return?"}, {"owner": {"reputation": 1, "user_id": 10946167, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LwTB6TO6pE0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYILWFVpXbGlP3M8YxARBO2mrRYeg/mo/photo.jpg?sz=128", "display_name": "Dh Fr", "link": "https://stackoverflow.com/users/10946167/dh-fr"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1556745842, "post_id": 55942752, "comment_id": 98538987, "body": "I&#39;ve been playing with VLOOKUPs but can&#39;t get them to work. My issue is that I need to have a single master table with the IDs, which means I can&#39;t think of a solution that&#39;d have a permanent reference between the IDs and the Data2 column (that doesn&#39;t just reproduce the problem I have above). I&#39;m fairly tired, does that make sense?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556752800, "post_id": 55942752, "comment_id": 98540723, "body": "Why do this though?  You can much easier use one sheet and toggle the extra column visibility.  Two sheets adds a bunch of unnecessary complexity"}], "owner": {"reputation": 1, "user_id": 10946167, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LwTB6TO6pE0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYILWFVpXbGlP3M8YxARBO2mrRYeg/mo/photo.jpg?sz=128", "display_name": "Dh Fr", "link": "https://stackoverflow.com/users/10946167/dh-fr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556779594, "creation_date": 1556745054, "last_edit_date": 1556779594, "question_id": 55942752, "link": "https://stackoverflow.com/questions/55942752/how-to-duplicate-and-sync-tables-based-on-id-column-in-excel", "title": "How to duplicate and sync tables based on ID column in Excel?", "body": "<p>I'd like to duplicate a table in Excel onto a different worksheet, add columns to the new table, and keep the rows synced.</p>\n\n<p>(p.s I'm not sure how to add images of the Excel sheet in here?)</p>\n\n<p>For example, I have a table (Table1):  </p>\n\n<pre><code>ID    Data  \nA     1  \nB     2  \nC     3  \nD     4 \n</code></pre>\n\n<p>I'd like to duplicate it in another sheet (Table2) and add a column that's only in the new table: </p>\n\n<pre><code>ID    Data   Data2  \nA     1      a  \nB     2      b  \nC     3      c  \nD     4      d  \n</code></pre>\n\n<p>And I'd keep the rows synced, so that if I add, delete or amend a row in the original table (Table1), the new table (Table2) remains consistent <strong>including the added column that only exists in the new table</strong>.</p>\n\n<p>For example, if I delete the row with ID \"B\" in the original table, I'd like this to happen in the new table:</p>\n\n<pre><code>ID    Data   Data2  \nA     1      a  \nC     3      c  \nD     4      d \n</code></pre>\n\n<p>I've been able to duplicate the table via a connection or query, but the added column in the new table doesn't stay in sync. For example, at the moment if I delete the row with ID \"B\" in the original table, this happens in the new table:  </p>\n\n<pre><code>ID    Data   Data2  \nA     1      a  \nC     3      b  \nD     4      c \n</code></pre>\n\n<p>The columns that are in the original table update correctly, while the new column seems to be ignored.</p>\n\n<p>I need to use Excel and if possible without VBA, but if VBA is the only way this will work then I'll need to use it.</p>\n\n<p>I'm pretty desperate so any tips in the right direction would be gratefully received!!</p>\n"}, {"tags": ["excel", "vba", "bubble-sort"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1556745056, "post_id": 55942645, "comment_id": 98538698, "body": "<code>For i = LBound(LbList, 1)+1...</code>"}, {"owner": {"reputation": 15, "user_id": 10929149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac939a1380e9d8c22e8f74a3bc3764ff?s=128&d=identicon&r=PG&f=1", "display_name": "AnotherPerson", "link": "https://stackoverflow.com/users/10929149/anotherperson"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556745204, "post_id": 55942645, "comment_id": 98538747, "body": "holy fock, you are an genius..."}], "owner": {"reputation": 15, "user_id": 10929149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac939a1380e9d8c22e8f74a3bc3764ff?s=128&d=identicon&r=PG&f=1", "display_name": "AnotherPerson", "link": "https://stackoverflow.com/users/10929149/anotherperson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556798293, "creation_date": 1556744328, "last_edit_date": 1556798293, "question_id": 55942645, "link": "https://stackoverflow.com/questions/55942645/listbox-sorting-using-bubble-method-skipping-first-item-in-listbox", "title": "Listbox sorting using bubble method skipping first item in listbox", "body": "<p>I need help customizing this bubble sort code so that it will skip the first item in the listbox and only sort a-z on the rest of the items in the listbox. I'm lost and need some directions. Thanks</p>\n\n<pre><code>    Dim j As Long\n    Dim sTemp As String\n    Dim sTemp2 As String\n    Dim LbList As Variant\n\n    'Store the list in an array for sorting\n    LbList = Me.WorksheetListBox.List\n\n    'Bubble sort the array on the first value\n    For i = LBound(LbList, 1) To UBound(LbList, 1) - 1\n        For j = i + 1 To UBound(LbList, 1)\n            If LbList(i, 0) &gt; LbList(j, 0) Then\n                'Swap the first value\n                sTemp = LbList(i, 0)\n                LbList(i, 0) = LbList(j, 0)\n                LbList(j, 0) = sTemp\n\n                'Swap the second value\n                sTemp2 = LbList(i, 1)\n                LbList(i, 1) = LbList(j, 1)\n                LbList(j, 1) = sTemp2\n            End If\n        Next j\n    Next i\n\n'Remove the contents of the listbox\n        Me.WorksheetListBox.Clear\n\n        'Repopulate with the sorted list\n        Me.WorksheetListBox.List = LbList\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11435606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ed4f57cd56ddae783797ff33cb654c?s=128&d=identicon&r=PG&f=1", "display_name": "Denise Turan", "link": "https://stackoverflow.com/users/11435606/denise-turan"}, "edited": false, "score": 0, "creation_date": 1557250925, "post_id": 55948427, "comment_id": 98699335, "body": "I am new to this site. How do I accept the solution? I tried to click on the above arrow and received a notice telling that anyone with less than 15 reputation, the site will accept my score, but it will not be shown on this thread."}, {"owner": {"reputation": 372, "user_id": 10996676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b40d30e699db99cf4405492b601bf9?s=128&d=identicon&r=PG&f=1", "display_name": "Spainey", "link": "https://stackoverflow.com/users/10996676/spainey"}, "reply_to_user": {"reputation": 11, "user_id": 11435606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ed4f57cd56ddae783797ff33cb654c?s=128&d=identicon&r=PG&f=1", "display_name": "Denise Turan", "link": "https://stackoverflow.com/users/11435606/denise-turan"}, "edited": false, "score": 0, "creation_date": 1557304951, "post_id": 55948427, "comment_id": 98715840, "body": "Here is a helpful link that can hopefully explain how to do this and the benefits of doing so :)  <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\" title=\"how does accepting an answer work\">meta.stackexchange.com/questions/5234/&hellip;</a>"}], "tags": [], "owner": {"reputation": 372, "user_id": 10996676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b40d30e699db99cf4405492b601bf9?s=128&d=identicon&r=PG&f=1", "display_name": "Spainey", "link": "https://stackoverflow.com/users/10996676/spainey"}, "is_accepted": false, "score": 2, "last_activity_date": 1556785674, "creation_date": 1556785674, "answer_id": 55948427, "question_id": 55942508, "link": "https://stackoverflow.com/questions/55942508/copy-range-to-last-row-and-paste-in-another-worksheet/55948427#55948427", "title": "Copy range to last row and paste in another worksheet", "body": "<p>I noticed you had another question to answer, so I had a go at this one too. </p>\n\n<p>I know it wasn't in your original request, but I've added a section that clears the contents of the \"RPG\" file first (Only from row 5 downwards), so that you won't run in to any problems. This way you will always have a blank page to paste your new data in to and you'll never have data left over from last time if your new data is smaller than your old data. If you don't need this bit feel free to leave it out. </p>\n\n<pre><code>Sub Get_New_Data_From_Other_Workbook()\n'\n' This macro will copy data from a .xlsx file and paste it back into the .xlsm file\n' Any contents in the .xlsm file will first be deleted\n\n    ' Clear the existing contents of the destination sheet\n    Windows(\"RPG - Apr Mnth acs by co.xlsm\").Activate                   ' Make sure the RPG file is selected\n    Sheets(\"010 - RPL\").Select                                          ' Select the required sheet\n    Range(\"A5\").Select\n    Range(Selection, ActiveCell.SpecialCells(xlLastCell)).Select        ' From A5, select every cell until the end of the page (up to where the data stops)\n    Application.CutCopyMode = False\n    Selection.ClearContents                                             ' Delete contents\n    Range(\"A1\").Select                                                  ' Select A1 for presentation purposes\n\n    ' Go to the correct sheet of the other workbook and copy the data\n    Windows(\"Month By Month Income Statement 10.xlsx\").Activate         ' Select the other workbook\n    Sheets(\"Month By Month Income Statmen-A\").Select                    ' Select the sheet with the data on\n    Range(\"A5\").Select\n    Range(Selection, ActiveCell.SpecialCells(xlLastCell)).Select        ' From A5, select every cell until the end of the page (up to where the data stops)\n    Selection.Copy                                                      ' Copy the data\n\n    ' Come back to the macro workbook and paste the data in A5 of the required sheet\n    Windows(\"RPG - Apr Mnth acs by co.xlsm\").Activate                   ' Select the RPG file\n    Sheets(\"010 - RPL\").Select                                          ' Select the required sheet\n    Range(\"A5\").Select                                                  ' Select cell A5\n    ActiveSheet.Paste                                                   ' Paste the data\n    Range(\"A1\").Select                                                  ' Select A1 for presentation purposes\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11435606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ed4f57cd56ddae783797ff33cb654c?s=128&d=identicon&r=PG&f=1", "display_name": "Denise Turan", "link": "https://stackoverflow.com/users/11435606/denise-turan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1556785674, "creation_date": 1556743506, "last_edit_date": 1556747375, "question_id": 55942508, "link": "https://stackoverflow.com/questions/55942508/copy-range-to-last-row-and-paste-in-another-worksheet", "title": "Copy range to last row and paste in another worksheet", "body": "<p>I need vba code to copy everything starting from A5, everything to the right of it and down to the last row in one workbook and paste it into another Workbook, starting at A5.</p>\n\n<p>This is the code that I have so far, but it's not working. </p>\n\n<pre><code>Windows(\"Month By Month Income Statment 10.xlsx\").Activate\nSheets(\"Month By Month Income Statmen-A\").Select\nRange(\"A5\").Select\n\nDim EC As Long\nDim X As Long\nDim Y As Long\nX = Range(\"A5\").End(xlUp).Offset(1, 0).Row\nEC = Range(\"A5\").End(xlToLeft).Offset(0, X).Column\n\nRange(\"A5\" &amp; EC).Select\nSelection.Copy\n\nWindows(\"RPG - Apr Mnth acs by co.xlsm\").Activate\nSheets(\"010 - RPL\").Select\nRange(\"A5\").Select\nActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1556743502, "post_id": 55942453, "comment_id": 98538191, "body": "I think you need to elaborate more: are the workbooks the user can browse A) workbooks user opens, or B) workbooks the userform code opens?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1556744113, "post_id": 55942453, "comment_id": 98538382, "body": "I&#39;d re-post <a href=\"https://stackoverflow.com/a/55926975/1188513\">this answer</a>, verbatim. You absolutely want <code>vbModeless</code>, and definitely split up your procedures. The less a procedure does, the better."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556744686, "post_id": 55942453, "comment_id": 98538570, "body": "<a href=\"https://stackoverflow.com/a/47358692/1188513\">Related</a>"}, {"owner": {"reputation": 545, "user_id": 11356960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cda0d343183c7e4d9d5961845654b0?s=128&d=identicon&r=PG&f=1", "display_name": "NoNameNo123", "link": "https://stackoverflow.com/users/11356960/nonameno123"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1556805126, "post_id": 55942453, "comment_id": 98559843, "body": "@Mistella The workbooks are already open and have been opened by my code (preceding the userform)"}, {"owner": {"reputation": 545, "user_id": 11356960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cda0d343183c7e4d9d5961845654b0?s=128&d=identicon&r=PG&f=1", "display_name": "NoNameNo123", "link": "https://stackoverflow.com/users/11356960/nonameno123"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556805556, "post_id": 55942453, "comment_id": 98560119, "body": "@MathieuGuindon Ok, so I have no clue about class module and reading up on it and understanding it might take a bit.Definitely thank you for the links, though.   In the meantime, if I&#39;m sticking with my non-class code, I assume the &quot;the less a procedure does, the better&quot; still holds true? So for example for my code, I have three different types of data that I copy - should I put those 3 different data types in 3 different procedures and call them from the main one? What&#39;s the reason for this? Is it readability or something else?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1556809983, "post_id": 55942453, "comment_id": 98562675, "body": "A form is little more than a class module with a visual designer. A worksheet is a class. A workbook is a class. A range is a class. You&#39;ve been using classes all along! As for how/where to split things up, it&#39;s all about <i>abstraction levels</i>: you want your &quot;main procedure&quot; (the public macro) to read like a high-level executive summary of what&#39;s going on, and each procedure goes into deeper details about how each part gets done. For readability, yes - but mostly because a procedure that does one thing, has only 1 reason to fail... but first things first: it needs to work, <i>then</i> be pretty!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1556810548, "post_id": 55942453, "comment_id": 98562982, "body": "The problem you&#39;re having with a modeless form, is that a modeless form is <i>inherently</i> going to <i>want</i> your code to go asychronous and enter an event-driven paradigm: any other hacks to keep it all procedural, is essentially <i>fighting</i> the very nature of how a modeless form wants to work. And then the hacks have flaws, which cause bugs, which cause more hacks, which inevitably complicate things well beyond the &quot;complexity&quot; of doing things properly."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1556811097, "post_id": 55942453, "comment_id": 98563304, "body": "Once you get your code to work as intended (pretty or not), I&#39;d recommend you put it up for peer review on <a href=\"https://codereview.stackexchange.com\">Code Review</a> - you&#39;ll get answers with infinitely more info/details than whatever can fit in a 400-character comment :)"}, {"owner": {"reputation": 545, "user_id": 11356960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cda0d343183c7e4d9d5961845654b0?s=128&d=identicon&r=PG&f=1", "display_name": "NoNameNo123", "link": "https://stackoverflow.com/users/11356960/nonameno123"}, "edited": false, "score": 0, "creation_date": 1556827357, "post_id": 55942453, "comment_id": 98570604, "body": "Thanks a lot! One question about Code Review: Is it encouraged to link to a .xlsx file that shows the data/data structure? I imagine looking at the code with just a description of the data is somewhat difficult."}], "owner": {"reputation": 545, "user_id": 11356960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cda0d343183c7e4d9d5961845654b0?s=128&d=identicon&r=PG&f=1", "display_name": "NoNameNo123", "link": "https://stackoverflow.com/users/11356960/nonameno123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556743161, "creation_date": 1556743161, "question_id": 55942453, "link": "https://stackoverflow.com/questions/55942453/userform-stop-execution-of-code-but-let-user-look-through-workbooks", "title": "UserForm: Stop execution of code, but let user look through workbooks?", "body": "<p>I'd like to show a UserForm, but allow the user to look through worksbooks and worksheets. I know I can hide the UF, but I'd prefer to leave up the UF. Is this possible? I know there's <code>vbModeless</code>, but the code continues to execute, which is not what I want. </p>\n\n<p>My code so far looks somewhat like this:</p>\n\n<pre><code>Sub Test()\nDim Counter As Long\nDim wb As Workbook\n\nApplication.ScreenUpdating = False\n\n '-------main code\n\nIf Counter &lt;&gt; 0 Then\n    frmTest.Show \nEnd If\nUnload Me\nFor Each wb In Application.Workbooks\n    If wb.Name Like \"Report*\" Then wb.Close SaveChanges:=True\nNext wb\n\nApplication.ScreenUpdating = True \n\nEnd Sub\n</code></pre>\n\n<p>I could change the if-statement to</p>\n\n<pre><code>If ErrorCount &gt; 0 Then\n       frmTest.Show vbModeless\n    Else\n        Call SaveWorkbooks\n    End If\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>And create another sub:</p>\n\n<pre><code>Sub SaveWorkbooks()\nDim wb As Workbook\n    Unload frmTest\n    For Each wb In Application.Workbooks\n        If wb.Name Like \"Report*\" Then wb.Close SaveChanges:=True\n    Next wb\n\nEnd Sub\n</code></pre>\n\n<p>I guess that works, but </p>\n\n<ol>\n<li>Is it good practice splitting up your code like that?</li>\n<li>What if this occurred in the middle of my main sub? That would make 1) even worse. </li>\n</ol>\n\n<p>Is there a more elegant solution</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556743264, "post_id": 55942283, "comment_id": 98538115, "body": "Remove the <code>.Select</code> member call. <code>Range.Select</code> is not a function, it doesn&#39;t return anything. Did you mean <code>.Value</code>? Note that if <code>.SpecialCells(xlCellTypeConstants)</code> yields more than a single cell, <code>.Value</code> will be a 2D variant array containing all the values in that <code>Range</code>."}, {"owner": {"reputation": 1, "user_id": 2434555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123dbadd3bbf9c3ef115306d6db504ac?s=128&d=identicon&r=PG", "display_name": "user2434555", "link": "https://stackoverflow.com/users/2434555/user2434555"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556743874, "post_id": 55942283, "comment_id": 98538302, "body": "I&#39;m not sure. This was something I plucked out when I searched how to copy rows with only value on the web. A 2D array is what I&#39;m looking for. If you know any better way to populate this I&#39;d be open to trying this out. I tried the .Value instead and got a 1004 error"}], "answers": [{"tags": [], "owner": {"reputation": 173, "user_id": 1719890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd25513c710f5a3d0d21b5dc195d6621?s=128&d=identicon&r=PG", "display_name": "Jitendra Singh", "link": "https://stackoverflow.com/users/1719890/jitendra-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1556854348, "last_edit_date": 1556854348, "creation_date": 1556813578, "answer_id": 55956440, "question_id": 55942283, "link": "https://stackoverflow.com/questions/55942283/copy-a-row-of-only-data-then-move-on-to-the-next-worksheet-if-no-values-left/55956440#55956440", "title": "Copy a row of only data then move on to the next worksheet if no values left", "body": "<p>Your code creates the Master sheet every time which will cause the program to fail when it tries to name the sheet in the next run. Also, in your iteration through all sheets, you are reading data from Master sheet as well which might give incorrect results. I can quickly think of below code. I have used the numerical notation for rows and cells. Also since the range is constant, i looped through the range that you specified</p>\n\n<pre><code>Sub distribute()\n    Dim sh As Worksheet\n    Dim destsh As Worksheet\n    Dim i As Integer: i = 1\n    Dim sheetName As String: sheetName = \"\"\n\n    Set destsh = ActiveWorkbook.Worksheets.Add\n\n    'Taking sheet name as input from user\n    sheetName = InputBox(\"Enter sheetname to aggregate data\")\n\n    'Checking if sheetname was entered properly\n    If (sheetName &lt;&gt; \"\") Then\n        destsh.Name = sheetName\n        ActiveWorkbook.Worksheets(\"Master\").Cells.EntireColumn.ColumnWidth = 30\n        ActiveWorkbook.Worksheets(\"Master\").Cells.EntireRow.AutoFit\n        ActiveWorkbook.Worksheets(\"Master\").UsedRange.UnMerge\n        ActiveWorkbook.Worksheets(\"Master\").UsedRange.WrapText = False\n\n        masterSheetRow = 1\n        For Each sh In ActiveWorkbook.Worksheets\n        'Making sure that the sheet is not the master sheet while getting rows\n            If (sh.Name &lt;&gt; sheetName) Then\n                For i = 7 To 90\n                    If (sh.Cells(i, 2).Value &lt;&gt; \"\") Then\n                        destsh.Cells(masterSheetRow, 1).Value = sh.Cells(i, 2).Value\n                        masterSheetRow = masterSheetRow + 1\n                    End If\n                Next\n            End If\n        Next\n    Else\n        MsgBox (\"Enter valid sheetname\")\n    End If\nEnd Sub\n\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2434555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123dbadd3bbf9c3ef115306d6db504ac?s=128&d=identicon&r=PG", "display_name": "user2434555", "link": "https://stackoverflow.com/users/2434555/user2434555"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556854348, "creation_date": 1556742236, "last_edit_date": 1556743215, "question_id": 55942283, "link": "https://stackoverflow.com/questions/55942283/copy-a-row-of-only-data-then-move-on-to-the-next-worksheet-if-no-values-left", "title": "Copy a row of only data then move on to the next worksheet if no values left", "body": "<p>I don't know how to create this section of the code. This is a template code that I've used to copy specific values from a cell from each worksheet into one master worksheet that compiles that data usually into one row.</p>\n\n<pre><code>Sub distribute()\nDim sh As Worksheet\nDim destsh As Worksheet\nDim i As Integer\n\nSet destsh = ActiveWorkbook.Worksheets.Add\ndestsh.Name = \"Master\"\n\ni = 1\nFor Each sh In ActiveWorkbook.Worksheets\n        ***destsh.Cells(i, 1).Value = sh.Range(\"B7:B90\").SpecialCells(xlCellTypeConstants).Select***\ni = i + 1\nNext\n\n\n   ActiveWorkbook.Worksheets(\"Master\").Cells.EntireColumn.ColumnWidth = 30\n   ActiveWorkbook.Worksheets(\"Master\").Cells.EntireRow.AutoFit\n   ActiveWorkbook.Worksheets(\"Master\").UsedRange.UnMerge\n   ActiveWorkbook.Worksheets(\"Master\").UsedRange.WrapText = False\n\n\nEnd Sub\n</code></pre>\n\n<p>I want my code to go through each worksheet in my workbook and copy the column from the range B7:B90 and stop where there are no more values within each row of each worksheet, then moves on to the next worksheet. Some worksheets have 10 cells in one row, others have 60; in this scenario my master file would show 70 cells in column A from both worksheets. The code creates a master worksheet that compiles the worksheets row B in one column.</p>\n\n<p><strong><em>The section I need help with has been asterisked</em></strong></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1556742006, "post_id": 55942166, "comment_id": 98537668, "body": "Why can&#39;t you just pass the formula as a string rather than a formula?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1556742778, "post_id": 55942166, "comment_id": 98537923, "body": "What&#39;s the purpose of using a UDF here? Why not just use a <code>Worksheet_Change()</code> event or something of the like to see whether or not <code>B1</code> contains something - is it relative to the formula&#39;s position? A UDF should be used to return something to its cell, not to throw a <code>MsgBox</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556743119, "post_id": 55942166, "comment_id": 98538053, "body": "That would be <code>MsgBox condition</code>, without the extra parentheses (note the space the VBE puts between <code>MsgBox</code> and <code>(condition)</code> - that&#39;s your cue for &quot;woopsie, do I really want to evaluate the parenthesised expression as a value and force-pass it <code>ByVal</code> to this function?&quot;). That said I&#39;ve no idea what you&#39;re trying to accomplish or what types are involved, everything is an implicit <code>Variant</code> here. I&#39;ll take a wild guess and go with <code>MsgBox Application.Evaluate(condition)</code>."}, {"owner": {"reputation": 99, "user_id": 7061188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/86c26ee5856422615312ae78e743a281?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7061188/daniel"}, "edited": false, "score": 0, "creation_date": 1556743777, "post_id": 55942166, "comment_id": 98538260, "body": "My goal is to implement my own IFS function who behave identically like in Excel 2016. I am just curious if its possible. Thats why I don&#39;t want to pass a string as an agrument."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1556744434, "post_id": 55942166, "comment_id": 98538488, "body": "IFS evaluates <i>everything</i> passed to it, so I don&#39;t see why you need to do anything other than let Excel do the evaluation for you. Otherwise, pass strings and use <code>evaluate</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556744805, "post_id": 55942166, "comment_id": 98538608, "body": "<code>=IF(AND(condition1, condition2, condition3), value_if_true, value_if_false)</code> then"}, {"owner": {"reputation": 99, "user_id": 7061188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/86c26ee5856422615312ae78e743a281?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7061188/daniel"}, "edited": false, "score": 0, "creation_date": 1556745015, "post_id": 55942166, "comment_id": 98538682, "body": "Ok, but for example I would like to add some additional customization to formula like using wildcards: <code>=IF(B1=&quot;*omething&quot;)</code>. If unfortunately excel will evaluate that condition as <code>FALSE</code> if B1 cell contains word &quot;string&quot;"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1556745078, "post_id": 55942166, "comment_id": 98538705, "body": "<code>=if(isnumber(search(&quot;omething&quot;,B1))</code>"}, {"owner": {"reputation": 99, "user_id": 7061188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/86c26ee5856422615312ae78e743a281?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7061188/daniel"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1556745309, "post_id": 55942166, "comment_id": 98538788, "body": "@Rory I know its possible to write crazy long nested formula full of other formulas, but its not convenient, easy to make a mistake and hard to modify."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1556745611, "post_id": 55942166, "comment_id": 98538903, "body": "Unlike this VBA? :) You&#39;ll have to pass strings, and parse and evaluate them. Not really simpler, IMO."}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1556743107, "creation_date": 1556743107, "answer_id": 55942444, "question_id": 55942166, "link": "https://stackoverflow.com/questions/55942166/pass-function-argument-as-formula/55942444#55942444", "title": "Pass function argument as formula", "body": "<p>I think you're looking for:</p>\n\n<pre><code>Function custom_if_formula(condition)\n    If condition.Value = \"something\" Then MsgBox \"something\"\nEnd Function\n</code></pre>\n\n<p>Where <code>B1</code> is taken as the argument: <code>=custom_if_formula(B1)</code>. Putting this in any cell (when <code>B1</code> contains the string \"something\") will return:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yzHIQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yzHIQ.png\" alt=\"img1\"></a></p>\n\n<p>You should really clarify what your intent is here, though. A UDF should return a value to its cell. Right now, it will just say <code>0</code> in the UDF's cell. Additionally, looking for \"something\" could be interpreted as looking for <em>anything</em>, and using this kind of verbiage leads to the \"Who's on first, what's on second\" ordeal...</p>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 7061188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/86c26ee5856422615312ae78e743a281?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7061188/daniel"}, "is_accepted": true, "score": 0, "last_activity_date": 1556747777, "creation_date": 1556747777, "answer_id": 55943182, "question_id": 55942166, "link": "https://stackoverflow.com/questions/55942166/pass-function-argument-as-formula/55943182#55943182", "title": "Pass function argument as formula", "body": "<p>Ok, I found a way how to do it:</p>\n\n<pre><code>Function custom_if_formula(condition)\n    cell_formula = Range(Application.Caller.Address).Formula 'I get an adress of a cell which call an UDF, and then take all string it contains\n    arg = Mid(cell_formula, 12, 100)\n    MsgBox(arg)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 7061188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/86c26ee5856422615312ae78e743a281?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7061188/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 55943182, "answer_count": 2, "score": 0, "last_activity_date": 1556747777, "creation_date": 1556741647, "last_edit_date": 1556744109, "question_id": 55942166, "link": "https://stackoverflow.com/questions/55942166/pass-function-argument-as-formula", "title": "Pass function argument as formula", "body": "<p>Here is a code of my VBA script:</p>\n\n<pre><code>Function custom_if_formula(condition)\n    MsgBox(condition)    \nEnd Function\n</code></pre>\n\n<p>I am pasting the formula to any cell:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>=custom_if_formula(B1=\"something\")\n</code></pre>\n\n<p>The result in MsgBox is: <code>TRUE</code> or <code>FALSE</code>.  Is it possible get in MsgBox as a result <code>B1=\"something\"</code> as instead?</p>\n\n<p>A pseudo-code of what I would like to achieve:</p>\n\n<pre><code>Function custom_if_formula(condition)\n    condition = condition.formula 'any method which take a literal string\n    MsgBox(condition)    \nEnd Function\n</code></pre>\n\n<p>P.S. My goal is to implement my own IFS function who behave identically like in Excel 2016. I am just curious if its possible. Tha'ts why I don't want to pass a string as an argument.</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1556779445, "creation_date": 1556779445, "answer_id": 55946973, "question_id": 55942033, "link": "https://stackoverflow.com/questions/55942033/append-data-from-form-to-column/55946973#55946973", "title": "append data from form to column", "body": "<p>You wouldn't just keep on appending text to the same record. Where would you end?</p>\n\n<p>So, skip all the code and create a form bound to the table.</p>\n\n<p>Have one field for the date. Set its <em>DefaultValue</em> to: Now()</p>\n\n<p>Set the form's property <em>AllowEdits</em> to: False</p>\n"}], "owner": {"reputation": 1, "user_id": 11433943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/997fedf62a7bc85d4bd7567aa0ec248c?s=128&d=identicon&r=PG&f=1", "display_name": "John Cuevas", "link": "https://stackoverflow.com/users/11433943/john-cuevas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594780143, "creation_date": 1556741046, "last_edit_date": 1594780143, "question_id": 55942033, "link": "https://stackoverflow.com/questions/55942033/append-data-from-form-to-column", "title": "append data from form to column", "body": "<p>I am working on a \"issue tracker\" access data base where the user enters there data through forms, create new form and edit form.</p>\n\n<p>I have a comment section on my edit form which I have been requested to remained lock, for viewing purposes. So the user can only view the comments.\nI have another box below that must \"append\" or add data to the comment section with a time and user stamp.</p>\n\n<p>My approach is to create a vba code that will allow the user to enter data, and once entered will show in the locked comment section. As the user is working through a \"editing\" form. </p>\n\n<p>I am fairly new to access and vba and unfortunately I cant find anything that I understand online. </p>\n\n<p>Below is some code use and found searching online. I have but can figure out how to append ( or add ) it to the existing column. It is running fine but the data value I wish to add don't go anywhere?</p>\n\n<pre><code>Private Sub Add_Click()\n\nDim StrSQL As String\nDim addComments As String\n\n' where addcomment.value is the value desire to append\naddCommentStr = Me!addComment.Value\n\n'where IssueTrack is Table, AdditionalComments is column\nStrSQL = \"INSERT INTO IssueTracker(AdditionalComments) VALUES ('\" &amp; \naddCommentStr &amp; \"' );\"\n\nDoCmd.SetWarnings False\nDoCmd.RunSQL StrSQL\nDoCmd.SetWarnings True\n\nMsgBox (\"Comment Added\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 3, "creation_date": 1556749449, "post_id": 55941999, "comment_id": 98540032, "body": "what does debug.print .responsetext produce?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1556759124, "post_id": 55941999, "comment_id": 98541784, "body": "I&#39;d suggest using a JSON Parser"}, {"owner": {"reputation": 11, "user_id": 11438764, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fhbra0AyhkU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3retc4lT6i1u130DdeByGNyHXQNVNA/mo/photo.jpg?sz=128", "display_name": "hodpy62", "link": "https://stackoverflow.com/users/11438764/hodpy62"}, "edited": false, "score": 0, "creation_date": 1556863690, "post_id": 55941999, "comment_id": 98579045, "body": "Hi Guys, can you show me how to try these things in code please?  I\u2019m a tinkerer and edit other peoples code when I can but not very experienced."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556917136, "post_id": 55941999, "comment_id": 98604572, "body": "before <i>lineS = Split(.responsetext, vbLf)</i>  put the line debug.print .responsetext  and then add the output from the immediate window (Ctrl + G) into the question via <a href=\"https://stackoverflow.com/posts/55941999/edit\">edit</a>"}], "owner": {"reputation": 11, "user_id": 11438764, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fhbra0AyhkU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3retc4lT6i1u130DdeByGNyHXQNVNA/mo/photo.jpg?sz=128", "display_name": "hodpy62", "link": "https://stackoverflow.com/users/11438764/hodpy62"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1556740912, "creation_date": 1556740784, "last_edit_date": 1556740912, "question_id": 55941999, "link": "https://stackoverflow.com/questions/55941999/get-data-from-google-maps-api-with-vba", "title": "Get Data From Google Maps API with vba", "body": "<p>I am trying to get excel to extract driving time and distance using the google maps api.  I cannot get it to pull any data out at all.</p>\n\n<pre><code>Sub main()\n    Dim a, b, i, Str As String\n    Dim lineS As Variant\n    On Error Resume Next\n    'Application.ScreenUpdating = False\n    With CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n        a = CStr(ThisWorkbook.Worksheets(1).Range(\"B3\"))\n        Dim iRow As Long: iRow = ThisWorkbook.Worksheets(1).Range(\"G6500\").End(xlUp).Row\n        For j = 5 To iRow\n            b = ThisWorkbook.Worksheets(1).Range(\"R\" &amp; j)\n            .Open \"GET\", \"https://maps.googleapis.com/maps/api/distancematrix/json?origins=\" &amp; a &amp; \"&amp;destinations=\" &amp; b &amp; \"&amp;mode=driving&amp;key=[hidden from this post]\", False\n            .send\n            lineS = Split(.responsetext, vbLf)\n            linS = .response\n                For k = 25 To UBound(lineS)\n                    If Trim(lineS(k)) = \"\"\"distance\"\" : {\" Then\n                        Exit For\n                    End If\n                Next k\n            ThisWorkbook.Worksheets(1).Range(\"s\" &amp; j) = lineS(k + 1)\n            ThisWorkbook.Worksheets(1).Range(\"t\" &amp; j) = lineS(k + 5)\n            Application.Wait (Now + TimeValue(\"0:00:01\"))\n        Next j\n    End With\n    'Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>The api works and looks like this in a browser:</p>\n\n<pre><code>\n{\n   \"destination_addresses\" : [ \"Aberdeen AB11, UK\" ],\n   \"origin_addresses\" : [ \"Harwich CO12, UK\" ],\n   \"rows\" : [\n      {\n         \"elements\" : [\n            {\n               \"distance\" : {\n                  \"text\" : \"899 km\",\n                  \"value\" : 898569\n               },\n               \"duration\" : {\n                  \"text\" : \"9 hours 32 mins\",\n                  \"value\" : 34292\n               },\n               \"status\" : \"OK\"\n            }\n         ]\n      }\n   ],\n   \"status\" : \"OK\"\n}\n\n</code></pre>\n\n<p>Any help is much appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1556739302, "post_id": 55941627, "comment_id": 98536589, "body": "Is <code>target</code> declared and assigned anywhere? You should provide more code in the form of a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 0, "creation_date": 1556739417, "post_id": 55941627, "comment_id": 98536621, "body": "FYI error 424 means &#39;Object Required&#39;. See: <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/object-required-error-424\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1556739432, "post_id": 55941627, "comment_id": 98536625, "body": "Always put <code>Option Explicit</code> at the top of every module, that will prevent the code from compiling with undeclared variables. You&#39;re getting error 424 &quot;Object Required&quot; because <code>target</code> is an undeclared variable (and thus a <code>Variant&#47;Empty</code>) against which a member call is not possible, because it&#39;s not an object and as such, doesn&#39;t have any members to invoke."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556739552, "post_id": 55941627, "comment_id": 98536679, "body": "&quot;The following code is part of a worksheet change event&quot; - so <code>Target</code> should already be declared in that context?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556739648, "post_id": 55941627, "comment_id": 98536714, "body": "<code>FILLABLE_TOP_MER</code> etc are what exactly?  If not range objects then that&#39;s a problem you need to fix."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556739660, "post_id": 55941627, "comment_id": 98536724, "body": "@TimWilliams ah, missed that. Guessing <code>FILLABLE_XXXXX</code> aren&#39;t objects then. They should be <code>Range</code> instances; OP needs to <a href=\"https://stackoverflow.com/posts/55941627/edit\">edit</a> and show us how <code>FILLABLE_XXXXXX</code> variables (constants?) are being declared+assigned."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11438619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fa12f498d7244d65e634e973bdc86a7?s=128&d=identicon&r=PG&f=1", "display_name": "FemaleWill", "link": "https://stackoverflow.com/users/11438619/femalewill"}, "edited": false, "score": 0, "creation_date": 1556742200, "post_id": 55941795, "comment_id": 98537749, "body": "Thanks to everyone that provided input, but this solved my problem perfectly! Thank you, Mathieu!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1556739822, "creation_date": 1556739822, "answer_id": 55941795, "question_id": 55941627, "link": "https://stackoverflow.com/questions/55941627/how-do-i-declare-and-assign-an-object-for-this-line-of-code/55941795#55941795", "title": "How do I declare and assign an object for this line of code?", "body": "<p><code>Union</code> works with <code>Range</code> objects. Assuming <code>FILLABLE_TOP_MER</code> is a <code>String</code> containing the name of a <code>Name</code>, then you need to get the <code>Range</code> for these names:</p>\n\n<pre><code>Dim FillableTopMerRange As Range\nSet FillableTopMerRange = ThisWorkbook.Names(FILLABLE_TOP_MER).RefersToRange\n\nDim FillableTopRegRange As Range\nSet FillableTopRegRange = ThisWorkbook.Names(FILLABLE_TOP_REG).RefersToRange\n\n'...\n\nIf ... And Intersect(Target, Union(FillableTopMerRange, FillableTopRegRange, ...)) Is Nothing Then...\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11438619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fa12f498d7244d65e634e973bdc86a7?s=128&d=identicon&r=PG&f=1", "display_name": "FemaleWill", "link": "https://stackoverflow.com/users/11438619/femalewill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556739822, "creation_date": 1556738932, "last_edit_date": 1556739167, "question_id": 55941627, "link": "https://stackoverflow.com/questions/55941627/how-do-i-declare-and-assign-an-object-for-this-line-of-code", "title": "How do I declare and assign an object for this line of code?", "body": "<p>I'm new to VBA and I'm having difficulty understanding the concept of declaring an object within code... </p>\n\n<p>The following code is part of a worksheet change event, which directs the user to \"F6\" when the user attempts to select any of the three \"FILLABLE\" name ranges established on sheet1 of my workbook.\nI consolidated this code from several working if statements using the \"union\" function and now I'm receiving run-time error '424' whenever I run my macro.</p>\n\n<pre><code>Set ws = ThisWorkbook.Sheets(\"Inventory in-out\")\n\nIf target.Row &lt; 14 And Intersect(target, Union(FILLABLE_TOP_MER, FILLABLE_TOP_REG, FILLABLE_TOP_NOMSG)) Is Nothing Then\n    Range(\"F6\").Select\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "image", "outlook"], "comments": [{"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1556739783, "post_id": 55941325, "comment_id": 98536785, "body": "I believe there may be some issue with your .htm file.  Are the images local references?  I took your code verbatim and  set .HTMLBody = &quot;&lt;img src =(put image url here)&gt;&quot; and i had no issues loading an image. It also worked with generic strings in place of strBody and the HTML snippet in place of the sText."}, {"owner": {"reputation": 238, "user_id": 3075004, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c93e29376ecb9bec13c6d6edd59e37be?s=128&d=identicon&r=PG&f=1", "display_name": "Peekay", "link": "https://stackoverflow.com/users/3075004/peekay"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1556764152, "post_id": 55941325, "comment_id": 98542637, "body": "There are multiple images in the .html file. There is also text which is formatted into table with two columns. Does this change anything?"}], "answers": [{"comments": [{"owner": {"reputation": 238, "user_id": 3075004, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c93e29376ecb9bec13c6d6edd59e37be?s=128&d=identicon&r=PG&f=1", "display_name": "Peekay", "link": "https://stackoverflow.com/users/3075004/peekay"}, "edited": false, "score": 0, "creation_date": 1556764139, "post_id": 55942292, "comment_id": 98542631, "body": "There are multiple images in the .html file. There is also text which is formatted into table with two columns. Does this change anything?"}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "reply_to_user": {"reputation": 238, "user_id": 3075004, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c93e29376ecb9bec13c6d6edd59e37be?s=128&d=identicon&r=PG&f=1", "display_name": "Peekay", "link": "https://stackoverflow.com/users/3075004/peekay"}, "edited": false, "score": 0, "creation_date": 1556775993, "post_id": 55942292, "comment_id": 98545227, "body": "Yes you need to adapt it to your specific needs. Declare another global variable to copy the table into in the loop just before the \u2018call SendEmail\u2019. Depends how exactly your excel file is you need to tweak the login ex maybe the table is in a different worksheet than putting it in the for loop will make no sense and you need another way to do it maybe another loop that goes through the second sheet or if you only have one table that you need to send to all you don\u2019t need to put it in a loop just set the range on that table and you can call the variable in the sendEmail."}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "reply_to_user": {"reputation": 238, "user_id": 3075004, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c93e29376ecb9bec13c6d6edd59e37be?s=128&d=identicon&r=PG&f=1", "display_name": "Peekay", "link": "https://stackoverflow.com/users/3075004/peekay"}, "edited": false, "score": 0, "creation_date": 1556777399, "post_id": 55942292, "comment_id": 98545730, "body": "Regarding your .html file with multiple images I\u2019m not sure what you mean exactly. If .html is like a container for multiple images and you want to display them in the body of the email that will not work. You need to have individual images in a folder and have a good name convention ex Img1 and do a for loop and increment I every time depending on how many img you want to add or the easy way if you have 10 img declare 10 variable for each img and were you see in my code photoSize replace it with yours in by one and you need to use \u2018&amp;\u2019 in between and good to go."}, {"owner": {"reputation": 238, "user_id": 3075004, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c93e29376ecb9bec13c6d6edd59e37be?s=128&d=identicon&r=PG&f=1", "display_name": "Peekay", "link": "https://stackoverflow.com/users/3075004/peekay"}, "edited": false, "score": 0, "creation_date": 1556783297, "post_id": 55942292, "comment_id": 98548298, "body": "If .html is like a container for multiple images and you want to display them in the &quot;body of the email&quot; - Yes. This is the issue. Then there are hyperlinks attached to the images. Looping is complex. I am contemplating making it .mht file. But not sure the code will work. We need a binary mode reader in GetFile. It cannot be opened as a text stream I guess. \u2013"}, {"owner": {"reputation": 238, "user_id": 3075004, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c93e29376ecb9bec13c6d6edd59e37be?s=128&d=identicon&r=PG&f=1", "display_name": "Peekay", "link": "https://stackoverflow.com/users/3075004/peekay"}, "edited": false, "score": 0, "creation_date": 1556783525, "post_id": 55942292, "comment_id": 98548400, "body": "may be the solution in this question will work <a href=\"https://stackoverflow.com/questions/35609112/how-to-send-a-word-document-as-body-of-an-email-with-vba\" title=\"how to send a word document as body of an email with vba\">stackoverflow.com/questions/35609112/&hellip;</a> But how to put the copied content from word document below a customized email content that is generated using some variables in the excel fields."}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "reply_to_user": {"reputation": 238, "user_id": 3075004, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c93e29376ecb9bec13c6d6edd59e37be?s=128&d=identicon&r=PG&f=1", "display_name": "Peekay", "link": "https://stackoverflow.com/users/3075004/peekay"}, "edited": false, "score": 0, "creation_date": 1556795051, "post_id": 55942292, "comment_id": 98554179, "body": "It might be easier if you just have just the images and assign to variable then you can easily insert it in the body of the email."}], "tags": [], "owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "is_accepted": false, "score": 0, "last_activity_date": 1556742898, "last_edit_date": 1556742898, "creation_date": 1556742280, "answer_id": 55942292, "question_id": 55941325, "link": "https://stackoverflow.com/questions/55941325/embedding-an-html-file-with-images-in-an-outlook-email-generated-by-excel-vba/55942292#55942292", "title": "Embedding an HTML file with images in an Outlook email generated by Excel VBA", "body": "<p>Here ia an example that works for me you need to adapt it according to your needs.\nThis will embed the image in the body of the email and will attach it from what I remember. Please note you need to display the email first and then send it that is the only way to show on different device, i learn that the hard way. It can be done via code as the below example if you want to display and review the email just comment out the <code>.Send</code> after you are happy you can press manually <code>send</code>. </p>\n\n<pre><code>Option Explicit\nDim titleName As String\nDim firstName As String\nDim lastName As String\nDim fullName As String\nDim clientEmail As String\nDim ccEmail As String\nDim bccEmail As String\nDim emailMessage As String\n\nSub GenerateInfo()\n\n    Dim WS As Worksheet\n    Dim lrow As Long\n    Dim cRow As Long\n\n    Set WS = ActiveSheet\n\n    With WS\n        lrow = .Range(\"E\" &amp; .Rows.Count).End(xlUp).Row\n        Application.ScreenUpdating = False\n        For cRow = 2 To lrow\n            If Not .Range(\"L\" &amp; cRow).value = \"\" Then\n                titleName = .Range(\"D\" &amp; cRow).value\n                firstName = .Range(\"E\" &amp; cRow).value\n                lastName = .Range(\"F\" &amp; cRow).value\n                fullName = firstName &amp; \" \" &amp; lastName\n                clientEmail = .Range(\"L\" &amp; cRow).value\n\n                Call SendEmail\n\n                .Range(\"Y\" &amp; cRow).value = \"Yes\"\n                .Range(\"Y\" &amp; cRow).Font.Color = vbGreen\n\n            Else\n                .Range(\"Y\" &amp; cRow).value = \"No\"\n                .Range(\"Y\" &amp; cRow).Font.Color = vbRed\n            End If\n        Next cRow\n    End With\n\n    Application.ScreenUpdating = True\n\n    MsgBox \"Process completed!\", vbInformation\n\nEnd Sub\nSub SendEmail()\n\n    Dim outlookApp As Object\n    Dim outlookMail As Object\n    Dim sigString As String\n    Dim Signature As String\n    Dim insertPhoto As String\n    Dim photoSize As String\n\n    Set outlookApp = CreateObject(\"Outlook.Application\")\n    Set outlookMail = outlookApp.CreateItem(0)\n\n    'Change only Mysig.htm to the name of your signature\n    sigString = Environ(\"appdata\") &amp; _\n                \"\\Microsoft\\Signatures\\Marius.htm\"\n\n    If Dir(sigString) &lt;&gt; \"\" Then\n        Signature = GetBoiler(sigString)\n    Else\n        Signature = \"\"\n    End If\n\n    insertPhoto = \"C:\\Users\\marius\\Desktop\\Presale.jpg\" 'Picture path\n    photoSize = \"&lt;img src=\"\"cid:Presale.jpg\"\"height=400 width=400&gt;\" 'Change image name here\n\n    emailMessage = \"&lt;BODY style=font-size:11pt;font-family:Calibri&gt;Dear \" &amp; titleName &amp; \" \" &amp; fullName &amp; \",\" &amp; _\n                    \"&lt;p&gt;I hope my email will find you very well.\" &amp; _\n                    \"&lt;p&gt;Our &lt;strong&gt;sales preview&lt;/strong&gt; starts on Thursday the 22nd until Sunday the 25th of November.\" &amp; _\n                    \"&lt;p&gt;I look forward to welcoming you into the store to shop on preview.&lt;p&gt;\" &amp; _\n                    \"&lt;p&gt; It really is the perfect opportunity to get some fabulous pieces for the fast approaching festive season.\" &amp; _\n                    \"&lt;p&gt;Please feel free to contact me and book an appointment.\" &amp; _\n                    \"&lt;p&gt;I look forward to seeing you then.\" &amp; _\n                    \"&lt;p&gt;\" &amp; photoSize &amp; _\n                    \"&lt;p&gt;Kind Regards,\" &amp; _\n                    \"&lt;br&gt;\" &amp; _\n                    \"&lt;br&gt;&lt;strong&gt;Marius&lt;/strong&gt;\" &amp; _\n                    \"&lt;br&gt;Assistant Store Manager\" &amp; _\n                    \"&lt;p&gt;\"\n\n\n    With outlookMail\n        .To = clientEmail\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"PRIVATE SALE\"\n        .BodyFormat = 2\n        .Attachments.Add insertPhoto, 1, 0\n        .HTMLBody = emailMessage &amp; Signature 'Including photo insert and signature\n        '.HTMLBody = emailMessage &amp; Signature 'Only signature\n        .Importance = 2\n        .ReadReceiptRequested = True\n        .Display\n        .Send\n\n    End With\n\n    Set outlookApp = Nothing\n    Set outlookMail = Nothing\nEnd Sub\nFunction GetBoiler(ByVal sFile As String) As String\n\n    Dim fso As Object\n    Dim ts As Object\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set ts = fso.GetFile(sFile).OpenAsTextStream(1, -2)\n    GetBoiler = ts.readall\n    ts.Close\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 238, "user_id": 3075004, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c93e29376ecb9bec13c6d6edd59e37be?s=128&d=identicon&r=PG&f=1", "display_name": "Peekay", "link": "https://stackoverflow.com/users/3075004/peekay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1229, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574537483, "creation_date": 1556737544, "last_edit_date": 1574537483, "question_id": 55941325, "link": "https://stackoverflow.com/questions/55941325/embedding-an-html-file-with-images-in-an-outlook-email-generated-by-excel-vba", "title": "Embedding an HTML file with images in an Outlook email generated by Excel VBA", "body": "<p>I want to send a personalized email generated by Excel VBA.</p>\n\n<p>The email contains personalized text followed by a html file that contains images.</p>\n\n<p>I tried the following code but the images are not displayed. </p>\n\n<pre><code>Sub Mail_Outlook_With_Html_Doc()\n\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim strbody As String\n    Dim oFSO As Object\n    Dim oFS As Object\n    Dim sText As String            \n\n    Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set oFS = oFSO.OpenTextFile(\"C:\\....\\invite.htm\")\n\n    Do Until oFS.AtEndOfStream\n        sText = oFS.ReadAll()\n    Loop\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    'strbody = personalized email body generated here\n\n    On Error Resume Next\n\n    With OutMail\n        .display\n        .To = ToAdd\n        .CC = \n        .BCC = \"\"\n        .Subject = \"Test Email\"\n        .ReadReceiptRequested = True\n\n        ' the html file is appended here to the personalized email body generated\n        .HTMLBody = strbody &amp; sText\n        .Send\n    End With\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>The invite.htm referred above contains images which are not visible when the email is sent. Neither in the email messages sent nor in the email messages received.</p>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1556737849, "post_id": 55941320, "comment_id": 98536034, "body": "Are the names you are pulling from the Combo Box the display names of the email address in your address book or are they all just first name[space]last name?  Generally speaking if the first and last name of the email recipient are going to be the &quot;same&quot; as the email, you could simply do <code>.To = replace(comboA.Value,&quot; &quot;,&quot;.&quot;) &amp; &quot;@xyz.com&quot;</code> etc etc"}, {"owner": {"reputation": 1, "user_id": 11438461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97e19e8ac07d05d0c59d9d59741003b5?s=128&d=identicon&r=PG&f=1", "display_name": "floatsonwater", "link": "https://stackoverflow.com/users/11438461/floatsonwater"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1556739544, "post_id": 55941320, "comment_id": 98536674, "body": "ha, that was too easy. It worked great! Next problem though is if a user does&#39;t select a name from one of the combo boxes when the email is created is enters @xyz.com. How can I skip reading a combo box if nothing was selected?"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1556740815, "post_id": 55941320, "comment_id": 98537228, "body": "Something like this. I think the way you&#39;re pulling your addresses in could use some adjustment but this should get you there.  Just make sure to pull out the trailing comma for the very last value otherwise it may error when sending.  <code>IIf(IsNull(comboA.Value) = False, Replace(comboA.Value, &quot; &quot;, &quot;.&quot;) &amp; &quot;@xyz.com&quot; &amp; &quot;, &quot;, &quot;&quot;)</code>"}, {"owner": {"reputation": 1, "user_id": 11438461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97e19e8ac07d05d0c59d9d59741003b5?s=128&d=identicon&r=PG&f=1", "display_name": "floatsonwater", "link": "https://stackoverflow.com/users/11438461/floatsonwater"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1556748922, "post_id": 55941320, "comment_id": 98539883, "body": "Seems to still return @xyz.com. I was using this. .To = IIf(IsNull(comboA.Value) = False, Replace(comboA.Value, &quot; &quot;, &quot;.&quot;) &amp; &quot;@xyz.com&quot; &amp; &quot;, &quot;, &quot;&quot;)"}, {"owner": {"reputation": 1, "user_id": 11438461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97e19e8ac07d05d0c59d9d59741003b5?s=128&d=identicon&r=PG&f=1", "display_name": "floatsonwater", "link": "https://stackoverflow.com/users/11438461/floatsonwater"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1556749130, "post_id": 55941320, "comment_id": 98539943, "body": "Open to suggestions too about how I was pulling the names in."}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1556749638, "post_id": 55941320, "comment_id": 98540067, "body": "Hmm, perhaps its a blank value as opposed to an unselected value? <code>.To = IIf(IsNull(comboA.Value) = 0 and trim(comboA.Value) &lt;&gt; &quot;&quot;, Replace(comboA.Value, &quot; &quot;, &quot;.&quot;) &amp; &quot;@xyz.com&quot; &amp; &quot;, &quot;, &quot;&quot;)</code>  Try that out. If that doesn&#39;t work, we&#39;re missing something."}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1556750158, "post_id": 55941320, "comment_id": 98540200, "body": "Regarding pulling the names in, if you want to make it a bit more scaleable and stop typing out new code each time you add a box you could loop through the form controls using For ctrl in Me.Controls and then checking the ctrl.tag = &quot;email&quot;.  You&#39;d have to set the tag(its a property in the combo box on the design page) for this to work though."}, {"owner": {"reputation": 1, "user_id": 11438461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97e19e8ac07d05d0c59d9d59741003b5?s=128&d=identicon&r=PG&f=1", "display_name": "floatsonwater", "link": "https://stackoverflow.com/users/11438461/floatsonwater"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1556753447, "post_id": 55941320, "comment_id": 98540828, "body": "That new line worked. Thanks Mike! I agree that code for pulling in names was not very scaleable. I&#39;ll look into your suggestions and see if I can improve it."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1556767603, "post_id": 55941320, "comment_id": 98543256, "body": "I suggest the CommandButton to send the email to be disabled until both the combo boxes has a selected value. Also by default, Outlook doesn&#39;t take comma as separating email addresses."}, {"owner": {"reputation": 1, "user_id": 11438461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97e19e8ac07d05d0c59d9d59741003b5?s=128&d=identicon&r=PG&f=1", "display_name": "floatsonwater", "link": "https://stackoverflow.com/users/11438461/floatsonwater"}, "edited": false, "score": 0, "creation_date": 1556805492, "post_id": 55941320, "comment_id": 98560080, "body": "Your right, updated comma to semi-colon. Thanks"}], "owner": {"reputation": 1, "user_id": 11438461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97e19e8ac07d05d0c59d9d59741003b5?s=128&d=identicon&r=PG&f=1", "display_name": "floatsonwater", "link": "https://stackoverflow.com/users/11438461/floatsonwater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556737527, "creation_date": 1556737527, "question_id": 55941320, "link": "https://stackoverflow.com/questions/55941320/using-vba-format-the-first-and-last-name-into-an-email-address-for-outlook", "title": "Using VBA format the first and last name into an email address for Outlook", "body": "<p>I have a user form with several combo boxes that is populated with names that is read from a worksheet in excel. After a user selects a name from each combo box and clicks the submit button it will open Outlook to send an email to those people. The code works fine, but I need help reformatting the names. </p>\n\n<p>How can I reformat the first and last name into a valid email? First and last name are read from a single cell.</p>\n\n<p>Example: \nJohn Smith (what is selected in combo box)\nconvert to --> john.smith@xzy.com</p>\n\n<p>.To = comboA.Value &amp; \", \" &amp; _<br>\n(This is the line that works to ready name, but does not format into an email)</p>\n\n<p>Also, if someone does not select a name from a combo box, is it possible to ignore this line and not try to enter something into Outlook?</p>\n\n<pre><code>Dim WS As Worksheet\nDim LastRow As Long\nDim bColumn As Range\nDim cColumn As Range\nDim dColumn As Range\nDim eColumn As Range\nDim fColumn As Range\nDim gColumn As Range\nDim hColumn As Range\nDim iColumn As Range\nDim jColumn As Range\nDim kColumn As Range\n\nSet WS = ActiveWorkbook.Worksheets(\"UserData\")\n\nWith WS\n    LastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n\n    For Each bColumn In .Range(\"B3:B\" &amp; LastRow)\n        If bColumn.Value &lt;&gt; \"\" Then\n            Me.comboA.AddItem bColumn.Value\n        End If\n    Next\nEnd With\n\nWith WS\n    LastRow = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n\n    For Each cColumn In .Range(\"C3:C\" &amp; LastRow)\n        If cColumn.Value &lt;&gt; \"\" Then\n            Me.comboB.AddItem cColumn.Value\n        End If\n    Next\nEnd With\n\n\nDim objOutlook As Object\nDim objEmail As Object\n\nSet objOutlook = CreateObject(\"Outlook.Application\")\nobjOutlook.Session.Logon\nSet objEmail = objOutlook.CreateItem(0)\nobjEmail.Display\nOn Error Resume Next\n\nWith objEmail\n    .To = comboA.Value &amp; \", \" &amp; _\n          comboB.Value &amp; \", \" &amp; _\n          comboC.Value &amp; \", \" &amp; _\n          comboD.Value &amp; \", \" &amp; _\n          comboE.Value &amp; \", \" &amp; _\n          comboF.Value &amp; \", \" &amp; _\n          comboG.Value\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1556738373, "post_id": 55941228, "comment_id": 98536217, "body": "Immediate suspicion is that your &quot;post&quot; database doesn&#39;t have enough columns to handle the data set you&#39;re trying to insert.  B5 to GG5 is a significant amount of columns.  Are you certain you have enough columns in the &quot;AA-AM&quot;. Which specifc line of code does the error present itself? On the <code>oRS.Fields(j) = oSelect.Cells(i, j)</code>  If that&#39;s the case, it may also be that you&#39;re hitting the end of the row in access before excel.  Fields is a 0 bounded array where 0 is the first item. This would cause you to start inserting on the second column in access form the first column in excel."}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1556738773, "post_id": 55941228, "comment_id": 98536361, "body": "Try <code>oRS.Fields(j-1)</code> instead."}, {"owner": {"reputation": 1, "user_id": 11438485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497341a3a3191dc5f9edc3ea4392fa1b?s=128&d=identicon&r=PG&f=1", "display_name": "carnold1991", "link": "https://stackoverflow.com/users/11438485/carnold1991"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1556748305, "post_id": 55941228, "comment_id": 98539717, "body": "Hm interesting, so I did the j-1 and i am not longer getting the error. Thank you. But now I do not see that the data is being post within Recordset AA-AM..I search all over the database but cannot find the new data"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1556749328, "post_id": 55941228, "comment_id": 98540002, "body": "Probably already gave this a shot, but if you have the table open already, hit F5 to refresh.  I&#39;ve basically utilized your code to test and it worked fine on my end.  I&#39;d suggest stepping through and debugging some of the code at the insert point. So step through up to the oRS.Fields(j) = and use something like <code>debug.print oSelect.Cells(i,j)</code> or hover over that portion to see if theres actively a value.  Good luck!"}, {"owner": {"reputation": 1, "user_id": 11438485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497341a3a3191dc5f9edc3ea4392fa1b?s=128&d=identicon&r=PG&f=1", "display_name": "carnold1991", "link": "https://stackoverflow.com/users/11438485/carnold1991"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1556824538, "post_id": 55941228, "comment_id": 98569415, "body": "Thanks Mike that worked, I realized the next hour or so it was working, I just was not refreshing. Thanks so much. So now I am running into a bit more of a problem if I run it more than once in a day, let say if data is updated..first run through is perfect, updates based on today. The Access DB won&#39;t let me post more than one date so I have to manually go back in and delete those rows or else I get a run time error 3022. This is because date is primary key and I cannot change that, so cannot have duplicates. I am trying an IF function on the SQL code with no luck"}, {"owner": {"reputation": 1, "user_id": 11438485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497341a3a3191dc5f9edc3ea4392fa1b?s=128&d=identicon&r=PG&f=1", "display_name": "carnold1991", "link": "https://stackoverflow.com/users/11438485/carnold1991"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1556824785, "post_id": 55941228, "comment_id": 98569536, "body": "formatting will look weird but here&#39;s the If I&#39;m trying to develop SQL = &quot;SELECT [AA-AM].Dates &quot;     SQL = SQL &amp; &quot;FROM [AA-AM] &quot;     SQL = SQL &amp; &quot;WHERE [AA-AM].Dates = Date()&quot;          If SQL = Date Then     &#39;blank here on purpose, do not want it do to anything     Else          For i = 1 To oSelect.Rows.Count         rs.AddNew     For j = 1 To oSelect.Columns.Count         rs.Fields(j - 1) = oSelect.Cells(i, j)     Next j     rs.Update     Next i     End If"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1557151159, "post_id": 55941228, "comment_id": 98659029, "body": "Quick option to do this is adjust your <code>oDB.OpenRecordset(&quot;AA-AM&quot;)</code> to <code>oDB.OpenRecordset(&quot;AA-AM&quot;, dbOpenDynaset)</code>. This will open as a dynaset vs table type recordset and then we can do <code>oRS.FindFirst(&quot;date = &quot; &amp; date())</code>.  Then block your two For loops in a large if statement with the criteria <code>If oRS.NoMatch = True Then &quot;update code&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11438485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497341a3a3191dc5f9edc3ea4392fa1b?s=128&d=identicon&r=PG&f=1", "display_name": "carnold1991", "link": "https://stackoverflow.com/users/11438485/carnold1991"}, "edited": false, "score": 0, "creation_date": 1556824597, "post_id": 55951123, "comment_id": 98569438, "body": "Thanks Harassed! Got that to work with the help of you and Mike. As I said above to Mike, I am now running into a run time error of 3022 if I try to post more than once a day because date is primary key and I cannot change that, so cannot create duplicates. Hope that makes sense. I am trying an IF function on the SQL code with no luck"}, {"owner": {"reputation": 1, "user_id": 11438485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497341a3a3191dc5f9edc3ea4392fa1b?s=128&d=identicon&r=PG&f=1", "display_name": "carnold1991", "link": "https://stackoverflow.com/users/11438485/carnold1991"}, "edited": false, "score": 0, "creation_date": 1556824742, "post_id": 55951123, "comment_id": 98569508, "body": "SQL = &quot;SELECT [AA-AM].Dates &quot;     SQL = SQL &amp; &quot;FROM [AA-AM] &quot;     SQL = SQL &amp; &quot;WHERE [AA-AM].Dates = Date()&quot;          If SQL = Date Then     &#39;blank here on purpose, do not want it do to anything     Else          For i = 1 To oSelect.Rows.Count         rs.AddNew     For j = 1 To oSelect.Columns.Count         rs.Fields(j - 1) = oSelect.Cells(i, j)     Next j     rs.Update     Next i     End If"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1556795309, "creation_date": 1556795309, "answer_id": 55951123, "question_id": 55941228, "link": "https://stackoverflow.com/questions/55941228/transmit-data-from-excel-to-access-table/55951123#55951123", "title": "Transmit data from Excel to Access table", "body": "<p>The error is here</p>\n\n<pre><code> For j = 1 To oSelect.Columns.Count\n    oRS.Fields(j) = oSelect.Cells(i, j)\nNext j\n</code></pre>\n\n<p>Fields is a zero based array so you are putting the data into the wrong field and when you get to the last column you attempt to access a field that isn't there. You want</p>\n\n<pre><code>For j = 1 To oSelect.Columns.Count\n    oRS.Fields(j-1) = oSelect.Cells(i, j)\nNext j\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11438485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497341a3a3191dc5f9edc3ea4392fa1b?s=128&d=identicon&r=PG&f=1", "display_name": "carnold1991", "link": "https://stackoverflow.com/users/11438485/carnold1991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556795309, "creation_date": 1556737023, "last_edit_date": 1556779585, "question_id": 55941228, "link": "https://stackoverflow.com/questions/55941228/transmit-data-from-excel-to-access-table", "title": "Transmit data from Excel to Access table", "body": "<p>After going through online forums, I have developed some code to pull data from an X Access database and place within an excel, which is working successfully. From there, I want to take this data and place within another Access database. Think of the excel as the intermediary where, at some point (this is a project given by my boss), the excel will help produce calculations and that info will be taken to the other Access database. For the time being, I just want X Access data to be placed into Y Access sheet. I am having an issue with that placement. In Y Access database I want to head to the last row, insert a row, and place the data within. Sounds easy, but giving me a problem at the end in the DataPost() sub. For the below:</p>\n\n<pre><code>For i = 1 To oSelect.Rows.Count\n    oRS.AddNew\nFor j = 1 To oSelect.Columns.Count\n    oRS.Fields(j) = oSelect.Cells(i, j)\nNext j\noRS.Update\nNext i\noDB.Close\n</code></pre>\n\n<p>I am getting a Run-time error 3265 saying Item not found in this collection. I can walk through the code and see the data being selected, but when it gets to the end gives me that error.</p>\n\n<p>I am using DAO connections, code below for the Pull and Post (problem) code. Online I see a lot of other options such as ADO, but I can't add outside of DAO connections I believe. I want to be able to provide the DataPull info as well so you can see my DAO logic I got from some others online.</p>\n\n<p>The SQL Select is much longer, but was having error placing it within this forum so cut it down.</p>\n\n<pre><code>Sub DataPull()\n\n    Const DbLoc As String = \"C:\\WIP\\PullSample.accdb\"\n    Dim db As DAO.Database, rs As DAO.Recordset, wkb As Workbook, wks As Worksheet, wks2 As Worksheet, recCount As Long\n    Dim SQL As String, i As Double, n As Double, lr As Double, t As Double\n\n\n    Set wkb = ActiveWorkbook\n    Set wks = wkb.Worksheets(1)\n    Set wks2 = wkb.Worksheets(2)\n    Set db = OpenDatabase(DbLoc)\n\n    SQL = \"SELECT [AA-AM].Dates, [AA-AM].[A US Equity]\"\n    SQL = SQL &amp; \"FROM [AA-AM] \"\n    SQL = SQL &amp; \"WHERE [AA-AM].Dates = Date() \"\n\n    Set rs = db.OpenRecordset(SQL, dbOpenSnapshot)\n\n    wks2.Range(\"B5\").CopyFromRecordset rs\n    wks2.Range(\"B5:GG5\").Font.Name = \"Garamond\"\n    wks2.Range(\"B5:GG5\").Font.Size = 10\n\n    wks2.Range(\"C5:GG5\").Copy\n    wks.Range(\"D6\").PasteSpecial Transpose:=True\n\n    Set rs = Nothing\n    Set wks = Nothing\n    Set wks2 = Nothing\n    Set wkb = Nothing\n\n\n      End Sub\n\n    Sub DataPost()\n\n    Dim oSelect As Range, i As Long, j As Integer, sPath As String\n    Dim lr as long\n    Dim wkb As Workbook, wks As Worksheet, wks2 As Worksheet\n    Dim oDAO As DAO.DBEngine, oDB As DAO.Database\n    Dim oRS As DAO.Recordset\n    Const DbLoc As String = \"C:\\WIP\\ProjPullDB.accdb\"\n\n    Set wkb = ActiveWorkbook\n    Set wks = wkb.Worksheets(1)\n    Set wks2 = wkb.Worksheets(2)\n    Set oSelect = wks2.Range(\"B5:GG5\")\n\n    'wks2.Activate\n    'oSelect.Copy\n\n    Set oDAO = New DAO.DBEngine\n    Set oDB = oDAO.OpenDatabase(DbLoc)\n    Set oRS = oDB.OpenRecordset(\"AA-AM\")\n\n    For i = 1 To oSelect.Rows.Count\n        oRS.AddNew\n    For j = 1 To oSelect.Columns.Count\n        oRS.Fields(j) = oSelect.Cells(i, j)\n    Next j\n    oRS.Update\n    Next i\n    oDB.Close\n\nEnd Sub\n</code></pre>\n\n<p>I expect to be able to place the <code>oSelect</code> data <code>wk2.Range(\"B5:GG5\")</code> data into the Y Access database last row, but no luck.</p>\n"}, {"tags": ["excel", "vba", "filtering", "autofilter"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 2, "creation_date": 1556735983, "post_id": 55940996, "comment_id": 98535287, "body": "What is the other filter criteria? On what field? (I.E. are you filtering the same column?)"}, {"owner": {"reputation": 7, "user_id": 10821119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DFEgC.jpg?s=128&g=1", "display_name": "MM18", "link": "https://stackoverflow.com/users/10821119/mm18"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1556743610, "post_id": 55940996, "comment_id": 98538221, "body": "Slightly different parameters but same concept.  It would be Field: =38 and Criteria2:=&quot;Employee&quot;.    I&#39;m just not sure of the syntax."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1556813730, "post_id": 55940996, "comment_id": 98564695, "body": "I updated the answer; when I combined your with statement to include the range, I failed to remove the <code>.</code> from <code>.Cells(.Rows</code>, a hazard of copy_paste"}, {"owner": {"reputation": 7, "user_id": 10821119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DFEgC.jpg?s=128&g=1", "display_name": "MM18", "link": "https://stackoverflow.com/users/10821119/mm18"}, "edited": false, "score": 0, "creation_date": 1556825256, "post_id": 55940996, "comment_id": 98569760, "body": "I appreciate your help, but still something&#39;s not quite meshing right.  I don&#39;t receive an error, but nothing happens when I run my macro. i&#39;ve updated the question to include my entire code. Any ideas? Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 10821119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DFEgC.jpg?s=128&g=1", "display_name": "MM18", "link": "https://stackoverflow.com/users/10821119/mm18"}, "edited": false, "score": 0, "creation_date": 1556807809, "post_id": 55942712, "comment_id": 98561396, "body": "For some reason I get &quot;Invalid or unqualified reference&quot; when i try this method."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": true, "score": 0, "last_activity_date": 1556813297, "last_edit_date": 1556813297, "creation_date": 1556744806, "answer_id": 55942712, "question_id": 55940996, "link": "https://stackoverflow.com/questions/55940996/how-do-i-add-another-filter-to-my-vba-code/55942712#55942712", "title": "How do i add another filter to my VBA Code?", "body": "<p>To filter a range for multiple criteria in a single column use <code>Or</code>...</p>\n\n<pre><code>With Wb1.Sheets(12).Range(\"$A$1:$AM\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row)\n    .AutoFilter Field:=19, Criteria1:=\"Test,Test\", Operator:=xlOr, Criteria2:=\"No\"\n    'Do stuff\nEnd With\n</code></pre>\n\n<p>To filter more than 2 criteria in a column you must use an array...</p>\n\n<pre><code>Criteria1:=Array(\"Test,Test\", \"No\", \"Yes\") \n</code></pre>\n\n<p>To filter a range for multiple criteria in different columns (you must set two fields)...</p>\n\n<pre><code>    With Wb1.Sheets(12).Range(\"$A$1:$AM\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row)\n        If AutoFilterMode Then .AutoFilterMode = False\n        .AutoFilter Field:=19, Criteria1:=\"Test,Test\"\n        .AutoFilter Field:=38, Criteria1:=\"Employee\"\n        'do stuff\n   End With\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 10821119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DFEgC.jpg?s=128&g=1", "display_name": "MM18", "link": "https://stackoverflow.com/users/10821119/mm18"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 55942712, "answer_count": 1, "score": 0, "last_activity_date": 1556825440, "creation_date": 1556735846, "last_edit_date": 1556825440, "question_id": 55940996, "link": "https://stackoverflow.com/questions/55940996/how-do-i-add-another-filter-to-my-vba-code", "title": "How do i add another filter to my VBA Code?", "body": "<p>I've created code in VBA that filters my data befre transferring but I'd like to add an additional filter. </p>\n\n<p>How would I go about that ? </p>\n\n<p>I've tried simply adding a row under Criteria 1 with the new values but it doesn't work. </p>\n\n<pre><code> With Wb1.Sheets(12)\n            If .AutoFilterMode Then .AutoFilterMode = False\n            .Range(\"$A$1:$AM\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row).AutoFilter Field:=19, _\n     Criteria1:=\"Test,Test\"\n            Set rngToCopy = .AutoFilter.Range\n        End With\n        rngToCopy.Copy\n        wb2.Sheets(2).Range(\"$A1\").PasteSpecial xlValues\n    End If\n    ThisWorkbook.RefreshAll\n</code></pre>\n\n<p>Still having issues for some reason, here's the entire code. When I execute, I dont' receive an error, but nothing copies. </p>\n\n<pre><code>\nSub CopyData()\n    On Error GoTo ErrorHandle\n\n\n    Application.ScreenUpdating = False\n\n\n    Dim Wb1 As Workbook, wb2 As Workbook, wB As Workbook\n    Dim rngToCopy As Range\n\n\n    For Each wB In Application.Workbooks\n        If Left(wB.Name, 21) = \"Test_Test Test\" Then\n            Set Wb1 = wB\n            Exit For\n        End If\n    Next\n\n\n    If Not Wb1 Is Nothing Then '&lt;~~ check if you actually found the needed workbook\n        Set wb2 = ThisWorkbook\n With Wb1.Sheets(12).Range(\"$A$1:$AM\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row)\n        If AutoFilterMode Then .AutoFilterMode = False\n        .AutoFilter Field:=19, Criteria1:=\"Test,Test\"\n        .AutoFilter Field:=38, Criteria1:=\"Employee\"\n        'do stuff\n        Set rngToCopy = .AutoFilter.Range\n   End With\n   rngToCopy.Copy\n        wb2.Sheets(2).Range(\"$A1\").PasteSpecial xlValues\n    End If\n    ThisWorkbook.RefreshAll\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1556735569, "post_id": 55940827, "comment_id": 98535126, "body": "Or use textboxes as &#39;labels&#39; with expression in ControlSource property referencing the other form control. No VBA."}], "answers": [{"comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1556735797, "post_id": 55940940, "comment_id": 98535215, "body": "And exactly how did you use <code>Form.Activate</code>? Did you mean <code>Form_Activate()</code> event?"}, {"owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1556736881, "post_id": 55940940, "comment_id": 98535660, "body": "Ahh yes! I just noticed i&#39;m missing the parenthesis"}], "tags": [], "owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "is_accepted": false, "score": 0, "last_activity_date": 1556736887, "last_edit_date": 1556736887, "creation_date": 1556735578, "answer_id": 55940940, "question_id": 55940827, "link": "https://stackoverflow.com/questions/55940827/access-vba-on-form-open-set-labels/55940940#55940940", "title": "Access VBA: On Form Open set Labels", "body": "<p>I have figured out my problem. There were many ways to go about solving this, but the simplest was to use <code>Form_Activate()</code></p>\n"}], "owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594780153, "creation_date": 1556735006, "last_edit_date": 1594780153, "question_id": 55940827, "link": "https://stackoverflow.com/questions/55940827/access-vba-on-form-open-set-labels", "title": "Access VBA: On Form Open set Labels", "body": "<p>I'm not sure how to phrase this so i'll just talk through it. There are multiple forms open at one time. A user bounces between a few of them through buttons that navigate through the forms. I am trying to make the labels change dynamically as they bounce through forms. The code below works on a Click event...</p>\n\n<pre><code>Private Sub Command56_Click()\n    Label21.Caption = Nz(Forms(\"User_Activities\").text14.Value)\n    Label22.Caption = Nz(Forms(\"User_Activities\").text16.Value)\n    Label23.Caption = Nz(Forms(\"User_Activities\").text18.Value)\n    Label24.Caption = Nz(Forms(\"User_Activities\").text20.Value)\n    Label25.Caption = Nz(Forms(\"User_Activities\").text22.Value)\n    Label26.Caption = Nz(Forms(\"User_Activities\").text24.Value)\n    Label27.Caption = Nz(Forms(\"User_Activities\").text26.Value)\n    Label28.Caption = Nz(Forms(\"User_Activities\").text28.Value)\n    Label29.Caption = Nz(Forms(\"User_Activities\").text30.Value)\n    Label30.Caption = Nz(Forms(\"User_Activities\").text32.Value)\nEnd Sub\n</code></pre>\n\n<p>I'm trying to figure out what to use instead of <code>Click</code> Here to make it dynamic. I've tried initialize, resize, and load. None of those work because the form is already open at the time.</p>\n"}, {"tags": ["excel", "vba", "sequence"], "comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 2, "creation_date": 1556735867, "post_id": 55940642, "comment_id": 98535244, "body": "Welcome to SO.  I would suggest trying out code first then when you run into a problem or get an unexpected result then edit this question with the code or post a new question.  SO is not a free code writing service.  With that being said, I would first look up how to determine the last row with data, which will be a great start."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1556736334, "post_id": 55940642, "comment_id": 98535418, "body": "<a href=\"https://stackoverflow.com/q/11169445/1188513\">This</a> should help getting started."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1557247550, "post_id": 55940642, "comment_id": 98697880, "body": "<code>lineNo</code> is a Long/Integer, a simple data type. There is no such thing as a <code>DataSeries</code> method. What exactly are you trying to do with that statement?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1557247621, "post_id": 55940642, "comment_id": 98697914, "body": "The <code>DataSeries</code> method belongs to the <code>Range</code> type object, not an integer/long: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.dataseries\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/excel.range.dataseri&zwnj;&#8203;es</a>"}, {"owner": {"reputation": 15, "user_id": 11438348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h6mmP.jpg?s=128&g=1", "display_name": "mjc5592", "link": "https://stackoverflow.com/users/11438348/mjc5592"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1557248027, "post_id": 55940642, "comment_id": 98698084, "body": "@DavidZemens When I change my data type for LineNo to range, it pops up a different error message, stating &quot;Run-time error &#39;91&#39;: Object variable or With block variable not set&quot;"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1557249348, "post_id": 55940642, "comment_id": 98698634, "body": "well, you need to <i>set</i> object variables, and you need to assign them properly. so, something like <code>lineNo = Range(&quot;B2&quot;).End(xlDown).Select</code> is explicitly wrong for several reasons. You&#39;re missing the required <code>Set</code> keyword in a range assignment statement, and also the range <code>Select</code> method returns a boolean, not an object reference."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1557249383, "post_id": 55940642, "comment_id": 98698649, "body": "so let&#39;s back up a few steps: what are you trying to do with <code>lineNo</code>? What is it supposed to represent in this code, and how do you intend to use it?"}, {"owner": {"reputation": 15, "user_id": 11438348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h6mmP.jpg?s=128&g=1", "display_name": "mjc5592", "link": "https://stackoverflow.com/users/11438348/mjc5592"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1557249960, "post_id": 55940642, "comment_id": 98698878, "body": "@DavidZemens lineNo represents the line number on an expense report that I am importing from a biweekly report into a master file of all expenses in a year. The code needs to find the last line number of the master file, take it&#39;s value, and go back to the biweekly report and fill in column B with a linear increase starting with the last line number of the master file + 1."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1557253073, "post_id": 55940642, "comment_id": 98700312, "body": "See the suggested link for help finding the last row. the <code>Select</code> method returns a boolean so it will only give you a value of 1/0. Instead of <code>Select</code>, use <code>.Row</code> property. But the link above should help in a more general sense."}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1556796043, "creation_date": 1556796043, "answer_id": 55951333, "question_id": 55940642, "link": "https://stackoverflow.com/questions/55940642/is-there-a-way-in-excel-vba-to-check-a-sequence-of-numbers-in-one-workbook-find/55951333#55951333", "title": "Is there a way in Excel VBA to check a sequence of numbers in one workbook, find the last one, and continue it in another workbook?", "body": "<p>Since the numbers are sequential you just need the largest number in that column of the old spreadsheet. So, let's assume your numbers are in column A of the first worksheet, and that sheet is called \"Sheet1\" and that your workbooks are called OLD.xls and New.Xls. The simplest way is to start with both workbooks open. Then in New.xls in the cell where you want to start the new sequence you can just type </p>\n\n<pre><code>    =MAX([Old.xls]Sheet1!A:A)+1\n</code></pre>\n\n<p>Now, when you close OLD.xls, Excel will edit the formula to store the full path to old.xls automatically. You can then save new.xls.</p>\n"}], "owner": {"reputation": 15, "user_id": 11438348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h6mmP.jpg?s=128&g=1", "display_name": "mjc5592", "link": "https://stackoverflow.com/users/11438348/mjc5592"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 537, "favorite_count": 0, "closed_date": 1557253012, "answer_count": 1, "score": 0, "last_activity_date": 1557246854, "creation_date": 1556734145, "last_edit_date": 1557246854, "question_id": 55940642, "link": "https://stackoverflow.com/questions/55940642/is-there-a-way-in-excel-vba-to-check-a-sequence-of-numbers-in-one-workbook-find", "closed_reason": "Duplicate", "title": "Is there a way in Excel VBA to check a sequence of numbers in one workbook, find the last one, and continue it in another workbook?", "body": "<p>I am trying to automate going through the LastLineNo (a linear sequence of numbers increasing by 1 each time) of one workbook, finding the last value at the bottom of the data, and starting the LastLineNo of a different Workbook with the final value found in the first workbook +1.</p>\n\n<p>EDIT: After some trial and error, I believe I have gotten closer to figuring it out. Now, I've gotten my code to look like this:</p>\n\n<pre><code>Dim lineNo As Long\nDim filePath As String\nDim nextValue As Long\nDim trial As Workbook\n\nfilePath = \"C:\\Users\\Michael Christ\\Documents\\Excel Work INP Automation Project\\Trialbook.xlsm\"\nSet trial = Workbooks.Open(filePath)\n\nlineNo = Range(\"B2\").End(xlDown).Select\n\nWorkbooks(1).Activate\nRange(\"B2\").Select\nlineNo.DataSeries rowcol:=xlColumns, Type:=xlLinear, Date:=xlDay, step:=1, stop:=Range(\"B2\").End(xlDown), Trend:=False\n</code></pre>\n\n<p>It is a public sub procedure.\nThe issue I am encountering at this stage is that I get an error when I run saying \"Compile error: invalid qualifier\" and it highlights the title of the procedure in yellow, and highlights the variable name lineNo attached to the DataSeries object. Anyone know why it's doing this?</p>\n\n<p>Thank you for the suggestions when I first asked this question, they were very helpful. Cheers.</p>\n"}, {"tags": ["excel", "vba", "replace", "runtime-error", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1556745462, "creation_date": 1556745462, "answer_id": 55942811, "question_id": 55940573, "link": "https://stackoverflow.com/questions/55940573/find-text-in-powerpoint-and-replace-with-text-from-a-cell-in-excel/55942811#55942811", "title": "Find text in PowerPoint and Replace with text from a cell in Excel", "body": "<p>Not all shapes have a <a href=\"https://docs.microsoft.com/en-us/office/vba/api/powerpoint.shape.textframe\" rel=\"nofollow noreferrer\"><code>TextFrame</code></a>. </p>\n\n<p>From the documentation:</p>\n\n<blockquote>\n  <p>Use the <strong><code>HasTextFrame</code></strong> property to determine whether a shape contains a text frame before you apply the <strong><code>TextFrame</code></strong> property.</p>\n</blockquote>\n\n<p>So try:</p>\n\n<pre><code>If shp.HasTextFrame\n    Set ShpTxt = shp.TextFrame.TextRange\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11438150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9177ce5cdc2ed65b1c76e9c3ca629cf?s=128&d=identicon&r=PG&f=1", "display_name": "jackofalltrades97", "link": "https://stackoverflow.com/users/11438150/jackofalltrades97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "accepted_answer_id": 55942811, "answer_count": 1, "score": 2, "last_activity_date": 1609397152, "creation_date": 1556733789, "last_edit_date": 1609397152, "question_id": 55940573, "link": "https://stackoverflow.com/questions/55940573/find-text-in-powerpoint-and-replace-with-text-from-a-cell-in-excel", "title": "Find text in PowerPoint and Replace with text from a cell in Excel", "body": "<p>I'm trying to find and replace a list of words inside a PowerPoint slide with values from cells in an Excel file. I'm running the VBA in PowerPoint and it gives this error.</p>\n<blockquote>\n<p>Run-time error '-2147024809 (80070057)': The specified value is out of range.</p>\n</blockquote>\n<p>The code seems to stop at this line (the first one):</p>\n<pre><code>Set ShpTxt = shp.TextFrame.TextRange\n</code></pre>\n<p>I've gone through other posts that have similar purposes and errors and tried about 20 different combinations, from both the Internet and from my ideas but none works.</p>\n<pre><code>Sub MergePPT3()\n\n    Dim pp As Object\n    Dim pptemplate As Object\n    'Dim headerbox As TextRange\n    'Dim contextbox As TextRange\n    Dim x As Long\n    Dim y As Long\n    Dim sld As Slide\n    Dim shp As Shape\n    Dim ShpTxt As TextRange\n    Dim TmpTxt As TextRange\n    Dim FindList As Variant\n    Dim ReplaceList As Variant\n    Dim ExApp As Object\n    Dim ExInput As Object\n    \n    Dim SuName As String\n    Dim WFWS As String\n    Dim WFYOY As String\n    Dim CGWS As String\n    Dim CGYOY As String\n    Dim RNKG As String\n    Dim MKTCAT As String\n    \n    Set ExApp = GetObject(, &quot;Excel.Application&quot;)\n    ExApp.Visible = True\n    Set ExInput = ExApp.Workbooks.Open(ActivePresentation.Path &amp; &quot;/Testing.xlsm&quot;)\n    \n    y = 2\n    \n    SuName = ExInput.Sheets(&quot;SuIDs&quot;).Range(&quot;B&quot; &amp; y).Value\n    WFWS = ExInput.Sheets(&quot;SuIDs&quot;).Range(&quot;C&quot; &amp; y).Value\n    WFYOY = ExInput.Sheets(&quot;SuIDs&quot;).Range(&quot;D&quot; &amp; y).Value\n    CGWS = ExInput.Sheets(&quot;SuIDs&quot;).Range(&quot;E&quot; &amp; y).Value\n    CGYOY = ExInput.Sheets(&quot;SuIDs&quot;).Range(&quot;F&quot; &amp; y).Value\n    RNKG = ExInput.Sheets(&quot;SuIDs&quot;).Range(&quot;G&quot; &amp; y).Value\n    MKTCAT = ExInput.Sheets(&quot;SuIDs&quot;).Range(&quot;H&quot; &amp; y).Value\n    \n    FindList = Array(&quot;SUNAME&quot;, &quot;WFWS&quot;, &quot;WFYOY&quot;, &quot;CGWS&quot;, &quot;CGYOY&quot;, &quot;RNKG&quot;, &quot;MKTCAT&quot;)\n    ReplaceList = Array(SuName, WFWS, WFYOY, CGWS, CGYOY, RNKG, MKTCAT)\n    \n     For Each sld In ActivePresentation.Slides\n        \n        For Each shp In sld.Shapes\n          'Store shape text into a variable\n            Set ShpTxt = shp.TextFrame.TextRange\n          \n          'Ensure There is Text To Search Through\n            If ShpTxt &lt;&gt; &quot;&quot; Then\n              For x = LBound(FindList) To UBound(FindList)\n                \n                'Store text into a variable\n                 Set ShpTxt = shp.TextFrame.TextRange\n                \n                'Find First Instance of &quot;Find&quot; word (if exists)\n                 Set TmpTxt = ShpTxt.Replace( _\n                   FindWhat:=FindList(x), _\n                   Replacewhat:=ReplaceList(x), _\n                   WholeWords:=True)\n            \n                'Find Any Additional instances of &quot;Find&quot; word (if exists)\n                  Do While Not TmpTxt Is Nothing\n                    Set ShpTxt = ShpTxt.Characters(TmpTxt.Start + TmpTxt.Length, ShpTxt.Length)\n                    Set TmpTxt = ShpTxt.Replace( _\n                     FindWhat:=FindList(x), _\n                     Replacewhat:=ReplaceList(x), _\n                     WholeWords:=True)\n                  Loop\n                  \n              Next x\n              \n            End If\n            \n        Next shp\n          \n      Next sld\n    \n    End Sub\n</code></pre>\n<p>I used variable &quot;y&quot; as a possibility to loop this code for multiple rows of inputs within the Excel file.</p>\n"}, {"tags": ["excel", "vba", "hyperlink"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11400360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b283851bb34fe05af86f12492fb2924?s=128&d=identicon&r=PG&f=1", "display_name": "user952643", "link": "https://stackoverflow.com/users/11400360/user952643"}, "edited": false, "score": 0, "creation_date": 1556734241, "post_id": 55940357, "comment_id": 98534621, "body": "I think I get what your additions are supposed to do here, but instead of getting me to through the first &quot;Edit&quot; link, I&#39;m just staying on the same page with both &quot;Edit&quot; links now with no error messages provided."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 11400360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b283851bb34fe05af86f12492fb2924?s=128&d=identicon&r=PG&f=1", "display_name": "user952643", "link": "https://stackoverflow.com/users/11400360/user952643"}, "edited": false, "score": 0, "creation_date": 1556735641, "post_id": 55940357, "comment_id": 98535154, "body": "Then maybe there aren&#39;t two links with &quot;Edit&quot; when you code runs? Perhaps a timing issue - if you put a break on the &quot;Set..&quot; line and wait a couple of seconds before continuing does it then work?"}, {"owner": {"reputation": 3, "user_id": 11400360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b283851bb34fe05af86f12492fb2924?s=128&d=identicon&r=PG&f=1", "display_name": "user952643", "link": "https://stackoverflow.com/users/11400360/user952643"}, "edited": false, "score": 0, "creation_date": 1556736453, "post_id": 55940357, "comment_id": 98535468, "body": "I already have a break specified just before I run that chunk, so both &quot;Edit&quot; are definitely on the webpage.  I tried adding one in on the &quot;Set...&quot; line, but got an error saying &quot;permission denied&quot;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 11400360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b283851bb34fe05af86f12492fb2924?s=128&d=identicon&r=PG&f=1", "display_name": "user952643", "link": "https://stackoverflow.com/users/11400360/user952643"}, "edited": false, "score": 0, "creation_date": 1556737960, "post_id": 55940357, "comment_id": 98536078, "body": "Try adding some debugging output (see edits above) - do you get what you expect?"}, {"owner": {"reputation": 3, "user_id": 11400360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b283851bb34fe05af86f12492fb2924?s=128&d=identicon&r=PG&f=1", "display_name": "user952643", "link": "https://stackoverflow.com/users/11400360/user952643"}, "edited": false, "score": 0, "creation_date": 1556738662, "post_id": 55940357, "comment_id": 98536320, "body": "Still no difference.  Is there a way to reference the href value instead of the innerText value?  If so, that would solve the problem.  Your attention here is greatly appreciated."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 11400360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b283851bb34fe05af86f12492fb2924?s=128&d=identicon&r=PG&f=1", "display_name": "user952643", "link": "https://stackoverflow.com/users/11400360/user952643"}, "edited": false, "score": 0, "creation_date": 1556738993, "post_id": 55940357, "comment_id": 98536457, "body": "&quot;no difference&quot; means what ? - what output do you see in the Immediate pane in the VB editor?"}, {"owner": {"reputation": 3, "user_id": 11400360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b283851bb34fe05af86f12492fb2924?s=128&d=identicon&r=PG&f=1", "display_name": "user952643", "link": "https://stackoverflow.com/users/11400360/user952643"}, "edited": false, "score": 0, "creation_date": 1556740073, "post_id": 55940357, "comment_id": 98536928, "body": "The output in the immediate pane lists 50+ links, showing things like <code>Link          State Licenses:</code> (which is the link I clicked on earlier in my code by using getElementByID and is the page on which I&#39;m trying to select the second &#39;Edit&#39; link).  There was no <code>Link          Edit</code> printed in the immediate pane.  Apologies for any lack of clarity."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 11400360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b283851bb34fe05af86f12492fb2924?s=128&d=identicon&r=PG&f=1", "display_name": "user952643", "link": "https://stackoverflow.com/users/11400360/user952643"}, "edited": false, "score": 0, "creation_date": 1556740183, "post_id": 55940357, "comment_id": 98536977, "body": "Well if there are no &quot;Edit&quot; links on the page then it&#39;s difficult to make any suggestions as to how you can fix that.  Maybe if you also show the code that gets you to that page there might be something there to work with."}, {"owner": {"reputation": 3, "user_id": 11400360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b283851bb34fe05af86f12492fb2924?s=128&d=identicon&r=PG&f=1", "display_name": "user952643", "link": "https://stackoverflow.com/users/11400360/user952643"}, "edited": false, "score": 0, "creation_date": 1556740919, "post_id": 55940357, "comment_id": 98537272, "body": "I extended the delay by a few seconds and the print commands returned what would be expected.  Took out the print lines from the code (used the code you originally provided) and everything worked as expected.  This has been enormously helpful, thank you for your patience and willingness to help"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1556737927, "last_edit_date": 1556737927, "creation_date": 1556732595, "answer_id": 55940357, "question_id": 55940255, "link": "https://stackoverflow.com/questions/55940255/how-to-click-on-the-desired-link-when-there-are-two-distinct-links-with-the-same/55940357#55940357", "title": "How to click on the desired link when there are two distinct links with the same TagName and InnerText using Excel VBA", "body": "<p>You could do something like this:</p>\n\n<pre><code>    Dim i As Long\n    Set AllHyperLinks = IE.document.getElementsByTagName(\"a\")\n\n    For Each hyper_link In AllHyperLinks\n       Debug.Print \"Link\", hyper_link.innerText\n       If hyper_link.innerText = \"Edit\" Then\n            i = i + 1\n            Debug.Print , \"Edit Link #\" &amp; i\n            If i = 2 Then\n                Debug.Print , \"Clicking...!\"\n                hyper_link.Click\n                Exit For\n            End If\n        End If\n    Next\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11400360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b283851bb34fe05af86f12492fb2924?s=128&d=identicon&r=PG&f=1", "display_name": "user952643", "link": "https://stackoverflow.com/users/11400360/user952643"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 55940357, "answer_count": 1, "score": 0, "last_activity_date": 1556737927, "creation_date": 1556732192, "last_edit_date": 1556732658, "question_id": 55940255, "link": "https://stackoverflow.com/questions/55940255/how-to-click-on-the-desired-link-when-there-are-two-distinct-links-with-the-same", "title": "How to click on the desired link when there are two distinct links with the same TagName and InnerText using Excel VBA", "body": "<p>I am trying to get the code in my VBA Module to click on a specific link on a webpage, but there are two distinct links with the same name (\"Edit\") and I cannot seem to click on the one I want to select (the second of the two).</p>\n\n<p>With the code I currently have, I am able to access the first \"Edit\" link, but I need to access the second \"Edit\" link instead.</p>\n\n<p>Here is what I currently have:</p>\n\n<pre><code>   Set AllHyperLinks = IE.document.getElementsByTagName(\"a\")\n\n        For Each hyper_link In AllHyperLinks\n\n            If hyper_link.innerText = \"Edit\" Then\n                hyper_link.Click\n                Exit For\n\n            End If\n        Next\n</code></pre>\n\n<p>The links appear in the page source as follows:</p>\n\n<p>First \"Edit\" link</p>\n\n<pre><code>&lt;a href=\"javascript:__doPostBack('ctl04$ctl00$ctl00$esbasegrid_$ctl02$ctl00','')\"&gt;Edit&lt;/a&gt;\n</code></pre>\n\n<p>Second \"Edit\" link (<strong><em>the one I want to click on</em></strong>)</p>\n\n<pre><code>&lt;a href=\"javascript:__doPostBack('ctl04$ctl00$ctl01$esbasegrid_$ctl02$ctl00','')\"&gt;Edit&lt;/a&gt;\n</code></pre>\n\n<p>As I have indicated above, I would like to get to click on the second \"Edit\" link, but instead my code is clicking on the first.</p>\n\n<p>Relatively new to VBA, so any help here would be greatly appreciated!</p>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 2, "creation_date": 1556730320, "post_id": 55939820, "comment_id": 98532839, "body": "Please post your code.  It is hard to help if we can&#39;t see what you have done."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1556733292, "post_id": 55939820, "comment_id": 98534193, "body": "Works for me if I use an ActiveX scrollbar"}, {"owner": {"reputation": 1, "user_id": 9754033, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6ZEx3LriFOE/AAAAAAAAAAI/AAAAAAAAAAA/uVtiWghNmMw/photo.jpg?sz=128", "display_name": "noafterglow", "link": "https://stackoverflow.com/users/9754033/noafterglow"}, "edited": false, "score": 0, "creation_date": 1556752553, "post_id": 55939820, "comment_id": 98540689, "body": "Hmmm.  Thanks!  ActiveX seems to work differently than Form controls.  Weird.  I think the point of the question is still valid since ActiveX doesn&#39;t work on a mac....  I would love to see if there is anyone out there that knows how the two really behave."}], "owner": {"reputation": 1, "user_id": 9754033, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6ZEx3LriFOE/AAAAAAAAAAI/AAAAAAAAAAA/uVtiWghNmMw/photo.jpg?sz=128", "display_name": "noafterglow", "link": "https://stackoverflow.com/users/9754033/noafterglow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556730108, "creation_date": 1556730108, "question_id": 55939820, "link": "https://stackoverflow.com/questions/55939820/how-to-make-live-chart-in-excel-with-scrollbar", "title": "How to make &quot;Live chart&quot; in excel with scrollbar", "body": "<p>I added a scroll bar form control to Sheet 1.  Its value goes to cell A1.\nWhen I move the slider on the control, the value in A1 changes \"live\"  i.e. as I move the slider.  </p>\n\n<p>Then I added some fixed numbers in A2 and A3 and a pie chart which references A1:A3.  The chart shows the relative proportions of A1:A3, but:</p>\n\n<p><strong>It does not update as the numbers change, only upon mouse release.</strong> </p>\n\n<p>Initially I thought that only A1 was being recalc, but adding a dependent calculation clearly shows that subsequent calc also are evaluated.</p>\n\n<p>I tried to start writing a macro to force the recalculation of the spreadsheet, but:</p>\n\n<p>1) the Worksheet_Change() event does <strong>NOT</strong> get called, even on mouse release!</p>\n\n<p>2) I have not been able to find a way to force the graph to refresh i.e.</p>\n\n<p><em>There does not seem to be any way to force an object to refresh in Excel</em></p>\n\n<p>I expected the chart to change upon data change, but there appears to be some deeper logic in Excel which is not described anywhere for how refresh actually works.  </p>\n\n<p>I can totally see why (performance) this would have been coded this way, but I can't seem to understand how they did it, or how to make it not do it that way when we want something else to happen.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 5, "creation_date": 1556729623, "post_id": 55939694, "comment_id": 98532548, "body": "Qualify <i>all</i> your Range/Cells calls with an explicit worksheet object."}, {"owner": {"reputation": 11, "user_id": 11286593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vCs6T.png?s=128&g=1", "display_name": "Unicode", "link": "https://stackoverflow.com/users/11286593/unicode"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556729726, "post_id": 55939694, "comment_id": 98532595, "body": "@ Tim Williams - Hello there, I am not very familiar with your suggestion, would you be able to elaborate or detail a some more for me to comprehend, thank you"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1556729831, "post_id": 55939694, "comment_id": 98532643, "body": "You should <a href=\"https://stackoverflow.com/a/10717999/4717755\">avoid using <code>Select</code> and <code>Activate</code></a> completely. <a href=\"https://www.spreadsheetsmadeeasy.com/7-common-vba-mistakes-to-avoid/\" rel=\"nofollow noreferrer\">Here&#39;s another</a> reference."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1556730180, "post_id": 55939694, "comment_id": 98532780, "body": "<code>Results.Cells</code> is qualified: <code>Cells</code> alone is not"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1556731075, "post_id": 55939694, "comment_id": 98533124, "body": "PeterT&#39;s reference is exactly what you should look at."}, {"owner": {"reputation": 11, "user_id": 11286593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vCs6T.png?s=128&g=1", "display_name": "Unicode", "link": "https://stackoverflow.com/users/11286593/unicode"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1556732025, "post_id": 55939694, "comment_id": 98533566, "body": "@PeterT - currently checking again."}, {"owner": {"reputation": 11, "user_id": 11286593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vCs6T.png?s=128&g=1", "display_name": "Unicode", "link": "https://stackoverflow.com/users/11286593/unicode"}, "edited": false, "score": 0, "creation_date": 1556736149, "post_id": 55939694, "comment_id": 98535348, "body": "@GMalc - is there a better script for including into Sheet2, that will Delimit column C, D?"}], "owner": {"reputation": 11, "user_id": 11286593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vCs6T.png?s=128&g=1", "display_name": "Unicode", "link": "https://stackoverflow.com/users/11286593/unicode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556729513, "creation_date": 1556729513, "question_id": 55939694, "link": "https://stackoverflow.com/questions/55939694/vba-project-window-runs-macro-correct-however-button-on-sheet1-does-not", "title": "VBA project Window runs Macro correct, however, Button on Sheet1 Does not", "body": "<p>I have tested my macro many times through VBA Run Window, and all on Sheet2 appears correctly.  When I try to run Macro from Button on Sheet1, two columns \"C\" and \"D\" raise all the numbers by one cell up.  What could be the issue on Button, Sheet1?</p>\n\n<p>At the same time, this script code has been arranged to delete content from empty rows with additional words, or letters, then it is suppose to delete a row up, perhaps, this could be the issue.</p>\n\n<p>My code:</p>\n\n<pre><code>Sub CopyPasteintoSheet2()\n\n\nDim lr As Long\nDim i As Long\nDim inputdtae As Date\nDim rng As Range\n\n\nlr = Cells(Rows.Count, 1).End(xlUp).Row\n\n    For i = lr - 0 To 2 Step -1\n        If Cells(i, \"B\") = \"LLC\" Then\n            Cells(i, \"B\").EntireRow.Delete\n        End If\n    Next i\n\n\nActiveWindow.SmallScroll Down:=11\n\n    Columns(\"J:J\").Select\n    Selection.TextToColumns Destination:=Range(\"J1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n    :=Array(1, 1), TrailingMinusNumbers:=True\n    Columns(\"R:R\").Select\n    Selection.TextToColumns Destination:=Range(\"R1\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n        Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n        :=Array(1, 1), TrailingMinusNumbers:=True\n\n\n\nDim LastRow As Long\nDim NEWFORMAT As Worksheet\nDim Results As Worksheet\n\n   Set Results = Sheets(\"NEWFORMAT\")\n    LastRow = Results.Cells(Results.Rows.Count, \"Z\").End(xlUp).Row\n\n    Range(\"A15:A400\").Copy\n    Results.Range(\"A\" &amp; LastRow + 2).PasteSpecial xlValues\n    Range(\"B15:B400\").Copy\n    Results.Range(\"B\" &amp; LastRow + 2).PasteSpecial xlValues\n    Range(\"J15:J400\").Copy\n    Results.Range(\"C\" &amp; LastRow + 2).PasteSpecial xlValues\n    Range(\"R15:R400\").Copy\n    Results.Range(\"D\" &amp; LastRow + 2).PasteSpecial xlValues\n\n    Application.DataEntryMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "edited": false, "score": 0, "creation_date": 1556737587, "post_id": 55939425, "comment_id": 98535932, "body": "Excel does love to edit hyperlinks itself ... I had a similar problem. My first &quot;fix&quot; was to store the path to each file or folder in a cell in Excel. Then I put code into the Sheet.Activate event for re-building the hyperlinks - slows noticeably with a few hundred hyperlinks in a sheet. That worked for a while but was less than perfect, so in the end I went for an alternative and abandoned hyperlinks."}], "answers": [{"tags": [], "owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "is_accepted": false, "score": 0, "last_activity_date": 1556739094, "creation_date": 1556739094, "answer_id": 55941651, "question_id": 55939425, "link": "https://stackoverflow.com/questions/55939425/having-trouble-getting-vba-to-edit-existing-hyperlinks/55941651#55941651", "title": "Having trouble getting VBA to edit existing hyperlinks", "body": "<p>To avoid Hyperlinks - store the path to the file in a cell (instead of the hyperlink)</p>\n\n<p>Then something like following in the sheet.selectionchange procedure</p>\n\n<pre><code>Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n   Dim MinValidRow as long, MaxValidRow as Long, LinkedCol as long\n\n   MinValidRow = 5 ' You Set this to whatever you want\n   MaxValidRow = 9 ' You Set this to whatever you want\n   LinkedCol   = 2 ' You Set this to whatever you want\n\n   If Sh.Name = \"YourSheet\" then\n      If Target.Column = LinkedCol and Target.Row &gt; MinValidRow and Target.Row&lt;MaxValidrow then\n         CreateObject(\"Shell.Application\").Open(Target.Text)\n      End If\n   End If\nEnd Sub\n</code></pre>\n\n<p>You should also move away from the selected cell so it can be selected again by clicking into it and you probably want to prevent someone firing off loads of files by pressing &amp; holding down arrow </p>\n"}], "owner": {"reputation": 185, "user_id": 11116312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xpSGIRqI4b4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNPsVUDBiaRp_oj3KvxIxzBXkndA/mo/photo.jpg?sz=128", "display_name": "David Podolak", "link": "https://stackoverflow.com/users/11116312/david-podolak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556739094, "creation_date": 1556728227, "question_id": 55939425, "link": "https://stackoverflow.com/questions/55939425/having-trouble-getting-vba-to-edit-existing-hyperlinks", "title": "Having trouble getting VBA to edit existing hyperlinks", "body": "<p>So I am running a macro that archives an accounting log into an archive folder, after it is archived the macro clears a column on multiple sheets to clear the accounting log. For some reason when I first ran this macro, everything worked fine but every hyperlink that was linked to a folder on the server became corrupted. The final 2 folders are correct but all preceding folders became \"../../../../../\" when I click on Edit Hyperlink. So it looked like \"../../../../../Clients/ClientA/\". The archived file has the same \"../../\" but the links work.</p>\n\n<p>Upon clicking on the link I was prompted with the following error: 'Cannot open the specified file.' But when I edit the file and put folder names instead of \"../\" then it works fine. I am not sure why this is occurring. But regardless each Hyperlink is on every sheet on Cell G1. So I wrote a macro to fix the links.</p>\n\n<pre><code>  Sub hyperUpdate()\n  Dim wsHyper As Worksheet, addr As String, lastrow As Long, h As Hyperlink\n\n  lastrow = Worksheets(\"Auto Archive\").Range(\"A\" &amp; Worksheets(\"Auto \n  Archive\").Rows.Count).End(xlUp).Row\n\n  For i = 2 To lastrow\n\n  Set wsHyper = Worksheets(Worksheets(\"Auto Archive\").Cells(i, 1).Value)\n  wsHyper.Activate\n  addr = Worksheets(\"Auto Archive\").Cells(i, 3).Value\n  wsHyper.Cells(1, 7).Activate\n\n\n  Application.ActiveCell.Hyperlinks(1).Address = addr\n  MsgBox Application.ActiveCell.Hyperlinks(1).Address\n\n  Next i\n\n  End Sub\n</code></pre>\n\n<p>So The message box said the correct address each time but when i click on edit hyperlink I get the same \"../../\" and the link still doesn't work. What is a better way to go about this? Thank you</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1556728456, "post_id": 55939418, "comment_id": 98532043, "body": "You will want to use the <code>Range.Find</code> method most likely, but this is highly dependent on the formats being correct. On the spreadsheet, do the dates have time stamps or is the decimal 0?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1556728513, "post_id": 55939418, "comment_id": 98532071, "body": "Also, you cannot name a sub <code>date</code> as this is reserved word"}, {"owner": {"reputation": 79, "user_id": 11385750, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rn_1Ha_ZydE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re_k5YfmZaWr7QgmmbK4SRwaqw15A/mo/photo.jpg?sz=128", "display_name": "Djhans26 ", "link": "https://stackoverflow.com/users/11385750/djhans26"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1556728680, "post_id": 55939418, "comment_id": 98532137, "body": "They are not time stamped and when I put range.find, it comes up as an error \u201cargument not optional.\u201d"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1556728709, "post_id": 55939418, "comment_id": 98532158, "body": "Working on solution - hold steady"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 11385750, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rn_1Ha_ZydE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re_k5YfmZaWr7QgmmbK4SRwaqw15A/mo/photo.jpg?sz=128", "display_name": "Djhans26 ", "link": "https://stackoverflow.com/users/11385750/djhans26"}, "edited": false, "score": 0, "creation_date": 1556729802, "post_id": 55939564, "comment_id": 98532633, "body": "How would I add a sum function to the first empty row I after the data and adding everything above it up to cell D4?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 79, "user_id": 11385750, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rn_1Ha_ZydE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re_k5YfmZaWr7QgmmbK4SRwaqw15A/mo/photo.jpg?sz=128", "display_name": "Djhans26 ", "link": "https://stackoverflow.com/users/11385750/djhans26"}, "edited": false, "score": 1, "creation_date": 1556729848, "post_id": 55939564, "comment_id": 98532649, "body": "That is a completely different question. Give it some time to try to figure that out - if you cant, new questions get new posts. If this answered the question in your initial post, you should accept the solution :)"}, {"owner": {"reputation": 79, "user_id": 11385750, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rn_1Ha_ZydE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re_k5YfmZaWr7QgmmbK4SRwaqw15A/mo/photo.jpg?sz=128", "display_name": "Djhans26 ", "link": "https://stackoverflow.com/users/11385750/djhans26"}, "edited": false, "score": 0, "creation_date": 1556730092, "post_id": 55939564, "comment_id": 98532748, "body": "This finds the first cell that contains a date I enter. How do I modify it to come from bottom up instead of top down?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 79, "user_id": 11385750, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rn_1Ha_ZydE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re_k5YfmZaWr7QgmmbK4SRwaqw15A/mo/photo.jpg?sz=128", "display_name": "Djhans26 ", "link": "https://stackoverflow.com/users/11385750/djhans26"}, "edited": false, "score": 1, "creation_date": 1556730152, "post_id": 55939564, "comment_id": 98532771, "body": "You can amend options on the <code>Range.Find</code> method. <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\">This</a> link will tell you exactly how"}, {"owner": {"reputation": 79, "user_id": 11385750, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rn_1Ha_ZydE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re_k5YfmZaWr7QgmmbK4SRwaqw15A/mo/photo.jpg?sz=128", "display_name": "Djhans26 ", "link": "https://stackoverflow.com/users/11385750/djhans26"}, "edited": false, "score": 0, "creation_date": 1559592474, "post_id": 55939564, "comment_id": 99462092, "body": "How do I get this to where if the date is not found, it will let the user retry?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 79, "user_id": 11385750, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rn_1Ha_ZydE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re_k5YfmZaWr7QgmmbK4SRwaqw15A/mo/photo.jpg?sz=128", "display_name": "Djhans26 ", "link": "https://stackoverflow.com/users/11385750/djhans26"}, "edited": false, "score": 0, "creation_date": 1559660692, "post_id": 55939564, "comment_id": 99486621, "body": "<a href=\"https://stackoverflow.com/questions/31999974/do-until-loop-inputbox-infinitely-loops\" title=\"do until loop inputbox infinitely loops\">stackoverflow.com/questions/31999974/&hellip;</a>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 79, "user_id": 11385750, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rn_1Ha_ZydE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re_k5YfmZaWr7QgmmbK4SRwaqw15A/mo/photo.jpg?sz=128", "display_name": "Djhans26 ", "link": "https://stackoverflow.com/users/11385750/djhans26"}, "edited": false, "score": 0, "creation_date": 1559662392, "post_id": 55939564, "comment_id": 99487598, "body": "@Djhans26 please post a new question as this is a new issue and not in your initial question. New questions get new posts. If questions were allowed to continuously evolve, no question would ever really be answered."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 79, "user_id": 11385750, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rn_1Ha_ZydE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re_k5YfmZaWr7QgmmbK4SRwaqw15A/mo/photo.jpg?sz=128", "display_name": "Djhans26 ", "link": "https://stackoverflow.com/users/11385750/djhans26"}, "edited": false, "score": 0, "creation_date": 1559662421, "post_id": 55939564, "comment_id": 99487615, "body": "Here is one more link that shows you how to do this with a date  <a href=\"https://stackoverflow.com/questions/19430765/input-box-date-range-in-vba\" title=\"input box date range in vba\">stackoverflow.com/questions/19430765/&hellip;</a>"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1556728898, "creation_date": 1556728898, "answer_id": 55939564, "question_id": 55939418, "link": "https://stackoverflow.com/questions/55939418/how-do-i-insert-an-input-box-that-will-ask-for-a-date-and-then-add-to-rows-after/55939564#55939564", "title": "How do I insert an input box that will ask for a date and then add to Rows after that date?", "body": "<p>A couple of things</p>\n\n<ol>\n<li>You cannot name your sub <code>date</code> as this is a reserved word</li>\n<li>No need for <code>.Selection</code></li>\n<li>If you use <code>Application.Inputbox</code>, you can control the input type (<em>to some degree</em>)</li>\n</ol>\n\n<hr>\n\n<p><em>Assumes you are working on <code>Sheet1</code> and your dates that are to be matched against the user input span <code>Column F</code></em></p>\n\n<pre><code>Sub Date_Finder()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\") '&lt;-- Update\nDim xInput As Date, Found As Range\n\nxInput = Application.InputBox(\"Enter Date [mm/dd/yyyy]\", Type:=1)\n\n    If IsDate(xInput) Then\n        Set Found = ws.Range(\"F:F\").Find(xInput)\n\n        If Found Is Nothing Then\n            MsgBox \"Input not found in range\"\n        Else\n            Found.Offset(1).EntireRow.Insert (xlShiftDown)\n            Found.Offset(1).EntireRow.Insert (xlShiftDown)                \n        End If\n    Else\n        MsgBox \"Invalid Entry. Ending sub\" &amp; vbNewLine &amp; \"Entry: \" &amp; xInput, vbCritical\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 11385750, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rn_1Ha_ZydE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re_k5YfmZaWr7QgmmbK4SRwaqw15A/mo/photo.jpg?sz=128", "display_name": "Djhans26 ", "link": "https://stackoverflow.com/users/11385750/djhans26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 55939564, "answer_count": 1, "score": 1, "last_activity_date": 1556728898, "creation_date": 1556728177, "last_edit_date": 1556728434, "question_id": 55939418, "link": "https://stackoverflow.com/questions/55939418/how-do-i-insert-an-input-box-that-will-ask-for-a-date-and-then-add-to-rows-after", "title": "How do I insert an input box that will ask for a date and then add to Rows after that date?", "body": "<pre><code>Sub date\n    Dim DTE as Date\n    MBox = InputBox(\u201cEnter Friday date\u201d)\n    If IsDate(MBox) Then\n        DTE = CDate(MBox)\n        Range(\u201cF\u201d &amp; Rows.Count).End(xlUp).Offset(1).Select\n        Selection.Insert Shift:=xlDown\n        Selection.Insert Shift:=xlDown\n     Else \n         MsgBox(\u201cThis isn\u2019t a date. Try again.\u201d)\n    End if\nEnd sub\n</code></pre>\n\n<p>I need the code to add two rows after it finds the date the user enters in the input box and then add up the values in column D. I realize the range row is incorrect but I am not sure how to insert the rows after the date I entered.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1556727911, "post_id": 55939329, "comment_id": 98531829, "body": "What exactly are you asking?"}, {"owner": {"reputation": 1, "user_id": 3148313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff03a02ddf752fa95612be0e6d8d393b?s=128&d=identicon&r=PG&f=1", "display_name": "user3148313", "link": "https://stackoverflow.com/users/3148313/user3148313"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1556728156, "post_id": 55939329, "comment_id": 98531931, "body": "The code I show doesn&#39;t work.  What is the correct Dim statement, and correct MsgBox statement, or correct way to dimension the arrays?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556728239, "post_id": 55939329, "comment_id": 98531963, "body": "Do you feel it&#39;s not already correct?"}, {"owner": {"reputation": 1, "user_id": 3148313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff03a02ddf752fa95612be0e6d8d393b?s=128&d=identicon&r=PG&f=1", "display_name": "user3148313", "link": "https://stackoverflow.com/users/3148313/user3148313"}, "edited": false, "score": 0, "creation_date": 1556728273, "post_id": 55939329, "comment_id": 98531971, "body": "Yes, it doesn&#39;t work."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1556728449, "post_id": 55939329, "comment_id": 98532040, "body": "Your code is not creating a <i>2-D</i> array.  It is creating an array of arrays.  Each element of <code>Design</code> is itself an array."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1556728468, "post_id": 55939329, "comment_id": 98532050, "body": "I suggest you read up on understanding how arrays work in VBA, particularly multi-dimensional arrays. You can find good information in <a href=\"https://excelmacromastery.com/excel-vba-array/\" rel=\"nofollow noreferrer\">this article</a> and <a href=\"https://riptutorial.com/vba/example/17455/multidimensional-arrays\" rel=\"nofollow noreferrer\">this one</a>"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556731380, "post_id": 55939466, "comment_id": 98533262, "body": "As was mentioned already, what you have is a <i>jagged array</i> (an array of arrays). A 2D array would be declared like <code>Dim stuff(0 To 99, 0 To 9)</code>, and then you could do  <code>stuff(i, j) = x</code> and <code>MsgBox stuff(i, j)</code>."}], "tags": [], "owner": {"reputation": 1, "user_id": 3148313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff03a02ddf752fa95612be0e6d8d393b?s=128&d=identicon&r=PG&f=1", "display_name": "user3148313", "link": "https://stackoverflow.com/users/3148313/user3148313"}, "is_accepted": false, "score": 0, "last_activity_date": 1556728446, "creation_date": 1556728446, "answer_id": 55939466, "question_id": 55939329, "link": "https://stackoverflow.com/questions/55939329/looping-thru-2d-array-using-vba/55939466#55939466", "title": "Looping thru 2D array using VBA", "body": "<p>Wow, my apologies.  I've been trying for WEEKS to get this to work, and in formatting it for this question, it FINALLY worked!   Code is good as is.</p>\n"}], "owner": {"reputation": 1, "user_id": 3148313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff03a02ddf752fa95612be0e6d8d393b?s=128&d=identicon&r=PG&f=1", "display_name": "user3148313", "link": "https://stackoverflow.com/users/3148313/user3148313"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1556728618, "creation_date": 1556727717, "last_edit_date": 1556728618, "question_id": 55939329, "link": "https://stackoverflow.com/questions/55939329/looping-thru-2d-array-using-vba", "title": "Looping thru 2D array using VBA", "body": "<p>I have several designs, and each design has several variables.</p>\n\n<p>Using VBA code, I want to loop thru each design, and assign variables to each of the indices of the one design.\nI'm having a hard time getting the array dim statement correct, and correctly calling the nth variable of each design. \nI've shown VBA code here that uses a message box to display if I am getting the right value from each j loop, and each design.</p>\n\n<p>Any help?</p>\n\n<pre><code>Dim Design(0 To 9) As Variant\n\nSub main\n\nDesign(1) = Array(4,6,2,1)\nDesign(2) = Array(8,2,6,9)\n\nFor i = 1 To 2\n   For j = 1 to 4\n     MsgBox (Design(i)(j-1))\n   Next j\nNext i\n\nEnd sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1556727762, "post_id": 55939304, "comment_id": 98531751, "body": "What did you already try?  You should be able to use <code>If headerCell.Value Like &quot;P.#&quot; Or headerCell.Value Like &quot;P.##&quot;</code> for example to match &quot;P.&quot; followed by one or two digits."}, {"owner": {"reputation": 3, "user_id": 11437794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7--YiDtzx3I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reoNrXykNE4UaI92svgb4Gu-EtnZQ/mo/photo.jpg?sz=128", "display_name": "Ralph Nelson", "link": "https://stackoverflow.com/users/11437794/ralph-nelson"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556735576, "post_id": 55939304, "comment_id": 98535133, "body": "Thank you for your reply/question Tim! I have used Set aCell = .Range(&quot;A2:OZ2&quot;).Find(What:=&quot;P.&quot;, LookIn:=xlValues, LookAt:=xlWhole, _ MatchCase:=False, SearchFormat:=False) That didn&#39;t work. I have changed &quot;P.&quot; to a particular #, e.g. &quot;P.1&quot; or &quot;P.2&quot; etc and that works fine but any general characteristic as you suggest didn&#39;t work. Certainly could be my lack of experience causing the problem."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556735709, "post_id": 55939304, "comment_id": 98535176, "body": "<code>LookAt:=xlWhole</code> &gt;&gt; <code>LookAt:=xlPart</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11437794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7--YiDtzx3I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reoNrXykNE4UaI92svgb4Gu-EtnZQ/mo/photo.jpg?sz=128", "display_name": "Ralph Nelson", "link": "https://stackoverflow.com/users/11437794/ralph-nelson"}, "edited": false, "score": 0, "creation_date": 1556738458, "post_id": 55941007, "comment_id": 98536245, "body": "Your suggestion worked fine except for one issue that resulted from the software generating the spreadsheet which put a space in front of the P.  Changing the &quot;P.#&quot; to &quot; P.#&quot; etc fixed that.  No way you would have ever known about that!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 11437794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7--YiDtzx3I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reoNrXykNE4UaI92svgb4Gu-EtnZQ/mo/photo.jpg?sz=128", "display_name": "Ralph Nelson", "link": "https://stackoverflow.com/users/11437794/ralph-nelson"}, "edited": false, "score": 0, "creation_date": 1556738940, "post_id": 55941007, "comment_id": 98536431, "body": "You can allow for that by removing any leading/trailing spaces using Trim() - see edits above"}, {"owner": {"reputation": 3, "user_id": 11437794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7--YiDtzx3I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reoNrXykNE4UaI92svgb4Gu-EtnZQ/mo/photo.jpg?sz=128", "display_name": "Ralph Nelson", "link": "https://stackoverflow.com/users/11437794/ralph-nelson"}, "edited": false, "score": 0, "creation_date": 1556739595, "post_id": 55941007, "comment_id": 98536695, "body": "yes, see you slightly revised to trim the c.value"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1556738910, "last_edit_date": 1556738910, "creation_date": 1556735901, "answer_id": 55941007, "question_id": 55939304, "link": "https://stackoverflow.com/questions/55939304/find-columns-with-headers-that-vary-from-one-column-to-the-next/55941007#55941007", "title": "Find columns with headers that vary from one column to the next", "body": "<p>This is what I was suggesting:</p>\n\n<pre><code>Dim c As Range, v\n\nFor Each c In Application.Intersect(ActiveSheet.Rows(2), ActiveSheet.UsedRange)\n    v = Trim(c.Value)\n    If v Like \"P.#\" Or v Like \"P.##\" Then\n        Debug.Print v &amp; \" found at \" &amp; c.Address &amp; _\n                     \" on '\" &amp; c.Parent.Name &amp; \"'\"\n    End If\nNext c\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11437794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7--YiDtzx3I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reoNrXykNE4UaI92svgb4Gu-EtnZQ/mo/photo.jpg?sz=128", "display_name": "Ralph Nelson", "link": "https://stackoverflow.com/users/11437794/ralph-nelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "closed_date": 1556757518, "accepted_answer_id": 55941007, "answer_count": 1, "score": -1, "last_activity_date": 1556779493, "creation_date": 1556727582, "last_edit_date": 1556779493, "question_id": 55939304, "link": "https://stackoverflow.com/questions/55939304/find-columns-with-headers-that-vary-from-one-column-to-the-next", "closed_reason": "Needs more focus", "title": "Find columns with headers that vary from one column to the next", "body": "<p>Want to process an excel spreadsheet, many columns, using a vba macro.  Within the spreadsheet the columns have headers denoting a property, such as \u201cP.#\u201d, where # starts at 1 and goes to a higher value which can vary from one spreadsheet to another.</p>\n\n<p>For example, the following spreadsheet table:</p>\n\n<pre><code>Excel column    --- U   V   W   --- AX  AY  ---\nheaders         --- T.1 P.1 C.1     T.2 P.2 ---\ndate            --- --- --- --- --- --- --- ---\n</code></pre>\n\n<p>I want to pick up the P.# columns and copy them to another spreadsheet.  I know how to copy from one spreadsheet to another, my problem is picking up the P columns as the # changes and copy the column to another spreadsheet (same workbook).  I'm wrapped around the axle on this!!</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "answers": [{"tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": false, "score": 1, "last_activity_date": 1562220920, "last_edit_date": 1562220920, "creation_date": 1557132972, "answer_id": 56001834, "question_id": 55939294, "link": "https://stackoverflow.com/questions/55939294/how-to-check-if-data-from-a-pivot-table-is-used-in-a-getpivotdata-formula/56001834#56001834", "title": "How to check if data from a pivot table is used in a GETPIVOTDATA formula", "body": "<p>As you already found out, the <code>Range.Precedents</code> of a cell with a <code>GETPIVOTDATA</code> formula unfortunately only points to the first cell of the pivot table. So you can not use precedents to identify an already referenced cell of a pivot table.</p>\n\n<p>My code does following:</p>\n\n<ul>\n<li>build the <strong>=GETPIVOTDATA()</strong> formula string for <strong>each pivottable's datarange cell</strong></li>\n<li>collect those <em>possible</em> formulas in an array</li>\n<li>compare each <em>used</em> formula, e. g. within range G1:G500, with this array</li>\n<li>if the formula is found, the corresponding pivotcell is marked yellow</li>\n</ul>\n\n<pre><code>    Private Sub EveryPossibleGETPIVOTDATAformula()\n        Dim pt As PivotTable\n        Dim pi As PivotItem\n        Dim pc As PivotCell\n        Dim c As Range\n        Dim i As Long, j As Long\n        Dim PossibleFormulas() As String\n\n        Set pt = ActiveSheet.PivotTables(1)\n\n        ReDim PossibleFormulas( _\n            1 To _\n            pt.PivotRowAxis.PivotLines.Count * _\n            pt.PivotColumnAxis.PivotLines.Count)\n\n        i = 1\n        For Each c In pt.DataBodyRange.Cells\n            Set pc = c.PivotCell\n            PossibleFormulas(i) = _\n                \"=GETPIVOTDATA(\"\"\" &amp; _\n                pc.DataField.SourceName &amp; \"\"\",\" &amp; _\n                pt.TableRange1.Cells(1).Address\n            For Each pi In pc.RowItems\n                PossibleFormulas(i) = PossibleFormulas(i) &amp; _\n                    \",\"\"\" &amp; pi.Parent.Name &amp; _\n                    \"\"\",\"\"\" &amp; pi.Value &amp; \"\"\"\"\n            Next pi\n            For Each pi In pc.ColumnItems\n                PossibleFormulas(i) = PossibleFormulas(i) &amp; _\n                    \",\"\"\" &amp; pi.Parent.Name &amp; _\n                    \"\"\",\"\"\" &amp; pi.Value &amp; \"\"\"\"\n            Next pi\n            PossibleFormulas(i) = PossibleFormulas(i) &amp; \")\"\n            i = i + 1\n        Next c\n\n\n        Dim myPosition As Variant\n        For Each c In ActiveSheet.Range(\"G1:G500\") ' adapt it\n            If c.HasFormula Then\n                myPosition = Application.Match(c.Formula, PossibleFormulas(), 0)\n                If IsNumeric(myPosition) Then\n                    pt.DataBodyRange.Cells(myPosition).Interior.Color = vbYellow\n                End If\n            End If\n        Next c\n    End Sub\n\n</code></pre>\n\n<p>Be aware: It works only, if =GETPIVOTDATA(...) is the only formula part in your cells. If you need further calculations, like a multiplication (you did it with =GETPIVOTDAT(...)*2), please try to separate that multiplication to an additional column.</p>\n"}], "owner": {"reputation": 35, "user_id": 11239682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cJUsYAe0b3M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcR0_aHslxMMDyVSlJ2wxEcbwQM2A/mo/photo.jpg?sz=128", "display_name": "dieter declerck", "link": "https://stackoverflow.com/users/11239682/dieter-declerck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1563374479, "creation_date": 1556727511, "last_edit_date": 1563374479, "question_id": 55939294, "link": "https://stackoverflow.com/questions/55939294/how-to-check-if-data-from-a-pivot-table-is-used-in-a-getpivotdata-formula", "title": "How to check if data from a pivot table is used in a GETPIVOTDATA formula", "body": "<p>I use the data from the pivot table in formulas. There is a lot of data in the pivot table and I need to check, which data is already used in formulas.</p>\n\n<p>I used already this piece of code to mark the used pivot data, but it does not work for GETPIVOTDATA formulas:</p>\n\n<p><code>Cells(24, \"g\").Precedents.Interior.ColorIndex = 5</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/k6jZb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k6jZb.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "linux", "vba", "shell", "putty"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556727289, "post_id": 55938753, "comment_id": 98531574, "body": "Does that putty command line work if run directly in cmd ?"}, {"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 0, "creation_date": 1556728781, "post_id": 55938753, "comment_id": 98532187, "body": "Indeed, your command-line won&#39;t work even standalone. This is not a Excel/VBA question."}, {"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 0, "creation_date": 1556728791, "post_id": 55938753, "comment_id": 98532191, "body": "Also, don&#39;t use PuTTY to automate commands. Use Plink (part of PuTTY package)."}, {"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 0, "creation_date": 1556728802, "post_id": 55938753, "comment_id": 98532199, "body": "And then see, <a href=\"https://stackoverflow.com/q/54432962/850848\">Executing (sudo) subcommands using Plink</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "is_accepted": true, "score": 1, "last_activity_date": 1556776366, "creation_date": 1556776366, "answer_id": 55946366, "question_id": 55938753, "link": "https://stackoverflow.com/questions/55938753/how-to-pass-multiple-commands-to-shell-function-in-vba-using-putty/55946366#55946366", "title": "How to pass multiple commands to Shell function in VBA using putty?", "body": "<p>Create a batch file that works without using VBA then use the code you have above to simply call the batch file. Your issue is currently not related to VBA.</p>\n\n<p>See this post on how to make a batch file to login to a server w/ Putty.</p>\n\n<p><a href=\"https://superuser.com/questions/1278434/create-a-batch-file-or-shortcut-to-putty-ssh-that-opens-a-session-and-runs-a-c\">https://superuser.com/questions/1278434/create-a-batch-file-or-shortcut-to-putty-ssh-that-opens-a-session-and-runs-a-c</a></p>\n\n<p>Eg: I just test and this worked fine</p>\n\n<pre><code>Private Sub main_function()\n\n    cmd = \"C:\\test.cmd\"\n    retval = Shell(cmd, vbMaximizedFocus)\n\nEnd Sub\n</code></pre>\n\n<p>Make sure your batch works when you double click it, then call via VBA.</p>\n"}], "owner": {"reputation": 45, "user_id": 2536944, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a5031c8a92f606409c30e5ac6e60797a?s=128&d=identicon&r=PG", "display_name": "Vidhyasaghar", "link": "https://stackoverflow.com/users/2536944/vidhyasaghar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 677, "favorite_count": 1, "accepted_answer_id": 55946366, "answer_count": 1, "score": 2, "last_activity_date": 1556776366, "creation_date": 1556724787, "last_edit_date": 1556726468, "question_id": 55938753, "link": "https://stackoverflow.com/questions/55938753/how-to-pass-multiple-commands-to-shell-function-in-vba-using-putty", "title": "How to pass multiple commands to Shell function in VBA using putty?", "body": "<p>Am trying to connect to Linux server using VBA shell command. Am not able to execute multiple commands in it.</p>\n\n<p>I have the below code in my VBA script, and the command file which has the list of commands</p>\n\n<pre><code>Private Sub main_function()\n\n    cmd = \"C:\\putty.exe -t -ssh username@servername.com -pw password -P 22 -m c:\\cmd.txt\"\n    retval = Shell(cmd, vbMaximizedFocus)\n\nEnd Sub\n</code></pre>\n\n<p></p>\n\n<pre><code>sudo to user\ncat &gt; filename.txt\nsh shellfile.sh\n</code></pre>\n\n<p>I want to execute all the listed commands in the cmd.txt file but am not able to execute any command from the cmd.txt file, the code just logs in to the linux and exits.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556729269, "post_id": 55938721, "comment_id": 98532403, "body": "<code>Set olAttach = olItem.Attachments.item(1)</code> will fail if there are no attachments, so you first need to check whether there are any attachments. You can&#39;t check for <code>If Not olAttach Is Nothing</code> as you already triggered a run-time error. Your code could be simplified a lot if you use the <code>item</code> argument passed to your sub - that is the mail which triggered the event: no need to loop over your inbox every time..."}, {"owner": {"reputation": 102, "user_id": 11401691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebf01cf8746368323336aa1e5adcd52?s=128&d=identicon&r=PG&f=1", "display_name": "Computer_Nerd", "link": "https://stackoverflow.com/users/11401691/computer-nerd"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556733605, "post_id": 55938721, "comment_id": 98534350, "body": "Hi Tim, the four emails I receive daily and have &quot;Michael Jordan&quot; in the body have attachments. Do you know a way I can count the four items and then stop the code once I have received the four items?"}], "answers": [{"tags": [], "owner": {"reputation": 102, "user_id": 11401691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebf01cf8746368323336aa1e5adcd52?s=128&d=identicon&r=PG&f=1", "display_name": "Computer_Nerd", "link": "https://stackoverflow.com/users/11401691/computer-nerd"}, "is_accepted": true, "score": 0, "last_activity_date": 1556813591, "creation_date": 1556813591, "answer_id": 55956444, "question_id": 55938721, "link": "https://stackoverflow.com/questions/55938721/run-time-error-440-array-index-out-of-bounds-when-referencing-attachment-by/55956444#55956444", "title": "Run Time Error &#39;440&#39;; Array index out of bounds, when referencing attachment by index", "body": "<p>So I was able to answer my question. The conditions of my code were to save the attachments from emails with \"Michael Jordan\" in the body. These emails were only sent out on the early morning (between 12 AM and 6 AM). I know that I there are only FOUR emails sent and each email has ONE attachment so I put a break in my loop once I have a total count for four attachments.</p>\n\n<p>Below is my modified code</p>\n\n<pre><code>Public Sub April26(item As Outlook.MailItem)\n\n'\nDim olApp As Object\nDim olNS As Object\nDim myDate As Date\nDim olItems As Object\nDim olItem As Object\nDim olAttach As Object\nDim Date1 As String\nDim Date2 As String\nDim iAttachments As Integer\n\nDate1 = Date &amp; \" \" &amp; TimeValue(\"6:00:00\")\nDate2 = Date &amp; \" \" &amp; TimeValue(\"00:00:00\")\n\n\nOn Error Resume Next\nSet olApp = GetObject(, \"Outlook.Application\")\nErr.Clear: On Error GoTo 0\n\nIf olApp Is Nothing Then\nSet olApp = CreateObject(\"Outlook.Application\")\nFlg = True\nEnd If\n\nSet olNS = olApp.GetNamespace(\"MAPI\")\n\n\n\nSet olItems = olNS.GetDefaultFolder(olFolderInbox).Items\n\n\n\nFor Each olItem In olItems\n    If olItem.ReceivedTime &lt; Date1 Then\n    If olItem.ReceivedTime &gt; Date2 Then\n    If InStr(olItem.Body, \"Michael Jordan\") &gt; 0 Then\n    'MsgBox (olItem &amp; \" \" &amp; olItem.ReceivedTime)\n    iAttachments = olItem.Attachments.Count + iAttachments\n\n    Set olAttach = olItem.Attachments.item(1)\n\n    On Error GoTo Err_Handler\n    olAttach.SaveAsFile \"C:\\Desktop\\Outlook Downloads\" &amp; \"\\\" &amp; olAttach.FileName\n\n    Set olAttach = Nothing\n    Set olItem = Nothing\n\n\n    If iAttachments = 4 Then Exit For\n    End If\n    End If\n    End If\nNext\n\n\n    Set olAttach = Nothing\n    Set olItem = Nothing\n    Set olApp = Nothing\n    Set olNS = Nothing\n    Set olItems = Nothing\n\n\n\nExit Sub\n\nErr_Handler:\n    MsgBox \"An unexpected error has occurred.\" _\n        &amp; vbCrLf &amp; \"Please note and report the following information to Darth Vader.\" _\n        &amp; vbCrLf &amp; \"Macro Name: April26\" _\n        &amp; vbCrLf &amp; \"Error Number: \" &amp; Err.Number _\n        &amp; vbCrLf &amp; \"Error Description: \" &amp; Err.Description _\n        , vbCritical, \"Error!\"\n    Exit Sub\n\n\n\nEnd Sub\n\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1568851143, "creation_date": 1568851143, "answer_id": 58002059, "question_id": 55938721, "link": "https://stackoverflow.com/questions/55938721/run-time-error-440-array-index-out-of-bounds-when-referencing-attachment-by/58002059#58002059", "title": "Run Time Error &#39;440&#39;; Array index out of bounds, when referencing attachment by index", "body": "<p>The error is due to there being no attachments.</p>\n\n<p>With <code>On Error Resume Next</code> anticipated errors are bypassed. Since they are anticipated you will know how to handle them, or ignore if reasonable to do so. </p>\n\n<pre><code>Option Explicit\n\n' Extra lines for running code from applications other than Outlook removed\n\nPublic Sub April26(olItem As MailItem)\n\n    Dim myDate As Date\n    Dim olAttach As Attachment\n\n    If olItem.ReceivedTime &gt; Date Then\n\n        If InStr(olItem.Body, \"Michael Jordan\") &gt; 0 Then\n\n            ' Rare beneficial use of \"On Error Resume Next\"\n            On Error Resume Next\n            ' Bypass error if there is no attachment\n            Set olAttach = olItem.Attachments.item(1)\n            'If there is an error olAttach remains whatever it was before\n            ' In this case it is the initial value of Nothing\n            ' Remove error bypass as soon as the purpose is served\n            On Error GoTo 0\n\n            If Not olAttach Is Nothing Then\n                olAttach.SaveAsFile \"C:\\Users\\Desktop\\Outlook Downloads\" &amp; \"\\\" &amp; olAttach.fileName\n                ' If this type of error handling is in a loop,\n                '  reinitialize\n                ' Set olAttach = Nothing\n            End If\n\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 102, "user_id": 11401691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebf01cf8746368323336aa1e5adcd52?s=128&d=identicon&r=PG&f=1", "display_name": "Computer_Nerd", "link": "https://stackoverflow.com/users/11401691/computer-nerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 55956444, "answer_count": 2, "score": 0, "last_activity_date": 1568851143, "creation_date": 1556724663, "last_edit_date": 1568479378, "question_id": 55938721, "link": "https://stackoverflow.com/questions/55938721/run-time-error-440-array-index-out-of-bounds-when-referencing-attachment-by", "title": "Run Time Error &#39;440&#39;; Array index out of bounds, when referencing attachment by index", "body": "<p>I have an Outlook rule to run a script to save attachments.</p>\n\n<p>I insert an <code>Err.Clear</code> right after <code>Set olAttach = olItem.Attachments.item(1)</code> to clear an error in the code but this eventually causes the rule to fail.</p>\n\n<p>When I don't have the <code>Err.Clear</code> command the code stops and gives</p>\n\n<blockquote>\n  <p>Run Time Error '440'; Array index out of bounds.</p>\n</blockquote>\n\n<pre><code>Public Sub April26(item As Outlook.MailItem)\n\n'\nDim olApp As Object\nDim olNS As Object\nDim myDate As Date\nDim olItems As Object\nDim olItem As Object\nDim olAttach As Object\n\nOn Error Resume Next\nSet olApp = GetObject(, \"Outlook.Application\")\nErr.Clear: On Error GoTo 0\n\nIf olApp Is Nothing Then\n    Set olApp = CreateObject(\"Outlook.Application\")\n    Flg = True\nEnd If\n\nSet olNS = olApp.GetNamespace(\"MAPI\")\nSet olItems = olNS.GetDefaultFolder(olFolderInbox).Items\n\nFor Each olItem In olItems\n    If olItem.ReceivedTime &gt; Date Then\n        If InStr(olItem.Body, \"Michael Jordan\") &gt; 0 Then\n\n            Set olAttach = olItem.Attachments.item(1) '&lt;---\n            'Err.Clear: On Error GoTo 0               '&lt;---\n\n            If Not olAttach Is Nothing Then\n                On Error GoTo Finished\n                olAttach.SaveAsFile \"C:\\Users\\Desktop\\Outlook Downloads\" &amp; \"\\\" &amp; olAttach.FileName\n                Set olAttach = Nothing\n                Set olItem = Nothing\n            End If\n\n        End If\n    End If\nNext\n\nSet olApp = Nothing\nSet olNS = Nothing\nSet olItems = Nothing\n\nFinished:\nExit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1556724879, "post_id": 55938660, "comment_id": 98530467, "body": "Don&#39;t understand how any of it can work as <code>ArrO</code> is 3x2 but in main2 it is being defined as 2x3?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 2, "creation_date": 1556724923, "post_id": 55938660, "comment_id": 98530484, "body": "How are you calling <code>DoArrays</code>? I ask as I think you might be calling it as a UDF on the sheet itself? If so, you should know that UDFs can&#39;t (yes, there are rare exceptions) generally alter cells on the worksheet, other than the cell that&#39;s calling the UDF."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1556729712, "post_id": 55938660, "comment_id": 98532585, "body": "I&#39;m not seeing the circular reference that you&#39;re encountering. When I tried to run your code, I encountered a few blocking problems such as the array dimension mismatch that @SJR noted above plus your comparisons <code>nRT &lt;&gt; nC</code> and <code>nCT &lt;&gt; nR</code> I think are incorrect. (should be <code>nRT &lt;&gt; nR</code> and <code>nCT &lt;&gt; nC</code>?) I can&#39;t be sure because you haven&#39;t defined the size of your &quot;to&quot; array and what transform you&#39;re making on the &quot;from&quot; array."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1556729747, "post_id": 55938660, "comment_id": 98532608, "body": "If you are using this function on the worksheet, to return the individual values, either embed it into the <code>INDEX</code> function, and change the row/column indices as you fill the formula down and right, or enter it as an array over a range of cells large enough to encompass the results."}, {"owner": {"reputation": 1, "user_id": 11437531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-et6g1FaStDM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rciJ4Wz03kdF38OzyVDAJP0Y_0Pzw/mo/photo.jpg?sz=128", "display_name": "Christoph Ruchti", "link": "https://stackoverflow.com/users/11437531/christoph-ruchti"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1556815841, "post_id": 55938660, "comment_id": 98565625, "body": "@CLR: Thanks, you confirm what I suspected as explanation of my small test."}, {"owner": {"reputation": 1, "user_id": 11437531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-et6g1FaStDM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rciJ4Wz03kdF38OzyVDAJP0Y_0Pzw/mo/photo.jpg?sz=128", "display_name": "Christoph Ruchti", "link": "https://stackoverflow.com/users/11437531/christoph-ruchti"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1556889277, "post_id": 55938660, "comment_id": 98591832, "body": "@Ron: I tried your proposal with a range of cells large enough. But I could not get it working. But you motivated me to dig further. Finally I found a solution, which works for me. It is described in my next comment below."}, {"owner": {"reputation": 1, "user_id": 11437531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-et6g1FaStDM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rciJ4Wz03kdF38OzyVDAJP0Y_0Pzw/mo/photo.jpg?sz=128", "display_name": "Christoph Ruchti", "link": "https://stackoverflow.com/users/11437531/christoph-ruchti"}, "edited": false, "score": 0, "creation_date": 1556889358, "post_id": 55938660, "comment_id": 98591891, "body": "My function now accepts two ranges as input, each containing the data of a state vector. The calculations of the function generate a matrix.This matrix, which is declared as array of variant is assigned to the result of the function.On the worksheet I arrange the first state vector, the matrix and the second state vector nicely next to each other. The first cell of the matrix contains the function call, which is extended to the entire range with the CSE keystrokes. This works nicely. Althog 9 cells are computed, the function is evaluated only once."}], "owner": {"reputation": 1, "user_id": 11437531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-et6g1FaStDM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rciJ4Wz03kdF38OzyVDAJP0Y_0Pzw/mo/photo.jpg?sz=128", "display_name": "Christoph Ruchti", "link": "https://stackoverflow.com/users/11437531/christoph-ruchti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556724480, "creation_date": 1556724418, "last_edit_date": 1556724480, "question_id": 55938660, "link": "https://stackoverflow.com/questions/55938660/vba-macro-for-excel-having-an-array-as-input-and-an-array-as-output", "title": "VBA macro for Excel, having an array as input and an array as output", "body": "<p>I want to write a VBA function which takes an array as input from an Excel worksheet and puts a modified array as output to another range on the same worksheet.</p>\n\n<p>My arrays have typically 20 numbers and there are going to be lots of such calls on the same worksheet. I tried a simple example with a single 2x3 matrix and failed. Getting the input into VBA works fine, but I could not put the output from the function back to Excel. With a stand-alone subroutine I encounter no problem. </p>\n\n<pre><code>Option Explicit\n\nPrivate Const nR As Long = 3\nPrivate Const nC As Long = 2\n\nPublic MsgTxt As String\nPublic MsgTit As String\nPublic iMsg As Integer\n\nPrivate ArrO(1 To nR, 1 To nC) As Variant\n\nFunction DoArrays(wrF As Range, wrT As Range) As Long\n    Dim nRI As Long\n    Dim nCI As Long\n    Dim iR As Long\n    Dim iC As Long\n    Dim wc1 As Range\n    Dim wcx As Range\n\n    Dim ArrI() As Variant\n    ArrI = wrF.Value\n\n    nRI = wrF.Rows.Count\n    If nRI &lt;&gt; nR Then\n        MsgTit = \"GetArray: misaligned rows\"\n        MsgTxt = \"nRI = \" &amp; CStr(nRI)\n        iMsg = MsgBox(MsgTxt, vbCritical, MsgTit)\n        End\n    End If\n\n    nCI = wrF.Columns.Count\n    If nCI &lt;&gt; nC Then\n        MsgTit = \"GetArray: misaligned columns\"\n        MsgTxt = \"nCI = \" &amp; CStr(nCI)\n        iMsg = MsgBox(MsgTxt, vbCritical, MsgTit)\n        End\n    End If\n\n    For iR = 1 To nR\n        For iC = 1 To nC\n            ArrO(iC, iR) = -ArrI(iR, iC)\n        Next iC\n    Next iR\n\n    Set wc1 = wrF.Cells(1, 1)\n    Set wcx = wrF.Cells(nR, nC)\n\n    MsgTit = \"DoArrays\"\n    MsgTxt = \"\"\n    MsgTxt = MsgTxt &amp; vbCrLf &amp; \"Range wrF\"\n    MsgTxt = MsgTxt &amp; vbCrLf &amp; \"# rows = \" &amp; CStr(nR)\n    MsgTxt = MsgTxt &amp; vbCrLf &amp; \"# cols = \" &amp; CStr(nC)\n    MsgTxt = MsgTxt &amp; vbCrLf &amp; \"address of first cell = \" &amp; wc1.Address\n    MsgTxt = MsgTxt &amp; vbCrLf &amp; \"address of last  cell = \" &amp; wcx.Address\n    MsgTxt = MsgTxt &amp; vbCrLf &amp; \"Array Arr\"\n    MsgTxt = MsgTxt &amp; vbCrLf &amp; \" 1st index runs \" &amp; CStr(LBound(ArrI, 1)) &amp; \" to \" &amp; CStr(UBound(ArrI, 1))\n    MsgTxt = MsgTxt &amp; vbCrLf &amp; \" 2nd index runs \" &amp; CStr(LBound(ArrI, 2)) &amp; \" to \" &amp; CStr(UBound(ArrI, 2))\n    iMsg = MsgBox(MsgTxt, vbInformation, MsgTit)\n\n    Call PutArray(wrT)\n\n    DoArrays = nR * nC\nEnd Function\n\nSub PutArray(wrT As Range)\n    Dim nRT As Long\n    Dim nCT As Long\n\n    nRT = wrT.Rows.Count\n    If nRT &lt;&gt; nC Then\n        MsgTit = \"PutArray: misaligned rows\"\n        MsgTxt = \"nRT = \" &amp; CStr(nRT)\n        iMsg = MsgBox(MsgTxt, vbCritical, MsgTit)\n        End\n    End If\n\n    nCT = wrT.Columns.Count\n    If nCT &lt;&gt; nR Then\n        MsgTit = \"PutArray: misaligned columns\"\n        MsgTxt = \"nCT = \" &amp; CStr(nCT)\n        iMsg = MsgBox(MsgTxt, vbCritical, MsgTit)\n        End\n    End If\n\n    MsgTit = \"Range wrT in Putarray\"\n    MsgTxt = \"\"\n    MsgTxt = MsgTxt &amp; vbCrLf &amp; \"Range wrT\"\n    MsgTxt = MsgTxt &amp; vbCrLf &amp; \"# rows = \" &amp; CStr(nR)\n    MsgTxt = MsgTxt &amp; vbCrLf &amp; \"# cols = \" &amp; CStr(nC)\n    iMsg = MsgBox(MsgTxt, vbInformation, MsgTit)\n\n    wrT.Value = ArrO\nEnd Sub\n\nSub main2()\n    Dim wr As Range\n    Dim ws As Worksheet\n\n    ArrO(1, 1) = 11\n    ArrO(1, 2) = 21\n    ArrO(1, 3) = 31\n    ArrO(2, 1) = 12\n    ArrO(2, 2) = 22\n    ArrO(2, 3) = 32\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet2\")\n\n    Set wr = ws.Range(ws.Cells(9, 2), ws.Cells(10, 4))\n\n    Call PutArray(wr)\nEnd Sub\n</code></pre>\n\n<p>The function DoArrays works fine all the way to the very last statment in the subroutine PutArray. Ther it fails and returns with #VALUE.  The same subroutine PutArray works fine if it is called in 'stand-alone' manner from the sub Main2. </p>\n\n<p>I suspect the issue here is the ability of Excel to detect circular references. But there must be a soultion. The built-in function MINV is providing exactly the functionality I want. Is there a way to use the magic CSE key strokes (control shift enter) in connection with a VBA macro?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 2, "creation_date": 1556722962, "post_id": 55938264, "comment_id": 98529454, "body": "<code>If Not IsEmpty(whatever)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1556727947, "post_id": 55938311, "comment_id": 98531847, "body": "I&#39;m missing something. OP says the &quot;blank&quot; is &quot;in the userform&quot;, i.e. the textboxes contain an empty string (which isn&#39;t <code>Empty</code> and won&#39;t work with <code>IsEmpty</code>) -- but then accepts this answer which checks whether the cells about to be written to, are empty. I&#39;m... confused."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1556728305, "post_id": 55938311, "comment_id": 98531978, "body": "@MathieuGuindon - I was actually just thinking the same. I referenced cells, not userform. ...but it got accepted...?  Maybe just the idea of using an &quot;If&quot; statement hadn&#39;t occurred to OP, so <i>that&#39;s</i> the part that helped?  I think instead they could do <code>If tbAvP.Text &lt;&gt; &quot;&quot; ...</code>?"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1556723350, "last_edit_date": 1556723350, "creation_date": 1556722955, "answer_id": 55938311, "question_id": 55938264, "link": "https://stackoverflow.com/questions/55938264/how-do-i-skip-this-line-when-userform-is-blank/55938311#55938311", "title": "How do I skip this line when Userform is blank?", "body": "<p>You could add an IF statement:</p>\n\n<pre><code>With Sheets(\"Test\")\n    If .Cells(7, lrCal).Value &lt;&gt; \"\" or .Cells(8, lrCal).Value &lt;&gt; \"\" Then\n        [your code]\n    End IF\nEnd With\n</code></pre>\n\n<p>You might need to break that in to two separate statements, if one can be blank, and you want to calculate the other.  But the above should give you general idea on how to handle this.</p>\n\n<p>Edit: Or, as @Damian noted in a comment, you can use <code>If Not IsEmpty([cell ref]) or Not IsEmpty([other cell ref]) Then</code></p>\n"}], "owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 55938311, "answer_count": 1, "score": -1, "last_activity_date": 1556723369, "creation_date": 1556722780, "last_edit_date": 1556723369, "question_id": 55938264, "link": "https://stackoverflow.com/questions/55938264/how-do-i-skip-this-line-when-userform-is-blank", "title": "How do I skip this line when Userform is blank?", "body": "<p>How do I skip these lines in my codes? So I have a userform where it will input data but for some of the data there a percent. So I set it up like this:</p>\n\n<pre><code>With Sheets(\"Test\")\n      .cells(7,lrCal).Value = tbAvP.Text / 100\n      .cells(8,lrcal).Value = tbAcc.Text / 100\nend With\n</code></pre>\n\n<p>I understand that the error is that the code read blank equal to zero. How would I bypass this if there a blank in the userform?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1556722797, "post_id": 55938221, "comment_id": 98529380, "body": "Do you mean the 46 will change? Given that you seemingly know to find the last row in a column, I&#39;m not clear why you need help?"}, {"owner": {"reputation": 79, "user_id": 11385750, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rn_1Ha_ZydE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re_k5YfmZaWr7QgmmbK4SRwaqw15A/mo/photo.jpg?sz=128", "display_name": "Djhans26 ", "link": "https://stackoverflow.com/users/11385750/djhans26"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1556723298, "post_id": 55938221, "comment_id": 98529622, "body": "The 46 will change, yes. I don\u2019t know how to make that a variable as well as F46 in range needs to be a variable as that will change every week."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 11385750, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rn_1Ha_ZydE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re_k5YfmZaWr7QgmmbK4SRwaqw15A/mo/photo.jpg?sz=128", "display_name": "Djhans26 ", "link": "https://stackoverflow.com/users/11385750/djhans26"}, "edited": false, "score": 1, "creation_date": 1556724316, "post_id": 55938415, "comment_id": 98530180, "body": "This works tremendously! Thank you for the help and sorry if I didn\u2019t explain it very well."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1556723388, "creation_date": 1556723388, "answer_id": 55938415, "question_id": 55938221, "link": "https://stackoverflow.com/questions/55938221/i-need-to-insert-a-vlookup-in-a-cell-after-the-last-row-that-could-vary-from-wee/55938415#55938415", "title": "I need to insert a vlookup in a cell after the last row that could vary from week to week", "body": "<p>Try this, not 100% sure I have understood. You can change the variable name to something better.</p>\n\n<pre><code>Sub vlookup()\n    Dim TR As Long, TRf As Long\n    TR = Range(\"C\" &amp; Rows.count).End(xlUp).Row\n    TRf = Range(\"F\" &amp; Rows.count).End(xlUp).Row + 1\n    Range(\"F\" &amp; TRf &amp; \":F\" &amp; TR).Formula = \"=Vlookup(C\" &amp; TRf &amp; \",OpenDCSInvoices!$A:$C, 3, False)\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 11385750, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rn_1Ha_ZydE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re_k5YfmZaWr7QgmmbK4SRwaqw15A/mo/photo.jpg?sz=128", "display_name": "Djhans26 ", "link": "https://stackoverflow.com/users/11385750/djhans26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 55938415, "answer_count": 1, "score": 0, "last_activity_date": 1556779436, "creation_date": 1556722557, "last_edit_date": 1556779436, "question_id": 55938221, "link": "https://stackoverflow.com/questions/55938221/i-need-to-insert-a-vlookup-in-a-cell-after-the-last-row-that-could-vary-from-wee", "title": "I need to insert a vlookup in a cell after the last row that could vary from week to week", "body": "<pre><code>Sub vlookup\n    Dim TR As Long\n    TR = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n    Range(\"F46\").Formula =\"=Vlookup(C46,OpenDCSInvoices!$A:$C, 3, False)\"\n    Range(\"F46\").Copy\n    Range(\"F46:F\" &amp; TR).PasteSpecial xlPasteAll\nEnd sub\n</code></pre>\n\n<p>As this is a weekly report it varies so the vlookup may be inserted in a different cell depending on how big or small the data file is. This code works for this week but it won\u2019t work for next week as it will change. I need to insert the vlookup in column F after the last cell of data as I am adding to existing data and it needs to lookup the value in column C that is adjacent to where the vlookup will start. Thank you and anything helps as I am stuck.</p>\n"}, {"tags": ["excel", "vba", "loops", "worksheet"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1556722482, "post_id": 55938128, "comment_id": 98529221, "body": "Which line errors? Possibly you don&#39;t have a table with the name."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1556722597, "post_id": 55938128, "comment_id": 98529270, "body": "You&#39;re attempting to refresh <b>all</b> of those tables on <b>each</b> worksheet. Is there a copy of all 5 tables on every worksheet?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1556722860, "post_id": 55938128, "comment_id": 98529406, "body": "To add to @CLR&#39;s comment, table names have Workbook scope so you even if you had a copy on each sheet, the names would vary."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1556722995, "post_id": 55938128, "comment_id": 98529476, "body": "@BigBen - good point, and we now know why it errors so you need to check first whether the table exists or vary the list of tables according to the sheet."}, {"owner": {"reputation": 143, "user_id": 8131651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212848180980497/picture?type=large", "display_name": "Simone Fick", "link": "https://stackoverflow.com/users/8131651/simone-fick"}, "edited": false, "score": 0, "creation_date": 1556723157, "post_id": 55938128, "comment_id": 98529561, "body": "@ SJR this line errors: &quot;sh.ListObjects(TableNames(i)).DataBodyRange.Font.Size = 10&quot;"}, {"owner": {"reputation": 143, "user_id": 8131651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212848180980497/picture?type=large", "display_name": "Simone Fick", "link": "https://stackoverflow.com/users/8131651/simone-fick"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1556723256, "post_id": 55938128, "comment_id": 98529602, "body": "@CLR each worksheet only has one table in it, which corresponds to the sheet name as well. All the tables do exist, I run a lot of other code on them."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1556723309, "post_id": 55938128, "comment_id": 98529630, "body": "@SimoneFick - if you follow our discussion you&#39;ll see that we have established the cause of the error."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1556723440, "post_id": 55938128, "comment_id": 98529711, "body": "If there&#39;s only one table on those sheets, then loop through those sheets only and modify the first table on them."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1556723493, "post_id": 55938128, "comment_id": 98529738, "body": "If there&#39;s only one table on each sheet you don&#39;t need the second loop at all. Just use the index."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1556723547, "post_id": 55938128, "comment_id": 98529768, "body": "<code>sh.ListObjects(1).DataBodyRange.Font.Size = 10</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1556723586, "post_id": 55938128, "comment_id": 98529793, "body": "@SJR yes, the best answer. I&#39;ll upvote if you add it."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1556723802, "post_id": 55938128, "comment_id": 98529895, "body": "@BigBen - thanks, you&#39;re a gent!"}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 8131651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212848180980497/picture?type=large", "display_name": "Simone Fick", "link": "https://stackoverflow.com/users/8131651/simone-fick"}, "edited": false, "score": 0, "creation_date": 1556731984, "post_id": 55938413, "comment_id": 98533546, "body": "This seems to be the best way to go since I have other sheets with tables on as well. I get a different error now:&quot; &#39;91&#39; Object variable or With block variable not set.&quot; on the following line: &quot; tbl.DataBodyRange.Font.Size = 10 &quot;"}, {"owner": {"reputation": 143, "user_id": 8131651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212848180980497/picture?type=large", "display_name": "Simone Fick", "link": "https://stackoverflow.com/users/8131651/simone-fick"}, "edited": false, "score": 0, "creation_date": 1556732182, "post_id": 55938413, "comment_id": 98533630, "body": "Will it be easier to make a list of the Worksheet names and then just loop through those sheets and format any table on it?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 143, "user_id": 8131651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212848180980497/picture?type=large", "display_name": "Simone Fick", "link": "https://stackoverflow.com/users/8131651/simone-fick"}, "edited": false, "score": 0, "creation_date": 1556785402, "post_id": 55938413, "comment_id": 98549337, "body": "Try adding a <code>Debug.print sh.Name, tbl.Name</code> line before the font size change so you can see which sheet and table it&#39;s getting stuck on."}, {"owner": {"reputation": 143, "user_id": 8131651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212848180980497/picture?type=large", "display_name": "Simone Fick", "link": "https://stackoverflow.com/users/8131651/simone-fick"}, "edited": false, "score": 0, "creation_date": 1557138391, "post_id": 55938413, "comment_id": 98652400, "body": "I get a list with 3 of the 5 sheets."}, {"owner": {"reputation": 143, "user_id": 8131651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212848180980497/picture?type=large", "display_name": "Simone Fick", "link": "https://stackoverflow.com/users/8131651/simone-fick"}, "edited": false, "score": 0, "creation_date": 1557140008, "post_id": 55938413, "comment_id": 98653131, "body": "@ CLR It got stuck on an empty table, so I just put in <code>On Error Resume Next</code> and it worked, thank you so much for all the help!"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 143, "user_id": 8131651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212848180980497/picture?type=large", "display_name": "Simone Fick", "link": "https://stackoverflow.com/users/8131651/simone-fick"}, "edited": false, "score": 0, "creation_date": 1557223237, "post_id": 55938413, "comment_id": 98683930, "body": "Rather than using <code>On Error..</code> you might be better off wrapping the font change code in a <code>If tbl.ListRows.Count &gt; 0 Then ... &lt;code&gt; .. End If</code> to prevent the code attempting to run on an empty table."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 2, "last_activity_date": 1556723774, "last_edit_date": 1556723774, "creation_date": 1556723387, "answer_id": 55938413, "question_id": 55938128, "link": "https://stackoverflow.com/questions/55938128/trying-to-loop-through-worksheets-and-format-specific-tables-in-them/55938413#55938413", "title": "Trying to loop through worksheets and format specific tables in them", "body": "<p>Here's one way of fixing your code:</p>\n\n<pre><code>For Each sh In wbTemplate.Worksheets\n    For i = LBound(TableNames) To UBound(TableNames)\n\n        For Each tbl In sh.ListObjects\n            If tbl.Name = TableNames(i) Then\n                tbl.DataBodyRange.Font.Size = 10\n            End If\n        Next tbl\n\n    Next i\nNext sh\n</code></pre>\n\n<p>So I've used your code to cycle through each sheet and each tablename in your array - but then instead of running the code on <em>that</em>, we check every table (<code>tbl</code>) on sheet <code>sh</code> and if the name matches the name you're looking for, <strong><em>then</em></strong> the code runs.</p>\n\n<hr>\n\n<p>If you want to refresh any and all tables on each worksheet, then this is simple:</p>\n\n<pre><code>For Each sh In wbTemplate.Worksheets\n    For Each tbl In sh.ListObjects\n        tbl.DataBodyRange.Font.Size = 10\n    Next\nNext sh\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1556723769, "creation_date": 1556723769, "answer_id": 55938503, "question_id": 55938128, "link": "https://stackoverflow.com/questions/55938128/trying-to-loop-through-worksheets-and-format-specific-tables-in-them/55938503#55938503", "title": "Trying to loop through worksheets and format specific tables in them", "body": "<p>If you have only one table on each sheet, you can dispense with the second loop altogether and the array of names and just use the collection's index (1).</p>\n\n<p>If you have other tables, use CLR's approach.</p>\n\n<pre><code>Sub x()\n\nDim wbTemplate As Workbook\nDim sh As Worksheet\n\nFor Each sh In wbTemplate.Worksheets\n    sh.ListObjects(1).DataBodyRange.Font.Size = 10\nNext sh\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 8131651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212848180980497/picture?type=large", "display_name": "Simone Fick", "link": "https://stackoverflow.com/users/8131651/simone-fick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 55938413, "answer_count": 2, "score": 0, "last_activity_date": 1556779431, "creation_date": 1556722206, "last_edit_date": 1556779431, "question_id": 55938128, "link": "https://stackoverflow.com/questions/55938128/trying-to-loop-through-worksheets-and-format-specific-tables-in-them", "title": "Trying to loop through worksheets and format specific tables in them", "body": "<p>Instead of coding for every specific worksheet to format specific tables, I want to create a loop that formats only the tables in the list, on different worksheets.</p>\n\n<p>current code: (sh and wbTemplate defined and set earlier in the code)</p>\n\n<pre><code>Dim AllTableNames As String\nDim TableNames As Variant\nDim i As Long\n\n    AllTableNames = \"Table_Dormant_Stock,Table_Overstock,Table_Negative_Stock,Table_Outdated_Stock_Counts,Table_Waste_Returns\"\n    TableNames = Split(AllTableNames, \",\")\n\n    For Each sh In wbTemplate.Worksheets\n        For i = LBound(TableNames) To UBound(TableNames)\n           sh.ListObjects(TableNames(i)).DataBodyRange.Font.Size = 10\n        Next i\n    Next sh\n</code></pre>\n\n<p>I get \"Run-time Error \"9\": Subscript out of range\".\nI know it has something to do with the second loop, I've never done it before so not sure how to fix it.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11232616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Re1MXVlAwHk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdvF53CseM4HwleD50Cc8uCP4vGUQ/mo/photo.jpg?sz=128", "display_name": "NewAtSQL", "link": "https://stackoverflow.com/users/11232616/newatsql"}, "edited": false, "score": 0, "creation_date": 1556721933, "post_id": 55937996, "comment_id": 98528907, "body": "I have tried that, but it still shows 13, even after changing the textboxes format to &quot;fhmy&quot;0000000"}, {"owner": {"reputation": 114574, "user_id": 10498828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1360dd652f1e970ba098d1d5b63c14d?s=128&d=identicon&r=PG&f=1", "display_name": "forpas", "link": "https://stackoverflow.com/users/10498828/forpas"}, "reply_to_user": {"reputation": 25, "user_id": 11232616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Re1MXVlAwHk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdvF53CseM4HwleD50Cc8uCP4vGUQ/mo/photo.jpg?sz=128", "display_name": "NewAtSQL", "link": "https://stackoverflow.com/users/11232616/newatsql"}, "edited": false, "score": 0, "creation_date": 1556722243, "post_id": 55937996, "comment_id": 98529087, "body": "Then you are doing something wrong. If you change the format to <code>&quot;FHMY&quot;0000000</code> you will see the correct value like <code>FHMY0000013</code>"}, {"owner": {"reputation": 25, "user_id": 11232616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Re1MXVlAwHk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdvF53CseM4HwleD50Cc8uCP4vGUQ/mo/photo.jpg?sz=128", "display_name": "NewAtSQL", "link": "https://stackoverflow.com/users/11232616/newatsql"}, "edited": false, "score": 0, "creation_date": 1556722330, "post_id": 55937996, "comment_id": 98529137, "body": "i have added a snapshot (form2 format) in the question, check it..i might be doing something wrong, but i dont know what."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 25, "user_id": 11232616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Re1MXVlAwHk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdvF53CseM4HwleD50Cc8uCP4vGUQ/mo/photo.jpg?sz=128", "display_name": "NewAtSQL", "link": "https://stackoverflow.com/users/11232616/newatsql"}, "edited": false, "score": 0, "creation_date": 1556722832, "post_id": 55937996, "comment_id": 98529396, "body": "@NewAtSQL <code>Format</code> controls how the field is displayed. It does not affect its underlying value. FWIW you should avoid using PK/ID (autonumber) columns for that purpose - PK should have no meaning whatsoever for anything other than the database engine."}, {"owner": {"reputation": 25, "user_id": 11232616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Re1MXVlAwHk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdvF53CseM4HwleD50Cc8uCP4vGUQ/mo/photo.jpg?sz=128", "display_name": "NewAtSQL", "link": "https://stackoverflow.com/users/11232616/newatsql"}, "edited": false, "score": 0, "creation_date": 1556723023, "post_id": 55937996, "comment_id": 98529494, "body": "thanks guys, that worked (changing datatype of form2&#39;s table to number instead of text) :)"}], "tags": [], "owner": {"reputation": 114574, "user_id": 10498828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1360dd652f1e970ba098d1d5b63c14d?s=128&d=identicon&r=PG&f=1", "display_name": "forpas", "link": "https://stackoverflow.com/users/10498828/forpas"}, "is_accepted": true, "score": 1, "last_activity_date": 1556722714, "last_edit_date": 1556722714, "creation_date": 1556721657, "answer_id": 55937996, "question_id": 55937818, "link": "https://stackoverflow.com/questions/55937818/fomatted-autonumbered-text-not-getting-copied-from-one-form-to-another/55937996#55937996", "title": "Fomatted autonumbered text not getting copied from one form to another", "body": "<p>This happens because the values stored in the table for the column <code>JOB</code> are numbers like <code>13, 14, 15</code> etc and not <code>FHMY0000013, FHMY0000014, FHMY0000015</code>. <br/>\nAs you can see in the definition of the column, the <em>Format</em> attribute is set to <code>\"FHMY\"0000000</code> and this is valid only for presentation purposes. <br/>\nSo in forms and tables you see <code>FHMY0000013</code> when the actual value stored is <code>13</code>.<br/>\nIf you want to see in textbox in form2 the copied values formatted you must also change the <em>Format</em> of this textbox to: <code>\"FHMY\"0000000</code><br/>\nAnother case is that in the underlying table of form2 the column represented by the textbox is defined as data type <code>TEXT</code>. <br/>\nChange it to <code>Number</code>.</p>\n"}], "owner": {"reputation": 25, "user_id": 11232616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Re1MXVlAwHk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdvF53CseM4HwleD50Cc8uCP4vGUQ/mo/photo.jpg?sz=128", "display_name": "NewAtSQL", "link": "https://stackoverflow.com/users/11232616/newatsql"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18, "favorite_count": 0, "accepted_answer_id": 55937996, "answer_count": 1, "score": 0, "last_activity_date": 1556722714, "creation_date": 1556720778, "last_edit_date": 1556722097, "question_id": 55937818, "link": "https://stackoverflow.com/questions/55937818/fomatted-autonumbered-text-not-getting-copied-from-one-form-to-another", "title": "Fomatted autonumbered text not getting copied from one form to another", "body": "<p>I have written a macro to copy data from one textbox in form1 to a textbox in form2.</p>\n\n<p>The textbox in form1 fetches value from a field in DB which is autonumbered and uses the format \"FHMY\"0000000</p>\n\n<p>My code works but instead of copying the formatted text(number) it just copies the sequence number:</p>\n\n<p>Lets say 13th entry in table associated with form1 is fhmy0000013, but when i use the macro it copies 13 and not the text fhmy0000013.</p>\n\n<p><a href=\"https://i.stack.imgur.com/07VFy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/07VFy.png\" alt=\"format\"></a></p>\n\n<pre><code>Option Compare Database\n\nPrivate Sub Command119_Click()\n\nDoCmd.OpenForm \"PrinterFhamylabel\"\n\nForms![PrinterFhamyLabel].JOB = Me.JOBNum\n\nMe.JOBNum.SetFocus\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/O2XDO.png\" rel=\"nofollow noreferrer\">form2 property</a></p>\n"}, {"tags": ["excel", "vba", "excel-2010"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1556720221, "post_id": 55937623, "comment_id": 98528037, "body": "What is your question? You just posted your code which creates the xl file and this code, I assume, runs fine. I do not see any code where you try to email the file you created."}, {"owner": {"reputation": 165, "user_id": 10443658, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LP9ALIqkcVc/AAAAAAAAAAI/AAAAAAAAAFc/kGaxZ5Vpx0g/photo.jpg?sz=128", "display_name": "Kaustubh Ursekar", "link": "https://stackoverflow.com/users/10443658/kaustubh-ursekar"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1556720428, "post_id": 55937623, "comment_id": 98528134, "body": "That is exactly my question. What and where should I add to get it e-mailed."}, {"owner": {"reputation": 165, "user_id": 10443658, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LP9ALIqkcVc/AAAAAAAAAAI/AAAAAAAAAFc/kGaxZ5Vpx0g/photo.jpg?sz=128", "display_name": "Kaustubh Ursekar", "link": "https://stackoverflow.com/users/10443658/kaustubh-ursekar"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1556720449, "post_id": 55937623, "comment_id": 98528142, "body": "I am new to VB so i do not know the stuff. :("}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556720985, "post_id": 55937623, "comment_id": 98528411, "body": "This looks like making Excel to the job of SQL Server Reporting Services (SSRS)... scheduling Excel to run unattended is not a recommended scenario."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1556721036, "post_id": 55937623, "comment_id": 98528443, "body": "I&#39;d suggest to look <a href=\"https://www.rondebruin.nl/win/s1/outlook/mail.htm\" rel=\"nofollow noreferrer\">here</a> and come back if you get stuck. Right now this is kind of &quot;gimme the code&quot; question. And as Mathieu wrote, using xl for such kind of reporting might not be a good idea."}, {"owner": {"reputation": 165, "user_id": 10443658, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LP9ALIqkcVc/AAAAAAAAAAI/AAAAAAAAAFc/kGaxZ5Vpx0g/photo.jpg?sz=128", "display_name": "Kaustubh Ursekar", "link": "https://stackoverflow.com/users/10443658/kaustubh-ursekar"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556721205, "post_id": 55937623, "comment_id": 98528532, "body": "So what you suggest @MathieuGuindon"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 3, "creation_date": 1556721517, "post_id": 55937623, "comment_id": 98528696, "body": "I would probably write stored procedure that gives me everything I need to recreate the worksheet report on SSRS, deploy to the report server, and set up subscriptions to that the emailing happens server-side, without involving Excel, Outlook, or VBA. But if none of it is configured and you need it fast, look into the link @Storax provided =)"}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 11435272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3puYmqG6nic/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrrfKMQxnbsGQ2eYtiz9DhFpV5Ug/mo/photo.jpg?sz=128", "display_name": "therealJoeT", "link": "https://stackoverflow.com/users/11435272/therealjoet"}, "is_accepted": false, "score": 1, "last_activity_date": 1556724212, "last_edit_date": 1556724212, "creation_date": 1556723802, "answer_id": 55938514, "question_id": 55937623, "link": "https://stackoverflow.com/questions/55937623/how-to-e-mail-the-entire-excel-file-through-vba-script/55938514#55938514", "title": "How to e-mail the entire excel file through VBA script", "body": "<p>This depends heavily on how you want to send the email.  Are you using outlook or are you trying to send it through gmail, yahoo or a private smtp server?  </p>\n\n<p>Regardless, I would put the vba code to send the file in the module of the excel file.  The bat file calls Macro1 to update the workbook and then runs the macro code inside the module in the workbook.  Make sure the code is in a module, not in any of the sheets or workbook.  If you are using outlook to email, the code inside the module should look something like this with the Outlook Application module loaded in the library references:</p>\n\n<pre><code>Sub Email_Active_Workbook()\n'Working in Excel 2000-2016\n    Dim OutApp As Object\n    Dim OutMail As Object\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n    With OutMail\n        .to = \"email@address\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"This is the Subject line\"\n        .Body = \"Hi there\"\n        .Attachments.Add ActiveWorkbook.FullName\n        .Send   'or use .Display\n    End With\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>This is adapted from: <a href=\"https://www.rondebruin.nl/win/s1/outlook/amail1.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s1/outlook/amail1.htm</a></p>\n\n<p>This site is also worth referencing if sending through outlook: <a href=\"https://wellsr.com/vba/2018/excel/vba-send-email-from-excel/\" rel=\"nofollow noreferrer\">https://wellsr.com/vba/2018/excel/vba-send-email-from-excel/</a></p>\n\n<p>And this: \n<a href=\"https://powerspreadsheets.com/send-email-excel-vba/\" rel=\"nofollow noreferrer\">https://powerspreadsheets.com/send-email-excel-vba/</a></p>\n\n<p>And then in your VB file Macro1 below the <code>objWorkbook.save</code> line add:</p>\n\n<pre><code>objExcel.Application.Run \"StdztnRefRepTrial.xlsx!Email_Active_Workbook\"\n\n</code></pre>\n\n<p>If your sending through an smtp server, it become slightly more complicated because you need to ensure the CDO library is loaded and it depends on the security settings of the mail server.  This thread gives a working example of VBA sending an email on a PC, which can easily be adapted to your needs: <a href=\"https://stackoverflow.com/questions/51990005/send-email-with-workbook-from-vba-macro-on-both-windows-and-mac\">Send email with workbook from VBA macro on both Windows and Mac</a></p>\n\n<p>If SSL is required, it gets a little more complex.  See this site for more details, specifically the link to Github for the SSL code: <a href=\"https://www.makeuseof.com/tag/send-emails-excel-vba/\" rel=\"nofollow noreferrer\">https://www.makeuseof.com/tag/send-emails-excel-vba/</a></p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I completely agree with the prior comments, this is not the best way to accomplish reporting SQL data.  This can be a quick fix, but using SSRS to send these reports should be your primary focus.  I hope this isn't mission critical data, otherwise the emails will not get sent if you get an error when you leave this unattended.</p>\n"}, {"tags": [], "owner": {"reputation": 165, "user_id": 10443658, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LP9ALIqkcVc/AAAAAAAAAAI/AAAAAAAAAFc/kGaxZ5Vpx0g/photo.jpg?sz=128", "display_name": "Kaustubh Ursekar", "link": "https://stackoverflow.com/users/10443658/kaustubh-ursekar"}, "is_accepted": true, "score": 1, "last_activity_date": 1582363078, "last_edit_date": 1582363078, "creation_date": 1582304509, "answer_id": 60343259, "question_id": 55937623, "link": "https://stackoverflow.com/questions/55937623/how-to-e-mail-the-entire-excel-file-through-vba-script/60343259#60343259", "title": "How to e-mail the entire excel file through VBA script", "body": "<p>I know this is old question. I am doing this just for the purpose of future newbies of VB and SO who might encounter similar or same problems as per imaginary demands of their clients.</p>\n\n<p>I have pasted my entire code and the Solution of the code with the help of highly revered VB developers at SO. The same question and its solution can be found below at this given link below:</p>\n\n<p><a href=\"https://codereview.stackexchange.com/questions/219371/write-to-excel-from-sql-db-using-vba-script/219378#219378\">https://codereview.stackexchange.com/questions/219371/write-to-excel-from-sql-db-using-vba-script/219378#219378</a></p>\n"}], "owner": {"reputation": 165, "user_id": 10443658, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LP9ALIqkcVc/AAAAAAAAAAI/AAAAAAAAAFc/kGaxZ5Vpx0g/photo.jpg?sz=128", "display_name": "Kaustubh Ursekar", "link": "https://stackoverflow.com/users/10443658/kaustubh-ursekar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 1, "accepted_answer_id": 60343259, "answer_count": 2, "score": 1, "last_activity_date": 1582363078, "creation_date": 1556719891, "last_edit_date": 1556723862, "question_id": 55937623, "link": "https://stackoverflow.com/questions/55937623/how-to-e-mail-the-entire-excel-file-through-vba-script", "title": "How to e-mail the entire excel file through VBA script", "body": "<p>I wish to automate emailing of my excel file which is currently being performed by me manually</p>\n\n<p>I have the following flow structure:\nTask scheduler -> .bat file -> VBA script -> excel formulas</p>\n\n<p>This means that my task scheduler will hit .bat file which would trigger VB file to execute the code and this will dump data from SQL DB into Excel file and then formulas inside of Excel file will prepare charts and graphs and all the calculations.</p>\n\n<p>Here is my code of VB file:</p>\n\n<pre><code>    Macro1\nPrivate Sub Macro1()\n\nSet objExcel  = CreateObject(\"Excel.Application\")\nSet objWorkbook = objExcel.Workbooks.Open(\"C:\\Users\\kursekar\\Documents\\Work\\Apps\\ReferralStrApp\\StdztnRefRepTrial.xlsx\")\nobjExcel.Visible = False\nSet Conn = CreateObject(\"ADODB.Connection\")\nSet RS   = CreateObject(\"ADODB.Recordset\") \nDim SQL\nDim Sconnect\nSconnect = \"Provider=SQLOLEDB.1;Password='25LaurelRoad';User ID='CPSMDIT\\kursekar';Data Source='analyzer';Initial Catalog='analyzer_str';Integrated Security=SSPI; Persist Security Info=True;\"\nConn.Open Sconnect\n\nSQL = \"WITH cte_REFERRALS_REPORTS(referralnum, refer_from, refer_from_name, refer_from_id, refer_to, refer_to_name, refer_to_id) AS (SELECT referralnum, refer_from, CASE WHEN refer_from_id = 'R' THEN RdicF.refname WHEN refer_from_id = 'P' THEN PdicF.provname END AS refer_from_name, refer_from_id, refer_to, \"\nSQL = SQL &amp; \"CASE WHEN refer_to_id = 'R' THEN RdicT.refname WHEN refer_to_id = 'P' THEN PdicT.provname END AS refer_to_name, refer_to_id FROM referral_t r Left Join refcode_t RdicF ON  r.refer_from = CASE WHEN r.refer_from_id='R' THEN RdicF.refcode ELSE NULL END Left Join refcode_t RdicT ON  r.refer_to = CASE WHEN r.refer_to_id = 'R' THEN RdicT.refcode ELSE NULL END \"\nSQL = SQL &amp; \"Left Join provcode_t PdicF ON r.refer_from  = CASE WHEN r.refer_from_id = 'P' THEN PdicF.provcode ELSE NULL END Left Join provcode_t PdicT ON r.refer_to = CASE WHEN r.refer_to_id = 'P' THEN PdicT.provcode ELSE NULL END ) SELECT chgslipno , a.acctno, patfname, patlname, appt_date, a.enccode, pr.provname \"\nSQL = SQL &amp; \",a.provcode, rfc.refname, a.refcode, r1.refer_from as r1_ref_from, r1.refer_from_id as r1_ref_from_id, r1.refer_from_name as r1_ref_from_name, a.referral1 as r1_refnum, r2.refer_from as r2_ref_from, r2.refer_from_id as r2_ref_from_id, r2.refer_from_name as r2_ref_from_name,a.referral2, prgrc.provgrpdesc,s.specdesc, a.prov_dept, pos.posdesc,pr.cred \"\nSQL = SQL &amp; \"FROM apptmt_t a Left JOIN patdemo_t p ON a.acctno = p.acctno LEFT JOIN provcode_t pr ON pr.provcode = a.provcode LEFT JOIN refcode_t rfc ON a.refcode = rfc.refcode LEFT JOIN (SELECT*FROM cte_REFERRALS_REPORTS) r1 ON a.referral1 = r1.referralnum LEFT JOIN (SELECT*FROM cte_REFERRALS_REPORTS) r2 \"\nSQL = SQL &amp; \"on a.referral2 = r2.referralnum LEFT JOIN provgrpprov_t prgrpr on a.provcode = prgrpr.provcode LEFT JOIN provgrpcode_t prgrc on prgrpr.provgrpcode = prgrc.provgrpcode LEFT JOIN specialty_t s on pr.speccode = s.speccode LEFT JOIN poscode_t pos on a.poscode = pos.poscode \"\nSQL = SQL &amp; \"WHERE UPPER(a.enccode) in ('CON','APE','COB','CONZ','HAC','HFUI','MMN','NCG','NCHF','NCPF','NHFU','NMC','NOB','NP','NP15','NPE','NPI','NPOV','NPS','NPSV','NPV','OVN','IMC','NP30') AND UPPER(a.appt_status)='ARR' AND appt_date &gt;= '2017-01-01' \"\nSQL = SQL &amp; \"ORDER BY a.acctno\"\n\nSet Sheet = objWorkbook.ActiveSheet\nSheet.Activate\n\nRS.Open SQL, Conn\n Sheet.Range(\"A2\").CopyFromRecordset RS\n\nRS.Close\nConn.Close\n\nobjExcel.DisplayAlerts = False\n'Release memory\n'Set objFSO = Nothing\n'Set objFolder = Nothing\n'Set objFile = Nothing\nobjWorkbook.Save\nobjExcel.DisplayAlerts = True\nobjWorkbook.Close\nobjExcel.Workbooks.Close\nobjExcel.Quit\n\n'Set objExcel = Nothing\nMsgBox (\"Saved\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1806, "user_id": 8754516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7be49dad417bd035463828d197cfb7c?s=128&d=identicon&r=PG&f=1", "display_name": "natn2323", "link": "https://stackoverflow.com/users/8754516/natn2323"}, "edited": false, "score": 3, "creation_date": 1556719149, "post_id": 55937294, "comment_id": 98527545, "body": "Welcome to SO. What have you tried so far?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1556725407, "post_id": 55937294, "comment_id": 98530711, "body": "Sounds doable - loop through each sheet, find formulas using <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.specialcells\" rel=\"nofollow noreferrer\"><code>SpecialCells</code></a> and then check if the formula begins with <code>=cc.f</code>..."}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 11278270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7b80e13f312a241547e42d27b0b8ed?s=128&d=identicon&r=PG&f=1", "display_name": "CreeXLR", "link": "https://stackoverflow.com/users/11278270/creexlr"}, "is_accepted": false, "score": 0, "last_activity_date": 1556725484, "creation_date": 1556725484, "answer_id": 55938888, "question_id": 55937294, "link": "https://stackoverflow.com/questions/55937294/count-number-of-specific-formula-in-workbook/55938888#55938888", "title": "Count number of specific formula in workbook", "body": "<p>You can use the worksheet CountIF formulas as a function in VBA</p>\n\n<pre><code>Range(\"Output Cell\").Value = Application.WorksheetFunction.COUNTIF(Range(\"Your Range\"),\"*=cc.f*\")\n\n</code></pre>\n\n<p>Off my phone at the moment so can't test if that works proper, but after you fiddle with it a bit it should do the trick. I suggest looking up some CountIF VBA questions here on SO, a lot of people have posted many creative approaches to this one</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11437245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4e76c370ff171151b3d09c82fe10d?s=128&d=identicon&r=PG&f=1", "display_name": "user11437245", "link": "https://stackoverflow.com/users/11437245/user11437245"}, "is_accepted": false, "score": 1, "last_activity_date": 1556740828, "creation_date": 1556740828, "answer_id": 55942007, "question_id": 55937294, "link": "https://stackoverflow.com/questions/55937294/count-number-of-specific-formula-in-workbook/55942007#55942007", "title": "Count number of specific formula in workbook", "body": "<p>thanks for showing direction: i have now with some workaround first find the formula's with cc.f than replace it by \"XYZ\" and than count. This can be faster but i do not know how. Further to my code is that the counting does only one sheet and not all sheets.</p>\n\n<pre><code>Sub Countccf()\n\nDim oCell As Range\nDim oSh As Worksheet\nDim iVal As Integer\n\nOn Error Resume Next\nFor Each oSh In Worksheets\nFor Each oCell In oSh.UsedRange.SpecialCells(xlCellTypeFormulas)\nIf InStr(oCell.Formula, \"cc.f\") &gt; 0 Then\noCell.Replace what:=\"*cc.f*\", Replacement:=\"XYZ\"\n\nEnd If\nNext\nNext\n\niVal = Application.WorksheetFunction.CountIf(Range(\"A1:ZZ65012\"), \"XYZ\")\nMsgBox iVal\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11437245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4e76c370ff171151b3d09c82fe10d?s=128&d=identicon&r=PG&f=1", "display_name": "user11437245", "link": "https://stackoverflow.com/users/11437245/user11437245"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "closed_date": 1556755082, "answer_count": 2, "score": 0, "last_activity_date": 1557139269, "creation_date": 1556718522, "last_edit_date": 1557139269, "question_id": 55937294, "link": "https://stackoverflow.com/questions/55937294/count-number-of-specific-formula-in-workbook", "closed_reason": "Needs more focus", "title": "Count number of specific formula in workbook", "body": "<p>I am new to VBA.\nI have excel-file with approx 20 sheets. In these sheets there are formula's starting with \" =cc.f \" (ibm cognos). \nI would like to count (using vba) these formula's in the whole workbook and have the total number of formula's returned to me.</p>\n\n<p>thanks!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "is_accepted": true, "score": 0, "last_activity_date": 1556732365, "last_edit_date": 1556732365, "creation_date": 1556731853, "answer_id": 55940176, "question_id": 55936839, "link": "https://stackoverflow.com/questions/55936839/if-any-of-this-50-cells-specific-cell-then-input-the-column-header-from-that/55940176#55940176", "title": "If any of this 50 cells = specific cell, then input the column header from that line in my result column", "body": "<p>Having a bit of a hard time understanding exactly what the problem is, but this may help. Also please remember to accept as answer or +1 !!!</p>\n\n<p><strong>Formulas:</strong></p>\n\n<pre><code>{=IF(SUM(C3:E3)/SUM(COUNTA(C3:E3)*1)=B3,INDEX(C2:E2,MATCH(FALSE,ISBLANK(C3:E3),0)),\"NONE\")}\n\n{=IF(SUM(C4:E4)/SUM(COUNTA(C4:E4)*1)=B4,INDEX(C3:E3,MATCH(FALSE,ISBLANK(C4:E4),0)),\"NONE\")}\n</code></pre>\n\n<p><strong>Demo:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/RW4pd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RW4pd.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 44, "user_id": 5336592, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nrQ_hSYG0zU/AAAAAAAAAAI/AAAAAAAACwI/IOblD7clS6Q/photo.jpg?sz=128", "display_name": "Michael Rygaard", "link": "https://stackoverflow.com/users/5336592/michael-rygaard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 55940176, "answer_count": 1, "score": 0, "last_activity_date": 1556779369, "creation_date": 1556716417, "last_edit_date": 1556779369, "question_id": 55936839, "link": "https://stackoverflow.com/questions/55936839/if-any-of-this-50-cells-specific-cell-then-input-the-column-header-from-that", "title": "If any of this 50 cells = specific cell, then input the column header from that line in my result column", "body": "<p>Each line is a sample\nin column K i have the sub-samples  carried out on that sample\nin column L to BP I have the different possible results.</p>\n\n<p>90 % of the time all the sub-samples are the same result, so i would like that result to show in column BQ, if there are only one result.</p>\n\n<p>The way to determin if there is only one result is easy, if the number in column one of the columns L to BP is = column P then all of the sub-samples are in this column and the result in BQ is = the header i have in line 5</p>\n\n<p>I could do this with alot of IF statements like thisin each cell in column BQ :</p>\n\n<p><code>=if.error(IF(K7*1&lt;1;\"\";IF(K7=M7;$M$6;HVIS(N7=K7;$N$6;IF(K7=V7;$V$6;IF(K7=X7;$X$6;IF(K7=L7;L6;IF(K7=W7;$W$6;\"\")))))));\"\")</code></p>\n\n<p>This is the if statement for 6 columns but there are 33, and perhaps more vile come in the future</p>\n\n<p>So i hope there is a better way.</p>\n\n<p>How it looks:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ToBfh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ToBfh.png\" alt=\"how it looks\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2123, "user_id": 220425, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZjmDV.jpg?s=128&g=1", "display_name": "Maris B.", "link": "https://stackoverflow.com/users/220425/maris-b"}, "edited": false, "score": 0, "creation_date": 1556716511, "post_id": 55936729, "comment_id": 98526318, "body": "My advise is to split your coding questions into smaller ones. This way you have better chance that someone will answer your questions. And don&#39;t expect that you will get working code if you write long specification in the question. Good luck in your learning to code :)"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 2123, "user_id": 220425, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZjmDV.jpg?s=128&g=1", "display_name": "Maris B.", "link": "https://stackoverflow.com/users/220425/maris-b"}, "edited": false, "score": 0, "creation_date": 1556717006, "post_id": 55936729, "comment_id": 98526553, "body": "Sounds like you&#39;ve got a good project for yourself and with the description of what you want, you&#39;ve also set up a specification for the features you need. As @MarisB. suggests, take things one step at a time. <a href=\"https://stackoverflow.com/a/9813626/4717755\">Here&#39;s a link</a> that will show you how to create a hyperlink from the person&#39;s name to the new sheet that was created. Just add bits of code one small feature at a time and test it to make sure it works before tackling the next part. You&#39;ll get there!"}], "owner": {"reputation": 1, "user_id": 11436996, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-F7CJzBvQ7TU/AAAAAAAAAAI/AAAAAAAAAuQ/YvX1jfiNnZQ/photo.jpg?sz=128", "display_name": "Rick Mcilroy", "link": "https://stackoverflow.com/users/11436996/rick-mcilroy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556715853, "creation_date": 1556715853, "question_id": 55936729, "link": "https://stackoverflow.com/questions/55936729/sequential-cell-hyperlinks-to-created-sheets", "title": "Sequential cell hyperlinks to created sheets", "body": "<p>I'm in the process of creating a workbook that tracks temporary personnel coming into the shop and their progress through a training program.</p>\n\n<p>I have two pages, a main sheet which lists the temporary personnel under the following headings:  Name, Start Date and End Date.  There is also a button to create new sheets.  The second sheet is a template used for formatting new sheets.</p>\n\n<p>What works currently is:</p>\n\n<p>Add New Sheet button - creates a new sheet, prompts the user to name the sheet and formats the new sheet using the template.</p>\n\n<p>What I would like to add:</p>\n\n<p>After the user enters the temp person's information, they click the add new sheet button.  In addition to the functions already working I would like the button to hyperlink the \"Name\" cell that the user just entered information into so that cell will take the user to the training tracker sheet for that person.</p>\n\n<p>Also, I would like the button to take the information (Name, Start Date and End Date) for that person and copy to the new sheet.</p>\n\n<p>I don't have much of a background in coding, I've managed to take some example code and make minor changes to get what's working now.  I don't know if what I'm asking is possible or not.  The main thing is to ensure that each time the user enters a new person's information and clicks the add new sheet button the information for the correct person gets copied to the new sheet and the hyperlink will take the user to the correct person's training tracker.</p>\n\n<p>Thanks for any help, it's appreciated.</p>\n\n<p>The following is the code for what I have working so far.</p>\n\n<pre><code>Private Sub AddSheet_Click()\nDim DefaultSheetName As String\n\n\nWorksheets(\"Template\").Copy Before:=Worksheets(\"Template\")\n\nDefaultSheetName = ActiveSheet.Name\nApplication.Dialogs(xlDialogWorkbookName).Show\n\nIf ActiveSheet.Name = DefaultSheetName Then\n    MsgBox \"You didn't name the new sheet.\" &amp; vbCrLf &amp; _\n           \"Processing cancelled\", vbExclamation\n    Application.DisplayAlerts = False\n    ActiveSheet.Delete\n    Application.DisplayAlerts = True\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1556713944, "post_id": 55936274, "comment_id": 98525180, "body": "What is the value of the <code>dateOfBirth</code> variable when you break the code at this line? What is the &quot;result&quot; that is &quot;always the same&quot;? An error? Unexpected answer? Something else?"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1556714160, "post_id": 55936274, "comment_id": 98525293, "body": "Did you set <code>source</code> and <code>list</code> correcly?"}, {"owner": {"reputation": 3, "user_id": 11436928, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JMPqDIMh56I/AAAAAAAAAAI/AAAAAAAAAIk/gsO3UK0kOB0/photo.jpg?sz=128", "display_name": "NaXXik", "link": "https://stackoverflow.com/users/11436928/naxxik"}, "edited": false, "score": 0, "creation_date": 1556714395, "post_id": 55936274, "comment_id": 98525393, "body": "Value of the dateOfBirth is 6.7.2011. The resul is that I always get run-time error. And yes source and list are set corretly, it works in other parts of the code."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1556714763, "post_id": 55936274, "comment_id": 98525551, "body": "I changed the semi-colons to commas and the formula worked"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1556714850, "post_id": 55936274, "comment_id": 98525594, "body": "Is <code>nextRow</code> defined, and assigned a value? Also, which run-time error do you get?"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1556714975, "post_id": 55936274, "comment_id": 98525655, "body": "Please Debug your code (via Stepping <code>F8</code> key) and return to us with which line was highlighted and the exact error. My money would be on the <code>list.Range</code> line"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1556715046, "post_id": 55936274, "comment_id": 98525696, "body": "Additionally, your code is incomplete (eg. <code>nextRow</code> is lacking definition). We can&#39;t correct your code, if we don&#39;t know what it looks like!"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1556715284, "post_id": 55936274, "comment_id": 98525794, "body": "Not sure if this would throw a <code>1004</code>, but you&#39;re using <code>FormulaLocal</code>. If your Excel version is using any language other than English, this will throw an error"}, {"owner": {"reputation": 3, "user_id": 11436928, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JMPqDIMh56I/AAAAAAAAAAI/AAAAAAAAAIk/gsO3UK0kOB0/photo.jpg?sz=128", "display_name": "NaXXik", "link": "https://stackoverflow.com/users/11436928/naxxik"}, "edited": false, "score": 0, "creation_date": 1556715443, "post_id": 55936274, "comment_id": 98525857, "body": "I tried changing semicolons to commas and still error. NextRow has value assigned. I get run-time error 1004. Application-defined or object-defined error. Problem is with list.Range line. Everything else works as it should."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 1, "creation_date": 1556715623, "post_id": 55936274, "comment_id": 98525950, "body": "We <b><i>need</i></b> to see the full code. Your formula appears fine. Perhaps <code>nextrow</code> is populated with a value &lt;1 or &gt;1,048,576. Can only guess with this partial code"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1556715705, "post_id": 55936274, "comment_id": 98525992, "body": "Or at least go through the code using <code>F8</code> and tell us the values of <code>source</code>, <code>list</code>, <code>nextRow</code> and <code>dateOfBirth</code> and how you dim&#39;d these variables."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1556718277, "post_id": 55936274, "comment_id": 98527096, "body": "<code>6.7.2011</code> Is probably a text string and not a date."}, {"owner": {"reputation": 3, "user_id": 11436928, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JMPqDIMh56I/AAAAAAAAAAI/AAAAAAAAAIk/gsO3UK0kOB0/photo.jpg?sz=128", "display_name": "NaXXik", "link": "https://stackoverflow.com/users/11436928/naxxik"}, "edited": false, "score": 0, "creation_date": 1556718696, "post_id": 55936274, "comment_id": 98527307, "body": "No, its a date."}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 0, "last_activity_date": 1556720361, "creation_date": 1556720361, "answer_id": 55937720, "question_id": 55936274, "link": "https://stackoverflow.com/questions/55936274/excel-vba-insert-formula-with-a-variable-into-a-cell/55937720#55937720", "title": "Excel VBA insert formula with a variable into a cell", "body": "<p>Let's say the date of birth is 6.7.2011.</p>\n\n<p>That means, using your formula:</p>\n\n<p><code>.Formula = \"=ROUNDDOWN(YEARFRAC(\" &amp; dateOfBirth &amp; \",TODAY(),1),0)\"</code></p>\n\n<p>it will create the formula:</p>\n\n<p><code>=ROUNDDOWN(YEARFRAC(6.7.2011,TODAY(),1),0)</code></p>\n\n<p>Can you see the issue now?</p>\n\n<p>Try using:</p>\n\n<p><code>.Formula = \"=ROUNDDOWN(YEARFRAC(\" &amp; dateOfBirth * 1 &amp; \",TODAY(),1),0)\"</code></p>\n\n<p>This will create the formula:</p>\n\n<p><code>=ROUNDDOWN(YEARFRAC(40730,TODAY(),1),0)</code></p>\n\n<p>..which while looking a little strange, should give you the right answer and not error.</p>\n"}], "owner": {"reputation": 3, "user_id": 11436928, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JMPqDIMh56I/AAAAAAAAAAI/AAAAAAAAAIk/gsO3UK0kOB0/photo.jpg?sz=128", "display_name": "NaXXik", "link": "https://stackoverflow.com/users/11436928/naxxik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 55937720, "answer_count": 1, "score": -1, "last_activity_date": 1556720361, "creation_date": 1556713625, "last_edit_date": 1556717220, "question_id": 55936274, "link": "https://stackoverflow.com/questions/55936274/excel-vba-insert-formula-with-a-variable-into-a-cell", "title": "Excel VBA insert formula with a variable into a cell", "body": "<p>I need to insert a formula using VBA into a cell but I always get a run-time error 1004. Code looks like this:</p>\n\n<pre><code>Sub save_data()\n\nDim source As Worksheet\nDim list As Worksheet\nDim nextRow As Integer\nDim nextId As Integer\nDim startDate As Date, endDate As Date, randDatum As Date, dateOfBirth As Date\n\nstartDate = \"17/6/2018\"\nrandDate = WorksheetFunction.RandBetween(startDate, Date)\n\nSet source = Worksheets(\"Add user\")\nSet list = Worksheets(\"Users\")\n\nnextRow = list.Range(\"A\" &amp; list.Rows.Count).End(xlUp).Offset(1).Row\nnextId = list.Range(\"A\" &amp; list.Rows.Count).End(xlUp).Value + 1\ndateOfBirth = source.Range(\"F24\").Value\n\nlist.Cells(nextRow, 1).Value = nextId\nlist.Cells(nextRow, 2).Value = source.Range(\"F4\").Value\nlist.Cells(nextRow, 3).Value = source.Range(\"F6\").Value\nlist.Cells(nextRow, 4).Value = source.Range(\"F8\").Value\nlist.Cells(nextRow, 5).Value = source.Range(\"F10\").Value\nlist.Cells(nextRow, 6).Value = source.Range(\"F12\").Value\nlist.Cells(nextRow, 7).Value = source.Range(\"F14\").Value\nlist.Cells(nextRow, 8).Value = source.Range(\"F16\").Value\nlist.Cells(nextRow, 9).Value = source.Range(\"F18\").Value\nlist.Cells(nextRow, 10).Value = source.Range(\"F20\").Value\nlist.Cells(nextRow, 11).Value = source.Range(\"F22\").Value\nlist.Cells(nextRow, 12).Value = source.Range(\"F24\").Value\nlist.Range(\"M\" &amp; nextRow).Formula = \"=ROUNDDOWN(YEARFRAC(\" &amp; dateOfBirth &amp; \",TODAY(),1),0)\"\nlist.Cells(nextRow, 14).Value = Date\nlist.Cells(nextRow, 15).Value = randDate\nlist.Cells(nextRow, 16).Value = Date - randDate\nlist.Cells(nextRow, 16).Value = \"=TODAY()\"\n\nEnd Sub\n</code></pre>\n\n<p>I have tried Formula and FormulaLocal but result is always the same.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1556713734, "post_id": 55936130, "comment_id": 98525080, "body": "I&#39;m a bit confused. After closing <code>ThisWorkbook</code>, you want to leave Excel open if <code>Excel.Workbooks.Count &gt; 0</code>, but you want to close the application if <code>Excel.Workbooks.Count = 0</code>?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1556714061, "post_id": 55936130, "comment_id": 98525243, "body": "@FreeMan I&#39;m reading it that way as well. Seems like a <code>If Application.Workbooks.Count = 0 Then Application.Quit</code> might be the right way to go here?"}, {"owner": {"reputation": 472, "user_id": 4105679, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b378f63f5898183a8cdbb1f8e17a1b95?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4105679/luke"}, "edited": false, "score": 0, "creation_date": 1556714694, "post_id": 55936130, "comment_id": 98525516, "body": "That works but I had to change it to <code>If Application.Workbooks.Count = 1 Then Application.Quit</code>"}], "answers": [{"comments": [{"owner": {"reputation": 472, "user_id": 4105679, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b378f63f5898183a8cdbb1f8e17a1b95?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4105679/luke"}, "edited": false, "score": 0, "creation_date": 1556720149, "post_id": 55937103, "comment_id": 98528000, "body": "This is what i wanted but i had to change it from <code>0</code> to <code>1</code> - <code>If Excel.Application.Workbooks.Count = 1 Then</code>"}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 0, "last_activity_date": 1556717640, "creation_date": 1556717640, "answer_id": 55937103, "question_id": 55936130, "link": "https://stackoverflow.com/questions/55936130/save-as-xlsx-then-close-with-out-closing-all-workbooks/55937103#55937103", "title": "Save as xlsx then close with out closing all workbooks", "body": "<p>In order to <em>close</em> Excel if your code is closing the last open workbook, but leave it open if there are other workbooks open, you'll need to check the <code>Application.Workbook.Count</code> property, like this:</p>\n\n<pre><code>Sub SaveAsXlsx()\n\n  Dim varResponse As Variant\n  varResponse = MsgBox(\"Save As xlsx Removing Macros &amp; Then Closes The Workbook\", vbYesNo, \"Save As xlsx\")\n  If varResponse &lt;&gt; vbYes Then Exit Sub\n\n  Application.DisplayAlerts = False\n  Dim FilePath As String\n  FilePath = ThisWorkbook.FullName\n  FilePath = Left(FilePath, Len(FilePath) - 5) &amp; \" To Review\" &amp; \".xlsx\"\n\n  ThisWorkbook.SaveAs Filename:=FilePath, FileFormat:= _\n                      xlOpenXMLWorkbook, CreateBackup:=False\n\n'Enter Anything to Happen on xlsx Book Here\n  Range(\"A1\").Select\n\n\n  ThisWorkbook.Save\n\n  FilePath = Application.ActiveWorkbook.FullName\n  MsgBox \"Saved Review Copy As\" &amp; Chr(10) &amp; Chr(10) &amp; FilePath, , \"Saved!\"\n\n  ThisWorkbook.Close\n\n  If Excel.Application.Workbooks.Count = 0 Then\n    Application.Quit\n  End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 472, "user_id": 4105679, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b378f63f5898183a8cdbb1f8e17a1b95?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4105679/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 55937103, "answer_count": 1, "score": 0, "last_activity_date": 1556717640, "creation_date": 1556712969, "last_edit_date": 1556713313, "question_id": 55936130, "link": "https://stackoverflow.com/questions/55936130/save-as-xlsx-then-close-with-out-closing-all-workbooks", "title": "Save as xlsx then close with out closing all workbooks", "body": "<p>I want to save the active workbook as xlsx and then close it without closing all the open excel workbooks. This code works but closes all the open excel files. </p>\n\n<p>If I remove <code>Application.Quit</code> and leave <code>ThisWorkbook.Close</code> it will work only if I have more then one workbook open but if I only have the one workbook open it will close but leave a blank excel window open.</p>\n\n<pre><code>Sub SaveAsXlsx()\n\nDim varResponse As Variant\nvarResponse = MsgBox(\"Save As xlsx Removing Macros &amp; Then Closes The Workbook\", vbYesNo, \"Save As xlsx\")\nIf varResponse &lt;&gt; vbYes Then Exit Sub\n\nApplication.DisplayAlerts = False\nDim FilePath As String\nFilePath = ThisWorkbook.FullName\nFilePath = Left(FilePath, Len(FilePath) - 5) &amp; \" To Review\" &amp; \".xlsx\"\n\nThisWorkbook.SaveAs Filename:=FilePath, FileFormat:= _\n    xlOpenXMLWorkbook, CreateBackup:=False\n\n'Enter Anything to Happen on xlsx Book Here\nRange(\"A1\").Select\n\n\nThisWorkbook.Save\n\nFilePath = Application.ActiveWorkbook.FullName\nMsgBox \"Saved Review Copy As\" &amp; Chr(10) &amp; Chr(10) &amp; FilePath, , \"Saved!\"\n\nApplication.Quit\nThisWorkbook.Close\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1556711712, "post_id": 55935799, "comment_id": 98524234, "body": "And what should be the <code>return</code> ? Because of now you would just loop through dates without doing anything. When should the loop stop?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1556712168, "post_id": 55935799, "comment_id": 98524424, "body": "You have <code>**If** i = 1 To 10</code>.  Change it to <code>**For** i = 1 To 10</code>"}, {"owner": {"reputation": 175, "user_id": 10416032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dbfc52b019473bcf01a9b9c70889a61?s=128&d=identicon&r=PG&f=1", "display_name": "nicshah", "link": "https://stackoverflow.com/users/10416032/nicshah"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1556712912, "post_id": 55935799, "comment_id": 98524724, "body": "@RonRosenfeld thanks - of course it should be FOR!  Thank you for your help.  I&#39;ve been staring at this for way too long."}], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 2993190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IGBU.jpg?s=128&g=1", "display_name": "DaveMac", "link": "https://stackoverflow.com/users/2993190/davemac"}, "is_accepted": false, "score": -1, "last_activity_date": 1556711718, "creation_date": 1556711718, "answer_id": 55935865, "question_id": 55935799, "link": "https://stackoverflow.com/questions/55935799/i-would-like-to-set-my-date-from-a-range-of-dates-and-then-loop-through-the-lis/55935865#55935865", "title": "I would like to set my date from a range of dates, and then loop through the list of dates?", "body": "<p>Try using the For Each</p>\n\n<p>e.g.</p>\n\n<pre><code>Each c in DateRng\ndebug.print c.value\nnext\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 10416032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dbfc52b019473bcf01a9b9c70889a61?s=128&d=identicon&r=PG&f=1", "display_name": "nicshah", "link": "https://stackoverflow.com/users/10416032/nicshah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1556711718, "creation_date": 1556711374, "question_id": 55935799, "link": "https://stackoverflow.com/questions/55935799/i-would-like-to-set-my-date-from-a-range-of-dates-and-then-loop-through-the-lis", "title": "I would like to set my date from a range of dates, and then loop through the list of dates?", "body": "<p>I would like to set the sDate variable in my code to come from a list of date in a range.  </p>\n\n<p>My code works for one date, but for the life of me I can't remember how to loop through a list of dates.</p>\n\n<p>When I have one in the cell called \"BusinessDate\", it works...</p>\n\n<pre><code>Public Function sGetDate () as Date\nDim DateRng as Range\nDim sDate as Date\nSet DateRng = Sheets(\"Control\").Range(\"BusinessDate\")\n</code></pre>\n\n<p>I thought I could do something like this for a loop of 10 dates from a list:</p>\n\n<pre><code>Public Function sGetDate () as Date\nDim DateRng as Range\nDim sDate as Date\nSet DateRng = Sheets(\"Control\").Range(\"BusinessDateList\")\n\nIf i = 1 To 10\nsDate = BusinessDateList(i)\nNext i\nEnd If\n\nOnce the date is set from the list, it can loop through the existing code.\n\nThis doesn't seem to work at setting the date, but I it's been so long since I have looked at any vba I can't think of where to start.  Any help would be great.\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11422101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39766e44e122a26b7a799e2761573586?s=128&d=identicon&r=PG&f=1", "display_name": "dystopia94", "link": "https://stackoverflow.com/users/11422101/dystopia94"}, "edited": false, "score": 0, "creation_date": 1556711397, "post_id": 55935700, "comment_id": 98524093, "body": "i tried placing DisplayCurrentTime() as public in module1 but im having runtime error 424 object required."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 5, "user_id": 11422101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39766e44e122a26b7a799e2761573586?s=128&d=identicon&r=PG&f=1", "display_name": "dystopia94", "link": "https://stackoverflow.com/users/11422101/dystopia94"}, "edited": false, "score": 0, "creation_date": 1556711549, "post_id": 55935700, "comment_id": 98524169, "body": "Why would you want to do that? Unless you&#39;re using <code>DIsplayCurrentTime</code> outside of the UserForm, placing that Sub inside the UserForm&#39;s module is perfectly fine."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 5, "user_id": 11422101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39766e44e122a26b7a799e2761573586?s=128&d=identicon&r=PG&f=1", "display_name": "dystopia94", "link": "https://stackoverflow.com/users/11422101/dystopia94"}, "edited": false, "score": 0, "creation_date": 1556712281, "post_id": 55935700, "comment_id": 98524471, "body": "@dystopia94 I have added an alternative which you can use if you want ``DisplayCurrentTime` to be in another module than the UF&#39;s"}, {"owner": {"reputation": 5, "user_id": 11422101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39766e44e122a26b7a799e2761573586?s=128&d=identicon&r=PG&f=1", "display_name": "dystopia94", "link": "https://stackoverflow.com/users/11422101/dystopia94"}, "edited": false, "score": 0, "creation_date": 1556715760, "post_id": 55935700, "comment_id": 98526021, "body": "Thank you @TimStack. The last code was not having an error and displays the time but it is not updating the time automatically."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 5, "user_id": 11422101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39766e44e122a26b7a799e2761573586?s=128&d=identicon&r=PG&f=1", "display_name": "dystopia94", "link": "https://stackoverflow.com/users/11422101/dystopia94"}, "edited": false, "score": 0, "creation_date": 1556716725, "post_id": 55935700, "comment_id": 98526434, "body": "@dystopia94 set <code>LatestTime</code> to <code>nextSecond + 1</code>, and specify the module for the procedure. I have edited the code"}, {"owner": {"reputation": 5, "user_id": 11422101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39766e44e122a26b7a799e2761573586?s=128&d=identicon&r=PG&f=1", "display_name": "dystopia94", "link": "https://stackoverflow.com/users/11422101/dystopia94"}, "edited": false, "score": 0, "creation_date": 1556718438, "post_id": 55935700, "comment_id": 98527173, "body": "Stil not updating. But i found this video <a href=\"https://www.youtube.com/watch?v=H5649YiZjZM&amp;t=14s\" rel=\"nofollow noreferrer\">youtube.com/watch?v=H5649YiZjZM&amp;t=14s</a> wich is how I want the clock to work but without the use of a start button,"}, {"owner": {"reputation": 5, "user_id": 11422101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39766e44e122a26b7a799e2761573586?s=128&d=identicon&r=PG&f=1", "display_name": "dystopia94", "link": "https://stackoverflow.com/users/11422101/dystopia94"}, "edited": false, "score": 0, "creation_date": 1556718948, "post_id": 55935700, "comment_id": 98527439, "body": "Thanks for the patience and help. I Found a working code here:               Private Sub UserForm_Activate() Do     DoEvents     Label8.Caption = Time     Loop End Sub"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 5, "user_id": 11422101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39766e44e122a26b7a799e2761573586?s=128&d=identicon&r=PG&f=1", "display_name": "dystopia94", "link": "https://stackoverflow.com/users/11422101/dystopia94"}, "edited": false, "score": 0, "creation_date": 1556719111, "post_id": 55935700, "comment_id": 98527519, "body": "Not an ideal code, but good to see you got it working. My code not working is due to the arguments specified for the Sub. I still advise you to place the Sub in the Userform module, that would work flawlessly."}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": true, "score": 0, "last_activity_date": 1556719128, "last_edit_date": 1556719128, "creation_date": 1556710876, "answer_id": 55935700, "question_id": 55935654, "link": "https://stackoverflow.com/questions/55935654/call-displaycurrenttime-enlightenment/55935700#55935700", "title": "Call DisplayCurrentTime Enlightenment", "body": "<p>Place <code>DisplayCurrentTime</code> inside the UserForm module. Then you can call the sub as follows</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Book2.UserForm1.DisplayCurrentTime\nEnd Sub \n\nPrivate Sub DisplayCurrentTime()\n    Dim nextSecond As Date\n\n    nextSecond = DateAdd(\"s\", 1, Now())\n\n    Label8.Caption = Time()\n\n    Application.OnTime _\n      Procedure:=\"UserForm1.DisplayCurrentTime\", _\n      EarliestTime:=nextSecond, _\n      LatestTime:=nextSecond + 1\nEnd Sub\n</code></pre>\n\n<p>Alternatively, you could place <code>DisplayCurrentTime</code> in another module. However, you are populating controls in the UF so you will have to specify the UF. The procedure below is fit to work for any UserForm.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    DisplayCurrentTime Me, \"Label8\"\nEnd Sub \n</code></pre>\n\n<p>Sub below in another module</p>\n\n<pre><code>Sub DisplayCurrentTime(UF As UserForm, Cntrl_Name As String)\n    Dim nextSecond As Date\n\n    nextSecond = DateAdd(\"s\", 1, Now())\n\n    UF.Controls.Item(Cntrl_Name).Caption = Time()\n\n    'If the control you want to paste the date to is Label8 for every UF, use the commented out code instead..\n    '..and remove \", Cntrl_Name As String\" from this sub, and...\n    '..remove the specified control in the UserForm_Initialize sub\n\n    'UF.Controls.Item(\"Label8\").Caption = Time()\n\n     'Module1 is true in my case, edit to suit your project\n     Application.OnTime _\n      Procedure:=\"Module1.DisplayCurrentTime\", _\n      EarliestTime:=nextSecond, _\n      LatestTime:=nextSecond + 1\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": false, "score": 0, "last_activity_date": 1556711090, "creation_date": 1556711090, "answer_id": 55935747, "question_id": 55935654, "link": "https://stackoverflow.com/questions/55935654/call-displaycurrenttime-enlightenment/55935747#55935747", "title": "Call DisplayCurrentTime Enlightenment", "body": "<p>Change the <code>DisplayCurrentTime()</code> procedure as <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/public-statement\" rel=\"nofollow noreferrer\"><strong><code>Public</code></strong></a></p>\n\n<pre><code>Public Sub DisplayCurrentTime()\n  'your code here...\nEnd Sub\n</code></pre>\n\n<p>This sets the \"module level\" as externally accessible.</p>\n\n<blockquote>\n  <p>Note, <code>Public</code> <code>Property</code> and <code>Sub/Function</code>  will be accessible to all outside in all modules and all applications unless <code>Option Private Module</code> is in effect</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 5, "user_id": 11422101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39766e44e122a26b7a799e2761573586?s=128&d=identicon&r=PG&f=1", "display_name": "dystopia94", "link": "https://stackoverflow.com/users/11422101/dystopia94"}, "is_accepted": false, "score": 0, "last_activity_date": 1556719190, "creation_date": 1556719190, "answer_id": 55937463, "question_id": 55935654, "link": "https://stackoverflow.com/questions/55935654/call-displaycurrenttime-enlightenment/55937463#55937463", "title": "Call DisplayCurrentTime Enlightenment", "body": "<p>Found this code here: <a href=\"https://www.youtube.com/watch?v=H5649YiZjZM\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=H5649YiZjZM</a></p>\n\n<pre><code>Private Sub UserForm_Activate()\nDo\n    DoEvents\n    Label8.Caption = Time\n    Loop\nEnd Sub\n</code></pre>\n\n<p>This code works and does what I want. Thanks for all the help everyone @Tim Stacks and @Rawrplus!</p>\n"}], "owner": {"reputation": 5, "user_id": 11422101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39766e44e122a26b7a799e2761573586?s=128&d=identicon&r=PG&f=1", "display_name": "dystopia94", "link": "https://stackoverflow.com/users/11422101/dystopia94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 55935700, "answer_count": 3, "score": 0, "last_activity_date": 1556779362, "creation_date": 1556710675, "last_edit_date": 1556779362, "question_id": 55935654, "link": "https://stackoverflow.com/questions/55935654/call-displaycurrenttime-enlightenment", "title": "Call DisplayCurrentTime Enlightenment", "body": "<p>I want to display an active time in label8 specifically, but I'm having problems in calling the <code>DisplayCurrentTime()</code> in the userform initialize.</p>\n\n<p><em>I am new to learning <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged &#39;vba&#39;\" rel=\"tag\">vba</a> and I am browsing Stackoverflow for answers</em></p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    Book2.UserForm1.DisplayCurrentTime\nEnd Sub \n</code></pre>\n\n<p>i have these to try to call it</p>\n\n<pre><code>Sub DisplayCurrentTime()\n    Dim nextSecond As Date\n\n  nextSecond = DateAdd(\"s\", 1, Now())\n\n  Label8.Caption = Time()\n\n  Application.OnTime _\n    Procedure:=\"DisplayCurrentTime\", _\n    EarliestTime:=nextSecond, _\n    LatestTime:=nextSecond\nEnd Sub\n</code></pre>\n\n<p>and i have these lines to work in label8</p>\n"}, {"tags": ["excel", "vba", "wildcard"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1556709550, "post_id": 55935378, "comment_id": 98523405, "body": "Try using <code>&quot;?*&quot;</code> as the criterion."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1556710790, "post_id": 55935378, "comment_id": 98523881, "body": "Also is <code>&quot;&quot; text</code> a +1 count?"}, {"owner": {"reputation": 5, "user_id": 11166763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ca3b2848bc182fe649114e96824d74?s=128&d=identicon&r=PG&f=1", "display_name": "Luke Sharkey", "link": "https://stackoverflow.com/users/11166763/luke-sharkey"}, "edited": false, "score": 0, "creation_date": 1556804353, "post_id": 55935378, "comment_id": 98559386, "body": "Using &quot;?*&quot; rather than &quot;&quot;?*&quot;&quot; worked... I thought special characters always had to be prefixed in some way, e.g. the semicolon in:  Range(Var1 &amp; &quot;:&quot; &amp; Var2)."}], "answers": [{"tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": true, "score": 1, "last_activity_date": 1556710747, "creation_date": 1556710747, "answer_id": 55935673, "question_id": 55935378, "link": "https://stackoverflow.com/questions/55935378/using-wildcards-in-excel-vba/55935673#55935673", "title": "Using wildcards in Excel VBA", "body": "<p>Tried and tested:</p>\n\n<pre><code>Public Function not_qt(ByVal rng As Range) As Integer\n\n    Dim cell As Range\n    Dim counter As Integer: counter = 0\n\n    For Each cell In rng\n        If Not IsEmpty(cell) Then\n            If Not cell Like Chr(34) &amp; \"*\" &amp; Chr(34) Then\n                counter = counter + 1\n                'cell.Offset(0, 1) = counter   '&lt;- Only for illustration purposes\n            End If\n        End If\n    Next cell\n\n    not_qt = counter\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/DnJ5L.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DnJ5L.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 5, "user_id": 11166763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8ca3b2848bc182fe649114e96824d74?s=128&d=identicon&r=PG&f=1", "display_name": "Luke Sharkey", "link": "https://stackoverflow.com/users/11166763/luke-sharkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 55935673, "answer_count": 1, "score": 0, "last_activity_date": 1556711844, "creation_date": 1556709365, "last_edit_date": 1556711844, "question_id": 55935378, "link": "https://stackoverflow.com/questions/55935378/using-wildcards-in-excel-vba", "title": "Using wildcards in Excel VBA", "body": "<p>I am trying to use wildcards in a formula to count cells in a table column which contain text and not <code>\"\"</code></p>\n\n<p>I tried the following methods:</p>\n\n<ul>\n<li>String comparison</li>\n</ul>\n\n<pre><code>Dim g As Integer\n\ng = Application.WorksheetFunction.CountIf(ThisWorkbook.Worksheets(\"ws1\").ListObjects(\"Table1\").ListColumns(\"ColumnA\").DataBodyRange, \"\"*?\"\")\n</code></pre>\n\n<ul>\n<li>Using a tilde failed:</li>\n</ul>\n\n<pre><code>Dim g As Integer\n\ng = Application.WorksheetFunction.CountIf(ThisWorkbook.Worksheets(\"ws1\").ListObjects(\"Table1\").ListColumns(\"ColumnA\").DataBodyRange, \"\"~*?\"\")\n</code></pre>\n\n<ul>\n<li>Using ASCII characters below returned 0:</li>\n</ul>\n\n<pre><code>g = Application.WorksheetFunction.CountIf(ThisWorkbook.Worksheets(\"ws1\").ListObjects(\"Table1\").ListColumns(\"Column1\").DataBodyRange, Chr(34) &amp; Chr(63) &amp; Chr(42) &amp; Chr(34))\n</code></pre>\n"}, {"tags": ["vba", "web-scraping"], "comments": [{"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556730990, "post_id": 55935260, "comment_id": 98533078, "body": "it&#39;s a list of 25 countrys ( Argentina, Portugal , England , France, Germany , ... )"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556732882, "post_id": 55935260, "comment_id": 98534000, "body": "You know some good books to help me improving on web-scrapping vba ? I really want to improve and learn more and more, and since i like read books it could help me a lot ."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556733254, "post_id": 55935260, "comment_id": 98534180, "body": "I don&#39;t know about books. Resources: <a href=\"https://www.youtube.com/user/WiseOwlTutorials/search?query=web-scraping\" rel=\"nofollow noreferrer\">youtube.com/user/WiseOwlTutorials/search?query=web-scraping</a> , <a href=\"https://flukeout.github.io/\" rel=\"nofollow noreferrer\">flukeout.github.io</a> , <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors</a> , <a href=\"https://codingislove.com/http-requests-excel-vba/\" rel=\"nofollow noreferrer\">codingislove.com/http-requests-excel-vba</a>"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556737823, "post_id": 55935260, "comment_id": 98536022, "body": "How is the code? :) Still in progress?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556741923, "post_id": 55935260, "comment_id": 98537639, "body": "I had written a full answer which just bloody disappeared with internet drop. One second and will write up and post again!"}], "answers": [{"comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1556793185, "post_id": 55935887, "comment_id": 98553256, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/192714/discussion-on-answer-by-qharr-how-to-solve-error-70-permission-denied\">moved to chat</a>."}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556805941, "post_id": 55935887, "comment_id": 98560348, "body": "Really thank you for your help ! You&#39;re a genious :) the code works really well !"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556807996, "post_id": 55935887, "comment_id": 98561513, "body": "I run the code and didn&#39;t show me error . What bug have?"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556808845, "post_id": 55935887, "comment_id": 98561999, "body": "I will test now the code and then i give you feedback , but you do an amazing job , you improve my code so much ! Really thank you for the help ."}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556808919, "post_id": 55935887, "comment_id": 98562052, "body": "One question, if some day i want to just filter the main leagues of each country i only need switch in the function &quot;GetMatches&quot; right ?"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556809814, "post_id": 55935887, "comment_id": 98562588, "body": "Main leagues is for example England Premier League, France League 1 , Spain La Liga , etc"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556809907, "post_id": 55935887, "comment_id": 98562632, "body": "I run the code and finished now , but didn&#39;t show me one game : <a href=\"https://www.oddsportal.com/soccer/france/ligue-1/nimes-bordeaux-dII5jA9G/\" rel=\"nofollow noreferrer\">oddsportal.com/soccer/france/ligue-1/nimes-bordeaux-dII5jA9G</a> . Really strange"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556811135, "post_id": 55935887, "comment_id": 98563322, "body": "Completely missed"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556811759, "post_id": 55935887, "comment_id": 98563658, "body": "Hmm i actually know what is the problem . For example &quot;Portugal - Campeonato de Portugal&quot; , what happens is : copy first game, then second missed, copy third game, then fourth game missed, etc..."}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556812322, "post_id": 55935887, "comment_id": 98563968, "body": "If the table looks like this : <a href=\"https://prnt.sc/njkeem\" rel=\"nofollow noreferrer\">prnt.sc/njkeem</a> then copy odds alternately, but if the table looks like this: <a href=\"https://prnt.sc/njkevo\" rel=\"nofollow noreferrer\">prnt.sc/njkevo</a> then copy all the odds correctly"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556897246, "post_id": 55935887, "comment_id": 98596520, "body": "Just updated :) My next challenge will be see only certain leagues in that countries :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556897421, "post_id": 55935887, "comment_id": 98596613, "body": "Edit doesn&#39;t look quite right. I can see the addition of another case which will never be reached because it has the same value as the case before."}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556897605, "post_id": 55935887, "comment_id": 98596707, "body": "Sorry , you were right , i forgot to switch to only &quot; deactivate&quot;"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556898161, "post_id": 55935887, "comment_id": 98597029, "body": "Yes now i will try do other code alone for learn more ( using this ) to only check some leagues in that countrys . Again really thank you for your help ! You were really helpfull and kind person !"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556898735, "post_id": 55935887, "comment_id": 98597345, "body": "It shows me another error don&#39;t know why . Should appear &quot;No Odds&quot; in this game   <a href=\"https://www.oddsportal.com/soccer/norway/norway-cup-women/bryne-gimletroll-6DLVH8pe/#over-under;2\" rel=\"nofollow noreferrer\">oddsportal.com/soccer/norway/norway-cup-women/&hellip;</a>  but brower stop in show me error 424 : object required"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556899211, "post_id": 55935887, "comment_id": 98597576, "body": "I think is cause doesn&#39;t appear over 2.5 for this game and in code stops in that part. Maybe cause is looping and doesn&#39;t stop because we can&#39;t find the odds &quot;Do                 Loop Until .document.querySelector(&quot;.table-chunk-header-dark&quot;).getAttri&zwnj;&#8203;bute(&quot;style&quot;) = &quot;display: block;&quot;                  .document.querySelector(&quot;[onclick*=&#39;P-2.50-0-0&#39;]&quot;).Click&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556899349, "post_id": 55935887, "comment_id": 98597651, "body": "which exact line does it stop on? This is my debug script where you insert a single failing url : <a href=\"https://pastebin.com/nmJVRgHS\" rel=\"nofollow noreferrer\">pastebin.com/nmJVRgHS</a> That runs without fail for me which makes me think timing issue in loop (error will only sometimes pop up). If that is the case I need to know the exact failing line to add additional wait condition."}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556899823, "post_id": 55935887, "comment_id": 98597873, "body": "In my script executed over all urls it stops in that game and particulary in the line of over 2.5 on the loop"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556899906, "post_id": 55935887, "comment_id": 98597919, "body": "1) please paste the exact failing code line (the code) here 2) Does your script fail everytime or sometimes ? (I thought it was working?)"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556900301, "post_id": 55935887, "comment_id": 98598133, "body": "The code is working really well , but stops ( don&#39;t know why) in that particularly game on over 3.5 and then i thought that if the browser stops in that page then maybe the code stop in the loop for over 2.5"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556900360, "post_id": 55935887, "comment_id": 98598167, "body": "Do                 Loop Until .document.querySelector(&quot;.table-chunk-header-dark&quot;).getAttri&zwnj;&#8203;bute(&quot;style&quot;) = &quot;display: block;&quot;"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556900919, "post_id": 55935887, "comment_id": 98598439, "body": "No , because when the page stops in that url only shows me the error 424 object required"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556906709, "post_id": 55935887, "comment_id": 98600763, "body": "Again showed me that error : 424 object required, but only appears to click on &quot;ok&quot; or &quot;help&quot; , not debug  <a href=\"https://prnt.sc/nk1ayw\" rel=\"nofollow noreferrer\">prnt.sc/nk1ayw</a>"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556960924, "post_id": 55935887, "comment_id": 98611558, "body": "I think i solved the problem . will test in more days for see if works"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556964892, "post_id": 55935887, "comment_id": 98612405, "body": "i switch the line &quot;.document.querySelector(&quot;[onclick*=&#39;P-2.50-0-0&#39;]&quot;).Click&quot; to: On Error Resume Next  .document.querySelector(&quot;[onclick*=&#39;P-2.50-0-0&#39;]&quot;).Click  On Error GoTo 0 &quot; but in this game he gives me the odd of over 3.5 and i don&#39;t want this , so isn&#39;t working"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556964968, "post_id": 55935887, "comment_id": 98612419, "body": "Should i just put &quot;On Error GoTo 0&quot; and cut &quot;On Error Resume Next&quot; ?"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556965103, "post_id": 55935887, "comment_id": 98612440, "body": "that line doesn&#39;t click on over 2.5 if exists over 2.5 ?"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556965199, "post_id": 55935887, "comment_id": 98612458, "body": "but like i said before , when show me error , don&#39;t show me the button for debug , so i don&#39;t see where gets highlighted in yellow <a href=\"https://prnt.sc/nk1ayw\" rel=\"nofollow noreferrer\">prnt.sc/nk1ayw</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556965985, "post_id": 55935887, "comment_id": 98612656, "body": "This method you can use instead to go to error line: <a href=\"https://stackoverflow.com/a/36554214/6241235\">stackoverflow.com/a/36554214/6241235</a> Trap the error with an Error handler. Follow steps as described in that answer."}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556966632, "post_id": 55935887, "comment_id": 98612817, "body": "i can&#39;t open that pastebin, i create an account and still can&#39;t open"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556967226, "post_id": 55935887, "comment_id": 98612959, "body": "I switched one thing in vba and know appears debug,  wait i will run the code , then i tell you were highlighted in yellow on error"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1556967356, "post_id": 55935887, "comment_id": 98612989, "body": "Now stops here &quot; .Document.querySelector(&quot;[onmousedown*=&#39;uid&#40;13&#41;&#39;]&quot;).&zwnj;&#8203;FireEvent &quot;onmousedown&quot; &quot; ... I really don&#39;t understand this xD stops in that link <a href=\"https://www.oddsportal.com/soccer/argentina/primera-b-nacional/ca-mitre-santiago-del-estero-almagro-nmJPChXS/#bts;2\" rel=\"nofollow noreferrer\">oddsportal.com/soccer/argentina/primera-b-nacional/&hellip;</a>"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1557048963, "post_id": 55935887, "comment_id": 98629179, "body": "<a href=\"https://prnt.sc/nklob8\" rel=\"nofollow noreferrer\">prnt.sc/nklob8</a> When shows me the error i click in debug and after f8 and still show me highlighted in yellow only that line"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1557049036, "post_id": 55935887, "comment_id": 98629199, "body": "<a href=\"https://prnt.sc/nklome\" rel=\"nofollow noreferrer\">prnt.sc/nklome</a> &quot;interromper em todos os erros&quot; is  the same as &quot;break on all errors&quot;"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1557055251, "post_id": 55935887, "comment_id": 98630592, "body": "The problem is that line for sure , cause i eliminate that line and code works"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1557072501, "post_id": 55935887, "comment_id": 98635383, "body": "And have other error the code, because if in some urls that doesn&#39;t have over 2.5 but have for example over 3.5 the code show me error here &quot;.document.querySelector(&quot;[onclick*=&#39;P-2.50-0-0&#39;]&quot;).Click&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1557075682, "post_id": 55935887, "comment_id": 98636142, "body": "I didn&#39;t see that case when running. But it is easy to solve. Where are you finding an example for this too fail? Which url?"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1557076066, "post_id": 55935887, "comment_id": 98636252, "body": "waiit i will run and send u url"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1557076198, "post_id": 55935887, "comment_id": 98636283, "body": "<a href=\"https://www.oddsportal.com/soccer/norway/division-3-group-1-2019/spjelkavik-herd-082q0Ir2/#over-under;2\" rel=\"nofollow noreferrer\">oddsportal.com/soccer/norway/division-3-group-1-2019/&hellip;</a>"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1557081501, "post_id": 55935887, "comment_id": 98637653, "body": "Can you help me fix this problem ? I can&#39;t solve that :/"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1557093378, "post_id": 55935887, "comment_id": 98640475, "body": "Thank you for your help. I already see you help a lot of people and don&#39;t have time to help me more , so don&#39;t worry, i will try alone . Good luck helping people !"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1557093605, "post_id": 55935887, "comment_id": 98640516, "body": "I will look at this again. Don&#39;t worry. I don&#39;t like leaving questions unfinished. This one will take more time and thought though as I am not getting the error when I run it."}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 1, "creation_date": 1557094377, "post_id": 55935887, "comment_id": 98640674, "body": "Try switch for day 23 of that month and see if shows errors on your excel"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1557145207, "post_id": 55935887, "comment_id": 98655629, "body": "yes now this script solves the problem of if doesn&#39;t exist over 2.5 but exists others overs. But still have one error on &quot;.Document.querySelector(&quot;[onmousedown*=&#39;uid&#40;13&#41;&#39;]&quot;)&zwnj;&#8203;.FireEvent &quot;onmousedown&quot; &quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1557145297, "post_id": 55935887, "comment_id": 98655672, "body": "This is wrapped in an On Error so no error should be reported during run and &quot;no odds&quot; should returned.  The above version ran with no problem for me. You need break on unhandled errors (something like <i>quebrar em erros n&#227;o tratados</i>) in settings"}, {"owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "edited": false, "score": 0, "creation_date": 1557146324, "post_id": 55935887, "comment_id": 98656255, "body": "Now doesn&#39;t show me error :) i have switched in settings to &quot;break on all errors&quot; for see the debug option , now i switch again to &quot;break on unhandled errors&quot; and code works ! Thanks man"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1557146358, "post_id": 55935887, "comment_id": 98656273, "body": "Let&#39;s hope it is finally answered! Lol. We will see. Give it a few days and see. If still working then maybe accept answer."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1557144131, "last_edit_date": 1557144131, "creation_date": 1556711793, "answer_id": 55935887, "question_id": 55935260, "link": "https://stackoverflow.com/questions/55935260/how-to-solve-error-70-permission-denied/55935887#55935887", "title": "How to solve &quot;error 70 permission denied&quot;?", "body": "<p><strong>tl;dr;</strong></p>\n\n<p>One of the immediately obvious issues is the repeated creation of IE instances when only one is needed. <code>Permission denied</code> can occur for a number of reasons including not handling/disposing of objects properly. </p>\n\n<p>The following shows you how to:</p>\n\n<ol>\n<li>Work more efficiently with a single IE instance</li>\n<li>Use a helper function to gather all the urls to visit and filter on countries of interest</li>\n<li>Correctly retrieve <code>liga</code> value and assign country to a <code>country</code> variable</li>\n<li>Navigate to pages and between tabs accurately. Simply concatenating a suffix e.g.  <code>#bts;2</code> did not prove reliable for me with page almost always defaulting to default tab of <code>#1X2;2</code>. Below clicks/use of events are deployed to achieve the required navigation</li>\n<li>Apply condition based waits for content to be present with a timed loop demonstrated as well as a loop waiting for change in attribute value</li>\n<li>Reduce I/O and significantly boost execution time by storing results in an array and writing that array, <code>results</code>, out once to the sheet. Writing an item at a time to the sheet is an expensive I/O operation</li>\n<li>Use faster CSS selectors which modern browsers are optimised for</li>\n</ol>\n\n<hr>\n\n<p><strong>Caveats:</strong></p>\n\n<ul>\n<li>Tested with all links but there is scope for tightening up the code</li>\n<li>It is likely you may need to have a condition based wait for each event (clicking/FireEvent) on the page. I have demonstrated a variety of these.</li>\n</ul>\n\n<hr>\n\n<p><strong>Example contents of results array (1 index expanded) :</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/7F0ma.png\" width=\"500\"></p>\n\n<p>Empty indices are deliberately left to reflect desired output format. One additional column for <code>country</code> is added at end.</p>\n\n<hr>\n\n<p><strong>Example output:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/sPcbl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sPcbl.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong>Requirements:</strong></p>\n\n<ol>\n<li>VBE > Tools > References > Add reference to Microsoft HTML Object Library</li>\n</ol>\n\n<hr>\n\n<p><strong>VBA:</strong></p>\n\n<pre><code>Option Explicit\n'VBE &gt; Tools &gt; References:\n' Microsoft Internet Controls\nPublic Sub GetOddsInfo()\n    Dim ie As New InternetExplorer, url As String, matches()\n    Dim i As Long, results(), ws As Worksheet, headers()\n    Const MAX_WAIT_SEC As Long = 10\n    url = \"https://www.oddsportal.com/matches/soccer/20190423/\"\n    Set ws = ThisWorkbook.Worksheets(\"Plan1\")\n    headers = Array(\"Jogo\", vbNullString, \"Home Odds\", \"Draw odds\", \"Away Odds\", vbNullString, \"BTT\", _\n                    \"NBTT\", vbNullString, \"O2\", \"U2\", vbNullString, \"Liga\", \"Country\")\n\n    With ie\n        .Visible = True\n        .Navigate2 url\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        matches = GetMatches(url, .document)\n        ReDim results(1 To UBound(matches, 1), 1 To 14)\n\n        For i = LBound(matches, 1) To UBound(matches, 1)\n\n            .Navigate2 matches(i, 4)             ' default is \"#1X2;2\"\n\n            While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n            Dim equipas As String, liga As String, averages As Object, oddH As String, oddD As String, oddA As String\n            Dim country As String\n            country = matches(i, 1)\n            liga = matches(i, 2)\n            equipas = matches(i, 3)\n            Set averages = .document.querySelectorAll(\".aver td\")\n            oddH = \"'\" &amp; averages.item(1).innerText 'to ensure odds are correctly formatted on output\n            oddD = \"'\" &amp; averages.item(2).innerText\n            oddA = \"'\" &amp; averages.item(3).innerText\n            Set averages = Nothing\n\n            If .document.querySelectorAll(\"[onclick*='uid\\(13\\)'], [onmousedown*='uid\\(13\\)']\").Length &gt; 1 Then\n                On Error Resume Next\n                .document.querySelector(\"[onclick*='uid\\(13\\)']\").FireEvent \"onclick\" 'both teams to score\n                .document.querySelector(\"[onmousedown*='uid\\(13\\)']\").FireEvent \"onmousedown\"\n                On Error GoTo 0\n\n                While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n                Dim oddBtts  As String, oddNbtts As String, t As Date\n\n                t = Timer\n                Do\n                    On Error Resume Next\n                    Set averages = .document.querySelectorAll(\".aver td\")\n                    On Error GoTo 0\n                    If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n                Loop While averages.Length &lt; 2\n\n                If averages.Length &gt; 1 Then\n                    oddBtts = \"'\" &amp; averages.item(1).innerText\n                    oddNbtts = \"'\" &amp; averages.item(2).innerText\n                End If\n            Else\n                oddBtts = \"No odds\"\n                oddNbtts = \"No odds\"\n            End If\n            Set averages = Nothing\n            Dim oddOver As String, oddUnder As String\n\n            If .document.querySelector(\"#bettype-tabs li:nth-of-type(5)\").getAttribute(\"style\") = \"display: block;\" Then\n\n                .document.querySelector(\"#bettype-tabs li:nth-of-type(5) span\").FireEvent \"onmousedown\" 'over/under\n\n                Do\n                Loop Until .document.querySelector(\".table-chunk-header-dark\").getAttribute(\"style\") = \"display: block;\"\n\n               If .document.querySelectorAll(\"[onclick*='P-2.50-0-0']\").Length = 0 Then\n                   oddOver = \"No odds\"\n                   oddUnder = \"No odds\"\n               Else\n\n                .document.querySelector(\"[onclick*='P-2.50-0-0']\").Click\n\n                While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n\n                Set averages = .document.querySelectorAll(\".aver td\")\n                oddOver = \"'\" &amp; averages.item(2).innerText\n                oddUnder = \"'\" &amp; averages.item(3).innerText\n\n                End If\n\n            Else\n                oddOver = \"No odds\"\n                oddUnder = \"No odds\"\n            End If\n\n            Set averages = Nothing\n\n            Dim resultsPositions(), resultsOrder(), j As Long\n            resultsPositions = Array(1, 3, 4, 5, 7, 8, 10, 11, 13, 14) 'columns in output\n            resultsOrder = Array(equipas, oddH, oddD, oddA, oddBtts, oddNbtts, oddOver, oddUnder, liga, country)\n\n            For j = LBound(resultsPositions) To UBound(resultsPositions)\n                results(i, resultsPositions(j)) = resultsOrder(j)\n            Next\n            'If i = 5 Then Stop                   ''for testing\n        Next\n        .Quit\n    End With\n    With ws\n        .Cells(1, 1).Resize(1, UBound(headers) + 1) = headers\n        .Cells(2, 1).Resize(UBound(results, 1), UBound(results, 2)) = results\n    End With\nEnd Sub\n\nPublic Function GetMatches(ByVal url As String, ByVal doc As Object) As Variant\n    Dim results(), i As Long, listings As Object, html As HTMLDocument\n    Dim countries(), liga As String, country As String, equipas As String, include As Boolean\n    Set html = New HTMLDocument\n\n    countries = Array(\"Argentina\", \"Austria\", \"Belgium\", \"Brazil\", \"China\", \"Denmark\", \"England\", _\n                      \"Finland\", \"France\", \"Germany\", \"Greece\", \"Ireland\", \"Italy\", \"Japan\", \"Netherlands\", \"Norway\", _\n                      \"Poland\", \"Portugal\", \"Russia\", \"Scotland\", \"Spain\", \"Sweden\", \"Switzerland\", \"Turkey\", \"USA\")\n\n    Set listings = doc.querySelectorAll(\"#table-matches tr\")\n    Dim games As Object, r As Long\n    Set games = doc.querySelectorAll(\".table-participant a\")\n    ReDim results(1 To games.Length, 1 To 4)     'country, liga, equipas, url\n\n    For i = 0 To listings.Length - 1\n        html.body.innerHTML = listings.item(i).innerHTML\n        Select Case listings.item(i).className\n        Case \"dark center\"\n            country = Trim$(html.querySelector(\".bfl\").innerText)\n            liga = html.querySelector(\".bflp + a\").innerText\n            include = Not IsError(Application.Match(country, countries, 0))\n        Case \"odd deactivate\"\n            If include Then\n                r = r + 1\n                results(r, 1) = country\n                results(r, 2) = liga\n                results(r, 3) = html.querySelector(\"a\").innerText\n                results(r, 4) = Replace$(html.querySelector(\"a\").href, \"about:\", \"https://www.oddsportal.com\")\n            End If\n        Case \" deactivate\"\n            If include Then\n                r = r + 1\n                results(r, 1) = country\n                results(r, 2) = liga\n                results(r, 3) = html.querySelector(\"a\").innerText\n                results(r, 4) = Replace$(html.querySelector(\"a\").href, \"about:\", \"https://www.oddsportal.com\")\n            End If\n        End Select\n    Next\n    results = Application.Transpose(results)\n    ReDim Preserve results(1 To UBound(results, 1), 1 To r)\n    results = Application.Transpose(results)\n    GetMatches = results\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11420328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZXsUlwo_Rc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrT3fj1JdAWmzHn0k3ncQjQ34qbA/mo/photo.jpg?sz=128", "display_name": "Carlos Miguel", "link": "https://stackoverflow.com/users/11420328/carlos-miguel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1034, "favorite_count": 0, "accepted_answer_id": 55935887, "answer_count": 1, "score": 2, "last_activity_date": 1557144131, "creation_date": 1556708805, "last_edit_date": 1556742741, "question_id": 55935260, "link": "https://stackoverflow.com/questions/55935260/how-to-solve-error-70-permission-denied", "title": "How to solve &quot;error 70 permission denied&quot;?", "body": "<p><a href=\"https://i.stack.imgur.com/9VgP9.png\" rel=\"nofollow noreferrer\">Example of what code do for day 20/04/2019</a></p>\n\n<p>I'm trying to scrape some odds from oddsportal for some leagues. But since I open too many links, after some time my code stops and shows me the following error:</p>\n\n<blockquote>\n  <p>Run-time error '70': Permission denied. </p>\n</blockquote>\n\n<p>I tried putting some delay in the code but the error persists. Could someone please help me?</p>\n\n<pre><code>Sub test()\n\nDim IE() As Object\nDim IE1 As Object\nDim doc As HTMLDocument\nDim link1x2 As String\nDim linkover As String\nDim linkbtts As String\n\n''Novo c\u00f3digo\nSet IE1 = CreateObject(\"InternetExplorer.Application\")\nIE1.Visible = False\nIE1.Navigate \"https://www.oddsportal.com/matches/soccer/20190420\"\n\nDo While IE1.Busy Or IE1.ReadyState &lt;&gt; 4\n    Application.Wait DateAdd(\"s\", 1, Now)\nLoop\n\nSet doc = IE1.Document\nSet jogos = doc.getElementsByClassName(\"deactivate\")\nReDim IE(0 To jogos.Length * 3)\ni = 2\nj = 0\n\nFor Each jogo In jogos\n    URL = jogo.Children(1).Children(0).href\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    Set IE(j) = CreateObject(\"InternetExplorer.Application\")\n    link1x2 = URL &amp; \"#1X2;2\"\n    IE(j).Visible = False\n    IE(j).Navigate link1x2\n\n    Do While IE(j).Busy Or IE(j).ReadyState &lt;&gt; 4\n        Application.Wait DateAdd(\"s\", 1, Now)\n    Loop\n\n    Set doc = IE(j).Document\n    Set equipas = doc.getElementById(\"col-content\").Children(0)\n    Set liga = doc.getElementsByClassName(\"home\")(0).Children(0).Children(3)\n\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    For k = 1 To 25\n        If liga.innerText = Worksheets(\"Plan2\").Range(\"A\" &amp; k) Then\n            Worksheets(\"Plan1\").Range(\"M\" &amp; i) = liga.innerText\n            Worksheets(\"Plan1\").Range(\"A\" &amp; i) = equipas.innerText\n            oddH = doc.getElementsByClassName(\"aver\")(0).Children(1).innerText\n            oddD = doc.getElementsByClassName(\"aver\")(0).Children(2).innerText\n            oddA = doc.getElementsByClassName(\"aver\")(0).Children(3).innerText\n\n            Worksheets(\"Plan1\").Range(\"C\" &amp; i) = oddH\n            Worksheets(\"Plan1\").Range(\"D\" &amp; i) = oddD\n            Worksheets(\"Plan1\").Range(\"E\" &amp; i) = oddA\n\n            Set IE(j + 1) = CreateObject(\"InternetExplorer.Application\")\n            linkbtts = URL &amp; \"#bts;2\"\n            IE(j + 1).Visible = False\n            IE(j + 1).Navigate linkbtts\n\n            Do While IE(j + 1).Busy Or IE(j + 1).ReadyState &lt;&gt; 4\n                Application.Wait DateAdd(\"s\", 1, Now)\n            Loop\n\n            Set doc = IE(j + 1).Document\n\n            oddBTTS = doc.getElementsByClassName(\"aver\")(0).Children(1).innerText\n            oddNBTTS = doc.getElementsByClassName(\"aver\")(0).Children(2).innerText\n\n            Worksheets(\"Plan1\").Range(\"G\" &amp; i) = oddBTTS\n            Worksheets(\"Plan1\").Range(\"H\" &amp; i) = oddNBTTS\n            IE(j + 1).Quit\n\n            Set IE(j + 2) = CreateObject(\"InternetExplorer.Application\")\n            linkover = URL &amp; \"#over-under;2;2.50;0\"\n            IE(j + 2).Visible = False\n            IE(j + 2).Navigate linkover\n\n            Do While IE(j + 2).Busy Or IE(j + 2).ReadyState &lt;&gt; 4\n                Application.Wait DateAdd(\"s\", 1, Now)\n            Loop\n\n            Set doc = IE(j + 2).Document\n\n            oddover = doc.getElementsByClassName(\"aver\")(0).Children(2).innerText\n            oddunder = doc.getElementsByClassName(\"aver\")(0).Children(3).innerText\n\n            Worksheets(\"Plan1\").Range(\"J\" &amp; i) = oddover\n            Worksheets(\"Plan1\").Range(\"K\" &amp; i) = oddunder\n            IE(j + 2).Quit\n            i = i + 1\n        End If\n    Next k\n    IE(j).Quit\n    Application.Wait DateAdd(\"s\", 1, Now)\n    Application.Wait DateAdd(\"s\", 1, Now)\n    Application.Wait DateAdd(\"s\", 1, Now)\n    Application.Wait DateAdd(\"s\", 1, Now)\n    Application.Wait DateAdd(\"s\", 1, Now)\n    Application.Wait DateAdd(\"s\", 1, Now)\n    Application.Wait DateAdd(\"s\", 1, Now)\n    Application.Wait DateAdd(\"s\", 1, Now)\n    Application.Wait DateAdd(\"s\", 1, Now)\n    Application.Wait DateAdd(\"s\", 1, Now)\n    j = j + 1\nNext jogo\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1, "user_id": 11436601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/952db9a5079a5bc1a4e9e2977b781e63?s=128&d=identicon&r=PG&f=1", "display_name": "ou_Koevoet", "link": "https://stackoverflow.com/users/11436601/ou-koevoet"}, "edited": false, "score": 0, "creation_date": 1556709285, "post_id": 55935185, "comment_id": 98523291, "body": "Glad it worked. You should probably also be aware of which is regarded as the first and second cells as it may not always be obvious."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1556708436, "creation_date": 1556708436, "answer_id": 55935185, "question_id": 55935029, "link": "https://stackoverflow.com/questions/55935029/select-two-cell-ranges-and-trying-to-copy-one-cell-range-to-the-other-after-stor/55935185#55935185", "title": "Select two cell ranges and trying to copy one cell range to the other after storing each selection range as a variable", "body": "<p>Seems rather convoluted. To paste you need</p>\n\n<p><code>Range(FirstCell1).Copy Range(SecondCell1)</code></p>\n\n<p><code>FirstCell1</code> and <code>SecondCell1</code> are addresses. i.e. strings, and hence cannot be copied, which is a method of the Range object.</p>\n\n<p>You should get in the habit of declaring all your variables and using <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/option-explicit-statement\" rel=\"nofollow noreferrer\">Option Explicit</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 11436601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/952db9a5079a5bc1a4e9e2977b781e63?s=128&d=identicon&r=PG&f=1", "display_name": "ou_Koevoet", "link": "https://stackoverflow.com/users/11436601/ou-koevoet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 16, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556736607, "creation_date": 1556707752, "last_edit_date": 1556736607, "question_id": 55935029, "link": "https://stackoverflow.com/questions/55935029/select-two-cell-ranges-and-trying-to-copy-one-cell-range-to-the-other-after-stor", "title": "Select two cell ranges and trying to copy one cell range to the other after storing each selection range as a variable", "body": "<p>I am selecting two cell ranges and trying to copy the first cell range to the second cell range after storing each selected range. when I use F8 to go step by step through the code it all works but when the last if statement is true, I cannot get the FirstCell to copy to the SecondCell </p>\n\n<pre><code>Sub Move()\n\nDim FirstCell As String\nDim SecondCell As String\nDim cel As Excel.Range\nDim count As Integer\n\n\nApplication.EnableEvents = False\ncount = 0\nFor Each cell In Selection\n\nIf count = 0 Then\nFirstCell = cell.Value\nFirstCell1 = cell.Address\n\nEnd If\n\nIf count = 1 Then\nSecondCell = cell.Value\nSecondCell1 = cell.Address\n\nEnd If\n\ncount = count + 1\n\nNext\n\n\nIf FirstCell &lt;&gt; \"\" And SecondCell = \"\" And count = 2 Then 'Else Exit Sub\n\nSelection.FirstCell.Copy\nSecondCell1.PasteSpecial\n\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 2696834, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdaa905f92bc0af908c5049e55beba2b?s=128&d=identicon&r=PG&f=1", "display_name": "Badvoc", "link": "https://stackoverflow.com/users/2696834/badvoc"}, "edited": false, "score": 0, "creation_date": 1556716690, "post_id": 55934982, "comment_id": 98526415, "body": "Fantastic, put me on the right line of thinking and now solved :)"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1556707505, "creation_date": 1556707505, "answer_id": 55934982, "question_id": 55934740, "link": "https://stackoverflow.com/questions/55934740/append-to-union-query/55934982#55934982", "title": "Append to Union query", "body": "<p>Yes:</p>\n\n<pre><code>Dim Sql As String\n\nSql = Replace(CurrentDb.QueryDefs(\"Query1\").SQL, \";\", vbCrLf)\nCurrentDb.QueryDefs(\"Query1\").SQL = Sql &amp; CurrentDb.QueryDefs(\"Query2\").SQL\n</code></pre>\n\n<p>Query1 now holds the combined SQL of the two queries.</p>\n\n<p>For repeated usage, store the original SQL of Query1 somewhere.</p>\n"}], "owner": {"reputation": 11, "user_id": 2696834, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdaa905f92bc0af908c5049e55beba2b?s=128&d=identicon&r=PG&f=1", "display_name": "Badvoc", "link": "https://stackoverflow.com/users/2696834/badvoc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 55934982, "answer_count": 1, "score": 0, "last_activity_date": 1594780168, "creation_date": 1556705991, "last_edit_date": 1594780168, "question_id": 55934740, "link": "https://stackoverflow.com/questions/55934740/append-to-union-query", "title": "Append to Union query", "body": "<p>Is it possible, using VBA to add another query to a Union query? \nfor example, the sql of a union query:</p>\n\n<pre><code>select Max(qryTRInputPriorityList_SS.DT1) AS MaxOfDT1\nFrom qryTRinputPriorityList_SS\nUNION ALL select Max(qryTRInputPriorityList_MB.DT1) AS MaxOfDT1\nFrom qryTRinputPriorityList_MB;\n</code></pre>\n\n<p>and using VBA I want to add another select query to the sql above:</p>\n\n<pre><code>select Max(qryTRInputPriorityList_SS.DT1) AS MaxOfDT1\nFrom qryTRinputPriorityList_SS\nUNION ALL select Max(qryTRInputPriorityList_MB.DT1) AS MaxOfDT1\nFrom qryTRinputPriorityList_MB\nUNION ALL select Max(qryTRInputPriorityList_GS.DT1) AS MaxOfDT1\nFrom qryTRinputPriorityList_GS;\n</code></pre>\n\n<p>any code samples or anything would help, </p>\n\n<p>thanks</p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1556705257, "post_id": 55934536, "comment_id": 98521810, "body": "How about a new UF with a Label that gets populated with <code>Join(ErrorArray, vbCrLf)</code>? Make sure you make ErrorArray a public variable in order for the new UF to read it."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1556705641, "post_id": 55934536, "comment_id": 98521948, "body": "@TimStack: not sure if you need to make <code>ErrorArray</code> a public variable. If a label is update, you could just update the label directly from UDF (as long as the form is exposed). NoNameNo123: you could have a checkbox in your form which user can select to show or hide error message. Than you can check the checkbox status and <code>ErrorCount</code> to decide if the error should be shown"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1556705861, "post_id": 55934536, "comment_id": 98522042, "body": "@Zac that&#39;s true. Public variable if it is populated from it&#39;s own module, private if populated from within the original UF."}], "owner": {"reputation": 545, "user_id": 11356960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cda0d343183c7e4d9d5961845654b0?s=128&d=identicon&r=PG&f=1", "display_name": "NoNameNo123", "link": "https://stackoverflow.com/users/11356960/nonameno123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556704905, "creation_date": 1556704905, "question_id": 55934536, "link": "https://stackoverflow.com/questions/55934536/vba-collecting-and-showing-error-messages-in-userform", "title": "VBA: Collecting and showing error messages in UserForm?", "body": "<p>I have written some code in VBA that gets data from other workbooks and then updates several \"masterfiles\", through which my code loops. Right now I make a backup before updating the data and at the end of the loop I save the updated file. The code works and I'm not sure how pertinent it even is to the question:</p>\n\n<pre><code>Sub YearlyReport()\n\nDim FilePath As String\nDim VWArray As Variant\nDim wbVWAggr As Workbook\nDim VWNumber As Variant\n\nFilePath = \"C:\\VBA\\YearlyReport\\\"\nVWArray = Array(21, 25, 35, 45, 46, 49, 51, 52, 53, 54, 101)\n\nApplication.ScreenUpdating = False\n    For Each VWNumber In VWArray\n        Set wbVWAggr = Application.Workbooks.Open(FilePath &amp; \"Report\" &amp; VWNumber &amp; \".xlsx\")\n        wbVWAggr.SaveAs FilePath &amp; \"Report\" &amp; VWNumber &amp; \"_old\" &amp; Format(Now(), \"dd-mm-yyyy hh-mm-ss\") &amp; \".xlsx\"\n\n        'Data gets copy pasted from other workbooks\n\n        Application.DisplayAlerts = False 'Overwrite old file\n        wbVWAggr.SaveAs FilePath &amp; \"Report\" &amp; VWNumber &amp; \".xlsx\"\n        Application.DisplayAlerts = True\n    Next VWNumber\n\nApplication.ScreenUpdating = True   \nEnd Sub\n</code></pre>\n\n<p>This approach is fine, but what if a file can't be found? What I really wanna do is to continue the code, collect the error messages and show them to the user at the end (I put the code in a separate sub). I'd still have to write it, but I could then ask the user if he wants to save or cancel the whole thing: </p>\n\n<pre><code>Sub ErrorCollection()\n    Dim ErrorCount As Long\n    Dim ErrorArray() As String\n    Dim FilePath As String\n    Dim VWNumber As Variant\n    Dim VWArray As Variant\n    Dim ErrorMessage As String\n    Dim Item As Variant\n\n    FilePath = \"C:\\VBA\\YearlyReport\\\"\n    VWArray = Array(21, 25, 35, 45, 46, 49, 51, 52, 53, 54, 101)\n\n    For Each VWNumber In VWArray\n        If Dir$(FilePath &amp; \"Report\" &amp; VWNumber &amp; \".xlsx\") = \"\" Then\n            ErrorMessage = \"Report\" &amp; VWNumber &amp; \" cannot be found.\"\n            ReDim Preserve ErrorArray(ErrorCount)\n            ErrorArray(ErrorCount) = ErrorMessage\n            ErrorCount = ErrorCount + 1\n        End If\n    Next VWNumber\n\n    If ErrorCount &gt; 0 Then\n        MsgBox Join(ErrorArray, vbCrLf)\n    End If\nEnd Sub\n</code></pre>\n\n<p>Ideally the user can also hide the popup message to look at the files, which means using a UserForm - but in that case how do I show the error messages like in the MsgBox? I tried googling, but I only came across questions how to populate an array from a userform. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 1, "creation_date": 1556702659, "post_id": 55934115, "comment_id": 98520854, "body": "Do <b><i>not</i></b> post code in images. Post it as text instead."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1556702767, "post_id": 55934115, "comment_id": 98520893, "body": "Is there any code that makes new folders? You could launch the sub in your post when this happens. If not, I am not aware of any VBA code that acts as a listener for changes in folders"}, {"owner": {"reputation": 1, "user_id": 11436314, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NKCSTUs9myA/AAAAAAAAAAI/AAAAAAAAF-4/p_jXkfaQZ4c/photo.jpg?sz=128", "display_name": "Sara", "link": "https://stackoverflow.com/users/11436314/sara"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1556703163, "post_id": 55934115, "comment_id": 98521045, "body": "Great point Tim, code added as text.  There isn&#39;t any code that makes new folders. But I wonder if theres a macro, button or VBA to run the original vba again but within the format"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1556703596, "post_id": 55934115, "comment_id": 98521215, "body": "What do you mean with &quot;within the format&quot;?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1556703622, "post_id": 55934115, "comment_id": 98521224, "body": "These days, you don&#39;t need VBA for that. You can do that with Power Query (Get and Transform in Excel 2016 or O365), without writing a line of VBA."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1556703705, "post_id": 55934115, "comment_id": 98521255, "body": "@teylyn Can you reproduce the checkboxes in PQ (or Tables)?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1556703713, "post_id": 55934115, "comment_id": 98521261, "body": "As @TimStack mentioned, I don&#39;t think there is a listener in VBA that would do that but saying that, nothing stopping you from creating a listener to do that. However, VBA seems quiet a heavy language to do that, you could achieve that with scripts"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1556703922, "post_id": 55934115, "comment_id": 98521346, "body": "@RonRosenfeld: I don&#39;t think OP is creating the checkboxes automatically (atleast not in the code that is provided). Saying that, there is nothing stopping an automation generation of checkboxes from within VBA everytime a new folder is added (will have to remove them as well if folder is removed).. comes with its own challenges though"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1556704035, "post_id": 55934115, "comment_id": 98521394, "body": "@Zac That would be how I would approach it also (and I have a workbook I use that does just that.  But when teylyn wrote it could be done in PQ, I was wondering if the automatic creation of checkboxes could be done with that tool, also."}, {"owner": {"reputation": 1, "user_id": 11436314, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NKCSTUs9myA/AAAAAAAAAAI/AAAAAAAAF-4/p_jXkfaQZ4c/photo.jpg?sz=128", "display_name": "Sara", "link": "https://stackoverflow.com/users/11436314/sara"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1556704283, "post_id": 55934115, "comment_id": 98521474, "body": "TimStack Within the visual format.  @teylyn I just came upon VBA when searching for ways to make a list of folders in a folder. I&#39;ll check out Power Query and see if that could create what I&#39;m aiming for, thanks !  The check boxes are not of great importance, just trying to make overview of tasks quick and easy :)"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1556704306, "post_id": 55934115, "comment_id": 98521479, "body": "@RonRosenfeld: not sure if that particular task could be achieved with scripts.. although, just thinking out loud, maybe with a VBA exposed class? not sure"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1556704593, "post_id": 55934115, "comment_id": 98521596, "body": "If you don&#39;t need the checkboxes, then just add (or re-write if there will be deletions), the first column."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1556707982, "post_id": 55934115, "comment_id": 98522812, "body": "@RonRosenfeld Power Query can read spreadsheet cells as inputs, so, yes, that would be doable. Individual check box controls in  spreadsheet rows is an awful practice, but since each check box value needs to be stored in the grid somewhere, it is possible to feed the values for the check boxes to Power Query for evaluation."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1556708077, "post_id": 55934115, "comment_id": 98522835, "body": "How come that none of you seasoned participants bothered to edit the question to reveal the screen shot?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1556708755, "post_id": 55934115, "comment_id": 98523092, "body": "@teylyn I&#39;m pretty new to PQ. Thanks for that information."}], "owner": {"reputation": 1, "user_id": 11436314, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NKCSTUs9myA/AAAAAAAAAAI/AAAAAAAAF-4/p_jXkfaQZ4c/photo.jpg?sz=128", "display_name": "Sara", "link": "https://stackoverflow.com/users/11436314/sara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 320, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556707761, "creation_date": 1556702624, "last_edit_date": 1556707761, "question_id": 55934115, "link": "https://stackoverflow.com/questions/55934115/excel-how-to-make-list-of-folders-in-folder-that-automatically-update", "title": "Excel: How to make list of folders in folder that automatically update", "body": "<p>I am trying to set up an excel sheet with a list of folders in a main folder (not including sub folders within the folders). I've succeeded in running a VBA to create the list and then I have used the list to add on the different information needed for each folder (see image of visual setup). \nBut I would like to be able to update the list, so whenever new folders are added to the main folder it will appear on the list in the sheet. \nIs it possible to update the list to the format I have created either by macro, or button or automatically ?</p>\n\n<p><img src=\"https://i.stack.imgur.com/AtKIY.png\" alt=\"Visual setup of sheet using vba code for data in coloumn A\"></p>\n\n<pre><code>Option Explicit\n\nSub ListFoldersInDirectory()\n\n\nDim objFSO As Object\nDim objFolders As Object\nDim objFolder As Object\nDim strDirectory As String\nDim arrFolders() As String\nDim FolderCount As Long\nDim FolderIndex As Long\n\n\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .InitialFileName = Application.DefaultFilePath &amp; \"\\\"\n    .Title = \"Select Folder\"\n    .Show\n    If .SelectedItems.Count = 0 Then\n        Exit Sub\n    End If\n    strDirectory = .SelectedItems(1)\nEnd With\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFolders = objFSO.GetFolder(strDirectory).SubFolders\n\nFolderCount = objFolders.Count\n\nIf FolderCount &gt; 0 Then\n    ReDim arrFolders(1 To FolderCount)\n    FolderIndex = 0\n    For Each objFolder In objFolders\n        FolderIndex = FolderIndex + 1\n        arrFolders(FolderIndex) = objFolder.Name\n    Next objFolder\n    Worksheets.Add\n    Range(\"A1\").Resize(FolderCount).Value = Application.Transpose(arrFolders)\nElse\n    MsgBox \"No folders found!\", vbExclamation\nEnd If\n\nSet objFSO = Nothing\nSet objFolders = Nothing\nSet objFolder = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1556699283, "post_id": 55933348, "comment_id": 98519696, "body": "It should work properly if both your <code>F1</code> and lookup ranges are formatted as dates."}, {"owner": {"reputation": 11, "user_id": 11436069, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-G9gsp6UuefE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rczCkmTOMjLKVMD0-OBau1wLbUEzg/mo/photo.jpg?sz=128", "display_name": "Paul Gledhill", "link": "https://stackoverflow.com/users/11436069/paul-gledhill"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1556701703, "post_id": 55933348, "comment_id": 98520538, "body": "Thanks, I had tried that but some of my cells had been merged which causes it not to work"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1556701758, "post_id": 55933348, "comment_id": 98520554, "body": "Ahhh merged cells! VBA nightmare ;)"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1556702565, "post_id": 55933348, "comment_id": 98520823, "body": "For the sake of VBA, I vote to banish merged cells!"}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1559551129, "post_id": 55933348, "comment_id": 99442289, "body": "If your merged cells are <b>only vertically</b> merged, then <code>Range.Find</code> also finds in merged cells. But if they are merged horizontally or 2-dimensional, then only <code>SearchOrder:=xlByRows</code> finds in them, but <code>SearchOrder:=xlByColumns</code> doesn&#39;t. If this parameter is omitted, the last used one is in place. (And this behaviour seems to be a bug)."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11436069, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-G9gsp6UuefE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rczCkmTOMjLKVMD0-OBau1wLbUEzg/mo/photo.jpg?sz=128", "display_name": "Paul Gledhill", "link": "https://stackoverflow.com/users/11436069/paul-gledhill"}, "edited": false, "score": 0, "creation_date": 1556701041, "post_id": 55933516, "comment_id": 98520332, "body": "Thanks for the quick response I have gotten it to work now!"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 11, "user_id": 11436069, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-G9gsp6UuefE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rczCkmTOMjLKVMD0-OBau1wLbUEzg/mo/photo.jpg?sz=128", "display_name": "Paul Gledhill", "link": "https://stackoverflow.com/users/11436069/paul-gledhill"}, "edited": false, "score": 0, "creation_date": 1556701982, "post_id": 55933516, "comment_id": 98520629, "body": "@PaulGledhill glad it does! I have changed <code>DateFormat</code> to <code>DateValue</code>. If this helped you, please don&#39;t forget to accept an answer"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": false, "score": 0, "last_activity_date": 1556701941, "last_edit_date": 1556701941, "creation_date": 1556699280, "answer_id": 55933516, "question_id": 55933348, "link": "https://stackoverflow.com/questions/55933348/how-to-search-for-a-cell-containing-a-certain-date/55933516#55933516", "title": "How to search for a cell containing a certain date?", "body": "<p>Combining <code>.Find</code> with date values is a tad tricky, as you found out yourself.</p>\n\n<p>Try the following</p>\n\n<pre><code>Sub finddate()\n\n'Date to be searched\nSet SDate = Sheets(\"Data\").Range(\"F1\")\n\n'find function\nSet oRange = Sheets(\"Planning\").Range(\"A1:A50\").Find(What:=DateValue(Sdate), lookin:=xlFormulas)\n\n'Return Address\nMsgBox oRange.Address\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": false, "score": 0, "last_activity_date": 1556701751, "creation_date": 1556701751, "answer_id": 55933946, "question_id": 55933348, "link": "https://stackoverflow.com/questions/55933348/how-to-search-for-a-cell-containing-a-certain-date/55933946#55933946", "title": "How to search for a cell containing a certain date?", "body": "<p>Another way to do it:</p>\n\n<pre><code>Sub findDate()\nDim sht As Worksheet\nSet sht = ThisWorkbook.Worksheets(\"The name of your Worksheet\")\nDim dateToFind As Date\ndateToFind = sht.Range(\"F1\").Value\nDim cell As Range\nFor Each cell In sht.Range(\"datesRng\").Cells 'I am using a named range which contains the dates but you can use A1:A50 instead\n    If cell.Value = dateToFind Then\n        MsgBox cell.Address\n    End If\nNext cell\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 1, "last_activity_date": 1556702205, "creation_date": 1556702205, "answer_id": 55934029, "question_id": 55933348, "link": "https://stackoverflow.com/questions/55933348/how-to-search-for-a-cell-containing-a-certain-date/55934029#55934029", "title": "How to search for a cell containing a certain date?", "body": "<p>You have merged cells, that's why it returns <code>Nothing</code>, try:</p>\n\n<pre><code>Sub finddate()\n\nSet Sdate = Sheets(\"Data\").Range(\"F1\")\nSet SearchRange = Sheets(\"Planning\").Range(\"A1:A50\")\n\nIf Not IsError(Application.Match(Sdate, SearchRange, 0)) Then\n    Set oRange = Cells(Application.Match(Sdate, SearchRange, 0), 1)\n    MsgBox oRange.Address\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11436069, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-G9gsp6UuefE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rczCkmTOMjLKVMD0-OBau1wLbUEzg/mo/photo.jpg?sz=128", "display_name": "Paul Gledhill", "link": "https://stackoverflow.com/users/11436069/paul-gledhill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1556779298, "creation_date": 1556698529, "last_edit_date": 1556779298, "question_id": 55933348, "link": "https://stackoverflow.com/questions/55933348/how-to-search-for-a-cell-containing-a-certain-date", "title": "How to search for a cell containing a certain date?", "body": "<p>Trying to search for the cell location of a certain date.</p>\n\n<p>I have a range of dates in dd-mm-yy form and need to be able to find the cell location of a date picked from a drop down menu. I was using a standard Range.Find function which works for searching for Non-dates but when searching for dates it returns error 91: Object variable or With block variable not set.</p>\n\n<p>I have tried converting the dates to text format through both format cells and a =text function in excel prior to running the program but it still does not work. </p>\n\n<p>I read somewhere about converting the date to match the internal format used by Excel (mm/dd/yy) but this didn't make a difference.</p>\n\n<pre><code>'Date to be searched\n\nSet SDate = Sheets(\"Data\").Range(\"F1\")\n\n'find function\n\nSet oRange = Sheets(\"Planning\").Range(\"A1:A50\").Find(What:=Sdate, lookat:=xlWhole)\n\n'Return Address\n\nMsgBox oRange.Address\n</code></pre>\n\n<p>I expect to be able to search for a cell location and be given a cell location, in either A1 form or (1,1). Both will work. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 2, "creation_date": 1556696949, "post_id": 55933014, "comment_id": 98518975, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12687536/how-to-get-selected-path-and-name-of-the-file-using-open-file-dialog-control\">How to get selected path and name of the file using open file dialog control</a>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1556698152, "post_id": 55933014, "comment_id": 98519348, "body": "@TimStack, I doubt it&#39;s a duplicate since OP is interested in <code>msoFileDialogFolderPicker</code> more so than picking a file. However it is a straightforward copy of the code given as answer in your link. Hindsight OP should have researched more himself."}], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 0, "last_activity_date": 1556697435, "last_edit_date": 1556697435, "creation_date": 1556696954, "answer_id": 55933115, "question_id": 55933014, "link": "https://stackoverflow.com/questions/55933014/how-to-select-and-referencing-path-in-excel/55933115#55933115", "title": "How to select and referencing path in Excel?", "body": "<p>Try something like this:</p>\n\n<pre><code>Dim FLDR as Variant\n\nOption Explicit\n\nSub SelectPath()\n\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .Title = \"Choose a directory!\"\n    .Show\nEnd With\nOn Error Resume Next\nFLDR = Application.FileDialog(msoFileDialogFolderPicker).SelectedItems(1) &amp; \"\\\"\nIf FLDR = False Then Exit Sub\n\nDebug.Print FLDR 'Or do something else\n\nEnd sub\n</code></pre>\n\n<p>Maybe you should specify your target range better, instead of using activecell.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11435946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275a24b9671855ffbbe7765fc7ef43a3?s=128&d=identicon&r=PG&f=1", "display_name": "Ruben", "link": "https://stackoverflow.com/users/11435946/ruben"}, "is_accepted": false, "score": 0, "last_activity_date": 1556699223, "creation_date": 1556699223, "answer_id": 55933501, "question_id": 55933014, "link": "https://stackoverflow.com/questions/55933014/how-to-select-and-referencing-path-in-excel/55933501#55933501", "title": "How to select and referencing path in Excel?", "body": "<p>ok, thank you for the answer!</p>\n\n<p>I edited my code like this and now it does what I need to.</p>\n\n<p>This is just the first part of a bigger workflow that I need to create.</p>\n\n<p>Let me know if you have any comments on the code I wrote!</p>\n\n<pre><code>Sub SelezionaCartella()\n\n    Set cl = ActiveCell\n\n    ' Open the file dialog\n\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .Show\n\n        ' Display path of folder selected\n        For lngCount = 1 To .SelectedItems.Count\n\n            ' Add Hyperlink and add \\ after folder path\n            cl.Worksheet.Hyperlinks.Add _\n                Anchor:=cl, Address:=.SelectedItems(lngCount), _\n                TextToDisplay:=.SelectedItems(lngCount) &amp; \"\\\"\n\n        Next lngCount\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11435946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275a24b9671855ffbbe7765fc7ef43a3?s=128&d=identicon&r=PG&f=1", "display_name": "Ruben", "link": "https://stackoverflow.com/users/11435946/ruben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1556699223, "creation_date": 1556696365, "question_id": 55933014, "link": "https://stackoverflow.com/questions/55933014/how-to-select-and-referencing-path-in-excel", "title": "How to select and referencing path in Excel?", "body": "<p>I want to be able to select and referencing a path in a cell (to use it later to save some files).</p>\n\n<p>I've tried the following code:</p>\n\n<pre><code>Sub SelectPath()\n    Dim lngCount As Long\n    Dim cl As Range\n\n    Set cl = ActiveCell\n    ' Open the file dialog\n    With Application.FileDialog(msoFileDialogOpen)\n        .AllowMultiSelect = True\n        .Show\n        ' Display paths of each file selected\n        For lngCount = 1 To .SelectedItems.Count\n\n            ' Add Hyperlinks\n            cl.Worksheet.Hyperlinks.Add _\n                Anchor:=cl, Address:=.SelectedItems(lngCount), _\n                TextToDisplay:=.SelectedItems(lngCount)\n\n            Set cl = cl.Offset(1, 0)\n        Next lngCount\n    End With\nEnd Sub\n</code></pre>\n\n<p>With this I'm able to select a file and put the path with the filename in the cell (in hyperlink format).</p>\n\n<p>What I want is to be able to select only a path (not a file) and put it in a cell without the hyperlink (this second part is not really important).</p>\n\n<p>How can I edit the code to do that?</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 2, "creation_date": 1556693898, "post_id": 55932597, "comment_id": 98518166, "body": "You need to use <code>ListBox2.List(i)</code> instead of  <code>ListBox2(i)</code>"}, {"owner": {"reputation": 1, "user_id": 11435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ee3b3c10f1dfacc10fdba02b5b24423?s=128&d=identicon&r=PG&f=1", "display_name": "lithiumtin", "link": "https://stackoverflow.com/users/11435777/lithiumtin"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1556695813, "post_id": 55932597, "comment_id": 98518669, "body": "@TimStack: It works,  thanks! Funny thing is I tried the <code>ListBox2.List(i)</code> a moment ago and it returned error.  Somehow it worked this time."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1556695816, "post_id": 55932597, "comment_id": 98518670, "body": "What is the listcount of the listbox?"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1556695959, "post_id": 55932597, "comment_id": 98518704, "body": "@lithiumtin probably had to do with an incorrect index value. Glad it works now!"}], "answers": [{"tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": false, "score": 0, "last_activity_date": 1556714212, "last_edit_date": 1556714212, "creation_date": 1556713906, "answer_id": 55936336, "question_id": 55932597, "link": "https://stackoverflow.com/questions/55932597/excel-vba-listbox-item-to-string-function/55936336#55936336", "title": "Excel-VBA ListBox Item to String function", "body": "<p>As mentioned in the comments, proper way to refer to <code>ListBox</code> items in an array-like fashion is via the <code>ListBox.List(i)</code> route.</p>\n\n<p>Also a good practice would be to to check first whether the <code>ListBox</code> is empty, because attempting to open an empty file (because of non-existent <code>ListBox</code> field) will result in an <strong>error!</strong></p>\n\n<pre><code>If Not ListBox2.ListCount = 0 Then\n  For i = 0 To ListBox2.ListCount - 1\n     Application.Workbooks.Open Filename:= directory &amp; \"\\\" &amp; ListBox2.List(i)\n  Next i\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ee3b3c10f1dfacc10fdba02b5b24423?s=128&d=identicon&r=PG&f=1", "display_name": "lithiumtin", "link": "https://stackoverflow.com/users/11435777/lithiumtin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 322, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556714212, "creation_date": 1556693506, "last_edit_date": 1556714135, "question_id": 55932597, "link": "https://stackoverflow.com/questions/55932597/excel-vba-listbox-item-to-string-function", "title": "Excel-VBA ListBox Item to String function", "body": "<p>I have a Userform which allows user to transfer item from <code>ListBox1</code> to <code>ListBox2</code>. </p>\n\n<p><strong>The items in <code>ListBox2</code> are supposed to be filenames of excel files which are to be imported.</strong></p>\n\n<p>I have an overall idea of how this can operate but I am stuck with the problem that I cannot open the file with the item name in <code>ListBox2</code>.</p>\n\n<p>My question is, is it possible to \"convert\" the item name in a <code>Listbox</code> to a string so it can be used as the filename for file opening?</p>\n\n<p>I tried to use the MsgBox to test if the <code>Listbox2(i) / ListBox2.Name(i) / ListBox2.List(i)</code> argument returns any values but unfortunately it doesn't. It always shows blank.</p>\n\n<pre><code>'This is the part where I try to open the files indicated in ListBox2\nDim directory = \"my directory is here\"\n\nFor i = 0 To ListBox2.ListCount - 1\n\n        Application.Workbooks.Open Filename:= directory &amp; \"\\\" &amp; \"FinalExcel.xlsx\" 'This one is for testing to open file and it works.\n        Application.Workbooks.Open Filename:= directory &amp; \"\\\" &amp; ListBox2(i)\n\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 372, "user_id": 10996676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b40d30e699db99cf4405492b601bf9?s=128&d=identicon&r=PG&f=1", "display_name": "Spainey", "link": "https://stackoverflow.com/users/10996676/spainey"}, "reply_to_user": {"reputation": 11, "user_id": 11435606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ed4f57cd56ddae783797ff33cb654c?s=128&d=identicon&r=PG&f=1", "display_name": "Denise Turan", "link": "https://stackoverflow.com/users/11435606/denise-turan"}, "edited": false, "score": 0, "creation_date": 1556783955, "post_id": 55932576, "comment_id": 98548615, "body": "No problem, happy I could help :)  Can you accept my solution please?"}], "tags": [], "owner": {"reputation": 372, "user_id": 10996676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b40d30e699db99cf4405492b601bf9?s=128&d=identicon&r=PG&f=1", "display_name": "Spainey", "link": "https://stackoverflow.com/users/10996676/spainey"}, "is_accepted": false, "score": 2, "last_activity_date": 1556693350, "creation_date": 1556693350, "answer_id": 55932576, "question_id": 55932232, "link": "https://stackoverflow.com/questions/55932232/vba-code-to-search-column-for-next-non-empty-cell-move-up-1-cell-paste-someth/55932576#55932576", "title": "VBA Code to search column for next non empty cell, move up 1 cell &amp; paste something into it.. do until it done", "body": "<p>I've had a go at this and think I have a working solution. Though I have made assumptions that all of your headers are in a row without empty cells between them... if this is not the case, you can simply edit the \"Selection.End(xlToRight)\" part of the Range statement before it copies the headers, so that it includes all of the headers.</p>\n\n<pre><code>Sub LoopForColumnHeaders()\n'\n' This macro copies headers from a defined range (\"B5\":End of row) and pastes it above each encountered row of data as a header\n\n    ' Copy the headers\n    Range(\"B5\").Select\n    Range(Selection, Selection.End(xlToRight)).Select       ' Does the same as Ctrl + Shift + Right\n    Selection.Copy                                          ' Copy the headers\n\n    ' Pasting the first headers\n    Selection.End(xlDown).Select                ' Does the same as Ctrl + down\n    Selection.Offset(-1, 0).Activate            ' Move up one row\n    ActiveSheet.Paste                           ' Paste the headers\n\n    ' Pasting subsequent headers\n\n    Do While Idx &lt; 1048575                      ' Change this value if you want to, it determines when the loop will stop, but I didn't want to assume the length of your data so I set it to max rows - 1\n        Selection.End(xlDown).Select            ' Does the same as Ctrl + down\n        Selection.End(xlDown).Select            ' Do it again to get to next code chunk\n        If Not IsEmpty(ActiveCell) Then         ' Check this cell is not empty (bottom of page if data does not reach this far)\n            Selection.Offset(-1, 0).Activate    ' Move up one row\n            If IsEmpty(ActiveCell) Then         ' Check if this cell is empty\n                ActiveSheet.Paste               ' Paste the headers\n            End If\n        End If\n        Idx = ActiveCell.Row                    ' Set the value of Idx equal to current row\n    Loop\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11435569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eyTfN.jpg?s=128&g=1", "display_name": "Reena", "link": "https://stackoverflow.com/users/11435569/reena"}, "is_accepted": false, "score": 0, "last_activity_date": 1556700203, "creation_date": 1556700203, "answer_id": 55933680, "question_id": 55932232, "link": "https://stackoverflow.com/questions/55932232/vba-code-to-search-column-for-next-non-empty-cell-move-up-1-cell-paste-someth/55933680#55933680", "title": "VBA Code to search column for next non empty cell, move up 1 cell &amp; paste something into it.. do until it done", "body": "<p>\nAssumptions: <br>\n1.  left most cell of the header to insert is B5. <br>\n2.  right most cell of the header to insert is unknown. <br>\n3.  last data in row 5 is part of the header to insert. <br>\n</p>\n\n<p>Here is the subroutine:</p>\n\n<pre><code>Public Sub insertHeader()\n\n    'add an error handler\n    On error goto errHandler\n\n    'declare variables to use\n    dim oRangeHeader as Excel.Range 'range object of header\n    dim lColLastHeader as long 'last column of header\n    dim lRowLastColOfB as long 'last row of column B with data\n    dim lRowLastColOfB as long 'last row of column B with data\n    dim lRowOfBLoop as long 'row loop variable of column B\n    dim lRowOfBLoopEmpty as long 'empty row in column B\n\n    'get the last column of the header to insert\n    lColLastHeader= Activesheet.Cells(5,Application.Columns.Count).End(xlToLeft).Column\n\n    'set to range object variable the header\n    set oRangeHeader = Activesheet.Range(cells(5,2), cells(5,lColLastHeader))\n\n    'check if last row of column B has data\n    if len(Activesheet.range(\"B\" &amp; application.rows.count).value) = 0 then\n        'length is zero = no data\n        'get the last row of column B with data            \n        lRowLastColOfB = Activesheet.range(\"B\" &amp; application.rows.count).end(xlUp).Row\n    else\n        'length is greater than zero\n        lRowLastColOfB = application.rows.count\n    end if\n\n    'check if value of last row of column B is greater than the row of header\n    if lRowLastColOfB &gt; 5 then\n        'set to 0 the empty row variable in column\n        lRowOfBLoopEmpty = 0\n        'create a loop from B6 to last row of B\n        for lRowOfBLoop = 6 to lRowLastColOfB \n            'check if cell is empty\n            if len(Activesheet.range(\"B\" &amp; lRowOfBloop).value) = 0 then\n                'set the row of B loop to variable for empty row in B \n                lRowOfBLoopEmpty = lRowOfBloop\n            else\n                'check if variable for empty row is 0\n                if lRowOfBLoopEmpty &gt; 0 then\n                    oRangeHeader.copy \n                    Activesheet.Range(\"B\" &amp; lRowOfBLoopEmpty).select\n                    Activesheet.Paste\n                    Activesheet.Range(\"B\" &amp; lRowOfBLoop).select\n                    Application.CutCopyMode = false  \n                    lRowOfBLoopEmpty = 0\n                End If\n            End If\n        Next lRowOfBLoop\n    End If\n\nexitHandler:\n    Set oRangeHeader = Nothing\n    Exit Sub\n\nerrHandler:\n    If err.number &lt;&gt; 0 then\n        msgbox err.description &amp; \" \" &amp; err.number, vbOKOnly+vbInformation, \"addHeader\"\n        err.clear\n    end if\n    Set oRangeHeader = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11435606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ed4f57cd56ddae783797ff33cb654c?s=128&d=identicon&r=PG&f=1", "display_name": "Denise Turan", "link": "https://stackoverflow.com/users/11435606/denise-turan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1672, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1556779293, "creation_date": 1556690456, "last_edit_date": 1556779293, "question_id": 55932232, "link": "https://stackoverflow.com/questions/55932232/vba-code-to-search-column-for-next-non-empty-cell-move-up-1-cell-paste-someth", "title": "VBA Code to search column for next non empty cell, move up 1 cell &amp; paste something into it.. do until it done", "body": "<p>I'm new to VBA and need code to find the next non-empty cell in column B (until there are no more rows with data), copy header B5:Last non-empty cell into the row above where it found the non-empty cell(right now it's B5:P5, but it will change each time there is a new month. Each of these headers is used for pivot tables.</p>\n\n<p>Basically, this is a download from accounting software and it isn't formatted correctly with headers, so I have to add them manually. Each of the sections in the worksheet is different sizes and will continue to change in size when the year progresses and additional accounting codes are used.</p>\n\n<p>I do not have any code at this time.</p>\n\n<p>Example of Header Row in Row 5</p>\n\n<pre><code>MainAccount DEPT    Dep Lookup  Dep Lookup  Dep Lookup  PROD\n</code></pre>\n\n<p>Let's just say that the first data point found in column B is found at B28, I need the header row copied and pasted from B5: last in a row to the row just above where it found the first data in B28, meaning that it will be pasted starting in B27.</p>\n\n<pre><code>61000   2110                \n61000   2110                1\n61000   2110                3\n61000   2120                \n61000   2120                1\n61000   2120                3\n61000   2120                4\n</code></pre>\n\n<p>Now it looks again in column B and finds the next data point in B100. I need the header copied and pasted from B5:last in row to B99. It keeps doing this until there is no more data. The placement of the data in rows will change from month to month.</p>\n\n<pre><code>76200               \n76200   1000            \n76200   2020            \n76200   2100            \n76200   2110            \n76200   2115    \n</code></pre>\n\n<p>I expect that for each time the codes finds a value in column B, that it will go up 1 row and paste the header into it. It will do this until there is no more data (basically, the rows will just be blank).</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10804733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6df0bd442aacb3a802e50d43bb768b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Jefferson P. Woodruff III", "link": "https://stackoverflow.com/users/10804733/jefferson-p-woodruff-iii"}, "edited": false, "score": 0, "creation_date": 1556730578, "post_id": 55932250, "comment_id": 98532927, "body": "Thank you, my high quality sir. That worked perfectly."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11434297"}, "is_accepted": false, "score": 0, "last_activity_date": 1556690560, "creation_date": 1556690560, "answer_id": 55932250, "question_id": 55932123, "link": "https://stackoverflow.com/questions/55932123/how-to-select-a-range-of-cells-until-a-specific-value/55932250#55932250", "title": "How to select a range of cells until a specific value", "body": "<p>Trying looking across the row to find <em>STOP</em> and the column that defines the <em>column_num</em> argument of the second Cells..</p>\n\n<pre><code>Range(Selection.Cells(1), Cells(Selection.Cells(1).Row, Application.Match(\"stop\", Selection.Cells(1).EntireRow, 0)-1)).Select\n</code></pre>\n\n<p>I'm using <code>Selection.Cells(1)</code> because Selection could be more than one cell in more than one row and this will only work on a single row.</p>\n\n<p>You might also want to start writing code without using Select and Selection.</p>\n"}], "owner": {"reputation": 11, "user_id": 10804733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6df0bd442aacb3a802e50d43bb768b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Jefferson P. Woodruff III", "link": "https://stackoverflow.com/users/10804733/jefferson-p-woodruff-iii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 536, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556743325, "creation_date": 1556689592, "last_edit_date": 1556743325, "question_id": 55932123, "link": "https://stackoverflow.com/questions/55932123/how-to-select-a-range-of-cells-until-a-specific-value", "title": "How to select a range of cells until a specific value", "body": "<p>I have a row with 100+ cells that have certain values.</p>\n\n<p>I need to select all of those rows, until a specific value appears (lets say its the string \"STOP\").</p>\n\n<p>Currently I have the following code that basically just lets me select everything until the last cell with a value in it.</p>\n\n<pre><code>Range(Selection, Selection.End(xlToRight)).Select\n</code></pre>\n\n<p>But, I need the selection to not go all the way to the end but right before the cell with \"STOP\" in it.</p>\n"}, {"tags": ["excel", "vba", "pbkdf2"], "comments": [{"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1556692474, "post_id": 55932053, "comment_id": 98517789, "body": "You are missing the <code>keyDecoding</code> enum I think in <code>ByVal decodeKey As keyDecoding</code> - either you copied the core wrong, or it doesn&#39;t exist and you need to write your own"}, {"owner": {"reputation": 11, "user_id": 6776579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vr6mk.jpg?s=128&g=1", "display_name": "le__bon", "link": "https://stackoverflow.com/users/6776579/le-bon"}, "reply_to_user": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1556695140, "post_id": 55932053, "comment_id": 98518466, "body": "Thanks - I&#39;ve coped everything from the source (re-checked) maybe they missed it in their posting? (link in original post) Thanks for your help, though, I&#39;m not quite sure how I&#39;d write my own? = \\"}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1556695971, "post_id": 55932053, "comment_id": 98518709, "body": "I took a quick look at the SO post you link; the <code>Decode</code> function is not included so you&#39;ll have to find your own I&#39;m afraid. The <code>Encode</code> function is in the body of the question. The Enums are missing but not too hard to write. I suggest reading up on what the <code>Decode</code> function does, trying to write your own, and if you have difficulties, post that in a new question here. <i>PS you only need to comment once, to tag someone in a post do <code>@username</code> at the start (see the help link in the bottom of the add comment box)</i>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6776579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vr6mk.jpg?s=128&g=1", "display_name": "le__bon", "link": "https://stackoverflow.com/users/6776579/le-bon"}, "edited": false, "score": 0, "creation_date": 1556695105, "post_id": 55932587, "comment_id": 98518456, "body": "Thanks - I&#39;ve coped everything from the source (re-checked) maybe they missed it in their posting? (link in original post)  Thanks for your help, though, I&#39;m not quite sure how I&#39;d write my own? = \\"}], "tags": [], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "is_accepted": false, "score": 1, "last_activity_date": 1556693756, "last_edit_date": 1556693756, "creation_date": 1556693434, "answer_id": 55932587, "question_id": 55932053, "link": "https://stackoverflow.com/questions/55932053/pbkdf2-as-a-function-in-excel/55932587#55932587", "title": "PBKDF2 as a function in Excel", "body": "<p>This whole section in your <code>HMAC</code> function is missing some enum definitions:</p>\n\n<pre><code>Select Case decodeKey\nCase kdBase64\n    hashManager.key = Decode(key, edBase64)\nCase kdHex\n    hashManager.key = Decode(key, edHex)\nCase Else\n    hashManager.key = UTF8_GetBytes(key)\nEnd Select\n</code></pre>\n\n<p><code>decodeKey</code> is declared in your function signature with type <code>keyDecoding</code> which I presume is an enum:</p>\n\n<pre><code>Optional ByVal decodeKey As keyDecoding = kdNone_String\n</code></pre>\n\n<p>That's what's giving your error, this <code>keyDecoding</code> enum is not defined anywhere. However it looks like it only has 3 members so you could probably roll your own.</p>\n\n<p>The <code>Decode</code> and <code>Encode</code> functions meanwhile take some enum with <code>edBase64</code> and <code>edHex</code> members. This enum also isn't defined anywhere (although this is not what gives you the error, it's the first point I mentioned).</p>\n\n<p>You haven't included those two functions anyway so I can't say much more than that, but I imagine their signatures will tell you what the name of your second missing enum is. There maybe other issues with the code, but that's just what stood out to me. Make sure you've copied it from source correctly:)</p>\n"}], "owner": {"reputation": 11, "user_id": 6776579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vr6mk.jpg?s=128&g=1", "display_name": "le__bon", "link": "https://stackoverflow.com/users/6776579/le-bon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1556693756, "creation_date": 1556689048, "question_id": 55932053, "link": "https://stackoverflow.com/questions/55932053/pbkdf2-as-a-function-in-excel", "title": "PBKDF2 as a function in Excel", "body": "<p>I've managed to get SHA256 hashing working in Excel but was looking for something a little more secure, I've come across PBKDF2 Hash Generation here:\n<a href=\"https://stackoverflow.com/questions/45542723/pbkdf2-excel-udf-and-how-to-concatenate-inti\">PBKDF2 Excel UDF and how to concatenate INT(i)</a>\nBut the code in the solution doesn't run:</p>\n\n<blockquote>\n  <p>Compile error: User-defined type not defined</p>\n</blockquote>\n\n<p>With the following highlighted:</p>\n\n<pre><code>Function HMAC(ByVal plainText As String, _\n    ByVal algoritm As hmacAlgorithm, _\n    Optional ByVal key As String, _\n    Optional ByVal decodeKey As keyDecoding = kdNone_String, _\n    Optional ByVal encodeHash As hashEncoding = heBase64) As Variant\n</code></pre>\n\n<p>My end hope is to have a function similar to the SHA256 I have =SHA256hash(A2) with PBKDF2 keylength,salt and iterations as options\n=PBKDF2(A2,512,saltysalt,5000)\nFor instance, so it's something simple for the team here to implement, as we all know, the more difficult it is to implement, the less likely people are to do it.</p>\n\n<p>The code on the above link is:</p>\n\n<p><strong>Enums</strong></p>\n\n<pre><code>Enum hmacAlgorithm\n    HMAC_MD5\n    HMAC_SHA1\n    HMAC_SHA256\n    HMAC_SHA384\n    HMAC_SHA512\nEnd Enum\n\nEnum hashEncoding\n    heBase64\n    heHex\n    heNone_Bytes\nEnd Enum\n</code></pre>\n\n<p><strong>PBKDF2 Function</strong></p>\n\n<pre><code>Function PBKDF2(ByVal password As String, _\n    ByVal salt As String, _\n    ByVal hashIterations As Long, _\n    ByVal algoritm As hmacAlgorithm, _\n    Optional ByVal dkLen As Long, _\n    Optional ByVal encodeHash As hashEncoding = heBase64) As Variant\n\n'https://tools.ietf.org/html/rfc2898 - PKCS #5: Password-Based Cryptography Specification Version 2.0\n'https://tools.ietf.org/html/rfc6070 - PKCS #5: Password-Based Key Derivation Function 2 (PBKDF2) Test Vectors\n'https://en.wikipedia.org/wiki/PBKDF2\n\n'DK = T1 || T2 || ... || Tdklen/hlen\n'Ti = F(password, salt, c, i)\n'\n'F(Password, Salt, c, i) = U1 ^ U2 ^ ... ^ Uc\n'\n'U_1 = PRF (P, S || INT (i)) (INT (i) is a four-octet encoding of the integer i, most significant octet first.)\n'U_2 = PRF (P, U_1)\n'...\n'U_c = PRF (P, U_{c-1})\n\nDim utf8Encoding As Object\nDim hashManager As Object\n\nDim hLen As Long\nDim noBlocks As Long\nDim noBlock As Long\n\nDim hmacKeyBytes() As Byte\nDim saltBytes() As Byte\nDim uboundSaltBytes As Long\n\nDim hmacBytes() As Byte\nDim tempBytes() As Byte\nDim outputBytes() As Byte\n\nDim i As Long\nDim j As Long\n\n'Create utf8-encoding object\nSet utf8Encoding = CreateObject(\"System.Text.UTF8Encoding\")\n\n'Create hmac object\nSelect Case algoritm\n    Case HMAC_MD5\n        Set hashManager = CreateObject(\"System.Security.Cryptography.HMACMD5\")\n    Case HMAC_SHA1\n        Set hashManager = CreateObject(\"System.Security.Cryptography.HMACSHA1\")\n    Case HMAC_SHA256\n        Set hashManager = CreateObject(\"System.Security.Cryptography.HMACSHA256\")\n    Case HMAC_SHA384\n        Set hashManager = CreateObject(\"System.Security.Cryptography.HMACSHA384\")\n    Case HMAC_SHA512\n        Set hashManager = CreateObject(\"System.Security.Cryptography.HMACSHA512\")\nEnd Select\n\n'Check the length of the blocks to be generated\nhLen = hashManager.HashSize / 8\n\n'Calculate amount of blocks 'T'\nIf dkLen = 0 Then dkLen = hLen\nnoBlocks = Application.WorksheetFunction.Ceiling(dkLen / hLen, 1)\n\n'Encode the key and salt to bytes\nhmacKeyBytes = utf8Encoding.GetBytes_4(password)\nsaltBytes = utf8Encoding.GetBytes_4(salt)\n\n'Set the key in the crypto class\nhashManager.key = hmacKeyBytes\n\n'Get the length of the salt, add 4 to concatenate INT(I)\nuboundSaltBytes = UBound(saltBytes) + 4\n\n'Loop T1 || T2 || ... || Tdklen/hlen\nFor i = 1 To noBlocks\n\n    'Salt || INT(i)\n    'INT (i) is a four-octet encoding of the integer i, most significant octet first.\n    tempBytes = saltBytes\n    ReDim Preserve tempBytes(uboundSaltBytes)\n    noBlock = i\n\n    'Calculate INT(i) of Salt || INT(i)\n    For j = 3 To 0 Step -1\n        tempBytes(uboundSaltBytes - j) = Int(noBlock / (255 ^ j))\n        noBlock = noBlock - Int(noBlock / (255 ^ j)) * 255 ^ j\n    Next j\n\n    'Hash U1: Salt || INT(i)\n    hmacBytes = hashManager.ComputeHash_2(tempBytes)\n    tempBytes = hmacBytes\n\n    'Hash, Xor: U1 ^ U2 ^ ... ^ Uc\n    For j = 1 To hashIterations - 1\n        hmacBytes = hashManager.ComputeHash_2(hmacBytes)\n        tempBytes = XorBytes(tempBytes, hmacBytes)\n    Next j\n\n    'For the first block outputBytes() is empty\n    If i = 1 Then\n        outputBytes = tempBytes\n    Else\n        ConcatenateArrayInPlace outputBytes, tempBytes\n    End If\n\nNext i\n\n'Extract the first dkLen octets to produce a derived key DK:\nReDim Preserve outputBytes(dkLen - 1)\n\n'Base64, Hex, or Byte() output\nIf encodeHash = heBase64 Then\n    PBKDF2 = Encode(outputBytes, edBase64)\nElseIf encodeHash = heHex Then\n    PBKDF2 = Encode(outputBytes, edHex)\nElse\n    PBKDF2 = outputBytes\nEnd If\n\nSet hashManager = Nothing\nSet utf8Encoding = Nothing\n\nEnd Function\n</code></pre>\n\n<p><strong>HMAC function</strong></p>\n\n<pre><code>Function HMAC(ByVal plainText As String, _\n    ByVal algoritm As hmacAlgorithm, _\n    Optional ByVal key As String, _\n    Optional ByVal decodeKey As keyDecoding = kdNone_String, _\n    Optional ByVal encodeHash As hashEncoding = heBase64) As Variant\n\nDim hashManager As Object\n\nDim hashBytes() As Byte\nDim hmacKeyBytes() As Byte\n\n'Create the specific hash manager based on the hash algoritm\nSelect Case algoritm\n    Case HMAC_MD5\n        Set hashManager = CreateObject(\"System.Security.Cryptography.HMACMD5\") 'Returns 128 bits, 16 bytes\n    Case HMAC_SHA1\n        Set hashManager = CreateObject(\"System.Security.Cryptography.HMACSHA1\") 'Returns 160 bits, 20 bytes\n    Case HMAC_SHA256\n        Set hashManager = CreateObject(\"System.Security.Cryptography.HMACSHA256\") 'Returns 256 bits, 32 bytes\n    Case HMAC_SHA384\n        Set hashManager = CreateObject(\"System.Security.Cryptography.HMACSHA384\") 'Returns 384 bits, 48 bytes\n    Case HMAC_SHA512\n        Set hashManager = CreateObject(\"System.Security.Cryptography.HMACSHA512\") 'Returns 512 bits, 64 bytes\nEnd Select\n\n'Encode the plaintText to bytes\nhashBytes = UTF8_GetBytes(plainText)\n\nIf key = vbNullString Then\n\n    'Get the key generated by the hashManager\n    hmacKeyBytes = hashManager.key\n\n    'Calculate the hash\n    hashBytes = hashManager.ComputeHash_2(hashBytes)\n\n    'Return encoded result\n    If encodeHash = heBase64 Then\n        HMAC = \"&lt;Key&gt;\" &amp; Encode(hmacKeyBytes, edBase64) &amp; \"&lt;Key&gt;\" &amp; vbCrLf &amp; Encode(hashBytes, edBase64)\n    ElseIf encodeHash = heHex Then\n        HMAC = \"&lt;Key&gt;\" &amp; Encode(hmacKeyBytes, edHex) &amp; \"&lt;Key&gt;\" &amp; vbCrLf &amp; Encode(hashBytes, edHex)\n    End If\n\nElse\n\n    'Decode and set the key\n    Select Case decodeKey\n    Case kdBase64\n        hashManager.key = Decode(key, edBase64)\n    Case kdHex\n        hashManager.key = Decode(key, edHex)\n    Case Else\n        hashManager.key = UTF8_GetBytes(key)\n    End Select\n\n    'Calculate the hash\n    hashBytes = hashManager.ComputeHash_2(hashBytes)\n\n    'Return encoded result\n    If encodeHash = heBase64 Then\n        HMAC = Encode(hashBytes, edBase64)\n    ElseIf encodeHash = heHex Then\n        HMAC = Encode(hashBytes, edHex)\n    End If\n\nEnd If\n\nSet hashManager = Nothing\n\nEnd Function\n</code></pre>\n\n<p><strong>Test subroutine:</strong></p>\n\n<pre><code>Sub PBKDF2_Test()\n\nDim testvector As String\nDim pbkdf2_result As String\n\npbkdf2_result = PBKDF2(\"password\", \"salt\", 1, HMAC_SHA1, 20, heHex)\ntestvector = \"0c60c80f961f0e71f3a9b524af6012062fe037a6\"\nIf pbkdf2_result = testvector Then Debug.Print \"TV1: OK\" Else Debug.Print \"TV1: FAULT\"\n\npbkdf2_result = PBKDF2(\"password\", \"salt\", 2, HMAC_SHA1, 20, heHex)\ntestvector = \"ea6c014dc72d6f8ccd1ed92ace1d41f0d8de8957\"\nIf pbkdf2_result = testvector Then Debug.Print \"TV2: OK\" Else Debug.Print \"TV2: FAULT\"\n\npbkdf2_result = PBKDF2(\"password\", \"salt\", 4096, HMAC_SHA1, 20, heHex)\ntestvector = \"4b007901b765489abead49d926f721d065a429c1\"\nIf pbkdf2_result = testvector Then Debug.Print \"TV3: OK\" Else Debug.Print \"TV3: FAULT\"\n\npbkdf2_result = PBKDF2(\"passwordPASSWORDpassword\", \"saltSALTsaltSALTsaltSALTsaltSALTsalt\", 4096, HMAC_SHA1, 25, heHex)\ntestvector = \"3d2eec4fe41c849b80c8d83662c0e44a8b291a964cf2f07038\"\nIf pbkdf2_result = testvector Then Debug.Print \"TV4: OK\" Else Debug.Print \"TV4: FAULT\"\n\nEnd Sub\n</code></pre>\n\n<p>Any assistance would be greatly appreciated. Googling doesn't turn up much on PBKDF2 use in Excel.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1556699785, "last_edit_date": 1556699785, "creation_date": 1556695674, "answer_id": 55932930, "question_id": 55930931, "link": "https://stackoverflow.com/questions/55930931/how-to-make-a-button-make-visible-objects-in-another-userform/55932930#55932930", "title": "How to make a button make visible objects in another UserForm?", "body": "<p><strong>1st version:</strong> As you work with the <a href=\"https://rubberduckvba.wordpress.com/tag/userforms/\" rel=\"nofollow noreferrer\">default instance</a> of the userforms your code in Main could look like that</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    If ComboBox1.Value = \"Test1\" Then\n        Test.Label1.Visible = True\n        Test.Label2.Visible = False\n    End If\n    If ComboBox1.Value = \"Test2\" Then\n        Test.Label1.Visible = False\n        Test.Label2.Visible = True\n    End If\n    Test.Show\nEnd Sub\n\n\nPrivate Sub UserForm_Initialize()\n    Load Test\n    ComboBox1.AddItem \"Test1\"\n    ComboBox1.AddItem \"Test2\"\nEnd Sub\n</code></pre>\n\n<p>For using the default instance you might want to look at the following links and also searach for yourself as this has certain disadvantages</p>\n\n<p><a href=\"https://stackoverflow.com/questions/22191821/vba-userforms-used-with-no-explicit-instantiation\">VBA Userforms used with no explicit instantiation</a></p>\n\n<p><a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">Rubberduck: Userform1.show</a></p>\n\n<p><strong>2nd Version:</strong> An improved version would also need code in the second userform</p>\n\n<p>Code in Main</p>\n\n<pre><code>Option Explicit\nDim fTest As Test\nPrivate Sub CommandButton1_Click()\n    If ComboBox1.Value = \"Test1\" Then\n        fTest.Label1.Visible = True\n        fTest.Label2.Visible = False\n        fTest.Show\n    End If\n    If ComboBox1.Value = \"Test2\" Then\n        fTest.Label1.Visible = False\n        fTest.Label2.Visible = True\n        fTest.Show\n    End If\nEnd Sub\n\n\nPrivate Sub UserForm_Initialize()\n    Set fTest = New Test\n    ComboBox1.AddItem \"Test1\"\n    ComboBox1.AddItem \"Test2\"\nEnd Sub\n</code></pre>\n\n<p>And code in Test where you also need a Close button then</p>\n\n<pre><code>Option Explicit\nPrivate Sub btnClose_Click()\n    Hide\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer _\n                                       , CloseMode As Integer)\n\n    ' Prevent the form being unloaded\n    If CloseMode = vbFormControlMenu Then Cancel = True\n    Hide\n\nEnd Sub\n</code></pre>\n\n<p><strong>3rd version:</strong> with a property might look like that</p>\n\n<p>Code in Main</p>\n\n<pre><code>Option Explicit\nDim fTest As Test\nPrivate Sub CommandButton1_Click()\n        fTest.whichLbl = ComboBox1.Value\n        fTest.Show\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    Set fTest = New Test\n    ComboBox1.AddItem \"Test1\"\n    ComboBox1.AddItem \"Test2\"\nEnd Sub\n</code></pre>\n\n<p>And code in Test</p>\n\n<pre><code>Option Explicit\nDim lbl As String\nPrivate Sub btnClose_Click()\n    Hide\nEnd Sub\n\nPrivate Sub UserForm_Activate()\n    Select Case lbl\n        Case \"Test1\"\n            Label1.Visible = True\n            Label2.Visible = False\n        Case \"Test2\"\n            Label1.Visible = False\n            Label2.Visible = True\n        Case Else\n            Label1.Visible = False\n            Label2.Visible = False\n    End Select\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer _\n                                       , CloseMode As Integer)\n\n    ' Prevent the form being unloaded\n    If CloseMode = vbFormControlMenu Then Cancel = True\n    Hide\n\nEnd Sub\n\nProperty Let whichLbl(selLbl As String)\n    lbl = selLbl\nEnd Property\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1556699399, "post_id": 55932974, "comment_id": 98519732, "body": "This solution uses als the default instance which has certain disadvantages as described <a href=\"https://rubberduckvba.wordpress.com/tag/userforms/\" rel=\"nofollow noreferrer\">here</a>. I als provided the link in my answer."}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1556702500, "post_id": 55932974, "comment_id": 98520801, "body": "That&#39;s a bit presumptuous don&#39;t you think?  Do you presume I don&#39;t use <code>Option Explicit</code> or that it is not followed by <code>Private test as testUserForm</code>? Is it possible that <code>Set test = New testUserForm</code> is executed when form 1 is initialized?  The default instance could be <code>OnomatopoeiaFlipFlapFlarpityFloop</code> or <code>test</code> or <code>UserForm1</code>.  A negative does not prove a positive.   What we know, is that <code>Me</code> supports encapsulation and <code>test</code> can be scoped to global, module, or both and that it is possibly a default instance."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1556703147, "post_id": 55932974, "comment_id": 98521040, "body": "No I do not think so as you explicitly use <code>test</code> as the name of the userform which the OP refers to as his userform. As you did not give the whole code I can IMHO assume this is the name of the userform and therfore the default instance. I trust that you will use <code>Option Explict</code> etc. in a complete code. Anyway, I just wanted to give the OP the hint: Be careful with the default instance. And I think he would use the default instance based on your code snippet."}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1556705677, "post_id": 55932974, "comment_id": 98521962, "body": "I feel like I have to call out that <code>MsgBox</code>.  I can understand why you omitted it from your answers.  Personally, I have no idea what purpose it serves but I can easily argue that the OP may be using the modal window as a break point to pause program execution. In such an event, my answer continues to works flawlessly while all three of yours break the project.  And no, I use <code>test</code> as the name of the variable holding the user form.  It is not declared anywhere in any example.  Do not presume what cannot be known."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1556706404, "post_id": 55932974, "comment_id": 98522228, "body": "Most of the time we presume something :-) If you don&#39;t use the default instance then you should add a hint that a unload of the userform must be prevented. But your suggestion to use a property is IMO the best direction to follow."}], "tags": [], "owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "is_accepted": true, "score": 2, "last_activity_date": 1556695997, "creation_date": 1556695997, "answer_id": 55932974, "question_id": 55930931, "link": "https://stackoverflow.com/questions/55930931/how-to-make-a-button-make-visible-objects-in-another-userform/55932974#55932974", "title": "How to make a button make visible objects in another UserForm?", "body": "<p>I would probably do this with a property on the second form</p>\n\n<p>form 1 might look like this</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    test.textInForm1ComboBox1 = Me.ComboBox1.Text\nEnd Sub\n</code></pre>\n\n<p>and form 2 might look like this</p>\n\n<pre><code>Public Property Let textInForm1ComboBox1 (boxValue as String)\n    Select Case boxValue\n        Case \"Test 1\"\n            Me.Label1.Visible = True\n        Case \"Test 2\"\n            Me.Label2.Visible = True\n        Case Else\n           MsgBox \"Select an option\"\n      End select\nEnd Property\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11435274, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dZNecObbMtM/AAAAAAAAAAI/AAAAAAAAAEk/4L6oNIsab58/photo.jpg?sz=128", "display_name": "raul valentin fonseca carrillo", "link": "https://stackoverflow.com/users/11435274/raul-valentin-fonseca-carrillo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 55932974, "answer_count": 2, "score": 0, "last_activity_date": 1556736370, "creation_date": 1556677480, "last_edit_date": 1556736370, "question_id": 55930931, "link": "https://stackoverflow.com/questions/55930931/how-to-make-a-button-make-visible-objects-in-another-userform", "title": "How to make a button make visible objects in another UserForm?", "body": "<p>I want to make a UserForm containing multiple labels and textboxs that are set to visible=false and that only when the user select from another UserForm it shows the labels and textboxs that I want </p>\n\n<p>THE FIRST USERFORM (Main)</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nIf ComboBox1 = \"Test1\" Then\nTest.Show\n --------------------\nElseIf ComboBox1 = \"Test2\" Then\nTest.Show\n --------------------\nElse\nMsgBox \"Select an option\"\n\nEnd If\n\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>THE SECOND USEFORM (Test)</p>\n\n<p>Contains label1 and label2, if ComboBox1 from Main = \"Test1\" I want label1 to be visible</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 10846193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c9a4dbb9aee938c3bf195aab5b6d6ec?s=128&d=identicon&r=PG&f=1", "display_name": "Jwem93", "link": "https://stackoverflow.com/users/10846193/jwem93"}, "edited": false, "score": 0, "creation_date": 1556680723, "post_id": 55930928, "comment_id": 98515505, "body": "Thanks for the help Ron, but these do not account for when there are values of 0 in the column (which I want to ignore)"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 113, "user_id": 10846193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c9a4dbb9aee938c3bf195aab5b6d6ec?s=128&d=identicon&r=PG&f=1", "display_name": "Jwem93", "link": "https://stackoverflow.com/users/10846193/jwem93"}, "edited": false, "score": 0, "creation_date": 1556682300, "post_id": 55930928, "comment_id": 98515757, "body": "@jwem93 I&#39;d just check the value of that cell for zero."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1556677783, "last_edit_date": 1556677783, "creation_date": 1556677474, "answer_id": 55930928, "question_id": 55930744, "link": "https://stackoverflow.com/questions/55930744/how-do-i-use-match-to-find-the-first-cell-at-the-end-of-a-column-in-vba/55930928#55930928", "title": "How do I use &#39;Match&#39; to find the first cell at the end of a column in VBA?", "body": "<p>It's not a simple fix to replicate your formula in VBA because it is an array formula in Excel, and you'd have to loop through each cell because of the <code>INT</code> function.</p>\n\n<p>(Not tested) To find the last cell in a column in VBA, do something like:</p>\n\n<pre><code>set myCell = Cells(Rows.Count,1).end(xlup)\n</code></pre>\n\n<p>and to find the first empty cell:</p>\n\n<pre><code>set myCell = Cells(Rows.Count,1).end(xlUp).Offset(1,0)\n</code></pre>\n\n<p>Of course, as in your VBA attempt, qualifying the worksheet is appropriate and preferred</p>\n\n<pre><code>With worksheets(\"Sheet1\")\n   set myCell = .Cells(.Rows.Count,1).end(xlup)\nend with\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 10846193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c9a4dbb9aee938c3bf195aab5b6d6ec?s=128&d=identicon&r=PG&f=1", "display_name": "Jwem93", "link": "https://stackoverflow.com/users/10846193/jwem93"}, "edited": false, "score": 0, "creation_date": 1556680469, "post_id": 55930958, "comment_id": 98515460, "body": "This is what I was after thanks Tim. Thanks for your quick response!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1556677847, "creation_date": 1556677847, "answer_id": 55930958, "question_id": 55930744, "link": "https://stackoverflow.com/questions/55930744/how-do-i-use-match-to-find-the-first-cell-at-the-end-of-a-column-in-vba/55930958#55930958", "title": "How do I use &#39;Match&#39; to find the first cell at the end of a column in VBA?", "body": "<p>This should work:</p>\n\n<pre><code>Debug.Print Sheets(\"Sheet1\").Evaluate(\"MATCH(0,INT(A:A),0)\")\n</code></pre>\n\n<p>Don't use the <code>Application.Evaluate</code> form unless you specifically want the formula to be evaluated in the context of whichever sheet happens to be active.</p>\n"}], "owner": {"reputation": 113, "user_id": 10846193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c9a4dbb9aee938c3bf195aab5b6d6ec?s=128&d=identicon&r=PG&f=1", "display_name": "Jwem93", "link": "https://stackoverflow.com/users/10846193/jwem93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 1, "accepted_answer_id": 55930958, "answer_count": 2, "score": 0, "last_activity_date": 1556677847, "creation_date": 1556675561, "last_edit_date": 1556676077, "question_id": 55930744, "link": "https://stackoverflow.com/questions/55930744/how-do-i-use-match-to-find-the-first-cell-at-the-end-of-a-column-in-vba", "title": "How do I use &#39;Match&#39; to find the first cell at the end of a column in VBA?", "body": "<p><strong>Excel based:</strong></p>\n\n<p>I am using {=MATCH(0,INT(A:A),0)} in Excel to select the first row after the last filled cell in Column A (note the last value is either followed by a 0 or a blank cell, which is why I use INT()). This works just fine, however I have trouble replicating it in VBA. </p>\n\n<p>This will be a very simple fix, but I can't quite get it! Thanks in advance</p>\n\n<p><strong>My attempt in VBA:</strong> </p>\n\n<pre><code>Application.Match(0, Int(Sheets(\"Sheet1\").Range(\"A:A\").FormulaArray), 0)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11434297"}, "is_accepted": false, "score": 0, "last_activity_date": 1556683104, "creation_date": 1556683104, "answer_id": 55931455, "question_id": 55930722, "link": "https://stackoverflow.com/questions/55930722/convert-columns-with-multiple-rows-of-data-to-rows-with-multiple-columns-removi/55931455#55931455", "title": "Convert columns with multiple rows of data to rows with multiple columns, removing duplicate reference numbers", "body": "<p>With your data in its current pattern you do not need to check both column A and column B.</p>\n\n<pre><code>Sub ConsolidateRows_SpreadAcross()\n\n    Dim i As Long, j As Long\n    Dim colMatch As Variant, colConcat As Variant\n\n    Application.ScreenUpdating = False 'disable ScreenUpdating to avoid screen flashes\n\n    With Worksheets(\"sheet15\")\n\n        For i = .Cells(.Rows.Count, \"A\").End(xlUp).Row To 2 Step -1\n\n            If .Cells(i, 1) = Cells(i - 1, 1) Then\n                .Range(.Cells(i, 3), .Cells(i, .Columns.Count).End(xlToLeft)).Copy _\n                  Destination:=.Cells(i - 1, .Columns.Count).End(xlToLeft).Offset(0, 1)\n                .Rows(i).Delete\n            End If\n\n        Next i\n\n        .Cells(1, \"C\").Resize(1, .Cells(1, 1).CurrentRegion.Columns.Count - 2) = \"data\"\n\n    End With\n\n    Application.ScreenUpdating = True 'reenable ScreenUpdating\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11435137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd32c679fe323d7b37d4ed52e8d8ce6f?s=128&d=identicon&r=PG&f=1", "display_name": "MaxT", "link": "https://stackoverflow.com/users/11435137/maxt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1556778374, "creation_date": 1556675350, "last_edit_date": 1556778374, "question_id": 55930722, "link": "https://stackoverflow.com/questions/55930722/convert-columns-with-multiple-rows-of-data-to-rows-with-multiple-columns-removi", "title": "Convert columns with multiple rows of data to rows with multiple columns, removing duplicate reference numbers", "body": "<p>I have a data set similar to the below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vsYoa.png\" rel=\"nofollow noreferrer\">Example data</a>          </p>\n\n<p>I would like to convert the data to multiple columns where duplicate ID's (column 1) are removed and all other data is consolidated into single rows split across columns.</p>\n\n<p>I have tried the following code from another thread:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/12613507/convert-columns-with-multiple-rows-of-data-to-rows-with-multiple-columns-in-exce\">Convert columns with multiple rows of data to rows with multiple columns in Excel.</a></p>\n\n<p>However this results in column two data also being consolidated across columns where there are duplicates in rows.</p>\n\n<p>For example, the above table would appear as</p>\n\n<p><a href=\"https://i.stack.imgur.com/bLij6.png\" rel=\"nofollow noreferrer\">Current result</a>    </p>\n\n<p>I need to amend the code so that it only removes duplicated data in column 1 and spreads the remaining data across columns.</p>\n\n<p>I would like the data to end as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8NtJ1.png\" rel=\"nofollow noreferrer\">Desired result</a></p>\n\n<p>Below is the code i'm using:</p>\n\n<hr>\n\n<pre><code>Sub ConsolidateRows_SpreadAcross()\n\nDim lastRow As Long, i As Long, j As Long\nDim colMatch As Variant, colConcat As Variant\n\napplication.ScreenUpdating = False 'disable ScreenUpdating to avoid screen flashes\n\nlastRow = range(\"A\" &amp; Rows.Count).End(xlUp).Row 'get last row\n\nFor i = lastRow To 2 Step -1\n\n    If Cells(i, 2) = Cells(i - 1, 2) Then\n        range(Cells(i, 3), Cells(i, Columns.Count).End(xlToLeft)).Copy Cells(i - 1, Columns.Count).End(xlToLeft).Offset(, 1)\n        Rows(i).Delete\n    Else\n        If Cells(i, 1) = Cells(i - 1, 1) Then\n            range(Cells(i, 2), Cells(i, Columns.Count).End(xlToLeft)).Copy _\n                Cells(i - 1, Columns.Count).End(xlToLeft).Offset(, 1)\n            Rows(i).Delete\n        End If\n    End If\n\nNext\n\napplication.ScreenUpdating = True 'reenable ScreenUpdating\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Any assistance would be greatly appreciated.</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1556690978, "post_id": 55930702, "comment_id": 98517458, "body": "Not really understanding the WHERE criteria. Why must n increment? Edit question to show sample data and desired result."}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 1, "last_activity_date": 1556735047, "last_edit_date": 1556735047, "creation_date": 1556690480, "answer_id": 55932239, "question_id": 55930702, "link": "https://stackoverflow.com/questions/55930702/writing-a-script-to-repeat-an-update-query-using-an-incrementing-variable/55932239#55932239", "title": "Writing a script to repeat an Update query using an incrementing variable", "body": "<p>VBA procedure could have code like:</p>\n\n<pre><code>Dim rs As DAO.Recordset, lngCnt As Long\nSet rs = CurrentDb.OpenRecordset(\"SELECT * FROM a WHERE pnsi Is Null;\")\nFor lngCnt = 1 to 100000\n    If Not rs.EOF Then\n        rs.Edit\n        rs!pnsi = lngCnt\n        rs.Update\n        rs.MoveNext\n    Else\n        Exit For\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4454842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d2b4180700c6f84159e0111267d01c7?s=128&d=identicon&r=PG&f=1", "display_name": "Ramski", "link": "https://stackoverflow.com/users/4454842/ramski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594780182, "creation_date": 1556675103, "last_edit_date": 1594780182, "question_id": 55930702, "link": "https://stackoverflow.com/questions/55930702/writing-a-script-to-repeat-an-update-query-using-an-incrementing-variable", "title": "Writing a script to repeat an Update query using an incrementing variable", "body": "<p>I have table a:</p>\n\n<pre><code>a.si\na.p\na.pnsi\n</code></pre>\n\n<p>si is a unique id, p is a double, pnsi is null</p>\n\n<p>I'd like to run an update query on pnsi using this subquery with variable n:</p>\n\n<pre><code>(SELECT si FROM a as y WHERE y.si = a.si + n AND y.p &gt; a.p)\n</code></pre>\n\n<p>I'd like to be able to run this query on incrementing values of n from 1 to 100,000, each time only on the remaining records where pnsi is still null.</p>\n\n<p>The query has two criteria:\n1. That the si value selected (y.si) as a.pnsi is greater than a.si\n2. That y.p is greater than a.p</p>\n\n<p>The purpose of this is to reduce processing time, since this procedure is going to be run on a table of over a million records and most of the time, the correct solution can be found with a very small n value. By running it this way, Access will evaluate n = 1, 2 ... (ascending), resulting in very few records where n will increment all the way up to 100,000. </p>\n\n<p>What I'm in need of is a script to increment through the values of n to repeat the update query n times on remaining null records. <strong>The script needs to send the current value of the n variable to the Update query (y.si = a.si + n).</strong> The loop stops when either there are no more records to update or when n reaches 100,000. Any ideas?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1556675972, "post_id": 55930690, "comment_id": 98514727, "body": "The FieldSize property in table can limit number of characters accepted by the field."}, {"owner": {"reputation": 27, "user_id": 6686711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56205ef5d6f3fa97fd3720edcab0e00f?s=128&d=identicon&r=PG&f=1", "display_name": "Costas", "link": "https://stackoverflow.com/users/6686711/costas"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1556728478, "post_id": 55930690, "comment_id": 98532059, "body": "True but it&#39;s an unbound textbox."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1556731223, "post_id": 55930690, "comment_id": 98533175, "body": "So you don&#39;t intend to save this input anywhere?"}, {"owner": {"reputation": 27, "user_id": 6686711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56205ef5d6f3fa97fd3720edcab0e00f?s=128&d=identicon&r=PG&f=1", "display_name": "Costas", "link": "https://stackoverflow.com/users/6686711/costas"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1556752526, "post_id": 55930690, "comment_id": 98540685, "body": "Oh no, I&#39;m definitely saving the input but as I mentioned it&#39;s a comment field and can be quite lengthy. I don&#39;t want someone to type in &quot;War And Peace&quot; only to have it truncated afterwards."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6686711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56205ef5d6f3fa97fd3720edcab0e00f?s=128&d=identicon&r=PG&f=1", "display_name": "Costas", "link": "https://stackoverflow.com/users/6686711/costas"}, "edited": false, "score": 1, "creation_date": 1556727662, "post_id": 55931849, "comment_id": 98531710, "body": "HansUp, thank you for the 2nd set of eyes on my miss. Works as desired now. I also added a <code>Me.Text0.SelStart = 20</code> as it was placing the cursor at the beginning of the line afterwards."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 27, "user_id": 6686711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56205ef5d6f3fa97fd3720edcab0e00f?s=128&d=identicon&r=PG&f=1", "display_name": "Costas", "link": "https://stackoverflow.com/users/6686711/costas"}, "edited": false, "score": 0, "creation_date": 1556730199, "post_id": 55931849, "comment_id": 98532791, "body": "Yeah, I thought about mentioning <code>.SelStart</code>.  In mine, I used <code>.SelStart = Len(Me.Text0.Text)</code>, but yours is simpler.  :-)"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 3, "last_activity_date": 1556687078, "creation_date": 1556687078, "answer_id": 55931849, "question_id": 55930690, "link": "https://stackoverflow.com/questions/55930690/how-to-limit-number-of-characters-of-form-field/55931849#55931849", "title": "How to limit number of characters of form field", "body": "<blockquote>\n  <p><em>... when it hits the limit the box comes up but as soon as you click OK it blanks the field. \n   How do you prevent it from killing the data already entered?</em></p>\n</blockquote>\n\n<p>Change this line ...</p>\n\n\n\n<pre class=\"lang-vba prettyprint-override\"><code>Me.Text0 = Left(Me.Text0, 20)\n</code></pre>\n\n<p>... to this ...</p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>Me.Text0.Text = Left(Me.Text0.Text, 20)\n</code></pre>\n\n<p>That change preserves the first 20 characters of <code>Me.Text0.Text</code> when it is altered by the <code>Left()</code> assignment expression.  The reason your original code was <em>\"killing the data already entered\"</em> is because <code>Me.Text0</code> means <code>Me.Text0.Value</code>, not <code>Me.Text0.Text</code></p>\n"}, {"tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": false, "score": 1, "last_activity_date": 1556804257, "creation_date": 1556804257, "answer_id": 55953735, "question_id": 55930690, "link": "https://stackoverflow.com/questions/55930690/how-to-limit-number-of-characters-of-form-field/55953735#55953735", "title": "How to limit number of characters of form field", "body": "<p>You don't need any code. Simply use a input mask setting in the text box.</p>\n\n<p>In the input mask, just type in AAAAA (20 of them).</p>\n\n<p>this way, you need no code at  all, and the user will only be able to enter as many characters as you want.</p>\n"}], "owner": {"reputation": 27, "user_id": 6686711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56205ef5d6f3fa97fd3720edcab0e00f?s=128&d=identicon&r=PG&f=1", "display_name": "Costas", "link": "https://stackoverflow.com/users/6686711/costas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1076, "favorite_count": 1, "accepted_answer_id": 55931849, "answer_count": 2, "score": 2, "last_activity_date": 1594780190, "creation_date": 1556674933, "last_edit_date": 1594780190, "question_id": 55930690, "link": "https://stackoverflow.com/questions/55930690/how-to-limit-number-of-characters-of-form-field", "title": "How to limit number of characters of form field", "body": "<p>I have a form with an unbound comment field that we want to limit the number of characters in it. To make things as clean as possible, and to confirm it wasn't something else, I created a new form with two unbound text boxes. \"Text0\" is where you enter the data and \"Text1\" is the counter.</p>\n\n<pre><code>Private Sub Text0_Change()\n    If Not IsNull(Me.Text0.Text) Then\n        If Len(Me.Text0.Text) &gt; 20 Then\n            Dim resp As Integer\n            resp = MsgBox(\"Exceeded the number of characters allowed.\", vbOKOnly, \"Too long\")\n            Me.Text0 = Left(Me.Text0, 20)\n        End If\n        Me.Text1 = Len(Me.Text0.Text) &amp; _\n        \" /20 characters used.\"\n    Else\n        Me.Text1 = \"0 /20 characters used.\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>To the issue. If you start entering data all is fine, it counts the length. However, when it hits the limit the box comes up but as soon as you click OK it blanks the field.</p>\n\n<p>I also tried to put in a validation rule but it doesn't fire until after loss of focus.</p>\n\n<p>How do you prevent it from killing the data already entered? The actual field limit is much longer and re-typing the comments won't fly.</p>\n"}, {"tags": ["excel", "vba", "userform", "worksheet-function"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1556673398, "post_id": 55930498, "comment_id": 98514310, "body": "Please create a screenshot with a few rows of data, one row for &quot;it&#39;s working&quot; and another one for data that is not working. It&#39;s hard to visualise your data structure, especially since the site hides words between angled brackets."}, {"owner": {"reputation": 13, "user_id": 11036387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26588fad49989ef0a77fafb022d68258?s=128&d=identicon&r=PG&f=1", "display_name": "Jjc1000", "link": "https://stackoverflow.com/users/11036387/jjc1000"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1556677243, "post_id": 55930498, "comment_id": 98514957, "body": "I was unaware that angle brackets hid text. Sorry about that. If I recall correctly, I cannot upload pictures yet because I do not have enough reputation points"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1556688206, "post_id": 55930498, "comment_id": 98516887, "body": "You can upload a picture but it won&#39;t be visible unless someone edits the post. I can do that."}], "owner": {"reputation": 13, "user_id": 11036387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26588fad49989ef0a77fafb022d68258?s=128&d=identicon&r=PG&f=1", "display_name": "Jjc1000", "link": "https://stackoverflow.com/users/11036387/jjc1000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556779287, "creation_date": 1556672909, "last_edit_date": 1556779287, "question_id": 55930498, "link": "https://stackoverflow.com/questions/55930498/excel-vba-index-match-working-inconsistently", "title": "Excel VBA: Index-Match working inconsistently", "body": "<p>I have an excel userform that pulls data from a worksheet. The user selects an OptionButton next to the textbox (13 total) containing a subject they would like to know additional information about. An index match (worksheet function) then returns the matching data from cells to populate additional textboxes on the userform. \nI have over 100 cells in the worksheet array that can be used to populate the textboxes that have radio buttons next to them. The index-match code I am using works on all of them but five and I cannot figure out why! \nError code: \"Run-time error 1004: Unable to get the Match property of the Worksheet Class\"</p>\n\n<p>I have tried the following:\n- making sure all the cells in the array are formatted the same (they are all formatted as 'General'). I have also tried formatting them as 'Text'. No luck\n- checking to make sure there were no hidden characters in the cells (I copy/pasted them to a notepad, checked the characters, then copied them back to excel.\n- ensured the cells do in fact have matches by copying them to a blank sheet and using the 'check for duplicates'\n- I tried to copy the formatting of a cell that does behave correctly onto those that do not. </p>\n\n<p>Here's where it gets strange. \nAll the cells contain strings of text that end with something similar to <code>\"&lt;T6-1.1.A.01&gt;\"</code> (not including the quotations) This lets the user know where in the dept reference manual the lines of text came. </p>\n\n<p>For the cells that have match errors, if I delete the contents from the index array and the match array and replace it with some simple text like \"apple\" the code runs fine. However once I get towards the end and have string that ends in some of the following combinations (including the angle brackets), the code stops working</p>\n\n<blockquote>\n  <p>&lt;5.A> &lt;.5.A> &lt;5.5.5> &lt;5-1.1.A> &lt;5-1.1,A> &lt;5-1.1 A> &lt;5-1.1A> &lt;5-1 1A></p>\n  \n  <p>5-1.1.A  (no brackets)</p>\n</blockquote>\n\n<p>This is what my code looks like (for the cases where it works and where it doesn't). The objects I refer to in the code are named ranges from my worksheet. They are all identical lengths.</p>\n\n<pre><code> TextBoxInspection.Text=Application.WorksheetFunction.Index\n (Sheets(\"Sheet4\").Range(\"InspectionTime\"),Application.WorksheetFunction\n .Match(TextBox13.Value,Sheets(\"Sheet4\").Range(\"InspectionCat\"),0),1)\n</code></pre>\n\n<p>I'm pretty new to VBA and cannot figure this one out. Anyone have an idea what is causing this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1556672540, "post_id": 55930450, "comment_id": 98514158, "body": "Remove <code>On Error Resume Next</code>. Does the code throw an error? If so, what is the error message?"}, {"owner": {"reputation": 3, "user_id": 10431739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e4d5ff192aeac8612c95df4e55970ce?s=128&d=identicon&r=PG&f=1", "display_name": "Derrick Lim", "link": "https://stackoverflow.com/users/10431739/derrick-lim"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1556782484, "post_id": 55930450, "comment_id": 98547920, "body": "if I remove &quot;On Error Resume Next&quot;, I will see an &quot;Run-time error &#39;5&#39;: Invalid procedure call or argument. if I add ReDim MyArray (3,20), The display was ok, but this statement was used to reserved the number of row of the output."}], "owner": {"reputation": 3, "user_id": 10431739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e4d5ff192aeac8612c95df4e55970ce?s=128&d=identicon&r=PG&f=1", "display_name": "Derrick Lim", "link": "https://stackoverflow.com/users/10431739/derrick-lim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556697555, "creation_date": 1556672329, "last_edit_date": 1556697555, "question_id": 55930450, "link": "https://stackoverflow.com/questions/55930450/abnormal-output-when-only-one-data", "title": "Abnormal Output When Only One Data", "body": "<p>I have the following code to display the output when the code was executed.\nEverything was ok except the output displayed when only one data is available.</p>\n\n<pre><code>Sub STELStatusCheck_click()\nDim MyArray()\nDim LastRow As Long, LastRow2 As Long\nDim ctr As Long\nDim ws As Worksheet\nApplication.ScreenUpdating = False\nOn Error Resume Next\n\nLastRow = Sheet11.Cells(Sheet11.Rows.Count, 2).End(xlUp).Row\nLastRow2 = Sheet13.Cells(Sheet13.Rows.Count, 2).End(xlUp).Row\n\nWith Sheet11\n    ctr = 0\n    For i = 4 To LastRow\n\n        If .Cells(i, 18) = \"Closed\" Then\n            If IsError(Application.Match(.Cells(i, 5).Value,  Sheet13.Columns(5), 0)) Then\n                ReDim Preserve MyArray(0 To 2, 0 To ctr)\n                MyArray(0, ctr) = .Cells(i, 5).Value\n                MyArray(1, ctr) = .Cells(i, 6).Value\n                MyArray(2, ctr) = \"Waiting Installation\"\n                ctr = ctr + 1\n            ElseIf Not IsError(Application.Match(.Cells(i, 5).Value, Sheet13.Columns(5), 0)) And Evaluate(\"Sumproduct((sktPCE!e6:e\" &amp; LastRow2 &amp; \"=\"\"\" &amp; _\n                           .Cells(i, 5) &amp; \"\"\")*(sktPCE!u6:u\" &amp; LastRow2 &amp; \"=\"\"In Service\"\"))\") = 0 Then\n                ReDim Preserve MyArray(0 To 2, 0 To ctr)\n                MyArray(0, ctr) = .Cells(i, 5).Value\n                MyArray(1, ctr) = .Cells(i, 6).Value\n                MyArray(2, ctr) = \"Waiting Installation\"\n                ctr = ctr + 1\n            End If\n        End If\n    Next i\nEnd With\nWith UserForm1\n    With .ListBox1\n        .Clear\n        .ColumnHeads = False\n        .ColumnCount = 3\n        .ColumnWidths = \"50;50;50\"\n        .List = Application.WorksheetFunction.Transpose(MyArray)\n        .TopIndex = 0\n    End With\n    .Show\n\n    End With\n    Application.ScreenUpdating = True\n    End Sub\n</code></pre>\n\n<p>The 1st picture is what I said abnormal and it should show the output as the the 2nd picture.</p>\n\n<p>Abnormal output<br>\n<a href=\"https://i.stack.imgur.com/GLvNK.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GLvNK.jpg\" alt=\"Abnormal output\"></a></p>\n\n<p>Desired output<br>\n<a href=\"https://i.stack.imgur.com/DfwtZ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DfwtZ.jpg\" alt=\"Desired output\"></a></p>\n"}, {"tags": ["excel", "vba", "selenium"], "comments": [{"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1556672060, "post_id": 55930409, "comment_id": 98514062, "body": "Use Application.Wait?"}, {"owner": {"reputation": 193, "user_id": 8359901, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EyQWI_rtFGk/AAAAAAAAAAI/AAAAAAAAAB4/vjteD8Ol7m4/photo.jpg?sz=128", "display_name": "Prateek Vishwas", "link": "https://stackoverflow.com/users/8359901/prateek-vishwas"}, "reply_to_user": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1556672297, "post_id": 55930409, "comment_id": 98514112, "body": "@Skin there is no busy/load sign in Chrome. Otherwise I would have used it. Usually the popup appears instantly in less than a second. I want the code to verify if the alert has popped up and only then proceed to clicking on that alert. will any loop work?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1556673077, "post_id": 55930409, "comment_id": 98514250, "body": "You are partially correct that there is no <code>Busy</code> property as there is with <code>InternetExplorerObj.Busy</code>. Fortunately, the ChromeDriver handles this better, within the method itself. Most of your methods and functions, such as <code>FindElementBy...()</code> have an optional <code>Timeout</code> argument. This is essentially now your <code>IE.Busy</code> property, but implemented in a much better way."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1556700236, "post_id": 55930409, "comment_id": 98520031, "body": "Is there a public url we can use to reproduce this? You have a great answer from @K.D\u1d00\u1d20\u026as (+) - but I would like to see what else might be possible."}, {"owner": {"reputation": 193, "user_id": 8359901, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EyQWI_rtFGk/AAAAAAAAAAI/AAAAAAAAAB4/vjteD8Ol7m4/photo.jpg?sz=128", "display_name": "Prateek Vishwas", "link": "https://stackoverflow.com/users/8359901/prateek-vishwas"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556984060, "post_id": 55930409, "comment_id": 98617383, "body": "@QHarr Unfortunatley, I don&#39;t have any public url. The Url we are using is on intranet. the code K.Davis has suggested <code>obj.SwitchToAlert(20).accept</code> is not working at all. Its throwing &#39;Run-Time error 27&#39; NoAlertPresentError no such alert&#39; everytime. When using time!"}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 8359901, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EyQWI_rtFGk/AAAAAAAAAAI/AAAAAAAAAB4/vjteD8Ol7m4/photo.jpg?sz=128", "display_name": "Prateek Vishwas", "link": "https://stackoverflow.com/users/8359901/prateek-vishwas"}, "edited": false, "score": 0, "creation_date": 1556677932, "post_id": 55930461, "comment_id": 98515083, "body": "@K.Davis <code>obj.SwitchToAlert(20).accept</code> is throwing me to my error handler. Is the correct property? or it should be <code>obj.SwitchToAlert(20 = -1).accept</code>?"}, {"owner": {"reputation": 193, "user_id": 8359901, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EyQWI_rtFGk/AAAAAAAAAAI/AAAAAAAAAB4/vjteD8Ol7m4/photo.jpg?sz=128", "display_name": "Prateek Vishwas", "link": "https://stackoverflow.com/users/8359901/prateek-vishwas"}, "edited": false, "score": 0, "creation_date": 1556769913, "post_id": 55930461, "comment_id": 98543685, "body": "@K.Davis Maybe the error is caused because I am closing the alert myself (in debug mode) to check if your suggestion is working! I do not have another way to test it since, the error earlier appeared randomly. I&#39;ll test it on my macro for next couple of days to check if the error re-appears. I&#39;ll mark it as an answer then. Hope that&#39;ll be OK for you."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 193, "user_id": 8359901, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EyQWI_rtFGk/AAAAAAAAAAI/AAAAAAAAAB4/vjteD8Ol7m4/photo.jpg?sz=128", "display_name": "Prateek Vishwas", "link": "https://stackoverflow.com/users/8359901/prateek-vishwas"}, "edited": false, "score": 0, "creation_date": 1556810388, "post_id": 55930461, "comment_id": 98562894, "body": "No rush @PrateekVishwas. Let me know if you need additional assistance."}, {"owner": {"reputation": 193, "user_id": 8359901, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EyQWI_rtFGk/AAAAAAAAAAI/AAAAAAAAAB4/vjteD8Ol7m4/photo.jpg?sz=128", "display_name": "Prateek Vishwas", "link": "https://stackoverflow.com/users/8359901/prateek-vishwas"}, "edited": false, "score": 0, "creation_date": 1556978631, "post_id": 55930461, "comment_id": 98615781, "body": "Hello @K.Davis, I distributed the macro among my team members with wait time parameters in that line i.e. <code>obj.SwitchToAlert(20).accept</code>. However, they still encountered errors at random times. Just when this line should have been executed. They did not take any screenshots though of that error. Can we create a loop to check if the alert is present before the code tries to click on the accept button? I tried <code>AlertChecker: Application.Wait (Now + TimeValue(&quot;0:00:01&quot;)) If verifyAlertPresent = False Then     GoTo AlertChecker End If</code> But didn&#39;t work!!"}, {"owner": {"reputation": 193, "user_id": 8359901, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EyQWI_rtFGk/AAAAAAAAAAI/AAAAAAAAAB4/vjteD8Ol7m4/photo.jpg?sz=128", "display_name": "Prateek Vishwas", "link": "https://stackoverflow.com/users/8359901/prateek-vishwas"}, "edited": false, "score": 0, "creation_date": 1556978799, "post_id": 55930461, "comment_id": 98615835, "body": "It&#39;s stuck in endless loop. If I change the value to True, then it simply jumps to accept the alert code even if the alert is not present."}, {"owner": {"reputation": 193, "user_id": 8359901, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EyQWI_rtFGk/AAAAAAAAAAI/AAAAAAAAAB4/vjteD8Ol7m4/photo.jpg?sz=128", "display_name": "Prateek Vishwas", "link": "https://stackoverflow.com/users/8359901/prateek-vishwas"}, "edited": false, "score": 0, "creation_date": 1556979603, "post_id": 55930461, "comment_id": 98616073, "body": "Hey @K.Davis, I&#39;ve just received an screenshot of the error! It&#39;s &#39;Run-Time error 27&#39; NoAlertPresentError no such alert"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 1, "last_activity_date": 1556672735, "last_edit_date": 1556672735, "creation_date": 1556672394, "answer_id": 55930461, "question_id": 55930409, "link": "https://stackoverflow.com/questions/55930409/wait-until-alert-is-present-in-chrome/55930461#55930461", "title": "Wait until alert is present in Chrome", "body": "<p>There are additional parameters in the <code>SwitchToAlert</code> method that you have overlooked.</p>\n\n<p>The one in particular is the <code>Optional Timeout As long = -1</code> parameter. Set this to a value, such as 20. This means it will wait <em>a maximum time of</em> 20 seconds for your alert to appear, then click accept. If it appears in 5 seconds, you only wait 5 seconds (not the full 20).</p>\n\n<pre><code>obj.SwitchToAlert(20).accept\n</code></pre>\n\n<p>Would be the line you are wanting to use.</p>\n\n<p>When you are using the default value of <code>-1</code>, you are telling this method to use the global default timeout, which is 5 seconds. You can change this global value by changing the <code>obj.Timeouts.ImplicitWait</code> property.</p>\n"}], "owner": {"reputation": 193, "user_id": 8359901, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EyQWI_rtFGk/AAAAAAAAAAI/AAAAAAAAAB4/vjteD8Ol7m4/photo.jpg?sz=128", "display_name": "Prateek Vishwas", "link": "https://stackoverflow.com/users/8359901/prateek-vishwas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1556672735, "creation_date": 1556671930, "last_edit_date": 1556672096, "question_id": 55930409, "link": "https://stackoverflow.com/questions/55930409/wait-until-alert-is-present-in-chrome", "title": "Wait until alert is present in Chrome", "body": "<p>I have an excel macro that enters data into a web-form (usng selenium and web driver). After each submission (by clicking submit button), a popup appears and the macro clicks OK on that alert by running this code line<code>obj.SwitchToAlert.accept</code> to continue the loop . Entire code is working fine. Only problem is sometimes the  alert takes 5-10 seconds to appear. That time the code proceeds to click the button and gives error (as no alert pop up is present yet). </p>\n\n<p>Is there any way that macro can wait until the alert is present before running <code>obj.SwitchToAlert.accept</code>?</p>\n"}, {"tags": ["excel", "vba", "userform", "mousedown"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1556671106, "post_id": 55930196, "comment_id": 98513918, "body": "Creating a class to handle events on runtime created objects is the correct approach,  but you say you&#39;ve tried that.   Show us that code"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556671503, "post_id": 55930196, "comment_id": 98513967, "body": "I clearly remember writing an answer a while back about handling events for dynamic controls, but I could&#39;t find it :("}, {"owner": {"reputation": 165, "user_id": 4665748, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/4203561480178574e4ebe500ee3b88d8?s=128&d=identicon&r=PG&f=1", "display_name": "gavin", "link": "https://stackoverflow.com/users/4665748/gavin"}, "edited": false, "score": 0, "creation_date": 1556673207, "post_id": 55930196, "comment_id": 98514277, "body": "I used the code from this thread <a href=\"https://stackoverflow.com/questions/7466376/how-to-detect-a-mouse-down-on-a-userform-frame-while-the-mouse-is-still-down?rq=1\" title=\"how to detect a mouse down on a userform frame while the mouse is still down\">stackoverflow.com/questions/7466376/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 4665748, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/4203561480178574e4ebe500ee3b88d8?s=128&d=identicon&r=PG&f=1", "display_name": "gavin", "link": "https://stackoverflow.com/users/4665748/gavin"}, "edited": false, "score": 0, "creation_date": 1557068213, "post_id": 55930357, "comment_id": 98634187, "body": "What was missing from your code description was that the label of ControlEvents was to be used to identify the objects such as ControlEvents.Caption and ControlEvents.Value. Before working that out, though the code was working, it wasn&#39;t telling me which OptionButton was being selected. But now it is all good and works fantastically. Thanks a bunch"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 165, "user_id": 4665748, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/4203561480178574e4ebe500ee3b88d8?s=128&d=identicon&r=PG&f=1", "display_name": "gavin", "link": "https://stackoverflow.com/users/4665748/gavin"}, "edited": false, "score": 1, "creation_date": 1557068555, "post_id": 55930357, "comment_id": 98634282, "body": "You can also cast it to <code>MSForms.Control</code> and use the <code>Tag</code> property to hold metadata like an ID - that way the logic isn&#39;t dependent on a caption, which in other scenarios might need to be localized: avoiding to use UI-only stuff (like a caption) like metadata (e.g. a unique ID) helps separate concerns and makes things more robust as a whole. Cheers!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1556671358, "creation_date": 1556671358, "answer_id": 55930357, "question_id": 55930196, "link": "https://stackoverflow.com/questions/55930196/detect-mouse-down-event-on-dynamic-objects-in-a-userform/55930357#55930357", "title": "Detect mouse down event on dynamic objects in a userform", "body": "<p>You need to wrap your controls in a class module - say, <code>DynamicOptionButton</code>:</p>\n\n<pre><code>Option Explicit\nPrivate WithEvents ControlEvents As MSForms.OptionButton\n\nPublic Sub Initialize(ByVal ctrl As MSForms.OptionButton)\n    If Not ControlEvents Is Nothing Then ThrowAlreadyInitialized\n    Set ControlEvents = ctrl\nEnd Property\n\nPrivate Property Get AsControl() As MSForms.Control\n    Set AsControl = ControlEvents\nEnd Property\n\nPrivate Sub ThrowAlreadyInitialized()\n    Err.Raise 5, TypeName(Me), \"Invalid Operation: This control is already initialized.\"\nEnd Sub\n\nPrivate Sub ControlEvents_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)\n    Dim parentForm As UserForm1 'todo: use your actual UserForm subtype\n    Set parentForm = AsControl.Parent \n    'handle mousedown here.\nEnd Sub\n</code></pre>\n\n<p>When you create the dynamic controls, you'll want a <strong>module-level</strong> <code>Collection</code> to hold the <code>DynamicOptionButton</code> instances - otherwise they'll <strong>go out of scope</strong> when <code>End Sub</code> is reached, and you'll never be able to handle any of their events.</p>\n\n<pre><code>Private DynamicControls As Collection\n\nPrivate Sub Class_Initialize()\n    Set DynamicControls = New Collection\n    'todo invoke CreateOptionButton\nEnd Sub\n\nPrivate Sub CreateOptionButton() 'todo parameterize\n    Dim ctrl As MSForms.OptionButton\n    Set ctrl = Me.Controls.Add(...)\n\n    Dim wrapper As DynamicOptionButton\n    Set wrapper = New DynamicOptionButton\n    wrapper.Initialize ctrl\n\n    DynamicControls.Add wrapper\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 4665748, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/4203561480178574e4ebe500ee3b88d8?s=128&d=identicon&r=PG&f=1", "display_name": "gavin", "link": "https://stackoverflow.com/users/4665748/gavin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 2, "accepted_answer_id": 55930357, "answer_count": 1, "score": 1, "last_activity_date": 1556671358, "creation_date": 1556669861, "question_id": 55930196, "link": "https://stackoverflow.com/questions/55930196/detect-mouse-down-event-on-dynamic-objects-in-a-userform", "title": "Detect mouse down event on dynamic objects in a userform", "body": "<p>I have a dynamic range of OptionButtons within a frame in a Userform. The number of OptionButtons  vary according to number of columns in a table. Each button is labeled according the column label. When a person selects an option I need a ListBox to be populated with the items found within that table column. \nPopulating the option buttons and ListBox is easy enough. I know how to detect mouse down events on known Userformobjects. But the buttons exist only through coding and vary. How do I detect MouseDown on an object that doesn't actually exist?\nI have tried the code for creating a MouseDown Class for a Frame</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1556668250, "post_id": 55929983, "comment_id": 98513410, "body": "The easiest way to figure out how to do this is to first make sure that Word can see your fonts (open a new document, select one of your fonts, type in some text to see that font working). Once you&#39;ve done that, then using the same document, record a macro of selecting some text and changing the font to one of your custom fonts. Stop recording, and then open the macro dialog and edit the macro you just created. The code that Word generated is a good base for you to use in your own code."}, {"owner": {"reputation": 41, "user_id": 11434995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e70ef0cfe2f258eea980d412e496350f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Liiceanu", "link": "https://stackoverflow.com/users/11434995/stefan-liiceanu"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1556668544, "post_id": 55929983, "comment_id": 98513463, "body": "Thank you. I see, your solution implies that somehow a blank new Word document created with VBA does not see the custom fonts, while a document in which I used a custom font will &quot;know&quot;. Kind of a &quot;vaccine&quot;. Hmmm, but that means I have to refer to a saved document, so I cannot create one from scratch. I will try that. But it is bizarre, the fact that the font is saved in Fonts, works properly in Word when used, has a clear name, but when I try to use that name VBA does not see it. I should add that I&#39;ve been programming VBA for 10 years...but am new to Word. Best."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1556668706, "post_id": 55929983, "comment_id": 98513503, "body": "None of what you just wrote applies. The test with the new, blank Word document (created as usual from the Word menu) simply validates that the fonts are properly installed and available to Word. Recording the macro generates the code that you can copy/paste into your actual document and use as a basis for writing your own code. If you can record a macro that sets the font properly, you can use it in your code. If you can&#39;t, then the font is not properly installed and you need to resolve that issue before moving on to trying to use it in VBA."}, {"owner": {"reputation": 41, "user_id": 11434995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e70ef0cfe2f258eea980d412e496350f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Liiceanu", "link": "https://stackoverflow.com/users/11434995/stefan-liiceanu"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1556668898, "post_id": 55929983, "comment_id": 98513535, "body": "I just tried your idea. Unfortunately it does not work. I opened a blank Word document. I turned on the macro recorder. Then I type some Japanese text, switching to a custom font. Clearly, the recorder identified the font name properly. But when I used that very font name in my original code, it failed to appear, still the default Office Asian font. Drives me crazy. Thank you anyway."}, {"owner": {"reputation": 41, "user_id": 11434995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e70ef0cfe2f258eea980d412e496350f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Liiceanu", "link": "https://stackoverflow.com/users/11434995/stefan-liiceanu"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1556669076, "post_id": 55929983, "comment_id": 98513575, "body": "In which case, it remains that the font is not properly installed as you said. But what does that mean? It is in my Windows\\Fonts folder, it appears in the drop-down menu in all Office applications. Does not that mean it is &quot;properly installed&quot;?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1556669207, "post_id": 55929983, "comment_id": 98513593, "body": "If it appears in the Word fonts menu, and a macro can record it and put the name in VBA code generated by recording that macro, it works, and will work in your own document. I can&#39;t tell you what you&#39;re doing wrong, because I can&#39;t see what you&#39;re doing. I can tell you I&#39;ve used code generated by the macro editor literally hundreds of times to get information used in my own code without issues other than my own mistakes."}, {"owner": {"reputation": 41, "user_id": 11434995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e70ef0cfe2f258eea980d412e496350f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Liiceanu", "link": "https://stackoverflow.com/users/11434995/stefan-liiceanu"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1556670140, "post_id": 55929983, "comment_id": 98513749, "body": "I fully agree with you, if it works with the macro recorder that it must work any other way. I found a solution, and it baffles me why it works. Here is the solution. I define the font name first. Then I insert the text. Then I define the font name again. Only like this it worked. It did not work defining the font first and adding the text next, or vice-versa. So I am happy it works, but surely something is wrong with Word."}, {"owner": {"reputation": 41, "user_id": 11434995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e70ef0cfe2f258eea980d412e496350f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Liiceanu", "link": "https://stackoverflow.com/users/11434995/stefan-liiceanu"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1556670153, "post_id": 55929983, "comment_id": 98513754, "body": "Here is the code:"}, {"owner": {"reputation": 41, "user_id": 11434995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e70ef0cfe2f258eea980d412e496350f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Liiceanu", "link": "https://stackoverflow.com/users/11434995/stefan-liiceanu"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1556670159, "post_id": 55929983, "comment_id": 98513756, "body": "Wrd_Doc.Shapes(&quot;shpTwo&quot;).TextFrame.TextRange.Font.Name = &quot;aoyagireisyosimo2&quot; Wrd_Doc.Shapes(&quot;shpTwo&quot;).TextFrame.TextRange.Text = Second_Text Wrd_Doc.Shapes(&quot;shpTwo&quot;).TextFrame.TextRange.Font.Name = &quot;aoyagireisyosimo2&quot; Wrd_Doc.Shapes(&quot;shpTwo&quot;).TextFrame.TextRange.Font.Size = 14"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1556670236, "post_id": 55929983, "comment_id": 98513770, "body": "Right. Something is wrong with Word. It&#39;s only been around for a couple of decades, been used by literally billions of people, and because you can&#39;t get a font to work it must be Word that is defective. :-)"}, {"owner": {"reputation": 41, "user_id": 11434995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e70ef0cfe2f258eea980d412e496350f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Liiceanu", "link": "https://stackoverflow.com/users/11434995/stefan-liiceanu"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1556670243, "post_id": 55929983, "comment_id": 98513773, "body": "Thank you for your idea, it did help in the end."}, {"owner": {"reputation": 41, "user_id": 11434995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e70ef0cfe2f258eea980d412e496350f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Liiceanu", "link": "https://stackoverflow.com/users/11434995/stefan-liiceanu"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1556670280, "post_id": 55929983, "comment_id": 98513781, "body": "Then how do you explain this?"}], "owner": {"reputation": 41, "user_id": 11434995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e70ef0cfe2f258eea980d412e496350f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Liiceanu", "link": "https://stackoverflow.com/users/11434995/stefan-liiceanu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1573924186, "creation_date": 1556667719, "last_edit_date": 1573924186, "question_id": 55929983, "link": "https://stackoverflow.com/questions/55929983/using-custom-fonts-non-ms-office-for-word-vba", "title": "Using custom fonts (non-MS Office) for Word VBA", "body": "<p>I have installed some custom Asian fonts in the Windows/Fonts folder. I am writing a code that reads some item names (just a plain string, ABC, but in Japanese) from MS-Excel cells, then pastes them in a text box in a new MS-Word document. The problem is that I can't use my custom fonts (these are <code>TTF</code> files) to format the text in MS-Word. </p>\n\n<p>I tried to name the font with <code>.ttf</code> in the end, besides simply referring to its name as it appears in the drop-down menu in MS-Word.</p>\n\n<pre><code>Wrd_Doc.Shapes(\"shpTwo\").TextFrame.TextRange.Font.Name = \"ShigotoMemogaki Regular\"\n</code></pre>\n\n<p>It refers to a text box named <code>shpTwo</code>. I pasted some text there and I want it to look like this custom font, named <code>ShigotoMemogaki Regular</code>. This font is saved in my Fonts folder, it works in MS-Word when I use it, but somehow the code does not recognize it, and instead, it uses the default Office Asian font, which is <code>MSMincho</code>.</p>\n\n<p>So the text is clearly copied from MS-Excel, it is in the newly created text box in a new Word document, but it's not in the font I need.</p>\n"}, {"tags": ["excel", "vba", "for-loop"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11167470, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vjDHh3PG444/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfynqfBAKwZw9EVdqGcNZmRvs_yEw/mo/photo.jpg?sz=128", "display_name": "Albert Pollard", "link": "https://stackoverflow.com/users/11167470/albert-pollard"}, "edited": false, "score": 0, "creation_date": 1556668177, "post_id": 55929931, "comment_id": 98513400, "body": "My votes aren&#39;t counted but that solved the issue! So, using the WS. before the object is the key?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 35, "user_id": 11167470, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vjDHh3PG444/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfynqfBAKwZw9EVdqGcNZmRvs_yEw/mo/photo.jpg?sz=128", "display_name": "Albert Pollard", "link": "https://stackoverflow.com/users/11167470/albert-pollard"}, "edited": false, "score": 0, "creation_date": 1556668903, "post_id": 55929931, "comment_id": 98513536, "body": "You should always try to qualify all of your <code>Range()</code> or <code>Cells()</code> with a specific worksheet object, otherwise your code can be prone to bugs which might be difficult to track down. See for example: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/28439376/what-is-the-default-scope-of-worksheets-and-cells-and-range/28439984#28439984\" title=\"what is the default scope of worksheets and cells and range\">stackoverflow.com/questions/28439376/&hellip;</a>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1556667233, "creation_date": 1556667233, "answer_id": 55929931, "question_id": 55929837, "link": "https://stackoverflow.com/questions/55929837/error-in-looping-through-sheets-returns-object-variable-or-with-block-variable/55929931#55929931", "title": "Error in looping through sheets. Returns Object Variable or With Block variable not set", "body": "<p>Something like this should work - note it's best to avoid ActiveSheet/ActiveCell etc</p>\n\n<pre><code>Dim WS As Worksheet \n\nFor Each WS In Worksheets\n    For i = WS.Cells(WS.Rows.Count, \"A\").End(xlUp).Row To 16 Step -1\n        If WS.Cells(i, 1) = \"Actual:\" Or WS.Cells(i, 1) = \"\" Then\n            'Delete Rows containing Actual: or empty rows\n             WS.Rows(i).EntireRow.Delete\n        End If\n    Next i\nNext WS\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11167470, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vjDHh3PG444/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfynqfBAKwZw9EVdqGcNZmRvs_yEw/mo/photo.jpg?sz=128", "display_name": "Albert Pollard", "link": "https://stackoverflow.com/users/11167470/albert-pollard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556779280, "creation_date": 1556666437, "last_edit_date": 1556779280, "question_id": 55929837, "link": "https://stackoverflow.com/questions/55929837/error-in-looping-through-sheets-returns-object-variable-or-with-block-variable", "title": "Error in looping through sheets. Returns Object Variable or With Block variable not set", "body": "<p>I loop thorough the sheets successfully until the last sheet where I get the Object Variable error and a Subscript out of range error.</p>\n\n<p>I believe the issue may be in the ActiveSheet.Next.Select when it runs out of worksheets. (see code).\nI have tried several loop methods using codes from here and other sites with no success.\nI can't use ThisWorkbook because the loop is being done on another workbook.</p>\n\n<pre><code>Dim WS As Worksheet\n\n   For Each WS In Worksheets\n\n       LastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n       For i = LastRow To 16 Step -1\n                If Cells(i, 1) = \"Actual:\" Or Cells(i, 1) = \"\" Then\n                'Delete Rows containing Actual: or empty rows\n                Rows(i).EntireRow.Delete\n            End If\n        Next i\n        ActiveSheet.Next.Select\n\n   Next WS\n</code></pre>\n\n<p>This completes preparing the workbook to copy the remaining lines, which is in another procedure.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1556669997, "post_id": 55929846, "comment_id": 98513728, "body": "I suspect the OP want to check only visible cells in a row (in case some columns are hidden),  in which case use Aggregate to do the count.  Otherwise,  good answer"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1556671870, "post_id": 55929846, "comment_id": 98514029, "body": "Thanks for the heads up @chrisneilsen. I believe <code>Aggregate</code> can only be used to exclude hidden rows (not columns). I will post an edit shortly."}, {"owner": {"reputation": 11, "user_id": 6227711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128ed4a1c8300d75bb0de59701cc49fe?s=128&d=identicon&r=PG&f=1", "display_name": "jusrleb1", "link": "https://stackoverflow.com/users/6227711/jusrleb1"}, "edited": false, "score": 0, "creation_date": 1556689153, "post_id": 55929846, "comment_id": 98517104, "body": "Thanks Chris Neilsen and K.Davis.  Please note that the entire row will never be completely blank.  As mentioned above, columns (A:G) will always have values in them.  I only want to evaluate the values in each visible row for columns (H:BN). Remember, I have already hidden all of the necessary columns at this point, so of the original 59 columns, it is possible that only 7 columns remain visible.  I only want to evaluate the values in the 7 visible columns for each row, and if those 7 visible columns are blank, then I want to hide that row and move the next row, and repeat until the end."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 11, "user_id": 6227711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128ed4a1c8300d75bb0de59701cc49fe?s=128&d=identicon&r=PG&f=1", "display_name": "jusrleb1", "link": "https://stackoverflow.com/users/6227711/jusrleb1"}, "edited": false, "score": 0, "creation_date": 1556721437, "post_id": 55929846, "comment_id": 98528653, "body": "@jusrleb1 Take a look at the update at the bottom of the answer."}, {"owner": {"reputation": 11, "user_id": 6227711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128ed4a1c8300d75bb0de59701cc49fe?s=128&d=identicon&r=PG&f=1", "display_name": "jusrleb1", "link": "https://stackoverflow.com/users/6227711/jusrleb1"}, "edited": false, "score": 0, "creation_date": 1556722455, "post_id": 55929846, "comment_id": 98529205, "body": "@K.D\u1d00\u1d20\u026as - thanks for the update.  One more issue, and this is my fault because I forgot to mention.  I do not want to evaluate Rows(1:4).  The row evaluation needs to start at Row 5, and then go to the end of the sheet."}, {"owner": {"reputation": 11, "user_id": 6227711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128ed4a1c8300d75bb0de59701cc49fe?s=128&d=identicon&r=PG&f=1", "display_name": "jusrleb1", "link": "https://stackoverflow.com/users/6227711/jusrleb1"}, "edited": false, "score": 0, "creation_date": 1556723248, "post_id": 55929846, "comment_id": 98529598, "body": "@K.D\u1d00\u1d20\u026as - I was able to edit your revised code and get it start at row 5.   <code>Set srcRng = ws.Rows(&quot;5:&quot; &amp; ws.Cells(ws.Rows.Count, 1).End(xlUp).Row)</code>  I am now noticing that it does not evaluate the last row of the sheet.  How do I fix that?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 11, "user_id": 6227711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128ed4a1c8300d75bb0de59701cc49fe?s=128&d=identicon&r=PG&f=1", "display_name": "jusrleb1", "link": "https://stackoverflow.com/users/6227711/jusrleb1"}, "edited": false, "score": 0, "creation_date": 1556723318, "post_id": 55929846, "comment_id": 98529633, "body": "@jusrleb1 Does the last row have a value in column A? The <code>1</code> in <code>ws.Cells(ws.Rows.Count, 1)</code> refers to column A when it checks for the last row."}, {"owner": {"reputation": 11, "user_id": 6227711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128ed4a1c8300d75bb0de59701cc49fe?s=128&d=identicon&r=PG&f=1", "display_name": "jusrleb1", "link": "https://stackoverflow.com/users/6227711/jusrleb1"}, "edited": false, "score": 1, "creation_date": 1556724217, "post_id": 55929846, "comment_id": 98530128, "body": "@K.D\u1d00\u1d20\u026as It does not.  Use column D, it has a value in each row.  Changed it to a 4.  <code>Set srcRng = ws.Rows(&quot;5:&quot; &amp; ws.Cells(ws.Rows.Count, 4).End(xlUp).Row)</code>.  Works perfectly!  Thank you."}, {"owner": {"reputation": 11, "user_id": 6227711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128ed4a1c8300d75bb0de59701cc49fe?s=128&d=identicon&r=PG&f=1", "display_name": "jusrleb1", "link": "https://stackoverflow.com/users/6227711/jusrleb1"}, "edited": false, "score": 0, "creation_date": 1556803140, "post_id": 55929846, "comment_id": 98558639, "body": "@K.D\u1d00\u1d20\u026as can you also help me with this last step: [link]<a href=\"https://stackoverflow.com/questions/55943013/how-do-i-print-save-only-the-visible-columns-and-rows-to-an-xlsx-file-in-vba\" title=\"how do i print save only the visible columns and rows to an xlsx file in vba\">stackoverflow.com/questions/55943013/&hellip;</a>"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 2, "last_activity_date": 1556721362, "last_edit_date": 1556721362, "creation_date": 1556666528, "answer_id": 55929846, "question_id": 55929746, "link": "https://stackoverflow.com/questions/55929746/how-to-hide-row-if-all-visible-cells-in-cell-range-are-blank-in-vba-for-excel/55929846#55929846", "title": "How to hide row if all visible cells in cell range are blank in VBA for Excel?", "body": "<p>You can use the pre-built <code>CountA()</code> worksheet function to count the number of cells that have data in them. This count will return a value of <code>0</code> if the entire row is blank.</p>\n\n<p>I would use <code>UsedRange</code> so you are not unnecessarily counting past your data. I would also union ranges to be hidden and hide them all at once, instead of one at a time for better performance.</p>\n\n<pre><code>Sub HideRows()\n\n    Dim r As Range, hideRng As Range\n\n    For Each r In ActiveSheet.UsedRange.Rows\n        If Application.CountA(r.EntireRow) = 0 Then\n            If hideRng Is Nothing Then\n                Set hideRng = r.EntireRow\n            Else\n                Set hideRng = Application.Union(hideRng, r.EntireRow)\n            End If\n        End If\n    Next r\n\n    If not hideRng is nothing then hideRng.EntireRow.Hidden = True\n\nEnd Sub\n</code></pre>\n\n<p>You don't need to overcomplicate the unhiding of the rows. This will unhide your rows without looping.</p>\n\n<pre><code>Sub UnHideRows()\n\n    ActiveSheet.Cells.EntireRow.Hidden = False\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Thanks to Chris Neilsen pointing out that you may have only wanted to check if the visible columns had any data, you can use this in place of the first code:</p>\n\n<pre><code>Sub HideRows()\n\n    Dim r As Range, hideRng As Range\n\n    UnHideRows\n\n    For Each r In ActiveSheet.UsedRange.Rows\n        If Application.CountA(r.EntireRow.SpecialCells(xlCellTypeVisible)) = 0 Then\n            If hideRng Is Nothing Then\n                Set hideRng = r.EntireRow\n            Else\n                Set hideRng = Application.Union(hideRng, r.EntireRow)\n            End If\n        End If\n    Next r\n\n    If Not hideRng Is Nothing Then hideRng.EntireRow.Hidden = True\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<hr>\n\n<hr>\n\n<p>Per OP's response of only wanting to look in the visible rows between the columns of <code>H:BN</code>, you can use the following to accomplish this:</p>\n\n<pre><code>Sub HideRows()\n\n    Dim srcRng As Range, ws As Worksheet\n    Set ws = ActiveSheet\n    Set srcRng = ws.Rows(\"1:\" &amp; ws.Cells(ws.Rows.Count, 1).End(xlUp).Row)\n\n    UnHideRows\n\n    Dim r As Range, hideRng As Range\n    For Each r In srcRng\n        If Application.CountA(r.Columns(\"H:BN\").SpecialCells(xlCellTypeVisible)) = 0 Then\n            If hideRng Is Nothing Then\n                Set hideRng = r.EntireRow\n            Else\n                Set hideRng = Application.Union(hideRng, r.EntireRow)\n            End If\n        End If\n    Next r\n\n    If Not hideRng Is Nothing Then hideRng.EntireRow.Hidden = True\n\nEnd Sub\n</code></pre>\n\n<p>In this function, I went ahead and created a new Range variable <code>srcRng</code>, because using the <code>Columns()</code> function with <code>UsedRange</code> can sometimes cause issues. Since we are no longer using <code>UsedRange</code>, we are now finding the last use row with <code>ws.Cells(ws.Rows.Count, 1).End(xlUp).Row</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 6227711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128ed4a1c8300d75bb0de59701cc49fe?s=128&d=identicon&r=PG&f=1", "display_name": "jusrleb1", "link": "https://stackoverflow.com/users/6227711/jusrleb1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1590, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1556779269, "creation_date": 1556665760, "last_edit_date": 1556779269, "question_id": 55929746, "link": "https://stackoverflow.com/questions/55929746/how-to-hide-row-if-all-visible-cells-in-cell-range-are-blank-in-vba-for-excel", "title": "How to hide row if all visible cells in cell range are blank in VBA for Excel?", "body": "<p>I am running some VBA macros in my Excel spreadsheet to help me eliminate irrelevant data from view to then allow me to export/copy a subset of the overall set of data I have.  My spreadsheet size is Columns(A:BN) and Rows(1:4693), which I would imagine is a decent size data set. Columns(A:G) will always remain visible.  I'm only interested in hiding what is in Columns(H:BN).  </p>\n\n<p>First, If I want to keep the column in view, I set the column value to \"Y\", then I click the 'Hide Columns\" button. I do this by attaching this subroutine to a button: </p>\n\n<pre><code>Sub Hidecolumn()\nDim p As Range\n    For Each p In Range(\"H1:BN1\").Cells\n        If p.Value = \"N\" Then\n            p.EntireColumn.Hidden = True          \n        End If\n    Next p  \nEnd Sub\n</code></pre>\n\n<p>This works perfectly.</p>\n\n<p>I also have a \"Show All Columns\" button to have all of the hidden columns reappear, and I do this with:</p>\n\n<pre><code>Sub Unhidecolumn()\nDim p As Range\n    For Each p In Range(\"H1:BN1\").Cells\n        If p.Value = \"Y\" Or p.Value = \"N\" Then\n            p.EntireColumn.Hidden = False    \n        End If\n    Next p   \nEnd Sub\n</code></pre>\n\n<p>Now that I have the columns I want, now I need to hide all of the unwanted rows. Each cell will have a \"Y\" in it if that row-column relationship exist. It will be blank if there is no relationship.  I want to hide all rows where all of the visible cells in the cell range are blank.  ALL CELLS in the cell range must be blank. </p>\n\n<p>Once I've hidden all of the unwanted rows, then I can copy the remaining/visible data and copy it to a new workbook to share with others, because they only need the data relevant to them.  </p>\n\n<p>Finally, just like I am able to unhide all of the hidden columns, I need to also be able to unhide all of the hidden rows. </p>\n\n<p>In the end, I want 4 buttons on my sheet.<br>\n1. Hide Columns\n2. Unhide Columns\n3. Hide Rows\n4. Unhide Rows</p>\n\n<p>I already have the first 2, now I need the last 2.  Please help.</p>\n\n<p>UPDATE: SOLUTION - Thank you @K.Davis!</p>\n\n<pre><code>Sub HideRowsSecond()\n\n    Dim srcRng As Range, ws As Worksheet\n    Set ws = ActiveSheet\n    Set srcRng = ws.Rows(\"5:\" &amp; ws.Cells(ws.Rows.Count, 4).End(xlUp).Row)\n\n    Dim R As Range, hideRng As Range\n    For Each R In srcRng\n        If Application.CountA(R.Columns(\"H:BN\").SpecialCells(xlCellTypeVisible)) = 0 Then\n            If hideRng Is Nothing Then\n                Set hideRng = R.EntireRow\n            Else\n                Set hideRng = Application.Union(hideRng, R.EntireRow)\n            End If\n        End If\n    Next R\n\n    If Not hideRng Is Nothing Then hideRng.EntireRow.Hidden = True\n    MsgBox (\"Complete\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "formula", "numeric", "counting"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1556665780, "post_id": 55929474, "comment_id": 98512943, "body": "Can you <a href=\"https://stackoverflow.com/posts/55929474/edit\">edit</a> your question with additional information? I am not really understanding what you need exactly."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556670526, "post_id": 55929474, "comment_id": 98513823, "body": "You can do this in one line: <code>Sheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C12:C15000&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C19&quot;).Value</code>  PS your use of Rows is a little confusing here - worksheets have &quot;rows&quot;, whereas code has &quot;lines&quot;"}, {"owner": {"reputation": 1, "user_id": 11018839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5992a4017d0b8bd535c2d01e1d64063f?s=128&d=identicon&r=PG&f=1", "display_name": "Cpilot", "link": "https://stackoverflow.com/users/11018839/cpilot"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556673896, "post_id": 55929474, "comment_id": 98514395, "body": "@Tim - Thank you for clarifying the language for me.  I am just learning about this stuff.  I have followed a couple forums and have been trying to read as much as possible.  I was asked to try to learn some basics.  I have edited my question once again.  I have added more lines.  I tried to create a series of lines that would truncate what I am transferring with the Macro. I see what you did with your example line.  I think I have an idea for how to utilize fewer lines (thanks to you).  If you have a minute, please check out my edit and see if you agree with my changes (Suggestions Welcome)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11018839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5992a4017d0b8bd535c2d01e1d64063f?s=128&d=identicon&r=PG&f=1", "display_name": "Cpilot", "link": "https://stackoverflow.com/users/11018839/cpilot"}, "edited": false, "score": 0, "creation_date": 1556679315, "post_id": 55930904, "comment_id": 98515265, "body": "Tim - You are the man! Thank you very much.  Do you know of any good sources I can utilize to learn more about Excel VBA coding?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 11018839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5992a4017d0b8bd535c2d01e1d64063f?s=128&d=identicon&r=PG&f=1", "display_name": "Cpilot", "link": "https://stackoverflow.com/users/11018839/cpilot"}, "edited": false, "score": 0, "creation_date": 1556680495, "post_id": 55930904, "comment_id": 98515470, "body": "I like books when learning something new, but realize that&#39;s a bit old-school these days.  I started with the Excel 95 (!) version of this one - <a href=\"https://rads.stackoverflow.com/amzn/click/com/1119067723\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">amazon.com/Excel-Power-Programming-Spreadsheets-Bookshelf/dp&zwnj;&#8203;/&hellip;</a>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1556677250, "creation_date": 1556677250, "answer_id": 55930904, "question_id": 55929474, "link": "https://stackoverflow.com/questions/55929474/auto-fill-consecutive-numerals-within-text-for-many-consecutive-rows/55930904#55930904", "title": "Auto-Fill Consecutive Numerals Within Text for Many Consecutive Rows", "body": "<p>You can use a loop for this:</p>\n\n<pre><code>Dim i As Long, rngDest As Range, rngSource As Range\n\nSet rngDest = Sheets(\"ENTR Ext Budget\").Range(\"C12:C21\")\nSet rngSrc = Sheets(\"BPC-SAP Grant Upload\").Range(\"C19\")\n\nFor i=1 to 100 'for example\n\n    rngDest.Value = rngSrc.Value\n\n    Set rngDest = rngDest.Offset(10, 0) 'move destination down 10 rows\n    Set rngSrc = rngSrc.Offset(1, 0)    'move source down 1 row\n\n    'not sure if this is what you meant...\n    If rngSrc.Row = 250 then \n        Set rngSrc = Sheets(\"BPC-SAP Grant Upload\").Range(\"C19\")\n    End if\nNext i\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11018839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5992a4017d0b8bd535c2d01e1d64063f?s=128&d=identicon&r=PG&f=1", "display_name": "Cpilot", "link": "https://stackoverflow.com/users/11018839/cpilot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1607589406, "creation_date": 1556663514, "last_edit_date": 1607589406, "question_id": 55929474, "link": "https://stackoverflow.com/questions/55929474/auto-fill-consecutive-numerals-within-text-for-many-consecutive-rows", "title": "Auto-Fill Consecutive Numerals Within Text for Many Consecutive Rows", "body": "<p>I need the numerals contained/mixed within row text to count consecutively as I duplicate the rows.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C12&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C62&quot;).Value\nSheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C13&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C62&quot;).Value\nSheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C...&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C62&quot;).Value\nSheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C15000&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C62&quot;).Value\n</code></pre>\n<p>e.g.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C4660&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C19&quot;).Value\nSheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C4661&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C19&quot;).Value\nSheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C4662&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C19&quot;).Value\nSheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C4663&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C19&quot;).Value\n</code></pre>\n<p>It is the &quot;C466*&quot; value that I would like to autofill with consecutive gains. I cannot find any help on other forums.</p>\n<p>Further Explanation</p>\n<ul>\n<li><p>In the Rows (as seen below) the Value &quot;(&quot;C4660&quot;), (&quot;C4661&quot;), (&quot;C4662&quot;), (&quot;C4663&quot;), etc.), is contained in each Row.  This (&quot;C*&quot;) references the cell which will have data from another sheet transferred into.</p>\n</li>\n<li><p>I am just beginning to write the macros and I am looking for an efficient way to duplicate these rows but with the (&quot;C*&quot;) value gaining by one in each consecutive row. I am trying to avoid having to touch every row.</p>\n</li>\n<li><p>My very First (&quot;C*&quot;) value is (&quot;C12&quot;). My final (&quot;C*&quot;) value needs to be roughly (&quot;C15000&quot;).</p>\n</li>\n<li><p>The Value of (&quot;C19&quot;) in each row does also have to change.  With Tim's suggestion, I have reduced the lines.  I added a more detailed example of what I have come up with.  When the (&quot;C19&quot;) value gets to (&quot;C250&quot;), I have to circle back to the top.</p>\n</li>\n</ul>\n<p>The lines I have added should show more of how I have to structure it.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C12:C21&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C19&quot;).Value\nSheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C22:C31&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C20&quot;).Value\nSheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C32:C41&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C21&quot;).Value\nSheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C42:C51&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C22&quot;).Value\nSheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C52:C61&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C23&quot;).Value\nSheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C62:C71&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C24&quot;).Value\nSheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C72:C81&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C25&quot;).Value\nSheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C82:C91&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C26&quot;).Value\nSheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C92:C101&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C27&quot;).Value\nSheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C102:C111&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C28&quot;).Value\nSheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C112:C121&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C29&quot;).Value\nSheets(&quot;ENTR Ext Budget&quot;).Range(&quot;C122:C131&quot;).Value = Sheets(&quot;BPC-SAP Grant Upload&quot;).Range(&quot;C30&quot;).Value\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556665641, "post_id": 55929219, "comment_id": 98512922, "body": "Look for OpenArgs, you can provide passing arguments when opening form. These arguments are processed in Form_Open or Form_Load event, and then you can write proper code, or define the source opening form"}], "answers": [{"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 0, "last_activity_date": 1556674260, "creation_date": 1556674260, "answer_id": 55930626, "question_id": 55929219, "link": "https://stackoverflow.com/questions/55929219/how-can-i-open-the-same-form-with-two-different-buttons-from-two-different-forms/55930626#55930626", "title": "How can I open the same form with two different buttons from two different forms and know which button was clicked?", "body": "<p>Couldn't you have the opening routine within Form1 and call it from your other forms, passing in the sender as a parameter? As below:</p>\n\n<p><strong>Userform1</strong></p>\n\n<pre><code>Private mSender As MSForms.UserForm\nPublic Sub OpenForm(sender As MSForms.UserForm)\n    Set mSender = sender\n    Me.Show\nEnd Sub\n</code></pre>\n\n<p><strong>Userform3</strong></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    UserForm1.OpenForm Me\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 3155631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a0672d6b4c83f8102e07575c894cdc?s=128&d=identicon&r=PG&f=1", "display_name": "Jasson C", "link": "https://stackoverflow.com/users/3155631/jasson-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 55930626, "answer_count": 1, "score": 0, "last_activity_date": 1556779247, "creation_date": 1556661872, "last_edit_date": 1556779247, "question_id": 55929219, "link": "https://stackoverflow.com/questions/55929219/how-can-i-open-the-same-form-with-two-different-buttons-from-two-different-forms", "title": "How can I open the same form with two different buttons from two different forms and know which button was clicked?", "body": "<p>I have a form (form1) that I use to create a new record in a sheet when I open it from form2. I would like to open the same form (form1), but from another form (form3) to update the info that I have already entered. </p>\n\n<p>How can I know from with form did I opened the form1 so I can decide if it will come clean or with info to update?</p>\n\n<p>I've tried creating a public variable in each form to save which button was clicked and a select case decide the state of the form but this approach doesn't seem very maintainable.</p>\n"}, {"tags": ["excel", "xml", "vba"], "comments": [{"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556661841, "post_id": 55929115, "comment_id": 98512044, "body": "If you mean than &quot;,&quot; should be decimal delimiter as &quot;.&quot; you can try change locale settings to corresponding. E.g. Russia, where decimal delimiter is &quot;,&quot;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1556661852, "post_id": 55929115, "comment_id": 98512048, "body": "Try <code>strLimitLow = Replace(xml.SelectSingleNode(&quot;&#47;LimitLow&quot;).Text, &quot;,&quot;, &quot;.&quot;)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6702507"}, "edited": false, "score": 0, "creation_date": 1556663154, "post_id": 55929115, "comment_id": 98512377, "body": "Sorry I didn&#39;t mention, I&#39;m from Germany, it&#39;s normal that we use &quot;,&quot; as decimal limiter.  The Replace option works for LimitLow &amp; LimitHigh, thanks, but for the Value it gets me &quot;Error 13 type mismatch&quot; if the Value is text not number"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556663287, "post_id": 55929115, "comment_id": 98512413, "body": "Yes I figured it was a locale-specific thing.  I&#39;m not sure why it would error if the <code>value</code> is text though - on which line do you see that error ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6702507"}, "edited": false, "score": 0, "creation_date": 1556664303, "post_id": 55929115, "comment_id": 98512645, "body": "Oh I&#39;m so sorry, it actually works perfectly, I had still something wrong from a previous try ... Thanks for the quick help, you&#39;re a legend!"}], "owner": {"user_type": "does_not_exist", "display_name": "user6702507"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556661168, "creation_date": 1556661168, "question_id": 55929115, "link": "https://stackoverflow.com/questions/55929115/get-number-value-read-out-of-xml-to-excel-spreadsheet-with-decimal-places", "title": "Get number value read out of xml to excel spreadsheet with decimal places", "body": "<p>I'm reading in XML files to an excel spreadsheet. I already have the code to import all data I need. The problem is, if the value I read out is a number, which is in this format \"3,090\" then I get only 3090 in my spreadsheet. Should be 3,090 as in my data.</p>\n\n<pre><code>Dim strLimitHigh As String, strLimitLow As String, strValue As String\n\nstrLimitLow = xml.SelectSingleNode(\"/LimitLow\").Text\nstrLimitHigh = xml.SelectSingleNode (\"/LimitHigh\").Text\nstrValue = xml.SelectSingleNode (\"/Value\").Text\n\nActiveWorksheet.Cells(Rows.Count \"A\").End(xlUp).Offset(1,0).Resize(1,15).Value = Array(strLimitLow, strLimitHigh, strValue)\n</code></pre>\n\n<p>When step through my code, the mouse over tells that strLimitLow is 3,090 as it's in the xml. But as soon as Excel copies it to the sheet it's displayed as 3090. I need 3,090 with 3 decimal places. Even if it would be 3,000 it needs to have 3 decimals. \nAlso \"Value\" can sometimes be number or it can be text, I need it to be able to import both, if it's text it should be go through to the sheet as text, if it's number get it format 0,000 with correct data and go to sheet then.</p>\n\n<p>Can someone please help? I don't know how to fix this :(</p>\n"}, {"tags": ["excel", "vba", "selenium", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556661225, "post_id": 55929007, "comment_id": 98511867, "body": "Tell us more about the incorrect results times... can you supply failing cases with expected results."}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556661933, "post_id": 55929007, "comment_id": 98512078, "body": "Increase delay time? E.g. bot.Wait = 10000?"}], "answers": [{"comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1556663691, "post_id": 55929440, "comment_id": 98512488, "body": "Thanks a lot. I encountered Dictionary Key not found :HasIcannfee at this line <code>json_ParseObject.Item(json_Key) = json_ParseValue(json_String, json_Index)</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1556663729, "post_id": 55929440, "comment_id": 98512498, "body": "Please provide the failing search domain. Also, that is not a key I am using.That is not the key for availability."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1556663946, "post_id": 55929440, "comment_id": 98512557, "body": "I wonder if it is a language thing. That might then be a problem for the parser. The above runs fine for me."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1556663989, "post_id": 55929440, "comment_id": 98512567, "body": "What happens if you debug.print .responsetext   - what do you get?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1556664305, "post_id": 55929440, "comment_id": 98512649, "body": "There&#39;s a responsetext and here&#39;s part of it <code>,&quot;ExactMatchDomain&quot;:{&quot;AuctionId&quot;:0,&quot;AddToCartCallback&quot;:&quot;http&zwnj;&#8203;s:&#47;&#47;find.godaddy.com&zwnj;&#8203;&#47;v1&#47;addtocart?domain&zwnj;&#8203;_guid=af0389ba-b35d-&zwnj;&#8203;474b-ba1a-7f1eaa2831&zwnj;&#8203;ac&quot;,&quot;DomainGUID&quot;:&quot;af&zwnj;&#8203;0389ba-b35d-474b-ba1&zwnj;&#8203;a-7f1eaa2831ac&quot;,</code>"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1556664406, "post_id": 55929440, "comment_id": 98512668, "body": "I found this part that may work but how can I use it <code>&quot;IsAvailable&quot;:false,</code>?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556664600, "post_id": 55929440, "comment_id": 98512707, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/192653/discussion-between-yasserkhalil-and-qharr\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1556700510, "last_edit_date": 1556700510, "creation_date": 1556663229, "answer_id": 55929440, "question_id": 55929007, "link": "https://stackoverflow.com/questions/55929007/check-domain-using-selenium/55929440#55929440", "title": "Check domain using selenium", "body": "<p>Use the API which has a field for this. There is an exact match API as well as a cross sell.</p>\n\n<p>Exact match</p>\n\n<pre><code>Option Explicit\nPublic Sub CheckDomainAvailability()\n    Dim json As Object, domains(), i As Long, url As String\n    domains = Array(\"google.com\", \"bszadfdws.com\")\n    url = \"https://find.godaddy.com/domainsapi/v1/search/exact?q=####&amp;key=dpp_search&amp;pc=&amp;ptl=&amp;itc=dpp_absol1\"\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        For i = LBound(domains) To UBound(domains)\n            .Open \"GET\", Replace$(url, \"####\", domains(i)), False\n            .send\n            Debug.Print JsonConverter.ParseJson(.responseText)(\"ExactMatchDomain\")(\"IsAvailable\")\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Cross sell to look at related domains:</p>\n\n<pre><code>https://find.godaddy.com/domainsapi/v1/crosssell/all?sld=domainNameGoesHere&amp;key=dpp_search&amp;pc=&amp;ptl=&amp;itc=dpp_absol1\n</code></pre>\n\n<p>You would then need to look at the value for key <code>CrossSellDomains</code> instead of <code>ExactMatchDomain</code></p>\n\n<hr>\n\n<p><strong>Requirements:</strong></p>\n\n<ol>\n<li>Download and add to your project jsonconverter.bas from <a href=\"https://github.com/VBA-tools/VBA-JSON/blob/master/JsonConverter.bas\" rel=\"nofollow noreferrer\">here</a></li>\n<li>VBE > Tools > References > Add reference to Microsoft Scripting Runtime</li>\n</ol>\n\n<hr>\n\n<p><strong>Selenium version:</strong></p>\n\n<p>Used timed loop and check contents of header for <code>available</code>.</p>\n\n<pre><code>Option Explicit\nPublic Sub CheckDomainAvailability()\n    Dim d As WebDriver, domains(), i As Long, t As Date, ele As Object\n    Const MAX_WAIT_SEC As Long = 10\n    domains = Array(\"google.com\", \"bszadfdws.com\")\n    Set d = New ChromeDriver\n\n    With d\n        .Start \"Chrome\"\n        For i = LBound(domains) To UBound(domains)\n            .get \"https://ae.godaddy.com/domainsearch/find?checkAvail=1&amp;tmskey=&amp;domainToCheck=\" &amp; domains(i)\n\n            t = Timer\n            Do\n                On Error Resume Next\n                Set ele = .FindElementByCss(\".exact-header-tag\")\n                On Error GoTo 0\n                If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n            Loop While ele Is Nothing\n            If Not ele Is Nothing Then\n                Debug.Print domains(i) &amp; \" available = \" &amp; (InStr(LCase$(ele.text), \"available\") &gt; 0)\n                Set ele  = Nothing\n            End If\n        Next\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 55929440, "answer_count": 1, "score": 2, "last_activity_date": 1556700510, "creation_date": 1556660446, "last_edit_date": 1556663010, "question_id": 55929007, "link": "https://stackoverflow.com/questions/55929007/check-domain-using-selenium", "title": "Check domain using selenium", "body": "<p>I am trying to check for some domains using selenium in VBA\nHere's my try </p>\n\n<pre><code>Option Explicit\nSub Check_Domain()\n    Dim bot As New WebDriver\n    Dim sDomain As String\n\n    sDomain = \"facebookopop.com\"\n    bot.Start \"chrome\", \"https://ae.godaddy.com/domainsearch/find?checkAvail=1&amp;tmskey=&amp;domainToCheck=\" &amp; sDomain\n    bot.Get \"/\"\n\n    Dim eleTaken As Object, eleAvailable As Object\n\n    bot.Wait 3000\n\n    On Error Resume Next\n    Set eleTaken = bot.FindElementByXPath(\"//text()[contains(.,'Domain Taken')]/ancestor::span[1]\")\n    Set eleAvailable = bot.FindElementByXPath(\"//text()[contains(.,'Domain Available')]/ancestor::span[1]\")\n    On Error GoTo 0\n\n    If Not eleTaken Is Nothing Then\n        Debug.Print \"Not Avaialable\"\n    ElseIf Not eleAvailable Is Nothing Then\n        Debug.Print \"Avaialable\"\n    Else\n        Debug.Print \"Unknown\"\n    End If\n    Stop\nEnd Sub\n</code></pre>\n\n<p>The code runs slowly and at the same time it doesn't give me correct results all the time .. How can I check for the existence of an element in an easy way and avoid errors?</p>\n\n<p>I don't know why the following code doesn't work</p>\n\n<pre><code>Sub Check_Domain_Advanced()\nDim bot As New WebDriver\nDim sDomain As String\nDim c As Range\nDim ele As Object\nDim t\nConst MAX_WAIT_SEC As Long = 10\n\nbot.Start \"chrome\"\n\nFor Each c In Range(\"A1:A\" &amp; Cells(Rows.Count, 1).End(xlUp).Row)\n    If Not IsEmpty(c.Value) Then\n        sDomain = c.Value\n        bot.ExecuteScript \"window.open(arguments[0])\", \"https://ae.godaddy.com/domainsearch/find?checkAvail=1&amp;tmskey=&amp;domainToCheck=\" &amp; sDomain\n        bot.SwitchToNextWindow\n\n        t = Timer\n        Do\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While bot.FindElementsByCss(\"span[class='domain-name-text h2']\").Count = 0\n\n        Set ele = bot.FindElementByCss(\"span[class='domain-name-text h2']\")\n\n        If ele.IsPresent Then\n            If InStr(ele.Text, \"available\") Then\n                c.Offset(, 1).Value = \"Avaialable\"\n            ElseIf InStr(ele.Text, \"taken\") Then\n                c.Offset(, 1).Value = \"Not Avaialable\"\n            Else\n                c.Offset(, 1).Value = \"Unknown\"\n            End If\n        End If\n    End If\nNext c\n\nStop\nEnd Sub\n</code></pre>\n\n<p>I need to open each link in a new tab and check for the domain (available or taken) but I got errors as for the element (because of the page loads)\nAny suggestions how to improve the code so as to work faster and to avoid errors?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 806, "user_id": 5430110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207708621344060/picture?type=large", "display_name": "Riley Carney", "link": "https://stackoverflow.com/users/5430110/riley-carney"}, "edited": false, "score": 0, "creation_date": 1556660951, "post_id": 55928984, "comment_id": 98511773, "body": "Why are you doing this in Excel versus something like Powershell? How are you pulling the data into Excel? For me this seems something better suited for a script that runs every specified period and sends e-mail updates to Sales individuals when more customers are added into whatever database system you&#39;re using."}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556662135, "post_id": 55928984, "comment_id": 98512130, "body": "Can you clear this part &quot;Meanwhile the subject line is only pulling the one customer the email is meant to display.&quot;? Could you provide information about some rows of source data, how it should be processed to email correctly, and what you get instead of it?"}, {"owner": {"reputation": 47, "user_id": 11434642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddda4f27fdb5f25c12d20eda3402ebd3?s=128&d=identicon&r=PG&f=1", "display_name": "Olly0206", "link": "https://stackoverflow.com/users/11434642/olly0206"}, "reply_to_user": {"reputation": 806, "user_id": 5430110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207708621344060/picture?type=large", "display_name": "Riley Carney", "link": "https://stackoverflow.com/users/5430110/riley-carney"}, "edited": false, "score": 0, "creation_date": 1556714720, "post_id": 55928984, "comment_id": 98525536, "body": "@RileyCarney I&#39;m not familiar with Powershell. I wasn&#39;t even familiar with VBA until a few weeks ago. I know very little about coding or any coding software to begin with. The data is provided to me in an Excel spreadsheet to begin with. I&#39;m trying to pull that data and put it into individual emails with the correct information. The script will pull the info I need in the format I need it so long as the email addresses are all unique. As soon as one is duplicated, it creates one email to the address with all customer info related to that address instead of separate emails."}, {"owner": {"reputation": 47, "user_id": 11434642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddda4f27fdb5f25c12d20eda3402ebd3?s=128&d=identicon&r=PG&f=1", "display_name": "Olly0206", "link": "https://stackoverflow.com/users/11434642/olly0206"}, "reply_to_user": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556715754, "post_id": 55928984, "comment_id": 98526018, "body": "@VanNg I made an edit in the original post that hopefully sheds more light on the source info. - The subject line pulls the correct corresponding line for the first customer pulled for that email. That is fine and works as intended when there is only one customer pulled for the email. As soon as multiple customers get thrown into the same email (which I don&#39;t want) then it only shows the one customer in the subject line. I think mentioning the subject line in my original post may have been unimportant information after all. It&#39;s doing what it should be doing."}, {"owner": {"reputation": 806, "user_id": 5430110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207708621344060/picture?type=large", "display_name": "Riley Carney", "link": "https://stackoverflow.com/users/5430110/riley-carney"}, "edited": false, "score": 0, "creation_date": 1556740335, "post_id": 55928984, "comment_id": 98537029, "body": "@Olly0206 I&#39;ll work on putting something together for you when I get home tonight from work. :)"}, {"owner": {"reputation": 47, "user_id": 11434642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddda4f27fdb5f25c12d20eda3402ebd3?s=128&d=identicon&r=PG&f=1", "display_name": "Olly0206", "link": "https://stackoverflow.com/users/11434642/olly0206"}, "reply_to_user": {"reputation": 806, "user_id": 5430110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207708621344060/picture?type=large", "display_name": "Riley Carney", "link": "https://stackoverflow.com/users/5430110/riley-carney"}, "edited": false, "score": 0, "creation_date": 1556746103, "post_id": 55928984, "comment_id": 98539087, "body": "@RileyCarney Thank you so much! Maybe this will help, <a href=\"https://www.rondebruin.nl/win/s1/outlook/bmail8.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s1/outlook/bmail8.htm</a>. This was where I started. I used the second example. I&#39;ve been staring at it so long I forgot that the code is supposed to look at unique email addresses and build emails based on that. I was thinking it was supposed to be looking at names and building off of that using the email addresses in the second column. But even though my understanding was off, I&#39;m still in the same predicament. I&#39;m not entirely sure how to fix it."}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556872461, "post_id": 55928984, "comment_id": 98582880, "body": "No I have understood your problem. But it is your vision of how-to-be is needed. How these emails should be processed? If we send email to customer1, then we should compose body with that customer only?"}, {"owner": {"reputation": 47, "user_id": 11434642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddda4f27fdb5f25c12d20eda3402ebd3?s=128&d=identicon&r=PG&f=1", "display_name": "Olly0206", "link": "https://stackoverflow.com/users/11434642/olly0206"}, "reply_to_user": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556888795, "post_id": 55928984, "comment_id": 98591552, "body": "@VanNg The goal is to create 1 email per customer that includes any and all rows from the spreadsheet and To any corresponding sales addresses. The problem is that it is creating 1 email with any matching sales addresses and including all rows of any and all customers that match that email. So instead of an email for Customer1 and Sales1@email.com and another for Customer2 at Sales1@email.com, it&#39;s creating one email for Customer 1 and 2 to Sales1@email.com."}, {"owner": {"reputation": 47, "user_id": 11434642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddda4f27fdb5f25c12d20eda3402ebd3?s=128&d=identicon&r=PG&f=1", "display_name": "Olly0206", "link": "https://stackoverflow.com/users/11434642/olly0206"}, "edited": false, "score": 0, "creation_date": 1556888969, "post_id": 55928984, "comment_id": 98591681, "body": "I have been playing around with the code some more and think I may have found something that I didn&#39;t fully understand before. I&#39;m not sure if I still do but I think I have a better understanding. -- It looks like the code is creating a filter that it uses to build the body of the email. It&#39;s filtering Column B (emails) for unique values and creating an email based on that. I think if I can change that filter code to filter for Column A and build an email using Column B, then I think I&#39;ll get what I&#39;m looking for. I just can&#39;t figure out how to make that work."}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556889196, "post_id": 55928984, "comment_id": 98591793, "body": "OK, lets see. situation A: you want to send email to Customer1. That way you&#39;ll find, that he has only one email sales1@address.com - send email to this address. Thus sales1@address.com is shared with Customer5, this fact is ignored. Is that OK?"}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556890325, "post_id": 55928984, "comment_id": 98592497, "body": "So I&#39;ve found following: you can do email field complex, e.g. Customer1_email1@address.com. In this case you&#39;ll get unique values for each customer_email pair, so filtering will work OK. Other part is that you&#39;ll have to do smth with generated email to send. But I think you should try this in order to understand, that is this desired behavior or not"}, {"owner": {"reputation": 47, "user_id": 11434642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddda4f27fdb5f25c12d20eda3402ebd3?s=128&d=identicon&r=PG&f=1", "display_name": "Olly0206", "link": "https://stackoverflow.com/users/11434642/olly0206"}, "reply_to_user": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556908990, "post_id": 55928984, "comment_id": 98601634, "body": "@VanNg I have made some progress towards solving this problem. One major change I made was eliminating the copying to a new sheet and instead just set the filter to use the active sheet. This gave me more precise control over generating emails with the correct information. Now, however, I have a new issue. Now, the macro generates a new mail for every line. So customers that have multiple lines are now getting multiple emails generated. The body info is still correct and the email addresses are correct. It&#39;s just creating multiple emails now. One for each line. 650 lines. 650 emails."}, {"owner": {"reputation": 806, "user_id": 5430110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207708621344060/picture?type=large", "display_name": "Riley Carney", "link": "https://stackoverflow.com/users/5430110/riley-carney"}, "edited": false, "score": 0, "creation_date": 1557187902, "post_id": 55928984, "comment_id": 98672340, "body": "Sorry work was busy Olly, going to put together some code tonight. Instead of VBA going to use Powershell however, I found that often times .xlsm files can get corrupted and aren&#39;t consistent enough for use, and if this is something you get on a regular basis as a .CSV file you can likely just automate these e-mails and set it as a task on your computer."}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1557208368, "post_id": 55928984, "comment_id": 98676433, "body": "Why you show in example table with Email body but using RangetoHTML in body? What you want?"}, {"owner": {"reputation": 47, "user_id": 11434642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddda4f27fdb5f25c12d20eda3402ebd3?s=128&d=identicon&r=PG&f=1", "display_name": "Olly0206", "link": "https://stackoverflow.com/users/11434642/olly0206"}, "reply_to_user": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1557257858, "post_id": 55928984, "comment_id": 98702334, "body": "@DmitrijHolkin I&#39;m not sure if I understand your question? The RangetoHTML is a function that grabs all rows and columns visible in the Excel file and copy/pastes them the body of the email in the same format as they appear in the Excel file. It was an alternative I decided to do instead of saving a copy of the workfile and attaching it to the email. I decided to load it into the body of the email since one complaint I get from my sales team is that the attachment creates extra steps."}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1557292962, "post_id": 55928984, "comment_id": 98710755, "body": "So my answers is not good for your? Can you show Email letter example you want to achieve"}, {"owner": {"reputation": 47, "user_id": 11434642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddda4f27fdb5f25c12d20eda3402ebd3?s=128&d=identicon&r=PG&f=1", "display_name": "Olly0206", "link": "https://stackoverflow.com/users/11434642/olly0206"}, "reply_to_user": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1557415020, "post_id": 55928984, "comment_id": 98765249, "body": "@DmitrijHolkin I&#39;m not sure if the code you provided will take care of my issue or not. I&#39;m very new with coding and VBA so I&#39;m still going through it to figure out what stuff I need to customize to fit my spreadsheet so I can find out if it works for my needs. I am learning all of this as I go and I have no one to explain anything to me so I&#39;m basically going through it line by line and researching what every line does and how it interacts with other parts of the code."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 11434642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddda4f27fdb5f25c12d20eda3402ebd3?s=128&d=identicon&r=PG&f=1", "display_name": "Olly0206", "link": "https://stackoverflow.com/users/11434642/olly0206"}, "edited": false, "score": 0, "creation_date": 1557150023, "post_id": 55976277, "comment_id": 98658366, "body": "I&#39;m not sure what it did but it did something. I didn&#39;t get an error or anything and it looks like it cycled through the entire code but it didn&#39;t generate any emails or make any changes that I can find. I&#39;m really not sure what happened but nothing changed as far as I can tell."}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "reply_to_user": {"reputation": 47, "user_id": 11434642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddda4f27fdb5f25c12d20eda3402ebd3?s=128&d=identicon&r=PG&f=1", "display_name": "Olly0206", "link": "https://stackoverflow.com/users/11434642/olly0206"}, "edited": false, "score": 0, "creation_date": 1557152568, "post_id": 55976277, "comment_id": 98659728, "body": "&quot;One for each line. 650 lines. 650 emails.&quot; - does code above do the same? It also generated 650 emails? Or it is not generating any?"}, {"owner": {"reputation": 47, "user_id": 11434642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddda4f27fdb5f25c12d20eda3402ebd3?s=128&d=identicon&r=PG&f=1", "display_name": "Olly0206", "link": "https://stackoverflow.com/users/11434642/olly0206"}, "edited": false, "score": 0, "creation_date": 1557158426, "post_id": 55976277, "comment_id": 98662732, "body": "Not getting anything at all. No emails. No nothing. It looks like the code is doing something. But whatever it&#39;s doing is all background so you don&#39;t actually see any result."}], "tags": [], "owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "is_accepted": false, "score": 1, "last_activity_date": 1556913076, "creation_date": 1556913076, "answer_id": 55976277, "question_id": 55928984, "link": "https://stackoverflow.com/questions/55928984/using-vba-to-build-emails-from-excel-that-combine-email-body-when-addresses-dupl/55976277#55976277", "title": "Using VBA to build emails from Excel that combine email body when addresses duplicate", "body": "<p>Try this, actually it generate needed number of emails. If OK, I'll clear the code</p>\n\n<pre><code>Option Explicit\n\nSub Send_Row_Or_Rows_2()\n\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim rng As Range\n    Dim Ash As Worksheet\n    Dim Cws As Worksheet\n    Dim Rcount As Long\n    Dim Rnum As Long\n    Dim FilterRange As Range\n    Dim FieldNum As Integer\n\n\n    On Error GoTo cleanup\n    Set OutApp = CreateObject(\"Outlook.Application\")\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    'Set filter sheet, you can also use Sheets(\"MySheet\")\n    Set Ash = ActiveSheet\n\n    'Set filter range and filter column (column with e-mail addresses)\n    Set FilterRange = Ash.Range(\"A1:BY\" &amp; Ash.Rows.Count)\n    FieldNum = 2    'Filter column = B because the filter range start in     Column A\n    'FieldNum = 2\n\n    Columns(\"A:B\").Select\n    Selection.Copy\n\n    ActiveSheet.Paste\n\n    'Add a worksheet for the unique list and copy the unique list in A1\n    Set Cws = Worksheets.Add\n    ActiveSheet.Paste\n'    FilterRange.Columns(FieldNum).AdvancedFilter _\n'            Action:=xlFilterCopy, _\n'            CopyToRange:=Cws.Range(\"A:B\"), _\n'            CriteriaRange:=\"\", Unique:=True\n\n\n    Columns(\"A:B\").Select\n    Application.CutCopyMode = False\n    ActiveSheet.Range(\"$A$1:$B$10\").RemoveDuplicates Columns:=Array(1, 2), Header _\n        :=xlYes\n\n    'Count of the unique values + the header cell\n    Rcount = Application.WorksheetFunction.CountA(Cws.Columns(1))\n\n    'If there are unique values start the loop\n    If Rcount &gt;= 2 Then\n        For Rnum = 2 To Rcount\n\n            'Filter the FilterRange on the FieldNum column\n            FilterRange.AutoFilter Field:=1, _\n                                   Criteria1:=Cws.Cells(Rnum, 1).Value\n\n            FilterRange.AutoFilter Field:=2, _\n                                   Criteria1:=Cws.Cells(Rnum, 2).Value\n\n            'If the unique value is a mail addres create a mail\n            If Cws.Cells(Rnum, 2).Value Like \"?*@?*.?*\" Then\n\n                With Ash.AutoFilter.Range\n                    On Error Resume Next\n                    Set rng = .SpecialCells(xlCellTypeVisible)\n                    On Error GoTo 0\n                End With\n\n                Set OutMail = OutApp.CreateItem(0)\n\n                On Error Resume Next\n                With OutMail\n                    Debug.Print \"to: \" &amp; .to &amp; \" subj: \" &amp; .Subject &amp; \" body:\" &amp; .htmlbody\n                    .to = Cws.Cells(Rnum, 2).Value\n                    .Subject = Ash.Cells(Rnum, 3) &amp; \" Bond Review \" &amp; Date\n                    .htmlbody = RangetoHTML(rng)\n                    .Display  'Or use Send\n                End With\n                On Error GoTo 0\n\n                Set OutMail = Nothing\n            End If\n\n            'Close AutoFilter\n            Ash.AutoFilterMode = False\n\n        Next Rnum\n    End If\n\ncleanup:\n    Set OutApp = Nothing\n    Application.DisplayAlerts = False\n    Cws.Delete\n    Application.DisplayAlerts = True\n\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\nEnd Sub\n\nFunction RangetoHTML(rng As Range)\n\nDim fso As Object\nDim ts As Object\nDim TempFile As String\nDim TempWB As Workbook\n\nTempFile = Environ$(\"temp\") &amp; \"/\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n'Copy the range and create a new workbook to past the data in\nrng.Copy\nSet TempWB = Workbooks.Add(1)\nWith TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    .Cells(1).PasteSpecial xlPasteValues, , False, False\n    .Cells(1).PasteSpecial xlPasteFormats, , False, False\n    .Cells(1).Select\n    Application.CutCopyMode = False\n    On Error Resume Next\n    .DrawingObjects.Visible = True\n    .DrawingObjects.Delete\n    On Error GoTo 0\nEnd With\n\n'Publish the sheet to a htm file\nWith TempWB.PublishObjects.Add( _\n     SourceType:=xlSourceRange, _\n     Filename:=TempFile, _\n     Sheet:=TempWB.Sheets(1).Name, _\n     Source:=TempWB.Sheets(1).UsedRange.Address, _\n     HtmlType:=xlHtmlStatic)\n    .Publish (True)\nEnd With\n\n'Read all data from the htm file into RangetoHTML\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\nRangetoHTML = ts.ReadAll\nts.Close\nRangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                      \"align=left x:publishsource=\")\n\n'Close TempWB\nTempWB.Close savechanges:=False\n\n'Delete the htm file we used in this function\nKill TempFile\nSet ts = Nothing\nSet fso = Nothing\nSet TempWB = Nothing\nEnd Function\n\nPublic Function EOMonth(dInput As Date)\n\nLastDayOfMonth = DateSerial(Year(dInput()), Month(dInput() + 1), -1)\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1557728209, "last_edit_date": 1557728209, "creation_date": 1557209354, "answer_id": 56016471, "question_id": 55928984, "link": "https://stackoverflow.com/questions/55928984/using-vba-to-build-emails-from-excel-that-combine-email-body-when-addresses-dupl/56016471#56016471", "title": "Using VBA to build emails from Excel that combine email body when addresses duplicate", "body": "<p>I using like that, First you need to convert your text to table and name it CustomersTbl or use </p>\n\n<pre><code>LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row ' get last row\nSet Rng = ws.Range(ws.Cells(1, 1), ws.Cells(LastRow, 4))\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>Set rng = ws.Range(\"CustomersTbl\")\n</code></pre>\n\n<p>Here is a code</p>\n\n<pre><code>Sub Send_Row_Or_Rows_2()\n' reference Microsoft Scripting Runtime\nDim OutApp As Object, OutMail As Object, dict As Object\nDim tKey(0 To 3, 0 To 1) As Variant\nDim rng As Range\nDim ws As Worksheet\n\nOn Error GoTo cleanup\nSet OutApp = CreateObject(\"Outlook.Application\")\nWith Application\n    .EnableEvents = False ' speedup Application, disable events\n    .ScreenUpdating = False ' prevent flashing, disable screen\nEnd With\n\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\") ' set shortest variable for worksheet\nSet dict = CreateObject(\"Scripting.Dictionary\") ' set object for unique values\nSet rng = ws.Range(\"CustomersTbl\") ' get range to variable\n'LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row ' get last row\n'Set Rng = ws.Range(ws.Cells(1, 1), ws.Cells(LastRow, 4)) 'get range to variable\nFor Each cRow In rng ' create unique dictionary\n    i = i + 1 ' increment\n    strCustomer = rng(i, 1)\n    strEmail = rng(i, 2)\n    strSubj = rng(i, 3)\n    strBody = rng(i, 4)\n    If dict.Exists(strCustomer) Then ' if dublicate\n        Dim tempArr() As Variant\n            tempArr() = dict(strCustomer)\n                If UBound(tempArr, 2) &gt; 0 Then ' if not nothing\n                    If Not IsEmpty(tempArr(0, 1)) Then ' if second element empty\n                        sCount = UBound(tempArr, 2) + 1\n                    Else\n                        sCount = UBound(tempArr, 2)  ' as is empty array\n                    End If\n                End If\n                    ReDim Preserve tempArr(0 To 3, 0 To sCount) ' redim array to next array size\n                        tempArr(0, sCount) = strCustomer 'fill array element\n                        tempArr(1, sCount) = strEmail 'fill array element\n                        tempArr(2, sCount) = strSubj 'fill array element\n                        tempArr(3, sCount) = strBody 'fill array element\n            dict(strCustomer) = tempArr ' put array to dictionary by unique name\n    Else\n        tKey(0, 0) = strCustomer 'fill array element\n        tKey(1, 0) = strEmail 'fill array element\n        tKey(2, 0) = strSubj 'fill array element\n        tKey(3, 0) = strBody 'fill array element\n            dict.Add strCustomer, tKey ' create unique name\n    End If\nNext cRow ' loop next row\n' now dict contains only unique elements, lets loop throught them\nFor Each UniqueCustomer In dict ' for each unique element\ncountEmails = UBound(dict(UniqueCustomer), 2) ' count emails of unique group\n    For i = 0 To countEmails ' loop each email in group\n        strCustomer = dict(UniqueCustomer)(0, i)\n        strEmail = dict(UniqueCustomer)(1, i)\n        strSubj = dict(UniqueCustomer)(2, i)\n        strBody = dict(UniqueCustomer)(3, i)\n        If Not IsEmpty(strCustomer) Then ' if element not empty create email\n            Set OutMail = OutApp.CreateItem(0)\n                    On Error Resume Next\n                    With OutMail\n                        .To = strEmail\n                        .Subject = strSubj\n                        .HTMLBody = strBody\n                        .Display  'Or use Send\n                    End With\n                    On Error GoTo 0\n            Set OutMail = Nothing\n        Else\n            GoTo sNext\n        End If\n        Stop\nsNext:\n    Next I ' next email\nNext UniqueCustomer 'next unique\n\ncleanup:\nSet OutApp = Nothing\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1557728934, "post_id": 56066425, "comment_id": 98847324, "body": "This code does not create unique emails, just per each row"}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1557778284, "post_id": 56066425, "comment_id": 98871637, "body": "Correct - but at this point it becomes a formula question, and while I&#39;m not quite sure exactly how things need to be merged, it makes it hard for me to answer. Either way, the formula aspect is a relatively simple portion of the code"}], "tags": [], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "is_accepted": false, "score": 3, "last_activity_date": 1557430483, "creation_date": 1557430483, "answer_id": 56066425, "question_id": 55928984, "link": "https://stackoverflow.com/questions/55928984/using-vba-to-build-emails-from-excel-that-combine-email-body-when-addresses-dupl/56066425#56066425", "title": "Using VBA to build emails from Excel that combine email body when addresses duplicate", "body": "<p>I've written code like this quite a few times - the base template is actually on my <a href=\"https://github.com/OlivierHJ/Excel-Projects/blob/master/Mass%20Email%20Macro.xlsm\" rel=\"nofollow noreferrer\">github</a></p>\n\n<p>The code:</p>\n\n<pre><code>Option Explicit\n\n\nSub LoopOverData()\nDim STbl As ListObject\nDim LastRow As Long\nDim WB As Workbook\nDim i As Long\nDim WS As Worksheet\nDim tblwsname As String\n\n\n    Set WB = ThisWorkbook\n\n\n    tblwsname = WB.Names(\"TblWSName\").RefersToRange.Value2\n    Set WS = WB.Sheets(tblwsname)\n    Set STbl = WS.ListObjects(\"EmailDataTable\")\n\n\n    LastRow = STbl.ListRows.Count\n\n\n    For i = 1 To LastRow\n         WB.Names(\"IterationNumber\").RefersToRange.Value2 = i\n         Application.Calculate\n         Call CreateEmail\n    Next i\n\n\n\nEnd Sub\n\n\n\n\n\nSub CreateEmail()\n' This macro is for the pricing confirm e-mail\n    Dim outApp As New Outlook.Application\n    Dim OutMail As Object\n    Dim Attchmnt As String\n    Dim Signature As String\n    Dim WB As Workbook\n    Set WB = ThisWorkbook\n   Attchmnt = WB.Names(\"Attachment\").RefersToRange.Value2\n   'We keep the file path for the attachment we're sending in Excel, for easy editing. Look in name manager to find it.\n\n    Application.EnableEvents = False\n     Application.ScreenUpdating = False\n\n    ' We don't need the screen to flicker while the macro is running - it speeds things up.\n    Set OutMail = outApp.CreateItem(0)\n    'Signature = OutMail.Body\n    On Error Resume Next\n    With OutMail\n    .To = WB.Names(\"to\").RefersToRange.Value2\n   .CC = WB.Names(\"cc\").RefersToRange.Value2\n   .BCC = WB.Names(\"bcc\").RefersToRange.Value2\n   .Subject = WB.Names(\"Subject\").RefersToRange.Value2\n   .Body = WB.Names(\"Body\").RefersToRange.Value2\n   .display\n   End With\n\n   If Attchmnt = \"\" Then\n   Else\n   OutMail.Attachments.Add Attchmnt\n   End If\n\n   'OutMail.send\n   'Remove this comment to directly send. Not recommended.\n\n   On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>The setup: You create a \"sample email\" basically, and you use =index(Range, IndexNum) to determine what item you're currently working on. IndexNum is a named range back to the base index, which the code will be changing.</p>\n\n<p>Hence, as each number in the index gets moved, all of the formulas update to the new email that needs to be written. It then calls the email generating procedure, and creates (but doesn't send) the email needed. This is to give you a chance to review the emails before sending them. </p>\n\n<p>You'll want the Microsoft Outlook 16.0 Object library enabled.</p>\n\n<p>There might be some rule to sending the information that I'm missing - if that's the case, I recommend a few formulas or power query to do the compression</p>\n"}, {"tags": [], "owner": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "is_accepted": false, "score": 1, "last_activity_date": 1557783132, "last_edit_date": 1557783132, "creation_date": 1557776513, "answer_id": 56118910, "question_id": 55928984, "link": "https://stackoverflow.com/questions/55928984/using-vba-to-build-emails-from-excel-that-combine-email-body-when-addresses-dupl/56118910#56118910", "title": "Using VBA to build emails from Excel that combine email body when addresses duplicate", "body": "<p>If I understand correctly, you want send emails based upon a unique combination of Customer and Email Address, and for each unique combo get the corresponding subject line and email body. So in your example above, I am assuming that since customer2 and Customer4 are duplicates, then you only want to send one email for each customer and use the corresponding subject line and email body found at the first occurrence of the Cutomer2 or 4. </p>\n\n<p>If my assumptions are correct, then the code below should do the job. Note the comments that explain each step. </p>\n\n<p><strong>Edit:</strong> I forgot to mention that using delimiter as I did originally is risky, because that delimiter could exist somewhere in the data and splitting by that delimiter would throw off your results. So, the better method, (and I believe more clean as well), would be the following: </p>\n\n<pre><code>Option Explicit\n\nPublic Sub SendEmails()\n\n Dim objDict As Object\n Dim objWB As Workbook\n Dim objWS As Worksheet\n Dim rngToLookUp As Range\n Dim lngLastRow As Long, i As Long\n Dim arryEmailData As Variant\n Dim objOutlookApp As Object, objOutlookEmail As Object\n Dim varKey As Variant, arryTemp As Variant\n\n    Application.ScreenUpdating = False\n\n    Set objWB = Workbooks(\"SomeWBName\")\n    Set objWS = objWB.Worksheets(\"SomeWSName\")\n    lngLastRow = objWS.Cells(objWS.Rows.Count, \"A\").End(xlUp).Row   'Find last row with data\n    Set rngToLookUp = objWS.Range(\"A2:D\" &amp; lngLastRow)              'set range for last row of data\n\n    arryEmailData = rngToLookUp.Value2    'Get the email data from the sheet into an array\n\n        Set objDict = CreateObject(\"Scripting.Dictionary\")      'set the dicitonary object\n        Set objOutlookApp = CreateObject(\"Outlook.Application\") 'set the outlook object\n\n\n            For i = LBound(arryEmailData, 1) To UBound(arryEmailData, 1)\n                varKey = Join(Array(arryEmailData(i, 1), arryEmailData(i, 2)), \"|\") 'Concatenate columns A and B using '|' as a\n                                                                                    'delimiter to form a unique Key\n\n                If Not objDict.Exists(varKey) Then\n\n                    objDict(varKey) = Array(arryEmailData(i, 2), _\n                                            arryEmailData(i, 3), _\n                                            arryEmailData(i, 4))\n                End If\n\n                varKey = Empty\n\n            Next i\n\n            'for each unique key in the dicitonary\n            'get the corresponding item which is an array\n            'created in the loop above\n            On Error GoTo cleanup\n            For Each varKey In objDict.Keys\n                arryTemp = objDict.Item(varKey)\n                Set objOutlookEmail = objOutlookApp.CreateItem(0)\n                    With objOutlookEmail\n                        .To = arryTemp(0)\n                        .Subject = arryTemp(1)\n                        .Body = arryTemp(2)\n                        .Send\n                    End With\n                Set objOutlookEmail = Nothing\n                arryTemp = Empty\n            Next\n\n    MsgBox \"All Emails have been sent\", vbInformation\n\ncleanup:\n        Set objOutlookApp = Nothing\n        Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p><strong>Original Post:</strong> </p>\n\n<pre><code>Option Explicit\n\nPublic Sub SendEmails()\n\n Dim objDict As Object\n Dim objWB As Workbook\n Dim objWS As Worksheet\n Dim rngToLookUp As Range\n Dim lngLastRow As Long, i As Long\n Dim arryEmailData As Variant\n Dim objOutlookApp As Object, objOutlookEmail As Object\n Dim varKey As Variant, arryTemp As Variant\n\n    Application.ScreenUpdating = False\n\n    Set objWB = Workbooks(\"SomeWBName\")\n    Set objWS = objWB.Worksheets(\"SomeWSName\")\n    lngLastRow = objWS.Cells(objWS.Rows.Count, \"A\").End(xlUp).Row   'Find last row with data\n    Set rngToLookUp = objWS.Range(\"A2:D\" &amp; lngLastRow)              'set range for last row of data\n\n    arryEmailData = rngToLookUp.Value2    'Get the email data from the sheet into an array\n\n        Set objDict = CreateObject(\"Scripting.Dictionary\")      'set the dicitonary object\n        Set objOutlookApp = CreateObject(\"Outlook.Application\") 'set the outlook object\n\n\n            For i = LBound(arryEmailData, 1) To UBound(arryEmailData, 1)\n                varKey = Join(Array(arryEmailData(i, 1), arryEmailData(i, 2)), \"|\") 'Concatenate columns A and B using '|' as a\n                                                                                    'delimiter to form a unique Key\n\n                If Not objDict.Exists(varKey) Then                          'If the key doesn't already exist, then concatenate\n                                                                            'the corresponding Email Address, subject line,\n                                                                            'and email body using\n                                                                            ''|' as a delimiter\n                    objDict(varKey) = Join(Array(arryEmailData(i, 2), _\n                                                 arryEmailData(i, 3), _\n                                                 arryEmailData(i, 4)), \"|\")\n                End If\n\n                varKey = Empty\n\n            Next i\n\n            'for each unique key in the dicitonary\n            'get the corresponding item\n            'split the item into a 3 element array using '|' delimiter that\n            'was originally used to concatenate the item in the loop above\n            On Error GoTo cleanup\n            For Each varKey In objDict.Keys\n                arryTemp = Split(objDict.Item, \"|\")\n                Set objOutlookEmail = objOutlookApp.CreateItem(0)\n                    With objOutlookEmail\n                        .To = arryTemp(0)\n                        .Subject = arryTemp(1)\n                        .Body = arryTemp(2)\n                        .Send\n                    End With\n                Set objOutlookEmail = Nothing\n            Next\n\n    MsgBox \"All Emails have been sent\", vbInformation\n\ncleanup:\n        Set objOutlookApp = Nothing\n        Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 11434642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddda4f27fdb5f25c12d20eda3402ebd3?s=128&d=identicon&r=PG&f=1", "display_name": "Olly0206", "link": "https://stackoverflow.com/users/11434642/olly0206"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1945, "favorite_count": 0, "answer_count": 4, "score": 4, "last_activity_date": 1557783132, "creation_date": 1556660320, "last_edit_date": 1556889058, "question_id": 55928984, "link": "https://stackoverflow.com/questions/55928984/using-vba-to-build-emails-from-excel-that-combine-email-body-when-addresses-dupl", "title": "Using VBA to build emails from Excel that combine email body when addresses duplicate", "body": "<p>First off, I'm very new with VBA. Still learning so I may be making some obvious mistakes.</p>\n\n<p>I'm trying to build emails using an Excel spreadsheet that I'm pulling information from to populate To, Subject, and Body of the emails. These are going to sales people to review information for their customers. I need each email to be based on the customer and sent to the corresponding sales reps. Some customers have multiple lines of information where as others have one and some sales people have overlapping customers.</p>\n\n<p>The code I have found and have been trying to edit is (as far as I can tell) building the emails based on the email addresses. So I end up with an email that has a sales person in the To line and the body has all of the customers specifically for that sales person. Meanwhile the subject line is only pulling the one customer the email is meant to display.</p>\n\n<p>Any help on this would be a godsend. I'm trying to reduce a 4-6 hour workload down to sub 1hr.</p>\n\n<p>Any time I try to make changes to the code to base it on the customer rather than the email address I either end up breaking the code or not building an email and instead somehow just applying a filter to the spreadsheet that filters for the same information that was going into the email prior to the change.</p>\n\n<p>I feel there may be more info necessary because I'm finding this to be far more complex than it appears but that may be me overthinking things. I've tried to limit this post to just the pertinent info but if I need to provide more I certainly will. I've been wracking my brain on this for weeks.</p>\n\n<p>I have tried a variety of If And/Then statements to try and make the code look at the customer column rather than the email column but I can't find any combination that works. The code I posted below is what I have managed to get to work to some degree. Since I've tried so many variations I wouldn't know what would be the best mistake to include. So hopefully this is at least not too messy.</p>\n\n<p>*Edit: The code requires a column of names in Column A which, as far as I understood, was supposed to be the condition that 'for this name create email using address in Column B.' But what it seems to be doing is creating an email using the address in Column B as the condition. So any customer line in A that matches the address in B gets thrown into the same email. I sort of need that to be the other way around. One email per customer of Column A to what ever email addresses are listed in Column B.</p>\n\n<p>Edit2: Source info looking something like this:</p>\n\n<pre><code>+----------------+---------------------+---------+--------------+\n|     Customer   |       Email         | Subj Ln |  Email Body  |\n+----------------+---------------------+---------+--------------+\n| Customer 1     | sales1@address.com  | info    |     info     |\n| Customer 2     | sales2@address.com  | info    |     info     |\n| Customer 2     | sales2@address.com  | info    |     info     |\n| Customer 2     | sales2@address.com  | info    |     info     |\n| Customer 3     | sales2@address.com  | info    |     info     |\n| Customer 4     | sales3@address.com  | info    |     info     |\n| Customer 4     | sales3@address.com  | info    |     info     |\n| Customer 5     | sales1@address.com  | info    |     info     |\n| Customer 6     | sales4@address.com  | info    |     info     |\n+----------------+---------------------+---------+--------------+\n</code></pre>\n\n<p>So the code should be looking at the Customer Column (Column A) and looking for unique instances then generating an email with the appropriate email address in the Email Column (Column B). Each one should be a separate email and when the email addresses are unique to the customer it will do that. So, in the example above Customer 6 gets a singular email to sales4. The email generates the appropriate Subject Line and Email Body. However, Customer 1 will generate an email with the appropriate Subj Ln and Email Body (for Customer 1) and it will also have the appropriate sales1 email address. But since sales1 also has Customer 5, the Email Body information for Customer 5 is included in the Customer 1 email. When I need Customer 5 to be a separate email.</p>\n\n<p>Edit3: I added the following paragraph as a comment below because I wasn't sure which would be the best way to get visibility to it. </p>\n\n<p>I have been playing around with the code some more and think I may have found something that I didn't fully understand before. I'm not sure if I still do but I think I have a better understanding. -- It looks like the code is creating a filter that it uses to build the body of the email. It's filtering Column B (emails) for unique values and creating an email based on that. I think if I can change that filter code to filter for Column A and build an email using Column B, then I think I'll get what I'm looking for. I just can't figure out how to make that work.</p>\n\n<p>I hope I'm clear. It is getting very confusing and overwhelming to me but I hope it is making sense. Also, I hope my formatting is correct.</p>\n\n<pre><code>Sub Send_Row_Or_Rows_2()\n\nDim OutApp As Object\nDim OutMail As Object\nDim rng As Range\nDim Ash As Worksheet\nDim Cws As Worksheet\nDim Rcount As Long\nDim Rnum As Long\nDim FilterRange As Range\nDim FieldNum As Integer\n\nOn Error GoTo cleanup\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\n'Set filter sheet, you can also use Sheets(\"MySheet\")\nSet Ash = ActiveSheet\n\n'Set filter range and filter column (column with e-mail addresses)\nSet FilterRange = Ash.Range(\"A1:AY\" &amp; Ash.Rows.Count)\nFieldNum = 2    'Filter column = B because the filter range start in \ncolumn A\n\n'Add a worksheet for the unique list and copy the unique list in A1\nSet Cws = Worksheets.Add\nFilterRange.Columns(FieldNum).AdvancedFilter _\n        Action:=xlFilterCopy, _\n        CopyToRange:=Cws.Range(\"A1\"), _\n        CriteriaRange:=\"\", Unique:=True\n\n'Count of the unique values + the header cell\nRcount = Application.WorksheetFunction.CountA(Cws.Columns(1))\n\n'If there are unique values start the loop\nIf Rcount &gt;= 2 Then\n    For Rnum = 2 To Rcount\n\n        'Filter the FilterRange on the FieldNum column\n        FilterRange.AutoFilter Field:=FieldNum, _\n                               Criteria1:=Cws.Cells(Rnum, 1).Value\n\n        'If the unique value is a mail addres create a mail\n        If Cws.Cells(Rnum, 1).Value Like \"?*@?*.?*\" Then\n\n            With Ash.AutoFilter.Range\n                On Error Resume Next\n                Set rng = .SpecialCells(xlCellTypeVisible)\n                On Error GoTo 0\n            End With\n\n            Set OutMail = OutApp.CreateItem(0)\n\n            On Error Resume Next\n            With OutMail\n                .To = Cws.Cells(Rnum, 1).Value\n                .Subject = Ash.Cells(Rnum, 3) &amp; \" Bond Review \" &amp; Date\n                .HTMLBody = RangetoHTML(rng)\n                .Display  'Or use Send\n            End With\n            On Error GoTo 0\n\n            Set OutMail = Nothing\n        End If\n\n        'Close AutoFilter\n        Ash.AutoFilterMode = False\n\n    Next Rnum\nEnd If\n\ncleanup:\nSet OutApp = Nothing\nApplication.DisplayAlerts = False\nCws.Delete\nApplication.DisplayAlerts = True\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\nEnd Sub\n\nFunction RangetoHTML(rng As Range)\n\nDim fso As Object\nDim ts As Object\nDim TempFile As String\nDim TempWB As Workbook\n\nTempFile = Environ$(\"temp\") &amp; \"/\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \n\".htm\"\n\n'Copy the range and create a new workbook to past the data in\nrng.Copy\nSet TempWB = Workbooks.Add(1)\nWith TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    .Cells(1).PasteSpecial xlPasteValues, , False, False\n    .Cells(1).PasteSpecial xlPasteFormats, , False, False\n    .Cells(1).Select\n    Application.CutCopyMode = False\n    On Error Resume Next\n    .DrawingObjects.Visible = True\n    .DrawingObjects.Delete\n    On Error GoTo 0\nEnd With\n\n'Publish the sheet to a htm file\nWith TempWB.PublishObjects.Add( _\n     SourceType:=xlSourceRange, _\n     Filename:=TempFile, _\n     Sheet:=TempWB.Sheets(1).Name, _\n     Source:=TempWB.Sheets(1).UsedRange.Address, _\n     HtmlType:=xlHtmlStatic)\n    .Publish (True)\nEnd With\n\n'Read all data from the htm file into RangetoHTML\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\nRangetoHTML = ts.ReadAll\nts.Close\nRangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                      \"align=left x:publishsource=\")\n\n'Close TempWB\nTempWB.Close savechanges:=False\n\n'Delete the htm file we used in this function\nKill TempFile\nSet ts = Nothing\nSet fso = Nothing\nSet TempWB = Nothing\nEnd Function\n\nPublic Function EOMonth(dInput As Date)\n\nLastDayOfMonth = DateSerial(Year(dInput()), Month(dInput() + 1), -1)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "emacs", "outlook", "emacsclient"], "owner": {"reputation": 53, "user_id": 2969651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc7141a11c688883144a7e838d3fce7d?s=128&d=identicon&r=PG&f=1", "display_name": "Perpetual Learner", "link": "https://stackoverflow.com/users/2969651/perpetual-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1592554614, "creation_date": 1556657590, "last_edit_date": 1592554614, "question_id": 55928520, "link": "https://stackoverflow.com/questions/55928520/emacsclientw-c-runs-very-slow-as-an-outlook-macro-while-super-fast-if-runs", "title": "&quot;emacsclientw -c &quot; runs very slow as an outlook macro, while super fast if runs in Window Powershell", "body": "<p>Here is a simple command to launch an emacsclient frame in Windows 10,  which I've added to outlook as a macro assigned to a new button.</p>\n\n<pre><code>Shell (\"c:/Users/user_name/emacs-25.3-x86_64/bin/emacsclientw.exe -c \")\n</code></pre>\n\n<p>But every time it is launched through that button, the outlook message window becomes non-responsive for 15+ seconds. </p>\n\n<p>If I change that macro to:</p>\n\n<pre><code>Shell (\"c:/Users/user_name/emacs-25.3-x86_64/bin/runemacs.exe\")\n</code></pre>\n\n<p>i,e, to launch emacs instead of emacsclient, it can finish instantaneously without any impact to outlook window.</p>\n\n<p>If I launch emacsclient directly in a Windows Powershell with this command:</p>\n\n<pre><code>c:/Users/user_name/emacs-25.3-x86_64/bin/emacsclientw.exe -c \n</code></pre>\n\n<p>a new frame can also pop up instantaneously without any noticeable impact to anything. </p>\n\n<p>so launch \"emacsclientw -c\" directly is fast, so is launch emacs through an outlook macro. but launch \"emacsclientw -c \" through an outlook macro is very slow.</p>\n\n<p>Can anyone shed some light on why this is the case?</p>\n\n<p>(BTW, \"runemacs.exe --daemon\" is part of my Windows startup script.)</p>\n"}, {"tags": ["excel", "vba", "string-search"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1556656065, "post_id": 55928197, "comment_id": 98510071, "body": "You need to include more of your code - it&#39;s impossible to tell what&#39;s happening from just these two lines. My guess is you&#39;re not resetting <code>ReasonCode</code> so it is still containing a previous value."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 5, "creation_date": 1556656105, "post_id": 55928197, "comment_id": 98510092, "body": "Also use <code>#</code> to match a single digit to simplify the first line - see the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/like-operator\" rel=\"nofollow noreferrer\"><code>Like</code></a> docs for more."}, {"owner": {"reputation": 117, "user_id": 8502642, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10212440635965104/picture?type=large", "display_name": "Marshall Gu", "link": "https://stackoverflow.com/users/8502642/marshall-gu"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1556719343, "post_id": 55928197, "comment_id": 98527645, "body": "@BigBen Funnily enough, the code originally had # but was giving the same results so I changed it to the like &quot;<i>1</i>&quot; etc. version as I wasn&#39;t familiar with #. I changed it back to # to match a single digit but again, it&#39;s still giving me &quot;Contains a number&quot; for cases that definitely do not contain a number."}, {"owner": {"reputation": 117, "user_id": 8502642, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10212440635965104/picture?type=large", "display_name": "Marshall Gu", "link": "https://stackoverflow.com/users/8502642/marshall-gu"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1556719423, "post_id": 55928197, "comment_id": 98527683, "body": "@dwirony I will edit the code in a moment. I added a reset but it&#39;s still giving me issues."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1556719769, "post_id": 55928197, "comment_id": 98527828, "body": "I&#39;d add more code than what you currently have. I agree with @dwirony&#39;s original comment - we need to see more. <code>Like</code> shouldn&#39;t be the issue. For example, if you enter <code>? &quot;marshall&quot; Like &quot;*#*&quot;</code> in the Immediate Window, you&#39;ll get <code>False</code>. I would think your reset should be at the beginning of the loop too."}, {"owner": {"reputation": 117, "user_id": 8502642, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10212440635965104/picture?type=large", "display_name": "Marshall Gu", "link": "https://stackoverflow.com/users/8502642/marshall-gu"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1556722321, "post_id": 55928197, "comment_id": 98529132, "body": "@BigBen moving the reset to the beginning fixed everything. Sorry, I facepalmed."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1556722352, "post_id": 55928197, "comment_id": 98529145, "body": "Well, easy fix! Glad to help out."}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 2, "last_activity_date": 1556664749, "last_edit_date": 1556664749, "creation_date": 1556659192, "answer_id": 55928787, "question_id": 55928197, "link": "https://stackoverflow.com/questions/55928197/vba-string-search-for-contains-a-number/55928787#55928787", "title": "VBA String Search for Contains a Number", "body": "<p><a href=\"https://stackoverflow.com/users/9245853\">BigBen</a> pretty much <a href=\"https://stackoverflow.com/questions/55928197/vba-string-search-for-contains-a-number#comment98510092_55928197\">answered your question on the usage of <code>#</code></a> with the <code>Like</code> operator, so I won't really go into that. But what I did notice is your usage of many Like operators in your If statement, so I figured I would take the opportunity to share a function I created a while ago and use frequently.</p>\n\n<p>The purpose of this function is to reduce multiple <code>Like</code> statements when comparing against a single value. While this function doesn't address your specific issue, it may be helpful in the future.</p>\n\n<pre><code>Function OrLike(ByVal compareVar As Variant, ParamArray CompareArgs() As Variant) As Boolean\n    Dim i As Long\n    If IsArray(CompareArgs(0)) Then\n        For i = LBound(CompareArgs(0)) To UBound(CompareArgs(0))\n            If compareVar Like CompareArgs(0)(i) Then\n                OrLike = True\n                Exit Function\n            End If\n        Next\n    Else\n        For i = LBound(CompareArgs) To UBound(CompareArgs)\n            If compareVar Like CStr(CompareArgs(i)) Then\n                OrLike = True\n                Exit Function\n            End If\n        Next i\n    End If\nEnd Function\n</code></pre>\n\n<p>First, the function checks the first value used in <code>CompareArgs</code>. If this value is an array, then it compares against the array, otherwise it will utilize the <code>ParamArray</code> keyword. This allows you to use this function in two ways:</p>\n\n<h1>With an Array variable as your arguments</h1>\n\n<pre><code>Dim Arr() As Variant\nArr = Array(\"Blah*\", \"Blah2*\")\n\nIf Orlike(\"BlahBlah\", Arr) Then\n    ' . . .\nEnd If\n</code></pre>\n\n<h1>Utilizing ParamArray</h1>\n\n<pre><code>If OrLike(\"BlahBlah\", \"Blah*\", \"Blah2*\") Then\n    ' . . .\nEnd If\n</code></pre>\n\n<hr>\n\n<p>Obviously, you don't want to use your current If statement that you provided. But if you were as an example, take a look how this function simplifies your statement and vastly improves readability by turning this:</p>\n\n<pre><code>ElseIf LastName Like \"*1*\" Or LastName Like \"*2*\" Or LastName Like \"*3*\" Or LastName Like \"*4*\" _\n            Or LastName Like \"*5*\" Or LastName Like \"*6*\" Or LastName Like \"*7*\" _\n            Or LastName Like \"*8*\" Or LastName Like \"*9*\" Or LastName Like \"*0*\" Then\n</code></pre>\n\n<p>Into this:</p>\n\n<pre><code>ElseIf OrLike(LastName, \"*1*\", \"*2*\", \"*3*\", \"*4*\", \"*5*\", \"*6*\", \"*7*\", \"*8*\", \"*9*\", \"*0*\") Then\n</code></pre>\n\n<hr>\n\n<p>Not only does it improve readability, but it may actually increase performance. The problem with VBA <code>If...Then</code> statements is that everything in the line must be evaluated, even after a statement that returns <code>True</code>.</p>\n\n<p>This function takes all of these arguments, and evaluates each statement until one becomes <code>True</code>, then it immediately exits the function - ignoring the remaining arguments. </p>\n"}], "owner": {"reputation": 117, "user_id": 8502642, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10212440635965104/picture?type=large", "display_name": "Marshall Gu", "link": "https://stackoverflow.com/users/8502642/marshall-gu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556719483, "creation_date": 1556655866, "last_edit_date": 1556719483, "question_id": 55928197, "link": "https://stackoverflow.com/questions/55928197/vba-string-search-for-contains-a-number", "title": "VBA String Search for Contains a Number", "body": "<p>I'm doing a data quality check on a large column of strings (ie. Last Name) and want to see if they contain a number.</p>\n\n<p>The VBA code that I've tried so far should be straight forward: if the LastName field contains 1 or 2 (etc.) than the ReasonCode = 3. Later on, if ReasonCode = 3, the results spits out \"Contains a number\"</p>\n\n<p>However, in situations like 'marshall', it's still populating \"Contains a number\"</p>\n\n<pre><code>ElseIf LastName Like \"*#*\" Or FirstName Like \"*#*\" Then\n\nReasonCode = 3\n\nEnd If\n\nElseIf ReasonCode = 3 Then\n\n    Cells(RowT, 16).Value = \"Contains a number\"\n\nReasonCode = 0\n\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1556655717, "post_id": 55928149, "comment_id": 98509949, "body": "It sounds like a filter would be an easier way to do this - simpler than looping through all rows. Also, just to note, recursion is not the same as iteration."}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 0, "creation_date": 1556656074, "post_id": 55928149, "comment_id": 98510074, "body": "If you read all of <code>A:B</code> into an array, you can loop over it to create a new array of just the items that have <code>Name    </code> in A and then you can paste just the second column into the new sheet."}, {"owner": {"reputation": 1, "user_id": 11317830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21e22c482d25c225ec42aa44cdc998a1?s=128&d=identicon&r=PG&f=1", "display_name": "Manu", "link": "https://stackoverflow.com/users/11317830/manu"}, "edited": false, "score": 0, "creation_date": 1556657136, "post_id": 55928149, "comment_id": 98510485, "body": "Can someone please provide an example.  I am kind of new to this.  Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 0, "last_activity_date": 1556659412, "creation_date": 1556659412, "answer_id": 55928828, "question_id": 55928149, "link": "https://stackoverflow.com/questions/55928149/how-do-i-make-a-function-recursive/55928828#55928828", "title": "How do I make a function recursive", "body": "<p>you can just loop through the range of cells and use offset to get the value in column B to place in the new worksheet.  It doesn't need to be recursive</p>\n\n<pre><code>Sub Test()\nDim c As Range\nDim iRow As Long\n    iRow = 1\n    For Each c In Sheets(\"original\").Range(\"A:A\")\n    If c.Value = \"Name        \" Then\n        Sheets(\"new\").Cells(iRow, 1).Value = c.Offset(0, 1).Value\n        'move to the next row\n        iRow = iRow + 1\n    End If\n    Next c\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 11440229, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/875faee8aa467190173d80439bcd685b?s=128&d=identicon&r=PG", "display_name": "user11440229", "link": "https://stackoverflow.com/users/11440229/user11440229"}, "is_accepted": false, "score": 0, "last_activity_date": 1556779075, "creation_date": 1556779075, "answer_id": 55946883, "question_id": 55928149, "link": "https://stackoverflow.com/questions/55928149/how-do-i-make-a-function-recursive/55946883#55946883", "title": "How do I make a function recursive", "body": "<p>Here bis an example using standard 2-D arrays. A dictionary is another array based option. An AutoFilter or Advanced Filter removes the need for arrays and/or iteration through the rows.</p>\n\n<p>Note that this does not loop through 'all the rows in column A'. It stops looping when there are no more values in column B that could be returned.</p>\n\n<pre><code>Sub Test2()\n    '\n    'https://stackoverflow.com/questions/55928149\n    '\n\n    Dim i As Long, arr As Variant, bees As Variant\n\n    With Worksheets(\"original\")\n\n        'collect source values\n        arr = .Range(.Cells(7, \"A\"), .Cells(.Rows.Count, \"B\").End(xlUp)).Value2\n\n        'prepare target array\n        ReDim bees(1 To 1, 1 To 1)\n\n        'loop through source value array and retain column B based on condition\n        For i = LBound(arr, 1) To UBound(arr, 1)\n            'case insensitive comparison\n            If LCase(arr(i, 1)) = LCase(\"Name        \") Then\n                'assign column B value to target array\n                bees(1, UBound(bees, 2)) = arr(i, 2)\n                'make room for next matching value\n                ReDim Preserve bees(1 To 1, 1 To UBound(bees, 2) + 1)\n            End If\n        Next i\n\n        'trim off the last unused element of the target array\n        ReDim Preserve bees(1 To 1, 1 To UBound(bees, 2) - 1)\n\n    End With\n\n    'add new worksheet at end of worksheets queue\n    With Worksheets.Add(after:=Worksheets(Worksheets.Count))\n\n        'rename new worksheet\n        .Name = \"bees\"\n\n        'put target array in new worksheet starting at A2\n        .Cells(2, \"A\").Resize(UBound(bees, 2), UBound(bees, 1)) = _\n            Application.Transpose(bees)\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11317830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21e22c482d25c225ec42aa44cdc998a1?s=128&d=identicon&r=PG&f=1", "display_name": "Manu", "link": "https://stackoverflow.com/users/11317830/manu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1556779220, "creation_date": 1556655639, "last_edit_date": 1556779220, "question_id": 55928149, "link": "https://stackoverflow.com/questions/55928149/how-do-i-make-a-function-recursive", "title": "How do I make a function recursive", "body": "<p>I have a huge set of data (almost 12k rows).  I want t search column A for a keyword (Ex: name\") and then move its corresponding value from column B to a new sheet.  I have this working but can't figure out how to make it recursive so it looks at all 12k entries in column A.  Please help.</p>\n\n<p>See script below that works, but needs to be recursive</p>\n\n<pre><code>Sub Test()\n\nWith Sheets(\"original\")\n    If .Range(\"A24\").Value = \"Name        \" Then\n        Sheets(\"new\").Range(\"A1\").Value = .Range(\"B24\").Value\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "function"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11385583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7482cb858eca6635bc3b9f946c85470f?s=128&d=identicon&r=PG&f=1", "display_name": "wsn3", "link": "https://stackoverflow.com/users/11385583/wsn3"}, "edited": false, "score": 0, "creation_date": 1556656434, "post_id": 55928216, "comment_id": 98510219, "body": "Thanks for the thought. but the prior value is needed in the calculation.  I just want to reference it relative to nEMA, not actually select it as input."}, {"owner": {"reputation": 19, "user_id": 11385583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7482cb858eca6635bc3b9f946c85470f?s=128&d=identicon&r=PG&f=1", "display_name": "wsn3", "link": "https://stackoverflow.com/users/11385583/wsn3"}, "edited": false, "score": 0, "creation_date": 1556656594, "post_id": 55928216, "comment_id": 98510283, "body": "The nEMA1 variable is normally one (1) row above the Function output and is the value of the 1 period earlier calculation. Thank you anyway."}, {"owner": {"reputation": 19, "user_id": 11385583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7482cb858eca6635bc3b9f946c85470f?s=128&d=identicon&r=PG&f=1", "display_name": "wsn3", "link": "https://stackoverflow.com/users/11385583/wsn3"}, "edited": false, "score": 0, "creation_date": 1556659713, "post_id": 55928216, "comment_id": 98511338, "body": "Thank for the response. Very helpful."}], "tags": [], "owner": {"reputation": 341, "user_id": 8826022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb38589eec35643089af93724c1d9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Murphy", "link": "https://stackoverflow.com/users/8826022/michael-murphy"}, "is_accepted": true, "score": 0, "last_activity_date": 1556657282, "last_edit_date": 1556657282, "creation_date": 1556655951, "answer_id": 55928216, "question_id": 55927941, "link": "https://stackoverflow.com/questions/55927941/eliminating-prior-calculation-address-in-vba-function/55928216#55928216", "title": "Eliminating Prior Calculation Address in VBA Function", "body": "<p>This function will use the value in the same column and one row above the cell it is written in instead of <code>nEMA1</code></p>\n\n<pre><code>'Exponential Moving Average\nFunction nEMA(Price, Periods)\n'Variables\nAlpha = (2 / (Periods + 1))\n\n'Formula Calculation\n' Uses the value above the formula in the calculation\nnEMA = (Alpha * Price) + ((1 - Alpha) * Application.Caller.Offset(-1))\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11385583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7482cb858eca6635bc3b9f946c85470f?s=128&d=identicon&r=PG&f=1", "display_name": "wsn3", "link": "https://stackoverflow.com/users/11385583/wsn3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 55928216, "answer_count": 1, "score": 0, "last_activity_date": 1556657282, "creation_date": 1556654481, "last_edit_date": 1556654532, "question_id": 55927941, "link": "https://stackoverflow.com/questions/55927941/eliminating-prior-calculation-address-in-vba-function", "title": "Eliminating Prior Calculation Address in VBA Function", "body": "<p>Have a simple problem with trying to simplify the code and use in a VBA function for calculating Exponential Moving Average (EMA). Current code is as follows:</p>\n\n<pre><code>'Exponential Moving Average\nFunction nEMA(Price, Periods, nEMA1)\n'Variables\nAlpha = (2 / (Periods + 1))\n\n'Formula Calculation\nnEMA = (Alpha * Price) + ((1 - Alpha) * nEMA1)\n\nEnd Function\n</code></pre>\n\n<p>I would like to eliminate the prior calculation input \"nEMA1.\"  This solution has a wide range of other application functions, as well. Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1556654386, "post_id": 55927891, "comment_id": 98509410, "body": "You&#39;ve declared <code>result</code> but are trying to use <code>result1</code>. That said, I&#39;d just use <code>.Range(&quot;A1:E5&quot;)</code> instead of <code>Cells</code> calls within <code>Range</code>..."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1556655163, "post_id": 55928006, "comment_id": 98509725, "body": "....and with the latest edit my typo comment is no longer applicable haha."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1556709879, "last_edit_date": 1556709879, "creation_date": 1556654792, "answer_id": 55928006, "question_id": 55927891, "link": "https://stackoverflow.com/questions/55927891/how-to-perform-operations-across-multiple-sheets-within-one-sub-function/55928006#55928006", "title": "How to perform operations across multiple sheets within one &quot;sub&quot; function", "body": "<p>Replace:</p>\n\n<pre><code>result1.Range(Cells(1, 1), Cells(5, 5)).Value = \"1\"\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>Range(result1.Cells(1, 1), result1.Cells(5, 5)).Value = \"1\"\n</code></pre>\n\n<p><em>(same with <code>result2</code>)</em></p>\n\n<p><strong>WHY:</strong></p>\n\n<p>The <code>Range()</code> function is very versatile in the kind of inputs it will accept.  For example:</p>\n\n<ol>\n<li>a string</li>\n<li>a set of strings</li>\n<li>a set of other  \"smaller\" ranges</li>\n</ol>\n\n<p>It is the last form that requires caution.  If you don't qualify the \"little\" ranges, Excel assumes you mean to use the cells on the Activesheet.</p>\n"}], "owner": {"reputation": 3, "user_id": 11434391, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-67WtyJ6pXCw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdRZf1phDumxXiQBUGp3MDTRDBH5w/mo/photo.jpg?sz=128", "display_name": "Max", "link": "https://stackoverflow.com/users/11434391/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "closed_date": 1556670628, "accepted_answer_id": 55928006, "answer_count": 1, "score": 0, "last_activity_date": 1556709879, "creation_date": 1556654243, "last_edit_date": 1556655036, "question_id": 55927891, "link": "https://stackoverflow.com/questions/55927891/how-to-perform-operations-across-multiple-sheets-within-one-sub-function", "closed_reason": "Duplicate", "title": "How to perform operations across multiple sheets within one &quot;sub&quot; function", "body": "<p>For the purpose of this, I want to insert values into two separate worksheets within one workbook.</p>\n\n<p>Why doesn't this work?</p>\n\n<pre><code>Sub TEST()\n\n    Dim result1 As Worksheet\n    Dim result2 As Worksheet\n\n    Set result1 = ActiveWorkbook.Sheets(\"Sheet1\")\n    Set result2 = ActiveWorkbook.Sheets(\"Sheet2\")\n\n    result1.Range(Cells(1, 1), Cells(5, 5)).Value = \"1\"\n\n    result2.Range(Cells(1, 1), Cells(5, 5)).Value = \"2\"\n\n\nEnd Sub\n</code></pre>\n\n<p>I expected this to make the values in the range <code>A1:E5</code> '1' on the first sheet and '2' on the second sheet. I know:</p>\n\n<pre><code>Range(Cells(1, 1), Cells(5, 5)).Value = \"1\"\n</code></pre>\n\n<p>works, but I'm not 100% confident the rest.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1556652677, "post_id": 55927535, "comment_id": 98508746, "body": "You may have to convert the textbox to a numerical value as by default it&#39;s text. In any case <code>valuecharge</code> will only ever show the last value as you are overwriting."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1556652964, "post_id": 55927535, "comment_id": 98508843, "body": "You could try adding <code>Exit For</code> after assigning the value to <code>ValueCharge</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11434301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4444ab7f761a4e9608b997a8300ef8c4?s=128&d=identicon&r=PG&f=1", "display_name": "Bpierson85", "link": "https://stackoverflow.com/users/11434301/bpierson85"}, "edited": false, "score": 0, "creation_date": 1556655208, "post_id": 55927806, "comment_id": 98509742, "body": "That worked perfectly. Macro functioning as desired. Thank you."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11434297"}, "is_accepted": false, "score": 1, "last_activity_date": 1556653740, "creation_date": 1556653740, "answer_id": 55927806, "question_id": 55927535, "link": "https://stackoverflow.com/questions/55927535/trouble-with-comparing/55927806#55927806", "title": "Trouble with Comparing", "body": "<p>TextBox5 is only text that looks a number. You need to convert to a true numerical value for a valid comparison.</p>\n\n<pre><code>    For i = 1 To 216 Step 1\n        If Sheet2.Cells(i, 1).Value &gt;= val(TextBox5) Then\n            ValueCharge = Sheet2.Cells(i, 2).Value\n            Exit For\n        End If\n    Next i\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11434301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4444ab7f761a4e9608b997a8300ef8c4?s=128&d=identicon&r=PG&f=1", "display_name": "Bpierson85", "link": "https://stackoverflow.com/users/11434301/bpierson85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556653740, "creation_date": 1556652472, "question_id": 55927535, "link": "https://stackoverflow.com/questions/55927535/trouble-with-comparing", "title": "Trouble with Comparing", "body": "<p>I am trying to compare my User Form input to a column of numbers in excel; find the number that my User Form input is less than or equal to and assign a variable the value of the cell next to the cell it was compared to (i.e. if Input is less than or equal to A2 then variable is set equal to B20) When I do this, it gives me the last value in the B column whether or not the Input value is less than the A column. </p>\n\n<p>I have tried an Exit For after the If Then but this just stops it after the first iteration. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub CommandButton2_Click()\nDim TextBox5 As Integer\nIf UserForm1.OptionButtonRes.Value = True Then\n        Dim i As Integer\n        For i = 1 To 216 Step 1\n            If Sheet2.Cells(i, 1).Value &gt;= TextBox5 Then\n            ValueCharge = Sheet2.Cells(i, 2).Value\n            End If\n        Next i\nEnd If\nMsgBox (ValueCharge)\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1556650926, "post_id": 55927167, "comment_id": 98508049, "body": "On your line <code>lcCal=</code> you should have <code>xlToLeft</code> instead of right.  You are going to the last column every time.  You should also put <code>Option Explicit</code> above your sub.  You will see that not all your variables are declared and you are mixing them up.  <code>lcCal</code> and <code>lrCal</code>."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1556651403, "post_id": 55927167, "comment_id": 98508248, "body": "In addition, where you are using <code>lrCal</code>, you will have two column identifiers, which will give you odd results.  You will want the row, then column."}, {"owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1556652226, "post_id": 55927167, "comment_id": 98508578, "body": "Ok, so I just updated the code a little bit.  I created a table of the area where I want the data to be filled in (&quot;Sale&quot;). Now I do not know how to set it up to go to the next available column."}, {"owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1556653633, "post_id": 55927167, "comment_id": 98509097, "body": "I set up lrEmp because it is in a different sheet and that I want it to enter the data by row, but for lcCal is in a different sheet and I want that to fill in data by column. Sorry for it being a little complicated. @DarrellH"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1556653866, "post_id": 55927167, "comment_id": 98509204, "body": "<code>lrCal</code> is not declared nor set.  I gave you an answer below."}, {"owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1556654134, "post_id": 55927167, "comment_id": 98509309, "body": "Yes i see, thank you. I mistyped it actually, it is IrCal"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "edited": false, "score": 0, "creation_date": 1556652430, "post_id": 55927339, "comment_id": 98508654, "body": "It said object doesn&#39;t support"}], "tags": [], "owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "is_accepted": false, "score": 0, "last_activity_date": 1556821552, "last_edit_date": 1556821552, "creation_date": 1556651446, "answer_id": 55927339, "question_id": 55927167, "link": "https://stackoverflow.com/questions/55927167/how-to-set-up-my-input-data-on-a-specific-cell-in-userform/55927339#55927339", "title": "How to set up my input data on a specific cell in Userform?", "body": "<p>If you're trying to find the column to the right of the last used column, try this:  Two sheets, one named Testcal and one named Main.</p>\n\n<pre><code>Private Sub TestCal()\nlccal = Sheets(\"TestCal\").Cells(1, Columns.Count).End(xlToLeft).Column + 1\nSheets(\"Main\").Cells(1, 1) = lccal\nEnd Sub\n</code></pre>\n\n<p>This returns the column to the right of the rightmost used column of whichever row you choose in Testcal. </p>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "edited": false, "score": 0, "creation_date": 1556654095, "post_id": 55927798, "comment_id": 98509283, "body": "The data is going from left to right, but thank you. This work now."}], "tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1556653698, "creation_date": 1556653698, "answer_id": 55927798, "question_id": 55927167, "link": "https://stackoverflow.com/questions/55927167/how-to-set-up-my-input-data-on-a-specific-cell-in-userform/55927798#55927798", "title": "How to set up my input data on a specific cell in Userform?", "body": "<p>Not sure where 7 through 10 comes from, maybe 7 is a header?</p>\n\n<pre><code>'This is the part I am having trouble with\nlcCal = Sheets(\"TestCal\").Cells(7,columns.count).End(xlToLeft).Column + 1\nWith Sheets(\"TestCal\")\n     .Cells(8, lcCal).Value = tbApple.Text\n     .Cells(9, lcCal).Value = tbOrange.Text\n     .Cells(10, lcCal).Value = tbBanana.Text\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 55927798, "answer_count": 2, "score": -1, "last_activity_date": 1556821552, "creation_date": 1556650611, "last_edit_date": 1556654410, "question_id": 55927167, "link": "https://stackoverflow.com/questions/55927167/how-to-set-up-my-input-data-on-a-specific-cell-in-userform", "title": "How to set up my input data on a specific cell in Userform?", "body": "<p>I want to start adding data from a specific cell and stop at another cell. From I7:I10 to T7:T10. \nBut I want to enter the data from the Userform. But whenever I entered the data, it is saying I am on Cell 16,000 something. </p>\n\n<p>I have two data set, and one tab in the userform work well, it would enter the data in rows. But for the other tab, I would like it to enter it by the next column. I have data below I7 by the way. But some of the areas are blank and some with data. \nOne of the tabs from Userform is going to a separate sheet called Employee and the other going to TestCal.</p>\n\n<pre><code>Private Sub CBSave_Click()\n\nDim lrEmp as Long\nDim lrCal as Long\n\n'This part work fine\nlrEmp = Sheets(\"Employee\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nWith Sheets(\"Employee\")\n    .Cells(lrEmp + 1, \"A\").Value = tbEmpID.Text\n    .Cells(lrEmp + 1, \"B\").Value = tbName.Text\n    .Cells(lrEmp + 1, \"C\").Value = tbLast.Text\nEnd With\n\n'This is the part I am having trouble with\nlcCal = Sheets(\"TestCal\").Range(\"Sales\") .End(xlToLeft).Column\nWith Sheets(\"TestCal\")\n     .Cells(lrCal, \"I\").Value = tbApple.Text\n     .Cells(lrCal + 1, \"I\").Value = tbOrange.Text\n     .Cells(lrCal + 2, \"I\").Value = tbBanana.Text\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I think I set up my column one wrong, how would I set it up where the next data entry will go to the right. Right now, the data entry is being inputted all the way down to the 16,000 cells for some reason. </p>\n\n<p>**Forgot to mention this, tbApple, tbOrange, and tbBanana are all in the same column. I want to get the next column with them like that. </p>\n\n<p>I hope I am making sense. Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1556650488, "post_id": 55927108, "comment_id": 98507860, "body": "Is vba really necessary, as this can be done with a simple formula: <code>=SUM(INDEX(26:999999,0,MATCH(&quot;Amount&quot;,25:25,0)))</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1556650832, "post_id": 55927108, "comment_id": 98508014, "body": "If you want vba to put the formula in then <code>Range(&quot;N22&quot;).Formula = &quot;=SUM(INDEX(26:999999,0,MATCH(&quot;&quot;Amount&quot;&quot;,25:25,0)))&quot;</code>"}, {"owner": {"reputation": 13, "user_id": 11401391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59176a818cff8fb7db5f9adf2b9c0053?s=128&d=identicon&r=PG&f=1", "display_name": "MiriamLara", "link": "https://stackoverflow.com/users/11401391/miriamlara"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1556742038, "post_id": 55927108, "comment_id": 98537682, "body": "Scott, perfect.... I used the formula that you send me in the vba and it works perfect. thanks a lot."}], "owner": {"reputation": 13, "user_id": 11401391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59176a818cff8fb7db5f9adf2b9c0053?s=128&d=identicon&r=PG&f=1", "display_name": "MiriamLara", "link": "https://stackoverflow.com/users/11401391/miriamlara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1556780436, "creation_date": 1556650333, "last_edit_date": 1556780436, "question_id": 55927108, "link": "https://stackoverflow.com/questions/55927108/how-find-column-letter-by-column-name-to-use-in-sum-formula-in-vba", "title": "How find column letter by column name to use in SUM formula in vba?", "body": "<p>I need to make a formula SUM in a Cell in VBA but I don't know which Column letter I need to sum. I know the column Name that it's equal to \"AMOUNT\" and the line that is locate the header of the line 25.</p>\n\n<pre><code>Sample: The column J line 25 has the header \"Amount\", so my formula needs to be equal below:\n\nRange(\"N22\").Select\nActiveCell.FormulaLocal = \"=SUM(J26:J999999)\"\n</code></pre>\n\n<p>So, I need a code in VBA to find the letter J to put in my formula below.</p>\n\n<pre><code>Range(\"N22\").Select\nActiveCell.FormulaLocal = \"=SUM(J26:J999999)\"\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556653044, "post_id": 55927004, "comment_id": 98508876, "body": "Can you share several urls where this is the case please?"}, {"owner": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556654685, "post_id": 55927004, "comment_id": 98509528, "body": "<a href=\"https://www.betexplorer.com/soccer/australia/a-league/stats/\" rel=\"nofollow noreferrer\">betexplorer.com/soccer/australia/a-league/stats</a> <a href=\"https://www.betexplorer.com/soccer/austria/tipico-bundesliga/stats/\" rel=\"nofollow noreferrer\">betexplorer.com/soccer/austria/tipico-bundesliga/stats</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556654755, "post_id": 55927004, "comment_id": 98509551, "body": "I&#39;ve given a few ways to try below."}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556662439, "post_id": 55927004, "comment_id": 98512203, "body": "Have you tried to connect to web lage through standard import external data master of Excel? It is very pretty sees tables on web pages and allows to insert them directly to sheet?"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556654882, "post_id": 55927738, "comment_id": 98509603, "body": "From what i can tell the only consistent is class=&quot;list-tabs__item__in&quot;&gt;Main&lt;/a&gt;&lt;/li&gt;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556654987, "post_id": 55927738, "comment_id": 98509658, "body": "If id is not consistent then use bottom example and the second method for switching to main tab within that example"}, {"owner": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556655215, "post_id": 55927738, "comment_id": 98509744, "body": "in fact the main difference is on a page where there are no tabs, the sm-0-0 id does not exist"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556655278, "post_id": 55927738, "comment_id": 98509775, "body": "Can you share that url? Does the bottom example not work?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556655634, "post_id": 55927738, "comment_id": 98509921, "body": "Seems fine. That is what I classify as normal page. 1 row of tabs and no Championship tab."}, {"owner": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556655985, "post_id": 55927738, "comment_id": 98510043, "body": "OK. So id need to implement that to the GetSoccerStats Sub? I tried adding it just before the Do DoEvents and it redirects fine, i then get a run time error. It must be me as i am not 100% sure where to put the code"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556656091, "post_id": 55927738, "comment_id": 98510081, "body": "You want it after: While .Busy Or .readyState &lt; 4: DoEvents: Wend  but you may need an additional wait before it."}, {"owner": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556656528, "post_id": 55927738, "comment_id": 98510257, "body": "Where i put it i get a run time error 70 Permission Denied on this line : text = objTableRow.Cells(0).innerText. If i put it where you suggest i get a run time error 91 Object variable or with block variable not defined. on on the same line"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556656671, "post_id": 55927738, "comment_id": 98510314, "body": "I&#39;ve added an example with one with/without"}, {"owner": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556657511, "post_id": 55927738, "comment_id": 98510621, "body": "Thanks, i have tried implementing it to the Sub GetSoccerStats that you created, i still get a run time error. I must be missing a trick (or simply the knowledge). Thanks for all your help btw ;)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556657837, "post_id": 55927738, "comment_id": 98510742, "body": "I can see two oversights (and they are my fault)  - I have gone back and corrected. Your current script should be something like:  <a href=\"https://pastebin.com/1Ram4xzZ\" rel=\"nofollow noreferrer\">pastebin.com/1Ram4xzZ</a>"}, {"owner": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556658747, "post_id": 55927738, "comment_id": 98511020, "body": "Ok great, that seems to work... except.... i get a run time 70 permission denied on this line : results(r, c + 1) = objTableRow.Cells(2).innerText. Whats weird is that it doesn&#39;t happen on the same league each time, sometimes i will get past 5 or 6 leagues and sometimes it will go through 20 and fail... Is it a timing thing?"}, {"owner": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556658906, "post_id": 55927738, "comment_id": 98511090, "body": "Or could it be that there are some pages that have tabs, but they actually load on the main tab....so changing tabs would not work because its already on the correct tab..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556659133, "post_id": 55927738, "comment_id": 98511160, "body": "Try changing Set objTable = Nothing  to  Set objTable = Nothing:  Set objTableRow = Nothing"}, {"owner": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556659454, "post_id": 55927738, "comment_id": 98511251, "body": "Changing that this time i got a 91 error on this line : results(r, c) = objTableRow.Cells(1).innerText"}, {"owner": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556659594, "post_id": 55927738, "comment_id": 98511295, "body": "currently running at a second time... and i got the run time 70 on objTableRow.Cells(0).innerText"}, {"owner": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556659628, "post_id": 55927738, "comment_id": 98511309, "body": "it was also not on the same league."}, {"owner": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556659699, "post_id": 55927738, "comment_id": 98511332, "body": "It seems as if the page dosnt load quickly i get the error"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1556659866, "post_id": 55927738, "comment_id": 98511383, "body": "Yeah.... you see where I say in the code additional wait may be required?"}, {"owner": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556659904, "post_id": 55927738, "comment_id": 98511392, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/192651/discussion-between-user3672422-and-qharr\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1556656654, "last_edit_date": 1556656654, "creation_date": 1556653368, "answer_id": 55927738, "question_id": 55927004, "link": "https://stackoverflow.com/questions/55927004/how-can-i-see-if-a-tab-within-an-html-page-exists-and-if-so-link-to-it-to-scrape/55927738#55927738", "title": "How can i see if a tab within an HTML page exists and if so link to it to scrape data?", "body": "<p>There are lots of possible ways to go about this. You are testing for differences between the pages that are consistent. For example,  there are double rows of tabs for pages where the Championship occurs. There is stats tab row above and Championship tab row below. The id (if consistent across Championship tab pages) <code>sm-0-0</code> is only present in Championship tab pages and not in the normal pages. Also, you may only find class <code>list-tabs--secondary</code>  where there is the championship secondary row</p>\n\n<p>Here are a few possibilities:</p>\n\n<p>If the <code>href</code> had a consistent string, that uniquely identifies the Championship tab, you could test for the presence of that</p>\n\n<pre><code>If ie.document.querySelectorAll(\"[href*='stage=hrVVyPkq']\").length &gt; 0 Then\n    'Championship tab is present \nElse\n   'Championship tab is not present \nEnd If\n</code></pre>\n\n<hr>\n\n<p>Alternatively, you could test the length of default tabs on the page by class. If you have Championship tab as default (as well as the Stats parent/supra tab)  then you get a length of 2. If you have a length of 1 it is just normal.</p>\n\n<pre><code>If ie.document.querySelectorAll(\".list-tabs__item__in.current\").length &gt; 1 Then\n    'championship tab present\nElse\n    'Championship tab is not present \nEnd If\n</code></pre>\n\n<hr>\n\n<p>Testing for id (if consistently the same across championship pages)</p>\n\n<pre><code>If ie.document.querySelectorAll(\"#sm-0-0\").length &gt; 0 Then\n'championship tab present\n'switch to main\n    ie.document.querySelector(\"#sm-0-0 a\").click 'or &gt;\n    ie.document.querySelector(\".list-tabs--secondary a\").click\nElse\n    'Championship tab is not present \nEnd If\n</code></pre>\n\n<hr>\n\n<p>Testing for secondary tab row class</p>\n\n<pre><code>If ie.document.querySelectorAll(\".list-tabs--secondary\").length &gt; 0 Then\n'championship tab present\n'switch to main\n    ie.document.querySelector(\"#sm-0-0 a\").click 'or &gt;\n    ie.document.querySelector(\".list-tabs--secondary a\").click\nElse\n    'Championship tab is not present \nEnd If\n</code></pre>\n\n<hr>\n\n<p><strong>Example implementation:</strong></p>\n\n<pre><code>Option Explicit\n\n'VBE &gt; Tools &gt; References:\n' Microsoft Internet Controls\nPublic Sub GetImageLinks()\n    Const MAX_WAIT_SEC As Long = 10\n    Dim ie As New InternetExplorer, i As Long, links(), objTable As MSHTML.HTMLTable, t As Date\n    links = Array(\"https://www.betexplorer.com/soccer/austria/tipico-bundesliga/stats/\", \"https://www.betexplorer.com/soccer/belgium/jupiler-league/stats/\")\n    'the first above has championship tab\n    With ie\n        .Visible = True\n        For i = LBound(links) To UBound(links)\n            .Navigate2 links(i)\n\n            While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n            If .document.querySelectorAll(\".list-tabs--secondary\").Length &gt; 0 Then\n                'championship tab present\n                'switch to main\n                .document.querySelector(\".list-tabs--secondary a\").Click\n\n                While .Busy Or .readyState &lt; 4: DoEvents: Wend\n            Else                                 'you don't need this part\n                'Championship tab is not present\n            End If\n\n            t = Timer\n            Do\n                DoEvents\n                On Error Resume Next\n                Set objTable = .document.getElementsByClassName(\"table-main leaguestats\")(0)\n                On Error GoTo 0\n                If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n            Loop While objTable Is Nothing\n            Debug.Print objTable.NamespaceURI\n            Set objTable = Nothing\n        Next\n        Stop\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 55927738, "answer_count": 1, "score": 1, "last_activity_date": 1556779216, "creation_date": 1556649903, "last_edit_date": 1556779216, "question_id": 55927004, "link": "https://stackoverflow.com/questions/55927004/how-can-i-see-if-a-tab-within-an-html-page-exists-and-if-so-link-to-it-to-scrape", "title": "How can i see if a tab within an HTML page exists and if so link to it to scrape data?", "body": "<p>I have some code (thanks to another user) which opens IE goes to a website and scrapes the data and feeds it back in to my sheet. The code works exactly how it should but i have a slight problem with it.</p>\n\n<p>The code is as follows</p>\n\n<pre><code>'VBE &gt; Tools &gt; References:'1: Microsoft HTML Object library  2: Microsoft Internet Controls\nPublic Sub GetSoccerStats()\nDim ie As Object, t As Date\nDim objDoc As New MSHTML.HTMLDocument, text As String\nDim lastRow As Long, dataSheet As Worksheet, inputArray(), i As Long\n\n\nConst MAX_WAIT_SEC As Long = 10\n\n\nSet dataSheet = ThisWorkbook.Worksheets(\"AVG GOAL DATA\")\nSet ie = CreateObject(\"InternetExplorer.Application\")\nWith dataSheet\n    lastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\nEnd With\n\n\ninputArray = dataSheet.Range(\"C4:E\" &amp; lastRow).Value\ninputArray = GetLinks(inputArray)\n\n\nDim results(), r As Long, c As Long\nReDim results(1 To UBound(inputArray, 1), 1 To 8)\n\n\nWith ie\n    .Visible = True\n    For i = LBound(inputArray, 1) To UBound(inputArray, 1)\n        r = r + 1\n        .navigate2 inputArray(i, 4)\n\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n\n        Dim objTable As MSHTML.HTMLTable, objTableRow As MSHTML.HTMLTableRow\n\n\n        Do\n            DoEvents\n            On Error Resume Next\n            Set objTable = .document.getElementsByClassName(\"table-main leaguestats\")(0)\n            On Error GoTo 0\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While objTable Is Nothing\n\n\n        If Not objTable Is Nothing Then\n            c = 1\n            For Each objTableRow In objTable.Rows\n                text = objTableRow.Cells(0).innerText\n                Select Case text\n                Case \"Matches played\", \"Matches remaining\", \"Home goals\", \"Away goals\"\n                    results(r, c) = objTableRow.Cells(1).innerText\n                    results(r, c + 1) = objTableRow.Cells(2).innerText\n                    c = c + 2\n                End Select\n            Next objTableRow\n        End If\n    Next\n    .Quit\nEnd With\ndataSheet.Range(\"F4\").Resize(UBound(results, 1), UBound(results, 2)) = results\nEnd Sub\n\nPublic Function GetLinks(ByRef inputArray As Variant) As Variant\nDim i As Long\nReDim Preserve inputArray(1 To UBound(inputArray, 1), 1 To UBound(inputArray, 2) + 1)\n\n\nFor i = LBound(inputArray, 1) To UBound(inputArray, 1)\n    inputArray(i, 4) = IIf(inputArray(i, 1) = \"CURRENT\", inputArray(i, 2), inputArray(i, 3))\nNext\nGetLinks = inputArray\nEnd Function\n</code></pre>\n\n<p>So, I have a worksheet that has a list of Football Leagues (in the rows), then columns hold the data. This code fetches data from betexplorer.com and populates this sheet (each row contains data corresponding to a league)</p>\n\n<p>At the moment this code looks on my sheet to see that if in column C, the word is CURRENT, then use the URL provided in column D. If column C contains the word LAST it takes the URL from column E.</p>\n\n<p>The problem is that Some leagues towards the end of the season get split in to groups (See <a href=\"https://www.betexplorer.com/soccer/belgium/jupiler-league/stats/\" rel=\"nofollow noreferrer\">https://www.betexplorer.com/soccer/belgium/jupiler-league/stats/</a>) As you notice when you land on this page it defaults you to giving stats to the 'Championship group' However there is a tab to the left that says 'main'. This is the data i need on the main tab. The further problem is that not all leagues have this. As far as i can tell, the 'main' stats tab has a different URL within an HREF tag so perhaps the VBA can use the link i provide on the worksheet, check to see if a 'main' tab exists, if it does not then just pull the data from that page, or if it does then redirect to the URL for the 'main' tab and pull the data from that one... </p>\n\n<p>The HTML looks like this: </p>\n\n<pre><code>&lt;li class=\"list-tabs__item\"&gt;&lt;a href=\"?stage=z3r4t5sS\" class=\"list-tabs__item__in\"&gt;Main&lt;/a&gt;&lt;/li&gt;\n&lt;li class=\"list-tabs__item\"&gt;&lt;a href=\"?stage=hrVVyPkq\" class=\"list-tabs__item__in current\"&gt;Championship Group&lt;/a&gt;&lt;/li&gt;\n&lt;li class=\"list-tabs__item\"&gt;&lt;a href=\"?stage=EPykCdW0\" class=\"list-tabs__item__in\"&gt;Europa League Group&lt;/a&gt;&lt;/li&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4074964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd3425091510bc5d01f23f20d1481147?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/4074964/nick"}, "edited": false, "score": 0, "creation_date": 1556648732, "post_id": 55926557, "comment_id": 98507149, "body": "This crashes VBA because (I think) the while loop is executing so fast and always seeing its still loaded."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 27, "user_id": 4074964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd3425091510bc5d01f23f20d1481147?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/4074964/nick"}, "edited": false, "score": 0, "creation_date": 1556648967, "post_id": 55926557, "comment_id": 98507243, "body": "You probably would need to add a <code>DoEvents</code> Line in the loop as well and/or a timer that waits to call the function."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 27, "user_id": 4074964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd3425091510bc5d01f23f20d1481147?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/4074964/nick"}, "edited": false, "score": 0, "creation_date": 1556650074, "post_id": 55926557, "comment_id": 98507690, "body": "@Nick FWIW <code>While</code>-waiting like this is really, <i>really</i> stretching the procedural paradigm well beyond what&#39;s acceptable IMO."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 27, "user_id": 4074964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd3425091510bc5d01f23f20d1481147?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/4074964/nick"}, "edited": false, "score": 1, "creation_date": 1556700037, "post_id": 55926557, "comment_id": 98519967, "body": "@Nick - FYI I recommend reading the related topic <a href=\"https://stackoverflow.com/questions/47357708/vba-destroy-a-modeless-userform-instance-properly\">destroy a modeless userform instance properly</a> based on Mathieu&#39;s outstanding overview <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">&quot;UserForm1.Show?&quot;</a>"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 2, "last_activity_date": 1556666482, "last_edit_date": 1556666482, "creation_date": 1556647714, "answer_id": 55926557, "question_id": 55926451, "link": "https://stackoverflow.com/questions/55926451/how-to-have-vba-code-wait-until-vbmodeless-userform-is-closed/55926557#55926557", "title": "How to have VBA code wait until vbModeless userform is closed", "body": "<p>I didn't author the following function, but I have used it for a long time and it works.</p>\n\n<pre><code>Private Function IsLoaded(ByVal formName As String) As Boolean\n    Dim frm As Object\n    For Each frm In VBA.UserForms\n        If frm.Name = formName Then\n            IsLoaded = True\n            Exit Function\n        End If\n    Next frm\n    IsLoaded = False\nEnd Function\n</code></pre>\n\n<p>You will need to hardcode the string name, and not use the <code>.Name</code> property of the form because the form may not be loaded yet and not contain this property.</p>\n\n<p>Here is a small snippet of how you can use this function:</p>\n\n<pre><code>Do While IsLoaded(\"StartingSINT_Popup\")\n    Debug.Print Time; \" StartingSINT_Popup Is Loaded!\"\nLoop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1556650328, "post_id": 55926975, "comment_id": 98507788, "body": "Well said. Might have to replace my function!"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "edited": false, "score": 0, "creation_date": 1589239362, "post_id": 55926975, "comment_id": 109209812, "body": "How can we have an event be triggered after <code>presenter.Show</code> executes with this approach? Currently UserForm_Activate does nothing, primarily looking to load a model into the form"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "edited": false, "score": 0, "creation_date": 1589240253, "post_id": 55926975, "comment_id": 109210049, "body": "@Jose not sure I follow. If you have a <code>Private WithEvents popup As SomeForm</code> then the activate handler would be <code>popup_Activate</code> - you should never type event handler signatures by hand... select the provider from the code pane top-left dropdown, then pick the event you want to handle from the top-right dropdown. See <a href=\"https://stackoverflow.com/a/47291028/1188513\">this post</a> (and the linked article) for more info on <i>Model-View-Presenter</i>."}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "edited": false, "score": 0, "creation_date": 1589244699, "post_id": 55926975, "comment_id": 109211185, "body": "@MathieuGuindon Thanks for providing that clarity. What if I have some code inside of my <code>UserForm</code> that sets the form sizing and loads <code>Model</code> values into <code>ComboBoxes</code>, How can I make that code execute? Would I need to declare a <code>Public Sub</code> inside of the <code>UserForm</code> and call the Sub via <code>popup_Activate</code> event?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1589245216, "post_id": 55926975, "comment_id": 109211313, "body": "I would have a <code>Public Property Set Model(ByVal value As Object)</code> and have the presenter property-inject the model there. The property has all rights to do something like <code>Set viewModel = value</code> and then to invoke some <code>InitializeView</code> procedure before returning, where things like <code>Me.NameBox.Text = viewModel.Name</code> happen. Meanwhile the <code>NameBox_Change</code> handler does <code>viewModel.Name = Me.NameBox.Text</code>, and optionally invokes model validation (which can then determine whether the OK button is enabled)."}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "edited": false, "score": 1, "creation_date": 1589247360, "post_id": 55926975, "comment_id": 109211784, "body": "@MathieuGuindon thanks!! That makes total sense! I am still learning about MVP and OOP thanks to your RubberDuck blog! I was the same person who commented on your CarFactory post 2 weeks ago. Thanks for all you do for us!"}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 1, "creation_date": 1612847998, "post_id": 55926975, "comment_id": 116887692, "body": "It took me a minute to &quot;generalize&quot; this and I&#39;m looking to functionalize it to utilize the same code for multiple userforms. Still learning for sure, but I realize this is the way to go. I tried using a Boolean and it just was a nightmare. I have userforms, call userforms, and then I&#39;d need layers of booleans.... Just felt wrong. Here is my question w/ generalized code from this Answer. Thanks! __&gt; <a href=\"https://stackoverflow.com/questions/66113380/functionalize-event-driven-modeless-userform-class\" title=\"functionalize event driven modeless userform class\">stackoverflow.com/questions/66113380/&hellip;</a>"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 6, "last_activity_date": 1556649730, "creation_date": 1556649730, "answer_id": 55926975, "question_id": 55926451, "link": "https://stackoverflow.com/questions/55926451/how-to-have-vba-code-wait-until-vbmodeless-userform-is-closed/55926975#55926975", "title": "How to have VBA code wait until vbModeless userform is closed", "body": "<blockquote>\n  <p>My userform is opened in the middle of a long subroutine which needs to finish executing after the userform is closed.</p>\n</blockquote>\n\n<p>Your procedure is doing too many things and needs to be broken down into smaller, more specialized procedures.</p>\n\n<p>The correct way to do this, is to <strong>shift the paradigm from <em>procedural</em> to <em>event-driven</em></strong>.</p>\n\n<p>Instead of showing the form's default instance like this:</p>\n\n<pre><code>StartingSINT_Popup.Show vbModeless 'Open userform\n</code></pre>\n\n<p>Have a class module that holds a <code>WithEvent</code> instance of it:</p>\n\n<pre><code>Private WithEvents popup As StartingSINT_Popup\n\nPrivate Sub Class_Initialize()\n    Set popup = New StartingSINT_Popup\nEnd Sub\n\nPublic Sub Show()\n    popup.Show vbModeless\nEnd Sub\n\nPrivate Sub popup_Closed()\n    ' code to run when the form is closed\nEnd Sub\n</code></pre>\n\n<p>In the form's code-behind, declare a <code>Closed</code> event:</p>\n\n<pre><code>Public Event Closed()\n</code></pre>\n\n<p>And then raise it in the <code>QueryClose</code> handler:</p>\n\n<pre><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    If CloseMode = 0 Then 'controlbox was clicked (the \"red X button\")\n        Cancel = True 'would otherwise destroy the form instance\n        Me.Hide 'always hide, never unload\n    End If\n    RaiseEvent Closed\nEnd Sub\n</code></pre>\n\n<p>Now say you named that class <code>PopupPresenter</code>, your procedure can now do this:</p>\n\n<pre><code>Private presenter As PopupPresenter\n\nPublic Sub DoStuff()\n    Set presenter = New PopupPresenter\n\n    'do stuff...\n\n    presenter.Show\n\n    'rest of the code in this scope will run immediately AND THIS IS FINE\n\nEnd Sub\n</code></pre>\n\n<p>Keep the presenter at module level so that the object doesn't go out of scope when <code>DoStuff</code> finishes, and pass any variables/values or state that the presenter object needs to do its job when the form is closed. You can do this by exposing properties or public fields/variables (prefer properties though, but that's a whole other topic):</p>\n\n<pre><code>Private WithEvents popup As StartingSINT_Popup\nPublic Foo As String\n\nPrivate Sub Class_Initialize()\n    Set popup = New StartingSINT_Popup\nEnd Sub\n\nPublic Sub Show()\n    popup.Show vbModeless\nEnd Sub\n\nPrivate Sub popup_Closed()\n    ' code to run when the form is closed\n    MsgBox Foo\nEnd Sub\n</code></pre>\n\n\n\n<pre><code>Private presenter As PopupPresenter\n\nPublic Sub DoStuff()\n    Set presenter = New PopupPresenter\n\n    'do stuff...\n\n    presenter.Show\n    presenter.Foo = \"some data\"\n\n    'rest of the code in this scope will run immediately AND THIS IS FINE\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 11546477, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-raYUXh3eMH4/AAAAAAAAAAI/AAAAAAAAluI/ogFuLwd5vmg/photo.jpg?sz=128", "display_name": "Wichie Artu", "link": "https://stackoverflow.com/users/11546477/wichie-artu"}, "is_accepted": false, "score": 0, "last_activity_date": 1576609111, "creation_date": 1576609111, "answer_id": 59380492, "question_id": 55926451, "link": "https://stackoverflow.com/questions/55926451/how-to-have-vba-code-wait-until-vbmodeless-userform-is-closed/59380492#59380492", "title": "How to have VBA code wait until vbModeless userform is closed", "body": "<p>Here is an alternative...</p>\n\n<p><strong>1. In the original [public] module</strong> (the one that calls userform 1), declare a public Boolean variable.</p>\n\n<p><code>Public done As Boolean</code></p>\n\n<p><strong>2. In userform 1,</strong> </p>\n\n<p>a. Assign a default value to the Boolean variable</p>\n\n<p>b. Call Userform 2</p>\n\n<p>c. Have a do while loop that...</p>\n\n<ul>\n<li>checks for that default value</li>\n<li>includes the DoEvents method (allows userform 2 to push through despite loop)</li>\n</ul>\n\n<p>Code</p>\n\n<pre><code>    Private Sub event_click()\n\n    done = False\n\n    Dim userform2 As New userform\n    userform2.Show Modeless\n\n    'This will loop through until userform2 changes done variable to \"True\"\n    Do While done = False\n    DoEvents\n    Loop\n\n    'Code after done with userform2\n    dataSource.Refresh\n\n    End Sub\n</code></pre>\n\n<p><strong>3. In userform 2</strong>, change value of Boolean to break loop</p>\n\n<p>Code</p>\n\n<pre><code>    Private Sub submit_Click()\n\n    'Userform submit code\n    Dim name As String        \n    name = TextBox.Value\n    sql = \"INSERT INTO table (field) VALUES ('\" &amp; name &amp; \"')\"        \n    Call query(sql)\n\n    'IMPORTANT: change Boolean variable to break loop before exiting userform\n    done = True\n\n    Unload Me\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 4074964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd3425091510bc5d01f23f20d1481147?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/4074964/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3248, "favorite_count": 4, "accepted_answer_id": 55926557, "answer_count": 3, "score": 2, "last_activity_date": 1576609111, "creation_date": 1556647236, "question_id": 55926451, "link": "https://stackoverflow.com/questions/55926451/how-to-have-vba-code-wait-until-vbmodeless-userform-is-closed", "title": "How to have VBA code wait until vbModeless userform is closed", "body": "<p>I'd like to use a formless userform so the user can navigate the excel sheet before answering the question on the userform. I need to pause or loop the code until the userform is closed (hidden or unloaded).</p>\n\n<p>Similar issue to this:\n<a href=\"https://stackoverflow.com/questions/38509403/how-can-i-wait-for-a-specific-code-to-run-while-when-form-is-closed-and-is-set-t\">How can I wait for a specific code to run while when form is closed and is set to vbModeless?</a>\nbut the solution here does not work for my application; My userform is opened in the middle of a long subroutine which needs to finish executing after the userform is closed.</p>\n\n<pre><code>Dim popupActive as Boolean\n\npopupActive = True\nStartingSINT_Popup.Show vbModeless 'Open userform\n\n'have VBA code wait until userform is closed\nwait until popupActive = False 'set to false with OK button on userform\n\n'continue code with info input inside StartingSINT_Popup userform\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 1990, "user_id": 5775341, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/67f9c208584c05ef9918d544e0d4b95f?s=128&d=identicon&r=PG&f=1", "display_name": "quicklikerabbit", "link": "https://stackoverflow.com/users/5775341/quicklikerabbit"}, "edited": false, "score": 0, "creation_date": 1556647402, "post_id": 55926414, "comment_id": 98506566, "body": "Can you share your code with us?"}, {"owner": {"reputation": 1, "user_id": 9899257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd5e802711a09355934fa05ea01b846?s=128&d=identicon&r=PG&f=1", "display_name": "Mike S", "link": "https://stackoverflow.com/users/9899257/mike-s"}, "reply_to_user": {"reputation": 1990, "user_id": 5775341, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/67f9c208584c05ef9918d544e0d4b95f?s=128&d=identicon&r=PG&f=1", "display_name": "quicklikerabbit", "link": "https://stackoverflow.com/users/5775341/quicklikerabbit"}, "edited": false, "score": 0, "creation_date": 1556648321, "post_id": 55926414, "comment_id": 98506976, "body": "Just edited my op. Not much to it currently. I&#39;m also wondering if I should have an input box in Excel, have it fill down the information however many times the user wants, then maybe have it create some sort of mail merge off of that instead of trying to write code to make it produce multiple pages."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 1, "creation_date": 1556663267, "post_id": 55926414, "comment_id": 98512408, "body": "Cross-posted at: <a href=\"https://www.mrexcel.com/forum/excel-questions/1096117-vba-produce-same-page-x-amount-times.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a> For cross-posting etiquette, please read: <a href=\"http://www.excelguru.ca/content.php?184\" rel=\"nofollow noreferrer\">excelguru.ca/content.php?184</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1556662928, "creation_date": 1556662928, "answer_id": 55929394, "question_id": 55926414, "link": "https://stackoverflow.com/questions/55926414/vba-to-produce-the-same-page-x-amount-of-times/55929394#55929394", "title": "VBA to produce the same page &quot;x&quot; amount of times", "body": "<p>A fairly common approach is to use a mailmerge, where you'd have an Excel worksheet as the data source and a Word mailmerge main document attached to that. The numbering column in Excel would perhaps have no more than single cell for the input of a number, and the cells on subsequent rows would simply increment that. When completing the merge, simply choose how many record to process. Your description suggests you might need an Excel workbook where you can keep a permanent record of the names, payment dates, payment amounts, coupon #s, etc., all of which can be processed as part of the mailmerge. For the basics, see: <a href=\"https://support.office.com/en-us/article/use-mail-merge-for-bulk-email-letters-labels-and-envelopes-f488ed5b-b849-4c11-9cff-932c49474705\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/use-mail-merge-for-bulk-email-letters-labels-and-envelopes-f488ed5b-b849-4c11-9cff-932c49474705</a></p>\n\n<p>For a variety of macro-based approaches for simple Word form replication, see:\n<a href=\"http://www.msofficeforums.com/word-vba/12959-sequential-document-numbering.html#post34477\" rel=\"nofollow noreferrer\">http://www.msofficeforums.com/word-vba/12959-sequential-document-numbering.html#post34477</a>\n<a href=\"http://www.msofficeforums.com/word-vba/12641-sequential-print-numbering.html#post33829http://www.msofficeforums.com/word-vba/35106-printing-multiple-copies-docm-word-pdf-saving.html#post113655\" rel=\"nofollow noreferrer\">http://www.msofficeforums.com/word-vba/12641-sequential-print-numbering.html#post33829http://www.msofficeforums.com/word-vba/35106-printing-multiple-copies-docm-word-pdf-saving.html#post113655</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9899257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd5e802711a09355934fa05ea01b846?s=128&d=identicon&r=PG&f=1", "display_name": "Mike S", "link": "https://stackoverflow.com/users/9899257/mike-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556869159, "creation_date": 1556647058, "last_edit_date": 1556869159, "question_id": 55926414, "link": "https://stackoverflow.com/questions/55926414/vba-to-produce-the-same-page-x-amount-of-times", "title": "VBA to produce the same page &quot;x&quot; amount of times", "body": "<p>In Word, I've created a template for a payment coupon book. So far I've written some code to load an input box/user form upon opening the word file. The user inputs stuff like name, payment date, payment amount, etc. After hitting submit, the user input is automatically entered into the template in the appropriate fields. I'm using bookmarks to do this. </p>\n\n<p>My last piece of the puzzle is this: I need it to produce however many coupons that the user defines in one of my input boxes. Each coupon would have the same information. The only difference is the coupon ID needs to auto-increment to be a unique ID. </p>\n\n<p>Think of this like producing a virtual checkbook almost. Your name, address, etc is all the same. The check number is different. This program is essentially asking how many checks you want. </p>\n\n<p>Also, if this would be easier in Excel or even creating a form in Adobe please let me know. This was the only way I knew how to do it. </p>\n\n<p>Feel free to ask any questions. Hope this makes sense. </p>\n\n<p>Code is as follows:</p>\n\n<pre><code>Private Sub Submit_Click()\n\n\nDim flName As Range\nSet flName = ActiveDocument.Bookmarks(\"flName\").Range\n\n    flName.Text = Me.firstNameTxt.Value\n\nDim acctNumber As Range\nSet acctNumber = ActiveDocument.Bookmarks(\"acctNumber\").Range\n    acctNumber.Text = Me.accountNumberTxt.Value\n\nDim trailerNumber As Range\nSet trailerNumber = ActiveDocument.Bookmarks(\"trailerNumber\").Range\n    trailerNumber.Text = Me.trailerTxt.Value\n\nDim DueDate As Range\nSet DueDate = ActiveDocument.Bookmarks(\"dueDate\").Range\n    DueDate.Text = Me.dueDateTxt.Value\n\nDim PaymentAmount As Range\nSet PaymentAmount = ActiveDocument.Bookmarks(\"paymentAmount\").Range\n    PaymentAmount.Text = Me.paymentAmountTxt.Value\n\nUnload Me\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 4, "creation_date": 1556646505, "post_id": 55926271, "comment_id": 98506156, "body": "Please show your declarations... if you have values declared as Long/Integer, but they should be Double, that could be a problem.  It is assumed you are using <code>Option Explicit</code> at the top of your module."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 6, "creation_date": 1556646637, "post_id": 55926271, "comment_id": 98506209, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/235409/compare-double-in-vba-precision-problem\">Compare double in VBA precision problem</a> In short, you are comparing two floats and that is a pain in the rear. It&#39;s not VBA, it&#39;s the nature of floating points storage and the intrinsic nature of the approximations that result."}, {"owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "edited": false, "score": 5, "creation_date": 1556646717, "post_id": 55926271, "comment_id": 98506241, "body": "As a general rule, equal comparisons aren&#39;t very good for the data type double (aka float).This is due the type rarely being exact (although very close). Instead subtract them and check that the difference is less than some threshold..."}], "owner": {"reputation": 41, "user_id": 5445045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e5e65d55ac0f9fce0c768706ea43821?s=128&d=identicon&r=PG&f=1", "display_name": "matt_codingtyro", "link": "https://stackoverflow.com/users/5445045/matt-codingtyro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "closed_date": 1556648559, "answer_count": 0, "score": 0, "last_activity_date": 1556656772, "creation_date": 1556646419, "last_edit_date": 1556656772, "question_id": 55926271, "link": "https://stackoverflow.com/questions/55926271/if-then-statement-results-to-false", "closed_reason": "Duplicate", "title": "if then statement results to false", "body": "<p>my if - then statement results to false even though the condition is true</p>\n\n<p>I've tried casting values to doubles</p>\n\n<pre><code>    dblCompare = CDbl(rng1.Offset(0, -12).Value2)\n    If dblTotal = dblCompare Then\n        'If the values match, then record the Unique IDs in Columns AI:AN\n        Range(Cells(m, 35), Cells(m, 35 + k - 1)) = arr\n    End If\n</code></pre>\n\n<p>dblCompare = 114954.48 and dblTotal = 114954.48.  However, the statement results to false and the pasting of the array into the Range is completely skipped.  Sometimes the if-then statement results to true and the contents of the array is pasted into the range, but sometimes it doesn't.  VBA appears to be very buggy.  All I can think of is that dblCompare needed to be type cast to a Double.</p>\n\n<p>My declarations: </p>\n\n<pre><code>Option Explicit\nSub Find_Recs()\n    Dim i As Integer, j As Integer, k As Integer, m As Integer\n    Dim strSearch As String\n    Dim dblTotal As Double, dblCompare As Double\n    Dim rng1 As Range, rng2 As Range\n    Dim arr As Variant\n'\n'\n'code here\n'\n'\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "excel", "vba"], "comments": [{"owner": {"reputation": 277, "user_id": 11320286, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11320286/noodles"}, "edited": false, "score": 1, "creation_date": 1556647913, "post_id": 55926219, "comment_id": 98506795, "body": "But why tag this VBA. What is your VBA question."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 277, "user_id": 11320286, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/43f607b763e211a8674c232e03b56400?s=128&d=identicon&r=PG", "display_name": "Noodles", "link": "https://stackoverflow.com/users/11320286/noodles"}, "edited": false, "score": 1, "creation_date": 1556656432, "post_id": 55926219, "comment_id": 98510217, "body": "@Noodles I mean, the question does <i>relate</i> to VBA, but the main issue here is that this question is far <b>too broad</b> for any answer to suffice."}], "owner": {"reputation": 809, "user_id": 6301517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bae3b1b6120f28d727740eb0695836a2?s=128&d=identicon&r=PG&f=1", "display_name": "Yolo_chicken", "link": "https://stackoverflow.com/users/6301517/yolo-chicken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556709097, "creation_date": 1556646229, "last_edit_date": 1556709097, "question_id": 55926219, "link": "https://stackoverflow.com/questions/55926219/converting-vba-to-python-file-structure-question", "title": "Converting VBA to Python - File Structure Question", "body": "<p>I have a straight forward simulation running in VBA but want to recreate this in Python. I have a number of class modules in VBA that define object properties, contain some subs, and functions. These objects are then used throughout the main module of VBA. </p>\n\n<p>Rewriting the VBA instructions into Python is no problem, I'm just curious how the class modules/modules translate over to Python. For example if I have a module that uses a user-defined type and looks like this in the VBA IDE:</p>\n\n<p><a href=\"https://i.stack.imgur.com/g2mbm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g2mbm.png\" alt=\"VBA Format\"></a></p>\n\n<p>Do I just write the class modules at the top of the Python script and the Main module below it. Or is it better to save my classes elsewhere and call them in?</p>\n"}, {"tags": ["excel", "vba", "aspect-ratio"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1556645885, "post_id": 55925964, "comment_id": 98505863, "body": "Indentation isn&#39;t consistent - consider using an <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indenter</a>"}, {"owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 0, "creation_date": 1556735253, "post_id": 55925964, "comment_id": 98535007, "body": "Ok, there was something lost in translation here.  Roll back those changes.  The only thing you needed to do was change where you had &quot;ShapeRange.LockAspectRatio&quot; to &quot;Shape.LockAspectRatio&quot; -- sorry for the confusion, I should have been more specific."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11433855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf8cb4d1fe1b7865f33ccaf18130790?s=128&d=identicon&r=PG&f=1", "display_name": "Willibj448", "link": "https://stackoverflow.com/users/11433855/willibj448"}, "edited": false, "score": 0, "creation_date": 1556731101, "post_id": 55928148, "comment_id": 98533132, "body": "Thanks @Ryan B. for the info - I tried to migrate your code into mine but for some reason it does not seem to work. Any ideas?"}, {"owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "reply_to_user": {"reputation": 3, "user_id": 11433855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf8cb4d1fe1b7865f33ccaf18130790?s=128&d=identicon&r=PG&f=1", "display_name": "Willibj448", "link": "https://stackoverflow.com/users/11433855/willibj448"}, "edited": false, "score": 0, "creation_date": 1556735952, "post_id": 55928148, "comment_id": 98535274, "body": "@Willibj448 I&#39;ve edited my answer to remove some code that I&#39;d put there just as a testing sample to explain what was going on -- it wasn&#39;t really meant to be added to your solution.  Sorry for that, I&#39;ve altered the answer to be more specific instructions for what you need to do."}], "tags": [], "owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1556735853, "last_edit_date": 1556735853, "creation_date": 1556655612, "answer_id": 55928148, "question_id": 55925964, "link": "https://stackoverflow.com/questions/55925964/vba-excel-comment-box-enabling-lock-aspect-ratio/55928148#55928148", "title": "VBA Excel Comment Box - Enabling Lock Aspect Ratio", "body": "<p>Given your block of code:</p>\n\n<pre><code>With ActiveCell.Comment\n    .Shape.Fill.UserPicture ImgFile\n    .Shape.Width = myImg.Width * ZoomF / 2645.9\n    .Shape.Height = myImg.Height * ZoomF / 2645.9\n    .ShapeRange.LockAspectRatio = msoTrue 'this does not seem to work\n    .Shape.Placement = 2 'move but do not size with cells\n\nEnd With\n</code></pre>\n\n<p>I believe you want to change this line:</p>\n\n<pre><code>.ShapeRange.LockAspectRatio = msoTrue\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>.Shape.LockAspectRatio = msoTrue\n</code></pre>\n\n<p>There isn't a 'ShapeRange' property on a Comment object.  So your code is generating an error there.  But, because you've declared \"OnErrorResumeNext\" the execution ignores the error and starts on the next line.  </p>\n\n<p>So, you don't see any problems, but your attempt to change the LockAspectRatio property doesn't actually work, and then the bit that comes after to change the Position property never gets executed.  Fixing the one line of code should solve both problems.</p>\n"}], "owner": {"reputation": 3, "user_id": 11433855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf8cb4d1fe1b7865f33ccaf18130790?s=128&d=identicon&r=PG&f=1", "display_name": "Willibj448", "link": "https://stackoverflow.com/users/11433855/willibj448"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 0, "accepted_answer_id": 55928148, "answer_count": 1, "score": 0, "last_activity_date": 1556797678, "creation_date": 1556645018, "last_edit_date": 1556797678, "question_id": 55925964, "link": "https://stackoverflow.com/questions/55925964/vba-excel-comment-box-enabling-lock-aspect-ratio", "title": "VBA Excel Comment Box - Enabling Lock Aspect Ratio", "body": "<p>I am using an existing VBA code to insert an image into a comment box in Excel. I would like to lock the aspect ratio of the comment box, and also select the \"Do not move or size with cell\"</p>\n\n<p>EDIT - Posted the code with @Ryan B. 's help - Works perfectly!</p>\n\n<pre><code>Sub add_content_image()\n\n    'NOTE: THE RESIZER ONLY WORKS FOR JPG IMAGES\n    Dim myFile As FileDialog, ImgFile, myImg As Variant\n    Dim ZoomF As Variant                         'string\n    On Error Resume Next\n\n    Set myFile = Application.FileDialog(msoFileDialogOpen)\n    With myFile\n        .Title = \"Choose File\"\n        .AllowMultiSelect = False\n        .Filters.Add Description:=\"Images\", Extensions:=\"*.jpg,*.Jpg,*.gif,*.png,*.tif,*.bmp\", Position:=1\n        If .Show &lt;&gt; -1 Then\n            MsgBox \"No image selected\", vbCritical\n            Exit Sub\n        End If\n    End With\n\n    ImgFile = myFile.SelectedItems(1)\n    If ImgFile = False Then Exit Sub\n    Application.ScreenUpdating = False\n    ZoomF = InputBox(Prompt:=\"Your selected file path:\" &amp; _\n                              vbNewLine &amp; ImgFile &amp; _\n                              vbNewLine &amp; \"\" &amp; _\n                              vbNewLine &amp; \"Input zoom % factor to apply to picture?\" &amp; _\n                              vbNewLine &amp; \"(Original picture size equals 100) .\" &amp; _\n                              vbNewLine &amp; \"Input a number greater than zero!\", Title:=\"Picture Scaling Percentage Factor\", Default:=100)\n\n    If Not IsNumeric(ZoomF) Or ZoomF = 0 Or ZoomF = \"\" Then\n        MsgBox \"You must enter a valid numeric value. Entered value must be a number greater than zero.\" &amp; _\n               vbNewLine &amp; \"Macro will terminate.\", vbCritical\n        Exit Sub\n    End If\n    With ActiveCell\n        .ClearComments\n        .AddComment\n        .Interior.ColorIndex = 19\n        .Value = \"Hover for Image\"\n    End With\n\n    Set myImg = LoadPicture(ImgFile)\n    With ActiveCell.Comment\n        .Shape.Fill.UserPicture ImgFile\n        .Shape.Width = myImg.Width * ZoomF / 2645.9\n        .Shape.Height = myImg.Height * ZoomF / 2645.9\n        .Shape.LockAspectRatio = msoTrue\n        .Shape.Placement = 3                     'do not move or size with cells\n\n    End With\n    Application.ScreenUpdating = True\n    Set myFile = Nothing: Set myImg = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1556645107, "post_id": 55925871, "comment_id": 98505533, "body": "Why would you open the workbook, then set <code>destWB</code> to the <code>ActiveWorkbook</code>. Try to avoid using <b>any</b> method with the work <i>Active</i> in it, unless you truly need it. <code>Set destWB = Application.Workbooks.Open(MasterLoc)</code>"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1556645411, "post_id": 55925871, "comment_id": 98505652, "body": "And what is this line for: <code>Set startSht = ActiveWorkbook.Worksheets(TabName)</code>? Why do you use explicit workbook objects on the 3 lines above then use the <code>ActiveWorkbook</code> for this? Set your workbook obj as you&#39;ve done with the others. And <code>startWB</code> should be explicit as well. Is this code in the <code>startWB</code>? If so, instead of using <code>ActiveWorkbook</code>, use <code>ThisWorkbook</code>."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1556645792, "post_id": 55925871, "comment_id": 98505811, "body": "What is the value of <code>TargetStartDate</code> when it errors?"}, {"owner": {"reputation": 25, "user_id": 9463032, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LIOm_gfXAbY/AAAAAAAAAAI/AAAAAAAACxc/6NhRLdjKtDc/photo.jpg?sz=128", "display_name": "Steven Gilbert", "link": "https://stackoverflow.com/users/9463032/steven-gilbert"}, "edited": false, "score": 0, "creation_date": 1556645811, "post_id": 55925871, "comment_id": 98505825, "body": "Thank you for the comments. I am still learning how to make my macros less clunky and your tips help a lot. As for the startsht lines, I removed those just now in an edit. This is a snip from a larger macro that is about 2000 lines long, I thought I removed all the other working lines to prevent confusion."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1556646063, "post_id": 55925871, "comment_id": 98505942, "body": "Unrelated to your issue, but setting the <code>bTSD.value</code> will just plunk down the string literal that <code>TargetStartDate</code> variable holds into that <code>bTSD</code> cell. Instead you want to set that cell&#39;s formula. <code>bTSD.Formula = TargetStartDate</code>  That probably won&#39;t fix your current issue, but will solve the next one."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1556646203, "post_id": 55925871, "comment_id": 98506004, "body": "I&#39;m also very curious what the value and type of <code>TargetStartDate</code> is when this errors. When you hit <code>debug</code> go to <code>View&gt;&gt;Locals Window</code> and copy/paste what the value of that variable is here (and make note of the variable type... I&#39;m assuming <code>variant&#47;string</code> at this point in the processing)."}, {"owner": {"reputation": 25, "user_id": 9463032, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LIOm_gfXAbY/AAAAAAAAAAI/AAAAAAAACxc/6NhRLdjKtDc/photo.jpg?sz=128", "display_name": "Steven Gilbert", "link": "https://stackoverflow.com/users/9463032/steven-gilbert"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1556646610, "post_id": 55925871, "comment_id": 98506197, "body": "@JNevill    : TargetStartDate : &quot;=&#39;Z:\\Master Projects\\Template\\Concept Testing&#91;Concept Testing - Project Tracker v1.0.xlsm]Background Formulas&#39;!$B$15&quot; : Variant/String  Should say something like &quot;=&#39;[Master Projects.xlsm]Background Formulas&#39;!$B$15&quot;"}, {"owner": {"reputation": 25, "user_id": 9463032, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LIOm_gfXAbY/AAAAAAAAAAI/AAAAAAAACxc/6NhRLdjKtDc/photo.jpg?sz=128", "display_name": "Steven Gilbert", "link": "https://stackoverflow.com/users/9463032/steven-gilbert"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1556647777, "post_id": 55925871, "comment_id": 98506726, "body": "@JNevill you were right about it being a <b>variant/string</b> do you have any ideas of why that is giving me this error?"}, {"owner": {"reputation": 25, "user_id": 9463032, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LIOm_gfXAbY/AAAAAAAAAAI/AAAAAAAACxc/6NhRLdjKtDc/photo.jpg?sz=128", "display_name": "Steven Gilbert", "link": "https://stackoverflow.com/users/9463032/steven-gilbert"}, "edited": false, "score": 0, "creation_date": 1556649172, "post_id": 55925871, "comment_id": 98507334, "body": "I closed and reopened my spreadsheet and the .formula tip fixed the error. Thank you!"}], "owner": {"reputation": 25, "user_id": 9463032, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LIOm_gfXAbY/AAAAAAAAAAI/AAAAAAAACxc/6NhRLdjKtDc/photo.jpg?sz=128", "display_name": "Steven Gilbert", "link": "https://stackoverflow.com/users/9463032/steven-gilbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556647294, "creation_date": 1556644555, "last_edit_date": 1556647294, "question_id": 55925871, "link": "https://stackoverflow.com/questions/55925871/vba-runtime-error-1004-application-defined-or-object-defined-error-when-pastin", "title": "VBA Runtime Error 1004 \u201cApplication-defined or Object-defined error\u201d when pasting value into a cell in another workbook", "body": "<p>I can't figure out why I am getting this error. I have not been able to find anybody with similar code getting this error.  </p>\n\n<p>The main objective is to run this from the starting workbook, jump to the destination workbook to get 3 addresses of cells, then jump back to the starting workbook and paste a formula referencing those cells in the destination workbook.</p>\n\n<p>I thought getting the formula right would be the hard part. But everything works except It is not allowing me to paste the final formula string into the cells. Giving me Runtime Error 1004 \u201cApplication-defined or Object-defined error\u201d. What am I missing here?</p>\n\n<pre><code>Sub DefeatRunTimeError()\n\n'Starting Workbook\nDim startWB As Workbook\nDim GENTemplate As Worksheet\n'Destination Workbook\nDim destWB As Workbook\nDim destBackgroundFormulas As Worksheet\n'Other Variables\nDim TabName As String\nDim bLoc As Range\nDim bTSD As Range\nDim bTGL As Range\nDim bRU As Range\n'Set Starting Workbook\nTabName = ActiveSheet.Name\nSet startWB = ActiveWorkbook\nSet GENTemplate = startWB.Sheets(TabName)\n\n'Define Filename of Destination Workbook\nMasterLoc = startWB.Names(\"MasterProjectTrackerLocation\").RefersToRange.Value\n\n    'Open Destination Workbook\n            Workbooks.Open (MasterLoc)\n\n    'Set Destination Workbook\n        Set destWB = ActiveWorkbook\n        Set destBackgroundFormulas = destWB.Worksheets(\"Background Formulas\")\n\n    'Define ranges\n        destBackgroundFormulas.Activate\n        Set bLoc = destBackgroundFormulas.Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n        bLoc.Value = TabName\n        Set bTSD = bLoc.Offset(0, 1)\n        Set bTGL = bLoc.Offset(0, 2)\n        Set bRU = bLoc.Offset(0, 3)\n\n    'Write Formula referencing these cells\n        strfile = Replace(ThisWorkbook.FullName, ThisWorkbook.Name, \"[\" &amp; ThisWorkbook.Name &amp; \"]\")\n        thefilename = \"='\" &amp; strfile &amp; \"Background Formulas\" &amp; \"'!\"\n        TargetStartDate = thefilename &amp; bTSD.Address\n        TargetGoLive = thefilename &amp; bTGL.Address\n        ReviewUpdate = thefilename &amp; bRU.Address\n\n    'Paste Formulas into Original Workbook\n        Set bTSD = GENTemplate.Range(\"b12\")\n        Set bTGL = GENTemplate.Range(\"b13\")\n        Set bRU = GENTemplate.Range(\"a4\")\n    'ERROR GIVEN ON THE LINE BELOW RUNTIME 1004\n        bTSD.Value = TargetStartDate\n        bTGL.Value = TargetGoLive\n        bRU.Value = ReviewUpdate\n\n End Sub\n</code></pre>\n\n<p>Edited Version</p>\n\n<pre><code>Sub DefeatRunTimeError()\n\n'Starting Workbook\nDim startWB As Workbook\nDim GENTemplate As Worksheet\n'Destination Workbook\nDim destWB As Workbook\nDim destBackgroundFormulas As Worksheet\n'Other Variables\nDim TabName As String\nDim bLoc As Range\nDim bTSD As Range\nDim bTGL As Range\nDim bRU As Range\n'Set Starting Workbook\nTabName = ActiveSheet.Name\nSet startWB = ActiveWorkbook\nSet GENTemplate = startWB.Sheets(TabName)\n\n'Define Filename of Destination Workbook\nMasterLoc = startWB.Names(\"MasterProjectTrackerLocation\").RefersToRange.Value\n\n    'Open Destination Workbook\n        Workbooks.Open (MasterLoc)\n\n    'Set Destination Workbook\n        Set destWB = Application.Workbooks.Open(MasterLoc)\n        Set destBackgroundFormulas = destWB.Worksheets(\"Background Formulas\")\n\n\n    'Define ranges\n        destBackgroundFormulas.Activate\n        strfile = Replace(destWB.FullName, destWB.Name, \"[\" &amp; destWB.Name &amp; \"]\")\n        thefilename = \"='\" &amp; strfile &amp; \"Background Formulas\" &amp; \"'!\"\n\n        Set bLoc = destBackgroundFormulas.Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n        bLoc.Value = TabName\n        Set bTSD = bLoc.Offset(0, 1)\n        Set bTGL = bLoc.Offset(0, 2)\n        Set bRU = bLoc.Offset(0, 3)\n\n    'Write Formula referencing these cells\n\n        TargetStartDate = thefilename &amp; bTSD.Address\n        TargetGoLive = thefilename &amp; bTGL.Address\n        ReviewUpdate = thefilename &amp; bRU.Address\n\n    'Paste Formulas into Original Workbook\n        Set bTSD = GENTemplate.Range(\"b12\")\n        Set bTGL = GENTemplate.Range(\"b13\")\n        Set bRU = GENTemplate.Range(\"a4\")\n\n        'MsgBox (TargetStartDate)\n\n        bTSD.Formula = TargetStartDate\n        bTGL.Formula = TargetGoLive\n        bRU.Formula = ReviewUpdate\n\n End Sub\n</code></pre>\n\n<p>Returns   : TargetStartDate : \"='Z:\\Master Projects[Master Projects.xlsm]Background Formulas'!$B$16\" : Variant/String</p>\n\n<p>For TargetStartDate, which yields the correct formula.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1556644378, "post_id": 55925776, "comment_id": 98505238, "body": "&quot;<a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/declaring-arrays#declare-a-dynamic-array\" rel=\"nofollow noreferrer\">Declaring arrays</a>&quot; on MSDN has a section on Dynamic Arrays"}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1556666155, "post_id": 55925776, "comment_id": 98513036, "body": "Are you using Option base 1? Else your loop will miss the first element"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1556672233, "post_id": 55925776, "comment_id": 98514094, "body": "* Is it normal for Ubound to throw an error on an empty array?*  <code>site_dates</code> is not an empty array; it is an uninitialized variable (empty variant), so yes, errors are normal."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1556645012, "creation_date": 1556645012, "answer_id": 55925961, "question_id": 55925776, "link": "https://stackoverflow.com/questions/55925776/how-do-i-instantiate-a-dynamic-empty-array-and-add-its-first-element/55925961#55925961", "title": "How do I instantiate a dynamic, empty array and add its first element?", "body": "<p>One way to start the growth process:</p>\n\n<pre><code>Sub InTheBeginning()\n    Dim site_dates() As Date, msg As String\n    ReDim site_dates(1)\n\n    For i = 1 To 10\n        ReDim site_dates(1 To UBound(site_dates) + 1)\n    Next i\n\n\n    msg = LBound(site_dates) &amp; vbCrLf &amp; UBound(site_dates)\n    MsgBox msg\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ZevNQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZevNQ.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 2206, "user_id": 1175788, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/ed6991f13be59c3996322a3afd84708e?s=128&d=identicon&r=PG", "display_name": "simplycoding", "link": "https://stackoverflow.com/users/1175788/simplycoding"}, "edited": false, "score": 0, "creation_date": 1556655249, "post_id": 55926041, "comment_id": 98509765, "body": "Ah thanks, I had done <code>Dim site_dates() As Array</code> which wasn&#39;t working. As far as resizing the array, for <code>site_dates</code>, I won&#39;t know the size so I&#39;ll have to dynamically resize it. Luckily, it will never have more than 11 elements so I&#39;m not too worried about performance."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1556645754, "last_edit_date": 1556645754, "creation_date": 1556645414, "answer_id": 55926041, "question_id": 55925776, "link": "https://stackoverflow.com/questions/55925776/how-do-i-instantiate-a-dynamic-empty-array-and-add-its-first-element/55926041#55926041", "title": "How do I instantiate a dynamic, empty array and add its first element?", "body": "<pre><code>Dim site_dates\n</code></pre>\n\n<p>This variable is an implicit <code>Variant</code>. While a <code>Variant</code> can very well hold an array, it initializes to <code>Variant/Empty</code>, which isn't an array - that's why <code>UBound(site_dates)</code> is throwing an error: you're trying to get the upper bound of a <code>Variant/Empty</code>, and VBA doesn't know what to do with that.</p>\n\n<p>This declares a dynamic array of <code>Variant</code> items:</p>\n\n<pre><code>Dim site_dates()\n</code></pre>\n\n<p>That said, in general you should avoid resizing arrays (a loop with <code>ReDim Preserve theArray(UBound(theArray) + 1)</code> is copying the entire array at every iteration just to add a single item - the penalty gets more apparent with more items): if you don't know how many elements you're going to need, it's usually a better idea to use a <code>Collection</code> and <code>Add</code> items as you go. If you do know how many elements you're going to need, then explicitly size the array accordingly, at the declaration site:</p>\n\n<pre><code>Dim site_dates(1 To 10)\n</code></pre>\n\n<p>Note that <code>Dim</code> statements aren't executable, so you can't use a variable. Use the <code>ReDim</code> statement to do this:</p>\n\n<pre><code>ReDim site_dates(1 To datesCount)\n</code></pre>\n\n<p><code>ReDim</code> acts as a declarative statement, so you don't need a prior <code>Dim</code>, even with <code>Option Explicit</code> specified.</p>\n\n<p>In this case you can use <code>Application.WorksheetFunction.CountIf</code> to get the number of dates matching the criteria and size the array before you start iterating the values.</p>\n"}, {"comments": [{"owner": {"reputation": 2206, "user_id": 1175788, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/ed6991f13be59c3996322a3afd84708e?s=128&d=identicon&r=PG", "display_name": "simplycoding", "link": "https://stackoverflow.com/users/1175788/simplycoding"}, "edited": false, "score": 0, "creation_date": 1556725746, "post_id": 55929878, "comment_id": 98530875, "body": "How do I reference mscorlib? I&#39;ve tried adding <code>Set clr = New mscoree.CorRuntimeHost</code> to the top of my script and elsewhere with no luck. Can&#39;t find any examples online that show where it&#39;s set"}], "tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": false, "score": 0, "last_activity_date": 1556732600, "last_edit_date": 1556732600, "creation_date": 1556666832, "answer_id": 55929878, "question_id": 55925776, "link": "https://stackoverflow.com/questions/55925776/how-do-i-instantiate-a-dynamic-empty-array-and-add-its-first-element/55929878#55929878", "title": "How do I instantiate a dynamic, empty array and add its first element?", "body": "<p>First to check that you are using Option base 1 because start your loops with 1??</p>\n\n<p>If you have a setup where you know the max possible site_dates from your data_dates, you can ReDim the site_dates at the beginning (before the loop)to have the same bounds as data-dates.</p>\n\n<p>Keep a track of the number of qualifying items written in a counter in the 'If logic' loop.\nThen at the end, you can Redim Preserve down to the amount generated:</p>\n\n<p><code>ReDim Preserve site_dates(1 to qualifyingCounter)</code></p>\n\n<p>Alternatively, with no worry about performance you can consider the easiest for me:</p>\n\n<p>Reference mscorlib and use an ArrayList</p>\n\n<pre><code>Dim data_dates\ndata_dates = Array(\"6/24/2019\", \"7/1/2019\", \"7/8/2019\", \"7/15/2019\", \"7/22/2019\", \"7/29/2019\", \"8/5/2019\", \"8/12/2019\", \"8/19/2019\", \"8/26/2019\", \"9/2/2019\")\n\nDim siteDate_ArrayList As New ArrayList\n\nDim date_iter As Long\nFor date_iter = 0 To UBound(data_dates)\n    If date_iter Mod 2 = 0 Then 'I changed this logic just for my test\n        siteDate_ArrayList.Add data_dates(date_iter)\n    End If\nNext date_iter\n\nDim site_dates As Variant\n'Please note that array resultant from ToArray on an empty ArrayList will have a Ubound of -1\nsite_dates = siteDate_ArrayList.ToArray\n</code></pre>\n\n<p>EDIT:\nTo refernce, go to Tools --> References and look down alphabetically for mscorlib.dll. Then check it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/H3R72.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H3R72.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 2206, "user_id": 1175788, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/ed6991f13be59c3996322a3afd84708e?s=128&d=identicon&r=PG", "display_name": "simplycoding", "link": "https://stackoverflow.com/users/1175788/simplycoding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 1, "answer_count": 3, "score": 3, "last_activity_date": 1556732600, "creation_date": 1556644221, "question_id": 55925776, "link": "https://stackoverflow.com/questions/55925776/how-do-i-instantiate-a-dynamic-empty-array-and-add-its-first-element", "title": "How do I instantiate a dynamic, empty array and add its first element?", "body": "<p>I've been trying to instantiate an empty array, where I'll be adding elements. For some reason, my script is throwing an error on simply calling <code>Ubound</code> on the empty array. I can't figure out how to instantiate an empty array... Here's what I've got:</p>\n\n<pre><code>Dim data_dates \ndata_dates = Array(\"6/24/2019\", \"7/1/2019\", \"7/8/2019\", \"7/15/2019\", \"7/22/2019\", \"7/29/2019\", \"8/5/2019\", \"8/12/2019\", \"8/19/2019\", \"8/26/2019\", \"9/2/2019\")\nDim site_dates\n\nFor date_iter = 1 To UBound(data_dates)\n    If start_date &lt;= data_dates(date_iter) And last_date &lt;= data_dates(date_iter) Then\n        MsgBox UBound(site_dates) '- LBound(site_dates) + 1\n        site_dates(UBound(site_dates) + 1) = data_dates(date_iter)\n    End If\nNext date_iter\n</code></pre>\n\n<p>So that MsgBox line is throwing an error. Is it normal for Ubound to throw an error on an empty array? If so, how do I add the first element to an empty array?</p>\n"}, {"tags": ["excel", "vba", "xpath"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556647993, "post_id": 55925766, "comment_id": 98506833, "body": "I can&#39;t reproduce this. Can you show the code for xdoc creation and population?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5482929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e36a0684c01776ed65605797c86eea84?s=128&d=identicon&r=PG&f=1", "display_name": "ivelin", "link": "https://stackoverflow.com/users/5482929/ivelin"}, "edited": false, "score": 1, "creation_date": 1556688567, "post_id": 55926632, "comment_id": 98516966, "body": "Hi, this works for me indeed. I had Microsoft XML 3 in references, after changing to Microsoft XML 6 it works. Thanks for the help!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1556648079, "creation_date": 1556648079, "answer_id": 55926632, "question_id": 55925766, "link": "https://stackoverflow.com/questions/55925766/xpath-query-with-backslashes-return-empty/55926632#55926632", "title": "xpath query with backslashes return empty", "body": "<p>I see nothing wrong with your xpath. Perhaps the error lies elsewhere. I used the following loading your xml from file; no problem.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub test()\n    Dim xmlDoc As Object, item As Object\n    Set xmlDoc = CreateObject(\"MSXML2.DOMDocument\") 'New MSXML2.DOMDocument60\n    With xmlDoc\n        .validateOnParse = True\n        .setProperty \"SelectionLanguage\", \"XPath\"\n        .async = False\n        If Not .Load(\"C:\\Users\\User\\Desktop\\Test.xml\") Then\n            Err.Raise .parseError.ErrorCode, , .parseError.reason\n        End If\n    End With\n    Dim path As String\n    path = \"/Directory/Document[Path='C:\\Users\\Ivelin\\Desktop\\Workspace\\Requests\\File.xlsm']/Status/text()\"\n    Set item = xmlDoc.SelectSingleNode(path)\n    Debug.Print item.Text\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5482929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e36a0684c01776ed65605797c86eea84?s=128&d=identicon&r=PG&f=1", "display_name": "ivelin", "link": "https://stackoverflow.com/users/5482929/ivelin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 1, "accepted_answer_id": 55926632, "answer_count": 1, "score": 1, "last_activity_date": 1556648079, "creation_date": 1556644161, "last_edit_date": 1556646403, "question_id": 55925766, "link": "https://stackoverflow.com/questions/55925766/xpath-query-with-backslashes-return-empty", "title": "xpath query with backslashes return empty", "body": "<p>I am trying to select a single MSXML2 node in excel using XPath predicates. I am able to select it just fine when I supply a string without backslashes. But as soon as I try with a file path string, the expression returns nothing.</p>\n\n<p>Here is my XML:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;Directory&gt;\n&lt;Document&gt;\n    &lt;Path/&gt;\n    &lt;Status/&gt;\n    &lt;Notes/&gt;\n&lt;/Document&gt;\n&lt;Document&gt;\n    &lt;Path&gt;C:\\Users\\Ivelin\\Desktop\\Workspace\\Requests\\File.xlsm&lt;/Path&gt;\n    &lt;Status&gt;Started&lt;/Status&gt;\n    &lt;Notes/&gt;&lt;/Document&gt;\n&lt;Document&gt;\n    &lt;Path&gt;TEST&lt;/Path&gt;\n    &lt;Status&gt;Started&lt;/Status&gt;\n    &lt;Notes/&gt;\n&lt;/Document&gt;\n&lt;/Directory&gt;\n</code></pre>\n\n<p>This works:</p>\n\n<pre><code>Dim Stat As IXMLDOMNode\nDim strPath\nstrPath = \"/Directory/Document[Path='TEST']/Status/text()\"\nMsgBox (strPath)\nSet Stat = XDoc.SelectSingleNode(strPath) \nMsgBox (Stat.NodeValue)\n</code></pre>\n\n<p>This returns null:</p>\n\n<pre><code>Dim Stat As IXMLDOMNode\nDim strPath\nstrPath = \"/Directory/Document[Path='C:\\Users\\Ivelin\\Desktop\\Workspace\\Requests\\File.xlsm']/Status/text()\"\nMsgBox (strPath)\nSet Stat = XDoc.SelectSingleNode(strPath) \nMsgBox (Stat.NodeValue)\n</code></pre>\n\n<p>I tried different suggestions, double backslashes etc. but no luck. Since I am interested in file names/paths, I don't really have other option, but to use backslashes.</p>\n\n<p>Any pointers on how to solve this are welcome.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11433719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26cc220d2386848fd79521b26eb2ee22?s=128&d=identicon&r=PG&f=1", "display_name": "M.W.", "link": "https://stackoverflow.com/users/11433719/m-w"}, "edited": false, "score": 0, "creation_date": 1556649233, "post_id": 55925948, "comment_id": 98507359, "body": "Thank you, Currently Column A:A is called Units so the amount of time a code has been scanned. Column B:B is a list with barcodes ,currently empty. When I scan a new barcode the macro should add the barcode to column B:B and a +1 in column A:A next to its corresponding barcode."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 19, "user_id": 11433719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26cc220d2386848fd79521b26eb2ee22?s=128&d=identicon&r=PG&f=1", "display_name": "M.W.", "link": "https://stackoverflow.com/users/11433719/m-w"}, "edited": false, "score": 0, "creation_date": 1556649988, "post_id": 55925948, "comment_id": 98507659, "body": "@M.W. then you just need to update the column references in the <code>Else</code> section from 3 to 1 (column A = 1, B = 2, C = 3, etc.).  This would fulfill the needs, where if it&#39;s not matched in column 2 (B) it is added to the last row + 1, assuming there is a header , the first row to have data is 2."}, {"owner": {"reputation": 19, "user_id": 11433719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26cc220d2386848fd79521b26eb2ee22?s=128&d=identicon&r=PG&f=1", "display_name": "M.W.", "link": "https://stackoverflow.com/users/11433719/m-w"}, "edited": false, "score": 0, "creation_date": 1556651054, "post_id": 55925948, "comment_id": 98508097, "body": "Big thanks to you, however there is one problem it keeps adding 93 so, +93 instead of +1"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 19, "user_id": 11433719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26cc220d2386848fd79521b26eb2ee22?s=128&d=identicon&r=PG&f=1", "display_name": "M.W.", "link": "https://stackoverflow.com/users/11433719/m-w"}, "edited": false, "score": 0, "creation_date": 1556657138, "post_id": 55925948, "comment_id": 98510486, "body": "Glad you got it sorted!"}, {"owner": {"reputation": 19, "user_id": 11433719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26cc220d2386848fd79521b26eb2ee22?s=128&d=identicon&r=PG&f=1", "display_name": "M.W.", "link": "https://stackoverflow.com/users/11433719/m-w"}, "edited": false, "score": 0, "creation_date": 1557104890, "post_id": 55925948, "comment_id": 98642348, "body": "Hi do you also know how I  can move the edited row to the top off my list? So basically a barcode is scanned and is placed in row 100 &quot;or whatever&quot;  but I want it to appear in row 4"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 0, "last_activity_date": 1556650361, "last_edit_date": 1556650361, "creation_date": 1556644929, "answer_id": 55925948, "question_id": 55925586, "link": "https://stackoverflow.com/questions/55925586/edit-adjacent-cells-with-find/55925948#55925948", "title": "Edit (adjacent) cells with Find()", "body": "<p>The the below will <strong>A)</strong> verify that you don't have a match (using <code>IsError</code>, which returns boolean) to determine if you need to add a value and start the scan count at 1, or <strong>B)</strong> if you need to find the previous entry (using <code>Match()</code>) and add to the counter:</p>\n\n<pre><code>If IsError(Application.Match(Cells(1,3).Value,Columns(2),0)) Then \n    lr = cells(rows.count,2).end(xlup).row\n    Cells(lr+1,2).Value = Cells(1,3).Value\n    Cells(lr+1,1).Value = 1\nElse \n    r = Application.match(Cells(1,3).Value,Columns(2),0)\n    cells(r,1).value = cells(r,1).value + 1\nEnd If\n</code></pre>\n\n<hr>\n\n<p><strong>Edit1:</strong></p>\n\n<p>Updated column #s for second subroutine per comment from OP, while stripping out the first subroutine and rewording.</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 11433719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26cc220d2386848fd79521b26eb2ee22?s=128&d=identicon&r=PG&f=1", "display_name": "M.W.", "link": "https://stackoverflow.com/users/11433719/m-w"}, "edited": false, "score": 0, "creation_date": 1556649394, "post_id": 55925956, "comment_id": 98507419, "body": "Thank you , but what I want is that the list should be created while the barcodes get scanned, because the excel sheet needs to be empty every time it is going to be used. The files are going to be saved by date and every day a new shipments of goods come in they al have new barcodes and need to be added to the list and counted."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 19, "user_id": 11433719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26cc220d2386848fd79521b26eb2ee22?s=128&d=identicon&r=PG&f=1", "display_name": "M.W.", "link": "https://stackoverflow.com/users/11433719/m-w"}, "edited": false, "score": 0, "creation_date": 1556649484, "post_id": 55925956, "comment_id": 98507468, "body": "My code adds new barcodes to the list and count them... check it out. thought you need to create a tab called &quot;DataBase&quot; to keep track of everything"}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 0, "last_activity_date": 1556645320, "last_edit_date": 1556645320, "creation_date": 1556644966, "answer_id": 55925956, "question_id": 55925586, "link": "https://stackoverflow.com/questions/55925586/edit-adjacent-cells-with-find/55925956#55925956", "title": "Edit (adjacent) cells with Find()", "body": "<p>With this code you will need a sheet called \"DataBase\" where you will store each scan and later will be the source for example for a pivot table:</p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim Barcode As String, i As Long, wsDB As Worksheet, LastRow As Long\n    Dim DictBarcodes As New Scripting.Dictionary 'You need to check the Microsoft Scripting Runtime reference for this to work\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n    End With\n\n    Set wsDB = ThisWorkbook.Sheets(\"DataBase\")\n\n    With Target\n        If .Range(\"C1\") = vbNullString Then MsgBox \"No input\"\n        On Error Resume Next\n\n        'loop through all the barcodes and store them into a dictionary\n        For i = 1 To .Rows.Count\n            If .Cells(i, 2) = vbNullString Then Exit For 'skip the loop once a blank cell is found\n            DictBarcodes.Add .Cells(i, 1), i 'this will raise an error if there are duplicates\n        Next i\n\n        'If the value doesn't exist we add it to the list\n        If Not DictBarcodes.Exists(.Cells(1, 3)) Then\n            LastRow = .Cells(.Rows.Count, 2).End(xlUp).Row + 1\n            .Cells(LastRow, 2) = .Cells(1, 3)\n        End If\n    End With\n\n    'Either it exists or not, store it to the data base to keep tracking\n    With wsDB\n        .Cells(1, 1) = \"Barcode\"\n        .Cells(1, 2) = \"Date Scan\"\n        LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row + 1\n        .Cells(LastRow, 1) = .Cells(1, 3)\n        .Cells(LastRow, 2) = Now\n    End With\n\n    'Finally the output on the adjacent cell\n    Target.Cells(1, 4) = Application.CountIf(wsDB.Range(\"A:A\"), Target.Cells(1, 3))\n\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n        .Calculation = xlCalculationAutomatic\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11433719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26cc220d2386848fd79521b26eb2ee22?s=128&d=identicon&r=PG&f=1", "display_name": "M.W.", "link": "https://stackoverflow.com/users/11433719/m-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 55925948, "answer_count": 2, "score": 0, "last_activity_date": 1556779148, "creation_date": 1556643400, "last_edit_date": 1556779148, "question_id": 55925586, "link": "https://stackoverflow.com/questions/55925586/edit-adjacent-cells-with-find", "title": "Edit (adjacent) cells with Find()", "body": "<p>I'm writing a small macro for searching and sorting barcodes. </p>\n\n<p>The idea is that barcodes are scanned into cell C1, then the macro is suppose to count the amount of times the same code is scanned. If the barcode is not already in the list (column B:B) it should add the new barcode in the list (column B:B).</p>\n\n<p>I've managed utilised the Find() syntax, however I can't manage to edit any cells with it. Only thing I am able to do is MsgBox \" \"  Ive tried:</p>\n\n<pre><code>Range(\"a5\").Value = 5\n</code></pre>\n\n<p>It doesn't work </p>\n\n<p>This is the code I currently have:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)    \n    If Range(\"C1\") = \"\" Then MsgBox \"No input\"\n\n    Dim barcodes As Range        \n    Set barcodes = Range(\"B:B\").Find(What:=Range(\"C1\").Value, After:=Range(\"B2\"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=True, MatchByte:=True, SearchFormat:=False)\n\n    If Not barcodes Is Nothing And Not Range(\"C1\") = \"\" Then\n        MsgBox \"Found\"\n    End If\n\n    If barcodes Is Nothing And Not Range(\"C1\") = \"\" Then\n        MsgBox \"New product\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>For <code>MsgBox \"Found\"</code> I want instead a code that counts the amount of times the same barcode has been scanned in the adjacent cell to the right. </p>\n\n<p>And for <code>Msgbox \"New product\"</code> I want to write a part that adds the new code to the list in this case Column B:B</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 3, "creation_date": 1556642081, "post_id": 55925175, "comment_id": 98504132, "body": "Do you need VBA for this? Both <code>=SUMPRODUCT((B1:B15=&quot;Dog&quot;)*(C1:C15=&quot;Hamster&quot;))</code> or <code>=COUNTIFS(B1:B15,&quot;Dog&quot;,C1:C15,&quot;Hamster&quot;)</code> return a count. If it can be both ways (Dog &amp; Hamster, Hamster &amp; Dog) you can write it both ways and add the two formulas"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1556643326, "post_id": 55925175, "comment_id": 98504721, "body": "With the update, JvDv&#39;s suggestion shuold be even more appropriate.  <code>=CountIfs(Source!$B:$B, Criteria!A2, Source!$C:$C, Criteria!B2)</code> where Source is the source sheet for your data, assuming col B is where pet named 1 shows up and col C is where petname 2 shows up, and Criteria is the sheet where your newly added list exists, where A2 &amp; B2 are dynamic references so you can drag the formula down."}, {"owner": {"reputation": 3, "user_id": 11428901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade1cadd21b86bc1b85133c433ddb52a?s=128&d=identicon&r=PG&f=1", "display_name": "Hamoudi", "link": "https://stackoverflow.com/users/11428901/hamoudi"}, "edited": false, "score": 0, "creation_date": 1556644889, "post_id": 55925175, "comment_id": 98505438, "body": "I need it in VBA as it is part of a larger automation of a data dump i am given. Essentially i am trying to count how many students that have a Parrot and Goldfish are considered F05 Students (Student type is a column on its own. Any help with the VBA code would be much appreciated."}], "owner": {"reputation": 3, "user_id": 11428901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade1cadd21b86bc1b85133c433ddb52a?s=128&d=identicon&r=PG&f=1", "display_name": "Hamoudi", "link": "https://stackoverflow.com/users/11428901/hamoudi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556643090, "creation_date": 1556641596, "last_edit_date": 1556643090, "question_id": 55925175, "link": "https://stackoverflow.com/questions/55925175/searching-entire-column-and-counting-matches-with-criteria-in-another-sheet", "title": "Searching entire column and counting matches with criteria in another sheet", "body": "<p>Basically i have two sheets, one worksheet with the criteria that will be used to search and count how many matches there are in another worksheet. Criteria is in two columns, for example each column has a type of pet dog and cat. The two pets in each row should be treated as a pair or set.</p>\n\n<pre><code>Unique Criteria \nPet1    Pet2\nDog Cat\nDog Hamster\nCat Hamster\nSnake   Dog\nParrot  GoldFish\n</code></pre>\n\n<p>I want to count how many students have the specific combinations of the Criteria next to each other for example Dog and Cat, how many have Dog and Hamster, How many have Parrot GoldFish.</p>\n\n<p>In the other sheet it has a list of students about 8 columns. Two of the columns are the pets they have. I want to match with these columns and count how many have a Dog and Hamster. </p>\n\n<p>So far i have been able to match the first set of criteria with the first student. I am lost at this point on what would be the best way to search the entire two columns and count how many student have a Dog and Cat and then display the count amount.  </p>\n\n<p>Sorry if i didnt explain perfectly! Thanks in advance!!</p>\n\n<pre><code>Sub CountProgPlan()\nDim Prog As Range\nSet Prog = Worksheets(\"Sheet2\").Range(\"a6\")\nDim Plan As Range\nSet Plan = Worksheets(\"Sheet2\").Range(\"b6\")\nDim StudentType As String\nStudentType = \"F05\"\nIf Prog = Worksheets(\"Sheet1\").Range(\"E2\") And Plan = Worksheets(\"Sheet1\").Range(\"F2\") And StudentType = Worksheets(\"Sheet1\").Range(\"d2\") Then\nMsgBox \"Postive\"\nElse\nMsgBox \"This is Negative\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "outlook-filter"], "comments": [{"owner": {"reputation": 567, "user_id": 11280012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/twb4R.png?s=128&g=1", "display_name": "Ronan Vico", "link": "https://stackoverflow.com/users/11280012/ronan-vico"}, "edited": false, "score": 0, "creation_date": 1556640589, "post_id": 55924883, "comment_id": 98503411, "body": "why are you using DASL ?"}, {"owner": {"reputation": 313, "user_id": 2333402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d33488407f4aea5362eaac866fdab3a?s=128&d=identicon&r=PG", "display_name": "Jaspos", "link": "https://stackoverflow.com/users/2333402/jaspos"}, "reply_to_user": {"reputation": 567, "user_id": 11280012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/twb4R.png?s=128&g=1", "display_name": "Ronan Vico", "link": "https://stackoverflow.com/users/11280012/ronan-vico"}, "edited": false, "score": 0, "creation_date": 1556704684, "post_id": 55924883, "comment_id": 98521622, "body": "@RonanVico: I&#39;m using DASL, as, according to Microsoft docs, the string filter for View.Filter in VBA is DASL:  &quot;The value of this property is a string, in DAV Searching and Locating (DASL) syntax&quot;  Happy to use any other appropriate method you can advise if it will work!"}, {"owner": {"reputation": 313, "user_id": 2333402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d33488407f4aea5362eaac866fdab3a?s=128&d=identicon&r=PG", "display_name": "Jaspos", "link": "https://stackoverflow.com/users/2333402/jaspos"}, "reply_to_user": {"reputation": 567, "user_id": 11280012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/twb4R.png?s=128&g=1", "display_name": "Ronan Vico", "link": "https://stackoverflow.com/users/11280012/ronan-vico"}, "edited": false, "score": 1, "creation_date": 1556705163, "post_id": 55924883, "comment_id": 98521780, "body": "As an addendum, I have found a VERY weird issue with DASL for this.  You can use the Outlook filter dialog box to create the DASL for you. But it works oddly,  For example, I can put in an email address on the &quot;Sent To&quot; field in the dialog box, and then pressing OK this works exactly as I need (showing ALL emails sent to this email address, not just those where the email address is in the &#39;DisaplayTo&#39; name. Great!!  This generates the following DASL code:"}, {"owner": {"reputation": 313, "user_id": 2333402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d33488407f4aea5362eaac866fdab3a?s=128&d=identicon&r=PG", "display_name": "Jaspos", "link": "https://stackoverflow.com/users/2333402/jaspos"}, "reply_to_user": {"reputation": 567, "user_id": 11280012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/twb4R.png?s=128&g=1", "display_name": "Ronan Vico", "link": "https://stackoverflow.com/users/11280012/ronan-vico"}, "edited": false, "score": 1, "creation_date": 1556705359, "post_id": 55924883, "comment_id": 98521844, "body": "<code>(&quot;http:&#47;&#47;schemas.microsoft.com&#47;mapi&#47;proptag&#47;0x0e04001f&quot; CI_STARTSWITH &#39;mymail@gmail.com&#39; OR &quot;http:&#47;&#47;schemas.microsoft.com&#47;mapi&#47;proptag&#47;0x0e03001f&quot; CI_STARTSWITH &#39;mymail@gmail.com&#39;) </code>  BUT, when you use this code in VBA, the filter only shows emails with the email address in the &#39;DisaplayTo&#39; field, not all emails as before  ie I get 2 different results, one from the dialog box, one in code, with supposedly the same DASL quesry!!!"}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 2333402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d33488407f4aea5362eaac866fdab3a?s=128&d=identicon&r=PG", "display_name": "Jaspos", "link": "https://stackoverflow.com/users/2333402/jaspos"}, "edited": false, "score": 0, "creation_date": 1556705001, "post_id": 55927998, "comment_id": 98521717, "body": "In fact, for the View.Filter DASL there&#39;s no need to add the &quot;@SQL=&quot; (see the example here on Microsoft docs: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.view.filter\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/outlook.view.filter</a>)  As I noted, the code as posted works fine, I am trying to find the equivalent for the &#39;To&#39; email address (NB and it HAS to be the email address NOT the display name)  FYI I am also not looking to return a collection I can inspect etc - I want the results returned in the Outlook window so the user sees the filtered emails.  Any help you can provide much appreciated!"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 1, "last_activity_date": 1556654713, "creation_date": 1556654713, "answer_id": 55927998, "question_id": 55924883, "link": "https://stackoverflow.com/questions/55924883/how-to-filter-an-outlook-view-in-vba-based-on-to-email-addresses/55927998#55927998", "title": "How to filter an Outlook view in VBA based on &quot;To&quot; email addresses", "body": "<p><em>Should be</em> </p>\n\n<pre><code>Dim Filter As String\n    Filter = \"@SQL=\" &amp; Chr(34) &amp; \"urn:schemas:httpmail:fromemail\" &amp; _\n                       Chr(34) &amp; \" Like '%0m3r 0m3r%'\"\n</code></pre>\n\n<p><em>Or use</em> </p>\n\n<pre><code>Filter = \"[SenderEmailAddress] = '0m3r@email.com'\"\n</code></pre>\n\n<p><em>Example</em></p>\n\n<pre><code>Option Explicit\nPrivate Sub Examples()\n    Dim olNs As Outlook.NameSpace\n    Dim Inbox As Outlook.MAPIFolder\n    Dim Item As Outlook.MailItem\n    Dim Items As Outlook.Items\n    Dim msg As String\n\n    Set olNs = Application.GetNamespace(\"MAPI\")\n    Set Inbox = olNs.GetDefaultFolder(olFolderInbox)\n\n    Dim Filter As String\n        Filter = \"@SQL=\" &amp; Chr(34) &amp; \"urn:schemas:httpmail:fromemail\" &amp; _\n                           Chr(34) &amp; \" Like '%0m3r 0m3r%'\"\n\n    Set Items = Inbox.Items.Restrict(Filter)\n\n    msg = Items.Count &amp; \" Items in \" &amp; Inbox.Name\n\n    MsgBox (msg)\n\nEnd Sub\n</code></pre>\n\n<p><strong><em><a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/exchange-server-2003/aa123730%28v%3Dexchg.65%29\" rel=\"nofollow noreferrer\">MSDN fromemail Field | Microsoft Docs</a></em></strong></p>\n\n<p><em><a href=\"https://stackoverflow.com/search?tab=votes&amp;q=user%3a4539709%20%5boutlook-filter%5d\">https://stackoverflow.com/search?tab=votes&amp;q=user%3a4539709%20%5boutlook-filter%5d</a></em></p>\n"}], "owner": {"reputation": 313, "user_id": 2333402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d33488407f4aea5362eaac866fdab3a?s=128&d=identicon&r=PG", "display_name": "Jaspos", "link": "https://stackoverflow.com/users/2333402/jaspos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 842, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1610625304, "creation_date": 1556640383, "last_edit_date": 1592554635, "question_id": 55924883, "link": "https://stackoverflow.com/questions/55924883/how-to-filter-an-outlook-view-in-vba-based-on-to-email-addresses", "title": "How to filter an Outlook view in VBA based on &quot;To&quot; email addresses", "body": "<p>I have a view in Outlook that includes both \"From\" and \"To\" emails from a mailbox</p>\n\n<p>I can very easily type in an email address into the Outlook search box, and the view will be instantly filtered to show all emails to and from the email address (plus perhaps, any other emails including this email address in the subject or body, but that's not an issue)</p>\n\n<p>I would like to replicate this process via VBA - I have an Access DB with contact details, and would like to be able to simply filter this view based on a contact email address in the DB.</p>\n\n<p>It seems like a very simple problem, but I can't find the solution. I have code that eg filters based on the from email address, but there seems no way to filter on a 'To' email address (I can filter on the 'To' display name but this is next to useless - it varies from one email to another, and seldom if ever contains the actual email address)</p>\n\n<p>I have a DASL filter code that works to filter on the 'From' email addresses using DASL syntax as follows:</p>\n\n<pre><code>Const SchemaFrom As String = \"urn:schemas:httpmail:fromemail\"\nDim EM as string\nEM = \"myemail@me.com\"\nobjView.Filter = Chr(34) &amp; SchemaFrom &amp; Chr(34) &amp; \" = '\" &amp; EM &amp; \"'\"\n</code></pre>\n\n<p>But there is nothing similar for 'To' emails.</p>\n\n<p>Ultimately I don't even need to filter based on eg the 'From' and 'To' email addresses - if there is a way to code this, so, like in the search box, it simply filters on any text field containing the email address that would be fine by me!!!</p>\n\n<p>For example, is there a generic DASL search that will do this, so no need to eg dictate searching in eg fromemail?</p>\n\n<p>All help much appreciated - it is so simple to do in the GUI of Outlook it must be possible from VBA surely?!</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1556648627, "post_id": 55924740, "comment_id": 98507107, "body": "&#39;director&#39; and &#39;senior&#39; could be data in same field - multiple records? So an entity could be both director and senior? Edit question to show sample data."}, {"owner": {"reputation": 37, "user_id": 10256126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b143fbbef4a024b915edd063710fdf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Tyrone", "link": "https://stackoverflow.com/users/10256126/tyrone"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1556736168, "post_id": 55924740, "comment_id": 98535355, "body": "@June7 Like a senior director of informatics as opposed to director of vital statistics. All of the filters for office title are bound to the same column in a table"}], "answers": [{"tags": [], "owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "is_accepted": false, "score": 0, "last_activity_date": 1556679887, "last_edit_date": 1556679887, "creation_date": 1556679541, "answer_id": 55931107, "question_id": 55924740, "link": "https://stackoverflow.com/questions/55924740/is-there-a-way-to-filter-a-report-based-on-a-textbox-that-will-exclude-whatever/55931107#55931107", "title": "Is there a way to filter a report based on a textbox that will exclude whatever is in the textbox?", "body": "<p>I don't think</p>\n\n<pre><code>If Me.Frame19 = 2 = True Then\n</code></pre>\n\n<p>and</p>\n\n<pre><code>If Me.Frame19 = 3 = True Then\n</code></pre>\n\n<p>will ever evaluating to true, I believe VBA evaluates 3 = true first which would always be false, then you are comparing a boolean type to an object type after that.</p>\n\n<p>Try:</p>\n\n<pre><code>If Me.Frame19.value = 1 Then\n....\nIf Me.Frame19.value = 2 Then\n...\nIf Me.Frame19.value = 3 Then\n</code></pre>\n\n<p>You should always specify which property of the object you are using i.e. .value or .text or .caption etc.</p>\n"}], "owner": {"reputation": 37, "user_id": 10256126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b143fbbef4a024b915edd063710fdf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Tyrone", "link": "https://stackoverflow.com/users/10256126/tyrone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594780204, "creation_date": 1556639844, "last_edit_date": 1594780204, "question_id": 55924740, "link": "https://stackoverflow.com/questions/55924740/is-there-a-way-to-filter-a-report-based-on-a-textbox-that-will-exclude-whatever", "title": "Is there a way to filter a report based on a textbox that will exclude whatever is in the textbox?", "body": "<p>I want to filter a report by excluding any word in a textbox. I can do this in a frame but I can't seem to do it by itself in a textbox. The reason I am doing this, is because I would ideally like to have 3 frames with option buttons that will allow me to filter the report based on what is in the textboxes.</p>\n\n<p>For example the three option buttons are associated with a textbox that will filter office titles. The three option buttons are begins with, contains and exclude. This works fine but the issue is I cannot combine multiple frames. I would want to filter something like 'begins with director but excludes senior'.</p>\n\n<pre><code>If Nz(Me.txtOffice, \"\") &lt;&gt; \"\" Then\n   If Me.Frame19 = 1 Then\n       stroffice = stroffice &amp; \"OFFICETITLE Like '\" &amp; Me.txtOffice &amp; \"*' AND \"\n       End If\n    If Me.Frame19 = 2 = True Then\n       stroffice = stroffice &amp; \"OFFICETITLE Like '*\" &amp; Me.txtOffice &amp; \"*' AND \"\n       End If\n    If Me.Frame19 = 3 = True Then\n       stroffice = stroffice &amp; \"OFFICETITLE Not Like '*\" &amp; Me.txtOffice &amp; \"*' AND \"\n       End If\n</code></pre>\n\n<p>Is there a way to have multiple frames filter a report or is there a way to have a textbox filter by excluding the word in the textbox?</p>\n"}, {"tags": ["excel", "vba", "csv", "boolean"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1556639675, "post_id": 55924447, "comment_id": 98502958, "body": "You can try using the import wizard which should allow you to set the column again as text before the import."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1556778525, "post_id": 55924643, "comment_id": 98546142, "body": "But note that in VBA <code>True</code> is <code>-1</code> while in formulas <code>True</code> is <code>1</code>!"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556780372, "post_id": 55924643, "comment_id": 98546911, "body": "@P\u1d07\u029c you  are kidding I hope? :) Wow, that&#39;s not funny - That can really destroy logic that you plan out on a worksheet... I will edit that into the answer because it could make a big difference for someone."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556780477, "post_id": 55924643, "comment_id": 98546946, "body": "@SolarMike No, I&#39;m not kidding. Test <code>Debug.Print cInt(True)</code>. But there is an easy solution: <code>False</code> is defined to be <code>0</code> and anything else should be considered as <code>True</code>, so no need to think about <code>-1</code> or <code>1</code>. Just think about <code>True</code> being not <code>0</code> as definition."}], "tags": [], "owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "is_accepted": true, "score": 2, "last_activity_date": 1556780491, "last_edit_date": 1556780491, "creation_date": 1556639514, "answer_id": 55924643, "question_id": 55924447, "link": "https://stackoverflow.com/questions/55924447/when-i-saveas-to-csv-it-changes-true-false-to-true-false/55924643#55924643", "title": "When I SaveAs to CSV it changes true/false to TRUE/FALSE", "body": "<p>When you save a CSV file, it removes formatting, so the true &amp; false, which Excel <strong>does</strong> recognize like it recognizes numbers like 1, 45 etc gets changed to TRUE &amp; FALSE.</p>\n\n<p>Just for interest, this shows multiplying by TRUE and FALSE, which excel equates to 1 (true) and 0 (false), (cells B1 and B2 contain 2):</p>\n\n<p><a href=\"https://i.stack.imgur.com/zxSkc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zxSkc.png\" alt=\"enter image description here\"></a></p>\n\n<p>Edit based on Peh's comment:</p>\n\n<p><strong>But note that in VBA True is -1 while in formulas True is 1</strong></p>\n\n<p>So,if you plan something on a worksheet to use in vba,then be careful.</p>\n"}], "owner": {"reputation": 17, "user_id": 1584637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51533f88065f0bfbd782fd2e27020e5e?s=128&d=identicon&r=PG", "display_name": "jhall68w", "link": "https://stackoverflow.com/users/1584637/jhall68w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 0, "accepted_answer_id": 55924643, "answer_count": 1, "score": 0, "last_activity_date": 1556780491, "creation_date": 1556638830, "last_edit_date": 1556778380, "question_id": 55924447, "link": "https://stackoverflow.com/questions/55924447/when-i-saveas-to-csv-it-changes-true-false-to-true-false", "title": "When I SaveAs to CSV it changes true/false to TRUE/FALSE", "body": "<p>I have true/false values in an xlsm formatted as TEXT.  When I SaveAS the sheet as a CSV file it changes all of the values as a TRUE/FALSE.  Is there a way to prevent that from happening, or will there need to be more steps added to the script to open the CSV and change the values to lower case? </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 13, "user_id": 11168058, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2g476hpGY0g/AAAAAAAAAAI/AAAAAAAABsQ/DHnKvA9mz00/photo.jpg?sz=128", "display_name": "Sandaruwan Weerasinghe", "link": "https://stackoverflow.com/users/11168058/sandaruwan-weerasinghe"}, "edited": false, "score": 0, "creation_date": 1556640367, "post_id": 55924419, "comment_id": 98503314, "body": "It&#39;s my pleasure."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1556638759, "creation_date": 1556638759, "answer_id": 55924419, "question_id": 55924383, "link": "https://stackoverflow.com/questions/55924383/run-vba-code-if-the-cell-value-true-or-equel-to-number-only/55924419#55924419", "title": "Run VBA code if the cell value true or equel to number only", "body": "<p>Just add another <code>If</code>, and use <code>Target</code> in your code rather than <code>ActiveCell</code>. The former is the cell that has been changed.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Not Application.Intersect(Target, [Picked]) Is Nothing Then\n        If Range(\"D2\").Value = 1 Then\n            [ValPicked] = Target.Value\n        End If\n     End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11168058, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2g476hpGY0g/AAAAAAAAAAI/AAAAAAAABsQ/DHnKvA9mz00/photo.jpg?sz=128", "display_name": "Sandaruwan Weerasinghe", "link": "https://stackoverflow.com/users/11168058/sandaruwan-weerasinghe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556779135, "creation_date": 1556638625, "last_edit_date": 1556779135, "question_id": 55924383, "link": "https://stackoverflow.com/questions/55924383/run-vba-code-if-the-cell-value-true-or-equel-to-number-only", "title": "Run VBA code if the cell value true or equel to number only", "body": "<p>I have an excel sheet which contain dynamic cell range name list(Picked)name manager. When I click any cell from that list vba code shows active cell value in another cell. I want run this vba code if <code>$d$2 = 1</code> only.</p>\n\n<p>VBA code as below.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Not Application.Intersect(ActiveCell, [Picked]) Is Nothing Then\n        [ValPicked] = ActiveCell.Value\n     End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "date", "ms-access", "controls"], "comments": [{"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556648913, "post_id": 55924198, "comment_id": 98507221, "body": "Why not applying Null value to date?"}, {"owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "reply_to_user": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556650714, "post_id": 55924198, "comment_id": 98507972, "body": "@VanNg the <code>acDate</code> doesn&#39;t work. it&#39;s giving me an undefined variable error no matter what <code>.Value</code> i try to give it"}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556651085, "post_id": 55924198, "comment_id": 98508106, "body": ".Value = Null that gives you what type of error?"}, {"owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "reply_to_user": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556652339, "post_id": 55924198, "comment_id": 98508623, "body": "@VanNg variable not defined on &quot;acDate&quot;"}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556653109, "post_id": 55924198, "comment_id": 98508900, "body": "Yep. Cause there is no such type - see <a href=\"https://documentation.help/MS-Access-Visual-Basic/acproControlType.htm\" rel=\"nofollow noreferrer\">documentation.help/MS-Access-Visual-Basic/acproControlType.h&zwnj;&#8203;tm</a>"}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556653221, "post_id": 55924198, "comment_id": 98508950, "body": "There can be textbox with applied input mask for date and time, or specific ActiveX control as datepicker. Just this check in case condition, maybe"}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556653259, "post_id": 55924198, "comment_id": 98508962, "body": "Just omit this check, delete this case part"}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556655155, "post_id": 55924198, "comment_id": 98509721, "body": "Case acTextBox .Value = Null"}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1556655173, "post_id": 55924198, "comment_id": 98509729, "body": "Correct this also"}], "answers": [{"comments": [{"owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "edited": false, "score": 0, "creation_date": 1556639017, "post_id": 55924297, "comment_id": 98502587, "body": "i&#39;m receiving a &quot;variable not defined&quot; error. I&#39;m not sure where i&#39;m going wrong here. I updated my post with the new code"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1556642172, "post_id": 55924297, "comment_id": 98504171, "body": "Who&#39;s downvoting this? Those values are the same, but <code>#00:00:00#</code> is faster to comprehend for &quot;foreigners&quot; (us outside the US)."}, {"owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "edited": false, "score": 0, "creation_date": 1556642751, "post_id": 55924297, "comment_id": 98504443, "body": "@gustav I receive a &quot;variable not defined&quot; error while using acDate. that is why I downvoted. I was hoping for more guidance on what i&#39;m doing wrong"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1556700695, "post_id": 55924297, "comment_id": 98520204, "body": "But <code>acDate</code> comes from your own code. It&#39;s not common practice to downvote others for own mistakes."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1556700896, "last_edit_date": 1556700896, "creation_date": 1556638299, "answer_id": 55924297, "question_id": 55924198, "link": "https://stackoverflow.com/questions/55924198/access-vba-resetting-a-date-on-a-form/55924297#55924297", "title": "Access VBA: Resetting a Date on a Form", "body": "<p>That is:</p>\n\n<pre><code>Case acDate\n    .Value = #00:00:00#\n</code></pre>\n\n<p>But, as noted, there is no \"Date\" control, thus you can reduce to:</p>\n\n<pre><code>For Each ctl In frm.Controls\n    With ctl\n        Select Case .ControlType\n            Case acTextBox, acComboBox, acListBox\n                .Value = Null\n            Case acCheckBox\n                .Value = False\n        End Select\n    End With\nNext ctl\n</code></pre>\n"}], "owner": {"reputation": 1164, "user_id": 2175534, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8495695328eb312bdd894387e0675c9c?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/2175534/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 55924297, "answer_count": 1, "score": 0, "last_activity_date": 1556700896, "creation_date": 1556637920, "last_edit_date": 1556638985, "question_id": 55924198, "link": "https://stackoverflow.com/questions/55924198/access-vba-resetting-a-date-on-a-form", "title": "Access VBA: Resetting a Date on a Form", "body": "<p>I'm trying to create a button with VBA code (on click) to empty a form in order for a new entry to be started, or an entry to be restarted. The below code works...</p>\n\n<pre><code>Public Sub clearForms()\nDim frm As Form\nSet frm = Forms!Person_Name\n\nDim ctl As Control\n\nFor Each ctl In frm.Controls\n    With ctl\n        Select Case .ControlType\n            Case acTextBox\n                .Value = \" \"\n            Case acCheckBox\n                .Value = False\n            Case acComboBox\n                .SetFocus\n                .SelText = \" \"\n            Case acListBox\n                .Value = Null\n            Case acDate\n\n        End Select\n    End With\nNext ctl\n\nMsgBox \"forms cleared\"\nEnd Sub\n</code></pre>\n\n<p>for everything besides a <code>Date</code> field that I have. I can't figure out how to reset the date to either 00:00:00:00 or just an empty box. I'd prefer an empty box, but am having trouble finding any information on how to do it. Thanks!</p>\n\n<p>Updated Code:</p>\n\n<pre><code>Public Sub clearForms()\nDim frm As Form\nSet frm = Forms!Person_Name\n\nDim ctl As Control\n\nFor Each ctl In frm.Controls\n    With ctl\n        Select Case .ControlType\n            Case acTextBox\n                .Value = \" \"\n            Case acCheckBox\n                .Value = False\n            Case acComboBox\n                .SetFocus\n                .SelText = \" \"\n            Case acListBox\n                .Value = Null\n            Case acDate\n                .Value = #12:00:00 AM#\n        End Select\n    End With\nNext ctl\n\nMsgBox \"forms cleared\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ssas", "mdx", "powerpivot", "powerquery"], "comments": [{"owner": {"reputation": 9093, "user_id": 5070440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/338bae7e3d7db140be2d1544e859f9f2?s=128&d=identicon&r=PG", "display_name": "GregGalloway", "link": "https://stackoverflow.com/users/5070440/greggalloway"}, "edited": false, "score": 0, "creation_date": 1556673562, "post_id": 55923810, "comment_id": 98514335, "body": "Can you describe what business need you are trying to accomplish? PowerPivot is pretty much an offline cube already so what feature is lacking?"}, {"owner": {"reputation": 125, "user_id": 11160298, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Nm421RiRedA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reHU1UN3gBCoq6U-N1kFr2g4O1-Jw/mo/photo.jpg?sz=128", "display_name": "Sergei Trunov", "link": "https://stackoverflow.com/users/11160298/sergei-trunov"}, "reply_to_user": {"reputation": 9093, "user_id": 5070440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/338bae7e3d7db140be2d1544e859f9f2?s=128&d=identicon&r=PG", "display_name": "GregGalloway", "link": "https://stackoverflow.com/users/5070440/greggalloway"}, "edited": false, "score": 0, "creation_date": 1556695938, "post_id": 55923810, "comment_id": 98518701, "body": "I am trying to put the data onto a share drive in hopes that my colleuges can access the same data once it&#39;s ready without having to share the workbook."}, {"owner": {"reputation": 9093, "user_id": 5070440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/338bae7e3d7db140be2d1544e859f9f2?s=128&d=identicon&r=PG", "display_name": "GregGalloway", "link": "https://stackoverflow.com/users/5070440/greggalloway"}, "edited": false, "score": 0, "creation_date": 1556714538, "post_id": 55923810, "comment_id": 98525452, "body": "do co-workers need to view it one-at-a-time or at the same time? Do you have SharePoint Online licenses for your users? Do you have a Power BI subscription for your users?"}, {"owner": {"reputation": 125, "user_id": 11160298, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Nm421RiRedA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reHU1UN3gBCoq6U-N1kFr2g4O1-Jw/mo/photo.jpg?sz=128", "display_name": "Sergei Trunov", "link": "https://stackoverflow.com/users/11160298/sergei-trunov"}, "reply_to_user": {"reputation": 9093, "user_id": 5070440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/338bae7e3d7db140be2d1544e859f9f2?s=128&d=identicon&r=PG", "display_name": "GregGalloway", "link": "https://stackoverflow.com/users/5070440/greggalloway"}, "edited": false, "score": 0, "creation_date": 1556715432, "post_id": 55923810, "comment_id": 98525850, "body": "We don&#39;t have any other products or platforms. Same time."}], "owner": {"reputation": 125, "user_id": 11160298, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Nm421RiRedA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reHU1UN3gBCoq6U-N1kFr2g4O1-Jw/mo/photo.jpg?sz=128", "display_name": "Sergei Trunov", "link": "https://stackoverflow.com/users/11160298/sergei-trunov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556646222, "creation_date": 1556636689, "last_edit_date": 1556646222, "question_id": 55923810, "link": "https://stackoverflow.com/questions/55923810/export-excel-powerpivot-recordset-as-offline-cube", "title": "Export Excel PowerPivot recordset as offline cube", "body": "<p>I have a PowerPivot model that has Power Query as a source. Is it possible to create an offline cube from this?</p>\n\n<p>I've tried creating a pivot table out of the PP and then using the pivotttable.createcubefile method, but get an error:</p>\n\n<pre><code>A cube file cannot be created from another cube file. The source \"$Embedded$\" is a cube file.\n</code></pre>\n\n<p>I've also tried ADODB and ADOMD connections.</p>\n\n<p>For ADODB an approach described here works to write CSV : <a href=\"https://www.kasperonbi.com/export-a-table-or-dax-query-from-power-pivot-to-csv-using-vba/\" rel=\"nofollow noreferrer\">https://www.kasperonbi.com/export-a-table-or-dax-query-from-power-pivot-to-csv-using-vba/</a></p>\n\n<p>But I cannot run a MDX query such as </p>\n\n<pre><code>CREATE GLOBAL CUBE \n</code></pre>\n\n<p>For ADOMD I tried an approach from here <a href=\"https://www.engram9.info/excel-2007-vba-2/creating-an-offline-cube-using-ado-md-and-vba.html\" rel=\"nofollow noreferrer\">https://www.engram9.info/excel-2007-vba-2/creating-an-offline-cube-using-ado-md-and-vba.html</a></p>\n\n<p>But the code fails at setting the ActiveConnection property for ADOMD.Catalog object. I use the </p>\n\n<pre><code>ThisWorkbook.Model.DataModelConnection.ModelConnection.ADOConnection\n</code></pre>\n\n<p>when setting the ActiveConnection property.</p>\n\n<p>Full code that I use atm</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Create_Local_Cube()\n    Dim ObjCatalog As New ADOMD.Catalog\n    Dim ObjCellset As New ADOMD.Cellset\n    Dim StrConnection As String\n    Dim strmdx As String\n\n    ThisWorkbook.Model.Initialize\n\n'Create connection string\n    'StrConnection = StrConnection &amp; \"Provider=MSOLAP;Data Source=D4SBY981;\"\n    'StrConnection = StrConnection &amp; \"Initial Catalog=AdventureWorks;\"\n    StrConnection = \"Provider=MSOLAP.5;Persist Security Info=True;Initial Catalog=Microsoft_SQLServer_AnalysisServices;Data Source=$Embedded$;MDX Compatibility=1;Safety Options=2;MDX Missing Member Mode=Error;Subqueries=0;Optimize Response=7;Update Isolation Level=2\"\n\n'Create the MDX Query\n\n    strmdx = strmdx &amp; \"CREATE GLOBAL CUBE [MyCustomCube]\"\n    strmdx = strmdx &amp; \"STORAGE 'C:\\MyCustomCube.cub' \"\n    strmdx = strmdx &amp; \"FROM [mergeMarinDs] \"\n    'StrMDX = StrMDX &amp; \"(\"\n    'StrMDX = StrMDX &amp; \"MEASURE [Analysis Services Tutorial].[Internet Sales-Sales Amount], \"\n    'StrMDX = StrMDX &amp; \"DIMENSION [Analysis Services Tutorial].[Customer], \"\n    'StrMDX = StrMDX &amp; \"DIMENSION [Analysis Services Tutorial].[Product]\"\n    'StrMDX = StrMDX &amp; \")\"\n\n    strmdx = \"EVALUATE mergeMarinDs\"\n\n'Feed the cellset object your MDX Query\n    ObjCellset.source = strmdx\n\n'Point catalog and cellset objects to the data source using your connection string\n    ObjCatalog.ActiveConnection = ThisWorkbook.Model.DataModelConnection.ModelConnection.ADOConnection\n    ObjCellset.ActiveConnection = ThisWorkbook.Model.DataModelConnection.ModelConnection.ADOConnection\n\n'Open Cellset and fill the local cube\n    ObjCellset.Open\n\n'Clean up\n\n    Set ObjCatalog = Nothing\n    Set ObjCellset = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I've also tried extracting the item.data file from a zipped workbook, but I don't know how to recover this file when chaging to .abf format as explained in slide 13 of this presentation <a href=\"https://slideplayer.com/slide/8455428/\" rel=\"nofollow noreferrer\">https://slideplayer.com/slide/8455428/</a></p>\n\n<p>Any advice on whether it is possible to export the PP model as an offline cube?</p>\n"}, {"tags": ["excel", "vba", "windows"], "comments": [{"owner": {"reputation": 28755, "user_id": 5047996, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/la3kD.png?s=128&g=1", "display_name": "aschipfl", "link": "https://stackoverflow.com/users/5047996/aschipfl"}, "edited": false, "score": 1, "creation_date": 1556634026, "post_id": 55922881, "comment_id": 98499647, "body": "<a href=\"https://scalibq.wordpress.com/2012/05/23/the-windows-command-prompt-is-not-a-dos-prompt/\" rel=\"nofollow noreferrer\">The Windows command prompt is <i>NOT</i> a DOS prompt!</a>"}, {"owner": {"reputation": 6216, "user_id": 10782538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd4ea4a840201c7d7ea5a86c46e558c?s=128&d=identicon&r=PG", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10782538/oliver"}, "edited": false, "score": 0, "creation_date": 1556634337, "post_id": 55922881, "comment_id": 98499803, "body": "<code>do until strloop = &quot;TXT&quot; or i &gt;= [number]</code>. Also very much as duplicate of <a href=\"https://stackoverflow.com/questions/38900644/do-loop-until-with-multiple-conditions\">this question</a>"}, {"owner": {"reputation": 6216, "user_id": 10782538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd4ea4a840201c7d7ea5a86c46e558c?s=128&d=identicon&r=PG", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10782538/oliver"}, "edited": false, "score": 0, "creation_date": 1556634409, "post_id": 55922881, "comment_id": 98499846, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/38900644/do-loop-until-with-multiple-conditions\">Do... Loop Until with multiple conditions</a>"}], "answers": [{"tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": false, "score": 3, "last_activity_date": 1556634143, "creation_date": 1556634143, "answer_id": 55922999, "question_id": 55922881, "link": "https://stackoverflow.com/questions/55922881/do-until-loop-one-or-another-condition-is-met/55922999#55922999", "title": "Do Until Loop. One or another condition is met", "body": "<pre><code>Dim StrLoop as string, i as long\n\nDo\n    DOS.readscreen StrLoop 3, 1, 4\n    i = i + 1\nLoop Until StrLoop = \"TXT\" or i = 1000\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 567, "user_id": 11280012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/twb4R.png?s=128&g=1", "display_name": "Ronan Vico", "link": "https://stackoverflow.com/users/11280012/ronan-vico"}, "is_accepted": false, "score": 2, "last_activity_date": 1556634265, "creation_date": 1556634265, "answer_id": 55923035, "question_id": 55922881, "link": "https://stackoverflow.com/questions/55922881/do-until-loop-one-or-another-condition-is-met/55923035#55923035", "title": "Do Until Loop. One or another condition is met", "body": "<p>You need to change the variable strloop , until get to a value </p>\n\n<pre><code>dim i as long \nDo Until StrLoop = \"TXT\" or i = 1000\n      DOS.readscreen StrLoop 3, 1, 4  \n      i = i + 1 \nLoop\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11432977, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N8GYx341geY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rerqKnw_UOLWzJRsWPkf2tUQTOU5Q/mo/photo.jpg?sz=128", "display_name": "Jmatta", "link": "https://stackoverflow.com/users/11432977/jmatta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1556642098, "creation_date": 1556633736, "last_edit_date": 1556642098, "question_id": 55922881, "link": "https://stackoverflow.com/questions/55922881/do-until-loop-one-or-another-condition-is-met", "title": "Do Until Loop. One or another condition is met", "body": "<p>I am trying to create a loop to have Excel tell a DOS based system to search for a condition. If it doesn't find the condition I get stuck in an infinite loop. I have found many situations where a loop will go until it meets a condition. But is there a way to have it run until the condition is met OR an integer reaches a point? I am VERY new to VBA, so take my lack of knowledge lightly please. </p>\n\n<p>I have tried several of the single condition guides, and purchased VBA for dummies, (not a great deal of help)</p>\n\n<pre><code>Sub Test ()\n    DOS.readscreen StrLoop 3, 1, 4  \n\n    Do Until StrLoop = \"TXT\"\n\n    Loop\nEnd Sub\n</code></pre>\n\n<p>I'm hoping to have an integer count to a certain point and if it reaches a point have it exit the loop. I am just uncertain of how to do it.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1556633088, "creation_date": 1556633088, "answer_id": 55922708, "question_id": 55922640, "link": "https://stackoverflow.com/questions/55922640/is-there-a-way-to-concontenate-on-a-file-path-in-excel-vba-2010/55922708#55922708", "title": "Is there a way to concontenate on a file path in excel vba 2010?", "body": "<p>This would be the correct syntax to concatenate strings:</p>\n\n<pre><code>Set xWb = Workbooks.Open(\"I:\\Shared\\Marlon\\Production\\Live Tracking\\TimeSheetProtype\\\" &amp; TextBox1.Value &amp; \".xlsm\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1556667625, "creation_date": 1556667625, "answer_id": 55929967, "question_id": 55922640, "link": "https://stackoverflow.com/questions/55922640/is-there-a-way-to-concontenate-on-a-file-path-in-excel-vba-2010/55929967#55929967", "title": "Is there a way to concontenate on a file path in excel vba 2010?", "body": "<p>The underscores are causing the problem.\nThey are line continuation characters in the VBE and somehow, in your writing or copy/pasting the code line, you have messed up the syntax.</p>\n\n<p>The underscore should be preceded by a <kbd>space</kbd> and followed by <kbd>newline</kbd>.</p>\n\n<p>So proper syntax of that line would be:</p>\n\n<pre><code>Set xWb = Workbooks.Open(\"I:\\Shared\\Marlon\\Production\\Live Tracking\\TimeSheetProtype\\\" &amp; _\n        TextBox1.Value _\n        &amp; \".xlsm\")\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11432947, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156294641527776/picture?type=large", "display_name": "Marlon Taylor", "link": "https://stackoverflow.com/users/11432947/marlon-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 55922708, "answer_count": 2, "score": 2, "last_activity_date": 1556667625, "creation_date": 1556632896, "last_edit_date": 1556633033, "question_id": 55922640, "link": "https://stackoverflow.com/questions/55922640/is-there-a-way-to-concontenate-on-a-file-path-in-excel-vba-2010", "title": "Is there a way to concontenate on a file path in excel vba 2010?", "body": "<p>I have tried this but I keep getting an error message of syntax but I am relatively new and struggle making the correction.</p>\n\n<p>Excel VBA 2010</p>\n\n<pre><code>Sub GoGetTimeSheet_Click()\n    'Find Specific Employee Time Sheet Time Sheet\n    Dim xWb As Workbook\n    Dim wbName As String\n\n    ''''This is where the highlight comes in''''''''\n\n\n    Set xWb = Workbooks.Open(\"I:\\Shared\\Marlon\\Production\\Live Tracking\\TimeSheetProtype\\\"&amp;_TextBox1.Value_&amp;\".xlsm\")\n\n    ''''''...........'''''''''''..........''''''''''.........''''''\n\n\n    wbName = xWb.Name\n    If Err.Number &lt;&gt; 0 Then\n        MsgBox \"This workbook doesn't exist!\", vbInformation, \"Hallmark MFO\"\n        Err.Clear\n    Else\n        MsgBox \"This workbook is opened!\", vbInformation, \"Congratulations, please proceed\"\n\n    End If\n\n    Call cmdClose_Click\nEnd Sub\n</code></pre>\n"}]