[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1427326451, "post_id": 29268461, "comment_id": 46738405, "body": "What range/cells are the formulas you want to change in? Is there always the same number of rows in each of the columns? What have you tried so far?"}, {"owner": {"reputation": 13, "user_id": 4714377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f6834bf1e9d435d2df91be5b221068?s=128&d=identicon&r=PG&f=1", "display_name": "Ted Barber Jr", "link": "https://stackoverflow.com/users/4714377/ted-barber-jr"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1427326777, "post_id": 29268461, "comment_id": 46738506, "body": "On each location worksheet formulas are within the range B2:M13 and each location worksheet contains the same number of rows/colmuns.  I have no coding experience so I have not tried any form of coding. I have been modifying each formula by using the find/replace on each  row of every worksheet."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1427326820, "post_id": 29268461, "comment_id": 46738515, "body": "Can you show us how your data is organized? Upload a screen shot in any free image hosting site (e.g. <a href=\"http://imgur.com\" rel=\"nofollow noreferrer\">imgur.com</a>) and post the link in comment or edit your post"}, {"owner": {"reputation": 13, "user_id": 4714377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f6834bf1e9d435d2df91be5b221068?s=128&d=identicon&r=PG&f=1", "display_name": "Ted Barber Jr", "link": "https://stackoverflow.com/users/4714377/ted-barber-jr"}, "edited": false, "score": 0, "creation_date": 1427327593, "post_id": 29268461, "comment_id": 46738740, "body": "Is there a way to upload the spreadsheet to this post?  I will remove the excess worksheets and only include the DATA worksheet and one location worksheet.  There are multiple formulas on the location worksheet.  Would it be helpful to post them?"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1427327849, "post_id": 29268461, "comment_id": 46738816, "body": "It would be, I dunno of what are good sites for hosting it though. The thing is, it is kinda hard to know what search-pattern to use to find and replace a number in a random formula. Will the formulas always be of the form which you showed above? Will the number you want to replace always be the same (i.e. 2 in your sample formula)? Will there be numbers in the formulas which you do <i>not</i> want to replace? Without knowing this, it is a bit tricky to even begin to come up with a solution."}, {"owner": {"reputation": 13, "user_id": 4714377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f6834bf1e9d435d2df91be5b221068?s=128&d=identicon&r=PG&f=1", "display_name": "Ted Barber Jr", "link": "https://stackoverflow.com/users/4714377/ted-barber-jr"}, "edited": false, "score": 0, "creation_date": 1427328329, "post_id": 29268461, "comment_id": 46738963, "body": "On the worksheet DATA row 2 contains data for January 2015 for location 1R, row 19 has February data, row 36 has March data, etc.  Row 3 contains January data for location 2R, 20 for February, etc.  This follows for the remaining 15 locations.  Here are the formulas in the location worksheets:  B2 =DATA!J2, C2 =DATA!C2, D2 =DATA!D2, E2 =(IF(ISBLANK(DATA!D2),&quot;-&quot;,IF(ISERROR(DATA!E2/DATA!D2),&quot;N/A&quot;,&zwnj;&#8203;(DATA!E2/DATA!D2))))&zwnj;&#8203;,"}, {"owner": {"reputation": 13, "user_id": 4714377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f6834bf1e9d435d2df91be5b221068?s=128&d=identicon&r=PG&f=1", "display_name": "Ted Barber Jr", "link": "https://stackoverflow.com/users/4714377/ted-barber-jr"}, "edited": false, "score": 0, "creation_date": 1427328515, "post_id": 29268461, "comment_id": 46739016, "body": "F2 =DATA!F2, G2 =(IF(ISBLANK(DATA!F2),&quot;-&quot;,IF(ISERROR(DATA!G2/DATA!F2),&quot;N/A&quot;,&zwnj;&#8203;(DATA!G2/DATA!F2))))&zwnj;&#8203;, H2 =DATA!H2, I2 =(IF(ISBLANK(DATA!I2),&quot;-&quot;,IF(ISERROR(DATA!I2/DATA!H2),&quot;N/A&quot;,&zwnj;&#8203;(DATA!I2/DATA!H2))))&zwnj;&#8203;, J2 =(IF(ISBLANK(DATA!J2),&quot;-&quot;,IF(ISERROR(DATA!K2/DATA!J2),&quot;N/A&quot;,&zwnj;&#8203;(DATA!K2/DATA!J2))))&zwnj;&#8203;, K2 =(IF(ISBLANK(DATA!J2),&quot;-&quot;,IF(ISERROR(DATA!L2/DATA!J2),&quot;N/A&quot;,&zwnj;&#8203;(DATA!L2/DATA!J2))))&zwnj;&#8203;, L2 =(IF(ISBLANK(DATA!J2),&quot;-&quot;,IF(ISERROR(DATA!M2/DATA!J2),&quot;N/A&quot;,&zwnj;&#8203;(DATA!M2/DATA!J2))))&zwnj;&#8203;, and M2 =(IF(ISBLANK(DATA!J2),&quot;-&quot;,IF(ISERROR(DATA!N2/DATA!J2),&quot;N/A&quot;,&zwnj;&#8203;(DATA!N2/DATA!J2))))&zwnj;&#8203;."}, {"owner": {"reputation": 13, "user_id": 4714377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f6834bf1e9d435d2df91be5b221068?s=128&d=identicon&r=PG&f=1", "display_name": "Ted Barber Jr", "link": "https://stackoverflow.com/users/4714377/ted-barber-jr"}, "edited": false, "score": 0, "creation_date": 1427328746, "post_id": 29268461, "comment_id": 46739095, "body": "(1) The number I want to replaced will be the same for that row only.  In column N on location worksheet 1R I have the value 3 in N2, 20 in N3, 37 in N4, etc.  On location worksheet 2R (the next worksheet) I have the value 4 in N2, 21 in N3, 38 in N4, etc.  (2)There are no numbers that will not be altered, meaning that every number in every formula will need to be modified to the number in column N of that row, since the same number applies to every formula in that row. (3)"}, {"owner": {"reputation": 13, "user_id": 4714377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f6834bf1e9d435d2df91be5b221068?s=128&d=identicon&r=PG&f=1", "display_name": "Ted Barber Jr", "link": "https://stackoverflow.com/users/4714377/ted-barber-jr"}, "edited": false, "score": 0, "creation_date": 1427329461, "post_id": 29268461, "comment_id": 46739286, "body": "Row 3 of worksheet 1R should have the number 19 in all formulas, row 4 should have row 36, etc.  Row 2 of the next location worksheet should have the number 3 in all formulas, row 3 should have the number 20, row 4 should have the number 37, etc.  The next location worksheet would increase the number by 1."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4714377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f6834bf1e9d435d2df91be5b221068?s=128&d=identicon&r=PG&f=1", "display_name": "Ted Barber Jr", "link": "https://stackoverflow.com/users/4714377/ted-barber-jr"}, "edited": false, "score": 0, "creation_date": 1427328043, "post_id": 29268621, "comment_id": 46738878, "body": "Again, forgive me if my original post wasn&#39;t clear.  Did I clearly describe what I&#39;m attempting to do?"}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": false, "score": 0, "last_activity_date": 1427327979, "last_edit_date": 1427327979, "creation_date": 1427327038, "answer_id": 29268621, "question_id": 29268461, "link": "https://stackoverflow.com/questions/29268461/use-code-to-modify-excel-formulas/29268621#29268621", "title": "Use code to modify Excel formulas", "body": "<p>You can always use something like:</p>\n\n<pre><code>If IsEmpty(Worksheets(\"DATA\").Cells(2, 4)) And _\n   IsError(Worksheets(\"DATA\").Cells(2, 5).Value / Worksheets(\"DATA\").Cells(2, 4).Value) Then\n   ActiveCell = \"NA\"\nElse\n   ActiveCell = Worksheets(\"DATA\").Cells(2, 5).Value / Worksheets(\"DATA\").Cells(2, 4).Value\nEnd If\n</code></pre>\n\n<p>Which is the formula you have translated to VBA code.</p>\n\n<p>However, you must add error handlers, and other stuff according to what you have in your input data.</p>\n"}, {"comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 13, "user_id": 4714377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f6834bf1e9d435d2df91be5b221068?s=128&d=identicon&r=PG&f=1", "display_name": "Ted Barber Jr", "link": "https://stackoverflow.com/users/4714377/ted-barber-jr"}, "edited": false, "score": 0, "creation_date": 1427331411, "post_id": 29269185, "comment_id": 46739819, "body": "Better now? @TedBarberJr"}, {"owner": {"reputation": 13, "user_id": 4714377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f6834bf1e9d435d2df91be5b221068?s=128&d=identicon&r=PG&f=1", "display_name": "Ted Barber Jr", "link": "https://stackoverflow.com/users/4714377/ted-barber-jr"}, "edited": false, "score": 0, "creation_date": 1427332198, "post_id": 29269185, "comment_id": 46739986, "body": "Thank you for your assistance eirikdaude.  This code is altering the formulas on the various location worksheets, which is ideal.  It also altered the data on the DATA worksheet but I reenter that data.  I truly appreciate your assistance with this.  Also, I&#39;ll look up some information to better understand what each line of this code does.  Thank you again!"}, {"owner": {"reputation": 13, "user_id": 4714377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f6834bf1e9d435d2df91be5b221068?s=128&d=identicon&r=PG&f=1", "display_name": "Ted Barber Jr", "link": "https://stackoverflow.com/users/4714377/ted-barber-jr"}, "edited": false, "score": 0, "creation_date": 1427332333, "post_id": 29269185, "comment_id": 46740010, "body": "YES!!  I really need to learn VB.  You have saved me hours of work.  Thank you again.  I truly appreciate the assistance."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 13, "user_id": 4714377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f6834bf1e9d435d2df91be5b221068?s=128&d=identicon&r=PG&f=1", "display_name": "Ted Barber Jr", "link": "https://stackoverflow.com/users/4714377/ted-barber-jr"}, "edited": false, "score": 0, "creation_date": 1427332757, "post_id": 29269185, "comment_id": 46740115, "body": "If this answers your question, I would appreciate if you marked it as such. There should be a checkmark next to the top of the answer. @TedBarberJr"}], "tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": true, "score": 0, "last_activity_date": 1427331283, "last_edit_date": 1427331283, "creation_date": 1427330630, "answer_id": 29269185, "question_id": 29268461, "link": "https://stackoverflow.com/questions/29268461/use-code-to-modify-excel-formulas/29269185#29269185", "title": "Use code to modify Excel formulas", "body": "<p>I am not on my work computer, so I haven't had the opportunity to test out this code, but I believe this should do what you want. If there are any issues with it, let me know, and I'll have a look at it at work tomorrow.</p>\n\n<pre><code>Sub replace_numbers()\n  Dim ws As Worksheet\n  Dim c As Range\n  Dim replace_with As Long\n  Dim objRegex As Object\n\n  'Application.EnableEvents = False\n  'Application.ScreenUpdating = False\n  'Application.DisplayStatusBar = False\n  'Application.Calculation = xlCalculationManual\n\n  Set objRegex = CreateObject(\"vbscript.regexp\")\n\n  With objRegex\n    .Global = True\n    .Pattern = \"\\d+\"\n  End With\n\n  For Each ws In Worksheets\n    If ws.Name &lt;&gt; \"DATA\" Then\n      For Each c In ws.Range(\"B2:M13\")\n        replace_with = CLng(Intersect(ws.Columns(\"N\"), ws.Rows(c.Row)).Value)\n        c.Formula = objRegex.Replace(c.Formula, replace_with)\n      Next\n    End If\n  Next\n\n  'Application.EnableEvents = True\n  'Application.ScreenUpdating = True\n  'Application.DisplayStatusBar = True\n  'Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>If the code runs as intended, remove the apostrophes before the <code>Application</code>-calls, in order to make the code run somewhat faster.</p>\n"}], "owner": {"reputation": 13, "user_id": 4714377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f6834bf1e9d435d2df91be5b221068?s=128&d=identicon&r=PG&f=1", "display_name": "Ted Barber Jr", "link": "https://stackoverflow.com/users/4714377/ted-barber-jr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2269, "favorite_count": 0, "accepted_answer_id": 29269185, "answer_count": 2, "score": 1, "last_activity_date": 1427331283, "creation_date": 1427326123, "last_edit_date": 1427330112, "question_id": 29268461, "link": "https://stackoverflow.com/questions/29268461/use-code-to-modify-excel-formulas", "title": "Use code to modify Excel formulas", "body": "<p>I have an Excel 2010 workbook with 22 worksheets in it.  The first worksheet is labeled DATA, where data is entered by a user.  Row A1-N1 contain labels.  Rows A2-A18 contains data for January 2015 for the 17 locations beginning as cell A2, i.e. row 2 contains data for location 1, row 3 for location 3, etc.  February data begins at row 19, March begins at row 36, etc.</p>\n\n<p>On each worksheet A1-M1 are labels and rows 2-13 are the months January - December.  Cell B2 on worksheet #2 references cell J2 on the worksheet DATA.  The other formulas on row 2 of worksheet #2 reference cells on row 2 on worksheet DATA.  Row 3 of worksheet #2 references cells on row 19 of DATA.  In column N of each location worksheet has a number in cell N2 that corresponds to the appliable row on the worksheet DATA.</p>\n\n<p>Here is an example of one of my formulas:</p>\n\n<blockquote>\n  <p>=(IF(ISBLANK(DATA!D2),\"-\",IF(ISERROR(DATA!E2/DATA!D2),\"N/A\",(DATA!E2/DATA!D2)))).</p>\n</blockquote>\n\n<p>I would like to have VB code, or a macro?, that would edit every formula on each worksheet by replacing the current number in the formula with the number in column N of that same row, i.e. if N7 contained the number 88 the code would alter any formula on that row by removing the current number in the formula and replacing with the number 88.</p>\n\n<p><strong>Additional information:</strong> </p>\n\n<p>On each worksheet there are different formulas for columns B-M.  The code would need to take the number in column N for that row and replace whatever number is in that formula with the number in column N of that row, for each row, for each worksheet.</p>\n\n<p>Currently, I have to touch each formula on every worksheet and this is too time consuming.  Beginning in April the locations will increase from 17 to 148 which will require coding to make the appropriate changes.</p>\n\n<p>DATA worksheet image </p>\n\n<p><img src=\"https://imgur.com/AP6M1G1.png\" alt=\"\"></p>\n\n<p>1R location worksheet image </p>\n\n<p><img src=\"https://imgur.com/9AcDGn0.png\" alt=\"\"></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 351, "user_id": 3597166, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5046ab7628deca9e3bf1b9f780a7b192?s=128&d=identicon&r=PG&f=1", "display_name": "Manivannan KG", "link": "https://stackoverflow.com/users/3597166/manivannan-kg"}, "edited": false, "score": 1, "creation_date": 1427326350, "post_id": 29268417, "comment_id": 46738374, "body": "There is no error handling in the above code. You can use <code>code</code> On Error Resume Next    to determine what should happen when errors occurs. Else you can validate with typical if else statment. Like if len(error) &lt;0, then &#39;do what you want else &#39;display error msg.."}], "answers": [{"comments": [{"owner": {"reputation": 1533, "user_id": 1965599, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/Rl1HG.png?s=128&g=1", "display_name": "Glyn", "link": "https://stackoverflow.com/users/1965599/glyn"}, "edited": false, "score": 0, "creation_date": 1427347006, "post_id": 29268517, "comment_id": 46743527, "body": "Thank you, I know very little about VBA and am on a steep learning curve. Regards, Glyn"}], "tags": [], "owner": {"reputation": 320, "user_id": 4713348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72460df3ea081a1177cb9566a6b57fc4?s=128&d=identicon&r=PG&f=1", "display_name": "gaby", "link": "https://stackoverflow.com/users/4713348/gaby"}, "is_accepted": true, "score": 1, "last_activity_date": 1427326405, "creation_date": 1427326405, "answer_id": 29268517, "question_id": 29268417, "link": "https://stackoverflow.com/questions/29268417/how-to-continue-a-macro-after-an-error-is-generated/29268517#29268517", "title": "How to continue a macro after an error is generated", "body": "<p><a href=\"http://support.microsoft.com/en-us/kb/141571\" rel=\"nofollow\">http://support.microsoft.com/en-us/kb/141571</a> Glun is correct\nYou have to take a look at On Error handle.</p>\n"}], "owner": {"reputation": 1533, "user_id": 1965599, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/Rl1HG.png?s=128&g=1", "display_name": "Glyn", "link": "https://stackoverflow.com/users/1965599/glyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 29268517, "answer_count": 1, "score": 0, "last_activity_date": 1427326405, "creation_date": 1427325926, "last_edit_date": 1531161705, "question_id": 29268417, "link": "https://stackoverflow.com/questions/29268417/how-to-continue-a-macro-after-an-error-is-generated", "title": "How to continue a macro after an error is generated", "body": "<p>I have an MS Excel macro that creates a number of PivotTables. The issue is that if a value that I am filtering on no longer exists an error is generated and the macro stops (the rest of the PivotTables are not created). The offending line is:</p>\n\n<pre><code>ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Test Cycle\").CurrentPage = _\n    \"SIT Cycle 2\"\n</code></pre>\n\n<p>If \"SIT Cycle 2\" has no errors today then it will not be in the source data and an error is thrown in the macro. Instead, I would like to print \"Nil\" on the active sheet and continue. The macro will eventually create about ten individual PivotTables.</p>\n\n<p>The Macro is:</p>\n\n<pre><code>'\n' Cycle_2_Severity_by_Status Macro\n'\n\n'\n    Sheets.Add\n    ActiveSheet.Name = \"Cycle 2 Severity by Status\"\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        \"Table_owssvr__1\", Version:=xlPivotTableVersion15).CreatePivotTable _\n        TableDestination:=\"'Cycle 2 Severity by Status'!R3C1\", TableName:=\"PivotTable2\", DefaultVersion _\n        :=xlPivotTableVersion15\n    Sheets(\"Cycle 2 Severity by Status\").Select\n    Cells(3, 1).Select\n    With ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Status\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Severity\")\n        .Orientation = xlColumnField\n        .Position = 1\n    End With\n    ActiveSheet.PivotTables(\"PivotTable2\").AddDataField ActiveSheet.PivotTables( _\n        \"PivotTable2\").PivotFields(\"SIR ID\"), \"Count of SIR ID\", xlCount\n    With ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Test Cycle\")\n        .Orientation = xlPageField\n        .Position = 1\n    End With\n    ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Test Cycle\"). _\n        ClearAllFilters\n    ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Test Cycle\").CurrentPage = _\n        \"SIT Cycle 2\"\n    Sheets(\"owssvr (1)\").Select\n    Range(\"A2\").Select\n'\n' SIT_CR_Severity_by_Status Macro\n'\n\n'\n    Sheets.Add\n    ActiveSheet.Name = \"SIT CR Severity by Status\"\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        \"Table_owssvr__1\", Version:=xlPivotTableVersion15).CreatePivotTable _\n        TableDestination:=\"'SIT CR Severity by Status'!R3C1\", TableName:=\"PivotTable2\", DefaultVersion _\n        :=xlPivotTableVersion15\n    Sheets(\"SIT CR Severity by Status\").Select\n    Cells(3, 1).Select\n    With ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Status\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Severity\")\n        .Orientation = xlColumnField\n        .Position = 1\n    End With\n    ActiveSheet.PivotTables(\"PivotTable2\").AddDataField ActiveSheet.PivotTables( _\n        \"PivotTable2\").PivotFields(\"SIR ID\"), \"Count of SIR ID\", xlCount\n    With ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Test Cycle\")\n        .Orientation = xlPageField\n        .Position = 1\n    End With\n    ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Test Cycle\"). _\n        ClearAllFilters\n    ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Test Cycle\").CurrentPage = _\n        \"SIT CR\"\n    Sheets(\"owssvr (1)\").Select\n    Range(\"A2\").Select\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1427326438, "post_id": 29268376, "comment_id": 46738402, "body": "Can you show how your data is organized? I think this can be simplified without looping. Show the source data (simplified) and then the form or template worksheet you want populated. You can upload screen shot in any free image hosting site (e.g <a href=\"http://imgur.com\" rel=\"nofollow noreferrer\">imgur.com</a>) and then post the link in your question."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1427327040, "post_id": 29268376, "comment_id": 46738586, "body": "Can you <a href=\"https://stackoverflow.com/posts/29268376/edit\">edit</a> your question and break up the huge wall of text to include some paragraph breaks? When you&#39;re talking, you pause to take a breath occasionally; you should do so when writing as well."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1427358902, "post_id": 29268376, "comment_id": 46747332, "body": "How about just adding Set incell = incell.Offset(1, 0)?"}, {"owner": {"reputation": 1047, "user_id": 4669839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O9FCz.png?s=128&g=1", "display_name": "cybermike", "link": "https://stackoverflow.com/users/4669839/cybermike"}, "edited": false, "score": 0, "creation_date": 1427362740, "post_id": 29268376, "comment_id": 46749193, "body": "So you realize you have a loop that does no looping?  Neither the Do nor the Loop defines any criteria to perform a loop.  It just &quot;falls through&quot; just once.  So indeed you appear to only be copying &quot;Results!A2&quot; into &quot;Audit Form!F29&quot; ... just that one cell.  You have no loop to &quot;loop through the cells in Column A&quot; to quote your question."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4713845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60bb0c97ad10d5224628126c212b60b7?s=128&d=identicon&r=PG&f=1", "display_name": "Spencer", "link": "https://stackoverflow.com/users/4713845/spencer"}, "is_accepted": false, "score": 0, "last_activity_date": 1427380455, "creation_date": 1427380455, "answer_id": 29281191, "question_id": 29268376, "link": "https://stackoverflow.com/questions/29268376/pasting-cells-from-table-into-an-excel-form/29281191#29281191", "title": "Pasting cells from table into an Excel form", "body": "<p>Thanks for the valuable feedback guys. </p>\n\n<p>However, it seems I was able to solve my own question.</p>\n\n<p>For your reference, the below code is what I was able to put together to work.</p>\n\n<p>Thanks again!</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub testbutton2()\r\n\r\nDim outcel As Range, incel As Range, rng As Range\r\n\r\nSet outcel = Worksheets(\"Results\").Range(\"A2\")\r\nSet incel = Worksheets(\"Audit Form\").Range(\"F29\")\r\nSet rng = Worksheets(\"Results\").Range(\"A2:A233\")\r\n\r\n\r\nFor Each outcel In rng.SpecialCells(xlCellTypeVisible)\r\n   \r\n\r\n    outcel.Copy\r\n    Sheets(\"Audit Form\").Range(\"F29\").PasteSpecial xlPasteValues\r\n    Sheets(\"Audit Form\").Copy Before:=Workbooks(\"Book1\").Sheets(1)\r\n    \r\nNext outcel\r\n    \r\n    \r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 1, "user_id": 4713845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60bb0c97ad10d5224628126c212b60b7?s=128&d=identicon&r=PG&f=1", "display_name": "Spencer", "link": "https://stackoverflow.com/users/4713845/spencer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 583, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427380455, "creation_date": 1427325739, "last_edit_date": 1427329984, "question_id": 29268376, "link": "https://stackoverflow.com/questions/29268376/pasting-cells-from-table-into-an-excel-form", "title": "Pasting cells from table into an Excel form", "body": "<p>So I am new to writing macros so please pardon any ignorance on my part. I have looked through many online resources to find a similar code but nothing that matches what I am needing.</p>\n\n<p>I am attempting to create a form within excel that auto-populates with data entered into a separate worksheet. The data sheet <code>WorkSheet(\"Results\")</code> has the data stored across the row with the first cell in the <code>Row(Column A)</code> being the data identifier. The form sheet <code>WorkSheet(\"Audit Form\")</code> needs the data identifier entered to populate the fields throughout the form. </p>\n\n<p>What I am needing is a code that will loop through the cells in <code>Column A</code>, enter them into the field on the Audit Form, and then copy the <code>WorkSheet(\"Audit Form\")</code> to a new WorkBook, cycling through each row in the table on the <code>WorkSheet(\"Results\")</code>. This will be driven by a button that will execute the macro once selected. Preferably the code will ignore hidden fields within the table, if a user were to use a filter on it.\nSo far, the code I have written will cycle through the rows in <code>Column A</code> and paste them to the required field in the Audit Form, and it will copy the <code>WorkSheet(\"Audit Form\")</code> to a new WorkBook but the Audit Forms being compiled into the new WorkBook only have the data identifier from the first <code>Row(\"A2\")</code>, so each copied Audit Form shows the same data.</p>\n\n<p>I am certain I am missing some small code that will correct this and I appreciate any advice that you may provide!</p>\n\n<pre><code>Sub testbutton()\n    Dim incell As Range, outcel As Range\n    Set outcel = Worksheets(\"Results\").Range(\"A2\")\n    Set incell = Sheets(\"Audit Form\").Range(\"F29\")\n    Do\n        incell.Value = outcel.Value\n        Sheets(\"Audit Form\").Copy Before:=Workbooks(\"Book1\").Sheets(1)\n        Set outcel = outcel.Offset(1, 0)        \n    Loop \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": false, "score": 0, "last_activity_date": 1427336464, "creation_date": 1427336464, "answer_id": 29270028, "question_id": 29268222, "link": "https://stackoverflow.com/questions/29268222/scrape-yellowpages-com/29270028#29270028", "title": "Scrape yellowpages.com", "body": "<p><code>Case Results</code> is wrong unless you have a variable called Results. You probably want <code>Case \"Results\"</code> instead</p>\n\n<p>Not sure if it's just your formatting here that is wrong but:</p>\n\n<pre><code>End\nSelect Next ele\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>End Select\nNext ele\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 2852173, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e2041f6618abe951f82ebd257874d7c3?s=128&d=identicon&r=PG&f=1", "display_name": "user2852173", "link": "https://stackoverflow.com/users/2852173/user2852173"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1427336464, "creation_date": 1427324923, "last_edit_date": 1427325134, "question_id": 29268222, "link": "https://stackoverflow.com/questions/29268222/scrape-yellowpages-com", "title": "Scrape yellowpages.com", "body": "<p>I am trying to scrape yellowpages.com using VBA using the following code but no data is getting recorded</p>\n\n<pre><code>For Each ele In .document.all\nSelect Case ele.tagname\nCase Results \nRowCount = RowCount + 1 \nCase \"Name\" \nsht.Range(\"A\" &amp; RowCount)=ele.innerText\nCase \"Adress\" \nsht.Range(\"A\" &amp; RowCount) = ele.innerText\nCase \"Email\" \nsht.Range(\"A\" &amp; RowCount) = ele.innerText\nEnd \nSelect Next ele \nEnd With\n</code></pre>\n\n<p>The results are just blank no error</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 1763, "user_id": 551705, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7311c566c1f1a5fd2326da17fce4a50f?s=128&d=identicon&r=PG", "display_name": "Mariska", "link": "https://stackoverflow.com/users/551705/mariska"}, "edited": false, "score": 0, "creation_date": 1427743549, "post_id": 29306572, "comment_id": 46894122, "body": "Seems like the yellow highlight doesn&#39;t work on my end. Any ideas why?"}, {"owner": {"reputation": 223, "user_id": 4374645, "user_type": "registered", "profile_image": "https://graph.facebook.com/513158033/picture?type=large", "display_name": "Stef Joynson", "link": "https://stackoverflow.com/users/4374645/stef-joynson"}, "reply_to_user": {"reputation": 1763, "user_id": 551705, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7311c566c1f1a5fd2326da17fce4a50f?s=128&d=identicon&r=PG", "display_name": "Mariska", "link": "https://stackoverflow.com/users/551705/mariska"}, "edited": false, "score": 1, "creation_date": 1427793045, "post_id": 29306572, "comment_id": 46912605, "body": "It wasn&#39;t on mine either, I had hoped it was something to do with my environment. However, I now have it working by changing wdYellow for the explicit value which is 7."}], "tags": [], "owner": {"reputation": 223, "user_id": 4374645, "user_type": "registered", "profile_image": "https://graph.facebook.com/513158033/picture?type=large", "display_name": "Stef Joynson", "link": "https://stackoverflow.com/users/4374645/stef-joynson"}, "is_accepted": true, "score": 1, "last_activity_date": 1427476993, "creation_date": 1427476993, "answer_id": 29306572, "question_id": 29267802, "link": "https://stackoverflow.com/questions/29267802/populating-mail-item-with-texts-and-images/29306572#29306572", "title": "Populating Mail Item with texts and Images", "body": "<p>I think your problem is the way you are trying to access Ranges in the Word object model. After some googling I have replaced your <code>Doc.Range(Len(Doc.Range), Len(Doc.Range)).</code> sections with paragraph references. See below:</p>\n\n<pre><code>Sub CreateEmailAndSend()\n\n    Dim outApp As Object\n    Dim OutMail As Object\n    Set outApp = CreateObject(\"Outlook.Application\")\n    Set oMail = outApp.CreateItem(0)\n    Dim Doc As Object\n\n    oMail.Display\n    Set Doc = outApp.ActiveInspector.WordEditor\n\n    oMail.To = \"\"\n    oMail.Subject = \"test\"\n\n    ' first sentence\n    Dim msg As String\n    msg = \"Plain Sentence\"\n\n    Doc.Range(0, 0) = msg\n\n    ' second sentence comes after\n    msg = \"Bold and Highlight Yellow Sentence\"\n\n    Doc.Paragraphs(1).Range.InsertParagraphAfter\n    Doc.Paragraphs(2).Range = msg\n    Doc.Paragraphs(2).Range.Font.Bold = True\n    Doc.Paragraphs(2).Range.HighlightColorIndex = wdYellow\n\n\n    ' paste image below it\n    Dim imagerng As Range\n    Set imagerng = Range(Cells(1, 1), Cells(5, 5))\n    imagerng.CopyPicture Appearance:=xlScreen, Format:=xlBitmap\n\n    Doc.Paragraphs(2).Range.InsertParagraphAfter\n    Doc.Paragraphs(3).Range.InsertParagraphAfter\n    Doc.Paragraphs(3).Range.Paste\n\nEnd Sub\n</code></pre>\n\n<p>This is now working for me.</p>\n"}], "owner": {"reputation": 1763, "user_id": 551705, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7311c566c1f1a5fd2326da17fce4a50f?s=128&d=identicon&r=PG", "display_name": "Mariska", "link": "https://stackoverflow.com/users/551705/mariska"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 29306572, "answer_count": 1, "score": 0, "last_activity_date": 1427476993, "creation_date": 1427322800, "last_edit_date": 1427390630, "question_id": 29267802, "link": "https://stackoverflow.com/questions/29267802/populating-mail-item-with-texts-and-images", "title": "Populating Mail Item with texts and Images", "body": "<p>I have the following code in Excel VBA:</p>\n\n<pre><code>Sub CreateEmailAndSend()\n\n    Dim outApp As Object\n    Dim OutMail As Object\n    Set outApp = CreateObject(\"Outlook.Application\")\n    Set oMail = outApp.CreateItem(0)\n    Dim Doc As Object\n\n    oMail.Display\n    Set Doc = outApp.ActiveInspector.WordEditor\n\n    oMail.To = \"\"\n    oMail.Subject = \"test\"\n\n    ' first sentence\n    Dim msg As String\n    msg = \"Plain Sentence\"\n\n    Doc.Range(0, 0) = msg\n\n    ' second sentence comes after\n    msg = \"Bold and Highlight Yellow Sentence\"\n    Doc.Range(Len(Doc.Range), Len(Doc.Range)) = msg\n    Doc.Range.Font.Bold = True\n    Doc.Range.HighlightColorIndex = wdYellow\n\n    ' paste image below it\n    Dim imagerng As Range\n    Set imagerng = Range(Cells(1, 1), Cells(5, 5))\n    imagerng.CopyPicture Appearance:=xlScreen, Format:=xlBitmap\n\n    Doc.Range(Len(Doc.Range), Len(Doc.Range)).Paste\n\nEnd Sub\n</code></pre>\n\n<p>Basically what I would like to do is to create and display an email that looks like this:</p>\n\n<blockquote>\n  <p>Plain Sentence<br>\n  Bold and Highlight Yellow Sentence (this sentence is bold and highlighted)<br>\n  (bitmap image)<br>\n  {my signature}<br></p>\n</blockquote>\n\n<p>However, the output I got from my code is</p>\n\n<blockquote>\n  <p>Plain Sentence (bold)<br>\n  (bitmap image) and the second sentence all over {my signature}</p>\n</blockquote>\n\n<p>How should I fix my code?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1427321827, "post_id": 29267321, "comment_id": 46736669, "body": "I am surprised this <code>imagePath = &quot;C:&#47;&#47;FILEPATH\\FILENAME.jpg&quot;</code> worked for you. You can preset the folders like <code>Const FDR1 = &quot;\\\\Server\\Folder&quot;</code> on top of all Sub. You also have an inefficient way to get the list of files in a folder. Do you omit files in it&#39;s subfolders?"}, {"owner": {"reputation": 31, "user_id": 4714219, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152783735793543/picture?type=large", "display_name": "Bronco Jones", "link": "https://stackoverflow.com/users/4714219/bronco-jones"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1427322010, "post_id": 29267321, "comment_id": 46736756, "body": "Solved by L42 Many thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4714219, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152783735793543/picture?type=large", "display_name": "Bronco Jones", "link": "https://stackoverflow.com/users/4714219/bronco-jones"}, "edited": false, "score": 0, "creation_date": 1427321893, "post_id": 29267569, "comment_id": 46736696, "body": "Thank You! Works perfectly."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 0, "last_activity_date": 1427321620, "creation_date": 1427321620, "answer_id": 29267569, "question_id": 29267321, "link": "https://stackoverflow.com/questions/29267321/word-vba-save-files-in-new-folder/29267569#29267569", "title": "Word VBA save files in new folder", "body": "<p>Remove this line which calls the <code>FileSaveAs</code> dialogue.</p>\n\n<pre><code>With Dialogs(wdDialogFileSaveAs)\n    .Name = \"\\\\i-worx-san-07.i-worx.ca\\wardell$\\Redirection\\billy.bones\\Desktop\\Test 3\\\" &amp; ActiveDocument.Name\n    .Show\nEnd With\n</code></pre>\n\n<p>Then modify this line:</p>\n\n<pre><code>objDocument.SaveAs\n</code></pre>\n\n<p>and include the filepath like this:</p>\n\n<pre><code>objDocument.SaveAs \"\\\\i-worx-san-07.i-worx.ca\\wardell$\\Redirection\\\" _\n    &amp; \"billy.bones\\Desktop\\Test 3\\\" &amp; ActiveDocument.Name\n</code></pre>\n\n<p>In newer version of Word, it was change to <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836084.aspx\" rel=\"nofollow\"><code>SaveAs2</code></a> but <code>SaveAs</code> still works.<br>\nThat method takes the file path where you want the file saved as first argument.</p>\n"}], "owner": {"reputation": 31, "user_id": 4714219, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152783735793543/picture?type=large", "display_name": "Bronco Jones", "link": "https://stackoverflow.com/users/4714219/bronco-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2703, "favorite_count": 0, "accepted_answer_id": 29267569, "answer_count": 1, "score": 2, "last_activity_date": 1427325577, "creation_date": 1427320664, "last_edit_date": 1427325577, "question_id": 29267321, "link": "https://stackoverflow.com/questions/29267321/word-vba-save-files-in-new-folder", "title": "Word VBA save files in new folder", "body": "<p>I have VBA in Word that opens multiple files from a folder that I select, replaces the logo in the header with a new file that I direct it to, and then saves the files in a different folder. </p>\n\n<p>I have the files saving in a different folder not because I want to, but because they are opening as read-only and I can't figure out how to make that not happen. I have tried everything I can find on here. I'm fine with them saving to a new folder. That's not the issue for me right now.</p>\n\n<p>Right now, this code works, but I have to click \"Save\" for each document. I would like that to be automated. The code right here is the saveas</p>\n\n<pre><code>End With\nWith Dialogs(wdDialogFileSaveAs)\n.Name = \"\\\\i-worx-san-07.i-worx.ca\\wardell$\\Redirection\\billy.bones\\Desktop\\Test 3\\\" &amp; ActiveDocument.Name\n.Show\nEnd With\n\nEnd With\nobjDocument.SaveAs\nobjDocument.Close (True)\n</code></pre>\n\n<p>The following is the complete VBA code. I'm an absolute novice, so go easy. I want to know how to go about making the saveas include the original filename, a new specified folder (can be specified in the code, doesn't have to be specified by the user) and do it without the user having to press \"save\" a brazillion times. I appreciate your help.</p>\n\n<pre><code>Sub Example1()\n'Declaring the required variables\nDim intResult As Integer\nDim strPath As String\nDim arrFiles() As String\nDim i As Integer\n'the dialog is displayed to the user\nintResult = Application.FileDialog(msoFileDialogFolderPicker).Show\n'checks if user has cancled the dialog\nIf intResult &lt;&gt; 0 Then\n'dispaly message box\nstrPath = Application.FileDialog( _\n    msoFileDialogFolderPicker).SelectedItems(1)\n    'Get all the files paths and store it in an array\narrFiles() = GetAllFilePaths(strPath)\n'Modifying all the files in the array path\nFor i = LBound(arrFiles) To UBound(arrFiles)\n    Call ModifyFile(arrFiles(i))\nNext i\nEnd If\nEnd Sub\n\nPrivate Sub ModifyFile(ByVal strPath As String)\nDim objDocument As Document\nSet objDocument = Documents.Open(strPath)\nWith ActiveDocument.Sections(1)\nWith ActiveDocument.Sections(1)\n.Headers(WdHeaderFooterIndex.wdHeaderFooterPrimary).Range.Delete\nEnd With\n    Dim imagePath As String\n    'Please enter the relative path of the image here\n    imagePath = \"C://FILEPATH\\FILENAME.jpg\"\n   Set oLogo = .Headers(wdHeaderFooterPrimary).Range.InlineShapes.AddPicture(FileName:=imagePath, LinkToFile:=False, SaveWithDocument:=True)\n    With oLogo.Range\n       .ParagraphFormat.Alignment = wdAlignParagraphRight\n       'Right alignment for logo image\n       .ParagraphFormat.RightIndent = InchesToPoints(-0.6)\n    End With\nEnd With\nWith oLogo\n    .Height = 320\n    .Width = 277\n\nWith Selection.PageSetup\n    'Header from Top value\n    .HeaderDistance = InchesToPoints(0.5)\nEnd With\nWith Dialogs(wdDialogFileSaveAs)\n.Name = \"\\\\i-worx-san-07.i-worx.ca\\wardell$\\Redirection\\billy.bones\\Desktop\\Test 3\\\" &amp; ActiveDocument.Name\n.Show\nEnd With\n\nEnd With\nobjDocument.SaveAs\nobjDocument.Close (True)\nEnd Sub\nPrivate Function GetAllFilePaths(ByVal strPath As String) _\nAs String()\nDim objFSO As Object\nDim objFolder As Object\nDim objFile As Object\nDim i As Integer\nDim arrOutput() As String\nReDim arrOutput(1 To 1)\n'Create an instance of the FileSystemObject\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\n'Get the folder object\nSet objFolder = objFSO.GetFolder(strPath)\ni = 1\n'loops through each file in the directory and\n'prints their names and path\nFor Each objFile In objFolder.Files\nReDim Preserve arrOutput(1 To i)\n'print file path\narrOutput(i) = objFile.Path\ni = i + 1\nNext objFile\nGetAllFilePaths = arrOutput\nEnd Function\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba", "ado", "dao"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1427353642, "creation_date": 1427353642, "answer_id": 29272782, "question_id": 29267266, "link": "https://stackoverflow.com/questions/29267266/access-compare-two-tables-and-update-or-insert-data-in-first-table/29272782#29272782", "title": "Access - compare two tables and update or insert data in first table", "body": "<p>One option is an \"upsert\" or combined append/update query.</p>\n\n<p>This old tip from Smart Access is one of my favourites:</p>\n\n<blockquote>\n  <p>Update and Append Records with One Query</p>\n  \n  <p>By Alan Biggs</p>\n  \n  <p>Did you know that you can use an update query in Access to both\n  update  and add records at the same time? This is useful if you have\n  two  versions of a table, tblOld and tblNew, and you want to integrate\n  the  changes from tblNew into tblOld. </p>\n  \n  <p>Follow these steps:</p>\n  \n  <ol>\n  <li><p>Create an update query and add the two tables. Join the two tables  by dragging the key field of tblNew onto the matching field of tblOld.</p></li>\n  <li><p>Double-click on the relationship and choose the join option that  includes all records from tblNew and only those that match from \n  tblOld. </p></li>\n  <li><p>Select all the fields from tblOld and drag them onto the QBE grid.</p></li>\n  <li><p>For each field, in the Update To cell type in tblNew.FieldName,  where FieldName matches the field name of tblOld.</p></li>\n  <li><p>Select Query Properties from the View menu and change Unique  Records to False. (This switches off the DISTINCTROW option in the SQL\n  view. If you leave this on you'll get only one blank record in your \n  results, but you want one blank record for each new record to be added\n  to tblOld.) </p></li>\n  <li><p>Run the query and you'll see the changes to tblNew are now in  tblOld. </p>\n  \n  <p>This will only add records to tblOld that have been added to tblNew. \n  Records in tblOld that aren't present in tblNew will still remain in \n  tblOld.</p></li>\n  </ol>\n</blockquote>\n"}], "owner": {"reputation": 89, "user_id": 2825175, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea35b0af5094fec40a5593158be5352b?s=128&d=identicon&r=PG&f=1", "display_name": "Zygmunt", "link": "https://stackoverflow.com/users/2825175/zygmunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4363, "favorite_count": 1, "accepted_answer_id": 29272782, "answer_count": 1, "score": 2, "last_activity_date": 1528137381, "creation_date": 1427320405, "question_id": 29267266, "link": "https://stackoverflow.com/questions/29267266/access-compare-two-tables-and-update-or-insert-data-in-first-table", "title": "Access - compare two tables and update or insert data in first table", "body": "<p>In my Access datebase I have a two tables:</p>\n\n<p>Table1:</p>\n\n<pre><code>    PersNum Name    Surname\n    2321    Lenora  Springer\n    2320    Donya   Gugino\n    3326    Leland  Wittmer\n    4588    Elmer   Mcdill\n</code></pre>\n\n<p>Table2:</p>\n\n<pre><code>    PersNum Name    Surname\n    2321    Lenora  Farney\n    2320    Donya   Willimas\n    3326    Leland  Wittmer\n    4588    Maya    Mcdill\n    7785    Yolanda Southall\n    1477    Hailey  Pinner \n</code></pre>\n\n<p>I need to find a way to check the personal number (field \"PersNum\"), and then if PersNum exist, update Name and Surname in Table1. If PersNum doesn't exist, insert new row in Table1.</p>\n\n<p>Expected results:</p>\n\n<pre><code>    PersNum Name    Surname\n    2321    Lenora  Farney      (updated surname)\n    2320    Donya   Willimas    (updated surname)\n    3326    Leland  Wittmer     (without change)\n    4588    Maya    Mcdill      (without change)\n    7785    Yolanda Southall    (new person)\n    1477    Hailey  Pinner      (new person)\n</code></pre>\n\n<p>I'm looking for any solutions based on SQL/VBA/DAO/ADO.</p>\n"}, {"tags": ["forms", "excel", "vba"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1427494662, "post_id": 29267223, "comment_id": 46815855, "body": "As  I mentioned in my answer you need to change the column count to 10, if J is the column you want to find the last cell in, in other words, the line where you set the value of <code>lRow</code> needs to be <code>lRow = Application.WorksheetFunction.Max(ws.Cells(Rows.Count, 10).End(xlUp).Offset(1, 0).Row, 7)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1429, "user_id": 903200, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/2b910cef4270315b02e4f38f3adcb4d1?s=128&d=identicon&r=PG", "display_name": "thefragileomen", "link": "https://stackoverflow.com/users/903200/thefragileomen"}, "edited": false, "score": 0, "creation_date": 1427322121, "post_id": 29267552, "comment_id": 46736802, "body": "my apologies. I mixed up my numbers and letters. I&#39;ve reflected my original post. So the form entries should fill cells in a ROW, not a column and then on next use, fill the next row etc.. My apologies again"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1427335473, "post_id": 29267552, "comment_id": 46740764, "body": "@pnuts Hmm, yeah, now that you mention it, that is a worksheet-function, isn&#39;t it? Edited the code in the answer to reflect this."}, {"owner": {"reputation": 1429, "user_id": 903200, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/2b910cef4270315b02e4f38f3adcb4d1?s=128&d=identicon&r=PG", "display_name": "thefragileomen", "link": "https://stackoverflow.com/users/903200/thefragileomen"}, "edited": false, "score": 0, "creation_date": 1427493781, "post_id": 29267552, "comment_id": 46815527, "body": "Thanks. This seems to enter the values in the correct row / column however when I open the form and add a second entry, it writes over the same row."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 1429, "user_id": 903200, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/2b910cef4270315b02e4f38f3adcb4d1?s=128&d=identicon&r=PG", "display_name": "thefragileomen", "link": "https://stackoverflow.com/users/903200/thefragileomen"}, "edited": false, "score": 0, "creation_date": 1427494178, "post_id": 29267552, "comment_id": 46815671, "body": "@thefragileomen Are you sure you have the <code>.Offset(0,1)</code> part in the line where you set a new value for <code>lRow</code>? And are you sure that <code>lRow</code> is set to a new value every time you use the form? Is <code>lRow</code> set using the correct column?"}, {"owner": {"reputation": 1429, "user_id": 903200, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/2b910cef4270315b02e4f38f3adcb4d1?s=128&d=identicon&r=PG", "display_name": "thefragileomen", "link": "https://stackoverflow.com/users/903200/thefragileomen"}, "edited": false, "score": 0, "creation_date": 1427494517, "post_id": 29267552, "comment_id": 46815799, "body": "Thanks @eirikdaude. I&#39;ve edited my question with my amended code following your advice. So cell J7 is my starting cell and this will contain a date value. This column will also have a value so I want to move onto J8 and the next one down etc"}], "tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": true, "score": 1, "last_activity_date": 1427335520, "last_edit_date": 1427335520, "creation_date": 1427321527, "answer_id": 29267552, "question_id": 29267223, "link": "https://stackoverflow.com/questions/29267223/copy-data-from-form-into-cell-in-excel-2010/29267552#29267552", "title": "Copy data from form into cell in Excel 2010", "body": "<p><code>.Cells(lRow, 1).Value</code> (and so forth) is what references what cell is written to. The first argument says what row the cell is in, the second what column it is in. When referencing the cells explicitly I see little reason to do it this way though, it is mainly for when you'd make a loop where e.g. <code>lRow</code> was incremented by one for each iteration in order to write down a column.</p>\n\n<p>Since <code>lRow</code> is decided using <code>lRow = ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row</code> it will always be the number of the first empty row in column A. To change it to return the first empty row in column J, you need to change the 1 in <code>Cells</code> to 10 (J is the 10th letter in the alphabet. To get it to not start further up than row 7 at any time, I'd add in a <code>Max</code>-statement:</p>\n\n<pre><code>lRow = Application.WorksheetFunction.Max(ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row, 7)\n</code></pre>\n\n<p>To get the sub to write to column J onwards inside the <code>With</code>-statement, you need to change the column-references to reflect this. Currently it writes to column 1, 2, 3, etc. you want it to write to column 10, 11, 12, etc. I.e. something like:</p>\n\n<pre><code>With ws\n    .Cells(lRow, 10).Value = Me.cboClass.Value\n    .Cells(lRow, 11).Value = Me.txtGivenName.Value\n    .Cells(lRow, 12).Value = Me.txtTagNumber.Value\n    etc.\n</code></pre>\n"}], "owner": {"reputation": 1429, "user_id": 903200, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/2b910cef4270315b02e4f38f3adcb4d1?s=128&d=identicon&r=PG", "display_name": "thefragileomen", "link": "https://stackoverflow.com/users/903200/thefragileomen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1050, "favorite_count": 0, "accepted_answer_id": 29267552, "answer_count": 1, "score": 0, "last_activity_date": 1427494385, "creation_date": 1427320261, "last_edit_date": 1531161705, "question_id": 29267223, "link": "https://stackoverflow.com/questions/29267223/copy-data-from-form-into-cell-in-excel-2010", "title": "Copy data from form into cell in Excel 2010", "body": "<p>I currently have an Excel 2010 spreadsheet. I have designed a form and I'm looking to allow users to enter date into the form and it then be entered into the worksheet.</p>\n\n<p>My first entry is \"txtDate\" on my form and I wish for this to be entered into cell J7 with the next data in the form \"txtTime\" going into cell K7 and then other data into other cells in the row - L7, M7, N7 etc etc... Once this cell is submitted with a button using on the form, the data is entered and then the next time the form is used, the data will go into the next row below, row 8 and then row 9 on the next occasion etc...</p>\n\n<p>I've found the sample below code on the internet and the example shows that it starts in cell A2. I can't see mention of A2 and so I'm wondering how I edit the code to start in cell J7.</p>\n\n<pre><code>'Copy input values to sheet.\n    Dim lRow As Long\n    Dim ws As Worksheet\n    Set ws = Worksheets(\"Animals\")\n    lRow = ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n    With ws\n        .Cells(lRow, 1).Value = Me.cboClass.Value\n        .Cells(lRow, 2).Value = Me.txtGivenName.Value\n        .Cells(lRow, 3).Value = Me.txtTagNumber.Value\n        .Cells(lRow, 4).Value = Me.txtSpecies.Value\n        .Cells(lRow, 5).Value = Me.cboSex.Value\n        .Cells(lRow, 6).Value = Me.cboConservationStatus.Value\n        .Cells(lRow, 7).Value = Me.txtComment.Value\n</code></pre>\n\n<p>Here is my code dated 27/03/2015 following the answer:</p>\n\n<pre><code>Dim lRow As Long\n     Dim ws As Worksheet\n     Set ws = Worksheets(\"Pursue\")\n     lRow = Application.WorksheetFunction.Max(ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row, 7)\n\n     With ws\n          .Cells(lRow, 10).Value = Me.dateBox.Value\n          etc....\n</code></pre>\n"}, {"tags": ["vba", "excel", "runtime-error", "columnsorting"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1427321090, "post_id": 29267094, "comment_id": 46736411, "body": "Missing a <code>.</code>? <code>.Range(.Cells(13, 1), .Cells(lastRow, lastCol)).Sort key1:=.Range(&quot;B13:B&quot; &amp; lastRow), order1:=xlAscending, Header:=xlNo</code> - Not sure if you can set Key1 as a big range. Your <code>Set Rng</code> looks weird to me. Where is <code>13A</code> to result of concatenating 2 numbers?"}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1427324795, "post_id": 29267094, "comment_id": 46737800, "body": "Hi PatricK, I think you are right, just like nwhaught. I will try to add the dot."}], "answers": [{"comments": [{"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1427322523, "post_id": 29267451, "comment_id": 46736930, "body": "Wow I think it works! :) I will get back to you tomorrow and mark it as an answer, when I have my work computer and have tested it properly. Thanks so far. Just to be sure, it sorts after the data in Column B13:B right?"}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "reply_to_user": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1427322954, "post_id": 29267451, "comment_id": 46737090, "body": "It should...it&#39;s still all your code, I just made the references to <code>ws</code> point to the right place. :-)"}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1427324740, "post_id": 29267451, "comment_id": 46737779, "body": "So when I run my macros, I open the this workbook, how do I make it show instead of the other workbook? I mean, so it opens but it is still &quot;in the background&quot;. Can you help?"}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "reply_to_user": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1427375779, "post_id": 29267451, "comment_id": 46756641, "body": "Before you turn off screen updating, <code>wb.Activate</code> will display whatever workbook you set wb to. For example <code>ThisWorkbook.Activate</code> will make the workbook containing the code visible. If you want the other workbook to be visible, you&#39;ll need to Dim a Workbook variable and set it to the other workbook. IF you do that however, you should revisit any line referring to <code>ActiveSheet</code> and make sure that the active sheet is still the one you intend. Best practice would be to declare each worksheet as a separate variable and reference each one explicitly."}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1427376822, "post_id": 29267451, "comment_id": 46757478, "body": "Thank you for that wonderful explanation :) so I&#39;m getting an error in the sorting code, probably because of the activesheet.usedrange what can I replace it with?"}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "reply_to_user": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1427377453, "post_id": 29267451, "comment_id": 46757920, "body": "Edited my original answer to demonstrate."}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1427378178, "post_id": 29267451, "comment_id": 46758447, "body": "Ahh thank you very much! Can I run this sub under sheetchange so it is always sorted?"}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "reply_to_user": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1427379105, "post_id": 29267451, "comment_id": 46759148, "body": "You may have an issue running it under sheetchange, again, because of the reliance on ActiveSheet. Per your code, you&#39;re relying on the <code>ActiveWorkbook</code> being different from <code>ThisWorkbook</code>. If you are running it from a worksheet event, that will no longer be true. Just like for sheets, best practice is to <code>Dim wb1, wb2 as Workbook</code> then <code>Set wb1 = ThisWorkbook</code> and `Set wb2 = workbooks(&quot;workbookname.xlsx&quot;)"}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1427381605, "post_id": 29267451, "comment_id": 46761076, "body": "Could help me with that? I get an error all the time"}], "tags": [], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "is_accepted": true, "score": 0, "last_activity_date": 1427377432, "last_edit_date": 1427377432, "creation_date": 1427321164, "answer_id": 29267451, "question_id": 29267094, "link": "https://stackoverflow.com/questions/29267094/run-time-error-1004-sorting-in-sheetchange/29267451#29267451", "title": "Run-time error &#39;1004&#39;: Sorting in sheetchange", "body": "<p>It looks like you've got some issues inside your With statement... using <code>Range</code> instead of <code>.Range</code> in several places. I've tried to clean it up a bit below...</p>\n\n<pre><code>Sub TESTSORT()\nDim startCol, myCol As String\nDim startRow, lastRow, lastCol As Long\nDim ws, ws2 As Worksheet\nDim Rng, cell As Range\n\nSet ws2 = ActiveSheet 'Preserves a reference to the active sheet as ws2\nThisWorkbook.Activate 'Makes this workbook the one that is displayed\n\nApplication.ScreenUpdating = False\nSet ws = ThisWorkbook.Sheets(\"Sheet1\")\n\nWith ws\n    startCol = \"A\"\n    startRow = 13\n    lastRow = .Range(startCol &amp; .Rows.Count).End(xlUp).Row\n    'lastCol = .Cells(2, .Columns.Count).End(xlToLeft).Column\n    lastCol = ws2.UsedRange.Columns(ws2.UsedRange.Columns.Count).Column\n\n    myCol = GetColumnLetter(lastCol)\n\n    Set Rng = .Range(startCol &amp; startRow &amp; \":\" &amp; myCol &amp; lastRow)\n\n    ' I GET THE ERROR HERE\n    .Range(.Cells(13, 1), .Cells(lastRow, lastCol)).Sort key1:=.Range(\"B13:B\" &amp; lastRow),\n    order1:=xlAscending, Header:=xlNo\n\n    End With\nApplication.ScreenUpdating = True\nEnd Sub\n\nFunction GetColumnLetter(colNum As Long) As String\nDim vArr\nvArr = Split(Cells(1, colNum).Address(True, False), \"$\")\nGetColumnLetter = vArr(0)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 29267451, "answer_count": 1, "score": 0, "last_activity_date": 1427377432, "creation_date": 1427319711, "last_edit_date": 1427320143, "question_id": 29267094, "link": "https://stackoverflow.com/questions/29267094/run-time-error-1004-sorting-in-sheetchange", "title": "Run-time error &#39;1004&#39;: Sorting in sheetchange", "body": "<p>I have simple problem using a sort macro. When I import data from my other Workbook, the workbook run the macro below in SheetChange and receive the run-time error.\n<strong>HOWEVER, it is working completely fine if I just run the macro when the Workbook is open.</strong></p>\n\n<p>I don\u00b4t know if I have to replace Range with ActiveWorkbook or something, but I think I have tried a lot of different stuff, still without luck :(</p>\n\n<p>I want it to sort from column B, starting in row 13 and until the last row/column. It is dynamic, so it will change every time I import stuff.</p>\n\n<pre><code>Sub TESTSORT()\nDim startCol, myCol As String\nDim startRow, lastRow, lastCol As Long\nDim ws As Worksheet\nDim Rng, cell As Range\n\nApplication.ScreenUpdating = False\nSet ws = ThisWorkbook.Sheets(\"Sheet1\")\n\nWith ws\nstartCol = \"A\"\nstartRow = 13\nlastRow = ws.Range(startCol &amp; ws.Rows.Count).End(xlUp).Row\n'lastCol = ws.Cells(2, ws.Columns.Count).End(xlToLeft).Column\nlastCol = ActiveSheet.UsedRange.Columns(ActiveSheet.UsedRange.Columns.Count).Column\n\nmyCol = GetColumnLetter(lastCol)\n\nSet Rng = ws.Range(startCol &amp; startRow &amp; \":\" &amp; myCol &amp; lastRow)\n\n' I GET THE ERROR HERE\nRange(.Cells(13, 1), .Cells(lastRow, lastCol)).Sort key1:=Range(\"B13:B\" &amp; lastRow),\norder1:=xlAscending, Header:=xlNo\n\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n\nFunction GetColumnLetter(colNum As Long) As String\nDim vArr\nvArr = Split(Cells(1, colNum).Address(True, False), \"$\")\nGetColumnLetter = vArr(0)\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1427319681, "post_id": 29266941, "comment_id": 46735761, "body": "This is a coding support site - not a &quot;free coders who are bored write my code for me&quot; site. Write at least one line of code yourself and I would help you."}, {"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1427338562, "post_id": 29266941, "comment_id": 46741525, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/29186684/normalize-concatenated-excel-data\">Normalize concatenated Excel data</a>"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 4714096, "user_type": "registered", "profile_image": "https://graph.facebook.com/10103785843121839/picture?type=large", "display_name": "andreyman", "link": "https://stackoverflow.com/users/4714096/andreyman"}, "edited": false, "score": 1, "creation_date": 1427415885, "post_id": 29268343, "comment_id": 46779401, "body": "I realize comment instructions said not to write thanks, but feel compelled - thanks very much for this. I wasn&#39;t expecting a full write-up of code, just pointing in the right direction in terms of what logic to use to get it done. So, very grateful - will dig into your code and try to figure out how it actually works. Thanks again, Andrey."}], "tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": false, "score": 0, "last_activity_date": 1427467875, "last_edit_date": 1427467875, "creation_date": 1427325540, "answer_id": 29268343, "question_id": 29266941, "link": "https://stackoverflow.com/questions/29266941/converting-multiple-columns-of-data-into-a-single-row-for-each-column/29268343#29268343", "title": "Converting multiple columns of data into a single row for each column", "body": "<p>I'm not sure if those comas were showing each column or are actually part of the value.</p>\n\n<p>I assumed that each type was merely in its own column like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/iFMSR.png\" alt=\"Before Data Fix\"></p>\n\n<p>The macro assumes that you run it while the sheet that contains the types is active and that the \"fixed data\" will be placed on \"Sheet2\"</p>\n\n<p>If this is not the case, change/add sheet references.</p>\n\n<pre><code>Sub FixMyData()\n'x will iterate through each row on our ActiveSheet from 1 to the last row\n'y will iterate through each column (Tag) if there are more than 2\n'z will keep track of the row we are outputting to on Sheet2\nDim x, y, z\n\nz = 1 'Start outputting on row 1\n\n'This line just speeds up macros that modify sheets significantly\nApplication.ScreenUpdating = False\n\n'Start at the first row on our active sheet and iterate through each one\nFor x = 1 To GetLastRow(ActiveSheet.Name, 1)\n    'This is a new row so get the date and put it on sheet2\n    Sheets(\"Sheet2\").Cells(z, 1).Value = Cells(x, 1)\n\n    'Grab the first tag (if it exists) and put it there too\n    Sheets(\"Sheet2\").Cells(z, 2).Value = Cells(x, 2)\n\n    'We're ready to output to the next row\n    z = z + 1\n\n    'If there is more than one tag on this row\n    If GetLastCol(ActiveSheet.Name, x) &gt; 2 Then\n\n        'Let's read through each one and output it in the same way\n        For y = 3 To GetLastCol(ActiveSheet.Name, x)\n            'Stick the date on Sheet2\n            Sheets(\"Sheet2\").Cells(z, 1).Value = Cells(x, 1)\n\n            'And stick the tag next to it\n            Sheets(\"Sheet2\").Cells(z, 2).Value = Cells(x, y)\n\n            'We're ready to write to the next row again\n            z = z + 1\n        Next y\n    End If\nNext x\n\n'Format column A on Sheet2 as dates (since we're not using copy)\nSheets(\"Sheet2\").Range(\"A1:A\" &amp; GetLastRow(\"Sheet2\", \"A\")).NumberFormat = \"m/d/yyyy\"\nApplication.ScreenUpdating = True\nEnd Sub\n\n'Helper functions that make the code easier to read\n'They return the last Row/Column (respectively) with data\n'-------------------------------------------------------------\nFunction GetLastRow(sheet As String, col As Variant) As Integer\nGetLastRow = Sheets(sheet).Cells(Sheets(sheet).Rows.Count, col).End(xlUp).row\nEnd Function\nFunction GetLastCol(sheet As String, row As Variant) As Integer\nGetLastCol = Sheets(sheet).Cells(row, Sheets(sheet).Columns.Count).End(xlToLeft).Column\nEnd Function\n'-------------------------------------------------------------\n</code></pre>\n\n<p>Results:</p>\n\n<p><img src=\"https://i.stack.imgur.com/KAvm1.png\" alt=\"Results\"></p>\n"}], "owner": {"reputation": 51, "user_id": 4714096, "user_type": "registered", "profile_image": "https://graph.facebook.com/10103785843121839/picture?type=large", "display_name": "andreyman", "link": "https://stackoverflow.com/users/4714096/andreyman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427467875, "creation_date": 1427319156, "last_edit_date": 1531161705, "question_id": 29266941, "link": "https://stackoverflow.com/questions/29266941/converting-multiple-columns-of-data-into-a-single-row-for-each-column", "title": "Converting multiple columns of data into a single row for each column", "body": "<p>I have a dataset with multiple columns. For every cell in column A, there is a variable number of cells in the other columns. Looking for help making a macro that creates a single row for every combination of column A with the corresponding cells in other columns. Example input:</p>\n\n<pre><code>Posted on   Tags\n3/8/15  Tag A\n3/8/15  Tag B, Tag C\n3/8/15  Tag C, Tag B, Tag D\n3/9/15  Tag D\n3/10/15 Tag D, Tag F\n3/10/15 Tag B\n3/10/15 Tag D, Tag E\n\nDesired output:\n\nPosted on   Tags\n3/8/15  Tag A\n3/8/15  Tag B\n3/8/15  Tag C\n3/8/15  Tag C\n3/8/15  Tag B\n3/8/15  Tag D\n3/9/15  Tag D\n3/10/15 Tag D\n3/10/15 Tag F\n3/10/15 Tag B\n3/10/15 Tag D\n3/10/15 Tag E\n</code></pre>\n"}, {"tags": ["vba", "excel", "match", "vlookup"], "comments": [{"owner": {"reputation": 35, "user_id": 3870159, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38aa6af6ac9e2a903e515ecfb9a4258b?s=128&d=identicon&r=PG&f=1", "display_name": "user3870159", "link": "https://stackoverflow.com/users/3870159/user3870159"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1427318716, "post_id": 29266746, "comment_id": 46735326, "body": "Its suppose to look like this, it didn&#39;t come out right."}, {"owner": {"reputation": 35, "user_id": 3870159, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38aa6af6ac9e2a903e515ecfb9a4258b?s=128&d=identicon&r=PG&f=1", "display_name": "user3870159", "link": "https://stackoverflow.com/users/3870159/user3870159"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1427318796, "post_id": 29266746, "comment_id": 46735364, "body": "I&#39;m working in Excel. I have any empty column that I&#39;m trying to write a formula for, where I return the value in Sheet 1 based on whether the segment and node names match in Sheet 2 compared to whats in Sheet 1 already."}], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 1, "last_activity_date": 1427319141, "creation_date": 1427319141, "answer_id": 29266936, "question_id": 29266746, "link": "https://stackoverflow.com/questions/29266746/return-a-value-by-using-match-index-or-vlookup-with-paired-search-terms/29266936#29266936", "title": "Return a value by using MATCH, INDEX or VLOOKUP with paired search terms", "body": "<p>Assuming <code>Segment</code> is in A1 of both sheets, insert a new ColumnA in <code>Sheet 1</code> with:  </p>\n\n<pre><code>=B2&amp;\"|\"&amp;C2  \n</code></pre>\n\n<p>in A2 copied down to suit, then in C2 of <code>Sheet 2</code>:  </p>\n\n<pre><code>=VLOOKUP(A2&amp;\"|\"&amp;B2,'Sheet 1'!A:D,4,0)  \n</code></pre>\n\n<p>copied down to suit. </p>\n"}], "owner": {"reputation": 35, "user_id": 3870159, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38aa6af6ac9e2a903e515ecfb9a4258b?s=128&d=identicon&r=PG&f=1", "display_name": "user3870159", "link": "https://stackoverflow.com/users/3870159/user3870159"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 29266936, "answer_count": 1, "score": 0, "last_activity_date": 1427319326, "creation_date": 1427318356, "last_edit_date": 1427319326, "question_id": 29266746, "link": "https://stackoverflow.com/questions/29266746/return-a-value-by-using-match-index-or-vlookup-with-paired-search-terms", "title": "Return a value by using MATCH, INDEX or VLOOKUP with paired search terms", "body": "<p>I'm trying to return a value based on whether other certain values are in a row. I have two sheets in Excel that I'm working on and can't get correct formula to return a value using VLOOKUP, INDEX or MATCH. The following is an example of the spreadsheets I have:</p>\n\n<pre>\nSheet 1\nSegment         Node           Value\n\nACDC            Acadian          300\nVentura         Acadian           50\nLooseGoose      Acadian          600\nDave            Haynes           500\n\nSheet 2\nSegment         Node           Value\nACDC            Acadian </pre>         \n\n<p>So I'm trying to write a function that'll return the value in Sheet 2 if the segment and node names match each other compared to how they are in Sheet 1.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1427322336, "post_id": 29266673, "comment_id": 46736866, "body": "Where are the lines to set the Range <code>startRange1</code>, <code>lastrowA</code>? Using <b>a65536</b> is legacy. Once you copied a range, you need to adjust the offset."}], "answers": [{"tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": true, "score": 2, "last_activity_date": 1427322314, "creation_date": 1427322314, "answer_id": 29267700, "question_id": 29266673, "link": "https://stackoverflow.com/questions/29266673/error-in-copying-only-value-of-a-cell-in-vba/29267700#29267700", "title": "Error in Copying only Value of a cell in VBA", "body": "<p>In order to just paste values, you need to use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839476.aspx\" rel=\"nofollow\"><code>PasteSpecial</code></a>-method.</p>\n\n<p>Change your code to:</p>\n\n<pre><code>Set startRange = ThisWorkbook.Worksheets(\"Sheet3\").Range(\"a65536\").End(xlUp)\nWorksheets(\"Sheet1\").Range(\"B2:B\" &amp; lastrowA).Copy\nstartRange1.Offset(1, 2).PasteSpecial Paste:=xlPasteValues\nApplication.CutCopyMode = False\nWorksheets(\"Sheet2\").Range(\"A2:A\" &amp; lastrowA).Copy\nstartRange1.Offset(1, 1).PasteSpecial Paste:=xlPasteValues\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>and I believe it should work as intended. You may also want to paste the numberformats, in which case you change <code>xlPasteValues</code> to <code>xlPasteValuesAndNumberFormats</code>. For more details on what you can do with <code>PasteSpecial</code>, I recommend you to have a look at the website I linked to above.</p>\n"}, {"tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 1, "last_activity_date": 1427322838, "creation_date": 1427322838, "answer_id": 29267814, "question_id": 29266673, "link": "https://stackoverflow.com/questions/29266673/error-in-copying-only-value-of-a-cell-in-vba/29267814#29267814", "title": "Error in Copying only Value of a cell in VBA", "body": "<p>Try this, easier to understand.</p>\n\n<pre><code>Sub PasteThem()\n    Dim oRngCopy As Range, oRngPasteTo As Range, lastrowA As Long\n    lastrowA = 123 ' Whatever you get this from...\n    ' Locate where to start pasting\n    Set oRngPasteTo = ThisWorkbook.Worksheets(\"Sheet3\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n    ' Sets Range 1 to copy\n    Set oRngCopy = Worksheets(\"Sheet1\").Range(\"B2:B\" &amp; lastrowA)\n    ' Copy the Range\n    oRngCopy.Copy\n    oRngPasteTo.PasteSpecial xlPasteValues\n    ' Adjust the Range to start pasting\n    Set oRngPasteTo = oRngPasteTo.Offset(oRngCopy.Rows + 1, 0)\n    ' Sets Range 2 to copy\n    Set oRngCopy = Worksheets(\"Sheet2\").Range(\"A2:A\" &amp; lastrowA)\n    ' Copy the Range\n    oRngCopy.Copy\n    oRngPasteTo.PasteSpecial xlPasteValues\n    ' Clean Up\n    Set oRngCopy = Nothing\n    Set oRngPasteTo = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 757, "user_id": 3504466, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e403443744e98a4c9ddd6316ce487c36?s=128&d=identicon&r=PG&f=1", "display_name": "Jain", "link": "https://stackoverflow.com/users/3504466/jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 29267700, "answer_count": 2, "score": 0, "last_activity_date": 1427322838, "creation_date": 1427318128, "question_id": 29266673, "link": "https://stackoverflow.com/questions/29266673/error-in-copying-only-value-of-a-cell-in-vba", "title": "Error in Copying only Value of a cell in VBA", "body": "<pre><code>Set startRange = ThisWorkbook.Worksheets(\"Sheet3\").Range(\"a65536\").End(xlUp)\nWorksheets(\"Sheet1\").Range(\"B2:B\" &amp; lastrowA).Copy startRange1.Offset(1, 2).Value\nWorksheets(\"Sheet2\").Range(\"A2:A\" &amp; lastrowA).Copy startRange1.Offset(1, 1)\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>I just want to copy the cell values and not the formulas in it as I get problems when I copy it to other sheet and save the file. I have tried value2 also but it doesn't work. please help Thanks.</p>\n"}, {"tags": ["vba", "excel", "type-mismatch"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4714035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb32aab4d1745d2b88006b9f49f72d82?s=128&d=identicon&r=PG&f=1", "display_name": "wannabepudge", "link": "https://stackoverflow.com/users/4714035/wannabepudge"}, "edited": false, "score": 0, "creation_date": 1427319735, "post_id": 29266680, "comment_id": 46735788, "body": "Well, I know I had tried CPIDws.Activate at one point and was getting the same error, but as you said, that did work now that I&#39;ve tried it again.  I haven&#39;t written VBA in a while, but I have always used <i>Activate</i> or <i>Select.</i> I will for sure take a look at the thread you referenced.  Thanks again for the help!"}, {"owner": {"reputation": 442, "user_id": 2497009, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yaHZR.png?s=128&g=1", "display_name": "usncahill", "link": "https://stackoverflow.com/users/2497009/usncahill"}, "edited": false, "score": 1, "creation_date": 1427321751, "post_id": 29266680, "comment_id": 46736645, "body": "Beginners seem to use Activate and Selection. All changes can be accomplished without ever activating a sheet. Directly referencing an object is good programming."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 5, "last_activity_date": 1427318560, "last_edit_date": 1495541036, "creation_date": 1427318155, "answer_id": 29266680, "question_id": 29266568, "link": "https://stackoverflow.com/questions/29266568/type-mismatch-13-error-when-trying-to-activate-a-sheet/29266680#29266680", "title": "Type Mismatch 13 error when trying to activate a sheet", "body": "<blockquote>\n  <p>At that point CPIDws = CERN000006. </p>\n</blockquote>\n\n<p>No it doesn't. :)</p>\n\n<p>You've declared <code>CPIDws As Worksheet</code> but you're using it as an argument to the <code>Sheets</code> method, which takes either an index (integer) or name (string) value.</p>\n\n<p>Thus, type mismatch.</p>\n\n<p>Try simply <code>CPIDws.Activate</code></p>\n\n<p>or, arguably you could do the redundant: <code>Sheets(CPIDws.Name).Activate</code></p>\n\n<p><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">THIS</a> may also come in helpful, as it's generally recommended not to rely on <code>Active</code> (cell, sheet, etc.) or <code>Selection</code> when it can be avoided (which is almost always the case, except for some instance when you use the <code>Selection</code> as a method of input. But generally, your macro should probably never need to <em>Select</em> or <em>Activate</em> any cell other than that which the user had selected for input.  In your case, since you're beginning at <code>Cells(1,1)</code> and controlling the iteration entirely through code, it's not at all necessary to <code>Select</code> or <code>Activate</code> anything.</p>\n"}], "owner": {"reputation": 23, "user_id": 4714035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb32aab4d1745d2b88006b9f49f72d82?s=128&d=identicon&r=PG&f=1", "display_name": "wannabepudge", "link": "https://stackoverflow.com/users/4714035/wannabepudge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4118, "favorite_count": 0, "accepted_answer_id": 29266680, "answer_count": 1, "score": 2, "last_activity_date": 1427320740, "creation_date": 1427317759, "last_edit_date": 1427320740, "question_id": 29266568, "link": "https://stackoverflow.com/questions/29266568/type-mismatch-13-error-when-trying-to-activate-a-sheet", "title": "Type Mismatch 13 error when trying to activate a sheet", "body": "<p>Everything I've read shows that I'm correctly denoting my variable and calling the sheet I want to activate. The last line is where I am getting the type mismatch. At that point CPIDws = CERN000006. I read somewhere that it might be problematic that the name is letters and numbers, but haven't found a way around it.</p>\n\n<pre><code>Sub Create_tab()\n\nDim newWS As Worksheet, CernWS As Worksheet, CPID As Variant\nDim Template As Worksheet, CPIDclm As Long, CERNdata As Range, CPIDcheck As Variant\nDim lngRow As Long, lngCol As Long, i As Integer, CPIDws As Worksheet\n\nSet Template = Sheets(\"Template\")\nSet CernWS = Sheets(\"CERN ID's\")\n'Set lngRow = 1\n'Set lngCol = 1\n\n\nCernWS.Activate\nCells(1, 1).Select\n\nDo\n    ActiveCell.Offset(1, 0).Select\n    Set CPID = ActiveCell\n\n    'create a new sheet as a copy of the template\n    Sheets(\"Template\").Copy _\n           after:=ActiveWorkbook.Sheets(ThisWorkbook.Sheets.Count)\n\n    'Name the new sheet as the current CPID value from CERN ID's worksheet\n    ActiveSheet.Name = CPID\n    Set CPIDws = ActiveSheet\n\n    'interigate AAA Data and update the new sheet with the data specific to the current cpid\n    Sheets(\"AAA Data\").Activate\n    Cells(2, 3).Activate\n    Set CPIDcheck = ActiveCell\n\n    Do\n        If CPID = CPIDcheck Then\n            ActiveCell.Offset(0, -2).Select\n            Set CERNdata = Range(Selection, Selection.End(xlToRight))\n        End If\n\n        Sheets(CPIDws).Activate\n</code></pre>\n"}, {"tags": ["list", "excel", "sequence", "cycle", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 2956284, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/41d465bbbbb14f3033adbbe6696fb9f9?s=128&d=identicon&r=PG&f=1", "display_name": "user2956284", "link": "https://stackoverflow.com/users/2956284/user2956284"}, "edited": false, "score": 0, "creation_date": 1427373235, "post_id": 29267368, "comment_id": 46755005, "body": "You&#39;re probably right. I should start learning it. It&#39;s just finding the time and I have usually get by &#39;winging it&#39; as I don&#39;t use too often.  Appologies about the rubbish explanation I thought it was clear.  I&#39;ll try and rephrase:  In Cell A20 the user can choose one of the following values from a dropdown menu. A, A#, B, C, C#, D, D#, E, F, F#, G, G#.  Every subsequent cell above A20 (up until A2) will show the next letter in sequence. So if A is selected the sequence will start there. If D is selected, the cell above will be D# and so on. G# is the end of the sequence and it will repeat."}, {"owner": {"reputation": 21, "user_id": 2956284, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/41d465bbbbb14f3033adbbe6696fb9f9?s=128&d=identicon&r=PG&f=1", "display_name": "user2956284", "link": "https://stackoverflow.com/users/2956284/user2956284"}, "edited": false, "score": 0, "creation_date": 1427373584, "post_id": 29267368, "comment_id": 46755241, "body": "But yes. I think I will try and learn the basics so I can make a better stab at it first time. Otherwise people are just basically writing it for me which is not very efficient, not to mention rude. Thanks for the help though."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1427355933, "last_edit_date": 1427355933, "creation_date": 1427320832, "answer_id": 29267368, "question_id": 29266527, "link": "https://stackoverflow.com/questions/29266527/loop-predefined-sequence-through-cells-in-excel/29267368#29267368", "title": "Loop predefined sequence through cells in excel", "body": "<p>You would do better learning the basics of VBA than searching for odd terms.  Search for \"Excel VBA Tutorial\".  There are many to choose from so try a few then complete the one that matches your learning style.  I prefer books.  I visited a good library; reviewed their Excel VBA Primers and then the borrowed what I thought were the best to try at home.  Finally I bought the best as a permenent reference book.</p>\n\n<p>Your questions is very unclear but I think you need a <code>For Each</code> loop within a <code>Do</code> loop.  You will find an introduction to loops near the start of any tutorial or primer. Try to develop this:</p>\n\n<pre><code>Sub demo()\n\n  Dim CellId As Variant\n  Dim LoopCount As Long\n\n  ' #### Replace Tidy with the name of a worksheet in your workbook.\n  With Worksheets(\"Tidy\")\n\n    Do While True\n      For Each CellId In Array(\"A20\", \"A19\", \"A18\", \"A17\")\n\n        Debug.Print CellId &amp; \"=\" &amp; .Range(CellId).Value\n\n        If LoopCount &gt;= 3 Then\n          Exit Do\n        End If\n\n      Next\n      LoopCount = LoopCount + 1\n\n    Loop\n\n  End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 2956284, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/41d465bbbbb14f3033adbbe6696fb9f9?s=128&d=identicon&r=PG&f=1", "display_name": "user2956284", "link": "https://stackoverflow.com/users/2956284/user2956284"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 435, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427355933, "creation_date": 1427317634, "last_edit_date": 1531161705, "question_id": 29266527, "link": "https://stackoverflow.com/questions/29266527/loop-predefined-sequence-through-cells-in-excel", "title": "Loop predefined sequence through cells in excel", "body": "<p>Have been searching for a few hours now I'm stuck. Not really sure what I'm searching for but guessing some VBA.</p>\n\n<p>What I want to do in excel is this:</p>\n\n<p>Have a predefined list i.e. [a,a#,b,c,c#...g#]</p>\n\n<p>Now when somebody enters value 'A' into cell A20 then A19 will be the next on the list 'A#', A18 will be 'B', A17 will be 'C' etc.</p>\n\n<p>If the value C is entered into cell A20 then A19 would be 'C#' and so on...</p>\n\n<p>Once the list reaches G# it shall repeat from A again. This would repeat until cell A2 is reached.</p>\n\n<p>Even a point in the right direction would be great as I don't really know what to search for. Have tried 'arrays' 'loop' 'cycle' without much luck.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1427318224, "post_id": 29266067, "comment_id": 46735073, "body": "Ah, thanks for the note on &quot;CDbl&quot;.  Unfortunately that statement always is true (for 293483 types and 29.39 types)."}, {"owner": {"reputation": 1901, "user_id": 704681, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a3c7e62604fc5f3e8f09b18160bd2ab7?s=128&d=identicon&r=PG", "display_name": "A. Masson", "link": "https://stackoverflow.com/users/704681/a-masson"}, "edited": false, "score": 0, "creation_date": 1492877369, "post_id": 29266067, "comment_id": 74173882, "body": "It could be &quot;Currency&quot; so alternative is:   If TypeName(cel.value) = &quot;Double&quot; Or if TypeName(cel.value) = &quot;Currency&quot; Then ..."}], "tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": false, "score": 5, "last_activity_date": 1427315984, "creation_date": 1427315984, "answer_id": 29266067, "question_id": 29265949, "link": "https://stackoverflow.com/questions/29265949/excel-vba-check-if-value-is-type-double/29266067#29266067", "title": "Excel VBA - check if value is type DOUBLE", "body": "<p>CDbl converts the value to a double.</p>\n\n<p>Try</p>\n\n<pre><code>if TypeName(cel.value) = \"Double\" then\n    cel.value = cel.value / 1000\nend if\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 5, "last_activity_date": 1427318781, "last_edit_date": 1427318781, "creation_date": 1427317764, "answer_id": 29266572, "question_id": 29265949, "link": "https://stackoverflow.com/questions/29265949/excel-vba-check-if-value-is-type-double/29266572#29266572", "title": "Excel VBA - check if value is type DOUBLE", "body": "<p>Alternatively, check for integer:</p>\n\n<pre><code>With cel\n    .Value = IIF(CLng(.Value)=.Value, .Value / 1000, .Value)\nEnd With\n</code></pre>\n\n<p>This says: if it's an integer/long (no decimal) then do the division by 1000, otherwise use the original <code>cel.Value</code>.</p>\n\n<p><strong>Note:</strong> this will not work for extraordinarily large integers (anything larger than a <code>Long</code> data type will raise an overflow error).</p>\n"}, {"comments": [{"owner": {"reputation": 1219, "user_id": 5330805, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c56d9df54a81610d9ca8ddb0df86fe16?s=128&d=identicon&r=PG&f=1", "display_name": "olidem", "link": "https://stackoverflow.com/users/5330805/olidem"}, "edited": false, "score": 0, "creation_date": 1542442865, "post_id": 39871638, "comment_id": 93576967, "body": "This is not compatible with other locales"}], "tags": [], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "is_accepted": false, "score": 3, "last_activity_date": 1475663693, "creation_date": 1475663693, "answer_id": 39871638, "question_id": 29265949, "link": "https://stackoverflow.com/questions/29265949/excel-vba-check-if-value-is-type-double/39871638#39871638", "title": "Excel VBA - check if value is type DOUBLE", "body": "<p>Look for a full stop:</p>\n\n<pre><code>If IsNumeric(cellValue) And InStr(1, cellValue, \".\") &gt; 0 then isDouble = true\n</code></pre>\n"}], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18995, "favorite_count": 0, "accepted_answer_id": 29266572, "answer_count": 3, "score": 2, "last_activity_date": 1475663693, "creation_date": 1427315568, "last_edit_date": 1531164843, "question_id": 29265949, "link": "https://stackoverflow.com/questions/29265949/excel-vba-check-if-value-is-type-double", "title": "Excel VBA - check if value is type DOUBLE", "body": "<p>I have a column of numbers and I am using VBA to divide them by 1000.  However, I only want to do this if there's NO decimal in there.  I.e. numbers like 10093, 20398, 2039348, 298, 299, 10 will all be divided by 1000, but 2938.39, 2883.2, .2 won't.</p>\n\n<p>I am thinking just to create a loop that checks if the cell value is a DOUBLE and if so, skip it  - otherwise, divide.</p>\n\n<p>So, I thought this might work, but it doesn't:</p>\n\n<pre><code>For Each cel In importWS.Range(Cells(2, 2), Cells(dataLastRow - datafirstrow + 1, 2))\n    If Not CDbl(cel.Value) Then\n        cel.Value = cel.Value / 1000\n    End If\nNext cel\n</code></pre>\n\n<p>Any ideas? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1427315042, "post_id": 29265757, "comment_id": 46733316, "body": "Need to see more code - at least as far as the <code>End If</code> associated with the <code>If IsFileOpen...</code> statement"}, {"owner": {"reputation": 311, "user_id": 4625094, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3668fc2b694b942575f32afdef39da31?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/4625094/rick"}, "reply_to_user": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1427315300, "post_id": 29265757, "comment_id": 46733464, "body": "Oops. Didn&#39;t realize I forgot that. I added the rest of it"}], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 1, "last_activity_date": 1427315149, "creation_date": 1427315149, "answer_id": 29265838, "question_id": 29265757, "link": "https://stackoverflow.com/questions/29265757/saving-macro-adds-another-workbook/29265838#29265838", "title": "saving macro adds another workbook", "body": "<p>Your code is creating a new workbook and setting a variable to that workbook:</p>\n\n<pre><code>Set wb = Workbooks.Add\n</code></pre>\n\n<p>Then it activates the current workbook, bringing it to the foreground:</p>\n\n<pre><code>ThisWorkbook.Activate\n</code></pre>\n\n<p>Then, for some reason immediately brings the new blank workbook front and center:</p>\n\n<pre><code>wb.Activate\n</code></pre>\n\n<p>Then it checks to see if some file is open. If it is, it closes it (not sure what this is since we don't know what <code>UserInput</code> is. Anyway, it closes that file, then saves the new blank workbook over the top of it. Just the blank work book.</p>\n\n<p>Is that your desired behavior? If you want to close this newly saved blank workbook, then just do...</p>\n\n<pre><code>wb.close \n</code></pre>\n\n<p>...at the end of all of that. But, honestly, the whole thing seems a little strange. </p>\n"}], "owner": {"reputation": 311, "user_id": 4625094, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3668fc2b694b942575f32afdef39da31?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/4625094/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 29265838, "answer_count": 1, "score": 0, "last_activity_date": 1427315210, "creation_date": 1427314849, "last_edit_date": 1531161705, "question_id": 29265757, "link": "https://stackoverflow.com/questions/29265757/saving-macro-adds-another-workbook", "title": "saving macro adds another workbook", "body": "<p>I have a modified piece of code that saves a macro into a specified folder. It works great, however it opens a blank workbook upon completion. I do not want that to happen. I am aware it has to do something with the following</p>\n\n<blockquote>\n  <p>workbooks.add</p>\n</blockquote>\n\n<p>But since the variable has to be set, is there a way around that? I am fairly new at this and I just don't want to screw it up haha. Any help would be appreciated. Thanks in advance</p>\n\n<p>Anyways, here is the piece of code</p>\n\n<pre><code>    Set wb = Workbooks.Add\n    Application.DisplayAlerts = False\n    ThisWorkbook.Activate\n    wb.Activate\n    If IsFileOpen(\"\\\\showdog\\service\\Service_job_PO\\\" &amp; UserInput) Then\n    Workbooks(UserInput).Close SaveChanges:=False\n    wb.SaveAs \"\\\\showdog\\service\\Service_job_PO\\\" &amp; UserInput    \n    Else\n    wb.SaveAs \"\\\\showdog\\service\\Service_job_PO\\\" &amp; UserInput \n    Application.DisplayAlerts = True\n    End If\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 40194, "user_id": 3829407, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/DQPor.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/3829407/matt"}, "edited": false, "score": 0, "creation_date": 1427314661, "post_id": 29265417, "comment_id": 46733087, "body": "Welcome to SO. How <i>exactly</i> is this code now working? What happens and is there anything you already have done to try and fix it? Also, how do you trigger this macro?"}, {"owner": {"reputation": 1, "user_id": 4713785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf04c16d207c70d565d1270f5ce18959?s=128&d=identicon&r=PG&f=1", "display_name": "Tiago", "link": "https://stackoverflow.com/users/4713785/tiago"}, "reply_to_user": {"reputation": 40194, "user_id": 3829407, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/DQPor.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/3829407/matt"}, "edited": false, "score": 0, "creation_date": 1427318194, "post_id": 29265417, "comment_id": 46735053, "body": "the problem probably is in &quot;Select Case email.SenderName&quot;"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1427322722, "post_id": 29265417, "comment_id": 46736995, "body": "Please add context to your question. If there are errors, which line? Also, how is this routing called? Are you using rules? Is this called by another macro?"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1427389396, "creation_date": 1427389396, "answer_id": 29284588, "question_id": 29265417, "link": "https://stackoverflow.com/questions/29265417/save-attachments-using-sender-name-and-then-save-to-a-folder-and-rename-them/29284588#29284588", "title": "Save attachments using sender name and then save to a folder and rename them", "body": "<p>I have noticed the following piece of code:</p>\n\n<pre><code>    For Each anexo In email.Attachments\n        If Right(anexo.DisplayName, Len(anexo.DisplayName) - _\n            InStrRev(anexo.DisplayName, \".\")) = \"xls\" Then\n            anexo.SaveAsFile (caminho &amp; \"\\\" &amp; \"Obama.xls\")\n        ElseIf Right(anexo.DisplayName, Len(anexo.DisplayName) - _\n        InStrRev(anexo.DisplayName, \".\")) = \"xlsx\" Then\n            anexo.SaveAsFile (caminho &amp; \"\\\" &amp; \"Obama.xlsx\")\n        End If\n        Set anexo = Nothing\n    Next\n</code></pre>\n\n<p>The fact is that if you have multiple attachments in the collection they may overwrite each other on the disk because you save files with the same name. Try to use individual file names instead:</p>\n\n<pre><code>     For Each anexo In email.Attachments\n        If Right(anexo.DisplayName, Len(anexo.DisplayName) - _\n            InStrRev(anexo.DisplayName, \".\")) = \"xls\" Then\n            anexo.SaveAsFile (caminho &amp; \"\\\" &amp; anexo.Index &amp; \"Obama.xls\")\n        ElseIf Right(anexo.DisplayName, Len(anexo.DisplayName) - _\n        InStrRev(anexo.DisplayName, \".\")) = \"xlsx\" Then\n            anexo.SaveAsFile (caminho &amp; \"\\\" &amp; anexo.Index &amp; \"Obama.xlsx\")\n        End If\n        Set anexo = Nothing\n    Next\n</code></pre>\n\n<p>So, each attachment will have the unique name.</p>\n\n<p>Also I'd suggest creating a folder for each email. </p>\n"}], "owner": {"reputation": 1, "user_id": 4713785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf04c16d207c70d565d1270f5ce18959?s=128&d=identicon&r=PG&f=1", "display_name": "Tiago", "link": "https://stackoverflow.com/users/4713785/tiago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1192, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593248559, "creation_date": 1427313705, "last_edit_date": 1593248559, "question_id": 29265417, "link": "https://stackoverflow.com/questions/29265417/save-attachments-using-sender-name-and-then-save-to-a-folder-and-rename-them", "title": "Save attachments using sender name and then save to a folder and rename them", "body": "<p>I have this macro to save email attachments using sender name. However, it isn't work. Can you help me?</p>\n\n<pre><code>Public Sub saveattachment(email As Outlook.MailItem)\n    Dim anexo As Outlook.Attachment\n    Dim caminho As String\n    Dim mes As String\n    Dim ano As String\n    Dim dataRena As String\n    Dim dataRena2 As String\n    Dim dataCall As String\n\n    'let\u00b4s find which month, mmmm, to save the workbook\n    Month = \"March\"\n    Year = CStr(Year(Date))\n\n    'save email using sendername\n    Select Case email.SenderName\n    Case \"Adam Smith\"\n        caminho = \"C:\\Users\\Barack.Obama\\Desktop\"\n        For Each anexo In email.Attachments\n            If Right(anexo.DisplayName, Len(anexo.DisplayName) - _\n                InStrRev(anexo.DisplayName, \".\")) = \"xls\" Then\n                anexo.SaveAsFile (caminho &amp; \"\\\" &amp; \"Obama.xls\")\n            ElseIf Right(anexo.DisplayName, Len(anexo.DisplayName) - _\n            InStrRev(anexo.DisplayName, \".\")) = \"xlsx\" Then\n                anexo.SaveAsFile (caminho &amp; \"\\\" &amp; \"Obama.xlsx\")\n            End If\n            Set anexo = Nothing\n        Next\n    End Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "function", "ms-access"], "comments": [{"owner": {"reputation": 93, "user_id": 4570045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70bfa73fea7427e9819d28f1edf6c83?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Wickett", "link": "https://stackoverflow.com/users/4570045/mark-wickett"}, "edited": false, "score": 0, "creation_date": 1427337232, "post_id": 29265284, "comment_id": 46741193, "body": "Why can&#39;t you use the existing Access function <code>Application.Nz</code> which does the same thing?"}, {"owner": {"reputation": 93, "user_id": 4570045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70bfa73fea7427e9819d28f1edf6c83?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Wickett", "link": "https://stackoverflow.com/users/4570045/mark-wickett"}, "edited": false, "score": 0, "creation_date": 1427337389, "post_id": 29265284, "comment_id": 46741235, "body": "Alternatively, if you&#39;re actually wanting to change the value that&#39;s retained in the table, you could construct a <code>For Each field In tblHLstrat.Fields</code> loop that includes the statement <code>If IsNull( field.Value ) Then field.Value = 0</code>"}], "answers": [{"tags": [], "owner": {"reputation": 5315, "user_id": 3689364, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/1wGCo.jpg?s=128&g=1", "display_name": "EliteRaceElephant", "link": "https://stackoverflow.com/users/3689364/eliteraceelephant"}, "is_accepted": false, "score": 0, "last_activity_date": 1427379644, "creation_date": 1427379644, "answer_id": 29280871, "question_id": 29265284, "link": "https://stackoverflow.com/questions/29265284/vba-access-function-concatenate-tbl-name-and-various-fields/29280871#29280871", "title": "VBA Access: function concatenate tbl name and various fields", "body": "<p>Like Mark Wickett wrote in his comment, you want the NZ() function. It does exactly what you do in your custom function and works perfectly in queries. I have so many NZ() in my queries. So so many.</p>\n\n<p>Nz(variable, valueIfNull)</p>\n\n<p>Your query would look like this:</p>\n\n<pre><code>\"SELECT [MR_PL] as mrPL, [Daily_Return_%] as mrDailyReturn, [MR_Comm] as mrComm &amp; _ \nFROM tblNav_Calc \nWHERE tblNav_Calc.[Nav Date] = #\" &amp; Nz(tradeDate, 0) &amp; \"#\"\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 4051369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5547afba5abb9b9ee10836979b511dd?s=128&d=identicon&r=PG&f=1", "display_name": "Udaya Tenneti", "link": "https://stackoverflow.com/users/4051369/udaya-tenneti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431305217, "creation_date": 1427313261, "last_edit_date": 1431305217, "question_id": 29265284, "link": "https://stackoverflow.com/questions/29265284/vba-access-function-concatenate-tbl-name-and-various-fields", "title": "VBA Access: function concatenate tbl name and various fields", "body": "<p>Here is my function:</p>\n\n<pre><code>Public Function checkIfNoll(tbl As DAO.Recordset, field As AccessObject, variable As Variant)\n    If IsNull(tbl!field) Then\n        variable = 0\n    Else\n        variable = tbl!field\n    End If\nEnd Function\n</code></pre>\n\n<p>I have a sql statement as such: </p>\n\n<pre><code>Set tblHLstrat = Nothing\nsqlString2 = \"SELECT [MR_PL] as mrPL, [Daily_Return_%] as mrDailyReturn, [MR_Comm] as mrComm &amp; _ \nFROM tblNav_Calc WHERE tblNav_Calc.[Nav Date] = #\" &amp; tradeDate &amp; \"#\"\nSet tblHLstrat = db.OpenRecordset(sqlString2)\n</code></pre>\n\n<p>I want to feed my vba code:</p>\n\n<p>variable = checkIfNoll(tblHLstrat, mrPL(each field selected in SQL, will call function over and over again), Variable)</p>\n\n<p>I am unable to concatenate the table name and respective field names as my function variable. If someone could help me that would be great.</p>\n\n<p>Essentially the function checks to make sure fields (1, 2, 3,... n) isn't null. if it is null, the variable(n) will be set to 0. if it is not null, variable (n) will be equal to the field value.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "cells"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4713749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58286e209aa438b7298668ecba21b560?s=128&d=identicon&r=PG&f=1", "display_name": "sdfgmiguelsdfg", "link": "https://stackoverflow.com/users/4713749/sdfgmiguelsdfg"}, "edited": false, "score": 0, "creation_date": 1427397887, "post_id": 29268408, "comment_id": 46771566, "body": "Thanks a lot, that was really helpfull :)"}], "tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": false, "score": 0, "last_activity_date": 1427325902, "creation_date": 1427325902, "answer_id": 29268408, "question_id": 29265186, "link": "https://stackoverflow.com/questions/29265186/it-doesnt-go-through-all-the-cell-sometimes-jump-to-another-one-without-going-i/29268408#29268408", "title": "it doesnt go through all the cell, sometimes jump to another one without going in a sequel", "body": "<p>When a row is deleted, the row under it is not inspected, but skipped.\nEg. if you delete row 2, row 3 becomes the new row 2; but your For each loop goes on, to row 3. This means one row got skipped.\nYou can try using cell.EntireRow.Clear instead of Delete, and after the code is finished, just sort your table, or select blank cells in a column and delete rows.</p>\n"}], "owner": {"reputation": 11, "user_id": 4713749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58286e209aa438b7298668ecba21b560?s=128&d=identicon&r=PG&f=1", "display_name": "sdfgmiguelsdfg", "link": "https://stackoverflow.com/users/4713749/sdfgmiguelsdfg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1427325902, "creation_date": 1427312972, "last_edit_date": 1427313155, "question_id": 29265186, "link": "https://stackoverflow.com/questions/29265186/it-doesnt-go-through-all-the-cell-sometimes-jump-to-another-one-without-going-i", "title": "it doesnt go through all the cell, sometimes jump to another one without going in a sequel", "body": "<pre><code>Sub Vecinas()\n\n\n    For Each cell In [Data!A2.A50001]\n\n        pmNoVecias = cell.Offset(0, 0)\n        pmNameOrigen = cell.Offset(0, 1)\n        pmNameVecina = cell.Offset(0, 7)\n        pmVecinas = cell.Offset(0, 8)\n        pmIntentos = cell.Offset(0, 9)\n\n\n        If pmNameOrigen = \"\" Then\n           Exit For\n        End If\n\n        If pmVecinas = \"Yes\" Then\n\n            If pmIntentos &lt; 100 Then\n                cell.EntireRow.Copy\n                Sheets(\"Borrar\").Select\n                cell.EntireRow.PasteSpecial\n                Sheets(\"Data\").Select\n                cell.EntireRow.Delete\n            End If\n\n        Else\n\n            If pmIntentos &gt; 100 Then\n                cell.EntireRow.Copy\n                Sheets(\"Agregar\").Select\n                cell.EntireRow.Insert\n                Sheets(\"Data\").Select\n                cell.EntireRow.Delete\n            Else\n                cell.EntireRow.Delete\n            End If\n\n        End If\n\n    Next\nEnd Sub\n</code></pre>\n\n<p>This program runs fine, it deletes information from one sheet and puts it in another one, the only problem is that it doesn't go through every single cell, sometimes jump 2 or 3. How can I make for this program to go to every single cell?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 77, "user_id": 4389518, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8398fb66030276c0d4498a544944b844?s=128&d=identicon&r=PG&f=1", "display_name": "rmh", "link": "https://stackoverflow.com/users/4389518/rmh"}, "is_accepted": false, "score": 0, "last_activity_date": 1427324089, "creation_date": 1427324089, "answer_id": 29268034, "question_id": 29265041, "link": "https://stackoverflow.com/questions/29265041/access-2010-embedding-a-form-into-a-navigation-form/29268034#29268034", "title": "Access 2010: Embedding a form into a navigation form", "body": "<p>Usually the way that people go about searching is to create a query that contains the fields with the criteria related to another text field. for example criteria for [First Name] might be:</p>\n\n<pre><code>Like [Forms]![frm_RecordSearch]![txtFirst] &amp; \"*\"\n</code></pre>\n\n<p>That will show all results if the text box is blank and allow for people to search based on partial matches.\nFrom there all you would need to do is create a form based on the query and have the form with the search criteria call the display form. This will automatically sort it. If you want to avoid closing the form each time you search again you can also use Me.requery for example with two forms the search form would look like:</p>\n\n<pre><code>Private Sub cmdb_search_Click()\nIf CurrentProject.AllForms(\"frm_SearchResults\").IsLoaded Then\nForms![frm_SearchResults].Form.Requery\nElse\nDoCmd.OpenForm \"frm_SearchResults\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>As well you can use a similar technique to sort using sub forms though where the subform is the results and the text boxes/combo boxes etc. are contained on the main form and have an after update requery or search button etc that triggers the search. The downside of this method is the form is not able to be continuous as far as I know, but you can still get a good result this way.</p>\n\n<p>I hope that helps. Let me know if anything is unclear!</p>\n"}], "owner": {"reputation": 159, "user_id": 2588410, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/SZMms.jpg?s=128&g=1", "display_name": "Essi Shams", "link": "https://stackoverflow.com/users/2588410/essi-shams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 559, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594645158, "creation_date": 1427312548, "last_edit_date": 1594645158, "question_id": 29265041, "link": "https://stackoverflow.com/questions/29265041/access-2010-embedding-a-form-into-a-navigation-form", "title": "Access 2010: Embedding a form into a navigation form", "body": "<p>I have a form called <strong>ClientSearch</strong> which provides basic search on three fields into the <strong><em>Clients</em></strong> Table and displays results. This form is bound to the <strong>Clients</strong> table (Record Source is set to \"Client\" for the form). To search the <strong><em>Clients</em></strong> table, my code uses a <strong><em>DoCmd.ApplyFilter</em></strong> command in the event handler for the search button.</p>\n\n<p>I then made a navigation form and dragged the <strong><em>ClientSearch</em></strong> form into one of its categories.</p>\n\n<p>Now, when I click the search button, my <strong><em>DoCmd.ApplyFilter</em></strong> does not work anymore. I get a runtime error telling me my form is not bound to a particular table which is true. The navigation form is not bound to any tables and it can't be, since there will be multiple embedded forms on it for different tables and queries. \nHow do I address this problem? It seems that Access and VBA have no idea which table to use for the <strong><em>ApplyFilter</em></strong> query.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 1, "last_activity_date": 1427312743, "creation_date": 1427312743, "answer_id": 29265098, "question_id": 29265037, "link": "https://stackoverflow.com/questions/29265037/vlookup-works-in-excel-sheet-but-showing-error-in-vba/29265098#29265098", "title": "Vlookup works in excel sheet but showing error in VBA", "body": "<p>Double up your double quotes around strings.</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"B2:B\" &amp; lastrow).Formula = \"=IF(ISNA(VLOOKUP($A19,Sheet2!$A$2:\" &amp; _\n    \"$BA$26,MATCH(\"\"New Ratio number\"\",Sheet2!$1:$1,0),FALSE)),VLOOKUP($A19,Sheet3!$A$1:\" &amp; _\n    \"$AH$465,MATCH(\"\"Coverage (Number)\"\",Sheet3!$1:$1,0),FALSE),VLOOKUP($A19,Sheet2!$A$2:\" &amp; _\n    \"$BA$26,MATCH(\"\"New Ratio number\"\",Sheet2!$1:$1,0),FALSE))\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": false, "score": 0, "last_activity_date": 1427312758, "creation_date": 1427312758, "answer_id": 29265103, "question_id": 29265037, "link": "https://stackoverflow.com/questions/29265037/vlookup-works-in-excel-sheet-but-showing-error-in-vba/29265103#29265103", "title": "Vlookup works in excel sheet but showing error in VBA", "body": "<p>You have to escape your double quotes with an extra double quote:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"B2:B\" &amp; lastrow).Formula = \"=IF(ISNA(VLOOKUP($A19,Sheet2!$A$2:$BA$26,MATCH(\"\"New Ratio number\"\",Sheet2!$1:$1,0),FALSE)),VLOOKUP($A19,Sheet3!$A$1:$AH$465,MATCH(\"\"Coverage (Number)\"\",Sheet3!$1:$1,0),FALSE),VLOOKUP($A19,Sheet2!$A$2:$BA$26,MATCH(\"\"New Ratio number\"\",Sheet2!$1:$1,0),FALSE))\"\n</code></pre>\n"}], "owner": {"reputation": 757, "user_id": 3504466, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e403443744e98a4c9ddd6316ce487c36?s=128&d=identicon&r=PG&f=1", "display_name": "Jain", "link": "https://stackoverflow.com/users/3504466/jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "closed_date": 1427322228, "accepted_answer_id": 29265098, "answer_count": 2, "score": 0, "last_activity_date": 1427312758, "creation_date": 1427312535, "question_id": 29265037, "link": "https://stackoverflow.com/questions/29265037/vlookup-works-in-excel-sheet-but-showing-error-in-vba", "closed_reason": "Duplicate", "title": "Vlookup works in excel sheet but showing error in VBA", "body": "<pre><code> 'Worksheets(\"Sheet1\").Range(\"B2:B\" &amp; lastrow).Formula = \"=IF(ISNA(VLOOKUP($A19,Sheet2!$A$2:$BA$26,MATCH(\"New Ratio number\",Sheet2!$1:$1,0),FALSE)),VLOOKUP($A19,Sheet3!$A$1:$AH$465,MATCH(\"Coverage (Number)\",Sheet3!$1:$1,0),FALSE),VLOOKUP($A19,Sheet2!$A$2:$BA$26,MATCH(\"New Ratio number\",Sheet2!$1:$1,0),FALSE))\"\n</code></pre>\n\n<p>Coverage (Number) and New ratio Number are column names (I doubt that column names are a probblem)\nThe Vlookup when I insert in a cell it is working but it is showing an syntax error in VBA. Also I have checked  other formula which worked means there is no problem in lastrow or any other statement in the code. Can anyone point out the problem please? Thanks</p>\n"}, {"tags": ["excel", "vba", "rows"], "comments": [{"owner": {"reputation": 5177, "user_id": 95674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e606b10c31dd8d9eecd1034789653e44?s=128&d=identicon&r=PG", "display_name": "Barett", "link": "https://stackoverflow.com/users/95674/barett"}, "edited": false, "score": 1, "creation_date": 1427310676, "post_id": 29264361, "comment_id": 46730835, "body": "Have you tried any Excel VBA tutorials to start learning to do this type of coding?"}, {"owner": {"reputation": 53, "user_id": 4713599, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u92J0gbrvrY/AAAAAAAAAAI/AAAAAAAACI8/fpTuKQtqPOE/photo.jpg?sz=128", "display_name": "Euan Ives", "link": "https://stackoverflow.com/users/4713599/euan-ives"}, "reply_to_user": {"reputation": 5177, "user_id": 95674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e606b10c31dd8d9eecd1034789653e44?s=128&d=identicon&r=PG", "display_name": "Barett", "link": "https://stackoverflow.com/users/95674/barett"}, "edited": false, "score": 0, "creation_date": 1427311632, "post_id": 29264361, "comment_id": 46731424, "body": "Thanks Barett, i have done several tutorials which show how to move and copy between sheets but not to the level i&#39;m trying , hence the question for help ..."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 4713599, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u92J0gbrvrY/AAAAAAAAAAI/AAAAAAAACI8/fpTuKQtqPOE/photo.jpg?sz=128", "display_name": "Euan Ives", "link": "https://stackoverflow.com/users/4713599/euan-ives"}, "edited": false, "score": 0, "creation_date": 1427315315, "post_id": 29265324, "comment_id": 46733475, "body": "Wow , thanks a million i will be trying this first thing in the morning and let you know :) Awesome !"}], "tags": [], "owner": {"reputation": 36, "user_id": 4633674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/878805a96c4a3bf20622a46e289a3bf8?s=128&d=identicon&r=PG", "display_name": "Sean McMenemy", "link": "https://stackoverflow.com/users/4633674/sean-mcmenemy"}, "is_accepted": false, "score": 1, "last_activity_date": 1427313374, "creation_date": 1427313374, "answer_id": 29265324, "question_id": 29264361, "link": "https://stackoverflow.com/questions/29264361/move-selected-row-to-new-sheet-with-button/29265324#29265324", "title": "Move selected row to new sheet with button", "body": "<p>Copy once for each sheet &amp; rename sht2 as needed. Assign each copy to a button.</p>\n\n<pre><code>Sub move_row()\n\n'Declare variables\n    Dim sht1 As Worksheet\n    Dim sht2 As Worksheet\n    Dim sht3 As Worksheet\n    Dim lastRow As Long\n\n'Set variables\n    Set sht1 = Sheets(\"Master\")\n    Set sht2 = Sheets(\"John\")\n\n'Select Entire Row\n    Selection.EntireRow.Select\n\n'Move row to destination sheet &amp; Delete source row\n    lastRow = sht2.Range(\"A\" &amp; sht2.Rows.Count).End(xlUp).Row\n\n    With Selection\n        .Copy Destination:=sht2.Range(\"A\" &amp; lastRow + 1)\n        .EntireRow.Delete\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 4713599, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u92J0gbrvrY/AAAAAAAAAAI/AAAAAAAACI8/fpTuKQtqPOE/photo.jpg?sz=128", "display_name": "Euan Ives", "link": "https://stackoverflow.com/users/4713599/euan-ives"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5947, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1471495485, "creation_date": 1427310305, "last_edit_date": 1427310955, "question_id": 29264361, "link": "https://stackoverflow.com/questions/29264361/move-selected-row-to-new-sheet-with-button", "title": "Move selected row to new sheet with button", "body": "<p>I have a master sheet with lots of data every day. I then have nine sheets (called <code>john</code>, <code>peter</code>, <code>james</code> etc.) I go through each row (line) and decide which work/row is for which individual then cut the selected row (example row 5) than go into that persons sheet (example <code>james</code>) than select the next free row and paste. Than return to the master sheet delete the empty row (example row 5) and repeat for the next person till the master sheet is empty.  </p>\n\n<p>What I'm trying to do is create buttons at the top of the sheet to link to macros/VBA with that person's name on and when going through the master sheet (Sheet 1 same workbook) want to select a row then press the button and that selected row be moved to that person's sheet in the next free row and deleting the original row. </p>\n"}, {"tags": ["excel", "vba", "csv", "excel-2007"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4713527, "user_type": "registered", "profile_image": "https://graph.facebook.com/1405545989761558/picture?type=large", "display_name": "Steven", "link": "https://stackoverflow.com/users/4713527/steven"}, "edited": false, "score": 0, "creation_date": 1427312302, "post_id": 29264470, "comment_id": 46731809, "body": "That hotfix doesn&#39;t cover my particular issue.  Excel 2007 is not attempting to save the CSV file.  The Import --&gt; Text wizard is able to create the original data import connection.  But after hitting RefreshAll in VBA a few times, Excel hits a wall (probably another user or the C++ process hitting the file at the same time) and then Excel can never recover from that error."}, {"owner": {"reputation": 320, "user_id": 4713348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72460df3ea081a1177cb9566a6b57fc4?s=128&d=identicon&r=PG&f=1", "display_name": "gaby", "link": "https://stackoverflow.com/users/4713348/gaby"}, "reply_to_user": {"reputation": 1, "user_id": 4713527, "user_type": "registered", "profile_image": "https://graph.facebook.com/1405545989761558/picture?type=large", "display_name": "Steven", "link": "https://stackoverflow.com/users/4713527/steven"}, "edited": false, "score": 0, "creation_date": 1427312892, "post_id": 29264470, "comment_id": 46732125, "body": "it seems that you need to renew your old c++ process and accessing the file  in RO read-only mode."}, {"owner": {"reputation": 320, "user_id": 4713348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72460df3ea081a1177cb9566a6b57fc4?s=128&d=identicon&r=PG&f=1", "display_name": "gaby", "link": "https://stackoverflow.com/users/4713348/gaby"}, "reply_to_user": {"reputation": 1, "user_id": 4713527, "user_type": "registered", "profile_image": "https://graph.facebook.com/1405545989761558/picture?type=large", "display_name": "Steven", "link": "https://stackoverflow.com/users/4713527/steven"}, "edited": false, "score": 0, "creation_date": 1427313506, "post_id": 29264470, "comment_id": 46732448, "body": "an other way is to implement the import-&gt;data from text function of excel in your own way using a VBA macro and then you can handle those csv file in readonly mode. A button and a VBA macro reading this file and place the content in the apropriate sheet i think is your solution if you can&#39;t rewrite the old c++ process."}, {"owner": {"reputation": 1, "user_id": 4713527, "user_type": "registered", "profile_image": "https://graph.facebook.com/1405545989761558/picture?type=large", "display_name": "Steven", "link": "https://stackoverflow.com/users/4713527/steven"}, "edited": false, "score": 0, "creation_date": 1427317576, "post_id": 29264470, "comment_id": 46734729, "body": "could you post a code snippet that opens a CSV file (say, from C:\\myData\\myfile.csv), and then loops over the contents and writes it to the Excel file?"}], "tags": [], "owner": {"reputation": 320, "user_id": 4713348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72460df3ea081a1177cb9566a6b57fc4?s=128&d=identicon&r=PG&f=1", "display_name": "gaby", "link": "https://stackoverflow.com/users/4713348/gaby"}, "is_accepted": false, "score": 0, "last_activity_date": 1427310655, "creation_date": 1427310655, "answer_id": 29264470, "question_id": 29264170, "link": "https://stackoverflow.com/questions/29264170/excel-2007-cannot-refreshdata-from-shared-csv-file-on-network-drive/29264470#29264470", "title": "Excel 2007 cannot RefreshData from shared CSV file on network drive", "body": "<p>check out <a href=\"http://support.microsoft.com/en-us/kb/983314\" rel=\"nofollow\">http://support.microsoft.com/en-us/kb/983314</a></p>\n\n<p>it seems to be sharing violation and the hot fix above seems to resolve this issue\nmay be that's why excel 2007 does not work.</p>\n\n<p>Before you install the office microsoft hotfix be sure that you have already read\nthe cause and effect issues of this hotfix in order to not produce any damage to your running office 2007 system.</p>\n\n<p>Also have in mind that windows xp handles completely efferent the files than windows 7 and specially network files.</p>\n"}], "owner": {"reputation": 1, "user_id": 4713527, "user_type": "registered", "profile_image": "https://graph.facebook.com/1405545989761558/picture?type=large", "display_name": "Steven", "link": "https://stackoverflow.com/users/4713527/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1427310655, "creation_date": 1427309674, "last_edit_date": 1592644375, "question_id": 29264170, "link": "https://stackoverflow.com/questions/29264170/excel-2007-cannot-refreshdata-from-shared-csv-file-on-network-drive", "title": "Excel 2007 cannot RefreshData from shared CSV file on network drive", "body": "<p>I have a simple Excel 2003 file running on WinXP that uses the\nImport External Data --&gt; Text wizard\nto import a CSV file from a shared network drive.</p>\n<h2>this works fine</h2>\n<p>I now need to do the same thing in Excel 2007 on a Windows7 box.\nSo i goto Data --&gt; From Text ....and repeat the steps, which are essentially the same as Excel 2003.</p>\n<p>At this point (when Excel 2007 is trying to open and read the contents of the CSV file), Excel is throwing a msgbox error</p>\n<p>&quot;Excel cannot access the file XYZ&quot;  There are several possible reasons</p>\n<p>-The file name or path does not exist</p>\n<p>-The file is being used by another program</p>\n<p>-The workbook you are trying to save has the same name as a currently open workbook</p>\n<p>So, i don't understand what is going on.  I can manually open the CSV file by just clicking on it in Windows Explorer.  And, my Excel 2003 files can make the VBA call  ThisWorkbook.RefreshAll  and the spreadsheet updates with the updated data in the CSV file (written by a legacy c++ process).</p>\n<p>So, why is Excel 2007 complaining??  Many users are hitting this CSV file intermitently with Excel 2003/WinXP with no problems.  Why is Excel 2007/Win7 complaining?  Is there a way to force Excel 2007 to attempt to open/import data the CSV file in Read-Only mode via VBA?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4500562, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8dac15110c01ea288a96baf7035425f6?s=128&d=identicon&r=PG&f=1", "display_name": "MrJ1m", "link": "https://stackoverflow.com/users/4500562/mrj1m"}, "edited": false, "score": 0, "creation_date": 1427309491, "post_id": 29264006, "comment_id": 46730142, "body": "So I should declare jbs as something else? maybe variant?"}, {"owner": {"reputation": 55, "user_id": 4500562, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8dac15110c01ea288a96baf7035425f6?s=128&d=identicon&r=PG&f=1", "display_name": "MrJ1m", "link": "https://stackoverflow.com/users/4500562/mrj1m"}, "edited": false, "score": 0, "creation_date": 1427309958, "post_id": 29264006, "comment_id": 46730422, "body": "Actually the loop in column 2 is supposed to check if one day have passed or not. If the date is different from the precedent, then do the stuff in the middle, for just the first two row, then go on to the next day. I&#39;ll try without the jbs variable if their is no need for it"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 55, "user_id": 4500562, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8dac15110c01ea288a96baf7035425f6?s=128&d=identicon&r=PG&f=1", "display_name": "MrJ1m", "link": "https://stackoverflow.com/users/4500562/mrj1m"}, "edited": false, "score": 0, "creation_date": 1427310040, "post_id": 29264006, "comment_id": 46730472, "body": "Shouldn&#39;t be a need for it, but if you&#39;re getting a type mismatch, that indicates you have a non-date in your date column. May want to check your data."}, {"owner": {"reputation": 55, "user_id": 4500562, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8dac15110c01ea288a96baf7035425f6?s=128&d=identicon&r=PG&f=1", "display_name": "MrJ1m", "link": "https://stackoverflow.com/users/4500562/mrj1m"}, "edited": false, "score": 0, "creation_date": 1427310154, "post_id": 29264006, "comment_id": 46730543, "body": "I&#39;m pretty sure it happens at the end of the loop, because if my  variable IngLastRow was wrong, the loop might have gone through some blank cell. I&#39;ll try and update. Thanks!"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 55, "user_id": 4500562, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8dac15110c01ea288a96baf7035425f6?s=128&d=identicon&r=PG&f=1", "display_name": "MrJ1m", "link": "https://stackoverflow.com/users/4500562/mrj1m"}, "edited": false, "score": 0, "creation_date": 1427310487, "post_id": 29264006, "comment_id": 46730709, "body": "If you&#39;re hitting the last row  &amp; it&#39;s blank, then: <code>For cRow = lngFirstRow To lngLastRow - 1</code>. Also <code>Step 1</code> is the default so you don&#39;t need that unless you like to be really, really complete."}, {"owner": {"reputation": 55, "user_id": 4500562, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8dac15110c01ea288a96baf7035425f6?s=128&d=identicon&r=PG&f=1", "display_name": "MrJ1m", "link": "https://stackoverflow.com/users/4500562/mrj1m"}, "edited": false, "score": 0, "creation_date": 1427320097, "post_id": 29264006, "comment_id": 46735951, "body": "It works like a charm!  Any idea how to get this program to the next level and make it work to extract the data from 5 specific workbook that are in the same folder?  For each workbook i need the data destination to be a sheet in a new workbook, which will also host the program."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 55, "user_id": 4500562, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8dac15110c01ea288a96baf7035425f6?s=128&d=identicon&r=PG&f=1", "display_name": "MrJ1m", "link": "https://stackoverflow.com/users/4500562/mrj1m"}, "edited": false, "score": 1, "creation_date": 1427325817, "post_id": 29264006, "comment_id": 46738195, "body": "Take a shot at it. If you get stuck post a new question with your code and where you got stuck."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 2, "last_activity_date": 1427309690, "last_edit_date": 1427309690, "creation_date": 1427309190, "answer_id": 29264006, "question_id": 29263942, "link": "https://stackoverflow.com/questions/29263942/vba-error-13-type-missmatch/29264006#29264006", "title": "VBA error 13 type missmatch", "body": "<ol>\n<li><code>jbs</code> is declared a <code>Date</code>. When you get your error, <code>.Cells(cRow,2)</code> is referring to a cell that does not contain a date or a floating point number that could be converted to a date.</li>\n</ol>\n\n<p>Assuming that you don't care what <em>kind</em> of values you're looking at in column 2, replace:</p>\n\n<pre><code>            jbs = .Cells(cRow, 2)\n                If jbs &lt;&gt; .Cells(cRow - 1, 2).Value Then\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>                If .Cells(cRow, 2) &lt;&gt; .Cells(cRow - 1, 2) Then\n</code></pre>\n\n<p>That eliminates declaring <code>jbs</code> and the typing altogether.</p>\n\n<ol start=\"2\">\n<li><code>lngLastRow = .UsedRange.Rows.Count</code></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 4500562, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8dac15110c01ea288a96baf7035425f6?s=128&d=identicon&r=PG&f=1", "display_name": "MrJ1m", "link": "https://stackoverflow.com/users/4500562/mrj1m"}, "edited": false, "score": 0, "creation_date": 1427320388, "post_id": 29265518, "comment_id": 46736120, "body": "Thanks a lot mate! I&#39;m starting to understand this find function a little better!  Also, it works fine doing &quot; If .Cells(cRow, 2) &lt;&gt; .Cells(cRow - 1, 2) Then &quot;.  I am now at the last stage of this, thanks to you"}], "tags": [], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1427314035, "creation_date": 1427314035, "answer_id": 29265518, "question_id": 29263942, "link": "https://stackoverflow.com/questions/29263942/vba-error-13-type-missmatch/29265518#29265518", "title": "VBA error 13 type missmatch", "body": "<h2>Find row of the last used cell on the sheet</h2>\n\n<p>The code for <code>lngLastRow</code> you are using, will return a row of the last used cell on the sheet. Not necessarily last used cell in column \"B\" which you are comparing later in your code, for example here : <code>If jbs &lt;&gt; .Cells(cRow - 1, 2).Value Then...</code>   </p>\n\n<h2>Find row of the last used cell in column \"B\"</h2>\n\n<p>If you want to find last used row in column \"B\" with this method use : <code>lngLastRow = .columns(2).Find(What:=\"*\", LookAt:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False).Row</code><br>\nThat should get rid of the loop error, because it will properly stop when it should.  </p>\n\n<hr>\n\n<p>Sources :</p>\n\n<ol>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff195212%28v=office.15%29.aspx\" rel=\"nofollow\">Application.Columns Property</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/bb178845%28v=office.12%29.aspx\" rel=\"nofollow\">Range.Find Method</a></li>\n</ol>\n"}], "owner": {"reputation": 55, "user_id": 4500562, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8dac15110c01ea288a96baf7035425f6?s=128&d=identicon&r=PG&f=1", "display_name": "MrJ1m", "link": "https://stackoverflow.com/users/4500562/mrj1m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 29264006, "answer_count": 2, "score": 0, "last_activity_date": 1427415436, "creation_date": 1427308988, "last_edit_date": 1427415436, "question_id": 29263942, "link": "https://stackoverflow.com/questions/29263942/vba-error-13-type-missmatch", "title": "VBA error 13 type missmatch", "body": "<p>I'm working with three 500K+ rows sheets on five different workbooks and on my way to extracting the data I need I came up with the following code:</p>\n\n<pre><code>Sub Macro3()\n\nDim lngFirstRow As Long, lngLastRow As Long, cRow As Long, lngNextDestRow As Long\nDim jbs As Date\nDim shSrc As Worksheet, shDest As Worksheet\n\nSet shDest = ActiveWorkbook.Sheets(\"Sheeet1\")  '''Feuille de destination (sheetDestination)\nlngNextDestRow = 2\n\n   For Each shSrc In ThisWorkbook.Worksheets\n   Nom = shSrc.Name\n    If Nom &lt;&gt; \"Sheeet2\" Then\n        With shSrc\n\n            lngFirstRow = 2\n            lngLastRow = .Cells.Find(What:=\"*\", after:=.Cells.Cells(1), LookAt:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False).Row\n\n            For cRow = lngFirstRow To lngLastRow Step 1\n                jbs = .Cells(cRow, 2)\n                    If jbs &lt;&gt; .Cells(cRow - 1, 2).Value Then\n                        .Range(\"B\" &amp; cRow).Copy Destination:=shDest.Range(\"A\" &amp; lngNextDestRow)\n                        .Range(\"D\" &amp; cRow).Copy Destination:=shDest.Range(\"B\" &amp; lngNextDestRow)\n                        .Range(\"D\" &amp; cRow + 1).Copy Destination:=shDest.Range(\"C\" &amp; lngNextDestRow)\n                        .Range(\"E\" &amp; cRow).Copy Destination:=shDest.Range(\"D\" &amp; lngNextDestRow)\n                        .Range(\"E\" &amp; cRow + 1).Copy Destination:=shDest.Range(\"E\" &amp; lngNextDestRow)\n                        .Range(\"F\" &amp; cRow).Copy Destination:=shDest.Range(\"F\" &amp; lngNextDestRow)\n                        .Range(\"F\" &amp; cRow + 1).Copy Destination:=shDest.Range(\"G\" &amp; lngNextDestRow)\n                        lngNextDestRow = lngNextDestRow + 1\n                    End If\n            Next cRow\n        End With\n    End If\nNext shSrc\nEnd Sub\n</code></pre>\n\n<p>This does what I need. I just modify it little by little to make the processing of the five workbooks faster. Here I extract the data in a new sheet on the same workbook.</p>\n\n<p>1) It seems to work but after the whole process is done I keep getting \" jbs = .Cells(cRow, 2) \" highlighted and an error 13 type. Any idea how to fix this?</p>\n\n<p>2) Someone provided me with this line:</p>\n\n<pre><code>lngLastRow = .Cells.Find(What:=\"*\", after:=.Cells.Cells(1), LookAt:=xlPart,    LookIn:=xlFormulas, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False).Row\n</code></pre>\n\n<p>Is there any way to find the number of the last filled row in a list of data?</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 698, "user_id": 2760773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b87b1b18411f5c97707cde95f5cdb6d?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/2760773/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1427312806, "creation_date": 1427312806, "answer_id": 29265117, "question_id": 29263894, "link": "https://stackoverflow.com/questions/29263894/outlook-vba-save-attachments-and-email-separately/29265117#29265117", "title": "Outlook VBA - Save Attachments and Email separately", "body": "<p>only way I can think of would be to save the E-Mail including attachments, then open the saved E-Mail from the disk and work with the attachments in there.</p>\n\n<pre><code>Sub workwithmail(pathfile As string)\nDim oNamespace As Outlook.NameSpace\n Set oNamespace = Application.GetNamespace(\"MAPI\")\nDim oSharedItem As Outlook.mailitem\nDim pathfile As String\n    Set oSharedItem = oNamespace.OpenSharedItem(pathfile)\n\n  '''here Comes your code\n\n    oSharedItem.Close (olSave)\n    Set oSharedItem = Nothing\n    Set oNamespace = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1427312869, "creation_date": 1427312869, "answer_id": 29265143, "question_id": 29263894, "link": "https://stackoverflow.com/questions/29263894/outlook-vba-save-attachments-and-email-separately/29265143#29265143", "title": "Outlook VBA - Save Attachments and Email separately", "body": "<p>Do not delete the attachments from the original item. Save the message as an MSG file using MailItem.SaveAs, reopen it using Application.Session.OpenSharedItem (returns MailItem object) and remove attachments from that object. Then call MailItem.Save.</p>\n"}], "owner": {"reputation": 2052, "user_id": 285246, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a4f6c2e8a146f19f210a10e624f57164?s=128&d=identicon&r=PG", "display_name": "Tejas", "link": "https://stackoverflow.com/users/285246/tejas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 504, "favorite_count": 0, "accepted_answer_id": 29265117, "answer_count": 2, "score": 2, "last_activity_date": 1593328091, "creation_date": 1427308844, "last_edit_date": 1593328091, "question_id": 29263894, "link": "https://stackoverflow.com/questions/29263894/outlook-vba-save-attachments-and-email-separately", "title": "Outlook VBA - Save Attachments and Email separately", "body": "<p>User will select an Email and I need to save all its attachments to a folder + that Email without attachment in a separate folder.</p>\n\n<p>I have written code and it seems to be working fine except one big issue:</p>\n\n<p><strong>Attachments are removed from original email also from my Inbox. After removing attachments I am calling SaveAs method so I think this should not happen.</strong></p>\n\n<p>Here is the code I have written:</p>\n\n<pre><code> Dim objMailItemOriginal As Outlook.MailItem\n    Dim objMailItemNew As Outlook.MailItem\n    Dim objNameSpaceUserNS As Outlook.namespace\n    Dim emailPath$, tmpFolder$\n\n    Set objMailItemOriginal = Application.ActiveExplorer.Selection(1)\n    Set objMailItemNew = Application.CreateItem(olMailItem)\n    Set objNameSpaceUserNS = Application.GetNamespace(\"MAPI\")\n\n    tmpFolder = Environ(\"Temp\") &amp; \"\\\" &amp; Format$(Now, \"hh_mm_ss\")\n    MkDir tmpFolder\n\n    emailPath = Environ$(\"Temp\") &amp; \"\\tmpEmail.msg\"\n\n    Dim attachPath$\n    For i = objMailItemOriginal.Attachments.Count To 1 Step -1\n        attachPath = tmpFolder &amp; \"\\\" &amp; objMailItemOriginal.Attachments(i)\n        objMailItemOriginal.Attachments(i).SaveAsFile attachPath\n\n        objMailItemNew.Attachments.Add attachPath\n        objMailItemOriginal.Attachments.Remove (i)\n    Next\n\n    objMailItemOriginal.SaveAs emailPath\n    objMailItemOriginal.Close olDiscard\n</code></pre>\n\n<p>Any outlook expert please?</p>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4713413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60b0d8f98ce77e4a78abb29d1e376f?s=128&d=identicon&r=PG&f=1", "display_name": "beaster", "link": "https://stackoverflow.com/users/4713413/beaster"}, "edited": false, "score": 0, "creation_date": 1427314977, "post_id": 29264246, "comment_id": 46733283, "body": "And this work also :-) Thank you guys for helping me."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1427309943, "creation_date": 1427309943, "answer_id": 29264246, "question_id": 29263850, "link": "https://stackoverflow.com/questions/29263850/declare-cellsrow-col-using-variables-from-array/29264246#29264246", "title": "Declare Cells(row,col) using variables from ARRAY", "body": "<p>Using <em>Arrays</em></p>\n\n<pre><code>Sub ResetButt01_Click()\n\nDim myRow() As Variant\nDim myCol() As Variant\nDim i As Long, R As Long, C As Long\n\nmyRow = Array(12, 12, 12, 19, 19, 19)\nmyCol = Array(5, 13, 21, 4, 6, 12)\n\nFor i = 0 To 5\n    R = myRow(i)\n    C = myCol(i)\n    Cells(R, C).Value = 0\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": false, "score": 3, "last_activity_date": 1427310048, "creation_date": 1427310048, "answer_id": 29264287, "question_id": 29263850, "link": "https://stackoverflow.com/questions/29263850/declare-cellsrow-col-using-variables-from-array/29264287#29264287", "title": "Declare Cells(row,col) using variables from ARRAY", "body": "<p>You can create a comma separated string with cell addresses:</p>\n\n<pre><code>Const myCells As String = \"A1, B2, C3, D4, E5, F6\"\nRange(myCells).Value = 0\n</code></pre>\n\n<p>You could also create named range <code>myCells2</code> and simply call:</p>\n\n<pre><code>Range(\"myCells2\").Value = 0 \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 4713413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60b0d8f98ce77e4a78abb29d1e376f?s=128&d=identicon&r=PG&f=1", "display_name": "beaster", "link": "https://stackoverflow.com/users/4713413/beaster"}, "edited": false, "score": 0, "creation_date": 1427315233, "post_id": 29264408, "comment_id": 46733427, "body": "Yeh this one also work and by your solution matro I finaly realize how it works. I am really very thankfull for your post."}], "tags": [], "owner": {"reputation": 29, "user_id": 3897351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d6SJS.jpg?s=128&g=1", "display_name": "matro", "link": "https://stackoverflow.com/users/3897351/matro"}, "is_accepted": false, "score": 1, "last_activity_date": 1427310430, "creation_date": 1427310430, "answer_id": 29264408, "question_id": 29263850, "link": "https://stackoverflow.com/questions/29263850/declare-cellsrow-col-using-variables-from-array/29264408#29264408", "title": "Declare Cells(row,col) using variables from ARRAY", "body": "<p>Try using cycle:</p>\n\n<pre><code>Option Explicit\n\nSub ResetButt01_Click()\n\nDim myRow() As Variant\nDim myCol() As Variant\nDim i As Integer\n\nmyRow = Array(12, 12, 12, 19, 19, 19)\nmyCol = Array(5, 13, 21, 4, 6, 12)\n\nFor i = LBound(myRow) To UBound(myRow)\n    Cells(myRow(i), myCol(i)).Value = 0\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>M.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 4713413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60b0d8f98ce77e4a78abb29d1e376f?s=128&d=identicon&r=PG&f=1", "display_name": "beaster", "link": "https://stackoverflow.com/users/4713413/beaster"}, "edited": false, "score": 0, "creation_date": 1427718941, "post_id": 29269617, "comment_id": 46878578, "body": "Thank you ... you are right it is faster without ARRAY but when I create one range it doesnt work - there was error. I try it several times and nothing. Then all I do was create second Dim rng2 As Range and I pul one half of cells to first range rng1 and second half of cells to another range rng2 and then it works perfectly. It seems to me that thare is limitation if you want fill range with single difrent cells like Range(&quot;A3, B3, C7, D1, D5.... etc)."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 23, "user_id": 4713413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60b0d8f98ce77e4a78abb29d1e376f?s=128&d=identicon&r=PG&f=1", "display_name": "beaster", "link": "https://stackoverflow.com/users/4713413/beaster"}, "edited": false, "score": 0, "creation_date": 1427724029, "post_id": 29269617, "comment_id": 46882111, "body": "@beaster can you pls add your example above?"}, {"owner": {"reputation": 23, "user_id": 4713413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60b0d8f98ce77e4a78abb29d1e376f?s=128&d=identicon&r=PG&f=1", "display_name": "beaster", "link": "https://stackoverflow.com/users/4713413/beaster"}, "edited": false, "score": 0, "creation_date": 1427726223, "post_id": 29269617, "comment_id": 46883659, "body": "This is my new code:   <code>Sub ResetButt01_Klikn&#250;\u0165()        Dim rng1 As Range       Dim rng2 As Range        Set rng1 = Range(&quot;C33,C40,C67,C74,C88,C95,D19,D53,E12,E26,E33,E40,E47,E&zwnj;&#8203;60,E67,E74,E81,E88,E&zwnj;&#8203;95,E102,F19,F53,G33,&zwnj;&#8203;G40&quot;)       Set rng2 = Range(&quot;G67,G74,G88,G95,K53,K60,L19,L26,L88,M12,M33,M40,M47,M&zwnj;&#8203;53,M60,M67,M74,M81,M&zwnj;&#8203;95,M102,N19,N26,N88,&zwnj;&#8203;O53,O60,T26,T33,T67,&zwnj;&#8203;T74,T81,T88,U12,U19,&zwnj;&#8203;U40,U47,U53,U60,U95,&zwnj;&#8203;U102,V26,V33,V67,V74&zwnj;&#8203;,V81,V88&quot;)       rng1.Value2 = 0       rng2.Value2 = 0        End Sub</code>"}, {"owner": {"reputation": 23, "user_id": 4713413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60b0d8f98ce77e4a78abb29d1e376f?s=128&d=identicon&r=PG&f=1", "display_name": "beaster", "link": "https://stackoverflow.com/users/4713413/beaster"}, "edited": false, "score": 0, "creation_date": 1427726443, "post_id": 29269617, "comment_id": 46883816, "body": "Why I cant put new line to the comment?  I tried to do that with two spaces to add linebreak but it doesnt work.  I think I am big lama."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 23, "user_id": 4713413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60b0d8f98ce77e4a78abb29d1e376f?s=128&d=identicon&r=PG&f=1", "display_name": "beaster", "link": "https://stackoverflow.com/users/4713413/beaster"}, "edited": false, "score": 0, "creation_date": 1427767329, "post_id": 29269617, "comment_id": 46903024, "body": "@beaster  see my update post above. For future reference its easier to edit your question - code and comments don&#39;t mix :)"}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 1, "last_activity_date": 1427767284, "last_edit_date": 1427767284, "creation_date": 1427333680, "answer_id": 29269617, "question_id": 29263850, "link": "https://stackoverflow.com/questions/29263850/declare-cellsrow-col-using-variables-from-array/29269617#29269617", "title": "Declare Cells(row,col) using variables from ARRAY", "body": "<p>The array approach you have used is actually much slower than writing to the range, as you are writing to each indvidual cell</p>\n\n<p>You would be better off defining a range, and writing to it in a sigle shot, code is also easier to read. On my testing this is 4x faster than the answer you have selected.</p>\n\n<pre><code>Sub ResetButt02_Click()\nDim rng1 As Range\nSet rng1 = Range(\"E12,M12,U12,D19,E19,l19\")\nrng1.Value2 = vbNullString\nEnd Sub\n</code></pre>\n\n<p><em>update</em></p>\n\n<p>When setting a single range there is a limit of 255 characters. Either work with two ranges as you did, or use <code>Union</code> to mesh the two ranges together:</p>\n\n<pre><code>Sub ResetButt01_Klikn\u00fat()\nDim rng1 As Range\nDim rng2 As Range\nSet rng1 = Range(\"C33,C40,C67,C74,C88,C95,D19,D53,E12,E26,E33,E40,E47,E60,E67,E74,E81,E88,E95,E102,F19,F53,G33,G40\")\nSet rng2 = Range(\"G67,G74,G88,G95,K53,K60,L19,L26,L88,M12,M33,M40,M47,M53,M60,M67,M74,M81,M95,M102,N19,N26,N88,O53,O60,T26,T33,T67,T74,T81,T88,U12,U19,U40,U47,U53,U60,U95,U102,V26,V33,V67,V74,V81,V88\")\nSet rng2 = Union(rng1, rng2)\nrng2.Value2 = 0\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4713413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60b0d8f98ce77e4a78abb29d1e376f?s=128&d=identicon&r=PG&f=1", "display_name": "beaster", "link": "https://stackoverflow.com/users/4713413/beaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 29269617, "answer_count": 4, "score": 2, "last_activity_date": 1427767284, "creation_date": 1427308720, "last_edit_date": 1427529907, "question_id": 29263850, "link": "https://stackoverflow.com/questions/29263850/declare-cellsrow-col-using-variables-from-array", "title": "Declare Cells(row,col) using variables from ARRAY", "body": "<p>Is it possible to to declare Cell position with using variables from an array?</p>\n\n<p>Here is my old code which works perfectly but what if I need many more Cells? (I make it shorter). This code by pressing button sets Value of selected cells to zero.</p>\n\n<pre><code>Sub ResetButt01_Click()\n\nCells(12, 5).Value = 0\nCells(12, 13).Value = 0\nCells(12, 21).Value = 0\nCells(19, 4).Value = 0\nCells(19, 6).Value = 0\nCells(19, 12).Value = 0\n\nEnd Sub\n</code></pre>\n\n<p>And here is my attempt to do it by using Array:</p>\n\n<pre><code>Sub ResetButt01_Click()\n\nDim myRow() As Variant\nDim myCol() As Variant\n\nmyRow = Array(12, 12, 12, 19, 19, 19)\nmyCol = Array(5, 13, 21, 4, 6, 12)\n\nCells(myRow, myCol).Value = 0\n\nEnd Sub\n</code></pre>\n\n<p>But this code doesn't work. So I tried this:</p>\n\n<pre><code>Sub ResetButt01_Click()\n\nDim myRow() As Variant\nDim myCol() As Variant\nDim r As Integer\nDim c As Integer\n\nmyRow = Array(12, 12, 12, 19, 19, 19)\nmyCol = Array(5, 13, 21, 4, 6, 12)\n\nr = myRow\nc = myCol\n\nCells(r, c).Value = 0\n\nEnd Sub\n</code></pre>\n\n<p>But again it doesn't work. Do you have any idea how to put values to array and this use these values as variables to define the position of Cells?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1427309373, "post_id": 29263803, "comment_id": 46730057, "body": "<a href=\"http://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>"}, {"owner": {"reputation": 1005, "user_id": 185133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7805e415be10bbac68980f707c634b41?s=128&d=identicon&r=PG", "display_name": "rryanp", "link": "https://stackoverflow.com/users/185133/rryanp"}, "edited": false, "score": 0, "creation_date": 1427310485, "post_id": 29263803, "comment_id": 46730707, "body": "Is there something consistent about the section headers that you could look for in VBA (e.g. each starts with a certain set of characters)? Or is there a blank row between each section? It would be relatively easy using a loop if you had some way to automatically determine the break between sections."}, {"owner": {"reputation": 3, "user_id": 4709462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c95d77bb95b0bfd8eae86220026ffd3?s=128&d=identicon&r=PG&f=1", "display_name": "Will Conley", "link": "https://stackoverflow.com/users/4709462/will-conley"}, "edited": false, "score": 0, "creation_date": 1427311049, "post_id": 29263803, "comment_id": 46731048, "body": "Each section has a column header marked &quot;Corrections $&quot; in the row above where the prices will start and a blank row above that separating the sections."}], "answers": [{"comments": [{"owner": {"reputation": 1005, "user_id": 185133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7805e415be10bbac68980f707c634b41?s=128&d=identicon&r=PG", "display_name": "rryanp", "link": "https://stackoverflow.com/users/185133/rryanp"}, "edited": false, "score": 0, "creation_date": 1427311657, "post_id": 29264703, "comment_id": 46731442, "body": "I just saw your comment above and made some slight edits to the post--the one thing that would have to be added is allowing for the blank row in between sections. I think this could be done by changing the If statement to:  if (wksh.range(&quot;A&quot;&amp;i).value=0 or wksh.range(&quot;A&quot;&amp;i)=&quot;&quot;) AND (wksh.range(&quot;A&quot;&amp;i+1).value=0 or wksh.range(&quot;A&quot;&amp;i+1)=&quot;&quot;) then"}], "tags": [], "owner": {"reputation": 1005, "user_id": 185133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7805e415be10bbac68980f707c634b41?s=128&d=identicon&r=PG", "display_name": "rryanp", "link": "https://stackoverflow.com/users/185133/rryanp"}, "is_accepted": true, "score": 0, "last_activity_date": 1427311348, "creation_date": 1427311348, "answer_id": 29264703, "question_id": 29263803, "link": "https://stackoverflow.com/questions/29263803/excel-2013-looking-for-a-macro-to-write-a-sum-for-variable-length-sections/29264703#29264703", "title": "Excel 2013 - Looking for a macro to write a sum for variable length sections", "body": "<p>This block of code assumes that each section heading starts with the word \"Corrections\" and that there are no blank rows between sections (so any blank cells will be filled with a sum formula). It also assumes the data is in column A. If your spreadsheet isn't setup like that, you could tweak this to work for your situation. Note that there isn't much in terms of error checking here, so you'll have to make sure your spreadsheet doesn't have any issues, or add error checks to the code (for example, if your spreadsheet doesn't start with a section heading, you may have an issue, and if you have sections with no values--that is a section header and then no data under it--you'll have an issue).</p>\n\n<pre><code>Dim wksh as worksheet\nDim last_row as long\nDim curr_start as long\n\nset wksh = thisworkbook.worksheets(\"&lt;your worksheet name&gt;\")\nlast_row = wksh.cells(wksh.Rows.Count, \"A\").End(xlUp).Row\n\nfor i = 1 to last_row + 1\n    if wksh.range(\"A\"&amp;i).value=0 or wksh.range(\"A\"&amp;i)=\"\" then\n        wksh.range(\"A\"&amp;i).formula = \"=SUM(A\" &amp; curr_start &amp; \":A\" &amp; i-1 &amp; \")\"\n    elseif left(wksh.range(\"A\"&amp;i).value, 4)=\"Corr\" then\n        curr_start = i + 1\n    endif\nnext i\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4709462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c95d77bb95b0bfd8eae86220026ffd3?s=128&d=identicon&r=PG&f=1", "display_name": "Will Conley", "link": "https://stackoverflow.com/users/4709462/will-conley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 458, "favorite_count": 0, "accepted_answer_id": 29264703, "answer_count": 1, "score": -1, "last_activity_date": 1427311348, "creation_date": 1427308588, "last_edit_date": 1427308601, "question_id": 29263803, "link": "https://stackoverflow.com/questions/29263803/excel-2013-looking-for-a-macro-to-write-a-sum-for-variable-length-sections", "title": "Excel 2013 - Looking for a macro to write a sum for variable length sections", "body": "<p>I'm trying to find a macro that will write a sum formula for a variable number of rows.  </p>\n\n<p>I have a bunch of sections on a fairly extensive sheet.  Each section has a column of costs, and each needs a sum at the end.  However, the sections are variable in length, so I can't just write one sum and copy/paste it to each section.</p>\n\n<p>Sections are stacked like this:</p>\n\n<p>Section Headers</p>\n\n<ul>\n<li>1  Data  $</li>\n<li>2  Data $</li>\n<li><p>3  Data $</p>\n\n<p>Sum?</p></li>\n</ul>\n\n<p>Section Headers</p>\n\n<ul>\n<li>1  Data $</li>\n<li>2  Data $</li>\n<li>3  Data $</li>\n<li>4  Data $ </li>\n<li>5  Data $</li>\n<li>6  Data $</li>\n<li><p>7  Data $</p>\n\n<p>Sum?</p></li>\n</ul>\n\n<p>I have a few hundred of these to do, and I'd rather not manually write the sum formula each time.  The lower boundary of the range I need summed is always the same relative to the formula cell, but the upper boundary is a random number of rows higher.  Is there a way to have a macro auto detect how big the section is and make the sum only for that range?</p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1427310007, "post_id": 29263887, "comment_id": 46730454, "body": "I did this and the error went away, but the text box just displays &quot;Name?&quot; instead of the data I want. I will try the other solution you provided."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 2, "creation_date": 1427310218, "post_id": 29263887, "comment_id": 46730570, "body": "Here: <code>AdultVar=rs!Result</code> The recordset does not include a field named <i>Result</i>. Try <code>AdultVar=rs![# Vars].Value</code> instead."}], "tags": [], "owner": {"reputation": 818, "user_id": 263967, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/72dabf31888fb47264347770925fa42c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholai", "link": "https://stackoverflow.com/users/263967/nicholai"}, "is_accepted": false, "score": 2, "last_activity_date": 1427308819, "creation_date": 1427308819, "answer_id": 29263887, "question_id": 29263775, "link": "https://stackoverflow.com/questions/29263775/set-text-box-equal-to-query/29263887#29263887", "title": "Set Text Box equal to Query", "body": "<p>The double quotes for \"adult\" are throwing the error because you're closing and reopening a string without telling VB what to do with <code>adult\"))\")</code>. SQL needs single quotes anyway, so change it to 'adult' and the error will go away.</p>\n"}, {"comments": [{"owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1427310160, "post_id": 29264008, "comment_id": 46730546, "body": "So do I just enter this VBA within a function and then set the Control source of the text box I want equal to the above VBA or do I need to do more VBA?"}, {"owner": {"reputation": 818, "user_id": 263967, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/72dabf31888fb47264347770925fa42c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholai", "link": "https://stackoverflow.com/users/263967/nicholai"}, "reply_to_user": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1427311393, "post_id": 29264008, "comment_id": 46731266, "body": "Your function seems fine at first glance. Replace your <code>&quot;rs=&quot;</code> line with my snippet, and fix the issue that @HansUp mentioned, and that should do it."}, {"owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1427321693, "post_id": 29264008, "comment_id": 46736625, "body": "So I now have the above code plus the issue with AdultVar=rs...fixed but I&#39;m still getting &quot;#Name?&quot; for the textbox. Any ideas?"}, {"owner": {"reputation": 818, "user_id": 263967, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/72dabf31888fb47264347770925fa42c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholai", "link": "https://stackoverflow.com/users/263967/nicholai"}, "reply_to_user": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1427322016, "post_id": 29264008, "comment_id": 46736757, "body": "Add a breakpoint early in your function so you can follow it. Then load the form, hit F8 when the VBA window pops back up, and hover on the variable names. You can watch what happens at each step to help narrow down the issue."}], "tags": [], "owner": {"reputation": 818, "user_id": 263967, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/72dabf31888fb47264347770925fa42c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholai", "link": "https://stackoverflow.com/users/263967/nicholai"}, "is_accepted": false, "score": 1, "last_activity_date": 1427309196, "creation_date": 1427309196, "answer_id": 29264008, "question_id": 29263775, "link": "https://stackoverflow.com/questions/29263775/set-text-box-equal-to-query/29264008#29264008", "title": "Set Text Box equal to Query", "body": "<p>A second option is to build your string first, like so:</p>\n\n<pre><code>Dim strSQL AS String\n\nstrSQL = \"Select Count([name]) as [# Vars] from Masterdb where [year] = \" &amp; Me.NavigationSubform.year.value &amp; \" and [recipient] = \" &amp; Me.NavigationSubform.recipient.value &amp; \" and [group]='adult'\"\n\nSet rs=CurrentDb.OpenRecordset(strSQL)\n</code></pre>\n\n<p>If you're not familiar with using the Me keyword, do a bit of reading up as it will shorten your code and save you time.</p>\n"}], "owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1021, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1427321837, "creation_date": 1427308480, "last_edit_date": 1427321837, "question_id": 29263775, "link": "https://stackoverflow.com/questions/29263775/set-text-box-equal-to-query", "title": "Set Text Box equal to Query", "body": "<p>I have a query in an Access Db that counts the number of observations that meet a certain criteria as defined by two comboboxes. The query works fine, and I can get the result of the query to display and update live with the comboboxes using subforms, but the subforms are an extremely ugly way to represent a single number.</p>\n\n<p>I would like to use a textbox to display that single number from the query instead of a subreport. I've tried inputting the SQL of the query into the Control Source and the Default Value, but no success.</p>\n\n<p>After reading through the forum it appears I can write a function and then set my control source equal to that function. </p>\n\n<p>Here is my VBA:</p>\n\n<pre><code>Public Function AdultCount()\nDim rs As Recordset\nSet rs=CurrentDb.OpenRecordset(\"Select Count([name]) as [# Vars] from Masterdb where ((masterdb.year=[forms]![Masterform]![NavigationSubform].[form]![year]) and (masterdb.recipient=[forms]![Masterform]![NavigationSubform].[form]![recipient]) and (masterdb.group=\"adult\"))\")\n\nAdultVar=rs!Result\n\nrs.Close\n\nSet rs=Nothing\n\nEnd Function\n</code></pre>\n\n<p>I get \"compile error: Expected:list separator or )\"\nand it highlights \"adult\" at the end of my SQL query.</p>\n\n<p>I don't know why this isn't working. Does anyone know why I'm getting this error, and tell me if I'm even doing the right thing to get what I want?</p>\n\n<p>edit:</p>\n\n<p>I now have </p>\n\n<pre><code>Dim strSQL AS String\n\nstrSQL = \"Select Count([name]) as [# Vars] from Masterdb where [year] = \" &amp; Me.NavigationSubform.year.value &amp; \" and [recipient] = \" &amp; Me.NavigationSubform.recipient.value &amp; \" and [group]='adult'\"\n\nSet rs=CurrentDb.OpenRecordset(strSQL)\n\nAdultVar=rs![# Vars].Value\n\nrs.Close\n\nSet rs=Nothing\n\nEnd Function\n</code></pre>\n\n<p>But the textbox reads \"#Name?\"</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 1282755, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1c391d44a9848604ee924b6ed9725b13?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1282755/chris"}, "edited": false, "score": 0, "creation_date": 1427313131, "post_id": 29264781, "comment_id": 46732270, "body": "When I run it, it says, &quot;Run-error &#39;3464&#39;: Data type mismatch in criteria expression&quot;"}, {"owner": {"reputation": 185, "user_id": 1282755, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1c391d44a9848604ee924b6ed9725b13?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1282755/chris"}, "edited": false, "score": 0, "creation_date": 1427314255, "post_id": 29264781, "comment_id": 46732847, "body": "I figured out the run-time error, but I guess I should have mentioned the rest of what I&#39;m trying to do, because I&#39;m having a problem with that now. CB2 is supposed to update all the textboxes with the &#39;=&quot;[ID] = &quot; &amp; Str(Nz([Screen].[ActiveControl],0))&#39; macro. Whenever I change something on CB1, it doesn&#39;t update CB2 and CB2 stops updating everything else."}], "tags": [], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "is_accepted": false, "score": 0, "last_activity_date": 1427311611, "creation_date": 1427311611, "answer_id": 29264781, "question_id": 29263690, "link": "https://stackoverflow.com/questions/29263690/ms-access-combo-box-query/29264781#29264781", "title": "ms-Access combo box query", "body": "<p>Remove the criteria section.  Then, in the OnChange event of the dropdown, put this:</p>\n\n<pre><code>Me.RecordSource = \"SELECT * FROM MyTable WHERE MyFieldName = \" &amp; [Forms]![Form Name]![Combo Box] &amp; \"\"\n\nMe.Requery\n</code></pre>\n\n<p>Obviously, you need to change the name of the table and field, I just used generic names since I don't know what they are called in your database.</p>\n"}], "owner": {"reputation": 185, "user_id": 1282755, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1c391d44a9848604ee924b6ed9725b13?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1282755/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1427311611, "creation_date": 1427308209, "question_id": 29263690, "link": "https://stackoverflow.com/questions/29263690/ms-access-combo-box-query", "title": "ms-Access combo box query", "body": "<p>I have a form that I am trying to get to update based on a query. Under criteria I've put <code>[Forms]![Form Name]![Combo Box]</code>\nWhenever I choose a different option in the combo box, nothing updates. How do I make the for update?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 13, "user_id": 4713329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9c9bddb5e233532e46124050dd974a2?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Chocho", "link": "https://stackoverflow.com/users/4713329/karen-chocho"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1427308044, "post_id": 29262884, "comment_id": 46729205, "body": "When testing the button, I type in text in comment box, save and then type in text in the new comment box and click on the button.  The error message is: Compile Error: Syntax Error.  It highlights lines 11-14 red and yellow highlight on the first line (with &quot;Definition&quot; stating: Identifier under cursor is not recognized&quot;.  My new comment is not appended and nothing happens."}, {"owner": {"reputation": 13, "user_id": 4713329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9c9bddb5e233532e46124050dd974a2?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Chocho", "link": "https://stackoverflow.com/users/4713329/karen-chocho"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1427310358, "post_id": 29262884, "comment_id": 46730647, "body": "That may be what my error is, what is that and how do I set it?"}, {"owner": {"reputation": 13, "user_id": 4713329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9c9bddb5e233532e46124050dd974a2?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Chocho", "link": "https://stackoverflow.com/users/4713329/karen-chocho"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1427310600, "post_id": 29262884, "comment_id": 46730780, "body": "Sorry, as I said, VERY new to VBA.  What is &quot;Definition&quot; and how to I fix that if it is necessary?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4713329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9c9bddb5e233532e46124050dd974a2?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Chocho", "link": "https://stackoverflow.com/users/4713329/karen-chocho"}, "edited": false, "score": 0, "creation_date": 1427389682, "post_id": 29281509, "comment_id": 46766978, "body": "Thank you so much, this works.  And thank you for explaining it too, it helps me learn."}], "tags": [], "owner": {"reputation": 5315, "user_id": 3689364, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/1wGCo.jpg?s=128&g=1", "display_name": "EliteRaceElephant", "link": "https://stackoverflow.com/users/3689364/eliteraceelephant"}, "is_accepted": true, "score": 1, "last_activity_date": 1427381273, "creation_date": 1427381273, "answer_id": 29281509, "question_id": 29262884, "link": "https://stackoverflow.com/questions/29262884/how-to-create-a-comment-box-with-time-and-date-stamp-in-access-using-vba/29281509#29281509", "title": "How to create a comment box with time and date stamp in Access using VBA", "body": "<p>I have some suggestions for your code:</p>\n\n<p><strong>1.</strong> Do not check if a textbox is null but how many characters your textbox has. You should always do it that way because otherwise you tend to get errors.</p>\n\n<pre><code>If (len(Me.NewComment.Value &amp; \"\") &gt; 0) Then\n    MsgBox (\"Please provide a comment before clicking\" &amp; _\n        \"on the Append Comment button.\")\n    Exit Sub\n  End If\n</code></pre>\n\n<p>Here you check the length of the string in your textbox. You need to append \"\" because otherwise you tend to get null-errors or something similar.</p>\n\n<p><strong>2.</strong> You forgot to reference the objects in your form correctly. You have your form and in that form you put your textboxes and also your VBA-code. Your can reference all your objects with \"Me.[FormObjects]\".</p>\n\n<p>The compiler complains that \"NewComment.Value\" or \"ReviewerComment.Value\" is not initialized or in other words not dimensioned. With correct reference this should stop.</p>\n\n<pre><code>Private Sub cmdAppendComment_Click()\nIf (len(Me.NewComment.Value &amp; \"\") &gt; 0) Then\n    MsgBox (\"Please provide a comment before clicking\" &amp; _\n        \"on the Append Comment button.\")\n    Exit Sub\n  End If\n\n  If (IsNull(Me.ReviewerComments.Value)) Then\n    Me.ReviewerComments.Value = Me.NewComment.Value &amp; \" ~ \" &amp; _\n           VBA.DateTime.Date &amp; \" ~ \" &amp; VBA.DateTime.Time\n  Else\n    Me.ReviewerComments.Value = Me.ReviewerComments.Value &amp; _\n           vbNewLine &amp; vbNewLine &amp; _\n           Me.NewComment.Value &amp; \" ~ \" &amp; _\n           VBA.DateTime.Date &amp; \" ~ \" &amp; VBA.DateTime.Time\n  End If\n  Me.NewComment.Value = \"\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4713329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9c9bddb5e233532e46124050dd974a2?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Chocho", "link": "https://stackoverflow.com/users/4713329/karen-chocho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 29281509, "answer_count": 1, "score": 1, "last_activity_date": 1427381273, "creation_date": 1427305622, "question_id": 29262884, "link": "https://stackoverflow.com/questions/29262884/how-to-create-a-comment-box-with-time-and-date-stamp-in-access-using-vba", "title": "How to create a comment box with time and date stamp in Access using VBA", "body": "<p>Completely new to VBA and need help with detailed instructions (dummy version for me).</p>\n\n<p>I have a table with various columns and the following columns, specifically:</p>\n\n<p>ReviewerComments\nNewComment</p>\n\n<p>I created a form with both of these fields and need to create an Append Comment button that moves the text from NewComment field and appends it to ReviewerComment field and time/date stamps the comments as they are added.  I named this button cmdAppendComment.</p>\n\n<p>I had seen someone else post something and I tried, but as I am completely new to this I know I messed it up.  Any help is greatly appreciated.</p>\n\n<p>This is what the VBA code looks like right now:</p>\n\n<pre><code>Private Sub cmdAppendComment_Click()\nIf (IsNull(NewComment.Value)) Then\n    MsgBox (\"Please provide a comment before clicking\" &amp; _\n        \"on the Append Comment button.\")\n    Exit Sub\n  End If\n\n  If (IsNull(ReviewerComments.Value)) Then\n    ReviewerComments.Value = NewComment.Value &amp; \" ~ \" &amp; _\n           VBA.DateTime.Date &amp; \" ~ \" &amp; VBA.DateTime.Time\n  Else\n    ReviewerComments.Value = ReviewerComments.Value &amp; _\n           vbNewLine &amp; vbNewLine &amp; _\n           NewComment.Value &amp; \" ~ \" &amp; _\n           VBA.DateTime.Date &amp; \" ~ \" &amp; VBA.DateTime.Time\n  End If\n\n  NewComment.Value = \"\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1427305825, "post_id": 29262830, "comment_id": 46727755, "body": "<a href=\"http://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>"}, {"owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "edited": false, "score": 2, "creation_date": 1427310458, "post_id": 29262830, "comment_id": 46730692, "body": "Have you looked at the &quot;Subtotals&quot; feature of Excel? It does exactly what you want."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4713269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c96b2d7611a36c43c15b91ab8df2fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Judhajit", "link": "https://stackoverflow.com/users/4713269/judhajit"}, "edited": false, "score": 0, "creation_date": 1427371993, "post_id": 29262952, "comment_id": 46754264, "body": "Actually I have a huge data set, and I have to do this across many excel sheets."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 3, "user_id": 4713269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c96b2d7611a36c43c15b91ab8df2fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Judhajit", "link": "https://stackoverflow.com/users/4713269/judhajit"}, "edited": false, "score": 0, "creation_date": 1427372132, "post_id": 29262952, "comment_id": 46754359, "body": "Read the instructions on how to ask a good question, then come back &amp; update your original question post. We&#39;ll be happy to help you over specific hurdles, but you&#39;re not going to find many willing to just do your work for you."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 2, "last_activity_date": 1427305859, "creation_date": 1427305859, "answer_id": 29262952, "question_id": 29262830, "link": "https://stackoverflow.com/questions/29262830/conditional-sum-using-vba/29262952#29262952", "title": "Conditional Sum using VBA", "body": "<p>It sounds like a Pivot Table will do what you want and you won't need any custom VBA code at all.</p>\n"}], "owner": {"reputation": 3, "user_id": 4713269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c96b2d7611a36c43c15b91ab8df2fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Judhajit", "link": "https://stackoverflow.com/users/4713269/judhajit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1427305859, "creation_date": 1427305484, "question_id": 29262830, "link": "https://stackoverflow.com/questions/29262830/conditional-sum-using-vba", "title": "Conditional Sum using VBA", "body": "<p>I want a code in VBA, which will get me a sum for a category (which is displayed as a number), note that this number is changing and not in serial order, as soon as it changes, I want the sum for that particular sub-division. Example- say Towns is a category and Ward is sub category, so my data is displayed as following:<br>\nSo lets say the data says that town numbered 100 has 3 wards (1001, 1002, 1003) with their population data,and town numbered 123 has 2 wards (1231, 1232) with their total population data correspondingly, now I want to sum the total population in town 100 and similarly for town 123..and so on.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1427308240, "post_id": 29262402, "comment_id": 46729317, "body": "Are you saying the log is a different workbook or a different worksheet?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4713265, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100374173281087/picture?type=large", "display_name": "Edris Yousefi", "link": "https://stackoverflow.com/users/4713265/edris-yousefi"}, "edited": false, "score": 0, "creation_date": 1427312610, "post_id": 29263774, "comment_id": 46731984, "body": "Thanks for your help I used this but keep receiving a Error Opening File.. I am pretty unfamiliar with this specific portion of excel but heres what I changed from what you have above:"}, {"owner": {"reputation": 23, "user_id": 4713265, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100374173281087/picture?type=large", "display_name": "Edris Yousefi", "link": "https://stackoverflow.com/users/4713265/edris-yousefi"}, "edited": false, "score": 0, "creation_date": 1427312731, "post_id": 29263774, "comment_id": 46732036, "body": "Sub CopyLastRowToLog() Set wb = Workbooks.Open(&quot;C:\\Users\\EYousefi\\Desktop&#91;Daily Referral Log.xlsx]Sheet1&quot;) &#39;Edit This Line On Error GoTo 0   ThisWb.Sheets(&quot;Sheet5&quot;).Range(&quot;A&quot; &amp; Sheets(&quot;Sheet5&quot;).UsedRange.Rows.Count).EntireRow.copy _ wb.Sheets(&quot;Sheet1&quot;).Range(&quot;A&quot; &amp; Sheets(&quot;Sheet1&quot;).UsedRange.Rows.Count + 1)  wb.Close (True) Application.DisplayAlerts = True Application.EnableEvents = True Application.ScreenUpdating = True  End Sub"}, {"owner": {"reputation": 23, "user_id": 4713265, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100374173281087/picture?type=large", "display_name": "Edris Yousefi", "link": "https://stackoverflow.com/users/4713265/edris-yousefi"}, "edited": false, "score": 0, "creation_date": 1427312901, "post_id": 29263774, "comment_id": 46732129, "body": "One final proposition is that the row i am copying, I would only like a handful of the columns not the entirety is that possible? Thank you SO MUCH for your HELP. Its very appreciated. @user1274820"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 23, "user_id": 4713265, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100374173281087/picture?type=large", "display_name": "Edris Yousefi", "link": "https://stackoverflow.com/users/4713265/edris-yousefi"}, "edited": false, "score": 0, "creation_date": 1427313872, "post_id": 29263774, "comment_id": 46732641, "body": "I edited the original - sorry for the slow reply. Let me know what columns you want to copy and I can write additional code. Basically you can just enter the ranges you need and the ranges where you want to paste. I showed an example for B-D, but you can specify which range you want to copy and where you want to paste it on each line"}, {"owner": {"reputation": 23, "user_id": 4713265, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100374173281087/picture?type=large", "display_name": "Edris Yousefi", "link": "https://stackoverflow.com/users/4713265/edris-yousefi"}, "edited": false, "score": 1, "creation_date": 1427314915, "post_id": 29263774, "comment_id": 46733244, "body": "Works Perfectly!! The individual pieces one at a time is what I ended up using as the other wasn&#39;t showing any information. Thanks a million @user1274820"}, {"owner": {"reputation": 23, "user_id": 4713265, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100374173281087/picture?type=large", "display_name": "Edris Yousefi", "link": "https://stackoverflow.com/users/4713265/edris-yousefi"}, "edited": false, "score": 0, "creation_date": 1429303473, "post_id": 29263774, "comment_id": 47553620, "body": "This was working for and I haven&#39;t changed anything, and all of a sudden its not copying the information anymore. It is still running as before, and you see it opening and closing the log its pointed to, but its not actually copying the information from the rows over.  Any thoughts?"}, {"owner": {"reputation": 23, "user_id": 4713265, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100374173281087/picture?type=large", "display_name": "Edris Yousefi", "link": "https://stackoverflow.com/users/4713265/edris-yousefi"}, "edited": false, "score": 0, "creation_date": 1429304087, "post_id": 29263774, "comment_id": 47553940, "body": "I&#39;m not sure what part it could be, because its finding opening and closing the file fine, just the copying part is not happening @user1274820"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 23, "user_id": 4713265, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100374173281087/picture?type=large", "display_name": "Edris Yousefi", "link": "https://stackoverflow.com/users/4713265/edris-yousefi"}, "edited": false, "score": 0, "creation_date": 1429415875, "post_id": 29263774, "comment_id": 47585406, "body": "Excel&#39;s copy function uses the clipboard, so maybe you have another application opening that is inhibiting the use of it? You can try <code>wb.Sheets(&quot;Sheet1&quot;).Range(&quot;B&quot; &amp; FinalWBLR &amp; &quot;:D&quot; &amp; ThisWBLR).Value = ThisWb.Sheets(&quot;Sheet5&quot;).Range(&quot;B&quot; &amp; ThisWBLR &amp; &quot;:D&quot; &amp; ThisWBLR).Value</code> I&#39;m not 100%, but you may need to individually copy the values one at a time instead of doing it by value if you try it this way. A better alternative is making sure you are not blocking the clipboard IMO but there are workarounds if you can&#39;t use the copy function."}, {"owner": {"reputation": 23, "user_id": 4713265, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100374173281087/picture?type=large", "display_name": "Edris Yousefi", "link": "https://stackoverflow.com/users/4713265/edris-yousefi"}, "edited": false, "score": 0, "creation_date": 1429541849, "post_id": 29263774, "comment_id": 47634768, "body": "I didn&#39;t seem to find a way to use the line you provided above. I also checked my clipboard and its empty with it still not performing the function. have 5 lines after that are the same except with adjustments to which cells are being copied, but below is the code I have: <code>ThisWBLR = ThisWb.Sheets(&quot;Patient List&quot;).UsedRange.Rows.Count FinalWBLR = wb.Sheets(&quot;Sheet1&quot;).UsedRange.Rows.Count + 1  ThisWb.Sheets(&quot;Patient List&quot;).Range(&quot;B&quot; &amp; ThisWBLR).copy wb.Sheets(&quot;Sheet1&quot;).Range(&quot;A&quot; &amp; FinalWBLR)</code>   @user1274820"}], "tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": true, "score": 0, "last_activity_date": 1427313822, "last_edit_date": 1427313822, "creation_date": 1427308479, "answer_id": 29263774, "question_id": 29262402, "link": "https://stackoverflow.com/questions/29262402/excel-macro-for-updating-log/29263774#29263774", "title": "Excel Macro for Updating log", "body": "<p>Looks like you're trying to open the log workbook and paste the last row from a data file into it.</p>\n\n<p>I think this is what you're looking for.</p>\n\n<p>Please let me know if you need something else.</p>\n\n<blockquote>\n  <p>How to not have the log file open or activated at any point for this to happen when the Macro is run.</p>\n</blockquote>\n\n<p>Regarding this line, I think I am understanding you right.</p>\n\n<p>You don't want to have to open it yourself manually; you want the code to do it.</p>\n\n<p>If that's not what you mean, please let me know (you will have to lock the file for write access to modify it regardless).</p>\n\n<pre><code>Sub CopyLastRowToLog()\n\nDim ThisWb, wb As Workbook\nSet ThisWb = ThisWorkbook\nApplication.EnableEvents = False\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\nOn Error Resume Next\nSet wb = Workbooks.Open(\"FileName and Path Goes Here\") 'Edit This Line\nOn Error GoTo 0\n\n'Basic Error Handling - Probably worth adding ReadOnly check but keeping code short\nIf wb Is Nothing Then\n    Application.DisplayAlerts = True\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n    MsgBox (\"Error Opening File\")\n    Exit Sub\nEnd If\n\n'Put the names of the sheets you're using below.\n'The first 2 sheets should be the sheet you're copying from\n'The second 2 sheets should be the sheet you're copying to\nThisWb.Sheets(\"Sheet1\").Range(\"A\" &amp; Sheets(\"Sheet1\").UsedRange.Rows.Count).EntireRow.Copy _\nwb.Sheets(\"Sheet1\").Range(\"A\" &amp; Sheets(\"Sheet1\").UsedRange.Rows.Count + 1)\n\nwb.Close (True)\nApplication.DisplayAlerts = True\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>To answer your first question, the file name looks weird:</p>\n\n<pre><code>Workbooks.Open(\"C:\\Users\\EYousefi\\Desktop[Daily Referral Log.xlsx]Sheet1\")\n</code></pre>\n\n<p>It should probably be:</p>\n\n<pre><code>Workbooks.Open(\"C:\\Users\\EYousefi\\Desktop\\Daily Referral Log.xlsx\")\n</code></pre>\n\n<p>You don't need to specify the sheet there.</p>\n\n<p>Secondly, to copy specific columns, you would want to change the copy line.\nI added 2 new variables to make it easier to read:</p>\n\n<pre><code>'Get the last rows for the workbooks\nDim ThisWBLR, FinalWBLR\n\nThisWBLR = ThisWB.Sheets(\"Sheet5\").UsedRange.Rows.Count\nFinalWBLR = wb.Sheets(\"Sheet1\").UsedRange.Rows.Count+1\n\nThisWb.Sheets(\"Sheet5\").Range(\"B\" &amp; ThisWBLR &amp; \":D\" &amp; ThisWBLR).Copy _\nwb.Sheets(\"Sheet1\").Range(\"B\" &amp; FinalWBLR)\n</code></pre>\n\n<p>You can also specify individual pieces of data one at a time if it is easier for you:</p>\n\n<pre><code>'Copy B to B\nThisWB.Sheets(\"Sheet5\").Range(\"B\" &amp; ThisWBLR).Copy wb.Sheets(\"Sheet1\").Range(\"B\" &amp; FinalWBLR)\n\n'Copy C to C\nThisWB.Sheets(\"Sheet5\").Range(\"C\" &amp; ThisWBLR).Copy wb.Sheets(\"Sheet1\").Range(\"C\" &amp; FinalWBLR)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4713265, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100374173281087/picture?type=large", "display_name": "Edris Yousefi", "link": "https://stackoverflow.com/users/4713265/edris-yousefi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 0, "accepted_answer_id": 29263774, "answer_count": 1, "score": 1, "last_activity_date": 1427313822, "creation_date": 1427304304, "last_edit_date": 1427307108, "question_id": 29262402, "link": "https://stackoverflow.com/questions/29262402/excel-macro-for-updating-log", "title": "Excel Macro for Updating log", "body": "<p>I am looking to create a macro where I take what I have in a master file that is constantly being updating on the last row and placing this into a separate log file. </p>\n\n<p>I would only like to copy specific cells from the last row of the original and paste them into the log file, i've gotten close I believe but need help with the following areas:</p>\n\n<ol>\n<li>Selection of the specific columns in the last row</li>\n<li>How to not have the log file open or activated at any point for this to happen when the Macro is run.</li>\n</ol>\n\n<p>I apologize if this question has been answered but I can't seem to curate all the information I am finding online to an applicable solution. Here is the macro I have thus far...</p>\n\n<pre><code>' copy2 Macro\n'\nRange(\"B5000\").End(xlUp).Select\nSelection.EntireRow.copy\nWindows(\"Daily Referral Log.xlsx\").Activate\nRange(\"A65536\").End(xlUp).Offset(1, 0).Select\nActiveSheet.Paste\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427303890, "post_id": 29262227, "comment_id": 46726451, "body": "<a href=\"http://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>"}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427356002, "post_id": 29262227, "comment_id": 46746126, "body": "As @FreeMan said. When you&#39;ll be updating your question, please provide us with this info : <b>1)</b> Are the workbooks in one folder? <b>2)</b> How did you approach the renaming before (what does not work)? <b>3)</b> What result you want to achieve? Addin-button, one-time-macro,...?"}], "answers": [{"tags": [], "owner": {"reputation": 619, "user_id": 2521902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06ad3a441473825a4250656cef99907e?s=128&d=identicon&r=PG", "display_name": "one angry researcher", "link": "https://stackoverflow.com/users/2521902/one-angry-researcher"}, "is_accepted": false, "score": 0, "last_activity_date": 1427304360, "creation_date": 1427304360, "answer_id": 29262425, "question_id": 29262227, "link": "https://stackoverflow.com/questions/29262227/rename-excel-worksheets-dynamiccaly-using-vba/29262425#29262425", "title": "RENAME Excel worksheets dynamiccaly using VBA", "body": "<p>This will rename a worksheet to have the same name as the workbook it is in:     </p>\n\n<pre><code>Worksheets(1).Name = ActiveWorkbook.Name\n</code></pre>\n\n<p>If there are several workbooks and you want to rename the first worksheet in each automatically, you could build a loop around this statement that opens each workbook and then runs the line of code above.</p>\n"}], "owner": {"reputation": 1, "user_id": 2941558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995b23976079a54477e7574d86d334f9?s=128&d=identicon&r=PG&f=1", "display_name": "Leena Ghoshal", "link": "https://stackoverflow.com/users/2941558/leena-ghoshal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 588, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427304360, "creation_date": 1427303814, "last_edit_date": 1531164843, "question_id": 29262227, "link": "https://stackoverflow.com/questions/29262227/rename-excel-worksheets-dynamiccaly-using-vba", "title": "RENAME Excel worksheets dynamiccaly using VBA", "body": "<p>I have about 50 workbooks each with two tabs. I want to rename the first worksheet with the same name that of the workbook name.\nI know how to to this when there is only one worksheet tab in the workbook.\nBut It does not work with multiple tabs.\nHow can I use VBA to dynamically rename worksheets that is same name as workbook name?</p>\n"}, {"tags": ["excel", "vba", "text", "send", "instant-messaging"], "comments": [{"owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "edited": false, "score": 1, "creation_date": 1427303598, "post_id": 29262039, "comment_id": 46726268, "body": "What instant messenger program/library is this? Ideally this should be tagged with the name of the program and answered with how to actually get the object."}, {"owner": {"reputation": 21, "user_id": 4713177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yyvGI.jpg?s=128&g=1", "display_name": "MC3000", "link": "https://stackoverflow.com/users/4713177/mc3000"}, "reply_to_user": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "edited": false, "score": 0, "creation_date": 1427304800, "post_id": 29262039, "comment_id": 46727053, "body": "I&#39;m trying to use Cisco Jabber messenger. I am referencing the CUCMESSENGER 1.0 Type Library where it lists the function available."}], "answers": [{"comments": [{"owner": {"reputation": 30124, "user_id": 334849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f39fc02c4a24b3c4825dae3d850004a?s=128&d=identicon&r=PG", "display_name": "LittleBobbyTables - Au Revoir", "link": "https://stackoverflow.com/users/334849/littlebobbytables-au-revoir"}, "edited": false, "score": 1, "creation_date": 1427303653, "post_id": 29262157, "comment_id": 46726308, "body": "I&#39;m out of votes for the day (otherwise I&#39;d +1 this), but that seems like the logical answer."}, {"owner": {"reputation": 30124, "user_id": 334849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f39fc02c4a24b3c4825dae3d850004a?s=128&d=identicon&r=PG", "display_name": "LittleBobbyTables - Au Revoir", "link": "https://stackoverflow.com/users/334849/littlebobbytables-au-revoir"}, "edited": false, "score": 0, "creation_date": 1427303718, "post_id": 29262157, "comment_id": 46726351, "body": "Yup, 30 as you see fit + 10 more for questions."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1427308633, "post_id": 29262157, "comment_id": 46729566, "body": "In VBA the declared variable is not &#39;initalized&#39; to &#39;None&#39; but rather to &#39;Nothing&#39;. To obtain instance is achieved with keywords Set and New, example: <code>Set msgr = New instantmessenger</code>"}, {"owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1427308960, "post_id": 29262157, "comment_id": 46729781, "body": "@dee sorry, I knew it was Nothing, but I forgot for some reason when answering this"}, {"owner": {"reputation": 21, "user_id": 4713177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yyvGI.jpg?s=128&g=1", "display_name": "MC3000", "link": "https://stackoverflow.com/users/4713177/mc3000"}, "edited": false, "score": 0, "creation_date": 1427313175, "post_id": 29262157, "comment_id": 46732290, "body": "Where can I find the documentation for the object library? I tried changing it to: set msgr= instant message (person@mail.com) and it still opens jabber window with the correct person then gives me an error."}, {"owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "reply_to_user": {"reputation": 21, "user_id": 4713177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yyvGI.jpg?s=128&g=1", "display_name": "MC3000", "link": "https://stackoverflow.com/users/4713177/mc3000"}, "edited": false, "score": 0, "creation_date": 1427374842, "post_id": 29262157, "comment_id": 46756043, "body": "@MC3000 is it the same error? What is your actual code? &quot;<code>set msgr= instant message (person@mail.com)</code>&quot; is not valid syntax."}, {"owner": {"reputation": 21, "user_id": 4713177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yyvGI.jpg?s=128&g=1", "display_name": "MC3000", "link": "https://stackoverflow.com/users/4713177/mc3000"}, "edited": false, "score": 0, "creation_date": 1427382918, "post_id": 29262157, "comment_id": 46762096, "body": "@Random832 I am using &quot;set msgr = Messenger.InstantMessege(person@email.con). It will still open a jabber chat window with the correct individual listed, but now I get &quot;Run-time error 91: Object variable or With block variable not set&quot;. I had this working with ms communicator but can&#39;t get it to work with Jabber. Any ideas?"}, {"owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "edited": false, "score": 0, "creation_date": 1427382991, "post_id": 29262157, "comment_id": 46762159, "body": "That is not valid syntax, and it&#39;s also spelled wrong. Please paste your actual code instead of retyping it.  Please paste the entire function of your code into the code block in your question. If it contains private information, change the code to a generic example and make sure the changed code still works before pasting it."}, {"owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "edited": false, "score": 0, "creation_date": 1427383100, "post_id": 29262157, "comment_id": 46762247, "body": "Also is there any documentation on this library available from the manufacturer of the IM program? Not having this information makes it very difficult to help you."}, {"owner": {"reputation": 21, "user_id": 4713177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yyvGI.jpg?s=128&g=1", "display_name": "MC3000", "link": "https://stackoverflow.com/users/4713177/mc3000"}, "edited": false, "score": 0, "creation_date": 1427383588, "post_id": 29262157, "comment_id": 46762613, "body": "I have looked for it on Ciscos website and on the folder where the dll file is located. Let me switch from my mobile to a pc to copy and paste the code."}], "tags": [], "owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "is_accepted": false, "score": 3, "last_activity_date": 1427308926, "last_edit_date": 1427308926, "creation_date": 1427303585, "answer_id": 29262157, "question_id": 29262039, "link": "https://stackoverflow.com/questions/29262039/using-vba-in-excel-to-send-instant-message/29262157#29262157", "title": "Using VBA in excel to send instant message", "body": "<p>You are not actually creating an instance of the instantmessengerconversationWndAdvanced class, just a variable (which is initialized to Nothing).</p>\n\n<p>Check the documentation of the object library you are using for how to obtain an instance of the class.</p>\n"}], "owner": {"reputation": 21, "user_id": 4713177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yyvGI.jpg?s=128&g=1", "display_name": "MC3000", "link": "https://stackoverflow.com/users/4713177/mc3000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1792, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1582732325, "creation_date": 1427303239, "last_edit_date": 1582732325, "question_id": 29262039, "link": "https://stackoverflow.com/questions/29262039/using-vba-in-excel-to-send-instant-message", "title": "Using VBA in excel to send instant message", "body": "<p>I keep getting an error while running this script:</p>\n\n<pre><code>Sub sendtext()\n\n    Dim msgr as instantmessengerconversationWndAdvanced\n    Dim Text as string\n\n    Text= range(\"a1\").value\n\n    Instantmessage (person@mail.com)\n    msgr.sendtext(Text)\n\nEnd Sub\n</code></pre>\n\n<p>It opens the chat window with the correct person listed, but I get an error when it gets to the text part:</p>\n\n<blockquote>\n  <p>Run-Time error '494': Object Required</p>\n</blockquote>\n\n<p>I checked the references and browsed the object library. I do see the <code>sendtext()</code> function listed and this has me confused. Am I missing something?Any help is appreciated. </p>\n"}, {"tags": ["excel", "vba", "while-loop", "excel-2007"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4667832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1425cc590002e8c3e5f1ccc3e1bc25e?s=128&d=identicon&r=PG&f=1", "display_name": "Crooks", "link": "https://stackoverflow.com/users/4667832/crooks"}, "edited": false, "score": 0, "creation_date": 1427460249, "post_id": 29262004, "comment_id": 46796547, "body": "Thank you very much. That solved the issue! I will absolutely check out that link. Trying to soak up as much knowledge as I can."}], "tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": false, "score": 1, "last_activity_date": 1427303140, "last_edit_date": 1495542134, "creation_date": 1427303140, "answer_id": 29262004, "question_id": 29261918, "link": "https://stackoverflow.com/questions/29261918/type-mismatch-arises-when-adding-a-basic-loop-in-vba/29262004#29262004", "title": "Type Mismatch arises when adding a basic loop in VBA", "body": "<p>Change </p>\n\n<pre><code>ElseIf MyCell = \"Busycon perversum\" Or \"Busycon sinistrum\" Then\n</code></pre>\n\n<p>to </p>\n\n<pre><code>ElseIf MyCell = \"Busycon perversum\" Or  MyCell = \"Busycon sinistrum\" Then\n</code></pre>\n\n<p>You need the full expression when using Or. </p>\n\n<p>Since you're new and using .Select this might be a good read for you when you have time:\n<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 4667832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1425cc590002e8c3e5f1ccc3e1bc25e?s=128&d=identicon&r=PG&f=1", "display_name": "Crooks", "link": "https://stackoverflow.com/users/4667832/crooks"}, "edited": false, "score": 0, "creation_date": 1427460686, "post_id": 29262102, "comment_id": 46796850, "body": "Thanks for the heads up about reserved words, I changed it just in case as well as fixing the Or expression and it seems to work now. Still getting my feet on the ground and am learning a lot from just this one snippet of code."}], "tags": [], "owner": {"reputation": 1210, "user_id": 1633618, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/df0aea3445c4e73c8ec6ac6d50d0c5d1?s=128&d=identicon&r=PG", "display_name": "Bmo", "link": "https://stackoverflow.com/users/1633618/bmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1427303414, "creation_date": 1427303414, "answer_id": 29262102, "question_id": 29261918, "link": "https://stackoverflow.com/questions/29261918/type-mismatch-arises-when-adding-a-basic-loop-in-vba/29262102#29262102", "title": "Type Mismatch arises when adding a basic loop in VBA", "body": "<p>@Sobigen's answer is a good one but if the looping is failing my hunch is <code>Count</code> is a reserved word. Change the variable <code>Count</code> to something else.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 4667832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1425cc590002e8c3e5f1ccc3e1bc25e?s=128&d=identicon&r=PG&f=1", "display_name": "Crooks", "link": "https://stackoverflow.com/users/4667832/crooks"}, "edited": false, "score": 0, "creation_date": 1427460440, "post_id": 29263735, "comment_id": 46796668, "body": "Thanks for the input! I&#39;m fairly new, I used a basic layout that I had seen on another script a co-worker wrote but I&#39;ll definitely be reading into select case usage. I&#39;m not quite sure what you mean by a Known loop, for testing purposes I used while &lt; 10 but once I get the kinks worked out i&#39;ll be using the special cells method to find the last used row in the Sheet since each sheet will have upwords of 30,000 entries."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 1, "user_id": 4667832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1425cc590002e8c3e5f1ccc3e1bc25e?s=128&d=identicon&r=PG&f=1", "display_name": "Crooks", "link": "https://stackoverflow.com/users/4667832/crooks"}, "edited": false, "score": 0, "creation_date": 1427460825, "post_id": 29263735, "comment_id": 46796927, "body": "Do While loop is most commonly used when you don&#39;t know (at design time) when the loop should terminate. A fixed start/end for the loop, like yours,  is usually done with a For/Next loop."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1427308378, "creation_date": 1427308378, "answer_id": 29263735, "question_id": 29261918, "link": "https://stackoverflow.com/questions/29261918/type-mismatch-arises-when-adding-a-basic-loop-in-vba/29263735#29263735", "title": "Type Mismatch arises when adding a basic loop in VBA", "body": "<p>Sobigen's answer should address the Mismatch error. Here is some help to clean up this code a bit. Whenever I have more than 2 or 3 conditions, I find <code>Select Case</code> to be preferable to <code>If/ElseIf/ElseIf</code>. Your mileage may vary, but I find it is easier to read and interpret, especially when you have <code>Or</code> conditions, the <code>Case</code> switch will allow multiple values.</p>\n\n<p>Also, since you have a <em>known</em> loop, there's no reason to use <code>Do While</code> instead of <code>For ... Next</code></p>\n\n<pre><code>Sub code_reassign()\nDim i As Integer\nDim MyCell As Range\n\nSet MyCell = ActiveCell\n\nFor i = 1 to 10\n    Select Case MyCell.Value\n        Case \"Busycotypus canaliculatus\"\n            MyCell.Offset(0, -1).Value = \"N106\"\n        Case \"Busycon carica\"\n            MyCell.Offset(0, -1).Value = \"N104\"\n        Case \"Busycon perversum\", \"Busycon sinistrum\" \n            MyCell.Offset(0, -1).Value = \"N103\"\n        Case \"Busycotypus spiratus\"\n            MyCell.Offset(0, -1).Value = \"N107\"\n    End Select\n\n    Set MyCell = MyCell.Offset(1, 0)\n\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4667832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1425cc590002e8c3e5f1ccc3e1bc25e?s=128&d=identicon&r=PG&f=1", "display_name": "Crooks", "link": "https://stackoverflow.com/users/4667832/crooks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 885, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1427308378, "creation_date": 1427302887, "last_edit_date": 1427304068, "question_id": 29261918, "link": "https://stackoverflow.com/questions/29261918/type-mismatch-arises-when-adding-a-basic-loop-in-vba", "title": "Type Mismatch arises when adding a basic loop in VBA", "body": "<p>I have a basic If ElseIf statement I'm trying to loop over a few hundred rows. The If/Else statement itself works until I try and Loop it (which I've included below). When I run it, it gives me a run time error \"13\" -type mismatch. I Initially set <code>MyCell</code> as a <code>String</code> until I had this error arise. Then I figured setting <code>MyCell</code> as a <code>Variant</code> I would be able to avoid this situation but it's still returning the RTE 13.  </p>\n\n<pre><code>Sub code_reassign()\nDim Count As Integer\nDim MyCell As Variant\n\nCount = 1\n\nDo While Count &lt; 10\n    MyCell = ActiveCell.Value\n\n    If MyCell = \"Busycotypus canaliculatus\" Then\n        ActiveCell.Offset(0, -1).Value = \"N106\"\n    ElseIf MyCell = \"Busycon carica\" Then\n        ActiveCell.Offset(0, -1).Value = \"N104\"\n    ElseIf MyCell = \"Busycon perversum\" Or \"Busycon sinistrum\" Then\n        ActiveCell.Offset(0, -1).Value = \"N103\"\n    ElseIf MyCell = \"Busycotypus spiratus\" Then\n        ActiveCell.Offset(0, -1).Value = \"N107\"\n    Else\n    End If\n\n    ActiveCell.Offset(1, 0).Select\n    Count = Count + 1\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>I'm still super new to VBA but have been thrown in the deep end at work. I'm doing what I can and studying the basics at home at nights to try and catch up.  Any insight as to why the loop is creating a problem with mismatching would be highly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 898, "user_id": 4425957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faea4ee63cb1f9c3e30d3faac96f978b?s=128&d=identicon&r=PG&f=1", "display_name": "Porcupine911", "link": "https://stackoverflow.com/users/4425957/porcupine911"}, "edited": false, "score": 0, "creation_date": 1427303005, "post_id": 29261824, "comment_id": 46725921, "body": "Have you tried <code>Range(&quot;A1&quot;).Hyperlinks.Item(1).Address</code> ?"}, {"owner": {"reputation": 125, "user_id": 1957538, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6512745c6cf60dc497138098b6a4604b?s=128&d=identicon&r=PG", "display_name": "AlpaxJ1", "link": "https://stackoverflow.com/users/1957538/alpaxj1"}, "reply_to_user": {"reputation": 898, "user_id": 4425957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faea4ee63cb1f9c3e30d3faac96f978b?s=128&d=identicon&r=PG&f=1", "display_name": "Porcupine911", "link": "https://stackoverflow.com/users/4425957/porcupine911"}, "edited": false, "score": 0, "creation_date": 1427303313, "post_id": 29261824, "comment_id": 46726101, "body": "Yes, i have tried that, the error message is &quot;Script out of range&quot;, still not pulling the URL."}, {"owner": {"reputation": 898, "user_id": 4425957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faea4ee63cb1f9c3e30d3faac96f978b?s=128&d=identicon&r=PG&f=1", "display_name": "Porcupine911", "link": "https://stackoverflow.com/users/4425957/porcupine911"}, "edited": false, "score": 0, "creation_date": 1427303547, "post_id": 29261824, "comment_id": 46726239, "body": "I see... Just tried it myself. I tried using the locals window to see what was going on and it shows 0 items even if i put a hyperlink in the cell. Hopefully someone with better relevant experience can chime in. Sorry, and good luck!"}, {"owner": {"reputation": 125, "user_id": 1957538, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6512745c6cf60dc497138098b6a4604b?s=128&d=identicon&r=PG", "display_name": "AlpaxJ1", "link": "https://stackoverflow.com/users/1957538/alpaxj1"}, "reply_to_user": {"reputation": 898, "user_id": 4425957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faea4ee63cb1f9c3e30d3faac96f978b?s=128&d=identicon&r=PG&f=1", "display_name": "Porcupine911", "link": "https://stackoverflow.com/users/4425957/porcupine911"}, "edited": false, "score": 0, "creation_date": 1427303610, "post_id": 29261824, "comment_id": 46726274, "body": "yes, hopefully. I&#39;ve been trying for hours. Not sure if its due to being external in a database that it cant access it. But it should once it pulls into the Excel sheet cell. thanks anyway for your support Porcupine911 :)"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1427304911, "post_id": 29261824, "comment_id": 46727125, "body": "What does <code>Range(&quot;A1&quot;).value</code> return?"}, {"owner": {"reputation": 125, "user_id": 1957538, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6512745c6cf60dc497138098b6a4604b?s=128&d=identicon&r=PG", "display_name": "AlpaxJ1", "link": "https://stackoverflow.com/users/1957538/alpaxj1"}, "edited": false, "score": 0, "creation_date": 1427444108, "post_id": 29261824, "comment_id": 46787580, "body": "I &quot;msgbox&quot;  &quot;Range(&quot;A1&quot;).value&quot; and comes up with blank."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1427447204, "post_id": 29261824, "comment_id": 46789041, "body": "<code>URL = Value1.Text</code> ?"}, {"owner": {"reputation": 125, "user_id": 1957538, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6512745c6cf60dc497138098b6a4604b?s=128&d=identicon&r=PG", "display_name": "AlpaxJ1", "link": "https://stackoverflow.com/users/1957538/alpaxj1"}, "edited": false, "score": 0, "creation_date": 1427465802, "post_id": 29261824, "comment_id": 46800104, "body": "That seems to work! - It retrieves the URL as text which is what i want. it seems that just &quot;value1&quot; provides the actual URL, which is weird. Surely Value1.value would return the text?  However, there is an issue, see my update."}], "answers": [{"tags": [], "owner": {"reputation": 1047, "user_id": 4669839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O9FCz.png?s=128&g=1", "display_name": "cybermike", "link": "https://stackoverflow.com/users/4669839/cybermike"}, "is_accepted": false, "score": 1, "last_activity_date": 1427313816, "last_edit_date": 1427313816, "creation_date": 1427312806, "answer_id": 29265119, "question_id": 29261824, "link": "https://stackoverflow.com/questions/29261824/getting-hyperlink-from-external-database/29265119#29265119", "title": "Getting Hyperlink from External Database", "body": "<p>So I think your fundamental problem is that in your function setting line, you need to put the URL in double quotes, so that line changes to:</p>\n\n<pre><code>Sheets(sheetname).Range(\"B\" &amp; cellRow &amp; \":B\" &amp; cellRow).Function = \"=HYPERLINK(\"\"\" &amp; URL &amp; \"\"\",\"\"View Change\"\")\"\n</code></pre>\n\n<p>Note the extra double-doublequotes around the URL variable.  The examples in the Microsoft help documentation clearly shows the URL needs be in quotes in the HYPERLINK function, and the setting of the cell abort without those quotes.</p>\n\n<p>Relative to the line you tagged [URL = Range(Value1.Address).Value] as not getting the URL.  We would need to see your source data if indeed that line also has a problem.  However, in my simple debug, I added <em>hyperlinks</em> into the source data cells (not a string of a URL), and your line-of-code above worked just fine putting the URL out of the hyperlink in the cell.</p>\n\n<p>Putting the \".SpecialCells(xlCellTypeVisible)\" redundantly in the \"For Each\" statement seems unnecessary since it is already a qualifier in the \"rng\" variable.  Works just fine for me without it, and I did hide some source data rows in my debug test just to make sure they were skipped.</p>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 1957538, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6512745c6cf60dc497138098b6a4604b?s=128&d=identicon&r=PG", "display_name": "AlpaxJ1", "link": "https://stackoverflow.com/users/1957538/alpaxj1"}, "edited": false, "score": 0, "creation_date": 1427449098, "post_id": 29296760, "comment_id": 46790124, "body": "I thanks for your input, as you rightly say, i can get the formula of the cell i.e. &quot;=HYPERLINK([@[CHANGE_LINK]])&quot;, however it cant be evaluated for some reason. I get Error 2015 when doing this: URL = Evaluate(Value1.Formula) , msgbox URL."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 0, "last_activity_date": 1427446912, "creation_date": 1427446912, "answer_id": 29296760, "question_id": 29261824, "link": "https://stackoverflow.com/questions/29261824/getting-hyperlink-from-external-database/29296760#29296760", "title": "Getting Hyperlink from External Database", "body": "<p>Your links are created by formulas.<br>\nSo you can retrieve them by using <code>Formula Property</code>.<br>\nNow if your <code>URL's</code> are always in the form of string with qoutations, you can try below</p>\n\n<pre><code>Dim r As Range, c As Range\nSet r = Sheets(\"SheetName\").Range(\"A1:A2000\").SpecialCell(xlCellTypeFormulas)\n\nFor Each c In r\n    Msgbox Split(c.Formula, \"\"\"\")(1)\nNext\n</code></pre>\n\n<p>This will return all your <code>URL's</code>. <br>\nHowever, if it is pointing a cell or outside reference you can try <code>Evaluate</code> like this:</p>\n\n<pre><code>Dim f As String, myurl As String\n\nFor Each c In r\n    f = c.Formula\n    myurl = Evaluate(Split(Mid(f, InStr(f, \"(\") + 1), \")\")(0))\n    MsgBox myurl\nNext\n</code></pre>\n\n<p>This works on formula like: <code>=HYPERLINK($B$1)</code> where <code>$B$1</code> contains the actual path.<br>\nIt will return the actual <code>URL</code> stored in cell reference.<bR>\nI cannot check if it will work with your case, but you can give it a try.</p>\n\n<p><strong>Additional:</strong></p>\n\n<p>Your formula omits the <code>[friendly_name]</code> argument, it should display the actual path on the cell.<br>\nIf so, you can retrieve the <code>URL</code> with <code>.Value</code> property.<br>\nAlthough you mentioned it in your post, are you certain this doesn't work?</p>\n"}], "owner": {"reputation": 125, "user_id": 1957538, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6512745c6cf60dc497138098b6a4604b?s=128&d=identicon&r=PG", "display_name": "AlpaxJ1", "link": "https://stackoverflow.com/users/1957538/alpaxj1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 29296760, "answer_count": 2, "score": 0, "last_activity_date": 1427465986, "creation_date": 1427302554, "last_edit_date": 1427465986, "question_id": 29261824, "link": "https://stackoverflow.com/questions/29261824/getting-hyperlink-from-external-database", "title": "Getting Hyperlink from External Database", "body": "<p>I am having issues with getting the value or URL of a hyperlink from an external source.</p>\n\n<p>I have a cell with the following formula:</p>\n\n<pre><code>=HYPERLINK([@[CHANGE_LINK]])\n</code></pre>\n\n<p>It gets the URL from an external data source and puts it into the cell.</p>\n\n<p>In my VBA sub i have the following:</p>\n\n<pre><code>Dim cellRow As Integer\nDim URL As String\nDim rng As Range\nSet rng = Sheets(changeSheet).Range(\"A1:A2000\").SpecialCells(xlCellTypeVisible)\ncellRow = 4\nFor Each Value1 In rng.SpecialCells(xlCellTypeVisible)\n    URL = Range(Value1.Address).Value '&lt;----CANT GET URL!\n    MsgBox URL\n    Sheets(sheetname).Range(\"B\" &amp; cellRow &amp; \":B\" &amp; cellRow).Value = \"=HYPERLINK(\" &amp; URL &amp; \",\"\"View Change\"\")\"\n    cellRow = cellRow + 1\nNext Value1\n</code></pre>\n\n<p>However, my question is. How do I get the URL of that formula into a VBA variable?</p>\n\n<p>I have tried multiple ways of doing this and none seem to get the URL:</p>\n\n<pre><code>Range(\"A1:A1\").value\nRange(\"A1:A1\").Address\nRange(\"A1:A1\").Formula\nRange(\"A1:A1\").Hyperlink(1)\nRange(\"A1:A1\").Hyperlink(1).Item(1)\nRange(\"A1:A1\").Hyperlinks\nRange(\"A1:A1\").Hyperlink.address\nRange(\"A1:A1\").Hyperlink.subaddress\n</code></pre>\n\n<p><strong>Update 27/03/2015</strong></p>\n\n<p>I use the follow code, which should work. However it doesnt retreive the text as a string. It doesnt seem to allow me to use it in the script...No idea why..</p>\n\n<pre><code>Dim row As Range\nDim cellRow As Integer\nDim URL As String\nDim rng As Range\n\nSet rng = Sheets(changeSheet).Range(\"B19:B2000\")\ncellRow = 4\nFor Each row In rng.SpecialCells(xlCellTypeVisible)\n    URL = row.Text &lt;--Application doesnt like the URL parsed into the statement below:\n    Sheets(sheetname).Range(\"B\" &amp; cellRow &amp; \":B\" &amp; cellRow).Value = \"=HYPERLINK(\" &amp; URL &amp; \",\"\"View Change\"\")\" &lt;---This is now the issue, ERROR 1004, Application or Object defined error....\n    cellRow = cellRow + 1\nNext row\n</code></pre>\n"}, {"tags": ["vba", "outlook", "ms-office", "outlook-addin", "ribbonx"], "answers": [{"comments": [{"owner": {"reputation": 1178, "user_id": 3595718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8b57b4d9ec401a3d876053badb8269bb?s=128&d=identicon&r=PG&f=1", "display_name": "ZerOne", "link": "https://stackoverflow.com/users/3595718/zerone"}, "edited": false, "score": 0, "creation_date": 1427377964, "post_id": 29279672, "comment_id": 46758290, "body": "Where do I have to put the function? And how do I get the current state of the button when the user save the appointment?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 1178, "user_id": 3595718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8b57b4d9ec401a3d876053badb8269bb?s=128&d=identicon&r=PG&f=1", "display_name": "ZerOne", "link": "https://stackoverflow.com/users/3595718/zerone"}, "edited": false, "score": 0, "creation_date": 1427387130, "post_id": 29279672, "comment_id": 46765343, "body": "Where did you define the getPressend callback?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 1178, "user_id": 3595718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8b57b4d9ec401a3d876053badb8269bb?s=128&d=identicon&r=PG&f=1", "display_name": "ZerOne", "link": "https://stackoverflow.com/users/3595718/zerone"}, "edited": false, "score": 0, "creation_date": 1427455228, "post_id": 29279672, "comment_id": 46793728, "body": "It should be - Sub GetPressed(control As IRibbonControl, ByRef returnValue)"}, {"owner": {"reputation": 1178, "user_id": 3595718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8b57b4d9ec401a3d876053badb8269bb?s=128&d=identicon&r=PG&f=1", "display_name": "ZerOne", "link": "https://stackoverflow.com/users/3595718/zerone"}, "edited": false, "score": 0, "creation_date": 1427459345, "post_id": 29279672, "comment_id": 46795991, "body": "and what do I have to write in the GetPressed function to get the state of the button when the user press &#39;save&#39;?"}, {"owner": {"reputation": 1178, "user_id": 3595718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8b57b4d9ec401a3d876053badb8269bb?s=128&d=identicon&r=PG&f=1", "display_name": "ZerOne", "link": "https://stackoverflow.com/users/3595718/zerone"}, "edited": false, "score": 0, "creation_date": 1427460820, "post_id": 29279672, "comment_id": 46796923, "body": "so for clarification: The save button is not my customized button.. When the user press the &#39;Save and Close&#39; button(applied by Outlook) then I want to get the state of my customized button"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 1178, "user_id": 3595718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8b57b4d9ec401a3d876053badb8269bb?s=128&d=identicon&r=PG&f=1", "display_name": "ZerOne", "link": "https://stackoverflow.com/users/3595718/zerone"}, "edited": false, "score": 0, "creation_date": 1427463373, "post_id": 29279672, "comment_id": 46798455, "body": "If the button belongs to your custom UI you should be aware of the current state. The GetPressed callback returns the value whether the button is in the pushed state or not. The second parameter passed to the GetPressed callback is the answer to the question. What value do you return to Office when it asks for the current state?"}, {"owner": {"reputation": 1178, "user_id": 3595718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8b57b4d9ec401a3d876053badb8269bb?s=128&d=identicon&r=PG&f=1", "display_name": "ZerOne", "link": "https://stackoverflow.com/users/3595718/zerone"}, "reply_to_user": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1427463630, "post_id": 29279672, "comment_id": 46798621, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/73939/discussion-between-zerone-and-eugene-astafiev\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 2, "last_activity_date": 1427463658, "last_edit_date": 1427463658, "creation_date": 1427376398, "answer_id": 29279672, "question_id": 29261709, "link": "https://stackoverflow.com/questions/29261709/get-customized-togglebutton-in-outlook-addin/29279672#29279672", "title": "Get customized togglebutton in outlook addin", "body": "<p>You need to call the GetPressed function declared in the custom UI markup as a callback for the toggleButton. It should look like the following one:</p>\n\n<pre><code>C#: bool GetPressed(IRibbonControl control)\nVBA: Sub GetPressed(control As IRibbonControl, ByRef returnValue)\nC++: HRESULT GetPressed([in] IRibbonControl *pControl, [out, retval]VARIANT_BOOL *pvarfPressed)\nVisual Basic: Function GetPressed(control As IRibbonControl) As Boolean\n</code></pre>\n\n<p>As you may see it returns a boolean value in which you are interested. If you don't use the parameter in the callback, just pass Nothing (null in C#).</p>\n\n<p>It seems you don't understand how Ribbon callbacks are designed and should be used. I'd recommend reading the following series of articles in MSDN:</p>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/aa338202%28v=office.12%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Customizing the 2007 Office Fluent Ribbon for Developers (Part 1 of 3)</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/aa338199(v=office.12).aspx\" rel=\"nofollow\">Customizing the 2007 Office Fluent Ribbon for Developers (Part 2 of 3)</a> </li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/aa722523(v=office.12).aspx\" rel=\"nofollow\">Customizing the 2007 Office Fluent Ribbon for Developers (Part 3 of 3)</a></li>\n</ul>\n\n<p>Also you may find the Globals.Ribbons property helpful, see <a href=\"https://msdn.microsoft.com/en-us/library/bb772088.aspx\" rel=\"nofollow\">Accessing the Ribbon at Run Time</a> for more information.</p>\n"}, {"comments": [{"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1427553294, "post_id": 29318323, "comment_id": 46828461, "body": "There is no need to retype the answer anew, moreover copying the idea of accessing the ribbon controls at runtime."}, {"owner": {"reputation": 307, "user_id": 2204063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KnXge.jpg?s=128&g=1", "display_name": "Sanjay Karia", "link": "https://stackoverflow.com/users/2204063/sanjay-karia"}, "reply_to_user": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1427606226, "post_id": 29318323, "comment_id": 46842249, "body": "&quot;copying the idea of accessing the ribbon controls at runtime&quot; can you please explain this ?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1427613145, "post_id": 29318323, "comment_id": 46843355, "body": "I had already described the Global.Ribbons property for accessing controls at runtime."}, {"owner": {"reputation": 1178, "user_id": 3595718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8b57b4d9ec401a3d876053badb8269bb?s=128&d=identicon&r=PG&f=1", "display_name": "ZerOne", "link": "https://stackoverflow.com/users/3595718/zerone"}, "edited": false, "score": 0, "creation_date": 1427708211, "post_id": 29318323, "comment_id": 46872284, "body": "Thanks to both of you! I now have access to my toggle button when the user press &#39;Save&#39;. The solution was to create the ribbon with the Visual Designer and not with Ribbon XML as Sanjay mentioned."}], "tags": [], "owner": {"reputation": 307, "user_id": 2204063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KnXge.jpg?s=128&g=1", "display_name": "Sanjay Karia", "link": "https://stackoverflow.com/users/2204063/sanjay-karia"}, "is_accepted": true, "score": 1, "last_activity_date": 1427553135, "last_edit_date": 1495541419, "creation_date": 1427553135, "answer_id": 29318323, "question_id": 29261709, "link": "https://stackoverflow.com/questions/29261709/get-customized-togglebutton-in-outlook-addin/29318323#29318323", "title": "Get customized togglebutton in outlook addin", "body": "<p>As I understand your basic need, you need to be able to check the state of the ToggleButton \"ImportToSalesforce\" when an Appointment is saved. I am not sure whether you are fine with using the Ribbon ( created from the Visual Designer ) instead of Ribbon XML ( which is more flexible and needs more programming as compared to the Visual Designer created Ribbon ) </p>\n\n<p>When you create the Ribbon using Visual Designer(with the needed Toggle Button) , you can easily access the ribbon object from anywhere inside the Addin, using the Ribbon collection.</p>\n\n<p>ThisRibbonCollection ribbons = Globals.Ribbons[Globals.ThisAddIn.Application.ActiveInspector()];\nribbons.SalesForceRibbon.toggleButton1.Checked  &lt;-- This is what you need ! </p>\n\n<p>In case you really need to use the Ribbon XML, instead of Ribbon Visual Designer, please refer -\n<a href=\"https://stackoverflow.com/questions/5780063/is-there-a-way-to-access-a-ribbon-xml-at-run-time\">Is there a way to access a Ribbon (XML) at run time?</a></p>\n"}], "owner": {"reputation": 1178, "user_id": 3595718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8b57b4d9ec401a3d876053badb8269bb?s=128&d=identicon&r=PG&f=1", "display_name": "ZerOne", "link": "https://stackoverflow.com/users/3595718/zerone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 0, "accepted_answer_id": 29318323, "answer_count": 2, "score": 1, "last_activity_date": 1592895916, "creation_date": 1427302236, "last_edit_date": 1592895916, "question_id": 29261709, "link": "https://stackoverflow.com/questions/29261709/get-customized-togglebutton-in-outlook-addin", "title": "Get customized togglebutton in outlook addin", "body": "<p>Hi I develop an addin for outlook where I want to add a new customized toggle button in the appointment tab. When I save the appointment I want to get the current state of the toggle button.\nThis is my code so far: </p>\n\n<p>So the button is already created, but when I press save, I can't get the button control.\n  Ribbon1.xml:</p>\n\n<pre><code>&lt;tab idMso=\"TabAppointment\"&gt;\n        &lt;group id=\"SalesforceGroup\" label=\"Salesforce\"&gt;\n          &lt;toggleButton id=\"ImportToSalesforce\" size=\"large\"\n            label=\"Import to Salesforce\" imageMso=\"DatabaseInsert\"\n            getPressed=\"GetPressed\"\n            onAction=\"Salesforce_Click\"  /&gt;\n        &lt;/group&gt;\n      &lt;/tab&gt;\n</code></pre>\n\n<p>Ribbon1.vb:</p>\n\n<pre><code>Public Sub GetPressed(ByVal control As Office.IRibbonControl)\n        MsgBox(\"test\")   ' This alert only pops up when the appointment window opens\n    End Sub\n\nPublic Sub Salesforce_Click(ByVal control As Office.IRibbonControl)\n    MsgBox(\"test\")    ' This alert never pops up\nEnd Sub\n</code></pre>\n\n<p>ThisAddIn.vb:</p>\n\n<pre><code>Private Sub inspectors_NewInspector(ByVal Inspector As Microsoft.Office.Interop.Outlook.Inspector) Handles inspectors.NewInspector\n    If TypeName(Inspector.CurrentItem) = \"AppointmentItem\" Then\n        MsgBox(\"event\")\n        oAppointmentItem = TryCast(Inspector.CurrentItem, Outlook.AppointmentItem)\n        AddHandler oAppointmentItem.Write, AddressOf Item_Save\n    End If\nEnd Sub\n\nPrivate Sub Item_Save(ByRef Cancel As Boolean)\n  'get IRibbonControl\nEnd Sub\n</code></pre>\n\n<p><strong>UPDATE:</strong>\nFixed the problem, that my onAction function never get called, because the parameter wasn't set right:\nRibbon1.vb:</p>\n\n<pre><code>Public Sub Salesforce_Click(ByVal control As Office.IRibbonControl, _\n    ByVal isPressed As Boolean)\n    MsgBox(\"test2\")\nEnd Sub\n</code></pre>\n\n<p>But the main question is: how to get the state of the toogle button when the user press save?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1427299937, "post_id": 29260744, "comment_id": 46723837, "body": "Stack Overflow is not a code writing service. What have you tried so far? And what <i>specific</i> problems are you having?"}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1427300028, "post_id": 29260744, "comment_id": 46723903, "body": "If you want to create a macro, show what you tried. Else it looks like you want someone to write that macro for you."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1427309716, "post_id": 29260744, "comment_id": 46730279, "body": "You may find <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> and <a href=\"http://stackoverflow.com/help\">stackoverflow.com/help</a> useful. Edit the question to add details. If it cannot be salvaged then consider deleting this question. As it stands now it can only gather downvotes which impacts your ability to ask questions. <a href=\"http://meta.stackoverflow.com/questions/258757/how-can-i-understand-why-am-i-receiving-a-warning-that-i-could-be-blocked\" title=\"how can i understand why am i receiving a warning that i could be blocked\">meta.stackoverflow.com/questions/258757/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1427375670, "creation_date": 1427375670, "answer_id": 29279395, "question_id": 29260744, "link": "https://stackoverflow.com/questions/29260744/how-to-check-details-before-sending-mails-in-outlook-using-macros/29279395#29279395", "title": "how to check details before sending mails in outlook using macros?", "body": "<p>It looks like you need to handle the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff865076(v=office.15).aspx\" rel=\"nofollow\">ItemSend</a> event of the Application class which is fired whenever an Microsoft Outlook item is sent, either by the user through an Inspector (before the inspector is closed, but after the user clicks the Send button) or when the Send method for an Outlook item, such as MailItem, is used in a program. Be aware, the Cancel parameter passed to the event handler allows to cancel the action. If the event procedure sets this argument to true, the send action is not completed and the inspector is left open.</p>\n\n<pre><code>Public WithEvents myOlApp As Outlook.Application  \nPublic Sub Initialize_handler()    \n   Set myOlApp = Outlook.Application  \nEnd Sub \n\nPrivate Sub myOlApp_ItemSend(ByVal Item As Object, Cancel As Boolean)  \n  Dim prompt As String  \n  prompt = \"Are you sure you want to send \" &amp; Item.Subject &amp; \"?\"  \n  If MsgBox(prompt, vbYesNo + vbQuestion, \"Sample\") = vbNo Then  \n    Cancel = True  \n  End If  \nEnd Sub\n</code></pre>\n\n<p>In the code you can check out whatever you need - the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff865652(v=office.15).aspx\" rel=\"nofollow\">Subject</a>, Body or HTMLBody values.</p>\n"}], "owner": {"reputation": 1, "user_id": 4712901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e8589a856b7653ea9b7d7cc68898a3?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya", "link": "https://stackoverflow.com/users/4712901/aditya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2001, "favorite_count": 0, "closed_date": 1515213466, "answer_count": 1, "score": -7, "last_activity_date": 1592699258, "creation_date": 1427299570, "last_edit_date": 1592699258, "question_id": 29260744, "link": "https://stackoverflow.com/questions/29260744/how-to-check-details-before-sending-mails-in-outlook-using-macros", "closed_reason": "Needs more focus", "title": "how to check details before sending mails in outlook using macros?", "body": "<p>I have to send mails to many different groups and sometimes I send to the wrong group.</p>\n\n<p>I want to create VBA code to check, the initial two letters of subject header and also whether the same two initial letters are present in the mail body, as I send the mail. If the escalation is correct then mail should be sent otherwise the code should display some error message.</p>\n"}, {"tags": ["vba", "loops", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427301934, "post_id": 29261529, "comment_id": 46725193, "body": "I had a laugh a bit. :D  Unbelievable, how synchronized our answers were."}, {"owner": {"reputation": 33, "user_id": 4712866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957a746a3bb27b153f2dbeba236e2a54?s=128&d=identicon&r=PG&f=1", "display_name": "William G.", "link": "https://stackoverflow.com/users/4712866/william-g"}, "edited": false, "score": 0, "creation_date": 1427303838, "post_id": 29261529, "comment_id": 46726427, "body": "@BranislavKoll&#225;r This is great however, the code found the data and moved the data to Column J. How can I break it down. For example:  I want the first instance of new results to have everything under it on Column J. Second instance and everything under Column K. Does this make sense?"}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1427304436, "post_id": 29261529, "comment_id": 46726800, "body": "I&#39;ve edited the code to fit your needs. It could also be done by finding last column again, with <code>...End(xlToLeft)</code>."}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1427304858, "post_id": 29261529, "comment_id": 46727090, "body": "Note, that the pasted columns will be next to each other. The first found range will be copied to column &quot;J&quot;, next found range will be copied to column &quot;K&quot;, etc. Even if some of the searched columns dont have the &quot;result&quot;."}], "tags": [], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "is_accepted": true, "score": 0, "last_activity_date": 1427304338, "last_edit_date": 1427304338, "creation_date": 1427301780, "answer_id": 29261529, "question_id": 29260701, "link": "https://stackoverflow.com/questions/29260701/loop-through-range-once-value-is-found-copy-cell-value-and-everything-under-an/29261529#29261529", "title": "Loop through range, once value is found, copy cell value and everything under and move to next column", "body": "<p>You dont have to loop through all the cells. Rather use the <code>Find() method</code>. It's more efficient I think.  </p>\n\n<pre><code>Sub Move_Data()\n\n    Dim rngFound As Range\n    Dim intColLoop As Integer\n    Dim LastColumn As Integer\n    Dim result As String 'added in edit, forgot that, oops\n    Dim intColPaste As Integer 'added in edit\n\n    result = \"New Results\"\n    LastColumn = ActiveSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n    With Cells\n        'in case the result is not on the ActiveSheet, exit code\n        If .Find(result) Is Nothing Then Exit Sub\n\n        '*****************Search all the columns, find result, copy ranges\n        'search all the columns\n        For intColLoop = 1 To LastColumn\n            With Columns(intColLoop)\n                'check if the result is in this column\n                If Not .Find(result) Is Nothing Then\n                    'find the result\n                    Set rngFound = .Find(result)\n                    'copy the found cell and continuous range beneath it to the destination column\n                    Range(rngFound, rngFound.End(xlDown)).Copy Destination:=Cells(Rows.Count, 10 + intColPaste).End(xlUp)  'Edit : changed the \"10\" to \"10 + intColPaste\"\n                    intColPaste = intColPaste + 1 'Edit : added counter for columns\n                End If\n            End With\n        Next intColLoop 'proceed to next column\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 4712866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957a746a3bb27b153f2dbeba236e2a54?s=128&d=identicon&r=PG&f=1", "display_name": "William G.", "link": "https://stackoverflow.com/users/4712866/william-g"}, "edited": false, "score": 0, "creation_date": 1427304016, "post_id": 29261537, "comment_id": 46726527, "body": "Thank you. I am getting a Argument Not Optional on this line:      rng.Range.Address"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 33, "user_id": 4712866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957a746a3bb27b153f2dbeba236e2a54?s=128&d=identicon&r=PG&f=1", "display_name": "William G.", "link": "https://stackoverflow.com/users/4712866/william-g"}, "edited": false, "score": 0, "creation_date": 1427304180, "post_id": 29261537, "comment_id": 46726627, "body": "In that case, I presume you&#39;re using the <code>While</code> loop. I&#39;ve fixed that line of code &amp; updated to show the <code>While</code> loop."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1427304142, "last_edit_date": 1427304142, "creation_date": 1427301801, "answer_id": 29261537, "question_id": 29260701, "link": "https://stackoverflow.com/questions/29260701/loop-through-range-once-value-is-found-copy-cell-value-and-everything-under-an/29261537#29261537", "title": "Loop through range, once value is found, copy cell value and everything under and move to next column", "body": "<p>Very well written for your first post, congrats!</p>\n\n<pre><code>Option Explicit\nSub Move_Data()\n\nDim SourceCol As integer\nDim DestCol As Integer\nDim LastRow As Long\n'Dim LastColumn As Long\nDim rng As Range\nDim result As String\nDim Addr as string\n\n  SourceCol = 1       'Column A\n  DestCol = 2         'Column B\n  result = \"New Results\"\n\n  LastRow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n  set rng = ActiveSheet.Range(cells.Address).Find (What:=Result, LookIn:=xlValues, _\n          LookAt:=xlWhole, MatchCase:=False)\n  While not rng is Nothing and Addr &lt;&gt; rng.Range.Address\n  'If not rng is Nothing\n    ActiveSheet.range(cells(rng.row, DestCol),cells(LastRow,DestCol) = _\n            ActiveSheet.range(cells(rng.row,SourceCol), cells(LastRow,SourceCol))\n  'End If\n    Addr = rng.range.address(ReferenceStyle:=xlR1C1)\n    set rng = ActiveSheet.Range(cells.Address).Find (What:=Result, LookIn:=xlValues, _\n          LookAt:=xlWhole, MatchCase:=False)\n  wend\n\nEnd Sub\n</code></pre>\n\n<p>Adjust <code>SourceCol</code> and <code>DestCol</code> as needed.</p>\n\n<p>That's untested and off the top of my head, so it might need a minor tweak. Use <code>.Find()</code> to find your text, then set your destination range = to what you just found.</p>\n\n<p>As written, it will find one occurrence of <code>result</code>. If you have multiple occurrences of <code>result</code>, comment out/delete the <code>If...</code> and 'End If` lines, then uncomment the 4 lines that are commented &amp; they'll loop through, finding them all.</p>\n"}], "owner": {"reputation": 33, "user_id": 4712866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957a746a3bb27b153f2dbeba236e2a54?s=128&d=identicon&r=PG&f=1", "display_name": "William G.", "link": "https://stackoverflow.com/users/4712866/william-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6445, "favorite_count": 1, "accepted_answer_id": 29261529, "answer_count": 2, "score": 3, "last_activity_date": 1427304725, "creation_date": 1427299422, "last_edit_date": 1427304725, "question_id": 29260701, "link": "https://stackoverflow.com/questions/29260701/loop-through-range-once-value-is-found-copy-cell-value-and-everything-under-an", "title": "Loop through range, once value is found, copy cell value and everything under and move to next column", "body": "<p>This is my first post. I've been trying to teach myself excel VBA and it has been quite challenging.</p>\n\n<p>Anyways I have been working on loops and ranges etc etc.</p>\n\n<p>Here's my dilemma:</p>\n\n<pre><code>Option Explicit\n\nSub Move_Data()\n\nDim i As Long\nDim j As Long\nDim LastRow As Long\nDim LastColumn As Long\nDim rng As Range\nDim result As String\n\nresult = \"New Results\"\n\nLastRow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\nLastColumn = ActiveSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n\nFor i = 3 To LastRow\nFor j = 1 To LastColumn\n\n\nIf Cells(i, 1) = result Then\n    j = j + 1\n    Cells(i, 1).Copy Destination:=ActiveSheet.Cells(i, j)\n\nEnd If\n\n\nNext j\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Little by little I have put the above together. Here's my question:</p>\n\n<p>I am trying to look at all the values in column \"A\". Once \"New Results\" is found I want to copy not only this cell, but everything underneath it, to a column \"J\". Then find the string in column \"B\" and copy the range to column \"K\", etc.</p>\n\n<p>So far the code finds \"New Results\" and moves it to column \"B\" which is expected since is the only code I have written. How can add another loop that will copy everything under \"New Results\" along with it and move it over to the new column. This way J will keep increasing and eventually I will have all the results broken down by columns. </p>\n\n<p>Hopefully this makes sense.</p>\n\n<p>Thanks all,</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 0, "last_activity_date": 1427300842, "creation_date": 1427300842, "answer_id": 29261197, "question_id": 29260564, "link": "https://stackoverflow.com/questions/29260564/access-vba-variables-dont-seem-to-clear-after-sub-routine-getting-procedure-de/29261197#29261197", "title": "Access VBA variables don&#39;t seem to clear after sub routine, getting procedure declaration does not match", "body": "<p><code>Cancel As Integer</code> is not supported for the <em>After Update</em> event.  Remove it from the declaration:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Private Sub QCSP154_AfterUpdate(Cancel As Integer)\nPrivate Sub QCSP154_AfterUpdate()\n</code></pre>\n\n<p>Avoid that problem in the future by letting Access start you off with a code stub for the event procedure.  Do that from the <em>Event</em> tab of the property sheet.  Find the event you want and click the 3-dot icon on the far right side of the adjoining input box.  </p>\n"}], "owner": {"reputation": 47, "user_id": 4712871, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-ZE5OrNmr2qU/AAAAAAAAAAI/AAAAAAAAADM/9RvTx6ENpZU/photo.jpg?sz=128", "display_name": "Tiffany V", "link": "https://stackoverflow.com/users/4712871/tiffany-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 29261197, "answer_count": 1, "score": 1, "last_activity_date": 1427300897, "creation_date": 1427299045, "last_edit_date": 1427300897, "question_id": 29260564, "link": "https://stackoverflow.com/questions/29260564/access-vba-variables-dont-seem-to-clear-after-sub-routine-getting-procedure-de", "title": "Access VBA variables don&#39;t seem to clear after sub routine, getting procedure declaration does not match", "body": "<p>I have a database that is used by a production team for performing reviews.  It contains a list of questions, and most questions require an exception be entered if the answer is 'No.'  They are currently updating these fields completely with comboboxes.  I am trying to program it so that after each answer, the portion of the exception that will always be the same based on that answer doesn't have to be updated.  I have started by declaring the variables (both within the sub routine as well as at the top as public variables).  My thought process was that every time they answer a question, the variables would be declared for that specific question and the pop-up form would fill based on those variables.  My code works as expected until I try to add the same code to a different question with the variables changed.  There are a few variables that would always be the same, but I am not concerned with cleaning that up just yet.  My code is below:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\nPublic LnNum As Long\nPublic PCID As Long\nPublic QCID As String\nPublic Cat As String\nPublic ExcDesc As String\n\nPrivate Sub QCSP15_AfterUpdate()\n\nLnNum = Me.Loan_Number.Value\nPCID = Me.PreCloseID.Value\nQCID = \"QCSP15\"\nCat = \"Preliminary Application\"\nExcDesc = \"The initial 1003 was not found in the file.\"\n\n    If Form_frmPreCloseAudit.QCSP15.Value = \"No\" Then\n        DoCmd.OpenForm \"frmTestExceptions\"\n        DoCmd.GoToRecord acDataForm, \"frmTestExceptions\", acNewRec\n        Form_frmTestExceptions.Loan_Number.Value = LnNum\n        Form_frmTestExceptions.PreClose_ID.Value = PCID\n        Form_frmTestExceptions.QCSPID = QCID\n        Form_frmTestExceptions.QCSP_Category.Value = Cat\n        Form_frmTestExceptions.Exception_Text.Value = ExcDesc\n    Else\n        DoCmd.GoToControl \"QCSP160\"\n    End If\n\nEnd Sub\n\nPrivate Sub QCSP154_AfterUpdate(Cancel As Integer)\n\nLnNum = Me.Loan_Number.Value\nPCID = Me.PreCloseID.Value\nQCID = \"QCSP154\"\nCat = \"Preliminary Application\"\nExcDesc = \"The DocuSign Certificate of Completion for the initial disclosure package was not uploaded to Doc V.\"      \n\n     If Form_frmPreCloseAudit.QCSP154.Value = \"No\" Then\n        DoCmd.OpenForm \"frmTestExceptions\"\n        DoCmd.GoToRecord acDataForm, \"frmTestExceptions\", acNewRec\n        Form_frmTestExceptions.Loan_Number.Value = LnNum\n        Form_frmTestExceptions.PreClose_ID.Value = PCID\n        Form_frmTestExceptions.QCSPID = QCID\n        Form_frmTestExceptions.QCSP_Category.Value = Cat\n        Form_frmTestExceptions.Exception_Text.Value = ExcDesc\n     Else\n        DoCmd.GoToControl \"QCSP161\"\n     End If\nEnd Sub\n</code></pre>\n\n<p>Once I add the second 'After Update' sub procedure for the next question, I get the procedure declaration does not match error.  I have tried naming the variables different things, but nothing seems to work and it might be beyond my ability to figure out as a novice.  </p>\n"}, {"tags": ["arrays", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 3450435, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0d672e25e46e6fc0df888e48bf90234f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul_S", "link": "https://stackoverflow.com/users/3450435/paul-s"}, "edited": false, "score": 0, "creation_date": 1427359477, "post_id": 29261677, "comment_id": 46747575, "body": "Having thought more on this, essentially I want a dialog box to be populated with each manufacturer located in col B. The user then selects which ones to filer on using check boxes. These are fed to the Materials array. The Qty array will consist of any non zero quantity for each row displayed"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 27, "user_id": 3450435, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0d672e25e46e6fc0df888e48bf90234f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul_S", "link": "https://stackoverflow.com/users/3450435/paul-s"}, "edited": false, "score": 0, "creation_date": 1427359718, "post_id": 29261677, "comment_id": 46747698, "body": "So, basically you are no longer interested in a solution to the problem you posted above?"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1427302156, "creation_date": 1427302156, "answer_id": 29261677, "question_id": 29260214, "link": "https://stackoverflow.com/questions/29260214/excel-2013-vba-user-populated-array-from-filtered-list/29261677#29261677", "title": "Excel 2013 VBA User Populated Array from Filtered List", "body": "<p>Either (1) you set the first filter and copy what you have to the new sheet (which you mentioned is working already) and then set the filter to something new and simply append the new result set to the end of the new sheet or (2) you \"save\" the result sets to an array in memory and then dump the arrays one after the other to the new sheet. The result is the same.</p>\n\n<p>So, it would seem to me that option 1 should be easy for you. Option 2 is as easy as option 1. Just dim a variant variable and assign it the range you wish you store in memory:</p>\n\n<pre><code>Dim vArray As Variant\n\nvArray = Sheets(\"Materials\").Range(\"A3:I524\")  'the range you wish to copy\n</code></pre>\n\n<p>Am I missing the point or is this what you need?</p>\n"}], "owner": {"reputation": 27, "user_id": 3450435, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0d672e25e46e6fc0df888e48bf90234f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul_S", "link": "https://stackoverflow.com/users/3450435/paul-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427302156, "creation_date": 1427298131, "last_edit_date": 1531161705, "question_id": 29260214, "link": "https://stackoverflow.com/questions/29260214/excel-2013-vba-user-populated-array-from-filtered-list", "title": "Excel 2013 VBA User Populated Array from Filtered List", "body": "<p>I have a VBA routine created (using Macro Record) to copy products and quantities to a new sheet using filtering on two columns. This works fine, but I would like to allow the user to select items and quantities from two filtered lists and add them to two arrays which are then copied to a new sheet.</p>\n\n<p>The Quantity Array could be simplified as it is just the quantities associated with the Manufacturer Array that are not equal to zero</p>\n\n<p>Code segment;</p>\n\n<pre><code>intCount = ActiveWorkbook.Sheets.Count\n\nSheets(\"Materials\").Select\nActiveSheet.Range(\"$A$3:$I$524\").AutoFilter Field:=2, Criteria1:=Array( _\n    \"Castel\", \"CEM\", \"Honeywell\", \"TYCO\"), Operator:=xlFilterValues\nActiveSheet.Range(\"$A$3:$I$524\").AutoFilter Field:=8, Criteria1:=Array( _\n    \"1.00\", \"10.00\", \"100.00\", \"2.00\", \"20.00\", \"24.00\", \"35.00\", \"4.00\", \"43.00\", \"5.00\", _\n    \"96.00\"), Operator:=xlFilterValues  \n</code></pre>\n\n<p>I would assume that each array element needs to defined as a variable and then passed to the array. I can't figure out how to present what to filter to the user. Create a user form and populate with the all the manufacturers? What is the most efficient method of achieving this? </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 223115, "user_id": 426671, "user_type": "moderator", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/zgBsf.jpg?s=128&g=1", "display_name": "Taryn", "link": "https://stackoverflow.com/users/426671/taryn"}, "edited": false, "score": 0, "creation_date": 1427378088, "post_id": 29260766, "comment_id": 46758379, "body": "Comments are not for extended discussion; this conversation has been <a href=\"http://chat.stackoverflow.com/rooms/73853/discussion-on-answer-by-random832-is-there-a-way-to-allign-a-form-button-to-a-ce\">moved to chat</a>."}, {"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1427380152, "post_id": 29260766, "comment_id": 46759957, "body": "thanks random I will try that - can it be 11 even for button number 2000 ?"}, {"owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "edited": false, "score": 0, "creation_date": 1427380246, "post_id": 29260766, "comment_id": 46760032, "body": "Yes this is why I used Mid - the parameter is the start of the number from the left."}, {"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1427380683, "post_id": 29260766, "comment_id": 46760340, "body": "do I ommit <code>Sheets(&quot;Sheet2&quot;).Range(&quot;AD&quot; &amp; CStr(i)).Value = 1</code> ? I seriously hate this problem - didnt want to have to say it"}, {"owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "edited": false, "score": 0, "creation_date": 1427380740, "post_id": 29260766, "comment_id": 46760393, "body": "I don&#39;t know what that line is or which function it is in, I&#39;ve never seen it before. There&#39;s no <code>i</code> variable in the offsetrelative function, and you&#39;re not setting any values in the Tester function, in the versions I have seen. You keep changing your code around."}, {"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1427380817, "post_id": 29260766, "comment_id": 46760457, "body": "im referencing AD not AE - I put dim mycell as range, dim my row as long . myrow = clng..... then what?"}, {"owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "edited": false, "score": 0, "creation_date": 1427380845, "post_id": 29260766, "comment_id": 46760477, "body": "...then the rest of the offsetrelative function is unchanged. You don&#39;t need mycell at all. How does this answer the issue that you asked me if you should omit a line that you have never shown me and I know nothing about. Also please continue this in the chat instead of here."}, {"owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "reply_to_user": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1427381235, "post_id": 29260766, "comment_id": 46760768, "body": "@Jonwhite What part don&#39;t you get?"}], "tags": [], "owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "is_accepted": false, "score": 1, "last_activity_date": 1427379590, "last_edit_date": 1427379590, "creation_date": 1427299631, "answer_id": 29260766, "question_id": 29260191, "link": "https://stackoverflow.com/questions/29260191/is-there-a-way-to-allign-a-form-button-to-a-cell-and-assign-another-sub-to-it/29260766#29260766", "title": "is there a way to allign a form button to a cell and assign another sub to it", "body": "<p>You seem to already know that <code>Buttons.Add()</code> returns the new button and can be stored in a variable and used wherever it's getting <code>Shapes(\"Button 24\")</code>, but I thought I should mention it for completeness.</p>\n\n<p>For doing a different action from each button, you can assign them all the same subroutine, and write a single subroutine that uses <code>ActiveSheet.Buttons(Application.Caller).TopLeftCell</code> to determine the cell that the button is in, and decides what to do based on the address of the cell.</p>\n\n<p>You can address cells relatively from the known cell with the <code>.Offset(x, y)</code> property or e.g. <code>.Row</code> instead of using <code>Sheet.Range</code>, to avoid having to dynamically calculate ranges, if every section the buttons are in is laid out the same way.</p>\n\n<pre><code>Sub offsetrelative()\n    Dim myCell as Range\n    Dim myRow as Long \n    myCell = ActiveSheet.Buttons(Application.Caller).TopLeftCell \n    myRow = myCell.Row - 2 ' D9 = 7\n    Application.ScreenUpdating = False\n    Sheets(\"sheet2\").Range(\"AE\" &amp; CStr(row)).Value = 1\n    Application.Wait (Now + 0.000001)\n    Sheets(\"sheet2\").Range(\"AE\" &amp; CStr(row)).Value = 0\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Another thing you could try is encoding the row number in the button name. So you can set <code>.Name = \"Button_Row\" &amp; CStr(i)</code> when you create the button, and then don't use <code>myCell</code> at all and use <code>myRow = CLng(Mid(Application.Caller, 11))</code> in the offsetrelative function. The 11 is the first character position of the number, it depends on the length of your prefix which was \"Button_Row\" [10 characters long] in this example.</p>\n"}, {"comments": [{"owner": {"reputation": 223115, "user_id": 426671, "user_type": "moderator", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/zgBsf.jpg?s=128&g=1", "display_name": "Taryn", "link": "https://stackoverflow.com/users/426671/taryn"}, "edited": false, "score": 0, "creation_date": 1427378118, "post_id": 29260800, "comment_id": 46758405, "body": "Comments are not for extended discussion; this conversation has been <a href=\"http://chat.stackoverflow.com/rooms/73854/discussion-on-answer-by-david-zemens-is-there-a-way-to-allign-a-form-button-to-a\">moved to chat</a>."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1427301463, "last_edit_date": 1427301463, "creation_date": 1427299729, "answer_id": 29260800, "question_id": 29260191, "link": "https://stackoverflow.com/questions/29260191/is-there-a-way-to-allign-a-form-button-to-a-cell-and-assign-another-sub-to-it/29260800#29260800", "title": "is there a way to allign a form button to a cell and assign another sub to it", "body": "<p>You're on the right track.  I'm going to use the first line from your recorded macro, and integrate with the <code>Tester</code> attempt you have made.  Then put it in a loop to create as many buttons as you want.</p>\n\n<pre><code>Sub Tester()\n    Dim btn as Object\n    Dim rng As Range\n    Dim i as Long\n    Dim lastRow As Long\n\n    lastRow = 100 'Modify as needed this will be the last possible row to add a button\n\n    For i = 3 to lastRow Step 4 \n        Set rng = ActiveSheet.Cells(i, 2)  'Column 2, row i\n\n        '## Create the button object and assign a variable to represent it\n        Set btn = ActiveSheet.Buttons.Add(1, 1, 1, 1)\n\n        '## use the btn variable to manipulate the button:\n        With btn\n            .Top = rng.Top\n            .Left = rng.Left\n            .Width = rng.Width\n            .Height = rng.RowHeight\n            .onAction = \"offsetRelative\"\n        End With\n    Next\nEnd Sub\n</code></pre>\n\n<p>I modify your <code>offsetRelative</code> function to use the <code>Application.Caller</code> to determine the cell/range where the button resides, and get the row number from that. Then, instead of hard-coding in the range like \"AE3\", we can combine the column \"AE\" with the row number:</p>\n\n<pre><code>Sub offsetrelative()\nDim rowNumber as Long\n'## Get the row number of the button:\nrowNumber = ActiveSheet.Shapes(Application.Caller).TopLeftCell.Row\n    Application.ScreenUpdating = False\n     Sheets(\"sheet2\").Range(\"AE\" &amp; Cstr(rowNumber)).Value = 1\n     Application.Wait (Now + 0.000001)\n     Sheets(\"sheet2\").Range(\"AE\" &amp; Cstr(rowNumber)).Value = 0\n     Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1427379590, "creation_date": 1427298105, "last_edit_date": 1427376957, "question_id": 29260191, "link": "https://stackoverflow.com/questions/29260191/is-there-a-way-to-allign-a-form-button-to-a-cell-and-assign-another-sub-to-it", "title": "is there a way to allign a form button to a cell and assign another sub to it", "body": "<p>Question has been solved how to make multiple buttons reference different adjacent offset cells </p>\n\n<p>Sub Tester()\n    Dim btn As Object\n    Dim rng As Range\n    Dim i As Long\n    Dim lastRow As Long</p>\n\n<pre><code>lastRow = 99999 'Modify as needed this will be the last possible row to add a button\n\nFor i = 2 To lastRow Step 4\n    Set rng = ActiveSheet.Cells(i, 21)  'Column 2, row i\n\n    '## Create the button object and assign a variable to represent it\n    Set btn = ActiveSheet.Buttons.Add(1, 1, 1, 1)\n\n    '## use the btn variable to manipulate the button:\n    With btn\n        .Top = rng.Top\n        .Left = rng.Left\n        .width = rng.width\n        .height = rng.RowHeight\n        .OnAction = \"offsetRelative\"\n        .Caption = \"Close\"\n    End With\nNext\nEnd Sub\n\nSub offsetrelative()\nDim rowNumber As Long\n'## Get the row number of the button:\nrowNumber = ActiveSheet.Shapes(Application.Caller).TopLeftCell.Row\nApplication.ScreenUpdating = False\n Sheets(\"Sheet6\").Range(\"AD\" &amp; CStr(rowNumber)).Value = 1\n\n Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p><strong>the above solution works great but is a little slow to calculate whenever I click a button. I need it to be instant but it hangs for 5 seconds...is there any way to avoid this?</strong></p>\n"}, {"tags": ["arrays", "vba", "formula"], "answers": [{"tags": [], "owner": {"reputation": 414, "user_id": 3750262, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/903190092/picture?type=large", "display_name": "Greg", "link": "https://stackoverflow.com/users/3750262/greg"}, "is_accepted": false, "score": 0, "last_activity_date": 1427298239, "creation_date": 1427298239, "answer_id": 29260253, "question_id": 29259921, "link": "https://stackoverflow.com/questions/29259921/cannot-run-formulaarray-however-the-code-works-as-a-regular-formula/29260253#29260253", "title": "Cannot run .FormulaArray, however the code works as a regular formula", "body": "<p>FormulaArray property has a character limit of 255.\nThe length of your formula is 310.\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff837104.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff837104.aspx</a></p>\n"}], "owner": {"reputation": 15, "user_id": 4600659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/741f5d8a1c332e43738a1b9eed9e668a?s=128&d=identicon&r=PG&f=1", "display_name": "Philip", "link": "https://stackoverflow.com/users/4600659/philip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427298239, "creation_date": 1427297400, "question_id": 29259921, "link": "https://stackoverflow.com/questions/29259921/cannot-run-formulaarray-however-the-code-works-as-a-regular-formula", "title": "Cannot run .FormulaArray, however the code works as a regular formula", "body": "<p>I have a VBA code that creates an array formula, however currently it creates a run-time error '1004' (Unable to set the FormulaArray propert of the Range class) when I run the script. I've included the working excel formula below as well.</p>\n\n<p>The odd thing is that the formula works if I use a simple .FormulaR1C1 syntax in the code the script runs fine. Once the formula is in the excel spreadsheet and I open the formula and click \"CTRL+SHIFT+ENTER\" it works just fine. \nThe code is below, I'm guessing the IF statements in the formula is the cause of the error. </p>\n\n<p>Can any of you see that I'm doing wrong?</p>\n\n<p>Thank you! :)</p>\n\n<pre><code>Set rng53 = Worksheets(\"Settings\").Range(\"N42\")\nrng53.Offset(r1).FormulaArray = \"=IFERROR(IF(Settings!R39C7=Admin!R7C17,INDEX(Dimensions!R5C18:R4171C18,MATCH(RC7&amp;RC9,Dimensions!R5C6:R4171C6&amp;Dimensions!R5C12:R4171C12,0)),IF(Settings!R39C7=Admin!R8C17,INDEX(Dimensions!R5C18:R4171C18,MATCH(RC7&amp;RC11&amp;RC13,Dimensions!R5C6:R4171C6&amp;Dimensions!R5C15:R4171C15&amp;Dimensions!R5C17:R4171C17,0)),\"\"Error\"\")),\"\"N/A\"\")\"\n\nWorking Excel formula:\n{=IFERROR(IF(Settings!$G$39=Admin!$Q$7,INDEX(Dimensions!$R$5:$R$4171,MATCH($G42&amp;$I42,Dimensions!$F$5:$F$4171&amp;Dimensions!$L$5:$L$4171,0)),IF(Settings!$G$39=Admin!$Q$8,INDEX(Dimensions!$R$5:$R$4171,MATCH($G42&amp;$K42&amp;$M42,Dimensions!$F$5:$F$4171&amp;Dimensions!$O$5:$O$4171&amp;Dimensions!$Q$5:$Q$4171,0)),\"Error\")),\"N/A\")}\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1838, "user_id": 2061621, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aa54f8ffbec0de165b1f053260f09665?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/2061621/kai"}, "edited": false, "score": 0, "creation_date": 1427297084, "post_id": 29259674, "comment_id": 46721803, "body": "Already tried: Closing/reopeing the database doesn&#39;t fix it, neither does Compact &amp; Repair or decompiling."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1427298149, "post_id": 29259674, "comment_id": 46722555, "body": "Does the form use a query as its Record Source?  If so, does that query still reference a field named <i>Format</i>?"}, {"owner": {"reputation": 1838, "user_id": 2061621, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aa54f8ffbec0de165b1f053260f09665?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/2061621/kai"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1427298256, "post_id": 29259674, "comment_id": 46722630, "body": "No, it&#39;s bound straight to the table. I idiot-checked all of those kind of things before posting (there&#39;s nothing on the form called Format - no controls, variables or anything) :)"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1427298434, "post_id": 29259674, "comment_id": 46722776, "body": "This sounds weird ... as if Access still remembers the field which no longer exists in the table.  As a long shot, I would save a copy of the revised table under a different name.  Then if you change the form&#39;s Record Source to that table copy, does it still think there is a field named <i>Format</i>?"}, {"owner": {"reputation": 1838, "user_id": 2061621, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aa54f8ffbec0de165b1f053260f09665?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/2061621/kai"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1427299065, "post_id": 29259674, "comment_id": 46723240, "body": "@HansUp Aha, think you&#39;ve cracked it. Changing the record source to a copy of the table removed the errant Format property. And changing it back didn&#39;t make it reappear. Post that as an answer and I&#39;ll accept it :)"}, {"owner": {"reputation": 1838, "user_id": 2061621, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aa54f8ffbec0de165b1f053260f09665?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/2061621/kai"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1427299168, "post_id": 29259674, "comment_id": 46723311, "body": "(worth noting a copy of the table isn&#39;t necessary - changing the record source of the form to any other table and changing back, or just removing it and putting it back in, fixes it)"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1427299347, "post_id": 29259674, "comment_id": 46723433, "body": "Fair enough.  I wanted to keep the other fields the same, just to avoid any other complications.  But apparently that wasn&#39;t necessary.  Meanwhile I still don&#39;t understand why the problem happened it in the first place; it just seems bizarre.  By the way, are you Kai the blues guy who worked for a Colorado auto hauler?"}, {"owner": {"reputation": 1838, "user_id": 2061621, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aa54f8ffbec0de165b1f053260f09665?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/2061621/kai"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1427299967, "post_id": 29259674, "comment_id": 46723860, "body": "Yeah, it was a bizarre problem. VBA does like to hang on to things sometimes. And nope, that&#39;s not me. I&#39;m in the UK, and I don&#39;t think anyone who knows me would let me get behind the wheel of a truck :)"}], "answers": [{"comments": [{"owner": {"reputation": 1838, "user_id": 2061621, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aa54f8ffbec0de165b1f053260f09665?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/2061621/kai"}, "edited": false, "score": 0, "creation_date": 1427297570, "post_id": 29259920, "comment_id": 46722168, "body": "This is a nice solution to my core problem (just discovered myself but using <code>Strings.Format</code> instead of <code>VBA.Format</code>), upvoted but going to wait to see if there&#39;s an answer to the question regarding &#39;rebuilding&#39; the field list before accepting :)"}], "tags": [], "owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "is_accepted": false, "score": 2, "last_activity_date": 1427297400, "creation_date": 1427297400, "answer_id": 29259920, "question_id": 29259674, "link": "https://stackoverflow.com/questions/29259674/refresh-access-bound-form-internal-field-list/29259920#29259920", "title": "Refresh Access bound form internal field list", "body": "<p>You can sidestep the namespace collision problem by fully qualifying the VBA <code>Format</code> function, like this:</p>\n\n<pre><code>VBA.Format(#17 March 2015#, \"dd MMM yyyy\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1838, "user_id": 2061621, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aa54f8ffbec0de165b1f053260f09665?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/2061621/kai"}, "edited": false, "score": 1, "creation_date": 1427299730, "post_id": 29260648, "comment_id": 46723688, "body": "Yeah, copying the table isn&#39;t necessary (and probably undesirable if it&#39;s a big table). Changing it to some other table will make all the references break, but they&#39;ll be fixed again once you change it back."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 1838, "user_id": 2061621, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aa54f8ffbec0de165b1f053260f09665?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/2061621/kai"}, "edited": false, "score": 1, "creation_date": 1427299908, "post_id": 29260648, "comment_id": 46723818, "body": "For a large table, I would paste the copy as structure only.  But since it doesn&#39;t even have to be the same table structure anyway, I guess that&#39;s a moot point.  :-)"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1427299264, "creation_date": 1427299264, "answer_id": 29260648, "question_id": 29259674, "link": "https://stackoverflow.com/questions/29259674/refresh-access-bound-form-internal-field-list/29260648#29260648", "title": "Refresh Access bound form internal field list", "body": "<p>See if you can make Access \"forget\" about the field which no longer exists.</p>\n\n<p>Save a copy of your current table with a new name.  Then use that new name in the form's Record Source.</p>\n\n<p>(<em>Note: Kai reported any old table change worked --- it doesn't require the same table structure.</em>)</p>\n\n<p>If Access no longer thinks there is a field named <em>Format</em>, change the Record Source again back to the old table name and see if it has still forgotten about the <em>Format</em> field.</p>\n"}], "owner": {"reputation": 1838, "user_id": 2061621, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/aa54f8ffbec0de165b1f053260f09665?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/2061621/kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 29260648, "answer_count": 2, "score": 2, "last_activity_date": 1427299264, "creation_date": 1427296791, "question_id": 29259674, "link": "https://stackoverflow.com/questions/29259674/refresh-access-bound-form-internal-field-list", "title": "Refresh Access bound form internal field list", "body": "<p>A little background first: I have a form in Access bound to a table. I was fighting an annoying error earlier where all calls to the <code>Format(...)</code> function threw a <code>type mismatch</code> error, regardless of what it was given as arguments. More perplexing was that the error only occurred when the form was open - in the immediate window I could type:</p>\n\n<pre><code>? Format(#17 March 2015#, \"dd MMM yyyy\")\n</code></pre>\n\n<p>If the form was closed, firing this code would return the expected result. When it was open, it threw <code>type mismatch</code>. Confusing.</p>\n\n<p>I eventually tracked the issue down - a field in the table bound to the form was named <strong>Format</strong>, and this was <em>shadowing</em> the <code>Format()</code> function, so VBA was attempting to treat the table field as a function and erroring.</p>\n\n<p>I closed the form, went into the table design and renamed the Format column to RequestFormat, expecting the issue to spirit away. Unfortunately, VBA seems to have a thing for rigidly clinging on to things forever once defined, and still maintains an entry for the now non-existent table field that continues to shadow the <code>Format()</code> function. An entry, I might add, that also cannot be referenced as a table field either because any attempts to call it as such prompts Access to tell me that it can't find a field named <code>Format</code>. Because it doesn't exist.</p>\n\n<p>So, somehow I need to get Access to rebuild its internal list of fields for the bound form and get rid of the now-deceased Format field. Any ideas?</p>\n\n<p>To prove that I'm not crazy, here's the intellisense in the IDE when <code>Format</code> is entered on a brand new form bound to the same table:</p>\n\n<p><img src=\"https://i.stack.imgur.com/UzhQz.png\" alt=\"enter image description here\"></p>\n\n<p>And here it is on my original form, still showing the recently-deceased Format property that shouldn't still be there:</p>\n\n<p><img src=\"https://i.stack.imgur.com/NWZrw.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1835, "user_id": 2443476, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/7fafc67c892104145e8296b2242f4d43?s=128&d=identicon&r=PG", "display_name": "user2443476", "link": "https://stackoverflow.com/users/2443476/user2443476"}, "edited": false, "score": 0, "creation_date": 1427364385, "post_id": 29259318, "comment_id": 46750167, "body": "thanks, that&#39;s exactly what I was looking for, the looking parameter is perfect."}], "tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": true, "score": 4, "last_activity_date": 1427295863, "creation_date": 1427295863, "answer_id": 29259318, "question_id": 29259185, "link": "https://stackoverflow.com/questions/29259185/find-address-of-a-cell-containing-a-formula-using-text-value-in-the-cell/29259318#29259318", "title": "Find address of a cell containing a formula, using text value in the cell", "body": "<p>If you really think the formula is the problem you can add</p>\n\n<pre><code>lookin:=xlValues\n</code></pre>\n\n<p>as a parameter to your find function so that it reads:</p>\n\n<pre><code>findValue = Sheets(\"STOCKS\").Range(\"E:E\").Find(\"ok\", lookin:=xlValues).Row\n</code></pre>\n\n<p>You will also get this error if the value you're looking for isn't found.  You can check for this with this code.</p>\n\n<pre><code>Dim findValue As Long\nDim r As Range\n\nSet r = Sheets(\"STOCKS\").Range(\"E:E\").Find(\"ok\", LookIn:=xlValues)\n\nIf r Is Nothing Then\n    MsgBox \"Not found\"\n    findvalue = -1\nElse\n    findvalue = r.Row\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1835, "user_id": 2443476, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/7fafc67c892104145e8296b2242f4d43?s=128&d=identicon&r=PG", "display_name": "user2443476", "link": "https://stackoverflow.com/users/2443476/user2443476"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 29259318, "answer_count": 1, "score": 3, "last_activity_date": 1518384001, "creation_date": 1427295463, "last_edit_date": 1518384001, "question_id": 29259185, "link": "https://stackoverflow.com/questions/29259185/find-address-of-a-cell-containing-a-formula-using-text-value-in-the-cell", "title": "Find address of a cell containing a formula, using text value in the cell", "body": "<p>I am trying to find a cell line containing the word \"ok\", this is my code:</p>\n\n<pre><code>Dim findValue As Long\nfindValue = Sheets(\"STOCKS\").Range(\"E:E\").Find(\"ok\").Row\n</code></pre>\n\n<p>The problem is that the cell containing the word \"ok\", for example E5, is filled by a formula taking the value of another cell in another sheet. So I am getting the following error:</p>\n\n<blockquote>\n  <p>execution error 91 : object variable or bloc variable with not defined<br>\n  (I have translated the message from French to English.)</p>\n</blockquote>\n\n<p>I think it's because the cell contains the formula and not the real value.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1427293951, "post_id": 29258546, "comment_id": 46719460, "body": "Well the whole file is in excel (this is one worksheet, same operation would be done for every worksheet) and I have already done a lot of other macros there which are related to this issue. TBH I have no idea what a &quot;PivotTable&quot; is ^_^."}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "edited": false, "score": 0, "creation_date": 1427294556, "post_id": 29258546, "comment_id": 46719910, "body": "I would still do it using a PivotTable. I updated the post above with more details. Try to use VBA as little as possible as it is more prone to errors and not all users will be able/will now how to use the macros."}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "edited": false, "score": 0, "creation_date": 1427294579, "post_id": 29258546, "comment_id": 46719928, "body": "Thanks  Jean-Fran&#231;ois ;)."}, {"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1427294634, "post_id": 29258546, "comment_id": 46719954, "body": "I was already checking pivot tables on google meanwhile you responded... HOLY COW HOW COULD I LIVE WITHOUT THIS. The macros would be primarly used by me or by people with strict instructions... So I guess the next step is learning how to create pivot tables using macros (as there are like 2500 sheets of nearly identical files)."}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "edited": false, "score": 1, "creation_date": 1427295222, "post_id": 29258546, "comment_id": 46720406, "body": "If this involves 2500 worksheets then indeed it might make sense to use macros. I had no idea it would involve so many. Still you can still do it easily using PivotTables. Just use the record macro option in the Developer ribbon on 1 worksheet then adapt the generate sourcecode for the remaining worksheets. Refreshing all Pivots is easy: &quot;ActiveWorkbook.RefreshAll&quot;"}, {"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1427296070, "post_id": 29258546, "comment_id": 46721021, "body": "Thanks for all the help! You saved me quite a few hours =). I have actually never used record a macro option, so I will have a look into that too."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427296369, "post_id": 29258546, "comment_id": 46721258, "body": "Not sure I agree with &quot;Try to use VBA as little as possible as it is more prone to errors and not all users will be able/will now how to use the macros&quot;, but in this case, PivotTables are the way to go! Code will be critical for making 2500 of them..."}, {"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1427381444, "post_id": 29258546, "comment_id": 46760952, "body": "Thanks again for all help. I have finished the macros for this work today, and basically the way I did it is that I made first sheet of the workbook manually (Ie. names of columns, pivot tables etc) and then made macro to copy it into next 2000 sheets while also changing the pivot table selection values. Next I did macro to input the values into specific sheets and to refresh the pivot tables (annoying that they dont refresh on their own). Now I have another problem, but I have already posted the question about it and hopefully after I solve that, the whole file will be ready to go."}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "edited": false, "score": 0, "creation_date": 1427460081, "post_id": 29258546, "comment_id": 46796423, "body": "Hi emihir0, no problem! Glad it helped!"}], "tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": true, "score": 3, "last_activity_date": 1427294456, "last_edit_date": 1427294456, "creation_date": 1427293859, "answer_id": 29258546, "question_id": 29258427, "link": "https://stackoverflow.com/questions/29258427/trouble-with-adding-up-cells-in-second-column-if-the-first-ones-are-identical-in/29258546#29258546", "title": "Trouble with adding up cells in second column if the first ones are identical in double dimensional array", "body": "<p>Why do it in VBA?</p>\n\n<p><strong>Create a PivotTable:</strong></p>\n\n<ul>\n<li>Add Work to ROWS</li>\n<li>Add Pairs to VALUES</li>\n</ul>\n\n<p>and voil\u00e0!</p>\n\n<p><strong>How to create a Pivot Table</strong></p>\n\n<p>Go to Insert->PivotTable. Proceed as mentioned above in the PivotTable fields panel.</p>\n\n<p>Read more here:\n<a href=\"https://support.office.com/en-sg/article/Overview-of-PivotTable-and-PivotChart-reports-00a5bf71-65cb-49f9-b321-85bb7b0b06c2\" rel=\"nofollow\">https://support.office.com/en-sg/article/Overview-of-PivotTable-and-PivotChart-reports-00a5bf71-65cb-49f9-b321-85bb7b0b06c2</a></p>\n"}], "owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 29258546, "answer_count": 1, "score": 1, "last_activity_date": 1427296600, "creation_date": 1427293593, "last_edit_date": 1427296600, "question_id": 29258427, "link": "https://stackoverflow.com/questions/29258427/trouble-with-adding-up-cells-in-second-column-if-the-first-ones-are-identical-in", "title": "Trouble with adding up cells in second column if the first ones are identical in double dimensional array", "body": "<p>My excel file looks something like this:</p>\n\n<pre><code>Work    Pairs  Name\nstrobel 400 Katarina\nstrobel 200 Katarina\nstrobel 200 Katarina\nsekanie 400 Katarina\nsekanie 300 Katarina\nsekanie 300 Katarina\nsekanie 300 Katarina\nsekanie 200 Katarina\nsekanie 100 Katarina\n</code></pre>\n\n<p>Basically it lists an operation of what a person has done (Work), number of pairs done in such operation (Pairs) and person's name (Name).</p>\n\n<p>I have already put everything into array by looping twice:</p>\n\n<pre><code>        For j = 1 To strDataRange.Rows.Count\n            For k = 1 To 3\n                arr(j, k) = strDataRange(j, k)\n            Next k\n        Next j\n</code></pre>\n\n<p>strDataRange is Range of Cells(2,1) to Cells(lastrow,3). This array is working properly.</p>\n\n<p>What I need to do is if the operations in first column have same name, add the number of pairs done in such operation together and make a new list (or array) with this information, ie. final result would be</p>\n\n<pre><code>strobel 800 Katarina\nsekanie 1600 Katarina\n</code></pre>\n\n<p>I'm not exactly sure how to do this (very inexperienced with programming), and I would rather not waste 20 hours by trying things that wouldn't work even if I did them correctly.</p>\n\n<p>My idea would be something like:</p>\n\n<pre><code>    For m = 1 To UBound(arr, 1)\n        If arr(m, 1) = arr(m + 1, 1) Then\n           &lt;make new array where the pairs of first 2 matches add up&gt;\n           &lt;somehow make this new array iterate until there are no 2 identical matches&gt;\n    Next m\n</code></pre>\n\n<p>Thanks a lot, appreciate any help!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 4346787, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001881520042/picture?type=large", "display_name": "Konsume", "link": "https://stackoverflow.com/users/4346787/konsume"}, "edited": false, "score": 0, "creation_date": 1427295440, "post_id": 29259084, "comment_id": 46720545, "body": "If there is no match in Sheets(&quot;Parker List&quot;) then I need to continue on the next line on Sheets(&quot;Product&quot;)"}, {"owner": {"reputation": 147, "user_id": 3988010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9cdb3a4caef798373f1f32373b5d872b?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Hodges", "link": "https://stackoverflow.com/users/3988010/guy-hodges"}, "reply_to_user": {"reputation": 59, "user_id": 4346787, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001881520042/picture?type=large", "display_name": "Konsume", "link": "https://stackoverflow.com/users/4346787/konsume"}, "edited": false, "score": 1, "creation_date": 1427295570, "post_id": 29259084, "comment_id": 46720640, "body": "What do you mean that you need to continue on the next line? Do you mean that you take the values according to the product name on the next line?"}, {"owner": {"reputation": 59, "user_id": 4346787, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001881520042/picture?type=large", "display_name": "Konsume", "link": "https://stackoverflow.com/users/4346787/konsume"}, "edited": false, "score": 0, "creation_date": 1427295775, "post_id": 29259084, "comment_id": 46720802, "body": "I need to search value of my sheet and find the same value on the other sheet.  IF there is no EXACT MATCH on the 2nd sheet, than noting has to be updated.  If there is an EXACT MATCH, than I need to take the value of B and S of the 2nd sheet and put in respectively in the F and H column of the 1st sheet"}, {"owner": {"reputation": 147, "user_id": 3988010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9cdb3a4caef798373f1f32373b5d872b?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Hodges", "link": "https://stackoverflow.com/users/3988010/guy-hodges"}, "reply_to_user": {"reputation": 59, "user_id": 4346787, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001881520042/picture?type=large", "display_name": "Konsume", "link": "https://stackoverflow.com/users/4346787/konsume"}, "edited": false, "score": 1, "creation_date": 1427296129, "post_id": 29259084, "comment_id": 46721071, "body": "Are there a pre-existing values in columns F and H that you wouldn&#39;t want to lose if there is no exact match? or is it blank?"}, {"owner": {"reputation": 59, "user_id": 4346787, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001881520042/picture?type=large", "display_name": "Konsume", "link": "https://stackoverflow.com/users/4346787/konsume"}, "edited": false, "score": 0, "creation_date": 1427296394, "post_id": 29259084, "comment_id": 46721271, "body": "It&#39;s blank... basically I need to fill F and H only if there is an EXACT match on A on both sheets but... A6048 could match with A10385 on the other sheet"}, {"owner": {"reputation": 147, "user_id": 3988010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9cdb3a4caef798373f1f32373b5d872b?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Hodges", "link": "https://stackoverflow.com/users/3988010/guy-hodges"}, "reply_to_user": {"reputation": 59, "user_id": 4346787, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001881520042/picture?type=large", "display_name": "Konsume", "link": "https://stackoverflow.com/users/4346787/konsume"}, "edited": false, "score": 1, "creation_date": 1427296539, "post_id": 29259084, "comment_id": 46721396, "body": "I&#39;ve edited the formula so that it will leave a blank value if there is no exact match. Give this a try and see if it works for you."}, {"owner": {"reputation": 59, "user_id": 4346787, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001881520042/picture?type=large", "display_name": "Konsume", "link": "https://stackoverflow.com/users/4346787/konsume"}, "edited": false, "score": 0, "creation_date": 1427296890, "post_id": 29259084, "comment_id": 46721652, "body": "Wierd... it&#39;s just pasting the text and not using the fomula =X"}, {"owner": {"reputation": 59, "user_id": 4346787, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001881520042/picture?type=large", "display_name": "Konsume", "link": "https://stackoverflow.com/users/4346787/konsume"}, "reply_to_user": {"reputation": 147, "user_id": 3988010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9cdb3a4caef798373f1f32373b5d872b?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Hodges", "link": "https://stackoverflow.com/users/3988010/guy-hodges"}, "edited": false, "score": 0, "creation_date": 1427297097, "post_id": 29259084, "comment_id": 46721822, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/73785/discussion-between-konsume-and-guy-hodges\">continue this discussion in chat</a>."}, {"owner": {"reputation": 59, "user_id": 4346787, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001881520042/picture?type=large", "display_name": "Konsume", "link": "https://stackoverflow.com/users/4346787/konsume"}, "edited": false, "score": 0, "creation_date": 1427297321, "post_id": 29259084, "comment_id": 46721980, "body": "Ok, I got it to work but It&#39;s just leaving everything &quot;blank&quot; =X"}], "tags": [], "owner": {"reputation": 147, "user_id": 3988010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9cdb3a4caef798373f1f32373b5d872b?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Hodges", "link": "https://stackoverflow.com/users/3988010/guy-hodges"}, "is_accepted": true, "score": 2, "last_activity_date": 1427296490, "last_edit_date": 1427296490, "creation_date": 1427295247, "answer_id": 29259084, "question_id": 29258340, "link": "https://stackoverflow.com/questions/29258340/i-need-to-compare-2-work-sheets-and-update-one-worksheet-with-the-info-from-anot/29259084#29259084", "title": "I need to compare 2 work sheets and update one worksheet with the info from another", "body": "<p>If for example the product name is in column A in both sheets, you could use something like this in column F of Sheets(\"Product\") to get the appropiate value from column B of Sheets(\"Parker List\") :</p>\n\n<pre><code>=IF(ISERROR(MATCH(A1,'Parker List'!A:A,0)),\"\",INDEX('Parker List'!B:B,MATCH(A1,'Parker List'!A:A,0)))\n</code></pre>\n\n<p>The key to this is to use 0 as the third optional argument of the MATCH function which will return an error value when a match is not made. ISERROR will detect this error and the IF function will perform the required calculations accordingly.</p>\n"}], "owner": {"reputation": 59, "user_id": 4346787, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001881520042/picture?type=large", "display_name": "Konsume", "link": "https://stackoverflow.com/users/4346787/konsume"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 726, "favorite_count": 0, "accepted_answer_id": 29259084, "answer_count": 1, "score": 0, "last_activity_date": 1427328756, "creation_date": 1427293355, "last_edit_date": 1427328756, "question_id": 29258340, "link": "https://stackoverflow.com/questions/29258340/i-need-to-compare-2-work-sheets-and-update-one-worksheet-with-the-info-from-anot", "title": "I need to compare 2 work sheets and update one worksheet with the info from another", "body": "<p>I've been trying to compare 2 sheets and update one of the sheets with some info.  I know about vlookup but I don't understand how it works.</p>\n\n<p>Here is what I need to do:</p>\n\n<ol>\n<li><p>Sheets(\"Product\") has many products on the A column (over 8,000)</p>\n\n<ul>\n<li>I need to select all products 1 by 1 and try to find if there is an EXACT MATCH (LookAt:=xlWhole) on the Sheets(\"Parker List\").</li>\n</ul></li>\n<li><p>If there is a match on the Sheets(\"Parker List\") I need to take SOME of the values of the Sheets(\"Parker List\") and put them into Sheets(\"Product\")</p></li>\n<li><p>If there is no match, I need to go to the next number in line in sheets(\"Product\")</p></li>\n</ol>\n\n<p>The values switch are:\nFrom Sheets(\"Parker List\") I need \"B\" and \"S\" and than put the infos in respectively \"F\" and \"H\" of the sheets(\"Product\") ONLY if the products of sheets(\"Product\") are found in Sheets(\"Parker List\").</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 755, "user_id": 3356425, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d1c91f0b514f74959f15d4565253e5c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3356425/alex"}, "edited": false, "score": 0, "creation_date": 1427292485, "post_id": 29257871, "comment_id": 46718416, "body": "I can&#39;t think of any specific line of code now, but concept-wise: Mark the rows you inserted with a flag or somehow check for already inserted rows before inserting any new ones."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4712301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b6eb712e5cb3134d19c161b8f13fd6c?s=128&d=identicon&r=PG&f=1", "display_name": "Lero", "link": "https://stackoverflow.com/users/4712301/lero"}, "edited": false, "score": 0, "creation_date": 1427292973, "post_id": 29258031, "comment_id": 46718750, "body": "Thank you for responding so quickly Alex and James. Is there any way to count the X blank rows within the code to ensure it doesn&#39;t insert again?"}, {"owner": {"reputation": 322, "user_id": 4413195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1rFPO.jpg?s=128&g=1", "display_name": "Jpad Solutions", "link": "https://stackoverflow.com/users/4413195/jpad-solutions"}, "reply_to_user": {"reputation": 11, "user_id": 4712301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b6eb712e5cb3134d19c161b8f13fd6c?s=128&d=identicon&r=PG&f=1", "display_name": "Lero", "link": "https://stackoverflow.com/users/4712301/lero"}, "edited": false, "score": 0, "creation_date": 1427293256, "post_id": 29258031, "comment_id": 46718953, "body": "something like the function I have put above. You could expand it to insert intcounter - intnumblankrows if you wanted to as well"}, {"owner": {"reputation": 11, "user_id": 4712301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b6eb712e5cb3134d19c161b8f13fd6c?s=128&d=identicon&r=PG&f=1", "display_name": "Lero", "link": "https://stackoverflow.com/users/4712301/lero"}, "edited": false, "score": 0, "creation_date": 1427293579, "post_id": 29258031, "comment_id": 46719205, "body": "Just trying to figure out how and where to use the function you provided- I&#39;m very new to Excel. I&#39;ve placed the function into a module, added a new column to the table and put =NeedMoreRows(I10:I300). I&#39;m obviously using it incorrectly as #VALUE error comes up."}, {"owner": {"reputation": 322, "user_id": 4413195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1rFPO.jpg?s=128&g=1", "display_name": "Jpad Solutions", "link": "https://stackoverflow.com/users/4413195/jpad-solutions"}, "reply_to_user": {"reputation": 11, "user_id": 4712301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b6eb712e5cb3134d19c161b8f13fd6c?s=128&d=identicon&r=PG&f=1", "display_name": "Lero", "link": "https://stackoverflow.com/users/4712301/lero"}, "edited": false, "score": 0, "creation_date": 1427294351, "post_id": 29258031, "comment_id": 46719750, "body": "I added something above, which is how I think you would call it"}], "tags": [], "owner": {"reputation": 322, "user_id": 4413195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1rFPO.jpg?s=128&g=1", "display_name": "Jpad Solutions", "link": "https://stackoverflow.com/users/4413195/jpad-solutions"}, "is_accepted": false, "score": 0, "last_activity_date": 1427294335, "last_edit_date": 1427294335, "creation_date": 1427292527, "answer_id": 29258031, "question_id": 29257871, "link": "https://stackoverflow.com/questions/29257871/inserting-x-number-of-rows-dependent-on-cell-value-and-formatting-the-new-rows/29258031#29258031", "title": "Inserting X number of rows dependent on cell value and formatting the new rows", "body": "<p>Your code will insert, say 5 blank rows beneath then number 5 in cell I11 for example. When you run the code again, it will again find the number 5 and insert another 5 rows.... You will need to tell it that it doesn't need to. That is to say you will need to either count the blank rows beneath the number 5 first, to see if there are already 5, or you need to mark the 5 as \"done\" (maybe by writing to column K perhaps)</p>\n\n<p>This function could potentially tell you if you need to add rows:</p>\n\n<pre><code>Function NeedsMoreRows(rngToCheck As Range) As Boolean\nDim intNumBlankRows As Integer\nDim intCounter As Integer\n\n    'this is the number of blank rows it should have underneath it\n    intNumBlankRows = rngToCheck.Value\n\n    For intCounter = 1 To intNumBlankRows\n\n        If ActiveSheet.Cells(rngToCheck.Row + intCounter, rngToCheck.Column) &lt;&gt; vbNullString Then NeedsMoreRows = True\n\n\n    Next intCounter\n\n\n\nEnd Function\n</code></pre>\n\n<p>If IsNumeric(.Value) And .Value > 1 And NeedsMoreRows(Cells(lngCounter, \"A\")) Then</p>\n"}], "owner": {"reputation": 11, "user_id": 4712301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b6eb712e5cb3134d19c161b8f13fd6c?s=128&d=identicon&r=PG&f=1", "display_name": "Lero", "link": "https://stackoverflow.com/users/4712301/lero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2240, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1427294964, "creation_date": 1427292095, "last_edit_date": 1531164843, "question_id": 29257871, "link": "https://stackoverflow.com/questions/29257871/inserting-x-number-of-rows-dependent-on-cell-value-and-formatting-the-new-rows", "title": "Inserting X number of rows dependent on cell value and formatting the new rows", "body": "<p>I have a table of data in Excel 2010 starting from row 10, each row containing a calculated number (X) in column I. The code is intended to insert (X) number of new rows below any row in the table when (X) is more than 1. </p>\n\n<p>The current code achieves this, but as new entries are made into the table and I run the code again, more blank rows are added below the additional rows already inserted.</p>\n\n<p>I'd also like to copy the information in columns A:G from the row containing (X) to each of the newly inserted rows, and make the original row appear in bold text. </p>\n\n<pre><code>Sub Insert_SB()\nDim lngCounter As Long\n\nFor lngCounter = Range(\"I\" &amp; Rows.count).End(xlUp).row To 10 Step -1\n\n\n    With Cells(lngCounter, \"I\")\n\n    If IsNumeric(.Value) And .Value &gt; 1 Then\n    With .Offset(1, 0).Resize(.Value - 1, 1)\n    .EntireRow.Insert\n    End With\n    If IsNumeric(.Value) And .Value = 0 Then Exit For\n\nEnd If\nEnd With\n\nNext lngCounter\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 4633674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/878805a96c4a3bf20622a46e289a3bf8?s=128&d=identicon&r=PG", "display_name": "Sean McMenemy", "link": "https://stackoverflow.com/users/4633674/sean-mcmenemy"}, "is_accepted": false, "score": 0, "last_activity_date": 1427294181, "creation_date": 1427294181, "answer_id": 29258668, "question_id": 29257808, "link": "https://stackoverflow.com/questions/29257808/copy-dynamic-ranges-and-append-from-one-sheet-to-another/29258668#29258668", "title": "Copy dynamic ranges and append from one sheet to another", "body": "<p>Assuming you have three sheets named Sheet 1:3, with data in A to C.</p>\n\n<pre><code>Sub combine_Sheets()\n\n'Declare variables\nDim sht1 As Worksheet\nDim sht2 As Worksheet\nDim sht3 As Worksheet\nDim lastRow As Long\n\n'Set variables\nSet sht1 = Sheets(\"Sheet1\")\nSet sht2 = Sheets(\"Sheet2\")\nSet sht3 = Sheets(\"Sheet3\")\n\n'Copy Sheet 2 to Sheet 1\n\n'Find Last row on Sheet 1\nlastRow = Cells(sht1.Rows.Count, \"A\").End(xlUp).Row\n\n'Copy Sheet 2 data to bottom of Sheet 1\nsht2.Range(\"A2:C\" &amp; Cells(ActiveSheet.Rows.Count, \"A\").End(xlUp).Row).Copy _\n    Destination:=sht1.Range(\"A\" &amp; lastRow + 1)\n\n'Copy Sheet 3 to Sheet 1\n\n'Find new Last row on Sheet 1\nlastRow = Cells(sht1.Rows.Count, \"A\").End(xlUp).Row\n\n'Copy Sheet 3 data to bottom of Sheet 1\nsht3.Range(\"A2:C\" &amp; Cells(ActiveSheet.Rows.Count, \"A\").End(xlUp).Row).Copy _\n    Destination:=sht1.Range(\"A\" &amp; lastRow + 1)\n\nsht1.Activate\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4712367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a53f3828b4626c54dad79c68b690d062?s=128&d=identicon&r=PG&f=1", "display_name": "LearningMig", "link": "https://stackoverflow.com/users/4712367/learningmig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2578, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1427327078, "creation_date": 1427291921, "last_edit_date": 1531164843, "question_id": 29257808, "link": "https://stackoverflow.com/questions/29257808/copy-dynamic-ranges-and-append-from-one-sheet-to-another", "title": "Copy dynamic ranges and append from one sheet to another", "body": "<p>I have 3 data sheets all with the same headers (columns).  I need to copy all the data into one sheet.  The number of rows will vary for each data sheet each time I run the reports. The number of columns are always constant.  How do I copy data from sheet 2 and sheet 3 and append onto sheet 1?</p>\n"}, {"tags": ["vba", "ms-access", "windows-7", "windows-xp", "mismatch"], "comments": [{"owner": {"reputation": 21, "user_id": 4320956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e4b66f1b62370bdec9a79afad675937?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Hollis", "link": "https://stackoverflow.com/users/4320956/ian-hollis"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1427292074, "post_id": 29257671, "comment_id": 46718109, "body": "unfortunatley I don&#39;t have access to an XP machine they are on another site 60 miles away"}, {"owner": {"reputation": 21, "user_id": 4320956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e4b66f1b62370bdec9a79afad675937?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Hollis", "link": "https://stackoverflow.com/users/4320956/ian-hollis"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1427292607, "post_id": 29257671, "comment_id": 46718480, "body": "done thanks for the pointer Hans"}, {"owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "edited": false, "score": 2, "creation_date": 1427292828, "post_id": 29257671, "comment_id": 46718623, "body": "Could it be the ADO version?  Windows 7 where you&#39;re developing has access to later version than an XP machine would.  <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms676506%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1427293256, "post_id": 29257671, "comment_id": 46718954, "body": "How do you support those remote users?  Can you use remote login or any screen sharing method?  Do you have a tech support person at the remote site?  You need to get eyeballs on the problem details."}, {"owner": {"reputation": 21, "user_id": 4320956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e4b66f1b62370bdec9a79afad675937?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Hollis", "link": "https://stackoverflow.com/users/4320956/ian-hollis"}, "edited": false, "score": 0, "creation_date": 1427294608, "post_id": 29257671, "comment_id": 46719941, "body": "Thanks for your input Hans I&#39;ve actually managed to find and old XP machine in this building and the code above works as it should on that. I&#39;ve asked if the user can check that various libraries etc are the same as we have here I&#39;ll let you know the outcome"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1427295506, "post_id": 29257671, "comment_id": 46720596, "body": "You can ask the remote user to run this as a single line in the Access Immediate window: <code>for i = 1 to references.count : ? references(i).Name, references(i).Major, references(i).Minor, references(i).IsBroken : next</code>"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1427295585, "post_id": 29257671, "comment_id": 46720646, "body": "If nothing shows True for <code>IsBroken</code>, the library versions are not the cause of your problem."}, {"owner": {"reputation": 21, "user_id": 4320956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e4b66f1b62370bdec9a79afad675937?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Hollis", "link": "https://stackoverflow.com/users/4320956/ian-hollis"}, "edited": false, "score": 0, "creation_date": 1427295766, "post_id": 29257671, "comment_id": 46720790, "body": "looks like it may be the ADO version as Sobigen suggests I&#39;ve managed to find and XP machine here and both that and windows 7 are using msado28.dll where as the machines at the other site look to be using msado1.5.dll, I&#39;ll ask if it can be changed back there"}, {"owner": {"reputation": 21, "user_id": 4320956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e4b66f1b62370bdec9a79afad675937?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Hollis", "link": "https://stackoverflow.com/users/4320956/ian-hollis"}, "edited": false, "score": 0, "creation_date": 1427295828, "post_id": 29257671, "comment_id": 46720839, "body": "Hans just seen your comment I&#39;ll ask them to try that also"}, {"owner": {"reputation": 21, "user_id": 4320956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e4b66f1b62370bdec9a79afad675937?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Hollis", "link": "https://stackoverflow.com/users/4320956/ian-hollis"}, "edited": false, "score": 0, "creation_date": 1427296184, "post_id": 29257671, "comment_id": 46721115, "body": "Thanks Hans it looks like that might be my problem I&#39;ll e-mail a colleague on the other site and ask him to give your immediate window suggestion a go"}, {"owner": {"reputation": 21, "user_id": 4320956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e4b66f1b62370bdec9a79afad675937?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Hollis", "link": "https://stackoverflow.com/users/4320956/ian-hollis"}, "edited": false, "score": 0, "creation_date": 1427372383, "post_id": 29257671, "comment_id": 46754511, "body": "Problem solved many thanks changed ado library for a different one then changed back again all your help much appreciated"}], "answers": [{"tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": false, "score": 0, "last_activity_date": 1427374213, "last_edit_date": 1495535055, "creation_date": 1427374213, "answer_id": 29278887, "question_id": 29257671, "link": "https://stackoverflow.com/questions/29257671/vba-type-mismatch-in-access/29278887#29278887", "title": "VBA type mismatch in Access", "body": "<p>This is the consolidation of all the comments into answer.</p>\n\n<p>Check the ADO version of the remote machines. Windows 7 where you're developing has access to later version than an XP machine would.  <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms676506%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms676506%28v=vs.85%29.aspx</a>\n<hr>\nFrom <a href=\"https://stackoverflow.com/users/77335/hansup\">HansUp</a>\nYou can ask the remote user to run this as a single line in the Access Immediate window: </p>\n\n<pre><code>for i = 1 to references.count : ? references(i).Name, references(i).Major, references(i).Minor, references(i).IsBroken : next\n</code></pre>\n\n<p>If nothing shows True for IsBroken, the library versions are not the cause of your problem.</p>\n"}], "owner": {"reputation": 21, "user_id": 4320956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e4b66f1b62370bdec9a79afad675937?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Hollis", "link": "https://stackoverflow.com/users/4320956/ian-hollis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 280, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594645150, "creation_date": 1427291551, "last_edit_date": 1594645150, "question_id": 29257671, "link": "https://stackoverflow.com/questions/29257671/vba-type-mismatch-in-access", "title": "VBA type mismatch in Access", "body": "<p>Good afternoon all</p>\n\n<p>I'm attmepting to implement an audit trail for a small database here at work and I've borrowed my code from Martin Greens' Fontstuff website\n<a href=\"http://www.fontstuff.com/access/acctut21.htm\" rel=\"nofollow\">Martin Green's Audit trail</a></p>\n\n<p>so I have a code module that constist of </p>\n\n<pre><code>Sub AuditChanges(IDField As String)\nOn Error GoTo AuditChanges_Err\n\nDim cnn As ADODB.Connection\nDim rst As ADODB.Recordset\nDim ctl As Control\nDim datTimeCheck As Date\nDim strUserID As String\nDim strReason As String\nDim strName As String\n\nSet cnn = CurrentProject.Connection\nSet rst = New ADODB.Recordset\nrst.Open \"SELECT * FROM tblAuditTrail\", cnn, adOpenDynamic, adLockOptimistic\ndatTimeCheck = Now()\nstrUserID = Environ(\"USERNAME\")\n\nstrReason = InputBox(\"Enter Reason\", \"Reason\")\n'strName = InputBox(\"Enter Name\", \"Name\")\n\nFor Each ctl In Screen.ActiveForm.Controls\n    If ctl.Tag = \"Audit\" Then\n        If Nz(ctl.Value) &lt;&gt; Nz(ctl.OldValue) Then\n            With rst\n                .AddNew\n                ![DateTime] = datTimeCheck\n                ![UserName] = strUserID\n                ![FormName] = Screen.ActiveForm.Name\n                ![RecordID] = Screen.ActiveForm.Controls(IDField).Value\n                ![FieldName] = ctl.ControlSource\n                ![OldValue] = ctl.OldValue\n                ![NewValue] = ctl.Value\n                ![Reason] = strReason\n                ![Name] = CurrentUser()\n                .Update\n            End With\n        End If\n    End If\nNext ctl\n\nAuditChanges_Exit:\nOn Error Resume Next\nrst.Close\ncnn.Close\nSet rst = Nothing\nSet cnn = Nothing\nExit Sub\n\nAuditChanges_Err:\nMsgBox Err.Description, vbCritical, \"ERROR!\"\nResume AuditChanges_Exit\nEnd Sub\n</code></pre>\n\n<p>and a short line in the before update method of each control on a form as follows</p>\n\n<pre><code>If Not Me.NewRecord Then Call AuditChanges(\"ID\")\n</code></pre>\n\n<p>My problem being if I run the database on a windows 7 machine everything works as it should.</p>\n\n<p>We do however have a few XP machines on which the dB has to be accessed and for some reason I get a type mismatch error when the code is executed unfortunately I'm unable to access these machines easily as they are on a different site </p>\n\n<p>Any Ideas?</p>\n\n<p>Thanks </p>\n"}, {"tags": ["c#", "asp.net", "excel", "vba"], "comments": [{"owner": {"reputation": 25213, "user_id": 3651607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mnc14.png?s=128&g=1", "display_name": "Andy Korneyev", "link": "https://stackoverflow.com/users/3651607/andy-korneyev"}, "edited": false, "score": 1, "creation_date": 1427291149, "post_id": 29257470, "comment_id": 46717402, "body": "It looks like you&#39;re trying to create your own GoogleDocs."}, {"owner": {"reputation": 1693, "user_id": 4243316, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/592e34b66d2d46db26df8d238d5f2294?s=128&d=identicon&r=PG&f=1", "display_name": "salsinga", "link": "https://stackoverflow.com/users/4243316/salsinga"}, "edited": false, "score": 0, "creation_date": 1456999219, "post_id": 29257470, "comment_id": 59209448, "body": "I am trying the following code.but it gives dialog box for opening/saving file.Response.ContentType = &quot;application/vnd.ms-excel&quot;;  string sFile = Server.MapPath(&quot;MyExcel.xls&quot;);  FileStream fs = new FileStream(sFile, FileMode.Open, FileAccess.Read);  byte[] b = new byte[(int)fs.Length];  fs.Read(b, 0, (int)fs.Length);  fs.Close();  Response.Clear();  Response.BinaryWrite(b);  Response.End();"}], "answers": [{"tags": [], "owner": {"reputation": 311, "user_id": 4490275, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4hntABYQw7Y/AAAAAAAAAAI/AAAAAAAAAIk/AdWiJc0EO_E/photo.jpg?sz=128", "display_name": "thienkhoi tran", "link": "https://stackoverflow.com/users/4490275/thienkhoi-tran"}, "is_accepted": false, "score": 0, "last_activity_date": 1427341300, "creation_date": 1427341300, "answer_id": 29270715, "question_id": 29257470, "link": "https://stackoverflow.com/questions/29257470/how-to-embedded-excel-file-in-asp-net-page/29270715#29270715", "title": "How to embedded Excel file in ASP.Net page?", "body": "<p>You can upload this file to Google Doc and open it then chose File -> Publish to the Web -> Get html code and paste them.<br>\nGood luck.</p>\n"}], "owner": {"reputation": 1, "user_id": 1127552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27a4bc56ba9c7f4ecee70f00efabe6a9?s=128&d=identicon&r=PG", "display_name": "Mohankumar. S", "link": "https://stackoverflow.com/users/1127552/mohankumar-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 683, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427341300, "creation_date": 1427291077, "last_edit_date": 1531161705, "question_id": 29257470, "link": "https://stackoverflow.com/questions/29257470/how-to-embedded-excel-file-in-asp-net-page", "title": "How to embedded Excel file in ASP.Net page?", "body": "<p>How to view excel file in ASP.Net page using c#?</p>\n\n<p>I need to view excel file in asp.net form and access the all excel functionality in this excel sheet.\n<strong>Note:</strong>\nExcel sheet will open inside the form tag, it means open within a page, not open separate file.</p>\n\n<p><strong><em>Like:</em></strong> Update fields, Merge fields, Wrap cells, Format the fields and apply text color. whatever Excel sheet have functionality all will be work asp.net excel page.</p>\n\n<p>Thanks in Advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 41522, "user_id": 1359668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xtsl4.jpg?s=128&g=1", "display_name": "Steven Doggart", "link": "https://stackoverflow.com/users/1359668/steven-doggart"}, "edited": false, "score": 2, "creation_date": 1427290338, "post_id": 29257127, "comment_id": 46716822, "body": "Please do not use the VB.NET tag for questions related to VBA.  They are completely different technologies."}, {"owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "reply_to_user": {"reputation": 41522, "user_id": 1359668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xtsl4.jpg?s=128&g=1", "display_name": "Steven Doggart", "link": "https://stackoverflow.com/users/1359668/steven-doggart"}, "edited": false, "score": 0, "creation_date": 1427290393, "post_id": 29257127, "comment_id": 46716866, "body": "I wasn&#39;t aware of that Sorry"}, {"owner": {"reputation": 41522, "user_id": 1359668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xtsl4.jpg?s=128&g=1", "display_name": "Steven Doggart", "link": "https://stackoverflow.com/users/1359668/steven-doggart"}, "edited": false, "score": 0, "creation_date": 1427290453, "post_id": 29257127, "comment_id": 46716911, "body": "No problem.  It&#39;s an honest mistake.  Just don&#39;t let it happen again :)"}], "answers": [{"tags": [], "owner": {"reputation": 41522, "user_id": 1359668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xtsl4.jpg?s=128&g=1", "display_name": "Steven Doggart", "link": "https://stackoverflow.com/users/1359668/steven-doggart"}, "is_accepted": true, "score": 8, "last_activity_date": 1427291363, "last_edit_date": 1427291363, "creation_date": 1427290960, "answer_id": 29257418, "question_id": 29257127, "link": "https://stackoverflow.com/questions/29257127/vba-complicated-getter-setter-syntax/29257418#29257418", "title": "VBA Complicated Getter, Setter syntax", "body": "<p>You are reading the documentation for VB.NET.  That's why you are confused.  The syntax for properties in VBA is different.  In VBA, the <code>Get</code> and <code>Let</code> for a property are not grouped together.  They need to be listed separately, essentially like two separate methods:</p>\n\n<pre><code>Private mMyProperty As String\n\nPublic Property Get MyProperty() As String\n    MyProperty = mMyProperty\nEnd Property\n\nPublic Property Let Transition(Value As String)\n    mMyProperty = Value\nEnd Property\n</code></pre>\n\n<p>For VBA reference material, try starting <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264383.aspx\" rel=\"noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 2, "last_activity_date": 1427291121, "creation_date": 1427291121, "answer_id": 29257487, "question_id": 29257127, "link": "https://stackoverflow.com/questions/29257127/vba-complicated-getter-setter-syntax/29257487#29257487", "title": "VBA Complicated Getter, Setter syntax", "body": "<p>Your issue is that you are reading .Net help files! :)</p>\n\n<p>Assuming you have a valid Vector class, your properties need to bde defined like this:</p>\n\n<pre><code>Private Matrix()              As Vector\nPublic Property Get Transition(Old_S As String, New_S As String, Period As Integer) As String\n' Some Code\n    Transition = Matrix(Column, Row).Value(Period)\nEnd Property\nPublic Property Let Transition(Old_S As String, New_S As String, Period As Integer, Vector_String As String)\n' Some Code\n    Matrix(Row, Column).Value = Vector_String\nEnd Property\n</code></pre>\n\n<p>Note that the argument list for both procedures must match except that the Letter has an additional argument of the same type that the Getter returns.</p>\n\n<p>It is also slightly unusual to have a Getter property that accepts arguments in VBA - that would more usually be implemented as a method.</p>\n"}, {"tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": false, "score": 1, "last_activity_date": 1427291242, "creation_date": 1427291242, "answer_id": 29257543, "question_id": 29257127, "link": "https://stackoverflow.com/questions/29257127/vba-complicated-getter-setter-syntax/29257543#29257543", "title": "VBA Complicated Getter, Setter syntax", "body": "<p>Looks like you're using VB.Net syntax in VBA. That's not going to work, as they're entirely different languages. Here is a link to the proper documentation for the <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg278574.aspx\" rel=\"nofollow\">VBA Property Keyword</a>.</p>\n\n<p>Here is how you would write it in VBA.</p>\n\n<pre><code>Private Matrix() As Vector\nPublic Property Get MatrixValue(Old_S As String, New_S As String, Period As Integer) As Double\n    ' Some Code\n    MatrixValue = Matrix(Column, Row).Value(Period)\nEnd Property\n\nPublic Property Let MatrixValue(Old_S As String, New_S As String, Vector_String As String)\n    ' Some Code\n    Matrix(Row, Column).Value = Vector_String\nEnd Property\n</code></pre>\n\n<p>But you're going to have trouble with the <code>Get</code> property. You <em>can</em> <a href=\"http://vba4all.com/is-it-possible-to-have-multiple-arguments-in-the-letget-properties-on-a-class-module-in-vba/\" rel=\"nofollow\">pass parameters into <code>Get</code></a>, but it's not exactly intuitive. I think what you're really looking for is a function.</p>\n\n<pre><code>Public Function GetMatrixValue(Old_S As String, New_S As String, Period As Integer) As Double\n    ' Some Code\n    MatrixValue = Matrix(Column, Row).Value(Period)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7099, "favorite_count": 1, "accepted_answer_id": 29257418, "answer_count": 3, "score": 2, "last_activity_date": 1427292530, "creation_date": 1427290255, "last_edit_date": 1531164843, "question_id": 29257127, "link": "https://stackoverflow.com/questions/29257127/vba-complicated-getter-setter-syntax", "title": "VBA Complicated Getter, Setter syntax", "body": "<p>Hi I'm rather new to VBA I need to create an object with relativelly complicated Getter and Setter. To do this I am constantly checking with <a href=\"https://msdn.microsoft.com/en-us/library/zzh9ha57.aspx\" rel=\"nofollow\">MSDN</a> but clearly I am not understanding something because VBE keep highlighting lines starting and closing: Property (it appaently needs Get or Let??), Get(it apparently needs  identifier), Let(it apparently needs  identifier as well).</p>\n\n<p>But I am trying to follow more concise notation where Get and Let methods are within a Property Statement which is used by Microsoft in its examples(see link above). </p>\n\n<p>Can someone tell me where is my syntax wrong(or Microsoft's Documentation for that matter)???</p>\n\n<p>Thank you</p>\n\n<pre><code>Private Matrix() As Vector\nProperty Transition()\n    Public Get(Old_S As String, New_S As String, Period As Integer) As Double\n        ' Some Code\n        Return Matrix(Column, Row).Value(Period)\n    End Get\n    Public Let(Old_S As String, New_S As String, Vector_String As String)\n        ' Some Code\n        Matrix(Row, Column).Value = Vector_String\n    End Let\nEnd Property\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1427289868, "post_id": 29256877, "comment_id": 46716454, "body": "It says that it is a syntax error..."}], "answers": [{"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427290057, "post_id": 29257001, "comment_id": 46716602, "body": "He indicated that the error is on the last line of code. So unless it&#39;s failing to make it into the <code>If</code> statement, I&#39;m not sure that&#39;s the issue."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1427290152, "post_id": 29257001, "comment_id": 46716676, "body": "For what I know it&#39;s true, the formula modifies the hosting cell, that can clearly not store a Worksheet object. If you really want this to be done by a function, you&#39;re free to add/remove sheets in the body of the function but you need to return another type of value (a boolean True/False for example)"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1427290834, "post_id": 29257001, "comment_id": 46717200, "body": "@MatteoNNZ &quot;the formula modifies the hosting cell&quot; in general or in this particular case? His code isn&#39;t modifying any cells... There are some limitations on what a <code>Function</code> can do, but adding/deleting worksheets and returning an object are <i>not</i> among those limitations. (Note, he&#39;s posted that my suggested fix is working for him, and has accepted that as an answer). Not trying to be harsh, just trying to help out."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1427291256, "post_id": 29257001, "comment_id": 46717485, "body": "A Function is limited <b>when called from a cell</b> - I do not think that is the case here."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427291271, "post_id": 29257001, "comment_id": 46717498, "body": "@FreeMan no worries, it&#39;s important to discuss (everyone has something to learn). I&#39;d be curious to see if you get a <code>#Value</code> error in the cell from which you call the function; in that case, is not the function which is returning the worksheet, it&#39;s added just because the command to do it is embedded in the function body (as it would be in a macro). But I thought we were discussing about the <i>return</i> of the function, in that case you will see yourself that you can return whatever (an empty <code>String</code>, a <code>Boolean</code> etc. and still have the worksheet added/removed ;)"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427291272, "post_id": 29257001, "comment_id": 46717500, "body": "@FreeMan I was replying in the assumption that <a href=\"http://stackoverflow.com/questions/29207513/how-to-prevent-excel-from-crashing-when-renaming-a-sheet-in-a-workbook-with-udfs/29209503#29209503\">this answer</a> I got a couple of days ago was correct for all functions, but apparently the functions aren&#39;t quite as fragile when they are not volatile. I still kinda agrees with the premise posted in that answer though, &quot;you use functions to calculate - you subs to change things.&quot;"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1427291469, "post_id": 29257001, "comment_id": 46717658, "body": "P.s. just to make clear: in this case the user wants to use a function just because he doesn&#39;t want to press &quot;execute&quot; on the macro (or adding a shortcut to it), but functions are done for returning an output (not only in VBA) and in this specific case the function is not returning anything used, but just trying to cast a worksheet in a cell (clearly getting a value error). For elegance&#39;s sake, I would have rather returned a Boolean to confirm the correct execution of the Sub code embedded in the function."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1427292562, "post_id": 29257001, "comment_id": 46718459, "body": "Interesting. You guys, (@MatteoNNZ &amp; eirikdaude) seem to be assuming he&#39;ll be calling this function by putting it in a cell with <code>=DeleteAndAddSheet(something)</code> that&#39;s not an assumption that I made at all. I just assumed it was a subroutine in his VBA code and he wanted to make it a function so he could return the new sheet and make his code a little cleaner. From your perspective, I believe you&#39;re correct. I just hadn&#39;t thought of it from that angle at all. (I believe Rory hit on that 20 minutes ago...)"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427292928, "post_id": 29257001, "comment_id": 46718709, "body": "@FreeMan reading properly the question, I see he starts with a sample use of the function that is in-code (within VBA) and not out-of-code (in Excel); I&#39;ve stuck on &quot;I use it so often..&quot; and didn&#39;t pay the right attention. In this case, you&#39;re absolutely right: functions within the code are <i>absolutely done</i> for returning objects."}], "tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": false, "score": 0, "last_activity_date": 1427291542, "last_edit_date": 1427291542, "creation_date": 1427289977, "answer_id": 29257001, "question_id": 29256877, "link": "https://stackoverflow.com/questions/29256877/vba-using-a-function-to-set-a-new-sheet/29257001#29257001", "title": "VBA : Using a function to set a new sheet", "body": "<p>You neeed to make it into a <code>Sub</code> instead, a <code>Function</code> cannot change anything apart from the cell it is working on, so the <code>Application.DisplayAlert</code>-statements, as well as the attempt to delete a worksheet causes it to throw an error.</p>\n\n<p>Upon some testing, it appears that a <code>function</code> will let you e.g. delete a sheet, but it will not let change application-settings.</p>\n"}, {"comments": [{"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1427290387, "post_id": 29257006, "comment_id": 46716862, "body": "The syntax you are providing is correct. My question is: <i>Is it possible for function to return a <code>Worksheet object</code>?</i>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1427290400, "post_id": 29257006, "comment_id": 46716871, "body": "Awesome! Thx! Can&#39;t accept the answer for 3 minutes, don&#39;t know why but will do ;)"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427290458, "post_id": 29257006, "comment_id": 46716915, "body": "Functions can return objects in general."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1427290664, "post_id": 29257006, "comment_id": 46717060, "body": "As evidenced by R3uK&#39;s response. :) They wouldn&#39;t be particularly useful if they couldn&#39;t."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 3, "last_activity_date": 1427289984, "creation_date": 1427289984, "answer_id": 29257006, "question_id": 29256877, "link": "https://stackoverflow.com/questions/29256877/vba-using-a-function-to-set-a-new-sheet/29257006#29257006", "title": "VBA : Using a function to set a new sheet", "body": "<p>change</p>\n\n<pre><code>DeleteAndAddSheet = ThisWorkbook.Worksheets(Worksheets.Count)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>set DeleteAndAddSheet = ThisWorkbook.Worksheets(Worksheets.Count)\n</code></pre>\n"}], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 29257006, "answer_count": 2, "score": 1, "last_activity_date": 1487251959, "creation_date": 1427289661, "last_edit_date": 1487251959, "question_id": 29256877, "link": "https://stackoverflow.com/questions/29256877/vba-using-a-function-to-set-a-new-sheet", "title": "VBA : Using a function to set a new sheet", "body": "<p>I use really often that routine that I wanted to modify into a function to be able to set the added sheet right away, like this </p>\n\n<pre><code>Set ShP = DeleteAndAddSheet(\"Name\")\n</code></pre>\n\n<p>So here is the function :</p>\n\n<pre><code>Public Function DeleteAndAddSheet(ByVal SheetName As String) As Worksheet\n\nFor Each aShe In Sheets\n    If aShe.Name &lt;&gt; SheetName Then\n    Else\n        Application.DisplayAlerts = False\n        aShe.Delete\n        Application.DisplayAlerts = True\n        Exit For\n    End If\nNext aShe\n\nSheets.Add after:=Sheets(Sheets.Count)\nSheets(Sheets.Count).Name = SheetName\n\nDeleteAndAddSheet = ThisWorkbook.Worksheets(Worksheets.Count)\n\nEnd Function\n</code></pre>\n\n<p>I get an error '91' on last row when setting the function's output, \"Object variable or With variable is not set\"</p>\n\n<p>I tried with Sheets and Worksheets and neither one of them work...</p>\n\n<p>Any idea?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1427289657, "post_id": 29256802, "comment_id": 46716294, "body": "VBA &lt;&gt; VB.NET and VB.NET doesnt have macros"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1427289743, "post_id": 29256802, "comment_id": 46716360, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/14261632/how-can-i-create-text-files-with-special-characters-in-their-filenames\">How can I create text files with special characters in their filenames</a>"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 1, "creation_date": 1427292468, "post_id": 29256802, "comment_id": 46718395, "body": "So with setting the format parameter to Unicode (-1) <code>Set oTxt = oFS.OpenTextFile(sFNText, 2, True, -1)</code> you had no success? What kind of &quot;foreign text&quot; is this? Can you give an example?"}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 4712035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f84b06a738d2bb6fefd72fb839f3e3e?s=128&d=identicon&r=PG&f=1", "display_name": "jbay", "link": "https://stackoverflow.com/users/4712035/jbay"}, "is_accepted": false, "score": 0, "last_activity_date": 1427291826, "creation_date": 1427291826, "answer_id": 29257770, "question_id": 29256802, "link": "https://stackoverflow.com/questions/29256802/reading-international-special-characters-in-vba/29257770#29257770", "title": "Reading International/Special Characters in VBA", "body": "<p>This is the code I use to write to a text.  I've tried many methods and this has worked the best.</p>\n\n<pre><code>Sub ProcessX()\n   FName1 = \"Location of File\"\n   txtStrngX = OpenTextFileToString2(FName1)\nend sub\n\nPublic Function OpenTextFileToString2(ByVal strFile As String) As String\n\n Dim hFile As Long\n hFile = FreeFile\n Open strFile For Input As #hFile\n OpenTextFileToString2 = Input$(LOF(hFile), hFile)\n Close #hFile\n\nEnd Function\n</code></pre>\n\n<p>As for reading in from rows just be sure to set your variable to a string when compiling and any method should work fine.</p>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 4712035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f84b06a738d2bb6fefd72fb839f3e3e?s=128&d=identicon&r=PG&f=1", "display_name": "jbay", "link": "https://stackoverflow.com/users/4712035/jbay"}, "is_accepted": false, "score": 0, "last_activity_date": 1427292103, "creation_date": 1427292103, "answer_id": 29257872, "question_id": 29256802, "link": "https://stackoverflow.com/questions/29256802/reading-international-special-characters-in-vba/29257872#29257872", "title": "Reading International/Special Characters in VBA", "body": "<p>sorry.  That's reading from a text.  Here is writing.</p>\n\n<pre><code>Public Function RecordsetToText(rs As Object, Optional FullPath _\n    As String, Optional ValueDelimiter As String = \"  \") As Boolean\n\n 'PURPOSE: EXPORTS DATA FROM AN ADO RECORDSET TO A TEXT FILE\n\n\n 'PARAMETERS:\n\n\n 'RS: Recordset to Export. Open the recordset before\n\n 'passing it to this function\n\n\n 'FullPath (Optional): FullPath of text file.\n\n 'if not specified, the function uses app.path +\n\n 'rs.txt\n\n\n 'ValueDelmiter (Optional): String to delimiter\n\n 'values within a row.  If not specified, an tab\n\n 'is used\n\n\n 'RETURNS: True if successful, false if an error occurs\n\n\n 'COMMENTS: Rows are delimited by a carriage return\n\n Dim sFullPath As String\n\n Dim sDelimiter As String\n\n Dim iFileNum As Integer\n\n Dim lFieldCount As Long\n\n Dim lCtr As Long\n\n Dim oField As ADODB.Field\n\n\n On Error GoTo ErrorHandler:\n\n\n\n If RecordSetReady(rs) = False Then Exit Function\n\n\n\n sDelimiter = ValueDelimiter\n\n\n If FullPath = \"\" Then\n\n     sFullPath = App.Path\n\n     If Right(sFullPath, 1) &lt;&gt; \"\\\" Then sFullPath = _\n\n        sFullPath &amp; \"\\\"\n\n\n     sFullPath = sFullPath &amp; \"rs.txt\"\n\n Else\n\n     sFullPath = FullPath\n\n End If\n\n\n iFileNum = FreeFile\n\n\n Open sFullPath For Output As #iFileNum\n\n\n With rs\n\n lFieldCount = .Fields.Count - 1\n\n\n On Error Resume Next\n\n .MoveFirst\n\n On Error GoTo ErrorHandler\n\n\n For lCtr = 0 To lFieldCount\n\n    Set oField = .Fields(lCtr)\n\n     If lCtr &lt; lFieldCount Then\n\n         Print #iFileNum, oField.Name &amp; sDelimiter;\n\n    Else\n\n        Print #iFileNum, oField.Name\n\n    End If\n\n Next\n\n\n Do While Not .EOF\n\n    For lCtr = 0 To lFieldCount\n\n    Set oField = .Fields(lCtr)\n\n      If lCtr &lt; lFieldCount Then\n\n          Print #iFileNum, oField.Value &amp; sDelimiter;\n\n     Else\n\n          Print #iFileNum, oField.Value\n\n       End If\n\n  Next\n\n .MoveNext\n\n Loop\n\n\n End With\n\n\n RecordsetToText = True\n\n\n ErrorHandler:\n\n  On Error Resume Next\n\n  Close #iFileNum\n\n\n End Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 747, "user_id": 4473858, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh6.googleusercontent.com/-0gSPQeIfbB4/AAAAAAAAAAI/AAAAAAAABUI/oQNW0_x0vo0/photo.jpg?sz=128", "display_name": "Garreth", "link": "https://stackoverflow.com/users/4473858/garreth"}, "edited": false, "score": 0, "creation_date": 1427323005, "post_id": 29259732, "comment_id": 46737113, "body": "This worked for me after cleaning down my code and starting again. I think potentially I had too many solutions jumbled up and complicating the issue. It appears as though there was no need for the strconv function. I think it&#39;s possible that the -1 flag on the opentextfile function fixed my issue. I am sure I tried this but with other solutions in place it may not have worked. Thanks!"}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 1, "last_activity_date": 1427296928, "creation_date": 1427296928, "answer_id": 29259732, "question_id": 29256802, "link": "https://stackoverflow.com/questions/29256802/reading-international-special-characters-in-vba/29259732#29259732", "title": "Reading International/Special Characters in VBA", "body": "<p>I have the following sheet:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Nbm8D.png\" alt=\"enter image description here\"></p>\n\n<p>and the following code:</p>\n\n<pre><code>Sub writeUnicodeText()\n Dim arr_Strings() As String\n i = 0\n For Each oCell In ActiveSheet.Range(\"A1:A4\")\n  ReDim Preserve arr_Strings(i)\n  arr_Strings(i) = oCell.Value\n  i = i + 1\n Next\n\n Set oFS = CreateObject(\"Scripting.Filesystemobject\")\n Set oTxt = oFS.OpenTextFile(\"C:\\users\\axel\\documents\\test.txt\", 2, True, -1)\n For i = 0 To UBound(arr_Strings)\n  oTxt.Write arr_Strings(i) &amp; vbNewLine\n Next i\n oTxt.Close\nEnd Sub\n</code></pre>\n\n<p>This produces the following file:</p>\n\n<p><img src=\"https://i.stack.imgur.com/6l2fH.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 747, "user_id": 4473858, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh6.googleusercontent.com/-0gSPQeIfbB4/AAAAAAAAAAI/AAAAAAAABUI/oQNW0_x0vo0/photo.jpg?sz=128", "display_name": "Garreth", "link": "https://stackoverflow.com/users/4473858/garreth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3551, "favorite_count": 0, "accepted_answer_id": 29259732, "answer_count": 3, "score": 2, "last_activity_date": 1565391416, "creation_date": 1427289441, "last_edit_date": 1565391416, "question_id": 29256802, "link": "https://stackoverflow.com/questions/29256802/reading-international-special-characters-in-vba", "title": "Reading International/Special Characters in VBA", "body": "<p>I read an Excel spreadsheet row by row and for each row create a textfile including information from the columns.</p>\n\n<p>From time to time there is foreign text in some of the spreadsheet cells. In the debugger the foreign text appears as '?' question marks. It fails when trying to write these question marks to the text file.</p>\n\n<p>This is a snippet of the code that reads the values from a row to a string array</p>\n\n<pre><code>    Set oFS = CreateObject(\"Scripting.Filesystemobject\")\n    For Each rID In oSh.UsedRange.Columns(\"A\").Cells\n        For Each rValue In oSh.UsedRange.Rows(rowCount).Cells\n            ReDim Preserve columnValues(columnCount)\n            columnValues(columnCount) = rValue\n            columnCount = columnCount + 1\n        Next\n    Next\n</code></pre>\n\n<p>This is the code which writes to a text file</p>\n\n<pre><code>sFNText = sMakeFolder &amp; \"\\\" &amp; rID.Value &amp; \".txt\"\nSet oTxt = oFS.OpenTextFile(sFNText, 2, True)\n\nFor i = 0 To UBound(columnTitles)\n     oTxt.Write columnTitles(i) &amp; \": \" &amp; columnValues(i) &amp; vbNewLine\nNext i\n\noTxt.Close\n</code></pre>\n\n<p>I have experimented with changing the format of opentextfile and also using AscW and ChrW to convert to and from ansi.</p>\n\n<p>EDIT: In particular I am trying to read in Greek symbols (pi, omega etc.) and write them back out to a textfile.  I have used the </p>\n\n<pre><code>StrConv(Cells(1, 1), vbUnicode)\n</code></pre>\n\n<p>method that was detailed in <a href=\"https://stackoverflow.com/questions/14261632/how-can-i-create-text-files-with-special-characters-in-their-filenames\">How can I create text files with special characters in their filenames</a> and have got that example working. It seems now a problem with writing this to a textfile. nixda's example seems to work in isolation when using his Print command, however when I try</p>\n\n<pre><code>otxt.Write\n</code></pre>\n\n<p>to write my stored variable to a textfile it writes out garbage, as opposed to the print method which produces the correct result.  Looking at the debugger both variables are stored identically (print method + write), so I believe it is now down to the output method (otxt.Write) which is converting the stored variable into garbage.  I have tried using the -1 &amp; -2 options for OpenTextFile - both producing garbage results.</p>\n"}, {"tags": ["excel", "vba", "userform", "multiple-monitors"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1427289103, "post_id": 29256492, "comment_id": 46715896, "body": "I guess that you have tried to add Application.WindowState = xlMaximized in your opening event, but I have no clue on how to force it to be in one screen..."}, {"owner": {"reputation": 107, "user_id": 4294776, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000685609043/picture?type=large", "display_name": "Muhammed Saddam", "link": "https://stackoverflow.com/users/4294776/muhammed-saddam"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1427291159, "post_id": 29256492, "comment_id": 46717407, "body": "Thanks, see below for the complete answer"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 4294776, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000685609043/picture?type=large", "display_name": "Muhammed Saddam", "link": "https://stackoverflow.com/users/4294776/muhammed-saddam"}, "edited": false, "score": 0, "creation_date": 1427291111, "post_id": 29256590, "comment_id": 46717382, "body": "Thanks, Actually, in case i open the excel file and minimize it and move it to second screen then close it, open it again, it does move it to the main screen but not full screen, so i added: Application.WindowState = xlMaximized Now it works fine!"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1427291414, "post_id": 29256590, "comment_id": 46717605, "body": "Can we do this also for the UserForm? because I&#39;ve had the issue some times already"}, {"owner": {"reputation": 107, "user_id": 4294776, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000685609043/picture?type=large", "display_name": "Muhammed Saddam", "link": "https://stackoverflow.com/users/4294776/muhammed-saddam"}, "edited": false, "score": 0, "creation_date": 1427294369, "post_id": 29256590, "comment_id": 46719769, "body": "am doing this for a userform, because i am taking the heigh and width of the application and apply it on the userform, see my final code in my answer"}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 3, "last_activity_date": 1427289208, "last_edit_date": 1427289208, "creation_date": 1427288907, "answer_id": 29256590, "question_id": 29256492, "link": "https://stackoverflow.com/questions/29256492/display-excel-on-the-primary-monitor/29256590#29256590", "title": "Display Excel on the primary monitor", "body": "<p>Add this to the <code>Workbook_Open()</code> event procedure, and you'll be able to open the workbook in full-screen mode on the primary monitor.</p>\n\n<pre><code>Private Sub Workbook_Open()\n   Application.Top = 0\n   Application.Left = 0\n   Application.DisplayFullScreen = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 107, "user_id": 4294776, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000685609043/picture?type=large", "display_name": "Muhammed Saddam", "link": "https://stackoverflow.com/users/4294776/muhammed-saddam"}, "is_accepted": false, "score": 0, "last_activity_date": 1427294853, "creation_date": 1427294853, "answer_id": 29258936, "question_id": 29256492, "link": "https://stackoverflow.com/questions/29256492/display-excel-on-the-primary-monitor/29258936#29258936", "title": "Display Excel on the primary monitor", "body": "<p>It seems that VBA is effected by the dimensions of the last opened Excel file,by dimensions i mean, if it's full screen or normal displayed and in which screen.\nThe other problem that need to be considered is: if an Excel file was displayed on secondary screen, and this screen is bigger than the primary screen, then Application.Top, Application.Left will not successfully be able to get the application to the main screen, it needs to be displayed as normal first.\nMy final code to solve my own questions is:</p>\n\n<pre><code>Application.Visible = True\nApplication.WindowsState=xlNormal\nApplication.Width =100\nApplication.Height =100\nApplication.Top = 0\nApplication.Left = 0\nApplication.WindowsState =xlMaximized\nWith UserForm2\n.Height=Application.Height\n.Width=Application.Width\nEnd With\nUserForm2.ScrollBars = fmScrollBarsVertical\nUserForm2.KeepScrollBarsVisible = fmScrollBarsVertical\nUserForm2.Zoom = 120\nUserForm2.ScrollHeight = (120 * nq) + 120\nUserForm2.Show vbModeless\nApplication.Visible = False\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 4294776, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000685609043/picture?type=large", "display_name": "Muhammed Saddam", "link": "https://stackoverflow.com/users/4294776/muhammed-saddam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2842, "favorite_count": 1, "accepted_answer_id": 29256590, "answer_count": 2, "score": 3, "last_activity_date": 1427294853, "creation_date": 1427288618, "question_id": 29256492, "link": "https://stackoverflow.com/questions/29256492/display-excel-on-the-primary-monitor", "title": "Display Excel on the primary monitor", "body": "<p>I have a Userform opens automatically when opening an excel file. It has some display problems, as the option buttons disappear when scrolling down the form. this problem only occurs when i have 2 monitors (main and secondary). I noticed these two scenarios:</p>\n\n<ol>\n<li>If i open any Excel file and make it full screen in the main screen then close it, then open the userform it works fine! </li>\n<li>If i open any excel file and move it to the secondary screen then\nclose it and open the userform, the problem occurs!</li>\n</ol>\n\n<p>So,my questions is:</p>\n\n<p>Is there any way to force Excel to be opened as full screen in the main screen?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 1210, "user_id": 1633618, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/df0aea3445c4e73c8ec6ac6d50d0c5d1?s=128&d=identicon&r=PG", "display_name": "Bmo", "link": "https://stackoverflow.com/users/1633618/bmo"}, "edited": false, "score": 0, "creation_date": 1427289491, "post_id": 29256437, "comment_id": 46716170, "body": "<a href=\"http://i.imgur.com/QEih0Fk.jpg\" rel=\"nofollow noreferrer\">Automated email printing</a>"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1427292880, "post_id": 29256437, "comment_id": 46718663, "body": "Try to choose another folder for saving attachments. Also try to set the oAtt object to Nothing right after the SaveAsFile call."}], "answers": [{"comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1499811704, "post_id": 45038300, "comment_id": 77065123, "body": "If it turns out the slow save is the problem then a more elegant solution would probably use FileExists code."}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": -1, "last_activity_date": 1499785615, "creation_date": 1499785615, "answer_id": 45038300, "question_id": 29256437, "link": "https://stackoverflow.com/questions/29256437/file-access-error-when-auto-printing-in-outlook-2013/45038300#45038300", "title": "File Access Error when auto printing in Outlook 2013", "body": "<p>Likely the file has not finished saving.</p>\n\n<pre><code>Sub LSPrint(Item As Outlook.MailItem)\n\n    ' Remove this line to determine the line with the error\n    ' On Error GoTo OError\n\n    dim i as long\n\n    'detect Temp\n    Dim oFS As FileSystemObject\n    Dim sTempFolder As String\n    Set oFS = CreateObject(\"Scripting.FileSystemObject\")\n    'Temporary Folder Path\n    sTempFolder = oFS.GetSpecialFolder(TemporaryFolder)\n\n    'creates a special temp folder\n    cTmpFld = sTempFolder &amp; \"\\OETMP\" &amp; Format(Now, \"yyyymmddhhmmss\")\n    MkDir (cTmpFld)\n\n    'save &amp; print\n    Dim oAtt As Attachment\n    For Each oAtt In Item.Attachments\n        FileName = oAtt.FileName\n        fullfile = cTmpFld &amp; \"\\\" &amp; FileName\n\n        'save attachment\n        oAtt.SaveAsFile (fullfile)\n\n        'prints attachment\n        Set objShell = CreateObject(\"Shell.Application\")\n        Set objFolder = objShell.NameSpace(0)\n\n        On Error GoTo OErrorDelay\n        ' Assuming it is the line with the error\n        Set objFolderItem = objFolder.ParseName(fullfile)\n        on error goto 0\n\n        objFolderItem.InvokeVerbEx (\"print\")\n\n    Next oAtt\n\n    'Cleanup\n    Set oFS = Nothing\n    Set objFolder = Nothing\n    Set objFolderItem = Nothing\n    Set objShell = Nothing\n\n    exit sub\n\nOError:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n    Err.Clear\n    Exit Sub\n\nOErrorDelay:\n' Assuming the error is due to the file not yet being available\n' Some method to delay the print request\n' This will use the minimum delay, if it works\n    i = i + 1\n    ' some \"reasonable\" number\n    if i &gt; 100000 then goto OError\n    resume\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3847, "user_id": 2332659, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/7xPto.png?s=128&g=1", "display_name": "Bignadad", "link": "https://stackoverflow.com/users/2332659/bignadad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 293, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593155276, "creation_date": 1427288474, "last_edit_date": 1593155276, "question_id": 29256437, "link": "https://stackoverflow.com/questions/29256437/file-access-error-when-auto-printing-in-outlook-2013", "title": "File Access Error when auto printing in Outlook 2013", "body": "<p>I have the following code that auto prints my pdf when an email is received. Every now and then i get a file access error and it holds up all emails from being checked. Most times it happens multiple times when it happens.</p>\n\n<p>I have tried a couple things but still get that error every now and then.</p>\n\n<pre><code>Sub LSPrint(Item As Outlook.MailItem)\n    On Error GoTo OError\n\n    'detect Temp\n    Dim oFS As FileSystemObject\n    Dim sTempFolder As String\n    Set oFS = CreateObject(\"Scripting.FileSystemObject\")\n    'Temporary Folder Path\n    sTempFolder = oFS.GetSpecialFolder(TemporaryFolder)\n\n    'creates a special temp folder\n    cTmpFld = sTempFolder &amp; \"\\OETMP\" &amp; Format(Now, \"yyyymmddhhmmss\")\n    MkDir (cTmpFld)\n\n    'save &amp; print\n    Dim oAtt As Attachment\n    For Each oAtt In Item.Attachments\n      FileName = oAtt.FileName\n      fullfile = cTmpFld &amp; \"\\\" &amp; FileName\n\n      'save attachment\n      oAtt.SaveAsFile (fullfile)\n\n      'prints attachment\n      Set objShell = CreateObject(\"Shell.Application\")\n      Set objFolder = objShell.NameSpace(0)\n      Set objFolderItem = objFolder.ParseName(fullfile)\n      objFolderItem.InvokeVerbEx (\"print\")\n\n    Next oAtt\n\n    'Cleanup\n    If Not oFS Is Nothing Then Set oFS = Nothing\n    If Not objFolder Is Nothing Then Set objFolder = Nothing\n    If Not objFolderItem Is Nothing Then Set objFolderItem = Nothing\n    If Not objShell Is Nothing Then Set objShell = Nothing\n\nOError:\n    If Err &lt;&gt; 0 Then\n      MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n      Err.Clear\n    End If\n    Exit Sub\n\n  End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "hyperlink"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1427289753, "post_id": 29256157, "comment_id": 46716367, "body": "Your sample file link leads to a pasword protected log-in. So how do we see it?"}, {"owner": {"reputation": 33, "user_id": 1957527, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/95676c50304e763fa6720519717264d9?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Bagadia", "link": "https://stackoverflow.com/users/1957527/mohit-bagadia"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1427290434, "post_id": 29256157, "comment_id": 46716894, "body": "@MarkFitzgerald I&#39;m Sorry. I have edited the post. You can try now. <a href=\"https://drive.google.com/open?id=0B-Mgxdw-FueaVnBmLXBWZmZGVjA&amp;authuser=0\" rel=\"nofollow noreferrer\">Sample file</a>"}], "answers": [{"tags": [], "owner": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "is_accepted": true, "score": 1, "last_activity_date": 1427290369, "creation_date": 1427290369, "answer_id": 29257169, "question_id": 29256157, "link": "https://stackoverflow.com/questions/29256157/hyperlink-after-vlookup/29257169#29257169", "title": "Hyperlink after Vlookup", "body": "<p>Here's how you can do that with a formula. You'll need to change the workbook name in the HYPERLINK formula to match yours.</p>\n\n<pre><code>=IF(ISERROR(VLOOKUP($A1,Sheet2!$B:$B,1,0)),\"\",HYPERLINK(\"[StackTest.xlsx]'Sheet2'!D\"&amp;TEXT(MATCH($A1,Sheet2!$B:$B,0),\"#\"),\"Click Here\"))\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 1957527, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/95676c50304e763fa6720519717264d9?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Bagadia", "link": "https://stackoverflow.com/users/1957527/mohit-bagadia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 1, "accepted_answer_id": 29257169, "answer_count": 1, "score": 2, "last_activity_date": 1427290369, "creation_date": 1427287797, "last_edit_date": 1427290365, "question_id": 29256157, "link": "https://stackoverflow.com/questions/29256157/hyperlink-after-vlookup", "title": "Hyperlink after Vlookup", "body": "<p>This simple thing is eating my brain out. Here is the challenge:</p>\n\n<p>I have 2 sheets in the same workbook. Say Sheet 1 and Sheet 2. I want to Vlookup for the value present in Sheet 1 Column A and Sheet 2 column B. If the value is found i want to put a hyperlink in Sheet 1 Column A to point it to Sheet 2 Column D. In simple words, there are program names present in both the sheets and associated risk in sheet 2. If the program is present in both the sheets then i want to navigate directly to the risk present in the Sheet 2 upon clicking the program name in Sheet1.</p>\n\n<p>I am attaching the sample file with this thread. Please somebody help me. I have tried with vba and normal formulas. Nothing is being worked out.</p>\n\n<p>SAmple file can be downloaded from <a href=\"https://drive.google.com/open?id=0B-Mgxdw-FueaVnBmLXBWZmZGVjA&amp;authuser=0\" rel=\"nofollow\">here</a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 4551214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaad7493b26164d35d3c43111acdbc0a?s=128&d=identicon&r=PG&f=1", "display_name": "a_visitor", "link": "https://stackoverflow.com/users/4551214/a-visitor"}, "is_accepted": false, "score": 0, "last_activity_date": 1427391967, "creation_date": 1427391967, "answer_id": 29285378, "question_id": 29255962, "link": "https://stackoverflow.com/questions/29255962/excel-offline-copy-workbook-is-in-read-only-mode/29285378#29285378", "title": "Excel &#39;OFFLINE COPY&#39; Workbook is in read-only mode", "body": "<p>I'm assuming you're running the macro from the workbook that's possibly an Offline Copy thus referring to it as ThisWorkbook?\nHow about this work-around: if trying to save the workbook errors out, go to a different block of code and execute what's needed there. </p>\n\n<p><code>On Error GoTo ErrorRecovery\n ThisWorkbook.Save\n ErrorRecovery:\n 'code for whatever needs to be done if the file can't be saved.</code></p>\n\n<p>I couldn't recreate your issue, but hope this helps!</p>\n"}], "owner": {"reputation": 9130, "user_id": 693560, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e71609811ad09d2eba439b051790fbc7?s=128&d=identicon&r=PG", "display_name": "Bronzato", "link": "https://stackoverflow.com/users/693560/bronzato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 495, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427391967, "creation_date": 1427287257, "question_id": 29255962, "link": "https://stackoverflow.com/questions/29255962/excel-offline-copy-workbook-is-in-read-only-mode", "title": "Excel &#39;OFFLINE COPY&#39; Workbook is in read-only mode", "body": "<p>I would like to detect whether the workbook is an <code>OFFLINE COPY</code> as showed on the picture below.</p>\n\n<p>Maybe with vba code ?</p>\n\n<p>The property <code>ThisWorkbook.ReadOnly</code> returns <code>False</code></p>\n\n<p><img src=\"https://i.stack.imgur.com/o7PqD.png\" alt=\"enter image description here\"></p>\n\n<p>With a 'real' read-only workbook, the event <code>Workbook_BeforeSave</code> is never reached. With the <code>OFFLINE COPY</code> read-only mode as I talk here, the event <code>Workbook_BeforeSave</code> is reached but returns the message below:</p>\n\n<p><img src=\"https://i.stack.imgur.com/LeFH1.png\" alt=\"enter image description here\"></p>\n\n<p>So the behaviour is different. I need to detect it with vba.</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1427286790, "post_id": 29255694, "comment_id": 46714307, "body": "Why do you need INDIRECT in there?"}, {"owner": {"reputation": 11, "user_id": 4423094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74ddbfe3c9bf43560369b9895e02b653?s=128&d=identicon&r=PG&f=1", "display_name": "Bobert3", "link": "https://stackoverflow.com/users/4423094/bobert3"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1427286849, "post_id": 29255694, "comment_id": 46714339, "body": "i have tried without the indirect also, but that did not work. the indirect allows me to create a reference using text and this seemed like a logical use of that"}, {"owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1429935183, "post_id": 29255694, "comment_id": 47847652, "body": "Please check: <a href=\"http://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>."}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1427287092, "creation_date": 1427287092, "answer_id": 29255902, "question_id": 29255694, "link": "https://stackoverflow.com/questions/29255694/using-workbook-name-in-sumifs-formula/29255902#29255902", "title": "using workbook name in sumifs formula", "body": "<p>You need the <code>Formula</code> property rather than <code>FormulaR1c1</code> and you don't need INDIRECT because you are doing the concatenation in the code, not the formula itself:</p>\n\n<pre><code>Range(\"F3\").Formula = _\n    \"=SUMIFS(\" &amp; sheet &amp; \"$H:$H,\" &amp; sheet &amp; \"$D:$D,\"\"=\"\"&amp;$B3,\" &amp; sheet &amp; \"$E:$E,\"\"=\"\"&amp;$C3)\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4423094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74ddbfe3c9bf43560369b9895e02b653?s=128&d=identicon&r=PG&f=1", "display_name": "Bobert3", "link": "https://stackoverflow.com/users/4423094/bobert3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 745, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429934929, "creation_date": 1427286530, "last_edit_date": 1531164843, "question_id": 29255694, "link": "https://stackoverflow.com/questions/29255694/using-workbook-name-in-sumifs-formula", "title": "using workbook name in sumifs formula", "body": "<p>I'm trying to use <code>sumifs</code> to generate a sum of a specific column in a sheet called '<code>Details Sheet</code>' in a different workbook based on checking that 2 other columns in '<code>details sheet</code>' match values in the current worksheet.\nRight now I have the following</p>\n\n<pre><code> ThisWB = ActiveWorkbook.Name\n</code></pre>\n\n<p>At the start of the macro. </p>\n\n<p>Later in the macro, I switch focus to the sheet/workbook that I am working out of, and I use:</p>\n\n<pre><code>Dim sheet As String\nsheet = \"'[\" &amp; ThisWB &amp; \"]Details Sheet'!\"\nRange(\"F3\").Select\nActiveCell.FormulaR1C1 = _\n        \"=SUMIFS(INDIRECT(sheet &amp; \"\"$H:$H\"\")),INDIRECT(sheet &amp; \"\"$D:$D\"\")),\"\"=\"\"&amp;$B3,INDIRECT(sheet &amp; \"\"$E:$E\"\")),\"\"=\"\"&amp;$C3)\"\n</code></pre>\n\n<p>This produces an error. I have tried various other ways to reference that sheet and none of them work.</p>\n\n<p>When I reference the sheet with the full name of the workbook, i.e. <code>[workbook1]Details Sheet!'$D:$D</code>, that does work.</p>\n\n<p>What am I missing here?</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1427288435, "creation_date": 1427288435, "answer_id": 29256417, "question_id": 29255356, "link": "https://stackoverflow.com/questions/29255356/sending-via-outlook-but-not-using-exchange-by-default/29256417#29256417", "title": "sending via outlook - but not using exchange by default", "body": "<p>The Outlook object model provides the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869311.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">SendUsingAccount</a> property for the MailItem class which allows to set an Account object that represents the account under which the MailItem is to be sent. You just need to setup the property before calling the Send method. For example:</p>\n\n<pre><code>Sub SendUsingAccount() \n  Dim oAccount As Outlook.account \n  For Each oAccount In Application.Session.Accounts \n    If oAccount.AccountType = olPop3 Then \n      Dim oMail As Outlook.MailItem \n      Set oMail = Application.CreateItem(olMailItem) \n      oMail.Subject = \"Sent using POP3 Account\" \n      oMail.Recipients.Add (\"someone@example.com\") \n      oMail.Recipients.ResolveAll \n      oMail.SendUsingAccount = oAccount \n      oMail.Send \n    End If \n  Next \nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4123344, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-bTvA6Pc4SOA/AAAAAAAAAAI/AAAAAAAABCg/TM5mIRTQkI0/photo.jpg?sz=128", "display_name": "Rob F", "link": "https://stackoverflow.com/users/4123344/rob-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593248642, "creation_date": 1427285597, "last_edit_date": 1593248642, "question_id": 29255356, "link": "https://stackoverflow.com/questions/29255356/sending-via-outlook-but-not-using-exchange-by-default", "title": "sending via outlook - but not using exchange by default", "body": "<p>i have a few accounts in outlook. one of them is an exchange account. others are IMAP</p>\n\n<p>I am trying to use the IMAP one by default..the outlook options do not seem to help...because--></p>\n\n<p>I am using VBA code to load email content and trigger email send process from excel.</p>\n\n<p>The emails keep going out using the exchange account even if i declare the IMAP account the default. Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1427286508, "post_id": 29255046, "comment_id": 46714132, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/19452461/vba-pulling-data-from-sap-for-dummies\">VBA pulling data from SAP for dummies</a>"}, {"owner": {"reputation": 9, "user_id": 4146193, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000929572920/picture?type=large", "display_name": "Yashwanth Inti", "link": "https://stackoverflow.com/users/4146193/yashwanth-inti"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1427288294, "post_id": 29255046, "comment_id": 46715319, "body": "Actually my company have disabled the record option in the sap system.I want solution without dummies."}, {"owner": {"reputation": 9, "user_id": 4146193, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000929572920/picture?type=large", "display_name": "Yashwanth Inti", "link": "https://stackoverflow.com/users/4146193/yashwanth-inti"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1427288698, "post_id": 29255046, "comment_id": 46715602, "body": "Thanks for your reply,I need to automate the process,its a manual process,with a click in excel the data need to be refreshed in the excel from SAP system using vba.I need the code for it  @eirikdaude"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 4146193, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000929572920/picture?type=large", "display_name": "Yashwanth Inti", "link": "https://stackoverflow.com/users/4146193/yashwanth-inti"}, "edited": false, "score": 0, "creation_date": 1427288399, "post_id": 29256078, "comment_id": 46715397, "body": "Hello ,Thanks for your reply,I need to automate the process,its  a manual process,with a click in excel the data need to be refreshed in the excel from SAP system using vba.I need the code for it"}, {"owner": {"reputation": 116, "user_id": 4712035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f84b06a738d2bb6fefd72fb839f3e3e?s=128&d=identicon&r=PG&f=1", "display_name": "jbay", "link": "https://stackoverflow.com/users/4712035/jbay"}, "reply_to_user": {"reputation": 9, "user_id": 4146193, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000929572920/picture?type=large", "display_name": "Yashwanth Inti", "link": "https://stackoverflow.com/users/4146193/yashwanth-inti"}, "edited": false, "score": 0, "creation_date": 1427290854, "post_id": 29256078, "comment_id": 46717218, "body": "Are you currently able to connect directly to a server?  You can create a text file and save as foo.udl then close the file and open it to get your server connection info.  Then write something like the below:  Public Function ObjectConnect(AID As String, APswd As String)      ObjectConnect = &quot;Provider=MSDASQL.9;Password=&quot; &amp; APswd &amp; &quot;;Persist Security Info=False;User ID=&quot; &amp; AID &amp; &quot;;Data Source=ServerName&quot;  End Function"}, {"owner": {"reputation": 116, "user_id": 4712035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f84b06a738d2bb6fefd72fb839f3e3e?s=128&d=identicon&r=PG&f=1", "display_name": "jbay", "link": "https://stackoverflow.com/users/4712035/jbay"}, "reply_to_user": {"reputation": 9, "user_id": 4146193, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000929572920/picture?type=large", "display_name": "Yashwanth Inti", "link": "https://stackoverflow.com/users/4146193/yashwanth-inti"}, "edited": false, "score": 0, "creation_date": 1427290984, "post_id": 29256078, "comment_id": 46717299, "body": "Otherwise if you cannot connect directly to the server then you need to get IT to create a nightly extract for you.  As I mentioned you can use this extract to automate in excel.  Do something like:  Private Sub Workbook_Open()    QueryTable.Refresh BackgroundQuery:=False end sub"}], "tags": [], "owner": {"reputation": 116, "user_id": 4712035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f84b06a738d2bb6fefd72fb839f3e3e?s=128&d=identicon&r=PG&f=1", "display_name": "jbay", "link": "https://stackoverflow.com/users/4712035/jbay"}, "is_accepted": false, "score": 0, "last_activity_date": 1427287522, "creation_date": 1427287522, "answer_id": 29256078, "question_id": 29255046, "link": "https://stackoverflow.com/questions/29255046/how-can-i-impoprt-data-from-sap-system-to-excel-using-vba/29256078#29256078", "title": "How can I impoprt data from SAP system to excel using VBA", "body": "<p>If you have access to SE16n you can export directly from there to csv or text file.  You can also get with IT to create a nightly spool that will dump a text file into a folder and then link directly to that file with excel.</p>\n"}], "owner": {"reputation": 9, "user_id": 4146193, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000929572920/picture?type=large", "display_name": "Yashwanth Inti", "link": "https://stackoverflow.com/users/4146193/yashwanth-inti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1766, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1427287522, "creation_date": 1427284761, "last_edit_date": 1531164843, "question_id": 29255046, "link": "https://stackoverflow.com/questions/29255046/how-can-i-impoprt-data-from-sap-system-to-excel-using-vba", "title": "How can I impoprt data from SAP system to excel using VBA", "body": "<p>Can anyone help me out regarding A  standard  code  for importing data from SAP SYSTEM TO EXCEL using VBA.  I use SE16 transaction and a table named .I need to import  data from TFACS table to excel using vba.</p>\n"}, {"tags": ["excel", "outlook", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2939, "user_id": 4711754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c25453f6a114ebb66aefcc27b0ab44d1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Allen", "link": "https://stackoverflow.com/users/4711754/andrew-allen"}, "edited": false, "score": 0, "creation_date": 1427290393, "post_id": 29256515, "comment_id": 46716865, "body": "thank you for the reply. I&#39;ll report back after reading through your links"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 1, "last_activity_date": 1427288691, "creation_date": 1427288691, "answer_id": 29256515, "question_id": 29254988, "link": "https://stackoverflow.com/questions/29254988/edit-table-text-within-outlook-email/29256515#29256515", "title": "Edit table text within Outlook email", "body": "<p>The Outlook uses Word as an email editor. You can use the Word object model to get the job done. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868196.aspx\" rel=\"nofollow\">WordEditor</a> property of the Inspector class returns an instance of the Word Document which represents the message body. </p>\n\n<p>You can read more about all possible ways of working with item bodies in the <a href=\"https://msdn.microsoft.com/en-us/library/dd492012(v=office.12).aspx\" rel=\"nofollow\">Chapter 17: Working with Item Bodies</a>.</p>\n"}], "owner": {"reputation": 2939, "user_id": 4711754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c25453f6a114ebb66aefcc27b0ab44d1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Allen", "link": "https://stackoverflow.com/users/4711754/andrew-allen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1451, "favorite_count": 0, "accepted_answer_id": 29256515, "answer_count": 1, "score": 0, "last_activity_date": 1478349632, "creation_date": 1427284603, "last_edit_date": 1531161705, "question_id": 29254988, "link": "https://stackoverflow.com/questions/29254988/edit-table-text-within-outlook-email", "title": "Edit table text within Outlook email", "body": "<p>I want to be able to find and replace text within an email that has been embedded in a table using Excel VBA. I already know how to open the existing  outlook email. From the forums I understand that the following code works for text only but not when it's embedded in a table within the  email.  </p>\n\n<p>Is there any way to use bookmarks? Any attempt I've made leaves the email body untouched or strips all formatting. </p>\n\n<pre><code>With OutMail\n    .To = UserForm1.TextBox4.Text\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"This is my Subject line\"\n    .HTMLBody = Replace(.HTMLBody, \"&lt;First Name&gt;\", UserForm1.TextBox5.Text)\n    .HTMLBody = Replace(.HTMLBody, \"&lt;Last Name&gt;\", UserForm1.TextBox6.Text)\n    .Display\nEnd With\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007", "dsn"], "comments": [{"owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "edited": false, "score": 0, "creation_date": 1427286601, "post_id": 29254055, "comment_id": 46714201, "body": "Can you share the code you are using to update the recordset?"}, {"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1427290272, "post_id": 29254055, "comment_id": 46716767, "body": "Is the recordset in question a single table or a query?"}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 4711707, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1037383746276136/picture?type=large", "display_name": "Noora No", "link": "https://stackoverflow.com/users/4711707/noora-no"}, "edited": false, "score": 0, "creation_date": 1427350365, "post_id": 29260822, "comment_id": 46744364, "body": "thank you for the reply, i checked the linked table all of them have a primary key specified in SQL server,and i can see the keys in query builder in Access, except one table that dose not have a primary key, so how can i modify my code?, i updated my question with module code that will link the tables."}], "tags": [], "owner": {"reputation": 33619, "user_id": 6884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c486c90e9e7a87a23ea89c09f27e33da?s=128&d=identicon&r=PG", "display_name": "Christian Specht", "link": "https://stackoverflow.com/users/6884/christian-specht"}, "is_accepted": true, "score": 1, "last_activity_date": 1427299781, "last_edit_date": 1495541179, "creation_date": 1427299781, "answer_id": 29260822, "question_id": 29254055, "link": "https://stackoverflow.com/questions/29254055/run-time-error-3326-this-recordset-is-not-updateable/29260822#29260822", "title": "Run-time error &#39;3326&#39; This Recordset is not updateable", "body": "<p>Access is able to update linked tables <strong>only</strong> when they have a primary key.<br>\nWhen they don't have one, you'll get the \"This Recordset is not updateable\" error.</p>\n\n<p>If the underlying SQL Server table has a primary key, Access will usually detect it and use it in the linked table as well.</p>\n\n<p>If the table does <strong>not</strong> have a primary key on the server, or if it's a view and not a table, Access is not able to set a primary key by itself.</p>\n\n<p>If you link a view manually per DSN, a window will pop up and ask you to select the columns which Access should consider as the primary key:</p>\n\n<p><img src=\"https://i.stack.imgur.com/FXnQw.jpg\" alt=\"select unique record identifier\">  </p>\n\n<p>When you link the table DSN-less (i.e. per code) and you don't specify a primary key, Access will link the table without primary key.</p>\n\n<p><strong>So I suppose that the table you're talking about is either a view or it has no primary key.<br>\nWhen it was originally linked with DSN, someone selected the primary key in the popup window shown above.<br>\nWhen you re-linked it with your DSN-less code, you probably didn't set the primary key, and that's why you're getting the \"This Recordset is not updateable\" error now.</strong></p>\n\n<p><strong>Solution: After linking the table with your DSN-less code, <a href=\"https://stackoverflow.com/a/11529053/6884\">explicitly set the primary key via VBA code</a>.</strong></p>\n"}], "owner": {"reputation": 179, "user_id": 4711707, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1037383746276136/picture?type=large", "display_name": "Noora No", "link": "https://stackoverflow.com/users/4711707/noora-no"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6207, "favorite_count": 0, "accepted_answer_id": 29260822, "answer_count": 1, "score": 1, "last_activity_date": 1427350603, "creation_date": 1427281885, "last_edit_date": 1427350603, "question_id": 29254055, "link": "https://stackoverflow.com/questions/29254055/run-time-error-3326-this-recordset-is-not-updateable", "title": "Run-time error &#39;3326&#39; This Recordset is not updateable", "body": "<p>i have an application that was created using Access 2007, its working perfectly with DSN, i update the application to use DSN-less connection to SQL-Server, i didn't change any code in the application, but when i run the application i am getting this error</p>\n\n<blockquote>\n  <p>Run-time error '3326' This Recordset is not updateable</p>\n</blockquote>\n\n<pre><code>Sub DnsLessLinkTable()\n\n    Dim td As TableDef\n    Dim stConnect As String\n    Dim strTablesName(0 To 7) As String\n    strTablesName(0) = \"dbo_Directorate\"\n    strTablesName(1) = \"dbo_Nationality\"\n    strTablesName(2) = \"dbo_personal\"\n    strTablesName(3) = \"dbo_Qualification\"\n    strTablesName(4) = \"dbo_Qualimain\"\n    strTablesName(5) = \"dbo_Qualisec\"\n    strTablesName(6) = \"dbo_Section\"\n    strTablesName(7) = \"dbo_Trips\"\n\n    For Each td In CurrentDb.TableDefs\n       For Each TableName In strTablesName\n           If td.Name = TableName Then\n              CurrentDb.TableDefs.Delete TableName\n           End If\n       Next\n   Next\n\n   stConnect = \"ODBC;Driver={SQL Server};Server=ServerNametest;Database=DBName;Uid=user;Pwd=password;\"\n   For Each TableName In strTablesName\n       Dim splitTarget As Variant\n       splitTarget = Split(TableName, \"_\")\n       Set td = CurrentDb.CreateTableDef(TableName, dbAttachSavePWD, splitTarget(1), stConnect)\n       CurrentDb.TableDefs.Append td\n       AttachDSNLessTable = True\n   Next\n   Err.Description\nEnd Sub\n</code></pre>\n\n<p><strong>the only table that dosnt have a primary key is [Personal] in SQL server and i linked it to [dbo_personal]</strong></p>\n\n<p>the DSN-less module was run successfully and updated all the linked table, i am really struggling with this application,\nnote that before DSN-less connection i was using the same connection string on building the DSN</p>\n\n<p>any suggestion that will help</p>\n"}, {"tags": ["excel", "ms-word", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1427281891, "post_id": 29253784, "comment_id": 46711179, "body": "Word&#39;s <code>Printout</code> method doesn&#39;t have <code>IgnorePrintAreas</code> or <code>Preview</code> arguments - why do you think you need them?"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1427282282, "post_id": 29253784, "comment_id": 46711396, "body": "it show me a warning about wrong document margings, so which arguments have word&#39;s Printout method?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1427282636, "post_id": 29253784, "comment_id": 46711589, "body": "Look it up. ;) <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837331.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1427282746, "post_id": 29253784, "comment_id": 46711658, "body": "Ok write the answer i will accept thanks? and what about marging warning? how just print document without any warnings ?"}], "answers": [{"comments": [{"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1427285662, "post_id": 29254460, "comment_id": 46713483, "body": "But warnings still appears"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1427285848, "post_id": 29254460, "comment_id": 46713644, "body": "I&#39;m afraid I don&#39;t know how to stop that then."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1427283113, "creation_date": 1427283113, "answer_id": 29254460, "question_id": 29253784, "link": "https://stackoverflow.com/questions/29253784/word-doc-print-from-excel-error-named-argument-not-found/29254460#29254460", "title": "Word doc print from Excel Error Named argument not found", "body": "<p>Word's <code>Printout</code> method doesn't have <code>IgnorePrintAreas</code> or <code>Preview</code> arguments. There's a list of the available arguments here: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837331.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff837331.aspx?f=255&amp;MSPPError=-2147217396</a></p>\n\n<p>You may be able to suppress the margin warning using:</p>\n\n<pre><code>WA.Displayalerts = 0\nWD.PrintOut Copies:=1, Collate:=True\nWA.Displayalerts = -1\n</code></pre>\n"}], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 29254460, "answer_count": 1, "score": -1, "last_activity_date": 1427297008, "creation_date": 1427281197, "last_edit_date": 1531161705, "question_id": 29253784, "link": "https://stackoverflow.com/questions/29253784/word-doc-print-from-excel-error-named-argument-not-found", "title": "Word doc print from Excel Error Named argument not found", "body": "<pre><code>Dim WA As Object, WD As Object\n    Set WA = CreateObject(\"Word.Application\")\n\nSet WD = WA.Documents.Add(Filename)\n    With WD\n        .PrintOut Copies:=1, _\n             Collate:=True, IgnorePrintAreas:=False, Preview:=False\n    End With\nWD.Close False\nWA.Quit False\nSet WD = Nothing\nSet WA = Nothing\n</code></pre>\n\n<p>I get error \"Named argument not found\", only works </p>\n\n<blockquote>\n  <p>.PrintOut Copies:=1</p>\n</blockquote>\n\n<p>But it show me a warning about wrong document margings</p>\n\n<p>a reference in my project by clicking \"Tools\" ---> \"References...\" and then clicking the checkbox next to \"Microsoft Word 15.0 Object Library\". Selected</p>\n\n<p>No of  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840681.aspx\" rel=\"nofollow\">this parameters</a> working\nSo how Printout with all i needed parametrs?</p>\n"}, {"tags": ["vba", "excel", "vbe"], "comments": [{"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1427284117, "post_id": 29253704, "comment_id": 46712520, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/2649844/excel-tab-sheet-names-vs-visual-basic-sheet-names\">Excel tab sheet names vs. Visual Basic sheet names</a>"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1427284139, "post_id": 29253704, "comment_id": 46712535, "body": "Also related: <a href=\"http://stackoverflow.com/questions/27169070/identifying-a-worksheet-other-than-by-its-name\" title=\"identifying a worksheet other than by its name\">stackoverflow.com/questions/27169070/&hellip;</a>  and quite a few more: <a href=\"http://stackoverflow.com/search?q=sheet+name+codename\">stackoverflow.com/search?q=sheet+name+codename</a>"}], "answers": [{"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1427282341, "post_id": 29254113, "comment_id": 46711430, "body": "good shout on the further info about referencing in the same project."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 5, "last_activity_date": 1427283868, "last_edit_date": 1495535433, "creation_date": 1427282080, "answer_id": 29254113, "question_id": 29253704, "link": "https://stackoverflow.com/questions/29253704/worksheet-names-in-vbe/29254113#29254113", "title": "Worksheet names in VBE", "body": "<p><code>Control</code> is the code name of the sheet, whereas <code>Plan 1</code> is the tab name of the sheet. The latter can be easily changed by the user so it's safer to use the codename if you can - for example, referring to:</p>\n\n<pre><code>control.range(\"A1:A10\")\n</code></pre>\n\n<p>rather than:</p>\n\n<pre><code>sheets(\"Plan 1\").Range(\"A1:A10\")\n</code></pre>\n\n<p>Note that you cannot use sheet codenames to refer to sheets in workbooks other than the one containing the code unless you set a reference to the project of that workbook, or use <a href=\"https://stackoverflow.com/questions/25203173/fully-reference-a-worksheet-by-codename\">a function that loops through each sheet in the other workbook testing the codename property of each</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 2, "last_activity_date": 1427282149, "creation_date": 1427282149, "answer_id": 29254138, "question_id": 29253704, "link": "https://stackoverflow.com/questions/29253704/worksheet-names-in-vbe/29254138#29254138", "title": "Worksheet names in VBE", "body": "<p>\"Plan1\" is the tab name, which is what appears on the tab at the bottom of the worksheet.  </p>\n\n<p>\"Control\" is the code name, which can be used in VBA to reference that particular worksheet object directly.</p>\n\n<p><code>Sheets(\"Plan1\").Cells(1, 1).Value</code> and <code>Control.Cells(1, 1).Value</code> will produce the same output.</p>\n"}, {"tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 0, "last_activity_date": 1482444377, "creation_date": 1482444377, "answer_id": 41292332, "question_id": 29253704, "link": "https://stackoverflow.com/questions/29253704/worksheet-names-in-vbe/41292332#41292332", "title": "Worksheet names in VBE", "body": "<p>Each document-type vbComponent in the VBE has a <code>Name</code> and a <code>CodeName</code>:</p>\n\n<ul>\n<li><code>Name</code> is the name that is visible on the sheet tab in the Excel UI.</li>\n<li><code>CodeName</code> is the name that the sheet object can be referred to in your VBA.</li>\n</ul>\n\n<p>Example:</p>\n\n<pre><code>Sub Names()\n\n  Debug.Print Control.Name              'Prints \"Plan 1\"\n  Debug.Print Control.CodeName          'Prints \"Control\"\n\n  'This approach uses the sheet name in a call to `Sheets`,\n  ' which will break if a user changes the name of the sheet\n  'The sheets collection returns an object, so you don't get\n  ' Intellisense, or compile-time error checking\n  Debug.Print Sheets(\"Plan 1\").Name     'Prints \"Plan 1\"\n  Debug.Print Sheets(\"Plan 1\").CodeName 'Prints \"Control\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 29254113, "answer_count": 3, "score": 2, "last_activity_date": 1482444377, "creation_date": 1427281000, "last_edit_date": 1531164843, "question_id": 29253704, "link": "https://stackoverflow.com/questions/29253704/worksheet-names-in-vbe", "title": "Worksheet names in VBE", "body": "<p>I've noticed that my workbook has two different names for each component in the VBE.\nWhat is the difference between name1 and name2?\nWhich one should I refer to, so I will be sure my macro will work?</p>\n\n<p><img src=\"https://i.stack.imgur.com/A5gFi.jpg\" alt=\"enter image description here\"> </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1427280672, "post_id": 29253419, "comment_id": 46710449, "body": "Your code would be so much easier to read and understand if it was indented. I can&#39;t be bothered doing it so it&#39;s up to you."}, {"owner": {"reputation": 3, "user_id": 4711570, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152850450422620/picture?type=large", "display_name": "Kurt Desira", "link": "https://stackoverflow.com/users/4711570/kurt-desira"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1427281405, "post_id": 29253419, "comment_id": 46710881, "body": "Hi Mark, iv updated it, however indentation is not coming as it should be for a reason or another."}, {"owner": {"reputation": 520, "user_id": 4342155, "user_type": "registered", "profile_image": "https://graph.facebook.com/553839289/picture?type=large", "display_name": "Mark Moore", "link": "https://stackoverflow.com/users/4342155/mark-moore"}, "edited": false, "score": 1, "creation_date": 1427281725, "post_id": 29253419, "comment_id": 46711078, "body": "It would be a big change for you but any code that loops on a lot of cells can take quite a while, so in this scenario I always use arrays.  Basic concept is that each iteration of a loop reading a cell is effectively an I/O between the software layers of the code and the worksheet, so more cells = more i/o.   Is you use an array method, you read the contents of both sheets into an array (1 each) = 2 I/O&#39;s - then do what ever you want in the code, maybe writing out to another array or updating the existing ones, and at the end, write any updated or new array back to your target.  3 I/O&#39;s"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 1, "creation_date": 1427283464, "post_id": 29253419, "comment_id": 46712109, "body": "As your code is working, albeit slowly, your question may get more answers on <a href=\"http://codereview.stackexchange.com/\">Code review</a>"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1427284299, "post_id": 29253419, "comment_id": 46712628, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/6134002/vba-excel-large-data-manipulation-getting-memory-issue\">VBA Excel large data manipulation getting memory issue</a>. Also very related: <a href=\"http://stackoverflow.com/questions/5387929/vba-macro-to-compare-all-cells-of-two-excel-files\" title=\"vba macro to compare all cells of two excel files\">stackoverflow.com/questions/5387929/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4711570, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152850450422620/picture?type=large", "display_name": "Kurt Desira", "link": "https://stackoverflow.com/users/4711570/kurt-desira"}, "edited": false, "score": 0, "creation_date": 1427308300, "post_id": 29254808, "comment_id": 46729358, "body": "thanks very helpful !  saved me a lot of time :)"}], "tags": [], "owner": {"reputation": 1047, "user_id": 4669839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O9FCz.png?s=128&g=1", "display_name": "cybermike", "link": "https://stackoverflow.com/users/4669839/cybermike"}, "is_accepted": true, "score": 1, "last_activity_date": 1427285379, "last_edit_date": 1427285379, "creation_date": 1427284094, "answer_id": 29254808, "question_id": 29253419, "link": "https://stackoverflow.com/questions/29253419/vba-comparing-from-two-sheets-is-too-slow/29254808#29254808", "title": "VBA Comparing from two sheets is too slow?", "body": "<p>Some suggestions:</p>\n\n<ul>\n<li><p>Since you are suppressing ScreenUpdating, and you are (quite correctly) not using copy and paste to move the data from X.ActiveSheet to Sheet1, then you really don't need the line \"ThisWorkbook1.Sheets(\"Sheet1\").Activate\" repeating over and over in the loop. An Activate call can be quite time consuming even when Sheet1 is already activated, and its not like you are flipping which sheet is active.</p></li>\n<li><p>Also, you are re-opening \"E:\\Partner_Commission_Compiler\\Repository\\Transaction_Charges.xlsx\" over and over in the loop. Again needless, and without a doubt is consuming more and more CPU time when you do not need to.  </p></li>\n</ul>\n\n<p>The following two lines should be moved before any of your loops:</p>\n\n<pre><code>Set X = Workbooks.Open(\"E:\\Partner_Commission_Compiler\\Repository\\Transaction_Charges.xlsx\")\nFinalrow2 = X.ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 4711570, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152850450422620/picture?type=large", "display_name": "Kurt Desira", "link": "https://stackoverflow.com/users/4711570/kurt-desira"}, "edited": false, "score": 0, "creation_date": 1427308316, "post_id": 29256913, "comment_id": 46729368, "body": "also very helpful thanks :)"}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 1, "last_activity_date": 1427289762, "creation_date": 1427289762, "answer_id": 29256913, "question_id": 29253419, "link": "https://stackoverflow.com/questions/29253419/vba-comparing-from-two-sheets-is-too-slow/29256913#29256913", "title": "VBA Comparing from two sheets is too slow?", "body": "<p>In addition to cybermike's fine suggestions (not opening the file on every loop should save significant time), you could try these changes.</p>\n\n<p>Change this:</p>\n\n<pre><code>CardBrand2 = Sheets(\"sheet2\").Cells(K, 3).Value\nIf CardBrand = CardBrand2 Then\n</code></pre>\n\n<p>to this</p>\n\n<pre><code>If Sheets(\"sheet2\").Cells(K, 3) = Sheets(\"sheet2\").Cells(K, 3).Value\n</code></pre>\n\n<p>You have:</p>\n\n<pre><code>Dim ASI\n</code></pre>\n\n<p>Which declares it a <code>Variant</code>. Every time your code uses <code>ASI</code>, Excel has to decipher what type of data is stored in <code>ASI</code> to determine how to assign or compare it. If you declare it a specific type, it can skip that determination step which will speed up execution. Since you're assigning it to the contents of a cell, you could probably specify <code>String</code> or <code>Integer</code>. If it's sometimes one, sometimes the other, <code>Dim as String</code>, then explicitly <code>CStr(cell).value</code> and do all your comparisons as strings. It will again eliminate time needed for Excel to figure out what to do with the values.</p>\n\n<p>You can replace: </p>\n\n<pre><code>TC_ASI = X.ActiveSheet.Cells(I, 6).Value\nTC_STD = X.ActiveSheet.Cells(I, 11).Value\nTC_ID = X.ActiveSheet.Cells(I, 1).Value\nIf (TC_ASI = ASI) And (TC_STD = STD Or TC_STD = \"All\") And TC_ID = ID Then\n  TC_Perc = X.ActiveSheet.Cells(I, 19).Value\n  TC_Base = X.ActiveSheet.Cells(I, 20).Value\n  ThisWorkbook1.Sheets(\"Sheet1\").Activate\n  Sheets(\"sheet1\").Cells(G, 13).Value = TC_Perc\n  Sheets(\"sheet1\").Cells(G, 14).Value = TC_Base\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>If x.cells(i,6) = Sheets(\"sheet2\").Cells(K, 1) AND _\n   (x.cells(1,11) = Sheets(\"sheet1\").Cells(G, 10)  OR _\n    x.cells(1,11) = \"All\") AND _\n   x.Cells(i,1) = Sheets(\"sheet1\").Cells(G, 5) Then\n  Sheets(\"sheet1\").Cells(G, 13).Value = X.Cells(I, 19)\n  Sheets(\"sheet1\").Cells(G, 14).Value = X.Cells(I, 20)\n</code></pre>\n\n<p>Removing all those assignments on each loop will save some processing time. It's a bit harder to read the code, though, so you may want to leave some pseudocode in comments to help remember what all those different cells represent.</p>\n"}], "owner": {"reputation": 3, "user_id": 4711570, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152850450422620/picture?type=large", "display_name": "Kurt Desira", "link": "https://stackoverflow.com/users/4711570/kurt-desira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "closed_date": 1427376099, "accepted_answer_id": 29254808, "answer_count": 2, "score": 0, "last_activity_date": 1427289762, "creation_date": 1427280188, "last_edit_date": 1531164843, "question_id": 29253419, "link": "https://stackoverflow.com/questions/29253419/vba-comparing-from-two-sheets-is-too-slow", "closed_reason": "Duplicate", "title": "VBA Comparing from two sheets is too slow?", "body": "<p>So here is my code , im trying to compare a sheet containing 3000 rows with another one of 5000 rows, however it is working too slow, can anyone help ?    </p>\n\n<pre><code>Dim G As Long\nDim K As Long\nDim CardBrand As String\nDim STD As String\nDim CardBrand2 As String\nDim ASI\nDim ID As String\nDim X As Workbook\nDim FinalRow As Long\nDim Finalrow2 As Long\nDim I As Long\nDim TC_STD As String\nDim TC_ASI As String\nDim TC_Perc As Double\nDim TC_Base As Double\nDim TC_ID As String\n\n\n    Application.ScreenUpdating = False\n    FinalRow = Cells(Rows.Count, \"I\").End(xlUp).Row\n\n\n    For G = 5 To FinalRow\n\n        CardBrand = Sheets(\"sheet1\").Cells(G, 9).Value\n        STD = Sheets(\"sheet1\").Cells(G, 10).Value\n        ID = Sheets(\"sheet1\").Cells(G, 5).Value\n\n        For K = 2 To 51\n\n            CardBrand2 = Sheets(\"sheet2\").Cells(K, 3).Value\n\n            If CardBrand = CardBrand2 Then\n\n                ASI = Sheets(\"sheet2\").Cells(K, 1).Value\n                Set X = Workbooks.Open(\"E:\\Partner_Commission_Compiler\\Repository\\Transaction_Charges.xlsx\")\n                Finalrow2 = X.ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n                For I = 1 To Finalrow2\n\n                    TC_ASI = X.ActiveSheet.Cells(I, 6).Value\n                    TC_STD = X.ActiveSheet.Cells(I, 11).Value\n                    TC_ID = X.ActiveSheet.Cells(I, 1).Value\n\n                        If (TC_ASI = ASI) And (TC_STD = STD Or TC_STD = \"All\") And TC_ID = ID Then\n\n                            TC_Perc = X.ActiveSheet.Cells(I, 19).Value\n                            TC_Base = X.ActiveSheet.Cells(I, 20).Value\n                            ThisWorkbook1.Sheets(\"Sheet1\").Activate\n\n                            Sheets(\"sheet1\").Cells(G, 13).Value = TC_Perc\n                            Sheets(\"sheet1\").Cells(G, 14).Value = TC_Base\n                        End If\n                Next I\n            End If\n        Next K\n    Next G\n\n    X.Close (False)\n    Application.ScreenUpdating = True\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1427279893, "post_id": 29253232, "comment_id": 46710011, "body": "Why are you looping through over a million rows when you can just use <code>Range.Find()</code> ?"}, {"owner": {"reputation": 665, "user_id": 4259417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82ce39c7bfa96f76ec14a5dffdd27ef?s=128&d=identicon&r=PG", "display_name": "Shauno_88", "link": "https://stackoverflow.com/users/4259417/shauno-88"}, "edited": false, "score": 0, "creation_date": 1427280151, "post_id": 29253232, "comment_id": 46710149, "body": "But if you do want to loop through, maybe set i = 1 and use &quot;Do until i &gt; Rng.Columns.Count&quot; and at the end i=i+1"}, {"owner": {"reputation": 469, "user_id": 2347043, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fd5ada534ffbdfa94d40ed566fbe34d2?s=128&d=identicon&r=PG", "display_name": "Sara", "link": "https://stackoverflow.com/users/2347043/sara"}, "edited": false, "score": 0, "creation_date": 1427280227, "post_id": 29253232, "comment_id": 46710203, "body": "I need to find a value in a matrix that covers mutliple columns and rows. I figured it would be easier if I made my own functions. I&#39;m totally new to VBA and Excel (just started a week ago). I did not know Range.Find(), as I can see it does not return a position but the content of the first occurrence (I may use it wrong)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1427280460, "post_id": 29253232, "comment_id": 46710334, "body": "I&#39;m still learning almost everytime... Thx SO and J-F! Maybe try both ByRef and ByVal parameters, or switch row from integer to double or long (probably not a problem...) because your code seem good"}, {"owner": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "edited": false, "score": 1, "creation_date": 1427281174, "post_id": 29253232, "comment_id": 46710756, "body": "@Sara Range.Find() returns the default property of the range object, which is the value. You can just use Range.Find().Row to return the Row property."}, {"owner": {"reputation": 469, "user_id": 2347043, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fd5ada534ffbdfa94d40ed566fbe34d2?s=128&d=identicon&r=PG", "display_name": "Sara", "link": "https://stackoverflow.com/users/2347043/sara"}, "edited": false, "score": 0, "creation_date": 1427281380, "post_id": 29253232, "comment_id": 46710866, "body": "Thak you I&#39;ll try it"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1427281590, "post_id": 29253232, "comment_id": 46711003, "body": "@Sara you can use something like <code>Set rngVar = rng.Find(&quot;something&quot;)</code> and then <code>rngVar.Address</code> or <code>rngVar.Row</code> etc to get the position."}], "answers": [{"comments": [{"owner": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "edited": false, "score": 0, "creation_date": 1427280345, "post_id": 29253362, "comment_id": 46710265, "body": "+1 I would do this, but to OP just for future reference as well, when looping through all the rows in a worksheet, you are better off declaring the variable type as Long instead of Integer, because the Integer data type can only store values up to 32768."}, {"owner": {"reputation": 469, "user_id": 2347043, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fd5ada534ffbdfa94d40ed566fbe34d2?s=128&d=identicon&r=PG", "display_name": "Sara", "link": "https://stackoverflow.com/users/2347043/sara"}, "edited": false, "score": 0, "creation_date": 1427280534, "post_id": 29253362, "comment_id": 46710370, "body": "I need to loop through a unknown amount of columns and rows"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "edited": false, "score": 0, "creation_date": 1427281750, "post_id": 29253362, "comment_id": 46711094, "body": "@Dave Entirely pedantic I know, but an integer can hold up to 32,767 in VBA &lt;/ocd&gt;"}, {"owner": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "edited": false, "score": 1, "creation_date": 1427284365, "post_id": 29253362, "comment_id": 46712670, "body": "I forgot to mention up to but not including... ;)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1427290174, "post_id": 29253362, "comment_id": 46716690, "body": "&lt;3 I didn&#39;t knew that we can use an array with a range like this, that&#39;s awesome! :)"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1427291732, "post_id": 29253362, "comment_id": 46717867, "body": "@R3uK step through this line -&gt; <code>myArray = [A1:A10]</code> and then look at <code>myArray</code> in the locals window. ;)"}], "tags": [], "owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "is_accepted": true, "score": 3, "last_activity_date": 1427291412, "last_edit_date": 1427291412, "creation_date": 1427280059, "answer_id": 29253362, "question_id": 29253232, "link": "https://stackoverflow.com/questions/29253232/loop-through-an-entire-column-to-find-a-value/29253362#29253362", "title": "Loop through an entire column to find a value", "body": "<p>Why not just use the built-in <code>MATCH</code> function?</p>\n\n<pre><code>=MATCH(C3,A:A,0)\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/0fuAe.png\" alt=\"enter image description here\"></p>\n\n<hr>\n\n<p>... because you want to search many columns at once. To do so, you can use this UDF:</p>\n\n<pre><code>Function FindRow(lookFor As String, rng As Range)\n    Dim v As Variant\n    Dim iRow As Long\n    Dim iCol As Long\n\n    'Read contents of range into a Variant array\n    v = rng.Value \n\n    'Loop through contents to locate the desired element\n    For iRow = LBound(v, 1) To UBound(v, 1)\n        For iCol = LBound(v, 2) To UBound(v, 2)\n            If v(iRow, iCol) = lookFor Then\n                FindRow = iRow\n                Exit Function\n            End If\n        Next iCol\n    Next iRow\n\n\n\n    FindRow = CVErr(XlCVError.xlErrNA)\nEnd Function\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/1CHjc.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 469, "user_id": 2347043, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fd5ada534ffbdfa94d40ed566fbe34d2?s=128&d=identicon&r=PG", "display_name": "Sara", "link": "https://stackoverflow.com/users/2347043/sara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2535, "favorite_count": 0, "accepted_answer_id": 29253362, "answer_count": 1, "score": 0, "last_activity_date": 1431274762, "creation_date": 1427279649, "last_edit_date": 1431274762, "question_id": 29253232, "link": "https://stackoverflow.com/questions/29253232/loop-through-an-entire-column-to-find-a-value", "title": "Loop through an entire column to find a value", "body": "<p>How can I loop through all the rows of a column in VBA ?</p>\n\n<p>Here is my sample :</p>\n\n<pre><code>Function FindRow(Item As String, Rng As range) As Variant\n\nDim row As Integer\nDim col As Integer\n\nFor col = 1 To Rng.Columns.Count\n    For row = 1 To Rng.Rows.Count        \n        If Rng.Cells(row, col).Value = Item Then\n            FindRow = row + Rng.row - 1\n            Exit Function\n        End If\n    Next row\nNext col\n\nFindRow = CVErr(XlCVError.xlErrNA)\n\nEnd Function\n</code></pre>\n\n<p>If my range is a single column, Rng.Columns.Count is 1 and Rng.Rows.Count is 1048576. My function stops before entering the second For. If I add a watch on Rng.Cells(row, col).Value, I got an </p>\n\n<pre><code>&lt;Application-defined or object-defined error&gt; \n</code></pre>\n\n<p>in the watch window, but no pop-up.</p>\n\n<p>Thank you.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p><strong>Second solution</strong></p>\n\n<p>Using Rng.Find(Item).Row</p>\n\n<pre><code>Function FindRow(Item As String, Rng As range) As Variant\n\nFindRow = Rng.Find(Item).Row\n\nEnd Function\n</code></pre>\n\n<p>/!\\ It returns #VALUE instead of #N/A if the Item is not in the range</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1427289284, "creation_date": 1427289284, "answer_id": 29256735, "question_id": 29253220, "link": "https://stackoverflow.com/questions/29253220/open-an-excel-attachment-in-outlook-2010-using-vba/29256735#29256735", "title": "Open an Excel attachment in Outlook 2010 using VBA", "body": "<p>First of all, I'd suggest starting from the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736(v=office.14).aspx\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a> article in MSDN.</p>\n\n<p>You can assign a VBA macro to the Outlook rule, it should look like the following one:</p>\n\n<pre><code>public sub test(mail as MailItem)\n    ' \nend sub\n</code></pre>\n\n<p>where you can check out the mail object. It looks like you need to check out the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff865652.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Subject</a>, <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff868556.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">UnRead</a> and <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff866435.aspx\" rel=\"nofollow\">Attachments</a> properties of the MailItem class.</p>\n"}], "owner": {"reputation": 1, "user_id": 4711500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ac192126ab8ba96d424df9c1e05cfe?s=128&d=identicon&r=PG&f=1", "display_name": "zig", "link": "https://stackoverflow.com/users/4711500/zig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1748, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1593070151, "creation_date": 1427279621, "last_edit_date": 1593070151, "question_id": 29253220, "link": "https://stackoverflow.com/questions/29253220/open-an-excel-attachment-in-outlook-2010-using-vba", "title": "Open an Excel attachment in Outlook 2010 using VBA", "body": "<p>I would like to know how to Open an Excel attachment in my inbox Outlook 2010 with VBA code.</p>\n\n<p>I would like the code to:</p>\n\n<ol>\n<li>Check for a specific subject that does not change \"Test\"</li>\n<li>Check if that email is read or unread and if it is unread to use that one</li>\n</ol>\n\n<p>I have a rule in place where the emails are stored in a subfolder based on the subject but I can change it to go back to the main inbox</p>\n\n<p>I would really appreciate if you can explain what the code is doing as I am not familiar with the Outlook connection bit.</p>\n\n<hr>\n\n<p>This is what I have pulled together from various sites including stackoverflow it does the job.</p>\n\n<ul>\n<li>It seems to run for emails that have RE: in the subject for the 10PM and 5PM emails. I explicitly named subject of the two emails. Can anyone help me?  </li>\n<li>I am not familiar with declaring variables for Outlook objects. Have I declared the variables correctly?</li>\n<li>I would also like to copy the data within each file and paste it into another workbook. I would like the data to be pasted underneath the first data from each work book so it will need to find the last row and paste it 1 row below the last row for each data on each workbook onto the open workbook which is stored in another path.</li>\n</ul>\n\n<p>.</p>\n\n<pre><code>Sub DownloadAttachmentFirstUnreadEmail()\n\n    Const olFolderInbox = 6\n    Const AttachmentPath As String = \"C:\\My Documents\\Outlook Test\\\"\n\n    Dim oOlAtch As Object\n\n    Set objOutlook = CreateObject(\"Outlook.Application\")\n    Set objNamespace = objOutlook.GetNamespace(\"MAPI\")\n    Set objFolder = objNamespace.GetDefaultFolder(olFolderInbox)\n    Set objFolder = objFolder.Folders(\"**CLIENT ISSUES**\").Folders(\"*Daily Reports\").Folders(\"1. Open Trade Report\")\n\n    Set colItems = objFolder.Items\n    Set colFilteredItems1 = colItems.Restrict(\"[Unread] = True AND [Subject] = '10PM FXC Email notification for Martin Currie'\")\n    Set colFilteredItems2 = colItems.Restrict(\"[Unread] = True AND [Subject] = 'FXC Email notification for Martin Currie Funds'\")\n\n       '~~&gt; Check if there are any actual unread 10PM FXC emails\n    If colFilteredItems1.Count = 0 Then\n        MsgBox \"NO Unread 10PM Email In Inbox\"\n    Else\n        '~~&gt; Extract the attachment from the 1st unread email\n        For Each colItems In colFilteredItems1\n            '~~&gt; Check if the email actually has an attachment\n            If colItems.Attachments.Count &lt;&gt; 0 Then\n                For Each oOlAtch In colItems.Attachments\n                    '~~&gt; save the attachment and open them\n                    oOlAtch.SaveAsFile AttachmentPath &amp; oOlAtch.Filename\n                    Set wb = Workbooks.Open(Filename:=AttachmentPath &amp; oOlAtch.Filename)\n                Next oOlAtch\n            Else\n                MsgBox \"10PM email doesn't have an attachment\"\n            End If\n        Next colItems\n\n    End If\n\n           '~~&gt; Check if there are any actual unread FXC Email emails\n    If colFilteredItems2.Count = 0 Then\n        MsgBox \"NO Unread 5PM Email In Inbox\"\n    Else\n        '~~&gt; Extract the attachment from the 1st unread email\n        For Each colItems In colFilteredItems2\n            '~~&gt; Check if the email actually has an attachment\n            If colItems.Attachments.Count &lt;&gt; 0 Then\n                For Each oOlAtch In colItems.Attachments\n                    '~~&gt; save the attachment and open them\n                    oOlAtch.SaveAsFile AttachmentPath &amp; oOlAtch.Filename\n                    Set wb = Workbooks.Open(Filename:=AttachmentPath &amp; oOlAtch.Filename)\n                Next oOlAtch\n            Else\n                MsgBox \"5PM email doesn't have an attachment\"\n            End If\n        Next colItems\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["xml", "vba", "encoding"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 9379550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "joking", "link": "https://stackoverflow.com/users/9379550/joking"}, "is_accepted": false, "score": 0, "last_activity_date": 1611182684, "creation_date": 1611182684, "answer_id": 65818770, "question_id": 29252587, "link": "https://stackoverflow.com/questions/29252587/mxxmlwriter60-ignores-encoding-property/65818770#65818770", "title": "MXXMLWriter60 ignores encoding property", "body": "<p>I know that this question is quite old, but I stumpled across the same issue and finaly I found a working solution I like to share... maybe it helps others facing the same problem.</p>\n<p>Using a ADODB-Stream object as output target for the MXXMLWriter60 with matching encoding definitions results in the expected xml header.</p>\n<pre><code>Sub prettyPrintXML()\n\nDim stream As Object\nDim reader As New SAXXMLReader60\nDim writer As New MXXMLWriter60\nDim filename As String\n\nSet stream = CreateObject(&quot;ADODB.Stream&quot;)\nWith stream\n    .Type = 2\n    .Charset = &quot;iso-8859-1&quot;\n    .Open\nEnd With\n\nWith writer\n    .indent = True\n    .omitXMLDeclaration = False\n    .Encoding = &quot;iso-8859-1&quot;\n    .output = stream\nEnd With\n\nSet reader.contentHandler = writer\nSet reader.errorHandler = writer\n\nCall reader.putProperty(&quot;http://xml.org/sax/properties/declaration-handler&quot;, writer)\nCall reader.putProperty(&quot;http://xml.org/sax/properties/lexical-handler&quot;, writer)\n\nCall reader.Parse(&quot;&lt;rootElement&gt;&lt;levelOneItemOne&gt;&lt;levelTwoItemOne&gt;&lt;/levelTwoItemOne&gt;&lt;/levelOneItemOne&gt;&lt;levelOneItemTwo&gt;&lt;levelTwoItemOne&gt;&lt;/levelTwoItemOne&gt;&lt;levelTwoItemTwo&gt;&lt;/levelTwoItemTwo&gt;&lt;/levelOneItemTwo&gt;&lt;/rootElement&gt;&quot;)\n\nfilename = ThisWorkbook.Path &amp; &quot;\\prettyPrint.xml&quot;\nstream.SaveToFile filename, 2\nstream.Close\n\nEnd Sub\n</code></pre>\n<p>Gives the result</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot; standalone=&quot;no&quot;?&gt;\n&lt;rootElement&gt;\n    &lt;levelOneItemOne&gt;\n        &lt;levelTwoItemOne/&gt;\n    &lt;/levelOneItemOne&gt;\n    &lt;levelOneItemTwo&gt;\n        &lt;levelTwoItemOne/&gt;\n        &lt;levelTwoItemTwo/&gt;\n    &lt;/levelOneItemTwo&gt;\n&lt;/rootElement&gt;\n</code></pre>\n<p>The code base is from here: <a href=\"https://stackoverflow.com/questions/1118576/how-can-i-pretty-print-xml-source-using-vb6-and-msxml\">How can I pretty-print XML source using VB6 and MSXML?</a></p>\n"}], "owner": {"reputation": 480, "user_id": 4300087, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-36mCauZSegQ/AAAAAAAAAAI/AAAAAAAAAA8/HDMJV_GXBjA/photo.jpg?sz=128", "display_name": "FireEmerald", "link": "https://stackoverflow.com/users/4300087/fireemerald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 629, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1611182684, "creation_date": 1427277784, "question_id": 29252587, "link": "https://stackoverflow.com/questions/29252587/mxxmlwriter60-ignores-encoding-property", "title": "MXXMLWriter60 ignores encoding property", "body": "<p>I'm using a <strong><em>MXXMLWriter60</em></strong> in combination with a <strong><em>SAXXMLReader60</em></strong> to indent the output and add the correct encoding tag.</p>\n\n<p>The output content is indented but it seems like the encoding property is always ignored. Why?</p>\n\n<p>Input, loaded via DOMDocument60.Load(), looks like:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"iso-8859-15\"?&gt;\n</code></pre>\n\n<p>Sourcecode:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub SaveXmlAs(ByVal thisDOMDocument60 As DOMDocument60, ByVal thisEncoding As String, ByVal thisDestinationPath As String)\n\n    ' Set properties on the XML writer - including BOM, XML declaration and encoding\n    Dim xmlWriter As New MXXMLWriter60\n    With xmlWriter\n        .Encoding = \"iso-8859-15\"\n        '.Version = \"1.0\"\" encoding=\"\"iso-8859-15\" Hacky solution like hell...\n        .byteOrderMark = True\n        .omitXMLDeclaration = False\n        .indent = True\n    End With\n\n    ' Set the XML writer to the SAX content handler.\n    Dim xmlReader As New SAXXMLReader60\n    With xmlReader\n        Set .contentHandler = xmlWriter\n        Set .dtdHandler = xmlWriter\n        Set .errorHandler = xmlWriter\n\n        ' Now pass the DOM through the SAX handler, and it will call the writer\n        .Parse thisDOMDocument60\n    End With\n\n    ' Let the writer do its thing\n    Open thisDestinationPath For Output As #1\n        Print #1, xmlWriter.output\n    Close #1\nEnd Sub\n</code></pre>\n\n<p>The output always looks like:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" standalone=\"no\"?&gt;\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "is_accepted": false, "score": 0, "last_activity_date": 1427903289, "creation_date": 1427903289, "answer_id": 29395259, "question_id": 29252134, "link": "https://stackoverflow.com/questions/29252134/vba-powerpoint-slide-table-data-to-combobox-item/29395259#29395259", "title": "VBA Powerpoint slide table data to combobox item", "body": "<p>To read the contents of the first cells of a row in a PowerPoint table this is the starting point.</p>\n\n<pre><code>Dim tbl As Table \nDim i As Long\n\nSet tbl = ActivePresentation.Slides(1).Shapes(2).Table\nFor i = 1 To tbl.Rows.Count\n    Debug.Print tbl.Cell(i, 1).Shape.TextFrame2.TextRange.Text\nNext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4711238, "user_type": "registered", "profile_image": "https://graph.facebook.com/1083988194960141/picture?type=large", "display_name": "J\u0101nis Melders", "link": "https://stackoverflow.com/users/4711238/j%c4%81nis-melders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 372, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480025865, "creation_date": 1427276599, "last_edit_date": 1480025865, "question_id": 29252134, "link": "https://stackoverflow.com/questions/29252134/vba-powerpoint-slide-table-data-to-combobox-item", "title": "VBA Powerpoint slide table data to combobox item", "body": "<p>This is my first question, so sorry for terminology. \nI'm beginner in VBA, so I'm stopped in few questions.</p>\n\n<p>I'm working in Powerpoint. I have combobox and I want to add items from table (it could be as table, or Excel spreadSheet) which is on previous slide.</p>\n\n<p>I found one example for Excel (I don't know if will work in PPT):</p>\n\n<pre><code>Sub Loadbox()\n    row_review = 1\n    Dim TheSheet As ?????\n    Set TheSheet = ?????\n    Do\n    DoEvents\n    row_review = row_review + 1\n    item_in_review = TheSheet.Range(\"A\" &amp; row_review)\n        If Len(item_inreview) &gt; 0 Then ComboBox1.AddItem (item_in_review)\n\n    Loop Until item_in_review = \"\"\nEnd Sub\n</code></pre>\n\n<p>But I couldn't understand how to define table from witch I get data for item.</p>\n\n<p>Maybe there is better way how to do it?</p>\n"}, {"tags": ["vba", "email", "excel", "outlook"], "comments": [{"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1427277008, "post_id": 29251868, "comment_id": 46708222, "body": "What is in <code>B4</code> - a file path?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1427277550, "post_id": 29251868, "comment_id": 46708575, "body": "Loop through the range of file paths and add each one in turn."}, {"owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "edited": false, "score": 0, "creation_date": 1427278190, "post_id": 29251868, "comment_id": 46708953, "body": "You can use <code>.Attachments.Add</code> multiple times times to add each attachment. Each time reference it to a different path possibly using a loop."}, {"owner": {"reputation": 31, "user_id": 4711292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152582890012563/picture?type=large", "display_name": "Thomas Varghese", "link": "https://stackoverflow.com/users/4711292/thomas-varghese"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1427279594, "post_id": 29251868, "comment_id": 46709833, "body": "@brettdj Yes, B4 has a file path, I have multiple paths in B5, B6 as well, etc"}, {"owner": {"reputation": 31, "user_id": 4711292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152582890012563/picture?type=large", "display_name": "Thomas Varghese", "link": "https://stackoverflow.com/users/4711292/thomas-varghese"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1427279698, "post_id": 29251868, "comment_id": 46709899, "body": "@Rory Can you help me out with the code ?"}, {"owner": {"reputation": 31, "user_id": 4711292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152582890012563/picture?type=large", "display_name": "Thomas Varghese", "link": "https://stackoverflow.com/users/4711292/thomas-varghese"}, "reply_to_user": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "edited": false, "score": 0, "creation_date": 1427279712, "post_id": 29251868, "comment_id": 46709915, "body": "@izzymo Can you help me out with the code ?"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4711292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152582890012563/picture?type=large", "display_name": "Thomas Varghese", "link": "https://stackoverflow.com/users/4711292/thomas-varghese"}, "edited": false, "score": 0, "creation_date": 1427283880, "post_id": 29253276, "comment_id": 46712372, "body": "Hi Abhijeet any way I can make this dynamic??"}], "tags": [], "owner": {"reputation": 101, "user_id": 4537141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12922249ab999d39c095198d5961cd49?s=128&d=identicon&r=PG&f=1", "display_name": "Abhijeet Shukla", "link": "https://stackoverflow.com/users/4537141/abhijeet-shukla"}, "is_accepted": false, "score": 1, "last_activity_date": 1427279790, "creation_date": 1427279790, "answer_id": 29253276, "question_id": 29251868, "link": "https://stackoverflow.com/questions/29251868/sending-multiple-attachments-from-excel-sheet-with-vba/29253276#29253276", "title": "Sending multiple attachments from excel sheet with VBA", "body": "<p>Enclose your .Attachments.Add statement in loop. Something like below might work</p>\n\n<pre><code>    For i = 4 To 6\n      .Attachments.Add Range(\"B\" &amp; i).Value\n    Next i \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "is_accepted": false, "score": 1, "last_activity_date": 1427284659, "creation_date": 1427284659, "answer_id": 29255017, "question_id": 29251868, "link": "https://stackoverflow.com/questions/29251868/sending-multiple-attachments-from-excel-sheet-with-vba/29255017#29255017", "title": "Sending multiple attachments from excel sheet with VBA", "body": "<p>To make it Dynamic you can set the upper limit of i to the last row in Column B</p>\n\n<pre><code>For i = 4 To Range(\"B\" &amp; rows.count).end(xlUp).row\n  .Attachments.Add Range(\"B\" &amp; i).Value\nNext i \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1427334454, "creation_date": 1427334454, "answer_id": 29269734, "question_id": 29251868, "link": "https://stackoverflow.com/questions/29251868/sending-multiple-attachments-from-excel-sheet-with-vba/29269734#29269734", "title": "Sending multiple attachments from excel sheet with VBA", "body": "<p>This updated code:</p>\n\n<ol>\n<li>Looks for file names from <code>B4</code></li>\n<li>Uses <code>Dir</code> to ensure the attached files actually exist at the specified path</li>\n<li><p>Tidies up the worksheet code (<code>Activate</code> is unnecessary)</p>\n\n<pre><code>Sub CreateMail()\n\nDim objOutlook As Object\nDim objMail As Object\nDim rngTo As Range\nDim rngSubject As Range\nDim rngBody As Range\nDim rngAttach As Range\nDim rng2 As Range\nDim ws As Worksheet\n\n\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objMail = objOutlook.CreateItem(0)\n\nApplication.ScreenUpdating = False\nSet ws = Worksheets(\"Mail List\")\n\nWith ws\n    Set rngTo = .Range(\"B1\")\n    Set rngSubject = .Range(\"B2\")\n    Set rngBody = .Range(\"B3\")\n    Set rngAttach = ws.Range(ws.[b4], ws.Cells(Rows.Count, \"B\").End(xlUp))\nEnd With\n\nWith objMail\n    .To = rngTo.Value\n    .Subject = rngSubject.Value\n    .body = rngBody.Value\n    For Each rng1 In rngAttach.Cells\n        If Len(Dir(rng1)) &gt; 0 Then .Attachments.Add rng1.Value\n    Next\n\n    .display 'Instead of .Display, you can use .Send to send the email _\n                or .Save to save a copy in the drafts folder\nEnd With\n\nSet objOutlook = Nothing\nSet objMail = Nothing\nSet rngTo = Nothing\nSet rngSubject = Nothing\nSet rngBody = Nothing\nSet rngAttach = Nothing\n\nEnd Sub\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 31, "user_id": 4711292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152582890012563/picture?type=large", "display_name": "Thomas Varghese", "link": "https://stackoverflow.com/users/4711292/thomas-varghese"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3110, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1480284181, "creation_date": 1427275832, "last_edit_date": 1427277216, "question_id": 29251868, "link": "https://stackoverflow.com/questions/29251868/sending-multiple-attachments-from-excel-sheet-with-vba", "title": "Sending multiple attachments from excel sheet with VBA", "body": "<p>I have the existing code to send a mail from a Sheet in my Excel file - </p>\n\n<pre><code>Sub CreateMail()\n\n    Dim objOutlook As Object\n    Dim objMail As Object\n    Dim rngTo As Range\n    Dim rngSubject As Range\n    Dim rngBody As Range\n    Dim rngAttach As Range\n\n    Set objOutlook = CreateObject(\"Outlook.Application\")\n    Set objMail = objOutlook.CreateItem(0)\n\n    Application.ScreenUpdating = False\n    Worksheets(\"Mail List\").Activate\n\n    With ActiveSheet\n        Set rngTo = .Range(\"B1\")\n        Set rngSubject = .Range(\"B2\")\n        Set rngBody = .Range(\"B3\")\n        Set rngAttach = .Range(\"B4\")\n\n    End With\n\n    With objMail\n        .To = rngTo.Value\n        .Subject = rngSubject.Value\n        .body = rngBody.Value\n        .Attachments.Add rngAttach.Value\n        .display 'Instead of .Display, you can use .Send to send the email _\n                    or .Save to save a copy in the drafts folder\n    End With\n\n    Set objOutlook = Nothing\n    Set objMail = Nothing\n    Set rngTo = Nothing\n    Set rngSubject = Nothing\n    Set rngBody = Nothing\n    Set rngAttach = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>However, I want to include a number of attachments, and hence the \n<code>Set rngAttach = .Range(\"B4\")</code> does not help to do this.</p>\n\n<p>Any help on this?\nThanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2412, "user_id": 1093787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GKuMw.jpg?s=128&g=1", "display_name": "Edi G.", "link": "https://stackoverflow.com/users/1093787/edi-g"}, "edited": false, "score": 4, "creation_date": 1427274400, "post_id": 29251362, "comment_id": 46706623, "body": "&quot; Plz give VBA code to do so.&quot;... Welcome to Stack Overflow. Your question seems totally unclear to me. Would be better if you clarify it. Please read FAQ, -&gt; <a href=\"http://stackoverflow.com/tour\">stackoverflow.com/tour</a> How to Ask -&gt; <a href=\"http://stackoverflow.com/questions/how-to-ask\">stackoverflow.com/questions/how-to-ask</a> and help center -&gt; <a href=\"http://stackoverflow.com/help\">stackoverflow.com/help</a> as a start."}, {"owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "edited": false, "score": 0, "creation_date": 1427284126, "post_id": 29251362, "comment_id": 46712528, "body": "We are here to help, not to provide programming services."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 4538041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c63c6f09c8f0cfbcdc1a5abbdbf58bfe?s=128&d=identicon&r=PG&f=1", "display_name": "KCSR", "link": "https://stackoverflow.com/users/4538041/kcsr"}, "edited": false, "score": 0, "creation_date": 1427518004, "post_id": 29256396, "comment_id": 46820596, "body": "i dont know the string I have to find, I&#39;ll explain it better.. I know &quot;_part&quot; is part of that string. The code should extract all string that contains &quot;_part&quot;. Its like ctrl+f &quot;_part&quot;. Then i manually copy paste it. I just want to automate this procedure"}, {"owner": {"reputation": 116, "user_id": 4712035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f84b06a738d2bb6fefd72fb839f3e3e?s=128&d=identicon&r=PG&f=1", "display_name": "jbay", "link": "https://stackoverflow.com/users/4712035/jbay"}, "reply_to_user": {"reputation": 9, "user_id": 4538041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c63c6f09c8f0cfbcdc1a5abbdbf58bfe?s=128&d=identicon&r=PG&f=1", "display_name": "KCSR", "link": "https://stackoverflow.com/users/4538041/kcsr"}, "edited": false, "score": 0, "creation_date": 1427977320, "post_id": 29256396, "comment_id": 46998360, "body": "len() = gives you the entire length of the string. instr() = this is used to find the _part you&#39;re looking for. mid() = with the prior two and the mid statement you can capture as much of the text as you&#39;d like using addition and subtraction."}, {"owner": {"reputation": 116, "user_id": 4712035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f84b06a738d2bb6fefd72fb839f3e3e?s=128&d=identicon&r=PG&f=1", "display_name": "jbay", "link": "https://stackoverflow.com/users/4712035/jbay"}, "reply_to_user": {"reputation": 9, "user_id": 4538041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c63c6f09c8f0cfbcdc1a5abbdbf58bfe?s=128&d=identicon&r=PG&f=1", "display_name": "KCSR", "link": "https://stackoverflow.com/users/4538041/kcsr"}, "edited": false, "score": 0, "creation_date": 1427977526, "post_id": 29256396, "comment_id": 46998497, "body": "Although you could just use excel functions if all you&#39;re trying to do is copy and paste a part of a string."}], "tags": [], "owner": {"reputation": 116, "user_id": 4712035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f84b06a738d2bb6fefd72fb839f3e3e?s=128&d=identicon&r=PG&f=1", "display_name": "jbay", "link": "https://stackoverflow.com/users/4712035/jbay"}, "is_accepted": false, "score": 0, "last_activity_date": 1427288391, "creation_date": 1427288391, "answer_id": 29256396, "question_id": 29251362, "link": "https://stackoverflow.com/questions/29251362/i-have-part-of-string-i-need-to-get-full-string-from-vba/29256396#29256396", "title": "I have part of string i need to get full string from VBA", "body": "<p>x = mid(\"string you're searching\" , InStr(\"string you're searching\", \"String you want to find\") , len( \"string you're searching\" ) - InStr(\"string you're searching\", \"String you want to find\") )</p>\n"}], "owner": {"reputation": 9, "user_id": 4538041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c63c6f09c8f0cfbcdc1a5abbdbf58bfe?s=128&d=identicon&r=PG&f=1", "display_name": "KCSR", "link": "https://stackoverflow.com/users/4538041/kcsr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1427288391, "creation_date": 1427274220, "last_edit_date": 1531164843, "question_id": 29251362, "link": "https://stackoverflow.com/questions/29251362/i-have-part-of-string-i-need-to-get-full-string-from-vba", "title": "I have part of string i need to get full string from VBA", "body": "<p>I need to extract full string from excel cell, through VBA. I just know a part of string\nEg: somestr_part\nill search _part in excel. It should extract somestr_part into a variable. \nPlz give VBA code to do so.</p>\n\n<p>Thank you,\nKCSR</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1427276536, "post_id": 29251325, "comment_id": 46707897, "body": "Have you considered normalising the data by filling the Main Category and SubCategory columns down until the row before they change? That&#39;s easily done in VBA. You could then build a pivot table with conditional formatting to make JobNo&gt;0 font colour the same as its background colour."}], "answers": [{"comments": [{"owner": {"reputation": 9006, "user_id": 2257664, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d9f0c8cfc4646b1ad1e7030785967ea7?s=128&d=identicon&r=PG", "display_name": "A.L", "link": "https://stackoverflow.com/users/2257664/a-l"}, "edited": false, "score": 0, "creation_date": 1427309399, "post_id": 29256631, "comment_id": 46730085, "body": "Why should anyone use this code? You should add an explanation in this answer."}, {"owner": {"reputation": 116, "user_id": 4712035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f84b06a738d2bb6fefd72fb839f3e3e?s=128&d=identicon&r=PG&f=1", "display_name": "jbay", "link": "https://stackoverflow.com/users/4712035/jbay"}, "reply_to_user": {"reputation": 9006, "user_id": 2257664, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d9f0c8cfc4646b1ad1e7030785967ea7?s=128&d=identicon&r=PG", "display_name": "A.L", "link": "https://stackoverflow.com/users/2257664/a-l"}, "edited": false, "score": 0, "creation_date": 1427382710, "post_id": 29256631, "comment_id": 46761946, "body": "I was under the impression that the code was self explanatory to the question he asked."}, {"owner": {"reputation": 9006, "user_id": 2257664, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d9f0c8cfc4646b1ad1e7030785967ea7?s=128&d=identicon&r=PG", "display_name": "A.L", "link": "https://stackoverflow.com/users/2257664/a-l"}, "edited": false, "score": 0, "creation_date": 1427389182, "post_id": 29256631, "comment_id": 46766668, "body": "That&#39;s true, but it&#39;s better to add a short text to describe what the code do. This way, future users can just go to the solution, understand what the code do and use it. See <a href=\"http://meta.stackexchange.com/a/148274/237701\">Meta</a> for details."}], "tags": [], "owner": {"reputation": 116, "user_id": 4712035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f84b06a738d2bb6fefd72fb839f3e3e?s=128&d=identicon&r=PG&f=1", "display_name": "jbay", "link": "https://stackoverflow.com/users/4712035/jbay"}, "is_accepted": false, "score": 0, "last_activity_date": 1427289046, "creation_date": 1427289046, "answer_id": 29256631, "question_id": 29251325, "link": "https://stackoverflow.com/questions/29251325/numbering-rows-based-on-logic/29256631#29256631", "title": "Numbering rows based on logic", "body": "<p>do the below.</p>\n\n<pre><code>for i=1 to range(\"a500000\").end(xlup).row\n\n cells(i,1).select\n\n if len(selection.offset(0,1))&lt;=1 then\n    activecell.value = \"\"\n end if\n\n if len(selection.offset(0,3))&lt;=1 then\n    activecell.offset(0,2).value = \"\"\n end if\nnext i\n</code></pre>\n"}], "owner": {"reputation": 693, "user_id": 1370714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f39159ebc56ae9286560032f41265491?s=128&d=identicon&r=PG", "display_name": "Tony Clifton", "link": "https://stackoverflow.com/users/1370714/tony-clifton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427289046, "creation_date": 1427274107, "last_edit_date": 1427286539, "question_id": 29251325, "link": "https://stackoverflow.com/questions/29251325/numbering-rows-based-on-logic", "title": "Numbering rows based on logic", "body": "<p>On the left side of below image you see the current state of my Excel sheet. </p>\n\n<p><strong>Note</strong>: it's all about the <em>numbering</em>. </p>\n\n<p>At the moment the numbering is needed to process the sheet. However in a newer version the sheet will look like the right side of the image.</p>\n\n<p>For the new version to work, I'm looking for a macro that will remove the numbers and output the right side of the image.</p>\n\n<p>However if I need to go back to the old version for some reason, I would also like to know how to put the numbering back in there.</p>\n\n<p><img src=\"https://i.stack.imgur.com/vI6ZG.jpg\" alt=\"Excel sheet with two versions of one table\"></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": false, "score": 0, "last_activity_date": 1427275558, "creation_date": 1427275558, "answer_id": 29251772, "question_id": 29250936, "link": "https://stackoverflow.com/questions/29250936/copy-and-paste-data-from-excel-table-with-2-colums-to-excel-table-with-8-columns/29251772#29251772", "title": "copy and paste data from excel table with 2 colums to excel table with 8 columns using VBA", "body": "<p>The reason for the two columns repeating is in your setting of the paste range</p>\n\n<p><code>Wba.Activate\nSet LastRow = ActiveSheet.ListObjects(\"Planning6S\").ListRows.Add</code></p>\n\n<p>LastRow is a range and your planning6S table spans 8 columns. So, if you copied 2 columns and then pasted them into a 1 row by 8 column range then Excel will repeat the two column clipboard across all 8 selected columns.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 4707851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6a675d5b05bb97a3268a8530bba8ecb?s=128&d=identicon&r=PG&f=1", "display_name": "Emmy Brack", "link": "https://stackoverflow.com/users/4707851/emmy-brack"}, "edited": false, "score": 0, "creation_date": 1427282210, "post_id": 29251950, "comment_id": 46711357, "body": "LastRow.Range.Cells(1, 1).PasteSpecial xlPasteValues  thanks for your effort"}], "tags": [], "owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "is_accepted": false, "score": 0, "last_activity_date": 1427276086, "creation_date": 1427276086, "answer_id": 29251950, "question_id": 29250936, "link": "https://stackoverflow.com/questions/29250936/copy-and-paste-data-from-excel-table-with-2-colums-to-excel-table-with-8-columns/29251950#29251950", "title": "copy and paste data from excel table with 2 colums to excel table with 8 columns using VBA", "body": "<p>I'm pretty sure the problem is in these lines:</p>\n\n<pre><code>Set LastRow = ActiveSheet.ListObjects(\"Planning6S\").ListRows.Add\n</code></pre>\n\n<p>...</p>\n\n<pre><code>ActiveSheet.ListObjects(\"WerkplaatsTabel\").DataBodyRange.Copy\nLastRow.Range.PasteSpecial xlPasteValues\n</code></pre>\n\n<p>The first line inserts a new <strong>row</strong>, which is necessary if the table is empty before the copy, but since your import table is 8 columns wide and your export table only two columns wide, the two columns will be repeated 4 times. (In keeping with Mark Fitzgerald's reply).</p>\n\n<p>Try this instead:</p>\n\n<pre><code>Dim LR as variant\nSet LR = ActiveSheet.ListObjects(\"Planning6S\").DataBodyRange.Columns(\"A:B\") 'your desired copy range`\n\nActiveSheet.ListObjects(\"WerkplaatsTabel\").DataBodyRange.Copy LR\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2456, "user_id": 1754307, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/7170dd9a6ce7317ab73835c15ef1d9f7?s=128&d=identicon&r=PG", "display_name": "smackenzie", "link": "https://stackoverflow.com/users/1754307/smackenzie"}, "is_accepted": false, "score": 0, "last_activity_date": 1427276107, "creation_date": 1427276107, "answer_id": 29251960, "question_id": 29250936, "link": "https://stackoverflow.com/questions/29250936/copy-and-paste-data-from-excel-table-with-2-colums-to-excel-table-with-8-columns/29251960#29251960", "title": "copy and paste data from excel table with 2 colums to excel table with 8 columns using VBA", "body": "<p>Does this work to paste it into the first top left hand cell of the LastRow range?</p>\n\n<pre><code>LastRow.Cells(1,1).PasteSpecial xlPasteValues\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4707851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6a675d5b05bb97a3268a8530bba8ecb?s=128&d=identicon&r=PG&f=1", "display_name": "Emmy Brack", "link": "https://stackoverflow.com/users/4707851/emmy-brack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 500, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1427276107, "creation_date": 1427272915, "last_edit_date": 1427273213, "question_id": 29250936, "link": "https://stackoverflow.com/questions/29250936/copy-and-paste-data-from-excel-table-with-2-colums-to-excel-table-with-8-columns", "title": "copy and paste data from excel table with 2 colums to excel table with 8 columns using VBA", "body": "<p>i like to copy table body of a 2 column table in a workbook to the first 2 columns of a 8 column table in another workbook.\ni wrote this code but when pasting the body to the other table i get the 2 columns repeated on column 3 and 4, 5 and 6 and 7 and 8</p>\n\n<pre><code>Dim wbk As Workbook\n\nSub overzetten_naar_planning()\n\nDim folderPath As String, fileName As String, filePath As String\nDim LastRow As Variant\nDim Wb As Workbook\nSet Wb = ThisWorkbook\n\n' create path containing the planning file\nfolderPath = ThisWorkbook.Path &amp; \"\\\"\nfileName = \"6s planning 2015.xlsx\"\nfilePath = folderPath &amp; fileName\n\n' check if planning is already open in your session.\nIf IsWorkBookOpen(filePath) Then\n    Set Wba = Workbooks(fileName)\nElse\n    Set Wba = Workbooks.Open(filePath, UpdateLinks:=0)\nEnd If\n\nWba.Activate\nSet LastRow = ActiveSheet.ListObjects(\"Planning6S\").ListRows.Add\nThisWorkbook.Activate\nActiveSheet.ListObjects(\"WerkplaatsTabel\").DataBodyRange.Copy\nLastRow.Range.PasteSpecial xlPasteValues\n\nEnd Sub\n\nFunction IsWorkBookOpen(fileName As String)\nDim ff As Long, ErrNo As Long\n\nOn Error Resume Next\nff = FreeFile()\nOpen fileName For Input Lock Read As #ff\nClose ff\nErrNo = Err\nOn Error GoTo 0\n\nSelect Case ErrNo\nCase 0:    IsWorkBookOpen = False\nCase 70:   IsWorkBookOpen = True\nCase Else: Error ErrNo\nEnd Select\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "edited": false, "score": 0, "creation_date": 1427273267, "post_id": 29249899, "comment_id": 46706008, "body": "In Access you would need to use a form on the first table and then put your code in the appropriate locations in that form ie. After_Update Before_Delete etc."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1427280783, "post_id": 29249899, "comment_id": 46710520, "body": "If you are using Access 2010 or newer you might be able to use an event-driven <a href=\"https://support.office.com/en-ca/article/Create-a-data-macro-b1b94bca-4f17-47ad-a66d-f296ef834200?CorrelationId=fd1e6868-51a4-4cc3-88be-4cb5add8d666&amp;ui=en-US&amp;rs=en-CA&amp;ad=CA\" rel=\"nofollow noreferrer\">data macro</a> to some advantage."}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 4731795, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b488619b97cb441867ddb72338b6297?s=128&d=identicon&r=PG&f=1", "display_name": "Lenny Sockman", "link": "https://stackoverflow.com/users/4731795/lenny-sockman"}, "is_accepted": false, "score": 0, "last_activity_date": 1427851953, "creation_date": 1427851953, "answer_id": 29381408, "question_id": 29249899, "link": "https://stackoverflow.com/questions/29249899/ms-access-make-one-table-get-data-from-another-table-in-real-time/29381408#29381408", "title": "Ms Access, make one table get data from another table in real time", "body": "<p>If you're wanting to automatically update, independently of any form, a table based on changes made to another table, I would recommend a data macro which is new to MS Access 2010. They're pretty cool and are similar to triggers in enterprise level relational database management systems.</p>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 4539195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc6c071d3cef57cc1a25c748676caff?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/4539195/dave"}, "is_accepted": false, "score": 0, "last_activity_date": 1427901649, "creation_date": 1427901649, "answer_id": 29394698, "question_id": 29249899, "link": "https://stackoverflow.com/questions/29249899/ms-access-make-one-table-get-data-from-another-table-in-real-time/29394698#29394698", "title": "Ms Access, make one table get data from another table in real time", "body": "<p>Open your Activity table. Under table tools create a named macro called NewRecord. Create a parameter called prmCustomer. Your macro could look like this:</p>\n\n<pre><code>Create a Record In Activity\n    Alias \nSetField\n    Name Customer\n    Value = [prmCustomer]\n</code></pre>\n\n<p>Then open your Customer table. Under table tools create an After Insert Event. Your event could look like this:</p>\n\n<pre><code>RunDataMacro\n    Macro Name Activity.NewRecord\nParameters\n    prmCustomer = CustomerID\n</code></pre>\n\n<p>You'll have to do some playing around since you haven't given much info, but that's the gist of it. </p>\n"}], "owner": {"reputation": 1, "user_id": 4560946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ae4eb881ba9e9380aab44491580108?s=128&d=identicon&r=PG&f=1", "display_name": "Jax", "link": "https://stackoverflow.com/users/4560946/jax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 885, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1427901649, "creation_date": 1427269001, "question_id": 29249899, "link": "https://stackoverflow.com/questions/29249899/ms-access-make-one-table-get-data-from-another-table-in-real-time", "title": "Ms Access, make one table get data from another table in real time", "body": "<p>So, i have 2 tables, let's say : Customers and Activity. Customers containing only customers and activity containing customers but also other pieces of information. </p>\n\n<p>I have a form to write data in the Customers table. \nWhat i need is the Activity table to auto-update itself each time I write an entry in the Customers table. </p>\n\n<p>Is it possible to create a relationship between the two tables to do that? Or should I write something at the end of the code I use for the form?\nIs it possible for instance to create a function that i call at the end of the code i use for the form?\nThanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1047, "user_id": 4669839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O9FCz.png?s=128&g=1", "display_name": "cybermike", "link": "https://stackoverflow.com/users/4669839/cybermike"}, "edited": false, "score": 0, "creation_date": 1427284877, "post_id": 29249300, "comment_id": 46713001, "body": "I am trying to understand your question ... is it that you DO want the &quot;Data Saved Successfully&quot; alert message to show, but automatically close itself after a moment or two (thus no need for an OK button)?  Or you are asking to not have the &quot;Data Saved Successfully&quot; alert message show at all?  Because if it is the latter (no message at all) then just remove the &#39;alert(&quot;Data Saved Successfully&quot;)&#39; line right in the code."}], "answers": [{"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 1, "last_activity_date": 1427291612, "creation_date": 1427291612, "answer_id": 29257684, "question_id": 29249300, "link": "https://stackoverflow.com/questions/29249300/disable-alert-message-of-a-webpage-using-vba-code/29257684#29257684", "title": "Disable Alert message of a webpage using VBA code", "body": "<p>You could try wrapping the line with the Application.DisplayAlerts function that produces the display box you don't want;</p>\n\n<p>eg.</p>\n\n<pre><code>If Trim(htmlInput.ID) = \"btn\" Then\n    If Trim(htmlInput.Name) = \"btnfinal\" Then\n          Application.DisplayAlerts = False\n              htmlInput.Click \n          Application.DisplayAlerts = True\n\n.... Further Code\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4798469, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153790781699466/picture?type=large", "display_name": "Roberto Gomides", "link": "https://stackoverflow.com/users/4798469/roberto-gomides"}, "is_accepted": false, "score": -2, "last_activity_date": 1462223139, "creation_date": 1462223139, "answer_id": 36991703, "question_id": 29249300, "link": "https://stackoverflow.com/questions/29249300/disable-alert-message-of-a-webpage-using-vba-code/36991703#36991703", "title": "Disable Alert message of a webpage using VBA code", "body": "<p>I had this problem and the only way I could solve it was by writing a vb script that identifies the pop up and closes it...</p>\n\n<p>After that, you just need to call it from your vba code.</p>\n"}], "owner": {"reputation": 11, "user_id": 4710700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da9aa668078143585dbef96643c1b9?s=128&d=identicon&r=PG&f=1", "display_name": "unknown identifier", "link": "https://stackoverflow.com/users/4710700/unknown-identifier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4046, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1462223139, "creation_date": 1427266598, "last_edit_date": 1531164843, "question_id": 29249300, "link": "https://stackoverflow.com/questions/29249300/disable-alert-message-of-a-webpage-using-vba-code", "title": "Disable Alert message of a webpage using VBA code", "body": "<p>I am opening a webpage using VBA code which contains form where data will be filled by user. I have excel file which contains data. I write VBA code that read the data from excel and put it on webpage. After filling information on webpage I click on Save button. All this work I had done using VBA code so that it can be done automatically. I have 500 users data hence I run the loop 500 times. All it done fines. </p>\n\n<p>Only one problem come and it is that after filling data in webpage form when I click on save button a popup message comes \"Your data saved successfully\". It has \"OK\" button. Now my program stops here and need user intervention to manually click on \"OK\" button.</p>\n\n<p>Is there any way using VBA code by which we can stop this popup message box, so that manual intervention is no longer required?</p>\n\n<p>I read the webpage and Javascript written for webpage also. I found that when Save button is clicked a function called <code>savedetails()</code> . Inside this function a <code>alert()</code> function is there. Sample code here</p>\n\n<pre><code>function saveDetails()\n{\n/* get details of member*/\n---\n---\n---\n---\n---\nif (xml.status == 200 || window.location.href.indexOf(\"http\") == -1) {  \n    var successCode = \"\";\nalert(\"Data Saved Successfully\");\nvar tes = xml.responseText;\n\n/*  if (successCode == '1') {  */\n\ndocument.webDataForm.submit();\nremove_popup();\n};\n}\n</code></pre>\n\n<p>VBA Code For Each htmlInput In htmlColl</p>\n\n<pre><code>  If Trim(htmlInput.ID) = \"btn\" Then\n    If Trim(htmlInput.Name) = \"btnfinal\" Then\n                              htmlInput.Click  'After this \"Data Saved Successfully popup message comes and program need user intervention\n                             temp = htmlInput.getAttribute(\"onClick\")\n                             MsgBox temp\n                            'IE.document.getElementById(\"clearRelItems\").removeAttribute (\"o n C l i c k\")\n                    'Call iedoc.parentWindow.execScript(\"window.confirm = function saveBankDetails() {return true}\", \"JavaScript\")  // Not worked\n                             'htmlInput.removeAttribute (\"onClick\") //Not worked\n                             'htmlInput.setAttribute \"onClick\", \"return TRUE\"   //Not worked\n                            'Application.SendKeys \"{ENTER}\", True // Not worked\n                            Exit For\n                        End If\n                    End If\n            Next htmlInput\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1427271166, "post_id": 29248992, "comment_id": 46704975, "body": "Do consider &quot;going back to basics&quot;. What do you want to achieve here? Your excel formula and supporting vba is <i>extremely</i> brittle."}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1427271377, "post_id": 29248992, "comment_id": 46705075, "body": "Just tryied your VBA formula, with added <code>Cells(1,1)</code> and it worked. Note I changed the worksheet index to 1, for test purposes. <code>Sheets(1).Cells(1,1).Formula = _ &quot;=IF(ISERROR(VLOOKUP(RC[7],Sheet2!R4C2:R&quot; &amp; Lrow2 &amp; &quot;C2,1,FALSE)),RC[7],HYPERLINK(CELL(&quot; &amp; &quot;&quot;&quot;address&quot;&quot;&quot; &amp; &quot;,INDEX(Sheet2!R4C2:&quot; &amp; &quot;R&quot; &amp; Lrow2 &amp; &quot;C2,MATCH(RC[7],Sheet2!R4C2:&quot; &amp; &quot;R&quot; &amp; Lrow2 &amp; &quot;C2,0))),RC[7]))&quot;</code>"}, {"owner": {"reputation": 33, "user_id": 1957527, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/95676c50304e763fa6720519717264d9?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Bagadia", "link": "https://stackoverflow.com/users/1957527/mohit-bagadia"}, "reply_to_user": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1427272981, "post_id": 29248992, "comment_id": 46705859, "body": "@BranislavKoll&#225;r Thanks. The formula is now working.     &#39;Sheets(1).Cells(Lrow3, 3).FormulaR1C1 = &quot;= IF(ISERROR(VLOOKUP(Sheet4!R&quot; &amp; Lrow3 &amp; &quot;C9,Sheet2!R4C2:R&quot; &amp; Lrow2 &amp; &quot;C2,1,FALSE)),Sheet4!R&quot; &amp; Lrow3 &amp; &quot;C9,HYPERLINK(CELL(&quot; &amp; &quot;&quot;&quot;address&quot;&quot;&quot; &amp; &quot;,INDEX(Sheet2!R4C2:&quot; &amp; &quot;R&quot; &amp; Lrow2 &amp; &quot;C2,MATCH(Sheet4!R&quot; &amp; Lrow3 &amp; &quot;C9,Sheet2!R4C2:&quot; &amp; &quot;R&quot; &amp; Lrow2 &amp; &quot;C2,0))),Sheet4!R&quot; &amp; Lrow3 &amp; &quot;C9))&quot; &#39;  But i got struck with another problem. When i am running my entire code,  a popup is being displayed 2 times (1 for Sheet4 and the other for Sheet2) asking for File names. Is anything wrong with the &quot;&quot;&quot;address&quot;&quot;&quot;?"}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1427276877, "post_id": 29248992, "comment_id": 46708140, "body": "I don&#39;t know mate. Try updating the quesiton with this new issue. It will be more visible to other SE users, more likely to get answered."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 1957527, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/95676c50304e763fa6720519717264d9?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Bagadia", "link": "https://stackoverflow.com/users/1957527/mohit-bagadia"}, "edited": false, "score": 0, "creation_date": 1427266401, "post_id": 29249119, "comment_id": 46702813, "body": "I have tried your suggestion, but i am still getting the run-time error. Here is what i have tried:                                                                      For Rows1 = 6 To Lrow1 Sheets(4).Cells(Rows1, 3).Formula = &quot;= IF(ISERROR(VLOOKUP(RC[7],Sheet2!R4C2:R&quot; &amp; Lrow2 &amp; &quot;C2,1,FALSE)),RC[7],HYPERLINK(CELL(&quot; &amp; &quot;&quot;&quot;address&quot;&quot;&quot; &amp; &quot;,INDEX(Sheet2!R4C2:&quot; &amp; &quot;R&quot; &amp; Lrow2 &amp; &quot;C2,MATCH(RC[7],Sheet2!R4C2:&quot; &amp; &quot;R&quot; &amp; Lrow2 &amp; &quot;C2,0))),RC[7]))&quot; Next Rows1"}, {"owner": {"reputation": 351, "user_id": 3597166, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5046ab7628deca9e3bf1b9f780a7b192?s=128&d=identicon&r=PG&f=1", "display_name": "Manivannan KG", "link": "https://stackoverflow.com/users/3597166/manivannan-kg"}, "reply_to_user": {"reputation": 33, "user_id": 1957527, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/95676c50304e763fa6720519717264d9?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Bagadia", "link": "https://stackoverflow.com/users/1957527/mohit-bagadia"}, "edited": false, "score": 1, "creation_date": 1427325917, "post_id": 29249119, "comment_id": 46738229, "body": "Yeah.Please try using .FormulaR1C1 if you specify rows &amp; columns.Adding to it, I could find one mistake in above code <code>code</code> Sheets(4).Cells(Rows1, 3).Formula  where tag <b>bold</b> Rows1 is invalid. Just use <code>code</code>  Sheets(4).Cells(1, 3). To verify, Can you see the formula appearing in row1,column 3 , after the code is executed."}, {"owner": {"reputation": 33, "user_id": 1957527, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/95676c50304e763fa6720519717264d9?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Bagadia", "link": "https://stackoverflow.com/users/1957527/mohit-bagadia"}, "edited": false, "score": 0, "creation_date": 1427706304, "post_id": 29249119, "comment_id": 46871173, "body": "Thanks. @Manivannan KG"}, {"owner": {"reputation": 351, "user_id": 3597166, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5046ab7628deca9e3bf1b9f780a7b192?s=128&d=identicon&r=PG&f=1", "display_name": "Manivannan KG", "link": "https://stackoverflow.com/users/3597166/manivannan-kg"}, "reply_to_user": {"reputation": 33, "user_id": 1957527, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/95676c50304e763fa6720519717264d9?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Bagadia", "link": "https://stackoverflow.com/users/1957527/mohit-bagadia"}, "edited": false, "score": 0, "creation_date": 1427761085, "post_id": 29249119, "comment_id": 46901391, "body": "@MohitBagadia pleasure dude. Someone might help me when i have queries. May be you too!!"}], "tags": [], "owner": {"reputation": 351, "user_id": 3597166, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5046ab7628deca9e3bf1b9f780a7b192?s=128&d=identicon&r=PG&f=1", "display_name": "Manivannan KG", "link": "https://stackoverflow.com/users/3597166/manivannan-kg"}, "is_accepted": true, "score": 1, "last_activity_date": 1427270170, "last_edit_date": 1427270170, "creation_date": 1427265890, "answer_id": 29249119, "question_id": 29248992, "link": "https://stackoverflow.com/questions/29248992/run-excel-formula-through-vba/29249119#29249119", "title": "Run excel formula through VBA", "body": "<p>Just a minor mistake you've done.</p>\n\n<p><code>Sheets(4).Formula = \"\"</code>  represents the formula applied on sheet4.Logically sheet 4 has almost million rows. Where will the formula sit?</p>\n\n<pre><code>Sheet(4).cells(row, column).Formula = \"\"\n</code></pre>\n\n<p>Here is one example i have just wrote few min back for sumif</p>\n\n<pre><code>  shPivotAdjustmentsIRSPV.Cells(NumRows, NumColumns + 1).Formula =\n \"=Sum(\" &amp; shPivotAdjustmentsIRSPV.Cells(3, NumColumns + 1).Address &amp;\n \":\" &amp; shPivotAdjustmentsIRSPV.Cells(NumRows - 2, NumColumns +\n 1).Address &amp; \")\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1427271027, "creation_date": 1427271027, "answer_id": 29250396, "question_id": 29248992, "link": "https://stackoverflow.com/questions/29248992/run-excel-formula-through-vba/29250396#29250396", "title": "Run excel formula through VBA", "body": "<p>In addition to a range, you need to use the <code>.FormulaR1C1</code> property if you are going to use R1C1 references:</p>\n\n<pre><code>Sheets(4).Range(\"A7\").FormulaR1C1 = \"=IF(ISERROR(VLOOKUP(RC[7],Sheet2!R4C2:R\" &amp; Lrow2 &amp; \"C2,1,FALSE)),RC[7],HYPERLINK(CELL(\"\"address\"\",INDEX(Sheet2!R4C2:R\" &amp; Lrow2 &amp; \"C2,MATCH(RC[7],Sheet2!R4C2:R\" &amp; Lrow2 &amp; \"C2,0))),RC[7]))\"\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 1957527, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/95676c50304e763fa6720519717264d9?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Bagadia", "link": "https://stackoverflow.com/users/1957527/mohit-bagadia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4137, "favorite_count": 0, "accepted_answer_id": 29249119, "answer_count": 2, "score": 0, "last_activity_date": 1427271027, "creation_date": 1427265365, "last_edit_date": 1427270102, "question_id": 29248992, "link": "https://stackoverflow.com/questions/29248992/run-excel-formula-through-vba", "title": "Run excel formula through VBA", "body": "<p>I am trying to VLOOKUP some value in 2 sheets and if the value is found then i am putting a hyperlink on the Sheet 1 cell to point it to the Sheet 2 cell.</p>\n\n<p>I have written an Excel formula for the same and it is working fine. But I am unable to convert it into a VBA formula. What am I doing wrong?</p>\n\n<p>Excel formula:\n    <code>=IF(ISERROR(VLOOKUP(RC[7],Sheet2!R1C1:R20C1,1,FALSE)),RC[7],HYPERLINK(CELL(\"address\",INDEX(Sheet2!R1C1:R20C1,MATCH(RC[7],Sheet2!R1C1:R20C1,0))),RC[7]))</code></p>\n\n<p>VBA formula which i have tried:</p>\n\n<pre><code>Sheets(4).Formula = \"= IF(ISERROR(VLOOKUP(RC[7],Sheet2!R4C2:R\" &amp; Lrow2 &amp; \"C2,1,FALSE)),RC[7],HYPERLINK(CELL(\" &amp; \"\"\"address\"\"\" &amp; \",INDEX(Sheet2!R4C2:\" &amp; \"R\" &amp; Lrow2 &amp; \"C2,MATCH(RC[7],Sheet2!R4C2:\" &amp; \"R\" &amp; Lrow2 &amp; \"C2,0))),RC[7]))\"\n</code></pre>\n\n<p>P.S.: Do not worry about the row and column indexes. I wrote the formula for test file and writing the vba for the master file.</p>\n"}, {"tags": ["vba", "excel", "templates", "add-in"], "comments": [{"owner": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "edited": false, "score": 0, "creation_date": 1427271835, "post_id": 29248865, "comment_id": 46705293, "body": "One reason your add-in may not be loading is if you are using code to open a new instance of Excel which you are then trying to run the code in. This might help if that is the case: <a href=\"http://stackoverflow.com/questions/213375/loading-addins-when-excel-is-instantiated-programmatically\" title=\"loading addins when excel is instantiated programmatically\">stackoverflow.com/questions/213375/&hellip;</a>"}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1427280250, "post_id": 29248865, "comment_id": 46710217, "body": "Are you using the Excel addin manager to add your addin to the list of loaded addins?"}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1427293806, "post_id": 29248865, "comment_id": 46719358, "body": "Thanks, guys, I&#39;ll take a look at that."}], "answers": [{"comments": [{"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1429798580, "post_id": 29255564, "comment_id": 47778540, "body": "At first I did not have the file in its place, but after recording some macro to the &quot;Personal Macro Workbook&quot; and saving it, the file appeared just in place it had to be in. The <b>Personal.xslb</b> seems to be designed for VBA code only, as there are no worksheets if you open the file. Thanks!"}], "tags": [], "owner": {"reputation": 1047, "user_id": 4669839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O9FCz.png?s=128&g=1", "display_name": "cybermike", "link": "https://stackoverflow.com/users/4669839/cybermike"}, "is_accepted": true, "score": 2, "last_activity_date": 1427286197, "creation_date": 1427286197, "answer_id": 29255564, "question_id": 29248865, "link": "https://stackoverflow.com/questions/29248865/normal-dotm-equivalent-in-excel-for-referencing-the-same-single-vba-code/29255564#29255564", "title": "Normal.dotm equivalent in Excel for referencing the same single VBA code", "body": "<p>Indeed, Excel DOES have a common code file, similar in concept to Word's normal.dotm. It is called Personal.xlsb. I use it myself for common functions that I need for several linked yet independent spreadsheets. </p>\n\n<p>Using Personal.xlsb has some disadvantages too, so you'll have to decide if that works better than the Add-in approach. Note that Personal.xlsb works best when its just one person needing common functions across spreadsheets; its not well suited for multi-user access to the spreadsheets in an enterprise environment.</p>\n\n<p>Some useful links are below to get started.  Also just google search \"excel Personal.xlsb\" and you will find a lot more information:</p>\n\n<ul>\n<li><a href=\"http://www.rondebruin.nl/win/personal.htm\" rel=\"nofollow\">http://www.rondebruin.nl/win/personal.htm</a></li>\n<li><a href=\"http://chandoo.org/wp/2013/11/18/using-personal-macro-workbook/\" rel=\"nofollow\">http://chandoo.org/wp/2013/11/18/using-personal-macro-workbook/</a></li>\n</ul>\n"}], "owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4117, "favorite_count": 0, "accepted_answer_id": 29255564, "answer_count": 1, "score": 1, "last_activity_date": 1522708736, "creation_date": 1427264873, "last_edit_date": 1522708736, "question_id": 29248865, "link": "https://stackoverflow.com/questions/29248865/normal-dotm-equivalent-in-excel-for-referencing-the-same-single-vba-code", "title": "Normal.dotm equivalent in Excel for referencing the same single VBA code", "body": "<p>Just curiosity.</p>\n\n<p>The only way I know so far is to create an add-in with code, put it in some trusted directory and hope it opens when you need it. The drawback is that it sometimes does not open together with application (e.g. I have a custom UDF in the add-in, I use it in the worksheet and an error is what I get, because the addin hasn't started). For this I have a button on my ribbon which calls a sub in the addin which does nothing, but then the addin is activated the UDF works.</p>\n\n<p>Is there any other efficient way to reference code in another workbooks, like in Word we have normal.dotm template?</p>\n"}, {"tags": ["excel", "userform", "vba"], "answers": [{"comments": [{"owner": {"reputation": 697, "user_id": 1582396, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1d2412c0a0d1da3627ce046b38a606da?s=128&d=identicon&r=PG", "display_name": "BlueSun3k1", "link": "https://stackoverflow.com/users/1582396/bluesun3k1"}, "edited": false, "score": 0, "creation_date": 1427264875, "post_id": 29248292, "comment_id": 46702148, "body": "Thanks for the prompt response and the help. I tried both options and only the first option worked. The second option with the modified version of the script generated an error. Run-time error 1004: Application-defined or Object-defined error. I&#39;m going with the first option. Thanks again."}, {"owner": {"reputation": 697, "user_id": 1582396, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1d2412c0a0d1da3627ce046b38a606da?s=128&d=identicon&r=PG", "display_name": "BlueSun3k1", "link": "https://stackoverflow.com/users/1582396/bluesun3k1"}, "edited": false, "score": 0, "creation_date": 1427377681, "post_id": 29248292, "comment_id": 46758090, "body": "It points to .Offset(0, -4).Value = txtName.Value. I&#39;m actually having issues with both scripts now. on the first option WriteRow = Application.Match(IDNum, rngIDNum, 0) is causing the script to crash &quot;WriteRow&quot; Returns 0 when I hover over it while debugging."}, {"owner": {"reputation": 697, "user_id": 1582396, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1d2412c0a0d1da3627ce046b38a606da?s=128&d=identicon&r=PG", "display_name": "BlueSun3k1", "link": "https://stackoverflow.com/users/1582396/bluesun3k1"}, "edited": false, "score": 0, "creation_date": 1427379706, "post_id": 29248292, "comment_id": 46759610, "body": "I&#39;m trying your second option and I fixed the Run-time error 1004: Application-defined or Object-defined error. I had added a column before and after txtID.Value which was making it look into the wrong Offset numbers. However, the script passes with no error but it&#39;s not saving the changes I make to the data before I run the script. Any ideas why?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 697, "user_id": 1582396, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1d2412c0a0d1da3627ce046b38a606da?s=128&d=identicon&r=PG", "display_name": "BlueSun3k1", "link": "https://stackoverflow.com/users/1582396/bluesun3k1"}, "edited": false, "score": 0, "creation_date": 1427407683, "post_id": 29248292, "comment_id": 46776663, "body": "@user1582396 If no match is found, then it will not save the changes. If you are searching in <i>Column E</i> then there should be no problem with the code. I&#39;ve tried and tested it."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 2, "last_activity_date": 1427262899, "last_edit_date": 1427262899, "creation_date": 1427262256, "answer_id": 29248292, "question_id": 29248222, "link": "https://stackoverflow.com/questions/29248222/excel-vba-userform-update-override-data/29248292#29248292", "title": "Excel VBA UserForm - Update/Override Data", "body": "<p>It should start with:</p>\n\n<pre><code>.Offset(0, 0).Value = txtName.Value\n</code></pre>\n\n<p>Setting the <em>ColumnIndex</em> to <strong>1</strong> will make it target 1 column to the right.<br>\nAlso, instead of using <code>Select</code> you can directly work on the object like this:</p>\n\n<pre><code>With .Cells(WriteRow, 1)\n    .Offset(0, 0).Value = txtName.Value\n    .\n    .\n    .Offset(0, 4).Value = txtID.Value\nEnd With\n</code></pre>\n\n<p>Or you can also try this version of your code using <code>Range.Find Method</code>.</p>\n\n<pre><code>Private Sub RecordUpdate_Click()\n    Dim LastRow As Long\n    Dim IDNum As String\n    Dim rngIDNum As Range\n    Dim ws As Worksheet\n\n    Set ws = Worksheets(\"Records\")\n    ' Find the ID \n    With ws\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        IDNum = txtID.Value\n        Set rngIDNum = .Range(\"E1:E\" &amp; LastRow).Find(IDNum, .Range(\"E\" &amp; LastRow))\n    End With\n    ' Inform and Exit if ID doesn't exist\n    If rngIDNum Is Nothing Then MsgBox \"ID not found\": Exit Sub\n    ' Update the values\n    With rngIDNum\n        .Offset(0, -4).Value = txtName.Value\n        .Offset(0, -3).Value = txtlName.Value\n        .Offset(0, -2).Value = txtGender.Value\n        .Offset(0, -1).Value = txtAge.Value\n        .Offset(0, 0).Value = txtID.Value\n    End With\nEnd Sub\n</code></pre>\n\n<p>I assumed you're working on <code>Worksheet(\"Records\")</code> which you have assigned in <code>ws</code> variable.</p>\n"}], "owner": {"reputation": 697, "user_id": 1582396, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1d2412c0a0d1da3627ce046b38a606da?s=128&d=identicon&r=PG", "display_name": "BlueSun3k1", "link": "https://stackoverflow.com/users/1582396/bluesun3k1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2464, "favorite_count": 0, "accepted_answer_id": 29248292, "answer_count": 1, "score": 0, "last_activity_date": 1534264506, "creation_date": 1427261931, "last_edit_date": 1531161705, "question_id": 29248222, "link": "https://stackoverflow.com/questions/29248222/excel-vba-userform-update-override-data", "title": "Excel VBA UserForm - Update/Override Data", "body": "<p>I'm trying to pull and update some records thru an <code>UserForm</code> and I've almost got it, except for the piece of code that isn't working as intended. It's supposed to override the previous record (whatever information is found in the same row as the record found by the IDNum.</p>\n\n<p>For some reason, it starts to copy the data as of column B when it should override everything as of <code>Column A</code>.</p>\n\n<p>Here's the code.</p>\n\n<pre><code>Private Sub RecordUpdate_Click()\n    Dim LastRow As Long\n    Dim IDNum As String\n    Dim rngIDNum As Range\n    Dim WriteRow As Long\n    Dim ws As Worksheet\n\n    Set ws = Worksheets(\"Records\")\n\n    With ActiveSheet\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        Set rngIDNum = .Range(\"E1:E\" &amp; LastRow)\n        IDNum = txtID.Value\n        WriteRow = Application.Match(IDNum, rngIDNum, 0)\n        Cells(WriteRow, 1).Select\n        With ActiveCell\n            .Offset(0, 1).Value = txtName.Value\n            .Offset(0, 2).Value = txtlName.Value\n            .Offset(0, 3).Value = txtGender.Value\n            .Offset(0, 4).Value = txtAge.Value\n            .Offset(0, 5).Value = txtID.Value\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>It leaves intact whatever is in <code>Column A</code> and copies the edited entries from B to F instead of A to E. Any inputs are greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": true, "score": 1, "last_activity_date": 1427266257, "creation_date": 1427266257, "answer_id": 29249215, "question_id": 29248178, "link": "https://stackoverflow.com/questions/29248178/macro-for-multiple-matching-cells-detection/29249215#29249215", "title": "Macro for multiple matching cells detection", "body": "<p>To fix the issue delete <code>strMsgBody1</code> declaration and replace every occurance with <code>strMsgBody</code>. You don't need a second variable. </p>\n"}], "owner": {"reputation": 284, "user_id": 4294537, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a93aea8ae1e46b34575fe0e5b6cc3fa?s=128&d=identicon&r=PG&f=1", "display_name": "adrian", "link": "https://stackoverflow.com/users/4294537/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 1, "accepted_answer_id": 29249215, "answer_count": 1, "score": 1, "last_activity_date": 1427287305, "creation_date": 1427261680, "last_edit_date": 1427287305, "question_id": 29248178, "link": "https://stackoverflow.com/questions/29248178/macro-for-multiple-matching-cells-detection", "title": "Macro for multiple matching cells detection", "body": "<p>I am implementing a macro that checks column E for dates that are 7 days away from current date.</p>\n\n<p>If cell date - current date = 7</p>\n\n<p>then an email containing the row that has the matching cell is sent.\nThis is my coding it works successfully, except for one issue.</p>\n\n<pre><code>Sub Workbook_Open()\n\nDim rngStart As Range\nDim rngEnd As Range\nDim rngCell As Range\nDim strHtmlHead As String\nDim strHtmlFoot As String\nDim strMsgBody As String\nDim strMsgBody1 As String\nDim strMsg As String\nDim objEmail As Object\nDim OutlookApp As Object\nDim OutlookMail As Object\n\n'On Error GoTo ErrHnd\n\n'only run if between midnight and 2AM\n'If Hour(Now) &lt; 2 Then\n\n'setup basic HTML message header and footer\n\n\n'setup start of body of message\nstrMsgBody = \"The following task(s) are due in less than 7 days :\"\n\n'Worksheet name\nWith Worksheets(\"Sheet1\")\n    'set start of date range\n    Set rngStart = .Range(\"E1\")\n    'find end of date range\n    Set rngEnd = .Range(\"E\" &amp; CStr(Application.Rows.Count)).End(xlUp)\n\n    'loop through all used cells in column G\n    For Each rngCell In .Range(rngStart, rngEnd)\n        'test if date is equal to 7 days from today\n        If IsDate(rngCell.Value) Then\n        If rngCell.Value - Int(Now) = 7 Then\n            'add to message - use task name from column A (offset -3)\n            'change as required\n            strMsgBody1 = strMsgBody &amp; \"&lt;Br&gt;\" &amp; \"&lt;Br&gt;\" &amp; \"Task: \" &amp; rngCell.Offset(0, -3).Text _\n                &amp; \" is due on  \" &amp; rngCell.Text &amp; \"&lt;Br&gt; \" &amp; \"&lt;Br&gt; \" &amp; \"Therefore please take necessary action\"\n        End If\n        End If\n    Next rngCell\n\n    'Note last test time/date\n    rngEnd.Offset(1, -3) = Now\n    rngEnd.Offset(1, -3).NumberFormat = \"dd/mm/yy\"\nEnd With\n\n'put message together\nstrMsg = strMsgBody1\n\n'test message\n'MsgBox strMsg\n\n'create the e-mail object\n\n\nSet OutlookApp = CreateObject(\"Outlook.Application\")\nSet OutlookMail = OutlookApp.CreateItem(0)\n\nWith OutlookMail\n\n.To = \"adrianadriananthony@outlook.com\"\n.CC = \"\"\n.BCC = \"\"\n.Subject = \"Task Alert\"\n.HTMLBody = strMsg\n.Send\nEnd With\n\n\nSet OutlookMail = Nothing\nSet OutlookApp = Nothing\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\n\n'remove the e-mail object\n\nExit Sub\n\n'error handler\nErrHnd:\nErr.Clear\n\nEnd Sub\n</code></pre>\n\n<p>When there are two or more records with the same date that matches the criterion  </p>\n\n<p>cell date - current date = 7</p>\n\n<p>then only one record is displayed in the email and sent to the email address.</p>\n\n<p>For example there are three records as shown below:</p>\n\n<p><img src=\"https://i.stack.imgur.com/GIdVX.png\" alt=\"enter image description here\"></p>\n\n<p>and only the third record is detected and attached to the body of the email.</p>\n\n<p><strong>I need to know why this happens?</strong> \n<strong>How can I edit my code to correct this?</strong> </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1047, "user_id": 4669839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O9FCz.png?s=128&g=1", "display_name": "cybermike", "link": "https://stackoverflow.com/users/4669839/cybermike"}, "edited": false, "score": 0, "creation_date": 1427259584, "post_id": 29247682, "comment_id": 46700470, "body": "You do know how to nest loops right?  You&#39;ve got three loops that do nothing, then an IF statement at the end that checks nothing (well likely checks D2000,E2000,F2000).  All your &quot;Next&quot;s should be after the IF statement at a minimum."}, {"owner": {"reputation": 37, "user_id": 4710314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1038059449542438/picture?type=large", "display_name": "Prashant Agrawal", "link": "https://stackoverflow.com/users/4710314/prashant-agrawal"}, "reply_to_user": {"reputation": 1047, "user_id": 4669839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O9FCz.png?s=128&g=1", "display_name": "cybermike", "link": "https://stackoverflow.com/users/4669839/cybermike"}, "edited": false, "score": 0, "creation_date": 1427259893, "post_id": 29247682, "comment_id": 46700537, "body": "Can you help me with the code. I am new to VBA @cybermike"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4710314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1038059449542438/picture?type=large", "display_name": "Prashant Agrawal", "link": "https://stackoverflow.com/users/4710314/prashant-agrawal"}, "edited": false, "score": 0, "creation_date": 1427260628, "post_id": 29247865, "comment_id": 46700738, "body": "Thanks dude ....It worked  using if ..End if and after that For...Next and With...End With"}], "tags": [], "owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "is_accepted": true, "score": 1, "last_activity_date": 1427260379, "last_edit_date": 1427260379, "creation_date": 1427259957, "answer_id": 29247865, "question_id": 29247682, "link": "https://stackoverflow.com/questions/29247682/how-to-give-multiple-condition-in-if-statement-in-vba/29247865#29247865", "title": "How to give multiple condition in if statement in VBA", "body": "<p>Welcome to the site!</p>\n\n<p>Your syntax is not correct. The loop <code>For Each ... Next</code> should encompass the code that you want to repeat . Since your loop does not contain anything inside, it does absolutely nothing. I tried to write an understandable code for you:</p>\n\n<pre><code>Sub HideRows()\nDim i as Long 'Counter\nApplication.ScreenUpdating = False\nApplication.Calculation = xlManual\n\nWith ActiveSheet\n    For i = 2 To 2000\n        If (.Range(\"D\" &amp; i).Value = 0 Or .Range(\"D\" &amp; i).Text = \"#N/A\") And _\n           (.Range(\"E\" &amp; i).Value = 0 Or .Range(\"E\" &amp; i).Text = \"#N/A\") And _\n           (.Range(\"F\" &amp; i).Value = 0 Or .Range(\"F\" &amp; i).Text = \"#N/A\") Then\n        .Range(\"D\" &amp; i).EntireRow.Hidden = True\n        End If\n    Next\nEnd With\n\nApplication.Calculation = xlAutomatic\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>In the example you see that the loop <code>For ... Next</code> encompasses some code, therefore the code will be done, as you can see, for 1999 times counting from 2 to 2000.Everything is enclosed in <code>With ActiveSheet ... End With</code> statement. The reason is to make the code more readable and not to repeat <code>ActiveSheet</code>. If you did not use it, instead of <code>.Range</code> you would have to write the full thing (<code>ActiveSheet.Range</code>).</p>\n"}], "owner": {"reputation": 37, "user_id": 4710314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1038059449542438/picture?type=large", "display_name": "Prashant Agrawal", "link": "https://stackoverflow.com/users/4710314/prashant-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6286, "favorite_count": 0, "accepted_answer_id": 29247865, "answer_count": 1, "score": 0, "last_activity_date": 1427260379, "creation_date": 1427258946, "last_edit_date": 1531164843, "question_id": 29247682, "link": "https://stackoverflow.com/questions/29247682/how-to-give-multiple-condition-in-if-statement-in-vba", "title": "How to give multiple condition in if statement in VBA", "body": "<p>I have written a VBA code to auto hide rows when the three coloumn \" D\" , \"E\" and \"F simultaneously show zero value. If any one of them is having non-zero value it should not hide the rows. Moreover I also want to add \"#N/A\" also, like if #NA is there just like Zero it should hide the row.</p>\n\n<p>But it seems there is some problem with the code. Please help me out. </p>\n\n<pre><code>Sub HideRows()\nApplication.ScreenUpdating = False\nApplication.Calculation = xlManual\n\nFor Each x In Range(\"D2:D2000\")\nNext\nFor Each y In Range(\"E2:E2000\")\nNext\nFor Each Z In Range(\"F2:F2000\")\nNext\nIf x.Value = 0 And y.Value = 0 And Z.Value = 0 Then x.EntireRow.Hidden = True\n\nApplication.Calculation = xlAutomatic\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2003"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1427255458, "post_id": 29246996, "comment_id": 46699345, "body": "@PortlandRunner Post it as answer, I&#39;ll delete mine :)"}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1427255563, "post_id": 29246996, "comment_id": 46699369, "body": "Thanks @L42 I appreciate the offer"}, {"owner": {"reputation": 67, "user_id": 4672473, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/10202757466336335/picture?type=large", "display_name": "Angelo Adrian", "link": "https://stackoverflow.com/users/4672473/angelo-adrian"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1427256872, "post_id": 29246996, "comment_id": 46699728, "body": "@PortlandRunner sir, i did place the x = x+1 but it still cant read the correct username and password. This time only the row3 is being determined."}], "answers": [{"tags": [], "owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "is_accepted": false, "score": 4, "last_activity_date": 1427255507, "creation_date": 1427255507, "answer_id": 29247130, "question_id": 29246996, "link": "https://stackoverflow.com/questions/29246996/do-loop-not-looping/29247130#29247130", "title": "Do Loop not looping", "body": "<p>If <code>Cells(2,1)</code> is not <code>\"\"</code> then you have an infinite loop because you never increment <code>x</code>.  </p>\n\n<p>Just before <code>Loop</code> add this: <code>x = x + 1</code> to increment your loop.  </p>\n\n<p>I suggest you play with some of <a href=\"http://www.excel-easy.com/vba/loop.html\" rel=\"nofollow\">these examples</a> to get an idea of how VBA loops work.</p>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 4672473, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/10202757466336335/picture?type=large", "display_name": "Angelo Adrian", "link": "https://stackoverflow.com/users/4672473/angelo-adrian"}, "is_accepted": false, "score": 1, "last_activity_date": 1427257097, "creation_date": 1427257097, "answer_id": 29247365, "question_id": 29246996, "link": "https://stackoverflow.com/questions/29246996/do-loop-not-looping/29247365#29247365", "title": "Do Loop not looping", "body": "<p>@PortlandRunner i have found the answer. thanks for helpiing. instead of placing x=x+1 right before the loop i did this </p>\n\n<pre><code>Do While ActiveWorkbook.Worksheets(\"Sheet1\").Cells(x, 1).Value &lt;&gt; \"\"\n\n    If ActiveWorkbook.Worksheets(\"Sheet1\").Cells(x, 1).Value = user And ActiveWorkbook.Worksheets(\"Sheet1\").Cells(x, 2).Value = pass Then\n       MsgBox \"YES\"\n       Exit Do\n    Else\n        x = x + 1\n       If ActiveWorkbook.Worksheets(\"Sheet1\").Cells(x, 1).Value = user And ActiveWorkbook.Worksheets(\"Sheet1\").Cells(x, 2).Value = pass Then\n        MsgBox \"YES\"\n       Exit Do\n       Else\n        MsgBox \"NO\"\n        Exit Do\n       End If\n    End If\nloop\n</code></pre>\n\n<p>thank you so much to the people who helped :)</p>\n"}, {"tags": [], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1427285119, "creation_date": 1427285119, "answer_id": 29255186, "question_id": 29246996, "link": "https://stackoverflow.com/questions/29246996/do-loop-not-looping/29255186#29255186", "title": "Do Loop not looping", "body": "<p>Just to simplify your own answer Angelo, here are some tips :  </p>\n\n<pre><code>With ActiveWorkbook.Worksheets(\"Sheet1\")\n    If (.Cells(x, 1) = user And .Cells(x, 2) = pass) Or _\n    (.Cells(x + 1, 1) = user And .Cells(x + 1, 2) = pass) Then\n        MsgBox \"YES\"\n        Exit Do\n    Else\n        MsgBox \"NO\"\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 4672473, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/10202757466336335/picture?type=large", "display_name": "Angelo Adrian", "link": "https://stackoverflow.com/users/4672473/angelo-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1427285119, "creation_date": 1427254731, "last_edit_date": 1531164843, "question_id": 29246996, "link": "https://stackoverflow.com/questions/29246996/do-loop-not-looping", "title": "Do Loop not looping", "body": "<p>I have this do loop code in my <code>Userform</code>.</p>\n\n<pre><code>Private Sub cmdLogin_Click()\nDim user, pass As String\nDim x As Integer\n\nuser = Me.user1.Text\npass = Me.pass1.Text\n\nx = 2\nDo While ActiveWorkbook.Worksheets(\"Sheet1\").Cells(x, 1).Value &lt;&gt; \"\"\n    If ActiveWorkbook.Worksheets(\"Sheet1\").Cells(x, 1).Value = user _\n    And ActiveWorkbook.Worksheets(\"Sheet1\").Cells(x, 2).Value = pass Then\n       MsgBox \"YES\"\n       Exit Do\n    Else\n       MsgBox \"NO\"\n       Exit Do\n    End If\nLoop\nEnd Sub\n</code></pre>\n\n<p>But it seems like the code does not loop throughout the cells and only stops until x=2 or cells(2,1). This results not being able to go through the whole list of usernames and passwords and every username and pass i enter becomes wrong except the ones at row 2. Please help as i am new to VBA </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1427254238, "post_id": 29246484, "comment_id": 46699090, "body": "Yes it makes sense and it sounds like <a href=\"https://support.office.com/en-us/article/vlookup-function-adceda66-30de-4f26-923b-7257939faa65\" rel=\"nofollow noreferrer\"><i>Vlookup</i></a> with a helper column I guess?"}], "answers": [{"tags": [], "owner": {"reputation": 1047, "user_id": 4669839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O9FCz.png?s=128&g=1", "display_name": "cybermike", "link": "https://stackoverflow.com/users/4669839/cybermike"}, "is_accepted": false, "score": 0, "last_activity_date": 1427258452, "creation_date": 1427258452, "answer_id": 29247580, "question_id": 29246484, "link": "https://stackoverflow.com/questions/29246484/automate-excel-worksheet-to-apply-information-in-specific-row-to-another-workshe/29247580#29247580", "title": "Automate Excel worksheet to apply information in specific row to another worksheet", "body": "<p>If as you stated you already have a pre-filled-in column C that maps a row in Sheet1 to a row in Sheet2, then all you need is the INDEX function to pull information from Sheet2 into Sheet1.  </p>\n\n<p>You cannot \"replace\" the number in Sheet1 col C with information from Sheet2; you need to keep it as the row# into Sheet2.  So you copy the information from Sheet2 into Sheet1 in some other column on Sheet1.  But you can hide Col C in Sheet1 if you do not want to see it for some reason.  Or just move the mapping Column in Sheet1 to some column much further to the right.</p>\n\n<p>If you have multiple columns in Sheet2 to move to Sheet1, just use multiple INDEX functions in the proper Sheet1 columns with the proper Sheet2 column numbers.</p>\n\n<p>A trivial example for pulling one data element from Sheet2 to Sheet1 for row 2 in Sheet1 (replace the <em>col#inSheet2</em> with a Sheet2 column number); the dollar-signs are important:</p>\n\n<pre><code>=INDEX(Sheet2!$A$1:$A$1, Sheet1!$C2, col#inSheet2)\n</code></pre>\n\n<p>If the rows in Sheet1 change, yet there is a per-row key value that maps rows in Sheet1 to Sheet2, then use the MATCH function in Sheet1 col C to get the row# in Sheet2 that maps to Sheet1.  This is particularly true if there are multiple columns of data to transfer from Sheet2 to Sheet1.</p>\n\n<p>And as @L42 mentioned, use VLOOKUP instead if there is just one column to move from Sheet2 to Sheet1, and again the rows from Sheet1 to Sheet2 change weekly, and again there is a per-row key value that maps the two sheets.</p>\n"}], "owner": {"reputation": 1, "user_id": 4710093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-i-lXEV6KzEI/AAAAAAAAAAI/AAAAAAAAAI4/-ghEPacySbo/photo.jpg?sz=128", "display_name": "sopelis", "link": "https://stackoverflow.com/users/4710093/sopelis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427258452, "creation_date": 1427250856, "last_edit_date": 1427251036, "question_id": 29246484, "link": "https://stackoverflow.com/questions/29246484/automate-excel-worksheet-to-apply-information-in-specific-row-to-another-workshe", "title": "Automate Excel worksheet to apply information in specific row to another worksheet", "body": "<p>I have 2 worksheets setup in excel. Worksheet 1 is dynamic information that I edit weekly. Worksheet 2 is static and will not change. One column in worksheet 1 numbers that are associated with a particular row in worksheet 2. For example, if worksheet 1 column C has a 4 in it, I'd like to apply what is in row 4 in worksheet 2, to replace that number with text.</p>\n\n<p>Does that make sense?</p>\n"}, {"tags": ["ms-access", "null", "vba"], "comments": [{"owner": {"reputation": 2892, "user_id": 1935222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gx2zd.png?s=128&g=1", "display_name": "4dmonster", "link": "https://stackoverflow.com/users/1935222/4dmonster"}, "edited": false, "score": 0, "creation_date": 1427268425, "post_id": 29245720, "comment_id": 46703799, "body": "in VBA you can use <code>isNull</code> function to detect <code>null</code> dates and do what ever you want."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1427283714, "creation_date": 1427283714, "answer_id": 29254675, "question_id": 29245720, "link": "https://stackoverflow.com/questions/29245720/handling-null-date-values-in-access-queries/29254675#29254675", "title": "Handling null date values in Access queries", "body": "<p>You can use Nz, for example:</p>\n\n<pre><code>DiffDays = DateDiff(\"d\", YourDateVariable, Nz([YourFieldValue], YourDateVariable))\n</code></pre>\n\n<p>will return 0 in any case where YourFieldValue should be Null.</p>\n"}], "owner": {"reputation": 161, "user_id": 3718812, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/458654dc70ed906f1104ec9ae2b676ea?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3718812/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3026, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427283714, "creation_date": 1427245180, "question_id": 29245720, "link": "https://stackoverflow.com/questions/29245720/handling-null-date-values-in-access-queries", "title": "Handling null date values in Access queries", "body": "<p>I have a table containing null values as dates, 10 in all. In a query based on this table, I want to compare a date in the record with a reference date which I am doing fine with Access VBA. Any of the fields in the record containing dates on the table could be NULL. My VBA code runs fine when the NULL values are located at either the beginning of a record or is the last field in a record. </p>\n\n<p>The query errors I am getting are when the NULL date fields occur in the middle of a record. For example two non - null dates, followed by a null date, followed by a final non - null date field. </p>\n\n<p>I am comparing dates, hence I don't think I can use the NZ() function to force a non null value. </p>\n\n<p>Is there some other methods I can use to correctly handle these NULL values? Appreciate the help from the community!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1427247229, "creation_date": 1427247229, "answer_id": 29245993, "question_id": 29245659, "link": "https://stackoverflow.com/questions/29245659/copy-all-cells-with-values-from-a-range-of-columns-into-one-single-column/29245993#29245993", "title": "Copy all cells with values from a range of columns into one single column", "body": "<p>Consider:</p>\n\n<pre><code>Sub ReOrganize()\n    Dim K As Long, ar\n    K = 1\n    For Each ar In Array(\"T\", \"U\", \"V\", \"W\", \"X\")\n        For i = 1 To 4\n            If Cells(i, ar).Value &lt;&gt; \"\" Then\n                Cells(K, \"Z\").Value = Cells(i, ar).Value\n                K = K + 1\n            End If\n        Next i\n    Next ar\nEnd Sub\n</code></pre>\n\n<p>For example:</p>\n\n<p><img src=\"https://i.stack.imgur.com/w7bOn.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 339, "user_id": 4709889, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9271519b66b415611910b055302699a4?s=128&d=identicon&r=PG&f=1", "display_name": "FrenchConnections", "link": "https://stackoverflow.com/users/4709889/frenchconnections"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1720, "favorite_count": 0, "accepted_answer_id": 29245993, "answer_count": 1, "score": 0, "last_activity_date": 1427247229, "creation_date": 1427244684, "last_edit_date": 1531164843, "question_id": 29245659, "link": "https://stackoverflow.com/questions/29245659/copy-all-cells-with-values-from-a-range-of-columns-into-one-single-column", "title": "Copy all cells with values from a range of columns into one single column", "body": "<p>I am a beginner with VBA, and I've been working on my first large-scale project. I have a Spreadsheet that compares multiple sets of data, and spits out values if there are any errors. My values are in range T4:X4 and I would like all of the values to be displayed sequentially in the range Z4:Z, with no blanks. One of the problems is all of the blank cells actually have formulas in them that just evaluate to \" \". I don't want to copy those.</p>\n\n<p>Here is the code I have written thus far:</p>\n\n<pre><code>Sub Generate_ReportVSP1()\n\nDim rSource As Range\nDim TargetRange As Range\n\nDim i As Integer\nDim j As Integer\n\nDim LastRowCarrier As Long\nDim LastRowConsole As Long\nDim ws2 As Worksheet\n\nSet ws2 = Sheets(\"Sheet2\")\n\nLastRowCarrier = ws2.Cells(Rows.Count, \"X\").End(xlUp).Row\nLastRowConsole = ws2.Cells(Rows.Count, \"S\").End(xlUp).Row\nLastRowReport = ws2.Cells(Rows.Count, \"AA\").End(xlUp).Row\n\n Set rSource = Application.Union(Range(\"T4:T\" &amp; LastRowConsole),    Range(\"U4:U\" &amp; LastRowConsole), Range(\"V4:V\" &amp; LastRowConsole), Range(\"W4:W\" &amp; LastRowConsole), Range(\"X4:X\" &amp; LastRowCarrier))\n\n Application.Calculation = xlCalculationManual\n\nFor j = 4 To LastRowCarrier\n    If Cells(j, 20).Value &lt;&gt; \" \" Then\n    Cells(j, 20).Copy\n    Cells(j, 26).PasteSpecial Paste:=xlPasteValues\nEnd If\nNext j\n\nApplication.Calculation = xlCalculationAutomatic\n\nWith Sheets(\"Sheet2\")\nRange(\"AA4\" &amp; LastRowReport).SpecialCells(xlCellTypeBlanks).Select\nSelection.Delete Shift:=xlUp\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 8, "last_activity_date": 1427244272, "creation_date": 1427244272, "answer_id": 29245604, "question_id": 29245499, "link": "https://stackoverflow.com/questions/29245499/use-excel-vba-to-change-view/29245604#29245604", "title": "Use Excel VBA to Change View", "body": "<p><code>ActiveWindow</code> is an <em>object</em>, <code>xlNormalView</code> is a long/enumerated constant associated with a property of that object. You can't assign the property value to the object itself, instead, assign it to the appropriate property. I believe the correct one would be:</p>\n\n<pre><code>ActiveWindow.View = xlNormalView \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31351, "user_id": 1447509, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/AYREu.jpg?s=128&g=1", "display_name": "cssyphus", "link": "https://stackoverflow.com/users/1447509/cssyphus"}, "is_accepted": false, "score": 0, "last_activity_date": 1527785207, "last_edit_date": 1527785207, "creation_date": 1527527101, "answer_id": 50570849, "question_id": 29245499, "link": "https://stackoverflow.com/questions/29245499/use-excel-vba-to-change-view/50570849#50570849", "title": "Use Excel VBA to Change View", "body": "<p>The following VBA will set all SELECTED sheets to the same view, same zoom level and same visible area as the active tab:</p>\n\n<pre><code>Sub ResetAllSheetPerspectives_OnSelectedSheets()\n    'Not working? Are any tabs selected? Only works on selected worksheets.\n    Dim ws As Worksheet\n    Dim lRow As Long\n    Dim lCol As Long\n    Dim dZoom, dView As Double\n\n    lRow = ActiveWindow.ScrollRow\n    lCol = ActiveWindow.ScrollColumn\n    dZoom = ActiveWindow.Zoom\n    dView = ActiveWindow.View\n\n    For Each ws In Application.ActiveWindow.SelectedSheets\n        ws.Activate\n        ActiveWindow.Zoom = dZoom\n        ActiveWindow.View = dView\n        Application.Goto ws.Cells(lRow, lCol), True\n    Next ws\nEnd Sub\n</code></pre>\n\n<p>Please upvote the below source:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/50298471/setting-all-selected-sheets-to-same-visible-area/50298725#50298725\">Setting all selected sheets to same visible area</a></p>\n\n<hr>\n\n<p>See Also:</p>\n\n<p><a href=\"https://support.office.com/en-us/article/run-a-macro-5e855fd2-02d1-45f5-90a3-50e645fe3155\" rel=\"nofollow noreferrer\">How to run a macro in Excel - support.office.com</a></p>\n\n<p><a href=\"https://www.wikihow.com/Use-Macros-in-Excel\" rel=\"nofollow noreferrer\">Use macros in Excel - WikiHow</a></p>\n\n<p><a href=\"https://searchengineland.com/how-to-use-macros-you-find-online-in-6-easy-steps-137786\" rel=\"nofollow noreferrer\">How to use macros you find online in six easy steps - searchengineland.com</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13722654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20f00664cf4e23fb1af4b13756aa809?s=128&d=identicon&r=PG", "display_name": "Daryl B", "link": "https://stackoverflow.com/users/13722654/daryl-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1591810908, "creation_date": 1591810908, "answer_id": 62309796, "question_id": 29245499, "link": "https://stackoverflow.com/questions/29245499/use-excel-vba-to-change-view/62309796#62309796", "title": "Use Excel VBA to Change View", "body": "<p>You can also do ActiveSheet.Range(\"A1\").Select\nIt won't change the view necessarily but it'll select the appropriate cell as well.</p>\n"}], "owner": {"reputation": 41, "user_id": 4709881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9ebab76a82e3fcdf95703addec6eabe?s=128&d=identicon&r=PG&f=1", "display_name": "Corey", "link": "https://stackoverflow.com/users/4709881/corey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8298, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1593769818, "creation_date": 1427243579, "last_edit_date": 1593769818, "question_id": 29245499, "link": "https://stackoverflow.com/questions/29245499/use-excel-vba-to-change-view", "title": "Use Excel VBA to Change View", "body": "<p>I'm trying to run a simple <code>For Each</code> loop to change the view in Excel, but keep getting a:</p>\n\n<blockquote>\n  <p>438 Run-time Error</p>\n</blockquote>\n\n<pre><code>Sub ChangeView()\n\nDim ws As Worksheet\n\nFor Each ws In ActiveWorkbook.Worksheets\n    ws.Select\n    ActiveWindow = xlNormalView\n    Range(\"A1\").Select\nNext\n</code></pre>\n\n<p>The error highlights the <code>ActiveWindow</code> line. Why?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1427270490, "post_id": 29245189, "comment_id": 46704684, "body": "What&#39;s in cell <code>Sheet2.Cells(j, 3)</code> when the error occurs? I betcha it isn&#39;t a number. Try stepping through your code in debug mode and watching how your variables evolve (<a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">instructions</a>). If that doesn&#39;t help, then I suggest you see this for guidance: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1427270607, "post_id": 29245285, "comment_id": 46704725, "body": "But that would give an Overflow error, not type mismatch. So that can&#39;t be the reason."}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": false, "score": 2, "last_activity_date": 1427242304, "creation_date": 1427242304, "answer_id": 29245285, "question_id": 29245189, "link": "https://stackoverflow.com/questions/29245189/run-time-error-13-type-mismatch/29245285#29245285", "title": "Run Time Error &#39;13&#39;: Type mismatch", "body": "<p>The reason is most probably with the data you are trying to assign an <code>Integer</code> with. I tried with <code>3</code>, and got no issues. Max. Integer value in VBA is <em>32767</em>.</p>\n\n<p>I'd suggest to declare the <code>maxTT</code> variable as <code>Long</code>.</p>\n\n<pre><code>Dim maxTT As Long\n</code></pre>\n\n<p>There may be other issues, but without the input it is difficult to guess.</p>\n"}], "owner": {"reputation": 21, "user_id": 4222138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c2e4c87fd7d3970594696600fdc4397?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmet Umut Durmu\u015f", "link": "https://stackoverflow.com/users/4222138/ahmet-umut-durmu%c5%9f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427287261, "creation_date": 1427241796, "last_edit_date": 1427287261, "question_id": 29245189, "link": "https://stackoverflow.com/questions/29245189/run-time-error-13-type-mismatch", "title": "Run Time Error &#39;13&#39;: Type mismatch", "body": "<p>I have created a macro file to run a greedy algorithm, that is a heuristic process of assigning the work with the greatest value with to the idle server. The macro should assign 26 works to two workstations running the greedy algorithm. </p>\n\n<p>At first I must determine if the task was assigned and then I must determine which unassigned task has the greatest task time and move on. This should be a pretty straightforward code but I have trouble reading the task times from the spreadsheet which range from (C2:C27). I have written the following code but I get a <code>Run Time Error '13': Type  mismatch</code> at the line I have marked with two **:</p>\n\n<pre><code>Sub GreedyAlgorithm()\n\nDim totalA As Integer\nDim totalB As Integer\nDim nbA As Integer\nDim nbB As Integer\nDim maxRN As Integer\nDim maxTT As Integer\n\ntotalA = 0\ntotalB = 0\nnbA = 0\nnbB = 0\n\n\n\nFor i = 1 To 26\n    maxRN = 0\n    maxTT = 0\n\n    For j = 2 To 27\n        If IsEmpty(Sheet2.Cells(j, 5)) Then\n            If Sheet2.Cells(j, 3).Value &gt; maxTT Then\n            maxRN = j\n            **maxTT = Sheet2.Cells(j, 3).Value\n            End If\n        End If\n    Next j\n\n    If totalB &gt; totalA Then\n        Sheet2.Cells(maxRN, 5).Value = \"A\"\n        nbA = nbA + 1\n        Sheet2.Cells(maxRN, 6).Value = nbA\n        totalA = totalA + maxTT\n    ElseIf totalB &lt;= totalA Then\n        Sheet2.Cells(maxRN, 5).Value = \"B\"\n        nbB = nbB + 1\n        Sheet2.Cells(maxRN, 6).Value = nbB\n        totalB = totalB + maxTT\n\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>What might be the reason for this? I have went back to my spreadsheet and manually set the data types as number for my range. This still has not solved the problem.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4709808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e441033c7ac75ca43267b02357e38038?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/4709808/scott"}, "edited": false, "score": 0, "creation_date": 1428085573, "post_id": 29418686, "comment_id": 47044133, "body": "Thanks, Dave.  I understand how the code you&#39;re setting up works, but I&#39;m a little confused on how to implement this. Many of these options don&#39;t exist in my Macro Builder, i.e. &quot;Look Up A Record&quot;, &quot;Alias&quot;, &quot;[prmAction]&quot;. I&#39;m BRAND NEW to this and apologize if I&#39;m missing something that&#39;s very basic."}, {"owner": {"reputation": 136, "user_id": 4539195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc6c071d3cef57cc1a25c748676caff?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/4539195/dave"}, "reply_to_user": {"reputation": 13, "user_id": 4709808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e441033c7ac75ca43267b02357e38038?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/4709808/scott"}, "edited": false, "score": 0, "creation_date": 1428419217, "post_id": 29418686, "comment_id": 47148623, "body": "No worries at all - took me a while to figure things out too. Those options you aren&#39;t seeing are available in the data macro builder. Data macros are special in that they&#39;re tied to events that happen in a table and are restricted to actions that involve table data. So open up your table that tracks donors and there should be a tab for table tools and &quot;before events&quot; or &quot;after events&quot;. Choosing an &quot;after insert&quot; event will allow you to create a data macro. See if you can find that then follow the steps above. Keep me updated - Dave"}, {"owner": {"reputation": 13, "user_id": 4709808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e441033c7ac75ca43267b02357e38038?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/4709808/scott"}, "edited": false, "score": 0, "creation_date": 1428529470, "post_id": 29418686, "comment_id": 47206142, "body": "Thanks, @Dave. I&#39;m able to access all of that now. I&#39;ll work on it and get back to you.  I&#39;m a little worried that my Donor column in my Donations table (which is currently set to house BOTH the donor&#39;s name and company) may not link correctly to the Donor ID, but I&#39;ll give it a shot. Much appreciated."}, {"owner": {"reputation": 13, "user_id": 4709808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e441033c7ac75ca43267b02357e38038?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/4709808/scott"}, "edited": false, "score": 0, "creation_date": 1428605251, "post_id": 29418686, "comment_id": 47244532, "body": "Okay, Dave. It seems to be working. It will get tested over the course of the next few weeks as new items come in and out. THANK YOU for your help."}], "tags": [], "owner": {"reputation": 136, "user_id": 4539195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc6c071d3cef57cc1a25c748676caff?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/4539195/dave"}, "is_accepted": true, "score": 0, "last_activity_date": 1427994978, "creation_date": 1427994978, "answer_id": 29418686, "question_id": 29245181, "link": "https://stackoverflow.com/questions/29245181/vba-in-microsoft-access-2013-mark-checkbox-if-data-is-entered-in-linked-form/29418686#29418686", "title": "VBA in Microsoft Access 2013 mark checkbox if data is entered in linked form", "body": "<p>A more elegant solution probably exists with VBA, but I will show you one way to do it with macros:</p>\n\n<p>First create a \"Named Macro\" in your table that tracks Donors, and we'll call it UpdateParticipation. Then create two parameters for the macro - first one is prmAction and that will determine if you inserted or deleted an item from your donation table. Second parameter is prmDonorID and that will identify which record in the table to update the status for.</p>\n\n<p>The named macro will check the participation box if a donation is added, and uncheck the participation box if a donation is deleted. The macro will look like this:</p>\n\n<pre><code>If [prmAction]=\"Inserted\" Then\n    Look Up A Record In DonorsTable\n    Where Condition = [DonorsTable].[ID]=[prmDonorID]\n    Alias\n    EditRecord\n    Alias\n        SetField\n        Name DonorsTable.Participated\n        Value = True\n    End EditRecord\nElse If [prmAction]=\"Deleted\" Then\n    Look Up A Record In DonorsTable\n    Where Condition = [DonorsTable].[ID]=[prmDonorID]\n    Alias\n    EditRecord\n    Alias\n        SetField\n        Name DonorsTable.Participated\n        Value = False\n    End EditRecord\nEnd If\n</code></pre>\n\n<p>Now whenever you are in the DonationsTable and insert/delete a record, you want to trigger the named macro.</p>\n\n<p>So in DonationsTable create an After Insert Event that looks like this:</p>\n\n<pre><code>RunDataMacro\n    Macro Name DonorsTable.UpdateParticipation\nParameters\n    prmAction = \"Inserted\"\n    prmDonorID = [DonationsTable].[DonorID]\n</code></pre>\n\n<p>When you delete a record it's a little trickier - if you are deleting the second donation from a donor, they are still participating so you don't want to uncheck the box in DonorsTable. So create an After Delete Event that looks like this:</p>\n\n<pre><code>Look Up A Record In SELECT DonationsTable.DonorID FROM DonationsTable;\n    Where Condition = [DonorID]=[Old].[DonorID]\n    Alias\n    StopMacro\nRunDataMacro\n    Macro Name DonorsTable.UpdateParticipation\nParameters\n    prmAction = \"Deleted\"\n    prmDonorID = [DonationsTable].[DonorID]\n</code></pre>\n\n<p>That will have you covered if you insert or delete a donation. You will want to create a similar setup if an existing record in DonationsTable is edited, where the DonorID is changed from one to another.         </p>\n"}], "owner": {"reputation": 13, "user_id": 4709808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e441033c7ac75ca43267b02357e38038?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/4709808/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 1, "accepted_answer_id": 29418686, "answer_count": 1, "score": 0, "last_activity_date": 1594644868, "creation_date": 1427241751, "last_edit_date": 1594644868, "question_id": 29245181, "link": "https://stackoverflow.com/questions/29245181/vba-in-microsoft-access-2013-mark-checkbox-if-data-is-entered-in-linked-form", "title": "VBA in Microsoft Access 2013 mark checkbox if data is entered in linked form", "body": "<p>I have created a database in Access 2013 to track donations and solicitation for an auction. My prospects are set up in one table/form with an available column to note whether or not they participated this year.</p>\n\n<p>Once an item is sent in, I log that item in a linked \"Donations\" form that calls out its donor.</p>\n\n<p><strong>Is there a way to automatically check the participation checkbox in the Prospects form once a donation has been entered in the Donations form?</strong></p>\n\n<p>I feel like I can imagine a somewhat simple piece of JS that could take care of this, but don't know Access well enough to accomplish the task in that program.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1427237645, "post_id": 29244249, "comment_id": 46694600, "body": "<a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Check this out</a> for a start. Once you&#39;ve explicitly reference all your objects, you&#39;ll be closer to what you want. Also force variable declaration. You can enable it in <i>VBE&gt;Tools&gt;Options</i> or you can simple add this line at the very top of your code: <code>Option Explicit</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4709486, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153183553298910/picture?type=large", "display_name": "Thom Herold", "link": "https://stackoverflow.com/users/4709486/thom-herold"}, "edited": false, "score": 0, "creation_date": 1427754736, "post_id": 29246139, "comment_id": 46899672, "body": "Thanks for all you help. This will probably confuse me more than anything in the beginning but hopefully I can decipher it. I am getting an error when I try to run this macro. &quot;The Microsoft database engine could not find the object &#39;SWL$&#39; &quot;"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 11, "user_id": 4709486, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153183553298910/picture?type=large", "display_name": "Thom Herold", "link": "https://stackoverflow.com/users/4709486/thom-herold"}, "edited": false, "score": 0, "creation_date": 1427763101, "post_id": 29246139, "comment_id": 46901919, "body": "@ThomHerold That is suppose to be the name of your <code>Sheet</code>. with a <code>$</code> sign in front."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 1, "last_activity_date": 1427248834, "last_edit_date": 1592644375, "creation_date": 1427248356, "answer_id": 29246139, "question_id": 29244249, "link": "https://stackoverflow.com/questions/29244249/adding-unique-data-from-source-worksheet-to-master-worksheet/29246139#29246139", "title": "Adding unique data from Source Worksheet to Master Worksheet", "body": "<p>Although I've posted a link for you to check out, I will post this solution which I've used before.</p>\n<pre><code>Sub ject()\n    Dim con As Object: Set con = CreateObject(&quot;ADODB.Connection&quot;)\n    Dim rec As Object: Set rec = CreateObject(&quot;ADODB.Recordset&quot;)\n    \n    Dim datasource As String\n    datasource = ThisWorkbook.FullName ' returns the fullpath\n\n    Dim sconnect As String\n    sconnect = &quot;Provider=Microsoft.ACE.OLEDB.12.0;&quot; &amp; _\n                &quot;Data Source=&quot; &amp; datasource &amp; &quot;;&quot; &amp; _\n                &quot;Extended Properties=&quot;&quot;Excel 12.0;HDR=YES&quot;&quot;;&quot;\n    con.Open sconnect\n    \n    Dim sqlstr As String\n    ' This basically executes anti-join if you know SQL\n    sqlstr = &quot;SELECT * &quot;\n    sqlstr = sqlstr &amp; &quot;FROM [SWL$] e &quot;\n    sqlstr = sqlstr &amp; &quot;LEFT JOIN [MWL$] u &quot;\n    sqlstr = sqlstr &amp; &quot;ON e.ID = u.ID &quot;\n    sqlstr = sqlstr &amp; &quot;WHERE u.ID IS NULL &quot;\n    sqlstr = sqlstr &amp; &quot;AND e.ID IS NOT NULL;&quot;\n\n    rec.Open sqlstr, con, 3, 1\n    \n    ' Dump data that meets your requirement\n    With Sheets(&quot;MWL&quot;)\n        Dim lr As Long\n        lr = .Range(&quot;D&quot; &amp; .Rows.Count).End(xlUp).Row + 1\n        .Range(&quot;D&quot; &amp; lr).CopyFromRecordset rec\n    End With\nEnd Sub\n</code></pre>\n<p>Considerations:</p>\n<ol>\n<li>Your <code>SWL</code> and <code>MWL</code> sheet data should start at Row 1 with headers.\n<img src=\"https://i.stack.imgur.com/AqHFj.png\" alt=\"enter image description here\" /></li>\n<li>Both should have the header name <strong>ID</strong> which contains the unique identifier. If not, you can adjust the code above.</li>\n</ol>\n<p>So what the code does is access <em>ADO (Active Data Objects)</em> to be able to execute data comparison using SQL commands. It is way faster than the conventional Range to Range comparison (looping). I'm not sure if it is faster than Array to Array comparison but it is certainly easier to read and adjust once you get the hang of it. Anyways, this maybe a little bit too much at the moment (since you said it is your first project), but this is tried and tested and certainly works.</p>\n<p><strong>IMPORTANT:</strong> Notice the <code>sconnect</code> variable. You need to use the correct <a href=\"http://www.connectionstrings.com/excel/\" rel=\"nofollow noreferrer\"><em>Connection String</em></a> depending on the version of your Excel.</p>\n"}], "owner": {"reputation": 11, "user_id": 4709486, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153183553298910/picture?type=large", "display_name": "Thom Herold", "link": "https://stackoverflow.com/users/4709486/thom-herold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1427248834, "creation_date": 1427236928, "last_edit_date": 1427237438, "question_id": 29244249, "link": "https://stackoverflow.com/questions/29244249/adding-unique-data-from-source-worksheet-to-master-worksheet", "title": "Adding unique data from Source Worksheet to Master Worksheet", "body": "<p>A row from the Source List Worksheet (<strong>SLW</strong>) columns (1, 2 &amp; 3) needs pasted into the Master List Worksheet (<strong>MLW</strong>) columns (3, 4 &amp; 5) [same order] if the unique <strong>ID</strong> number (SLW1 = MLW3) does <strong>NOT</strong> already exists in the \"Master List\" (same workbook).\nMy first Excel VBA project ever. So any and all advice/suggestions/corrections/short cuts would be great. This code is what I have fumbled creating. As you know, its not working.</p>\n\n<pre><code>Sub Transfer()\n\n    Dim SLR As Integer 'SourceList's Woksheets Last Row\n    Dim MLR As Integer 'MasterList's Woksheets Last Row\n    Dim SC As Integer 'SourceList Counting through the loop (ROW NUMBER)\n    Dim SR As Range 'SourceList A-C Row data\n                    '(Source information 3 rows to be transfered)\n    Dim ID As Integer 'Unique code of Projects\n    Dim Found As Range\n\n    Sheets(\"SourceList\").Activate\n    SLR = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    'Start loop to go through SourceList unique ID numbers\n    For SC = 2 To SLR\n        'Copy SourceList ID number into Variable \"ID\"\n        ID = Sheets(\"SourceList\").Range(1, SC)\n\n        'Also, Save Range into Variable so it doesn't have to\n        'go back and forth between Worksheets\n        Set SR = Range(Cells(1, SC), Cells(3, SC))\n\n        Sheets(\"MasterList\").Activate\n        Found = Columns(\"C:C\").Find(What:=ID, After:=ActiveCell, LookIn:=xlFormulas, _\n            LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n            MatchCase:=False, SearchFormat:=False).Activate\n        If Found Is Nothing Then\n            MLR = Cells(Rows.Count, \"C\").End(xlUp).Row + 1\n            Range(Cells(3, MLR)) = SR\n            SR.ClearContents\n        End If\n        Sheets(\"SourceList\").Activate\n    Next SC\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "combobox"], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1427239049, "creation_date": 1427239049, "answer_id": 29244687, "question_id": 29243305, "link": "https://stackoverflow.com/questions/29243305/how-to-use-case-in-a-vb-macros-combo-box/29244687#29244687", "title": "How to use Case in a VB Macros combo box?", "body": "<p>If you're trying to use a <a href=\"https://msdn.microsoft.com/en-us/library/cy37t14y.aspx\" rel=\"nofollow\"><code>Select Case</code></a>, you can simple do it like this:</p>\n\n<pre><code>Select Case ComboBox1\nCase \"Tipo A\"\n    ' what you want to do for Tipo A\nCase \"Tipo B\"\n    ' and another for Tipo B\nCase \"Tipo C\"\n    ' for Tipo C\nCase Else\n    ' what you want to do otherwise\nEnd Select\n</code></pre>\n\n<p>You can add this in to what ever <code>Form Control Event</code> you want to use.\nTake note that you can only evaluate the <code>ComboBox1</code> at runtime.</p>\n"}], "owner": {"reputation": 11, "user_id": 3460406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977d495339836a5f49ec0e2be75584df?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Cast29", "link": "https://stackoverflow.com/users/3460406/mr-cast29"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 386, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427239049, "creation_date": 1427232731, "last_edit_date": 1531164843, "question_id": 29243305, "link": "https://stackoverflow.com/questions/29243305/how-to-use-case-in-a-vb-macros-combo-box", "title": "How to use Case in a VB Macros combo box?", "body": "<p>I'm constructing a macro form, and I have this code </p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    ComboBox1.List = Array(\"Tipo A\", \"Tipo B\", \"Tipo C\")\nEnd Sub\n</code></pre>\n\n<p>I want to know how to use a case from this code.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "edited": false, "score": 0, "creation_date": 1427232443, "post_id": 29243050, "comment_id": 46692375, "body": "Trying to decode your module...what is the following code supposed to accomplish: <code>c = wsh.Cells.Find(What:=&quot;*&quot;,</code>?"}, {"owner": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "edited": false, "score": 0, "creation_date": 1427232762, "post_id": 29243050, "comment_id": 46692542, "body": "Do you want a prompt for each sheet that is the workbook or do you want the macro to &quot;remember&quot; what Area(1), Area(2), and Area(3) are and automatically resize them in subsequent sheets?"}, {"owner": {"reputation": 23, "user_id": 4663117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3bcbac34e2d519594245d1c7be8467?s=128&d=identicon&r=PG&f=1", "display_name": "Marrone", "link": "https://stackoverflow.com/users/4663117/marrone"}, "reply_to_user": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "edited": false, "score": 0, "creation_date": 1427308800, "post_id": 29243050, "comment_id": 46729660, "body": "Thanks Micheal for your quick answer and your code. The fact is that I also noticed that the headers are actually not consistent, as sometimes is <b>apple</b> and some other times is <b>apples</b> for example. Would it be possible to indicate the text to look for in the headers of those 3 columns instead of manually select them? This way, all the columns including &quot;apple&quot; or &quot;apples&quot; will be shown. Thanks"}, {"owner": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "edited": false, "score": 0, "creation_date": 1427387068, "post_id": 29243050, "comment_id": 46765297, "body": "Are you getting a runtime error because the columns don&#39;t match?"}, {"owner": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "edited": false, "score": 0, "creation_date": 1427388006, "post_id": 29243050, "comment_id": 46765894, "body": "Added a new popup if the column name isn&#39;t found exactly in subsequent worksheets.  Therefore, if you have <b>apple</b> in the first and second worksheet but <b>apples</b> in the third, you will receive a second <code>InputBox</code> when the code loops through to the third sheet and it cannot find <b>apples</b> exactly."}, {"owner": {"reputation": 23, "user_id": 4663117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3bcbac34e2d519594245d1c7be8467?s=128&d=identicon&r=PG&f=1", "display_name": "Marrone", "link": "https://stackoverflow.com/users/4663117/marrone"}, "reply_to_user": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "edited": false, "score": 0, "creation_date": 1427401539, "post_id": 29243050, "comment_id": 46773508, "body": "Thank you so much once again! The formula is awesome, but the 2nd pop-up filters only the new 3 columns of 1 single sheet, instead of all the remaining ones. It pops up constantly until all the sheets are processed and I basically have to enter the same 3 columns each time. I think the easier solution is to replace the column-selecting method by a simple keyword search. This way, I don&#39;t need to manually select any column and the function will simply unhide the columns containind &quot;apple/apples&quot;, &quot;Orange/oranges&quot;, etc. in their headers (row 1). What do you think?"}, {"owner": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "edited": false, "score": 0, "creation_date": 1427402212, "post_id": 29243050, "comment_id": 46773916, "body": "Probably a good solution, but I would then change the input from a simple <code>InputBox</code> to an actual <code>UserForm1</code>, which falls outside the scope of the specific question.  How many sheets are in a typical worksheet?"}, {"owner": {"reputation": 23, "user_id": 4663117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3bcbac34e2d519594245d1c7be8467?s=128&d=identicon&r=PG&f=1", "display_name": "Marrone", "link": "https://stackoverflow.com/users/4663117/marrone"}, "reply_to_user": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "edited": false, "score": 0, "creation_date": 1427403002, "post_id": 29243050, "comment_id": 46774373, "body": "Feel free to edit the formula as you like, the important thing is that 6 steps I mentioned in the first message are achieved, the method can vary. As per the sheets, I usually deal with files with at least 10 sheets."}, {"owner": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "edited": false, "score": 0, "creation_date": 1427406092, "post_id": 29243050, "comment_id": 46775958, "body": "The code is now updated to store previous choices in an array, so if on the first page you choose <b>apple</b> and then on the second page you choose <b>apples</b>, then on pages 3-n, the code will search for either <b>apple</b> or <b>apples</b>."}, {"owner": {"reputation": 23, "user_id": 4663117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3bcbac34e2d519594245d1c7be8467?s=128&d=identicon&r=PG&f=1", "display_name": "Marrone", "link": "https://stackoverflow.com/users/4663117/marrone"}, "reply_to_user": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "edited": false, "score": 0, "creation_date": 1427471370, "post_id": 29243050, "comment_id": 46803975, "body": "Thanks! Now it works perfectly. One more thing: do you know why the 100% zoom is only applied to one sheet instead of all? Also, I&#39;ve got an alternative code which works differently and it&#39;s is significantly lighter (you can find the code in my first message), but it seems to filter only the first keyword and not all of them. Do you you think it would be a simpler solution?"}, {"owner": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "edited": false, "score": 0, "creation_date": 1427574109, "post_id": 29243050, "comment_id": 46835382, "body": "It wasn&#39;t zooming because the <code>ActiveWindow.Zoom = 100</code> was in the wrong location...the code has been updated to achieve the proper zoom.  The alternative code does not achieve 1,3,5,6, so I would just use your original example.  It the answer works for you, please accept it (<a href=\"http://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>)"}, {"owner": {"reputation": 23, "user_id": 4663117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3bcbac34e2d519594245d1c7be8467?s=128&d=identicon&r=PG&f=1", "display_name": "Marrone", "link": "https://stackoverflow.com/users/4663117/marrone"}, "reply_to_user": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "edited": false, "score": 0, "creation_date": 1427720631, "post_id": 29243050, "comment_id": 46879705, "body": "Thank you very much for your help!"}], "answers": [{"tags": [], "owner": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "is_accepted": true, "score": 0, "last_activity_date": 1427469267, "last_edit_date": 1427469267, "creation_date": 1427234827, "answer_id": 29243792, "question_id": 29243050, "link": "https://stackoverflow.com/questions/29243050/show-columns-placed-in-multiple-ranges/29243792#29243792", "title": "Show columns placed in multiple ranges", "body": "<p>If you simply want a popup box for the user to select the 3 columns on each sheet, remove the line that reads</p>\n\n<pre><code>f = True\n</code></pre>\n\n<p>that is inside the <code>If f = False Then</code> statement.</p>\n\n<p>If you want the macro to \"remember\" the column headers for each column chosen on the first page, then you'll need to modify the code slightly (and make some assumptions):</p>\n\n<p>Assumptions</p>\n\n<ol>\n<li>The column headers are in the first row</li>\n<li>The column headers are unique (i.e., you don't have the same column title multiple times in the same sheet).</li>\n</ol>\n\n<p>EDIT: \nCode will now store all selected columns in an array that will search on each worksheet.  For example, if on worksheet 1 you have <strong>apple</strong>, <strong>banana</strong>, and <strong>coconut</strong>, you will get an initial <code>InputBox</code>.  If on worksheet 3, you now have <strong>apples</strong>, <strong>bananas</strong>, and <strong>coconuts</strong>, then you will get a second <code>InputBox</code> asking for these values.  Now, on worksheets 4-n, the code will search for <em>either</em> <strong>apple</strong> or <strong>apples</strong>.</p>\n\n<p>Code</p>\n\n<pre><code>Sub AdjustTF()\nColumnWidth = 10\nDim wsh As Worksheet\nDim rng As Range\nDim i As Long\nDim f As Boolean\nDim c As Long\n\n'Dim aCol(1 To 1, 1 To 3) As String\nDim aCol() As String\n    ReDim aCol(1 To 3, 1 To 1)\nDim iCol(1 To 3) As Integer\nDim iTemp As Integer\nDim uStr As String\n\nOn Error GoTo ErrHandler\n' The following two lines are optional\nWorksheets(1).Select\nRange(\"A1\").Select\nFor Each wsh In Worksheets\n    d = 1\n    wsh.Cells.WrapText = False\n    wsh.Cells.VerticalAlignment = xlBottom\n    wsh.Cells.HorizontalAlignment = xlLeft\n    wsh.Cells.EntireColumn.Hidden = False\n    If f = False Then\n        On Error Resume Next\n            Err.Number = 0\n            Set rng = Application.InputBox( _\n                Prompt:=\"Select the columns to keep.\", _\n                Type:=8).EntireColumn\n            If Err.Number &gt; 0 Then\n                Exit Sub\n            End If\n        On Error GoTo ErrHandler\n\n        f = True\n        aCol(1, 1) = wsh.Cells(1, rng.Areas(1).Column).Value\n        aCol(2, 1) = wsh.Cells(1, rng.Areas(2).Column).Value\n        aCol(3, 1) = wsh.Cells(1, rng.Areas(3).Column).Value\n\n    Else\n        On Error Resume Next\n            For a = 1 To 3\n                iCol(a) = 0\n            Next\n            For a = 1 To UBound(aCol, 2)\n                Err.Number = 0\n                iTemp = wsh.Cells.Find(what:=aCol(1, a), lookat:=xlWhole).Column\n                    If Err.Number = 0 And iCol(1) = 0 Then iCol(1) = iTemp\n                Err.Number = 0\n                iTemp = wsh.Cells.Find(what:=aCol(2, a), lookat:=xlWhole).Column\n                    If Err.Number = 0 And iCol(2) = 0 Then iCol(2) = iTemp\n                Err.Number = 0\n                iTemp = wsh.Cells.Find(what:=aCol(3, a), lookat:=xlWhole).Column\n                    If Err.Number = 0 And iCol(3) = 0 Then iCol(3) = iTemp\n\n                If iCol(1) &gt; 0 And iCol(2) &gt; 0 And iCol(3) &gt; 0 Then Exit For\n            Next\n            If iCol(1) = 0 Or iCol(2) = 0 Or iCol(3) = 0 Then\n                wsh.Activate\n                    Err.Number = 0\n                    Set rng = Application.InputBox( _\n                        Prompt:=\"Select the columns to keep.\", _\n                        Type:=8).EntireColumn\n                    If Err.Number &gt; 0 Then\n                        Exit Sub\n                    End If\n\n\n                a = UBound(aCol, 2) + 1\n                ReDim Preserve aCol(1 To 3, 1 To a)\n                aCol(1, a) = wsh.Cells(1, rng.Areas(1).Column).Value\n                aCol(2, a) = wsh.Cells(1, rng.Areas(2).Column).Value\n                aCol(3, a) = wsh.Cells(1, rng.Areas(3).Column).Value\n\n            Else\n                uStr = Range(wsh.Cells(1, iCol(1)), wsh.Cells(1, iCol(1))).Address &amp; \",\" &amp; _\n                    Range(wsh.Cells(1, iCol(2)), wsh.Cells(1, iCol(2))).Address &amp; \",\" &amp; _\n                    Range(wsh.Cells(1, iCol(3)), wsh.Cells(1, iCol(3))).Address\n\n\n                Set rng = Range(uStr)\n            End If\n        On Error GoTo ErrHandler\n    End If\n\n    Set rng = wsh.Range(rng.Address).EntireColumn\n\n\n    c = wsh.Cells.Find(what:=\"*\", SearchOrder:=xlByColumns, _\n        SearchDirection:=xlPrevious).Column\n    wsh.Range(wsh.Cells(1, 1), wsh.Cells(1, c)).EntireColumn.Hidden = True\n    With rng\n        .Hidden = False\n        With .Areas(1)\n            .ColumnWidth = 3\n            For i = 1 To 3\n                .ColumnWidth = 120 / .Width * .ColumnWidth\n            Next i\n            .ShrinkToFit = True\n        End With\n        With .Areas(2)\n            .ColumnWidth = 8\n            For i = 1 To 3\n                .ColumnWidth = 350 / .Width * .ColumnWidth\n            Next i\n            .WrapText = True\n        End With\n        With .Areas(3)\n            .ColumnWidth = 8\n            For i = 1 To 3\n                .ColumnWidth = 350 / .Width * .ColumnWidth\n            Next i\n            .WrapText = True\n        End With\n    End With\n    wsh.Cells.EntireRow.AutoFit\n    wsh.Activate\n    ActiveWindow.Zoom = 100\n    wsh.Cells(1, 1).Select\nNextSheet:\n    Next wsh\n    Application.Goto Worksheets(1).Range(\"A1\"), True\n    Exit Sub\nErrHandler:\n    Select Case Err\n        Case 424 ' Object required\n            Resume NextSheet\n        Case Else\n            MsgBox Err.Description, vbExclamation\n    End Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4663117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3bcbac34e2d519594245d1c7be8467?s=128&d=identicon&r=PG&f=1", "display_name": "Marrone", "link": "https://stackoverflow.com/users/4663117/marrone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 29243792, "answer_count": 1, "score": 0, "last_activity_date": 1427471410, "creation_date": 1427231796, "last_edit_date": 1427471410, "question_id": 29243050, "link": "https://stackoverflow.com/questions/29243050/show-columns-placed-in-multiple-ranges", "title": "Show columns placed in multiple ranges", "body": "<p>I have multiple Excel files with the following structure:</p>\n\n<p>Each file has the exact same columns (Apples, Oranges, Bananas, etc.) but placed under different letters throughout the sheets. For example, column \"Apples\" is under letter A in the first 5 sheets, but it's under letter C in the rest of the sheets. This order is not consistent and varies in each file.</p>\n\n<p>I would like a macro capable of:</p>\n\n<ol>\n<li>Unwrap all the cells in all sheets.</li>\n<li>Hide columns from A to Z in all sheets.</li>\n<li>Unhide only three columns featuring the words \"apples/apple\", \"oranges/orange\" and \"bananas/bananas\" in row 1.</li>\n<li>Shrink to fit the text in the \"apples/apple\" column and set the width to 120.</li>\n<li>Wrap to fit the text on the \"oranges/orange\" and \"bananas/bananas\" columns and set the width to 350.</li>\n<li>Zoom all sheets to 100%.</li>\n</ol>\n\n<p>I have this macro that works like a charm, as it allows me to choose which three columns I want to keep. However, it works exclusively if they are placed in the exact same order in all sheets:</p>\n\n<pre><code>Sub AdjustTF()\nColumnWidth = 10\nActiveWindow.Zoom = 100\nDim wsh As Worksheet\nDim rng As Range\nDim i As Long\nDim f As Boolean\nDim c As Long\nOn Error GoTo ErrHandler\n' The following two lines are optional\nWorksheets(1).Select\nRange(\"A1\").Select\nFor Each wsh In Worksheets\n    wsh.Cells.WrapText = False\n    wsh.Cells.VerticalAlignment = xlBottom\n    wsh.Cells.HorizontalAlignment = xlLeft\n    wsh.Cells.EntireColumn.Hidden = False\n    If f = False Then\n        Set rng = Application.InputBox( _\n            Prompt:=\"Select the columns to keep.\", _\n            Type:=8).EntireColumn\n        f = True\n    End If\n    Set rng = wsh.Range(rng.Address).EntireColumn\n    c = wsh.Cells.Find(What:=\"*\", SearchOrder:=xlByColumns, _\n        SearchDirection:=xlPrevious).Column\n    wsh.Range(wsh.Cells(1, 1), wsh.Cells(1, c)).EntireColumn.Hidden = True\n    With rng\n        .Hidden = False\n        With .Areas(1)\n            .ColumnWidth = 3\n            For i = 1 To 3\n                .ColumnWidth = 120 / .Width * .ColumnWidth\n            Next i\n            .ShrinkToFit = True\n        End With\n        With .Areas(2)\n            .ColumnWidth = 8\n            For i = 1 To 3\n                .ColumnWidth = 350 / .Width * .ColumnWidth\n            Next i\n            .WrapText = True\n        End With\n        With .Areas(3)\n            .ColumnWidth = 8\n            For i = 1 To 3\n                .ColumnWidth = 350 / .Width * .ColumnWidth\n            Next i\n            .WrapText = True\n        End With\n    End With\n    wsh.Cells.EntireRow.AutoFit\nNextSheet:\n    Next wsh\n    Application.Goto Worksheets(1).Range(\"A1\"), True\n    Exit Sub\nErrHandler:\n    Select Case Err\n        Case 424 ' Object required\n            Resume NextSheet\n        Case Else\n            MsgBox Err.Description, vbExclamation\n    End Select\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT:</strong> I've also this code, which is significantly lighter (even though doesn't quite perform all tasks I wanted) but for some reasons works only with a single file and not when assigned to my Personal.xls sheet.</p>\n\n<pre><code>Sub AdjustTFAlternate()\n  Dim R As Range\n  Dim Ws As Worksheet\n  Dim Item\n  'In each worksheet\n  For Each Ws In ActiveWorkbook.Worksheets\n    'Hide all columns\n    Ws.UsedRange.EntireColumn.Hidden = True\n    'Search for this words\n    For Each Item In Array(\"apple*\", \"orange*\", \"banana*\")\n      'Search for a keyword in the 1st row\n      Set R = Ws.Rows(1).Find(Item, LookIn:=xlFormulas, LookAt:=xlWhole)\n      If R Is Nothing Then\n        'Not found\n        Exit For\n      End If\n      'Unhide this column\n      R.EntireColumn.Hidden = False\n    Next\n  Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "edited": false, "score": 0, "creation_date": 1427231781, "post_id": 29242843, "comment_id": 46692048, "body": "is each record on a new line?  The OP&#39;s unformatted data looked like the data didn&#39;t have any line breaks in it, in which case this wouldn&#39;t work.  Otherwise, if each entry is on a new line, then this is good."}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "reply_to_user": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "edited": false, "score": 0, "creation_date": 1427233330, "post_id": 29242843, "comment_id": 46692786, "body": "@Michael: OP&#39;s data <i>looked</i> like it had no line breaks  -- but OP had indeed typed line breaks in the question. They just didn&#39;t show when looked at through the Stack Overflow parser. Once formatted as code they did show. Have a look at the edit history if you want to convince yourself!"}, {"owner": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "edited": false, "score": 0, "creation_date": 1427235074, "post_id": 29242843, "comment_id": 46693586, "body": "Well, now the problem becomes trivial.  I was seeing if there was a way of implementing a RegExp to search for a <code>Recipient, PanelSize, NumberOfAlerts</code> combination, but that was extremely difficult."}], "tags": [], "owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "is_accepted": true, "score": 3, "last_activity_date": 1427275356, "last_edit_date": 1427275356, "creation_date": 1427231032, "answer_id": 29242843, "question_id": 29242296, "link": "https://stackoverflow.com/questions/29242296/vba-macro-to-read-string-with-delimited-and-non-delimited-spaces/29242843#29242843", "title": "vba Macro to Read String with delimited and non delimited spaces", "body": "<p>This works:</p>\n\n<pre><code>Dim sLine As String\nsLine = \"Michigan Patient Care          6789                       1056\"\n\n'Remove all double spaces\nDo While InStr(sLine, \"  \") &lt;&gt; 0\n    sLine = Replace(sLine, \"  \", \" \")\nLoop\n\n'Split using space delimiters\nDim splitLine() As String\nsplitLine = Split(sLine, \" \")\n\n'Collect recipient pieces \n'(i.e. all pieces but the last two, which we know are PanelSize and NumberOfAlerts)\nDim splitRecipient() As String\nReDim splitRecipient(0 To UBound(splitLine) - 2)\nDim i As Long\nFor i = 0 To UBound(splitRecipient)\n    splitRecipient(i) = splitLine(i)\nNext i\n\n'Join recipient pieces\nMsgBox \"Recipient: \" &amp; Join(splitRecipient, \" \") &amp; vbCrLf &amp; _\n    \"PanelSize: \" &amp; splitLine(UBound(splitLine) - 1) &amp; vbCrLf &amp; _\n    \"NumberOfAlerts: \" &amp; splitLine(UBound(splitLine))\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/XzgEB.png\" alt=\"enter image description here\"></p>\n\n<p>But really, if your file is in fixed width format, with columns always having the same width and padded with spaces, then it's much easier. In your example, the first column looks like it's 30 chars wide, and the second, 27. So in this case, you could do this:</p>\n\n<pre><code>Dim sLines() As String\nReDim sLines(1 To 3)\nsLines(1) = \"Michigan Regional             42454                      15756\"\nsLines(2) = \"Wellcare                      21234                       8492\"\nsLines(3) = \"Michigan Patient Care          6789                       1056\"\n\nDim iLine As Long\nFor iLine = LBound(sLines) To UBound(sLines)\n    MsgBox \"Recipient: \" &amp; Trim(Mid(sLines(iLine), 1, 30)) &amp; vbCrLf &amp; _\n        \"PanelSize: \" &amp; Trim(Mid(sLines(iLine), 31, 27)) &amp; vbCrLf &amp; _\n        \"NumberOfAlerts: \" &amp; Trim(Mid(sLines(iLine), 58))\nNext iLine\n</code></pre>\n\n<p>The first line is then parsed as:</p>\n\n<p><img src=\"https://i.stack.imgur.com/oyr0F.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 75, "user_id": 1867785, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0406d1ba9371b3225e9eb0a502e763db?s=128&d=identicon&r=PG", "display_name": "Dylan Haines", "link": "https://stackoverflow.com/users/1867785/dylan-haines"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 29242843, "answer_count": 1, "score": 1, "last_activity_date": 1594645162, "creation_date": 1427229011, "last_edit_date": 1594645162, "question_id": 29242296, "link": "https://stackoverflow.com/questions/29242296/vba-macro-to-read-string-with-delimited-and-non-delimited-spaces", "title": "vba Macro to Read String with delimited and non delimited spaces", "body": "<p>I have a .txt document that has table information as follows</p>\n\n<pre><code>Recipient                    PanelSize                  NumberOfAlerts\n\nMichigan Regional             42454                      15756\nWellcare                      21234                       8492\nMichigan Patient Care          6789                       1056\n</code></pre>\n\n<p>I am using a VBA macro to read the .txt file and input into an Excel sheet.</p>\n\n<p>I am having problems mainly with the Recipient. The recipient names contain spaces, so using </p>\n\n<pre><code>vDatavalues = Split(sLine, \" \")\n</code></pre>\n\n<p>separates Recipients like</p>\n\n<pre><code>Michigan|       |Patient|        |Care|\n</code></pre>\n\n<p>which I do not want. </p>\n\n<p>How can I split the lines I am reading to format into the 3 columns correctly reading line by line from the table?</p>\n\n<p>EDIT: Here is an example of the .txt files I am trying to read and format <a href=\"https://onedrive.live.com/redir?resid=B49EE8B8E5559AE!107&amp;authkey=!AKWEjCRLeUITplU&amp;ithint=file%2ctxt\" rel=\"nofollow\">TEST.txt</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1427226900, "post_id": 29241599, "comment_id": 46689387, "body": "Check which line is causing your problem by removing one of the 2 in the <code>With</code>"}, {"owner": {"reputation": 757, "user_id": 3504466, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e403443744e98a4c9ddd6316ce487c36?s=128&d=identicon&r=PG&f=1", "display_name": "Jain", "link": "https://stackoverflow.com/users/3504466/jain"}, "edited": false, "score": 0, "creation_date": 1427229063, "post_id": 29241599, "comment_id": 46690584, "body": "I have already labelled row 1. I want data to start from row 2, but data starts from 1 only and row 1 and row 2 are showing same data"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1427230236, "post_id": 29241599, "comment_id": 46691234, "body": "Did you try setting the ActiveCell to &quot;A2&quot;, and then copying the recordset? Like <code>ActiveCell = Range(&quot;A2&quot;)</code> before the <code>with</code> block, and <code>.Range(&quot;A2&quot;).CopyFromRecordset rs</code> inside the block?"}, {"owner": {"reputation": 757, "user_id": 3504466, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e403443744e98a4c9ddd6316ce487c36?s=128&d=identicon&r=PG&f=1", "display_name": "Jain", "link": "https://stackoverflow.com/users/3504466/jain"}, "edited": false, "score": 0, "creation_date": 1427230770, "post_id": 29241599, "comment_id": 46691524, "body": "Thanks. I will try that and get back."}], "owner": {"reputation": 757, "user_id": 3504466, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e403443744e98a4c9ddd6316ce487c36?s=128&d=identicon&r=PG&f=1", "display_name": "Jain", "link": "https://stackoverflow.com/users/3504466/jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1427235882, "creation_date": 1427226575, "last_edit_date": 1427235882, "question_id": 29241599, "link": "https://stackoverflow.com/questions/29241599/headers-in-excel-get-replaced", "title": "Headers in excel get replaced", "body": "<p>I am pasting data from a record set in Excel. I have already named the first row as header, manually. Now I am pasting data starting from second row, but my headers get replaced by data in first row itself. Can anybody guess as what can be the problem?</p>\n\n<pre><code>lastrow = Worksheets(\"Sheet1\").Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nWith Worksheets(\"Sheet1\")\n    .Range(\"A2:DH\" &amp; lastrow).Cells.ClearContents\n    .Cells(2, 1).CopyFromRecordset rs\nEnd With\n</code></pre>\n\n<p><strong>Edit:</strong> The First and Second row are same. i.e Header is replaced by data which is supposed to be the first row of data and it is not the case from where the data is pulled. May be this provides some more info on what can be the problem.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1427226347, "post_id": 29241482, "comment_id": 46689057, "body": "<code>If Worksheets(&quot;In Stock&quot;).Cells(i, 11) &lt;  98 Then GoTo JMP1</code> Should work. Unless the cell contain a &#39;%&#39; sign"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1427226378, "post_id": 29241482, "comment_id": 46689079, "body": "If it&#39;s a percentage, then it&#39;s less than 0.98, not 98."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 1, "creation_date": 1427226524, "post_id": 29241482, "comment_id": 46689162, "body": "<code>Worksheets(&quot;In Stock&quot;).Cells(20,   1).Value</code> etc are never updated.  Did you mean <code>Worksheets(&quot;In Stock&quot;).Cells(19+z,   1).Value</code>.  I should add that this is dreadful code. Where did you get it? `"}, {"owner": {"reputation": 3, "user_id": 4709064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d8488cfb025f4d1a05f7c7c20d7df22?s=128&d=identicon&r=PG&f=1", "display_name": "Aisha", "link": "https://stackoverflow.com/users/4709064/aisha"}, "edited": false, "score": 0, "creation_date": 1427226911, "post_id": 29241482, "comment_id": 46689394, "body": "Hi Tony, this worked great- thanks so much for your help!  A colleague helped me out, but I&#39;m thinking that after this- I will be picking up some VBA manuals myself."}, {"owner": {"reputation": 3, "user_id": 4709064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d8488cfb025f4d1a05f7c7c20d7df22?s=128&d=identicon&r=PG&f=1", "display_name": "Aisha", "link": "https://stackoverflow.com/users/4709064/aisha"}, "edited": false, "score": 0, "creation_date": 1427226920, "post_id": 29241482, "comment_id": 46689398, "body": "Thanks a bunch for your help everyone!"}], "answers": [{"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1427231116, "creation_date": 1427231116, "answer_id": 29242867, "question_id": 29241482, "link": "https://stackoverflow.com/questions/29241482/vba-excel-macro-copies-the-first-line-multiple-times-instead-of-going-to-the-sec/29242867#29242867", "title": "VBA Excel Macro copies the first line multiple times instead of going to the second line", "body": "<p><code>GoTo</code> is generally considered the bane of modern society and should be avoided whenever possible. It makes code very difficult to follow for the person coming along behind you (or for you when you have to revisit it in 6 months). This will make your code much more readable:</p>\n\n<pre><code>Option Explicit\nDim SourceRow As Integer\nDim DestRow as Integer\nDim Col as Integer \n\nSourceRow = 3\n\nFor DestRow = 20 To Worksheets(\"In Stock\").TextBox1.Value\n  If Worksheets(\"In Stock\").Cells(DestRow, 11) &lt; 0.98 Then  \n    With Worksheets(\"Low\")\n      For Col = 1 to 13\n        .Cells(SourceRow, Col) = Worksheets(\"In Stock\").Cells(DestRow, Col)\n      Next\n    End With\n    SourceRow = SourceRow + 1\n  End If\nNext \n\nWorksheets(\"Low\").Select\n</code></pre>\n\n<p>As was mentioned in the comments, since you're looking for a percentage, your <code>If</code> should be comparing to <code>0.98</code>, and since it's a numeric, there's no reason to put it in quotes <code>\"98\"</code> and force Excel to convert it from a string to a float every time.</p>\n"}], "owner": {"reputation": 3, "user_id": 4709064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d8488cfb025f4d1a05f7c7c20d7df22?s=128&d=identicon&r=PG&f=1", "display_name": "Aisha", "link": "https://stackoverflow.com/users/4709064/aisha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427231116, "creation_date": 1427226194, "question_id": 29241482, "link": "https://stackoverflow.com/questions/29241482/vba-excel-macro-copies-the-first-line-multiple-times-instead-of-going-to-the-sec", "title": "VBA Excel Macro copies the first line multiple times instead of going to the second line", "body": "<p>I need your input. </p>\n\n<p>On Sheet 1  \"In Stock\", I have 13 columns of data with about 300 rows. I need to copy this data into sheet 2 \"Low\" based on the value of column 11. </p>\n\n<p>If column 11 is less than 98%, I need to copy the data. </p>\n\n<p>Here is my macro:</p>\n\n<pre><code>Dim z As Integer\n\nz = 3\n\nFor i = 20 To Worksheets(\"In Stock\").TextBox1.Value\nIf Worksheets(\"In Stock\").Cells(i, 11) &lt; \"98\" Then GoTo JMP1\nGoTo JMP2\n\nJMP1:\nWorksheets(\"Low\").Cells(z, 1).Value = Worksheets(\"In Stock\").Cells(20,   1).Value\nWorksheets(\"Low\").Cells(z, 2).Value = Worksheets(\"In Stock\").Cells(20, 2).Value\nWorksheets(\"Low\").Cells(z, 3).Value = Worksheets(\"In Stock\").Cells(20, 3).Value\nWorksheets(\"Low\").Cells(z, 4).Value = Worksheets(\"In Stock\").Cells(20, 4).Value\nWorksheets(\"Low\").Cells(z, 5).Value = Worksheets(\"In Stock\").Cells(20, 5).Value\nWorksheets(\"Low\").Cells(z, 6).Value = Worksheets(\"In Stock\").Cells(20, 6).Value\nWorksheets(\"Low\").Cells(z, 7).Value = Worksheets(\"In Stock\").Cells(20, 7).Value\nWorksheets(\"Low\").Cells(z, 8).Value = Worksheets(\"In Stock\").Cells(20, 8).Value\nWorksheets(\"Low\").Cells(z, 9).Value = Worksheets(\"In Stock\").Cells(20, 9).Value\nWorksheets(\"Low\").Cells(z, 10).Value = Worksheets(\"In Stock\").Cells(20, 10).Value\nWorksheets(\"Low\").Cells(z, 11).Value = Worksheets(\"In Stock\").Cells(20, 11).Value\nWorksheets(\"Low\").Cells(z, 12).Value = Worksheets(\"In Stock\").Cells(20, 12).Value\nWorksheets(\"Low\").Cells(z, 13).Value = Worksheets(\"In Stock\").Cells(20, 13).Value\n\nz = z + 1\n\nJMP2:\nNext i\nWorksheets(\"Low\").Select\n</code></pre>\n\n<p>As you can see, it's a simple copy/paste based on an if but for some reason- the macro just copies the first line instead of skipping to the second line that is under 98%. </p>\n\n<p>Also, instead of copying the full value of the data in the columns- I am just seeing zeros right now.</p>\n\n<p>Many thanks for your help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 93, "user_id": 4570045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70bfa73fea7427e9819d28f1edf6c83?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Wickett", "link": "https://stackoverflow.com/users/4570045/mark-wickett"}, "edited": false, "score": 0, "creation_date": 1427239691, "post_id": 29241419, "comment_id": 46695334, "body": "You don&#39;t need to use VBA: use VLOOKUP to achieve this - see <a href=\"https://support.office.com/en-in/article/VLOOKUP-function-adceda66-30de-4f26-923b-7257939faa65\" rel=\"nofollow noreferrer\">support.office.com/en-in/article/&hellip;</a> to get started"}], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 4663401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac32b68acf50cf217119913894e7f2a6?s=128&d=identicon&r=PG&f=1", "display_name": "amg", "link": "https://stackoverflow.com/users/4663401/amg"}, "is_accepted": true, "score": 0, "last_activity_date": 1427377659, "creation_date": 1427377659, "answer_id": 29280141, "question_id": 29241419, "link": "https://stackoverflow.com/questions/29241419/read-in-customerid-from-sheet1-find-customerid-on-sheet-2-copy-paste-customern/29280141#29280141", "title": "Read-in CustomerID from Sheet1, find CustomerID on Sheet 2, copy/paste CustomerName to Sheet1", "body": "<p><strong>\" Mark Wickett \"</strong> has correctly pointed it out.\nBut if you still want to go to the vba than here it is.</p>\n\n<p>say here is the screenshot of your first sheet\n<img src=\"https://i.stack.imgur.com/b9rct.jpg\" alt=\"enter image description here\"></p>\n\n<p>and here is screenshot of your second sheet</p>\n\n<p><img src=\"https://i.stack.imgur.com/91fhq.jpg\" alt=\"enter image description here\"></p>\n\n<p>Here is the Code</p>\n\n<pre><code>Dim rngCust As Range\nDim rNo As Long\nDim strCust As String\nDim rngSearch As Range\nDim rngFound As Range\nDim intFound As Long\n\nApplication.ScreenUpdating = False\n\nSet rngCust = Sheets(1).Range(Cells(2, 1), Cells(2, 1).End(xlDown))\n    For Each cell In rngCust.Cells\n        rNo = cell.Row\n        strCust = Cells(rNo, 1).Value\n        Sheets(2).Select\n            Set rngSearch = Sheets(2).Range(Cells(2, 1), Cells(2, 1).End(xlDown))\n            Set rngFound = rngSearch.Find(What:=strCust, Lookat:=xlWhole, _\n                           SearchOrder:=xlByRows, searchdirection:=xlNext, _\n                           MatchCase:=False)\n            If Not rngFound Is Nothing Then\n                intFound = rngFound.Row\n            End If\n        Sheets(1).Select\n        Sheets(1).Cells(rNo, 2).Value = Sheets(2).Cells(intFound, 2).Value\n\n    Next\n    Application.ScreenUpdating = True\n</code></pre>\n\n<p><strong>here is the Output</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/C83G8.jpg\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 29, "user_id": 4675576, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205273108602866/picture?type=large", "display_name": "Michael Lengs&#248;", "link": "https://stackoverflow.com/users/4675576/michael-lengs%c3%b8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 29280141, "answer_count": 1, "score": 0, "last_activity_date": 1427377659, "creation_date": 1427226017, "question_id": 29241419, "link": "https://stackoverflow.com/questions/29241419/read-in-customerid-from-sheet1-find-customerid-on-sheet-2-copy-paste-customern", "title": "Read-in CustomerID from Sheet1, find CustomerID on Sheet 2, copy/paste CustomerName to Sheet1", "body": "<p>I'm quite new at excel, so please bear with me.</p>\n\n<p>On Sheet1 of my workbook I have data like CostumerID, CostumerName, Email and so on spread in columns A-G. CostumerID is filled with ID's and CostumerName is empty.</p>\n\n<p>On Sheet2 of my workbook I have 2 columns (A and B). Column A contains CustomerID and column B contains the correct CustomerName for that CustomerID.</p>\n\n<p>My problem is:</p>\n\n<p>I need a macro that goes to Sheet1, reads the CustomerID in column A, then goes to Sheet2, find that CustomerID also in column A, get the CustomerName in column B and paste that name to column B in Sheet1 next to cell from which it got the first CustomerID.</p>\n\n<p>Further ellaboration:</p>\n\n<p>Step 1: Get value of cell in column A on Sheet 1</p>\n\n<p>Step 2: Go to Sheet2, find that value in column A, then copy CustomerName from same row.</p>\n\n<p>Step 3: Paste that CostumerName into column B on the same row as original value from column A on Sheet1.</p>\n\n<p>Sheet1 can be 100-6000 rows, and it needs to check all CustomerID's in column A in Sheet1 and find the corresponding CustomerName. There can be duplicates in column A on Sheet1, but the value of columns D, F and G are all unique.</p>\n\n<p>Normally I would present my attempt on how to do this, but I have no idea how to do this.</p>\n\n<p>Anybody have an idea?</p>\n\n<p>Any help would be greatly appreciated!</p>\n"}, {"tags": ["vba", "userform"], "comments": [{"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1427225756, "post_id": 29241292, "comment_id": 46688707, "body": "The problem here is that this form is (hopefully) actually a &quot;Continuous Form&quot; and each record contains controls with the same name.  I say &quot;hopefully&quot; because if your table is set up so that every control name in that picture is unique, you need to take a database design class.  Can you do this with a query, or even VBA if absolutely necessary?"}, {"owner": {"reputation": 125, "user_id": 4533426, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/915128241833410/picture?type=large", "display_name": "AggieIE", "link": "https://stackoverflow.com/users/4533426/aggieie"}, "reply_to_user": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1427226346, "post_id": 29241292, "comment_id": 46689055, "body": "@JohnnyBones Every column has a unique name. Like in the &quot;area&quot; column the names are <b>areadd1, areaadd2</b> and so forth. And no, I cant use a query."}, {"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1427227956, "post_id": 29241292, "comment_id": 46689962, "body": "When you say &quot;need a way to read the values of the line and reason columns into arrays based upon the values of &#39;Area&#39; and &#39;Shift&#39;&quot;, can you expand on that a bit?  I&#39;m not sure what is going into the array.  Are you only looking to put the Line and Reason fields into the array when Area = &quot;Kitting&quot; and Shift = &quot;1&quot;?"}, {"owner": {"reputation": 125, "user_id": 4533426, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/915128241833410/picture?type=large", "display_name": "AggieIE", "link": "https://stackoverflow.com/users/4533426/aggieie"}, "reply_to_user": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1427231018, "post_id": 29241292, "comment_id": 46691627, "body": "@JohnnyBones Basically I want to create 6 arrays for every combination of &quot;Area&quot; and &quot;Shift.&quot; So one for Kitting Shift 1, another for Kitting Shift2, one for Delivery Shift 1 and so forth"}], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 2, "last_activity_date": 1427244765, "creation_date": 1427244765, "answer_id": 29245666, "question_id": 29241292, "link": "https://stackoverflow.com/questions/29241292/loop-through-single-column-of-userform/29245666#29245666", "title": "Loop through single column of Userform", "body": "<p>If you've manage to standardized your naming, you can do it like this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim i As Integer\n    Dim areaCB As MSForms.ComboBox\n    Dim shiftCB As MSForms.ComboBox\n    Dim reasonCB  As MSForms.ComboBox\n    Dim somearray\n\n    For i = 1 To 3 ' 3 or more depending on how may you have in your form\n        Set areaCB = Me.Controls(\"areadd\" &amp; i)\n        Set shiftCB = Me.Controls(\"shiftdd\" &amp; i)\n        Set reasonCB = Me.Controls(\"reasondd\" &amp; i)\n\n        If areaCB.Value = \"Kitting\" _\n        And shiftCB.Value = \"1\" Then\n            If IsArray(somearray) Then\n                ReDim Preserve somearray(UBound(somearray) + 1)\n                somearray(UBound(somearray)) = reasonCB.Value\n            Else\n                somearray = Array(reasonCB.Value)\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>So for example in <em>areadd1</em>, <strong>1</strong> is the row number.<br>\nCorrespondingly, the <em>ComboBox</em> next to it to the right is <em>shiftdd1</em> and so on.<br>\nThis is just to give you idea. Modify it to suit your needs.</p>\n"}], "owner": {"reputation": 125, "user_id": 4533426, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/915128241833410/picture?type=large", "display_name": "AggieIE", "link": "https://stackoverflow.com/users/4533426/aggieie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 29245666, "answer_count": 1, "score": 0, "last_activity_date": 1427244765, "creation_date": 1427225549, "last_edit_date": 1427239409, "question_id": 29241292, "link": "https://stackoverflow.com/questions/29241292/loop-through-single-column-of-userform", "title": "Loop through single column of Userform", "body": "<p>I've worked with userforms in VBA a bit and know some of the tricks for looping through all controls. However, I'm running into issues with this one, and need a way to read the values of the line and reason columns into arrays based upon the values of <b> \"Area\" </b> and <b> \"Shift\"</b>. The possible values for these two columns are in the picture. <br>\n<br>\nBasically what I need is something like </p>\n\n<pre><code>For Each ctl In Me.Controls\n    If somectl.Value = \"Kitting\" And otherctl.Value = \"1\" Then\n        ReDim Preserve somearray(i)\n        somearray(i) = ctl.Value\n    End If\nNext ctl\n</code></pre>\n\n\n\n<p><img src=\"https://i.stack.imgur.com/dRitO.jpg\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 4566870, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b401fe7a3b8d296cb4946703b214c49?s=128&d=identicon&r=PG&f=1", "display_name": "blackwind", "link": "https://stackoverflow.com/users/4566870/blackwind"}, "edited": false, "score": 0, "creation_date": 1427241487, "post_id": 29244492, "comment_id": 46695871, "body": "Thanks for this, but I think it doesn&#39;t work in my case... All my buttons and radio button macros stopped working. Is there something I need to do a little differently in this case?"}, {"owner": {"reputation": 5111, "user_id": 1359088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4ffb15d50db85cc68143626a8e0046?s=128&d=identicon&r=PG", "display_name": "James Toomey", "link": "https://stackoverflow.com/users/1359088/james-toomey"}, "reply_to_user": {"reputation": 91, "user_id": 4566870, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b401fe7a3b8d296cb4946703b214c49?s=128&d=identicon&r=PG&f=1", "display_name": "blackwind", "link": "https://stackoverflow.com/users/4566870/blackwind"}, "edited": false, "score": 0, "creation_date": 1427303170, "post_id": 29244492, "comment_id": 46726007, "body": "So you put the code and forms in a *.dotm file, is that right? What about if you open the *.dotm file directly? Do the buttons work from it? Just trying to see if the *.dotm file is broken, or if something is breaking when the *.dotm file is attached to a new document and used."}, {"owner": {"reputation": 91, "user_id": 4566870, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b401fe7a3b8d296cb4946703b214c49?s=128&d=identicon&r=PG&f=1", "display_name": "blackwind", "link": "https://stackoverflow.com/users/4566870/blackwind"}, "edited": false, "score": 0, "creation_date": 1427363020, "post_id": 29244492, "comment_id": 46749359, "body": "Nope, not working in the dotm either. I cut and pasted all the code from &quot;ThisDocument&quot; to &quot;Module1&quot;, if that matters. I don&#39;t think copy paste is the right way to go, because it should only remain in the module, correct?"}, {"owner": {"reputation": 91, "user_id": 4566870, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b401fe7a3b8d296cb4946703b214c49?s=128&d=identicon&r=PG&f=1", "display_name": "blackwind", "link": "https://stackoverflow.com/users/4566870/blackwind"}, "edited": false, "score": 0, "creation_date": 1427363411, "post_id": 29244492, "comment_id": 46749589, "body": "I also just noticed that I can however run all the non private macros from the Macros window like you displayed in the screenshot. Just none of the form elements seem to be triggering anything automatically."}, {"owner": {"reputation": 5111, "user_id": 1359088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4ffb15d50db85cc68143626a8e0046?s=128&d=identicon&r=PG", "display_name": "James Toomey", "link": "https://stackoverflow.com/users/1359088/james-toomey"}, "reply_to_user": {"reputation": 91, "user_id": 4566870, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b401fe7a3b8d296cb4946703b214c49?s=128&d=identicon&r=PG&f=1", "display_name": "blackwind", "link": "https://stackoverflow.com/users/4566870/blackwind"}, "edited": false, "score": 0, "creation_date": 1427384538, "post_id": 29244492, "comment_id": 46763344, "body": "So the modules and form are all replicated verbatim among the various word docs? What about if you take one of those Word docs and do a Save As to an *.dotm file? In theory the form should still work right because it&#39;s an identical copy of the word doc. If it doesn&#39;t, maybe the security settings are blocking the code. These are under Orb&gt;Word Options&gt;Trust Center&gt;Trust Center Settings&gt;Macro Settings. Do the form elements make calls to other files by path, or perhaps to a database?"}, {"owner": {"reputation": 91, "user_id": 4566870, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b401fe7a3b8d296cb4946703b214c49?s=128&d=identicon&r=PG&f=1", "display_name": "blackwind", "link": "https://stackoverflow.com/users/4566870/blackwind"}, "edited": false, "score": 0, "creation_date": 1427396352, "post_id": 29244492, "comment_id": 46770752, "body": "The form in the template stops working once I move everything to the module, so it all breaks there already. Maybe because most of the codes are  &quot;private&quot; subs? Maybe that&#39;s the key to the problem? I turned of the security and that didn&#39;t help either. Also, no, it isn&#39;t pointing to anything external."}, {"owner": {"reputation": 5111, "user_id": 1359088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4ffb15d50db85cc68143626a8e0046?s=128&d=identicon&r=PG", "display_name": "James Toomey", "link": "https://stackoverflow.com/users/1359088/james-toomey"}, "reply_to_user": {"reputation": 91, "user_id": 4566870, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b401fe7a3b8d296cb4946703b214c49?s=128&d=identicon&r=PG&f=1", "display_name": "blackwind", "link": "https://stackoverflow.com/users/4566870/blackwind"}, "edited": false, "score": 0, "creation_date": 1427405504, "post_id": 29244492, "comment_id": 46775691, "body": "Okay, I think I understand better now. I rewrote the answer. Let me know if this helps."}], "tags": [], "owner": {"reputation": 5111, "user_id": 1359088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4ffb15d50db85cc68143626a8e0046?s=128&d=identicon&r=PG", "display_name": "James Toomey", "link": "https://stackoverflow.com/users/1359088/james-toomey"}, "is_accepted": true, "score": 3, "last_activity_date": 1427405472, "last_edit_date": 1427405472, "creation_date": 1427238012, "answer_id": 29244492, "question_id": 29240612, "link": "https://stackoverflow.com/questions/29240612/centralized-vba-code-for-multiple-word-files/29244492#29244492", "title": "Centralized VBA code for multiple Word files", "body": "<p>Yes, your idea of centralizing the code in a template and attaching that template to the various Word docs will work. These pics are using Word 2007 but I think it's pretty similar for newer versions. First create a new document and put the code in a Module (named \"CommonFunctions\" in the picture):</p>\n\n<p><img src=\"https://i.stack.imgur.com/lqk3A.png\" alt=\"enter image description here\"></p>\n\n<p>Save the doc as a macro-enabled template:</p>\n\n<p><img src=\"https://i.stack.imgur.com/DUTEp.png\" alt=\"enter image description here\"></p>\n\n<p>Now make a new document, save it as a *.docm (necessary for it to run code because a *.docx is macro-free), and attach the document template as shown below. (An alternative is to put the *.dotm file in the startup directory <code>C:\\Users\\&lt;username&gt;\\AppData\\Roaming\\Microsoft\\Word\\STARTUP</code>, which loads it automatically.) If you don't put it in the Startup, you'll see the name but it won't be loaded (ie, checked), but you can load it in code, as I'll show.</p>\n\n<p><img src=\"https://i.stack.imgur.com/9sTuj.png\" alt=\"enter image description here\"></p>\n\n<p>Make a user form in this document:</p>\n\n<p><img src=\"https://i.stack.imgur.com/zOlkq.png\" alt=\"enter image description here\"></p>\n\n<p>Put this code for the button's click event:</p>\n\n<pre><code>If AddIns(\"c:\\_b\\MasterDocWithFunctions.dotm\").Installed = False Then\n    AddIns(\"c:\\_b\\MasterDocWithFunctions.dotm\").Installed = True\nEnd If\n\nApplication.Run \"CommonFunctions.Test1\"\nApplication.Run \"CommonFunctions.Test2\"\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/HsFNa.png\" alt=\"enter image description here\"></p>\n\n<p>Notice how the code can load the AddIn for you, because it won't be automatically loaded unless you put it in the Startup directory. This pic shows how the AddIn is referenced but not loaded. You need the checkbox to be able to call code in it. If you don't load it using code and don't put it in the Startup, then the user will have to manually put a checkmark everytime the document opens.</p>\n\n<p><img src=\"https://i.stack.imgur.com/QwUsc.png\" alt=\"enter image description here\"></p>\n\n<p>Now the form should work when you click the button. Notice how it can call both public and private functions. The Private keyword definitely shields one module from another, but it seems like modules that are called from an AddIn are considered to be part of the same module, not sure why? Also if you don't put Public or Private at all then VBA considers it Public, I'm pretty sure.</p>\n\n<p><img src=\"https://i.stack.imgur.com/P8HwZ.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 91, "user_id": 4566870, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b401fe7a3b8d296cb4946703b214c49?s=128&d=identicon&r=PG&f=1", "display_name": "blackwind", "link": "https://stackoverflow.com/users/4566870/blackwind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1344, "favorite_count": 0, "accepted_answer_id": 29244492, "answer_count": 1, "score": 2, "last_activity_date": 1593766133, "creation_date": 1427223108, "last_edit_date": 1593766133, "question_id": 29240612, "link": "https://stackoverflow.com/questions/29240612/centralized-vba-code-for-multiple-word-files", "title": "Centralized VBA code for multiple Word files", "body": "<p>I have multiple files with the same VBA code in them, which will most likely have to be changed over time. I don't want to go one by one and c/p the code, so one obvious idea that came to mind is to have one centralized document with the code (template?) that all files refer to.</p>\n\n<p>I found a few topics here at stackoverflow, but none of them work for me or are inconclusive:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/3923778/run-external-vba-code-in-ms-word\">Run external vba-code in MS Word</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/28631897/centralized-vba-code-one-file-for-multiple-workbooks\">Centralized VBA code (one file) for multiple workbooks</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/6192618/calling-an-external-vba-from-vbscript\">Calling an External VBA from VBScript</a></p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1427222783, "creation_date": 1427222783, "answer_id": 29240521, "question_id": 29240251, "link": "https://stackoverflow.com/questions/29240251/vba-outlook-gettable-error-91-object-variable-and-with-block-variable-not-set/29240521#29240521", "title": "VBA Outlook - GetTable error 91: object variable and with block variable not set", "body": "<p>Looks like this is in Excel.</p>\n\n<p>In Tools | References add Outlook.</p>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1427226453, "creation_date": 1427226453, "answer_id": 29241562, "question_id": 29240251, "link": "https://stackoverflow.com/questions/29240251/vba-outlook-gettable-error-91-object-variable-and-with-block-variable-not-set/29241562#29241562", "title": "VBA Outlook - GetTable error 91: object variable and with block variable not set", "body": "<p>The error means MailItem.GetConversation() returns null. This can happens for the brand new messages (retrieved from objApp.ActiveInspector.CurrentItem in your code).\nYou must check the return value instead of assuming that you will always get back a valid object.</p>\n"}, {"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1427388913, "creation_date": 1427388913, "answer_id": 29284413, "question_id": 29240251, "link": "https://stackoverflow.com/questions/29240251/vba-outlook-gettable-error-91-object-variable-and-with-block-variable-not-set/29284413#29284413", "title": "VBA Outlook - GetTable error 91: object variable and with block variable not set", "body": "<p>It looks like the oConv object was not set correctly/initialized. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869870(v=office.15).aspx\" rel=\"nofollow\">GetConversation</a> method of the MailItem class returns null if no conversation exists for the item. No conversation exists for an item in the following scenarios:</p>\n\n<ul>\n<li>The item has not been saved. An item can be saved programmatically, by user action, or by auto-save.</li>\n<li>For an item that can be sent (for example, a mail item, appointment item, or contact item), the item has not been sent.</li>\n<li>Conversations have been disabled through the Windows registry.</li>\n<li>The store does not support Conversation view (for example, Outlook is running in classic online mode against a version of Microsoft Exchange earlier than Microsoft Exchange Server 2010). Use the IsConversationEnabled property of the Store object to determine whether the store supports Conversation view.</li>\n</ul>\n\n<p>So, if any of these statements is the case, your code will fail.</p>\n"}], "owner": {"reputation": 251, "user_id": 4233291, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/dca7b89667f1cb99a16263879305ac9b?s=128&d=identicon&r=PG&f=1", "display_name": "pexpex223", "link": "https://stackoverflow.com/users/4233291/pexpex223"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 817, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1593248127, "creation_date": 1427221953, "last_edit_date": 1593248127, "question_id": 29240251, "link": "https://stackoverflow.com/questions/29240251/vba-outlook-gettable-error-91-object-variable-and-with-block-variable-not-set", "title": "VBA Outlook - GetTable error 91: object variable and with block variable not set", "body": "<p>I am trying to get table from Outlook email and copy it to Excel using VBA.</p>\n\n<p>There is an error <code>91: object variable and with block variable not set</code> in the line below. I have been using the getCurrent() function in other modules and it works fine.</p>\n\n<pre><code>Set oTable = oConv.GetTable\n</code></pre>\n\n<p><strong>My VBA code:</strong></p>\n\n<pre><code>Public objApp As Outlook.Application\n\nSub ReadTable()\n\nDim oTable As Outlook.Table\nDim oConv As Outlook.Conversation\n\nSet oConv = GetCurrentItem().GetConversation\nSet oTable = oConv.GetTable\n\nEnd Sub\n\nFunction GetCurrentItem() As Object\n\nSet objApp = CreateObject(\"Outlook.Application\")\nOn Error Resume Next\nSelect Case TypeName(objApp.ActiveWindow)\n    Case \"Explorer\"\n        Set GetCurrentItem = objApp.ActiveExplorer.Selection.Item(1)\n    Case \"Inspector\"\n        Set GetCurrentItem = objApp.ActiveInspector.CurrentItem\nEnd Select\n\nSet objApp = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1427222606, "post_id": 29240222, "comment_id": 46687033, "body": "It would be easier to use excel formula"}, {"owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "reply_to_user": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1427223269, "post_id": 29240222, "comment_id": 46687423, "body": "@phil652 I am certainly open to that.  How can I sum the cells 2 and three rows from my active cell? I would prefer to have this done in the code, the point of this is to automate this process so going in to manually do this would defeat that purpose. I tried using the     &quot; ActiveCell.FormulaR1C1&quot; code but couldn&#39;t get anything to come of it. Thanks for your insight."}, {"owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1427225833, "post_id": 29240222, "comment_id": 46688749, "body": "@pnuts Awesome! Thanks again for your help, pnuts. The only issue I am having is with my line:  ActiveCell.FormulaR1C1 = &quot;=SUM(&#39;Asset_Dtl for CEQs for FAS 157&#39;!J:J)&quot;   After the macro runs the cell is left with &quot;=SUM(&#39;Asset_Dtl for CEQs for FAS 157&#39;!J:(J))&quot; and I have to manually go in to remove the parenthesis around the second J. Are you familiar with what causes this issue by chance?"}, {"owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1427227537, "post_id": 29240222, "comment_id": 46689730, "body": "@pnuts Aaah I see. I tried it without the R1C1 portion and it sort of works. It gives me the #REF error but when I go into the cell and hit enter it pulls the correct  data. I will continue to play around with that part.  Thanks so much for your assistance with this, it is greatly appreciated. Take care!"}, {"owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1427227655, "post_id": 29240222, "comment_id": 46689794, "body": "@pnuts Hey pnuts, I apologize for keeping this going but I do not see an option to select your response as the answer?"}], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "is_accepted": true, "score": 1, "last_activity_date": 1427386519, "creation_date": 1427386519, "answer_id": 29283577, "question_id": 29240222, "link": "https://stackoverflow.com/questions/29240222/use-vba-to-sum-several-cells-above-active-cell/29283577#29283577", "title": "Use VBA to sum several cells above active cell", "body": "<p>This answer was provided by pnuts (site wont let me select his response as answer):</p>\n\n<p>\"Once you have selected the 406 cell </p>\n\n<pre><code>Selection.FormulaR1C1 = \"=SUM(R[-3]C:R[-2]C)\" \n</code></pre>\n\n<p>\u2013  pnuts yesterday\"  </p>\n\n<p>Here is how I have applied it to my own macro:</p>\n\n<pre><code>Range(\"U1\").End(xlDown).Offset(3, 0).Select\nSelection.FormulaR1C1 = \"=SUM(R[-4]C:R[-3]C)\"\n</code></pre>\n\n<p>This allows the macro to go to the end of Column U (where I have established two sum cells) then select the cell three rows down. This cell will then sum the cells 4 and 3 rows above.</p>\n"}], "owner": {"reputation": 57, "user_id": 4638017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vATYR.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4638017/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3071, "favorite_count": 0, "accepted_answer_id": 29283577, "answer_count": 1, "score": 1, "last_activity_date": 1427386519, "creation_date": 1427221872, "last_edit_date": 1427223092, "question_id": 29240222, "link": "https://stackoverflow.com/questions/29240222/use-vba-to-sum-several-cells-above-active-cell", "title": "Use VBA to sum several cells above active cell", "body": "<p>I need to use VBA to set a cell to sum several cells above the active cell. I have played around with some code that I came across but it is set to pull the entire column above the active cell. I do not understand the code enough to modify it to sum the cells two and three rows above. Here is what I have so far (only a portion of the macro posted):</p>\n\n<pre><code>Sub QRTLYdatagrab()\n\n''''Script leading up to this point has been omitted''''\n\nRange(\"U1\").End(xlDown).Offset(1, 0).Select\nActiveCell.FormulaR1C1 = \"SUM('Asset_Dtl for CEQs for FAS 157'!J:J)\"\nRange(\"U1\").End(xlDown).Offset(2, 0).Select\n\nDim r As Range, rAbove As Range\nDim wf As WorksheetFunction\nSet wf = Application.WorksheetFunction\nSet r = ActiveCell\nSet rAbove = Range(r.Offset(-2, 0), Cells(2, r.Column))\nr.Formula = \"=SUM(\" &amp; rAbove.Address &amp; \")\"\n\n''''Script after this point has been omitted''''\n\nEnd Sub\n</code></pre>\n\n<p>A quick example: one quarter my data may utilize 402 rows. I have summed rows 1 - 402 in 403. 404 is pulling a sum from another tab. I need 406 to sum 403 and 404. Please let me know if I need to clarify anything and thank you in advance for any help. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1427220507, "creation_date": 1427220507, "answer_id": 29239876, "question_id": 29239767, "link": "https://stackoverflow.com/questions/29239767/object-required-error-on-my-row-count-attempt/29239876#29239876", "title": "Object required error on my row count attempt", "body": "<p><code>RowNum</code> is not an object variable.  The <code>Set</code> keyword is only used when assigning to object variables. </p>\n\n<p>Remove the <code>Set</code> keyword.</p>\n\n<pre><code>RowNum = Sheets(\"Sheet3\").ListObjects(\"Table1\").ListColumns(1).Count\n</code></pre>\n\n<p>The error message means that the statement cannot be compiled/evaluated because the left side of the assignment is not an object type, as it would need to be when using the <code>Set</code> keyword (in that case, you would also need to ensure the right side of the assignment statement returns an object type, too).</p>\n"}], "owner": {"reputation": 3, "user_id": 4695129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/142a924e54d0d068a8e0e775edc1f2c1?s=128&d=identicon&r=PG&f=1", "display_name": "user4695129", "link": "https://stackoverflow.com/users/4695129/user4695129"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2118, "favorite_count": 0, "accepted_answer_id": 29239876, "answer_count": 1, "score": 0, "last_activity_date": 1427220633, "creation_date": 1427220112, "last_edit_date": 1531164843, "question_id": 29239767, "link": "https://stackoverflow.com/questions/29239767/object-required-error-on-my-row-count-attempt", "title": "Object required error on my row count attempt", "body": "<p>I keep getting object required on this sub at:</p>\n\n<p><code>Set RowNum = Sheets(\"Sheet3\").ListObjects(\"Table1\").ListColumns(1).Count</code></p>\n\n<p>Any extra help would be appreciated as well. I am trying to copy and paste from one table to another based off of the the first column cell value of each row of the table I am coping to and comparing it to the table that contains the data I need organized by </p>\n\n<pre><code>Private Sub ECRList_Click()\n\nDim RowName As String\nDim ColName As String\n Dim Collist As Range\n Dim Namelist As Range\n Dim RowNum As Integer\n'Dim ColNum As Integer\n\n\nSet Collist = Sheets(\"Sheet3\").ListObject(\"Table1\").HeaderRowRange    'creates an array that contains the table header cell names\nSet Namelist = Sheets(\"Sheet3\").ListObjects(\"Table1\").ListColumns(1).Range 'creates an array that contains the first row cell names of the table\nSet RowNum = Sheets(\"Sheet3\").ListObjects(\"Table1\").ListColumns(1).Count\n\nFor Each ColName In Collist 'iterate through each name in column header array\n    For Each RowName In Namelist  'iterate through each name in row name list\n        For RowNum = 1 To Namelist.UBound 'supplies an accurate array length\n            If Sheets(\"Sheet2\").ListObjects(\"Table3\").DataBodyRange(RowNum, \"Column1\").Value = Sheet1.ListObjects(\"Table1\").DataBodyRange(RowNum, \"ECR_No\").Value Then 'compares the text of both of tables first rows\n           Sheets(\"Sheet2\").ListObjects(\"Table3\").ListRow(RowNum).Select\n           Sheets(\"Sheet2\").ListObjects(\"Table3\").ListRow(RowNum).Copy 'copies the row from table 3\n           Sheets(\"Sheet3\").ListObjects(\"Table1\").ListRow(RowNum).Select\n           Sheets(\"Sheet3\").ListObjects(\"Table1\").ListRow(RowNum).Paste 'pastes the row from table 3 too table 2\n\n\n                'Next ColNum\n            End If\n        Next RowNum\n    Next RowName\nNext ColName\nEnd Sub\n</code></pre>\n"}]